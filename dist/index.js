var Nv = Object.defineProperty;
var Tv = (t, r, a) => r in t ? Nv(t, r, { enumerable: !0, configurable: !0, writable: !0, value: a }) : t[r] = a;
var Xe = (t, r, a) => Tv(t, typeof r != "symbol" ? r + "" : r, a);
var Av = typeof globalThis < "u" ? globalThis : typeof window < "u" ? window : typeof global < "u" ? global : typeof self < "u" ? self : {};
function Nl(t) {
  return t && t.__esModule && Object.prototype.hasOwnProperty.call(t, "default") ? t.default : t;
}
var mh = { exports: {} }, Fs = {};
/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var d1;
function Mv() {
  if (d1) return Fs;
  d1 = 1;
  var t = Symbol.for("react.transitional.element"), r = Symbol.for("react.fragment");
  function a(l, s, c) {
    var d = null;
    if (c !== void 0 && (d = "" + c), s.key !== void 0 && (d = "" + s.key), "key" in s) {
      c = {};
      for (var m in s)
        m !== "key" && (c[m] = s[m]);
    } else c = s;
    return s = c.ref, {
      $$typeof: t,
      type: l,
      key: d,
      ref: s !== void 0 ? s : null,
      props: c
    };
  }
  return Fs.Fragment = r, Fs.jsx = a, Fs.jsxs = a, Fs;
}
var f1;
function zv() {
  return f1 || (f1 = 1, mh.exports = Mv()), mh.exports;
}
var u = zv(), ph = { exports: {} }, at = {};
/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var h1;
function Rv() {
  if (h1) return at;
  h1 = 1;
  var t = Symbol.for("react.transitional.element"), r = Symbol.for("react.portal"), a = Symbol.for("react.fragment"), l = Symbol.for("react.strict_mode"), s = Symbol.for("react.profiler"), c = Symbol.for("react.consumer"), d = Symbol.for("react.context"), m = Symbol.for("react.forward_ref"), g = Symbol.for("react.suspense"), p = Symbol.for("react.memo"), v = Symbol.for("react.lazy"), x = Symbol.for("react.activity"), E = Symbol.iterator;
  function w(L) {
    return L === null || typeof L != "object" ? null : (L = E && L[E] || L["@@iterator"], typeof L == "function" ? L : null);
  }
  var _ = {
    isMounted: function() {
      return !1;
    },
    enqueueForceUpdate: function() {
    },
    enqueueReplaceState: function() {
    },
    enqueueSetState: function() {
    }
  }, A = Object.assign, D = {};
  function R(L, he, M) {
    this.props = L, this.context = he, this.refs = D, this.updater = M || _;
  }
  R.prototype.isReactComponent = {}, R.prototype.setState = function(L, he) {
    if (typeof L != "object" && typeof L != "function" && L != null)
      throw Error(
        "takes an object of state variables to update or a function which returns an object of state variables."
      );
    this.updater.enqueueSetState(this, L, he, "setState");
  }, R.prototype.forceUpdate = function(L) {
    this.updater.enqueueForceUpdate(this, L, "forceUpdate");
  };
  function Z() {
  }
  Z.prototype = R.prototype;
  function K(L, he, M) {
    this.props = L, this.context = he, this.refs = D, this.updater = M || _;
  }
  var ge = K.prototype = new Z();
  ge.constructor = K, A(ge, R.prototype), ge.isPureReactComponent = !0;
  var de = Array.isArray;
  function I() {
  }
  var V = { H: null, A: null, T: null, S: null }, we = Object.prototype.hasOwnProperty;
  function Te(L, he, M) {
    var Ie = M.ref;
    return {
      $$typeof: t,
      type: L,
      key: he,
      ref: Ie !== void 0 ? Ie : null,
      props: M
    };
  }
  function X(L, he) {
    return Te(L.type, he, L.props);
  }
  function oe(L) {
    return typeof L == "object" && L !== null && L.$$typeof === t;
  }
  function se(L) {
    var he = { "=": "=0", ":": "=2" };
    return "$" + L.replace(/[=:]/g, function(M) {
      return he[M];
    });
  }
  var Re = /\/+/g;
  function be(L, he) {
    return typeof L == "object" && L !== null && L.key != null ? se("" + L.key) : he.toString(36);
  }
  function je(L) {
    switch (L.status) {
      case "fulfilled":
        return L.value;
      case "rejected":
        throw L.reason;
      default:
        switch (typeof L.status == "string" ? L.then(I, I) : (L.status = "pending", L.then(
          function(he) {
            L.status === "pending" && (L.status = "fulfilled", L.value = he);
          },
          function(he) {
            L.status === "pending" && (L.status = "rejected", L.reason = he);
          }
        )), L.status) {
          case "fulfilled":
            return L.value;
          case "rejected":
            throw L.reason;
        }
    }
    throw L;
  }
  function re(L, he, M, Ie, Ye) {
    var ye = typeof L;
    (ye === "undefined" || ye === "boolean") && (L = null);
    var me = !1;
    if (L === null) me = !0;
    else
      switch (ye) {
        case "bigint":
        case "string":
        case "number":
          me = !0;
          break;
        case "object":
          switch (L.$$typeof) {
            case t:
            case r:
              me = !0;
              break;
            case v:
              return me = L._init, re(
                me(L._payload),
                he,
                M,
                Ie,
                Ye
              );
          }
      }
    if (me)
      return Ye = Ye(L), me = Ie === "" ? "." + be(L, 0) : Ie, de(Ye) ? (M = "", me != null && (M = me.replace(Re, "$&/") + "/"), re(Ye, he, M, "", function(Rt) {
        return Rt;
      })) : Ye != null && (oe(Ye) && (Ye = X(
        Ye,
        M + (Ye.key == null || L && L.key === Ye.key ? "" : ("" + Ye.key).replace(
          Re,
          "$&/"
        ) + "/") + me
      )), he.push(Ye)), 1;
    me = 0;
    var Ge = Ie === "" ? "." : Ie + ":";
    if (de(L))
      for (var Ne = 0; Ne < L.length; Ne++)
        Ie = L[Ne], ye = Ge + be(Ie, Ne), me += re(
          Ie,
          he,
          M,
          ye,
          Ye
        );
    else if (Ne = w(L), typeof Ne == "function")
      for (L = Ne.call(L), Ne = 0; !(Ie = L.next()).done; )
        Ie = Ie.value, ye = Ge + be(Ie, Ne++), me += re(
          Ie,
          he,
          M,
          ye,
          Ye
        );
    else if (ye === "object") {
      if (typeof L.then == "function")
        return re(
          je(L),
          he,
          M,
          Ie,
          Ye
        );
      throw he = String(L), Error(
        "Objects are not valid as a React child (found: " + (he === "[object Object]" ? "object with keys {" + Object.keys(L).join(", ") + "}" : he) + "). If you meant to render a collection of children, use an array instead."
      );
    }
    return me;
  }
  function _e(L, he, M) {
    if (L == null) return L;
    var Ie = [], Ye = 0;
    return re(L, Ie, "", "", function(ye) {
      return he.call(M, ye, Ye++);
    }), Ie;
  }
  function fe(L) {
    if (L._status === -1) {
      var he = L._result;
      he = he(), he.then(
        function(M) {
          (L._status === 0 || L._status === -1) && (L._status = 1, L._result = M);
        },
        function(M) {
          (L._status === 0 || L._status === -1) && (L._status = 2, L._result = M);
        }
      ), L._status === -1 && (L._status = 0, L._result = he);
    }
    if (L._status === 1) return L._result.default;
    throw L._result;
  }
  var Ue = typeof reportError == "function" ? reportError : function(L) {
    if (typeof window == "object" && typeof window.ErrorEvent == "function") {
      var he = new window.ErrorEvent("error", {
        bubbles: !0,
        cancelable: !0,
        message: typeof L == "object" && L !== null && typeof L.message == "string" ? String(L.message) : String(L),
        error: L
      });
      if (!window.dispatchEvent(he)) return;
    } else if (typeof process == "object" && typeof process.emit == "function") {
      process.emit("uncaughtException", L);
      return;
    }
    console.error(L);
  }, O = {
    map: _e,
    forEach: function(L, he, M) {
      _e(
        L,
        function() {
          he.apply(this, arguments);
        },
        M
      );
    },
    count: function(L) {
      var he = 0;
      return _e(L, function() {
        he++;
      }), he;
    },
    toArray: function(L) {
      return _e(L, function(he) {
        return he;
      }) || [];
    },
    only: function(L) {
      if (!oe(L))
        throw Error(
          "React.Children.only expected to receive a single React element child."
        );
      return L;
    }
  };
  return at.Activity = x, at.Children = O, at.Component = R, at.Fragment = a, at.Profiler = s, at.PureComponent = K, at.StrictMode = l, at.Suspense = g, at.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE = V, at.__COMPILER_RUNTIME = {
    __proto__: null,
    c: function(L) {
      return V.H.useMemoCache(L);
    }
  }, at.cache = function(L) {
    return function() {
      return L.apply(null, arguments);
    };
  }, at.cacheSignal = function() {
    return null;
  }, at.cloneElement = function(L, he, M) {
    if (L == null)
      throw Error(
        "The argument must be a React element, but you passed " + L + "."
      );
    var Ie = A({}, L.props), Ye = L.key;
    if (he != null)
      for (ye in he.key !== void 0 && (Ye = "" + he.key), he)
        !we.call(he, ye) || ye === "key" || ye === "__self" || ye === "__source" || ye === "ref" && he.ref === void 0 || (Ie[ye] = he[ye]);
    var ye = arguments.length - 2;
    if (ye === 1) Ie.children = M;
    else if (1 < ye) {
      for (var me = Array(ye), Ge = 0; Ge < ye; Ge++)
        me[Ge] = arguments[Ge + 2];
      Ie.children = me;
    }
    return Te(L.type, Ye, Ie);
  }, at.createContext = function(L) {
    return L = {
      $$typeof: d,
      _currentValue: L,
      _currentValue2: L,
      _threadCount: 0,
      Provider: null,
      Consumer: null
    }, L.Provider = L, L.Consumer = {
      $$typeof: c,
      _context: L
    }, L;
  }, at.createElement = function(L, he, M) {
    var Ie, Ye = {}, ye = null;
    if (he != null)
      for (Ie in he.key !== void 0 && (ye = "" + he.key), he)
        we.call(he, Ie) && Ie !== "key" && Ie !== "__self" && Ie !== "__source" && (Ye[Ie] = he[Ie]);
    var me = arguments.length - 2;
    if (me === 1) Ye.children = M;
    else if (1 < me) {
      for (var Ge = Array(me), Ne = 0; Ne < me; Ne++)
        Ge[Ne] = arguments[Ne + 2];
      Ye.children = Ge;
    }
    if (L && L.defaultProps)
      for (Ie in me = L.defaultProps, me)
        Ye[Ie] === void 0 && (Ye[Ie] = me[Ie]);
    return Te(L, ye, Ye);
  }, at.createRef = function() {
    return { current: null };
  }, at.forwardRef = function(L) {
    return { $$typeof: m, render: L };
  }, at.isValidElement = oe, at.lazy = function(L) {
    return {
      $$typeof: v,
      _payload: { _status: -1, _result: L },
      _init: fe
    };
  }, at.memo = function(L, he) {
    return {
      $$typeof: p,
      type: L,
      compare: he === void 0 ? null : he
    };
  }, at.startTransition = function(L) {
    var he = V.T, M = {};
    V.T = M;
    try {
      var Ie = L(), Ye = V.S;
      Ye !== null && Ye(M, Ie), typeof Ie == "object" && Ie !== null && typeof Ie.then == "function" && Ie.then(I, Ue);
    } catch (ye) {
      Ue(ye);
    } finally {
      he !== null && M.types !== null && (he.types = M.types), V.T = he;
    }
  }, at.unstable_useCacheRefresh = function() {
    return V.H.useCacheRefresh();
  }, at.use = function(L) {
    return V.H.use(L);
  }, at.useActionState = function(L, he, M) {
    return V.H.useActionState(L, he, M);
  }, at.useCallback = function(L, he) {
    return V.H.useCallback(L, he);
  }, at.useContext = function(L) {
    return V.H.useContext(L);
  }, at.useDebugValue = function() {
  }, at.useDeferredValue = function(L, he) {
    return V.H.useDeferredValue(L, he);
  }, at.useEffect = function(L, he) {
    return V.H.useEffect(L, he);
  }, at.useEffectEvent = function(L) {
    return V.H.useEffectEvent(L);
  }, at.useId = function() {
    return V.H.useId();
  }, at.useImperativeHandle = function(L, he, M) {
    return V.H.useImperativeHandle(L, he, M);
  }, at.useInsertionEffect = function(L, he) {
    return V.H.useInsertionEffect(L, he);
  }, at.useLayoutEffect = function(L, he) {
    return V.H.useLayoutEffect(L, he);
  }, at.useMemo = function(L, he) {
    return V.H.useMemo(L, he);
  }, at.useOptimistic = function(L, he) {
    return V.H.useOptimistic(L, he);
  }, at.useReducer = function(L, he, M) {
    return V.H.useReducer(L, he, M);
  }, at.useRef = function(L) {
    return V.H.useRef(L);
  }, at.useState = function(L) {
    return V.H.useState(L);
  }, at.useSyncExternalStore = function(L, he, M) {
    return V.H.useSyncExternalStore(
      L,
      he,
      M
    );
  }, at.useTransition = function() {
    return V.H.useTransition();
  }, at.version = "19.2.3", at;
}
var m1;
function du() {
  return m1 || (m1 = 1, ph.exports = Rv()), ph.exports;
}
var U = du();
const ib = /* @__PURE__ */ Nl(U);
var gh = { exports: {} }, $s = {}, yh = { exports: {} }, bh = {};
/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var p1;
function Ov() {
  return p1 || (p1 = 1, (function(t) {
    function r(re, _e) {
      var fe = re.length;
      re.push(_e);
      e: for (; 0 < fe; ) {
        var Ue = fe - 1 >>> 1, O = re[Ue];
        if (0 < s(O, _e))
          re[Ue] = _e, re[fe] = O, fe = Ue;
        else break e;
      }
    }
    function a(re) {
      return re.length === 0 ? null : re[0];
    }
    function l(re) {
      if (re.length === 0) return null;
      var _e = re[0], fe = re.pop();
      if (fe !== _e) {
        re[0] = fe;
        e: for (var Ue = 0, O = re.length, L = O >>> 1; Ue < L; ) {
          var he = 2 * (Ue + 1) - 1, M = re[he], Ie = he + 1, Ye = re[Ie];
          if (0 > s(M, fe))
            Ie < O && 0 > s(Ye, M) ? (re[Ue] = Ye, re[Ie] = fe, Ue = Ie) : (re[Ue] = M, re[he] = fe, Ue = he);
          else if (Ie < O && 0 > s(Ye, fe))
            re[Ue] = Ye, re[Ie] = fe, Ue = Ie;
          else break e;
        }
      }
      return _e;
    }
    function s(re, _e) {
      var fe = re.sortIndex - _e.sortIndex;
      return fe !== 0 ? fe : re.id - _e.id;
    }
    if (t.unstable_now = void 0, typeof performance == "object" && typeof performance.now == "function") {
      var c = performance;
      t.unstable_now = function() {
        return c.now();
      };
    } else {
      var d = Date, m = d.now();
      t.unstable_now = function() {
        return d.now() - m;
      };
    }
    var g = [], p = [], v = 1, x = null, E = 3, w = !1, _ = !1, A = !1, D = !1, R = typeof setTimeout == "function" ? setTimeout : null, Z = typeof clearTimeout == "function" ? clearTimeout : null, K = typeof setImmediate < "u" ? setImmediate : null;
    function ge(re) {
      for (var _e = a(p); _e !== null; ) {
        if (_e.callback === null) l(p);
        else if (_e.startTime <= re)
          l(p), _e.sortIndex = _e.expirationTime, r(g, _e);
        else break;
        _e = a(p);
      }
    }
    function de(re) {
      if (A = !1, ge(re), !_)
        if (a(g) !== null)
          _ = !0, I || (I = !0, se());
        else {
          var _e = a(p);
          _e !== null && je(de, _e.startTime - re);
        }
    }
    var I = !1, V = -1, we = 5, Te = -1;
    function X() {
      return D ? !0 : !(t.unstable_now() - Te < we);
    }
    function oe() {
      if (D = !1, I) {
        var re = t.unstable_now();
        Te = re;
        var _e = !0;
        try {
          e: {
            _ = !1, A && (A = !1, Z(V), V = -1), w = !0;
            var fe = E;
            try {
              t: {
                for (ge(re), x = a(g); x !== null && !(x.expirationTime > re && X()); ) {
                  var Ue = x.callback;
                  if (typeof Ue == "function") {
                    x.callback = null, E = x.priorityLevel;
                    var O = Ue(
                      x.expirationTime <= re
                    );
                    if (re = t.unstable_now(), typeof O == "function") {
                      x.callback = O, ge(re), _e = !0;
                      break t;
                    }
                    x === a(g) && l(g), ge(re);
                  } else l(g);
                  x = a(g);
                }
                if (x !== null) _e = !0;
                else {
                  var L = a(p);
                  L !== null && je(
                    de,
                    L.startTime - re
                  ), _e = !1;
                }
              }
              break e;
            } finally {
              x = null, E = fe, w = !1;
            }
            _e = void 0;
          }
        } finally {
          _e ? se() : I = !1;
        }
      }
    }
    var se;
    if (typeof K == "function")
      se = function() {
        K(oe);
      };
    else if (typeof MessageChannel < "u") {
      var Re = new MessageChannel(), be = Re.port2;
      Re.port1.onmessage = oe, se = function() {
        be.postMessage(null);
      };
    } else
      se = function() {
        R(oe, 0);
      };
    function je(re, _e) {
      V = R(function() {
        re(t.unstable_now());
      }, _e);
    }
    t.unstable_IdlePriority = 5, t.unstable_ImmediatePriority = 1, t.unstable_LowPriority = 4, t.unstable_NormalPriority = 3, t.unstable_Profiling = null, t.unstable_UserBlockingPriority = 2, t.unstable_cancelCallback = function(re) {
      re.callback = null;
    }, t.unstable_forceFrameRate = function(re) {
      0 > re || 125 < re ? console.error(
        "forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"
      ) : we = 0 < re ? Math.floor(1e3 / re) : 5;
    }, t.unstable_getCurrentPriorityLevel = function() {
      return E;
    }, t.unstable_next = function(re) {
      switch (E) {
        case 1:
        case 2:
        case 3:
          var _e = 3;
          break;
        default:
          _e = E;
      }
      var fe = E;
      E = _e;
      try {
        return re();
      } finally {
        E = fe;
      }
    }, t.unstable_requestPaint = function() {
      D = !0;
    }, t.unstable_runWithPriority = function(re, _e) {
      switch (re) {
        case 1:
        case 2:
        case 3:
        case 4:
        case 5:
          break;
        default:
          re = 3;
      }
      var fe = E;
      E = re;
      try {
        return _e();
      } finally {
        E = fe;
      }
    }, t.unstable_scheduleCallback = function(re, _e, fe) {
      var Ue = t.unstable_now();
      switch (typeof fe == "object" && fe !== null ? (fe = fe.delay, fe = typeof fe == "number" && 0 < fe ? Ue + fe : Ue) : fe = Ue, re) {
        case 1:
          var O = -1;
          break;
        case 2:
          O = 250;
          break;
        case 5:
          O = 1073741823;
          break;
        case 4:
          O = 1e4;
          break;
        default:
          O = 5e3;
      }
      return O = fe + O, re = {
        id: v++,
        callback: _e,
        priorityLevel: re,
        startTime: fe,
        expirationTime: O,
        sortIndex: -1
      }, fe > Ue ? (re.sortIndex = fe, r(p, re), a(g) === null && re === a(p) && (A ? (Z(V), V = -1) : A = !0, je(de, fe - Ue))) : (re.sortIndex = O, r(g, re), _ || w || (_ = !0, I || (I = !0, se()))), re;
    }, t.unstable_shouldYield = X, t.unstable_wrapCallback = function(re) {
      var _e = E;
      return function() {
        var fe = E;
        E = _e;
        try {
          return re.apply(this, arguments);
        } finally {
          E = fe;
        }
      };
    };
  })(bh)), bh;
}
var g1;
function Dv() {
  return g1 || (g1 = 1, yh.exports = Ov()), yh.exports;
}
var xh = { exports: {} }, Rn = {};
/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var y1;
function Lv() {
  if (y1) return Rn;
  y1 = 1;
  var t = du();
  function r(g) {
    var p = "https://react.dev/errors/" + g;
    if (1 < arguments.length) {
      p += "?args[]=" + encodeURIComponent(arguments[1]);
      for (var v = 2; v < arguments.length; v++)
        p += "&args[]=" + encodeURIComponent(arguments[v]);
    }
    return "Minified React error #" + g + "; visit " + p + " for the full message or use the non-minified dev environment for full errors and additional helpful warnings.";
  }
  function a() {
  }
  var l = {
    d: {
      f: a,
      r: function() {
        throw Error(r(522));
      },
      D: a,
      C: a,
      L: a,
      m: a,
      X: a,
      S: a,
      M: a
    },
    p: 0,
    findDOMNode: null
  }, s = Symbol.for("react.portal");
  function c(g, p, v) {
    var x = 3 < arguments.length && arguments[3] !== void 0 ? arguments[3] : null;
    return {
      $$typeof: s,
      key: x == null ? null : "" + x,
      children: g,
      containerInfo: p,
      implementation: v
    };
  }
  var d = t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;
  function m(g, p) {
    if (g === "font") return "";
    if (typeof p == "string")
      return p === "use-credentials" ? p : "";
  }
  return Rn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE = l, Rn.createPortal = function(g, p) {
    var v = 2 < arguments.length && arguments[2] !== void 0 ? arguments[2] : null;
    if (!p || p.nodeType !== 1 && p.nodeType !== 9 && p.nodeType !== 11)
      throw Error(r(299));
    return c(g, p, null, v);
  }, Rn.flushSync = function(g) {
    var p = d.T, v = l.p;
    try {
      if (d.T = null, l.p = 2, g) return g();
    } finally {
      d.T = p, l.p = v, l.d.f();
    }
  }, Rn.preconnect = function(g, p) {
    typeof g == "string" && (p ? (p = p.crossOrigin, p = typeof p == "string" ? p === "use-credentials" ? p : "" : void 0) : p = null, l.d.C(g, p));
  }, Rn.prefetchDNS = function(g) {
    typeof g == "string" && l.d.D(g);
  }, Rn.preinit = function(g, p) {
    if (typeof g == "string" && p && typeof p.as == "string") {
      var v = p.as, x = m(v, p.crossOrigin), E = typeof p.integrity == "string" ? p.integrity : void 0, w = typeof p.fetchPriority == "string" ? p.fetchPriority : void 0;
      v === "style" ? l.d.S(
        g,
        typeof p.precedence == "string" ? p.precedence : void 0,
        {
          crossOrigin: x,
          integrity: E,
          fetchPriority: w
        }
      ) : v === "script" && l.d.X(g, {
        crossOrigin: x,
        integrity: E,
        fetchPriority: w,
        nonce: typeof p.nonce == "string" ? p.nonce : void 0
      });
    }
  }, Rn.preinitModule = function(g, p) {
    if (typeof g == "string")
      if (typeof p == "object" && p !== null) {
        if (p.as == null || p.as === "script") {
          var v = m(
            p.as,
            p.crossOrigin
          );
          l.d.M(g, {
            crossOrigin: v,
            integrity: typeof p.integrity == "string" ? p.integrity : void 0,
            nonce: typeof p.nonce == "string" ? p.nonce : void 0
          });
        }
      } else p == null && l.d.M(g);
  }, Rn.preload = function(g, p) {
    if (typeof g == "string" && typeof p == "object" && p !== null && typeof p.as == "string") {
      var v = p.as, x = m(v, p.crossOrigin);
      l.d.L(g, v, {
        crossOrigin: x,
        integrity: typeof p.integrity == "string" ? p.integrity : void 0,
        nonce: typeof p.nonce == "string" ? p.nonce : void 0,
        type: typeof p.type == "string" ? p.type : void 0,
        fetchPriority: typeof p.fetchPriority == "string" ? p.fetchPriority : void 0,
        referrerPolicy: typeof p.referrerPolicy == "string" ? p.referrerPolicy : void 0,
        imageSrcSet: typeof p.imageSrcSet == "string" ? p.imageSrcSet : void 0,
        imageSizes: typeof p.imageSizes == "string" ? p.imageSizes : void 0,
        media: typeof p.media == "string" ? p.media : void 0
      });
    }
  }, Rn.preloadModule = function(g, p) {
    if (typeof g == "string")
      if (p) {
        var v = m(p.as, p.crossOrigin);
        l.d.m(g, {
          as: typeof p.as == "string" && p.as !== "script" ? p.as : void 0,
          crossOrigin: v,
          integrity: typeof p.integrity == "string" ? p.integrity : void 0
        });
      } else l.d.m(g);
  }, Rn.requestFormReset = function(g) {
    l.d.r(g);
  }, Rn.unstable_batchedUpdates = function(g, p) {
    return g(p);
  }, Rn.useFormState = function(g, p, v) {
    return d.H.useFormState(g, p, v);
  }, Rn.useFormStatus = function() {
    return d.H.useHostTransitionStatus();
  }, Rn.version = "19.2.3", Rn;
}
var b1;
function lb() {
  if (b1) return xh.exports;
  b1 = 1;
  function t() {
    if (!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ > "u" || typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE != "function"))
      try {
        __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t);
      } catch (r) {
        console.error(r);
      }
  }
  return t(), xh.exports = Lv(), xh.exports;
}
/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var x1;
function Bv() {
  if (x1) return $s;
  x1 = 1;
  var t = Dv(), r = du(), a = lb();
  function l(e) {
    var n = "https://react.dev/errors/" + e;
    if (1 < arguments.length) {
      n += "?args[]=" + encodeURIComponent(arguments[1]);
      for (var i = 2; i < arguments.length; i++)
        n += "&args[]=" + encodeURIComponent(arguments[i]);
    }
    return "Minified React error #" + e + "; visit " + n + " for the full message or use the non-minified dev environment for full errors and additional helpful warnings.";
  }
  function s(e) {
    return !(!e || e.nodeType !== 1 && e.nodeType !== 9 && e.nodeType !== 11);
  }
  function c(e) {
    var n = e, i = e;
    if (e.alternate) for (; n.return; ) n = n.return;
    else {
      e = n;
      do
        n = e, (n.flags & 4098) !== 0 && (i = n.return), e = n.return;
      while (e);
    }
    return n.tag === 3 ? i : null;
  }
  function d(e) {
    if (e.tag === 13) {
      var n = e.memoizedState;
      if (n === null && (e = e.alternate, e !== null && (n = e.memoizedState)), n !== null) return n.dehydrated;
    }
    return null;
  }
  function m(e) {
    if (e.tag === 31) {
      var n = e.memoizedState;
      if (n === null && (e = e.alternate, e !== null && (n = e.memoizedState)), n !== null) return n.dehydrated;
    }
    return null;
  }
  function g(e) {
    if (c(e) !== e)
      throw Error(l(188));
  }
  function p(e) {
    var n = e.alternate;
    if (!n) {
      if (n = c(e), n === null) throw Error(l(188));
      return n !== e ? null : e;
    }
    for (var i = e, o = n; ; ) {
      var h = i.return;
      if (h === null) break;
      var b = h.alternate;
      if (b === null) {
        if (o = h.return, o !== null) {
          i = o;
          continue;
        }
        break;
      }
      if (h.child === b.child) {
        for (b = h.child; b; ) {
          if (b === i) return g(h), e;
          if (b === o) return g(h), n;
          b = b.sibling;
        }
        throw Error(l(188));
      }
      if (i.return !== o.return) i = h, o = b;
      else {
        for (var C = !1, T = h.child; T; ) {
          if (T === i) {
            C = !0, i = h, o = b;
            break;
          }
          if (T === o) {
            C = !0, o = h, i = b;
            break;
          }
          T = T.sibling;
        }
        if (!C) {
          for (T = b.child; T; ) {
            if (T === i) {
              C = !0, i = b, o = h;
              break;
            }
            if (T === o) {
              C = !0, o = b, i = h;
              break;
            }
            T = T.sibling;
          }
          if (!C) throw Error(l(189));
        }
      }
      if (i.alternate !== o) throw Error(l(190));
    }
    if (i.tag !== 3) throw Error(l(188));
    return i.stateNode.current === i ? e : n;
  }
  function v(e) {
    var n = e.tag;
    if (n === 5 || n === 26 || n === 27 || n === 6) return e;
    for (e = e.child; e !== null; ) {
      if (n = v(e), n !== null) return n;
      e = e.sibling;
    }
    return null;
  }
  var x = Object.assign, E = Symbol.for("react.element"), w = Symbol.for("react.transitional.element"), _ = Symbol.for("react.portal"), A = Symbol.for("react.fragment"), D = Symbol.for("react.strict_mode"), R = Symbol.for("react.profiler"), Z = Symbol.for("react.consumer"), K = Symbol.for("react.context"), ge = Symbol.for("react.forward_ref"), de = Symbol.for("react.suspense"), I = Symbol.for("react.suspense_list"), V = Symbol.for("react.memo"), we = Symbol.for("react.lazy"), Te = Symbol.for("react.activity"), X = Symbol.for("react.memo_cache_sentinel"), oe = Symbol.iterator;
  function se(e) {
    return e === null || typeof e != "object" ? null : (e = oe && e[oe] || e["@@iterator"], typeof e == "function" ? e : null);
  }
  var Re = Symbol.for("react.client.reference");
  function be(e) {
    if (e == null) return null;
    if (typeof e == "function")
      return e.$$typeof === Re ? null : e.displayName || e.name || null;
    if (typeof e == "string") return e;
    switch (e) {
      case A:
        return "Fragment";
      case R:
        return "Profiler";
      case D:
        return "StrictMode";
      case de:
        return "Suspense";
      case I:
        return "SuspenseList";
      case Te:
        return "Activity";
    }
    if (typeof e == "object")
      switch (e.$$typeof) {
        case _:
          return "Portal";
        case K:
          return e.displayName || "Context";
        case Z:
          return (e._context.displayName || "Context") + ".Consumer";
        case ge:
          var n = e.render;
          return e = e.displayName, e || (e = n.displayName || n.name || "", e = e !== "" ? "ForwardRef(" + e + ")" : "ForwardRef"), e;
        case V:
          return n = e.displayName || null, n !== null ? n : be(e.type) || "Memo";
        case we:
          n = e._payload, e = e._init;
          try {
            return be(e(n));
          } catch {
          }
      }
    return null;
  }
  var je = Array.isArray, re = r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE, _e = a.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE, fe = {
    pending: !1,
    data: null,
    method: null,
    action: null
  }, Ue = [], O = -1;
  function L(e) {
    return { current: e };
  }
  function he(e) {
    0 > O || (e.current = Ue[O], Ue[O] = null, O--);
  }
  function M(e, n) {
    O++, Ue[O] = e.current, e.current = n;
  }
  var Ie = L(null), Ye = L(null), ye = L(null), me = L(null);
  function Ge(e, n) {
    switch (M(ye, n), M(Ye, e), M(Ie, null), n.nodeType) {
      case 9:
      case 11:
        e = (e = n.documentElement) && (e = e.namespaceURI) ? O0(e) : 0;
        break;
      default:
        if (e = n.tagName, n = n.namespaceURI)
          n = O0(n), e = D0(n, e);
        else
          switch (e) {
            case "svg":
              e = 1;
              break;
            case "math":
              e = 2;
              break;
            default:
              e = 0;
          }
    }
    he(Ie), M(Ie, e);
  }
  function Ne() {
    he(Ie), he(Ye), he(ye);
  }
  function Rt(e) {
    e.memoizedState !== null && M(me, e);
    var n = Ie.current, i = D0(n, e.type);
    n !== i && (M(Ye, e), M(Ie, i));
  }
  function tn(e) {
    Ye.current === e && (he(Ie), he(Ye)), me.current === e && (he(me), Us._currentValue = fe);
  }
  var mt, qr;
  function Mr(e) {
    if (mt === void 0)
      try {
        throw Error();
      } catch (i) {
        var n = i.stack.trim().match(/\n( *(at )?)/);
        mt = n && n[1] || "", qr = -1 < i.stack.indexOf(`
    at`) ? " (<anonymous>)" : -1 < i.stack.indexOf("@") ? "@unknown:0:0" : "";
      }
    return `
` + mt + e + qr;
  }
  var Fn = !1;
  function Ga(e, n) {
    if (!e || Fn) return "";
    Fn = !0;
    var i = Error.prepareStackTrace;
    Error.prepareStackTrace = void 0;
    try {
      var o = {
        DetermineComponentFrameRoot: function() {
          try {
            if (n) {
              var Ee = function() {
                throw Error();
              };
              if (Object.defineProperty(Ee.prototype, "props", {
                set: function() {
                  throw Error();
                }
              }), typeof Reflect == "object" && Reflect.construct) {
                try {
                  Reflect.construct(Ee, []);
                } catch (pe) {
                  var ce = pe;
                }
                Reflect.construct(e, [], Ee);
              } else {
                try {
                  Ee.call();
                } catch (pe) {
                  ce = pe;
                }
                e.call(Ee.prototype);
              }
            } else {
              try {
                throw Error();
              } catch (pe) {
                ce = pe;
              }
              (Ee = e()) && typeof Ee.catch == "function" && Ee.catch(function() {
              });
            }
          } catch (pe) {
            if (pe && ce && typeof pe.stack == "string")
              return [pe.stack, ce.stack];
          }
          return [null, null];
        }
      };
      o.DetermineComponentFrameRoot.displayName = "DetermineComponentFrameRoot";
      var h = Object.getOwnPropertyDescriptor(
        o.DetermineComponentFrameRoot,
        "name"
      );
      h && h.configurable && Object.defineProperty(
        o.DetermineComponentFrameRoot,
        "name",
        { value: "DetermineComponentFrameRoot" }
      );
      var b = o.DetermineComponentFrameRoot(), C = b[0], T = b[1];
      if (C && T) {
        var P = C.split(`
`), le = T.split(`
`);
        for (h = o = 0; o < P.length && !P[o].includes("DetermineComponentFrameRoot"); )
          o++;
        for (; h < le.length && !le[h].includes(
          "DetermineComponentFrameRoot"
        ); )
          h++;
        if (o === P.length || h === le.length)
          for (o = P.length - 1, h = le.length - 1; 1 <= o && 0 <= h && P[o] !== le[h]; )
            h--;
        for (; 1 <= o && 0 <= h; o--, h--)
          if (P[o] !== le[h]) {
            if (o !== 1 || h !== 1)
              do
                if (o--, h--, 0 > h || P[o] !== le[h]) {
                  var Se = `
` + P[o].replace(" at new ", " at ");
                  return e.displayName && Se.includes("<anonymous>") && (Se = Se.replace("<anonymous>", e.displayName)), Se;
                }
              while (1 <= o && 0 <= h);
            break;
          }
      }
    } finally {
      Fn = !1, Error.prepareStackTrace = i;
    }
    return (i = e ? e.displayName || e.name : "") ? Mr(i) : "";
  }
  function Ml(e, n) {
    switch (e.tag) {
      case 26:
      case 27:
      case 5:
        return Mr(e.type);
      case 16:
        return Mr("Lazy");
      case 13:
        return e.child !== n && n !== null ? Mr("Suspense Fallback") : Mr("Suspense");
      case 19:
        return Mr("SuspenseList");
      case 0:
      case 15:
        return Ga(e.type, !1);
      case 11:
        return Ga(e.type.render, !1);
      case 1:
        return Ga(e.type, !0);
      case 31:
        return Mr("Activity");
      default:
        return "";
    }
  }
  function zl(e) {
    try {
      var n = "", i = null;
      do
        n += Ml(e, i), i = e, e = e.return;
      while (e);
      return n;
    } catch (o) {
      return `
Error generating stack: ` + o.message + `
` + o.stack;
    }
  }
  var Va = Object.prototype.hasOwnProperty, Hr = t.unstable_scheduleCallback, Tn = t.unstable_cancelCallback, Rl = t.unstable_shouldYield, ha = t.unstable_requestPaint, mn = t.unstable_now, ma = t.unstable_getCurrentPriorityLevel, ve = t.unstable_ImmediatePriority, Oe = t.unstable_UserBlockingPriority, Je = t.unstable_NormalPriority, it = t.unstable_LowPriority, xt = t.unstable_IdlePriority, pn = t.log, Sn = t.unstable_setDisableYieldValue, nn = null, Vt = null;
  function Kt(e) {
    if (typeof pn == "function" && Sn(e), Vt && typeof Vt.setStrictMode == "function")
      try {
        Vt.setStrictMode(nn, e);
      } catch {
      }
  }
  var Be = Math.clz32 ? Math.clz32 : Ol, $n = Math.log, fn = Math.LN2;
  function Ol(e) {
    return e >>>= 0, e === 0 ? 32 : 31 - ($n(e) / fn | 0) | 0;
  }
  var He = 256, Ka = 262144, Ui = 4194304;
  function zr(e) {
    var n = e & 42;
    if (n !== 0) return n;
    switch (e & -e) {
      case 1:
        return 1;
      case 2:
        return 2;
      case 4:
        return 4;
      case 8:
        return 8;
      case 16:
        return 16;
      case 32:
        return 32;
      case 64:
        return 64;
      case 128:
        return 128;
      case 256:
      case 512:
      case 1024:
      case 2048:
      case 4096:
      case 8192:
      case 16384:
      case 32768:
      case 65536:
      case 131072:
        return e & 261888;
      case 262144:
      case 524288:
      case 1048576:
      case 2097152:
        return e & 3932160;
      case 4194304:
      case 8388608:
      case 16777216:
      case 33554432:
        return e & 62914560;
      case 67108864:
        return 67108864;
      case 134217728:
        return 134217728;
      case 268435456:
        return 268435456;
      case 536870912:
        return 536870912;
      case 1073741824:
        return 0;
      default:
        return e;
    }
  }
  function Pi(e, n, i) {
    var o = e.pendingLanes;
    if (o === 0) return 0;
    var h = 0, b = e.suspendedLanes, C = e.pingedLanes;
    e = e.warmLanes;
    var T = o & 134217727;
    return T !== 0 ? (o = T & ~b, o !== 0 ? h = zr(o) : (C &= T, C !== 0 ? h = zr(C) : i || (i = T & ~e, i !== 0 && (h = zr(i))))) : (T = o & ~b, T !== 0 ? h = zr(T) : C !== 0 ? h = zr(C) : i || (i = o & ~e, i !== 0 && (h = zr(i)))), h === 0 ? 0 : n !== 0 && n !== h && (n & b) === 0 && (b = h & -h, i = n & -n, b >= i || b === 32 && (i & 4194048) !== 0) ? n : h;
  }
  function pa(e, n) {
    return (e.pendingLanes & ~(e.suspendedLanes & ~e.pingedLanes) & n) === 0;
  }
  function vd(e, n) {
    switch (e) {
      case 1:
      case 2:
      case 4:
      case 8:
      case 64:
        return n + 250;
      case 16:
      case 32:
      case 128:
      case 256:
      case 512:
      case 1024:
      case 2048:
      case 4096:
      case 8192:
      case 16384:
      case 32768:
      case 65536:
      case 131072:
      case 262144:
      case 524288:
      case 1048576:
      case 2097152:
        return n + 5e3;
      case 4194304:
      case 8388608:
      case 16777216:
      case 33554432:
        return -1;
      case 67108864:
      case 134217728:
      case 268435456:
      case 536870912:
      case 1073741824:
        return -1;
      default:
        return -1;
    }
  }
  function Su() {
    var e = Ui;
    return Ui <<= 1, (Ui & 62914560) === 0 && (Ui = 4194304), e;
  }
  function Fr(e) {
    for (var n = [], i = 0; 31 > i; i++) n.push(e);
    return n;
  }
  function gr(e, n) {
    e.pendingLanes |= n, n !== 268435456 && (e.suspendedLanes = 0, e.pingedLanes = 0, e.warmLanes = 0);
  }
  function Ho(e, n, i, o, h, b) {
    var C = e.pendingLanes;
    e.pendingLanes = i, e.suspendedLanes = 0, e.pingedLanes = 0, e.warmLanes = 0, e.expiredLanes &= i, e.entangledLanes &= i, e.errorRecoveryDisabledLanes &= i, e.shellSuspendCounter = 0;
    var T = e.entanglements, P = e.expirationTimes, le = e.hiddenUpdates;
    for (i = C & ~i; 0 < i; ) {
      var Se = 31 - Be(i), Ee = 1 << Se;
      T[Se] = 0, P[Se] = -1;
      var ce = le[Se];
      if (ce !== null)
        for (le[Se] = null, Se = 0; Se < ce.length; Se++) {
          var pe = ce[Se];
          pe !== null && (pe.lane &= -536870913);
        }
      i &= ~Ee;
    }
    o !== 0 && qi(e, o, 0), b !== 0 && h === 0 && e.tag !== 0 && (e.suspendedLanes |= b & ~(C & ~n));
  }
  function qi(e, n, i) {
    e.pendingLanes |= n, e.suspendedLanes &= ~n;
    var o = 31 - Be(n);
    e.entangledLanes |= n, e.entanglements[o] = e.entanglements[o] | 1073741824 | i & 261930;
  }
  function Ot(e, n) {
    var i = e.entangledLanes |= n;
    for (e = e.entanglements; i; ) {
      var o = 31 - Be(i), h = 1 << o;
      h & n | e[o] & n && (e[o] |= n), i &= ~h;
    }
  }
  function Xt(e, n) {
    var i = n & -n;
    return i = (i & 42) !== 0 ? 1 : Fo(i), (i & (e.suspendedLanes | n)) !== 0 ? 0 : i;
  }
  function Fo(e) {
    switch (e) {
      case 2:
        e = 1;
        break;
      case 8:
        e = 4;
        break;
      case 32:
        e = 16;
        break;
      case 256:
      case 512:
      case 1024:
      case 2048:
      case 4096:
      case 8192:
      case 16384:
      case 32768:
      case 65536:
      case 131072:
      case 262144:
      case 524288:
      case 1048576:
      case 2097152:
      case 4194304:
      case 8388608:
      case 16777216:
      case 33554432:
        e = 128;
        break;
      case 268435456:
        e = 134217728;
        break;
      default:
        e = 0;
    }
    return e;
  }
  function Ya(e) {
    return e &= -e, 2 < e ? 8 < e ? (e & 134217727) !== 0 ? 32 : 268435456 : 8 : 2;
  }
  function Hi() {
    var e = _e.p;
    return e !== 0 ? e : (e = window.event, e === void 0 ? 32 : a1(e.type));
  }
  function Fi(e, n) {
    var i = _e.p;
    try {
      return _e.p = e, n();
    } finally {
      _e.p = i;
    }
  }
  var $r = Math.random().toString(36).slice(2), Bt = "__reactFiber$" + $r, Wt = "__reactProps$" + $r, In = "__reactContainer$" + $r, Qa = "__reactEvents$" + $r, Sd = "__reactListeners$" + $r, Gr = "__reactHandles$" + $r, $o = "__reactResources$" + $r, rr = "__reactMarker$" + $r;
  function Dl(e) {
    delete e[Bt], delete e[Wt], delete e[Qa], delete e[Sd], delete e[Gr];
  }
  function Vr(e) {
    var n = e[Bt];
    if (n) return n;
    for (var i = e.parentNode; i; ) {
      if (n = i[In] || i[Bt]) {
        if (i = n.alternate, n.child !== null || i !== null && i.child !== null)
          for (e = H0(e); e !== null; ) {
            if (i = e[Bt]) return i;
            e = H0(e);
          }
        return n;
      }
      e = i, i = e.parentNode;
    }
    return null;
  }
  function Tt(e) {
    if (e = e[Bt] || e[In]) {
      var n = e.tag;
      if (n === 5 || n === 6 || n === 13 || n === 31 || n === 26 || n === 27 || n === 3)
        return e;
    }
    return null;
  }
  function ar(e) {
    var n = e.tag;
    if (n === 5 || n === 26 || n === 27 || n === 6) return e.stateNode;
    throw Error(l(33));
  }
  function An(e) {
    var n = e[$o];
    return n || (n = e[$o] = { hoistableStyles: /* @__PURE__ */ new Map(), hoistableScripts: /* @__PURE__ */ new Map() }), n;
  }
  function Zt(e) {
    e[rr] = !0;
  }
  var ga = /* @__PURE__ */ new Set(), $i = {};
  function Rr(e, n) {
    Kr(e, n), Kr(e + "Capture", n);
  }
  function Kr(e, n) {
    for ($i[e] = n, e = 0; e < n.length; e++)
      ga.add(n[e]);
  }
  var ya = RegExp(
    "^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"
  ), Go = {}, Gi = {};
  function wu(e) {
    return Va.call(Gi, e) ? !0 : Va.call(Go, e) ? !1 : ya.test(e) ? Gi[e] = !0 : (Go[e] = !0, !1);
  }
  function ct(e, n, i) {
    if (wu(n))
      if (i === null) e.removeAttribute(n);
      else {
        switch (typeof i) {
          case "undefined":
          case "function":
          case "symbol":
            e.removeAttribute(n);
            return;
          case "boolean":
            var o = n.toLowerCase().slice(0, 5);
            if (o !== "data-" && o !== "aria-") {
              e.removeAttribute(n);
              return;
            }
        }
        e.setAttribute(n, "" + i);
      }
  }
  function Vi(e, n, i) {
    if (i === null) e.removeAttribute(n);
    else {
      switch (typeof i) {
        case "undefined":
        case "function":
        case "symbol":
        case "boolean":
          e.removeAttribute(n);
          return;
      }
      e.setAttribute(n, "" + i);
    }
  }
  function yr(e, n, i, o) {
    if (o === null) e.removeAttribute(i);
    else {
      switch (typeof o) {
        case "undefined":
        case "function":
        case "symbol":
        case "boolean":
          e.removeAttribute(i);
          return;
      }
      e.setAttributeNS(n, i, "" + o);
    }
  }
  function wn(e) {
    switch (typeof e) {
      case "bigint":
      case "boolean":
      case "number":
      case "string":
      case "undefined":
        return e;
      case "object":
        return e;
      default:
        return "";
    }
  }
  function Xa(e) {
    var n = e.type;
    return (e = e.nodeName) && e.toLowerCase() === "input" && (n === "checkbox" || n === "radio");
  }
  function ku(e, n, i) {
    var o = Object.getOwnPropertyDescriptor(
      e.constructor.prototype,
      n
    );
    if (!e.hasOwnProperty(n) && typeof o < "u" && typeof o.get == "function" && typeof o.set == "function") {
      var h = o.get, b = o.set;
      return Object.defineProperty(e, n, {
        configurable: !0,
        get: function() {
          return h.call(this);
        },
        set: function(C) {
          i = "" + C, b.call(this, C);
        }
      }), Object.defineProperty(e, n, {
        enumerable: o.enumerable
      }), {
        getValue: function() {
          return i;
        },
        setValue: function(C) {
          i = "" + C;
        },
        stopTracking: function() {
          e._valueTracker = null, delete e[n];
        }
      };
    }
  }
  function Ll(e) {
    if (!e._valueTracker) {
      var n = Xa(e) ? "checked" : "value";
      e._valueTracker = ku(
        e,
        n,
        "" + e[n]
      );
    }
  }
  function Vo(e) {
    if (!e) return !1;
    var n = e._valueTracker;
    if (!n) return !0;
    var i = n.getValue(), o = "";
    return e && (o = Xa(e) ? e.checked ? "true" : "false" : e.value), e = o, e !== i ? (n.setValue(e), !0) : !1;
  }
  function Et(e) {
    if (e = e || (typeof document < "u" ? document : void 0), typeof e > "u") return null;
    try {
      return e.activeElement || e.body;
    } catch {
      return e.body;
    }
  }
  var Ki = /[\n"\\]/g;
  function gn(e) {
    return e.replace(
      Ki,
      function(n) {
        return "\\" + n.charCodeAt(0).toString(16) + " ";
      }
    );
  }
  function Yr(e, n, i, o, h, b, C, T) {
    e.name = "", C != null && typeof C != "function" && typeof C != "symbol" && typeof C != "boolean" ? e.type = C : e.removeAttribute("type"), n != null ? C === "number" ? (n === 0 && e.value === "" || e.value != n) && (e.value = "" + wn(n)) : e.value !== "" + wn(n) && (e.value = "" + wn(n)) : C !== "submit" && C !== "reset" || e.removeAttribute("value"), n != null ? Yi(e, C, wn(n)) : i != null ? Yi(e, C, wn(i)) : o != null && e.removeAttribute("value"), h == null && b != null && (e.defaultChecked = !!b), h != null && (e.checked = h && typeof h != "function" && typeof h != "symbol"), T != null && typeof T != "function" && typeof T != "symbol" && typeof T != "boolean" ? e.name = "" + wn(T) : e.removeAttribute("name");
  }
  function Bl(e, n, i, o, h, b, C, T) {
    if (b != null && typeof b != "function" && typeof b != "symbol" && typeof b != "boolean" && (e.type = b), n != null || i != null) {
      if (!(b !== "submit" && b !== "reset" || n != null)) {
        Ll(e);
        return;
      }
      i = i != null ? "" + wn(i) : "", n = n != null ? "" + wn(n) : i, T || n === e.value || (e.value = n), e.defaultValue = n;
    }
    o = o ?? h, o = typeof o != "function" && typeof o != "symbol" && !!o, e.checked = T ? e.checked : !!o, e.defaultChecked = !!o, C != null && typeof C != "function" && typeof C != "symbol" && typeof C != "boolean" && (e.name = C), Ll(e);
  }
  function Yi(e, n, i) {
    n === "number" && Et(e.ownerDocument) === e || e.defaultValue === "" + i || (e.defaultValue = "" + i);
  }
  function Or(e, n, i, o) {
    if (e = e.options, n) {
      n = {};
      for (var h = 0; h < i.length; h++)
        n["$" + i[h]] = !0;
      for (i = 0; i < e.length; i++)
        h = n.hasOwnProperty("$" + e[i].value), e[i].selected !== h && (e[i].selected = h), h && o && (e[i].defaultSelected = !0);
    } else {
      for (i = "" + wn(i), n = null, h = 0; h < e.length; h++) {
        if (e[h].value === i) {
          e[h].selected = !0, o && (e[h].defaultSelected = !0);
          return;
        }
        n !== null || e[h].disabled || (n = e[h]);
      }
      n !== null && (n.selected = !0);
    }
  }
  function Ko(e, n, i) {
    if (n != null && (n = "" + wn(n), n !== e.value && (e.value = n), i == null)) {
      e.defaultValue !== n && (e.defaultValue = n);
      return;
    }
    e.defaultValue = i != null ? "" + wn(i) : "";
  }
  function Qi(e, n, i, o) {
    if (n == null) {
      if (o != null) {
        if (i != null) throw Error(l(92));
        if (je(o)) {
          if (1 < o.length) throw Error(l(93));
          o = o[0];
        }
        i = o;
      }
      i == null && (i = ""), n = i;
    }
    i = wn(n), e.defaultValue = i, o = e.textContent, o === i && o !== "" && o !== null && (e.value = o), Ll(e);
  }
  function ba(e, n) {
    if (n) {
      var i = e.firstChild;
      if (i && i === e.lastChild && i.nodeType === 3) {
        i.nodeValue = n;
        return;
      }
    }
    e.textContent = n;
  }
  var wd = new Set(
    "animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(
      " "
    )
  );
  function yt(e, n, i) {
    var o = n.indexOf("--") === 0;
    i == null || typeof i == "boolean" || i === "" ? o ? e.setProperty(n, "") : n === "float" ? e.cssFloat = "" : e[n] = "" : o ? e.setProperty(n, i) : typeof i != "number" || i === 0 || wd.has(n) ? n === "float" ? e.cssFloat = i : e[n] = ("" + i).trim() : e[n] = i + "px";
  }
  function Yo(e, n, i) {
    if (n != null && typeof n != "object")
      throw Error(l(62));
    if (e = e.style, i != null) {
      for (var o in i)
        !i.hasOwnProperty(o) || n != null && n.hasOwnProperty(o) || (o.indexOf("--") === 0 ? e.setProperty(o, "") : o === "float" ? e.cssFloat = "" : e[o] = "");
      for (var h in n)
        o = n[h], n.hasOwnProperty(h) && i[h] !== o && yt(e, h, o);
    } else
      for (var b in n)
        n.hasOwnProperty(b) && yt(e, b, n[b]);
  }
  function Qo(e) {
    if (e.indexOf("-") === -1) return !1;
    switch (e) {
      case "annotation-xml":
      case "color-profile":
      case "font-face":
      case "font-face-src":
      case "font-face-uri":
      case "font-face-format":
      case "font-face-name":
      case "missing-glyph":
        return !1;
      default:
        return !0;
    }
  }
  var kd = /* @__PURE__ */ new Map([
    ["acceptCharset", "accept-charset"],
    ["htmlFor", "for"],
    ["httpEquiv", "http-equiv"],
    ["crossOrigin", "crossorigin"],
    ["accentHeight", "accent-height"],
    ["alignmentBaseline", "alignment-baseline"],
    ["arabicForm", "arabic-form"],
    ["baselineShift", "baseline-shift"],
    ["capHeight", "cap-height"],
    ["clipPath", "clip-path"],
    ["clipRule", "clip-rule"],
    ["colorInterpolation", "color-interpolation"],
    ["colorInterpolationFilters", "color-interpolation-filters"],
    ["colorProfile", "color-profile"],
    ["colorRendering", "color-rendering"],
    ["dominantBaseline", "dominant-baseline"],
    ["enableBackground", "enable-background"],
    ["fillOpacity", "fill-opacity"],
    ["fillRule", "fill-rule"],
    ["floodColor", "flood-color"],
    ["floodOpacity", "flood-opacity"],
    ["fontFamily", "font-family"],
    ["fontSize", "font-size"],
    ["fontSizeAdjust", "font-size-adjust"],
    ["fontStretch", "font-stretch"],
    ["fontStyle", "font-style"],
    ["fontVariant", "font-variant"],
    ["fontWeight", "font-weight"],
    ["glyphName", "glyph-name"],
    ["glyphOrientationHorizontal", "glyph-orientation-horizontal"],
    ["glyphOrientationVertical", "glyph-orientation-vertical"],
    ["horizAdvX", "horiz-adv-x"],
    ["horizOriginX", "horiz-origin-x"],
    ["imageRendering", "image-rendering"],
    ["letterSpacing", "letter-spacing"],
    ["lightingColor", "lighting-color"],
    ["markerEnd", "marker-end"],
    ["markerMid", "marker-mid"],
    ["markerStart", "marker-start"],
    ["overlinePosition", "overline-position"],
    ["overlineThickness", "overline-thickness"],
    ["paintOrder", "paint-order"],
    ["panose-1", "panose-1"],
    ["pointerEvents", "pointer-events"],
    ["renderingIntent", "rendering-intent"],
    ["shapeRendering", "shape-rendering"],
    ["stopColor", "stop-color"],
    ["stopOpacity", "stop-opacity"],
    ["strikethroughPosition", "strikethrough-position"],
    ["strikethroughThickness", "strikethrough-thickness"],
    ["strokeDasharray", "stroke-dasharray"],
    ["strokeDashoffset", "stroke-dashoffset"],
    ["strokeLinecap", "stroke-linecap"],
    ["strokeLinejoin", "stroke-linejoin"],
    ["strokeMiterlimit", "stroke-miterlimit"],
    ["strokeOpacity", "stroke-opacity"],
    ["strokeWidth", "stroke-width"],
    ["textAnchor", "text-anchor"],
    ["textDecoration", "text-decoration"],
    ["textRendering", "text-rendering"],
    ["transformOrigin", "transform-origin"],
    ["underlinePosition", "underline-position"],
    ["underlineThickness", "underline-thickness"],
    ["unicodeBidi", "unicode-bidi"],
    ["unicodeRange", "unicode-range"],
    ["unitsPerEm", "units-per-em"],
    ["vAlphabetic", "v-alphabetic"],
    ["vHanging", "v-hanging"],
    ["vIdeographic", "v-ideographic"],
    ["vMathematical", "v-mathematical"],
    ["vectorEffect", "vector-effect"],
    ["vertAdvY", "vert-adv-y"],
    ["vertOriginX", "vert-origin-x"],
    ["vertOriginY", "vert-origin-y"],
    ["wordSpacing", "word-spacing"],
    ["writingMode", "writing-mode"],
    ["xmlnsXlink", "xmlns:xlink"],
    ["xHeight", "x-height"]
  ]), Un = /^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;
  function Dr(e) {
    return Un.test("" + e) ? "javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')" : e;
  }
  function Gn() {
  }
  var br = null;
  function Il(e) {
    return e = e.target || e.srcElement || window, e.correspondingUseElement && (e = e.correspondingUseElement), e.nodeType === 3 ? e.parentNode : e;
  }
  var xa = null, Pt = null;
  function ir(e) {
    var n = Tt(e);
    if (n && (e = n.stateNode)) {
      var i = e[Wt] || null;
      e: switch (e = n.stateNode, n.type) {
        case "input":
          if (Yr(
            e,
            i.value,
            i.defaultValue,
            i.defaultValue,
            i.checked,
            i.defaultChecked,
            i.type,
            i.name
          ), n = i.name, i.type === "radio" && n != null) {
            for (i = e; i.parentNode; ) i = i.parentNode;
            for (i = i.querySelectorAll(
              'input[name="' + gn(
                "" + n
              ) + '"][type="radio"]'
            ), n = 0; n < i.length; n++) {
              var o = i[n];
              if (o !== e && o.form === e.form) {
                var h = o[Wt] || null;
                if (!h) throw Error(l(90));
                Yr(
                  o,
                  h.value,
                  h.defaultValue,
                  h.defaultValue,
                  h.checked,
                  h.defaultChecked,
                  h.type,
                  h.name
                );
              }
            }
            for (n = 0; n < i.length; n++)
              o = i[n], o.form === e.form && Vo(o);
          }
          break e;
        case "textarea":
          Ko(e, i.value, i.defaultValue);
          break e;
        case "select":
          n = i.value, n != null && Or(e, !!i.multiple, n, !1);
      }
    }
  }
  var va = !1;
  function Wa(e, n, i) {
    if (va) return e(n, i);
    va = !0;
    try {
      var o = e(n);
      return o;
    } finally {
      if (va = !1, (xa !== null || Pt !== null) && (fc(), xa && (n = xa, e = Pt, Pt = xa = null, ir(n), e)))
        for (n = 0; n < e.length; n++) ir(e[n]);
    }
  }
  function Sa(e, n) {
    var i = e.stateNode;
    if (i === null) return null;
    var o = i[Wt] || null;
    if (o === null) return null;
    i = o[n];
    e: switch (n) {
      case "onClick":
      case "onClickCapture":
      case "onDoubleClick":
      case "onDoubleClickCapture":
      case "onMouseDown":
      case "onMouseDownCapture":
      case "onMouseMove":
      case "onMouseMoveCapture":
      case "onMouseUp":
      case "onMouseUpCapture":
      case "onMouseEnter":
        (o = !o.disabled) || (e = e.type, o = !(e === "button" || e === "input" || e === "select" || e === "textarea")), e = !o;
        break e;
      default:
        e = !1;
    }
    if (e) return null;
    if (i && typeof i != "function")
      throw Error(
        l(231, n, typeof i)
      );
    return i;
  }
  var yn = !(typeof window > "u" || typeof window.document > "u" || typeof window.document.createElement > "u"), Xo = !1;
  if (yn)
    try {
      var Mn = {};
      Object.defineProperty(Mn, "passive", {
        get: function() {
          Xo = !0;
        }
      }), window.addEventListener("test", Mn, Mn), window.removeEventListener("test", Mn, Mn);
    } catch {
      Xo = !1;
    }
  var xr = null, Ul = null, Za = null;
  function Ja() {
    if (Za) return Za;
    var e, n = Ul, i = n.length, o, h = "value" in xr ? xr.value : xr.textContent, b = h.length;
    for (e = 0; e < i && n[e] === h[e]; e++) ;
    var C = i - e;
    for (o = 1; o <= C && n[i - o] === h[b - o]; o++) ;
    return Za = h.slice(e, 1 < o ? 1 - o : void 0);
  }
  function ei(e) {
    var n = e.keyCode;
    return "charCode" in e ? (e = e.charCode, e === 0 && n === 13 && (e = 13)) : e = n, e === 10 && (e = 13), 32 <= e || e === 13 ? e : 0;
  }
  function Xi() {
    return !0;
  }
  function Cu() {
    return !1;
  }
  function rn(e) {
    function n(i, o, h, b, C) {
      this._reactName = i, this._targetInst = h, this.type = o, this.nativeEvent = b, this.target = C, this.currentTarget = null;
      for (var T in e)
        e.hasOwnProperty(T) && (i = e[T], this[T] = i ? i(b) : b[T]);
      return this.isDefaultPrevented = (b.defaultPrevented != null ? b.defaultPrevented : b.returnValue === !1) ? Xi : Cu, this.isPropagationStopped = Cu, this;
    }
    return x(n.prototype, {
      preventDefault: function() {
        this.defaultPrevented = !0;
        var i = this.nativeEvent;
        i && (i.preventDefault ? i.preventDefault() : typeof i.returnValue != "unknown" && (i.returnValue = !1), this.isDefaultPrevented = Xi);
      },
      stopPropagation: function() {
        var i = this.nativeEvent;
        i && (i.stopPropagation ? i.stopPropagation() : typeof i.cancelBubble != "unknown" && (i.cancelBubble = !0), this.isPropagationStopped = Xi);
      },
      persist: function() {
      },
      isPersistent: Xi
    }), n;
  }
  var wa = {
    eventPhase: 0,
    bubbles: 0,
    cancelable: 0,
    timeStamp: function(e) {
      return e.timeStamp || Date.now();
    },
    defaultPrevented: 0,
    isTrusted: 0
  }, Pl = rn(wa), Qr = x({}, wa, { view: 0, detail: 0 }), ql = rn(Qr), Wi, Wo, Zi, Hl = x({}, Qr, {
    screenX: 0,
    screenY: 0,
    clientX: 0,
    clientY: 0,
    pageX: 0,
    pageY: 0,
    ctrlKey: 0,
    shiftKey: 0,
    altKey: 0,
    metaKey: 0,
    getModifierState: ka,
    button: 0,
    buttons: 0,
    relatedTarget: function(e) {
      return e.relatedTarget === void 0 ? e.fromElement === e.srcElement ? e.toElement : e.fromElement : e.relatedTarget;
    },
    movementX: function(e) {
      return "movementX" in e ? e.movementX : (e !== Zi && (Zi && e.type === "mousemove" ? (Wi = e.screenX - Zi.screenX, Wo = e.screenY - Zi.screenY) : Wo = Wi = 0, Zi = e), Wi);
    },
    movementY: function(e) {
      return "movementY" in e ? e.movementY : Wo;
    }
  }), Fl = rn(Hl), Zo = x({}, Hl, { dataTransfer: 0 }), Eu = rn(Zo), $l = x({}, Qr, { relatedTarget: 0 }), ti = rn($l), Gl = x({}, wa, {
    animationName: 0,
    elapsedTime: 0,
    pseudoElement: 0
  }), ju = rn(Gl), Cd = x({}, wa, {
    clipboardData: function(e) {
      return "clipboardData" in e ? e.clipboardData : window.clipboardData;
    }
  }), ni = rn(Cd), Jo = x({}, wa, { data: 0 }), Vl = rn(Jo), es = {
    Esc: "Escape",
    Spacebar: " ",
    Left: "ArrowLeft",
    Up: "ArrowUp",
    Right: "ArrowRight",
    Down: "ArrowDown",
    Del: "Delete",
    Win: "OS",
    Menu: "ContextMenu",
    Apps: "ContextMenu",
    Scroll: "ScrollLock",
    MozPrintableKey: "Unidentified"
  }, ts = {
    8: "Backspace",
    9: "Tab",
    12: "Clear",
    13: "Enter",
    16: "Shift",
    17: "Control",
    18: "Alt",
    19: "Pause",
    20: "CapsLock",
    27: "Escape",
    32: " ",
    33: "PageUp",
    34: "PageDown",
    35: "End",
    36: "Home",
    37: "ArrowLeft",
    38: "ArrowUp",
    39: "ArrowRight",
    40: "ArrowDown",
    45: "Insert",
    46: "Delete",
    112: "F1",
    113: "F2",
    114: "F3",
    115: "F4",
    116: "F5",
    117: "F6",
    118: "F7",
    119: "F8",
    120: "F9",
    121: "F10",
    122: "F11",
    123: "F12",
    144: "NumLock",
    145: "ScrollLock",
    224: "Meta"
  }, bn = {
    Alt: "altKey",
    Control: "ctrlKey",
    Meta: "metaKey",
    Shift: "shiftKey"
  };
  function Ji(e) {
    var n = this.nativeEvent;
    return n.getModifierState ? n.getModifierState(e) : (e = bn[e]) ? !!n[e] : !1;
  }
  function ka() {
    return Ji;
  }
  var _u = x({}, Qr, {
    key: function(e) {
      if (e.key) {
        var n = es[e.key] || e.key;
        if (n !== "Unidentified") return n;
      }
      return e.type === "keypress" ? (e = ei(e), e === 13 ? "Enter" : String.fromCharCode(e)) : e.type === "keydown" || e.type === "keyup" ? ts[e.keyCode] || "Unidentified" : "";
    },
    code: 0,
    location: 0,
    ctrlKey: 0,
    shiftKey: 0,
    altKey: 0,
    metaKey: 0,
    repeat: 0,
    locale: 0,
    getModifierState: ka,
    charCode: function(e) {
      return e.type === "keypress" ? ei(e) : 0;
    },
    keyCode: function(e) {
      return e.type === "keydown" || e.type === "keyup" ? e.keyCode : 0;
    },
    which: function(e) {
      return e.type === "keypress" ? ei(e) : e.type === "keydown" || e.type === "keyup" ? e.keyCode : 0;
    }
  }), Kl = rn(_u), Nu = x({}, Hl, {
    pointerId: 0,
    width: 0,
    height: 0,
    pressure: 0,
    tangentialPressure: 0,
    tiltX: 0,
    tiltY: 0,
    twist: 0,
    pointerType: 0,
    isPrimary: 0
  }), ns = rn(Nu), Yl = x({}, Qr, {
    touches: 0,
    targetTouches: 0,
    changedTouches: 0,
    altKey: 0,
    metaKey: 0,
    ctrlKey: 0,
    shiftKey: 0,
    getModifierState: ka
  }), rs = rn(Yl), Ca = x({}, wa, {
    propertyName: 0,
    elapsedTime: 0,
    pseudoElement: 0
  }), as = rn(Ca), is = x({}, Hl, {
    deltaX: function(e) {
      return "deltaX" in e ? e.deltaX : "wheelDeltaX" in e ? -e.wheelDeltaX : 0;
    },
    deltaY: function(e) {
      return "deltaY" in e ? e.deltaY : "wheelDeltaY" in e ? -e.wheelDeltaY : "wheelDelta" in e ? -e.wheelDelta : 0;
    },
    deltaZ: 0,
    deltaMode: 0
  }), Ql = rn(is), ls = x({}, wa, {
    newState: 0,
    oldState: 0
  }), Tu = rn(ls), Ed = [9, 13, 27, 32], el = yn && "CompositionEvent" in window, Xr = null;
  yn && "documentMode" in document && (Xr = document.documentMode);
  var jd = yn && "TextEvent" in window && !Xr, Xl = yn && (!el || Xr && 8 < Xr && 11 >= Xr), Wl = " ", Au = !1;
  function os(e, n) {
    switch (e) {
      case "keyup":
        return Ed.indexOf(n.keyCode) !== -1;
      case "keydown":
        return n.keyCode !== 229;
      case "keypress":
      case "mousedown":
      case "focusout":
        return !0;
      default:
        return !1;
    }
  }
  function Mu(e) {
    return e = e.detail, typeof e == "object" && "data" in e ? e.data : null;
  }
  var Ea = !1;
  function zu(e, n) {
    switch (e) {
      case "compositionend":
        return Mu(n);
      case "keypress":
        return n.which !== 32 ? null : (Au = !0, Wl);
      case "textInput":
        return e = n.data, e === Wl && Au ? null : e;
      default:
        return null;
    }
  }
  function _d(e, n) {
    if (Ea)
      return e === "compositionend" || !el && os(e, n) ? (e = Ja(), Za = Ul = xr = null, Ea = !1, e) : null;
    switch (e) {
      case "paste":
        return null;
      case "keypress":
        if (!(n.ctrlKey || n.altKey || n.metaKey) || n.ctrlKey && n.altKey) {
          if (n.char && 1 < n.char.length)
            return n.char;
          if (n.which) return String.fromCharCode(n.which);
        }
        return null;
      case "compositionend":
        return Xl && n.locale !== "ko" ? null : n.data;
      default:
        return null;
    }
  }
  var Ru = {
    color: !0,
    date: !0,
    datetime: !0,
    "datetime-local": !0,
    email: !0,
    month: !0,
    number: !0,
    password: !0,
    range: !0,
    search: !0,
    tel: !0,
    text: !0,
    time: !0,
    url: !0,
    week: !0
  };
  function Zl(e) {
    var n = e && e.nodeName && e.nodeName.toLowerCase();
    return n === "input" ? !!Ru[e.type] : n === "textarea";
  }
  function ss(e, n, i, o) {
    xa ? Pt ? Pt.push(o) : Pt = [o] : xa = o, n = xc(n, "onChange"), 0 < n.length && (i = new Pl(
      "onChange",
      "change",
      null,
      i,
      o
    ), e.push({ event: i, listeners: n }));
  }
  var ri = null, tl = null;
  function Nd(e) {
    N0(e, 0);
  }
  function Jl(e) {
    var n = ar(e);
    if (Vo(n)) return e;
  }
  function nl(e, n) {
    if (e === "change") return n;
  }
  var vr = !1;
  if (yn) {
    var qt;
    if (yn) {
      var ai = "oninput" in document;
      if (!ai) {
        var Pn = document.createElement("div");
        Pn.setAttribute("oninput", "return;"), ai = typeof Pn.oninput == "function";
      }
      qt = ai;
    } else qt = !1;
    vr = qt && (!document.documentMode || 9 < document.documentMode);
  }
  function Ou() {
    ri && (ri.detachEvent("onpropertychange", eo), tl = ri = null);
  }
  function eo(e) {
    if (e.propertyName === "value" && Jl(tl)) {
      var n = [];
      ss(
        n,
        tl,
        e,
        Il(e)
      ), Wa(Nd, n);
    }
  }
  function Du(e, n, i) {
    e === "focusin" ? (Ou(), ri = n, tl = i, ri.attachEvent("onpropertychange", eo)) : e === "focusout" && Ou();
  }
  function ja(e) {
    if (e === "selectionchange" || e === "keyup" || e === "keydown")
      return Jl(tl);
  }
  function us(e, n) {
    if (e === "click") return Jl(n);
  }
  function ii(e, n) {
    if (e === "input" || e === "change")
      return Jl(n);
  }
  function Wr(e, n) {
    return e === n && (e !== 0 || 1 / e === 1 / n) || e !== e && n !== n;
  }
  var zn = typeof Object.is == "function" ? Object.is : Wr;
  function f(e, n) {
    if (zn(e, n)) return !0;
    if (typeof e != "object" || e === null || typeof n != "object" || n === null)
      return !1;
    var i = Object.keys(e), o = Object.keys(n);
    if (i.length !== o.length) return !1;
    for (o = 0; o < i.length; o++) {
      var h = i[o];
      if (!Va.call(n, h) || !zn(e[h], n[h]))
        return !1;
    }
    return !0;
  }
  function y(e) {
    for (; e && e.firstChild; ) e = e.firstChild;
    return e;
  }
  function S(e, n) {
    var i = y(e);
    e = 0;
    for (var o; i; ) {
      if (i.nodeType === 3) {
        if (o = e + i.textContent.length, e <= n && o >= n)
          return { node: i, offset: n - e };
        e = o;
      }
      e: {
        for (; i; ) {
          if (i.nextSibling) {
            i = i.nextSibling;
            break e;
          }
          i = i.parentNode;
        }
        i = void 0;
      }
      i = y(i);
    }
  }
  function k(e, n) {
    return e && n ? e === n ? !0 : e && e.nodeType === 3 ? !1 : n && n.nodeType === 3 ? k(e, n.parentNode) : "contains" in e ? e.contains(n) : e.compareDocumentPosition ? !!(e.compareDocumentPosition(n) & 16) : !1 : !1;
  }
  function j(e) {
    e = e != null && e.ownerDocument != null && e.ownerDocument.defaultView != null ? e.ownerDocument.defaultView : window;
    for (var n = Et(e.document); n instanceof e.HTMLIFrameElement; ) {
      try {
        var i = typeof n.contentWindow.location.href == "string";
      } catch {
        i = !1;
      }
      if (i) e = n.contentWindow;
      else break;
      n = Et(e.document);
    }
    return n;
  }
  function N(e) {
    var n = e && e.nodeName && e.nodeName.toLowerCase();
    return n && (n === "input" && (e.type === "text" || e.type === "search" || e.type === "tel" || e.type === "url" || e.type === "password") || n === "textarea" || e.contentEditable === "true");
  }
  var z = yn && "documentMode" in document && 11 >= document.documentMode, B = null, H = null, F = null, J = !1;
  function q(e, n, i) {
    var o = i.window === i ? i.document : i.nodeType === 9 ? i : i.ownerDocument;
    J || B == null || B !== Et(o) || (o = B, "selectionStart" in o && N(o) ? o = { start: o.selectionStart, end: o.selectionEnd } : (o = (o.ownerDocument && o.ownerDocument.defaultView || window).getSelection(), o = {
      anchorNode: o.anchorNode,
      anchorOffset: o.anchorOffset,
      focusNode: o.focusNode,
      focusOffset: o.focusOffset
    }), F && f(F, o) || (F = o, o = xc(H, "onSelect"), 0 < o.length && (n = new Pl(
      "onSelect",
      "select",
      null,
      n,
      i
    ), e.push({ event: n, listeners: o }), n.target = B)));
  }
  function te(e, n) {
    var i = {};
    return i[e.toLowerCase()] = n.toLowerCase(), i["Webkit" + e] = "webkit" + n, i["Moz" + e] = "moz" + n, i;
  }
  var $ = {
    animationend: te("Animation", "AnimationEnd"),
    animationiteration: te("Animation", "AnimationIteration"),
    animationstart: te("Animation", "AnimationStart"),
    transitionrun: te("Transition", "TransitionRun"),
    transitionstart: te("Transition", "TransitionStart"),
    transitioncancel: te("Transition", "TransitionCancel"),
    transitionend: te("Transition", "TransitionEnd")
  }, Y = {}, Q = {};
  yn && (Q = document.createElement("div").style, "AnimationEvent" in window || (delete $.animationend.animation, delete $.animationiteration.animation, delete $.animationstart.animation), "TransitionEvent" in window || delete $.transitionend.transition);
  function ee(e) {
    if (Y[e]) return Y[e];
    if (!$[e]) return e;
    var n = $[e], i;
    for (i in n)
      if (n.hasOwnProperty(i) && i in Q)
        return Y[e] = n[i];
    return e;
  }
  var ae = ee("animationend"), ue = ee("animationiteration"), xe = ee("animationstart"), Ce = ee("transitionrun"), De = ee("transitionstart"), qe = ee("transitioncancel"), Ae = ee("transitionend"), Le = /* @__PURE__ */ new Map(), Pe = "abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(
    " "
  );
  Pe.push("scrollEnd");
  function Me(e, n) {
    Le.set(e, n), Rr(n, [e]);
  }
  var $e = typeof reportError == "function" ? reportError : function(e) {
    if (typeof window == "object" && typeof window.ErrorEvent == "function") {
      var n = new window.ErrorEvent("error", {
        bubbles: !0,
        cancelable: !0,
        message: typeof e == "object" && e !== null && typeof e.message == "string" ? String(e.message) : String(e),
        error: e
      });
      if (!window.dispatchEvent(n)) return;
    } else if (typeof process == "object" && typeof process.emit == "function") {
      process.emit("uncaughtException", e);
      return;
    }
    console.error(e);
  }, We = [], rt = 0, lt = 0;
  function xn() {
    for (var e = rt, n = lt = rt = 0; n < e; ) {
      var i = We[n];
      We[n++] = null;
      var o = We[n];
      We[n++] = null;
      var h = We[n];
      We[n++] = null;
      var b = We[n];
      if (We[n++] = null, o !== null && h !== null) {
        var C = o.pending;
        C === null ? h.next = h : (h.next = C.next, C.next = h), o.pending = h;
      }
      b !== 0 && rl(i, h, b);
    }
  }
  function nt(e, n, i, o) {
    We[rt++] = e, We[rt++] = n, We[rt++] = i, We[rt++] = o, lt |= o, e.lanes |= o, e = e.alternate, e !== null && (e.lanes |= o);
  }
  function an(e, n, i, o) {
    return nt(e, n, i, o), ln(e);
  }
  function $t(e, n) {
    return nt(e, null, null, n), ln(e);
  }
  function rl(e, n, i) {
    e.lanes |= i;
    var o = e.alternate;
    o !== null && (o.lanes |= i);
    for (var h = !1, b = e.return; b !== null; )
      b.childLanes |= i, o = b.alternate, o !== null && (o.childLanes |= i), b.tag === 22 && (e = b.stateNode, e === null || e._visibility & 1 || (h = !0)), e = b, b = b.return;
    return e.tag === 3 ? (b = e.stateNode, h && n !== null && (h = 31 - Be(i), e = b.hiddenUpdates, o = e[h], o === null ? e[h] = [n] : o.push(n), n.lane = i | 536870912), b) : null;
  }
  function ln(e) {
    if (50 < zs)
      throw zs = 0, If = null, Error(l(185));
    for (var n = e.return; n !== null; )
      e = n, n = e.return;
    return e.tag === 3 ? e.stateNode : null;
  }
  var Vn = {};
  function cs(e, n, i, o) {
    this.tag = e, this.key = i, this.sibling = this.child = this.return = this.stateNode = this.type = this.elementType = null, this.index = 0, this.refCleanup = this.ref = null, this.pendingProps = n, this.dependencies = this.memoizedState = this.updateQueue = this.memoizedProps = null, this.mode = o, this.subtreeFlags = this.flags = 0, this.deletions = null, this.childLanes = this.lanes = 0, this.alternate = null;
  }
  function lr(e, n, i, o) {
    return new cs(e, n, i, o);
  }
  function Td(e) {
    return e = e.prototype, !(!e || !e.isReactComponent);
  }
  function _a(e, n) {
    var i = e.alternate;
    return i === null ? (i = lr(
      e.tag,
      n,
      e.key,
      e.mode
    ), i.elementType = e.elementType, i.type = e.type, i.stateNode = e.stateNode, i.alternate = e, e.alternate = i) : (i.pendingProps = n, i.type = e.type, i.flags = 0, i.subtreeFlags = 0, i.deletions = null), i.flags = e.flags & 65011712, i.childLanes = e.childLanes, i.lanes = e.lanes, i.child = e.child, i.memoizedProps = e.memoizedProps, i.memoizedState = e.memoizedState, i.updateQueue = e.updateQueue, n = e.dependencies, i.dependencies = n === null ? null : { lanes: n.lanes, firstContext: n.firstContext }, i.sibling = e.sibling, i.index = e.index, i.ref = e.ref, i.refCleanup = e.refCleanup, i;
  }
  function cp(e, n) {
    e.flags &= 65011714;
    var i = e.alternate;
    return i === null ? (e.childLanes = 0, e.lanes = n, e.child = null, e.subtreeFlags = 0, e.memoizedProps = null, e.memoizedState = null, e.updateQueue = null, e.dependencies = null, e.stateNode = null) : (e.childLanes = i.childLanes, e.lanes = i.lanes, e.child = i.child, e.subtreeFlags = 0, e.deletions = null, e.memoizedProps = i.memoizedProps, e.memoizedState = i.memoizedState, e.updateQueue = i.updateQueue, e.type = i.type, n = i.dependencies, e.dependencies = n === null ? null : {
      lanes: n.lanes,
      firstContext: n.firstContext
    }), e;
  }
  function Lu(e, n, i, o, h, b) {
    var C = 0;
    if (o = e, typeof e == "function") Td(e) && (C = 1);
    else if (typeof e == "string")
      C = gv(
        e,
        i,
        Ie.current
      ) ? 26 : e === "html" || e === "head" || e === "body" ? 27 : 5;
    else
      e: switch (e) {
        case Te:
          return e = lr(31, i, n, h), e.elementType = Te, e.lanes = b, e;
        case A:
          return al(i.children, h, b, n);
        case D:
          C = 8, h |= 24;
          break;
        case R:
          return e = lr(12, i, n, h | 2), e.elementType = R, e.lanes = b, e;
        case de:
          return e = lr(13, i, n, h), e.elementType = de, e.lanes = b, e;
        case I:
          return e = lr(19, i, n, h), e.elementType = I, e.lanes = b, e;
        default:
          if (typeof e == "object" && e !== null)
            switch (e.$$typeof) {
              case K:
                C = 10;
                break e;
              case Z:
                C = 9;
                break e;
              case ge:
                C = 11;
                break e;
              case V:
                C = 14;
                break e;
              case we:
                C = 16, o = null;
                break e;
            }
          C = 29, i = Error(
            l(130, e === null ? "null" : typeof e, "")
          ), o = null;
      }
    return n = lr(C, i, n, h), n.elementType = e, n.type = o, n.lanes = b, n;
  }
  function al(e, n, i, o) {
    return e = lr(7, e, o, n), e.lanes = i, e;
  }
  function Ad(e, n, i) {
    return e = lr(6, e, null, n), e.lanes = i, e;
  }
  function dp(e) {
    var n = lr(18, null, null, 0);
    return n.stateNode = e, n;
  }
  function Md(e, n, i) {
    return n = lr(
      4,
      e.children !== null ? e.children : [],
      e.key,
      n
    ), n.lanes = i, n.stateNode = {
      containerInfo: e.containerInfo,
      pendingChildren: null,
      implementation: e.implementation
    }, n;
  }
  var fp = /* @__PURE__ */ new WeakMap();
  function Sr(e, n) {
    if (typeof e == "object" && e !== null) {
      var i = fp.get(e);
      return i !== void 0 ? i : (n = {
        value: e,
        source: n,
        stack: zl(n)
      }, fp.set(e, n), n);
    }
    return {
      value: e,
      source: n,
      stack: zl(n)
    };
  }
  var to = [], no = 0, Bu = null, ds = 0, wr = [], kr = 0, li = null, Zr = 1, Jr = "";
  function Na(e, n) {
    to[no++] = ds, to[no++] = Bu, Bu = e, ds = n;
  }
  function hp(e, n, i) {
    wr[kr++] = Zr, wr[kr++] = Jr, wr[kr++] = li, li = e;
    var o = Zr;
    e = Jr;
    var h = 32 - Be(o) - 1;
    o &= ~(1 << h), i += 1;
    var b = 32 - Be(n) + h;
    if (30 < b) {
      var C = h - h % 5;
      b = (o & (1 << C) - 1).toString(32), o >>= C, h -= C, Zr = 1 << 32 - Be(n) + h | i << h | o, Jr = b + e;
    } else
      Zr = 1 << b | i << h | o, Jr = e;
  }
  function zd(e) {
    e.return !== null && (Na(e, 1), hp(e, 1, 0));
  }
  function Rd(e) {
    for (; e === Bu; )
      Bu = to[--no], to[no] = null, ds = to[--no], to[no] = null;
    for (; e === li; )
      li = wr[--kr], wr[kr] = null, Jr = wr[--kr], wr[kr] = null, Zr = wr[--kr], wr[kr] = null;
  }
  function mp(e, n) {
    wr[kr++] = Zr, wr[kr++] = Jr, wr[kr++] = li, Zr = n.id, Jr = n.overflow, li = e;
  }
  var kn = null, Ht = null, bt = !1, oi = null, Cr = !1, Od = Error(l(519));
  function si(e) {
    var n = Error(
      l(
        418,
        1 < arguments.length && arguments[1] !== void 0 && arguments[1] ? "text" : "HTML",
        ""
      )
    );
    throw fs(Sr(n, e)), Od;
  }
  function pp(e) {
    var n = e.stateNode, i = e.type, o = e.memoizedProps;
    switch (n[Bt] = e, n[Wt] = o, i) {
      case "dialog":
        ft("cancel", n), ft("close", n);
        break;
      case "iframe":
      case "object":
      case "embed":
        ft("load", n);
        break;
      case "video":
      case "audio":
        for (i = 0; i < Os.length; i++)
          ft(Os[i], n);
        break;
      case "source":
        ft("error", n);
        break;
      case "img":
      case "image":
      case "link":
        ft("error", n), ft("load", n);
        break;
      case "details":
        ft("toggle", n);
        break;
      case "input":
        ft("invalid", n), Bl(
          n,
          o.value,
          o.defaultValue,
          o.checked,
          o.defaultChecked,
          o.type,
          o.name,
          !0
        );
        break;
      case "select":
        ft("invalid", n);
        break;
      case "textarea":
        ft("invalid", n), Qi(n, o.value, o.defaultValue, o.children);
    }
    i = o.children, typeof i != "string" && typeof i != "number" && typeof i != "bigint" || n.textContent === "" + i || o.suppressHydrationWarning === !0 || z0(n.textContent, i) ? (o.popover != null && (ft("beforetoggle", n), ft("toggle", n)), o.onScroll != null && ft("scroll", n), o.onScrollEnd != null && ft("scrollend", n), o.onClick != null && (n.onclick = Gn), n = !0) : n = !1, n || si(e, !0);
  }
  function gp(e) {
    for (kn = e.return; kn; )
      switch (kn.tag) {
        case 5:
        case 31:
        case 13:
          Cr = !1;
          return;
        case 27:
        case 3:
          Cr = !0;
          return;
        default:
          kn = kn.return;
      }
  }
  function ro(e) {
    if (e !== kn) return !1;
    if (!bt) return gp(e), bt = !0, !1;
    var n = e.tag, i;
    if ((i = n !== 3 && n !== 27) && ((i = n === 5) && (i = e.type, i = !(i !== "form" && i !== "button") || Jf(e.type, e.memoizedProps)), i = !i), i && Ht && si(e), gp(e), n === 13) {
      if (e = e.memoizedState, e = e !== null ? e.dehydrated : null, !e) throw Error(l(317));
      Ht = q0(e);
    } else if (n === 31) {
      if (e = e.memoizedState, e = e !== null ? e.dehydrated : null, !e) throw Error(l(317));
      Ht = q0(e);
    } else
      n === 27 ? (n = Ht, wi(e.type) ? (e = ah, ah = null, Ht = e) : Ht = n) : Ht = kn ? jr(e.stateNode.nextSibling) : null;
    return !0;
  }
  function il() {
    Ht = kn = null, bt = !1;
  }
  function Dd() {
    var e = oi;
    return e !== null && (Xn === null ? Xn = e : Xn.push.apply(
      Xn,
      e
    ), oi = null), e;
  }
  function fs(e) {
    oi === null ? oi = [e] : oi.push(e);
  }
  var Ld = L(null), ll = null, Ta = null;
  function ui(e, n, i) {
    M(Ld, n._currentValue), n._currentValue = i;
  }
  function Aa(e) {
    e._currentValue = Ld.current, he(Ld);
  }
  function Bd(e, n, i) {
    for (; e !== null; ) {
      var o = e.alternate;
      if ((e.childLanes & n) !== n ? (e.childLanes |= n, o !== null && (o.childLanes |= n)) : o !== null && (o.childLanes & n) !== n && (o.childLanes |= n), e === i) break;
      e = e.return;
    }
  }
  function Id(e, n, i, o) {
    var h = e.child;
    for (h !== null && (h.return = e); h !== null; ) {
      var b = h.dependencies;
      if (b !== null) {
        var C = h.child;
        b = b.firstContext;
        e: for (; b !== null; ) {
          var T = b;
          b = h;
          for (var P = 0; P < n.length; P++)
            if (T.context === n[P]) {
              b.lanes |= i, T = b.alternate, T !== null && (T.lanes |= i), Bd(
                b.return,
                i,
                e
              ), o || (C = null);
              break e;
            }
          b = T.next;
        }
      } else if (h.tag === 18) {
        if (C = h.return, C === null) throw Error(l(341));
        C.lanes |= i, b = C.alternate, b !== null && (b.lanes |= i), Bd(C, i, e), C = null;
      } else C = h.child;
      if (C !== null) C.return = h;
      else
        for (C = h; C !== null; ) {
          if (C === e) {
            C = null;
            break;
          }
          if (h = C.sibling, h !== null) {
            h.return = C.return, C = h;
            break;
          }
          C = C.return;
        }
      h = C;
    }
  }
  function ao(e, n, i, o) {
    e = null;
    for (var h = n, b = !1; h !== null; ) {
      if (!b) {
        if ((h.flags & 524288) !== 0) b = !0;
        else if ((h.flags & 262144) !== 0) break;
      }
      if (h.tag === 10) {
        var C = h.alternate;
        if (C === null) throw Error(l(387));
        if (C = C.memoizedProps, C !== null) {
          var T = h.type;
          zn(h.pendingProps.value, C.value) || (e !== null ? e.push(T) : e = [T]);
        }
      } else if (h === me.current) {
        if (C = h.alternate, C === null) throw Error(l(387));
        C.memoizedState.memoizedState !== h.memoizedState.memoizedState && (e !== null ? e.push(Us) : e = [Us]);
      }
      h = h.return;
    }
    e !== null && Id(
      n,
      e,
      i,
      o
    ), n.flags |= 262144;
  }
  function Iu(e) {
    for (e = e.firstContext; e !== null; ) {
      if (!zn(
        e.context._currentValue,
        e.memoizedValue
      ))
        return !0;
      e = e.next;
    }
    return !1;
  }
  function ol(e) {
    ll = e, Ta = null, e = e.dependencies, e !== null && (e.firstContext = null);
  }
  function Cn(e) {
    return yp(ll, e);
  }
  function Uu(e, n) {
    return ll === null && ol(e), yp(e, n);
  }
  function yp(e, n) {
    var i = n._currentValue;
    if (n = { context: n, memoizedValue: i, next: null }, Ta === null) {
      if (e === null) throw Error(l(308));
      Ta = n, e.dependencies = { lanes: 0, firstContext: n }, e.flags |= 524288;
    } else Ta = Ta.next = n;
    return i;
  }
  var f2 = typeof AbortController < "u" ? AbortController : function() {
    var e = [], n = this.signal = {
      aborted: !1,
      addEventListener: function(i, o) {
        e.push(o);
      }
    };
    this.abort = function() {
      n.aborted = !0, e.forEach(function(i) {
        return i();
      });
    };
  }, h2 = t.unstable_scheduleCallback, m2 = t.unstable_NormalPriority, on = {
    $$typeof: K,
    Consumer: null,
    Provider: null,
    _currentValue: null,
    _currentValue2: null,
    _threadCount: 0
  };
  function Ud() {
    return {
      controller: new f2(),
      data: /* @__PURE__ */ new Map(),
      refCount: 0
    };
  }
  function hs(e) {
    e.refCount--, e.refCount === 0 && h2(m2, function() {
      e.controller.abort();
    });
  }
  var ms = null, Pd = 0, io = 0, lo = null;
  function p2(e, n) {
    if (ms === null) {
      var i = ms = [];
      Pd = 0, io = $f(), lo = {
        status: "pending",
        value: void 0,
        then: function(o) {
          i.push(o);
        }
      };
    }
    return Pd++, n.then(bp, bp), n;
  }
  function bp() {
    if (--Pd === 0 && ms !== null) {
      lo !== null && (lo.status = "fulfilled");
      var e = ms;
      ms = null, io = 0, lo = null;
      for (var n = 0; n < e.length; n++) (0, e[n])();
    }
  }
  function g2(e, n) {
    var i = [], o = {
      status: "pending",
      value: null,
      reason: null,
      then: function(h) {
        i.push(h);
      }
    };
    return e.then(
      function() {
        o.status = "fulfilled", o.value = n;
        for (var h = 0; h < i.length; h++) (0, i[h])(n);
      },
      function(h) {
        for (o.status = "rejected", o.reason = h, h = 0; h < i.length; h++)
          (0, i[h])(void 0);
      }
    ), o;
  }
  var xp = re.S;
  re.S = function(e, n) {
    n0 = mn(), typeof n == "object" && n !== null && typeof n.then == "function" && p2(e, n), xp !== null && xp(e, n);
  };
  var sl = L(null);
  function qd() {
    var e = sl.current;
    return e !== null ? e : Dt.pooledCache;
  }
  function Pu(e, n) {
    n === null ? M(sl, sl.current) : M(sl, n.pool);
  }
  function vp() {
    var e = qd();
    return e === null ? null : { parent: on._currentValue, pool: e };
  }
  var oo = Error(l(460)), Hd = Error(l(474)), qu = Error(l(542)), Hu = { then: function() {
  } };
  function Sp(e) {
    return e = e.status, e === "fulfilled" || e === "rejected";
  }
  function wp(e, n, i) {
    switch (i = e[i], i === void 0 ? e.push(n) : i !== n && (n.then(Gn, Gn), n = i), n.status) {
      case "fulfilled":
        return n.value;
      case "rejected":
        throw e = n.reason, Cp(e), e;
      default:
        if (typeof n.status == "string") n.then(Gn, Gn);
        else {
          if (e = Dt, e !== null && 100 < e.shellSuspendCounter)
            throw Error(l(482));
          e = n, e.status = "pending", e.then(
            function(o) {
              if (n.status === "pending") {
                var h = n;
                h.status = "fulfilled", h.value = o;
              }
            },
            function(o) {
              if (n.status === "pending") {
                var h = n;
                h.status = "rejected", h.reason = o;
              }
            }
          );
        }
        switch (n.status) {
          case "fulfilled":
            return n.value;
          case "rejected":
            throw e = n.reason, Cp(e), e;
        }
        throw cl = n, oo;
    }
  }
  function ul(e) {
    try {
      var n = e._init;
      return n(e._payload);
    } catch (i) {
      throw i !== null && typeof i == "object" && typeof i.then == "function" ? (cl = i, oo) : i;
    }
  }
  var cl = null;
  function kp() {
    if (cl === null) throw Error(l(459));
    var e = cl;
    return cl = null, e;
  }
  function Cp(e) {
    if (e === oo || e === qu)
      throw Error(l(483));
  }
  var so = null, ps = 0;
  function Fu(e) {
    var n = ps;
    return ps += 1, so === null && (so = []), wp(so, e, n);
  }
  function gs(e, n) {
    n = n.props.ref, e.ref = n !== void 0 ? n : null;
  }
  function $u(e, n) {
    throw n.$$typeof === E ? Error(l(525)) : (e = Object.prototype.toString.call(n), Error(
      l(
        31,
        e === "[object Object]" ? "object with keys {" + Object.keys(n).join(", ") + "}" : e
      )
    ));
  }
  function Ep(e) {
    function n(ne, G) {
      if (e) {
        var ie = ne.deletions;
        ie === null ? (ne.deletions = [G], ne.flags |= 16) : ie.push(G);
      }
    }
    function i(ne, G) {
      if (!e) return null;
      for (; G !== null; )
        n(ne, G), G = G.sibling;
      return null;
    }
    function o(ne) {
      for (var G = /* @__PURE__ */ new Map(); ne !== null; )
        ne.key !== null ? G.set(ne.key, ne) : G.set(ne.index, ne), ne = ne.sibling;
      return G;
    }
    function h(ne, G) {
      return ne = _a(ne, G), ne.index = 0, ne.sibling = null, ne;
    }
    function b(ne, G, ie) {
      return ne.index = ie, e ? (ie = ne.alternate, ie !== null ? (ie = ie.index, ie < G ? (ne.flags |= 67108866, G) : ie) : (ne.flags |= 67108866, G)) : (ne.flags |= 1048576, G);
    }
    function C(ne) {
      return e && ne.alternate === null && (ne.flags |= 67108866), ne;
    }
    function T(ne, G, ie, ke) {
      return G === null || G.tag !== 6 ? (G = Ad(ie, ne.mode, ke), G.return = ne, G) : (G = h(G, ie), G.return = ne, G);
    }
    function P(ne, G, ie, ke) {
      var Ze = ie.type;
      return Ze === A ? Se(
        ne,
        G,
        ie.props.children,
        ke,
        ie.key
      ) : G !== null && (G.elementType === Ze || typeof Ze == "object" && Ze !== null && Ze.$$typeof === we && ul(Ze) === G.type) ? (G = h(G, ie.props), gs(G, ie), G.return = ne, G) : (G = Lu(
        ie.type,
        ie.key,
        ie.props,
        null,
        ne.mode,
        ke
      ), gs(G, ie), G.return = ne, G);
    }
    function le(ne, G, ie, ke) {
      return G === null || G.tag !== 4 || G.stateNode.containerInfo !== ie.containerInfo || G.stateNode.implementation !== ie.implementation ? (G = Md(ie, ne.mode, ke), G.return = ne, G) : (G = h(G, ie.children || []), G.return = ne, G);
    }
    function Se(ne, G, ie, ke, Ze) {
      return G === null || G.tag !== 7 ? (G = al(
        ie,
        ne.mode,
        ke,
        Ze
      ), G.return = ne, G) : (G = h(G, ie), G.return = ne, G);
    }
    function Ee(ne, G, ie) {
      if (typeof G == "string" && G !== "" || typeof G == "number" || typeof G == "bigint")
        return G = Ad(
          "" + G,
          ne.mode,
          ie
        ), G.return = ne, G;
      if (typeof G == "object" && G !== null) {
        switch (G.$$typeof) {
          case w:
            return ie = Lu(
              G.type,
              G.key,
              G.props,
              null,
              ne.mode,
              ie
            ), gs(ie, G), ie.return = ne, ie;
          case _:
            return G = Md(
              G,
              ne.mode,
              ie
            ), G.return = ne, G;
          case we:
            return G = ul(G), Ee(ne, G, ie);
        }
        if (je(G) || se(G))
          return G = al(
            G,
            ne.mode,
            ie,
            null
          ), G.return = ne, G;
        if (typeof G.then == "function")
          return Ee(ne, Fu(G), ie);
        if (G.$$typeof === K)
          return Ee(
            ne,
            Uu(ne, G),
            ie
          );
        $u(ne, G);
      }
      return null;
    }
    function ce(ne, G, ie, ke) {
      var Ze = G !== null ? G.key : null;
      if (typeof ie == "string" && ie !== "" || typeof ie == "number" || typeof ie == "bigint")
        return Ze !== null ? null : T(ne, G, "" + ie, ke);
      if (typeof ie == "object" && ie !== null) {
        switch (ie.$$typeof) {
          case w:
            return ie.key === Ze ? P(ne, G, ie, ke) : null;
          case _:
            return ie.key === Ze ? le(ne, G, ie, ke) : null;
          case we:
            return ie = ul(ie), ce(ne, G, ie, ke);
        }
        if (je(ie) || se(ie))
          return Ze !== null ? null : Se(ne, G, ie, ke, null);
        if (typeof ie.then == "function")
          return ce(
            ne,
            G,
            Fu(ie),
            ke
          );
        if (ie.$$typeof === K)
          return ce(
            ne,
            G,
            Uu(ne, ie),
            ke
          );
        $u(ne, ie);
      }
      return null;
    }
    function pe(ne, G, ie, ke, Ze) {
      if (typeof ke == "string" && ke !== "" || typeof ke == "number" || typeof ke == "bigint")
        return ne = ne.get(ie) || null, T(G, ne, "" + ke, Ze);
      if (typeof ke == "object" && ke !== null) {
        switch (ke.$$typeof) {
          case w:
            return ne = ne.get(
              ke.key === null ? ie : ke.key
            ) || null, P(G, ne, ke, Ze);
          case _:
            return ne = ne.get(
              ke.key === null ? ie : ke.key
            ) || null, le(G, ne, ke, Ze);
          case we:
            return ke = ul(ke), pe(
              ne,
              G,
              ie,
              ke,
              Ze
            );
        }
        if (je(ke) || se(ke))
          return ne = ne.get(ie) || null, Se(G, ne, ke, Ze, null);
        if (typeof ke.then == "function")
          return pe(
            ne,
            G,
            ie,
            Fu(ke),
            Ze
          );
        if (ke.$$typeof === K)
          return pe(
            ne,
            G,
            ie,
            Uu(G, ke),
            Ze
          );
        $u(G, ke);
      }
      return null;
    }
    function Ve(ne, G, ie, ke) {
      for (var Ze = null, kt = null, Qe = G, st = G = 0, gt = null; Qe !== null && st < ie.length; st++) {
        Qe.index > st ? (gt = Qe, Qe = null) : gt = Qe.sibling;
        var Ct = ce(
          ne,
          Qe,
          ie[st],
          ke
        );
        if (Ct === null) {
          Qe === null && (Qe = gt);
          break;
        }
        e && Qe && Ct.alternate === null && n(ne, Qe), G = b(Ct, G, st), kt === null ? Ze = Ct : kt.sibling = Ct, kt = Ct, Qe = gt;
      }
      if (st === ie.length)
        return i(ne, Qe), bt && Na(ne, st), Ze;
      if (Qe === null) {
        for (; st < ie.length; st++)
          Qe = Ee(ne, ie[st], ke), Qe !== null && (G = b(
            Qe,
            G,
            st
          ), kt === null ? Ze = Qe : kt.sibling = Qe, kt = Qe);
        return bt && Na(ne, st), Ze;
      }
      for (Qe = o(Qe); st < ie.length; st++)
        gt = pe(
          Qe,
          ne,
          st,
          ie[st],
          ke
        ), gt !== null && (e && gt.alternate !== null && Qe.delete(
          gt.key === null ? st : gt.key
        ), G = b(
          gt,
          G,
          st
        ), kt === null ? Ze = gt : kt.sibling = gt, kt = gt);
      return e && Qe.forEach(function(_i) {
        return n(ne, _i);
      }), bt && Na(ne, st), Ze;
    }
    function tt(ne, G, ie, ke) {
      if (ie == null) throw Error(l(151));
      for (var Ze = null, kt = null, Qe = G, st = G = 0, gt = null, Ct = ie.next(); Qe !== null && !Ct.done; st++, Ct = ie.next()) {
        Qe.index > st ? (gt = Qe, Qe = null) : gt = Qe.sibling;
        var _i = ce(ne, Qe, Ct.value, ke);
        if (_i === null) {
          Qe === null && (Qe = gt);
          break;
        }
        e && Qe && _i.alternate === null && n(ne, Qe), G = b(_i, G, st), kt === null ? Ze = _i : kt.sibling = _i, kt = _i, Qe = gt;
      }
      if (Ct.done)
        return i(ne, Qe), bt && Na(ne, st), Ze;
      if (Qe === null) {
        for (; !Ct.done; st++, Ct = ie.next())
          Ct = Ee(ne, Ct.value, ke), Ct !== null && (G = b(Ct, G, st), kt === null ? Ze = Ct : kt.sibling = Ct, kt = Ct);
        return bt && Na(ne, st), Ze;
      }
      for (Qe = o(Qe); !Ct.done; st++, Ct = ie.next())
        Ct = pe(Qe, ne, st, Ct.value, ke), Ct !== null && (e && Ct.alternate !== null && Qe.delete(Ct.key === null ? st : Ct.key), G = b(Ct, G, st), kt === null ? Ze = Ct : kt.sibling = Ct, kt = Ct);
      return e && Qe.forEach(function(_v) {
        return n(ne, _v);
      }), bt && Na(ne, st), Ze;
    }
    function zt(ne, G, ie, ke) {
      if (typeof ie == "object" && ie !== null && ie.type === A && ie.key === null && (ie = ie.props.children), typeof ie == "object" && ie !== null) {
        switch (ie.$$typeof) {
          case w:
            e: {
              for (var Ze = ie.key; G !== null; ) {
                if (G.key === Ze) {
                  if (Ze = ie.type, Ze === A) {
                    if (G.tag === 7) {
                      i(
                        ne,
                        G.sibling
                      ), ke = h(
                        G,
                        ie.props.children
                      ), ke.return = ne, ne = ke;
                      break e;
                    }
                  } else if (G.elementType === Ze || typeof Ze == "object" && Ze !== null && Ze.$$typeof === we && ul(Ze) === G.type) {
                    i(
                      ne,
                      G.sibling
                    ), ke = h(G, ie.props), gs(ke, ie), ke.return = ne, ne = ke;
                    break e;
                  }
                  i(ne, G);
                  break;
                } else n(ne, G);
                G = G.sibling;
              }
              ie.type === A ? (ke = al(
                ie.props.children,
                ne.mode,
                ke,
                ie.key
              ), ke.return = ne, ne = ke) : (ke = Lu(
                ie.type,
                ie.key,
                ie.props,
                null,
                ne.mode,
                ke
              ), gs(ke, ie), ke.return = ne, ne = ke);
            }
            return C(ne);
          case _:
            e: {
              for (Ze = ie.key; G !== null; ) {
                if (G.key === Ze)
                  if (G.tag === 4 && G.stateNode.containerInfo === ie.containerInfo && G.stateNode.implementation === ie.implementation) {
                    i(
                      ne,
                      G.sibling
                    ), ke = h(G, ie.children || []), ke.return = ne, ne = ke;
                    break e;
                  } else {
                    i(ne, G);
                    break;
                  }
                else n(ne, G);
                G = G.sibling;
              }
              ke = Md(ie, ne.mode, ke), ke.return = ne, ne = ke;
            }
            return C(ne);
          case we:
            return ie = ul(ie), zt(
              ne,
              G,
              ie,
              ke
            );
        }
        if (je(ie))
          return Ve(
            ne,
            G,
            ie,
            ke
          );
        if (se(ie)) {
          if (Ze = se(ie), typeof Ze != "function") throw Error(l(150));
          return ie = Ze.call(ie), tt(
            ne,
            G,
            ie,
            ke
          );
        }
        if (typeof ie.then == "function")
          return zt(
            ne,
            G,
            Fu(ie),
            ke
          );
        if (ie.$$typeof === K)
          return zt(
            ne,
            G,
            Uu(ne, ie),
            ke
          );
        $u(ne, ie);
      }
      return typeof ie == "string" && ie !== "" || typeof ie == "number" || typeof ie == "bigint" ? (ie = "" + ie, G !== null && G.tag === 6 ? (i(ne, G.sibling), ke = h(G, ie), ke.return = ne, ne = ke) : (i(ne, G), ke = Ad(ie, ne.mode, ke), ke.return = ne, ne = ke), C(ne)) : i(ne, G);
    }
    return function(ne, G, ie, ke) {
      try {
        ps = 0;
        var Ze = zt(
          ne,
          G,
          ie,
          ke
        );
        return so = null, Ze;
      } catch (Qe) {
        if (Qe === oo || Qe === qu) throw Qe;
        var kt = lr(29, Qe, null, ne.mode);
        return kt.lanes = ke, kt.return = ne, kt;
      } finally {
      }
    };
  }
  var dl = Ep(!0), jp = Ep(!1), ci = !1;
  function Fd(e) {
    e.updateQueue = {
      baseState: e.memoizedState,
      firstBaseUpdate: null,
      lastBaseUpdate: null,
      shared: { pending: null, lanes: 0, hiddenCallbacks: null },
      callbacks: null
    };
  }
  function $d(e, n) {
    e = e.updateQueue, n.updateQueue === e && (n.updateQueue = {
      baseState: e.baseState,
      firstBaseUpdate: e.firstBaseUpdate,
      lastBaseUpdate: e.lastBaseUpdate,
      shared: e.shared,
      callbacks: null
    });
  }
  function di(e) {
    return { lane: e, tag: 0, payload: null, callback: null, next: null };
  }
  function fi(e, n, i) {
    var o = e.updateQueue;
    if (o === null) return null;
    if (o = o.shared, (jt & 2) !== 0) {
      var h = o.pending;
      return h === null ? n.next = n : (n.next = h.next, h.next = n), o.pending = n, n = ln(e), rl(e, null, i), n;
    }
    return nt(e, o, n, i), ln(e);
  }
  function ys(e, n, i) {
    if (n = n.updateQueue, n !== null && (n = n.shared, (i & 4194048) !== 0)) {
      var o = n.lanes;
      o &= e.pendingLanes, i |= o, n.lanes = i, Ot(e, i);
    }
  }
  function Gd(e, n) {
    var i = e.updateQueue, o = e.alternate;
    if (o !== null && (o = o.updateQueue, i === o)) {
      var h = null, b = null;
      if (i = i.firstBaseUpdate, i !== null) {
        do {
          var C = {
            lane: i.lane,
            tag: i.tag,
            payload: i.payload,
            callback: null,
            next: null
          };
          b === null ? h = b = C : b = b.next = C, i = i.next;
        } while (i !== null);
        b === null ? h = b = n : b = b.next = n;
      } else h = b = n;
      i = {
        baseState: o.baseState,
        firstBaseUpdate: h,
        lastBaseUpdate: b,
        shared: o.shared,
        callbacks: o.callbacks
      }, e.updateQueue = i;
      return;
    }
    e = i.lastBaseUpdate, e === null ? i.firstBaseUpdate = n : e.next = n, i.lastBaseUpdate = n;
  }
  var Vd = !1;
  function bs() {
    if (Vd) {
      var e = lo;
      if (e !== null) throw e;
    }
  }
  function xs(e, n, i, o) {
    Vd = !1;
    var h = e.updateQueue;
    ci = !1;
    var b = h.firstBaseUpdate, C = h.lastBaseUpdate, T = h.shared.pending;
    if (T !== null) {
      h.shared.pending = null;
      var P = T, le = P.next;
      P.next = null, C === null ? b = le : C.next = le, C = P;
      var Se = e.alternate;
      Se !== null && (Se = Se.updateQueue, T = Se.lastBaseUpdate, T !== C && (T === null ? Se.firstBaseUpdate = le : T.next = le, Se.lastBaseUpdate = P));
    }
    if (b !== null) {
      var Ee = h.baseState;
      C = 0, Se = le = P = null, T = b;
      do {
        var ce = T.lane & -536870913, pe = ce !== T.lane;
        if (pe ? (pt & ce) === ce : (o & ce) === ce) {
          ce !== 0 && ce === io && (Vd = !0), Se !== null && (Se = Se.next = {
            lane: 0,
            tag: T.tag,
            payload: T.payload,
            callback: null,
            next: null
          });
          e: {
            var Ve = e, tt = T;
            ce = n;
            var zt = i;
            switch (tt.tag) {
              case 1:
                if (Ve = tt.payload, typeof Ve == "function") {
                  Ee = Ve.call(zt, Ee, ce);
                  break e;
                }
                Ee = Ve;
                break e;
              case 3:
                Ve.flags = Ve.flags & -65537 | 128;
              case 0:
                if (Ve = tt.payload, ce = typeof Ve == "function" ? Ve.call(zt, Ee, ce) : Ve, ce == null) break e;
                Ee = x({}, Ee, ce);
                break e;
              case 2:
                ci = !0;
            }
          }
          ce = T.callback, ce !== null && (e.flags |= 64, pe && (e.flags |= 8192), pe = h.callbacks, pe === null ? h.callbacks = [ce] : pe.push(ce));
        } else
          pe = {
            lane: ce,
            tag: T.tag,
            payload: T.payload,
            callback: T.callback,
            next: null
          }, Se === null ? (le = Se = pe, P = Ee) : Se = Se.next = pe, C |= ce;
        if (T = T.next, T === null) {
          if (T = h.shared.pending, T === null)
            break;
          pe = T, T = pe.next, pe.next = null, h.lastBaseUpdate = pe, h.shared.pending = null;
        }
      } while (!0);
      Se === null && (P = Ee), h.baseState = P, h.firstBaseUpdate = le, h.lastBaseUpdate = Se, b === null && (h.shared.lanes = 0), yi |= C, e.lanes = C, e.memoizedState = Ee;
    }
  }
  function _p(e, n) {
    if (typeof e != "function")
      throw Error(l(191, e));
    e.call(n);
  }
  function Np(e, n) {
    var i = e.callbacks;
    if (i !== null)
      for (e.callbacks = null, e = 0; e < i.length; e++)
        _p(i[e], n);
  }
  var uo = L(null), Gu = L(0);
  function Tp(e, n) {
    e = Ua, M(Gu, e), M(uo, n), Ua = e | n.baseLanes;
  }
  function Kd() {
    M(Gu, Ua), M(uo, uo.current);
  }
  function Yd() {
    Ua = Gu.current, he(uo), he(Gu);
  }
  var or = L(null), Er = null;
  function hi(e) {
    var n = e.alternate;
    M(Jt, Jt.current & 1), M(or, e), Er === null && (n === null || uo.current !== null || n.memoizedState !== null) && (Er = e);
  }
  function Qd(e) {
    M(Jt, Jt.current), M(or, e), Er === null && (Er = e);
  }
  function Ap(e) {
    e.tag === 22 ? (M(Jt, Jt.current), M(or, e), Er === null && (Er = e)) : mi();
  }
  function mi() {
    M(Jt, Jt.current), M(or, or.current);
  }
  function sr(e) {
    he(or), Er === e && (Er = null), he(Jt);
  }
  var Jt = L(0);
  function Vu(e) {
    for (var n = e; n !== null; ) {
      if (n.tag === 13) {
        var i = n.memoizedState;
        if (i !== null && (i = i.dehydrated, i === null || nh(i) || rh(i)))
          return n;
      } else if (n.tag === 19 && (n.memoizedProps.revealOrder === "forwards" || n.memoizedProps.revealOrder === "backwards" || n.memoizedProps.revealOrder === "unstable_legacy-backwards" || n.memoizedProps.revealOrder === "together")) {
        if ((n.flags & 128) !== 0) return n;
      } else if (n.child !== null) {
        n.child.return = n, n = n.child;
        continue;
      }
      if (n === e) break;
      for (; n.sibling === null; ) {
        if (n.return === null || n.return === e) return null;
        n = n.return;
      }
      n.sibling.return = n.return, n = n.sibling;
    }
    return null;
  }
  var Ma = 0, ot = null, At = null, sn = null, Ku = !1, co = !1, fl = !1, Yu = 0, vs = 0, fo = null, y2 = 0;
  function Yt() {
    throw Error(l(321));
  }
  function Xd(e, n) {
    if (n === null) return !1;
    for (var i = 0; i < n.length && i < e.length; i++)
      if (!zn(e[i], n[i])) return !1;
    return !0;
  }
  function Wd(e, n, i, o, h, b) {
    return Ma = b, ot = n, n.memoizedState = null, n.updateQueue = null, n.lanes = 0, re.H = e === null || e.memoizedState === null ? hg : hf, fl = !1, b = i(o, h), fl = !1, co && (b = zp(
      n,
      i,
      o,
      h
    )), Mp(e), b;
  }
  function Mp(e) {
    re.H = ks;
    var n = At !== null && At.next !== null;
    if (Ma = 0, sn = At = ot = null, Ku = !1, vs = 0, fo = null, n) throw Error(l(300));
    e === null || un || (e = e.dependencies, e !== null && Iu(e) && (un = !0));
  }
  function zp(e, n, i, o) {
    ot = e;
    var h = 0;
    do {
      if (co && (fo = null), vs = 0, co = !1, 25 <= h) throw Error(l(301));
      if (h += 1, sn = At = null, e.updateQueue != null) {
        var b = e.updateQueue;
        b.lastEffect = null, b.events = null, b.stores = null, b.memoCache != null && (b.memoCache.index = 0);
      }
      re.H = mg, b = n(i, o);
    } while (co);
    return b;
  }
  function b2() {
    var e = re.H, n = e.useState()[0];
    return n = typeof n.then == "function" ? Ss(n) : n, e = e.useState()[0], (At !== null ? At.memoizedState : null) !== e && (ot.flags |= 1024), n;
  }
  function Zd() {
    var e = Yu !== 0;
    return Yu = 0, e;
  }
  function Jd(e, n, i) {
    n.updateQueue = e.updateQueue, n.flags &= -2053, e.lanes &= ~i;
  }
  function ef(e) {
    if (Ku) {
      for (e = e.memoizedState; e !== null; ) {
        var n = e.queue;
        n !== null && (n.pending = null), e = e.next;
      }
      Ku = !1;
    }
    Ma = 0, sn = At = ot = null, co = !1, vs = Yu = 0, fo = null;
  }
  function qn() {
    var e = {
      memoizedState: null,
      baseState: null,
      baseQueue: null,
      queue: null,
      next: null
    };
    return sn === null ? ot.memoizedState = sn = e : sn = sn.next = e, sn;
  }
  function en() {
    if (At === null) {
      var e = ot.alternate;
      e = e !== null ? e.memoizedState : null;
    } else e = At.next;
    var n = sn === null ? ot.memoizedState : sn.next;
    if (n !== null)
      sn = n, At = e;
    else {
      if (e === null)
        throw ot.alternate === null ? Error(l(467)) : Error(l(310));
      At = e, e = {
        memoizedState: At.memoizedState,
        baseState: At.baseState,
        baseQueue: At.baseQueue,
        queue: At.queue,
        next: null
      }, sn === null ? ot.memoizedState = sn = e : sn = sn.next = e;
    }
    return sn;
  }
  function Qu() {
    return { lastEffect: null, events: null, stores: null, memoCache: null };
  }
  function Ss(e) {
    var n = vs;
    return vs += 1, fo === null && (fo = []), e = wp(fo, e, n), n = ot, (sn === null ? n.memoizedState : sn.next) === null && (n = n.alternate, re.H = n === null || n.memoizedState === null ? hg : hf), e;
  }
  function Xu(e) {
    if (e !== null && typeof e == "object") {
      if (typeof e.then == "function") return Ss(e);
      if (e.$$typeof === K) return Cn(e);
    }
    throw Error(l(438, String(e)));
  }
  function tf(e) {
    var n = null, i = ot.updateQueue;
    if (i !== null && (n = i.memoCache), n == null) {
      var o = ot.alternate;
      o !== null && (o = o.updateQueue, o !== null && (o = o.memoCache, o != null && (n = {
        data: o.data.map(function(h) {
          return h.slice();
        }),
        index: 0
      })));
    }
    if (n == null && (n = { data: [], index: 0 }), i === null && (i = Qu(), ot.updateQueue = i), i.memoCache = n, i = n.data[n.index], i === void 0)
      for (i = n.data[n.index] = Array(e), o = 0; o < e; o++)
        i[o] = X;
    return n.index++, i;
  }
  function za(e, n) {
    return typeof n == "function" ? n(e) : n;
  }
  function Wu(e) {
    var n = en();
    return nf(n, At, e);
  }
  function nf(e, n, i) {
    var o = e.queue;
    if (o === null) throw Error(l(311));
    o.lastRenderedReducer = i;
    var h = e.baseQueue, b = o.pending;
    if (b !== null) {
      if (h !== null) {
        var C = h.next;
        h.next = b.next, b.next = C;
      }
      n.baseQueue = h = b, o.pending = null;
    }
    if (b = e.baseState, h === null) e.memoizedState = b;
    else {
      n = h.next;
      var T = C = null, P = null, le = n, Se = !1;
      do {
        var Ee = le.lane & -536870913;
        if (Ee !== le.lane ? (pt & Ee) === Ee : (Ma & Ee) === Ee) {
          var ce = le.revertLane;
          if (ce === 0)
            P !== null && (P = P.next = {
              lane: 0,
              revertLane: 0,
              gesture: null,
              action: le.action,
              hasEagerState: le.hasEagerState,
              eagerState: le.eagerState,
              next: null
            }), Ee === io && (Se = !0);
          else if ((Ma & ce) === ce) {
            le = le.next, ce === io && (Se = !0);
            continue;
          } else
            Ee = {
              lane: 0,
              revertLane: le.revertLane,
              gesture: null,
              action: le.action,
              hasEagerState: le.hasEagerState,
              eagerState: le.eagerState,
              next: null
            }, P === null ? (T = P = Ee, C = b) : P = P.next = Ee, ot.lanes |= ce, yi |= ce;
          Ee = le.action, fl && i(b, Ee), b = le.hasEagerState ? le.eagerState : i(b, Ee);
        } else
          ce = {
            lane: Ee,
            revertLane: le.revertLane,
            gesture: le.gesture,
            action: le.action,
            hasEagerState: le.hasEagerState,
            eagerState: le.eagerState,
            next: null
          }, P === null ? (T = P = ce, C = b) : P = P.next = ce, ot.lanes |= Ee, yi |= Ee;
        le = le.next;
      } while (le !== null && le !== n);
      if (P === null ? C = b : P.next = T, !zn(b, e.memoizedState) && (un = !0, Se && (i = lo, i !== null)))
        throw i;
      e.memoizedState = b, e.baseState = C, e.baseQueue = P, o.lastRenderedState = b;
    }
    return h === null && (o.lanes = 0), [e.memoizedState, o.dispatch];
  }
  function rf(e) {
    var n = en(), i = n.queue;
    if (i === null) throw Error(l(311));
    i.lastRenderedReducer = e;
    var o = i.dispatch, h = i.pending, b = n.memoizedState;
    if (h !== null) {
      i.pending = null;
      var C = h = h.next;
      do
        b = e(b, C.action), C = C.next;
      while (C !== h);
      zn(b, n.memoizedState) || (un = !0), n.memoizedState = b, n.baseQueue === null && (n.baseState = b), i.lastRenderedState = b;
    }
    return [b, o];
  }
  function Rp(e, n, i) {
    var o = ot, h = en(), b = bt;
    if (b) {
      if (i === void 0) throw Error(l(407));
      i = i();
    } else i = n();
    var C = !zn(
      (At || h).memoizedState,
      i
    );
    if (C && (h.memoizedState = i, un = !0), h = h.queue, of(Lp.bind(null, o, h, e), [
      e
    ]), h.getSnapshot !== n || C || sn !== null && sn.memoizedState.tag & 1) {
      if (o.flags |= 2048, ho(
        9,
        { destroy: void 0 },
        Dp.bind(
          null,
          o,
          h,
          i,
          n
        ),
        null
      ), Dt === null) throw Error(l(349));
      b || (Ma & 127) !== 0 || Op(o, n, i);
    }
    return i;
  }
  function Op(e, n, i) {
    e.flags |= 16384, e = { getSnapshot: n, value: i }, n = ot.updateQueue, n === null ? (n = Qu(), ot.updateQueue = n, n.stores = [e]) : (i = n.stores, i === null ? n.stores = [e] : i.push(e));
  }
  function Dp(e, n, i, o) {
    n.value = i, n.getSnapshot = o, Bp(n) && Ip(e);
  }
  function Lp(e, n, i) {
    return i(function() {
      Bp(n) && Ip(e);
    });
  }
  function Bp(e) {
    var n = e.getSnapshot;
    e = e.value;
    try {
      var i = n();
      return !zn(e, i);
    } catch {
      return !0;
    }
  }
  function Ip(e) {
    var n = $t(e, 2);
    n !== null && Wn(n, e, 2);
  }
  function af(e) {
    var n = qn();
    if (typeof e == "function") {
      var i = e;
      if (e = i(), fl) {
        Kt(!0);
        try {
          i();
        } finally {
          Kt(!1);
        }
      }
    }
    return n.memoizedState = n.baseState = e, n.queue = {
      pending: null,
      lanes: 0,
      dispatch: null,
      lastRenderedReducer: za,
      lastRenderedState: e
    }, n;
  }
  function Up(e, n, i, o) {
    return e.baseState = i, nf(
      e,
      At,
      typeof o == "function" ? o : za
    );
  }
  function x2(e, n, i, o, h) {
    if (ec(e)) throw Error(l(485));
    if (e = n.action, e !== null) {
      var b = {
        payload: h,
        action: e,
        next: null,
        isTransition: !0,
        status: "pending",
        value: null,
        reason: null,
        listeners: [],
        then: function(C) {
          b.listeners.push(C);
        }
      };
      re.T !== null ? i(!0) : b.isTransition = !1, o(b), i = n.pending, i === null ? (b.next = n.pending = b, Pp(n, b)) : (b.next = i.next, n.pending = i.next = b);
    }
  }
  function Pp(e, n) {
    var i = n.action, o = n.payload, h = e.state;
    if (n.isTransition) {
      var b = re.T, C = {};
      re.T = C;
      try {
        var T = i(h, o), P = re.S;
        P !== null && P(C, T), qp(e, n, T);
      } catch (le) {
        lf(e, n, le);
      } finally {
        b !== null && C.types !== null && (b.types = C.types), re.T = b;
      }
    } else
      try {
        b = i(h, o), qp(e, n, b);
      } catch (le) {
        lf(e, n, le);
      }
  }
  function qp(e, n, i) {
    i !== null && typeof i == "object" && typeof i.then == "function" ? i.then(
      function(o) {
        Hp(e, n, o);
      },
      function(o) {
        return lf(e, n, o);
      }
    ) : Hp(e, n, i);
  }
  function Hp(e, n, i) {
    n.status = "fulfilled", n.value = i, Fp(n), e.state = i, n = e.pending, n !== null && (i = n.next, i === n ? e.pending = null : (i = i.next, n.next = i, Pp(e, i)));
  }
  function lf(e, n, i) {
    var o = e.pending;
    if (e.pending = null, o !== null) {
      o = o.next;
      do
        n.status = "rejected", n.reason = i, Fp(n), n = n.next;
      while (n !== o);
    }
    e.action = null;
  }
  function Fp(e) {
    e = e.listeners;
    for (var n = 0; n < e.length; n++) (0, e[n])();
  }
  function $p(e, n) {
    return n;
  }
  function Gp(e, n) {
    if (bt) {
      var i = Dt.formState;
      if (i !== null) {
        e: {
          var o = ot;
          if (bt) {
            if (Ht) {
              t: {
                for (var h = Ht, b = Cr; h.nodeType !== 8; ) {
                  if (!b) {
                    h = null;
                    break t;
                  }
                  if (h = jr(
                    h.nextSibling
                  ), h === null) {
                    h = null;
                    break t;
                  }
                }
                b = h.data, h = b === "F!" || b === "F" ? h : null;
              }
              if (h) {
                Ht = jr(
                  h.nextSibling
                ), o = h.data === "F!";
                break e;
              }
            }
            si(o);
          }
          o = !1;
        }
        o && (n = i[0]);
      }
    }
    return i = qn(), i.memoizedState = i.baseState = n, o = {
      pending: null,
      lanes: 0,
      dispatch: null,
      lastRenderedReducer: $p,
      lastRenderedState: n
    }, i.queue = o, i = cg.bind(
      null,
      ot,
      o
    ), o.dispatch = i, o = af(!1), b = ff.bind(
      null,
      ot,
      !1,
      o.queue
    ), o = qn(), h = {
      state: n,
      dispatch: null,
      action: e,
      pending: null
    }, o.queue = h, i = x2.bind(
      null,
      ot,
      h,
      b,
      i
    ), h.dispatch = i, o.memoizedState = e, [n, i, !1];
  }
  function Vp(e) {
    var n = en();
    return Kp(n, At, e);
  }
  function Kp(e, n, i) {
    if (n = nf(
      e,
      n,
      $p
    )[0], e = Wu(za)[0], typeof n == "object" && n !== null && typeof n.then == "function")
      try {
        var o = Ss(n);
      } catch (C) {
        throw C === oo ? qu : C;
      }
    else o = n;
    n = en();
    var h = n.queue, b = h.dispatch;
    return i !== n.memoizedState && (ot.flags |= 2048, ho(
      9,
      { destroy: void 0 },
      v2.bind(null, h, i),
      null
    )), [o, b, e];
  }
  function v2(e, n) {
    e.action = n;
  }
  function Yp(e) {
    var n = en(), i = At;
    if (i !== null)
      return Kp(n, i, e);
    en(), n = n.memoizedState, i = en();
    var o = i.queue.dispatch;
    return i.memoizedState = e, [n, o, !1];
  }
  function ho(e, n, i, o) {
    return e = { tag: e, create: i, deps: o, inst: n, next: null }, n = ot.updateQueue, n === null && (n = Qu(), ot.updateQueue = n), i = n.lastEffect, i === null ? n.lastEffect = e.next = e : (o = i.next, i.next = e, e.next = o, n.lastEffect = e), e;
  }
  function Qp() {
    return en().memoizedState;
  }
  function Zu(e, n, i, o) {
    var h = qn();
    ot.flags |= e, h.memoizedState = ho(
      1 | n,
      { destroy: void 0 },
      i,
      o === void 0 ? null : o
    );
  }
  function Ju(e, n, i, o) {
    var h = en();
    o = o === void 0 ? null : o;
    var b = h.memoizedState.inst;
    At !== null && o !== null && Xd(o, At.memoizedState.deps) ? h.memoizedState = ho(n, b, i, o) : (ot.flags |= e, h.memoizedState = ho(
      1 | n,
      b,
      i,
      o
    ));
  }
  function Xp(e, n) {
    Zu(8390656, 8, e, n);
  }
  function of(e, n) {
    Ju(2048, 8, e, n);
  }
  function S2(e) {
    ot.flags |= 4;
    var n = ot.updateQueue;
    if (n === null)
      n = Qu(), ot.updateQueue = n, n.events = [e];
    else {
      var i = n.events;
      i === null ? n.events = [e] : i.push(e);
    }
  }
  function Wp(e) {
    var n = en().memoizedState;
    return S2({ ref: n, nextImpl: e }), function() {
      if ((jt & 2) !== 0) throw Error(l(440));
      return n.impl.apply(void 0, arguments);
    };
  }
  function Zp(e, n) {
    return Ju(4, 2, e, n);
  }
  function Jp(e, n) {
    return Ju(4, 4, e, n);
  }
  function eg(e, n) {
    if (typeof n == "function") {
      e = e();
      var i = n(e);
      return function() {
        typeof i == "function" ? i() : n(null);
      };
    }
    if (n != null)
      return e = e(), n.current = e, function() {
        n.current = null;
      };
  }
  function tg(e, n, i) {
    i = i != null ? i.concat([e]) : null, Ju(4, 4, eg.bind(null, n, e), i);
  }
  function sf() {
  }
  function ng(e, n) {
    var i = en();
    n = n === void 0 ? null : n;
    var o = i.memoizedState;
    return n !== null && Xd(n, o[1]) ? o[0] : (i.memoizedState = [e, n], e);
  }
  function rg(e, n) {
    var i = en();
    n = n === void 0 ? null : n;
    var o = i.memoizedState;
    if (n !== null && Xd(n, o[1]))
      return o[0];
    if (o = e(), fl) {
      Kt(!0);
      try {
        e();
      } finally {
        Kt(!1);
      }
    }
    return i.memoizedState = [o, n], o;
  }
  function uf(e, n, i) {
    return i === void 0 || (Ma & 1073741824) !== 0 && (pt & 261930) === 0 ? e.memoizedState = n : (e.memoizedState = i, e = a0(), ot.lanes |= e, yi |= e, i);
  }
  function ag(e, n, i, o) {
    return zn(i, n) ? i : uo.current !== null ? (e = uf(e, i, o), zn(e, n) || (un = !0), e) : (Ma & 42) === 0 || (Ma & 1073741824) !== 0 && (pt & 261930) === 0 ? (un = !0, e.memoizedState = i) : (e = a0(), ot.lanes |= e, yi |= e, n);
  }
  function ig(e, n, i, o, h) {
    var b = _e.p;
    _e.p = b !== 0 && 8 > b ? b : 8;
    var C = re.T, T = {};
    re.T = T, ff(e, !1, n, i);
    try {
      var P = h(), le = re.S;
      if (le !== null && le(T, P), P !== null && typeof P == "object" && typeof P.then == "function") {
        var Se = g2(
          P,
          o
        );
        ws(
          e,
          n,
          Se,
          dr(e)
        );
      } else
        ws(
          e,
          n,
          o,
          dr(e)
        );
    } catch (Ee) {
      ws(
        e,
        n,
        { then: function() {
        }, status: "rejected", reason: Ee },
        dr()
      );
    } finally {
      _e.p = b, C !== null && T.types !== null && (C.types = T.types), re.T = C;
    }
  }
  function w2() {
  }
  function cf(e, n, i, o) {
    if (e.tag !== 5) throw Error(l(476));
    var h = lg(e).queue;
    ig(
      e,
      h,
      n,
      fe,
      i === null ? w2 : function() {
        return og(e), i(o);
      }
    );
  }
  function lg(e) {
    var n = e.memoizedState;
    if (n !== null) return n;
    n = {
      memoizedState: fe,
      baseState: fe,
      baseQueue: null,
      queue: {
        pending: null,
        lanes: 0,
        dispatch: null,
        lastRenderedReducer: za,
        lastRenderedState: fe
      },
      next: null
    };
    var i = {};
    return n.next = {
      memoizedState: i,
      baseState: i,
      baseQueue: null,
      queue: {
        pending: null,
        lanes: 0,
        dispatch: null,
        lastRenderedReducer: za,
        lastRenderedState: i
      },
      next: null
    }, e.memoizedState = n, e = e.alternate, e !== null && (e.memoizedState = n), n;
  }
  function og(e) {
    var n = lg(e);
    n.next === null && (n = e.alternate.memoizedState), ws(
      e,
      n.next.queue,
      {},
      dr()
    );
  }
  function df() {
    return Cn(Us);
  }
  function sg() {
    return en().memoizedState;
  }
  function ug() {
    return en().memoizedState;
  }
  function k2(e) {
    for (var n = e.return; n !== null; ) {
      switch (n.tag) {
        case 24:
        case 3:
          var i = dr();
          e = di(i);
          var o = fi(n, e, i);
          o !== null && (Wn(o, n, i), ys(o, n, i)), n = { cache: Ud() }, e.payload = n;
          return;
      }
      n = n.return;
    }
  }
  function C2(e, n, i) {
    var o = dr();
    i = {
      lane: o,
      revertLane: 0,
      gesture: null,
      action: i,
      hasEagerState: !1,
      eagerState: null,
      next: null
    }, ec(e) ? dg(n, i) : (i = an(e, n, i, o), i !== null && (Wn(i, e, o), fg(i, n, o)));
  }
  function cg(e, n, i) {
    var o = dr();
    ws(e, n, i, o);
  }
  function ws(e, n, i, o) {
    var h = {
      lane: o,
      revertLane: 0,
      gesture: null,
      action: i,
      hasEagerState: !1,
      eagerState: null,
      next: null
    };
    if (ec(e)) dg(n, h);
    else {
      var b = e.alternate;
      if (e.lanes === 0 && (b === null || b.lanes === 0) && (b = n.lastRenderedReducer, b !== null))
        try {
          var C = n.lastRenderedState, T = b(C, i);
          if (h.hasEagerState = !0, h.eagerState = T, zn(T, C))
            return nt(e, n, h, 0), Dt === null && xn(), !1;
        } catch {
        } finally {
        }
      if (i = an(e, n, h, o), i !== null)
        return Wn(i, e, o), fg(i, n, o), !0;
    }
    return !1;
  }
  function ff(e, n, i, o) {
    if (o = {
      lane: 2,
      revertLane: $f(),
      gesture: null,
      action: o,
      hasEagerState: !1,
      eagerState: null,
      next: null
    }, ec(e)) {
      if (n) throw Error(l(479));
    } else
      n = an(
        e,
        i,
        o,
        2
      ), n !== null && Wn(n, e, 2);
  }
  function ec(e) {
    var n = e.alternate;
    return e === ot || n !== null && n === ot;
  }
  function dg(e, n) {
    co = Ku = !0;
    var i = e.pending;
    i === null ? n.next = n : (n.next = i.next, i.next = n), e.pending = n;
  }
  function fg(e, n, i) {
    if ((i & 4194048) !== 0) {
      var o = n.lanes;
      o &= e.pendingLanes, i |= o, n.lanes = i, Ot(e, i);
    }
  }
  var ks = {
    readContext: Cn,
    use: Xu,
    useCallback: Yt,
    useContext: Yt,
    useEffect: Yt,
    useImperativeHandle: Yt,
    useLayoutEffect: Yt,
    useInsertionEffect: Yt,
    useMemo: Yt,
    useReducer: Yt,
    useRef: Yt,
    useState: Yt,
    useDebugValue: Yt,
    useDeferredValue: Yt,
    useTransition: Yt,
    useSyncExternalStore: Yt,
    useId: Yt,
    useHostTransitionStatus: Yt,
    useFormState: Yt,
    useActionState: Yt,
    useOptimistic: Yt,
    useMemoCache: Yt,
    useCacheRefresh: Yt
  };
  ks.useEffectEvent = Yt;
  var hg = {
    readContext: Cn,
    use: Xu,
    useCallback: function(e, n) {
      return qn().memoizedState = [
        e,
        n === void 0 ? null : n
      ], e;
    },
    useContext: Cn,
    useEffect: Xp,
    useImperativeHandle: function(e, n, i) {
      i = i != null ? i.concat([e]) : null, Zu(
        4194308,
        4,
        eg.bind(null, n, e),
        i
      );
    },
    useLayoutEffect: function(e, n) {
      return Zu(4194308, 4, e, n);
    },
    useInsertionEffect: function(e, n) {
      Zu(4, 2, e, n);
    },
    useMemo: function(e, n) {
      var i = qn();
      n = n === void 0 ? null : n;
      var o = e();
      if (fl) {
        Kt(!0);
        try {
          e();
        } finally {
          Kt(!1);
        }
      }
      return i.memoizedState = [o, n], o;
    },
    useReducer: function(e, n, i) {
      var o = qn();
      if (i !== void 0) {
        var h = i(n);
        if (fl) {
          Kt(!0);
          try {
            i(n);
          } finally {
            Kt(!1);
          }
        }
      } else h = n;
      return o.memoizedState = o.baseState = h, e = {
        pending: null,
        lanes: 0,
        dispatch: null,
        lastRenderedReducer: e,
        lastRenderedState: h
      }, o.queue = e, e = e.dispatch = C2.bind(
        null,
        ot,
        e
      ), [o.memoizedState, e];
    },
    useRef: function(e) {
      var n = qn();
      return e = { current: e }, n.memoizedState = e;
    },
    useState: function(e) {
      e = af(e);
      var n = e.queue, i = cg.bind(null, ot, n);
      return n.dispatch = i, [e.memoizedState, i];
    },
    useDebugValue: sf,
    useDeferredValue: function(e, n) {
      var i = qn();
      return uf(i, e, n);
    },
    useTransition: function() {
      var e = af(!1);
      return e = ig.bind(
        null,
        ot,
        e.queue,
        !0,
        !1
      ), qn().memoizedState = e, [!1, e];
    },
    useSyncExternalStore: function(e, n, i) {
      var o = ot, h = qn();
      if (bt) {
        if (i === void 0)
          throw Error(l(407));
        i = i();
      } else {
        if (i = n(), Dt === null)
          throw Error(l(349));
        (pt & 127) !== 0 || Op(o, n, i);
      }
      h.memoizedState = i;
      var b = { value: i, getSnapshot: n };
      return h.queue = b, Xp(Lp.bind(null, o, b, e), [
        e
      ]), o.flags |= 2048, ho(
        9,
        { destroy: void 0 },
        Dp.bind(
          null,
          o,
          b,
          i,
          n
        ),
        null
      ), i;
    },
    useId: function() {
      var e = qn(), n = Dt.identifierPrefix;
      if (bt) {
        var i = Jr, o = Zr;
        i = (o & ~(1 << 32 - Be(o) - 1)).toString(32) + i, n = "_" + n + "R_" + i, i = Yu++, 0 < i && (n += "H" + i.toString(32)), n += "_";
      } else
        i = y2++, n = "_" + n + "r_" + i.toString(32) + "_";
      return e.memoizedState = n;
    },
    useHostTransitionStatus: df,
    useFormState: Gp,
    useActionState: Gp,
    useOptimistic: function(e) {
      var n = qn();
      n.memoizedState = n.baseState = e;
      var i = {
        pending: null,
        lanes: 0,
        dispatch: null,
        lastRenderedReducer: null,
        lastRenderedState: null
      };
      return n.queue = i, n = ff.bind(
        null,
        ot,
        !0,
        i
      ), i.dispatch = n, [e, n];
    },
    useMemoCache: tf,
    useCacheRefresh: function() {
      return qn().memoizedState = k2.bind(
        null,
        ot
      );
    },
    useEffectEvent: function(e) {
      var n = qn(), i = { impl: e };
      return n.memoizedState = i, function() {
        if ((jt & 2) !== 0)
          throw Error(l(440));
        return i.impl.apply(void 0, arguments);
      };
    }
  }, hf = {
    readContext: Cn,
    use: Xu,
    useCallback: ng,
    useContext: Cn,
    useEffect: of,
    useImperativeHandle: tg,
    useInsertionEffect: Zp,
    useLayoutEffect: Jp,
    useMemo: rg,
    useReducer: Wu,
    useRef: Qp,
    useState: function() {
      return Wu(za);
    },
    useDebugValue: sf,
    useDeferredValue: function(e, n) {
      var i = en();
      return ag(
        i,
        At.memoizedState,
        e,
        n
      );
    },
    useTransition: function() {
      var e = Wu(za)[0], n = en().memoizedState;
      return [
        typeof e == "boolean" ? e : Ss(e),
        n
      ];
    },
    useSyncExternalStore: Rp,
    useId: sg,
    useHostTransitionStatus: df,
    useFormState: Vp,
    useActionState: Vp,
    useOptimistic: function(e, n) {
      var i = en();
      return Up(i, At, e, n);
    },
    useMemoCache: tf,
    useCacheRefresh: ug
  };
  hf.useEffectEvent = Wp;
  var mg = {
    readContext: Cn,
    use: Xu,
    useCallback: ng,
    useContext: Cn,
    useEffect: of,
    useImperativeHandle: tg,
    useInsertionEffect: Zp,
    useLayoutEffect: Jp,
    useMemo: rg,
    useReducer: rf,
    useRef: Qp,
    useState: function() {
      return rf(za);
    },
    useDebugValue: sf,
    useDeferredValue: function(e, n) {
      var i = en();
      return At === null ? uf(i, e, n) : ag(
        i,
        At.memoizedState,
        e,
        n
      );
    },
    useTransition: function() {
      var e = rf(za)[0], n = en().memoizedState;
      return [
        typeof e == "boolean" ? e : Ss(e),
        n
      ];
    },
    useSyncExternalStore: Rp,
    useId: sg,
    useHostTransitionStatus: df,
    useFormState: Yp,
    useActionState: Yp,
    useOptimistic: function(e, n) {
      var i = en();
      return At !== null ? Up(i, At, e, n) : (i.baseState = e, [e, i.queue.dispatch]);
    },
    useMemoCache: tf,
    useCacheRefresh: ug
  };
  mg.useEffectEvent = Wp;
  function mf(e, n, i, o) {
    n = e.memoizedState, i = i(o, n), i = i == null ? n : x({}, n, i), e.memoizedState = i, e.lanes === 0 && (e.updateQueue.baseState = i);
  }
  var pf = {
    enqueueSetState: function(e, n, i) {
      e = e._reactInternals;
      var o = dr(), h = di(o);
      h.payload = n, i != null && (h.callback = i), n = fi(e, h, o), n !== null && (Wn(n, e, o), ys(n, e, o));
    },
    enqueueReplaceState: function(e, n, i) {
      e = e._reactInternals;
      var o = dr(), h = di(o);
      h.tag = 1, h.payload = n, i != null && (h.callback = i), n = fi(e, h, o), n !== null && (Wn(n, e, o), ys(n, e, o));
    },
    enqueueForceUpdate: function(e, n) {
      e = e._reactInternals;
      var i = dr(), o = di(i);
      o.tag = 2, n != null && (o.callback = n), n = fi(e, o, i), n !== null && (Wn(n, e, i), ys(n, e, i));
    }
  };
  function pg(e, n, i, o, h, b, C) {
    return e = e.stateNode, typeof e.shouldComponentUpdate == "function" ? e.shouldComponentUpdate(o, b, C) : n.prototype && n.prototype.isPureReactComponent ? !f(i, o) || !f(h, b) : !0;
  }
  function gg(e, n, i, o) {
    e = n.state, typeof n.componentWillReceiveProps == "function" && n.componentWillReceiveProps(i, o), typeof n.UNSAFE_componentWillReceiveProps == "function" && n.UNSAFE_componentWillReceiveProps(i, o), n.state !== e && pf.enqueueReplaceState(n, n.state, null);
  }
  function hl(e, n) {
    var i = n;
    if ("ref" in n) {
      i = {};
      for (var o in n)
        o !== "ref" && (i[o] = n[o]);
    }
    if (e = e.defaultProps) {
      i === n && (i = x({}, i));
      for (var h in e)
        i[h] === void 0 && (i[h] = e[h]);
    }
    return i;
  }
  function yg(e) {
    $e(e);
  }
  function bg(e) {
    console.error(e);
  }
  function xg(e) {
    $e(e);
  }
  function tc(e, n) {
    try {
      var i = e.onUncaughtError;
      i(n.value, { componentStack: n.stack });
    } catch (o) {
      setTimeout(function() {
        throw o;
      });
    }
  }
  function vg(e, n, i) {
    try {
      var o = e.onCaughtError;
      o(i.value, {
        componentStack: i.stack,
        errorBoundary: n.tag === 1 ? n.stateNode : null
      });
    } catch (h) {
      setTimeout(function() {
        throw h;
      });
    }
  }
  function gf(e, n, i) {
    return i = di(i), i.tag = 3, i.payload = { element: null }, i.callback = function() {
      tc(e, n);
    }, i;
  }
  function Sg(e) {
    return e = di(e), e.tag = 3, e;
  }
  function wg(e, n, i, o) {
    var h = i.type.getDerivedStateFromError;
    if (typeof h == "function") {
      var b = o.value;
      e.payload = function() {
        return h(b);
      }, e.callback = function() {
        vg(n, i, o);
      };
    }
    var C = i.stateNode;
    C !== null && typeof C.componentDidCatch == "function" && (e.callback = function() {
      vg(n, i, o), typeof h != "function" && (bi === null ? bi = /* @__PURE__ */ new Set([this]) : bi.add(this));
      var T = o.stack;
      this.componentDidCatch(o.value, {
        componentStack: T !== null ? T : ""
      });
    });
  }
  function E2(e, n, i, o, h) {
    if (i.flags |= 32768, o !== null && typeof o == "object" && typeof o.then == "function") {
      if (n = i.alternate, n !== null && ao(
        n,
        i,
        h,
        !0
      ), i = or.current, i !== null) {
        switch (i.tag) {
          case 31:
          case 13:
            return Er === null ? hc() : i.alternate === null && Qt === 0 && (Qt = 3), i.flags &= -257, i.flags |= 65536, i.lanes = h, o === Hu ? i.flags |= 16384 : (n = i.updateQueue, n === null ? i.updateQueue = /* @__PURE__ */ new Set([o]) : n.add(o), qf(e, o, h)), !1;
          case 22:
            return i.flags |= 65536, o === Hu ? i.flags |= 16384 : (n = i.updateQueue, n === null ? (n = {
              transitions: null,
              markerInstances: null,
              retryQueue: /* @__PURE__ */ new Set([o])
            }, i.updateQueue = n) : (i = n.retryQueue, i === null ? n.retryQueue = /* @__PURE__ */ new Set([o]) : i.add(o)), qf(e, o, h)), !1;
        }
        throw Error(l(435, i.tag));
      }
      return qf(e, o, h), hc(), !1;
    }
    if (bt)
      return n = or.current, n !== null ? ((n.flags & 65536) === 0 && (n.flags |= 256), n.flags |= 65536, n.lanes = h, o !== Od && (e = Error(l(422), { cause: o }), fs(Sr(e, i)))) : (o !== Od && (n = Error(l(423), {
        cause: o
      }), fs(
        Sr(n, i)
      )), e = e.current.alternate, e.flags |= 65536, h &= -h, e.lanes |= h, o = Sr(o, i), h = gf(
        e.stateNode,
        o,
        h
      ), Gd(e, h), Qt !== 4 && (Qt = 2)), !1;
    var b = Error(l(520), { cause: o });
    if (b = Sr(b, i), Ms === null ? Ms = [b] : Ms.push(b), Qt !== 4 && (Qt = 2), n === null) return !0;
    o = Sr(o, i), i = n;
    do {
      switch (i.tag) {
        case 3:
          return i.flags |= 65536, e = h & -h, i.lanes |= e, e = gf(i.stateNode, o, e), Gd(i, e), !1;
        case 1:
          if (n = i.type, b = i.stateNode, (i.flags & 128) === 0 && (typeof n.getDerivedStateFromError == "function" || b !== null && typeof b.componentDidCatch == "function" && (bi === null || !bi.has(b))))
            return i.flags |= 65536, h &= -h, i.lanes |= h, h = Sg(h), wg(
              h,
              e,
              i,
              o
            ), Gd(i, h), !1;
      }
      i = i.return;
    } while (i !== null);
    return !1;
  }
  var yf = Error(l(461)), un = !1;
  function En(e, n, i, o) {
    n.child = e === null ? jp(n, null, i, o) : dl(
      n,
      e.child,
      i,
      o
    );
  }
  function kg(e, n, i, o, h) {
    i = i.render;
    var b = n.ref;
    if ("ref" in o) {
      var C = {};
      for (var T in o)
        T !== "ref" && (C[T] = o[T]);
    } else C = o;
    return ol(n), o = Wd(
      e,
      n,
      i,
      C,
      b,
      h
    ), T = Zd(), e !== null && !un ? (Jd(e, n, h), Ra(e, n, h)) : (bt && T && zd(n), n.flags |= 1, En(e, n, o, h), n.child);
  }
  function Cg(e, n, i, o, h) {
    if (e === null) {
      var b = i.type;
      return typeof b == "function" && !Td(b) && b.defaultProps === void 0 && i.compare === null ? (n.tag = 15, n.type = b, Eg(
        e,
        n,
        b,
        o,
        h
      )) : (e = Lu(
        i.type,
        null,
        o,
        n,
        n.mode,
        h
      ), e.ref = n.ref, e.return = n, n.child = e);
    }
    if (b = e.child, !Ef(e, h)) {
      var C = b.memoizedProps;
      if (i = i.compare, i = i !== null ? i : f, i(C, o) && e.ref === n.ref)
        return Ra(e, n, h);
    }
    return n.flags |= 1, e = _a(b, o), e.ref = n.ref, e.return = n, n.child = e;
  }
  function Eg(e, n, i, o, h) {
    if (e !== null) {
      var b = e.memoizedProps;
      if (f(b, o) && e.ref === n.ref)
        if (un = !1, n.pendingProps = o = b, Ef(e, h))
          (e.flags & 131072) !== 0 && (un = !0);
        else
          return n.lanes = e.lanes, Ra(e, n, h);
    }
    return bf(
      e,
      n,
      i,
      o,
      h
    );
  }
  function jg(e, n, i, o) {
    var h = o.children, b = e !== null ? e.memoizedState : null;
    if (e === null && n.stateNode === null && (n.stateNode = {
      _visibility: 1,
      _pendingMarkers: null,
      _retryCache: null,
      _transitions: null
    }), o.mode === "hidden") {
      if ((n.flags & 128) !== 0) {
        if (b = b !== null ? b.baseLanes | i : i, e !== null) {
          for (o = n.child = e.child, h = 0; o !== null; )
            h = h | o.lanes | o.childLanes, o = o.sibling;
          o = h & ~b;
        } else o = 0, n.child = null;
        return _g(
          e,
          n,
          b,
          i,
          o
        );
      }
      if ((i & 536870912) !== 0)
        n.memoizedState = { baseLanes: 0, cachePool: null }, e !== null && Pu(
          n,
          b !== null ? b.cachePool : null
        ), b !== null ? Tp(n, b) : Kd(), Ap(n);
      else
        return o = n.lanes = 536870912, _g(
          e,
          n,
          b !== null ? b.baseLanes | i : i,
          i,
          o
        );
    } else
      b !== null ? (Pu(n, b.cachePool), Tp(n, b), mi(), n.memoizedState = null) : (e !== null && Pu(n, null), Kd(), mi());
    return En(e, n, h, i), n.child;
  }
  function Cs(e, n) {
    return e !== null && e.tag === 22 || n.stateNode !== null || (n.stateNode = {
      _visibility: 1,
      _pendingMarkers: null,
      _retryCache: null,
      _transitions: null
    }), n.sibling;
  }
  function _g(e, n, i, o, h) {
    var b = qd();
    return b = b === null ? null : { parent: on._currentValue, pool: b }, n.memoizedState = {
      baseLanes: i,
      cachePool: b
    }, e !== null && Pu(n, null), Kd(), Ap(n), e !== null && ao(e, n, o, !0), n.childLanes = h, null;
  }
  function nc(e, n) {
    return n = ac(
      { mode: n.mode, children: n.children },
      e.mode
    ), n.ref = e.ref, e.child = n, n.return = e, n;
  }
  function Ng(e, n, i) {
    return dl(n, e.child, null, i), e = nc(n, n.pendingProps), e.flags |= 2, sr(n), n.memoizedState = null, e;
  }
  function j2(e, n, i) {
    var o = n.pendingProps, h = (n.flags & 128) !== 0;
    if (n.flags &= -129, e === null) {
      if (bt) {
        if (o.mode === "hidden")
          return e = nc(n, o), n.lanes = 536870912, Cs(null, e);
        if (Qd(n), (e = Ht) ? (e = P0(
          e,
          Cr
        ), e = e !== null && e.data === "&" ? e : null, e !== null && (n.memoizedState = {
          dehydrated: e,
          treeContext: li !== null ? { id: Zr, overflow: Jr } : null,
          retryLane: 536870912,
          hydrationErrors: null
        }, i = dp(e), i.return = n, n.child = i, kn = n, Ht = null)) : e = null, e === null) throw si(n);
        return n.lanes = 536870912, null;
      }
      return nc(n, o);
    }
    var b = e.memoizedState;
    if (b !== null) {
      var C = b.dehydrated;
      if (Qd(n), h)
        if (n.flags & 256)
          n.flags &= -257, n = Ng(
            e,
            n,
            i
          );
        else if (n.memoizedState !== null)
          n.child = e.child, n.flags |= 128, n = null;
        else throw Error(l(558));
      else if (un || ao(e, n, i, !1), h = (i & e.childLanes) !== 0, un || h) {
        if (o = Dt, o !== null && (C = Xt(o, i), C !== 0 && C !== b.retryLane))
          throw b.retryLane = C, $t(e, C), Wn(o, e, C), yf;
        hc(), n = Ng(
          e,
          n,
          i
        );
      } else
        e = b.treeContext, Ht = jr(C.nextSibling), kn = n, bt = !0, oi = null, Cr = !1, e !== null && mp(n, e), n = nc(n, o), n.flags |= 4096;
      return n;
    }
    return e = _a(e.child, {
      mode: o.mode,
      children: o.children
    }), e.ref = n.ref, n.child = e, e.return = n, e;
  }
  function rc(e, n) {
    var i = n.ref;
    if (i === null)
      e !== null && e.ref !== null && (n.flags |= 4194816);
    else {
      if (typeof i != "function" && typeof i != "object")
        throw Error(l(284));
      (e === null || e.ref !== i) && (n.flags |= 4194816);
    }
  }
  function bf(e, n, i, o, h) {
    return ol(n), i = Wd(
      e,
      n,
      i,
      o,
      void 0,
      h
    ), o = Zd(), e !== null && !un ? (Jd(e, n, h), Ra(e, n, h)) : (bt && o && zd(n), n.flags |= 1, En(e, n, i, h), n.child);
  }
  function Tg(e, n, i, o, h, b) {
    return ol(n), n.updateQueue = null, i = zp(
      n,
      o,
      i,
      h
    ), Mp(e), o = Zd(), e !== null && !un ? (Jd(e, n, b), Ra(e, n, b)) : (bt && o && zd(n), n.flags |= 1, En(e, n, i, b), n.child);
  }
  function Ag(e, n, i, o, h) {
    if (ol(n), n.stateNode === null) {
      var b = Vn, C = i.contextType;
      typeof C == "object" && C !== null && (b = Cn(C)), b = new i(o, b), n.memoizedState = b.state !== null && b.state !== void 0 ? b.state : null, b.updater = pf, n.stateNode = b, b._reactInternals = n, b = n.stateNode, b.props = o, b.state = n.memoizedState, b.refs = {}, Fd(n), C = i.contextType, b.context = typeof C == "object" && C !== null ? Cn(C) : Vn, b.state = n.memoizedState, C = i.getDerivedStateFromProps, typeof C == "function" && (mf(
        n,
        i,
        C,
        o
      ), b.state = n.memoizedState), typeof i.getDerivedStateFromProps == "function" || typeof b.getSnapshotBeforeUpdate == "function" || typeof b.UNSAFE_componentWillMount != "function" && typeof b.componentWillMount != "function" || (C = b.state, typeof b.componentWillMount == "function" && b.componentWillMount(), typeof b.UNSAFE_componentWillMount == "function" && b.UNSAFE_componentWillMount(), C !== b.state && pf.enqueueReplaceState(b, b.state, null), xs(n, o, b, h), bs(), b.state = n.memoizedState), typeof b.componentDidMount == "function" && (n.flags |= 4194308), o = !0;
    } else if (e === null) {
      b = n.stateNode;
      var T = n.memoizedProps, P = hl(i, T);
      b.props = P;
      var le = b.context, Se = i.contextType;
      C = Vn, typeof Se == "object" && Se !== null && (C = Cn(Se));
      var Ee = i.getDerivedStateFromProps;
      Se = typeof Ee == "function" || typeof b.getSnapshotBeforeUpdate == "function", T = n.pendingProps !== T, Se || typeof b.UNSAFE_componentWillReceiveProps != "function" && typeof b.componentWillReceiveProps != "function" || (T || le !== C) && gg(
        n,
        b,
        o,
        C
      ), ci = !1;
      var ce = n.memoizedState;
      b.state = ce, xs(n, o, b, h), bs(), le = n.memoizedState, T || ce !== le || ci ? (typeof Ee == "function" && (mf(
        n,
        i,
        Ee,
        o
      ), le = n.memoizedState), (P = ci || pg(
        n,
        i,
        P,
        o,
        ce,
        le,
        C
      )) ? (Se || typeof b.UNSAFE_componentWillMount != "function" && typeof b.componentWillMount != "function" || (typeof b.componentWillMount == "function" && b.componentWillMount(), typeof b.UNSAFE_componentWillMount == "function" && b.UNSAFE_componentWillMount()), typeof b.componentDidMount == "function" && (n.flags |= 4194308)) : (typeof b.componentDidMount == "function" && (n.flags |= 4194308), n.memoizedProps = o, n.memoizedState = le), b.props = o, b.state = le, b.context = C, o = P) : (typeof b.componentDidMount == "function" && (n.flags |= 4194308), o = !1);
    } else {
      b = n.stateNode, $d(e, n), C = n.memoizedProps, Se = hl(i, C), b.props = Se, Ee = n.pendingProps, ce = b.context, le = i.contextType, P = Vn, typeof le == "object" && le !== null && (P = Cn(le)), T = i.getDerivedStateFromProps, (le = typeof T == "function" || typeof b.getSnapshotBeforeUpdate == "function") || typeof b.UNSAFE_componentWillReceiveProps != "function" && typeof b.componentWillReceiveProps != "function" || (C !== Ee || ce !== P) && gg(
        n,
        b,
        o,
        P
      ), ci = !1, ce = n.memoizedState, b.state = ce, xs(n, o, b, h), bs();
      var pe = n.memoizedState;
      C !== Ee || ce !== pe || ci || e !== null && e.dependencies !== null && Iu(e.dependencies) ? (typeof T == "function" && (mf(
        n,
        i,
        T,
        o
      ), pe = n.memoizedState), (Se = ci || pg(
        n,
        i,
        Se,
        o,
        ce,
        pe,
        P
      ) || e !== null && e.dependencies !== null && Iu(e.dependencies)) ? (le || typeof b.UNSAFE_componentWillUpdate != "function" && typeof b.componentWillUpdate != "function" || (typeof b.componentWillUpdate == "function" && b.componentWillUpdate(o, pe, P), typeof b.UNSAFE_componentWillUpdate == "function" && b.UNSAFE_componentWillUpdate(
        o,
        pe,
        P
      )), typeof b.componentDidUpdate == "function" && (n.flags |= 4), typeof b.getSnapshotBeforeUpdate == "function" && (n.flags |= 1024)) : (typeof b.componentDidUpdate != "function" || C === e.memoizedProps && ce === e.memoizedState || (n.flags |= 4), typeof b.getSnapshotBeforeUpdate != "function" || C === e.memoizedProps && ce === e.memoizedState || (n.flags |= 1024), n.memoizedProps = o, n.memoizedState = pe), b.props = o, b.state = pe, b.context = P, o = Se) : (typeof b.componentDidUpdate != "function" || C === e.memoizedProps && ce === e.memoizedState || (n.flags |= 4), typeof b.getSnapshotBeforeUpdate != "function" || C === e.memoizedProps && ce === e.memoizedState || (n.flags |= 1024), o = !1);
    }
    return b = o, rc(e, n), o = (n.flags & 128) !== 0, b || o ? (b = n.stateNode, i = o && typeof i.getDerivedStateFromError != "function" ? null : b.render(), n.flags |= 1, e !== null && o ? (n.child = dl(
      n,
      e.child,
      null,
      h
    ), n.child = dl(
      n,
      null,
      i,
      h
    )) : En(e, n, i, h), n.memoizedState = b.state, e = n.child) : e = Ra(
      e,
      n,
      h
    ), e;
  }
  function Mg(e, n, i, o) {
    return il(), n.flags |= 256, En(e, n, i, o), n.child;
  }
  var xf = {
    dehydrated: null,
    treeContext: null,
    retryLane: 0,
    hydrationErrors: null
  };
  function vf(e) {
    return { baseLanes: e, cachePool: vp() };
  }
  function Sf(e, n, i) {
    return e = e !== null ? e.childLanes & ~i : 0, n && (e |= cr), e;
  }
  function zg(e, n, i) {
    var o = n.pendingProps, h = !1, b = (n.flags & 128) !== 0, C;
    if ((C = b) || (C = e !== null && e.memoizedState === null ? !1 : (Jt.current & 2) !== 0), C && (h = !0, n.flags &= -129), C = (n.flags & 32) !== 0, n.flags &= -33, e === null) {
      if (bt) {
        if (h ? hi(n) : mi(), (e = Ht) ? (e = P0(
          e,
          Cr
        ), e = e !== null && e.data !== "&" ? e : null, e !== null && (n.memoizedState = {
          dehydrated: e,
          treeContext: li !== null ? { id: Zr, overflow: Jr } : null,
          retryLane: 536870912,
          hydrationErrors: null
        }, i = dp(e), i.return = n, n.child = i, kn = n, Ht = null)) : e = null, e === null) throw si(n);
        return rh(e) ? n.lanes = 32 : n.lanes = 536870912, null;
      }
      var T = o.children;
      return o = o.fallback, h ? (mi(), h = n.mode, T = ac(
        { mode: "hidden", children: T },
        h
      ), o = al(
        o,
        h,
        i,
        null
      ), T.return = n, o.return = n, T.sibling = o, n.child = T, o = n.child, o.memoizedState = vf(i), o.childLanes = Sf(
        e,
        C,
        i
      ), n.memoizedState = xf, Cs(null, o)) : (hi(n), wf(n, T));
    }
    var P = e.memoizedState;
    if (P !== null && (T = P.dehydrated, T !== null)) {
      if (b)
        n.flags & 256 ? (hi(n), n.flags &= -257, n = kf(
          e,
          n,
          i
        )) : n.memoizedState !== null ? (mi(), n.child = e.child, n.flags |= 128, n = null) : (mi(), T = o.fallback, h = n.mode, o = ac(
          { mode: "visible", children: o.children },
          h
        ), T = al(
          T,
          h,
          i,
          null
        ), T.flags |= 2, o.return = n, T.return = n, o.sibling = T, n.child = o, dl(
          n,
          e.child,
          null,
          i
        ), o = n.child, o.memoizedState = vf(i), o.childLanes = Sf(
          e,
          C,
          i
        ), n.memoizedState = xf, n = Cs(null, o));
      else if (hi(n), rh(T)) {
        if (C = T.nextSibling && T.nextSibling.dataset, C) var le = C.dgst;
        C = le, o = Error(l(419)), o.stack = "", o.digest = C, fs({ value: o, source: null, stack: null }), n = kf(
          e,
          n,
          i
        );
      } else if (un || ao(e, n, i, !1), C = (i & e.childLanes) !== 0, un || C) {
        if (C = Dt, C !== null && (o = Xt(C, i), o !== 0 && o !== P.retryLane))
          throw P.retryLane = o, $t(e, o), Wn(C, e, o), yf;
        nh(T) || hc(), n = kf(
          e,
          n,
          i
        );
      } else
        nh(T) ? (n.flags |= 192, n.child = e.child, n = null) : (e = P.treeContext, Ht = jr(
          T.nextSibling
        ), kn = n, bt = !0, oi = null, Cr = !1, e !== null && mp(n, e), n = wf(
          n,
          o.children
        ), n.flags |= 4096);
      return n;
    }
    return h ? (mi(), T = o.fallback, h = n.mode, P = e.child, le = P.sibling, o = _a(P, {
      mode: "hidden",
      children: o.children
    }), o.subtreeFlags = P.subtreeFlags & 65011712, le !== null ? T = _a(
      le,
      T
    ) : (T = al(
      T,
      h,
      i,
      null
    ), T.flags |= 2), T.return = n, o.return = n, o.sibling = T, n.child = o, Cs(null, o), o = n.child, T = e.child.memoizedState, T === null ? T = vf(i) : (h = T.cachePool, h !== null ? (P = on._currentValue, h = h.parent !== P ? { parent: P, pool: P } : h) : h = vp(), T = {
      baseLanes: T.baseLanes | i,
      cachePool: h
    }), o.memoizedState = T, o.childLanes = Sf(
      e,
      C,
      i
    ), n.memoizedState = xf, Cs(e.child, o)) : (hi(n), i = e.child, e = i.sibling, i = _a(i, {
      mode: "visible",
      children: o.children
    }), i.return = n, i.sibling = null, e !== null && (C = n.deletions, C === null ? (n.deletions = [e], n.flags |= 16) : C.push(e)), n.child = i, n.memoizedState = null, i);
  }
  function wf(e, n) {
    return n = ac(
      { mode: "visible", children: n },
      e.mode
    ), n.return = e, e.child = n;
  }
  function ac(e, n) {
    return e = lr(22, e, null, n), e.lanes = 0, e;
  }
  function kf(e, n, i) {
    return dl(n, e.child, null, i), e = wf(
      n,
      n.pendingProps.children
    ), e.flags |= 2, n.memoizedState = null, e;
  }
  function Rg(e, n, i) {
    e.lanes |= n;
    var o = e.alternate;
    o !== null && (o.lanes |= n), Bd(e.return, n, i);
  }
  function Cf(e, n, i, o, h, b) {
    var C = e.memoizedState;
    C === null ? e.memoizedState = {
      isBackwards: n,
      rendering: null,
      renderingStartTime: 0,
      last: o,
      tail: i,
      tailMode: h,
      treeForkCount: b
    } : (C.isBackwards = n, C.rendering = null, C.renderingStartTime = 0, C.last = o, C.tail = i, C.tailMode = h, C.treeForkCount = b);
  }
  function Og(e, n, i) {
    var o = n.pendingProps, h = o.revealOrder, b = o.tail;
    o = o.children;
    var C = Jt.current, T = (C & 2) !== 0;
    if (T ? (C = C & 1 | 2, n.flags |= 128) : C &= 1, M(Jt, C), En(e, n, o, i), o = bt ? ds : 0, !T && e !== null && (e.flags & 128) !== 0)
      e: for (e = n.child; e !== null; ) {
        if (e.tag === 13)
          e.memoizedState !== null && Rg(e, i, n);
        else if (e.tag === 19)
          Rg(e, i, n);
        else if (e.child !== null) {
          e.child.return = e, e = e.child;
          continue;
        }
        if (e === n) break e;
        for (; e.sibling === null; ) {
          if (e.return === null || e.return === n)
            break e;
          e = e.return;
        }
        e.sibling.return = e.return, e = e.sibling;
      }
    switch (h) {
      case "forwards":
        for (i = n.child, h = null; i !== null; )
          e = i.alternate, e !== null && Vu(e) === null && (h = i), i = i.sibling;
        i = h, i === null ? (h = n.child, n.child = null) : (h = i.sibling, i.sibling = null), Cf(
          n,
          !1,
          h,
          i,
          b,
          o
        );
        break;
      case "backwards":
      case "unstable_legacy-backwards":
        for (i = null, h = n.child, n.child = null; h !== null; ) {
          if (e = h.alternate, e !== null && Vu(e) === null) {
            n.child = h;
            break;
          }
          e = h.sibling, h.sibling = i, i = h, h = e;
        }
        Cf(
          n,
          !0,
          i,
          null,
          b,
          o
        );
        break;
      case "together":
        Cf(
          n,
          !1,
          null,
          null,
          void 0,
          o
        );
        break;
      default:
        n.memoizedState = null;
    }
    return n.child;
  }
  function Ra(e, n, i) {
    if (e !== null && (n.dependencies = e.dependencies), yi |= n.lanes, (i & n.childLanes) === 0)
      if (e !== null) {
        if (ao(
          e,
          n,
          i,
          !1
        ), (i & n.childLanes) === 0)
          return null;
      } else return null;
    if (e !== null && n.child !== e.child)
      throw Error(l(153));
    if (n.child !== null) {
      for (e = n.child, i = _a(e, e.pendingProps), n.child = i, i.return = n; e.sibling !== null; )
        e = e.sibling, i = i.sibling = _a(e, e.pendingProps), i.return = n;
      i.sibling = null;
    }
    return n.child;
  }
  function Ef(e, n) {
    return (e.lanes & n) !== 0 ? !0 : (e = e.dependencies, !!(e !== null && Iu(e)));
  }
  function _2(e, n, i) {
    switch (n.tag) {
      case 3:
        Ge(n, n.stateNode.containerInfo), ui(n, on, e.memoizedState.cache), il();
        break;
      case 27:
      case 5:
        Rt(n);
        break;
      case 4:
        Ge(n, n.stateNode.containerInfo);
        break;
      case 10:
        ui(
          n,
          n.type,
          n.memoizedProps.value
        );
        break;
      case 31:
        if (n.memoizedState !== null)
          return n.flags |= 128, Qd(n), null;
        break;
      case 13:
        var o = n.memoizedState;
        if (o !== null)
          return o.dehydrated !== null ? (hi(n), n.flags |= 128, null) : (i & n.child.childLanes) !== 0 ? zg(e, n, i) : (hi(n), e = Ra(
            e,
            n,
            i
          ), e !== null ? e.sibling : null);
        hi(n);
        break;
      case 19:
        var h = (e.flags & 128) !== 0;
        if (o = (i & n.childLanes) !== 0, o || (ao(
          e,
          n,
          i,
          !1
        ), o = (i & n.childLanes) !== 0), h) {
          if (o)
            return Og(
              e,
              n,
              i
            );
          n.flags |= 128;
        }
        if (h = n.memoizedState, h !== null && (h.rendering = null, h.tail = null, h.lastEffect = null), M(Jt, Jt.current), o) break;
        return null;
      case 22:
        return n.lanes = 0, jg(
          e,
          n,
          i,
          n.pendingProps
        );
      case 24:
        ui(n, on, e.memoizedState.cache);
    }
    return Ra(e, n, i);
  }
  function Dg(e, n, i) {
    if (e !== null)
      if (e.memoizedProps !== n.pendingProps)
        un = !0;
      else {
        if (!Ef(e, i) && (n.flags & 128) === 0)
          return un = !1, _2(
            e,
            n,
            i
          );
        un = (e.flags & 131072) !== 0;
      }
    else
      un = !1, bt && (n.flags & 1048576) !== 0 && hp(n, ds, n.index);
    switch (n.lanes = 0, n.tag) {
      case 16:
        e: {
          var o = n.pendingProps;
          if (e = ul(n.elementType), n.type = e, typeof e == "function")
            Td(e) ? (o = hl(e, o), n.tag = 1, n = Ag(
              null,
              n,
              e,
              o,
              i
            )) : (n.tag = 0, n = bf(
              null,
              n,
              e,
              o,
              i
            ));
          else {
            if (e != null) {
              var h = e.$$typeof;
              if (h === ge) {
                n.tag = 11, n = kg(
                  null,
                  n,
                  e,
                  o,
                  i
                );
                break e;
              } else if (h === V) {
                n.tag = 14, n = Cg(
                  null,
                  n,
                  e,
                  o,
                  i
                );
                break e;
              }
            }
            throw n = be(e) || e, Error(l(306, n, ""));
          }
        }
        return n;
      case 0:
        return bf(
          e,
          n,
          n.type,
          n.pendingProps,
          i
        );
      case 1:
        return o = n.type, h = hl(
          o,
          n.pendingProps
        ), Ag(
          e,
          n,
          o,
          h,
          i
        );
      case 3:
        e: {
          if (Ge(
            n,
            n.stateNode.containerInfo
          ), e === null) throw Error(l(387));
          o = n.pendingProps;
          var b = n.memoizedState;
          h = b.element, $d(e, n), xs(n, o, null, i);
          var C = n.memoizedState;
          if (o = C.cache, ui(n, on, o), o !== b.cache && Id(
            n,
            [on],
            i,
            !0
          ), bs(), o = C.element, b.isDehydrated)
            if (b = {
              element: o,
              isDehydrated: !1,
              cache: C.cache
            }, n.updateQueue.baseState = b, n.memoizedState = b, n.flags & 256) {
              n = Mg(
                e,
                n,
                o,
                i
              );
              break e;
            } else if (o !== h) {
              h = Sr(
                Error(l(424)),
                n
              ), fs(h), n = Mg(
                e,
                n,
                o,
                i
              );
              break e;
            } else {
              switch (e = n.stateNode.containerInfo, e.nodeType) {
                case 9:
                  e = e.body;
                  break;
                default:
                  e = e.nodeName === "HTML" ? e.ownerDocument.body : e;
              }
              for (Ht = jr(e.firstChild), kn = n, bt = !0, oi = null, Cr = !0, i = jp(
                n,
                null,
                o,
                i
              ), n.child = i; i; )
                i.flags = i.flags & -3 | 4096, i = i.sibling;
            }
          else {
            if (il(), o === h) {
              n = Ra(
                e,
                n,
                i
              );
              break e;
            }
            En(e, n, o, i);
          }
          n = n.child;
        }
        return n;
      case 26:
        return rc(e, n), e === null ? (i = V0(
          n.type,
          null,
          n.pendingProps,
          null
        )) ? n.memoizedState = i : bt || (i = n.type, e = n.pendingProps, o = vc(
          ye.current
        ).createElement(i), o[Bt] = n, o[Wt] = e, jn(o, i, e), Zt(o), n.stateNode = o) : n.memoizedState = V0(
          n.type,
          e.memoizedProps,
          n.pendingProps,
          e.memoizedState
        ), null;
      case 27:
        return Rt(n), e === null && bt && (o = n.stateNode = F0(
          n.type,
          n.pendingProps,
          ye.current
        ), kn = n, Cr = !0, h = Ht, wi(n.type) ? (ah = h, Ht = jr(o.firstChild)) : Ht = h), En(
          e,
          n,
          n.pendingProps.children,
          i
        ), rc(e, n), e === null && (n.flags |= 4194304), n.child;
      case 5:
        return e === null && bt && ((h = o = Ht) && (o = rv(
          o,
          n.type,
          n.pendingProps,
          Cr
        ), o !== null ? (n.stateNode = o, kn = n, Ht = jr(o.firstChild), Cr = !1, h = !0) : h = !1), h || si(n)), Rt(n), h = n.type, b = n.pendingProps, C = e !== null ? e.memoizedProps : null, o = b.children, Jf(h, b) ? o = null : C !== null && Jf(h, C) && (n.flags |= 32), n.memoizedState !== null && (h = Wd(
          e,
          n,
          b2,
          null,
          null,
          i
        ), Us._currentValue = h), rc(e, n), En(e, n, o, i), n.child;
      case 6:
        return e === null && bt && ((e = i = Ht) && (i = av(
          i,
          n.pendingProps,
          Cr
        ), i !== null ? (n.stateNode = i, kn = n, Ht = null, e = !0) : e = !1), e || si(n)), null;
      case 13:
        return zg(e, n, i);
      case 4:
        return Ge(
          n,
          n.stateNode.containerInfo
        ), o = n.pendingProps, e === null ? n.child = dl(
          n,
          null,
          o,
          i
        ) : En(e, n, o, i), n.child;
      case 11:
        return kg(
          e,
          n,
          n.type,
          n.pendingProps,
          i
        );
      case 7:
        return En(
          e,
          n,
          n.pendingProps,
          i
        ), n.child;
      case 8:
        return En(
          e,
          n,
          n.pendingProps.children,
          i
        ), n.child;
      case 12:
        return En(
          e,
          n,
          n.pendingProps.children,
          i
        ), n.child;
      case 10:
        return o = n.pendingProps, ui(n, n.type, o.value), En(e, n, o.children, i), n.child;
      case 9:
        return h = n.type._context, o = n.pendingProps.children, ol(n), h = Cn(h), o = o(h), n.flags |= 1, En(e, n, o, i), n.child;
      case 14:
        return Cg(
          e,
          n,
          n.type,
          n.pendingProps,
          i
        );
      case 15:
        return Eg(
          e,
          n,
          n.type,
          n.pendingProps,
          i
        );
      case 19:
        return Og(e, n, i);
      case 31:
        return j2(e, n, i);
      case 22:
        return jg(
          e,
          n,
          i,
          n.pendingProps
        );
      case 24:
        return ol(n), o = Cn(on), e === null ? (h = qd(), h === null && (h = Dt, b = Ud(), h.pooledCache = b, b.refCount++, b !== null && (h.pooledCacheLanes |= i), h = b), n.memoizedState = { parent: o, cache: h }, Fd(n), ui(n, on, h)) : ((e.lanes & i) !== 0 && ($d(e, n), xs(n, null, null, i), bs()), h = e.memoizedState, b = n.memoizedState, h.parent !== o ? (h = { parent: o, cache: o }, n.memoizedState = h, n.lanes === 0 && (n.memoizedState = n.updateQueue.baseState = h), ui(n, on, o)) : (o = b.cache, ui(n, on, o), o !== h.cache && Id(
          n,
          [on],
          i,
          !0
        ))), En(
          e,
          n,
          n.pendingProps.children,
          i
        ), n.child;
      case 29:
        throw n.pendingProps;
    }
    throw Error(l(156, n.tag));
  }
  function Oa(e) {
    e.flags |= 4;
  }
  function jf(e, n, i, o, h) {
    if ((n = (e.mode & 32) !== 0) && (n = !1), n) {
      if (e.flags |= 16777216, (h & 335544128) === h)
        if (e.stateNode.complete) e.flags |= 8192;
        else if (s0()) e.flags |= 8192;
        else
          throw cl = Hu, Hd;
    } else e.flags &= -16777217;
  }
  function Lg(e, n) {
    if (n.type !== "stylesheet" || (n.state.loading & 4) !== 0)
      e.flags &= -16777217;
    else if (e.flags |= 16777216, !W0(n))
      if (s0()) e.flags |= 8192;
      else
        throw cl = Hu, Hd;
  }
  function ic(e, n) {
    n !== null && (e.flags |= 4), e.flags & 16384 && (n = e.tag !== 22 ? Su() : 536870912, e.lanes |= n, yo |= n);
  }
  function Es(e, n) {
    if (!bt)
      switch (e.tailMode) {
        case "hidden":
          n = e.tail;
          for (var i = null; n !== null; )
            n.alternate !== null && (i = n), n = n.sibling;
          i === null ? e.tail = null : i.sibling = null;
          break;
        case "collapsed":
          i = e.tail;
          for (var o = null; i !== null; )
            i.alternate !== null && (o = i), i = i.sibling;
          o === null ? n || e.tail === null ? e.tail = null : e.tail.sibling = null : o.sibling = null;
      }
  }
  function Ft(e) {
    var n = e.alternate !== null && e.alternate.child === e.child, i = 0, o = 0;
    if (n)
      for (var h = e.child; h !== null; )
        i |= h.lanes | h.childLanes, o |= h.subtreeFlags & 65011712, o |= h.flags & 65011712, h.return = e, h = h.sibling;
    else
      for (h = e.child; h !== null; )
        i |= h.lanes | h.childLanes, o |= h.subtreeFlags, o |= h.flags, h.return = e, h = h.sibling;
    return e.subtreeFlags |= o, e.childLanes = i, n;
  }
  function N2(e, n, i) {
    var o = n.pendingProps;
    switch (Rd(n), n.tag) {
      case 16:
      case 15:
      case 0:
      case 11:
      case 7:
      case 8:
      case 12:
      case 9:
      case 14:
        return Ft(n), null;
      case 1:
        return Ft(n), null;
      case 3:
        return i = n.stateNode, o = null, e !== null && (o = e.memoizedState.cache), n.memoizedState.cache !== o && (n.flags |= 2048), Aa(on), Ne(), i.pendingContext && (i.context = i.pendingContext, i.pendingContext = null), (e === null || e.child === null) && (ro(n) ? Oa(n) : e === null || e.memoizedState.isDehydrated && (n.flags & 256) === 0 || (n.flags |= 1024, Dd())), Ft(n), null;
      case 26:
        var h = n.type, b = n.memoizedState;
        return e === null ? (Oa(n), b !== null ? (Ft(n), Lg(n, b)) : (Ft(n), jf(
          n,
          h,
          null,
          o,
          i
        ))) : b ? b !== e.memoizedState ? (Oa(n), Ft(n), Lg(n, b)) : (Ft(n), n.flags &= -16777217) : (e = e.memoizedProps, e !== o && Oa(n), Ft(n), jf(
          n,
          h,
          e,
          o,
          i
        )), null;
      case 27:
        if (tn(n), i = ye.current, h = n.type, e !== null && n.stateNode != null)
          e.memoizedProps !== o && Oa(n);
        else {
          if (!o) {
            if (n.stateNode === null)
              throw Error(l(166));
            return Ft(n), null;
          }
          e = Ie.current, ro(n) ? pp(n) : (e = F0(h, o, i), n.stateNode = e, Oa(n));
        }
        return Ft(n), null;
      case 5:
        if (tn(n), h = n.type, e !== null && n.stateNode != null)
          e.memoizedProps !== o && Oa(n);
        else {
          if (!o) {
            if (n.stateNode === null)
              throw Error(l(166));
            return Ft(n), null;
          }
          if (b = Ie.current, ro(n))
            pp(n);
          else {
            var C = vc(
              ye.current
            );
            switch (b) {
              case 1:
                b = C.createElementNS(
                  "http://www.w3.org/2000/svg",
                  h
                );
                break;
              case 2:
                b = C.createElementNS(
                  "http://www.w3.org/1998/Math/MathML",
                  h
                );
                break;
              default:
                switch (h) {
                  case "svg":
                    b = C.createElementNS(
                      "http://www.w3.org/2000/svg",
                      h
                    );
                    break;
                  case "math":
                    b = C.createElementNS(
                      "http://www.w3.org/1998/Math/MathML",
                      h
                    );
                    break;
                  case "script":
                    b = C.createElement("div"), b.innerHTML = "<script><\/script>", b = b.removeChild(
                      b.firstChild
                    );
                    break;
                  case "select":
                    b = typeof o.is == "string" ? C.createElement("select", {
                      is: o.is
                    }) : C.createElement("select"), o.multiple ? b.multiple = !0 : o.size && (b.size = o.size);
                    break;
                  default:
                    b = typeof o.is == "string" ? C.createElement(h, { is: o.is }) : C.createElement(h);
                }
            }
            b[Bt] = n, b[Wt] = o;
            e: for (C = n.child; C !== null; ) {
              if (C.tag === 5 || C.tag === 6)
                b.appendChild(C.stateNode);
              else if (C.tag !== 4 && C.tag !== 27 && C.child !== null) {
                C.child.return = C, C = C.child;
                continue;
              }
              if (C === n) break e;
              for (; C.sibling === null; ) {
                if (C.return === null || C.return === n)
                  break e;
                C = C.return;
              }
              C.sibling.return = C.return, C = C.sibling;
            }
            n.stateNode = b;
            e: switch (jn(b, h, o), h) {
              case "button":
              case "input":
              case "select":
              case "textarea":
                o = !!o.autoFocus;
                break e;
              case "img":
                o = !0;
                break e;
              default:
                o = !1;
            }
            o && Oa(n);
          }
        }
        return Ft(n), jf(
          n,
          n.type,
          e === null ? null : e.memoizedProps,
          n.pendingProps,
          i
        ), null;
      case 6:
        if (e && n.stateNode != null)
          e.memoizedProps !== o && Oa(n);
        else {
          if (typeof o != "string" && n.stateNode === null)
            throw Error(l(166));
          if (e = ye.current, ro(n)) {
            if (e = n.stateNode, i = n.memoizedProps, o = null, h = kn, h !== null)
              switch (h.tag) {
                case 27:
                case 5:
                  o = h.memoizedProps;
              }
            e[Bt] = n, e = !!(e.nodeValue === i || o !== null && o.suppressHydrationWarning === !0 || z0(e.nodeValue, i)), e || si(n, !0);
          } else
            e = vc(e).createTextNode(
              o
            ), e[Bt] = n, n.stateNode = e;
        }
        return Ft(n), null;
      case 31:
        if (i = n.memoizedState, e === null || e.memoizedState !== null) {
          if (o = ro(n), i !== null) {
            if (e === null) {
              if (!o) throw Error(l(318));
              if (e = n.memoizedState, e = e !== null ? e.dehydrated : null, !e) throw Error(l(557));
              e[Bt] = n;
            } else
              il(), (n.flags & 128) === 0 && (n.memoizedState = null), n.flags |= 4;
            Ft(n), e = !1;
          } else
            i = Dd(), e !== null && e.memoizedState !== null && (e.memoizedState.hydrationErrors = i), e = !0;
          if (!e)
            return n.flags & 256 ? (sr(n), n) : (sr(n), null);
          if ((n.flags & 128) !== 0)
            throw Error(l(558));
        }
        return Ft(n), null;
      case 13:
        if (o = n.memoizedState, e === null || e.memoizedState !== null && e.memoizedState.dehydrated !== null) {
          if (h = ro(n), o !== null && o.dehydrated !== null) {
            if (e === null) {
              if (!h) throw Error(l(318));
              if (h = n.memoizedState, h = h !== null ? h.dehydrated : null, !h) throw Error(l(317));
              h[Bt] = n;
            } else
              il(), (n.flags & 128) === 0 && (n.memoizedState = null), n.flags |= 4;
            Ft(n), h = !1;
          } else
            h = Dd(), e !== null && e.memoizedState !== null && (e.memoizedState.hydrationErrors = h), h = !0;
          if (!h)
            return n.flags & 256 ? (sr(n), n) : (sr(n), null);
        }
        return sr(n), (n.flags & 128) !== 0 ? (n.lanes = i, n) : (i = o !== null, e = e !== null && e.memoizedState !== null, i && (o = n.child, h = null, o.alternate !== null && o.alternate.memoizedState !== null && o.alternate.memoizedState.cachePool !== null && (h = o.alternate.memoizedState.cachePool.pool), b = null, o.memoizedState !== null && o.memoizedState.cachePool !== null && (b = o.memoizedState.cachePool.pool), b !== h && (o.flags |= 2048)), i !== e && i && (n.child.flags |= 8192), ic(n, n.updateQueue), Ft(n), null);
      case 4:
        return Ne(), e === null && Yf(n.stateNode.containerInfo), Ft(n), null;
      case 10:
        return Aa(n.type), Ft(n), null;
      case 19:
        if (he(Jt), o = n.memoizedState, o === null) return Ft(n), null;
        if (h = (n.flags & 128) !== 0, b = o.rendering, b === null)
          if (h) Es(o, !1);
          else {
            if (Qt !== 0 || e !== null && (e.flags & 128) !== 0)
              for (e = n.child; e !== null; ) {
                if (b = Vu(e), b !== null) {
                  for (n.flags |= 128, Es(o, !1), e = b.updateQueue, n.updateQueue = e, ic(n, e), n.subtreeFlags = 0, e = i, i = n.child; i !== null; )
                    cp(i, e), i = i.sibling;
                  return M(
                    Jt,
                    Jt.current & 1 | 2
                  ), bt && Na(n, o.treeForkCount), n.child;
                }
                e = e.sibling;
              }
            o.tail !== null && mn() > cc && (n.flags |= 128, h = !0, Es(o, !1), n.lanes = 4194304);
          }
        else {
          if (!h)
            if (e = Vu(b), e !== null) {
              if (n.flags |= 128, h = !0, e = e.updateQueue, n.updateQueue = e, ic(n, e), Es(o, !0), o.tail === null && o.tailMode === "hidden" && !b.alternate && !bt)
                return Ft(n), null;
            } else
              2 * mn() - o.renderingStartTime > cc && i !== 536870912 && (n.flags |= 128, h = !0, Es(o, !1), n.lanes = 4194304);
          o.isBackwards ? (b.sibling = n.child, n.child = b) : (e = o.last, e !== null ? e.sibling = b : n.child = b, o.last = b);
        }
        return o.tail !== null ? (e = o.tail, o.rendering = e, o.tail = e.sibling, o.renderingStartTime = mn(), e.sibling = null, i = Jt.current, M(
          Jt,
          h ? i & 1 | 2 : i & 1
        ), bt && Na(n, o.treeForkCount), e) : (Ft(n), null);
      case 22:
      case 23:
        return sr(n), Yd(), o = n.memoizedState !== null, e !== null ? e.memoizedState !== null !== o && (n.flags |= 8192) : o && (n.flags |= 8192), o ? (i & 536870912) !== 0 && (n.flags & 128) === 0 && (Ft(n), n.subtreeFlags & 6 && (n.flags |= 8192)) : Ft(n), i = n.updateQueue, i !== null && ic(n, i.retryQueue), i = null, e !== null && e.memoizedState !== null && e.memoizedState.cachePool !== null && (i = e.memoizedState.cachePool.pool), o = null, n.memoizedState !== null && n.memoizedState.cachePool !== null && (o = n.memoizedState.cachePool.pool), o !== i && (n.flags |= 2048), e !== null && he(sl), null;
      case 24:
        return i = null, e !== null && (i = e.memoizedState.cache), n.memoizedState.cache !== i && (n.flags |= 2048), Aa(on), Ft(n), null;
      case 25:
        return null;
      case 30:
        return null;
    }
    throw Error(l(156, n.tag));
  }
  function T2(e, n) {
    switch (Rd(n), n.tag) {
      case 1:
        return e = n.flags, e & 65536 ? (n.flags = e & -65537 | 128, n) : null;
      case 3:
        return Aa(on), Ne(), e = n.flags, (e & 65536) !== 0 && (e & 128) === 0 ? (n.flags = e & -65537 | 128, n) : null;
      case 26:
      case 27:
      case 5:
        return tn(n), null;
      case 31:
        if (n.memoizedState !== null) {
          if (sr(n), n.alternate === null)
            throw Error(l(340));
          il();
        }
        return e = n.flags, e & 65536 ? (n.flags = e & -65537 | 128, n) : null;
      case 13:
        if (sr(n), e = n.memoizedState, e !== null && e.dehydrated !== null) {
          if (n.alternate === null)
            throw Error(l(340));
          il();
        }
        return e = n.flags, e & 65536 ? (n.flags = e & -65537 | 128, n) : null;
      case 19:
        return he(Jt), null;
      case 4:
        return Ne(), null;
      case 10:
        return Aa(n.type), null;
      case 22:
      case 23:
        return sr(n), Yd(), e !== null && he(sl), e = n.flags, e & 65536 ? (n.flags = e & -65537 | 128, n) : null;
      case 24:
        return Aa(on), null;
      case 25:
        return null;
      default:
        return null;
    }
  }
  function Bg(e, n) {
    switch (Rd(n), n.tag) {
      case 3:
        Aa(on), Ne();
        break;
      case 26:
      case 27:
      case 5:
        tn(n);
        break;
      case 4:
        Ne();
        break;
      case 31:
        n.memoizedState !== null && sr(n);
        break;
      case 13:
        sr(n);
        break;
      case 19:
        he(Jt);
        break;
      case 10:
        Aa(n.type);
        break;
      case 22:
      case 23:
        sr(n), Yd(), e !== null && he(sl);
        break;
      case 24:
        Aa(on);
    }
  }
  function js(e, n) {
    try {
      var i = n.updateQueue, o = i !== null ? i.lastEffect : null;
      if (o !== null) {
        var h = o.next;
        i = h;
        do {
          if ((i.tag & e) === e) {
            o = void 0;
            var b = i.create, C = i.inst;
            o = b(), C.destroy = o;
          }
          i = i.next;
        } while (i !== h);
      }
    } catch (T) {
      Nt(n, n.return, T);
    }
  }
  function pi(e, n, i) {
    try {
      var o = n.updateQueue, h = o !== null ? o.lastEffect : null;
      if (h !== null) {
        var b = h.next;
        o = b;
        do {
          if ((o.tag & e) === e) {
            var C = o.inst, T = C.destroy;
            if (T !== void 0) {
              C.destroy = void 0, h = n;
              var P = i, le = T;
              try {
                le();
              } catch (Se) {
                Nt(
                  h,
                  P,
                  Se
                );
              }
            }
          }
          o = o.next;
        } while (o !== b);
      }
    } catch (Se) {
      Nt(n, n.return, Se);
    }
  }
  function Ig(e) {
    var n = e.updateQueue;
    if (n !== null) {
      var i = e.stateNode;
      try {
        Np(n, i);
      } catch (o) {
        Nt(e, e.return, o);
      }
    }
  }
  function Ug(e, n, i) {
    i.props = hl(
      e.type,
      e.memoizedProps
    ), i.state = e.memoizedState;
    try {
      i.componentWillUnmount();
    } catch (o) {
      Nt(e, n, o);
    }
  }
  function _s(e, n) {
    try {
      var i = e.ref;
      if (i !== null) {
        switch (e.tag) {
          case 26:
          case 27:
          case 5:
            var o = e.stateNode;
            break;
          case 30:
            o = e.stateNode;
            break;
          default:
            o = e.stateNode;
        }
        typeof i == "function" ? e.refCleanup = i(o) : i.current = o;
      }
    } catch (h) {
      Nt(e, n, h);
    }
  }
  function ea(e, n) {
    var i = e.ref, o = e.refCleanup;
    if (i !== null)
      if (typeof o == "function")
        try {
          o();
        } catch (h) {
          Nt(e, n, h);
        } finally {
          e.refCleanup = null, e = e.alternate, e != null && (e.refCleanup = null);
        }
      else if (typeof i == "function")
        try {
          i(null);
        } catch (h) {
          Nt(e, n, h);
        }
      else i.current = null;
  }
  function Pg(e) {
    var n = e.type, i = e.memoizedProps, o = e.stateNode;
    try {
      e: switch (n) {
        case "button":
        case "input":
        case "select":
        case "textarea":
          i.autoFocus && o.focus();
          break e;
        case "img":
          i.src ? o.src = i.src : i.srcSet && (o.srcset = i.srcSet);
      }
    } catch (h) {
      Nt(e, e.return, h);
    }
  }
  function _f(e, n, i) {
    try {
      var o = e.stateNode;
      W2(o, e.type, i, n), o[Wt] = n;
    } catch (h) {
      Nt(e, e.return, h);
    }
  }
  function qg(e) {
    return e.tag === 5 || e.tag === 3 || e.tag === 26 || e.tag === 27 && wi(e.type) || e.tag === 4;
  }
  function Nf(e) {
    e: for (; ; ) {
      for (; e.sibling === null; ) {
        if (e.return === null || qg(e.return)) return null;
        e = e.return;
      }
      for (e.sibling.return = e.return, e = e.sibling; e.tag !== 5 && e.tag !== 6 && e.tag !== 18; ) {
        if (e.tag === 27 && wi(e.type) || e.flags & 2 || e.child === null || e.tag === 4) continue e;
        e.child.return = e, e = e.child;
      }
      if (!(e.flags & 2)) return e.stateNode;
    }
  }
  function Tf(e, n, i) {
    var o = e.tag;
    if (o === 5 || o === 6)
      e = e.stateNode, n ? (i.nodeType === 9 ? i.body : i.nodeName === "HTML" ? i.ownerDocument.body : i).insertBefore(e, n) : (n = i.nodeType === 9 ? i.body : i.nodeName === "HTML" ? i.ownerDocument.body : i, n.appendChild(e), i = i._reactRootContainer, i != null || n.onclick !== null || (n.onclick = Gn));
    else if (o !== 4 && (o === 27 && wi(e.type) && (i = e.stateNode, n = null), e = e.child, e !== null))
      for (Tf(e, n, i), e = e.sibling; e !== null; )
        Tf(e, n, i), e = e.sibling;
  }
  function lc(e, n, i) {
    var o = e.tag;
    if (o === 5 || o === 6)
      e = e.stateNode, n ? i.insertBefore(e, n) : i.appendChild(e);
    else if (o !== 4 && (o === 27 && wi(e.type) && (i = e.stateNode), e = e.child, e !== null))
      for (lc(e, n, i), e = e.sibling; e !== null; )
        lc(e, n, i), e = e.sibling;
  }
  function Hg(e) {
    var n = e.stateNode, i = e.memoizedProps;
    try {
      for (var o = e.type, h = n.attributes; h.length; )
        n.removeAttributeNode(h[0]);
      jn(n, o, i), n[Bt] = e, n[Wt] = i;
    } catch (b) {
      Nt(e, e.return, b);
    }
  }
  var Da = !1, cn = !1, Af = !1, Fg = typeof WeakSet == "function" ? WeakSet : Set, vn = null;
  function A2(e, n) {
    if (e = e.containerInfo, Wf = _c, e = j(e), N(e)) {
      if ("selectionStart" in e)
        var i = {
          start: e.selectionStart,
          end: e.selectionEnd
        };
      else
        e: {
          i = (i = e.ownerDocument) && i.defaultView || window;
          var o = i.getSelection && i.getSelection();
          if (o && o.rangeCount !== 0) {
            i = o.anchorNode;
            var h = o.anchorOffset, b = o.focusNode;
            o = o.focusOffset;
            try {
              i.nodeType, b.nodeType;
            } catch {
              i = null;
              break e;
            }
            var C = 0, T = -1, P = -1, le = 0, Se = 0, Ee = e, ce = null;
            t: for (; ; ) {
              for (var pe; Ee !== i || h !== 0 && Ee.nodeType !== 3 || (T = C + h), Ee !== b || o !== 0 && Ee.nodeType !== 3 || (P = C + o), Ee.nodeType === 3 && (C += Ee.nodeValue.length), (pe = Ee.firstChild) !== null; )
                ce = Ee, Ee = pe;
              for (; ; ) {
                if (Ee === e) break t;
                if (ce === i && ++le === h && (T = C), ce === b && ++Se === o && (P = C), (pe = Ee.nextSibling) !== null) break;
                Ee = ce, ce = Ee.parentNode;
              }
              Ee = pe;
            }
            i = T === -1 || P === -1 ? null : { start: T, end: P };
          } else i = null;
        }
      i = i || { start: 0, end: 0 };
    } else i = null;
    for (Zf = { focusedElem: e, selectionRange: i }, _c = !1, vn = n; vn !== null; )
      if (n = vn, e = n.child, (n.subtreeFlags & 1028) !== 0 && e !== null)
        e.return = n, vn = e;
      else
        for (; vn !== null; ) {
          switch (n = vn, b = n.alternate, e = n.flags, n.tag) {
            case 0:
              if ((e & 4) !== 0 && (e = n.updateQueue, e = e !== null ? e.events : null, e !== null))
                for (i = 0; i < e.length; i++)
                  h = e[i], h.ref.impl = h.nextImpl;
              break;
            case 11:
            case 15:
              break;
            case 1:
              if ((e & 1024) !== 0 && b !== null) {
                e = void 0, i = n, h = b.memoizedProps, b = b.memoizedState, o = i.stateNode;
                try {
                  var Ve = hl(
                    i.type,
                    h
                  );
                  e = o.getSnapshotBeforeUpdate(
                    Ve,
                    b
                  ), o.__reactInternalSnapshotBeforeUpdate = e;
                } catch (tt) {
                  Nt(
                    i,
                    i.return,
                    tt
                  );
                }
              }
              break;
            case 3:
              if ((e & 1024) !== 0) {
                if (e = n.stateNode.containerInfo, i = e.nodeType, i === 9)
                  th(e);
                else if (i === 1)
                  switch (e.nodeName) {
                    case "HEAD":
                    case "HTML":
                    case "BODY":
                      th(e);
                      break;
                    default:
                      e.textContent = "";
                  }
              }
              break;
            case 5:
            case 26:
            case 27:
            case 6:
            case 4:
            case 17:
              break;
            default:
              if ((e & 1024) !== 0) throw Error(l(163));
          }
          if (e = n.sibling, e !== null) {
            e.return = n.return, vn = e;
            break;
          }
          vn = n.return;
        }
  }
  function $g(e, n, i) {
    var o = i.flags;
    switch (i.tag) {
      case 0:
      case 11:
      case 15:
        Ba(e, i), o & 4 && js(5, i);
        break;
      case 1:
        if (Ba(e, i), o & 4)
          if (e = i.stateNode, n === null)
            try {
              e.componentDidMount();
            } catch (C) {
              Nt(i, i.return, C);
            }
          else {
            var h = hl(
              i.type,
              n.memoizedProps
            );
            n = n.memoizedState;
            try {
              e.componentDidUpdate(
                h,
                n,
                e.__reactInternalSnapshotBeforeUpdate
              );
            } catch (C) {
              Nt(
                i,
                i.return,
                C
              );
            }
          }
        o & 64 && Ig(i), o & 512 && _s(i, i.return);
        break;
      case 3:
        if (Ba(e, i), o & 64 && (e = i.updateQueue, e !== null)) {
          if (n = null, i.child !== null)
            switch (i.child.tag) {
              case 27:
              case 5:
                n = i.child.stateNode;
                break;
              case 1:
                n = i.child.stateNode;
            }
          try {
            Np(e, n);
          } catch (C) {
            Nt(i, i.return, C);
          }
        }
        break;
      case 27:
        n === null && o & 4 && Hg(i);
      case 26:
      case 5:
        Ba(e, i), n === null && o & 4 && Pg(i), o & 512 && _s(i, i.return);
        break;
      case 12:
        Ba(e, i);
        break;
      case 31:
        Ba(e, i), o & 4 && Kg(e, i);
        break;
      case 13:
        Ba(e, i), o & 4 && Yg(e, i), o & 64 && (e = i.memoizedState, e !== null && (e = e.dehydrated, e !== null && (i = U2.bind(
          null,
          i
        ), iv(e, i))));
        break;
      case 22:
        if (o = i.memoizedState !== null || Da, !o) {
          n = n !== null && n.memoizedState !== null || cn, h = Da;
          var b = cn;
          Da = o, (cn = n) && !b ? Ia(
            e,
            i,
            (i.subtreeFlags & 8772) !== 0
          ) : Ba(e, i), Da = h, cn = b;
        }
        break;
      case 30:
        break;
      default:
        Ba(e, i);
    }
  }
  function Gg(e) {
    var n = e.alternate;
    n !== null && (e.alternate = null, Gg(n)), e.child = null, e.deletions = null, e.sibling = null, e.tag === 5 && (n = e.stateNode, n !== null && Dl(n)), e.stateNode = null, e.return = null, e.dependencies = null, e.memoizedProps = null, e.memoizedState = null, e.pendingProps = null, e.stateNode = null, e.updateQueue = null;
  }
  var Gt = null, Kn = !1;
  function La(e, n, i) {
    for (i = i.child; i !== null; )
      Vg(e, n, i), i = i.sibling;
  }
  function Vg(e, n, i) {
    if (Vt && typeof Vt.onCommitFiberUnmount == "function")
      try {
        Vt.onCommitFiberUnmount(nn, i);
      } catch {
      }
    switch (i.tag) {
      case 26:
        cn || ea(i, n), La(
          e,
          n,
          i
        ), i.memoizedState ? i.memoizedState.count-- : i.stateNode && (i = i.stateNode, i.parentNode.removeChild(i));
        break;
      case 27:
        cn || ea(i, n);
        var o = Gt, h = Kn;
        wi(i.type) && (Gt = i.stateNode, Kn = !1), La(
          e,
          n,
          i
        ), Ls(i.stateNode), Gt = o, Kn = h;
        break;
      case 5:
        cn || ea(i, n);
      case 6:
        if (o = Gt, h = Kn, Gt = null, La(
          e,
          n,
          i
        ), Gt = o, Kn = h, Gt !== null)
          if (Kn)
            try {
              (Gt.nodeType === 9 ? Gt.body : Gt.nodeName === "HTML" ? Gt.ownerDocument.body : Gt).removeChild(i.stateNode);
            } catch (b) {
              Nt(
                i,
                n,
                b
              );
            }
          else
            try {
              Gt.removeChild(i.stateNode);
            } catch (b) {
              Nt(
                i,
                n,
                b
              );
            }
        break;
      case 18:
        Gt !== null && (Kn ? (e = Gt, I0(
          e.nodeType === 9 ? e.body : e.nodeName === "HTML" ? e.ownerDocument.body : e,
          i.stateNode
        ), Eo(e)) : I0(Gt, i.stateNode));
        break;
      case 4:
        o = Gt, h = Kn, Gt = i.stateNode.containerInfo, Kn = !0, La(
          e,
          n,
          i
        ), Gt = o, Kn = h;
        break;
      case 0:
      case 11:
      case 14:
      case 15:
        pi(2, i, n), cn || pi(4, i, n), La(
          e,
          n,
          i
        );
        break;
      case 1:
        cn || (ea(i, n), o = i.stateNode, typeof o.componentWillUnmount == "function" && Ug(
          i,
          n,
          o
        )), La(
          e,
          n,
          i
        );
        break;
      case 21:
        La(
          e,
          n,
          i
        );
        break;
      case 22:
        cn = (o = cn) || i.memoizedState !== null, La(
          e,
          n,
          i
        ), cn = o;
        break;
      default:
        La(
          e,
          n,
          i
        );
    }
  }
  function Kg(e, n) {
    if (n.memoizedState === null && (e = n.alternate, e !== null && (e = e.memoizedState, e !== null))) {
      e = e.dehydrated;
      try {
        Eo(e);
      } catch (i) {
        Nt(n, n.return, i);
      }
    }
  }
  function Yg(e, n) {
    if (n.memoizedState === null && (e = n.alternate, e !== null && (e = e.memoizedState, e !== null && (e = e.dehydrated, e !== null))))
      try {
        Eo(e);
      } catch (i) {
        Nt(n, n.return, i);
      }
  }
  function M2(e) {
    switch (e.tag) {
      case 31:
      case 13:
      case 19:
        var n = e.stateNode;
        return n === null && (n = e.stateNode = new Fg()), n;
      case 22:
        return e = e.stateNode, n = e._retryCache, n === null && (n = e._retryCache = new Fg()), n;
      default:
        throw Error(l(435, e.tag));
    }
  }
  function oc(e, n) {
    var i = M2(e);
    n.forEach(function(o) {
      if (!i.has(o)) {
        i.add(o);
        var h = P2.bind(null, e, o);
        o.then(h, h);
      }
    });
  }
  function Yn(e, n) {
    var i = n.deletions;
    if (i !== null)
      for (var o = 0; o < i.length; o++) {
        var h = i[o], b = e, C = n, T = C;
        e: for (; T !== null; ) {
          switch (T.tag) {
            case 27:
              if (wi(T.type)) {
                Gt = T.stateNode, Kn = !1;
                break e;
              }
              break;
            case 5:
              Gt = T.stateNode, Kn = !1;
              break e;
            case 3:
            case 4:
              Gt = T.stateNode.containerInfo, Kn = !0;
              break e;
          }
          T = T.return;
        }
        if (Gt === null) throw Error(l(160));
        Vg(b, C, h), Gt = null, Kn = !1, b = h.alternate, b !== null && (b.return = null), h.return = null;
      }
    if (n.subtreeFlags & 13886)
      for (n = n.child; n !== null; )
        Qg(n, e), n = n.sibling;
  }
  var Lr = null;
  function Qg(e, n) {
    var i = e.alternate, o = e.flags;
    switch (e.tag) {
      case 0:
      case 11:
      case 14:
      case 15:
        Yn(n, e), Qn(e), o & 4 && (pi(3, e, e.return), js(3, e), pi(5, e, e.return));
        break;
      case 1:
        Yn(n, e), Qn(e), o & 512 && (cn || i === null || ea(i, i.return)), o & 64 && Da && (e = e.updateQueue, e !== null && (o = e.callbacks, o !== null && (i = e.shared.hiddenCallbacks, e.shared.hiddenCallbacks = i === null ? o : i.concat(o))));
        break;
      case 26:
        var h = Lr;
        if (Yn(n, e), Qn(e), o & 512 && (cn || i === null || ea(i, i.return)), o & 4) {
          var b = i !== null ? i.memoizedState : null;
          if (o = e.memoizedState, i === null)
            if (o === null)
              if (e.stateNode === null) {
                e: {
                  o = e.type, i = e.memoizedProps, h = h.ownerDocument || h;
                  t: switch (o) {
                    case "title":
                      b = h.getElementsByTagName("title")[0], (!b || b[rr] || b[Bt] || b.namespaceURI === "http://www.w3.org/2000/svg" || b.hasAttribute("itemprop")) && (b = h.createElement(o), h.head.insertBefore(
                        b,
                        h.querySelector("head > title")
                      )), jn(b, o, i), b[Bt] = e, Zt(b), o = b;
                      break e;
                    case "link":
                      var C = Q0(
                        "link",
                        "href",
                        h
                      ).get(o + (i.href || ""));
                      if (C) {
                        for (var T = 0; T < C.length; T++)
                          if (b = C[T], b.getAttribute("href") === (i.href == null || i.href === "" ? null : i.href) && b.getAttribute("rel") === (i.rel == null ? null : i.rel) && b.getAttribute("title") === (i.title == null ? null : i.title) && b.getAttribute("crossorigin") === (i.crossOrigin == null ? null : i.crossOrigin)) {
                            C.splice(T, 1);
                            break t;
                          }
                      }
                      b = h.createElement(o), jn(b, o, i), h.head.appendChild(b);
                      break;
                    case "meta":
                      if (C = Q0(
                        "meta",
                        "content",
                        h
                      ).get(o + (i.content || ""))) {
                        for (T = 0; T < C.length; T++)
                          if (b = C[T], b.getAttribute("content") === (i.content == null ? null : "" + i.content) && b.getAttribute("name") === (i.name == null ? null : i.name) && b.getAttribute("property") === (i.property == null ? null : i.property) && b.getAttribute("http-equiv") === (i.httpEquiv == null ? null : i.httpEquiv) && b.getAttribute("charset") === (i.charSet == null ? null : i.charSet)) {
                            C.splice(T, 1);
                            break t;
                          }
                      }
                      b = h.createElement(o), jn(b, o, i), h.head.appendChild(b);
                      break;
                    default:
                      throw Error(l(468, o));
                  }
                  b[Bt] = e, Zt(b), o = b;
                }
                e.stateNode = o;
              } else
                X0(
                  h,
                  e.type,
                  e.stateNode
                );
            else
              e.stateNode = Y0(
                h,
                o,
                e.memoizedProps
              );
          else
            b !== o ? (b === null ? i.stateNode !== null && (i = i.stateNode, i.parentNode.removeChild(i)) : b.count--, o === null ? X0(
              h,
              e.type,
              e.stateNode
            ) : Y0(
              h,
              o,
              e.memoizedProps
            )) : o === null && e.stateNode !== null && _f(
              e,
              e.memoizedProps,
              i.memoizedProps
            );
        }
        break;
      case 27:
        Yn(n, e), Qn(e), o & 512 && (cn || i === null || ea(i, i.return)), i !== null && o & 4 && _f(
          e,
          e.memoizedProps,
          i.memoizedProps
        );
        break;
      case 5:
        if (Yn(n, e), Qn(e), o & 512 && (cn || i === null || ea(i, i.return)), e.flags & 32) {
          h = e.stateNode;
          try {
            ba(h, "");
          } catch (Ve) {
            Nt(e, e.return, Ve);
          }
        }
        o & 4 && e.stateNode != null && (h = e.memoizedProps, _f(
          e,
          h,
          i !== null ? i.memoizedProps : h
        )), o & 1024 && (Af = !0);
        break;
      case 6:
        if (Yn(n, e), Qn(e), o & 4) {
          if (e.stateNode === null)
            throw Error(l(162));
          o = e.memoizedProps, i = e.stateNode;
          try {
            i.nodeValue = o;
          } catch (Ve) {
            Nt(e, e.return, Ve);
          }
        }
        break;
      case 3:
        if (kc = null, h = Lr, Lr = Sc(n.containerInfo), Yn(n, e), Lr = h, Qn(e), o & 4 && i !== null && i.memoizedState.isDehydrated)
          try {
            Eo(n.containerInfo);
          } catch (Ve) {
            Nt(e, e.return, Ve);
          }
        Af && (Af = !1, Xg(e));
        break;
      case 4:
        o = Lr, Lr = Sc(
          e.stateNode.containerInfo
        ), Yn(n, e), Qn(e), Lr = o;
        break;
      case 12:
        Yn(n, e), Qn(e);
        break;
      case 31:
        Yn(n, e), Qn(e), o & 4 && (o = e.updateQueue, o !== null && (e.updateQueue = null, oc(e, o)));
        break;
      case 13:
        Yn(n, e), Qn(e), e.child.flags & 8192 && e.memoizedState !== null != (i !== null && i.memoizedState !== null) && (uc = mn()), o & 4 && (o = e.updateQueue, o !== null && (e.updateQueue = null, oc(e, o)));
        break;
      case 22:
        h = e.memoizedState !== null;
        var P = i !== null && i.memoizedState !== null, le = Da, Se = cn;
        if (Da = le || h, cn = Se || P, Yn(n, e), cn = Se, Da = le, Qn(e), o & 8192)
          e: for (n = e.stateNode, n._visibility = h ? n._visibility & -2 : n._visibility | 1, h && (i === null || P || Da || cn || ml(e)), i = null, n = e; ; ) {
            if (n.tag === 5 || n.tag === 26) {
              if (i === null) {
                P = i = n;
                try {
                  if (b = P.stateNode, h)
                    C = b.style, typeof C.setProperty == "function" ? C.setProperty("display", "none", "important") : C.display = "none";
                  else {
                    T = P.stateNode;
                    var Ee = P.memoizedProps.style, ce = Ee != null && Ee.hasOwnProperty("display") ? Ee.display : null;
                    T.style.display = ce == null || typeof ce == "boolean" ? "" : ("" + ce).trim();
                  }
                } catch (Ve) {
                  Nt(P, P.return, Ve);
                }
              }
            } else if (n.tag === 6) {
              if (i === null) {
                P = n;
                try {
                  P.stateNode.nodeValue = h ? "" : P.memoizedProps;
                } catch (Ve) {
                  Nt(P, P.return, Ve);
                }
              }
            } else if (n.tag === 18) {
              if (i === null) {
                P = n;
                try {
                  var pe = P.stateNode;
                  h ? U0(pe, !0) : U0(P.stateNode, !1);
                } catch (Ve) {
                  Nt(P, P.return, Ve);
                }
              }
            } else if ((n.tag !== 22 && n.tag !== 23 || n.memoizedState === null || n === e) && n.child !== null) {
              n.child.return = n, n = n.child;
              continue;
            }
            if (n === e) break e;
            for (; n.sibling === null; ) {
              if (n.return === null || n.return === e) break e;
              i === n && (i = null), n = n.return;
            }
            i === n && (i = null), n.sibling.return = n.return, n = n.sibling;
          }
        o & 4 && (o = e.updateQueue, o !== null && (i = o.retryQueue, i !== null && (o.retryQueue = null, oc(e, i))));
        break;
      case 19:
        Yn(n, e), Qn(e), o & 4 && (o = e.updateQueue, o !== null && (e.updateQueue = null, oc(e, o)));
        break;
      case 30:
        break;
      case 21:
        break;
      default:
        Yn(n, e), Qn(e);
    }
  }
  function Qn(e) {
    var n = e.flags;
    if (n & 2) {
      try {
        for (var i, o = e.return; o !== null; ) {
          if (qg(o)) {
            i = o;
            break;
          }
          o = o.return;
        }
        if (i == null) throw Error(l(160));
        switch (i.tag) {
          case 27:
            var h = i.stateNode, b = Nf(e);
            lc(e, b, h);
            break;
          case 5:
            var C = i.stateNode;
            i.flags & 32 && (ba(C, ""), i.flags &= -33);
            var T = Nf(e);
            lc(e, T, C);
            break;
          case 3:
          case 4:
            var P = i.stateNode.containerInfo, le = Nf(e);
            Tf(
              e,
              le,
              P
            );
            break;
          default:
            throw Error(l(161));
        }
      } catch (Se) {
        Nt(e, e.return, Se);
      }
      e.flags &= -3;
    }
    n & 4096 && (e.flags &= -4097);
  }
  function Xg(e) {
    if (e.subtreeFlags & 1024)
      for (e = e.child; e !== null; ) {
        var n = e;
        Xg(n), n.tag === 5 && n.flags & 1024 && n.stateNode.reset(), e = e.sibling;
      }
  }
  function Ba(e, n) {
    if (n.subtreeFlags & 8772)
      for (n = n.child; n !== null; )
        $g(e, n.alternate, n), n = n.sibling;
  }
  function ml(e) {
    for (e = e.child; e !== null; ) {
      var n = e;
      switch (n.tag) {
        case 0:
        case 11:
        case 14:
        case 15:
          pi(4, n, n.return), ml(n);
          break;
        case 1:
          ea(n, n.return);
          var i = n.stateNode;
          typeof i.componentWillUnmount == "function" && Ug(
            n,
            n.return,
            i
          ), ml(n);
          break;
        case 27:
          Ls(n.stateNode);
        case 26:
        case 5:
          ea(n, n.return), ml(n);
          break;
        case 22:
          n.memoizedState === null && ml(n);
          break;
        case 30:
          ml(n);
          break;
        default:
          ml(n);
      }
      e = e.sibling;
    }
  }
  function Ia(e, n, i) {
    for (i = i && (n.subtreeFlags & 8772) !== 0, n = n.child; n !== null; ) {
      var o = n.alternate, h = e, b = n, C = b.flags;
      switch (b.tag) {
        case 0:
        case 11:
        case 15:
          Ia(
            h,
            b,
            i
          ), js(4, b);
          break;
        case 1:
          if (Ia(
            h,
            b,
            i
          ), o = b, h = o.stateNode, typeof h.componentDidMount == "function")
            try {
              h.componentDidMount();
            } catch (le) {
              Nt(o, o.return, le);
            }
          if (o = b, h = o.updateQueue, h !== null) {
            var T = o.stateNode;
            try {
              var P = h.shared.hiddenCallbacks;
              if (P !== null)
                for (h.shared.hiddenCallbacks = null, h = 0; h < P.length; h++)
                  _p(P[h], T);
            } catch (le) {
              Nt(o, o.return, le);
            }
          }
          i && C & 64 && Ig(b), _s(b, b.return);
          break;
        case 27:
          Hg(b);
        case 26:
        case 5:
          Ia(
            h,
            b,
            i
          ), i && o === null && C & 4 && Pg(b), _s(b, b.return);
          break;
        case 12:
          Ia(
            h,
            b,
            i
          );
          break;
        case 31:
          Ia(
            h,
            b,
            i
          ), i && C & 4 && Kg(h, b);
          break;
        case 13:
          Ia(
            h,
            b,
            i
          ), i && C & 4 && Yg(h, b);
          break;
        case 22:
          b.memoizedState === null && Ia(
            h,
            b,
            i
          ), _s(b, b.return);
          break;
        case 30:
          break;
        default:
          Ia(
            h,
            b,
            i
          );
      }
      n = n.sibling;
    }
  }
  function Mf(e, n) {
    var i = null;
    e !== null && e.memoizedState !== null && e.memoizedState.cachePool !== null && (i = e.memoizedState.cachePool.pool), e = null, n.memoizedState !== null && n.memoizedState.cachePool !== null && (e = n.memoizedState.cachePool.pool), e !== i && (e != null && e.refCount++, i != null && hs(i));
  }
  function zf(e, n) {
    e = null, n.alternate !== null && (e = n.alternate.memoizedState.cache), n = n.memoizedState.cache, n !== e && (n.refCount++, e != null && hs(e));
  }
  function Br(e, n, i, o) {
    if (n.subtreeFlags & 10256)
      for (n = n.child; n !== null; )
        Wg(
          e,
          n,
          i,
          o
        ), n = n.sibling;
  }
  function Wg(e, n, i, o) {
    var h = n.flags;
    switch (n.tag) {
      case 0:
      case 11:
      case 15:
        Br(
          e,
          n,
          i,
          o
        ), h & 2048 && js(9, n);
        break;
      case 1:
        Br(
          e,
          n,
          i,
          o
        );
        break;
      case 3:
        Br(
          e,
          n,
          i,
          o
        ), h & 2048 && (e = null, n.alternate !== null && (e = n.alternate.memoizedState.cache), n = n.memoizedState.cache, n !== e && (n.refCount++, e != null && hs(e)));
        break;
      case 12:
        if (h & 2048) {
          Br(
            e,
            n,
            i,
            o
          ), e = n.stateNode;
          try {
            var b = n.memoizedProps, C = b.id, T = b.onPostCommit;
            typeof T == "function" && T(
              C,
              n.alternate === null ? "mount" : "update",
              e.passiveEffectDuration,
              -0
            );
          } catch (P) {
            Nt(n, n.return, P);
          }
        } else
          Br(
            e,
            n,
            i,
            o
          );
        break;
      case 31:
        Br(
          e,
          n,
          i,
          o
        );
        break;
      case 13:
        Br(
          e,
          n,
          i,
          o
        );
        break;
      case 23:
        break;
      case 22:
        b = n.stateNode, C = n.alternate, n.memoizedState !== null ? b._visibility & 2 ? Br(
          e,
          n,
          i,
          o
        ) : Ns(e, n) : b._visibility & 2 ? Br(
          e,
          n,
          i,
          o
        ) : (b._visibility |= 2, mo(
          e,
          n,
          i,
          o,
          (n.subtreeFlags & 10256) !== 0 || !1
        )), h & 2048 && Mf(C, n);
        break;
      case 24:
        Br(
          e,
          n,
          i,
          o
        ), h & 2048 && zf(n.alternate, n);
        break;
      default:
        Br(
          e,
          n,
          i,
          o
        );
    }
  }
  function mo(e, n, i, o, h) {
    for (h = h && ((n.subtreeFlags & 10256) !== 0 || !1), n = n.child; n !== null; ) {
      var b = e, C = n, T = i, P = o, le = C.flags;
      switch (C.tag) {
        case 0:
        case 11:
        case 15:
          mo(
            b,
            C,
            T,
            P,
            h
          ), js(8, C);
          break;
        case 23:
          break;
        case 22:
          var Se = C.stateNode;
          C.memoizedState !== null ? Se._visibility & 2 ? mo(
            b,
            C,
            T,
            P,
            h
          ) : Ns(
            b,
            C
          ) : (Se._visibility |= 2, mo(
            b,
            C,
            T,
            P,
            h
          )), h && le & 2048 && Mf(
            C.alternate,
            C
          );
          break;
        case 24:
          mo(
            b,
            C,
            T,
            P,
            h
          ), h && le & 2048 && zf(C.alternate, C);
          break;
        default:
          mo(
            b,
            C,
            T,
            P,
            h
          );
      }
      n = n.sibling;
    }
  }
  function Ns(e, n) {
    if (n.subtreeFlags & 10256)
      for (n = n.child; n !== null; ) {
        var i = e, o = n, h = o.flags;
        switch (o.tag) {
          case 22:
            Ns(i, o), h & 2048 && Mf(
              o.alternate,
              o
            );
            break;
          case 24:
            Ns(i, o), h & 2048 && zf(o.alternate, o);
            break;
          default:
            Ns(i, o);
        }
        n = n.sibling;
      }
  }
  var Ts = 8192;
  function po(e, n, i) {
    if (e.subtreeFlags & Ts)
      for (e = e.child; e !== null; )
        Zg(
          e,
          n,
          i
        ), e = e.sibling;
  }
  function Zg(e, n, i) {
    switch (e.tag) {
      case 26:
        po(
          e,
          n,
          i
        ), e.flags & Ts && e.memoizedState !== null && yv(
          i,
          Lr,
          e.memoizedState,
          e.memoizedProps
        );
        break;
      case 5:
        po(
          e,
          n,
          i
        );
        break;
      case 3:
      case 4:
        var o = Lr;
        Lr = Sc(e.stateNode.containerInfo), po(
          e,
          n,
          i
        ), Lr = o;
        break;
      case 22:
        e.memoizedState === null && (o = e.alternate, o !== null && o.memoizedState !== null ? (o = Ts, Ts = 16777216, po(
          e,
          n,
          i
        ), Ts = o) : po(
          e,
          n,
          i
        ));
        break;
      default:
        po(
          e,
          n,
          i
        );
    }
  }
  function Jg(e) {
    var n = e.alternate;
    if (n !== null && (e = n.child, e !== null)) {
      n.child = null;
      do
        n = e.sibling, e.sibling = null, e = n;
      while (e !== null);
    }
  }
  function As(e) {
    var n = e.deletions;
    if ((e.flags & 16) !== 0) {
      if (n !== null)
        for (var i = 0; i < n.length; i++) {
          var o = n[i];
          vn = o, t0(
            o,
            e
          );
        }
      Jg(e);
    }
    if (e.subtreeFlags & 10256)
      for (e = e.child; e !== null; )
        e0(e), e = e.sibling;
  }
  function e0(e) {
    switch (e.tag) {
      case 0:
      case 11:
      case 15:
        As(e), e.flags & 2048 && pi(9, e, e.return);
        break;
      case 3:
        As(e);
        break;
      case 12:
        As(e);
        break;
      case 22:
        var n = e.stateNode;
        e.memoizedState !== null && n._visibility & 2 && (e.return === null || e.return.tag !== 13) ? (n._visibility &= -3, sc(e)) : As(e);
        break;
      default:
        As(e);
    }
  }
  function sc(e) {
    var n = e.deletions;
    if ((e.flags & 16) !== 0) {
      if (n !== null)
        for (var i = 0; i < n.length; i++) {
          var o = n[i];
          vn = o, t0(
            o,
            e
          );
        }
      Jg(e);
    }
    for (e = e.child; e !== null; ) {
      switch (n = e, n.tag) {
        case 0:
        case 11:
        case 15:
          pi(8, n, n.return), sc(n);
          break;
        case 22:
          i = n.stateNode, i._visibility & 2 && (i._visibility &= -3, sc(n));
          break;
        default:
          sc(n);
      }
      e = e.sibling;
    }
  }
  function t0(e, n) {
    for (; vn !== null; ) {
      var i = vn;
      switch (i.tag) {
        case 0:
        case 11:
        case 15:
          pi(8, i, n);
          break;
        case 23:
        case 22:
          if (i.memoizedState !== null && i.memoizedState.cachePool !== null) {
            var o = i.memoizedState.cachePool.pool;
            o != null && o.refCount++;
          }
          break;
        case 24:
          hs(i.memoizedState.cache);
      }
      if (o = i.child, o !== null) o.return = i, vn = o;
      else
        e: for (i = e; vn !== null; ) {
          o = vn;
          var h = o.sibling, b = o.return;
          if (Gg(o), o === i) {
            vn = null;
            break e;
          }
          if (h !== null) {
            h.return = b, vn = h;
            break e;
          }
          vn = b;
        }
    }
  }
  var z2 = {
    getCacheForType: function(e) {
      var n = Cn(on), i = n.data.get(e);
      return i === void 0 && (i = e(), n.data.set(e, i)), i;
    },
    cacheSignal: function() {
      return Cn(on).controller.signal;
    }
  }, R2 = typeof WeakMap == "function" ? WeakMap : Map, jt = 0, Dt = null, dt = null, pt = 0, _t = 0, ur = null, gi = !1, go = !1, Rf = !1, Ua = 0, Qt = 0, yi = 0, pl = 0, Of = 0, cr = 0, yo = 0, Ms = null, Xn = null, Df = !1, uc = 0, n0 = 0, cc = 1 / 0, dc = null, bi = null, hn = 0, xi = null, bo = null, Pa = 0, Lf = 0, Bf = null, r0 = null, zs = 0, If = null;
  function dr() {
    return (jt & 2) !== 0 && pt !== 0 ? pt & -pt : re.T !== null ? $f() : Hi();
  }
  function a0() {
    if (cr === 0)
      if ((pt & 536870912) === 0 || bt) {
        var e = Ka;
        Ka <<= 1, (Ka & 3932160) === 0 && (Ka = 262144), cr = e;
      } else cr = 536870912;
    return e = or.current, e !== null && (e.flags |= 32), cr;
  }
  function Wn(e, n, i) {
    (e === Dt && (_t === 2 || _t === 9) || e.cancelPendingCommit !== null) && (xo(e, 0), vi(
      e,
      pt,
      cr,
      !1
    )), gr(e, i), ((jt & 2) === 0 || e !== Dt) && (e === Dt && ((jt & 2) === 0 && (pl |= i), Qt === 4 && vi(
      e,
      pt,
      cr,
      !1
    )), ta(e));
  }
  function i0(e, n, i) {
    if ((jt & 6) !== 0) throw Error(l(327));
    var o = !i && (n & 127) === 0 && (n & e.expiredLanes) === 0 || pa(e, n), h = o ? L2(e, n) : Pf(e, n, !0), b = o;
    do {
      if (h === 0) {
        go && !o && vi(e, n, 0, !1);
        break;
      } else {
        if (i = e.current.alternate, b && !O2(i)) {
          h = Pf(e, n, !1), b = !1;
          continue;
        }
        if (h === 2) {
          if (b = n, e.errorRecoveryDisabledLanes & b)
            var C = 0;
          else
            C = e.pendingLanes & -536870913, C = C !== 0 ? C : C & 536870912 ? 536870912 : 0;
          if (C !== 0) {
            n = C;
            e: {
              var T = e;
              h = Ms;
              var P = T.current.memoizedState.isDehydrated;
              if (P && (xo(T, C).flags |= 256), C = Pf(
                T,
                C,
                !1
              ), C !== 2) {
                if (Rf && !P) {
                  T.errorRecoveryDisabledLanes |= b, pl |= b, h = 4;
                  break e;
                }
                b = Xn, Xn = h, b !== null && (Xn === null ? Xn = b : Xn.push.apply(
                  Xn,
                  b
                ));
              }
              h = C;
            }
            if (b = !1, h !== 2) continue;
          }
        }
        if (h === 1) {
          xo(e, 0), vi(e, n, 0, !0);
          break;
        }
        e: {
          switch (o = e, b = h, b) {
            case 0:
            case 1:
              throw Error(l(345));
            case 4:
              if ((n & 4194048) !== n) break;
            case 6:
              vi(
                o,
                n,
                cr,
                !gi
              );
              break e;
            case 2:
              Xn = null;
              break;
            case 3:
            case 5:
              break;
            default:
              throw Error(l(329));
          }
          if ((n & 62914560) === n && (h = uc + 300 - mn(), 10 < h)) {
            if (vi(
              o,
              n,
              cr,
              !gi
            ), Pi(o, 0, !0) !== 0) break e;
            Pa = n, o.timeoutHandle = L0(
              l0.bind(
                null,
                o,
                i,
                Xn,
                dc,
                Df,
                n,
                cr,
                pl,
                yo,
                gi,
                b,
                "Throttled",
                -0,
                0
              ),
              h
            );
            break e;
          }
          l0(
            o,
            i,
            Xn,
            dc,
            Df,
            n,
            cr,
            pl,
            yo,
            gi,
            b,
            null,
            -0,
            0
          );
        }
      }
      break;
    } while (!0);
    ta(e);
  }
  function l0(e, n, i, o, h, b, C, T, P, le, Se, Ee, ce, pe) {
    if (e.timeoutHandle = -1, Ee = n.subtreeFlags, Ee & 8192 || (Ee & 16785408) === 16785408) {
      Ee = {
        stylesheets: null,
        count: 0,
        imgCount: 0,
        imgBytes: 0,
        suspenseyImages: [],
        waitingForImages: !0,
        waitingForViewTransition: !1,
        unsuspend: Gn
      }, Zg(
        n,
        b,
        Ee
      );
      var Ve = (b & 62914560) === b ? uc - mn() : (b & 4194048) === b ? n0 - mn() : 0;
      if (Ve = bv(
        Ee,
        Ve
      ), Ve !== null) {
        Pa = b, e.cancelPendingCommit = Ve(
          m0.bind(
            null,
            e,
            n,
            b,
            i,
            o,
            h,
            C,
            T,
            P,
            Se,
            Ee,
            null,
            ce,
            pe
          )
        ), vi(e, b, C, !le);
        return;
      }
    }
    m0(
      e,
      n,
      b,
      i,
      o,
      h,
      C,
      T,
      P
    );
  }
  function O2(e) {
    for (var n = e; ; ) {
      var i = n.tag;
      if ((i === 0 || i === 11 || i === 15) && n.flags & 16384 && (i = n.updateQueue, i !== null && (i = i.stores, i !== null)))
        for (var o = 0; o < i.length; o++) {
          var h = i[o], b = h.getSnapshot;
          h = h.value;
          try {
            if (!zn(b(), h)) return !1;
          } catch {
            return !1;
          }
        }
      if (i = n.child, n.subtreeFlags & 16384 && i !== null)
        i.return = n, n = i;
      else {
        if (n === e) break;
        for (; n.sibling === null; ) {
          if (n.return === null || n.return === e) return !0;
          n = n.return;
        }
        n.sibling.return = n.return, n = n.sibling;
      }
    }
    return !0;
  }
  function vi(e, n, i, o) {
    n &= ~Of, n &= ~pl, e.suspendedLanes |= n, e.pingedLanes &= ~n, o && (e.warmLanes |= n), o = e.expirationTimes;
    for (var h = n; 0 < h; ) {
      var b = 31 - Be(h), C = 1 << b;
      o[b] = -1, h &= ~C;
    }
    i !== 0 && qi(e, i, n);
  }
  function fc() {
    return (jt & 6) === 0 ? (Rs(0), !1) : !0;
  }
  function Uf() {
    if (dt !== null) {
      if (_t === 0)
        var e = dt.return;
      else
        e = dt, Ta = ll = null, ef(e), so = null, ps = 0, e = dt;
      for (; e !== null; )
        Bg(e.alternate, e), e = e.return;
      dt = null;
    }
  }
  function xo(e, n) {
    var i = e.timeoutHandle;
    i !== -1 && (e.timeoutHandle = -1, ev(i)), i = e.cancelPendingCommit, i !== null && (e.cancelPendingCommit = null, i()), Pa = 0, Uf(), Dt = e, dt = i = _a(e.current, null), pt = n, _t = 0, ur = null, gi = !1, go = pa(e, n), Rf = !1, yo = cr = Of = pl = yi = Qt = 0, Xn = Ms = null, Df = !1, (n & 8) !== 0 && (n |= n & 32);
    var o = e.entangledLanes;
    if (o !== 0)
      for (e = e.entanglements, o &= n; 0 < o; ) {
        var h = 31 - Be(o), b = 1 << h;
        n |= e[h], o &= ~b;
      }
    return Ua = n, xn(), i;
  }
  function o0(e, n) {
    ot = null, re.H = ks, n === oo || n === qu ? (n = kp(), _t = 3) : n === Hd ? (n = kp(), _t = 4) : _t = n === yf ? 8 : n !== null && typeof n == "object" && typeof n.then == "function" ? 6 : 1, ur = n, dt === null && (Qt = 1, tc(
      e,
      Sr(n, e.current)
    ));
  }
  function s0() {
    var e = or.current;
    return e === null ? !0 : (pt & 4194048) === pt ? Er === null : (pt & 62914560) === pt || (pt & 536870912) !== 0 ? e === Er : !1;
  }
  function u0() {
    var e = re.H;
    return re.H = ks, e === null ? ks : e;
  }
  function c0() {
    var e = re.A;
    return re.A = z2, e;
  }
  function hc() {
    Qt = 4, gi || (pt & 4194048) !== pt && or.current !== null || (go = !0), (yi & 134217727) === 0 && (pl & 134217727) === 0 || Dt === null || vi(
      Dt,
      pt,
      cr,
      !1
    );
  }
  function Pf(e, n, i) {
    var o = jt;
    jt |= 2;
    var h = u0(), b = c0();
    (Dt !== e || pt !== n) && (dc = null, xo(e, n)), n = !1;
    var C = Qt;
    e: do
      try {
        if (_t !== 0 && dt !== null) {
          var T = dt, P = ur;
          switch (_t) {
            case 8:
              Uf(), C = 6;
              break e;
            case 3:
            case 2:
            case 9:
            case 6:
              or.current === null && (n = !0);
              var le = _t;
              if (_t = 0, ur = null, vo(e, T, P, le), i && go) {
                C = 0;
                break e;
              }
              break;
            default:
              le = _t, _t = 0, ur = null, vo(e, T, P, le);
          }
        }
        D2(), C = Qt;
        break;
      } catch (Se) {
        o0(e, Se);
      }
    while (!0);
    return n && e.shellSuspendCounter++, Ta = ll = null, jt = o, re.H = h, re.A = b, dt === null && (Dt = null, pt = 0, xn()), C;
  }
  function D2() {
    for (; dt !== null; ) d0(dt);
  }
  function L2(e, n) {
    var i = jt;
    jt |= 2;
    var o = u0(), h = c0();
    Dt !== e || pt !== n ? (dc = null, cc = mn() + 500, xo(e, n)) : go = pa(
      e,
      n
    );
    e: do
      try {
        if (_t !== 0 && dt !== null) {
          n = dt;
          var b = ur;
          t: switch (_t) {
            case 1:
              _t = 0, ur = null, vo(e, n, b, 1);
              break;
            case 2:
            case 9:
              if (Sp(b)) {
                _t = 0, ur = null, f0(n);
                break;
              }
              n = function() {
                _t !== 2 && _t !== 9 || Dt !== e || (_t = 7), ta(e);
              }, b.then(n, n);
              break e;
            case 3:
              _t = 7;
              break e;
            case 4:
              _t = 5;
              break e;
            case 7:
              Sp(b) ? (_t = 0, ur = null, f0(n)) : (_t = 0, ur = null, vo(e, n, b, 7));
              break;
            case 5:
              var C = null;
              switch (dt.tag) {
                case 26:
                  C = dt.memoizedState;
                case 5:
                case 27:
                  var T = dt;
                  if (C ? W0(C) : T.stateNode.complete) {
                    _t = 0, ur = null;
                    var P = T.sibling;
                    if (P !== null) dt = P;
                    else {
                      var le = T.return;
                      le !== null ? (dt = le, mc(le)) : dt = null;
                    }
                    break t;
                  }
              }
              _t = 0, ur = null, vo(e, n, b, 5);
              break;
            case 6:
              _t = 0, ur = null, vo(e, n, b, 6);
              break;
            case 8:
              Uf(), Qt = 6;
              break e;
            default:
              throw Error(l(462));
          }
        }
        B2();
        break;
      } catch (Se) {
        o0(e, Se);
      }
    while (!0);
    return Ta = ll = null, re.H = o, re.A = h, jt = i, dt !== null ? 0 : (Dt = null, pt = 0, xn(), Qt);
  }
  function B2() {
    for (; dt !== null && !Rl(); )
      d0(dt);
  }
  function d0(e) {
    var n = Dg(e.alternate, e, Ua);
    e.memoizedProps = e.pendingProps, n === null ? mc(e) : dt = n;
  }
  function f0(e) {
    var n = e, i = n.alternate;
    switch (n.tag) {
      case 15:
      case 0:
        n = Tg(
          i,
          n,
          n.pendingProps,
          n.type,
          void 0,
          pt
        );
        break;
      case 11:
        n = Tg(
          i,
          n,
          n.pendingProps,
          n.type.render,
          n.ref,
          pt
        );
        break;
      case 5:
        ef(n);
      default:
        Bg(i, n), n = dt = cp(n, Ua), n = Dg(i, n, Ua);
    }
    e.memoizedProps = e.pendingProps, n === null ? mc(e) : dt = n;
  }
  function vo(e, n, i, o) {
    Ta = ll = null, ef(n), so = null, ps = 0;
    var h = n.return;
    try {
      if (E2(
        e,
        h,
        n,
        i,
        pt
      )) {
        Qt = 1, tc(
          e,
          Sr(i, e.current)
        ), dt = null;
        return;
      }
    } catch (b) {
      if (h !== null) throw dt = h, b;
      Qt = 1, tc(
        e,
        Sr(i, e.current)
      ), dt = null;
      return;
    }
    n.flags & 32768 ? (bt || o === 1 ? e = !0 : go || (pt & 536870912) !== 0 ? e = !1 : (gi = e = !0, (o === 2 || o === 9 || o === 3 || o === 6) && (o = or.current, o !== null && o.tag === 13 && (o.flags |= 16384))), h0(n, e)) : mc(n);
  }
  function mc(e) {
    var n = e;
    do {
      if ((n.flags & 32768) !== 0) {
        h0(
          n,
          gi
        );
        return;
      }
      e = n.return;
      var i = N2(
        n.alternate,
        n,
        Ua
      );
      if (i !== null) {
        dt = i;
        return;
      }
      if (n = n.sibling, n !== null) {
        dt = n;
        return;
      }
      dt = n = e;
    } while (n !== null);
    Qt === 0 && (Qt = 5);
  }
  function h0(e, n) {
    do {
      var i = T2(e.alternate, e);
      if (i !== null) {
        i.flags &= 32767, dt = i;
        return;
      }
      if (i = e.return, i !== null && (i.flags |= 32768, i.subtreeFlags = 0, i.deletions = null), !n && (e = e.sibling, e !== null)) {
        dt = e;
        return;
      }
      dt = e = i;
    } while (e !== null);
    Qt = 6, dt = null;
  }
  function m0(e, n, i, o, h, b, C, T, P) {
    e.cancelPendingCommit = null;
    do
      pc();
    while (hn !== 0);
    if ((jt & 6) !== 0) throw Error(l(327));
    if (n !== null) {
      if (n === e.current) throw Error(l(177));
      if (b = n.lanes | n.childLanes, b |= lt, Ho(
        e,
        i,
        b,
        C,
        T,
        P
      ), e === Dt && (dt = Dt = null, pt = 0), bo = n, xi = e, Pa = i, Lf = b, Bf = h, r0 = o, (n.subtreeFlags & 10256) !== 0 || (n.flags & 10256) !== 0 ? (e.callbackNode = null, e.callbackPriority = 0, q2(Je, function() {
        return x0(), null;
      })) : (e.callbackNode = null, e.callbackPriority = 0), o = (n.flags & 13878) !== 0, (n.subtreeFlags & 13878) !== 0 || o) {
        o = re.T, re.T = null, h = _e.p, _e.p = 2, C = jt, jt |= 4;
        try {
          A2(e, n, i);
        } finally {
          jt = C, _e.p = h, re.T = o;
        }
      }
      hn = 1, p0(), g0(), y0();
    }
  }
  function p0() {
    if (hn === 1) {
      hn = 0;
      var e = xi, n = bo, i = (n.flags & 13878) !== 0;
      if ((n.subtreeFlags & 13878) !== 0 || i) {
        i = re.T, re.T = null;
        var o = _e.p;
        _e.p = 2;
        var h = jt;
        jt |= 4;
        try {
          Qg(n, e);
          var b = Zf, C = j(e.containerInfo), T = b.focusedElem, P = b.selectionRange;
          if (C !== T && T && T.ownerDocument && k(
            T.ownerDocument.documentElement,
            T
          )) {
            if (P !== null && N(T)) {
              var le = P.start, Se = P.end;
              if (Se === void 0 && (Se = le), "selectionStart" in T)
                T.selectionStart = le, T.selectionEnd = Math.min(
                  Se,
                  T.value.length
                );
              else {
                var Ee = T.ownerDocument || document, ce = Ee && Ee.defaultView || window;
                if (ce.getSelection) {
                  var pe = ce.getSelection(), Ve = T.textContent.length, tt = Math.min(P.start, Ve), zt = P.end === void 0 ? tt : Math.min(P.end, Ve);
                  !pe.extend && tt > zt && (C = zt, zt = tt, tt = C);
                  var ne = S(
                    T,
                    tt
                  ), G = S(
                    T,
                    zt
                  );
                  if (ne && G && (pe.rangeCount !== 1 || pe.anchorNode !== ne.node || pe.anchorOffset !== ne.offset || pe.focusNode !== G.node || pe.focusOffset !== G.offset)) {
                    var ie = Ee.createRange();
                    ie.setStart(ne.node, ne.offset), pe.removeAllRanges(), tt > zt ? (pe.addRange(ie), pe.extend(G.node, G.offset)) : (ie.setEnd(G.node, G.offset), pe.addRange(ie));
                  }
                }
              }
            }
            for (Ee = [], pe = T; pe = pe.parentNode; )
              pe.nodeType === 1 && Ee.push({
                element: pe,
                left: pe.scrollLeft,
                top: pe.scrollTop
              });
            for (typeof T.focus == "function" && T.focus(), T = 0; T < Ee.length; T++) {
              var ke = Ee[T];
              ke.element.scrollLeft = ke.left, ke.element.scrollTop = ke.top;
            }
          }
          _c = !!Wf, Zf = Wf = null;
        } finally {
          jt = h, _e.p = o, re.T = i;
        }
      }
      e.current = n, hn = 2;
    }
  }
  function g0() {
    if (hn === 2) {
      hn = 0;
      var e = xi, n = bo, i = (n.flags & 8772) !== 0;
      if ((n.subtreeFlags & 8772) !== 0 || i) {
        i = re.T, re.T = null;
        var o = _e.p;
        _e.p = 2;
        var h = jt;
        jt |= 4;
        try {
          $g(e, n.alternate, n);
        } finally {
          jt = h, _e.p = o, re.T = i;
        }
      }
      hn = 3;
    }
  }
  function y0() {
    if (hn === 4 || hn === 3) {
      hn = 0, ha();
      var e = xi, n = bo, i = Pa, o = r0;
      (n.subtreeFlags & 10256) !== 0 || (n.flags & 10256) !== 0 ? hn = 5 : (hn = 0, bo = xi = null, b0(e, e.pendingLanes));
      var h = e.pendingLanes;
      if (h === 0 && (bi = null), Ya(i), n = n.stateNode, Vt && typeof Vt.onCommitFiberRoot == "function")
        try {
          Vt.onCommitFiberRoot(
            nn,
            n,
            void 0,
            (n.current.flags & 128) === 128
          );
        } catch {
        }
      if (o !== null) {
        n = re.T, h = _e.p, _e.p = 2, re.T = null;
        try {
          for (var b = e.onRecoverableError, C = 0; C < o.length; C++) {
            var T = o[C];
            b(T.value, {
              componentStack: T.stack
            });
          }
        } finally {
          re.T = n, _e.p = h;
        }
      }
      (Pa & 3) !== 0 && pc(), ta(e), h = e.pendingLanes, (i & 261930) !== 0 && (h & 42) !== 0 ? e === If ? zs++ : (zs = 0, If = e) : zs = 0, Rs(0);
    }
  }
  function b0(e, n) {
    (e.pooledCacheLanes &= n) === 0 && (n = e.pooledCache, n != null && (e.pooledCache = null, hs(n)));
  }
  function pc() {
    return p0(), g0(), y0(), x0();
  }
  function x0() {
    if (hn !== 5) return !1;
    var e = xi, n = Lf;
    Lf = 0;
    var i = Ya(Pa), o = re.T, h = _e.p;
    try {
      _e.p = 32 > i ? 32 : i, re.T = null, i = Bf, Bf = null;
      var b = xi, C = Pa;
      if (hn = 0, bo = xi = null, Pa = 0, (jt & 6) !== 0) throw Error(l(331));
      var T = jt;
      if (jt |= 4, e0(b.current), Wg(
        b,
        b.current,
        C,
        i
      ), jt = T, Rs(0, !1), Vt && typeof Vt.onPostCommitFiberRoot == "function")
        try {
          Vt.onPostCommitFiberRoot(nn, b);
        } catch {
        }
      return !0;
    } finally {
      _e.p = h, re.T = o, b0(e, n);
    }
  }
  function v0(e, n, i) {
    n = Sr(i, n), n = gf(e.stateNode, n, 2), e = fi(e, n, 2), e !== null && (gr(e, 2), ta(e));
  }
  function Nt(e, n, i) {
    if (e.tag === 3)
      v0(e, e, i);
    else
      for (; n !== null; ) {
        if (n.tag === 3) {
          v0(
            n,
            e,
            i
          );
          break;
        } else if (n.tag === 1) {
          var o = n.stateNode;
          if (typeof n.type.getDerivedStateFromError == "function" || typeof o.componentDidCatch == "function" && (bi === null || !bi.has(o))) {
            e = Sr(i, e), i = Sg(2), o = fi(n, i, 2), o !== null && (wg(
              i,
              o,
              n,
              e
            ), gr(o, 2), ta(o));
            break;
          }
        }
        n = n.return;
      }
  }
  function qf(e, n, i) {
    var o = e.pingCache;
    if (o === null) {
      o = e.pingCache = new R2();
      var h = /* @__PURE__ */ new Set();
      o.set(n, h);
    } else
      h = o.get(n), h === void 0 && (h = /* @__PURE__ */ new Set(), o.set(n, h));
    h.has(i) || (Rf = !0, h.add(i), e = I2.bind(null, e, n, i), n.then(e, e));
  }
  function I2(e, n, i) {
    var o = e.pingCache;
    o !== null && o.delete(n), e.pingedLanes |= e.suspendedLanes & i, e.warmLanes &= ~i, Dt === e && (pt & i) === i && (Qt === 4 || Qt === 3 && (pt & 62914560) === pt && 300 > mn() - uc ? (jt & 2) === 0 && xo(e, 0) : Of |= i, yo === pt && (yo = 0)), ta(e);
  }
  function S0(e, n) {
    n === 0 && (n = Su()), e = $t(e, n), e !== null && (gr(e, n), ta(e));
  }
  function U2(e) {
    var n = e.memoizedState, i = 0;
    n !== null && (i = n.retryLane), S0(e, i);
  }
  function P2(e, n) {
    var i = 0;
    switch (e.tag) {
      case 31:
      case 13:
        var o = e.stateNode, h = e.memoizedState;
        h !== null && (i = h.retryLane);
        break;
      case 19:
        o = e.stateNode;
        break;
      case 22:
        o = e.stateNode._retryCache;
        break;
      default:
        throw Error(l(314));
    }
    o !== null && o.delete(n), S0(e, i);
  }
  function q2(e, n) {
    return Hr(e, n);
  }
  var gc = null, So = null, Hf = !1, yc = !1, Ff = !1, Si = 0;
  function ta(e) {
    e !== So && e.next === null && (So === null ? gc = So = e : So = So.next = e), yc = !0, Hf || (Hf = !0, F2());
  }
  function Rs(e, n) {
    if (!Ff && yc) {
      Ff = !0;
      do
        for (var i = !1, o = gc; o !== null; ) {
          if (e !== 0) {
            var h = o.pendingLanes;
            if (h === 0) var b = 0;
            else {
              var C = o.suspendedLanes, T = o.pingedLanes;
              b = (1 << 31 - Be(42 | e) + 1) - 1, b &= h & ~(C & ~T), b = b & 201326741 ? b & 201326741 | 1 : b ? b | 2 : 0;
            }
            b !== 0 && (i = !0, E0(o, b));
          } else
            b = pt, b = Pi(
              o,
              o === Dt ? b : 0,
              o.cancelPendingCommit !== null || o.timeoutHandle !== -1
            ), (b & 3) === 0 || pa(o, b) || (i = !0, E0(o, b));
          o = o.next;
        }
      while (i);
      Ff = !1;
    }
  }
  function H2() {
    w0();
  }
  function w0() {
    yc = Hf = !1;
    var e = 0;
    Si !== 0 && J2() && (e = Si);
    for (var n = mn(), i = null, o = gc; o !== null; ) {
      var h = o.next, b = k0(o, n);
      b === 0 ? (o.next = null, i === null ? gc = h : i.next = h, h === null && (So = i)) : (i = o, (e !== 0 || (b & 3) !== 0) && (yc = !0)), o = h;
    }
    hn !== 0 && hn !== 5 || Rs(e), Si !== 0 && (Si = 0);
  }
  function k0(e, n) {
    for (var i = e.suspendedLanes, o = e.pingedLanes, h = e.expirationTimes, b = e.pendingLanes & -62914561; 0 < b; ) {
      var C = 31 - Be(b), T = 1 << C, P = h[C];
      P === -1 ? ((T & i) === 0 || (T & o) !== 0) && (h[C] = vd(T, n)) : P <= n && (e.expiredLanes |= T), b &= ~T;
    }
    if (n = Dt, i = pt, i = Pi(
      e,
      e === n ? i : 0,
      e.cancelPendingCommit !== null || e.timeoutHandle !== -1
    ), o = e.callbackNode, i === 0 || e === n && (_t === 2 || _t === 9) || e.cancelPendingCommit !== null)
      return o !== null && o !== null && Tn(o), e.callbackNode = null, e.callbackPriority = 0;
    if ((i & 3) === 0 || pa(e, i)) {
      if (n = i & -i, n === e.callbackPriority) return n;
      switch (o !== null && Tn(o), Ya(i)) {
        case 2:
        case 8:
          i = Oe;
          break;
        case 32:
          i = Je;
          break;
        case 268435456:
          i = xt;
          break;
        default:
          i = Je;
      }
      return o = C0.bind(null, e), i = Hr(i, o), e.callbackPriority = n, e.callbackNode = i, n;
    }
    return o !== null && o !== null && Tn(o), e.callbackPriority = 2, e.callbackNode = null, 2;
  }
  function C0(e, n) {
    if (hn !== 0 && hn !== 5)
      return e.callbackNode = null, e.callbackPriority = 0, null;
    var i = e.callbackNode;
    if (pc() && e.callbackNode !== i)
      return null;
    var o = pt;
    return o = Pi(
      e,
      e === Dt ? o : 0,
      e.cancelPendingCommit !== null || e.timeoutHandle !== -1
    ), o === 0 ? null : (i0(e, o, n), k0(e, mn()), e.callbackNode != null && e.callbackNode === i ? C0.bind(null, e) : null);
  }
  function E0(e, n) {
    if (pc()) return null;
    i0(e, n, !0);
  }
  function F2() {
    tv(function() {
      (jt & 6) !== 0 ? Hr(
        ve,
        H2
      ) : w0();
    });
  }
  function $f() {
    if (Si === 0) {
      var e = io;
      e === 0 && (e = He, He <<= 1, (He & 261888) === 0 && (He = 256)), Si = e;
    }
    return Si;
  }
  function j0(e) {
    return e == null || typeof e == "symbol" || typeof e == "boolean" ? null : typeof e == "function" ? e : Dr("" + e);
  }
  function _0(e, n) {
    var i = n.ownerDocument.createElement("input");
    return i.name = n.name, i.value = n.value, e.id && i.setAttribute("form", e.id), n.parentNode.insertBefore(i, n), e = new FormData(e), i.parentNode.removeChild(i), e;
  }
  function $2(e, n, i, o, h) {
    if (n === "submit" && i && i.stateNode === h) {
      var b = j0(
        (h[Wt] || null).action
      ), C = o.submitter;
      C && (n = (n = C[Wt] || null) ? j0(n.formAction) : C.getAttribute("formAction"), n !== null && (b = n, C = null));
      var T = new Pl(
        "action",
        "action",
        null,
        o,
        h
      );
      e.push({
        event: T,
        listeners: [
          {
            instance: null,
            listener: function() {
              if (o.defaultPrevented) {
                if (Si !== 0) {
                  var P = C ? _0(h, C) : new FormData(h);
                  cf(
                    i,
                    {
                      pending: !0,
                      data: P,
                      method: h.method,
                      action: b
                    },
                    null,
                    P
                  );
                }
              } else
                typeof b == "function" && (T.preventDefault(), P = C ? _0(h, C) : new FormData(h), cf(
                  i,
                  {
                    pending: !0,
                    data: P,
                    method: h.method,
                    action: b
                  },
                  b,
                  P
                ));
            },
            currentTarget: h
          }
        ]
      });
    }
  }
  for (var Gf = 0; Gf < Pe.length; Gf++) {
    var Vf = Pe[Gf], G2 = Vf.toLowerCase(), V2 = Vf[0].toUpperCase() + Vf.slice(1);
    Me(
      G2,
      "on" + V2
    );
  }
  Me(ae, "onAnimationEnd"), Me(ue, "onAnimationIteration"), Me(xe, "onAnimationStart"), Me("dblclick", "onDoubleClick"), Me("focusin", "onFocus"), Me("focusout", "onBlur"), Me(Ce, "onTransitionRun"), Me(De, "onTransitionStart"), Me(qe, "onTransitionCancel"), Me(Ae, "onTransitionEnd"), Kr("onMouseEnter", ["mouseout", "mouseover"]), Kr("onMouseLeave", ["mouseout", "mouseover"]), Kr("onPointerEnter", ["pointerout", "pointerover"]), Kr("onPointerLeave", ["pointerout", "pointerover"]), Rr(
    "onChange",
    "change click focusin focusout input keydown keyup selectionchange".split(" ")
  ), Rr(
    "onSelect",
    "focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(
      " "
    )
  ), Rr("onBeforeInput", [
    "compositionend",
    "keypress",
    "textInput",
    "paste"
  ]), Rr(
    "onCompositionEnd",
    "compositionend focusout keydown keypress keyup mousedown".split(" ")
  ), Rr(
    "onCompositionStart",
    "compositionstart focusout keydown keypress keyup mousedown".split(" ")
  ), Rr(
    "onCompositionUpdate",
    "compositionupdate focusout keydown keypress keyup mousedown".split(" ")
  );
  var Os = "abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(
    " "
  ), K2 = new Set(
    "beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Os)
  );
  function N0(e, n) {
    n = (n & 4) !== 0;
    for (var i = 0; i < e.length; i++) {
      var o = e[i], h = o.event;
      o = o.listeners;
      e: {
        var b = void 0;
        if (n)
          for (var C = o.length - 1; 0 <= C; C--) {
            var T = o[C], P = T.instance, le = T.currentTarget;
            if (T = T.listener, P !== b && h.isPropagationStopped())
              break e;
            b = T, h.currentTarget = le;
            try {
              b(h);
            } catch (Se) {
              $e(Se);
            }
            h.currentTarget = null, b = P;
          }
        else
          for (C = 0; C < o.length; C++) {
            if (T = o[C], P = T.instance, le = T.currentTarget, T = T.listener, P !== b && h.isPropagationStopped())
              break e;
            b = T, h.currentTarget = le;
            try {
              b(h);
            } catch (Se) {
              $e(Se);
            }
            h.currentTarget = null, b = P;
          }
      }
    }
  }
  function ft(e, n) {
    var i = n[Qa];
    i === void 0 && (i = n[Qa] = /* @__PURE__ */ new Set());
    var o = e + "__bubble";
    i.has(o) || (T0(n, e, 2, !1), i.add(o));
  }
  function Kf(e, n, i) {
    var o = 0;
    n && (o |= 4), T0(
      i,
      e,
      o,
      n
    );
  }
  var bc = "_reactListening" + Math.random().toString(36).slice(2);
  function Yf(e) {
    if (!e[bc]) {
      e[bc] = !0, ga.forEach(function(i) {
        i !== "selectionchange" && (K2.has(i) || Kf(i, !1, e), Kf(i, !0, e));
      });
      var n = e.nodeType === 9 ? e : e.ownerDocument;
      n === null || n[bc] || (n[bc] = !0, Kf("selectionchange", !1, n));
    }
  }
  function T0(e, n, i, o) {
    switch (a1(n)) {
      case 2:
        var h = Sv;
        break;
      case 8:
        h = wv;
        break;
      default:
        h = uh;
    }
    i = h.bind(
      null,
      n,
      i,
      e
    ), h = void 0, !Xo || n !== "touchstart" && n !== "touchmove" && n !== "wheel" || (h = !0), o ? h !== void 0 ? e.addEventListener(n, i, {
      capture: !0,
      passive: h
    }) : e.addEventListener(n, i, !0) : h !== void 0 ? e.addEventListener(n, i, {
      passive: h
    }) : e.addEventListener(n, i, !1);
  }
  function Qf(e, n, i, o, h) {
    var b = o;
    if ((n & 1) === 0 && (n & 2) === 0 && o !== null)
      e: for (; ; ) {
        if (o === null) return;
        var C = o.tag;
        if (C === 3 || C === 4) {
          var T = o.stateNode.containerInfo;
          if (T === h) break;
          if (C === 4)
            for (C = o.return; C !== null; ) {
              var P = C.tag;
              if ((P === 3 || P === 4) && C.stateNode.containerInfo === h)
                return;
              C = C.return;
            }
          for (; T !== null; ) {
            if (C = Vr(T), C === null) return;
            if (P = C.tag, P === 5 || P === 6 || P === 26 || P === 27) {
              o = b = C;
              continue e;
            }
            T = T.parentNode;
          }
        }
        o = o.return;
      }
    Wa(function() {
      var le = b, Se = Il(i), Ee = [];
      e: {
        var ce = Le.get(e);
        if (ce !== void 0) {
          var pe = Pl, Ve = e;
          switch (e) {
            case "keypress":
              if (ei(i) === 0) break e;
            case "keydown":
            case "keyup":
              pe = Kl;
              break;
            case "focusin":
              Ve = "focus", pe = ti;
              break;
            case "focusout":
              Ve = "blur", pe = ti;
              break;
            case "beforeblur":
            case "afterblur":
              pe = ti;
              break;
            case "click":
              if (i.button === 2) break e;
            case "auxclick":
            case "dblclick":
            case "mousedown":
            case "mousemove":
            case "mouseup":
            case "mouseout":
            case "mouseover":
            case "contextmenu":
              pe = Fl;
              break;
            case "drag":
            case "dragend":
            case "dragenter":
            case "dragexit":
            case "dragleave":
            case "dragover":
            case "dragstart":
            case "drop":
              pe = Eu;
              break;
            case "touchcancel":
            case "touchend":
            case "touchmove":
            case "touchstart":
              pe = rs;
              break;
            case ae:
            case ue:
            case xe:
              pe = ju;
              break;
            case Ae:
              pe = as;
              break;
            case "scroll":
            case "scrollend":
              pe = ql;
              break;
            case "wheel":
              pe = Ql;
              break;
            case "copy":
            case "cut":
            case "paste":
              pe = ni;
              break;
            case "gotpointercapture":
            case "lostpointercapture":
            case "pointercancel":
            case "pointerdown":
            case "pointermove":
            case "pointerout":
            case "pointerover":
            case "pointerup":
              pe = ns;
              break;
            case "toggle":
            case "beforetoggle":
              pe = Tu;
          }
          var tt = (n & 4) !== 0, zt = !tt && (e === "scroll" || e === "scrollend"), ne = tt ? ce !== null ? ce + "Capture" : null : ce;
          tt = [];
          for (var G = le, ie; G !== null; ) {
            var ke = G;
            if (ie = ke.stateNode, ke = ke.tag, ke !== 5 && ke !== 26 && ke !== 27 || ie === null || ne === null || (ke = Sa(G, ne), ke != null && tt.push(
              Ds(G, ke, ie)
            )), zt) break;
            G = G.return;
          }
          0 < tt.length && (ce = new pe(
            ce,
            Ve,
            null,
            i,
            Se
          ), Ee.push({ event: ce, listeners: tt }));
        }
      }
      if ((n & 7) === 0) {
        e: {
          if (ce = e === "mouseover" || e === "pointerover", pe = e === "mouseout" || e === "pointerout", ce && i !== br && (Ve = i.relatedTarget || i.fromElement) && (Vr(Ve) || Ve[In]))
            break e;
          if ((pe || ce) && (ce = Se.window === Se ? Se : (ce = Se.ownerDocument) ? ce.defaultView || ce.parentWindow : window, pe ? (Ve = i.relatedTarget || i.toElement, pe = le, Ve = Ve ? Vr(Ve) : null, Ve !== null && (zt = c(Ve), tt = Ve.tag, Ve !== zt || tt !== 5 && tt !== 27 && tt !== 6) && (Ve = null)) : (pe = null, Ve = le), pe !== Ve)) {
            if (tt = Fl, ke = "onMouseLeave", ne = "onMouseEnter", G = "mouse", (e === "pointerout" || e === "pointerover") && (tt = ns, ke = "onPointerLeave", ne = "onPointerEnter", G = "pointer"), zt = pe == null ? ce : ar(pe), ie = Ve == null ? ce : ar(Ve), ce = new tt(
              ke,
              G + "leave",
              pe,
              i,
              Se
            ), ce.target = zt, ce.relatedTarget = ie, ke = null, Vr(Se) === le && (tt = new tt(
              ne,
              G + "enter",
              Ve,
              i,
              Se
            ), tt.target = ie, tt.relatedTarget = zt, ke = tt), zt = ke, pe && Ve)
              t: {
                for (tt = Y2, ne = pe, G = Ve, ie = 0, ke = ne; ke; ke = tt(ke))
                  ie++;
                ke = 0;
                for (var Ze = G; Ze; Ze = tt(Ze))
                  ke++;
                for (; 0 < ie - ke; )
                  ne = tt(ne), ie--;
                for (; 0 < ke - ie; )
                  G = tt(G), ke--;
                for (; ie--; ) {
                  if (ne === G || G !== null && ne === G.alternate) {
                    tt = ne;
                    break t;
                  }
                  ne = tt(ne), G = tt(G);
                }
                tt = null;
              }
            else tt = null;
            pe !== null && A0(
              Ee,
              ce,
              pe,
              tt,
              !1
            ), Ve !== null && zt !== null && A0(
              Ee,
              zt,
              Ve,
              tt,
              !0
            );
          }
        }
        e: {
          if (ce = le ? ar(le) : window, pe = ce.nodeName && ce.nodeName.toLowerCase(), pe === "select" || pe === "input" && ce.type === "file")
            var kt = nl;
          else if (Zl(ce))
            if (vr)
              kt = ii;
            else {
              kt = ja;
              var Qe = Du;
            }
          else
            pe = ce.nodeName, !pe || pe.toLowerCase() !== "input" || ce.type !== "checkbox" && ce.type !== "radio" ? le && Qo(le.elementType) && (kt = nl) : kt = us;
          if (kt && (kt = kt(e, le))) {
            ss(
              Ee,
              kt,
              i,
              Se
            );
            break e;
          }
          Qe && Qe(e, ce, le), e === "focusout" && le && ce.type === "number" && le.memoizedProps.value != null && Yi(ce, "number", ce.value);
        }
        switch (Qe = le ? ar(le) : window, e) {
          case "focusin":
            (Zl(Qe) || Qe.contentEditable === "true") && (B = Qe, H = le, F = null);
            break;
          case "focusout":
            F = H = B = null;
            break;
          case "mousedown":
            J = !0;
            break;
          case "contextmenu":
          case "mouseup":
          case "dragend":
            J = !1, q(Ee, i, Se);
            break;
          case "selectionchange":
            if (z) break;
          case "keydown":
          case "keyup":
            q(Ee, i, Se);
        }
        var st;
        if (el)
          e: {
            switch (e) {
              case "compositionstart":
                var gt = "onCompositionStart";
                break e;
              case "compositionend":
                gt = "onCompositionEnd";
                break e;
              case "compositionupdate":
                gt = "onCompositionUpdate";
                break e;
            }
            gt = void 0;
          }
        else
          Ea ? os(e, i) && (gt = "onCompositionEnd") : e === "keydown" && i.keyCode === 229 && (gt = "onCompositionStart");
        gt && (Xl && i.locale !== "ko" && (Ea || gt !== "onCompositionStart" ? gt === "onCompositionEnd" && Ea && (st = Ja()) : (xr = Se, Ul = "value" in xr ? xr.value : xr.textContent, Ea = !0)), Qe = xc(le, gt), 0 < Qe.length && (gt = new Vl(
          gt,
          e,
          null,
          i,
          Se
        ), Ee.push({ event: gt, listeners: Qe }), st ? gt.data = st : (st = Mu(i), st !== null && (gt.data = st)))), (st = jd ? zu(e, i) : _d(e, i)) && (gt = xc(le, "onBeforeInput"), 0 < gt.length && (Qe = new Vl(
          "onBeforeInput",
          "beforeinput",
          null,
          i,
          Se
        ), Ee.push({
          event: Qe,
          listeners: gt
        }), Qe.data = st)), $2(
          Ee,
          e,
          le,
          i,
          Se
        );
      }
      N0(Ee, n);
    });
  }
  function Ds(e, n, i) {
    return {
      instance: e,
      listener: n,
      currentTarget: i
    };
  }
  function xc(e, n) {
    for (var i = n + "Capture", o = []; e !== null; ) {
      var h = e, b = h.stateNode;
      if (h = h.tag, h !== 5 && h !== 26 && h !== 27 || b === null || (h = Sa(e, i), h != null && o.unshift(
        Ds(e, h, b)
      ), h = Sa(e, n), h != null && o.push(
        Ds(e, h, b)
      )), e.tag === 3) return o;
      e = e.return;
    }
    return [];
  }
  function Y2(e) {
    if (e === null) return null;
    do
      e = e.return;
    while (e && e.tag !== 5 && e.tag !== 27);
    return e || null;
  }
  function A0(e, n, i, o, h) {
    for (var b = n._reactName, C = []; i !== null && i !== o; ) {
      var T = i, P = T.alternate, le = T.stateNode;
      if (T = T.tag, P !== null && P === o) break;
      T !== 5 && T !== 26 && T !== 27 || le === null || (P = le, h ? (le = Sa(i, b), le != null && C.unshift(
        Ds(i, le, P)
      )) : h || (le = Sa(i, b), le != null && C.push(
        Ds(i, le, P)
      ))), i = i.return;
    }
    C.length !== 0 && e.push({ event: n, listeners: C });
  }
  var Q2 = /\r\n?/g, X2 = /\u0000|\uFFFD/g;
  function M0(e) {
    return (typeof e == "string" ? e : "" + e).replace(Q2, `
`).replace(X2, "");
  }
  function z0(e, n) {
    return n = M0(n), M0(e) === n;
  }
  function Mt(e, n, i, o, h, b) {
    switch (i) {
      case "children":
        typeof o == "string" ? n === "body" || n === "textarea" && o === "" || ba(e, o) : (typeof o == "number" || typeof o == "bigint") && n !== "body" && ba(e, "" + o);
        break;
      case "className":
        Vi(e, "class", o);
        break;
      case "tabIndex":
        Vi(e, "tabindex", o);
        break;
      case "dir":
      case "role":
      case "viewBox":
      case "width":
      case "height":
        Vi(e, i, o);
        break;
      case "style":
        Yo(e, o, b);
        break;
      case "data":
        if (n !== "object") {
          Vi(e, "data", o);
          break;
        }
      case "src":
      case "href":
        if (o === "" && (n !== "a" || i !== "href")) {
          e.removeAttribute(i);
          break;
        }
        if (o == null || typeof o == "function" || typeof o == "symbol" || typeof o == "boolean") {
          e.removeAttribute(i);
          break;
        }
        o = Dr("" + o), e.setAttribute(i, o);
        break;
      case "action":
      case "formAction":
        if (typeof o == "function") {
          e.setAttribute(
            i,
            "javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')"
          );
          break;
        } else
          typeof b == "function" && (i === "formAction" ? (n !== "input" && Mt(e, n, "name", h.name, h, null), Mt(
            e,
            n,
            "formEncType",
            h.formEncType,
            h,
            null
          ), Mt(
            e,
            n,
            "formMethod",
            h.formMethod,
            h,
            null
          ), Mt(
            e,
            n,
            "formTarget",
            h.formTarget,
            h,
            null
          )) : (Mt(e, n, "encType", h.encType, h, null), Mt(e, n, "method", h.method, h, null), Mt(e, n, "target", h.target, h, null)));
        if (o == null || typeof o == "symbol" || typeof o == "boolean") {
          e.removeAttribute(i);
          break;
        }
        o = Dr("" + o), e.setAttribute(i, o);
        break;
      case "onClick":
        o != null && (e.onclick = Gn);
        break;
      case "onScroll":
        o != null && ft("scroll", e);
        break;
      case "onScrollEnd":
        o != null && ft("scrollend", e);
        break;
      case "dangerouslySetInnerHTML":
        if (o != null) {
          if (typeof o != "object" || !("__html" in o))
            throw Error(l(61));
          if (i = o.__html, i != null) {
            if (h.children != null) throw Error(l(60));
            e.innerHTML = i;
          }
        }
        break;
      case "multiple":
        e.multiple = o && typeof o != "function" && typeof o != "symbol";
        break;
      case "muted":
        e.muted = o && typeof o != "function" && typeof o != "symbol";
        break;
      case "suppressContentEditableWarning":
      case "suppressHydrationWarning":
      case "defaultValue":
      case "defaultChecked":
      case "innerHTML":
      case "ref":
        break;
      case "autoFocus":
        break;
      case "xlinkHref":
        if (o == null || typeof o == "function" || typeof o == "boolean" || typeof o == "symbol") {
          e.removeAttribute("xlink:href");
          break;
        }
        i = Dr("" + o), e.setAttributeNS(
          "http://www.w3.org/1999/xlink",
          "xlink:href",
          i
        );
        break;
      case "contentEditable":
      case "spellCheck":
      case "draggable":
      case "value":
      case "autoReverse":
      case "externalResourcesRequired":
      case "focusable":
      case "preserveAlpha":
        o != null && typeof o != "function" && typeof o != "symbol" ? e.setAttribute(i, "" + o) : e.removeAttribute(i);
        break;
      case "inert":
      case "allowFullScreen":
      case "async":
      case "autoPlay":
      case "controls":
      case "default":
      case "defer":
      case "disabled":
      case "disablePictureInPicture":
      case "disableRemotePlayback":
      case "formNoValidate":
      case "hidden":
      case "loop":
      case "noModule":
      case "noValidate":
      case "open":
      case "playsInline":
      case "readOnly":
      case "required":
      case "reversed":
      case "scoped":
      case "seamless":
      case "itemScope":
        o && typeof o != "function" && typeof o != "symbol" ? e.setAttribute(i, "") : e.removeAttribute(i);
        break;
      case "capture":
      case "download":
        o === !0 ? e.setAttribute(i, "") : o !== !1 && o != null && typeof o != "function" && typeof o != "symbol" ? e.setAttribute(i, o) : e.removeAttribute(i);
        break;
      case "cols":
      case "rows":
      case "size":
      case "span":
        o != null && typeof o != "function" && typeof o != "symbol" && !isNaN(o) && 1 <= o ? e.setAttribute(i, o) : e.removeAttribute(i);
        break;
      case "rowSpan":
      case "start":
        o == null || typeof o == "function" || typeof o == "symbol" || isNaN(o) ? e.removeAttribute(i) : e.setAttribute(i, o);
        break;
      case "popover":
        ft("beforetoggle", e), ft("toggle", e), ct(e, "popover", o);
        break;
      case "xlinkActuate":
        yr(
          e,
          "http://www.w3.org/1999/xlink",
          "xlink:actuate",
          o
        );
        break;
      case "xlinkArcrole":
        yr(
          e,
          "http://www.w3.org/1999/xlink",
          "xlink:arcrole",
          o
        );
        break;
      case "xlinkRole":
        yr(
          e,
          "http://www.w3.org/1999/xlink",
          "xlink:role",
          o
        );
        break;
      case "xlinkShow":
        yr(
          e,
          "http://www.w3.org/1999/xlink",
          "xlink:show",
          o
        );
        break;
      case "xlinkTitle":
        yr(
          e,
          "http://www.w3.org/1999/xlink",
          "xlink:title",
          o
        );
        break;
      case "xlinkType":
        yr(
          e,
          "http://www.w3.org/1999/xlink",
          "xlink:type",
          o
        );
        break;
      case "xmlBase":
        yr(
          e,
          "http://www.w3.org/XML/1998/namespace",
          "xml:base",
          o
        );
        break;
      case "xmlLang":
        yr(
          e,
          "http://www.w3.org/XML/1998/namespace",
          "xml:lang",
          o
        );
        break;
      case "xmlSpace":
        yr(
          e,
          "http://www.w3.org/XML/1998/namespace",
          "xml:space",
          o
        );
        break;
      case "is":
        ct(e, "is", o);
        break;
      case "innerText":
      case "textContent":
        break;
      default:
        (!(2 < i.length) || i[0] !== "o" && i[0] !== "O" || i[1] !== "n" && i[1] !== "N") && (i = kd.get(i) || i, ct(e, i, o));
    }
  }
  function Xf(e, n, i, o, h, b) {
    switch (i) {
      case "style":
        Yo(e, o, b);
        break;
      case "dangerouslySetInnerHTML":
        if (o != null) {
          if (typeof o != "object" || !("__html" in o))
            throw Error(l(61));
          if (i = o.__html, i != null) {
            if (h.children != null) throw Error(l(60));
            e.innerHTML = i;
          }
        }
        break;
      case "children":
        typeof o == "string" ? ba(e, o) : (typeof o == "number" || typeof o == "bigint") && ba(e, "" + o);
        break;
      case "onScroll":
        o != null && ft("scroll", e);
        break;
      case "onScrollEnd":
        o != null && ft("scrollend", e);
        break;
      case "onClick":
        o != null && (e.onclick = Gn);
        break;
      case "suppressContentEditableWarning":
      case "suppressHydrationWarning":
      case "innerHTML":
      case "ref":
        break;
      case "innerText":
      case "textContent":
        break;
      default:
        if (!$i.hasOwnProperty(i))
          e: {
            if (i[0] === "o" && i[1] === "n" && (h = i.endsWith("Capture"), n = i.slice(2, h ? i.length - 7 : void 0), b = e[Wt] || null, b = b != null ? b[i] : null, typeof b == "function" && e.removeEventListener(n, b, h), typeof o == "function")) {
              typeof b != "function" && b !== null && (i in e ? e[i] = null : e.hasAttribute(i) && e.removeAttribute(i)), e.addEventListener(n, o, h);
              break e;
            }
            i in e ? e[i] = o : o === !0 ? e.setAttribute(i, "") : ct(e, i, o);
          }
    }
  }
  function jn(e, n, i) {
    switch (n) {
      case "div":
      case "span":
      case "svg":
      case "path":
      case "a":
      case "g":
      case "p":
      case "li":
        break;
      case "img":
        ft("error", e), ft("load", e);
        var o = !1, h = !1, b;
        for (b in i)
          if (i.hasOwnProperty(b)) {
            var C = i[b];
            if (C != null)
              switch (b) {
                case "src":
                  o = !0;
                  break;
                case "srcSet":
                  h = !0;
                  break;
                case "children":
                case "dangerouslySetInnerHTML":
                  throw Error(l(137, n));
                default:
                  Mt(e, n, b, C, i, null);
              }
          }
        h && Mt(e, n, "srcSet", i.srcSet, i, null), o && Mt(e, n, "src", i.src, i, null);
        return;
      case "input":
        ft("invalid", e);
        var T = b = C = h = null, P = null, le = null;
        for (o in i)
          if (i.hasOwnProperty(o)) {
            var Se = i[o];
            if (Se != null)
              switch (o) {
                case "name":
                  h = Se;
                  break;
                case "type":
                  C = Se;
                  break;
                case "checked":
                  P = Se;
                  break;
                case "defaultChecked":
                  le = Se;
                  break;
                case "value":
                  b = Se;
                  break;
                case "defaultValue":
                  T = Se;
                  break;
                case "children":
                case "dangerouslySetInnerHTML":
                  if (Se != null)
                    throw Error(l(137, n));
                  break;
                default:
                  Mt(e, n, o, Se, i, null);
              }
          }
        Bl(
          e,
          b,
          T,
          P,
          le,
          C,
          h,
          !1
        );
        return;
      case "select":
        ft("invalid", e), o = C = b = null;
        for (h in i)
          if (i.hasOwnProperty(h) && (T = i[h], T != null))
            switch (h) {
              case "value":
                b = T;
                break;
              case "defaultValue":
                C = T;
                break;
              case "multiple":
                o = T;
              default:
                Mt(e, n, h, T, i, null);
            }
        n = b, i = C, e.multiple = !!o, n != null ? Or(e, !!o, n, !1) : i != null && Or(e, !!o, i, !0);
        return;
      case "textarea":
        ft("invalid", e), b = h = o = null;
        for (C in i)
          if (i.hasOwnProperty(C) && (T = i[C], T != null))
            switch (C) {
              case "value":
                o = T;
                break;
              case "defaultValue":
                h = T;
                break;
              case "children":
                b = T;
                break;
              case "dangerouslySetInnerHTML":
                if (T != null) throw Error(l(91));
                break;
              default:
                Mt(e, n, C, T, i, null);
            }
        Qi(e, o, h, b);
        return;
      case "option":
        for (P in i)
          if (i.hasOwnProperty(P) && (o = i[P], o != null))
            switch (P) {
              case "selected":
                e.selected = o && typeof o != "function" && typeof o != "symbol";
                break;
              default:
                Mt(e, n, P, o, i, null);
            }
        return;
      case "dialog":
        ft("beforetoggle", e), ft("toggle", e), ft("cancel", e), ft("close", e);
        break;
      case "iframe":
      case "object":
        ft("load", e);
        break;
      case "video":
      case "audio":
        for (o = 0; o < Os.length; o++)
          ft(Os[o], e);
        break;
      case "image":
        ft("error", e), ft("load", e);
        break;
      case "details":
        ft("toggle", e);
        break;
      case "embed":
      case "source":
      case "link":
        ft("error", e), ft("load", e);
      case "area":
      case "base":
      case "br":
      case "col":
      case "hr":
      case "keygen":
      case "meta":
      case "param":
      case "track":
      case "wbr":
      case "menuitem":
        for (le in i)
          if (i.hasOwnProperty(le) && (o = i[le], o != null))
            switch (le) {
              case "children":
              case "dangerouslySetInnerHTML":
                throw Error(l(137, n));
              default:
                Mt(e, n, le, o, i, null);
            }
        return;
      default:
        if (Qo(n)) {
          for (Se in i)
            i.hasOwnProperty(Se) && (o = i[Se], o !== void 0 && Xf(
              e,
              n,
              Se,
              o,
              i,
              void 0
            ));
          return;
        }
    }
    for (T in i)
      i.hasOwnProperty(T) && (o = i[T], o != null && Mt(e, n, T, o, i, null));
  }
  function W2(e, n, i, o) {
    switch (n) {
      case "div":
      case "span":
      case "svg":
      case "path":
      case "a":
      case "g":
      case "p":
      case "li":
        break;
      case "input":
        var h = null, b = null, C = null, T = null, P = null, le = null, Se = null;
        for (pe in i) {
          var Ee = i[pe];
          if (i.hasOwnProperty(pe) && Ee != null)
            switch (pe) {
              case "checked":
                break;
              case "value":
                break;
              case "defaultValue":
                P = Ee;
              default:
                o.hasOwnProperty(pe) || Mt(e, n, pe, null, o, Ee);
            }
        }
        for (var ce in o) {
          var pe = o[ce];
          if (Ee = i[ce], o.hasOwnProperty(ce) && (pe != null || Ee != null))
            switch (ce) {
              case "type":
                b = pe;
                break;
              case "name":
                h = pe;
                break;
              case "checked":
                le = pe;
                break;
              case "defaultChecked":
                Se = pe;
                break;
              case "value":
                C = pe;
                break;
              case "defaultValue":
                T = pe;
                break;
              case "children":
              case "dangerouslySetInnerHTML":
                if (pe != null)
                  throw Error(l(137, n));
                break;
              default:
                pe !== Ee && Mt(
                  e,
                  n,
                  ce,
                  pe,
                  o,
                  Ee
                );
            }
        }
        Yr(
          e,
          C,
          T,
          P,
          le,
          Se,
          b,
          h
        );
        return;
      case "select":
        pe = C = T = ce = null;
        for (b in i)
          if (P = i[b], i.hasOwnProperty(b) && P != null)
            switch (b) {
              case "value":
                break;
              case "multiple":
                pe = P;
              default:
                o.hasOwnProperty(b) || Mt(
                  e,
                  n,
                  b,
                  null,
                  o,
                  P
                );
            }
        for (h in o)
          if (b = o[h], P = i[h], o.hasOwnProperty(h) && (b != null || P != null))
            switch (h) {
              case "value":
                ce = b;
                break;
              case "defaultValue":
                T = b;
                break;
              case "multiple":
                C = b;
              default:
                b !== P && Mt(
                  e,
                  n,
                  h,
                  b,
                  o,
                  P
                );
            }
        n = T, i = C, o = pe, ce != null ? Or(e, !!i, ce, !1) : !!o != !!i && (n != null ? Or(e, !!i, n, !0) : Or(e, !!i, i ? [] : "", !1));
        return;
      case "textarea":
        pe = ce = null;
        for (T in i)
          if (h = i[T], i.hasOwnProperty(T) && h != null && !o.hasOwnProperty(T))
            switch (T) {
              case "value":
                break;
              case "children":
                break;
              default:
                Mt(e, n, T, null, o, h);
            }
        for (C in o)
          if (h = o[C], b = i[C], o.hasOwnProperty(C) && (h != null || b != null))
            switch (C) {
              case "value":
                ce = h;
                break;
              case "defaultValue":
                pe = h;
                break;
              case "children":
                break;
              case "dangerouslySetInnerHTML":
                if (h != null) throw Error(l(91));
                break;
              default:
                h !== b && Mt(e, n, C, h, o, b);
            }
        Ko(e, ce, pe);
        return;
      case "option":
        for (var Ve in i)
          if (ce = i[Ve], i.hasOwnProperty(Ve) && ce != null && !o.hasOwnProperty(Ve))
            switch (Ve) {
              case "selected":
                e.selected = !1;
                break;
              default:
                Mt(
                  e,
                  n,
                  Ve,
                  null,
                  o,
                  ce
                );
            }
        for (P in o)
          if (ce = o[P], pe = i[P], o.hasOwnProperty(P) && ce !== pe && (ce != null || pe != null))
            switch (P) {
              case "selected":
                e.selected = ce && typeof ce != "function" && typeof ce != "symbol";
                break;
              default:
                Mt(
                  e,
                  n,
                  P,
                  ce,
                  o,
                  pe
                );
            }
        return;
      case "img":
      case "link":
      case "area":
      case "base":
      case "br":
      case "col":
      case "embed":
      case "hr":
      case "keygen":
      case "meta":
      case "param":
      case "source":
      case "track":
      case "wbr":
      case "menuitem":
        for (var tt in i)
          ce = i[tt], i.hasOwnProperty(tt) && ce != null && !o.hasOwnProperty(tt) && Mt(e, n, tt, null, o, ce);
        for (le in o)
          if (ce = o[le], pe = i[le], o.hasOwnProperty(le) && ce !== pe && (ce != null || pe != null))
            switch (le) {
              case "children":
              case "dangerouslySetInnerHTML":
                if (ce != null)
                  throw Error(l(137, n));
                break;
              default:
                Mt(
                  e,
                  n,
                  le,
                  ce,
                  o,
                  pe
                );
            }
        return;
      default:
        if (Qo(n)) {
          for (var zt in i)
            ce = i[zt], i.hasOwnProperty(zt) && ce !== void 0 && !o.hasOwnProperty(zt) && Xf(
              e,
              n,
              zt,
              void 0,
              o,
              ce
            );
          for (Se in o)
            ce = o[Se], pe = i[Se], !o.hasOwnProperty(Se) || ce === pe || ce === void 0 && pe === void 0 || Xf(
              e,
              n,
              Se,
              ce,
              o,
              pe
            );
          return;
        }
    }
    for (var ne in i)
      ce = i[ne], i.hasOwnProperty(ne) && ce != null && !o.hasOwnProperty(ne) && Mt(e, n, ne, null, o, ce);
    for (Ee in o)
      ce = o[Ee], pe = i[Ee], !o.hasOwnProperty(Ee) || ce === pe || ce == null && pe == null || Mt(e, n, Ee, ce, o, pe);
  }
  function R0(e) {
    switch (e) {
      case "css":
      case "script":
      case "font":
      case "img":
      case "image":
      case "input":
      case "link":
        return !0;
      default:
        return !1;
    }
  }
  function Z2() {
    if (typeof performance.getEntriesByType == "function") {
      for (var e = 0, n = 0, i = performance.getEntriesByType("resource"), o = 0; o < i.length; o++) {
        var h = i[o], b = h.transferSize, C = h.initiatorType, T = h.duration;
        if (b && T && R0(C)) {
          for (C = 0, T = h.responseEnd, o += 1; o < i.length; o++) {
            var P = i[o], le = P.startTime;
            if (le > T) break;
            var Se = P.transferSize, Ee = P.initiatorType;
            Se && R0(Ee) && (P = P.responseEnd, C += Se * (P < T ? 1 : (T - le) / (P - le)));
          }
          if (--o, n += 8 * (b + C) / (h.duration / 1e3), e++, 10 < e) break;
        }
      }
      if (0 < e) return n / e / 1e6;
    }
    return navigator.connection && (e = navigator.connection.downlink, typeof e == "number") ? e : 5;
  }
  var Wf = null, Zf = null;
  function vc(e) {
    return e.nodeType === 9 ? e : e.ownerDocument;
  }
  function O0(e) {
    switch (e) {
      case "http://www.w3.org/2000/svg":
        return 1;
      case "http://www.w3.org/1998/Math/MathML":
        return 2;
      default:
        return 0;
    }
  }
  function D0(e, n) {
    if (e === 0)
      switch (n) {
        case "svg":
          return 1;
        case "math":
          return 2;
        default:
          return 0;
      }
    return e === 1 && n === "foreignObject" ? 0 : e;
  }
  function Jf(e, n) {
    return e === "textarea" || e === "noscript" || typeof n.children == "string" || typeof n.children == "number" || typeof n.children == "bigint" || typeof n.dangerouslySetInnerHTML == "object" && n.dangerouslySetInnerHTML !== null && n.dangerouslySetInnerHTML.__html != null;
  }
  var eh = null;
  function J2() {
    var e = window.event;
    return e && e.type === "popstate" ? e === eh ? !1 : (eh = e, !0) : (eh = null, !1);
  }
  var L0 = typeof setTimeout == "function" ? setTimeout : void 0, ev = typeof clearTimeout == "function" ? clearTimeout : void 0, B0 = typeof Promise == "function" ? Promise : void 0, tv = typeof queueMicrotask == "function" ? queueMicrotask : typeof B0 < "u" ? function(e) {
    return B0.resolve(null).then(e).catch(nv);
  } : L0;
  function nv(e) {
    setTimeout(function() {
      throw e;
    });
  }
  function wi(e) {
    return e === "head";
  }
  function I0(e, n) {
    var i = n, o = 0;
    do {
      var h = i.nextSibling;
      if (e.removeChild(i), h && h.nodeType === 8)
        if (i = h.data, i === "/$" || i === "/&") {
          if (o === 0) {
            e.removeChild(h), Eo(n);
            return;
          }
          o--;
        } else if (i === "$" || i === "$?" || i === "$~" || i === "$!" || i === "&")
          o++;
        else if (i === "html")
          Ls(e.ownerDocument.documentElement);
        else if (i === "head") {
          i = e.ownerDocument.head, Ls(i);
          for (var b = i.firstChild; b; ) {
            var C = b.nextSibling, T = b.nodeName;
            b[rr] || T === "SCRIPT" || T === "STYLE" || T === "LINK" && b.rel.toLowerCase() === "stylesheet" || i.removeChild(b), b = C;
          }
        } else
          i === "body" && Ls(e.ownerDocument.body);
      i = h;
    } while (i);
    Eo(n);
  }
  function U0(e, n) {
    var i = e;
    e = 0;
    do {
      var o = i.nextSibling;
      if (i.nodeType === 1 ? n ? (i._stashedDisplay = i.style.display, i.style.display = "none") : (i.style.display = i._stashedDisplay || "", i.getAttribute("style") === "" && i.removeAttribute("style")) : i.nodeType === 3 && (n ? (i._stashedText = i.nodeValue, i.nodeValue = "") : i.nodeValue = i._stashedText || ""), o && o.nodeType === 8)
        if (i = o.data, i === "/$") {
          if (e === 0) break;
          e--;
        } else
          i !== "$" && i !== "$?" && i !== "$~" && i !== "$!" || e++;
      i = o;
    } while (i);
  }
  function th(e) {
    var n = e.firstChild;
    for (n && n.nodeType === 10 && (n = n.nextSibling); n; ) {
      var i = n;
      switch (n = n.nextSibling, i.nodeName) {
        case "HTML":
        case "HEAD":
        case "BODY":
          th(i), Dl(i);
          continue;
        case "SCRIPT":
        case "STYLE":
          continue;
        case "LINK":
          if (i.rel.toLowerCase() === "stylesheet") continue;
      }
      e.removeChild(i);
    }
  }
  function rv(e, n, i, o) {
    for (; e.nodeType === 1; ) {
      var h = i;
      if (e.nodeName.toLowerCase() !== n.toLowerCase()) {
        if (!o && (e.nodeName !== "INPUT" || e.type !== "hidden"))
          break;
      } else if (o) {
        if (!e[rr])
          switch (n) {
            case "meta":
              if (!e.hasAttribute("itemprop")) break;
              return e;
            case "link":
              if (b = e.getAttribute("rel"), b === "stylesheet" && e.hasAttribute("data-precedence"))
                break;
              if (b !== h.rel || e.getAttribute("href") !== (h.href == null || h.href === "" ? null : h.href) || e.getAttribute("crossorigin") !== (h.crossOrigin == null ? null : h.crossOrigin) || e.getAttribute("title") !== (h.title == null ? null : h.title))
                break;
              return e;
            case "style":
              if (e.hasAttribute("data-precedence")) break;
              return e;
            case "script":
              if (b = e.getAttribute("src"), (b !== (h.src == null ? null : h.src) || e.getAttribute("type") !== (h.type == null ? null : h.type) || e.getAttribute("crossorigin") !== (h.crossOrigin == null ? null : h.crossOrigin)) && b && e.hasAttribute("async") && !e.hasAttribute("itemprop"))
                break;
              return e;
            default:
              return e;
          }
      } else if (n === "input" && e.type === "hidden") {
        var b = h.name == null ? null : "" + h.name;
        if (h.type === "hidden" && e.getAttribute("name") === b)
          return e;
      } else return e;
      if (e = jr(e.nextSibling), e === null) break;
    }
    return null;
  }
  function av(e, n, i) {
    if (n === "") return null;
    for (; e.nodeType !== 3; )
      if ((e.nodeType !== 1 || e.nodeName !== "INPUT" || e.type !== "hidden") && !i || (e = jr(e.nextSibling), e === null)) return null;
    return e;
  }
  function P0(e, n) {
    for (; e.nodeType !== 8; )
      if ((e.nodeType !== 1 || e.nodeName !== "INPUT" || e.type !== "hidden") && !n || (e = jr(e.nextSibling), e === null)) return null;
    return e;
  }
  function nh(e) {
    return e.data === "$?" || e.data === "$~";
  }
  function rh(e) {
    return e.data === "$!" || e.data === "$?" && e.ownerDocument.readyState !== "loading";
  }
  function iv(e, n) {
    var i = e.ownerDocument;
    if (e.data === "$~") e._reactRetry = n;
    else if (e.data !== "$?" || i.readyState !== "loading")
      n();
    else {
      var o = function() {
        n(), i.removeEventListener("DOMContentLoaded", o);
      };
      i.addEventListener("DOMContentLoaded", o), e._reactRetry = o;
    }
  }
  function jr(e) {
    for (; e != null; e = e.nextSibling) {
      var n = e.nodeType;
      if (n === 1 || n === 3) break;
      if (n === 8) {
        if (n = e.data, n === "$" || n === "$!" || n === "$?" || n === "$~" || n === "&" || n === "F!" || n === "F")
          break;
        if (n === "/$" || n === "/&") return null;
      }
    }
    return e;
  }
  var ah = null;
  function q0(e) {
    e = e.nextSibling;
    for (var n = 0; e; ) {
      if (e.nodeType === 8) {
        var i = e.data;
        if (i === "/$" || i === "/&") {
          if (n === 0)
            return jr(e.nextSibling);
          n--;
        } else
          i !== "$" && i !== "$!" && i !== "$?" && i !== "$~" && i !== "&" || n++;
      }
      e = e.nextSibling;
    }
    return null;
  }
  function H0(e) {
    e = e.previousSibling;
    for (var n = 0; e; ) {
      if (e.nodeType === 8) {
        var i = e.data;
        if (i === "$" || i === "$!" || i === "$?" || i === "$~" || i === "&") {
          if (n === 0) return e;
          n--;
        } else i !== "/$" && i !== "/&" || n++;
      }
      e = e.previousSibling;
    }
    return null;
  }
  function F0(e, n, i) {
    switch (n = vc(i), e) {
      case "html":
        if (e = n.documentElement, !e) throw Error(l(452));
        return e;
      case "head":
        if (e = n.head, !e) throw Error(l(453));
        return e;
      case "body":
        if (e = n.body, !e) throw Error(l(454));
        return e;
      default:
        throw Error(l(451));
    }
  }
  function Ls(e) {
    for (var n = e.attributes; n.length; )
      e.removeAttributeNode(n[0]);
    Dl(e);
  }
  var _r = /* @__PURE__ */ new Map(), $0 = /* @__PURE__ */ new Set();
  function Sc(e) {
    return typeof e.getRootNode == "function" ? e.getRootNode() : e.nodeType === 9 ? e : e.ownerDocument;
  }
  var qa = _e.d;
  _e.d = {
    f: lv,
    r: ov,
    D: sv,
    C: uv,
    L: cv,
    m: dv,
    X: hv,
    S: fv,
    M: mv
  };
  function lv() {
    var e = qa.f(), n = fc();
    return e || n;
  }
  function ov(e) {
    var n = Tt(e);
    n !== null && n.tag === 5 && n.type === "form" ? og(n) : qa.r(e);
  }
  var wo = typeof document > "u" ? null : document;
  function G0(e, n, i) {
    var o = wo;
    if (o && typeof n == "string" && n) {
      var h = gn(n);
      h = 'link[rel="' + e + '"][href="' + h + '"]', typeof i == "string" && (h += '[crossorigin="' + i + '"]'), $0.has(h) || ($0.add(h), e = { rel: e, crossOrigin: i, href: n }, o.querySelector(h) === null && (n = o.createElement("link"), jn(n, "link", e), Zt(n), o.head.appendChild(n)));
    }
  }
  function sv(e) {
    qa.D(e), G0("dns-prefetch", e, null);
  }
  function uv(e, n) {
    qa.C(e, n), G0("preconnect", e, n);
  }
  function cv(e, n, i) {
    qa.L(e, n, i);
    var o = wo;
    if (o && e && n) {
      var h = 'link[rel="preload"][as="' + gn(n) + '"]';
      n === "image" && i && i.imageSrcSet ? (h += '[imagesrcset="' + gn(
        i.imageSrcSet
      ) + '"]', typeof i.imageSizes == "string" && (h += '[imagesizes="' + gn(
        i.imageSizes
      ) + '"]')) : h += '[href="' + gn(e) + '"]';
      var b = h;
      switch (n) {
        case "style":
          b = ko(e);
          break;
        case "script":
          b = Co(e);
      }
      _r.has(b) || (e = x(
        {
          rel: "preload",
          href: n === "image" && i && i.imageSrcSet ? void 0 : e,
          as: n
        },
        i
      ), _r.set(b, e), o.querySelector(h) !== null || n === "style" && o.querySelector(Bs(b)) || n === "script" && o.querySelector(Is(b)) || (n = o.createElement("link"), jn(n, "link", e), Zt(n), o.head.appendChild(n)));
    }
  }
  function dv(e, n) {
    qa.m(e, n);
    var i = wo;
    if (i && e) {
      var o = n && typeof n.as == "string" ? n.as : "script", h = 'link[rel="modulepreload"][as="' + gn(o) + '"][href="' + gn(e) + '"]', b = h;
      switch (o) {
        case "audioworklet":
        case "paintworklet":
        case "serviceworker":
        case "sharedworker":
        case "worker":
        case "script":
          b = Co(e);
      }
      if (!_r.has(b) && (e = x({ rel: "modulepreload", href: e }, n), _r.set(b, e), i.querySelector(h) === null)) {
        switch (o) {
          case "audioworklet":
          case "paintworklet":
          case "serviceworker":
          case "sharedworker":
          case "worker":
          case "script":
            if (i.querySelector(Is(b)))
              return;
        }
        o = i.createElement("link"), jn(o, "link", e), Zt(o), i.head.appendChild(o);
      }
    }
  }
  function fv(e, n, i) {
    qa.S(e, n, i);
    var o = wo;
    if (o && e) {
      var h = An(o).hoistableStyles, b = ko(e);
      n = n || "default";
      var C = h.get(b);
      if (!C) {
        var T = { loading: 0, preload: null };
        if (C = o.querySelector(
          Bs(b)
        ))
          T.loading = 5;
        else {
          e = x(
            { rel: "stylesheet", href: e, "data-precedence": n },
            i
          ), (i = _r.get(b)) && ih(e, i);
          var P = C = o.createElement("link");
          Zt(P), jn(P, "link", e), P._p = new Promise(function(le, Se) {
            P.onload = le, P.onerror = Se;
          }), P.addEventListener("load", function() {
            T.loading |= 1;
          }), P.addEventListener("error", function() {
            T.loading |= 2;
          }), T.loading |= 4, wc(C, n, o);
        }
        C = {
          type: "stylesheet",
          instance: C,
          count: 1,
          state: T
        }, h.set(b, C);
      }
    }
  }
  function hv(e, n) {
    qa.X(e, n);
    var i = wo;
    if (i && e) {
      var o = An(i).hoistableScripts, h = Co(e), b = o.get(h);
      b || (b = i.querySelector(Is(h)), b || (e = x({ src: e, async: !0 }, n), (n = _r.get(h)) && lh(e, n), b = i.createElement("script"), Zt(b), jn(b, "link", e), i.head.appendChild(b)), b = {
        type: "script",
        instance: b,
        count: 1,
        state: null
      }, o.set(h, b));
    }
  }
  function mv(e, n) {
    qa.M(e, n);
    var i = wo;
    if (i && e) {
      var o = An(i).hoistableScripts, h = Co(e), b = o.get(h);
      b || (b = i.querySelector(Is(h)), b || (e = x({ src: e, async: !0, type: "module" }, n), (n = _r.get(h)) && lh(e, n), b = i.createElement("script"), Zt(b), jn(b, "link", e), i.head.appendChild(b)), b = {
        type: "script",
        instance: b,
        count: 1,
        state: null
      }, o.set(h, b));
    }
  }
  function V0(e, n, i, o) {
    var h = (h = ye.current) ? Sc(h) : null;
    if (!h) throw Error(l(446));
    switch (e) {
      case "meta":
      case "title":
        return null;
      case "style":
        return typeof i.precedence == "string" && typeof i.href == "string" ? (n = ko(i.href), i = An(
          h
        ).hoistableStyles, o = i.get(n), o || (o = {
          type: "style",
          instance: null,
          count: 0,
          state: null
        }, i.set(n, o)), o) : { type: "void", instance: null, count: 0, state: null };
      case "link":
        if (i.rel === "stylesheet" && typeof i.href == "string" && typeof i.precedence == "string") {
          e = ko(i.href);
          var b = An(
            h
          ).hoistableStyles, C = b.get(e);
          if (C || (h = h.ownerDocument || h, C = {
            type: "stylesheet",
            instance: null,
            count: 0,
            state: { loading: 0, preload: null }
          }, b.set(e, C), (b = h.querySelector(
            Bs(e)
          )) && !b._p && (C.instance = b, C.state.loading = 5), _r.has(e) || (i = {
            rel: "preload",
            as: "style",
            href: i.href,
            crossOrigin: i.crossOrigin,
            integrity: i.integrity,
            media: i.media,
            hrefLang: i.hrefLang,
            referrerPolicy: i.referrerPolicy
          }, _r.set(e, i), b || pv(
            h,
            e,
            i,
            C.state
          ))), n && o === null)
            throw Error(l(528, ""));
          return C;
        }
        if (n && o !== null)
          throw Error(l(529, ""));
        return null;
      case "script":
        return n = i.async, i = i.src, typeof i == "string" && n && typeof n != "function" && typeof n != "symbol" ? (n = Co(i), i = An(
          h
        ).hoistableScripts, o = i.get(n), o || (o = {
          type: "script",
          instance: null,
          count: 0,
          state: null
        }, i.set(n, o)), o) : { type: "void", instance: null, count: 0, state: null };
      default:
        throw Error(l(444, e));
    }
  }
  function ko(e) {
    return 'href="' + gn(e) + '"';
  }
  function Bs(e) {
    return 'link[rel="stylesheet"][' + e + "]";
  }
  function K0(e) {
    return x({}, e, {
      "data-precedence": e.precedence,
      precedence: null
    });
  }
  function pv(e, n, i, o) {
    e.querySelector('link[rel="preload"][as="style"][' + n + "]") ? o.loading = 1 : (n = e.createElement("link"), o.preload = n, n.addEventListener("load", function() {
      return o.loading |= 1;
    }), n.addEventListener("error", function() {
      return o.loading |= 2;
    }), jn(n, "link", i), Zt(n), e.head.appendChild(n));
  }
  function Co(e) {
    return '[src="' + gn(e) + '"]';
  }
  function Is(e) {
    return "script[async]" + e;
  }
  function Y0(e, n, i) {
    if (n.count++, n.instance === null)
      switch (n.type) {
        case "style":
          var o = e.querySelector(
            'style[data-href~="' + gn(i.href) + '"]'
          );
          if (o)
            return n.instance = o, Zt(o), o;
          var h = x({}, i, {
            "data-href": i.href,
            "data-precedence": i.precedence,
            href: null,
            precedence: null
          });
          return o = (e.ownerDocument || e).createElement(
            "style"
          ), Zt(o), jn(o, "style", h), wc(o, i.precedence, e), n.instance = o;
        case "stylesheet":
          h = ko(i.href);
          var b = e.querySelector(
            Bs(h)
          );
          if (b)
            return n.state.loading |= 4, n.instance = b, Zt(b), b;
          o = K0(i), (h = _r.get(h)) && ih(o, h), b = (e.ownerDocument || e).createElement("link"), Zt(b);
          var C = b;
          return C._p = new Promise(function(T, P) {
            C.onload = T, C.onerror = P;
          }), jn(b, "link", o), n.state.loading |= 4, wc(b, i.precedence, e), n.instance = b;
        case "script":
          return b = Co(i.src), (h = e.querySelector(
            Is(b)
          )) ? (n.instance = h, Zt(h), h) : (o = i, (h = _r.get(b)) && (o = x({}, i), lh(o, h)), e = e.ownerDocument || e, h = e.createElement("script"), Zt(h), jn(h, "link", o), e.head.appendChild(h), n.instance = h);
        case "void":
          return null;
        default:
          throw Error(l(443, n.type));
      }
    else
      n.type === "stylesheet" && (n.state.loading & 4) === 0 && (o = n.instance, n.state.loading |= 4, wc(o, i.precedence, e));
    return n.instance;
  }
  function wc(e, n, i) {
    for (var o = i.querySelectorAll(
      'link[rel="stylesheet"][data-precedence],style[data-precedence]'
    ), h = o.length ? o[o.length - 1] : null, b = h, C = 0; C < o.length; C++) {
      var T = o[C];
      if (T.dataset.precedence === n) b = T;
      else if (b !== h) break;
    }
    b ? b.parentNode.insertBefore(e, b.nextSibling) : (n = i.nodeType === 9 ? i.head : i, n.insertBefore(e, n.firstChild));
  }
  function ih(e, n) {
    e.crossOrigin == null && (e.crossOrigin = n.crossOrigin), e.referrerPolicy == null && (e.referrerPolicy = n.referrerPolicy), e.title == null && (e.title = n.title);
  }
  function lh(e, n) {
    e.crossOrigin == null && (e.crossOrigin = n.crossOrigin), e.referrerPolicy == null && (e.referrerPolicy = n.referrerPolicy), e.integrity == null && (e.integrity = n.integrity);
  }
  var kc = null;
  function Q0(e, n, i) {
    if (kc === null) {
      var o = /* @__PURE__ */ new Map(), h = kc = /* @__PURE__ */ new Map();
      h.set(i, o);
    } else
      h = kc, o = h.get(i), o || (o = /* @__PURE__ */ new Map(), h.set(i, o));
    if (o.has(e)) return o;
    for (o.set(e, null), i = i.getElementsByTagName(e), h = 0; h < i.length; h++) {
      var b = i[h];
      if (!(b[rr] || b[Bt] || e === "link" && b.getAttribute("rel") === "stylesheet") && b.namespaceURI !== "http://www.w3.org/2000/svg") {
        var C = b.getAttribute(n) || "";
        C = e + C;
        var T = o.get(C);
        T ? T.push(b) : o.set(C, [b]);
      }
    }
    return o;
  }
  function X0(e, n, i) {
    e = e.ownerDocument || e, e.head.insertBefore(
      i,
      n === "title" ? e.querySelector("head > title") : null
    );
  }
  function gv(e, n, i) {
    if (i === 1 || n.itemProp != null) return !1;
    switch (e) {
      case "meta":
      case "title":
        return !0;
      case "style":
        if (typeof n.precedence != "string" || typeof n.href != "string" || n.href === "")
          break;
        return !0;
      case "link":
        if (typeof n.rel != "string" || typeof n.href != "string" || n.href === "" || n.onLoad || n.onError)
          break;
        switch (n.rel) {
          case "stylesheet":
            return e = n.disabled, typeof n.precedence == "string" && e == null;
          default:
            return !0;
        }
      case "script":
        if (n.async && typeof n.async != "function" && typeof n.async != "symbol" && !n.onLoad && !n.onError && n.src && typeof n.src == "string")
          return !0;
    }
    return !1;
  }
  function W0(e) {
    return !(e.type === "stylesheet" && (e.state.loading & 3) === 0);
  }
  function yv(e, n, i, o) {
    if (i.type === "stylesheet" && (typeof o.media != "string" || matchMedia(o.media).matches !== !1) && (i.state.loading & 4) === 0) {
      if (i.instance === null) {
        var h = ko(o.href), b = n.querySelector(
          Bs(h)
        );
        if (b) {
          n = b._p, n !== null && typeof n == "object" && typeof n.then == "function" && (e.count++, e = Cc.bind(e), n.then(e, e)), i.state.loading |= 4, i.instance = b, Zt(b);
          return;
        }
        b = n.ownerDocument || n, o = K0(o), (h = _r.get(h)) && ih(o, h), b = b.createElement("link"), Zt(b);
        var C = b;
        C._p = new Promise(function(T, P) {
          C.onload = T, C.onerror = P;
        }), jn(b, "link", o), i.instance = b;
      }
      e.stylesheets === null && (e.stylesheets = /* @__PURE__ */ new Map()), e.stylesheets.set(i, n), (n = i.state.preload) && (i.state.loading & 3) === 0 && (e.count++, i = Cc.bind(e), n.addEventListener("load", i), n.addEventListener("error", i));
    }
  }
  var oh = 0;
  function bv(e, n) {
    return e.stylesheets && e.count === 0 && jc(e, e.stylesheets), 0 < e.count || 0 < e.imgCount ? function(i) {
      var o = setTimeout(function() {
        if (e.stylesheets && jc(e, e.stylesheets), e.unsuspend) {
          var b = e.unsuspend;
          e.unsuspend = null, b();
        }
      }, 6e4 + n);
      0 < e.imgBytes && oh === 0 && (oh = 62500 * Z2());
      var h = setTimeout(
        function() {
          if (e.waitingForImages = !1, e.count === 0 && (e.stylesheets && jc(e, e.stylesheets), e.unsuspend)) {
            var b = e.unsuspend;
            e.unsuspend = null, b();
          }
        },
        (e.imgBytes > oh ? 50 : 800) + n
      );
      return e.unsuspend = i, function() {
        e.unsuspend = null, clearTimeout(o), clearTimeout(h);
      };
    } : null;
  }
  function Cc() {
    if (this.count--, this.count === 0 && (this.imgCount === 0 || !this.waitingForImages)) {
      if (this.stylesheets) jc(this, this.stylesheets);
      else if (this.unsuspend) {
        var e = this.unsuspend;
        this.unsuspend = null, e();
      }
    }
  }
  var Ec = null;
  function jc(e, n) {
    e.stylesheets = null, e.unsuspend !== null && (e.count++, Ec = /* @__PURE__ */ new Map(), n.forEach(xv, e), Ec = null, Cc.call(e));
  }
  function xv(e, n) {
    if (!(n.state.loading & 4)) {
      var i = Ec.get(e);
      if (i) var o = i.get(null);
      else {
        i = /* @__PURE__ */ new Map(), Ec.set(e, i);
        for (var h = e.querySelectorAll(
          "link[data-precedence],style[data-precedence]"
        ), b = 0; b < h.length; b++) {
          var C = h[b];
          (C.nodeName === "LINK" || C.getAttribute("media") !== "not all") && (i.set(C.dataset.precedence, C), o = C);
        }
        o && i.set(null, o);
      }
      h = n.instance, C = h.getAttribute("data-precedence"), b = i.get(C) || o, b === o && i.set(null, h), i.set(C, h), this.count++, o = Cc.bind(this), h.addEventListener("load", o), h.addEventListener("error", o), b ? b.parentNode.insertBefore(h, b.nextSibling) : (e = e.nodeType === 9 ? e.head : e, e.insertBefore(h, e.firstChild)), n.state.loading |= 4;
    }
  }
  var Us = {
    $$typeof: K,
    Provider: null,
    Consumer: null,
    _currentValue: fe,
    _currentValue2: fe,
    _threadCount: 0
  };
  function vv(e, n, i, o, h, b, C, T, P) {
    this.tag = 1, this.containerInfo = e, this.pingCache = this.current = this.pendingChildren = null, this.timeoutHandle = -1, this.callbackNode = this.next = this.pendingContext = this.context = this.cancelPendingCommit = null, this.callbackPriority = 0, this.expirationTimes = Fr(-1), this.entangledLanes = this.shellSuspendCounter = this.errorRecoveryDisabledLanes = this.expiredLanes = this.warmLanes = this.pingedLanes = this.suspendedLanes = this.pendingLanes = 0, this.entanglements = Fr(0), this.hiddenUpdates = Fr(null), this.identifierPrefix = o, this.onUncaughtError = h, this.onCaughtError = b, this.onRecoverableError = C, this.pooledCache = null, this.pooledCacheLanes = 0, this.formState = P, this.incompleteTransitions = /* @__PURE__ */ new Map();
  }
  function Z0(e, n, i, o, h, b, C, T, P, le, Se, Ee) {
    return e = new vv(
      e,
      n,
      i,
      C,
      P,
      le,
      Se,
      Ee,
      T
    ), n = 1, b === !0 && (n |= 24), b = lr(3, null, null, n), e.current = b, b.stateNode = e, n = Ud(), n.refCount++, e.pooledCache = n, n.refCount++, b.memoizedState = {
      element: o,
      isDehydrated: i,
      cache: n
    }, Fd(b), e;
  }
  function J0(e) {
    return e ? (e = Vn, e) : Vn;
  }
  function e1(e, n, i, o, h, b) {
    h = J0(h), o.context === null ? o.context = h : o.pendingContext = h, o = di(n), o.payload = { element: i }, b = b === void 0 ? null : b, b !== null && (o.callback = b), i = fi(e, o, n), i !== null && (Wn(i, e, n), ys(i, e, n));
  }
  function t1(e, n) {
    if (e = e.memoizedState, e !== null && e.dehydrated !== null) {
      var i = e.retryLane;
      e.retryLane = i !== 0 && i < n ? i : n;
    }
  }
  function sh(e, n) {
    t1(e, n), (e = e.alternate) && t1(e, n);
  }
  function n1(e) {
    if (e.tag === 13 || e.tag === 31) {
      var n = $t(e, 67108864);
      n !== null && Wn(n, e, 67108864), sh(e, 67108864);
    }
  }
  function r1(e) {
    if (e.tag === 13 || e.tag === 31) {
      var n = dr();
      n = Fo(n);
      var i = $t(e, n);
      i !== null && Wn(i, e, n), sh(e, n);
    }
  }
  var _c = !0;
  function Sv(e, n, i, o) {
    var h = re.T;
    re.T = null;
    var b = _e.p;
    try {
      _e.p = 2, uh(e, n, i, o);
    } finally {
      _e.p = b, re.T = h;
    }
  }
  function wv(e, n, i, o) {
    var h = re.T;
    re.T = null;
    var b = _e.p;
    try {
      _e.p = 8, uh(e, n, i, o);
    } finally {
      _e.p = b, re.T = h;
    }
  }
  function uh(e, n, i, o) {
    if (_c) {
      var h = ch(o);
      if (h === null)
        Qf(
          e,
          n,
          o,
          Nc,
          i
        ), i1(e, o);
      else if (Cv(
        h,
        e,
        n,
        i,
        o
      ))
        o.stopPropagation();
      else if (i1(e, o), n & 4 && -1 < kv.indexOf(e)) {
        for (; h !== null; ) {
          var b = Tt(h);
          if (b !== null)
            switch (b.tag) {
              case 3:
                if (b = b.stateNode, b.current.memoizedState.isDehydrated) {
                  var C = zr(b.pendingLanes);
                  if (C !== 0) {
                    var T = b;
                    for (T.pendingLanes |= 2, T.entangledLanes |= 2; C; ) {
                      var P = 1 << 31 - Be(C);
                      T.entanglements[1] |= P, C &= ~P;
                    }
                    ta(b), (jt & 6) === 0 && (cc = mn() + 500, Rs(0));
                  }
                }
                break;
              case 31:
              case 13:
                T = $t(b, 2), T !== null && Wn(T, b, 2), fc(), sh(b, 2);
            }
          if (b = ch(o), b === null && Qf(
            e,
            n,
            o,
            Nc,
            i
          ), b === h) break;
          h = b;
        }
        h !== null && o.stopPropagation();
      } else
        Qf(
          e,
          n,
          o,
          null,
          i
        );
    }
  }
  function ch(e) {
    return e = Il(e), dh(e);
  }
  var Nc = null;
  function dh(e) {
    if (Nc = null, e = Vr(e), e !== null) {
      var n = c(e);
      if (n === null) e = null;
      else {
        var i = n.tag;
        if (i === 13) {
          if (e = d(n), e !== null) return e;
          e = null;
        } else if (i === 31) {
          if (e = m(n), e !== null) return e;
          e = null;
        } else if (i === 3) {
          if (n.stateNode.current.memoizedState.isDehydrated)
            return n.tag === 3 ? n.stateNode.containerInfo : null;
          e = null;
        } else n !== e && (e = null);
      }
    }
    return Nc = e, null;
  }
  function a1(e) {
    switch (e) {
      case "beforetoggle":
      case "cancel":
      case "click":
      case "close":
      case "contextmenu":
      case "copy":
      case "cut":
      case "auxclick":
      case "dblclick":
      case "dragend":
      case "dragstart":
      case "drop":
      case "focusin":
      case "focusout":
      case "input":
      case "invalid":
      case "keydown":
      case "keypress":
      case "keyup":
      case "mousedown":
      case "mouseup":
      case "paste":
      case "pause":
      case "play":
      case "pointercancel":
      case "pointerdown":
      case "pointerup":
      case "ratechange":
      case "reset":
      case "resize":
      case "seeked":
      case "submit":
      case "toggle":
      case "touchcancel":
      case "touchend":
      case "touchstart":
      case "volumechange":
      case "change":
      case "selectionchange":
      case "textInput":
      case "compositionstart":
      case "compositionend":
      case "compositionupdate":
      case "beforeblur":
      case "afterblur":
      case "beforeinput":
      case "blur":
      case "fullscreenchange":
      case "focus":
      case "hashchange":
      case "popstate":
      case "select":
      case "selectstart":
        return 2;
      case "drag":
      case "dragenter":
      case "dragexit":
      case "dragleave":
      case "dragover":
      case "mousemove":
      case "mouseout":
      case "mouseover":
      case "pointermove":
      case "pointerout":
      case "pointerover":
      case "scroll":
      case "touchmove":
      case "wheel":
      case "mouseenter":
      case "mouseleave":
      case "pointerenter":
      case "pointerleave":
        return 8;
      case "message":
        switch (ma()) {
          case ve:
            return 2;
          case Oe:
            return 8;
          case Je:
          case it:
            return 32;
          case xt:
            return 268435456;
          default:
            return 32;
        }
      default:
        return 32;
    }
  }
  var fh = !1, ki = null, Ci = null, Ei = null, Ps = /* @__PURE__ */ new Map(), qs = /* @__PURE__ */ new Map(), ji = [], kv = "mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(
    " "
  );
  function i1(e, n) {
    switch (e) {
      case "focusin":
      case "focusout":
        ki = null;
        break;
      case "dragenter":
      case "dragleave":
        Ci = null;
        break;
      case "mouseover":
      case "mouseout":
        Ei = null;
        break;
      case "pointerover":
      case "pointerout":
        Ps.delete(n.pointerId);
        break;
      case "gotpointercapture":
      case "lostpointercapture":
        qs.delete(n.pointerId);
    }
  }
  function Hs(e, n, i, o, h, b) {
    return e === null || e.nativeEvent !== b ? (e = {
      blockedOn: n,
      domEventName: i,
      eventSystemFlags: o,
      nativeEvent: b,
      targetContainers: [h]
    }, n !== null && (n = Tt(n), n !== null && n1(n)), e) : (e.eventSystemFlags |= o, n = e.targetContainers, h !== null && n.indexOf(h) === -1 && n.push(h), e);
  }
  function Cv(e, n, i, o, h) {
    switch (n) {
      case "focusin":
        return ki = Hs(
          ki,
          e,
          n,
          i,
          o,
          h
        ), !0;
      case "dragenter":
        return Ci = Hs(
          Ci,
          e,
          n,
          i,
          o,
          h
        ), !0;
      case "mouseover":
        return Ei = Hs(
          Ei,
          e,
          n,
          i,
          o,
          h
        ), !0;
      case "pointerover":
        var b = h.pointerId;
        return Ps.set(
          b,
          Hs(
            Ps.get(b) || null,
            e,
            n,
            i,
            o,
            h
          )
        ), !0;
      case "gotpointercapture":
        return b = h.pointerId, qs.set(
          b,
          Hs(
            qs.get(b) || null,
            e,
            n,
            i,
            o,
            h
          )
        ), !0;
    }
    return !1;
  }
  function l1(e) {
    var n = Vr(e.target);
    if (n !== null) {
      var i = c(n);
      if (i !== null) {
        if (n = i.tag, n === 13) {
          if (n = d(i), n !== null) {
            e.blockedOn = n, Fi(e.priority, function() {
              r1(i);
            });
            return;
          }
        } else if (n === 31) {
          if (n = m(i), n !== null) {
            e.blockedOn = n, Fi(e.priority, function() {
              r1(i);
            });
            return;
          }
        } else if (n === 3 && i.stateNode.current.memoizedState.isDehydrated) {
          e.blockedOn = i.tag === 3 ? i.stateNode.containerInfo : null;
          return;
        }
      }
    }
    e.blockedOn = null;
  }
  function Tc(e) {
    if (e.blockedOn !== null) return !1;
    for (var n = e.targetContainers; 0 < n.length; ) {
      var i = ch(e.nativeEvent);
      if (i === null) {
        i = e.nativeEvent;
        var o = new i.constructor(
          i.type,
          i
        );
        br = o, i.target.dispatchEvent(o), br = null;
      } else
        return n = Tt(i), n !== null && n1(n), e.blockedOn = i, !1;
      n.shift();
    }
    return !0;
  }
  function o1(e, n, i) {
    Tc(e) && i.delete(n);
  }
  function Ev() {
    fh = !1, ki !== null && Tc(ki) && (ki = null), Ci !== null && Tc(Ci) && (Ci = null), Ei !== null && Tc(Ei) && (Ei = null), Ps.forEach(o1), qs.forEach(o1);
  }
  function Ac(e, n) {
    e.blockedOn === n && (e.blockedOn = null, fh || (fh = !0, t.unstable_scheduleCallback(
      t.unstable_NormalPriority,
      Ev
    )));
  }
  var Mc = null;
  function s1(e) {
    Mc !== e && (Mc = e, t.unstable_scheduleCallback(
      t.unstable_NormalPriority,
      function() {
        Mc === e && (Mc = null);
        for (var n = 0; n < e.length; n += 3) {
          var i = e[n], o = e[n + 1], h = e[n + 2];
          if (typeof o != "function") {
            if (dh(o || i) === null)
              continue;
            break;
          }
          var b = Tt(i);
          b !== null && (e.splice(n, 3), n -= 3, cf(
            b,
            {
              pending: !0,
              data: h,
              method: i.method,
              action: o
            },
            o,
            h
          ));
        }
      }
    ));
  }
  function Eo(e) {
    function n(P) {
      return Ac(P, e);
    }
    ki !== null && Ac(ki, e), Ci !== null && Ac(Ci, e), Ei !== null && Ac(Ei, e), Ps.forEach(n), qs.forEach(n);
    for (var i = 0; i < ji.length; i++) {
      var o = ji[i];
      o.blockedOn === e && (o.blockedOn = null);
    }
    for (; 0 < ji.length && (i = ji[0], i.blockedOn === null); )
      l1(i), i.blockedOn === null && ji.shift();
    if (i = (e.ownerDocument || e).$$reactFormReplay, i != null)
      for (o = 0; o < i.length; o += 3) {
        var h = i[o], b = i[o + 1], C = h[Wt] || null;
        if (typeof b == "function")
          C || s1(i);
        else if (C) {
          var T = null;
          if (b && b.hasAttribute("formAction")) {
            if (h = b, C = b[Wt] || null)
              T = C.formAction;
            else if (dh(h) !== null) continue;
          } else T = C.action;
          typeof T == "function" ? i[o + 1] = T : (i.splice(o, 3), o -= 3), s1(i);
        }
      }
  }
  function u1() {
    function e(b) {
      b.canIntercept && b.info === "react-transition" && b.intercept({
        handler: function() {
          return new Promise(function(C) {
            return h = C;
          });
        },
        focusReset: "manual",
        scroll: "manual"
      });
    }
    function n() {
      h !== null && (h(), h = null), o || setTimeout(i, 20);
    }
    function i() {
      if (!o && !navigation.transition) {
        var b = navigation.currentEntry;
        b && b.url != null && navigation.navigate(b.url, {
          state: b.getState(),
          info: "react-transition",
          history: "replace"
        });
      }
    }
    if (typeof navigation == "object") {
      var o = !1, h = null;
      return navigation.addEventListener("navigate", e), navigation.addEventListener("navigatesuccess", n), navigation.addEventListener("navigateerror", n), setTimeout(i, 100), function() {
        o = !0, navigation.removeEventListener("navigate", e), navigation.removeEventListener("navigatesuccess", n), navigation.removeEventListener("navigateerror", n), h !== null && (h(), h = null);
      };
    }
  }
  function hh(e) {
    this._internalRoot = e;
  }
  zc.prototype.render = hh.prototype.render = function(e) {
    var n = this._internalRoot;
    if (n === null) throw Error(l(409));
    var i = n.current, o = dr();
    e1(i, o, e, n, null, null);
  }, zc.prototype.unmount = hh.prototype.unmount = function() {
    var e = this._internalRoot;
    if (e !== null) {
      this._internalRoot = null;
      var n = e.containerInfo;
      e1(e.current, 2, null, e, null, null), fc(), n[In] = null;
    }
  };
  function zc(e) {
    this._internalRoot = e;
  }
  zc.prototype.unstable_scheduleHydration = function(e) {
    if (e) {
      var n = Hi();
      e = { blockedOn: null, target: e, priority: n };
      for (var i = 0; i < ji.length && n !== 0 && n < ji[i].priority; i++) ;
      ji.splice(i, 0, e), i === 0 && l1(e);
    }
  };
  var c1 = r.version;
  if (c1 !== "19.2.3")
    throw Error(
      l(
        527,
        c1,
        "19.2.3"
      )
    );
  _e.findDOMNode = function(e) {
    var n = e._reactInternals;
    if (n === void 0)
      throw typeof e.render == "function" ? Error(l(188)) : (e = Object.keys(e).join(","), Error(l(268, e)));
    return e = p(n), e = e !== null ? v(e) : null, e = e === null ? null : e.stateNode, e;
  };
  var jv = {
    bundleType: 0,
    version: "19.2.3",
    rendererPackageName: "react-dom",
    currentDispatcherRef: re,
    reconcilerVersion: "19.2.3"
  };
  if (typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ < "u") {
    var Rc = __REACT_DEVTOOLS_GLOBAL_HOOK__;
    if (!Rc.isDisabled && Rc.supportsFiber)
      try {
        nn = Rc.inject(
          jv
        ), Vt = Rc;
      } catch {
      }
  }
  return $s.createRoot = function(e, n) {
    if (!s(e)) throw Error(l(299));
    var i = !1, o = "", h = yg, b = bg, C = xg;
    return n != null && (n.unstable_strictMode === !0 && (i = !0), n.identifierPrefix !== void 0 && (o = n.identifierPrefix), n.onUncaughtError !== void 0 && (h = n.onUncaughtError), n.onCaughtError !== void 0 && (b = n.onCaughtError), n.onRecoverableError !== void 0 && (C = n.onRecoverableError)), n = Z0(
      e,
      1,
      !1,
      null,
      null,
      i,
      o,
      null,
      h,
      b,
      C,
      u1
    ), e[In] = n.current, Yf(e), new hh(n);
  }, $s.hydrateRoot = function(e, n, i) {
    if (!s(e)) throw Error(l(299));
    var o = !1, h = "", b = yg, C = bg, T = xg, P = null;
    return i != null && (i.unstable_strictMode === !0 && (o = !0), i.identifierPrefix !== void 0 && (h = i.identifierPrefix), i.onUncaughtError !== void 0 && (b = i.onUncaughtError), i.onCaughtError !== void 0 && (C = i.onCaughtError), i.onRecoverableError !== void 0 && (T = i.onRecoverableError), i.formState !== void 0 && (P = i.formState)), n = Z0(
      e,
      1,
      !0,
      n,
      i ?? null,
      o,
      h,
      P,
      b,
      C,
      T,
      u1
    ), n.context = J0(null), i = n.current, o = dr(), o = Fo(o), h = di(o), h.callback = null, fi(i, h, o), i = o, n.current.lanes = i, gr(n, i), ta(n), e[In] = n.current, Yf(e), new zc(n);
  }, $s.version = "19.2.3", $s;
}
var v1;
function Iv() {
  if (v1) return gh.exports;
  v1 = 1;
  function t() {
    if (!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ > "u" || typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE != "function"))
      try {
        __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t);
      } catch (r) {
        console.error(r);
      }
  }
  return t(), gh.exports = Bv(), gh.exports;
}
var Uv = Iv();
const ob = /* @__PURE__ */ Nl(Uv), Pv = () => {
  if (document.getElementById("engram-font-preload")) return;
  [
    "https://fonts.googleapis.com/css2?family=Inter:wght@200;300;400;500;600&display=swap",
    "https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500&display=swap"
  ].forEach((r, a) => {
    const l = document.createElement("link");
    l.rel = "preload", l.as = "style", l.href = r, a === 0 && (l.id = "engram-font-preload"), document.head.appendChild(l);
    const s = document.createElement("link");
    s.rel = "stylesheet", s.href = r, document.head.appendChild(s);
  });
}, qv = () => (U.useEffect(() => {
  Pv();
}, []), /* @__PURE__ */ u.jsx("style", { children: `
    :root {
      --font-sans: 'Inter', system-ui, -apple-system, sans-serif;
      --font-mono: 'JetBrains Mono', monospace;
    }

    body {
      font-family: var(--font-sans);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    
    .font-mono {
      font-family: var(--font-mono);
    }
    
    /* Custom Scrollbar for dark theme - Minimalist */
    ::-webkit-scrollbar {
      width: 6px;
      height: 6px;
    }
    ::-webkit-scrollbar-track {
      background: transparent;
    }
    ::-webkit-scrollbar-thumb {
      background: rgba(63, 63, 70, 0.4); /* zinc-700 with opacity */
      border-radius: 3px;
    }
    ::-webkit-scrollbar-thumb:hover {
      background: rgba(82, 82, 91, 0.6); /* zinc-600 with opacity */
    }

    /* Animation Utilities */
    .animate-float {
      animation: float 6s ease-in-out infinite;
    }
    .animate-in {
      animation: fadeIn 0.3s ease-out forwards;
    }
    .fade-in {
      opacity: 0;
      animation: fadeIn 0.3s ease-out forwards;
    }
    
    @keyframes float {
      0% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
      100% { transform: translateY(0px); }
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(5px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Utility to hide scrollbar but keep functionality */
    .no-scrollbar::-webkit-scrollbar {
      display: none;
    }
    .no-scrollbar {
      -ms-overflow-style: none;
      scrollbar-width: none;
    }
  ` }));
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Hv = (t) => t.replace(/([a-z0-9])([A-Z])/g, "$1-$2").toLowerCase(), Fv = (t) => t.replace(
  /^([A-Z])|[\s-_]+(\w)/g,
  (r, a, l) => l ? l.toUpperCase() : a.toLowerCase()
), S1 = (t) => {
  const r = Fv(t);
  return r.charAt(0).toUpperCase() + r.slice(1);
}, sb = (...t) => t.filter((r, a, l) => !!r && r.trim() !== "" && l.indexOf(r) === a).join(" ").trim(), $v = (t) => {
  for (const r in t)
    if (r.startsWith("aria-") || r === "role" || r === "title")
      return !0;
};
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
var Gv = {
  xmlns: "http://www.w3.org/2000/svg",
  width: 24,
  height: 24,
  viewBox: "0 0 24 24",
  fill: "none",
  stroke: "currentColor",
  strokeWidth: 2,
  strokeLinecap: "round",
  strokeLinejoin: "round"
};
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Vv = U.forwardRef(
  ({
    color: t = "currentColor",
    size: r = 24,
    strokeWidth: a = 2,
    absoluteStrokeWidth: l,
    className: s = "",
    children: c,
    iconNode: d,
    ...m
  }, g) => U.createElement(
    "svg",
    {
      ref: g,
      ...Gv,
      width: r,
      height: r,
      stroke: t,
      strokeWidth: l ? Number(a) * 24 / Number(r) : a,
      className: sb("lucide", s),
      ...!c && !$v(m) && { "aria-hidden": "true" },
      ...m
    },
    [
      ...d.map(([p, v]) => U.createElement(p, v)),
      ...Array.isArray(c) ? c : [c]
    ]
  )
);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Fe = (t, r) => {
  const a = U.forwardRef(
    ({ className: l, ...s }, c) => U.createElement(Vv, {
      ref: c,
      iconNode: r,
      className: sb(
        `lucide-${Hv(S1(t))}`,
        `lucide-${t}`,
        l
      ),
      ...s
    })
  );
  return a.displayName = S1(t), a;
};
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Kv = [
  ["path", { d: "M12 17V3", key: "1cwfxf" }],
  ["path", { d: "m6 11 6 6 6-6", key: "12ii2o" }],
  ["path", { d: "M19 21H5", key: "150jfl" }]
], Yv = Fe("arrow-down-to-line", Kv);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Qv = [
  ["path", { d: "m12 19-7-7 7-7", key: "1l729n" }],
  ["path", { d: "M19 12H5", key: "x3x0zl" }]
], Am = Fe("arrow-left", Qv);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Xv = [
  ["path", { d: "M10.268 21a2 2 0 0 0 3.464 0", key: "vwvbt9" }],
  [
    "path",
    {
      d: "M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",
      key: "11g9vi"
    }
  ]
], Wv = Fe("bell", Xv);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Zv = [
  ["path", { d: "M12 7v14", key: "1akyts" }],
  [
    "path",
    {
      d: "M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",
      key: "ruj8y"
    }
  ]
], Jv = Fe("book-open", Zv);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const e4 = [
  [
    "path",
    {
      d: "M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",
      key: "k3hazp"
    }
  ]
], t4 = Fe("book", e4);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const n4 = [
  ["path", { d: "M12 8V4H8", key: "hb8ula" }],
  ["rect", { width: "16", height: "12", x: "4", y: "8", rx: "2", key: "enze0r" }],
  ["path", { d: "M2 14h2", key: "vft8re" }],
  ["path", { d: "M20 14h2", key: "4cs60a" }],
  ["path", { d: "M15 13v2", key: "1xurst" }],
  ["path", { d: "M9 13v2", key: "rq6x2g" }]
], ub = Fe("bot", n4);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const r4 = [
  [
    "path",
    {
      d: "M2.97 12.92A2 2 0 0 0 2 14.63v3.24a2 2 0 0 0 .97 1.71l3 1.8a2 2 0 0 0 2.06 0L12 19v-5.5l-5-3-4.03 2.42Z",
      key: "lc1i9w"
    }
  ],
  ["path", { d: "m7 16.5-4.74-2.85", key: "1o9zyk" }],
  ["path", { d: "m7 16.5 5-3", key: "va8pkn" }],
  ["path", { d: "M7 16.5v5.17", key: "jnp8gn" }],
  [
    "path",
    {
      d: "M12 13.5V19l3.97 2.38a2 2 0 0 0 2.06 0l3-1.8a2 2 0 0 0 .97-1.71v-3.24a2 2 0 0 0-.97-1.71L17 10.5l-5 3Z",
      key: "8zsnat"
    }
  ],
  ["path", { d: "m17 16.5-5-3", key: "8arw3v" }],
  ["path", { d: "m17 16.5 4.74-2.85", key: "8rfmw" }],
  ["path", { d: "M17 16.5v5.17", key: "k6z78m" }],
  [
    "path",
    {
      d: "M7.97 4.42A2 2 0 0 0 7 6.13v4.37l5 3 5-3V6.13a2 2 0 0 0-.97-1.71l-3-1.8a2 2 0 0 0-2.06 0l-3 1.8Z",
      key: "1xygjf"
    }
  ],
  ["path", { d: "M12 8 7.26 5.15", key: "1vbdud" }],
  ["path", { d: "m12 8 4.74-2.85", key: "3rx089" }],
  ["path", { d: "M12 13.5V8", key: "1io7kd" }]
], a4 = Fe("boxes", r4);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const i4 = [
  [
    "path",
    {
      d: "M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",
      key: "l5xja"
    }
  ],
  ["path", { d: "M9 13a4.5 4.5 0 0 0 3-4", key: "10igwf" }],
  ["path", { d: "M6.003 5.125A3 3 0 0 0 6.401 6.5", key: "105sqy" }],
  ["path", { d: "M3.477 10.896a4 4 0 0 1 .585-.396", key: "ql3yin" }],
  ["path", { d: "M6 18a4 4 0 0 1-1.967-.516", key: "2e4loj" }],
  ["path", { d: "M12 13h4", key: "1ku699" }],
  ["path", { d: "M12 18h6a2 2 0 0 1 2 2v1", key: "105ag5" }],
  ["path", { d: "M12 8h8", key: "1lhi5i" }],
  ["path", { d: "M16 8V5a2 2 0 0 1 2-2", key: "u6izg6" }],
  ["circle", { cx: "16", cy: "13", r: ".5", key: "ry7gng" }],
  ["circle", { cx: "18", cy: "3", r: ".5", key: "1aiba7" }],
  ["circle", { cx: "20", cy: "21", r: ".5", key: "yhc1fs" }],
  ["circle", { cx: "20", cy: "8", r: ".5", key: "1e43v0" }]
], l4 = Fe("brain-circuit", i4);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const o4 = [
  ["path", { d: "M12 18V5", key: "adv99a" }],
  ["path", { d: "M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4", key: "1e3is1" }],
  ["path", { d: "M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5", key: "1gqd8o" }],
  ["path", { d: "M17.997 5.125a4 4 0 0 1 2.526 5.77", key: "iwvgf7" }],
  ["path", { d: "M18 18a4 4 0 0 0 2-7.464", key: "efp6ie" }],
  ["path", { d: "M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517", key: "1gq6am" }],
  ["path", { d: "M6 18a4 4 0 0 1-2-7.464", key: "k1g0md" }],
  ["path", { d: "M6.003 5.125a4 4 0 0 0-2.526 5.77", key: "q97ue3" }]
], s4 = Fe("brain", o4);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const u4 = [
  ["path", { d: "M12 20v-9", key: "1qisl0" }],
  ["path", { d: "M14 7a4 4 0 0 1 4 4v3a6 6 0 0 1-12 0v-3a4 4 0 0 1 4-4z", key: "uouzyp" }],
  ["path", { d: "M14.12 3.88 16 2", key: "qol33r" }],
  ["path", { d: "M21 21a4 4 0 0 0-3.81-4", key: "1b0z45" }],
  ["path", { d: "M21 5a4 4 0 0 1-3.55 3.97", key: "5cxbf6" }],
  ["path", { d: "M22 13h-4", key: "1jl80f" }],
  ["path", { d: "M3 21a4 4 0 0 1 3.81-4", key: "1fjd4g" }],
  ["path", { d: "M3 5a4 4 0 0 0 3.55 3.97", key: "1d7oge" }],
  ["path", { d: "M6 13H2", key: "82j7cp" }],
  ["path", { d: "m8 2 1.88 1.88", key: "fmnt4t" }],
  ["path", { d: "M9 7.13V6a3 3 0 1 1 6 0v1.13", key: "1vgav8" }]
], c4 = Fe("bug", u4);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const d4 = [
  ["rect", { width: "16", height: "20", x: "4", y: "2", rx: "2", key: "1nb95v" }],
  ["line", { x1: "8", x2: "16", y1: "6", y2: "6", key: "x4nwl0" }],
  ["line", { x1: "16", x2: "16", y1: "14", y2: "18", key: "wjye3r" }],
  ["path", { d: "M16 10h.01", key: "1m94wz" }],
  ["path", { d: "M12 10h.01", key: "1nrarc" }],
  ["path", { d: "M8 10h.01", key: "19clt8" }],
  ["path", { d: "M12 14h.01", key: "1etili" }],
  ["path", { d: "M8 14h.01", key: "6423bh" }],
  ["path", { d: "M12 18h.01", key: "mhygvu" }],
  ["path", { d: "M8 18h.01", key: "lrp35t" }]
], f4 = Fe("calculator", d4);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const h4 = [["path", { d: "M20 6 9 17l-5-5", key: "1gmf2c" }]], Mm = Fe("check", h4);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const m4 = [["path", { d: "m6 9 6 6 6-6", key: "qrunsl" }]], Cl = Fe("chevron-down", m4);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const p4 = [["path", { d: "m9 18 6-6-6-6", key: "mthhwq" }]], fu = Fe("chevron-right", p4);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const g4 = [
  ["circle", { cx: "12", cy: "12", r: "10", key: "1mglay" }],
  ["line", { x1: "12", x2: "12", y1: "8", y2: "12", key: "1pkeuh" }],
  ["line", { x1: "12", x2: "12.01", y1: "16", y2: "16", key: "4dfq90" }]
], El = Fe("circle-alert", g4);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const y4 = [
  ["path", { d: "M21.801 10A10 10 0 1 1 17 3.335", key: "yps3ct" }],
  ["path", { d: "m9 11 3 3L22 4", key: "1pflzl" }]
], zm = Fe("circle-check-big", y4);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const b4 = [
  ["circle", { cx: "12", cy: "12", r: "10", key: "1mglay" }],
  ["path", { d: "m9 12 2 2 4-4", key: "dzmm74" }]
], cb = Fe("circle-check", b4);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const x4 = [
  ["path", { d: "M12 6v6l4 2", key: "mmk7yg" }],
  ["circle", { cx: "12", cy: "12", r: "10", key: "1mglay" }]
], db = Fe("clock", x4);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const v4 = [
  ["path", { d: "M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z", key: "p7xjir" }]
], S4 = Fe("cloud", v4);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const w4 = [
  [
    "path",
    { d: "M15 6v12a3 3 0 1 0 3-3H6a3 3 0 1 0 3 3V6a3 3 0 1 0-3 3h12a3 3 0 1 0-3-3", key: "11bfej" }
  ]
], w1 = Fe("command", w4);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const k4 = [
  ["rect", { width: "14", height: "14", x: "8", y: "8", rx: "2", ry: "2", key: "17jyea" }],
  ["path", { d: "M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2", key: "zix9uf" }]
], fb = Fe("copy", k4);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const C4 = [
  ["path", { d: "M20 4v7a4 4 0 0 1-4 4H4", key: "6o5b7l" }],
  ["path", { d: "m9 10-5 5 5 5", key: "1kshq7" }]
], k1 = Fe("corner-down-left", C4);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const E4 = [
  ["path", { d: "M12 20v2", key: "1lh1kg" }],
  ["path", { d: "M12 2v2", key: "tus03m" }],
  ["path", { d: "M17 20v2", key: "1rnc9c" }],
  ["path", { d: "M17 2v2", key: "11trls" }],
  ["path", { d: "M2 12h2", key: "1t8f8n" }],
  ["path", { d: "M2 17h2", key: "7oei6x" }],
  ["path", { d: "M2 7h2", key: "asdhe0" }],
  ["path", { d: "M20 12h2", key: "1q8mjw" }],
  ["path", { d: "M20 17h2", key: "1fpfkl" }],
  ["path", { d: "M20 7h2", key: "1o8tra" }],
  ["path", { d: "M7 20v2", key: "4gnj0m" }],
  ["path", { d: "M7 2v2", key: "1i4yhu" }],
  ["rect", { x: "4", y: "4", width: "16", height: "16", rx: "2", key: "1vbyd7" }],
  ["rect", { x: "8", y: "8", width: "8", height: "8", rx: "1", key: "z9xiuo" }]
], ud = Fe("cpu", E4);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const j4 = [
  ["ellipse", { cx: "12", cy: "5", rx: "9", ry: "3", key: "msslwz" }],
  ["path", { d: "M3 5V19A9 3 0 0 0 21 19V5", key: "1wlel7" }],
  ["path", { d: "M3 12A9 3 0 0 0 21 12", key: "mv7ke4" }]
], hu = Fe("database", j4);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const _4 = [
  ["path", { d: "M12 15V3", key: "m9g1x1" }],
  ["path", { d: "M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4", key: "ih7n3h" }],
  ["path", { d: "m7 10 5 5 5-5", key: "brsn70" }]
], tu = Fe("download", _4);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const N4 = [
  ["path", { d: "M15 3h6v6", key: "1q9fwt" }],
  ["path", { d: "M10 14 21 3", key: "gplh6r" }],
  ["path", { d: "M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6", key: "a6xqqp" }]
], T4 = Fe("external-link", N4);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const A4 = [
  [
    "path",
    {
      d: "M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",
      key: "1nclc0"
    }
  ],
  ["circle", { cx: "12", cy: "12", r: "3", key: "1v7zrd" }]
], C1 = Fe("eye", A4);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const M4 = [
  [
    "path",
    {
      d: "M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",
      key: "1oefj6"
    }
  ],
  ["path", { d: "M14 2v5a1 1 0 0 0 1 1h5", key: "wfsgrz" }],
  ["path", { d: "M10 9H8", key: "b1mrlr" }],
  ["path", { d: "M16 13H8", key: "t4e002" }],
  ["path", { d: "M16 17H8", key: "z1uh3a" }]
], mu = Fe("file-text", M4);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const z4 = [
  [
    "path",
    {
      d: "M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",
      key: "sc7q7i"
    }
  ]
], R4 = Fe("funnel", z4);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const O4 = [
  ["line", { x1: "6", x2: "6", y1: "3", y2: "15", key: "17qcm7" }],
  ["circle", { cx: "18", cy: "6", r: "3", key: "1h7g24" }],
  ["circle", { cx: "6", cy: "18", r: "3", key: "fqmcym" }],
  ["path", { d: "M18 9a9 9 0 0 1-9 9", key: "n2h4wq" }]
], hb = Fe("git-branch", O4);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const D4 = [
  [
    "path",
    {
      d: "M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",
      key: "tonef"
    }
  ],
  ["path", { d: "M9 18c-4.51 2-5-2-7-2", key: "9comsn" }]
], L4 = Fe("github", D4);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const B4 = [
  ["circle", { cx: "9", cy: "12", r: "1", key: "1vctgf" }],
  ["circle", { cx: "9", cy: "5", r: "1", key: "hp0tcf" }],
  ["circle", { cx: "9", cy: "19", r: "1", key: "fkjjf6" }],
  ["circle", { cx: "15", cy: "12", r: "1", key: "1tmaij" }],
  ["circle", { cx: "15", cy: "5", r: "1", key: "19l28e" }],
  ["circle", { cx: "15", cy: "19", r: "1", key: "f4zoj3" }]
], I4 = Fe("grip-vertical", B4);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const U4 = [
  ["line", { x1: "4", x2: "20", y1: "9", y2: "9", key: "4lhtct" }],
  ["line", { x1: "4", x2: "20", y1: "15", y2: "15", key: "vyu0kd" }],
  ["line", { x1: "10", x2: "8", y1: "3", y2: "21", key: "1ggp8o" }],
  ["line", { x1: "16", x2: "14", y1: "3", y2: "21", key: "weycgp" }]
], P4 = Fe("hash", U4);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const q4 = [
  ["path", { d: "M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8", key: "5wwlr5" }],
  [
    "path",
    {
      d: "M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",
      key: "r6nss1"
    }
  ]
], H4 = Fe("house", q4);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const F4 = [
  ["circle", { cx: "12", cy: "12", r: "10", key: "1mglay" }],
  ["path", { d: "M12 16v-4", key: "1dtifu" }],
  ["path", { d: "M12 8h.01", key: "e9boi3" }]
], $4 = Fe("info", F4);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const G4 = [
  ["path", { d: "m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4", key: "g0fldk" }],
  ["path", { d: "m21 2-9.6 9.6", key: "1j0ho8" }],
  ["circle", { cx: "7.5", cy: "15.5", r: "5.5", key: "yqb3hr" }]
], cd = Fe("key", G4);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const V4 = [
  [
    "path",
    {
      d: "M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",
      key: "zw3jo"
    }
  ],
  [
    "path",
    {
      d: "M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",
      key: "1wduqc"
    }
  ],
  [
    "path",
    {
      d: "M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",
      key: "kqbvx6"
    }
  ]
], Rm = Fe("layers", V4);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const K4 = [
  ["rect", { width: "7", height: "9", x: "3", y: "3", rx: "1", key: "10lvy0" }],
  ["rect", { width: "7", height: "5", x: "14", y: "3", rx: "1", key: "16une8" }],
  ["rect", { width: "7", height: "9", x: "14", y: "12", rx: "1", key: "1hutg5" }],
  ["rect", { width: "7", height: "5", x: "3", y: "16", rx: "1", key: "ldoo1y" }]
], Y4 = Fe("layout-dashboard", K4);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Q4 = [
  ["path", { d: "M8 5h13", key: "1pao27" }],
  ["path", { d: "M13 12h8", key: "h98zly" }],
  ["path", { d: "M13 19h8", key: "c3s6r1" }],
  ["path", { d: "M3 10a2 2 0 0 0 2 2h3", key: "1npucw" }],
  ["path", { d: "M3 5v12a2 2 0 0 0 2 2h3", key: "x1gjn2" }]
], X4 = Fe("list-tree", Q4);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const W4 = [
  ["path", { d: "M3 5h.01", key: "18ugdj" }],
  ["path", { d: "M3 12h.01", key: "nlz23k" }],
  ["path", { d: "M3 19h.01", key: "noohij" }],
  ["path", { d: "M8 5h13", key: "1pao27" }],
  ["path", { d: "M8 12h13", key: "1za7za" }],
  ["path", { d: "M8 19h13", key: "m83p4d" }]
], Z4 = Fe("list", W4);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const J4 = [["path", { d: "M21 12a9 9 0 1 1-6.219-8.56", key: "13zald" }]], Tl = Fe("loader-circle", J4);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const e3 = [
  ["path", { d: "M4 5h16", key: "1tepv9" }],
  ["path", { d: "M4 12h16", key: "1lakjw" }],
  ["path", { d: "M4 19h16", key: "1djgab" }]
], t3 = Fe("menu", e3);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const n3 = [
  [
    "path",
    {
      d: "M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",
      key: "18887p"
    }
  ]
], r3 = Fe("message-square", n3);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const a3 = [
  [
    "path",
    {
      d: "M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",
      key: "kfwtm"
    }
  ]
], E1 = Fe("moon", a3);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const i3 = [
  ["rect", { x: "16", y: "16", width: "6", height: "6", rx: "1", key: "4q2zg0" }],
  ["rect", { x: "2", y: "16", width: "6", height: "6", rx: "1", key: "8cvhb9" }],
  ["rect", { x: "9", y: "2", width: "6", height: "6", rx: "1", key: "1egb70" }],
  ["path", { d: "M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3", key: "1jsf9p" }],
  ["path", { d: "M12 12V8", key: "2874zd" }]
], mb = Fe("network", i3);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const l3 = [
  [
    "path",
    {
      d: "M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",
      key: "e79jfc"
    }
  ],
  ["circle", { cx: "13.5", cy: "6.5", r: ".5", fill: "currentColor", key: "1okk4w" }],
  ["circle", { cx: "17.5", cy: "10.5", r: ".5", fill: "currentColor", key: "f64h9f" }],
  ["circle", { cx: "6.5", cy: "12.5", r: ".5", fill: "currentColor", key: "qy21gx" }],
  ["circle", { cx: "8.5", cy: "7.5", r: ".5", fill: "currentColor", key: "fotxhn" }]
], j1 = Fe("palette", l3);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const o3 = [
  ["rect", { x: "14", y: "3", width: "5", height: "18", rx: "1", key: "kaeet6" }],
  ["rect", { x: "5", y: "3", width: "5", height: "18", rx: "1", key: "1wsw3u" }]
], s3 = Fe("pause", o3);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const u3 = [
  [
    "path",
    {
      d: "M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",
      key: "1a8usu"
    }
  ]
], c3 = Fe("pen", u3);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const d3 = [
  [
    "path",
    {
      d: "M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",
      key: "10ikf1"
    }
  ]
], Om = Fe("play", d3);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const f3 = [
  ["path", { d: "M5 12h14", key: "1ays0h" }],
  ["path", { d: "M12 5v14", key: "s699le" }]
], pb = Fe("plus", f3);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const h3 = [
  ["path", { d: "M12 2v10", key: "mnfbl" }],
  ["path", { d: "M18.4 6.6a9 9 0 1 1-12.77.04", key: "obofu9" }]
], Dm = Fe("power", h3);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const m3 = [
  ["path", { d: "M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8", key: "v9h5vc" }],
  ["path", { d: "M21 3v5h-5", key: "1q7to0" }],
  ["path", { d: "M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16", key: "3uifl3" }],
  ["path", { d: "M8 16H3v5", key: "1cv678" }]
], tr = Fe("refresh-cw", m3);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const p3 = [
  ["path", { d: "M17 3v10", key: "15fgeh" }],
  ["path", { d: "m12.67 5.5 8.66 5", key: "1gpheq" }],
  ["path", { d: "m12.67 10.5 8.66-5", key: "1dkfa6" }],
  [
    "path",
    { d: "M9 17a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h2a2 2 0 0 0 2-2v-2z", key: "swwfx4" }
  ]
], gb = Fe("regex", p3);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const g3 = [
  ["path", { d: "M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8", key: "1357e3" }],
  ["path", { d: "M3 3v5h5", key: "1xhq8a" }]
], y3 = Fe("rotate-ccw", g3);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const b3 = [
  [
    "path",
    {
      d: "M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",
      key: "1c8476"
    }
  ],
  ["path", { d: "M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7", key: "1ydtos" }],
  ["path", { d: "M7 3v4a1 1 0 0 0 1 1h7", key: "t51u73" }]
], eu = Fe("save", b3);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const x3 = [
  ["circle", { cx: "6", cy: "6", r: "3", key: "1lh9wr" }],
  ["path", { d: "M8.12 8.12 12 12", key: "1alkpv" }],
  ["path", { d: "M20 4 8.12 15.88", key: "xgtan2" }],
  ["circle", { cx: "6", cy: "18", r: "3", key: "fqmcym" }],
  ["path", { d: "M14.8 14.8 20 20", key: "ptml3r" }]
], v3 = Fe("scissors", x3);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const S3 = [
  ["path", { d: "M15 12h-5", key: "r7krc0" }],
  ["path", { d: "M15 8h-5", key: "1khuty" }],
  ["path", { d: "M19 17V5a2 2 0 0 0-2-2H4", key: "zz82l3" }],
  [
    "path",
    {
      d: "M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",
      key: "1ph1d7"
    }
  ]
], w3 = Fe("scroll-text", S3);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const k3 = [
  ["path", { d: "m21 21-4.34-4.34", key: "14j7rj" }],
  ["circle", { cx: "11", cy: "11", r: "8", key: "4ej97u" }]
], sa = Fe("search", k3);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const C3 = [
  [
    "path",
    {
      d: "M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",
      key: "1ffxy3"
    }
  ],
  ["path", { d: "m21.854 2.147-10.94 10.939", key: "12cjpa" }]
], E3 = Fe("send", C3);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const j3 = [
  ["rect", { width: "20", height: "8", x: "2", y: "2", rx: "2", ry: "2", key: "ngkwjq" }],
  ["rect", { width: "20", height: "8", x: "2", y: "14", rx: "2", ry: "2", key: "iecqi9" }],
  ["line", { x1: "6", x2: "6.01", y1: "6", y2: "6", key: "16zg32" }],
  ["line", { x1: "6", x2: "6.01", y1: "18", y2: "18", key: "nzw8ys" }]
], yb = Fe("server", j3);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const _3 = [
  [
    "path",
    {
      d: "M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",
      key: "1i5ecw"
    }
  ],
  ["circle", { cx: "12", cy: "12", r: "3", key: "1v7zrd" }]
], Wc = Fe("settings", _3);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const N3 = [
  ["path", { d: "M10 8h4", key: "1sr2af" }],
  ["path", { d: "M12 21v-9", key: "17s77i" }],
  ["path", { d: "M12 8V3", key: "13r4qs" }],
  ["path", { d: "M17 16h4", key: "h1uq16" }],
  ["path", { d: "M19 12V3", key: "o1uvq1" }],
  ["path", { d: "M19 21v-5", key: "qua636" }],
  ["path", { d: "M3 14h4", key: "bcjad9" }],
  ["path", { d: "M5 10V3", key: "cb8scm" }],
  ["path", { d: "M5 21v-7", key: "1w1uti" }]
], _1 = Fe("sliders-vertical", N3);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const T3 = [
  [
    "path",
    {
      d: "M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",
      key: "1s2grr"
    }
  ],
  ["path", { d: "M20 2v4", key: "1rf3ol" }],
  ["path", { d: "M22 4h-4", key: "gwowj6" }],
  ["circle", { cx: "4", cy: "20", r: "2", key: "6kqj1y" }]
], A3 = Fe("sparkles", T3);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const M3 = [
  ["rect", { width: "18", height: "18", x: "3", y: "3", rx: "2", key: "afitv7" }]
], z3 = Fe("square", M3);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const R3 = [
  ["circle", { cx: "12", cy: "12", r: "4", key: "4exip2" }],
  ["path", { d: "M12 2v2", key: "tus03m" }],
  ["path", { d: "M12 20v2", key: "1lh1kg" }],
  ["path", { d: "m4.93 4.93 1.41 1.41", key: "149t6j" }],
  ["path", { d: "m17.66 17.66 1.41 1.41", key: "ptbguv" }],
  ["path", { d: "M2 12h2", key: "1t8f8n" }],
  ["path", { d: "M20 12h2", key: "1q8mjw" }],
  ["path", { d: "m6.34 17.66-1.41 1.41", key: "1m8zz5" }],
  ["path", { d: "m19.07 4.93-1.41 1.41", key: "1shlcs" }]
], O3 = Fe("sun", R3);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const D3 = [
  ["circle", { cx: "12", cy: "12", r: "10", key: "1mglay" }],
  ["circle", { cx: "12", cy: "12", r: "6", key: "1vlfrh" }],
  ["circle", { cx: "12", cy: "12", r: "2", key: "1c9p78" }]
], Lm = Fe("target", D3);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const L3 = [
  ["path", { d: "M12 19h8", key: "baeox8" }],
  ["path", { d: "m4 17 6-6-6-6", key: "1yngyt" }]
], pu = Fe("terminal", L3);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const B3 = [
  ["path", { d: "M10 11v6", key: "nco0om" }],
  ["path", { d: "M14 11v6", key: "outv1u" }],
  ["path", { d: "M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6", key: "miytrc" }],
  ["path", { d: "M3 6h18", key: "d0wm0j" }],
  ["path", { d: "M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2", key: "e791ji" }]
], ca = Fe("trash-2", B3);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const I3 = [
  [
    "path",
    {
      d: "m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",
      key: "wmoenq"
    }
  ],
  ["path", { d: "M12 9v4", key: "juzpu7" }],
  ["path", { d: "M12 17h.01", key: "p32p05" }]
], bb = Fe("triangle-alert", I3);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const U3 = [
  ["path", { d: "M12 3v12", key: "1x0j5s" }],
  ["path", { d: "m17 8-5-5-5 5", key: "7q97r8" }],
  ["path", { d: "M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4", key: "ih7n3h" }]
], P3 = Fe("upload", U3);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const q3 = [
  [
    "path",
    {
      d: "m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",
      key: "ul74o6"
    }
  ],
  ["path", { d: "m14 7 3 3", key: "1r5n42" }],
  ["path", { d: "M5 6v4", key: "ilb8ba" }],
  ["path", { d: "M19 14v4", key: "blhpug" }],
  ["path", { d: "M10 2v2", key: "7u0qdc" }],
  ["path", { d: "M7 8H3", key: "zfb6yr" }],
  ["path", { d: "M21 16h-4", key: "1cnmox" }],
  ["path", { d: "M11 3H9", key: "1obp7u" }]
], H3 = Fe("wand-sparkles", q3);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const F3 = [
  ["path", { d: "M18 6 6 18", key: "1bl5f8" }],
  ["path", { d: "m6 6 12 12", key: "d8bk6v" }]
], Uo = Fe("x", F3);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const $3 = [
  [
    "path",
    {
      d: "M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",
      key: "1xq2db"
    }
  ]
], Bi = Fe("zap", $3);
var xb = lb();
const Bm = /* @__PURE__ */ Nl(xb);
class G3 {
  constructor() {
    Xe(this, "adapters", []);
  }
  registerAdapter(r) {
    this.adapters.push(r);
  }
  async search(r) {
    return r.trim() ? (await Promise.all(this.adapters.map((l) => l.search(r)))).flat().sort((l, s) => (s.score || 0) - (l.score || 0)) : [];
  }
}
const zo = new G3(), V3 = [
  // Sub-view Navigation (Deep Links)
  // These are NOT in the main sidebar, so we keep them here.
  {
    id: "nav-prompt",
    icon: Wc,
    label: "",
    description: " Prompt ",
    action: (t) => t("presets:prompt"),
    keywords: ["prompt", "template", "", ""],
    type: "navigation"
  },
  {
    id: "nav-regex",
    icon: Wc,
    label: "",
    description: " Regex ",
    action: (t) => t("presets:regex"),
    keywords: ["regex", "rule", "", ""],
    type: "navigation"
  },
  {
    id: "nav-worldbook",
    icon: H4,
    label: "",
    description: " World Info  Lorebook",
    action: (t) => t("presets:worldbook"),
    keywords: ["world", "book", "lore", ""],
    type: "navigation"
  }
], Jh = [
  { id: "dashboard", icon: Y4, label: "", path: "/dashboard" },
  { id: "memory", icon: X4, label: "", path: "/memory" },
  { id: "processing", icon: ud, label: "", path: "/processing" },
  { id: "presets", icon: cd, label: "API ", path: "/presets" },
  { id: "devlog", icon: pu, label: "", path: "/devlog" },
  { id: "settings", icon: Wc, label: "", path: "/settings" }
], K3 = {}, N1 = (t) => {
  let r;
  const a = /* @__PURE__ */ new Set(), l = (v, x) => {
    const E = typeof v == "function" ? v(r) : v;
    if (!Object.is(E, r)) {
      const w = r;
      r = x ?? (typeof E != "object" || E === null) ? E : Object.assign({}, r, E), a.forEach((_) => _(r, w));
    }
  }, s = () => r, g = { setState: l, getState: s, getInitialState: () => p, subscribe: (v) => (a.add(v), () => a.delete(v)), destroy: () => {
    (K3 ? "production" : void 0) !== "production" && console.warn(
      "[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."
    ), a.clear();
  } }, p = r = t(l, s, g);
  return g;
}, Y3 = (t) => t ? N1(t) : N1;
var vh = { exports: {} }, Sh = {}, wh = { exports: {} }, kh = {};
/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var T1;
function Q3() {
  if (T1) return kh;
  T1 = 1;
  var t = du();
  function r(x, E) {
    return x === E && (x !== 0 || 1 / x === 1 / E) || x !== x && E !== E;
  }
  var a = typeof Object.is == "function" ? Object.is : r, l = t.useState, s = t.useEffect, c = t.useLayoutEffect, d = t.useDebugValue;
  function m(x, E) {
    var w = E(), _ = l({ inst: { value: w, getSnapshot: E } }), A = _[0].inst, D = _[1];
    return c(
      function() {
        A.value = w, A.getSnapshot = E, g(A) && D({ inst: A });
      },
      [x, w, E]
    ), s(
      function() {
        return g(A) && D({ inst: A }), x(function() {
          g(A) && D({ inst: A });
        });
      },
      [x]
    ), d(w), w;
  }
  function g(x) {
    var E = x.getSnapshot;
    x = x.value;
    try {
      var w = E();
      return !a(x, w);
    } catch {
      return !0;
    }
  }
  function p(x, E) {
    return E();
  }
  var v = typeof window > "u" || typeof window.document > "u" || typeof window.document.createElement > "u" ? p : m;
  return kh.useSyncExternalStore = t.useSyncExternalStore !== void 0 ? t.useSyncExternalStore : v, kh;
}
var A1;
function X3() {
  return A1 || (A1 = 1, wh.exports = Q3()), wh.exports;
}
/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var M1;
function W3() {
  if (M1) return Sh;
  M1 = 1;
  var t = du(), r = X3();
  function a(p, v) {
    return p === v && (p !== 0 || 1 / p === 1 / v) || p !== p && v !== v;
  }
  var l = typeof Object.is == "function" ? Object.is : a, s = r.useSyncExternalStore, c = t.useRef, d = t.useEffect, m = t.useMemo, g = t.useDebugValue;
  return Sh.useSyncExternalStoreWithSelector = function(p, v, x, E, w) {
    var _ = c(null);
    if (_.current === null) {
      var A = { hasValue: !1, value: null };
      _.current = A;
    } else A = _.current;
    _ = m(
      function() {
        function R(I) {
          if (!Z) {
            if (Z = !0, K = I, I = E(I), w !== void 0 && A.hasValue) {
              var V = A.value;
              if (w(V, I))
                return ge = V;
            }
            return ge = I;
          }
          if (V = ge, l(K, I)) return V;
          var we = E(I);
          return w !== void 0 && w(V, we) ? (K = I, V) : (K = I, ge = we);
        }
        var Z = !1, K, ge, de = x === void 0 ? null : x;
        return [
          function() {
            return R(v());
          },
          de === null ? void 0 : function() {
            return R(de());
          }
        ];
      },
      [v, x, E, w]
    );
    var D = s(p, _[0], _[1]);
    return d(
      function() {
        A.hasValue = !0, A.value = D;
      },
      [D]
    ), g(D), D;
  }, Sh;
}
var z1;
function Z3() {
  return z1 || (z1 = 1, vh.exports = W3()), vh.exports;
}
var J3 = Z3();
const e5 = /* @__PURE__ */ Nl(J3), vb = {}, { useDebugValue: t5 } = ib, { useSyncExternalStoreWithSelector: n5 } = e5;
let R1 = !1;
const r5 = (t) => t;
function a5(t, r = r5, a) {
  (vb ? "production" : void 0) !== "production" && a && !R1 && (console.warn(
    "[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"
  ), R1 = !0);
  const l = n5(
    t.subscribe,
    t.getState,
    t.getServerState || t.getInitialState,
    r,
    a
  );
  return t5(l), l;
}
const O1 = (t) => {
  (vb ? "production" : void 0) !== "production" && typeof t != "function" && console.warn(
    "[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`."
  );
  const r = typeof t == "function" ? Y3(t) : t, a = (l, s) => a5(r, l, s);
  return Object.assign(a, r), a;
}, Sb = (t) => t ? O1(t) : O1, i5 = {
  name: "Paper (Light)",
  colors: {
    background: "oklch(1.0000 0 0)",
    foreground: "oklch(0.1884 0.0128 248.5103)",
    card: "oklch(0.9784 0.0011 197.1387)",
    cardForeground: "oklch(0.1884 0.0128 248.5103)",
    popover: "oklch(1.0000 0 0)",
    popoverForeground: "oklch(0.1884 0.0128 248.5103)",
    primary: "oklch(0.6723 0.1606 244.9955)",
    primaryForeground: "oklch(1.0000 0 0)",
    secondary: "oklch(0.1884 0.0128 248.5103)",
    secondaryForeground: "oklch(1.0000 0 0)",
    muted: "oklch(0.9222 0.0013 286.3737)",
    mutedForeground: "oklch(0.1884 0.0128 248.5103)",
    accent: "oklch(0.9392 0.0166 250.8453)",
    accentForeground: "oklch(0.6723 0.1606 244.9955)",
    destructive: "oklch(0.6188 0.2376 25.7658)",
    destructiveForeground: "oklch(1.0000 0 0)",
    border: "oklch(0.1884 0.0128 248.5103 / 0.15)",
    // Darker (Foreground based) as requested
    input: "oklch(0.9809 0.0025 228.7836)",
    ring: "oklch(0.6818 0.1584 243.3540)",
    chart1: "oklch(0.6723 0.1606 244.9955)",
    chart2: "oklch(0.6907 0.1554 160.3454)",
    chart3: "oklch(0.8214 0.1600 82.5337)",
    chart4: "oklch(0.7064 0.1822 151.7125)",
    chart5: "oklch(0.5919 0.2186 10.5826)",
    sidebar: "oklch(0.9784 0.0011 197.1387)",
    sidebarForeground: "oklch(0.1884 0.0128 248.5103)",
    sidebarPrimary: "oklch(0.6723 0.1606 244.9955)",
    sidebarPrimaryForeground: "oklch(1.0000 0 0)",
    sidebarAccent: "oklch(0.9392 0.0166 250.8453)",
    sidebarAccentForeground: "oklch(0.6723 0.1606 244.9955)",
    sidebarBorder: "oklch(0.1884 0.0128 248.5103 / 0.1)",
    // Darker (Foreground based)
    sidebarRing: "oklch(0.6818 0.1584 243.3540)"
  },
  variables: {
    radius: "1.3rem"
  }
}, l5 = {
  name: "Claude (Dark)",
  colors: {
    background: "oklch(0.2679 0.0036 106.6427)",
    foreground: "oklch(0.8074 0.0142 93.0137)",
    card: "oklch(0.2679 0.0036 106.6427)",
    cardForeground: "oklch(0.8074 0.0142 93.0137)",
    popover: "oklch(0.2357 0.0024 67.7077)",
    popoverForeground: "oklch(0.8074 0.0142 93.0137)",
    primary: "oklch(0.6724 0.1308 38.7559)",
    primaryForeground: "oklch(1.0000 0 0)",
    secondary: "oklch(0.2213 0.0038 106.7070)",
    secondaryForeground: "oklch(0.8074 0.0142 93.0137)",
    muted: "oklch(0.2357 0.0024 67.7077)",
    mutedForeground: "oklch(0.7713 0.0169 99.0657)",
    accent: "oklch(0.6724 0.1308 38.7559)",
    accentForeground: "oklch(1.0000 0 0)",
    destructive: "oklch(0.6368 0.2078 25.3313)",
    destructiveForeground: "oklch(1.0000 0 0)",
    border: "oklch(0.8074 0.0142 93.0137 / 0.15)",
    // Foreground / 0.15
    input: "oklch(0.4336 0.0113 100.2195)",
    ring: "oklch(0.6724 0.1308 38.7559)",
    chart1: "oklch(0.6724 0.1308 38.7559)",
    chart2: "oklch(0.6898 0.1581 290.4107)",
    chart3: "oklch(0.8816 0.0276 93.1280)",
    chart4: "oklch(0.3074 0.0516 289.3230)",
    chart5: "oklch(0.6368 0.2078 25.3313)",
    sidebar: "oklch(0.2357 0.0024 67.7077)",
    sidebarForeground: "oklch(0.7713 0.0169 99.0657)",
    sidebarPrimary: "oklch(0.6724 0.1308 38.7559)",
    sidebarPrimaryForeground: "oklch(1.0000 0 0)",
    sidebarAccent: "oklch(0.2213 0.0038 106.7070)",
    sidebarAccentForeground: "oklch(0.8074 0.0142 93.0137)",
    sidebarBorder: "oklch(0.7713 0.0169 99.0657 / 0.15)",
    // SidebarForeground / 0.15
    sidebarRing: "oklch(0.6724 0.1308 38.7559)"
  },
  variables: {
    radius: "0.4rem"
  }
}, o5 = {
  name: "Twitter (Dark)",
  colors: {
    background: "oklch(0 0 0)",
    foreground: "oklch(0.9328 0.0025 228.7857)",
    card: "oklch(0 0 0)",
    // Matching background for seamless look, or slightly lighter
    cardForeground: "oklch(0.9328 0.0025 228.7857)",
    popover: "oklch(0 0 0)",
    popoverForeground: "oklch(0.9328 0.0025 228.7857)",
    primary: "oklch(0.6692 0.1607 245.0110)",
    primaryForeground: "oklch(1.0000 0 0)",
    secondary: "oklch(0.2097 0.0080 274.5332)",
    // Using card color from ref as secondary
    secondaryForeground: "oklch(0.8853 0 0)",
    muted: "oklch(0.2090 0 0)",
    mutedForeground: "oklch(0.5637 0.0078 247.9662)",
    accent: "oklch(0.1928 0.0331 242.5459)",
    accentForeground: "oklch(0.6692 0.1607 245.0110)",
    destructive: "oklch(0.6188 0.2376 25.7658)",
    destructiveForeground: "oklch(1.0000 0 0)",
    border: "oklch(0.9328 0.0025 228.7857 / 0.15)",
    // Foreground / 0.15
    input: "oklch(0.3020 0.0288 244.8244)",
    ring: "oklch(0.6818 0.1584 243.3540)",
    chart1: "oklch(0.6723 0.1606 244.9955)",
    chart2: "oklch(0.6907 0.1554 160.3454)",
    chart3: "oklch(0.8214 0.1600 82.5337)",
    chart4: "oklch(0.7064 0.1822 151.7125)",
    chart5: "oklch(0.5919 0.2186 10.5826)",
    sidebar: "oklch(0 0 0)",
    sidebarForeground: "oklch(0.9328 0.0025 228.7857)",
    sidebarPrimary: "oklch(0.6692 0.1607 245.0110)",
    sidebarPrimaryForeground: "oklch(1.0000 0 0)",
    sidebarAccent: "oklch(0.1928 0.0331 242.5459)",
    sidebarAccentForeground: "oklch(0.6692 0.1607 245.0110)",
    sidebarBorder: "oklch(0.9328 0.0025 228.7857 / 0.15)",
    // SidebarForeground / 0.15
    sidebarRing: "oklch(0.6818 0.1584 243.3540)"
  },
  variables: {
    radius: "1.3rem"
  }
}, s5 = {
  name: "Discord (Dark)",
  colors: {
    background: "#313338",
    foreground: "#f2f3f5",
    card: "#2b2d31",
    cardForeground: "#f2f3f5",
    popover: "#313338",
    popoverForeground: "#f2f3f5",
    primary: "#5865f2",
    primaryForeground: "#ffffff",
    secondary: "#2b2d31",
    secondaryForeground: "#f2f3f5",
    muted: "#1e1f22",
    mutedForeground: "#949ba4",
    accent: "#3f4147",
    accentForeground: "#f2f3f5",
    destructive: "#fa777c",
    destructiveForeground: "#313338",
    border: "#f2f3f526",
    // Foreground #f2f3f5 with ~15% alpha
    input: "#1e1f22",
    ring: "#5865f2",
    chart1: "#5865f2",
    chart2: "#23a559",
    chart3: "#f0b232",
    chart4: "#00a8fc",
    chart5: "#eb459e",
    sidebar: "#1e1f22",
    sidebarForeground: "#949ba4",
    sidebarPrimary: "#5865f2",
    sidebarPrimaryForeground: "#ffffff",
    sidebarAccent: "#3f4147",
    sidebarAccentForeground: "#f2f3f5",
    sidebarBorder: "#949ba426",
    // SidebarForeground #949ba4 with ~15% alpha
    sidebarRing: "#5865f2"
  },
  variables: {
    radius: "0.25rem"
  }
}, u5 = {
  name: "Catppuccin Mocha",
  colors: {
    background: "#1e1e2e",
    // foreground: '#cdd6f4', // Old Text
    foreground: "#cba6f7",
    // Modified: Mauve as requested
    card: "#313244",
    cardForeground: "#cba6f7",
    // Also match text
    popover: "#1e1e2e",
    popoverForeground: "#cba6f7",
    primary: "#89b4fa",
    primaryForeground: "#1e1e2e",
    secondary: "#45475a",
    secondaryForeground: "#cba6f7",
    muted: "#313244",
    mutedForeground: "#a6adc8",
    accent: "#45475a",
    accentForeground: "#cba6f7",
    destructive: "#f38ba8",
    destructiveForeground: "#1e1e2e",
    border: "#cba6f726",
    // Mauve with ~15% alpha
    input: "#313244",
    ring: "#89b4fa",
    chart1: "#89b4fa",
    chart2: "#a6e3a1",
    chart3: "#f9e2af",
    chart4: "#fab387",
    chart5: "#cba6f7",
    sidebar: "#181825",
    sidebarForeground: "#cba6f7",
    // Mauve
    sidebarPrimary: "#89b4fa",
    sidebarPrimaryForeground: "#1e1e2e",
    sidebarAccent: "#313244",
    sidebarAccentForeground: "#cba6f7",
    sidebarBorder: "#cba6f726",
    // Mauve with ~15% alpha
    sidebarRing: "#89b4fa"
  },
  variables: {
    radius: "0.5rem"
  }
}, c5 = {
  name: "SillyTavern ()",
  colors: {
    background: "var(--SmartThemeBlurTintColor)",
    foreground: "var(--SmartThemeBodyColor)",
    card: "var(--SmartThemeBlurTintColor)",
    cardForeground: "var(--SmartThemeBodyColor)",
    popover: "var(--SmartThemeBlurTintColor)",
    popoverForeground: "var(--SmartThemeBodyColor)",
    primary: "var(--SmartThemeQuoteColor)",
    primaryForeground: "var(--SmartThemeBodyColor)",
    secondary: "var(--SmartThemeBorderColor)",
    secondaryForeground: "var(--SmartThemeBodyColor)",
    muted: "rgba(0,0,0,0.2)",
    mutedForeground: "rgba(255,255,255,0.5)",
    accent: "var(--SmartThemeQuoteColor)",
    accentForeground: "var(--SmartThemeBodyColor)",
    destructive: "var(--SmartThemeBorderColor)",
    destructiveForeground: "var(--SmartThemeBodyColor)",
    border: "var(--SmartThemeBorderColor)",
    input: "var(--SmartThemeBorderColor)",
    ring: "var(--SmartThemeQuoteColor)",
    chart1: "var(--SmartThemeQuoteColor)",
    chart2: "var(--SmartThemeQuoteColor)",
    chart3: "var(--SmartThemeQuoteColor)",
    chart4: "var(--SmartThemeQuoteColor)",
    chart5: "var(--SmartThemeQuoteColor)",
    sidebar: "var(--SmartThemeBlurTintColor)",
    sidebarForeground: "var(--SmartThemeBodyColor)",
    sidebarPrimary: "var(--SmartThemeQuoteColor)",
    sidebarPrimaryForeground: "var(--SmartThemeBodyColor)",
    sidebarAccent: "var(--SmartThemeBorderColor)",
    sidebarAccentForeground: "var(--SmartThemeBodyColor)",
    sidebarBorder: "var(--SmartThemeBorderColor)",
    sidebarRing: "var(--SmartThemeQuoteColor)"
  },
  variables: {
    radius: "0.4rem"
  }
}, d5 = {
  name: "Glass (Frosted)",
  colors: {
    // 
    background: "rgba(255, 255, 255, var(--glass-opacity, 0.1))",
    foreground: "#0f172a",
    //  (Slate-900) 
    //  - 
    card: "rgba(255, 255, 255, var(--glass-opacity, 0.25))",
    cardForeground: "#0f172a",
    popover: "rgba(255, 255, 255, var(--glass-opacity, 0.4))",
    popoverForeground: "#0f172a",
    primary: "rgba(15, 23, 42, 0.8)",
    // 
    primaryForeground: "#ffffff",
    secondary: "rgba(255, 255, 255, 0.3)",
    secondaryForeground: "#0f172a",
    muted: "rgba(255, 255, 255, 0.3)",
    mutedForeground: "rgba(15, 23, 42, 0.6)",
    accent: "rgba(255, 255, 255, 0.4)",
    accentForeground: "#0f172a",
    destructive: "rgba(239, 68, 68, 0.8)",
    destructiveForeground: "#ffffff",
    border: "rgba(15, 23, 42, 0.15)",
    // Lighter base (will be resistant to fade)
    input: "rgba(255, 255, 255, 0.4)",
    ring: "rgba(15, 23, 42, 0.4)",
    chart1: "#0f172a",
    chart2: "rgba(15, 23, 42, 0.8)",
    chart3: "rgba(15, 23, 42, 0.6)",
    chart4: "rgba(15, 23, 42, 0.4)",
    chart5: "rgba(15, 23, 42, 0.2)",
    sidebar: "rgba(255, 255, 255, var(--glass-opacity, 0.15))",
    sidebarForeground: "#0f172a",
    sidebarPrimary: "rgba(15, 23, 42, 0.8)",
    sidebarPrimaryForeground: "#ffffff",
    sidebarAccent: "rgba(255, 255, 255, 0.3)",
    sidebarAccentForeground: "#0f172a",
    sidebarBorder: "rgba(15, 23, 42, 0.1)",
    // Lighter base
    sidebarRing: "rgba(15, 23, 42, 0.4)"
  },
  variables: {
    radius: "1rem"
  }
}, Fc = {
  sillytavern: c5,
  // SillyTavern 
  paperLight: i5,
  twitterDark: o5,
  claudeDark: l5,
  catppuccin: u5,
  discord: s5,
  glass: d5
}, _n = [];
for (let t = 0; t < 256; ++t)
  _n.push((t + 256).toString(16).slice(1));
function f5(t, r = 0) {
  return (_n[t[r + 0]] + _n[t[r + 1]] + _n[t[r + 2]] + _n[t[r + 3]] + "-" + _n[t[r + 4]] + _n[t[r + 5]] + "-" + _n[t[r + 6]] + _n[t[r + 7]] + "-" + _n[t[r + 8]] + _n[t[r + 9]] + "-" + _n[t[r + 10]] + _n[t[r + 11]] + _n[t[r + 12]] + _n[t[r + 13]] + _n[t[r + 14]] + _n[t[r + 15]]).toLowerCase();
}
let Ch;
const h5 = new Uint8Array(16);
function m5() {
  if (!Ch) {
    if (typeof crypto > "u" || !crypto.getRandomValues)
      throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");
    Ch = crypto.getRandomValues.bind(crypto);
  }
  return Ch(h5);
}
const p5 = typeof crypto < "u" && crypto.randomUUID && crypto.randomUUID.bind(crypto), D1 = { randomUUID: p5 };
function g5(t, r, a) {
  var s;
  t = t || {};
  const l = t.random ?? ((s = t.rng) == null ? void 0 : s.call(t)) ?? m5();
  if (l.length < 16)
    throw new Error("Random bytes length must be >= 16");
  return l[6] = l[6] & 15 | 64, l[8] = l[8] & 63 | 128, f5(l);
}
function y5(t, r, a) {
  return D1.randomUUID && !t ? D1.randomUUID() : g5(t);
}
var em = function(t, r) {
  return em = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(a, l) {
    a.__proto__ = l;
  } || function(a, l) {
    for (var s in l) Object.prototype.hasOwnProperty.call(l, s) && (a[s] = l[s]);
  }, em(t, r);
};
function gu(t, r) {
  if (typeof r != "function" && r !== null)
    throw new TypeError("Class extends value " + String(r) + " is not a constructor or null");
  em(t, r);
  function a() {
    this.constructor = t;
  }
  t.prototype = r === null ? Object.create(r) : (a.prototype = r.prototype, new a());
}
function tm(t) {
  var r = typeof Symbol == "function" && Symbol.iterator, a = r && t[r], l = 0;
  if (a) return a.call(t);
  if (t && typeof t.length == "number") return {
    next: function() {
      return t && l >= t.length && (t = void 0), { value: t && t[l++], done: !t };
    }
  };
  throw new TypeError(r ? "Object is not iterable." : "Symbol.iterator is not defined.");
}
function nm(t, r) {
  var a = typeof Symbol == "function" && t[Symbol.iterator];
  if (!a) return t;
  var l = a.call(t), s, c = [], d;
  try {
    for (; (r === void 0 || r-- > 0) && !(s = l.next()).done; ) c.push(s.value);
  } catch (m) {
    d = { error: m };
  } finally {
    try {
      s && !s.done && (a = l.return) && a.call(l);
    } finally {
      if (d) throw d.error;
    }
  }
  return c;
}
function rm(t, r, a) {
  if (a || arguments.length === 2) for (var l = 0, s = r.length, c; l < s; l++)
    (c || !(l in r)) && (c || (c = Array.prototype.slice.call(r, 0, l)), c[l] = r[l]);
  return t.concat(c || Array.prototype.slice.call(r));
}
function ua(t) {
  return typeof t == "function";
}
function wb(t) {
  var r = function(l) {
    Error.call(l), l.stack = new Error().stack;
  }, a = t(r);
  return a.prototype = Object.create(Error.prototype), a.prototype.constructor = a, a;
}
var Eh = wb(function(t) {
  return function(a) {
    t(this), this.message = a ? a.length + ` errors occurred during unsubscription:
` + a.map(function(l, s) {
      return s + 1 + ") " + l.toString();
    }).join(`
  `) : "", this.name = "UnsubscriptionError", this.errors = a;
  };
});
function am(t, r) {
  if (t) {
    var a = t.indexOf(r);
    0 <= a && t.splice(a, 1);
  }
}
var dd = (function() {
  function t(r) {
    this.initialTeardown = r, this.closed = !1, this._parentage = null, this._finalizers = null;
  }
  return t.prototype.unsubscribe = function() {
    var r, a, l, s, c;
    if (!this.closed) {
      this.closed = !0;
      var d = this._parentage;
      if (d)
        if (this._parentage = null, Array.isArray(d))
          try {
            for (var m = tm(d), g = m.next(); !g.done; g = m.next()) {
              var p = g.value;
              p.remove(this);
            }
          } catch (A) {
            r = { error: A };
          } finally {
            try {
              g && !g.done && (a = m.return) && a.call(m);
            } finally {
              if (r) throw r.error;
            }
          }
        else
          d.remove(this);
      var v = this.initialTeardown;
      if (ua(v))
        try {
          v();
        } catch (A) {
          c = A instanceof Eh ? A.errors : [A];
        }
      var x = this._finalizers;
      if (x) {
        this._finalizers = null;
        try {
          for (var E = tm(x), w = E.next(); !w.done; w = E.next()) {
            var _ = w.value;
            try {
              L1(_);
            } catch (A) {
              c = c ?? [], A instanceof Eh ? c = rm(rm([], nm(c)), nm(A.errors)) : c.push(A);
            }
          }
        } catch (A) {
          l = { error: A };
        } finally {
          try {
            w && !w.done && (s = E.return) && s.call(E);
          } finally {
            if (l) throw l.error;
          }
        }
      }
      if (c)
        throw new Eh(c);
    }
  }, t.prototype.add = function(r) {
    var a;
    if (r && r !== this)
      if (this.closed)
        L1(r);
      else {
        if (r instanceof t) {
          if (r.closed || r._hasParent(this))
            return;
          r._addParent(this);
        }
        (this._finalizers = (a = this._finalizers) !== null && a !== void 0 ? a : []).push(r);
      }
  }, t.prototype._hasParent = function(r) {
    var a = this._parentage;
    return a === r || Array.isArray(a) && a.includes(r);
  }, t.prototype._addParent = function(r) {
    var a = this._parentage;
    this._parentage = Array.isArray(a) ? (a.push(r), a) : a ? [a, r] : r;
  }, t.prototype._removeParent = function(r) {
    var a = this._parentage;
    a === r ? this._parentage = null : Array.isArray(a) && am(a, r);
  }, t.prototype.remove = function(r) {
    var a = this._finalizers;
    a && am(a, r), r instanceof t && r._removeParent(this);
  }, t.EMPTY = (function() {
    var r = new t();
    return r.closed = !0, r;
  })(), t;
})(), kb = dd.EMPTY;
function Cb(t) {
  return t instanceof dd || t && "closed" in t && ua(t.remove) && ua(t.add) && ua(t.unsubscribe);
}
function L1(t) {
  ua(t) ? t() : t.unsubscribe();
}
var b5 = {
  Promise: void 0
}, x5 = {
  setTimeout: function(t, r) {
    for (var a = [], l = 2; l < arguments.length; l++)
      a[l - 2] = arguments[l];
    return setTimeout.apply(void 0, rm([t, r], nm(a)));
  },
  clearTimeout: function(t) {
    return clearTimeout(t);
  },
  delegate: void 0
};
function v5(t) {
  x5.setTimeout(function() {
    throw t;
  });
}
function B1() {
}
function $c(t) {
  t();
}
var Im = (function(t) {
  gu(r, t);
  function r(a) {
    var l = t.call(this) || this;
    return l.isStopped = !1, a ? (l.destination = a, Cb(a) && a.add(l)) : l.destination = k5, l;
  }
  return r.create = function(a, l, s) {
    return new im(a, l, s);
  }, r.prototype.next = function(a) {
    this.isStopped || this._next(a);
  }, r.prototype.error = function(a) {
    this.isStopped || (this.isStopped = !0, this._error(a));
  }, r.prototype.complete = function() {
    this.isStopped || (this.isStopped = !0, this._complete());
  }, r.prototype.unsubscribe = function() {
    this.closed || (this.isStopped = !0, t.prototype.unsubscribe.call(this), this.destination = null);
  }, r.prototype._next = function(a) {
    this.destination.next(a);
  }, r.prototype._error = function(a) {
    try {
      this.destination.error(a);
    } finally {
      this.unsubscribe();
    }
  }, r.prototype._complete = function() {
    try {
      this.destination.complete();
    } finally {
      this.unsubscribe();
    }
  }, r;
})(dd), S5 = (function() {
  function t(r) {
    this.partialObserver = r;
  }
  return t.prototype.next = function(r) {
    var a = this.partialObserver;
    if (a.next)
      try {
        a.next(r);
      } catch (l) {
        Oc(l);
      }
  }, t.prototype.error = function(r) {
    var a = this.partialObserver;
    if (a.error)
      try {
        a.error(r);
      } catch (l) {
        Oc(l);
      }
    else
      Oc(r);
  }, t.prototype.complete = function() {
    var r = this.partialObserver;
    if (r.complete)
      try {
        r.complete();
      } catch (a) {
        Oc(a);
      }
  }, t;
})(), im = (function(t) {
  gu(r, t);
  function r(a, l, s) {
    var c = t.call(this) || this, d;
    return ua(a) || !a ? d = {
      next: a ?? void 0,
      error: l ?? void 0,
      complete: s ?? void 0
    } : d = a, c.destination = new S5(d), c;
  }
  return r;
})(Im);
function Oc(t) {
  v5(t);
}
function w5(t) {
  throw t;
}
var k5 = {
  closed: !0,
  next: B1,
  error: w5,
  complete: B1
}, C5 = (function() {
  return typeof Symbol == "function" && Symbol.observable || "@@observable";
})();
function E5(t) {
  return t;
}
function j5(t) {
  return t.length === 0 ? E5 : t.length === 1 ? t[0] : function(a) {
    return t.reduce(function(l, s) {
      return s(l);
    }, a);
  };
}
var I1 = (function() {
  function t(r) {
    r && (this._subscribe = r);
  }
  return t.prototype.lift = function(r) {
    var a = new t();
    return a.source = this, a.operator = r, a;
  }, t.prototype.subscribe = function(r, a, l) {
    var s = this, c = N5(r) ? r : new im(r, a, l);
    return $c(function() {
      var d = s, m = d.operator, g = d.source;
      c.add(m ? m.call(c, g) : g ? s._subscribe(c) : s._trySubscribe(c));
    }), c;
  }, t.prototype._trySubscribe = function(r) {
    try {
      return this._subscribe(r);
    } catch (a) {
      r.error(a);
    }
  }, t.prototype.forEach = function(r, a) {
    var l = this;
    return a = U1(a), new a(function(s, c) {
      var d = new im({
        next: function(m) {
          try {
            r(m);
          } catch (g) {
            c(g), d.unsubscribe();
          }
        },
        error: c,
        complete: s
      });
      l.subscribe(d);
    });
  }, t.prototype._subscribe = function(r) {
    var a;
    return (a = this.source) === null || a === void 0 ? void 0 : a.subscribe(r);
  }, t.prototype[C5] = function() {
    return this;
  }, t.prototype.pipe = function() {
    for (var r = [], a = 0; a < arguments.length; a++)
      r[a] = arguments[a];
    return j5(r)(this);
  }, t.prototype.toPromise = function(r) {
    var a = this;
    return r = U1(r), new r(function(l, s) {
      var c;
      a.subscribe(function(d) {
        return c = d;
      }, function(d) {
        return s(d);
      }, function() {
        return l(c);
      });
    });
  }, t.create = function(r) {
    return new t(r);
  }, t;
})();
function U1(t) {
  var r;
  return (r = t ?? b5.Promise) !== null && r !== void 0 ? r : Promise;
}
function _5(t) {
  return t && ua(t.next) && ua(t.error) && ua(t.complete);
}
function N5(t) {
  return t && t instanceof Im || _5(t) && Cb(t);
}
function T5(t) {
  return ua(t == null ? void 0 : t.lift);
}
function A5(t) {
  return function(r) {
    if (T5(r))
      return r.lift(function(a) {
        try {
          return t(a, this);
        } catch (l) {
          this.error(l);
        }
      });
    throw new TypeError("Unable to lift unknown Observable type");
  };
}
function M5(t, r, a, l, s) {
  return new z5(t, r, a, l, s);
}
var z5 = (function(t) {
  gu(r, t);
  function r(a, l, s, c, d, m) {
    var g = t.call(this, a) || this;
    return g.onFinalize = d, g.shouldUnsubscribe = m, g._next = l ? function(p) {
      try {
        l(p);
      } catch (v) {
        a.error(v);
      }
    } : t.prototype._next, g._error = c ? function(p) {
      try {
        c(p);
      } catch (v) {
        a.error(v);
      } finally {
        this.unsubscribe();
      }
    } : t.prototype._error, g._complete = s ? function() {
      try {
        s();
      } catch (p) {
        a.error(p);
      } finally {
        this.unsubscribe();
      }
    } : t.prototype._complete, g;
  }
  return r.prototype.unsubscribe = function() {
    var a;
    if (!this.shouldUnsubscribe || this.shouldUnsubscribe()) {
      var l = this.closed;
      t.prototype.unsubscribe.call(this), !l && ((a = this.onFinalize) === null || a === void 0 || a.call(this));
    }
  }, r;
})(Im), R5 = wb(function(t) {
  return function() {
    t(this), this.name = "ObjectUnsubscribedError", this.message = "object unsubscribed";
  };
}), Um = (function(t) {
  gu(r, t);
  function r() {
    var a = t.call(this) || this;
    return a.closed = !1, a.currentObservers = null, a.observers = [], a.isStopped = !1, a.hasError = !1, a.thrownError = null, a;
  }
  return r.prototype.lift = function(a) {
    var l = new P1(this, this);
    return l.operator = a, l;
  }, r.prototype._throwIfClosed = function() {
    if (this.closed)
      throw new R5();
  }, r.prototype.next = function(a) {
    var l = this;
    $c(function() {
      var s, c;
      if (l._throwIfClosed(), !l.isStopped) {
        l.currentObservers || (l.currentObservers = Array.from(l.observers));
        try {
          for (var d = tm(l.currentObservers), m = d.next(); !m.done; m = d.next()) {
            var g = m.value;
            g.next(a);
          }
        } catch (p) {
          s = { error: p };
        } finally {
          try {
            m && !m.done && (c = d.return) && c.call(d);
          } finally {
            if (s) throw s.error;
          }
        }
      }
    });
  }, r.prototype.error = function(a) {
    var l = this;
    $c(function() {
      if (l._throwIfClosed(), !l.isStopped) {
        l.hasError = l.isStopped = !0, l.thrownError = a;
        for (var s = l.observers; s.length; )
          s.shift().error(a);
      }
    });
  }, r.prototype.complete = function() {
    var a = this;
    $c(function() {
      if (a._throwIfClosed(), !a.isStopped) {
        a.isStopped = !0;
        for (var l = a.observers; l.length; )
          l.shift().complete();
      }
    });
  }, r.prototype.unsubscribe = function() {
    this.isStopped = this.closed = !0, this.observers = this.currentObservers = null;
  }, Object.defineProperty(r.prototype, "observed", {
    get: function() {
      var a;
      return ((a = this.observers) === null || a === void 0 ? void 0 : a.length) > 0;
    },
    enumerable: !1,
    configurable: !0
  }), r.prototype._trySubscribe = function(a) {
    return this._throwIfClosed(), t.prototype._trySubscribe.call(this, a);
  }, r.prototype._subscribe = function(a) {
    return this._throwIfClosed(), this._checkFinalizedStatuses(a), this._innerSubscribe(a);
  }, r.prototype._innerSubscribe = function(a) {
    var l = this, s = this, c = s.hasError, d = s.isStopped, m = s.observers;
    return c || d ? kb : (this.currentObservers = null, m.push(a), new dd(function() {
      l.currentObservers = null, am(m, a);
    }));
  }, r.prototype._checkFinalizedStatuses = function(a) {
    var l = this, s = l.hasError, c = l.thrownError, d = l.isStopped;
    s ? a.error(c) : d && a.complete();
  }, r.prototype.asObservable = function() {
    var a = new I1();
    return a.source = this, a;
  }, r.create = function(a, l) {
    return new P1(a, l);
  }, r;
})(I1), P1 = (function(t) {
  gu(r, t);
  function r(a, l) {
    var s = t.call(this) || this;
    return s.destination = a, s.source = l, s;
  }
  return r.prototype.next = function(a) {
    var l, s;
    (s = (l = this.destination) === null || l === void 0 ? void 0 : l.next) === null || s === void 0 || s.call(l, a);
  }, r.prototype.error = function(a) {
    var l, s;
    (s = (l = this.destination) === null || l === void 0 ? void 0 : l.error) === null || s === void 0 || s.call(l, a);
  }, r.prototype.complete = function() {
    var a, l;
    (l = (a = this.destination) === null || a === void 0 ? void 0 : a.complete) === null || l === void 0 || l.call(a);
  }, r.prototype._subscribe = function(a) {
    var l, s;
    return (s = (l = this.source) === null || l === void 0 ? void 0 : l.subscribe(a)) !== null && s !== void 0 ? s : kb;
  }, r;
})(Um);
function O5(t, r) {
  return A5(function(a, l) {
    var s = 0;
    a.subscribe(M5(l, function(c) {
      return t.call(r, c, s++) && l.next(c);
    }));
  });
}
const Dc = new Um(), D5 = {
  /**
   * 
   */
  emit(t) {
    Dc.next({
      ...t,
      timestamp: Date.now()
    });
  },
  /**
   * 
   */
  subscribe(t) {
    const r = Dc.subscribe(t);
    return {
      unsubscribe: () => r.unsubscribe()
    };
  },
  /**
   * 
   */
  on(t, r) {
    const a = Dc.pipe(O5((l) => l.type === t)).subscribe((l) => r(l.payload));
    return {
      unsubscribe: () => a.unsubscribe()
    };
  },
  /**
   *  RxJS 
   */
  asObservable() {
    return Dc.asObservable();
  }
};
var Ut = /* @__PURE__ */ ((t) => (t[t.DEBUG = 0] = "DEBUG", t[t.INFO = 1] = "INFO", t[t.SUCCESS = 2] = "SUCCESS", t[t.WARN = 3] = "WARN", t[t.ERROR = 4] = "ERROR", t))(Ut || {});
const Zc = {
  0: { label: "DEBUG", icon: "", color: "#6c757d" },
  1: { label: "INFO", icon: "", color: "#17a2b8" },
  2: { label: "OK", icon: "", color: "#28a745" },
  3: { label: "WARN", icon: "", color: "#ffc107" },
  4: { label: "ERROR", icon: "", color: "#dc3545" }
}, Eb = {
  maxEntries: 5e3,
  minLevel: 0
  /* DEBUG */
}, jb = new Um();
let Ha = [], nu = { ...Eb };
function L5(t) {
  return new Date(t).toTimeString().slice(0, 8);
}
function Ro(t, r, a, l) {
  if (t < nu.minLevel) return;
  const s = {
    id: y5(),
    timestamp: Date.now(),
    level: t,
    module: r,
    message: a,
    data: l
  };
  Ha.push(s), Ha.length > nu.maxEntries && (Ha = Ha.slice(-nu.maxEntries)), jb.next(s);
}
function B5() {
  D5.subscribe((t) => {
    const a = {
      INGESTION_START: Ut.INFO,
      INGESTION_COMPLETE: Ut.SUCCESS,
      ENTITY_CREATED: Ut.INFO,
      MEMORY_STORED: Ut.SUCCESS,
      RETRIEVAL_START: Ut.DEBUG,
      RETRIEVAL_COMPLETE: Ut.SUCCESS,
      CHAT_CHANGED: Ut.INFO,
      MESSAGE_RECEIVED: Ut.DEBUG
    }[t.type] ?? Ut.DEBUG;
    Ro(a, "EventBus", `${t.type}`, t.payload);
  });
}
const W = {
  /**
   *  Logger
   */
  init(t) {
    t && (nu = { ...nu, ...t }), Ha = [], B5(), W.info("Logger", "Logger ");
  },
  /**
   * DEBUG 
   */
  debug(t, r, a) {
    Ro(Ut.DEBUG, t, r, a);
  },
  /**
   * INFO 
   */
  info(t, r, a) {
    Ro(Ut.INFO, t, r, a);
  },
  /**
   * SUCCESS 
   */
  success(t, r, a) {
    Ro(Ut.SUCCESS, t, r, a);
  },
  /**
   * WARN 
   */
  warn(t, r, a) {
    Ro(Ut.WARN, t, r, a);
  },
  /**
   * ERROR 
   */
  error(t, r, a) {
    Ro(Ut.ERROR, t, r, a);
  },
  /**
   * 
   */
  getLogs() {
    return [...Ha];
  },
  /**
   * 
   */
  subscribe(t) {
    const r = jb.subscribe(t);
    return () => r.unsubscribe();
  },
  /**
   * 
   */
  clear() {
    Ha = [], W.info("Logger", "");
  },
  /**
   *  Markdown 
   */
  exportToMarkdown() {
    const t = /* @__PURE__ */ new Date();
    t.toISOString().slice(0, 10), t.toTimeString().slice(0, 8).replace(/:/g, "");
    const r = {
      [Ut.DEBUG]: "DEBUG",
      [Ut.INFO]: "INFO",
      [Ut.SUCCESS]: "SUCCESS",
      [Ut.WARN]: "WARN",
      [Ut.ERROR]: "ERROR"
    };
    let a = `# Engram Debug Log

`;
    a += `- ****: ${t.toLocaleString("zh-CN")}
`, a += `- ****: 0.1.0
`, a += `- ****: ${Ha.length}

`, a += `---

`, a += `## 

`, a += "```\n";
    for (const l of Ha) {
      const s = L5(l.timestamp), c = r[l.level].padEnd(7), d = l.module.padEnd(16);
      if (a += `[${s}] [${d}] ${c} ${l.message}
`, l.data !== void 0) {
        const m = JSON.stringify(l.data, null, 2).split(`
`).map((g) => `    ${g}`).join(`
`);
        a += `${m}
`;
      }
    }
    return a += "```\n", a;
  },
  /**
   * 
   */
  getExportFilename() {
    const t = /* @__PURE__ */ new Date(), r = t.toISOString().slice(0, 10), a = t.toTimeString().slice(0, 8).replace(/:/g, "");
    return `engram_log_${r}_${a}.md`;
  }
}, q1 = 100;
class I5 {
  constructor() {
    Xe(this, "entries", []);
    Xe(this, "listeners", /* @__PURE__ */ new Set());
  }
  /**
   * 
   */
  logSend(r) {
    const a = `log_${Date.now()}_${Math.random().toString(36).slice(2, 8)}`, l = {
      id: a,
      timestamp: Date.now(),
      type: r.type,
      direction: "sent",
      systemPrompt: r.systemPrompt,
      userPrompt: r.userPrompt,
      tokensSent: r.tokensSent,
      model: r.model,
      character: r.character,
      floorRange: r.floorRange,
      status: "pending"
    };
    return this.entries.unshift(l), this.trimEntries(), this.notifyListeners(), a;
  }
  /**
   * 
   */
  logReceive(r, a) {
    const l = this.entries.find((d) => d.id === r);
    if (!l) return;
    const s = {
      id: `${r}_recv`,
      timestamp: Date.now(),
      type: l.type,
      direction: "received",
      response: a.response,
      tokensReceived: a.tokensReceived,
      status: a.status,
      error: a.error,
      duration: a.duration,
      model: l.model,
      character: l.character,
      floorRange: l.floorRange
    };
    l.status = a.status, l.duration = a.duration;
    const c = this.entries.findIndex((d) => d.id === r);
    c >= 0 ? this.entries.splice(c, 0, s) : this.entries.unshift(s), this.trimEntries(), this.notifyListeners();
  }
  /**
   * 
   */
  async logCall(r, a) {
    const l = this.logSend(r), s = Date.now();
    try {
      const c = await a();
      return this.logReceive(l, {
        response: typeof c == "string" ? c : JSON.stringify(c),
        status: "success",
        duration: Date.now() - s
      }), c;
    } catch (c) {
      throw this.logReceive(l, {
        status: "error",
        error: c instanceof Error ? c.message : String(c),
        duration: Date.now() - s
      }), c;
    }
  }
  /**
   * 
   */
  getAll() {
    return [...this.entries];
  }
  /**
   * +
   */
  getPaired() {
    const r = [], a = this.entries.filter((l) => l.direction === "sent");
    for (const l of a) {
      const s = this.entries.find(
        (c) => c.id === `${l.id}_recv` && c.direction === "received"
      );
      r.push({ sent: l, received: s });
    }
    return r;
  }
  /**
   * 
   */
  clear() {
    this.entries = [], this.notifyListeners();
  }
  /**
   * 
   */
  subscribe(r) {
    return this.listeners.add(r), () => this.listeners.delete(r);
  }
  /**
   * 
   */
  getCount() {
    return this.entries.filter((r) => r.direction === "sent").length;
  }
  /**
   * 
   */
  trimEntries() {
    this.entries.length > q1 * 2 && (this.entries = this.entries.slice(0, q1 * 2));
  }
  /**
   * 
   */
  notifyListeners() {
    for (const r of this.listeners)
      r();
  }
}
const Ir = new I5(), Pm = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  DEFAULT_LOGGER_CONFIG: Eb,
  LogLevel: Ut,
  LogLevelConfig: Zc,
  Logger: W,
  ModelLogger: Ir
}, Symbol.toStringTag, { value: "Module" })), U5 = `<system_configuration>
  <role_definition>
    : 
    : """"""
    
    :
      : 
      : 
      : 
      : 
    
    :
      - 
      -  YAML 
      - 
      - 
  </role_definition>

  <formatting_protocol>
    :  JSON 
    :
      - summary: //
      - meta:  (role, location, event, logic, causality)
      - significance_score: 0.0-1.0 
  </formatting_protocol>

  <logic_protocol>
    :
      : ""
      : """"
    
    :
      : 
      : 
        : "102344"
        : "1""3"""
      : 
        :  HH:MM (14:30)
        :  
        :   

     (Token):
      : 
      : 
       ():
        1: {{user}}
        2: {{user}}
        3: {{user}}...
       ():
        1: [ | {{user}}, , ] {{user}} ( | 0.7)

     ():
      -: "/"
        : {{user}}
        : {{user}}
      : ""
        : {{user}}...
        : {{user}}
      : 
        : {{user}}{{user}}...
        : {{user}}
      : """"
        : {{user}}
        : {{user}}

     ():
      _ (Foundation):
        : 0.1 - 0.4
        : >60%
        : """" 0.3-0.4 ()
      _ (Propulsion):
        : 0.5 - 0.7
        :  <30%
        : 
      _ (Keystone):
        : 0.8 - 0.9
        :  <10%
        : 
        : 
      _ (Turning Point):
        : 1.0
        : "" 1%
        : 
  </logic_protocol>

  <output_template>
    <think>
      :
        : \${}
        : \${}
      
      :
        : \${}
        : \${}
      
      :
        : \${}
        : \${}
      
      :
        : \${}
        : \${}
    </think>

    \`\`\`json
    {
      "events": [
        {
          "summary": "//",
          "meta": {
            "time_anchor": " 102344 ",
            "role": [""],
            "location": "",
            "event": "",
            "logic": [""],
            "causality": "Start|Chain|End"
          },
          "significance_score": 0.7
        }
      ]
    }
    \`\`\`
  </output_template>
  
  <example_demonstration>
    :
      "ABBA
      () AB""A""
      () A""A"""

    AI:
      <think>
        :
          : //
          : 
        
        :
          1: A (//) -> 
          2: B (//) -> 
          3:  +  -> 
          4:  +  -> 
      </think>

      \`\`\`json
      {
        "events": [
          {
            "summary": "ABBA",
            "meta": {
              "time_anchor": "102344 ",
              "role": ["A", "B"],
              "location": "",
              "event": "",
              "logic": ["", "", ""],
              "causality": "Start"
            },
            "significance_score": 0.8
          },
          {
            "summary": "ABA",
            "meta": {
              "role": ["A", "B", ""],
              "location": "",
              "event": "",
              "logic": ["", "", ""],
              "causality": "Chain"
            },
            "significance_score": 0.8
          },
          {
            "summary": "A",
            "meta": {
              "role": ["A", ""],
              "location": "",
              "event": "",
              "logic": ["", "", ""],
              "causality": "Start"
            },
            "significance_score": 0.6
          }
        ]
      }
      \`\`\`
  </example_demonstration>
</system_configuration>
`, _b = `<system_configuration>
  <role_definition>
    : 
    : "" Token 
    
    :
      : 
      : 
      : 
      : 
    
    :
      - 
      - 
      - 
      - 
  </role_definition>

  <compression_protocol>
    _: 
      : 
      :
        - P0 (): //
        - P1 (): /
        - P2 (): 
    
    _:
      : 
      :   
    
    _:
      : 
      :
        : "A " + "A "  "A " ()
        : "A "
  </compression_protocol>

  <merge_strategy>
    _:
      : 
      :
        :
          1. [3 | ] A  ( | 0.2)
          2. [5 | ] A  ( | 0.2)
          3. [7 | ] A  ( | 0.5)
        :
          1. [3-7 | ] A  ( | 0.5)
    
    _:
      : 
      : 
    
    _:
      : 
      :
        : "A " + "A " + "A "
        : "A "
      : ""
  </merge_strategy>

  <output_format>
    :  JSON  text_summary 
    :
      - summary: 
      - meta:  (role, location, event, logic, causality)
      - significance_score: 0.0-1.0  ()
    
    :  30-50%
  </output_format>

  <example_demonstration>
     ():
      \`\`\`
      (102344 ) AB
      Role: [A, B]
      Loc: 
      Event: 
      Logic: []
      Causality: Start
      Significance: 0.8

      (102344 ) BA
      Role: [A, B]
      Loc: 
      Event: 
      Logic: []
      Causality: Chain
      Significance: 0.6

      (1023-1026 ) AB
      Role: [A, ]
      Loc: 
      Event: 
      Logic: []
      Causality: Chain
      Significance: 0.4

      (1026 ) A
      Role: [A, B]
      Loc: B
      Event: 
      Logic: []
      Causality: End
      Significance: 0.8

      (410 ) A
      Role: [A]
      Loc: 
      Event: 
      Logic: []
      Causality: Start
      Significance: 0.3

      (410 14:30) A
      Role: [A, ]
      Loc: 
      Event: 
      Logic: [, ]
      Causality: Chain
      Significance: 0.7
      \`\`\`

     (JSON ):
      \`\`\`json
      {
        "events": [
          {
            "summary": "ABBA",
            "meta": {
              "time_anchor": "102344",
              "role": ["A", "B"],
              "location": "",
              "event": "",
              "logic": ["", "", ""],
              "causality": "Start"
            },
            "significance_score": 0.8
          },
          {
            "summary": "AB",
            "meta": {
              "time_anchor": "1023-1026",
              "role": ["A", "B", ""],
              "location": "",
              "event": "",
              "logic": ["", ""],
              "causality": "Chain"
            },
            "significance_score": 0.8
          },
          {
            "summary": "A",
            "meta": {
              "time_anchor": "410",
              "role": ["A", ""],
              "location": "",
              "event": "",
              "logic": ["", "", ""],
              "causality": "Start"
            },
            "significance_score": 0.7
          }
        ]
      }
      \`\`\`
  </example_demonstration>
</system_configuration>

`, P5 = `# Query 

""""

---

## 

****
{{worldbookContext}}

****
{{chatHistory}}

---

## 


1. ****""""""
2. ****
3. ****

---

## 

\`\`\`xml
<think>
[]
</think>

<query>
1, 2, 3, ...
</query>

<output>
[]
</output>
\`\`\`

---

## 

****

****
\`\`\`xml
<think>

- "" Alice  Bob
- ""
</think>

<query>
Alice, Bob, , , , 
</query>

<output>
 Alice  Bob 
</output>
\`\`\`

---

## 

{{userInput}}
`, q5 = `<system_configuration>
  <role_definition>
    :  / 
    : 

    :
      : 
      : 
      : """"

    :
      - 
      - 
      - 
      -  plot 
  </role_definition>

  <behavior_guidelines>
    :
      : 
      :
        1. 
        2. 
        3. 
      :
        : 
        : 
      :  think  output 

    :
      : 
      :
        - :  "500"   ""
        - :  "3"   ""
        - : 
        - :  ""   ""
      : AI
  </behavior_guidelines>

  <core_rules>
    A_:
      A1_:
        : 
        NPC: NPC
        : 

      A2_:
        : 10
        : NPC510
        : 

      A3_:
        : 20
        :
          : 
          : 
        : 

      A4_:
        :
          1: 
          2: 
          3: 

        :
          : 
          : 80
          : 100
          : 

    B_:
      B1_:
        : 
        : 
        : 

      B2_:
        : /
          : [] [: X] []  []  []
        : 
          : [] [] [] [] [: X]
        : 
          : [] [: X] []  []

      B3_:
        : 1-2
        : 

    C_:
      : 
      :
        : 
        : 
        : 
        :  {{user}} 
      :
        : 
        : 
  </core_rules>

  <writing_style>
    :
      : 
      : 
      : 
      : 
      : 
  </writing_style>

  <output_template>
    <think>
      :
        :
          : \${}
          : \${}
          : \${}
        :
          : \${}
          : \${}
        :
          : \${}
          : \${//}

      10:
        : \${}
        :
          1: \${}
          2: \${}
          ...
        :
          : \${}
        :
          : \${}
          : \${}

      :
        : \${}
        : \${} + \${} = \${}/100
        : \${} + \${} = \${}/100
        : \${(80)(100)}

      :
        :
          : \${/}
          : \${}
    </think>

    <query>
    \${ RAG }
    1, , , , ...
    </query>

    <output>
    <plot>
      <directive>
        <goal>\${}</goal>
        <plot_summary>\${}</plot_summary>
        <key_points>
          <point>\${+}</point>
          <point>\${}</point>
          <point>\${}</point>
          <point>\${}</point>
          <point>\${}</point>
        </key_points>
      </directive>

      :
        : \${}/100 \${}
        : \${}/100
        : \${}
        : \${}
        : \${}
        : \${}
        : \${NPC -  ()}

        :
          1. \${[] [] }
          2. \${[] [] }
    </plot>
    </output>
  </output_template>
</system_configuration>
`, H5 = `# 



---

## 

****
{{context}}

****
{{chatHistory}}

---

## 


1. ****
2. ****
3. ****
4. ****

---

## 

\`\`\`xml
<think>
[]
</think>

<output>
[]
</output>
\`\`\`

---

## 

****

****
\`\`\`xml
<think>

- 
- 
- 
</think>

<output>

</output>
\`\`\`

---

## 

{{userInput}}
`, Nb = {
  enabled: !0,
  decayFactor: 0.15,
  maxStickRounds: 3
};
class F5 {
  constructor() {
    /** : eventId -> StickyCacheEntry */
    Xe(this, "cache", /* @__PURE__ */ new Map());
    /**  */
    Xe(this, "currentRound", 0);
  }
  /**
   * 
   */
  nextRound() {
    this.currentRound++, W.debug("StickyCache", ` ${this.currentRound} `);
  }
  /**
   * 
   */
  getCurrentRound() {
    return this.currentRound;
  }
  /**
   * 
   */
  markRecalled(r) {
    const a = this.cache.get(r);
    a && a.lastRound === this.currentRound - 1 ? this.cache.set(r, {
      lastRound: this.currentRound,
      consecutiveCount: a.consecutiveCount + 1
    }) : this.cache.set(r, {
      lastRound: this.currentRound,
      consecutiveCount: 1
    });
  }
  /**
   * 
   */
  markRecalledBatch(r) {
    r.forEach((a) => this.markRecalled(a));
  }
  /**
   * 
   *
   * @param eventId  ID
   * @param config 
   * @returns  [0, 1]0 = 1 = 
   */
  getStickyPenalty(r, a) {
    if (!a.enabled) return 0;
    const l = this.cache.get(r);
    return !l || this.currentRound - l.lastRound > a.maxStickRounds ? 0 : Math.min(1, l.consecutiveCount * a.decayFactor);
  }
  /**
   * 
   */
  isSticky(r, a) {
    return this.getStickyPenalty(r, a) > 0;
  }
  /**
   * 
   *
   * @param maxAge 
   */
  cleanup(r = 10) {
    let a = 0;
    for (const [l, s] of this.cache)
      this.currentRound - s.lastRound > r && (this.cache.delete(l), a++);
    a > 0 && W.debug("StickyCache", ` ${a} `);
  }
  /**
   * 
   */
  clear() {
    this.cache.clear(), this.currentRound = 0, W.debug("StickyCache", "");
  }
  /**
   * 
   */
  getStats() {
    return {
      size: this.cache.size,
      currentRound: this.currentRound
    };
  }
  /**
   * /
   */
  getEventInfo(r) {
    return this.cache.get(r);
  }
}
const Gs = new F5(), Jc = [
  { value: "summary", label: "", description: " JSON " },
  { value: "trim", label: "/", description: "" },
  { value: "preprocessing", label: "", description: "Query //" }
], $5 = {
  enableNativeRegex: !0,
  enableEngramRegex: !0
}, fd = {
  enabled: !0,
  useEmbedding: !0,
  useRerank: !1,
  usePreprocessing: !1,
  useBruteForce: !1,
  //  Embedding 
  embedding: {
    topK: 20,
    minScoreThreshold: 0.3
  },
  sticky: { ...Nb, enabled: !0 }
}, G5 = {
  temperature: 0.7,
  topP: 0.95,
  maxTokens: 2048,
  frequencyPenalty: 0,
  presencePenalty: 0
}, V5 = {
  maxChatHistory: 10
}, K5 = {
  source: "transformers"
}, Y5 = {
  enabled: !1,
  url: "",
  apiKey: "",
  model: "",
  topN: 5,
  hybridAlpha: 0.5
}, H1 = {
  enabled: !1,
  trigger: "with_trim",
  concurrency: 5,
  keepRecentCount: 3
};
function Tb(t = "") {
  const r = Date.now();
  return {
    id: `preset_${r}`,
    name: t,
    source: "tavern",
    parameters: { ...G5 },
    context: { ...V5 },
    isDefault: !0,
    createdAt: r,
    updatedAt: r
  };
}
function Mi(t, r, a = {}) {
  const l = Date.now();
  return {
    id: a.id || `template_${l}_${Math.random().toString(36).slice(2, 8)}`,
    name: t,
    category: r,
    enabled: a.enabled ?? !1,
    isBuiltIn: a.isBuiltIn ?? !1,
    boundPresetId: a.boundPresetId ?? null,
    systemPrompt: a.systemPrompt ?? "",
    userPromptTemplate: a.userPromptTemplate ?? "",
    outputFormat: a.outputFormat ?? "plain",
    availableVariables: a.availableVariables ?? ["{{chatHistory}}", "{{context}}", "{{char}}", "{{user}}"],
    createdAt: l,
    updatedAt: l
  };
}
function qm() {
  return [
    Mi("", "summary", {
      id: "builtin_summary",
      enabled: !0,
      isBuiltIn: !0,
      systemPrompt: U5,
      userPromptTemplate: `{{worldbookContext}}


{{chatHistory}}

---
 JSON `,
      outputFormat: "json"
    }),
    Mi("", "trim", {
      id: "builtin_trim",
      enabled: !0,
      isBuiltIn: !0,
      systemPrompt: _b,
      userPromptTemplate: `{{worldbookContext}}




{{engramSummaries}}

`,
      outputFormat: "json"
    }),
    Mi("Query ", "preprocessing", {
      id: "builtin_query_enhance",
      enabled: !0,
      isBuiltIn: !0,
      systemPrompt: P5,
      userPromptTemplate: `****:
{{worldbookContext}}

****:
{{chatHistory}}

****:
{{userInput}}

---
`,
      outputFormat: "plain",
      availableVariables: ["{{worldbookContext}}", "{{chatHistory}}", "{{userInput}}", "{{char}}", "{{user}}"]
    }),
    Mi("", "preprocessing", {
      id: "builtin_plot_director",
      enabled: !1,
      // 
      isBuiltIn: !0,
      systemPrompt: q5,
      userPromptTemplate: `****:
{{worldbookContext}}

****:
{{chatHistory}}

****:
{{userInput}}

---
`,
      outputFormat: "plain",
      //  AI 
      availableVariables: ["{{worldbookContext}}", "{{context}}", "{{chatHistory}}", "{{userInput}}", "{{char}}", "{{user}}"]
    }),
    Mi("", "preprocessing", {
      id: "builtin_description_enhance",
      enabled: !1,
      // 
      isBuiltIn: !0,
      systemPrompt: H5,
      userPromptTemplate: `****:
{{chatHistory}}

****:
{{userInput}}

---
`,
      outputFormat: "plain",
      // 
      availableVariables: ["{{context}}", "{{chatHistory}}", "{{userInput}}", "{{char}}", "{{user}}"]
    })
  ];
}
function Ab(t) {
  return qm().find((r) => r.id === t);
}
function Hm(t) {
  return qm().find((r) => r.category === t) || null;
}
const Q5 = {
  enabled: !0,
  includeGlobal: !0,
  disabledWorldbooks: [],
  enableEJS: !0
  // V0.8  EJS
}, X5 = {
  enabled: !1,
  trigger: "token",
  tokenLimit: 4096,
  countLimit: 5,
  keepRecentCount: 3,
  preserveOriginal: !1,
  previewEnabled: !0
};
function F1() {
  return {
    llmPresets: [Tb()],
    selectedPresetId: null,
    vectorConfig: { ...K5 },
    rerankConfig: { ...Y5 },
    promptTemplates: qm(),
    worldbookConfig: { ...Q5 },
    regexConfig: { ...$5 },
    // V0.8
    recallConfig: { ...fd }
    // V0.8.5
  };
}
const gl = Object.freeze({
  theme: "odysseia",
  presets: {},
  templates: {},
  promptTemplates: [],
  hasSeenWelcome: !1,
  lastReadVersion: "0.0.0",
  summarizerConfig: {},
  trimmerConfig: {},
  regexRules: [],
  apiSettings: null,
  preprocessingConfig: null,
  // V0.8: 
  linkedDeletion: {
    enabled: !0,
    deleteWorldbook: !0,
    deleteChatWorldbook: !1,
    // 
    deleteIndexedDB: !1,
    showConfirmation: !0
  },
  glassSettings: {
    enabled: !0,
    opacity: 0.3,
    blur: 10
  }
});
class Ke {
  /**
   *  SillyTavern context
   */
  static getContext() {
    var r, a;
    return (a = (r = window.SillyTavern) == null ? void 0 : r.getContext) == null ? void 0 : a.call(r);
  }
  /**
   * 
   * 
   */
  static getSettings() {
    const r = this.getContext();
    return r != null && r.extensionSettings ? (r.extensionSettings[this.EXTENSION_NAME] || (r.extensionSettings[this.EXTENSION_NAME] = { ...gl }, W.debug("SettingsManager", "Initialized engram settings with defaults"), this.save()), r.extensionSettings[this.EXTENSION_NAME]) : (W.warn("SettingsManager", "SillyTavern context.extensionSettings not available"), { ...gl });
  }
  static getExtensionSettings() {
    return this.getSettings();
  }
  /**
   * 
   * 
   */
  static initSettings() {
    const r = this.getContext();
    if (!(r != null && r.extensionSettings)) {
      W.warn("SettingsManager", "Cannot init settings: context not available");
      return;
    }
    let a = !1;
    r.extensionSettings[this.EXTENSION_NAME] || (r.extensionSettings[this.EXTENSION_NAME] = { ...gl }, a = !0, W.info("SettingsManager", "Created engram settings"));
    const l = r.extensionSettings[this.EXTENSION_NAME];
    for (const s of Object.keys(gl))
      s in l || (l[s] = gl[s], a = !0, W.debug("SettingsManager", `Added missing field: ${s}`));
    a && this.save();
  }
  /**
   * Get a specific setting value
   */
  static get(r) {
    const l = this.getExtensionSettings()[r];
    return l !== void 0 ? l : gl[r];
  }
  /**
   * Save a specific setting value
   *  context.extensionSettings 
   */
  static set(r, a) {
    const l = this.getContext();
    if (!(l != null && l.extensionSettings)) {
      W.warn("SettingsManager", "Cannot set: context.extensionSettings not available");
      return;
    }
    l.extensionSettings[this.EXTENSION_NAME] || (l.extensionSettings[this.EXTENSION_NAME] = { ...gl }), l.extensionSettings[this.EXTENSION_NAME][r] = a, W.debug("SettingsManager", `Set ${String(r)} = ${JSON.stringify(a)}`), this.save();
  }
  /**
   * 
   */
  static save() {
    const r = this.getContext();
    r != null && r.saveSettingsDebounced ? (r.saveSettingsDebounced(), W.debug("SettingsManager", "Saved via context.saveSettingsDebounced")) : W.warn("SettingsManager", "saveSettingsDebounced not available");
  }
  /**
   * Load settings from SillyTavern global state
   * 
   */
  static loadSettings() {
    return this.getExtensionSettings();
  }
  /**
   * 
   * @param category 
   * @returns  null
   */
  static getEnabledPromptTemplate(r) {
    const a = this.get("apiSettings");
    return ((a == null ? void 0 : a.promptTemplates) || []).find((s) => s.category === r && s.enabled) || null;
  }
  /**
   *  ID 
   * @param id  ID
   * @returns  null
   */
  static getPromptTemplateById(r) {
    const a = this.get("apiSettings"), l = (a == null ? void 0 : a.promptTemplates) || [], s = l.find((d) => d.id === r);
    if (s) return s;
    const c = Ab(r);
    return c || l.find((d) => d.category === r && d.enabled) || null;
  }
  /**
   * 
   * @returns summarizerConfig 
   */
  static getSummarizerSettings() {
    return this.get("summarizerConfig") || {};
  }
  /**
   * 
   * @param config 
   */
  static setSummarizerSettings(r) {
    const a = this.getSummarizerSettings();
    this.set("summarizerConfig", { ...a, ...r });
  }
  /**
   * 
   * @returns RegexRule[] 
   */
  static getRegexRules() {
    return this.get("regexRules") || [];
  }
  /**
   * 
   * @param rules 
   */
  static setRegexRules(r) {
    this.set("regexRules", r);
  }
}
Xe(Ke, "EXTENSION_NAME", "engram");
const Mb = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  SettingsManager: Ke
}, Symbol.toStringTag, { value: "Module" }));
class Di {
  /**
   * 
   */
  static init() {
    this.injectStyles();
    let a = Ke.loadSettings().theme;
    a || (a = localStorage.getItem(this.STORAGE_KEY), a && Ke.set("theme", a));
    const l = Fc[a] ? a : "claudeDark";
    this.setTheme(l), W.info("ThemeManager", `: ${l}`);
  }
  /**
   * 
   */
  static setTheme(r) {
    Fc[r] || (W.warn("ThemeManager", `: ${r},  claudeDark`), r = "claudeDark"), this.currentTheme = r, Ke.set("theme", r), localStorage.setItem(this.STORAGE_KEY, r), this.applyThemeVariables(r);
  }
  /**
   * 
   */
  static getTheme() {
    return this.currentTheme;
  }
  /**
   *  (dist/style.css)
   */
  static injectStyles() {
    const r = "engram-styles";
    if (document.getElementById(r)) return;
    const a = document.createElement("link");
    a.id = r, a.rel = "stylesheet", a.type = "text/css", a.href = `scripts/extensions/Engram_project/dist/style.css?v=${Date.now()}`, document.head.appendChild(a);
  }
  /**
   *  CSS 
   */
  static applyThemeVariables(r) {
    var _, A;
    const a = Fc[r];
    if (!a) return;
    const l = document.documentElement, s = (D, R) => {
      l.style.setProperty(D, R);
    }, c = Ke.getSettings(), m = ((_ = c.glassSettings) == null ? void 0 : _.enabled) ?? !0 ? ((A = c.glassSettings) == null ? void 0 : A.opacity) ?? 1 : 1, p = !(r === "glass") && m < 1, v = Math.round((1 - m) * 100), x = [
      "background",
      "card",
      "popover",
      "sidebar",
      "secondary",
      "muted",
      "input",
      "border",
      "sidebarBorder"
    ];
    Object.entries(a.colors).forEach(([D, R]) => {
      let Z = `--${D.replace(/([A-Z])/g, "-$1").toLowerCase()}`;
      Z = Z.replace(/(\d+)/, "-$1");
      let K = R;
      if (p && x.includes(D)) {
        const de = D.toLowerCase().includes("border") ? Math.round(v * 0.1) : v;
        K = `color-mix(in srgb, ${R}, transparent ${de}%)`;
      }
      s(Z, K);
    }), Object.entries(a.variables).forEach(([D, R]) => {
      s(`--${D}`, R);
    }), r !== "paperLight" ? l.classList.add("dark") : l.classList.remove("dark");
    const w = Ke.getSettings().glassSettings;
    w && w.enabled ? (s("--glass-opacity", w.opacity.toString()), s("--glass-blur", `${w.blur}px`), w.blur > 0 ? s("--glass-backdrop-filter", `blur(${w.blur}px)`) : s("--glass-backdrop-filter", "none")) : (s("--glass-opacity", "1"), s("--glass-blur", "0px"), s("--glass-backdrop-filter", "none"));
  }
}
Xe(Di, "STORAGE_KEY", "engram-theme"), Xe(Di, "currentTheme", "claudeDark");
const Gc = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  ThemeManager: Di
}, Symbol.toStringTag, { value: "Module" })), W5 = Sb((t) => ({
  theme: Di.getTheme(),
  isDarkMode: Di.getTheme() !== "paperLight",
  setTheme: (r) => {
    Di.setTheme(r), t({
      theme: r,
      isDarkMode: r !== "paperLight"
    });
  }
}));
class zb {
  async search(r) {
    const a = r.toLowerCase().trim(), l = Jh.map((d) => ({
      id: `nav-${d.id}`,
      type: "navigation",
      // Explicitly cast to 'navigation' | 'action' | 'setting' | 'log'
      title: d.label,
      description: `Navigate to ${d.label}`,
      // Auto-generated description
      icon: d.icon,
      action: (m) => m(d.path),
      score: 10
    })).filter(
      (d) => d.title.toLowerCase().includes(a) || d.id.includes(a)
    ), s = V3.filter(
      (d) => {
        var m;
        return d.label.toLowerCase().includes(a) || ((m = d.description) == null ? void 0 : m.toLowerCase().includes(a)) || d.keywords.some((g) => g.toLowerCase().includes(a));
      }
    ).map((d) => ({
      id: d.id,
      type: "command",
      title: d.label,
      description: d.description,
      icon: d.icon,
      action: d.action,
      score: 9
    })), c = this.getThemeCommands().filter(
      (d) => {
        var m;
        return d.title.toLowerCase().includes(a) || ((m = d.keywords) == null ? void 0 : m.some((g) => g.toLowerCase().includes(a)));
      }
    );
    return [...l, ...s, ...c];
  }
  getThemeCommands() {
    const r = W5.getState().setTheme;
    return [
      {
        id: "theme-paper-light",
        type: "command",
        title: ": Paper Light (Twitter)",
        description: "",
        icon: O3,
        action: () => r("paperLight"),
        keywords: ["theme", "light", "white", "twitter", "paper", ""],
        score: 5
      },
      {
        id: "theme-twitter-dark",
        type: "command",
        title: ": Twitter Dark",
        description: "",
        icon: E1,
        action: () => r("twitterDark"),
        keywords: ["theme", "dark", "black", "twitter", "blue", ""],
        score: 5
      },
      {
        id: "theme-claude-dark",
        type: "command",
        title: ": Claude Dark",
        description: "",
        icon: E1,
        action: () => r("claudeDark"),
        keywords: ["theme", "dark", "claude", "paper", ""],
        score: 5
      },
      {
        id: "theme-catppuccin",
        type: "command",
        title: ": Catppuccin Mocha",
        description: "",
        icon: j1,
        action: () => r("catppuccin"),
        keywords: ["theme", "dark", "catppuccin", "mocha", ""],
        score: 5
      },
      {
        id: "theme-discord",
        type: "command",
        title: ": Discord Dark",
        description: " Discord ",
        icon: j1,
        action: () => r("discord"),
        keywords: ["theme", "dark", "discord", "game", ""],
        score: 5
      }
    ];
  }
}
class Z5 {
  async search(r) {
    const a = r.toLowerCase().trim();
    return this.getAllSettings().filter(
      (l) => {
        var s;
        return l.title.toLowerCase().includes(a) || ((s = l.keywords) == null ? void 0 : s.some((c) => c.toLowerCase().includes(a)));
      }
    );
  }
  getAllSettings() {
    return [
      // API Settings
      {
        id: "setting-api-key",
        type: "setting",
        title: " API Key",
        description: " LLM ",
        icon: cd,
        action: (r) => r("/api"),
        // Default to API page
        keywords: ["api", "key", "token", "credential"],
        score: 8
      },
      {
        id: "setting-model",
        type: "setting",
        title: " (Model)",
        description: " LLM ",
        icon: ud,
        action: (r) => r("/api"),
        keywords: ["model", "llm", "change", "switch"],
        score: 8
      },
      // Parameters
      {
        id: "setting-temperature",
        type: "setting",
        title: " (Temperature)",
        description: "",
        icon: _1,
        action: (r) => r("/api"),
        keywords: ["temp", "temperature", "random", "creativity"],
        score: 7
      },
      {
        id: "setting-top-p",
        type: "setting",
        title: " Top P",
        description: "",
        icon: _1,
        action: (r) => r("/api"),
        keywords: ["top", "p", "nucleus", "sampling"],
        score: 7
      },
      // Vector/RAG
      {
        id: "setting-vector",
        type: "setting",
        title: " (Vectorization)",
        description: "",
        icon: hu,
        action: (r) => r("/processing"),
        // processing:vectorization ideally
        keywords: ["vector", "embedding", "db", "store"],
        score: 7
      },
      {
        id: "setting-recall",
        type: "setting",
        title: " (Recall)",
        description: " RAG ",
        icon: r3,
        action: (r) => r("/processing"),
        // processing:recall
        keywords: ["recall", "rag", "retrieval", "search"],
        score: 7
      }
    ];
  }
}
class J5 {
  async search(r) {
    const a = r.toLowerCase().trim();
    return ["log", "debug", "error", "warn", "info", "dev"].some((s) => s.includes(a)) || a.includes("log") ? this.getLogActions() : [];
  }
  getLogActions() {
    return [
      {
        id: "log-view-all",
        type: "log",
        title: " (DevLog)",
        description: "",
        icon: pu,
        action: (r) => r("devlog"),
        score: 9
      },
      {
        id: "log-errors",
        type: "log",
        title: " (Errors)",
        description: "",
        icon: c4,
        action: (r) => r("devlog"),
        // In future: nav('/dev?filter=error')
        score: 8
      }
    ];
  }
}
function Fa() {
  var t, r;
  try {
    return ((r = (t = window.SillyTavern) == null ? void 0 : t.getContext) == null ? void 0 : r.call(t)) || null;
  } catch (a) {
    return console.warn("[Engram] Failed to get ST context:", a), null;
  }
}
function e6() {
  const t = Fa();
  return (t == null ? void 0 : t.chat) || [];
}
function t6() {
  return e6();
}
function Dn() {
  const t = Fa();
  return (t == null ? void 0 : t.chatId) || null;
}
function ou() {
  const t = Fa();
  return t ? {
    name: t.name2,
    id: t.characterId
  } : null;
}
function Fm() {
  try {
    return window.selected_model || void 0;
  } catch {
    return;
  }
}
function n6() {
  return Fa() !== null;
}
var Vc = { exports: {} }, r6 = Vc.exports, $1;
function a6() {
  return $1 || ($1 = 1, (function(t, r) {
    (function(a, l) {
      t.exports = l();
    })(r6, function() {
      var a = function(f, y) {
        return (a = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(S, k) {
          S.__proto__ = k;
        } || function(S, k) {
          for (var j in k) Object.prototype.hasOwnProperty.call(k, j) && (S[j] = k[j]);
        })(f, y);
      }, l = function() {
        return (l = Object.assign || function(f) {
          for (var y, S = 1, k = arguments.length; S < k; S++) for (var j in y = arguments[S]) Object.prototype.hasOwnProperty.call(y, j) && (f[j] = y[j]);
          return f;
        }).apply(this, arguments);
      };
      function s(f, y, S) {
        for (var k, j = 0, N = y.length; j < N; j++) !k && j in y || ((k = k || Array.prototype.slice.call(y, 0, j))[j] = y[j]);
        return f.concat(k || Array.prototype.slice.call(y));
      }
      var c = typeof globalThis < "u" ? globalThis : typeof self < "u" ? self : typeof window < "u" ? window : Av, d = Object.keys, m = Array.isArray;
      function g(f, y) {
        return typeof y != "object" || d(y).forEach(function(S) {
          f[S] = y[S];
        }), f;
      }
      typeof Promise > "u" || c.Promise || (c.Promise = Promise);
      var p = Object.getPrototypeOf, v = {}.hasOwnProperty;
      function x(f, y) {
        return v.call(f, y);
      }
      function E(f, y) {
        typeof y == "function" && (y = y(p(f))), (typeof Reflect > "u" ? d : Reflect.ownKeys)(y).forEach(function(S) {
          _(f, S, y[S]);
        });
      }
      var w = Object.defineProperty;
      function _(f, y, S, k) {
        w(f, y, g(S && x(S, "get") && typeof S.get == "function" ? { get: S.get, set: S.set, configurable: !0 } : { value: S, configurable: !0, writable: !0 }, k));
      }
      function A(f) {
        return { from: function(y) {
          return f.prototype = Object.create(y.prototype), _(f.prototype, "constructor", f), { extend: E.bind(null, f.prototype) };
        } };
      }
      var D = Object.getOwnPropertyDescriptor, R = [].slice;
      function Z(f, y, S) {
        return R.call(f, y, S);
      }
      function K(f, y) {
        return y(f);
      }
      function ge(f) {
        if (!f) throw new Error("Assertion Failed");
      }
      function de(f) {
        c.setImmediate ? setImmediate(f) : setTimeout(f, 0);
      }
      function I(f, y) {
        if (typeof y == "string" && x(f, y)) return f[y];
        if (!y) return f;
        if (typeof y != "string") {
          for (var S = [], k = 0, j = y.length; k < j; ++k) {
            var N = I(f, y[k]);
            S.push(N);
          }
          return S;
        }
        var z = y.indexOf(".");
        if (z !== -1) {
          var B = f[y.substr(0, z)];
          return B == null ? void 0 : I(B, y.substr(z + 1));
        }
      }
      function V(f, y, S) {
        if (f && y !== void 0 && !("isFrozen" in Object && Object.isFrozen(f))) if (typeof y != "string" && "length" in y) {
          ge(typeof S != "string" && "length" in S);
          for (var k = 0, j = y.length; k < j; ++k) V(f, y[k], S[k]);
        } else {
          var N, z, B = y.indexOf(".");
          B !== -1 ? (N = y.substr(0, B), (z = y.substr(B + 1)) === "" ? S === void 0 ? m(f) && !isNaN(parseInt(N)) ? f.splice(N, 1) : delete f[N] : f[N] = S : V(B = !(B = f[N]) || !x(f, N) ? f[N] = {} : B, z, S)) : S === void 0 ? m(f) && !isNaN(parseInt(y)) ? f.splice(y, 1) : delete f[y] : f[y] = S;
        }
      }
      function we(f) {
        var y, S = {};
        for (y in f) x(f, y) && (S[y] = f[y]);
        return S;
      }
      var Te = [].concat;
      function X(f) {
        return Te.apply([], f);
      }
      var ve = "BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(X([8, 16, 32, 64].map(function(f) {
        return ["Int", "Uint", "Float"].map(function(y) {
          return y + f + "Array";
        });
      }))).filter(function(f) {
        return c[f];
      }), oe = new Set(ve.map(function(f) {
        return c[f];
      })), se = null;
      function Re(f) {
        return se = /* @__PURE__ */ new WeakMap(), f = (function y(S) {
          if (!S || typeof S != "object") return S;
          var k = se.get(S);
          if (k) return k;
          if (m(S)) {
            k = [], se.set(S, k);
            for (var j = 0, N = S.length; j < N; ++j) k.push(y(S[j]));
          } else if (oe.has(S.constructor)) k = S;
          else {
            var z, B = p(S);
            for (z in k = B === Object.prototype ? {} : Object.create(B), se.set(S, k), S) x(S, z) && (k[z] = y(S[z]));
          }
          return k;
        })(f), se = null, f;
      }
      var be = {}.toString;
      function je(f) {
        return be.call(f).slice(8, -1);
      }
      var re = typeof Symbol < "u" ? Symbol.iterator : "@@iterator", _e = typeof re == "symbol" ? function(f) {
        var y;
        return f != null && (y = f[re]) && y.apply(f);
      } : function() {
        return null;
      };
      function fe(f, y) {
        return y = f.indexOf(y), 0 <= y && f.splice(y, 1), 0 <= y;
      }
      var Ue = {};
      function O(f) {
        var y, S, k, j;
        if (arguments.length === 1) {
          if (m(f)) return f.slice();
          if (this === Ue && typeof f == "string") return [f];
          if (j = _e(f)) {
            for (S = []; !(k = j.next()).done; ) S.push(k.value);
            return S;
          }
          if (f == null) return [f];
          if (typeof (y = f.length) != "number") return [f];
          for (S = new Array(y); y--; ) S[y] = f[y];
          return S;
        }
        for (y = arguments.length, S = new Array(y); y--; ) S[y] = arguments[y];
        return S;
      }
      var L = typeof Symbol < "u" ? function(f) {
        return f[Symbol.toStringTag] === "AsyncFunction";
      } : function() {
        return !1;
      }, ma = ["Unknown", "Constraint", "Data", "TransactionInactive", "ReadOnly", "Version", "NotFound", "InvalidState", "InvalidAccess", "Abort", "Timeout", "QuotaExceeded", "Syntax", "DataClone"], Pn = ["Modify", "Bulk", "OpenFailed", "VersionChange", "Schema", "Upgrade", "InvalidTable", "MissingAPI", "NoSuchDatabase", "InvalidArgument", "SubTransaction", "Unsupported", "Internal", "DatabaseClosed", "PrematureCommit", "ForeignAwait"].concat(ma), he = { VersionChanged: "Database version changed by other database connection", DatabaseClosed: "Database has been closed", Abort: "Transaction aborted", TransactionInactive: "Transaction has already completed or failed", MissingAPI: "IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb" };
      function M(f, y) {
        this.name = f, this.message = y;
      }
      function Ie(f, y) {
        return f + ". Errors: " + Object.keys(y).map(function(S) {
          return y[S].toString();
        }).filter(function(S, k, j) {
          return j.indexOf(S) === k;
        }).join(`
`);
      }
      function Ye(f, y, S, k) {
        this.failures = y, this.failedKeys = k, this.successCount = S, this.message = Ie(f, y);
      }
      function ye(f, y) {
        this.name = "BulkError", this.failures = Object.keys(y).map(function(S) {
          return y[S];
        }), this.failuresByPos = y, this.message = Ie(f, this.failures);
      }
      A(M).from(Error).extend({ toString: function() {
        return this.name + ": " + this.message;
      } }), A(Ye).from(M), A(ye).from(M);
      var me = Pn.reduce(function(f, y) {
        return f[y] = y + "Error", f;
      }, {}), Ge = M, Ne = Pn.reduce(function(f, y) {
        var S = y + "Error";
        function k(j, N) {
          this.name = S, j ? typeof j == "string" ? (this.message = "".concat(j).concat(N ? `
 ` + N : ""), this.inner = N || null) : typeof j == "object" && (this.message = "".concat(j.name, " ").concat(j.message), this.inner = j) : (this.message = he[y] || S, this.inner = null);
        }
        return A(k).from(Ge), f[y] = k, f;
      }, {});
      Ne.Syntax = SyntaxError, Ne.Type = TypeError, Ne.Range = RangeError;
      var Rt = ma.reduce(function(f, y) {
        return f[y + "Error"] = Ne[y], f;
      }, {}), tn = Pn.reduce(function(f, y) {
        return ["Syntax", "Type", "Range"].indexOf(y) === -1 && (f[y + "Error"] = Ne[y]), f;
      }, {});
      function mt() {
      }
      function qr(f) {
        return f;
      }
      function Mr(f, y) {
        return f == null || f === qr ? y : function(S) {
          return y(f(S));
        };
      }
      function Fn(f, y) {
        return function() {
          f.apply(this, arguments), y.apply(this, arguments);
        };
      }
      function Ga(f, y) {
        return f === mt ? y : function() {
          var S = f.apply(this, arguments);
          S !== void 0 && (arguments[0] = S);
          var k = this.onsuccess, j = this.onerror;
          this.onsuccess = null, this.onerror = null;
          var N = y.apply(this, arguments);
          return k && (this.onsuccess = this.onsuccess ? Fn(k, this.onsuccess) : k), j && (this.onerror = this.onerror ? Fn(j, this.onerror) : j), N !== void 0 ? N : S;
        };
      }
      function Ml(f, y) {
        return f === mt ? y : function() {
          f.apply(this, arguments);
          var S = this.onsuccess, k = this.onerror;
          this.onsuccess = this.onerror = null, y.apply(this, arguments), S && (this.onsuccess = this.onsuccess ? Fn(S, this.onsuccess) : S), k && (this.onerror = this.onerror ? Fn(k, this.onerror) : k);
        };
      }
      function zl(f, y) {
        return f === mt ? y : function(S) {
          var k = f.apply(this, arguments);
          g(S, k);
          var j = this.onsuccess, N = this.onerror;
          return this.onsuccess = null, this.onerror = null, S = y.apply(this, arguments), j && (this.onsuccess = this.onsuccess ? Fn(j, this.onsuccess) : j), N && (this.onerror = this.onerror ? Fn(N, this.onerror) : N), k === void 0 ? S === void 0 ? void 0 : S : g(k, S);
        };
      }
      function Va(f, y) {
        return f === mt ? y : function() {
          return y.apply(this, arguments) !== !1 && f.apply(this, arguments);
        };
      }
      function Hr(f, y) {
        return f === mt ? y : function() {
          var S = f.apply(this, arguments);
          if (S && typeof S.then == "function") {
            for (var k = this, j = arguments.length, N = new Array(j); j--; ) N[j] = arguments[j];
            return S.then(function() {
              return y.apply(k, N);
            });
          }
          return y.apply(this, arguments);
        };
      }
      tn.ModifyError = Ye, tn.DexieError = M, tn.BulkError = ye;
      var Tn = typeof location < "u" && /^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);
      function Rl(f) {
        Tn = f;
      }
      var ha = {}, mn = 100, ve = typeof Promise > "u" ? [] : (function() {
        var f = Promise.resolve();
        if (typeof crypto > "u" || !crypto.subtle) return [f, p(f), f];
        var y = crypto.subtle.digest("SHA-512", new Uint8Array([0]));
        return [y, p(y), f];
      })(), ma = ve[0], Pn = ve[1], ve = ve[2], Pn = Pn && Pn.then, Oe = ma && ma.constructor, Je = !!ve, it = function(f, y) {
        $n.push([f, y]), pn && (queueMicrotask(Su), pn = !1);
      }, xt = !0, pn = !0, Sn = [], nn = [], Vt = qr, Kt = { id: "global", global: !0, ref: 0, unhandleds: [], onunhandled: mt, pgp: !1, env: {}, finalize: mt }, Be = Kt, $n = [], fn = 0, Ol = [];
      function He(f) {
        if (typeof this != "object") throw new TypeError("Promises must be constructed via new");
        this._listeners = [], this._lib = !1;
        var y = this._PSD = Be;
        if (typeof f != "function") {
          if (f !== ha) throw new TypeError("Not a function");
          return this._state = arguments[1], this._value = arguments[2], void (this._state === !1 && zr(this, this._value));
        }
        this._state = null, this._value = null, ++y.ref, (function S(k, j) {
          try {
            j(function(N) {
              if (k._state === null) {
                if (N === k) throw new TypeError("A promise cannot be resolved with itself.");
                var z = k._lib && Fr();
                N && typeof N.then == "function" ? S(k, function(B, H) {
                  N instanceof He ? N._then(B, H) : N.then(B, H);
                }) : (k._state = !0, k._value = N, Pi(k)), z && gr();
              }
            }, zr.bind(null, k));
          } catch (N) {
            zr(k, N);
          }
        })(this, f);
      }
      var Ka = { get: function() {
        var f = Be, y = Fi;
        function S(k, j) {
          var N = this, z = !f.global && (f !== Be || y !== Fi), B = z && !In(), H = new He(function(F, J) {
            pa(N, new Ui(Dl(k, f, z, B), Dl(j, f, z, B), F, J, f));
          });
          return this._consoleTask && (H._consoleTask = this._consoleTask), H;
        }
        return S.prototype = ha, S;
      }, set: function(f) {
        _(this, "then", f && f.prototype === ha ? Ka : { get: function() {
          return f;
        }, set: Ka.set });
      } };
      function Ui(f, y, S, k, j) {
        this.onFulfilled = typeof f == "function" ? f : null, this.onRejected = typeof y == "function" ? y : null, this.resolve = S, this.reject = k, this.psd = j;
      }
      function zr(f, y) {
        var S, k;
        nn.push(y), f._state === null && (S = f._lib && Fr(), y = Vt(y), f._state = !1, f._value = y, k = f, Sn.some(function(j) {
          return j._value === k._value;
        }) || Sn.push(k), Pi(f), S && gr());
      }
      function Pi(f) {
        var y = f._listeners;
        f._listeners = [];
        for (var S = 0, k = y.length; S < k; ++S) pa(f, y[S]);
        var j = f._PSD;
        --j.ref || j.finalize(), fn === 0 && (++fn, it(function() {
          --fn == 0 && Ho();
        }, []));
      }
      function pa(f, y) {
        if (f._state !== null) {
          var S = f._state ? y.onFulfilled : y.onRejected;
          if (S === null) return (f._state ? y.resolve : y.reject)(f._value);
          ++y.psd.ref, ++fn, it(vd, [S, f, y]);
        } else f._listeners.push(y);
      }
      function vd(f, y, S) {
        try {
          var k, j = y._value;
          !y._state && nn.length && (nn = []), k = Tn && y._consoleTask ? y._consoleTask.run(function() {
            return f(j);
          }) : f(j), y._state || nn.indexOf(j) !== -1 || (function(N) {
            for (var z = Sn.length; z; ) if (Sn[--z]._value === N._value) return Sn.splice(z, 1);
          })(y), S.resolve(k);
        } catch (N) {
          S.reject(N);
        } finally {
          --fn == 0 && Ho(), --S.psd.ref || S.psd.finalize();
        }
      }
      function Su() {
        rr(Kt, function() {
          Fr() && gr();
        });
      }
      function Fr() {
        var f = xt;
        return pn = xt = !1, f;
      }
      function gr() {
        var f, y, S;
        do
          for (; 0 < $n.length; ) for (f = $n, $n = [], S = f.length, y = 0; y < S; ++y) {
            var k = f[y];
            k[0].apply(null, k[1]);
          }
        while (0 < $n.length);
        pn = xt = !0;
      }
      function Ho() {
        var f = Sn;
        Sn = [], f.forEach(function(k) {
          k._PSD.onunhandled.call(null, k._value, k);
        });
        for (var y = Ol.slice(0), S = y.length; S; ) y[--S]();
      }
      function qi(f) {
        return new He(ha, !1, f);
      }
      function Ot(f, y) {
        var S = Be;
        return function() {
          var k = Fr(), j = Be;
          try {
            return Gr(S, !0), f.apply(this, arguments);
          } catch (N) {
            y && y(N);
          } finally {
            Gr(j, !1), k && gr();
          }
        };
      }
      E(He.prototype, { then: Ka, _then: function(f, y) {
        pa(this, new Ui(null, null, f, y, Be));
      }, catch: function(f) {
        if (arguments.length === 1) return this.then(null, f);
        var y = f, S = arguments[1];
        return typeof y == "function" ? this.then(null, function(k) {
          return (k instanceof y ? S : qi)(k);
        }) : this.then(null, function(k) {
          return (k && k.name === y ? S : qi)(k);
        });
      }, finally: function(f) {
        return this.then(function(y) {
          return He.resolve(f()).then(function() {
            return y;
          });
        }, function(y) {
          return He.resolve(f()).then(function() {
            return qi(y);
          });
        });
      }, timeout: function(f, y) {
        var S = this;
        return f < 1 / 0 ? new He(function(k, j) {
          var N = setTimeout(function() {
            return j(new Ne.Timeout(y));
          }, f);
          S.then(k, j).finally(clearTimeout.bind(null, N));
        }) : this;
      } }), typeof Symbol < "u" && Symbol.toStringTag && _(He.prototype, Symbol.toStringTag, "Dexie.Promise"), Kt.env = $o(), E(He, { all: function() {
        var f = O.apply(null, arguments).map(Qa);
        return new He(function(y, S) {
          f.length === 0 && y([]);
          var k = f.length;
          f.forEach(function(j, N) {
            return He.resolve(j).then(function(z) {
              f[N] = z, --k || y(f);
            }, S);
          });
        });
      }, resolve: function(f) {
        return f instanceof He ? f : f && typeof f.then == "function" ? new He(function(y, S) {
          f.then(y, S);
        }) : new He(ha, !0, f);
      }, reject: qi, race: function() {
        var f = O.apply(null, arguments).map(Qa);
        return new He(function(y, S) {
          f.map(function(k) {
            return He.resolve(k).then(y, S);
          });
        });
      }, PSD: { get: function() {
        return Be;
      }, set: function(f) {
        return Be = f;
      } }, totalEchoes: { get: function() {
        return Fi;
      } }, newPSD: Bt, usePSD: rr, scheduler: { get: function() {
        return it;
      }, set: function(f) {
        it = f;
      } }, rejectionMapper: { get: function() {
        return Vt;
      }, set: function(f) {
        Vt = f;
      } }, follow: function(f, y) {
        return new He(function(S, k) {
          return Bt(function(j, N) {
            var z = Be;
            z.unhandleds = [], z.onunhandled = N, z.finalize = Fn(function() {
              var B, H = this;
              B = function() {
                H.unhandleds.length === 0 ? j() : N(H.unhandleds[0]);
              }, Ol.push(function F() {
                B(), Ol.splice(Ol.indexOf(F), 1);
              }), ++fn, it(function() {
                --fn == 0 && Ho();
              }, []);
            }, z.finalize), f();
          }, y, S, k);
        });
      } }), Oe && (Oe.allSettled && _(He, "allSettled", function() {
        var f = O.apply(null, arguments).map(Qa);
        return new He(function(y) {
          f.length === 0 && y([]);
          var S = f.length, k = new Array(S);
          f.forEach(function(j, N) {
            return He.resolve(j).then(function(z) {
              return k[N] = { status: "fulfilled", value: z };
            }, function(z) {
              return k[N] = { status: "rejected", reason: z };
            }).then(function() {
              return --S || y(k);
            });
          });
        });
      }), Oe.any && typeof AggregateError < "u" && _(He, "any", function() {
        var f = O.apply(null, arguments).map(Qa);
        return new He(function(y, S) {
          f.length === 0 && S(new AggregateError([]));
          var k = f.length, j = new Array(k);
          f.forEach(function(N, z) {
            return He.resolve(N).then(function(B) {
              return y(B);
            }, function(B) {
              j[z] = B, --k || S(new AggregateError(j));
            });
          });
        });
      }), Oe.withResolvers && (He.withResolvers = Oe.withResolvers));
      var Xt = { awaits: 0, echoes: 0, id: 0 }, Fo = 0, Ya = [], Hi = 0, Fi = 0, $r = 0;
      function Bt(f, y, S, k) {
        var j = Be, N = Object.create(j);
        return N.parent = j, N.ref = 0, N.global = !1, N.id = ++$r, Kt.env, N.env = Je ? { Promise: He, PromiseProp: { value: He, configurable: !0, writable: !0 }, all: He.all, race: He.race, allSettled: He.allSettled, any: He.any, resolve: He.resolve, reject: He.reject } : {}, y && g(N, y), ++j.ref, N.finalize = function() {
          --this.parent.ref || this.parent.finalize();
        }, k = rr(N, f, S, k), N.ref === 0 && N.finalize(), k;
      }
      function Wt() {
        return Xt.id || (Xt.id = ++Fo), ++Xt.awaits, Xt.echoes += mn, Xt.id;
      }
      function In() {
        return !!Xt.awaits && (--Xt.awaits == 0 && (Xt.id = 0), Xt.echoes = Xt.awaits * mn, !0);
      }
      function Qa(f) {
        return Xt.echoes && f && f.constructor === Oe ? (Wt(), f.then(function(y) {
          return In(), y;
        }, function(y) {
          return In(), Tt(y);
        })) : f;
      }
      function Sd() {
        var f = Ya[Ya.length - 1];
        Ya.pop(), Gr(f, !1);
      }
      function Gr(f, y) {
        var S, k = Be;
        (y ? !Xt.echoes || Hi++ && f === Be : !Hi || --Hi && f === Be) || queueMicrotask(y ? (function(j) {
          ++Fi, Xt.echoes && --Xt.echoes != 0 || (Xt.echoes = Xt.awaits = Xt.id = 0), Ya.push(Be), Gr(j, !0);
        }).bind(null, f) : Sd), f !== Be && (Be = f, k === Kt && (Kt.env = $o()), Je && (S = Kt.env.Promise, y = f.env, (k.global || f.global) && (Object.defineProperty(c, "Promise", y.PromiseProp), S.all = y.all, S.race = y.race, S.resolve = y.resolve, S.reject = y.reject, y.allSettled && (S.allSettled = y.allSettled), y.any && (S.any = y.any))));
      }
      function $o() {
        var f = c.Promise;
        return Je ? { Promise: f, PromiseProp: Object.getOwnPropertyDescriptor(c, "Promise"), all: f.all, race: f.race, allSettled: f.allSettled, any: f.any, resolve: f.resolve, reject: f.reject } : {};
      }
      function rr(f, y, S, k, j) {
        var N = Be;
        try {
          return Gr(f, !0), y(S, k, j);
        } finally {
          Gr(N, !1);
        }
      }
      function Dl(f, y, S, k) {
        return typeof f != "function" ? f : function() {
          var j = Be;
          S && Wt(), Gr(y, !0);
          try {
            return f.apply(this, arguments);
          } finally {
            Gr(j, !1), k && queueMicrotask(In);
          }
        };
      }
      function Vr(f) {
        Promise === Oe && Xt.echoes === 0 ? Hi === 0 ? f() : enqueueNativeMicroTask(f) : setTimeout(f, 0);
      }
      ("" + Pn).indexOf("[native code]") === -1 && (Wt = In = mt);
      var Tt = He.reject, ar = "", An = "Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.", Zt = "String expected.", ga = [], $i = "__dbnames", Rr = "readonly", Kr = "readwrite";
      function ya(f, y) {
        return f ? y ? function() {
          return f.apply(this, arguments) && y.apply(this, arguments);
        } : f : y;
      }
      var Go = { type: 3, lower: -1 / 0, lowerOpen: !1, upper: [[]], upperOpen: !1 };
      function Gi(f) {
        return typeof f != "string" || /\./.test(f) ? function(y) {
          return y;
        } : function(y) {
          return y[f] === void 0 && f in y && delete (y = Re(y))[f], y;
        };
      }
      function wu() {
        throw Ne.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.");
      }
      function ct(f, y) {
        try {
          var S = Vi(f), k = Vi(y);
          if (S !== k) return S === "Array" ? 1 : k === "Array" ? -1 : S === "binary" ? 1 : k === "binary" ? -1 : S === "string" ? 1 : k === "string" ? -1 : S === "Date" ? 1 : k !== "Date" ? NaN : -1;
          switch (S) {
            case "number":
            case "Date":
            case "string":
              return y < f ? 1 : f < y ? -1 : 0;
            case "binary":
              return (function(j, N) {
                for (var z = j.length, B = N.length, H = z < B ? z : B, F = 0; F < H; ++F) if (j[F] !== N[F]) return j[F] < N[F] ? -1 : 1;
                return z === B ? 0 : z < B ? -1 : 1;
              })(yr(f), yr(y));
            case "Array":
              return (function(j, N) {
                for (var z = j.length, B = N.length, H = z < B ? z : B, F = 0; F < H; ++F) {
                  var J = ct(j[F], N[F]);
                  if (J !== 0) return J;
                }
                return z === B ? 0 : z < B ? -1 : 1;
              })(f, y);
          }
        } catch {
        }
        return NaN;
      }
      function Vi(f) {
        var y = typeof f;
        return y != "object" ? y : ArrayBuffer.isView(f) ? "binary" : (f = je(f), f === "ArrayBuffer" ? "binary" : f);
      }
      function yr(f) {
        return f instanceof Uint8Array ? f : ArrayBuffer.isView(f) ? new Uint8Array(f.buffer, f.byteOffset, f.byteLength) : new Uint8Array(f);
      }
      function wn(f, y, S) {
        var k = f.schema.yProps;
        return k ? (y && 0 < S.numFailures && (y = y.filter(function(j, N) {
          return !S.failures[N];
        })), Promise.all(k.map(function(j) {
          return j = j.updatesTable, y ? f.db.table(j).where("k").anyOf(y).delete() : f.db.table(j).clear();
        })).then(function() {
          return S;
        })) : S;
      }
      var Xa = (ku.prototype.execute = function(f) {
        var y = this["@@propmod"];
        if (y.add !== void 0) {
          var S = y.add;
          if (m(S)) return s(s([], m(f) ? f : [], !0), S).sort();
          if (typeof S == "number") return (Number(f) || 0) + S;
          if (typeof S == "bigint") try {
            return BigInt(f) + S;
          } catch {
            return BigInt(0) + S;
          }
          throw new TypeError("Invalid term ".concat(S));
        }
        if (y.remove !== void 0) {
          var k = y.remove;
          if (m(k)) return m(f) ? f.filter(function(j) {
            return !k.includes(j);
          }).sort() : [];
          if (typeof k == "number") return Number(f) - k;
          if (typeof k == "bigint") try {
            return BigInt(f) - k;
          } catch {
            return BigInt(0) - k;
          }
          throw new TypeError("Invalid subtrahend ".concat(k));
        }
        return S = (S = y.replacePrefix) === null || S === void 0 ? void 0 : S[0], S && typeof f == "string" && f.startsWith(S) ? y.replacePrefix[1] + f.substring(S.length) : f;
      }, ku);
      function ku(f) {
        this["@@propmod"] = f;
      }
      function Ll(f, y) {
        for (var S = d(y), k = S.length, j = !1, N = 0; N < k; ++N) {
          var z = S[N], B = y[z], H = I(f, z);
          B instanceof Xa ? (V(f, z, B.execute(H)), j = !0) : H !== B && (V(f, z, B), j = !0);
        }
        return j;
      }
      var Vo = (Et.prototype._trans = function(f, y, S) {
        var k = this._tx || Be.trans, j = this.name, N = Tn && typeof console < "u" && console.createTask && console.createTask("Dexie: ".concat(f === "readonly" ? "read" : "write", " ").concat(this.name));
        function z(F, J, q) {
          if (!q.schema[j]) throw new Ne.NotFound("Table " + j + " not part of transaction");
          return y(q.idbtrans, q);
        }
        var B = Fr();
        try {
          var H = k && k.db._novip === this.db._novip ? k === Be.trans ? k._promise(f, z, S) : Bt(function() {
            return k._promise(f, z, S);
          }, { trans: k, transless: Be.transless || Be }) : (function F(J, q, te, $) {
            if (J.idbdb && (J._state.openComplete || Be.letThrough || J._vip)) {
              var Y = J._createTransaction(q, te, J._dbSchema);
              try {
                Y.create(), J._state.PR1398_maxLoop = 3;
              } catch (Q) {
                return Q.name === me.InvalidState && J.isOpen() && 0 < --J._state.PR1398_maxLoop ? (console.warn("Dexie: Need to reopen db"), J.close({ disableAutoOpen: !1 }), J.open().then(function() {
                  return F(J, q, te, $);
                })) : Tt(Q);
              }
              return Y._promise(q, function(Q, ee) {
                return Bt(function() {
                  return Be.trans = Y, $(Q, ee, Y);
                });
              }).then(function(Q) {
                if (q === "readwrite") try {
                  Y.idbtrans.commit();
                } catch {
                }
                return q === "readonly" ? Q : Y._completion.then(function() {
                  return Q;
                });
              });
            }
            if (J._state.openComplete) return Tt(new Ne.DatabaseClosed(J._state.dbOpenError));
            if (!J._state.isBeingOpened) {
              if (!J._state.autoOpen) return Tt(new Ne.DatabaseClosed());
              J.open().catch(mt);
            }
            return J._state.dbReadyPromise.then(function() {
              return F(J, q, te, $);
            });
          })(this.db, f, [this.name], z);
          return N && (H._consoleTask = N, H = H.catch(function(F) {
            return console.trace(F), Tt(F);
          })), H;
        } finally {
          B && gr();
        }
      }, Et.prototype.get = function(f, y) {
        var S = this;
        return f && f.constructor === Object ? this.where(f).first(y) : f == null ? Tt(new Ne.Type("Invalid argument to Table.get()")) : this._trans("readonly", function(k) {
          return S.core.get({ trans: k, key: f }).then(function(j) {
            return S.hook.reading.fire(j);
          });
        }).then(y);
      }, Et.prototype.where = function(f) {
        if (typeof f == "string") return new this.db.WhereClause(this, f);
        if (m(f)) return new this.db.WhereClause(this, "[".concat(f.join("+"), "]"));
        var y = d(f);
        if (y.length === 1) return this.where(y[0]).equals(f[y[0]]);
        var S = this.schema.indexes.concat(this.schema.primKey).filter(function(B) {
          if (B.compound && y.every(function(F) {
            return 0 <= B.keyPath.indexOf(F);
          })) {
            for (var H = 0; H < y.length; ++H) if (y.indexOf(B.keyPath[H]) === -1) return !1;
            return !0;
          }
          return !1;
        }).sort(function(B, H) {
          return B.keyPath.length - H.keyPath.length;
        })[0];
        if (S && this.db._maxKey !== ar) {
          var N = S.keyPath.slice(0, y.length);
          return this.where(N).equals(N.map(function(H) {
            return f[H];
          }));
        }
        !S && Tn && console.warn("The query ".concat(JSON.stringify(f), " on ").concat(this.name, " would benefit from a ") + "compound index [".concat(y.join("+"), "]"));
        var k = this.schema.idxByName;
        function j(B, H) {
          return ct(B, H) === 0;
        }
        var z = y.reduce(function(q, H) {
          var F = q[0], J = q[1], q = k[H], te = f[H];
          return [F || q, F || !q ? ya(J, q && q.multi ? function($) {
            return $ = I($, H), m($) && $.some(function(Y) {
              return j(te, Y);
            });
          } : function($) {
            return j(te, I($, H));
          }) : J];
        }, [null, null]), N = z[0], z = z[1];
        return N ? this.where(N.name).equals(f[N.keyPath]).filter(z) : S ? this.filter(z) : this.where(y).equals("");
      }, Et.prototype.filter = function(f) {
        return this.toCollection().and(f);
      }, Et.prototype.count = function(f) {
        return this.toCollection().count(f);
      }, Et.prototype.offset = function(f) {
        return this.toCollection().offset(f);
      }, Et.prototype.limit = function(f) {
        return this.toCollection().limit(f);
      }, Et.prototype.each = function(f) {
        return this.toCollection().each(f);
      }, Et.prototype.toArray = function(f) {
        return this.toCollection().toArray(f);
      }, Et.prototype.toCollection = function() {
        return new this.db.Collection(new this.db.WhereClause(this));
      }, Et.prototype.orderBy = function(f) {
        return new this.db.Collection(new this.db.WhereClause(this, m(f) ? "[".concat(f.join("+"), "]") : f));
      }, Et.prototype.reverse = function() {
        return this.toCollection().reverse();
      }, Et.prototype.mapToClass = function(f) {
        var y, S = this.db, k = this.name;
        function j() {
          return y !== null && y.apply(this, arguments) || this;
        }
        (this.schema.mappedClass = f).prototype instanceof wu && ((function(H, F) {
          if (typeof F != "function" && F !== null) throw new TypeError("Class extends value " + String(F) + " is not a constructor or null");
          function J() {
            this.constructor = H;
          }
          a(H, F), H.prototype = F === null ? Object.create(F) : (J.prototype = F.prototype, new J());
        })(j, y = f), Object.defineProperty(j.prototype, "db", { get: function() {
          return S;
        }, enumerable: !1, configurable: !0 }), j.prototype.table = function() {
          return k;
        }, f = j);
        for (var N = /* @__PURE__ */ new Set(), z = f.prototype; z; z = p(z)) Object.getOwnPropertyNames(z).forEach(function(H) {
          return N.add(H);
        });
        function B(H) {
          if (!H) return H;
          var F, J = Object.create(f.prototype);
          for (F in H) if (!N.has(F)) try {
            J[F] = H[F];
          } catch {
          }
          return J;
        }
        return this.schema.readHook && this.hook.reading.unsubscribe(this.schema.readHook), this.schema.readHook = B, this.hook("reading", B), f;
      }, Et.prototype.defineClass = function() {
        return this.mapToClass(function(f) {
          g(this, f);
        });
      }, Et.prototype.add = function(f, y) {
        var S = this, k = this.schema.primKey, j = k.auto, N = k.keyPath, z = f;
        return N && j && (z = Gi(N)(f)), this._trans("readwrite", function(B) {
          return S.core.mutate({ trans: B, type: "add", keys: y != null ? [y] : null, values: [z] });
        }).then(function(B) {
          return B.numFailures ? He.reject(B.failures[0]) : B.lastResult;
        }).then(function(B) {
          if (N) try {
            V(f, N, B);
          } catch {
          }
          return B;
        });
      }, Et.prototype.upsert = function(f, y) {
        var S = this, k = this.schema.primKey.keyPath;
        return this._trans("readwrite", function(j) {
          return S.core.get({ trans: j, key: f }).then(function(N) {
            var z = N ?? {};
            return Ll(z, y), k && V(z, k, f), S.core.mutate({ trans: j, type: "put", values: [z], keys: [f], upsert: !0, updates: { keys: [f], changeSpecs: [y] } }).then(function(B) {
              return B.numFailures ? He.reject(B.failures[0]) : !!N;
            });
          });
        });
      }, Et.prototype.update = function(f, y) {
        return typeof f != "object" || m(f) ? this.where(":id").equals(f).modify(y) : (f = I(f, this.schema.primKey.keyPath), f === void 0 ? Tt(new Ne.InvalidArgument("Given object does not contain its primary key")) : this.where(":id").equals(f).modify(y));
      }, Et.prototype.put = function(f, y) {
        var S = this, k = this.schema.primKey, j = k.auto, N = k.keyPath, z = f;
        return N && j && (z = Gi(N)(f)), this._trans("readwrite", function(B) {
          return S.core.mutate({ trans: B, type: "put", values: [z], keys: y != null ? [y] : null });
        }).then(function(B) {
          return B.numFailures ? He.reject(B.failures[0]) : B.lastResult;
        }).then(function(B) {
          if (N) try {
            V(f, N, B);
          } catch {
          }
          return B;
        });
      }, Et.prototype.delete = function(f) {
        var y = this;
        return this._trans("readwrite", function(S) {
          return y.core.mutate({ trans: S, type: "delete", keys: [f] }).then(function(k) {
            return wn(y, [f], k);
          }).then(function(k) {
            return k.numFailures ? He.reject(k.failures[0]) : void 0;
          });
        });
      }, Et.prototype.clear = function() {
        var f = this;
        return this._trans("readwrite", function(y) {
          return f.core.mutate({ trans: y, type: "deleteRange", range: Go }).then(function(S) {
            return wn(f, null, S);
          });
        }).then(function(y) {
          return y.numFailures ? He.reject(y.failures[0]) : void 0;
        });
      }, Et.prototype.bulkGet = function(f) {
        var y = this;
        return this._trans("readonly", function(S) {
          return y.core.getMany({ keys: f, trans: S }).then(function(k) {
            return k.map(function(j) {
              return y.hook.reading.fire(j);
            });
          });
        });
      }, Et.prototype.bulkAdd = function(f, y, S) {
        var k = this, j = Array.isArray(y) ? y : void 0, N = (S = S || (j ? void 0 : y)) ? S.allKeys : void 0;
        return this._trans("readwrite", function(z) {
          var F = k.schema.primKey, B = F.auto, F = F.keyPath;
          if (F && j) throw new Ne.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");
          if (j && j.length !== f.length) throw new Ne.InvalidArgument("Arguments objects and keys must have the same length");
          var H = f.length, F = F && B ? f.map(Gi(F)) : f;
          return k.core.mutate({ trans: z, type: "add", keys: j, values: F, wantResults: N }).then(function(Y) {
            var q = Y.numFailures, te = Y.results, $ = Y.lastResult, Y = Y.failures;
            if (q === 0) return N ? te : $;
            throw new ye("".concat(k.name, ".bulkAdd(): ").concat(q, " of ").concat(H, " operations failed"), Y);
          });
        });
      }, Et.prototype.bulkPut = function(f, y, S) {
        var k = this, j = Array.isArray(y) ? y : void 0, N = (S = S || (j ? void 0 : y)) ? S.allKeys : void 0;
        return this._trans("readwrite", function(z) {
          var F = k.schema.primKey, B = F.auto, F = F.keyPath;
          if (F && j) throw new Ne.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");
          if (j && j.length !== f.length) throw new Ne.InvalidArgument("Arguments objects and keys must have the same length");
          var H = f.length, F = F && B ? f.map(Gi(F)) : f;
          return k.core.mutate({ trans: z, type: "put", keys: j, values: F, wantResults: N }).then(function(Y) {
            var q = Y.numFailures, te = Y.results, $ = Y.lastResult, Y = Y.failures;
            if (q === 0) return N ? te : $;
            throw new ye("".concat(k.name, ".bulkPut(): ").concat(q, " of ").concat(H, " operations failed"), Y);
          });
        });
      }, Et.prototype.bulkUpdate = function(f) {
        var y = this, S = this.core, k = f.map(function(z) {
          return z.key;
        }), j = f.map(function(z) {
          return z.changes;
        }), N = [];
        return this._trans("readwrite", function(z) {
          return S.getMany({ trans: z, keys: k, cache: "clone" }).then(function(B) {
            var H = [], F = [];
            f.forEach(function(q, te) {
              var $ = q.key, Y = q.changes, Q = B[te];
              if (Q) {
                for (var ee = 0, ae = Object.keys(Y); ee < ae.length; ee++) {
                  var ue = ae[ee], xe = Y[ue];
                  if (ue === y.schema.primKey.keyPath) {
                    if (ct(xe, $) !== 0) throw new Ne.Constraint("Cannot update primary key in bulkUpdate()");
                  } else V(Q, ue, xe);
                }
                N.push(te), H.push($), F.push(Q);
              }
            });
            var J = H.length;
            return S.mutate({ trans: z, type: "put", keys: H, values: F, updates: { keys: k, changeSpecs: j } }).then(function(q) {
              var te = q.numFailures, $ = q.failures;
              if (te === 0) return J;
              for (var Y = 0, Q = Object.keys($); Y < Q.length; Y++) {
                var ee, ae = Q[Y], ue = N[Number(ae)];
                ue != null && (ee = $[ae], delete $[ae], $[ue] = ee);
              }
              throw new ye("".concat(y.name, ".bulkUpdate(): ").concat(te, " of ").concat(J, " operations failed"), $);
            });
          });
        });
      }, Et.prototype.bulkDelete = function(f) {
        var y = this, S = f.length;
        return this._trans("readwrite", function(k) {
          return y.core.mutate({ trans: k, type: "delete", keys: f }).then(function(j) {
            return wn(y, f, j);
          });
        }).then(function(z) {
          var j = z.numFailures, N = z.lastResult, z = z.failures;
          if (j === 0) return N;
          throw new ye("".concat(y.name, ".bulkDelete(): ").concat(j, " of ").concat(S, " operations failed"), z);
        });
      }, Et);
      function Et() {
      }
      function Ki(f) {
        function y(z, B) {
          if (B) {
            for (var H = arguments.length, F = new Array(H - 1); --H; ) F[H - 1] = arguments[H];
            return S[z].subscribe.apply(null, F), f;
          }
          if (typeof z == "string") return S[z];
        }
        var S = {};
        y.addEventType = N;
        for (var k = 1, j = arguments.length; k < j; ++k) N(arguments[k]);
        return y;
        function N(z, B, H) {
          if (typeof z != "object") {
            var F;
            B = B || Va;
            var J = { subscribers: [], fire: H = H || mt, subscribe: function(q) {
              J.subscribers.indexOf(q) === -1 && (J.subscribers.push(q), J.fire = B(J.fire, q));
            }, unsubscribe: function(q) {
              J.subscribers = J.subscribers.filter(function(te) {
                return te !== q;
              }), J.fire = J.subscribers.reduce(B, H);
            } };
            return S[z] = y[z] = J;
          }
          d(F = z).forEach(function(q) {
            var te = F[q];
            if (m(te)) N(q, F[q][0], F[q][1]);
            else {
              if (te !== "asap") throw new Ne.InvalidArgument("Invalid event config");
              var $ = N(q, qr, function() {
                for (var Y = arguments.length, Q = new Array(Y); Y--; ) Q[Y] = arguments[Y];
                $.subscribers.forEach(function(ee) {
                  de(function() {
                    ee.apply(null, Q);
                  });
                });
              });
            }
          });
        }
      }
      function gn(f, y) {
        return A(y).from({ prototype: f }), y;
      }
      function Yr(f, y) {
        return !(f.filter || f.algorithm || f.or) && (y ? f.justLimit : !f.replayFilter);
      }
      function Bl(f, y) {
        f.filter = ya(f.filter, y);
      }
      function Yi(f, y, S) {
        var k = f.replayFilter;
        f.replayFilter = k ? function() {
          return ya(k(), y());
        } : y, f.justLimit = S && !k;
      }
      function Or(f, y) {
        if (f.isPrimKey) return y.primaryKey;
        var S = y.getIndexByKeyPath(f.index);
        if (!S) throw new Ne.Schema("KeyPath " + f.index + " on object store " + y.name + " is not indexed");
        return S;
      }
      function Ko(f, y, S) {
        var k = Or(f, y.schema);
        return y.openCursor({ trans: S, values: !f.keysOnly, reverse: f.dir === "prev", unique: !!f.unique, query: { index: k, range: f.range } });
      }
      function Qi(f, y, S, k) {
        var j = f.replayFilter ? ya(f.filter, f.replayFilter()) : f.filter;
        if (f.or) {
          var N = {}, z = function(B, H, F) {
            var J, q;
            j && !j(H, F, function(te) {
              return H.stop(te);
            }, function(te) {
              return H.fail(te);
            }) || ((q = "" + (J = H.primaryKey)) == "[object ArrayBuffer]" && (q = "" + new Uint8Array(J)), x(N, q) || (N[q] = !0, y(B, H, F)));
          };
          return Promise.all([f.or._iterate(z, S), ba(Ko(f, k, S), f.algorithm, z, !f.keysOnly && f.valueMapper)]);
        }
        return ba(Ko(f, k, S), ya(f.algorithm, j), y, !f.keysOnly && f.valueMapper);
      }
      function ba(f, y, S, k) {
        var j = Ot(k ? function(N, z, B) {
          return S(k(N), z, B);
        } : S);
        return f.then(function(N) {
          if (N) return N.start(function() {
            var z = function() {
              return N.continue();
            };
            y && !y(N, function(B) {
              return z = B;
            }, function(B) {
              N.stop(B), z = mt;
            }, function(B) {
              N.fail(B), z = mt;
            }) || j(N.value, N, function(B) {
              return z = B;
            }), z();
          });
        });
      }
      var wd = (yt.prototype._read = function(f, y) {
        var S = this._ctx;
        return S.error ? S.table._trans(null, Tt.bind(null, S.error)) : S.table._trans("readonly", f).then(y);
      }, yt.prototype._write = function(f) {
        var y = this._ctx;
        return y.error ? y.table._trans(null, Tt.bind(null, y.error)) : y.table._trans("readwrite", f, "locked");
      }, yt.prototype._addAlgorithm = function(f) {
        var y = this._ctx;
        y.algorithm = ya(y.algorithm, f);
      }, yt.prototype._iterate = function(f, y) {
        return Qi(this._ctx, f, y, this._ctx.table.core);
      }, yt.prototype.clone = function(f) {
        var y = Object.create(this.constructor.prototype), S = Object.create(this._ctx);
        return f && g(S, f), y._ctx = S, y;
      }, yt.prototype.raw = function() {
        return this._ctx.valueMapper = null, this;
      }, yt.prototype.each = function(f) {
        var y = this._ctx;
        return this._read(function(S) {
          return Qi(y, f, S, y.table.core);
        });
      }, yt.prototype.count = function(f) {
        var y = this;
        return this._read(function(S) {
          var k = y._ctx, j = k.table.core;
          if (Yr(k, !0)) return j.count({ trans: S, query: { index: Or(k, j.schema), range: k.range } }).then(function(z) {
            return Math.min(z, k.limit);
          });
          var N = 0;
          return Qi(k, function() {
            return ++N, !1;
          }, S, j).then(function() {
            return N;
          });
        }).then(f);
      }, yt.prototype.sortBy = function(f, y) {
        var S = f.split(".").reverse(), k = S[0], j = S.length - 1;
        function N(H, F) {
          return F ? N(H[S[F]], F - 1) : H[k];
        }
        var z = this._ctx.dir === "next" ? 1 : -1;
        function B(H, F) {
          return ct(N(H, j), N(F, j)) * z;
        }
        return this.toArray(function(H) {
          return H.sort(B);
        }).then(y);
      }, yt.prototype.toArray = function(f) {
        var y = this;
        return this._read(function(S) {
          var k = y._ctx;
          if (k.dir === "next" && Yr(k, !0) && 0 < k.limit) {
            var j = k.valueMapper, N = Or(k, k.table.core.schema);
            return k.table.core.query({ trans: S, limit: k.limit, values: !0, query: { index: N, range: k.range } }).then(function(B) {
              return B = B.result, j ? B.map(j) : B;
            });
          }
          var z = [];
          return Qi(k, function(B) {
            return z.push(B);
          }, S, k.table.core).then(function() {
            return z;
          });
        }, f);
      }, yt.prototype.offset = function(f) {
        var y = this._ctx;
        return f <= 0 || (y.offset += f, Yr(y) ? Yi(y, function() {
          var S = f;
          return function(k, j) {
            return S === 0 || (S === 1 ? --S : j(function() {
              k.advance(S), S = 0;
            }), !1);
          };
        }) : Yi(y, function() {
          var S = f;
          return function() {
            return --S < 0;
          };
        })), this;
      }, yt.prototype.limit = function(f) {
        return this._ctx.limit = Math.min(this._ctx.limit, f), Yi(this._ctx, function() {
          var y = f;
          return function(S, k, j) {
            return --y <= 0 && k(j), 0 <= y;
          };
        }, !0), this;
      }, yt.prototype.until = function(f, y) {
        return Bl(this._ctx, function(S, k, j) {
          return !f(S.value) || (k(j), y);
        }), this;
      }, yt.prototype.first = function(f) {
        return this.limit(1).toArray(function(y) {
          return y[0];
        }).then(f);
      }, yt.prototype.last = function(f) {
        return this.reverse().first(f);
      }, yt.prototype.filter = function(f) {
        var y;
        return Bl(this._ctx, function(S) {
          return f(S.value);
        }), (y = this._ctx).isMatch = ya(y.isMatch, f), this;
      }, yt.prototype.and = function(f) {
        return this.filter(f);
      }, yt.prototype.or = function(f) {
        return new this.db.WhereClause(this._ctx.table, f, this);
      }, yt.prototype.reverse = function() {
        return this._ctx.dir = this._ctx.dir === "prev" ? "next" : "prev", this._ondirectionchange && this._ondirectionchange(this._ctx.dir), this;
      }, yt.prototype.desc = function() {
        return this.reverse();
      }, yt.prototype.eachKey = function(f) {
        var y = this._ctx;
        return y.keysOnly = !y.isMatch, this.each(function(S, k) {
          f(k.key, k);
        });
      }, yt.prototype.eachUniqueKey = function(f) {
        return this._ctx.unique = "unique", this.eachKey(f);
      }, yt.prototype.eachPrimaryKey = function(f) {
        var y = this._ctx;
        return y.keysOnly = !y.isMatch, this.each(function(S, k) {
          f(k.primaryKey, k);
        });
      }, yt.prototype.keys = function(f) {
        var y = this._ctx;
        y.keysOnly = !y.isMatch;
        var S = [];
        return this.each(function(k, j) {
          S.push(j.key);
        }).then(function() {
          return S;
        }).then(f);
      }, yt.prototype.primaryKeys = function(f) {
        var y = this._ctx;
        if (y.dir === "next" && Yr(y, !0) && 0 < y.limit) return this._read(function(k) {
          var j = Or(y, y.table.core.schema);
          return y.table.core.query({ trans: k, values: !1, limit: y.limit, query: { index: j, range: y.range } });
        }).then(function(k) {
          return k.result;
        }).then(f);
        y.keysOnly = !y.isMatch;
        var S = [];
        return this.each(function(k, j) {
          S.push(j.primaryKey);
        }).then(function() {
          return S;
        }).then(f);
      }, yt.prototype.uniqueKeys = function(f) {
        return this._ctx.unique = "unique", this.keys(f);
      }, yt.prototype.firstKey = function(f) {
        return this.limit(1).keys(function(y) {
          return y[0];
        }).then(f);
      }, yt.prototype.lastKey = function(f) {
        return this.reverse().firstKey(f);
      }, yt.prototype.distinct = function() {
        var f = this._ctx, f = f.index && f.table.schema.idxByName[f.index];
        if (!f || !f.multi) return this;
        var y = {};
        return Bl(this._ctx, function(j) {
          var k = j.primaryKey.toString(), j = x(y, k);
          return y[k] = !0, !j;
        }), this;
      }, yt.prototype.modify = function(f) {
        var y = this, S = this._ctx;
        return this._write(function(k) {
          var j = typeof f == "function" ? f : function(Q) {
            return Ll(Q, f);
          }, N = S.table.core, F = N.schema.primaryKey, z = F.outbound, B = F.extractKey, H = 200, F = y.db._options.modifyChunkSize;
          F && (H = typeof F == "object" ? F[N.name] || F["*"] || 200 : F);
          function J(Q, ue) {
            var ae = ue.failures, ue = ue.numFailures;
            te += Q - ue;
            for (var xe = 0, Ce = d(ae); xe < Ce.length; xe++) {
              var De = Ce[xe];
              q.push(ae[De]);
            }
          }
          var q = [], te = 0, $ = [], Y = f === Yo;
          return y.clone().primaryKeys().then(function(Q) {
            function ee(ue) {
              var xe = Math.min(H, Q.length - ue), Ce = Q.slice(ue, ue + xe);
              return (Y ? Promise.resolve([]) : N.getMany({ trans: k, keys: Ce, cache: "immutable" })).then(function(De) {
                var qe = [], Ae = [], Le = z ? [] : null, Pe = Y ? Ce : [];
                if (!Y) for (var Me = 0; Me < xe; ++Me) {
                  var $e = De[Me], We = { value: Re($e), primKey: Q[ue + Me] };
                  j.call(We, We.value, We) !== !1 && (We.value == null ? Pe.push(Q[ue + Me]) : z || ct(B($e), B(We.value)) === 0 ? (Ae.push(We.value), z && Le.push(Q[ue + Me])) : (Pe.push(Q[ue + Me]), qe.push(We.value)));
                }
                return Promise.resolve(0 < qe.length && N.mutate({ trans: k, type: "add", values: qe }).then(function(rt) {
                  for (var lt in rt.failures) Pe.splice(parseInt(lt), 1);
                  J(qe.length, rt);
                })).then(function() {
                  return (0 < Ae.length || ae && typeof f == "object") && N.mutate({ trans: k, type: "put", keys: Le, values: Ae, criteria: ae, changeSpec: typeof f != "function" && f, isAdditionalChunk: 0 < ue }).then(function(rt) {
                    return J(Ae.length, rt);
                  });
                }).then(function() {
                  return (0 < Pe.length || ae && Y) && N.mutate({ trans: k, type: "delete", keys: Pe, criteria: ae, isAdditionalChunk: 0 < ue }).then(function(rt) {
                    return wn(S.table, Pe, rt);
                  }).then(function(rt) {
                    return J(Pe.length, rt);
                  });
                }).then(function() {
                  return Q.length > ue + xe && ee(ue + H);
                });
              });
            }
            var ae = Yr(S) && S.limit === 1 / 0 && (typeof f != "function" || Y) && { index: S.index, range: S.range };
            return ee(0).then(function() {
              if (0 < q.length) throw new Ye("Error modifying one or more objects", q, te, $);
              return Q.length;
            });
          });
        });
      }, yt.prototype.delete = function() {
        var f = this._ctx, y = f.range;
        return !Yr(f) || f.table.schema.yProps || !f.isPrimKey && y.type !== 3 ? this.modify(Yo) : this._write(function(S) {
          var k = f.table.core.schema.primaryKey, j = y;
          return f.table.core.count({ trans: S, query: { index: k, range: j } }).then(function(N) {
            return f.table.core.mutate({ trans: S, type: "deleteRange", range: j }).then(function(H) {
              var B = H.failures, H = H.numFailures;
              if (H) throw new Ye("Could not delete some values", Object.keys(B).map(function(F) {
                return B[F];
              }), N - H);
              return N - H;
            });
          });
        });
      }, yt);
      function yt() {
      }
      var Yo = function(f, y) {
        return y.value = null;
      };
      function Qo(f, y) {
        return f < y ? -1 : f === y ? 0 : 1;
      }
      function kd(f, y) {
        return y < f ? -1 : f === y ? 0 : 1;
      }
      function Un(f, y, S) {
        return f = f instanceof xa ? new f.Collection(f) : f, f._ctx.error = new (S || TypeError)(y), f;
      }
      function Dr(f) {
        return new f.Collection(f, function() {
          return Il("");
        }).limit(0);
      }
      function Gn(f, y, S, k) {
        var j, N, z, B, H, F, J, q = S.length;
        if (!S.every(function(Y) {
          return typeof Y == "string";
        })) return Un(f, Zt);
        function te(Y) {
          j = Y === "next" ? function(ee) {
            return ee.toUpperCase();
          } : function(ee) {
            return ee.toLowerCase();
          }, N = Y === "next" ? function(ee) {
            return ee.toLowerCase();
          } : function(ee) {
            return ee.toUpperCase();
          }, z = Y === "next" ? Qo : kd;
          var Q = S.map(function(ee) {
            return { lower: N(ee), upper: j(ee) };
          }).sort(function(ee, ae) {
            return z(ee.lower, ae.lower);
          });
          B = Q.map(function(ee) {
            return ee.upper;
          }), H = Q.map(function(ee) {
            return ee.lower;
          }), J = (F = Y) === "next" ? "" : k;
        }
        te("next"), f = new f.Collection(f, function() {
          return br(B[0], H[q - 1] + k);
        }), f._ondirectionchange = function(Y) {
          te(Y);
        };
        var $ = 0;
        return f._addAlgorithm(function(Y, Q, ee) {
          var ae = Y.key;
          if (typeof ae != "string") return !1;
          var ue = N(ae);
          if (y(ue, H, $)) return !0;
          for (var xe = null, Ce = $; Ce < q; ++Ce) {
            var De = (function(qe, Ae, Le, Pe, Me, $e) {
              for (var We = Math.min(qe.length, Pe.length), rt = -1, lt = 0; lt < We; ++lt) {
                var xn = Ae[lt];
                if (xn !== Pe[lt]) return Me(qe[lt], Le[lt]) < 0 ? qe.substr(0, lt) + Le[lt] + Le.substr(lt + 1) : Me(qe[lt], Pe[lt]) < 0 ? qe.substr(0, lt) + Pe[lt] + Le.substr(lt + 1) : 0 <= rt ? qe.substr(0, rt) + Ae[rt] + Le.substr(rt + 1) : null;
                Me(qe[lt], xn) < 0 && (rt = lt);
              }
              return We < Pe.length && $e === "next" ? qe + Le.substr(qe.length) : We < qe.length && $e === "prev" ? qe.substr(0, Le.length) : rt < 0 ? null : qe.substr(0, rt) + Pe[rt] + Le.substr(rt + 1);
            })(ae, ue, B[Ce], H[Ce], z, F);
            De === null && xe === null ? $ = Ce + 1 : (xe === null || 0 < z(xe, De)) && (xe = De);
          }
          return Q(xe !== null ? function() {
            Y.continue(xe + J);
          } : ee), !1;
        }), f;
      }
      function br(f, y, S, k) {
        return { type: 2, lower: f, upper: y, lowerOpen: S, upperOpen: k };
      }
      function Il(f) {
        return { type: 1, lower: f, upper: f };
      }
      var xa = (Object.defineProperty(Pt.prototype, "Collection", { get: function() {
        return this._ctx.table.db.Collection;
      }, enumerable: !1, configurable: !0 }), Pt.prototype.between = function(f, y, S, k) {
        S = S !== !1, k = k === !0;
        try {
          return 0 < this._cmp(f, y) || this._cmp(f, y) === 0 && (S || k) && (!S || !k) ? Dr(this) : new this.Collection(this, function() {
            return br(f, y, !S, !k);
          });
        } catch {
          return Un(this, An);
        }
      }, Pt.prototype.equals = function(f) {
        return f == null ? Un(this, An) : new this.Collection(this, function() {
          return Il(f);
        });
      }, Pt.prototype.above = function(f) {
        return f == null ? Un(this, An) : new this.Collection(this, function() {
          return br(f, void 0, !0);
        });
      }, Pt.prototype.aboveOrEqual = function(f) {
        return f == null ? Un(this, An) : new this.Collection(this, function() {
          return br(f, void 0, !1);
        });
      }, Pt.prototype.below = function(f) {
        return f == null ? Un(this, An) : new this.Collection(this, function() {
          return br(void 0, f, !1, !0);
        });
      }, Pt.prototype.belowOrEqual = function(f) {
        return f == null ? Un(this, An) : new this.Collection(this, function() {
          return br(void 0, f);
        });
      }, Pt.prototype.startsWith = function(f) {
        return typeof f != "string" ? Un(this, Zt) : this.between(f, f + ar, !0, !0);
      }, Pt.prototype.startsWithIgnoreCase = function(f) {
        return f === "" ? this.startsWith(f) : Gn(this, function(y, S) {
          return y.indexOf(S[0]) === 0;
        }, [f], ar);
      }, Pt.prototype.equalsIgnoreCase = function(f) {
        return Gn(this, function(y, S) {
          return y === S[0];
        }, [f], "");
      }, Pt.prototype.anyOfIgnoreCase = function() {
        var f = O.apply(Ue, arguments);
        return f.length === 0 ? Dr(this) : Gn(this, function(y, S) {
          return S.indexOf(y) !== -1;
        }, f, "");
      }, Pt.prototype.startsWithAnyOfIgnoreCase = function() {
        var f = O.apply(Ue, arguments);
        return f.length === 0 ? Dr(this) : Gn(this, function(y, S) {
          return S.some(function(k) {
            return y.indexOf(k) === 0;
          });
        }, f, ar);
      }, Pt.prototype.anyOf = function() {
        var f = this, y = O.apply(Ue, arguments), S = this._cmp;
        try {
          y.sort(S);
        } catch {
          return Un(this, An);
        }
        if (y.length === 0) return Dr(this);
        var k = new this.Collection(this, function() {
          return br(y[0], y[y.length - 1]);
        });
        k._ondirectionchange = function(N) {
          S = N === "next" ? f._ascending : f._descending, y.sort(S);
        };
        var j = 0;
        return k._addAlgorithm(function(N, z, B) {
          for (var H = N.key; 0 < S(H, y[j]); ) if (++j === y.length) return z(B), !1;
          return S(H, y[j]) === 0 || (z(function() {
            N.continue(y[j]);
          }), !1);
        }), k;
      }, Pt.prototype.notEqual = function(f) {
        return this.inAnyRange([[-1 / 0, f], [f, this.db._maxKey]], { includeLowers: !1, includeUppers: !1 });
      }, Pt.prototype.noneOf = function() {
        var f = O.apply(Ue, arguments);
        if (f.length === 0) return new this.Collection(this);
        try {
          f.sort(this._ascending);
        } catch {
          return Un(this, An);
        }
        var y = f.reduce(function(S, k) {
          return S ? S.concat([[S[S.length - 1][1], k]]) : [[-1 / 0, k]];
        }, null);
        return y.push([f[f.length - 1], this.db._maxKey]), this.inAnyRange(y, { includeLowers: !1, includeUppers: !1 });
      }, Pt.prototype.inAnyRange = function(ae, y) {
        var S = this, k = this._cmp, j = this._ascending, N = this._descending, z = this._min, B = this._max;
        if (ae.length === 0) return Dr(this);
        if (!ae.every(function(ue) {
          return ue[0] !== void 0 && ue[1] !== void 0 && j(ue[0], ue[1]) <= 0;
        })) return Un(this, "First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower", Ne.InvalidArgument);
        var H = !y || y.includeLowers !== !1, F = y && y.includeUppers === !0, J, q = j;
        function te(ue, xe) {
          return q(ue[0], xe[0]);
        }
        try {
          (J = ae.reduce(function(ue, xe) {
            for (var Ce = 0, De = ue.length; Ce < De; ++Ce) {
              var qe = ue[Ce];
              if (k(xe[0], qe[1]) < 0 && 0 < k(xe[1], qe[0])) {
                qe[0] = z(qe[0], xe[0]), qe[1] = B(qe[1], xe[1]);
                break;
              }
            }
            return Ce === De && ue.push(xe), ue;
          }, [])).sort(te);
        } catch {
          return Un(this, An);
        }
        var $ = 0, Y = F ? function(ue) {
          return 0 < j(ue, J[$][1]);
        } : function(ue) {
          return 0 <= j(ue, J[$][1]);
        }, Q = H ? function(ue) {
          return 0 < N(ue, J[$][0]);
        } : function(ue) {
          return 0 <= N(ue, J[$][0]);
        }, ee = Y, ae = new this.Collection(this, function() {
          return br(J[0][0], J[J.length - 1][1], !H, !F);
        });
        return ae._ondirectionchange = function(ue) {
          q = ue === "next" ? (ee = Y, j) : (ee = Q, N), J.sort(te);
        }, ae._addAlgorithm(function(ue, xe, Ce) {
          for (var De, qe = ue.key; ee(qe); ) if (++$ === J.length) return xe(Ce), !1;
          return !Y(De = qe) && !Q(De) || (S._cmp(qe, J[$][1]) === 0 || S._cmp(qe, J[$][0]) === 0 || xe(function() {
            q === j ? ue.continue(J[$][0]) : ue.continue(J[$][1]);
          }), !1);
        }), ae;
      }, Pt.prototype.startsWithAnyOf = function() {
        var f = O.apply(Ue, arguments);
        return f.every(function(y) {
          return typeof y == "string";
        }) ? f.length === 0 ? Dr(this) : this.inAnyRange(f.map(function(y) {
          return [y, y + ar];
        })) : Un(this, "startsWithAnyOf() only works with strings");
      }, Pt);
      function Pt() {
      }
      function ir(f) {
        return Ot(function(y) {
          return va(y), f(y.target.error), !1;
        });
      }
      function va(f) {
        f.stopPropagation && f.stopPropagation(), f.preventDefault && f.preventDefault();
      }
      var Wa = "storagemutated", Sa = "x-storagemutated-1", yn = Ki(null, Wa), Xo = (Mn.prototype._lock = function() {
        return ge(!Be.global), ++this._reculock, this._reculock !== 1 || Be.global || (Be.lockOwnerFor = this), this;
      }, Mn.prototype._unlock = function() {
        if (ge(!Be.global), --this._reculock == 0) for (Be.global || (Be.lockOwnerFor = null); 0 < this._blockedFuncs.length && !this._locked(); ) {
          var f = this._blockedFuncs.shift();
          try {
            rr(f[1], f[0]);
          } catch {
          }
        }
        return this;
      }, Mn.prototype._locked = function() {
        return this._reculock && Be.lockOwnerFor !== this;
      }, Mn.prototype.create = function(f) {
        var y = this;
        if (!this.mode) return this;
        var S = this.db.idbdb, k = this.db._state.dbOpenError;
        if (ge(!this.idbtrans), !f && !S) switch (k && k.name) {
          case "DatabaseClosedError":
            throw new Ne.DatabaseClosed(k);
          case "MissingAPIError":
            throw new Ne.MissingAPI(k.message, k);
          default:
            throw new Ne.OpenFailed(k);
        }
        if (!this.active) throw new Ne.TransactionInactive();
        return ge(this._completion._state === null), (f = this.idbtrans = f || (this.db.core || S).transaction(this.storeNames, this.mode, { durability: this.chromeTransactionDurability })).onerror = Ot(function(j) {
          va(j), y._reject(f.error);
        }), f.onabort = Ot(function(j) {
          va(j), y.active && y._reject(new Ne.Abort(f.error)), y.active = !1, y.on("abort").fire(j);
        }), f.oncomplete = Ot(function() {
          y.active = !1, y._resolve(), "mutatedParts" in f && yn.storagemutated.fire(f.mutatedParts);
        }), this;
      }, Mn.prototype._promise = function(f, y, S) {
        var k = this;
        if (f === "readwrite" && this.mode !== "readwrite") return Tt(new Ne.ReadOnly("Transaction is readonly"));
        if (!this.active) return Tt(new Ne.TransactionInactive());
        if (this._locked()) return new He(function(N, z) {
          k._blockedFuncs.push([function() {
            k._promise(f, y, S).then(N, z);
          }, Be]);
        });
        if (S) return Bt(function() {
          var N = new He(function(z, B) {
            k._lock();
            var H = y(z, B, k);
            H && H.then && H.then(z, B);
          });
          return N.finally(function() {
            return k._unlock();
          }), N._lib = !0, N;
        });
        var j = new He(function(N, z) {
          var B = y(N, z, k);
          B && B.then && B.then(N, z);
        });
        return j._lib = !0, j;
      }, Mn.prototype._root = function() {
        return this.parent ? this.parent._root() : this;
      }, Mn.prototype.waitFor = function(f) {
        var y, S = this._root(), k = He.resolve(f);
        S._waitingFor ? S._waitingFor = S._waitingFor.then(function() {
          return k;
        }) : (S._waitingFor = k, S._waitingQueue = [], y = S.idbtrans.objectStore(S.storeNames[0]), (function N() {
          for (++S._spinCount; S._waitingQueue.length; ) S._waitingQueue.shift()();
          S._waitingFor && (y.get(-1 / 0).onsuccess = N);
        })());
        var j = S._waitingFor;
        return new He(function(N, z) {
          k.then(function(B) {
            return S._waitingQueue.push(Ot(N.bind(null, B)));
          }, function(B) {
            return S._waitingQueue.push(Ot(z.bind(null, B)));
          }).finally(function() {
            S._waitingFor === j && (S._waitingFor = null);
          });
        });
      }, Mn.prototype.abort = function() {
        this.active && (this.active = !1, this.idbtrans && this.idbtrans.abort(), this._reject(new Ne.Abort()));
      }, Mn.prototype.table = function(f) {
        var y = this._memoizedTables || (this._memoizedTables = {});
        if (x(y, f)) return y[f];
        var S = this.schema[f];
        if (!S) throw new Ne.NotFound("Table " + f + " not part of transaction");
        return S = new this.db.Table(f, S, this), S.core = this.db.core.table(f), y[f] = S;
      }, Mn);
      function Mn() {
      }
      function xr(f, y, S, k, j, N, z, B) {
        return { name: f, keyPath: y, unique: S, multi: k, auto: j, compound: N, src: (S && !z ? "&" : "") + (k ? "*" : "") + (j ? "++" : "") + Ul(y), type: B };
      }
      function Ul(f) {
        return typeof f == "string" ? f : f ? "[" + [].join.call(f, "+") + "]" : "";
      }
      function Za(f, y, S) {
        return { name: f, primKey: y, indexes: S, mappedClass: null, idxByName: (k = function(j) {
          return [j.name, j];
        }, S.reduce(function(j, N, z) {
          return z = k(N, z), z && (j[z[0]] = z[1]), j;
        }, {})) };
        var k;
      }
      var Ja = function(f) {
        try {
          return f.only([[]]), Ja = function() {
            return [[]];
          }, [[]];
        } catch {
          return Ja = function() {
            return ar;
          }, ar;
        }
      };
      function ei(f) {
        return f == null ? function() {
        } : typeof f == "string" ? (y = f).split(".").length === 1 ? function(S) {
          return S[y];
        } : function(S) {
          return I(S, y);
        } : function(S) {
          return I(S, f);
        };
        var y;
      }
      function Xi(f) {
        return [].slice.call(f);
      }
      var Cu = 0;
      function rn(f) {
        return f == null ? ":id" : typeof f == "string" ? f : "[".concat(f.join("+"), "]");
      }
      function wa(f, y, H) {
        function k(ee) {
          if (ee.type === 3) return null;
          if (ee.type === 4) throw new Error("Cannot convert never type to IDBKeyRange");
          var $ = ee.lower, Y = ee.upper, Q = ee.lowerOpen, ee = ee.upperOpen;
          return $ === void 0 ? Y === void 0 ? null : y.upperBound(Y, !!ee) : Y === void 0 ? y.lowerBound($, !!Q) : y.bound($, Y, !!Q, !!ee);
        }
        function j(te) {
          var $, Y = te.name;
          return { name: Y, schema: te, mutate: function(Q) {
            var ee = Q.trans, ae = Q.type, ue = Q.keys, xe = Q.values, Ce = Q.range;
            return new Promise(function(De, qe) {
              De = Ot(De);
              var Ae = ee.objectStore(Y), Le = Ae.keyPath == null, Pe = ae === "put" || ae === "add";
              if (!Pe && ae !== "delete" && ae !== "deleteRange") throw new Error("Invalid operation type: " + ae);
              var Me, $e = (ue || xe || { length: 1 }).length;
              if (ue && xe && ue.length !== xe.length) throw new Error("Given keys array must have same length as given values array.");
              if ($e === 0) return De({ numFailures: 0, failures: {}, results: [], lastResult: void 0 });
              function We(ln) {
                ++xn, va(ln);
              }
              var rt = [], lt = [], xn = 0;
              if (ae === "deleteRange") {
                if (Ce.type === 4) return De({ numFailures: xn, failures: lt, results: [], lastResult: void 0 });
                Ce.type === 3 ? rt.push(Me = Ae.clear()) : rt.push(Me = Ae.delete(k(Ce)));
              } else {
                var Le = Pe ? Le ? [xe, ue] : [xe, null] : [ue, null], nt = Le[0], an = Le[1];
                if (Pe) for (var $t = 0; $t < $e; ++$t) rt.push(Me = an && an[$t] !== void 0 ? Ae[ae](nt[$t], an[$t]) : Ae[ae](nt[$t])), Me.onerror = We;
                else for ($t = 0; $t < $e; ++$t) rt.push(Me = Ae[ae](nt[$t])), Me.onerror = We;
              }
              function rl(ln) {
                ln = ln.target.result, rt.forEach(function(Vn, cs) {
                  return Vn.error != null && (lt[cs] = Vn.error);
                }), De({ numFailures: xn, failures: lt, results: ae === "delete" ? ue : rt.map(function(Vn) {
                  return Vn.result;
                }), lastResult: ln });
              }
              Me.onerror = function(ln) {
                We(ln), rl(ln);
              }, Me.onsuccess = rl;
            });
          }, getMany: function(Q) {
            var ee = Q.trans, ae = Q.keys;
            return new Promise(function(ue, xe) {
              ue = Ot(ue);
              for (var Ce, De = ee.objectStore(Y), qe = ae.length, Ae = new Array(qe), Le = 0, Pe = 0, Me = function(rt) {
                rt = rt.target, Ae[rt._pos] = rt.result, ++Pe === Le && ue(Ae);
              }, $e = ir(xe), We = 0; We < qe; ++We) ae[We] != null && ((Ce = De.get(ae[We]))._pos = We, Ce.onsuccess = Me, Ce.onerror = $e, ++Le);
              Le === 0 && ue(Ae);
            });
          }, get: function(Q) {
            var ee = Q.trans, ae = Q.key;
            return new Promise(function(ue, xe) {
              ue = Ot(ue);
              var Ce = ee.objectStore(Y).get(ae);
              Ce.onsuccess = function(De) {
                return ue(De.target.result);
              }, Ce.onerror = ir(xe);
            });
          }, query: ($ = F, function(Q) {
            return new Promise(function(ee, ae) {
              ee = Ot(ee);
              var ue, xe, Ce, Le = Q.trans, De = Q.values, qe = Q.limit, Me = Q.query, Ae = qe === 1 / 0 ? void 0 : qe, Pe = Me.index, Me = Me.range, Le = Le.objectStore(Y), Pe = Pe.isPrimaryKey ? Le : Le.index(Pe.name), Me = k(Me);
              if (qe === 0) return ee({ result: [] });
              $ ? ((Ae = De ? Pe.getAll(Me, Ae) : Pe.getAllKeys(Me, Ae)).onsuccess = function($e) {
                return ee({ result: $e.target.result });
              }, Ae.onerror = ir(ae)) : (ue = 0, xe = !De && "openKeyCursor" in Pe ? Pe.openKeyCursor(Me) : Pe.openCursor(Me), Ce = [], xe.onsuccess = function($e) {
                var We = xe.result;
                return We ? (Ce.push(De ? We.value : We.primaryKey), ++ue === qe ? ee({ result: Ce }) : void We.continue()) : ee({ result: Ce });
              }, xe.onerror = ir(ae));
            });
          }), openCursor: function(Q) {
            var ee = Q.trans, ae = Q.values, ue = Q.query, xe = Q.reverse, Ce = Q.unique;
            return new Promise(function(De, qe) {
              De = Ot(De);
              var Pe = ue.index, Ae = ue.range, Le = ee.objectStore(Y), Le = Pe.isPrimaryKey ? Le : Le.index(Pe.name), Pe = xe ? Ce ? "prevunique" : "prev" : Ce ? "nextunique" : "next", Me = !ae && "openKeyCursor" in Le ? Le.openKeyCursor(k(Ae), Pe) : Le.openCursor(k(Ae), Pe);
              Me.onerror = ir(qe), Me.onsuccess = Ot(function($e) {
                var We, rt, lt, xn, nt = Me.result;
                nt ? (nt.___id = ++Cu, nt.done = !1, We = nt.continue.bind(nt), rt = (rt = nt.continuePrimaryKey) && rt.bind(nt), lt = nt.advance.bind(nt), xn = function() {
                  throw new Error("Cursor not stopped");
                }, nt.trans = ee, nt.stop = nt.continue = nt.continuePrimaryKey = nt.advance = function() {
                  throw new Error("Cursor not started");
                }, nt.fail = Ot(qe), nt.next = function() {
                  var an = this, $t = 1;
                  return this.start(function() {
                    return $t-- ? an.continue() : an.stop();
                  }).then(function() {
                    return an;
                  });
                }, nt.start = function(an) {
                  function $t() {
                    if (Me.result) try {
                      an();
                    } catch (ln) {
                      nt.fail(ln);
                    }
                    else nt.done = !0, nt.start = function() {
                      throw new Error("Cursor behind last entry");
                    }, nt.stop();
                  }
                  var rl = new Promise(function(ln, Vn) {
                    ln = Ot(ln), Me.onerror = ir(Vn), nt.fail = Vn, nt.stop = function(cs) {
                      nt.stop = nt.continue = nt.continuePrimaryKey = nt.advance = xn, ln(cs);
                    };
                  });
                  return Me.onsuccess = Ot(function(ln) {
                    Me.onsuccess = $t, $t();
                  }), nt.continue = We, nt.continuePrimaryKey = rt, nt.advance = lt, $t(), rl;
                }, De(nt)) : De(null);
              }, qe);
            });
          }, count: function(Q) {
            var ee = Q.query, ae = Q.trans, ue = ee.index, xe = ee.range;
            return new Promise(function(Ce, De) {
              var qe = ae.objectStore(Y), Ae = ue.isPrimaryKey ? qe : qe.index(ue.name), qe = k(xe), Ae = qe ? Ae.count(qe) : Ae.count();
              Ae.onsuccess = Ot(function(Le) {
                return Ce(Le.target.result);
              }), Ae.onerror = ir(De);
            });
          } };
        }
        var N, z, B, J = (z = H, B = Xi((N = f).objectStoreNames), { schema: { name: N.name, tables: B.map(function(te) {
          return z.objectStore(te);
        }).map(function(te) {
          var $ = te.keyPath, ee = te.autoIncrement, Y = m($), Q = {}, ee = { name: te.name, primaryKey: { name: null, isPrimaryKey: !0, outbound: $ == null, compound: Y, keyPath: $, autoIncrement: ee, unique: !0, extractKey: ei($) }, indexes: Xi(te.indexNames).map(function(ae) {
            return te.index(ae);
          }).map(function(Ce) {
            var ue = Ce.name, xe = Ce.unique, De = Ce.multiEntry, Ce = Ce.keyPath, De = { name: ue, compound: m(Ce), keyPath: Ce, unique: xe, multiEntry: De, extractKey: ei(Ce) };
            return Q[rn(Ce)] = De;
          }), getIndexByKeyPath: function(ae) {
            return Q[rn(ae)];
          } };
          return Q[":id"] = ee.primaryKey, $ != null && (Q[rn($)] = ee.primaryKey), ee;
        }) }, hasGetAll: 0 < B.length && "getAll" in z.objectStore(B[0]) && !(typeof navigator < "u" && /Safari/.test(navigator.userAgent) && !/(Chrome\/|Edge\/)/.test(navigator.userAgent) && [].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1] < 604) }), H = J.schema, F = J.hasGetAll, J = H.tables.map(j), q = {};
        return J.forEach(function(te) {
          return q[te.name] = te;
        }), { stack: "dbcore", transaction: f.transaction.bind(f), table: function(te) {
          if (!q[te]) throw new Error("Table '".concat(te, "' not found"));
          return q[te];
        }, MIN_KEY: -1 / 0, MAX_KEY: Ja(y), schema: H };
      }
      function Pl(f, y, S, k) {
        var j = S.IDBKeyRange;
        return S.indexedDB, { dbcore: (k = wa(y, j, k), f.dbcore.reduce(function(N, z) {
          return z = z.create, l(l({}, N), z(N));
        }, k)) };
      }
      function Qr(f, k) {
        var S = k.db, k = Pl(f._middlewares, S, f._deps, k);
        f.core = k.dbcore, f.tables.forEach(function(j) {
          var N = j.name;
          f.core.schema.tables.some(function(z) {
            return z.name === N;
          }) && (j.core = f.core.table(N), f[N] instanceof f.Table && (f[N].core = j.core));
        });
      }
      function ql(f, y, S, k) {
        S.forEach(function(j) {
          var N = k[j];
          y.forEach(function(z) {
            var B = (function H(F, J) {
              return D(F, J) || (F = p(F)) && H(F, J);
            })(z, j);
            (!B || "value" in B && B.value === void 0) && (z === f.Transaction.prototype || z instanceof f.Transaction ? _(z, j, { get: function() {
              return this.table(j);
            }, set: function(H) {
              w(this, j, { value: H, writable: !0, configurable: !0, enumerable: !0 });
            } }) : z[j] = new f.Table(j, N));
          });
        });
      }
      function Wi(f, y) {
        y.forEach(function(S) {
          for (var k in S) S[k] instanceof f.Table && delete S[k];
        });
      }
      function Wo(f, y) {
        return f._cfg.version - y._cfg.version;
      }
      function Zi(f, y, S, k) {
        var j = f._dbSchema;
        S.objectStoreNames.contains("$meta") && !j.$meta && (j.$meta = Za("$meta", ju("")[0], []), f._storeNames.push("$meta"));
        var N = f._createTransaction("readwrite", f._storeNames, j);
        N.create(S), N._completion.catch(k);
        var z = N._reject.bind(N), B = Be.transless || Be;
        Bt(function() {
          return Be.trans = N, Be.transless = B, y !== 0 ? (Qr(f, S), F = y, ((H = N).storeNames.includes("$meta") ? H.table("$meta").get("version").then(function(J) {
            return J ?? F;
          }) : He.resolve(F)).then(function(J) {
            return te = J, $ = N, Y = S, Q = [], J = (q = f)._versions, ee = q._dbSchema = ti(0, q.idbdb, Y), (J = J.filter(function(ae) {
              return ae._cfg.version >= te;
            })).length !== 0 ? (J.forEach(function(ae) {
              Q.push(function() {
                var ue = ee, xe = ae._cfg.dbschema;
                Gl(q, ue, Y), Gl(q, xe, Y), ee = q._dbSchema = xe;
                var Ce = Fl(ue, xe);
                Ce.add.forEach(function(Pe) {
                  Zo(Y, Pe[0], Pe[1].primKey, Pe[1].indexes);
                }), Ce.change.forEach(function(Pe) {
                  if (Pe.recreate) throw new Ne.Upgrade("Not yet support for changing primary key");
                  var Me = Y.objectStore(Pe.name);
                  Pe.add.forEach(function($e) {
                    return $l(Me, $e);
                  }), Pe.change.forEach(function($e) {
                    Me.deleteIndex($e.name), $l(Me, $e);
                  }), Pe.del.forEach(function($e) {
                    return Me.deleteIndex($e);
                  });
                });
                var De = ae._cfg.contentUpgrade;
                if (De && ae._cfg.version > te) {
                  Qr(q, Y), $._memoizedTables = {};
                  var qe = we(xe);
                  Ce.del.forEach(function(Pe) {
                    qe[Pe] = ue[Pe];
                  }), Wi(q, [q.Transaction.prototype]), ql(q, [q.Transaction.prototype], d(qe), qe), $.schema = qe;
                  var Ae, Le = L(De);
                  return Le && Wt(), Ce = He.follow(function() {
                    var Pe;
                    (Ae = De($)) && Le && (Pe = In.bind(null, null), Ae.then(Pe, Pe));
                  }), Ae && typeof Ae.then == "function" ? He.resolve(Ae) : Ce.then(function() {
                    return Ae;
                  });
                }
              }), Q.push(function(ue) {
                var xe, Ce, De = ae._cfg.dbschema;
                xe = De, Ce = ue, [].slice.call(Ce.db.objectStoreNames).forEach(function(qe) {
                  return xe[qe] == null && Ce.db.deleteObjectStore(qe);
                }), Wi(q, [q.Transaction.prototype]), ql(q, [q.Transaction.prototype], q._storeNames, q._dbSchema), $.schema = q._dbSchema;
              }), Q.push(function(ue) {
                q.idbdb.objectStoreNames.contains("$meta") && (Math.ceil(q.idbdb.version / 10) === ae._cfg.version ? (q.idbdb.deleteObjectStore("$meta"), delete q._dbSchema.$meta, q._storeNames = q._storeNames.filter(function(xe) {
                  return xe !== "$meta";
                })) : ue.objectStore("$meta").put(ae._cfg.version, "version"));
              });
            }), (function ae() {
              return Q.length ? He.resolve(Q.shift()($.idbtrans)).then(ae) : He.resolve();
            })().then(function() {
              Eu(ee, Y);
            })) : He.resolve();
            var q, te, $, Y, Q, ee;
          }).catch(z)) : (d(j).forEach(function(J) {
            Zo(S, J, j[J].primKey, j[J].indexes);
          }), Qr(f, S), void He.follow(function() {
            return f.on.populate.fire(N);
          }).catch(z));
          var H, F;
        });
      }
      function Hl(f, y) {
        Eu(f._dbSchema, y), y.db.version % 10 != 0 || y.objectStoreNames.contains("$meta") || y.db.createObjectStore("$meta").add(Math.ceil(y.db.version / 10 - 1), "version");
        var S = ti(0, f.idbdb, y);
        Gl(f, f._dbSchema, y);
        for (var k = 0, j = Fl(S, f._dbSchema).change; k < j.length; k++) {
          var N = (function(z) {
            if (z.change.length || z.recreate) return console.warn("Unable to patch indexes of table ".concat(z.name, " because it has changes on the type of index or primary key.")), { value: void 0 };
            var B = y.objectStore(z.name);
            z.add.forEach(function(H) {
              Tn && console.debug("Dexie upgrade patch: Creating missing index ".concat(z.name, ".").concat(H.src)), $l(B, H);
            });
          })(j[k]);
          if (typeof N == "object") return N.value;
        }
      }
      function Fl(f, y) {
        var S, k = { del: [], add: [], change: [] };
        for (S in f) y[S] || k.del.push(S);
        for (S in y) {
          var j = f[S], N = y[S];
          if (j) {
            var z = { name: S, def: N, recreate: !1, del: [], add: [], change: [] };
            if ("" + (j.primKey.keyPath || "") != "" + (N.primKey.keyPath || "") || j.primKey.auto !== N.primKey.auto) z.recreate = !0, k.change.push(z);
            else {
              var B = j.idxByName, H = N.idxByName, F = void 0;
              for (F in B) H[F] || z.del.push(F);
              for (F in H) {
                var J = B[F], q = H[F];
                J ? J.src !== q.src && z.change.push(q) : z.add.push(q);
              }
              (0 < z.del.length || 0 < z.add.length || 0 < z.change.length) && k.change.push(z);
            }
          } else k.add.push([S, N]);
        }
        return k;
      }
      function Zo(f, y, S, k) {
        var j = f.db.createObjectStore(y, S.keyPath ? { keyPath: S.keyPath, autoIncrement: S.auto } : { autoIncrement: S.auto });
        return k.forEach(function(N) {
          return $l(j, N);
        }), j;
      }
      function Eu(f, y) {
        d(f).forEach(function(S) {
          y.db.objectStoreNames.contains(S) || (Tn && console.debug("Dexie: Creating missing table", S), Zo(y, S, f[S].primKey, f[S].indexes));
        });
      }
      function $l(f, y) {
        f.createIndex(y.name, y.keyPath, { unique: y.unique, multiEntry: y.multi });
      }
      function ti(f, y, S) {
        var k = {};
        return Z(y.objectStoreNames, 0).forEach(function(j) {
          for (var N = S.objectStore(j), z = xr(Ul(F = N.keyPath), F || "", !0, !1, !!N.autoIncrement, F && typeof F != "string", !0), B = [], H = 0; H < N.indexNames.length; ++H) {
            var J = N.index(N.indexNames[H]), F = J.keyPath, J = xr(J.name, F, !!J.unique, !!J.multiEntry, !1, F && typeof F != "string", !1);
            B.push(J);
          }
          k[j] = Za(j, z, B);
        }), k;
      }
      function Gl(f, y, S) {
        for (var k = S.db.objectStoreNames, j = 0; j < k.length; ++j) {
          var N = k[j], z = S.objectStore(N);
          f._hasGetAll = "getAll" in z;
          for (var B = 0; B < z.indexNames.length; ++B) {
            var H = z.indexNames[B], F = z.index(H).keyPath, J = typeof F == "string" ? F : "[" + Z(F).join("+") + "]";
            !y[N] || (F = y[N].idxByName[J]) && (F.name = H, delete y[N].idxByName[J], y[N].idxByName[H] = F);
          }
        }
        typeof navigator < "u" && /Safari/.test(navigator.userAgent) && !/(Chrome\/|Edge\/)/.test(navigator.userAgent) && c.WorkerGlobalScope && c instanceof c.WorkerGlobalScope && [].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1] < 604 && (f._hasGetAll = !1);
      }
      function ju(f) {
        return f.split(",").map(function(y, S) {
          var N = y.split(":"), k = (j = N[1]) === null || j === void 0 ? void 0 : j.trim(), j = (y = N[0].trim()).replace(/([&*]|\+\+)/g, ""), N = /^\[/.test(j) ? j.match(/^\[(.*)\]$/)[1].split("+") : j;
          return xr(j, N || null, /\&/.test(y), /\*/.test(y), /\+\+/.test(y), m(N), S === 0, k);
        });
      }
      var Cd = (ni.prototype._createTableSchema = Za, ni.prototype._parseIndexSyntax = ju, ni.prototype._parseStoresSpec = function(f, y) {
        var S = this;
        d(f).forEach(function(k) {
          if (f[k] !== null) {
            var j = S._parseIndexSyntax(f[k]), N = j.shift();
            if (!N) throw new Ne.Schema("Invalid schema for table " + k + ": " + f[k]);
            if (N.unique = !0, N.multi) throw new Ne.Schema("Primary key cannot be multiEntry*");
            j.forEach(function(z) {
              if (z.auto) throw new Ne.Schema("Only primary key can be marked as autoIncrement (++)");
              if (!z.keyPath) throw new Ne.Schema("Index must have a name and cannot be an empty string");
            }), j = S._createTableSchema(k, N, j), y[k] = j;
          }
        });
      }, ni.prototype.stores = function(S) {
        var y = this.db;
        this._cfg.storesSource = this._cfg.storesSource ? g(this._cfg.storesSource, S) : S;
        var S = y._versions, k = {}, j = {};
        return S.forEach(function(N) {
          g(k, N._cfg.storesSource), j = N._cfg.dbschema = {}, N._parseStoresSpec(k, j);
        }), y._dbSchema = j, Wi(y, [y._allTables, y, y.Transaction.prototype]), ql(y, [y._allTables, y, y.Transaction.prototype, this._cfg.tables], d(j), j), y._storeNames = d(j), this;
      }, ni.prototype.upgrade = function(f) {
        return this._cfg.contentUpgrade = Hr(this._cfg.contentUpgrade || mt, f), this;
      }, ni);
      function ni() {
      }
      function Jo(f, y) {
        var S = f._dbNamesDB;
        return S || (S = f._dbNamesDB = new vr($i, { addons: [], indexedDB: f, IDBKeyRange: y })).version(1).stores({ dbnames: "name" }), S.table("dbnames");
      }
      function Vl(f) {
        return f && typeof f.databases == "function";
      }
      function es(f) {
        return Bt(function() {
          return Be.letThrough = !0, f();
        });
      }
      function ts(f) {
        return !("from" in f);
      }
      var bn = function(f, y) {
        if (!this) {
          var S = new bn();
          return f && "d" in f && g(S, f), S;
        }
        g(this, arguments.length ? { d: 1, from: f, to: 1 < arguments.length ? y : f } : { d: 0 });
      };
      function Ji(f, y, S) {
        var k = ct(y, S);
        if (!isNaN(k)) {
          if (0 < k) throw RangeError();
          if (ts(f)) return g(f, { from: y, to: S, d: 1 });
          var j = f.l, k = f.r;
          if (ct(S, f.from) < 0) return j ? Ji(j, y, S) : f.l = { from: y, to: S, d: 1, l: null, r: null }, Nu(f);
          if (0 < ct(y, f.to)) return k ? Ji(k, y, S) : f.r = { from: y, to: S, d: 1, l: null, r: null }, Nu(f);
          ct(y, f.from) < 0 && (f.from = y, f.l = null, f.d = k ? k.d + 1 : 1), 0 < ct(S, f.to) && (f.to = S, f.r = null, f.d = f.l ? f.l.d + 1 : 1), S = !f.r, j && !f.l && ka(f, j), k && S && ka(f, k);
        }
      }
      function ka(f, y) {
        ts(y) || (function S(k, H) {
          var N = H.from, z = H.to, B = H.l, H = H.r;
          Ji(k, N, z), B && S(k, B), H && S(k, H);
        })(f, y);
      }
      function _u(f, y) {
        var S = Kl(y), k = S.next();
        if (k.done) return !1;
        for (var j = k.value, N = Kl(f), z = N.next(j.from), B = z.value; !k.done && !z.done; ) {
          if (ct(B.from, j.to) <= 0 && 0 <= ct(B.to, j.from)) return !0;
          ct(j.from, B.from) < 0 ? j = (k = S.next(B.from)).value : B = (z = N.next(j.from)).value;
        }
        return !1;
      }
      function Kl(f) {
        var y = ts(f) ? null : { s: 0, n: f };
        return { next: function(S) {
          for (var k = 0 < arguments.length; y; ) switch (y.s) {
            case 0:
              if (y.s = 1, k) for (; y.n.l && ct(S, y.n.from) < 0; ) y = { up: y, n: y.n.l, s: 1 };
              else for (; y.n.l; ) y = { up: y, n: y.n.l, s: 1 };
            case 1:
              if (y.s = 2, !k || ct(S, y.n.to) <= 0) return { value: y.n, done: !1 };
            case 2:
              if (y.n.r) {
                y.s = 3, y = { up: y, n: y.n.r, s: 0 };
                continue;
              }
            case 3:
              y = y.up;
          }
          return { done: !0 };
        } };
      }
      function Nu(f) {
        var y, S, k = (((y = f.r) === null || y === void 0 ? void 0 : y.d) || 0) - (((S = f.l) === null || S === void 0 ? void 0 : S.d) || 0), j = 1 < k ? "r" : k < -1 ? "l" : "";
        j && (y = j == "r" ? "l" : "r", S = l({}, f), k = f[j], f.from = k.from, f.to = k.to, f[j] = k[j], S[j] = k[y], (f[y] = S).d = ns(S)), f.d = ns(f);
      }
      function ns(S) {
        var y = S.r, S = S.l;
        return (y ? S ? Math.max(y.d, S.d) : y.d : S ? S.d : 0) + 1;
      }
      function Yl(f, y) {
        return d(y).forEach(function(S) {
          f[S] ? ka(f[S], y[S]) : f[S] = (function k(j) {
            var N, z, B = {};
            for (N in j) x(j, N) && (z = j[N], B[N] = !z || typeof z != "object" || oe.has(z.constructor) ? z : k(z));
            return B;
          })(y[S]);
        }), f;
      }
      function rs(f, y) {
        return f.all || y.all || Object.keys(f).some(function(S) {
          return y[S] && _u(y[S], f[S]);
        });
      }
      E(bn.prototype, ((Pn = { add: function(f) {
        return ka(this, f), this;
      }, addKey: function(f) {
        return Ji(this, f, f), this;
      }, addKeys: function(f) {
        var y = this;
        return f.forEach(function(S) {
          return Ji(y, S, S);
        }), this;
      }, hasKey: function(f) {
        var y = Kl(this).next(f).value;
        return y && ct(y.from, f) <= 0 && 0 <= ct(y.to, f);
      } })[re] = function() {
        return Kl(this);
      }, Pn));
      var Ca = {}, as = {}, is = !1;
      function Ql(f) {
        Yl(as, f), is || (is = !0, setTimeout(function() {
          is = !1, ls(as, !(as = {}));
        }, 0));
      }
      function ls(f, y) {
        y === void 0 && (y = !1);
        var S = /* @__PURE__ */ new Set();
        if (f.all) for (var k = 0, j = Object.values(Ca); k < j.length; k++) Tu(z = j[k], f, S, y);
        else for (var N in f) {
          var z, B = /^idb\:\/\/(.*)\/(.*)\//.exec(N);
          B && (N = B[1], B = B[2], (z = Ca["idb://".concat(N, "/").concat(B)]) && Tu(z, f, S, y));
        }
        S.forEach(function(H) {
          return H();
        });
      }
      function Tu(f, y, S, k) {
        for (var j = [], N = 0, z = Object.entries(f.queries.query); N < z.length; N++) {
          for (var B = z[N], H = B[0], F = [], J = 0, q = B[1]; J < q.length; J++) {
            var te = q[J];
            rs(y, te.obsSet) ? te.subscribers.forEach(function(ee) {
              return S.add(ee);
            }) : k && F.push(te);
          }
          k && j.push([H, F]);
        }
        if (k) for (var $ = 0, Y = j; $ < Y.length; $++) {
          var Q = Y[$], H = Q[0], F = Q[1];
          f.queries.query[H] = F;
        }
      }
      function Ed(f) {
        var y = f._state, S = f._deps.indexedDB;
        if (y.isBeingOpened || f.idbdb) return y.dbReadyPromise.then(function() {
          return y.dbOpenError ? Tt(y.dbOpenError) : f;
        });
        y.isBeingOpened = !0, y.dbOpenError = null, y.openComplete = !1;
        var k = y.openCanceller, j = Math.round(10 * f.verno), N = !1;
        function z() {
          if (y.openCanceller !== k) throw new Ne.DatabaseClosed("db.open() was cancelled");
        }
        function B() {
          return new He(function(te, $) {
            if (z(), !S) throw new Ne.MissingAPI();
            var Y = f.name, Q = y.autoSchema || !j ? S.open(Y) : S.open(Y, j);
            if (!Q) throw new Ne.MissingAPI();
            Q.onerror = ir($), Q.onblocked = Ot(f._fireOnBlocked), Q.onupgradeneeded = Ot(function(ee) {
              var ae;
              J = Q.transaction, y.autoSchema && !f._options.allowEmptyDB ? (Q.onerror = va, J.abort(), Q.result.close(), (ae = S.deleteDatabase(Y)).onsuccess = ae.onerror = Ot(function() {
                $(new Ne.NoSuchDatabase("Database ".concat(Y, " doesnt exist")));
              })) : (J.onerror = ir($), ee = ee.oldVersion > Math.pow(2, 62) ? 0 : ee.oldVersion, q = ee < 1, f.idbdb = Q.result, N && Hl(f, J), Zi(f, ee / 10, J, $));
            }, $), Q.onsuccess = Ot(function() {
              J = null;
              var ee, ae, ue, xe, Ce, De = f.idbdb = Q.result, qe = Z(De.objectStoreNames);
              if (0 < qe.length) try {
                var Ae = De.transaction((xe = qe).length === 1 ? xe[0] : xe, "readonly");
                if (y.autoSchema) ae = De, ue = Ae, (ee = f).verno = ae.version / 10, ue = ee._dbSchema = ti(0, ae, ue), ee._storeNames = Z(ae.objectStoreNames, 0), ql(ee, [ee._allTables], d(ue), ue);
                else if (Gl(f, f._dbSchema, Ae), ((Ce = Fl(ti(0, (Ce = f).idbdb, Ae), Ce._dbSchema)).add.length || Ce.change.some(function(Le) {
                  return Le.add.length || Le.change.length;
                })) && !N) return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."), De.close(), j = De.version + 1, N = !0, te(B());
                Qr(f, Ae);
              } catch {
              }
              ga.push(f), De.onversionchange = Ot(function(Le) {
                y.vcFired = !0, f.on("versionchange").fire(Le);
              }), De.onclose = Ot(function() {
                f.close({ disableAutoOpen: !1 });
              }), q && (Ce = f._deps, Ae = Y, De = Ce.indexedDB, Ce = Ce.IDBKeyRange, Vl(De) || Ae === $i || Jo(De, Ce).put({ name: Ae }).catch(mt)), te();
            }, $);
          }).catch(function(te) {
            switch (te == null ? void 0 : te.name) {
              case "UnknownError":
                if (0 < y.PR1398_maxLoop) return y.PR1398_maxLoop--, console.warn("Dexie: Workaround for Chrome UnknownError on open()"), B();
                break;
              case "VersionError":
                if (0 < j) return j = 0, B();
            }
            return He.reject(te);
          });
        }
        var H, F = y.dbReadyResolve, J = null, q = !1;
        return He.race([k, (typeof navigator > "u" ? He.resolve() : !navigator.userAgentData && /Safari\//.test(navigator.userAgent) && !/Chrom(e|ium)\//.test(navigator.userAgent) && indexedDB.databases ? new Promise(function(te) {
          function $() {
            return indexedDB.databases().finally(te);
          }
          H = setInterval($, 100), $();
        }).finally(function() {
          return clearInterval(H);
        }) : Promise.resolve()).then(B)]).then(function() {
          return z(), y.onReadyBeingFired = [], He.resolve(es(function() {
            return f.on.ready.fire(f.vip);
          })).then(function te() {
            if (0 < y.onReadyBeingFired.length) {
              var $ = y.onReadyBeingFired.reduce(Hr, mt);
              return y.onReadyBeingFired = [], He.resolve(es(function() {
                return $(f.vip);
              })).then(te);
            }
          });
        }).finally(function() {
          y.openCanceller === k && (y.onReadyBeingFired = null, y.isBeingOpened = !1);
        }).catch(function(te) {
          y.dbOpenError = te;
          try {
            J && J.abort();
          } catch {
          }
          return k === y.openCanceller && f._close(), Tt(te);
        }).finally(function() {
          y.openComplete = !0, F();
        }).then(function() {
          var te;
          return q && (te = {}, f.tables.forEach(function($) {
            $.schema.indexes.forEach(function(Y) {
              Y.name && (te["idb://".concat(f.name, "/").concat($.name, "/").concat(Y.name)] = new bn(-1 / 0, [[[]]]));
            }), te["idb://".concat(f.name, "/").concat($.name, "/")] = te["idb://".concat(f.name, "/").concat($.name, "/:dels")] = new bn(-1 / 0, [[[]]]);
          }), yn(Wa).fire(te), ls(te, !0)), f;
        });
      }
      function el(f) {
        function y(N) {
          return f.next(N);
        }
        var S = j(y), k = j(function(N) {
          return f.throw(N);
        });
        function j(N) {
          return function(H) {
            var B = N(H), H = B.value;
            return B.done ? H : H && typeof H.then == "function" ? H.then(S, k) : m(H) ? Promise.all(H).then(S, k) : S(H);
          };
        }
        return j(y)();
      }
      function Xr(f, y, S) {
        for (var k = m(f) ? f.slice() : [f], j = 0; j < S; ++j) k.push(y);
        return k;
      }
      var jd = { stack: "dbcore", name: "VirtualIndexMiddleware", level: 1, create: function(f) {
        return l(l({}, f), { table: function(y) {
          var S = f.table(y), k = S.schema, j = {}, N = [];
          function z(q, te, $) {
            var Y = rn(q), Q = j[Y] = j[Y] || [], ee = q == null ? 0 : typeof q == "string" ? 1 : q.length, ae = 0 < te, ae = l(l({}, $), { name: ae ? "".concat(Y, "(virtual-from:").concat($.name, ")") : $.name, lowLevelIndex: $, isVirtual: ae, keyTail: te, keyLength: ee, extractKey: ei(q), unique: !ae && $.unique });
            return Q.push(ae), ae.isPrimaryKey || N.push(ae), 1 < ee && z(ee === 2 ? q[0] : q.slice(0, ee - 1), te + 1, $), Q.sort(function(ue, xe) {
              return ue.keyTail - xe.keyTail;
            }), ae;
          }
          y = z(k.primaryKey.keyPath, 0, k.primaryKey), j[":id"] = [y];
          for (var B = 0, H = k.indexes; B < H.length; B++) {
            var F = H[B];
            z(F.keyPath, 0, F);
          }
          function J(q) {
            var te, $ = q.query.index;
            return $.isVirtual ? l(l({}, q), { query: { index: $.lowLevelIndex, range: (te = q.query.range, $ = $.keyTail, { type: te.type === 1 ? 2 : te.type, lower: Xr(te.lower, te.lowerOpen ? f.MAX_KEY : f.MIN_KEY, $), lowerOpen: !0, upper: Xr(te.upper, te.upperOpen ? f.MIN_KEY : f.MAX_KEY, $), upperOpen: !0 }) } }) : q;
          }
          return l(l({}, S), { schema: l(l({}, k), { primaryKey: y, indexes: N, getIndexByKeyPath: function(q) {
            return (q = j[rn(q)]) && q[0];
          } }), count: function(q) {
            return S.count(J(q));
          }, query: function(q) {
            return S.query(J(q));
          }, openCursor: function(q) {
            var te = q.query.index, $ = te.keyTail, Y = te.isVirtual, Q = te.keyLength;
            return Y ? S.openCursor(J(q)).then(function(ae) {
              return ae && ee(ae);
            }) : S.openCursor(q);
            function ee(ae) {
              return Object.create(ae, { continue: { value: function(ue) {
                ue != null ? ae.continue(Xr(ue, q.reverse ? f.MAX_KEY : f.MIN_KEY, $)) : q.unique ? ae.continue(ae.key.slice(0, Q).concat(q.reverse ? f.MIN_KEY : f.MAX_KEY, $)) : ae.continue();
              } }, continuePrimaryKey: { value: function(ue, xe) {
                ae.continuePrimaryKey(Xr(ue, f.MAX_KEY, $), xe);
              } }, primaryKey: { get: function() {
                return ae.primaryKey;
              } }, key: { get: function() {
                var ue = ae.key;
                return Q === 1 ? ue[0] : ue.slice(0, Q);
              } }, value: { get: function() {
                return ae.value;
              } } });
            }
          } });
        } });
      } };
      function Xl(f, y, S, k) {
        return S = S || {}, k = k || "", d(f).forEach(function(j) {
          var N, z, B;
          x(y, j) ? (N = f[j], z = y[j], typeof N == "object" && typeof z == "object" && N && z ? (B = je(N)) !== je(z) ? S[k + j] = y[j] : B === "Object" ? Xl(N, z, S, k + j + ".") : N !== z && (S[k + j] = y[j]) : N !== z && (S[k + j] = y[j])) : S[k + j] = void 0;
        }), d(y).forEach(function(j) {
          x(f, j) || (S[k + j] = y[j]);
        }), S;
      }
      function Wl(f, y) {
        return y.type === "delete" ? y.keys : y.keys || y.values.map(f.extractKey);
      }
      var Au = { stack: "dbcore", name: "HooksMiddleware", level: 2, create: function(f) {
        return l(l({}, f), { table: function(y) {
          var S = f.table(y), k = S.schema.primaryKey;
          return l(l({}, S), { mutate: function(j) {
            var N = Be.trans, z = N.table(y).hook, B = z.deleting, H = z.creating, F = z.updating;
            switch (j.type) {
              case "add":
                if (H.fire === mt) break;
                return N._promise("readwrite", function() {
                  return J(j);
                }, !0);
              case "put":
                if (H.fire === mt && F.fire === mt) break;
                return N._promise("readwrite", function() {
                  return J(j);
                }, !0);
              case "delete":
                if (B.fire === mt) break;
                return N._promise("readwrite", function() {
                  return J(j);
                }, !0);
              case "deleteRange":
                if (B.fire === mt) break;
                return N._promise("readwrite", function() {
                  return (function q(te, $, Y) {
                    return S.query({ trans: te, values: !1, query: { index: k, range: $ }, limit: Y }).then(function(Q) {
                      var ee = Q.result;
                      return J({ type: "delete", keys: ee, trans: te }).then(function(ae) {
                        return 0 < ae.numFailures ? Promise.reject(ae.failures[0]) : ee.length < Y ? { failures: [], numFailures: 0, lastResult: void 0 } : q(te, l(l({}, $), { lower: ee[ee.length - 1], lowerOpen: !0 }), Y);
                      });
                    });
                  })(j.trans, j.range, 1e4);
                }, !0);
            }
            return S.mutate(j);
            function J(q) {
              var te, $, Y, Q = Be.trans, ee = q.keys || Wl(k, q);
              if (!ee) throw new Error("Keys missing");
              return (q = q.type === "add" || q.type === "put" ? l(l({}, q), { keys: ee }) : l({}, q)).type !== "delete" && (q.values = s([], q.values)), q.keys && (q.keys = s([], q.keys)), te = S, Y = ee, (($ = q).type === "add" ? Promise.resolve([]) : te.getMany({ trans: $.trans, keys: Y, cache: "immutable" })).then(function(ae) {
                var ue = ee.map(function(xe, Ce) {
                  var De, qe, Ae, Le = ae[Ce], Pe = { onerror: null, onsuccess: null };
                  return q.type === "delete" ? B.fire.call(Pe, xe, Le, Q) : q.type === "add" || Le === void 0 ? (De = H.fire.call(Pe, xe, q.values[Ce], Q), xe == null && De != null && (q.keys[Ce] = xe = De, k.outbound || V(q.values[Ce], k.keyPath, xe))) : (De = Xl(Le, q.values[Ce]), (qe = F.fire.call(Pe, De, xe, Le, Q)) && (Ae = q.values[Ce], Object.keys(qe).forEach(function(Me) {
                    x(Ae, Me) ? Ae[Me] = qe[Me] : V(Ae, Me, qe[Me]);
                  }))), Pe;
                });
                return S.mutate(q).then(function(xe) {
                  for (var Ce = xe.failures, De = xe.results, qe = xe.numFailures, xe = xe.lastResult, Ae = 0; Ae < ee.length; ++Ae) {
                    var Le = (De || ee)[Ae], Pe = ue[Ae];
                    Le == null ? Pe.onerror && Pe.onerror(Ce[Ae]) : Pe.onsuccess && Pe.onsuccess(q.type === "put" && ae[Ae] ? q.values[Ae] : Le);
                  }
                  return { failures: Ce, results: De, numFailures: qe, lastResult: xe };
                }).catch(function(xe) {
                  return ue.forEach(function(Ce) {
                    return Ce.onerror && Ce.onerror(xe);
                  }), Promise.reject(xe);
                });
              });
            }
          } });
        } });
      } };
      function os(f, y, S) {
        try {
          if (!y || y.keys.length < f.length) return null;
          for (var k = [], j = 0, N = 0; j < y.keys.length && N < f.length; ++j) ct(y.keys[j], f[N]) === 0 && (k.push(S ? Re(y.values[j]) : y.values[j]), ++N);
          return k.length === f.length ? k : null;
        } catch {
          return null;
        }
      }
      var Mu = { stack: "dbcore", level: -1, create: function(f) {
        return { table: function(y) {
          var S = f.table(y);
          return l(l({}, S), { getMany: function(k) {
            if (!k.cache) return S.getMany(k);
            var j = os(k.keys, k.trans._cache, k.cache === "clone");
            return j ? He.resolve(j) : S.getMany(k).then(function(N) {
              return k.trans._cache = { keys: k.keys, values: k.cache === "clone" ? Re(N) : N }, N;
            });
          }, mutate: function(k) {
            return k.type !== "add" && (k.trans._cache = null), S.mutate(k);
          } });
        } };
      } };
      function Ea(f, y) {
        return f.trans.mode === "readonly" && !!f.subscr && !f.trans.explicit && f.trans.db._options.cache !== "disabled" && !y.schema.primaryKey.outbound;
      }
      function zu(f, y) {
        switch (f) {
          case "query":
            return y.values && !y.unique;
          case "get":
          case "getMany":
          case "count":
          case "openCursor":
            return !1;
        }
      }
      var _d = { stack: "dbcore", level: 0, name: "Observability", create: function(f) {
        var y = f.schema.name, S = new bn(f.MIN_KEY, f.MAX_KEY);
        return l(l({}, f), { transaction: function(k, j, N) {
          if (Be.subscr && j !== "readonly") throw new Ne.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Be.querier));
          return f.transaction(k, j, N);
        }, table: function(k) {
          var j = f.table(k), N = j.schema, z = N.primaryKey, q = N.indexes, B = z.extractKey, H = z.outbound, F = z.autoIncrement && q.filter(function($) {
            return $.compound && $.keyPath.includes(z.keyPath);
          }), J = l(l({}, j), { mutate: function($) {
            function Y(Me) {
              return Me = "idb://".concat(y, "/").concat(k, "/").concat(Me), xe[Me] || (xe[Me] = new bn());
            }
            var Q, ee, ae, ue = $.trans, xe = $.mutatedParts || ($.mutatedParts = {}), Ce = Y(""), De = Y(":dels"), qe = $.type, Pe = $.type === "deleteRange" ? [$.range] : $.type === "delete" ? [$.keys] : $.values.length < 50 ? [Wl(z, $).filter(function(Me) {
              return Me;
            }), $.values] : [], Ae = Pe[0], Le = Pe[1], Pe = $.trans._cache;
            return m(Ae) ? (Ce.addKeys(Ae), (Pe = qe === "delete" || Ae.length === Le.length ? os(Ae, Pe) : null) || De.addKeys(Ae), (Pe || Le) && (Q = Y, ee = Pe, ae = Le, N.indexes.forEach(function(Me) {
              var $e = Q(Me.name || "");
              function We(lt) {
                return lt != null ? Me.extractKey(lt) : null;
              }
              function rt(lt) {
                return Me.multiEntry && m(lt) ? lt.forEach(function(xn) {
                  return $e.addKey(xn);
                }) : $e.addKey(lt);
              }
              (ee || ae).forEach(function(lt, an) {
                var nt = ee && We(ee[an]), an = ae && We(ae[an]);
                ct(nt, an) !== 0 && (nt != null && rt(nt), an != null && rt(an));
              });
            }))) : Ae ? (Le = { from: (Le = Ae.lower) !== null && Le !== void 0 ? Le : f.MIN_KEY, to: (Le = Ae.upper) !== null && Le !== void 0 ? Le : f.MAX_KEY }, De.add(Le), Ce.add(Le)) : (Ce.add(S), De.add(S), N.indexes.forEach(function(Me) {
              return Y(Me.name).add(S);
            })), j.mutate($).then(function(Me) {
              return !Ae || $.type !== "add" && $.type !== "put" || (Ce.addKeys(Me.results), F && F.forEach(function($e) {
                for (var We = $.values.map(function(nt) {
                  return $e.extractKey(nt);
                }), rt = $e.keyPath.findIndex(function(nt) {
                  return nt === z.keyPath;
                }), lt = 0, xn = Me.results.length; lt < xn; ++lt) We[lt][rt] = Me.results[lt];
                Y($e.name).addKeys(We);
              })), ue.mutatedParts = Yl(ue.mutatedParts || {}, xe), Me;
            });
          } }), q = function(Y) {
            var Q = Y.query, Y = Q.index, Q = Q.range;
            return [Y, new bn((Y = Q.lower) !== null && Y !== void 0 ? Y : f.MIN_KEY, (Q = Q.upper) !== null && Q !== void 0 ? Q : f.MAX_KEY)];
          }, te = { get: function($) {
            return [z, new bn($.key)];
          }, getMany: function($) {
            return [z, new bn().addKeys($.keys)];
          }, count: q, query: q, openCursor: q };
          return d(te).forEach(function($) {
            J[$] = function(Y) {
              var Q = Be.subscr, ee = !!Q, ae = Ea(Be, j) && zu($, Y) ? Y.obsSet = {} : Q;
              if (ee) {
                var ue = function(Le) {
                  return Le = "idb://".concat(y, "/").concat(k, "/").concat(Le), ae[Le] || (ae[Le] = new bn());
                }, xe = ue(""), Ce = ue(":dels"), Q = te[$](Y), ee = Q[0], Q = Q[1];
                if (($ === "query" && ee.isPrimaryKey && !Y.values ? Ce : ue(ee.name || "")).add(Q), !ee.isPrimaryKey) {
                  if ($ !== "count") {
                    var De = $ === "query" && H && Y.values && j.query(l(l({}, Y), { values: !1 }));
                    return j[$].apply(this, arguments).then(function(Le) {
                      if ($ === "query") {
                        if (H && Y.values) return De.then(function(We) {
                          return We = We.result, xe.addKeys(We), Le;
                        });
                        var Pe = Y.values ? Le.result.map(B) : Le.result;
                        (Y.values ? xe : Ce).addKeys(Pe);
                      } else if ($ === "openCursor") {
                        var Me = Le, $e = Y.values;
                        return Me && Object.create(Me, { key: { get: function() {
                          return Ce.addKey(Me.primaryKey), Me.key;
                        } }, primaryKey: { get: function() {
                          var We = Me.primaryKey;
                          return Ce.addKey(We), We;
                        } }, value: { get: function() {
                          return $e && xe.addKey(Me.primaryKey), Me.value;
                        } } });
                      }
                      return Le;
                    });
                  }
                  Ce.add(S);
                }
              }
              return j[$].apply(this, arguments);
            };
          }), J;
        } });
      } };
      function Ru(f, y, S) {
        if (S.numFailures === 0) return y;
        if (y.type === "deleteRange") return null;
        var k = y.keys ? y.keys.length : "values" in y && y.values ? y.values.length : 1;
        return S.numFailures === k ? null : (y = l({}, y), m(y.keys) && (y.keys = y.keys.filter(function(j, N) {
          return !(N in S.failures);
        })), "values" in y && m(y.values) && (y.values = y.values.filter(function(j, N) {
          return !(N in S.failures);
        })), y);
      }
      function Zl(f, y) {
        return S = f, ((k = y).lower === void 0 || (k.lowerOpen ? 0 < ct(S, k.lower) : 0 <= ct(S, k.lower))) && (f = f, (y = y).upper === void 0 || (y.upperOpen ? ct(f, y.upper) < 0 : ct(f, y.upper) <= 0));
        var S, k;
      }
      function ss(f, y, te, k, j, N) {
        if (!te || te.length === 0) return f;
        var z = y.query.index, B = z.multiEntry, H = y.query.range, F = k.schema.primaryKey.extractKey, J = z.extractKey, q = (z.lowLevelIndex || z).extractKey, te = te.reduce(function($, Y) {
          var Q = $, ee = [];
          if (Y.type === "add" || Y.type === "put") for (var ae = new bn(), ue = Y.values.length - 1; 0 <= ue; --ue) {
            var xe, Ce = Y.values[ue], De = F(Ce);
            ae.hasKey(De) || (xe = J(Ce), (B && m(xe) ? xe.some(function(Me) {
              return Zl(Me, H);
            }) : Zl(xe, H)) && (ae.addKey(De), ee.push(Ce)));
          }
          switch (Y.type) {
            case "add":
              var qe = new bn().addKeys(y.values ? $.map(function($e) {
                return F($e);
              }) : $), Q = $.concat(y.values ? ee.filter(function($e) {
                return $e = F($e), !qe.hasKey($e) && (qe.addKey($e), !0);
              }) : ee.map(function($e) {
                return F($e);
              }).filter(function($e) {
                return !qe.hasKey($e) && (qe.addKey($e), !0);
              }));
              break;
            case "put":
              var Ae = new bn().addKeys(Y.values.map(function($e) {
                return F($e);
              }));
              Q = $.filter(function($e) {
                return !Ae.hasKey(y.values ? F($e) : $e);
              }).concat(y.values ? ee : ee.map(function($e) {
                return F($e);
              }));
              break;
            case "delete":
              var Le = new bn().addKeys(Y.keys);
              Q = $.filter(function($e) {
                return !Le.hasKey(y.values ? F($e) : $e);
              });
              break;
            case "deleteRange":
              var Pe = Y.range;
              Q = $.filter(function($e) {
                return !Zl(F($e), Pe);
              });
          }
          return Q;
        }, f);
        return te === f ? f : (te.sort(function($, Y) {
          return ct(q($), q(Y)) || ct(F($), F(Y));
        }), y.limit && y.limit < 1 / 0 && (te.length > y.limit ? te.length = y.limit : f.length === y.limit && te.length < y.limit && (j.dirty = !0)), N ? Object.freeze(te) : te);
      }
      function ri(f, y) {
        return ct(f.lower, y.lower) === 0 && ct(f.upper, y.upper) === 0 && !!f.lowerOpen == !!y.lowerOpen && !!f.upperOpen == !!y.upperOpen;
      }
      function tl(f, y) {
        return (function(S, k, j, N) {
          if (S === void 0) return k !== void 0 ? -1 : 0;
          if (k === void 0) return 1;
          if ((k = ct(S, k)) === 0) {
            if (j && N) return 0;
            if (j) return 1;
            if (N) return -1;
          }
          return k;
        })(f.lower, y.lower, f.lowerOpen, y.lowerOpen) <= 0 && 0 <= (function(S, k, j, N) {
          if (S === void 0) return k !== void 0 ? 1 : 0;
          if (k === void 0) return -1;
          if ((k = ct(S, k)) === 0) {
            if (j && N) return 0;
            if (j) return -1;
            if (N) return 1;
          }
          return k;
        })(f.upper, y.upper, f.upperOpen, y.upperOpen);
      }
      function Nd(f, y, S, k) {
        f.subscribers.add(S), k.addEventListener("abort", function() {
          var j, N;
          f.subscribers.delete(S), f.subscribers.size === 0 && (j = f, N = y, setTimeout(function() {
            j.subscribers.size === 0 && fe(N, j);
          }, 3e3));
        });
      }
      var Jl = { stack: "dbcore", level: 0, name: "Cache", create: function(f) {
        var y = f.schema.name;
        return l(l({}, f), { transaction: function(S, k, j) {
          var N, z, B = f.transaction(S, k, j);
          return k === "readwrite" && (z = (N = new AbortController()).signal, j = function(H) {
            return function() {
              if (N.abort(), k === "readwrite") {
                for (var F = /* @__PURE__ */ new Set(), J = 0, q = S; J < q.length; J++) {
                  var te = q[J], $ = Ca["idb://".concat(y, "/").concat(te)];
                  if ($) {
                    var Y = f.table(te), Q = $.optimisticOps.filter(function($e) {
                      return $e.trans === B;
                    });
                    if (B._explicit && H && B.mutatedParts) for (var ee = 0, ae = Object.values($.queries.query); ee < ae.length; ee++) for (var ue = 0, xe = (qe = ae[ee]).slice(); ue < xe.length; ue++) rs((Ae = xe[ue]).obsSet, B.mutatedParts) && (fe(qe, Ae), Ae.subscribers.forEach(function($e) {
                      return F.add($e);
                    }));
                    else if (0 < Q.length) {
                      $.optimisticOps = $.optimisticOps.filter(function($e) {
                        return $e.trans !== B;
                      });
                      for (var Ce = 0, De = Object.values($.queries.query); Ce < De.length; Ce++) for (var qe, Ae, Le, Pe = 0, Me = (qe = De[Ce]).slice(); Pe < Me.length; Pe++) (Ae = Me[Pe]).res != null && B.mutatedParts && (H && !Ae.dirty ? (Le = Object.isFrozen(Ae.res), Le = ss(Ae.res, Ae.req, Q, Y, Ae, Le), Ae.dirty ? (fe(qe, Ae), Ae.subscribers.forEach(function($e) {
                        return F.add($e);
                      })) : Le !== Ae.res && (Ae.res = Le, Ae.promise = He.resolve({ result: Le }))) : (Ae.dirty && fe(qe, Ae), Ae.subscribers.forEach(function($e) {
                        return F.add($e);
                      })));
                    }
                  }
                }
                F.forEach(function($e) {
                  return $e();
                });
              }
            };
          }, B.addEventListener("abort", j(!1), { signal: z }), B.addEventListener("error", j(!1), { signal: z }), B.addEventListener("complete", j(!0), { signal: z })), B;
        }, table: function(S) {
          var k = f.table(S), j = k.schema.primaryKey;
          return l(l({}, k), { mutate: function(N) {
            var z = Be.trans;
            if (j.outbound || z.db._options.cache === "disabled" || z.explicit || z.idbtrans.mode !== "readwrite") return k.mutate(N);
            var B = Ca["idb://".concat(y, "/").concat(S)];
            return B ? (z = k.mutate(N), N.type !== "add" && N.type !== "put" || !(50 <= N.values.length || Wl(j, N).some(function(H) {
              return H == null;
            })) ? (B.optimisticOps.push(N), N.mutatedParts && Ql(N.mutatedParts), z.then(function(H) {
              0 < H.numFailures && (fe(B.optimisticOps, N), (H = Ru(0, N, H)) && B.optimisticOps.push(H), N.mutatedParts && Ql(N.mutatedParts));
            }), z.catch(function() {
              fe(B.optimisticOps, N), N.mutatedParts && Ql(N.mutatedParts);
            })) : z.then(function(H) {
              var F = Ru(0, l(l({}, N), { values: N.values.map(function(J, q) {
                var te;
                return H.failures[q] ? J : (J = (te = j.keyPath) !== null && te !== void 0 && te.includes(".") ? Re(J) : l({}, J), V(J, j.keyPath, H.results[q]), J);
              }) }), H);
              B.optimisticOps.push(F), queueMicrotask(function() {
                return N.mutatedParts && Ql(N.mutatedParts);
              });
            }), z) : k.mutate(N);
          }, query: function(N) {
            if (!Ea(Be, k) || !zu("query", N)) return k.query(N);
            var z = ((F = Be.trans) === null || F === void 0 ? void 0 : F.db._options.cache) === "immutable", q = Be, B = q.requery, H = q.signal, F = (function(Y, Q, ee, ae) {
              var ue = Ca["idb://".concat(Y, "/").concat(Q)];
              if (!ue) return [];
              if (!(Q = ue.queries[ee])) return [null, !1, ue, null];
              var xe = Q[(ae.query ? ae.query.index.name : null) || ""];
              if (!xe) return [null, !1, ue, null];
              switch (ee) {
                case "query":
                  var Ce = xe.find(function(De) {
                    return De.req.limit === ae.limit && De.req.values === ae.values && ri(De.req.query.range, ae.query.range);
                  });
                  return Ce ? [Ce, !0, ue, xe] : [xe.find(function(De) {
                    return ("limit" in De.req ? De.req.limit : 1 / 0) >= ae.limit && (!ae.values || De.req.values) && tl(De.req.query.range, ae.query.range);
                  }), !1, ue, xe];
                case "count":
                  return Ce = xe.find(function(De) {
                    return ri(De.req.query.range, ae.query.range);
                  }), [Ce, !!Ce, ue, xe];
              }
            })(y, S, "query", N), J = F[0], q = F[1], te = F[2], $ = F[3];
            return J && q ? J.obsSet = N.obsSet : (q = k.query(N).then(function(Y) {
              var Q = Y.result;
              if (J && (J.res = Q), z) {
                for (var ee = 0, ae = Q.length; ee < ae; ++ee) Object.freeze(Q[ee]);
                Object.freeze(Q);
              } else Y.result = Re(Q);
              return Y;
            }).catch(function(Y) {
              return $ && J && fe($, J), Promise.reject(Y);
            }), J = { obsSet: N.obsSet, promise: q, subscribers: /* @__PURE__ */ new Set(), type: "query", req: N, dirty: !1 }, $ ? $.push(J) : ($ = [J], (te = te || (Ca["idb://".concat(y, "/").concat(S)] = { queries: { query: {}, count: {} }, objs: /* @__PURE__ */ new Map(), optimisticOps: [], unsignaledParts: {} })).queries.query[N.query.index.name || ""] = $)), Nd(J, $, B, H), J.promise.then(function(Y) {
              return { result: ss(Y.result, N, te == null ? void 0 : te.optimisticOps, k, J, z) };
            });
          } });
        } });
      } };
      function nl(f, y) {
        return new Proxy(f, { get: function(S, k, j) {
          return k === "db" ? y : Reflect.get(S, k, j);
        } });
      }
      var vr = (qt.prototype.version = function(f) {
        if (isNaN(f) || f < 0.1) throw new Ne.Type("Given version is not a positive number");
        if (f = Math.round(10 * f) / 10, this.idbdb || this._state.isBeingOpened) throw new Ne.Schema("Cannot add version when database is open");
        this.verno = Math.max(this.verno, f);
        var y = this._versions, S = y.filter(function(k) {
          return k._cfg.version === f;
        })[0];
        return S || (S = new this.Version(f), y.push(S), y.sort(Wo), S.stores({}), this._state.autoSchema = !1, S);
      }, qt.prototype._whenReady = function(f) {
        var y = this;
        return this.idbdb && (this._state.openComplete || Be.letThrough || this._vip) ? f() : new He(function(S, k) {
          if (y._state.openComplete) return k(new Ne.DatabaseClosed(y._state.dbOpenError));
          if (!y._state.isBeingOpened) {
            if (!y._state.autoOpen) return void k(new Ne.DatabaseClosed());
            y.open().catch(mt);
          }
          y._state.dbReadyPromise.then(S, k);
        }).then(f);
      }, qt.prototype.use = function(f) {
        var y = f.stack, S = f.create, k = f.level, j = f.name;
        return j && this.unuse({ stack: y, name: j }), f = this._middlewares[y] || (this._middlewares[y] = []), f.push({ stack: y, create: S, level: k ?? 10, name: j }), f.sort(function(N, z) {
          return N.level - z.level;
        }), this;
      }, qt.prototype.unuse = function(f) {
        var y = f.stack, S = f.name, k = f.create;
        return y && this._middlewares[y] && (this._middlewares[y] = this._middlewares[y].filter(function(j) {
          return k ? j.create !== k : !!S && j.name !== S;
        })), this;
      }, qt.prototype.open = function() {
        var f = this;
        return rr(Kt, function() {
          return Ed(f);
        });
      }, qt.prototype._close = function() {
        this.on.close.fire(new CustomEvent("close"));
        var f = this._state, y = ga.indexOf(this);
        if (0 <= y && ga.splice(y, 1), this.idbdb) {
          try {
            this.idbdb.close();
          } catch {
          }
          this.idbdb = null;
        }
        f.isBeingOpened || (f.dbReadyPromise = new He(function(S) {
          f.dbReadyResolve = S;
        }), f.openCanceller = new He(function(S, k) {
          f.cancelOpen = k;
        }));
      }, qt.prototype.close = function(S) {
        var y = (S === void 0 ? { disableAutoOpen: !0 } : S).disableAutoOpen, S = this._state;
        y ? (S.isBeingOpened && S.cancelOpen(new Ne.DatabaseClosed()), this._close(), S.autoOpen = !1, S.dbOpenError = new Ne.DatabaseClosed()) : (this._close(), S.autoOpen = this._options.autoOpen || S.isBeingOpened, S.openComplete = !1, S.dbOpenError = null);
      }, qt.prototype.delete = function(f) {
        var y = this;
        f === void 0 && (f = { disableAutoOpen: !0 });
        var S = 0 < arguments.length && typeof arguments[0] != "object", k = this._state;
        return new He(function(j, N) {
          function z() {
            y.close(f);
            var B = y._deps.indexedDB.deleteDatabase(y.name);
            B.onsuccess = Ot(function() {
              var H, F, J;
              H = y._deps, F = y.name, J = H.indexedDB, H = H.IDBKeyRange, Vl(J) || F === $i || Jo(J, H).delete(F).catch(mt), j();
            }), B.onerror = ir(N), B.onblocked = y._fireOnBlocked;
          }
          if (S) throw new Ne.InvalidArgument("Invalid closeOptions argument to db.delete()");
          k.isBeingOpened ? k.dbReadyPromise.then(z) : z();
        });
      }, qt.prototype.backendDB = function() {
        return this.idbdb;
      }, qt.prototype.isOpen = function() {
        return this.idbdb !== null;
      }, qt.prototype.hasBeenClosed = function() {
        var f = this._state.dbOpenError;
        return f && f.name === "DatabaseClosed";
      }, qt.prototype.hasFailed = function() {
        return this._state.dbOpenError !== null;
      }, qt.prototype.dynamicallyOpened = function() {
        return this._state.autoSchema;
      }, Object.defineProperty(qt.prototype, "tables", { get: function() {
        var f = this;
        return d(this._allTables).map(function(y) {
          return f._allTables[y];
        });
      }, enumerable: !1, configurable: !0 }), qt.prototype.transaction = function() {
        var f = (function(y, S, k) {
          var j = arguments.length;
          if (j < 2) throw new Ne.InvalidArgument("Too few arguments");
          for (var N = new Array(j - 1); --j; ) N[j - 1] = arguments[j];
          return k = N.pop(), [y, X(N), k];
        }).apply(this, arguments);
        return this._transaction.apply(this, f);
      }, qt.prototype._transaction = function(f, y, S) {
        var k = this, j = Be.trans;
        j && j.db === this && f.indexOf("!") === -1 || (j = null);
        var N, z, B = f.indexOf("?") !== -1;
        f = f.replace("!", "").replace("?", "");
        try {
          if (z = y.map(function(F) {
            if (F = F instanceof k.Table ? F.name : F, typeof F != "string") throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");
            return F;
          }), f == "r" || f === Rr) N = Rr;
          else {
            if (f != "rw" && f != Kr) throw new Ne.InvalidArgument("Invalid transaction mode: " + f);
            N = Kr;
          }
          if (j) {
            if (j.mode === Rr && N === Kr) {
              if (!B) throw new Ne.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");
              j = null;
            }
            j && z.forEach(function(F) {
              if (j && j.storeNames.indexOf(F) === -1) {
                if (!B) throw new Ne.SubTransaction("Table " + F + " not included in parent transaction.");
                j = null;
              }
            }), B && j && !j.active && (j = null);
          }
        } catch (F) {
          return j ? j._promise(null, function(J, q) {
            q(F);
          }) : Tt(F);
        }
        var H = (function F(J, q, te, $, Y) {
          return He.resolve().then(function() {
            var Q = Be.transless || Be, ee = J._createTransaction(q, te, J._dbSchema, $);
            if (ee.explicit = !0, Q = { trans: ee, transless: Q }, $) ee.idbtrans = $.idbtrans;
            else try {
              ee.create(), ee.idbtrans._explicit = !0, J._state.PR1398_maxLoop = 3;
            } catch (xe) {
              return xe.name === me.InvalidState && J.isOpen() && 0 < --J._state.PR1398_maxLoop ? (console.warn("Dexie: Need to reopen db"), J.close({ disableAutoOpen: !1 }), J.open().then(function() {
                return F(J, q, te, null, Y);
              })) : Tt(xe);
            }
            var ae, ue = L(Y);
            return ue && Wt(), Q = He.follow(function() {
              var xe;
              (ae = Y.call(ee, ee)) && (ue ? (xe = In.bind(null, null), ae.then(xe, xe)) : typeof ae.next == "function" && typeof ae.throw == "function" && (ae = el(ae)));
            }, Q), (ae && typeof ae.then == "function" ? He.resolve(ae).then(function(xe) {
              return ee.active ? xe : Tt(new Ne.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"));
            }) : Q.then(function() {
              return ae;
            })).then(function(xe) {
              return $ && ee._resolve(), ee._completion.then(function() {
                return xe;
              });
            }).catch(function(xe) {
              return ee._reject(xe), Tt(xe);
            });
          });
        }).bind(null, this, N, z, j, S);
        return j ? j._promise(N, H, "lock") : Be.trans ? rr(Be.transless, function() {
          return k._whenReady(H);
        }) : this._whenReady(H);
      }, qt.prototype.table = function(f) {
        if (!x(this._allTables, f)) throw new Ne.InvalidTable("Table ".concat(f, " does not exist"));
        return this._allTables[f];
      }, qt);
      function qt(f, y) {
        var S = this;
        this._middlewares = {}, this.verno = 0;
        var k = qt.dependencies;
        this._options = y = l({ addons: qt.addons, autoOpen: !0, indexedDB: k.indexedDB, IDBKeyRange: k.IDBKeyRange, cache: "cloned" }, y), this._deps = { indexedDB: y.indexedDB, IDBKeyRange: y.IDBKeyRange }, k = y.addons, this._dbSchema = {}, this._versions = [], this._storeNames = [], this._allTables = {}, this.idbdb = null, this._novip = this;
        var j, N, z, B, H, F = { dbOpenError: null, isBeingOpened: !1, onReadyBeingFired: null, openComplete: !1, dbReadyResolve: mt, dbReadyPromise: null, cancelOpen: mt, openCanceller: null, autoSchema: !0, PR1398_maxLoop: 3, autoOpen: y.autoOpen };
        F.dbReadyPromise = new He(function(q) {
          F.dbReadyResolve = q;
        }), F.openCanceller = new He(function(q, te) {
          F.cancelOpen = te;
        }), this._state = F, this.name = f, this.on = Ki(this, "populate", "blocked", "versionchange", "close", { ready: [Hr, mt] }), this.once = function(q, te) {
          var $ = function() {
            for (var Y = [], Q = 0; Q < arguments.length; Q++) Y[Q] = arguments[Q];
            S.on(q).unsubscribe($), te.apply(S, Y);
          };
          return S.on(q, $);
        }, this.on.ready.subscribe = K(this.on.ready.subscribe, function(q) {
          return function(te, $) {
            qt.vip(function() {
              var Y, Q = S._state;
              Q.openComplete ? (Q.dbOpenError || He.resolve().then(te), $ && q(te)) : Q.onReadyBeingFired ? (Q.onReadyBeingFired.push(te), $ && q(te)) : (q(te), Y = S, $ || q(function ee() {
                Y.on.ready.unsubscribe(te), Y.on.ready.unsubscribe(ee);
              }));
            });
          };
        }), this.Collection = (j = this, gn(wd.prototype, function(ae, ee) {
          this.db = j;
          var $ = Go, Y = null;
          if (ee) try {
            $ = ee();
          } catch (ue) {
            Y = ue;
          }
          var Q = ae._ctx, ee = Q.table, ae = ee.hook.reading.fire;
          this._ctx = { table: ee, index: Q.index, isPrimKey: !Q.index || ee.schema.primKey.keyPath && Q.index === ee.schema.primKey.name, range: $, keysOnly: !1, dir: "next", unique: "", algorithm: null, filter: null, replayFilter: null, justLimit: !0, isMatch: null, offset: 0, limit: 1 / 0, error: Y, or: Q.or, valueMapper: ae !== qr ? ae : null };
        })), this.Table = (N = this, gn(Vo.prototype, function(q, te, $) {
          this.db = N, this._tx = $, this.name = q, this.schema = te, this.hook = N._allTables[q] ? N._allTables[q].hook : Ki(null, { creating: [Ga, mt], reading: [Mr, qr], updating: [zl, mt], deleting: [Ml, mt] });
        })), this.Transaction = (z = this, gn(Xo.prototype, function(q, te, $, Y, Q) {
          var ee = this;
          q !== "readonly" && te.forEach(function(ae) {
            ae = (ae = $[ae]) === null || ae === void 0 ? void 0 : ae.yProps, ae && (te = te.concat(ae.map(function(ue) {
              return ue.updatesTable;
            })));
          }), this.db = z, this.mode = q, this.storeNames = te, this.schema = $, this.chromeTransactionDurability = Y, this.idbtrans = null, this.on = Ki(this, "complete", "error", "abort"), this.parent = Q || null, this.active = !0, this._reculock = 0, this._blockedFuncs = [], this._resolve = null, this._reject = null, this._waitingFor = null, this._waitingQueue = null, this._spinCount = 0, this._completion = new He(function(ae, ue) {
            ee._resolve = ae, ee._reject = ue;
          }), this._completion.then(function() {
            ee.active = !1, ee.on.complete.fire();
          }, function(ae) {
            var ue = ee.active;
            return ee.active = !1, ee.on.error.fire(ae), ee.parent ? ee.parent._reject(ae) : ue && ee.idbtrans && ee.idbtrans.abort(), Tt(ae);
          });
        })), this.Version = (B = this, gn(Cd.prototype, function(q) {
          this.db = B, this._cfg = { version: q, storesSource: null, dbschema: {}, tables: {}, contentUpgrade: null };
        })), this.WhereClause = (H = this, gn(xa.prototype, function(q, te, $) {
          if (this.db = H, this._ctx = { table: q, index: te === ":id" ? null : te, or: $ }, this._cmp = this._ascending = ct, this._descending = function(Y, Q) {
            return ct(Q, Y);
          }, this._max = function(Y, Q) {
            return 0 < ct(Y, Q) ? Y : Q;
          }, this._min = function(Y, Q) {
            return ct(Y, Q) < 0 ? Y : Q;
          }, this._IDBKeyRange = H._deps.IDBKeyRange, !this._IDBKeyRange) throw new Ne.MissingAPI();
        })), this.on("versionchange", function(q) {
          0 < q.newVersion ? console.warn("Another connection wants to upgrade database '".concat(S.name, "'. Closing db now to resume the upgrade.")) : console.warn("Another connection wants to delete database '".concat(S.name, "'. Closing db now to resume the delete request.")), S.close({ disableAutoOpen: !1 });
        }), this.on("blocked", function(q) {
          !q.newVersion || q.newVersion < q.oldVersion ? console.warn("Dexie.delete('".concat(S.name, "') was blocked")) : console.warn("Upgrade '".concat(S.name, "' blocked by other connection holding version ").concat(q.oldVersion / 10));
        }), this._maxKey = Ja(y.IDBKeyRange), this._createTransaction = function(q, te, $, Y) {
          return new S.Transaction(q, te, $, S._options.chromeTransactionDurability, Y);
        }, this._fireOnBlocked = function(q) {
          S.on("blocked").fire(q), ga.filter(function(te) {
            return te.name === S.name && te !== S && !te._state.vcFired;
          }).map(function(te) {
            return te.on("versionchange").fire(q);
          });
        }, this.use(Mu), this.use(Jl), this.use(_d), this.use(jd), this.use(Au);
        var J = new Proxy(this, { get: function(q, te, $) {
          if (te === "_vip") return !0;
          if (te === "table") return function(Q) {
            return nl(S.table(Q), J);
          };
          var Y = Reflect.get(q, te, $);
          return Y instanceof Vo ? nl(Y, J) : te === "tables" ? Y.map(function(Q) {
            return nl(Q, J);
          }) : te === "_createTransaction" ? function() {
            return nl(Y.apply(this, arguments), J);
          } : Y;
        } });
        this.vip = J, k.forEach(function(q) {
          return q(S);
        });
      }
      var ai, Pn = typeof Symbol < "u" && "observable" in Symbol ? Symbol.observable : "@@observable", Ou = (eo.prototype.subscribe = function(f, y, S) {
        return this._subscribe(f && typeof f != "function" ? f : { next: f, error: y, complete: S });
      }, eo.prototype[Pn] = function() {
        return this;
      }, eo);
      function eo(f) {
        this._subscribe = f;
      }
      try {
        ai = { indexedDB: c.indexedDB || c.mozIndexedDB || c.webkitIndexedDB || c.msIndexedDB, IDBKeyRange: c.IDBKeyRange || c.webkitIDBKeyRange };
      } catch {
        ai = { indexedDB: null, IDBKeyRange: null };
      }
      function Du(f) {
        var y, S = !1, k = new Ou(function(j) {
          var N = L(f), z, B = !1, H = {}, F = {}, J = { get closed() {
            return B;
          }, unsubscribe: function() {
            B || (B = !0, z && z.abort(), q && yn.storagemutated.unsubscribe($));
          } };
          j.start && j.start(J);
          var q = !1, te = function() {
            return Vr(Y);
          }, $ = function(Q) {
            Yl(H, Q), rs(F, H) && te();
          }, Y = function() {
            var Q, ee, ae;
            !B && ai.indexedDB && (H = {}, Q = {}, z && z.abort(), z = new AbortController(), ae = (function(ue) {
              var xe = Fr();
              try {
                N && Wt();
                var Ce = Bt(f, ue);
                return Ce = N ? Ce.finally(In) : Ce;
              } finally {
                xe && gr();
              }
            })(ee = { subscr: Q, signal: z.signal, requery: te, querier: f, trans: null }), Promise.resolve(ae).then(function(ue) {
              S = !0, y = ue, B || ee.signal.aborted || (H = {}, (function(xe) {
                for (var Ce in xe) if (x(xe, Ce)) return;
                return 1;
              })(F = Q) || q || (yn(Wa, $), q = !0), Vr(function() {
                return !B && j.next && j.next(ue);
              }));
            }, function(ue) {
              S = !1, ["DatabaseClosedError", "AbortError"].includes(ue == null ? void 0 : ue.name) || B || Vr(function() {
                B || j.error && j.error(ue);
              });
            }));
          };
          return setTimeout(te, 0), J;
        });
        return k.hasValue = function() {
          return S;
        }, k.getValue = function() {
          return y;
        }, k;
      }
      var ja = vr;
      function us(f) {
        var y = Wr;
        try {
          Wr = !0, yn.storagemutated.fire(f), ls(f, !0);
        } finally {
          Wr = y;
        }
      }
      E(ja, l(l({}, tn), { delete: function(f) {
        return new ja(f, { addons: [] }).delete();
      }, exists: function(f) {
        return new ja(f, { addons: [] }).open().then(function(y) {
          return y.close(), !0;
        }).catch("NoSuchDatabaseError", function() {
          return !1;
        });
      }, getDatabaseNames: function(f) {
        try {
          return y = ja.dependencies, S = y.indexedDB, y = y.IDBKeyRange, (Vl(S) ? Promise.resolve(S.databases()).then(function(k) {
            return k.map(function(j) {
              return j.name;
            }).filter(function(j) {
              return j !== $i;
            });
          }) : Jo(S, y).toCollection().primaryKeys()).then(f);
        } catch {
          return Tt(new Ne.MissingAPI());
        }
        var y, S;
      }, defineClass: function() {
        return function(f) {
          g(this, f);
        };
      }, ignoreTransaction: function(f) {
        return Be.trans ? rr(Be.transless, f) : f();
      }, vip: es, async: function(f) {
        return function() {
          try {
            var y = el(f.apply(this, arguments));
            return y && typeof y.then == "function" ? y : He.resolve(y);
          } catch (S) {
            return Tt(S);
          }
        };
      }, spawn: function(f, y, S) {
        try {
          var k = el(f.apply(S, y || []));
          return k && typeof k.then == "function" ? k : He.resolve(k);
        } catch (j) {
          return Tt(j);
        }
      }, currentTransaction: { get: function() {
        return Be.trans || null;
      } }, waitFor: function(f, y) {
        return y = He.resolve(typeof f == "function" ? ja.ignoreTransaction(f) : f).timeout(y || 6e4), Be.trans ? Be.trans.waitFor(y) : y;
      }, Promise: He, debug: { get: function() {
        return Tn;
      }, set: function(f) {
        Rl(f);
      } }, derive: A, extend: g, props: E, override: K, Events: Ki, on: yn, liveQuery: Du, extendObservabilitySet: Yl, getByKeyPath: I, setByKeyPath: V, delByKeyPath: function(f, y) {
        typeof y == "string" ? V(f, y, void 0) : "length" in y && [].map.call(y, function(S) {
          V(f, S, void 0);
        });
      }, shallowClone: we, deepClone: Re, getObjectDiff: Xl, cmp: ct, asap: de, minKey: -1 / 0, addons: [], connections: ga, errnames: me, dependencies: ai, cache: Ca, semVer: "4.2.1", version: "4.2.1".split(".").map(function(f) {
        return parseInt(f);
      }).reduce(function(f, y, S) {
        return f + y / Math.pow(10, 2 * S);
      }) })), ja.maxKey = Ja(ja.dependencies.IDBKeyRange), typeof dispatchEvent < "u" && typeof addEventListener < "u" && (yn(Wa, function(f) {
        Wr || (f = new CustomEvent(Sa, { detail: f }), Wr = !0, dispatchEvent(f), Wr = !1);
      }), addEventListener(Sa, function(f) {
        f = f.detail, Wr || us(f);
      }));
      var ii, Wr = !1, zn = function() {
      };
      return typeof BroadcastChannel < "u" && ((zn = function() {
        (ii = new BroadcastChannel(Sa)).onmessage = function(f) {
          return f.data && us(f.data);
        };
      })(), typeof ii.unref == "function" && ii.unref(), yn(Wa, function(f) {
        Wr || ii.postMessage(f);
      })), typeof addEventListener < "u" && (addEventListener("pagehide", function(f) {
        if (!vr.disableBfCache && f.persisted) {
          Tn && console.debug("Dexie: handling persisted pagehide"), ii != null && ii.close();
          for (var y = 0, S = ga; y < S.length; y++) S[y].close({ disableAutoOpen: !1 });
        }
      }), addEventListener("pageshow", function(f) {
        !vr.disableBfCache && f.persisted && (Tn && console.debug("Dexie: handling persisted pageshow"), zn(), us({ all: new bn(-1 / 0, [[]]) }));
      })), He.rejectionMapper = function(f, y) {
        return !f || f instanceof M || f instanceof TypeError || f instanceof SyntaxError || !f.name || !Rt[f.name] ? f : (y = new Rt[f.name](y || f.message, f), "stack" in f && _(y, "stack", { get: function() {
          return this.inner.stack;
        } }), y);
      }, Rl(Tn), l(vr, Object.freeze({ __proto__: null, Dexie: vr, liveQuery: Du, Entity: wu, cmp: ct, PropModification: Xa, replacePrefix: function(f, y) {
        return new Xa({ replacePrefix: [f, y] });
      }, add: function(f) {
        return new Xa({ add: f });
      }, remove: function(f) {
        return new Xa({ remove: f });
      }, default: vr, RangeSet: bn, mergeRanges: ka, rangesOverlap: _u }), { default: vr }), vr;
    });
  })(Vc)), Vc.exports;
}
var i6 = a6();
const lm = /* @__PURE__ */ Nl(i6), G1 = Symbol.for("Dexie"), su = globalThis[G1] || (globalThis[G1] = lm);
if (lm.semVer !== su.semVer)
  throw new Error(`Two different versions of Dexie loaded in the same app: ${lm.semVer} and ${su.semVer}`);
const {
  liveQuery: QE,
  mergeRanges: XE,
  rangesOverlap: WE,
  RangeSet: ZE,
  cmp: JE,
  Entity: ej,
  PropModification: tj,
  replacePrefix: nj,
  add: rj,
  remove: aj,
  DexieYProvider: ij
} = su;
class Rb extends su {
  constructor(a) {
    super(`Engram_${a}`);
    Xe(this, "events");
    Xe(this, "entities");
    Xe(this, "meta");
    this.version(1).stores({
      // Events: 
      events: "id, timestamp, significance_score, level",
      // Entities: 
      entities: "id, type, name",
      // Meta:  (lastSummarizedFloor )
      meta: "key"
    });
  }
}
const wl = /* @__PURE__ */ new Map();
function kl(t) {
  if (!t)
    throw new Error("[Engram DB] chatId is required");
  return wl.has(t) || (console.debug(`[Engram DB] Creating database for chat: ${t}`), wl.set(t, new Rb(t))), wl.get(t);
}
function Ob(t) {
  const r = wl.get(t);
  r && (r.close(), wl.delete(t), console.debug(`[Engram DB] Closed database for chat: ${t}`));
}
function l6(t) {
  return wl.has(t);
}
function Li(t) {
  return wl.get(t) || null;
}
async function o6(t) {
  Ob(t), await su.delete(`Engram_${t}`), console.info(`[Engram DB] Deleted database for chat: ${t}`);
}
const s6 = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  ChatDatabase: Rb,
  closeDb: Ob,
  deleteDatabase: o6,
  getDbForChat: kl,
  hasDbForChat: l6,
  tryGetDbForChat: Li
}, Symbol.toStringTag, { value: "Module" }));
class u6 {
  async search(r) {
    const a = r.toLowerCase().trim();
    if (!a || a.length < 2) return [];
    const l = Dn();
    if (!l) return [];
    const s = Li(l);
    if (!s) return [];
    try {
      return (await s.events.filter((d) => d.summary.toLowerCase().includes(a)).reverse().limit(5).toArray()).map((d) => ({
        id: `memory-${d.id}`,
        type: "memory",
        title: d.summary.slice(0, 50) + (d.summary.length > 50 ? "..." : ""),
        description: new Date(d.timestamp).toLocaleString(),
        icon: mu,
        action: (m) => m("/memory"),
        // TODO: Nav to specific item?
        score: 5
        // Lower score than exact commands
      }));
    } catch (c) {
      return console.error("Memory search failed", c), [];
    }
  }
}
class c6 {
  async search(r) {
    const a = r.toLowerCase().trim();
    if (!a) return [];
    const l = [];
    return (Ke.get("promptTemplates") || []).forEach((c) => {
      c.name.toLowerCase().includes(a) && l.push({
        id: `template-${c.id}`,
        type: "setting",
        // or 'template'
        title: `: ${c.name}`,
        description: `Prompt Template (${c.category})`,
        icon: mu,
        action: (d) => d("presets:prompt"),
        // Ideally navigates to specific template
        score: 7
      });
    }), l;
  }
}
window.__ENGRAM_SEARCH_INIT__ || (zo.registerAdapter(new zb()), zo.registerAdapter(new Z5()), zo.registerAdapter(new J5()), zo.registerAdapter(new u6()), zo.registerAdapter(new c6()), window.__ENGRAM_SEARCH_INIT__ = !0);
const d6 = ({ onNavigate: t }) => {
  const [r, a] = U.useState(""), [l, s] = U.useState(!1), [c, d] = U.useState(0), [m, g] = U.useState([]), p = U.useRef(null);
  U.useEffect(() => {
    (async () => {
      if (!r.trim()) {
        const A = await new zb().search("");
        g(A);
        return;
      }
      const _ = await zo.search(r);
      g(_), d(0);
    })();
  }, [r, l]), U.useEffect(() => {
    const w = (_) => {
      (_.metaKey || _.ctrlKey) && _.key === "k" && (_.preventDefault(), s(!0));
    };
    return window.addEventListener("keydown", w), () => window.removeEventListener("keydown", w);
  }, []), U.useEffect(() => {
    l && setTimeout(() => {
      var w;
      return (w = p.current) == null ? void 0 : w.focus();
    }, 50);
  }, [l]);
  const v = (w) => {
    const _ = m.length + (r ? 1 : 0);
    switch (w.key) {
      case "ArrowDown":
        w.preventDefault(), d((A) => (A + 1) % _);
        break;
      case "ArrowUp":
        w.preventDefault(), d((A) => (A - 1 + _) % _);
        break;
      case "Enter":
        w.preventDefault(), x();
        break;
      case "Escape":
        s(!1);
        break;
    }
  }, x = () => {
    m.length > 0 && c < m.length ? m[c].action(t) : r && (console.log("Searching memory for:", r), t("/memory")), s(!1), a("");
  }, E = /* @__PURE__ */ u.jsx(
    "div",
    {
      className: "fixed inset-0 flex items-start justify-center pt-[15vh] px-4 animate-in fade-in duration-200",
      style: {
        height: "100dvh",
        width: "100vw",
        backgroundColor: "rgba(0,0,0,0.4)",
        // Slightly more transparent to not feel too heavy
        backdropFilter: "var(--glass-backdrop-filter, blur(4px))",
        zIndex: 2147483647
        // Max safe integer to ensure it's on top of SillyTavern UI
      },
      onClick: (w) => {
        w.target === w.currentTarget && s(!1);
      },
      children: /* @__PURE__ */ u.jsxs(
        "div",
        {
          className: "w-full max-w-xl border border-border rounded-xl shadow-2xl overflow-hidden flex flex-col animate-in zoom-in-95 slide-in-from-top-4 duration-200",
          style: {
            backgroundColor: "var(--popover)",
            color: "var(--popover-foreground)",
            backdropFilter: "var(--glass-backdrop-filter)",
            maxHeight: "70vh"
          },
          children: [
            /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-3 px-4 py-3 border-b border-border/50", children: [
              /* @__PURE__ */ u.jsx(sa, { size: 20, className: "text-muted-foreground shrink-0" }),
              /* @__PURE__ */ u.jsx(
                "input",
                {
                  ref: p,
                  type: "text",
                  className: "flex-1 bg-transparent border-none outline-none text-lg text-foreground placeholder:text-muted-foreground/50",
                  placeholder: "...",
                  value: r,
                  onChange: (w) => a(w.target.value),
                  onKeyDown: v
                }
              ),
              /* @__PURE__ */ u.jsx("div", { className: "text-[10px] text-muted-foreground border border-border px-1.5 py-0.5 rounded bg-muted/50 hidden sm:block", children: "ESC" })
            ] }),
            /* @__PURE__ */ u.jsxs("div", { className: "overflow-y-auto p-2 scroll-smooth", children: [
              m.length > 0 && /* @__PURE__ */ u.jsx("div", { className: "space-y-1", children: m.map((w, _) => /* @__PURE__ */ u.jsxs(
                "div",
                {
                  className: `flex items-center gap-3 px-3 py-2.5 rounded-lg cursor-pointer transition-colors ${_ === c ? "bg-primary/10 text-primary" : "text-foreground hover:bg-muted/50"}`,
                  onClick: () => {
                    w.action(t), s(!1), a("");
                  },
                  onMouseEnter: () => d(_),
                  children: [
                    /* @__PURE__ */ u.jsx("div", { className: `
                                        w-8 h-8 rounded-md flex items-center justify-center shrink-0
                                        ${_ === c ? "bg-primary/20" : "bg-muted/50 text-muted-foreground"}
                                    `, children: w.icon ? /* @__PURE__ */ u.jsx(w.icon, { size: 16 }) : /* @__PURE__ */ u.jsx(w1, { size: 16 }) }),
                    /* @__PURE__ */ u.jsxs("div", { className: "flex-1 min-w-0", children: [
                      /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-2", children: [
                        /* @__PURE__ */ u.jsx("span", { className: "text-sm font-medium", children: w.title }),
                        w.type !== "command" && /* @__PURE__ */ u.jsx("span", { className: "text-[10px] px-1.5 py-0.5 rounded-full bg-muted text-muted-foreground uppercase", children: w.type })
                      ] }),
                      w.description && /* @__PURE__ */ u.jsx("div", { className: "text-xs text-muted-foreground/80 truncate", children: w.description })
                    ] }),
                    _ === c && /* @__PURE__ */ u.jsx(k1, { size: 16, className: "text-muted-foreground/50" })
                  ]
                },
                w.id
              )) }),
              r && /* @__PURE__ */ u.jsxs(
                "div",
                {
                  className: `
                            mt-2 pt-2 border-t border-border/50
                            flex items-center gap-3 px-3 py-2.5 rounded-lg cursor-pointer transition-colors
                            ${c === m.length ? "bg-primary/10 text-primary" : "text-foreground hover:bg-muted/50"}
                        `,
                  onClick: () => x(),
                  onMouseEnter: () => d(m.length),
                  children: [
                    /* @__PURE__ */ u.jsx("div", { className: `w-8 h-8 rounded-md flex items-center justify-center shrink-0 ${c === m.length ? "bg-primary/20" : "bg-muted/50 text-muted-foreground"}`, children: /* @__PURE__ */ u.jsx(sa, { size: 16 }) }),
                    /* @__PURE__ */ u.jsxs("div", { className: "flex-1 min-w-0", children: [
                      /* @__PURE__ */ u.jsxs("div", { className: "text-sm font-medium", children: [
                        ': "',
                        /* @__PURE__ */ u.jsx("span", { className: "text-primary", children: r }),
                        '"'
                      ] }),
                      /* @__PURE__ */ u.jsx("div", { className: "text-xs text-muted-foreground/80", children: "..." })
                    ] }),
                    c === m.length && /* @__PURE__ */ u.jsx(k1, { size: 16, className: "text-muted-foreground/50" })
                  ]
                }
              ),
              m.length === 0 && !r && /* @__PURE__ */ u.jsxs("div", { className: "px-4 py-8 text-center text-muted-foreground text-sm", children: [
                /* @__PURE__ */ u.jsx(w1, { size: 32, className: "mx-auto mb-2 opacity-20" }),
                /* @__PURE__ */ u.jsx("p", { children: " (Cmd+K)" })
              ] })
            ] })
          ]
        }
      )
    }
  );
  return /* @__PURE__ */ u.jsxs(u.Fragment, { children: [
    /* @__PURE__ */ u.jsx(
      "button",
      {
        onClick: () => s(!0),
        className: "p-2 rounded-md hover:bg-accent hover:text-accent-foreground transition-colors text-muted-foreground",
        title: " (Cmd+K)",
        children: /* @__PURE__ */ u.jsx(sa, { size: 20 })
      }
    ),
    l && Bm.createPortal(E, document.body)
  ] });
}, f6 = ({ className: t = "", size: r = 24 }) => /* @__PURE__ */ u.jsx(
  "svg",
  {
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 400 592",
    width: r,
    height: r,
    className: t,
    "aria-label": "Engram Icon",
    children: /* @__PURE__ */ u.jsx(
      "path",
      {
        fill: "currentColor",
        d: `M103.875908,522.166260 
                C75.225380,521.276611 55.289425,503.229828 52.249313,475.852142 
                C49.879883,454.514191 63.027035,433.000366 83.930901,424.858398 
                C88.449257,423.098541 89.857674,420.860199 89.801926,416.150269 
                C89.555420,395.322357 89.621246,374.489380 89.762306,353.659515 
                C89.787170,349.987000 88.728760,348.057556 85.120293,346.642609 
                C64.672897,338.625031 52.338894,320.951630 52.085896,299.869415 
                C51.832878,278.785156 63.730618,260.903198 84.118019,252.449951 
                C88.288918,250.720566 89.867378,248.680847 89.807304,244.052597 
                C89.539139,223.391968 89.589142,202.724701 89.796356,182.062561 
                C89.836380,178.071609 88.518524,176.326385 84.841705,174.787247 
                C57.730556,163.438416 45.530682,135.966721 55.436111,109.194000 
                C62.627293,89.757439 81.922821,76.710289 103.282494,76.841476 
                C124.355003,76.970901 143.082275,89.740875 149.993118,109.121849 
                C151.315979,112.831749 153.184799,113.869263 156.863403,113.853104 
                C186.192612,113.724319 215.522736,113.698357 244.851929,113.811600 
                C248.773117,113.826736 250.677307,112.652130 252.052902,108.765602 
                C259.013885,89.098465 278.589447,76.365829 300.503601,76.811897 
                C322.171844,77.252960 341.040283,91.132324 347.255371,111.201912 
                C356.569763,141.279358 340.344788,170.373184 309.893127,176.623123 
                C283.359375,182.068970 260.376740,167.450562 251.980011,145.670181 
                C250.492157,141.810806 248.818085,140.240295 244.552948,140.266785 
                C215.390915,140.447968 186.227219,140.357330 157.064072,140.375076 
                C154.628784,140.376556 151.855545,139.805771 151.141357,143.359161 
                C150.400787,147.043839 146.628937,150.064713 151.136917,154.478546 
                C184.592346,187.235229 217.778336,220.267349 250.982285,253.280014 
                C253.021469,255.307434 254.527191,255.254166 257.033264,254.047714 
                C276.199188,244.820953 294.752930,247.045853 310.978485,259.993408 
                C328.011017,273.584869 333.936798,292.106659 327.764038,313.282837 
                C321.779785,333.812378 307.254517,345.637268 286.367889,349.037231 
                C276.405396,350.658997 266.352570,349.443024 257.275055,344.363342 
                C254.265045,342.678986 252.301132,343.049744 249.903275,345.441406 
                C230.205368,365.088531 210.395386,384.623230 190.631638,404.204376 
                C177.732651,416.984222 164.859726,429.790344 151.962982,442.572388 
                C148.257980,446.244415 148.113403,452.901764 151.629196,456.671387 
                C152.707138,457.827148 154.029282,457.681976 155.328629,457.681946 
                C185.658203,457.681458 215.987854,457.631042 246.317261,457.695557 
                C249.355972,457.702026 250.687012,456.399414 251.717636,453.698944 
                C259.314423,433.793579 278.324493,420.868317 299.341309,421.146240 
                C320.526215,421.426361 339.575745,434.206421 346.686249,452.909271 
                C354.337341,473.034058 348.794159,495.642761 332.699371,509.956390 
                C307.061371,532.757202 263.380280,521.715210 251.978027,489.436371 
                C250.838303,486.209961 249.371201,484.953583 245.964813,484.962799 
                C216.302094,485.043304 186.639008,484.985840 156.976028,484.969330 
                C154.436981,484.967896 152.081528,484.923981 150.916916,488.054077 
                C142.892441,509.621246 126.842339,520.325989 103.875908,522.166260 
                M141.430466,266.110352 
                C145.394760,270.906738 148.503693,276.196198 150.388428,282.139069 
                C151.211502,284.734314 152.692291,285.770782 155.494156,285.760895 
                C179.139755,285.677429 202.787949,285.547394 226.430206,285.843811 
                C232.373352,285.918304 231.388184,281.058533 233.335602,278.254700 
                C235.007233,275.847992 233.916855,274.189880 232.000244,272.304352 
                C199.956863,240.780380 167.866821,209.301468 136.133682,177.467056 
                C131.183243,172.500824 127.483856,170.729507 121.013550,174.621368 
                C117.660522,176.638214 116.183739,178.155136 116.217278,182.042480 
                C116.398239,203.022598 116.444160,224.006012 116.243645,244.985474 
                C116.204666,249.064667 117.676285,250.918961 121.328865,252.228989 
                C128.972488,254.970444 135.505173,259.524170 141.430466,266.110352 
                M116.349434,377.499908 
                C116.351860,390.663696 116.870338,403.855377 116.161102,416.980713 
                C115.742699,424.723846 121.926743,423.801880 125.649162,426.262665 
                C129.080231,428.530792 130.798965,425.706268 132.741440,423.784821 
                C165.551407,391.329803 198.234940,358.745361 231.274231,326.525696 
                C235.764252,322.147095 232.377243,319.155212 231.599960,315.493317 
                C230.884583,312.123138 228.193359,312.382568 225.670288,312.382812 
                C202.675171,312.384949 179.679749,312.445435 156.685303,312.323212 
                C153.331955,312.305389 151.624329,313.386505 150.456299,316.584381 
                C145.119888,331.194611 135.004120,341.287384 120.496223,346.769958 
                C117.238434,348.001068 116.190170,349.706024 116.267418,353.006317 
                C116.450615,360.833862 116.340004,368.668243 116.349434,377.499908z`
      }
    )
  }
), h6 = ({
  onToggleSidebar: t,
  isMobile: r,
  // Deprecated prop, handled by CSS
  onClose: a,
  onNavigate: l
}) => /* @__PURE__ */ u.jsxs("header", { className: "h-10 flex items-center justify-between px-4 bg-transparent z-50 transition-all duration-300 w-full flex-shrink-0", children: [
  /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-3 w-16 md:w-64", children: [
    /* @__PURE__ */ u.jsx(
      "button",
      {
        className: "p-2 -ml-2 rounded-md hover:bg-sidebar-accent hover:text-sidebar-accent-foreground transition-colors md:hidden",
        onClick: t,
        title: "",
        children: /* @__PURE__ */ u.jsx(t3, { size: 18 })
      }
    ),
    /* @__PURE__ */ u.jsxs("div", { className: "hidden md:flex items-center gap-2", children: [
      /* @__PURE__ */ u.jsx(f6, { size: 18, className: "text-primary" }),
      /* @__PURE__ */ u.jsx("span", { className: "font-semibold text-sidebar-foreground tracking-tight", children: "Engram" })
    ] })
  ] }),
  /* @__PURE__ */ u.jsx("div", { className: "flex-1" }),
  /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-1 md:gap-2", children: [
    /* @__PURE__ */ u.jsx(d6, { onNavigate: l }),
    /* @__PURE__ */ u.jsx("div", { className: "h-4 w-[1px] bg-border mx-1" }),
    /* @__PURE__ */ u.jsx(
      "button",
      {
        className: "p-2 rounded-md hover:bg-destructive hover:text-destructive-foreground transition-colors text-muted-foreground",
        onClick: a,
        title: "",
        children: /* @__PURE__ */ u.jsx(Uo, { size: 20 })
      }
    )
  ] })
] }), m6 = ({ className: t = "", height: r = 24 }) => {
  const a = Math.round(r * 3.17);
  return /* @__PURE__ */ u.jsxs(
    "svg",
    {
      xmlns: "http://www.w3.org/2000/svg",
      viewBox: "235 175 555 175",
      width: a,
      height: r,
      className: t,
      "aria-label": "Engram",
      children: [
        /* @__PURE__ */ u.jsx("path", { fill: "currentColor", d: "M752.3,294.5c-0.2-11.8-0.3-23.1-0.4-34.4c0-2.7,0-5.3-0.2-8c-0.6-6.4-4.1-10.1-9.8-10.9 c-6.9-0.9-12.2,2-14.5,7.9c-1,2.5-1.2,5.2-1.2,7.9c0,11,-0.3,22,0,33c0.1,5.2-1.7,6.9-6.7,6.4c-3.3-0.3-6.7-0.3-10,0 c-4.9,0.5-5.9-1.9-5.8-6.2c0.2-11.8,0.2-23.7,0-35.5c-0.2-9.4-5.4-14.3-14.1-13.5c-6.4,0.6-11.1,5.7-11.3,13 c-0.3,11.7-0.2,23.3-0.3,35c0,7.1,0,7.1-7.3,7.1c-3.3,0-6.7-0.1-10,0c-3.3,0.1-4.9-1.1-4.9-4.6c0.1-21.5,0-43-0.1-64.5 c0-2.9,1.3-4.3,4.2-4.3c3.2,0,6.3-0.1,9.5,0.1c4,0,8.8-1,7.5,6.6c8.6-6.1,16.9-8.7,26.3-7c5.2,1,10.1,2.7,13.7,6.6 c2.8,2.9,4.6,2.4,7.4,0c6.8-5.8,15-7.9,23.8-6.9c16.3,1.8,25.1,11.7,25.8,29.5c0.5,13.3,0.1,26.6,0.2,40 c0,3.4-1.2,5.1-4.7,4.7C763.8,295.7,757.9,298,752.3,294.5z" }),
        /* @__PURE__ */ u.jsx("path", { fill: "currentColor", d: "M463.1,324.1c-10.8-0.7-20.9-2.4-30.2-7.5c-3.6-2-5-4-2.4-7.8c2.3-3.4,4.1-7.1,6.5-11.3 c6.1,3.6,11.8,6.8,18.5,7.7c5.3,0.7,10.6,1.1,15.8-0.5c8.3-2.6,12.2-9.1,10.9-18.6c-9.1,7.5-19.3,8.6-30.2,6.4 c-7.8-1.6-14.2-5.6-19.2-11.8c-10.5-12.8-10.6-32.5-0.5-45.5c11.2-14.3,28.6-16.4,50.9-6.1c-0.4-6.2,3.5-6.3,8.1-6.2 c13,0.2,13,0.1,13,13c0,16.3-0.5,32.7,0.1,49C505.4,309.3,491.3,322.1,467.6,324C466.2,324.1,464.9,324.1,463.1,324.1z M482.1,252.6 c-0.6-2.1-1.6-4-3-5.7c-4.6-6-13.5-8.4-21.2-5.5c-7.4,2.7-11.1,8.9-10.6,17.8c0.4,7.4,5.7,13.5,13.6,15.2 C474.1,277.2,485.2,266.4,482.1,252.6z" }),
        /* @__PURE__ */ u.jsx("path", { fill: "currentColor", d: "M258.1,201.6c20.3,0,40.1,0.1,60-0.1c4.5,0,6.3,1.3,6.1,5.9c-0.4,14.6,2.1,12.6-12.7,12.7 c-10.7,0.1-21.3,0.1-32-0.1c-3.8-0.1-5.2,1-5.3,5.1c0,13.4-0.2,13.4,13.4,13.4c8.7,0,17.3,0.1,26,0c3.4-0.1,4.7,1.2,4.7,4.7 c-0.2,16.4,1.9,13.7-13.1,13.9c-8.8,0.1-17.7,0.1-26.5,0c-3.2,0-4.6,1.1-4.4,4.4c0.2,3.8,0.2,7.7,0,11.5 c-0.2,3.5,1.1,4.7,4.6,4.7c13.7-0.1,27.3,0.2,41-0.1c5.1-0.1,6.6,1.5,6.5,6.5c-0.2,12.3,0,12.3-12.1,12.3 c-18.7-0.1-37.3-0.2-56,0c-4.9,0.1-6.7-1.2-6.7-6.4c0.2-27.5,0.2-55,0-82.5C251.6,203,253,200.9,258.1,201.6z" }),
        /* @__PURE__ */ u.jsx("path", { fill: "currentColor", d: "M599.5,239.6c-5.6,0.9-10.6,2.1-15,4.9c-2.5,1.6-4,0.9-5.1-1.6c-0.9-2-1.9-3.9-2.9-5.8 c-3.1-6.1-3-6.4,3-9.3c11.6-5.6,23.9-7.1,36.5-4.6c15.1,2.9,23.6,12.8,24.1,28.7c0.4,13.3,0.1,26.6,0.2,40 c0,3.5-1.5,4.8-4.8,4.6c-3,0-6,0-9,0.1c-4.2,0.2-8.1,0.2-6.6-6.6c-12.4,9.5-24.9,10.4-37.7,3.9c-8.5-4.3-11.9-12-11.3-21.2 c0.6-9.1,5.9-15,14.4-17.9c5.7-1.9,11.6-2.8,17.7-2.8c4.6,0,9.3,0.5,13.8-0.4c1.9-7.2-7.4-13.5-17.2-11.9 M617.7,271.9 c-0.1-2.5,1-5.8-3.3-5.8c-5,0-10-0.1-15,0.2c-4,0.3-6.9,2.4-7.1,6.9c-0.2,4.5,2.2,7.2,6.3,8.4C606.5,283.8,613.8,280.3,617.7,271.9z" }),
        /* @__PURE__ */ u.jsx("path", { fill: "currentColor", d: "M346.2,222.9c2.6,0,4.8,0.1,7,0c4.7-0.4,8.1,0.7,7,7.3c6-4,11.6-7.1,18.2-7.9c18.2-2.1,34.8,7.7,35,29.4 c0.1,13.2-0.1,26.3,0.1,39.5c0,3.9-1.2,5.5-5.2,5.2c-4,0-8,0-12,0.2c-3.5,0.2-4.7-1.3-4.7-4.7c0.1-10.3,0.1-20.7,0-31 c0-2.3-0.1-4.7-0.5-7c-1.3-8.4-5.4-12.3-12.9-12.6c-8.4-0.3-14.3,3.9-16,11.9c-2,9.6-0.7,19.3-0.9,28.9 c-0.2,14.4,0,14.4-14.4,14.4c-7.8,0-7.9,0-7.9-8c0-19.5,0-39,0-58.5C339,223.3,339.2,223.2,346.2,222.9z" }),
        /* @__PURE__ */ u.jsx("path", { fill: "currentColor", d: "M543.2,258.4c-0.1,11.1-0.3,21.8-0.2,32.4c0,4-1.2,5.9-5.4,5.6c-4.3-0.3-8.7-0.1-13-0.1 c-2.7,0-3.9-1.3-3.9-4c0-21.8,0-43.6,0-65.5c0-2.8,1.3-3.9,3.9-4c2.8,0,5.7,0,8.5-0.1c4.8-0.2,9.6-0.5,8.7,6.4 c2.1,0.8,2.8-0.7,3.9-1.3c2.3-1.2,4.5-2.8,7-3.8c11.8-4.7,14.3-3,14.3,9.3c0,0.8-0.1,1.7,0,2.5c0.6,4.6-1,6.4-6,6.5 C550,242.6,544.8,247.5,543.2,258.4z" })
      ]
    }
  );
}, p6 = "0.8.5", Db = {
  version: p6
}, V1 = ({
  activeTab: t,
  onNavigate: r,
  isMobile: a,
  isOpen: l = !1,
  onClose: s,
  onShowUpdateNotice: c,
  hasUnreadUpdate: d
}) => {
  const m = (p) => {
    r(p), a && s && s();
  }, g = () => /* @__PURE__ */ u.jsxs("div", { className: "pt-4 border-t border-border/30 mt-2 space-y-2", children: [
    /* @__PURE__ */ u.jsxs(
      "button",
      {
        onClick: c,
        className: "w-full flex items-center gap-2 px-2 py-1.5 rounded-lg transition-all duration-200 text-muted-foreground hover:text-foreground hover:bg-muted/10 text-left",
        children: [
          /* @__PURE__ */ u.jsxs("div", { className: "relative", children: [
            /* @__PURE__ */ u.jsx(Wv, { size: 16, strokeWidth: 1.5 }),
            d && /* @__PURE__ */ u.jsx("span", { className: "absolute -top-1 -right-1 w-2 h-2 bg-red-500 rounded-full animate-pulse" })
          ] }),
          /* @__PURE__ */ u.jsx("span", { className: "text-xs", children: "" }),
          d && /* @__PURE__ */ u.jsx("span", { className: "ml-auto text-[10px] px-1.5 py-0.5 bg-primary/20 text-primary rounded-full", children: "NEW" })
        ]
      }
    ),
    /* @__PURE__ */ u.jsxs(
      "a",
      {
        href: "https://github.com/shiyue137mh-netizen/Engram",
        target: "_blank",
        rel: "noopener noreferrer",
        className: "group w-full flex items-center gap-2 px-2 py-1.5 rounded-lg transition-all duration-200 text-muted-foreground hover:text-foreground hover:bg-muted/10",
        title: "",
        children: [
          /* @__PURE__ */ u.jsx(L4, { size: 16, strokeWidth: 1.5, className: "group-hover:text-primary transition-colors" }),
          /* @__PURE__ */ u.jsx("span", { className: "text-xs", children: "GitHub" }),
          /* @__PURE__ */ u.jsx("span", { className: "ml-auto text-[10px] text-primary opacity-0 group-hover:opacity-100 transition-opacity", children: "Star " })
        ]
      }
    ),
    /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-2 px-2 py-1 opacity-50", children: [
      /* @__PURE__ */ u.jsx(m6, { height: 12 }),
      /* @__PURE__ */ u.jsxs("span", { className: "text-[10px] text-muted-foreground font-mono", children: [
        "v",
        Db.version
      ] })
    ] })
  ] });
  return a && !l ? null : a ? /* @__PURE__ */ u.jsxs(
    "div",
    {
      className: "fixed inset-0 z-[60] flex justify-start",
      style: { height: "100dvh", width: "100vw" },
      children: [
        /* @__PURE__ */ u.jsx(
          "div",
          {
            className: "absolute inset-0 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",
            onClick: s
          }
        ),
        /* @__PURE__ */ u.jsxs(
          "div",
          {
            id: "mobile-menu-drawer",
            className: "relative w-64 max-w-[80vw] h-full bg-sidebar border-r border-border shadow-2xl flex flex-col p-6 animate-in slide-in-from-left duration-300",
            style: { height: "100dvh" },
            children: [
              /* @__PURE__ */ u.jsxs("div", { className: "flex justify-between items-center mb-8", children: [
                /* @__PURE__ */ u.jsx("span", { className: "text-lg font-semibold text-sidebar-foreground/80", children: "" }),
                /* @__PURE__ */ u.jsx(
                  "button",
                  {
                    onClick: s,
                    className: "p-2 -mr-2 rounded-md hover:bg-sidebar-accent text-muted-foreground hover:text-sidebar-accent-foreground transition-colors",
                    children: /* @__PURE__ */ u.jsx(Uo, { size: 20 })
                  }
                )
              ] }),
              /* @__PURE__ */ u.jsx("nav", { className: "space-y-2 flex-1 overflow-y-auto", children: Jh.map((p) => {
                const v = p.icon, x = t === p.id;
                return /* @__PURE__ */ u.jsxs(
                  "button",
                  {
                    onClick: () => m(p.id),
                    className: `
                                    w-full flex items-center gap-4 px-4 py-3 rounded-xl text-left transition-all duration-200
                                    ${x ? "bg-primary/10 text-primary font-medium" : "text-muted-foreground hover:bg-sidebar-accent hover:text-sidebar-foreground"}
                                `,
                    children: [
                      /* @__PURE__ */ u.jsx(v, { size: 22, className: x ? "text-primary" : "text-muted-foreground/70" }),
                      /* @__PURE__ */ u.jsx("span", { children: p.label })
                    ]
                  },
                  p.id
                );
              }) }),
              /* @__PURE__ */ u.jsx("div", { className: "mt-auto", children: /* @__PURE__ */ u.jsx(g, {}) })
            ]
          }
        )
      ]
    }
  ) : /* @__PURE__ */ u.jsxs("aside", { className: "[display:none] md:flex w-36 flex-shrink-0 bg-sidebar flex-col z-40 pt-4 px-2 border-r border-border/50 animate-in slide-in-from-left-4 fade-in duration-500 fill-mode-both", style: { animationDelay: "100ms", animationFillMode: "both" }, children: [
    /* @__PURE__ */ u.jsx("nav", { className: "flex-1 w-full flex flex-col gap-1 overflow-y-auto no-scrollbar", children: Jh.map((p) => {
      const v = p.icon, x = t === p.id;
      return /* @__PURE__ */ u.jsxs(
        "button",
        {
          onClick: () => m(p.id),
          className: `
                                    w-full flex items-center gap-2 px-2 py-2 rounded-lg transition-all duration-200 text-left
                                    ${x ? "bg-primary/10 text-primary" : "text-muted-foreground hover:text-foreground hover:bg-muted/10"}
                                `,
          children: [
            /* @__PURE__ */ u.jsx(v, { size: 18, strokeWidth: x ? 2 : 1.5, className: "flex-shrink-0" }),
            /* @__PURE__ */ u.jsx("span", { className: `text-xs ${x ? "font-medium" : "font-normal"}`, children: p.label })
          ]
        },
        p.id
      );
    }) }),
    /* @__PURE__ */ u.jsx("div", { className: "pb-3", children: /* @__PURE__ */ u.jsx(g, {}) })
  ] });
}, Lc = {
  timeOut: 5e3,
  extendedTimeOut: 1e3,
  closeButton: !0,
  progressBar: !0
}, bl = class bl {
  constructor() {
  }
  static getInstance() {
    return bl.instance || (bl.instance = new bl()), bl.instance;
  }
  /**
   *  toastr 
   */
  getToastr() {
    return window.toastr || null;
  }
  /**
   * 
   */
  success(r, a = "Engram", l = {}) {
    const s = this.getToastr();
    s ? s.success(r, a, { ...Lc, ...l }) : console.log(`[Engram] SUCCESS: ${a} - ${r}`), W.info("Notification", `Success: ${r}`);
  }
  /**
   * 
   */
  info(r, a = "Engram", l = {}) {
    const s = this.getToastr();
    s ? s.info(r, a, { ...Lc, ...l }) : console.log(`[Engram] INFO: ${a} - ${r}`), W.info("Notification", `Info: ${r}`);
  }
  /**
   * 
   */
  warning(r, a = "Engram", l = {}) {
    const s = this.getToastr();
    s ? s.warning(r, a, { ...Lc, ...l }) : console.warn(`[Engram] WARNING: ${a} - ${r}`), W.warn("Notification", `Warning: ${r}`);
  }
  /**
   * 
   */
  error(r, a = "Engram", l = {}) {
    const s = this.getToastr();
    s ? s.error(r, a, { ...Lc, timeOut: 8e3, ...l }) : console.error(`[Engram] ERROR: ${a} - ${r}`), W.error("Notification", `Error: ${r}`);
  }
  /**
   * 
   * @param message 
   * @param title 
   * @param onCancel 
   * @returns toastr 
   */
  running(r, a = "Engram", l) {
    const s = this.getToastr();
    if (s) {
      const c = l ? `${r} <small style="opacity:0.7">()</small>` : r;
      return s.info(c, a, {
        timeOut: 2e4,
        //  20 
        extendedTimeOut: 0,
        // 
        closeButton: !1,
        // 
        progressBar: !0,
        // 
        tapToDismiss: !!l,
        // 
        onclick: l ? () => {
          W.info("Notification", ""), l();
        } : void 0,
        escapeHtml: !1
        //  HTML
      });
    } else
      return console.log(`[Engram] RUNNING: ${a} - ${r}`), null;
  }
  /**
   *  toastr 
   */
  remove(r) {
    const a = this.getToastr();
    a && r && a.remove(r);
  }
  /**
   * 
   */
  clear() {
    const r = this.getToastr();
    r && r.clear();
  }
};
Xe(bl, "instance");
let om = bl;
const wt = om.getInstance(), jo = {
  owner: "shiyue137mh-netizen",
  repo: "Engram",
  branch: "master"
}, Bc = Db.version;
let Vs = null, Ks = null;
function jh(t, r) {
  const a = t.split(".").map(Number), l = r.split(".").map(Number);
  for (let s = 0; s < Math.max(a.length, l.length); s++) {
    const c = a[s] || 0, d = l[s] || 0;
    if (c > d) return 1;
    if (c < d) return -1;
  }
  return 0;
}
class Ai {
  /**
   * 
   */
  static getCurrentVersion() {
    return Bc;
  }
  /**
   *  GitHub 
   */
  static async getLatestVersion() {
    if (Vs)
      return Vs;
    try {
      const r = `https://raw.githubusercontent.com/${jo.owner}/${jo.repo}/${jo.branch}/manifest.json`, a = await fetch(r);
      return a.ok ? (Vs = (await a.json()).version || null, Vs) : null;
    } catch {
      return null;
    }
  }
  /**
   * 
   */
  static async hasUpdate() {
    const r = await this.getLatestVersion();
    return r ? jh(r, Bc) > 0 : !1;
  }
  /**
   * 
   */
  static async getChangelog() {
    if (Ks)
      return Ks;
    try {
      const r = `https://raw.githubusercontent.com/${jo.owner}/${jo.repo}/${jo.branch}/CHANGELOG.md`, a = await fetch(r);
      return a.ok ? (Ks = await a.text(), Ks) : (console.warn("[Engram] UpdateService: ", a.status), wt.warning(`: ${a.status}`, ""), null);
    } catch (r) {
      return console.error("[Engram] UpdateService: ", r), wt.error("", ""), null;
    }
  }
  /**
   * 
   */
  static getReadVersion() {
    try {
      return Ke.get("lastReadVersion") || "0.0.0";
    } catch {
      return "0.0.0";
    }
  }
  /**
   * 
   */
  static async markAsRead(r) {
    const a = r || await this.getLatestVersion() || Bc;
    try {
      Ke.set("lastReadVersion", a), console.debug("[Engram] UpdateService: ", a);
    } catch (l) {
      console.error("[Engram] UpdateService: ", l);
    }
  }
  /**
   * 
   */
  static async hasUnreadUpdate() {
    const r = await this.getLatestVersion();
    if (!r || jh(r, Bc) <= 0)
      return !1;
    const a = this.getReadVersion();
    return jh(r, a) > 0;
  }
  /**
   * 
   */
  static clearCache() {
    Vs = null, Ks = null;
  }
}
function g6(t, r) {
  const a = {};
  return (t[t.length - 1] === "" ? [...t, ""] : t).join(
    (a.padRight ? " " : "") + "," + (a.padLeft === !1 ? "" : " ")
  ).trim();
}
const y6 = /^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u, b6 = /^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u, x6 = {};
function K1(t, r) {
  return (x6.jsx ? b6 : y6).test(t);
}
const v6 = /[ \t\n\f\r]/g;
function S6(t) {
  return typeof t == "object" ? t.type === "text" ? Y1(t.value) : !1 : Y1(t);
}
function Y1(t) {
  return t.replace(v6, "") === "";
}
class yu {
  /**
   * @param {SchemaType['property']} property
   *   Property.
   * @param {SchemaType['normal']} normal
   *   Normal.
   * @param {Space | undefined} [space]
   *   Space.
   * @returns
   *   Schema.
   */
  constructor(r, a, l) {
    this.normal = a, this.property = r, l && (this.space = l);
  }
}
yu.prototype.normal = {};
yu.prototype.property = {};
yu.prototype.space = void 0;
function Lb(t, r) {
  const a = {}, l = {};
  for (const s of t)
    Object.assign(a, s.property), Object.assign(l, s.normal);
  return new yu(a, l, r);
}
function sm(t) {
  return t.toLowerCase();
}
class nr {
  /**
   * @param {string} property
   *   Property.
   * @param {string} attribute
   *   Attribute.
   * @returns
   *   Info.
   */
  constructor(r, a) {
    this.attribute = a, this.property = r;
  }
}
nr.prototype.attribute = "";
nr.prototype.booleanish = !1;
nr.prototype.boolean = !1;
nr.prototype.commaOrSpaceSeparated = !1;
nr.prototype.commaSeparated = !1;
nr.prototype.defined = !1;
nr.prototype.mustUseProperty = !1;
nr.prototype.number = !1;
nr.prototype.overloadedBoolean = !1;
nr.prototype.property = "";
nr.prototype.spaceSeparated = !1;
nr.prototype.space = void 0;
let w6 = 0;
const ut = Al(), dn = Al(), um = Al(), ze = Al(), It = Al(), Lo = Al(), fr = Al();
function Al() {
  return 2 ** ++w6;
}
const cm = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  boolean: ut,
  booleanish: dn,
  commaOrSpaceSeparated: fr,
  commaSeparated: Lo,
  number: ze,
  overloadedBoolean: um,
  spaceSeparated: It
}, Symbol.toStringTag, { value: "Module" })), _h = (
  /** @type {ReadonlyArray<keyof typeof types>} */
  Object.keys(cm)
);
class $m extends nr {
  /**
   * @constructor
   * @param {string} property
   *   Property.
   * @param {string} attribute
   *   Attribute.
   * @param {number | null | undefined} [mask]
   *   Mask.
   * @param {Space | undefined} [space]
   *   Space.
   * @returns
   *   Info.
   */
  constructor(r, a, l, s) {
    let c = -1;
    if (super(r, a), Q1(this, "space", s), typeof l == "number")
      for (; ++c < _h.length; ) {
        const d = _h[c];
        Q1(this, _h[c], (l & cm[d]) === cm[d]);
      }
  }
}
$m.prototype.defined = !0;
function Q1(t, r, a) {
  a && (t[r] = a);
}
function Po(t) {
  const r = {}, a = {};
  for (const [l, s] of Object.entries(t.properties)) {
    const c = new $m(
      l,
      t.transform(t.attributes || {}, l),
      s,
      t.space
    );
    t.mustUseProperty && t.mustUseProperty.includes(l) && (c.mustUseProperty = !0), r[l] = c, a[sm(l)] = l, a[sm(c.attribute)] = l;
  }
  return new yu(r, a, t.space);
}
const Bb = Po({
  properties: {
    ariaActiveDescendant: null,
    ariaAtomic: dn,
    ariaAutoComplete: null,
    ariaBusy: dn,
    ariaChecked: dn,
    ariaColCount: ze,
    ariaColIndex: ze,
    ariaColSpan: ze,
    ariaControls: It,
    ariaCurrent: null,
    ariaDescribedBy: It,
    ariaDetails: null,
    ariaDisabled: dn,
    ariaDropEffect: It,
    ariaErrorMessage: null,
    ariaExpanded: dn,
    ariaFlowTo: It,
    ariaGrabbed: dn,
    ariaHasPopup: null,
    ariaHidden: dn,
    ariaInvalid: null,
    ariaKeyShortcuts: null,
    ariaLabel: null,
    ariaLabelledBy: It,
    ariaLevel: ze,
    ariaLive: null,
    ariaModal: dn,
    ariaMultiLine: dn,
    ariaMultiSelectable: dn,
    ariaOrientation: null,
    ariaOwns: It,
    ariaPlaceholder: null,
    ariaPosInSet: ze,
    ariaPressed: dn,
    ariaReadOnly: dn,
    ariaRelevant: null,
    ariaRequired: dn,
    ariaRoleDescription: It,
    ariaRowCount: ze,
    ariaRowIndex: ze,
    ariaRowSpan: ze,
    ariaSelected: dn,
    ariaSetSize: ze,
    ariaSort: null,
    ariaValueMax: ze,
    ariaValueMin: ze,
    ariaValueNow: ze,
    ariaValueText: null,
    role: null
  },
  transform(t, r) {
    return r === "role" ? r : "aria-" + r.slice(4).toLowerCase();
  }
});
function Ib(t, r) {
  return r in t ? t[r] : r;
}
function Ub(t, r) {
  return Ib(t, r.toLowerCase());
}
const k6 = Po({
  attributes: {
    acceptcharset: "accept-charset",
    classname: "class",
    htmlfor: "for",
    httpequiv: "http-equiv"
  },
  mustUseProperty: ["checked", "multiple", "muted", "selected"],
  properties: {
    // Standard Properties.
    abbr: null,
    accept: Lo,
    acceptCharset: It,
    accessKey: It,
    action: null,
    allow: null,
    allowFullScreen: ut,
    allowPaymentRequest: ut,
    allowUserMedia: ut,
    alt: null,
    as: null,
    async: ut,
    autoCapitalize: null,
    autoComplete: It,
    autoFocus: ut,
    autoPlay: ut,
    blocking: It,
    capture: null,
    charSet: null,
    checked: ut,
    cite: null,
    className: It,
    cols: ze,
    colSpan: null,
    content: null,
    contentEditable: dn,
    controls: ut,
    controlsList: It,
    coords: ze | Lo,
    crossOrigin: null,
    data: null,
    dateTime: null,
    decoding: null,
    default: ut,
    defer: ut,
    dir: null,
    dirName: null,
    disabled: ut,
    download: um,
    draggable: dn,
    encType: null,
    enterKeyHint: null,
    fetchPriority: null,
    form: null,
    formAction: null,
    formEncType: null,
    formMethod: null,
    formNoValidate: ut,
    formTarget: null,
    headers: It,
    height: ze,
    hidden: um,
    high: ze,
    href: null,
    hrefLang: null,
    htmlFor: It,
    httpEquiv: It,
    id: null,
    imageSizes: null,
    imageSrcSet: null,
    inert: ut,
    inputMode: null,
    integrity: null,
    is: null,
    isMap: ut,
    itemId: null,
    itemProp: It,
    itemRef: It,
    itemScope: ut,
    itemType: It,
    kind: null,
    label: null,
    lang: null,
    language: null,
    list: null,
    loading: null,
    loop: ut,
    low: ze,
    manifest: null,
    max: null,
    maxLength: ze,
    media: null,
    method: null,
    min: null,
    minLength: ze,
    multiple: ut,
    muted: ut,
    name: null,
    nonce: null,
    noModule: ut,
    noValidate: ut,
    onAbort: null,
    onAfterPrint: null,
    onAuxClick: null,
    onBeforeMatch: null,
    onBeforePrint: null,
    onBeforeToggle: null,
    onBeforeUnload: null,
    onBlur: null,
    onCancel: null,
    onCanPlay: null,
    onCanPlayThrough: null,
    onChange: null,
    onClick: null,
    onClose: null,
    onContextLost: null,
    onContextMenu: null,
    onContextRestored: null,
    onCopy: null,
    onCueChange: null,
    onCut: null,
    onDblClick: null,
    onDrag: null,
    onDragEnd: null,
    onDragEnter: null,
    onDragExit: null,
    onDragLeave: null,
    onDragOver: null,
    onDragStart: null,
    onDrop: null,
    onDurationChange: null,
    onEmptied: null,
    onEnded: null,
    onError: null,
    onFocus: null,
    onFormData: null,
    onHashChange: null,
    onInput: null,
    onInvalid: null,
    onKeyDown: null,
    onKeyPress: null,
    onKeyUp: null,
    onLanguageChange: null,
    onLoad: null,
    onLoadedData: null,
    onLoadedMetadata: null,
    onLoadEnd: null,
    onLoadStart: null,
    onMessage: null,
    onMessageError: null,
    onMouseDown: null,
    onMouseEnter: null,
    onMouseLeave: null,
    onMouseMove: null,
    onMouseOut: null,
    onMouseOver: null,
    onMouseUp: null,
    onOffline: null,
    onOnline: null,
    onPageHide: null,
    onPageShow: null,
    onPaste: null,
    onPause: null,
    onPlay: null,
    onPlaying: null,
    onPopState: null,
    onProgress: null,
    onRateChange: null,
    onRejectionHandled: null,
    onReset: null,
    onResize: null,
    onScroll: null,
    onScrollEnd: null,
    onSecurityPolicyViolation: null,
    onSeeked: null,
    onSeeking: null,
    onSelect: null,
    onSlotChange: null,
    onStalled: null,
    onStorage: null,
    onSubmit: null,
    onSuspend: null,
    onTimeUpdate: null,
    onToggle: null,
    onUnhandledRejection: null,
    onUnload: null,
    onVolumeChange: null,
    onWaiting: null,
    onWheel: null,
    open: ut,
    optimum: ze,
    pattern: null,
    ping: It,
    placeholder: null,
    playsInline: ut,
    popover: null,
    popoverTarget: null,
    popoverTargetAction: null,
    poster: null,
    preload: null,
    readOnly: ut,
    referrerPolicy: null,
    rel: It,
    required: ut,
    reversed: ut,
    rows: ze,
    rowSpan: ze,
    sandbox: It,
    scope: null,
    scoped: ut,
    seamless: ut,
    selected: ut,
    shadowRootClonable: ut,
    shadowRootDelegatesFocus: ut,
    shadowRootMode: null,
    shape: null,
    size: ze,
    sizes: null,
    slot: null,
    span: ze,
    spellCheck: dn,
    src: null,
    srcDoc: null,
    srcLang: null,
    srcSet: null,
    start: ze,
    step: null,
    style: null,
    tabIndex: ze,
    target: null,
    title: null,
    translate: null,
    type: null,
    typeMustMatch: ut,
    useMap: null,
    value: dn,
    width: ze,
    wrap: null,
    writingSuggestions: null,
    // Legacy.
    // See: https://html.spec.whatwg.org/#other-elements,-attributes-and-apis
    align: null,
    // Several. Use CSS `text-align` instead,
    aLink: null,
    // `<body>`. Use CSS `a:active {color}` instead
    archive: It,
    // `<object>`. List of URIs to archives
    axis: null,
    // `<td>` and `<th>`. Use `scope` on `<th>`
    background: null,
    // `<body>`. Use CSS `background-image` instead
    bgColor: null,
    // `<body>` and table elements. Use CSS `background-color` instead
    border: ze,
    // `<table>`. Use CSS `border-width` instead,
    borderColor: null,
    // `<table>`. Use CSS `border-color` instead,
    bottomMargin: ze,
    // `<body>`
    cellPadding: null,
    // `<table>`
    cellSpacing: null,
    // `<table>`
    char: null,
    // Several table elements. When `align=char`, sets the character to align on
    charOff: null,
    // Several table elements. When `char`, offsets the alignment
    classId: null,
    // `<object>`
    clear: null,
    // `<br>`. Use CSS `clear` instead
    code: null,
    // `<object>`
    codeBase: null,
    // `<object>`
    codeType: null,
    // `<object>`
    color: null,
    // `<font>` and `<hr>`. Use CSS instead
    compact: ut,
    // Lists. Use CSS to reduce space between items instead
    declare: ut,
    // `<object>`
    event: null,
    // `<script>`
    face: null,
    // `<font>`. Use CSS instead
    frame: null,
    // `<table>`
    frameBorder: null,
    // `<iframe>`. Use CSS `border` instead
    hSpace: ze,
    // `<img>` and `<object>`
    leftMargin: ze,
    // `<body>`
    link: null,
    // `<body>`. Use CSS `a:link {color: *}` instead
    longDesc: null,
    // `<frame>`, `<iframe>`, and `<img>`. Use an `<a>`
    lowSrc: null,
    // `<img>`. Use a `<picture>`
    marginHeight: ze,
    // `<body>`
    marginWidth: ze,
    // `<body>`
    noResize: ut,
    // `<frame>`
    noHref: ut,
    // `<area>`. Use no href instead of an explicit `nohref`
    noShade: ut,
    // `<hr>`. Use background-color and height instead of borders
    noWrap: ut,
    // `<td>` and `<th>`
    object: null,
    // `<applet>`
    profile: null,
    // `<head>`
    prompt: null,
    // `<isindex>`
    rev: null,
    // `<link>`
    rightMargin: ze,
    // `<body>`
    rules: null,
    // `<table>`
    scheme: null,
    // `<meta>`
    scrolling: dn,
    // `<frame>`. Use overflow in the child context
    standby: null,
    // `<object>`
    summary: null,
    // `<table>`
    text: null,
    // `<body>`. Use CSS `color` instead
    topMargin: ze,
    // `<body>`
    valueType: null,
    // `<param>`
    version: null,
    // `<html>`. Use a doctype.
    vAlign: null,
    // Several. Use CSS `vertical-align` instead
    vLink: null,
    // `<body>`. Use CSS `a:visited {color}` instead
    vSpace: ze,
    // `<img>` and `<object>`
    // Non-standard Properties.
    allowTransparency: null,
    autoCorrect: null,
    autoSave: null,
    disablePictureInPicture: ut,
    disableRemotePlayback: ut,
    prefix: null,
    property: null,
    results: ze,
    security: null,
    unselectable: null
  },
  space: "html",
  transform: Ub
}), C6 = Po({
  attributes: {
    accentHeight: "accent-height",
    alignmentBaseline: "alignment-baseline",
    arabicForm: "arabic-form",
    baselineShift: "baseline-shift",
    capHeight: "cap-height",
    className: "class",
    clipPath: "clip-path",
    clipRule: "clip-rule",
    colorInterpolation: "color-interpolation",
    colorInterpolationFilters: "color-interpolation-filters",
    colorProfile: "color-profile",
    colorRendering: "color-rendering",
    crossOrigin: "crossorigin",
    dataType: "datatype",
    dominantBaseline: "dominant-baseline",
    enableBackground: "enable-background",
    fillOpacity: "fill-opacity",
    fillRule: "fill-rule",
    floodColor: "flood-color",
    floodOpacity: "flood-opacity",
    fontFamily: "font-family",
    fontSize: "font-size",
    fontSizeAdjust: "font-size-adjust",
    fontStretch: "font-stretch",
    fontStyle: "font-style",
    fontVariant: "font-variant",
    fontWeight: "font-weight",
    glyphName: "glyph-name",
    glyphOrientationHorizontal: "glyph-orientation-horizontal",
    glyphOrientationVertical: "glyph-orientation-vertical",
    hrefLang: "hreflang",
    horizAdvX: "horiz-adv-x",
    horizOriginX: "horiz-origin-x",
    horizOriginY: "horiz-origin-y",
    imageRendering: "image-rendering",
    letterSpacing: "letter-spacing",
    lightingColor: "lighting-color",
    markerEnd: "marker-end",
    markerMid: "marker-mid",
    markerStart: "marker-start",
    navDown: "nav-down",
    navDownLeft: "nav-down-left",
    navDownRight: "nav-down-right",
    navLeft: "nav-left",
    navNext: "nav-next",
    navPrev: "nav-prev",
    navRight: "nav-right",
    navUp: "nav-up",
    navUpLeft: "nav-up-left",
    navUpRight: "nav-up-right",
    onAbort: "onabort",
    onActivate: "onactivate",
    onAfterPrint: "onafterprint",
    onBeforePrint: "onbeforeprint",
    onBegin: "onbegin",
    onCancel: "oncancel",
    onCanPlay: "oncanplay",
    onCanPlayThrough: "oncanplaythrough",
    onChange: "onchange",
    onClick: "onclick",
    onClose: "onclose",
    onCopy: "oncopy",
    onCueChange: "oncuechange",
    onCut: "oncut",
    onDblClick: "ondblclick",
    onDrag: "ondrag",
    onDragEnd: "ondragend",
    onDragEnter: "ondragenter",
    onDragExit: "ondragexit",
    onDragLeave: "ondragleave",
    onDragOver: "ondragover",
    onDragStart: "ondragstart",
    onDrop: "ondrop",
    onDurationChange: "ondurationchange",
    onEmptied: "onemptied",
    onEnd: "onend",
    onEnded: "onended",
    onError: "onerror",
    onFocus: "onfocus",
    onFocusIn: "onfocusin",
    onFocusOut: "onfocusout",
    onHashChange: "onhashchange",
    onInput: "oninput",
    onInvalid: "oninvalid",
    onKeyDown: "onkeydown",
    onKeyPress: "onkeypress",
    onKeyUp: "onkeyup",
    onLoad: "onload",
    onLoadedData: "onloadeddata",
    onLoadedMetadata: "onloadedmetadata",
    onLoadStart: "onloadstart",
    onMessage: "onmessage",
    onMouseDown: "onmousedown",
    onMouseEnter: "onmouseenter",
    onMouseLeave: "onmouseleave",
    onMouseMove: "onmousemove",
    onMouseOut: "onmouseout",
    onMouseOver: "onmouseover",
    onMouseUp: "onmouseup",
    onMouseWheel: "onmousewheel",
    onOffline: "onoffline",
    onOnline: "ononline",
    onPageHide: "onpagehide",
    onPageShow: "onpageshow",
    onPaste: "onpaste",
    onPause: "onpause",
    onPlay: "onplay",
    onPlaying: "onplaying",
    onPopState: "onpopstate",
    onProgress: "onprogress",
    onRateChange: "onratechange",
    onRepeat: "onrepeat",
    onReset: "onreset",
    onResize: "onresize",
    onScroll: "onscroll",
    onSeeked: "onseeked",
    onSeeking: "onseeking",
    onSelect: "onselect",
    onShow: "onshow",
    onStalled: "onstalled",
    onStorage: "onstorage",
    onSubmit: "onsubmit",
    onSuspend: "onsuspend",
    onTimeUpdate: "ontimeupdate",
    onToggle: "ontoggle",
    onUnload: "onunload",
    onVolumeChange: "onvolumechange",
    onWaiting: "onwaiting",
    onZoom: "onzoom",
    overlinePosition: "overline-position",
    overlineThickness: "overline-thickness",
    paintOrder: "paint-order",
    panose1: "panose-1",
    pointerEvents: "pointer-events",
    referrerPolicy: "referrerpolicy",
    renderingIntent: "rendering-intent",
    shapeRendering: "shape-rendering",
    stopColor: "stop-color",
    stopOpacity: "stop-opacity",
    strikethroughPosition: "strikethrough-position",
    strikethroughThickness: "strikethrough-thickness",
    strokeDashArray: "stroke-dasharray",
    strokeDashOffset: "stroke-dashoffset",
    strokeLineCap: "stroke-linecap",
    strokeLineJoin: "stroke-linejoin",
    strokeMiterLimit: "stroke-miterlimit",
    strokeOpacity: "stroke-opacity",
    strokeWidth: "stroke-width",
    tabIndex: "tabindex",
    textAnchor: "text-anchor",
    textDecoration: "text-decoration",
    textRendering: "text-rendering",
    transformOrigin: "transform-origin",
    typeOf: "typeof",
    underlinePosition: "underline-position",
    underlineThickness: "underline-thickness",
    unicodeBidi: "unicode-bidi",
    unicodeRange: "unicode-range",
    unitsPerEm: "units-per-em",
    vAlphabetic: "v-alphabetic",
    vHanging: "v-hanging",
    vIdeographic: "v-ideographic",
    vMathematical: "v-mathematical",
    vectorEffect: "vector-effect",
    vertAdvY: "vert-adv-y",
    vertOriginX: "vert-origin-x",
    vertOriginY: "vert-origin-y",
    wordSpacing: "word-spacing",
    writingMode: "writing-mode",
    xHeight: "x-height",
    // These were camelcased in Tiny. Now lowercased in SVG 2
    playbackOrder: "playbackorder",
    timelineBegin: "timelinebegin"
  },
  properties: {
    about: fr,
    accentHeight: ze,
    accumulate: null,
    additive: null,
    alignmentBaseline: null,
    alphabetic: ze,
    amplitude: ze,
    arabicForm: null,
    ascent: ze,
    attributeName: null,
    attributeType: null,
    azimuth: ze,
    bandwidth: null,
    baselineShift: null,
    baseFrequency: null,
    baseProfile: null,
    bbox: null,
    begin: null,
    bias: ze,
    by: null,
    calcMode: null,
    capHeight: ze,
    className: It,
    clip: null,
    clipPath: null,
    clipPathUnits: null,
    clipRule: null,
    color: null,
    colorInterpolation: null,
    colorInterpolationFilters: null,
    colorProfile: null,
    colorRendering: null,
    content: null,
    contentScriptType: null,
    contentStyleType: null,
    crossOrigin: null,
    cursor: null,
    cx: null,
    cy: null,
    d: null,
    dataType: null,
    defaultAction: null,
    descent: ze,
    diffuseConstant: ze,
    direction: null,
    display: null,
    dur: null,
    divisor: ze,
    dominantBaseline: null,
    download: ut,
    dx: null,
    dy: null,
    edgeMode: null,
    editable: null,
    elevation: ze,
    enableBackground: null,
    end: null,
    event: null,
    exponent: ze,
    externalResourcesRequired: null,
    fill: null,
    fillOpacity: ze,
    fillRule: null,
    filter: null,
    filterRes: null,
    filterUnits: null,
    floodColor: null,
    floodOpacity: null,
    focusable: null,
    focusHighlight: null,
    fontFamily: null,
    fontSize: null,
    fontSizeAdjust: null,
    fontStretch: null,
    fontStyle: null,
    fontVariant: null,
    fontWeight: null,
    format: null,
    fr: null,
    from: null,
    fx: null,
    fy: null,
    g1: Lo,
    g2: Lo,
    glyphName: Lo,
    glyphOrientationHorizontal: null,
    glyphOrientationVertical: null,
    glyphRef: null,
    gradientTransform: null,
    gradientUnits: null,
    handler: null,
    hanging: ze,
    hatchContentUnits: null,
    hatchUnits: null,
    height: null,
    href: null,
    hrefLang: null,
    horizAdvX: ze,
    horizOriginX: ze,
    horizOriginY: ze,
    id: null,
    ideographic: ze,
    imageRendering: null,
    initialVisibility: null,
    in: null,
    in2: null,
    intercept: ze,
    k: ze,
    k1: ze,
    k2: ze,
    k3: ze,
    k4: ze,
    kernelMatrix: fr,
    kernelUnitLength: null,
    keyPoints: null,
    // SEMI_COLON_SEPARATED
    keySplines: null,
    // SEMI_COLON_SEPARATED
    keyTimes: null,
    // SEMI_COLON_SEPARATED
    kerning: null,
    lang: null,
    lengthAdjust: null,
    letterSpacing: null,
    lightingColor: null,
    limitingConeAngle: ze,
    local: null,
    markerEnd: null,
    markerMid: null,
    markerStart: null,
    markerHeight: null,
    markerUnits: null,
    markerWidth: null,
    mask: null,
    maskContentUnits: null,
    maskUnits: null,
    mathematical: null,
    max: null,
    media: null,
    mediaCharacterEncoding: null,
    mediaContentEncodings: null,
    mediaSize: ze,
    mediaTime: null,
    method: null,
    min: null,
    mode: null,
    name: null,
    navDown: null,
    navDownLeft: null,
    navDownRight: null,
    navLeft: null,
    navNext: null,
    navPrev: null,
    navRight: null,
    navUp: null,
    navUpLeft: null,
    navUpRight: null,
    numOctaves: null,
    observer: null,
    offset: null,
    onAbort: null,
    onActivate: null,
    onAfterPrint: null,
    onBeforePrint: null,
    onBegin: null,
    onCancel: null,
    onCanPlay: null,
    onCanPlayThrough: null,
    onChange: null,
    onClick: null,
    onClose: null,
    onCopy: null,
    onCueChange: null,
    onCut: null,
    onDblClick: null,
    onDrag: null,
    onDragEnd: null,
    onDragEnter: null,
    onDragExit: null,
    onDragLeave: null,
    onDragOver: null,
    onDragStart: null,
    onDrop: null,
    onDurationChange: null,
    onEmptied: null,
    onEnd: null,
    onEnded: null,
    onError: null,
    onFocus: null,
    onFocusIn: null,
    onFocusOut: null,
    onHashChange: null,
    onInput: null,
    onInvalid: null,
    onKeyDown: null,
    onKeyPress: null,
    onKeyUp: null,
    onLoad: null,
    onLoadedData: null,
    onLoadedMetadata: null,
    onLoadStart: null,
    onMessage: null,
    onMouseDown: null,
    onMouseEnter: null,
    onMouseLeave: null,
    onMouseMove: null,
    onMouseOut: null,
    onMouseOver: null,
    onMouseUp: null,
    onMouseWheel: null,
    onOffline: null,
    onOnline: null,
    onPageHide: null,
    onPageShow: null,
    onPaste: null,
    onPause: null,
    onPlay: null,
    onPlaying: null,
    onPopState: null,
    onProgress: null,
    onRateChange: null,
    onRepeat: null,
    onReset: null,
    onResize: null,
    onScroll: null,
    onSeeked: null,
    onSeeking: null,
    onSelect: null,
    onShow: null,
    onStalled: null,
    onStorage: null,
    onSubmit: null,
    onSuspend: null,
    onTimeUpdate: null,
    onToggle: null,
    onUnload: null,
    onVolumeChange: null,
    onWaiting: null,
    onZoom: null,
    opacity: null,
    operator: null,
    order: null,
    orient: null,
    orientation: null,
    origin: null,
    overflow: null,
    overlay: null,
    overlinePosition: ze,
    overlineThickness: ze,
    paintOrder: null,
    panose1: null,
    path: null,
    pathLength: ze,
    patternContentUnits: null,
    patternTransform: null,
    patternUnits: null,
    phase: null,
    ping: It,
    pitch: null,
    playbackOrder: null,
    pointerEvents: null,
    points: null,
    pointsAtX: ze,
    pointsAtY: ze,
    pointsAtZ: ze,
    preserveAlpha: null,
    preserveAspectRatio: null,
    primitiveUnits: null,
    propagate: null,
    property: fr,
    r: null,
    radius: null,
    referrerPolicy: null,
    refX: null,
    refY: null,
    rel: fr,
    rev: fr,
    renderingIntent: null,
    repeatCount: null,
    repeatDur: null,
    requiredExtensions: fr,
    requiredFeatures: fr,
    requiredFonts: fr,
    requiredFormats: fr,
    resource: null,
    restart: null,
    result: null,
    rotate: null,
    rx: null,
    ry: null,
    scale: null,
    seed: null,
    shapeRendering: null,
    side: null,
    slope: null,
    snapshotTime: null,
    specularConstant: ze,
    specularExponent: ze,
    spreadMethod: null,
    spacing: null,
    startOffset: null,
    stdDeviation: null,
    stemh: null,
    stemv: null,
    stitchTiles: null,
    stopColor: null,
    stopOpacity: null,
    strikethroughPosition: ze,
    strikethroughThickness: ze,
    string: null,
    stroke: null,
    strokeDashArray: fr,
    strokeDashOffset: null,
    strokeLineCap: null,
    strokeLineJoin: null,
    strokeMiterLimit: ze,
    strokeOpacity: ze,
    strokeWidth: null,
    style: null,
    surfaceScale: ze,
    syncBehavior: null,
    syncBehaviorDefault: null,
    syncMaster: null,
    syncTolerance: null,
    syncToleranceDefault: null,
    systemLanguage: fr,
    tabIndex: ze,
    tableValues: null,
    target: null,
    targetX: ze,
    targetY: ze,
    textAnchor: null,
    textDecoration: null,
    textRendering: null,
    textLength: null,
    timelineBegin: null,
    title: null,
    transformBehavior: null,
    type: null,
    typeOf: fr,
    to: null,
    transform: null,
    transformOrigin: null,
    u1: null,
    u2: null,
    underlinePosition: ze,
    underlineThickness: ze,
    unicode: null,
    unicodeBidi: null,
    unicodeRange: null,
    unitsPerEm: ze,
    values: null,
    vAlphabetic: ze,
    vMathematical: ze,
    vectorEffect: null,
    vHanging: ze,
    vIdeographic: ze,
    version: null,
    vertAdvY: ze,
    vertOriginX: ze,
    vertOriginY: ze,
    viewBox: null,
    viewTarget: null,
    visibility: null,
    width: null,
    widths: null,
    wordSpacing: null,
    writingMode: null,
    x: null,
    x1: null,
    x2: null,
    xChannelSelector: null,
    xHeight: ze,
    y: null,
    y1: null,
    y2: null,
    yChannelSelector: null,
    z: null,
    zoomAndPan: null
  },
  space: "svg",
  transform: Ib
}), Pb = Po({
  properties: {
    xLinkActuate: null,
    xLinkArcRole: null,
    xLinkHref: null,
    xLinkRole: null,
    xLinkShow: null,
    xLinkTitle: null,
    xLinkType: null
  },
  space: "xlink",
  transform(t, r) {
    return "xlink:" + r.slice(5).toLowerCase();
  }
}), qb = Po({
  attributes: { xmlnsxlink: "xmlns:xlink" },
  properties: { xmlnsXLink: null, xmlns: null },
  space: "xmlns",
  transform: Ub
}), Hb = Po({
  properties: { xmlBase: null, xmlLang: null, xmlSpace: null },
  space: "xml",
  transform(t, r) {
    return "xml:" + r.slice(3).toLowerCase();
  }
}), E6 = {
  classId: "classID",
  dataType: "datatype",
  itemId: "itemID",
  strokeDashArray: "strokeDasharray",
  strokeDashOffset: "strokeDashoffset",
  strokeLineCap: "strokeLinecap",
  strokeLineJoin: "strokeLinejoin",
  strokeMiterLimit: "strokeMiterlimit",
  typeOf: "typeof",
  xLinkActuate: "xlinkActuate",
  xLinkArcRole: "xlinkArcrole",
  xLinkHref: "xlinkHref",
  xLinkRole: "xlinkRole",
  xLinkShow: "xlinkShow",
  xLinkTitle: "xlinkTitle",
  xLinkType: "xlinkType",
  xmlnsXLink: "xmlnsXlink"
}, j6 = /[A-Z]/g, X1 = /-[a-z]/g, _6 = /^data[-\w.:]+$/i;
function N6(t, r) {
  const a = sm(r);
  let l = r, s = nr;
  if (a in t.normal)
    return t.property[t.normal[a]];
  if (a.length > 4 && a.slice(0, 4) === "data" && _6.test(r)) {
    if (r.charAt(4) === "-") {
      const c = r.slice(5).replace(X1, A6);
      l = "data" + c.charAt(0).toUpperCase() + c.slice(1);
    } else {
      const c = r.slice(4);
      if (!X1.test(c)) {
        let d = c.replace(j6, T6);
        d.charAt(0) !== "-" && (d = "-" + d), r = "data" + d;
      }
    }
    s = $m;
  }
  return new s(l, r);
}
function T6(t) {
  return "-" + t.toLowerCase();
}
function A6(t) {
  return t.charAt(1).toUpperCase();
}
const M6 = Lb([Bb, k6, Pb, qb, Hb], "html"), Gm = Lb([Bb, C6, Pb, qb, Hb], "svg");
function z6(t) {
  return t.join(" ").trim();
}
var _o = {}, Nh, W1;
function R6() {
  if (W1) return Nh;
  W1 = 1;
  var t = /\/\*[^*]*\*+([^/*][^*]*\*+)*\//g, r = /\n/g, a = /^\s*/, l = /^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/, s = /^:\s*/, c = /^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/, d = /^[;\s]*/, m = /^\s+|\s+$/g, g = `
`, p = "/", v = "*", x = "", E = "comment", w = "declaration";
  function _(D, R) {
    if (typeof D != "string")
      throw new TypeError("First argument must be a string");
    if (!D) return [];
    R = R || {};
    var Z = 1, K = 1;
    function ge(be) {
      var je = be.match(r);
      je && (Z += je.length);
      var re = be.lastIndexOf(g);
      K = ~re ? be.length - re : K + be.length;
    }
    function de() {
      var be = { line: Z, column: K };
      return function(je) {
        return je.position = new I(be), Te(), je;
      };
    }
    function I(be) {
      this.start = be, this.end = { line: Z, column: K }, this.source = R.source;
    }
    I.prototype.content = D;
    function V(be) {
      var je = new Error(
        R.source + ":" + Z + ":" + K + ": " + be
      );
      if (je.reason = be, je.filename = R.source, je.line = Z, je.column = K, je.source = D, !R.silent) throw je;
    }
    function we(be) {
      var je = be.exec(D);
      if (je) {
        var re = je[0];
        return ge(re), D = D.slice(re.length), je;
      }
    }
    function Te() {
      we(a);
    }
    function X(be) {
      var je;
      for (be = be || []; je = oe(); )
        je !== !1 && be.push(je);
      return be;
    }
    function oe() {
      var be = de();
      if (!(p != D.charAt(0) || v != D.charAt(1))) {
        for (var je = 2; x != D.charAt(je) && (v != D.charAt(je) || p != D.charAt(je + 1)); )
          ++je;
        if (je += 2, x === D.charAt(je - 1))
          return V("End of comment missing");
        var re = D.slice(2, je - 2);
        return K += 2, ge(re), D = D.slice(je), K += 2, be({
          type: E,
          comment: re
        });
      }
    }
    function se() {
      var be = de(), je = we(l);
      if (je) {
        if (oe(), !we(s)) return V("property missing ':'");
        var re = we(c), _e = be({
          type: w,
          property: A(je[0].replace(t, x)),
          value: re ? A(re[0].replace(t, x)) : x
        });
        return we(d), _e;
      }
    }
    function Re() {
      var be = [];
      X(be);
      for (var je; je = se(); )
        je !== !1 && (be.push(je), X(be));
      return be;
    }
    return Te(), Re();
  }
  function A(D) {
    return D ? D.replace(m, x) : x;
  }
  return Nh = _, Nh;
}
var Z1;
function O6() {
  if (Z1) return _o;
  Z1 = 1;
  var t = _o && _o.__importDefault || function(l) {
    return l && l.__esModule ? l : { default: l };
  };
  Object.defineProperty(_o, "__esModule", { value: !0 }), _o.default = a;
  const r = t(R6());
  function a(l, s) {
    let c = null;
    if (!l || typeof l != "string")
      return c;
    const d = (0, r.default)(l), m = typeof s == "function";
    return d.forEach((g) => {
      if (g.type !== "declaration")
        return;
      const { property: p, value: v } = g;
      m ? s(p, v, g) : v && (c = c || {}, c[p] = v);
    }), c;
  }
  return _o;
}
var Ys = {}, J1;
function D6() {
  if (J1) return Ys;
  J1 = 1, Object.defineProperty(Ys, "__esModule", { value: !0 }), Ys.camelCase = void 0;
  var t = /^--[a-zA-Z0-9_-]+$/, r = /-([a-z])/g, a = /^[^-]+$/, l = /^-(webkit|moz|ms|o|khtml)-/, s = /^-(ms)-/, c = function(p) {
    return !p || a.test(p) || t.test(p);
  }, d = function(p, v) {
    return v.toUpperCase();
  }, m = function(p, v) {
    return "".concat(v, "-");
  }, g = function(p, v) {
    return v === void 0 && (v = {}), c(p) ? p : (p = p.toLowerCase(), v.reactCompat ? p = p.replace(s, m) : p = p.replace(l, m), p.replace(r, d));
  };
  return Ys.camelCase = g, Ys;
}
var Qs, ey;
function L6() {
  if (ey) return Qs;
  ey = 1;
  var t = Qs && Qs.__importDefault || function(s) {
    return s && s.__esModule ? s : { default: s };
  }, r = t(O6()), a = D6();
  function l(s, c) {
    var d = {};
    return !s || typeof s != "string" || (0, r.default)(s, function(m, g) {
      m && g && (d[(0, a.camelCase)(m, c)] = g);
    }), d;
  }
  return l.default = l, Qs = l, Qs;
}
var B6 = L6();
const I6 = /* @__PURE__ */ Nl(B6), Fb = $b("end"), Vm = $b("start");
function $b(t) {
  return r;
  function r(a) {
    const l = a && a.position && a.position[t] || {};
    if (typeof l.line == "number" && l.line > 0 && typeof l.column == "number" && l.column > 0)
      return {
        line: l.line,
        column: l.column,
        offset: typeof l.offset == "number" && l.offset > -1 ? l.offset : void 0
      };
  }
}
function U6(t) {
  const r = Vm(t), a = Fb(t);
  if (r && a)
    return { start: r, end: a };
}
function ru(t) {
  return !t || typeof t != "object" ? "" : "position" in t || "type" in t ? ty(t.position) : "start" in t || "end" in t ? ty(t) : "line" in t || "column" in t ? dm(t) : "";
}
function dm(t) {
  return ny(t && t.line) + ":" + ny(t && t.column);
}
function ty(t) {
  return dm(t && t.start) + "-" + dm(t && t.end);
}
function ny(t) {
  return t && typeof t == "number" ? t : 1;
}
class Bn extends Error {
  /**
   * Create a message for `reason`.
   *
   * >  **Note**: also has obsolete signatures.
   *
   * @overload
   * @param {string} reason
   * @param {Options | null | undefined} [options]
   * @returns
   *
   * @overload
   * @param {string} reason
   * @param {Node | NodeLike | null | undefined} parent
   * @param {string | null | undefined} [origin]
   * @returns
   *
   * @overload
   * @param {string} reason
   * @param {Point | Position | null | undefined} place
   * @param {string | null | undefined} [origin]
   * @returns
   *
   * @overload
   * @param {string} reason
   * @param {string | null | undefined} [origin]
   * @returns
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {Node | NodeLike | null | undefined} parent
   * @param {string | null | undefined} [origin]
   * @returns
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {Point | Position | null | undefined} place
   * @param {string | null | undefined} [origin]
   * @returns
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {string | null | undefined} [origin]
   * @returns
   *
   * @param {Error | VFileMessage | string} causeOrReason
   *   Reason for message, should use markdown.
   * @param {Node | NodeLike | Options | Point | Position | string | null | undefined} [optionsOrParentOrPlace]
   *   Configuration (optional).
   * @param {string | null | undefined} [origin]
   *   Place in code where the message originates (example:
   *   `'my-package:my-rule'` or `'my-rule'`).
   * @returns
   *   Instance of `VFileMessage`.
   */
  // eslint-disable-next-line complexity
  constructor(r, a, l) {
    super(), typeof a == "string" && (l = a, a = void 0);
    let s = "", c = {}, d = !1;
    if (a && ("line" in a && "column" in a ? c = { place: a } : "start" in a && "end" in a ? c = { place: a } : "type" in a ? c = {
      ancestors: [a],
      place: a.position
    } : c = { ...a }), typeof r == "string" ? s = r : !c.cause && r && (d = !0, s = r.message, c.cause = r), !c.ruleId && !c.source && typeof l == "string") {
      const g = l.indexOf(":");
      g === -1 ? c.ruleId = l : (c.source = l.slice(0, g), c.ruleId = l.slice(g + 1));
    }
    if (!c.place && c.ancestors && c.ancestors) {
      const g = c.ancestors[c.ancestors.length - 1];
      g && (c.place = g.position);
    }
    const m = c.place && "start" in c.place ? c.place.start : c.place;
    this.ancestors = c.ancestors || void 0, this.cause = c.cause || void 0, this.column = m ? m.column : void 0, this.fatal = void 0, this.file = "", this.message = s, this.line = m ? m.line : void 0, this.name = ru(c.place) || "1:1", this.place = c.place || void 0, this.reason = this.message, this.ruleId = c.ruleId || void 0, this.source = c.source || void 0, this.stack = d && c.cause && typeof c.cause.stack == "string" ? c.cause.stack : "", this.actual = void 0, this.expected = void 0, this.note = void 0, this.url = void 0;
  }
}
Bn.prototype.file = "";
Bn.prototype.name = "";
Bn.prototype.reason = "";
Bn.prototype.message = "";
Bn.prototype.stack = "";
Bn.prototype.column = void 0;
Bn.prototype.line = void 0;
Bn.prototype.ancestors = void 0;
Bn.prototype.cause = void 0;
Bn.prototype.fatal = void 0;
Bn.prototype.place = void 0;
Bn.prototype.ruleId = void 0;
Bn.prototype.source = void 0;
const Km = {}.hasOwnProperty, P6 = /* @__PURE__ */ new Map(), q6 = /[A-Z]/g, H6 = /* @__PURE__ */ new Set(["table", "tbody", "thead", "tfoot", "tr"]), F6 = /* @__PURE__ */ new Set(["td", "th"]), Gb = "https://github.com/syntax-tree/hast-util-to-jsx-runtime";
function $6(t, r) {
  if (!r || r.Fragment === void 0)
    throw new TypeError("Expected `Fragment` in options");
  const a = r.filePath || void 0;
  let l;
  if (r.development) {
    if (typeof r.jsxDEV != "function")
      throw new TypeError(
        "Expected `jsxDEV` in options when `development: true`"
      );
    l = Z6(a, r.jsxDEV);
  } else {
    if (typeof r.jsx != "function")
      throw new TypeError("Expected `jsx` in production options");
    if (typeof r.jsxs != "function")
      throw new TypeError("Expected `jsxs` in production options");
    l = W6(a, r.jsx, r.jsxs);
  }
  const s = {
    Fragment: r.Fragment,
    ancestors: [],
    components: r.components || {},
    create: l,
    elementAttributeNameCase: r.elementAttributeNameCase || "react",
    evaluater: r.createEvaluater ? r.createEvaluater() : void 0,
    filePath: a,
    ignoreInvalidStyle: r.ignoreInvalidStyle || !1,
    passKeys: r.passKeys !== !1,
    passNode: r.passNode || !1,
    schema: r.space === "svg" ? Gm : M6,
    stylePropertyNameCase: r.stylePropertyNameCase || "dom",
    tableCellAlignToStyle: r.tableCellAlignToStyle !== !1
  }, c = Vb(s, t, void 0);
  return c && typeof c != "string" ? c : s.create(
    t,
    s.Fragment,
    { children: c || void 0 },
    void 0
  );
}
function Vb(t, r, a) {
  if (r.type === "element")
    return G6(t, r, a);
  if (r.type === "mdxFlowExpression" || r.type === "mdxTextExpression")
    return V6(t, r);
  if (r.type === "mdxJsxFlowElement" || r.type === "mdxJsxTextElement")
    return Y6(t, r, a);
  if (r.type === "mdxjsEsm")
    return K6(t, r);
  if (r.type === "root")
    return Q6(t, r, a);
  if (r.type === "text")
    return X6(t, r);
}
function G6(t, r, a) {
  const l = t.schema;
  let s = l;
  r.tagName.toLowerCase() === "svg" && l.space === "html" && (s = Gm, t.schema = s), t.ancestors.push(r);
  const c = Yb(t, r.tagName, !1), d = J6(t, r);
  let m = Qm(t, r);
  return H6.has(r.tagName) && (m = m.filter(function(g) {
    return typeof g == "string" ? !S6(g) : !0;
  })), Kb(t, d, c, r), Ym(d, m), t.ancestors.pop(), t.schema = l, t.create(r, c, d, a);
}
function V6(t, r) {
  if (r.data && r.data.estree && t.evaluater) {
    const l = r.data.estree.body[0];
    return l.type, /** @type {Child | undefined} */
    t.evaluater.evaluateExpression(l.expression);
  }
  uu(t, r.position);
}
function K6(t, r) {
  if (r.data && r.data.estree && t.evaluater)
    return (
      /** @type {Child | undefined} */
      t.evaluater.evaluateProgram(r.data.estree)
    );
  uu(t, r.position);
}
function Y6(t, r, a) {
  const l = t.schema;
  let s = l;
  r.name === "svg" && l.space === "html" && (s = Gm, t.schema = s), t.ancestors.push(r);
  const c = r.name === null ? t.Fragment : Yb(t, r.name, !0), d = e8(t, r), m = Qm(t, r);
  return Kb(t, d, c, r), Ym(d, m), t.ancestors.pop(), t.schema = l, t.create(r, c, d, a);
}
function Q6(t, r, a) {
  const l = {};
  return Ym(l, Qm(t, r)), t.create(r, t.Fragment, l, a);
}
function X6(t, r) {
  return r.value;
}
function Kb(t, r, a, l) {
  typeof a != "string" && a !== t.Fragment && t.passNode && (r.node = l);
}
function Ym(t, r) {
  if (r.length > 0) {
    const a = r.length > 1 ? r : r[0];
    a && (t.children = a);
  }
}
function W6(t, r, a) {
  return l;
  function l(s, c, d, m) {
    const p = Array.isArray(d.children) ? a : r;
    return m ? p(c, d, m) : p(c, d);
  }
}
function Z6(t, r) {
  return a;
  function a(l, s, c, d) {
    const m = Array.isArray(c.children), g = Vm(l);
    return r(
      s,
      c,
      d,
      m,
      {
        columnNumber: g ? g.column - 1 : void 0,
        fileName: t,
        lineNumber: g ? g.line : void 0
      },
      void 0
    );
  }
}
function J6(t, r) {
  const a = {};
  let l, s;
  for (s in r.properties)
    if (s !== "children" && Km.call(r.properties, s)) {
      const c = t8(t, s, r.properties[s]);
      if (c) {
        const [d, m] = c;
        t.tableCellAlignToStyle && d === "align" && typeof m == "string" && F6.has(r.tagName) ? l = m : a[d] = m;
      }
    }
  if (l) {
    const c = (
      /** @type {Style} */
      a.style || (a.style = {})
    );
    c[t.stylePropertyNameCase === "css" ? "text-align" : "textAlign"] = l;
  }
  return a;
}
function e8(t, r) {
  const a = {};
  for (const l of r.attributes)
    if (l.type === "mdxJsxExpressionAttribute")
      if (l.data && l.data.estree && t.evaluater) {
        const c = l.data.estree.body[0];
        c.type;
        const d = c.expression;
        d.type;
        const m = d.properties[0];
        m.type, Object.assign(
          a,
          t.evaluater.evaluateExpression(m.argument)
        );
      } else
        uu(t, r.position);
    else {
      const s = l.name;
      let c;
      if (l.value && typeof l.value == "object")
        if (l.value.data && l.value.data.estree && t.evaluater) {
          const m = l.value.data.estree.body[0];
          m.type, c = t.evaluater.evaluateExpression(m.expression);
        } else
          uu(t, r.position);
      else
        c = l.value === null ? !0 : l.value;
      a[s] = /** @type {Props[keyof Props]} */
      c;
    }
  return a;
}
function Qm(t, r) {
  const a = [];
  let l = -1;
  const s = t.passKeys ? /* @__PURE__ */ new Map() : P6;
  for (; ++l < r.children.length; ) {
    const c = r.children[l];
    let d;
    if (t.passKeys) {
      const g = c.type === "element" ? c.tagName : c.type === "mdxJsxFlowElement" || c.type === "mdxJsxTextElement" ? c.name : void 0;
      if (g) {
        const p = s.get(g) || 0;
        d = g + "-" + p, s.set(g, p + 1);
      }
    }
    const m = Vb(t, c, d);
    m !== void 0 && a.push(m);
  }
  return a;
}
function t8(t, r, a) {
  const l = N6(t.schema, r);
  if (!(a == null || typeof a == "number" && Number.isNaN(a))) {
    if (Array.isArray(a) && (a = l.commaSeparated ? g6(a) : z6(a)), l.property === "style") {
      let s = typeof a == "object" ? a : n8(t, String(a));
      return t.stylePropertyNameCase === "css" && (s = r8(s)), ["style", s];
    }
    return [
      t.elementAttributeNameCase === "react" && l.space ? E6[l.property] || l.property : l.attribute,
      a
    ];
  }
}
function n8(t, r) {
  try {
    return I6(r, { reactCompat: !0 });
  } catch (a) {
    if (t.ignoreInvalidStyle)
      return {};
    const l = (
      /** @type {Error} */
      a
    ), s = new Bn("Cannot parse `style` attribute", {
      ancestors: t.ancestors,
      cause: l,
      ruleId: "style",
      source: "hast-util-to-jsx-runtime"
    });
    throw s.file = t.filePath || void 0, s.url = Gb + "#cannot-parse-style-attribute", s;
  }
}
function Yb(t, r, a) {
  let l;
  if (!a)
    l = { type: "Literal", value: r };
  else if (r.includes(".")) {
    const s = r.split(".");
    let c = -1, d;
    for (; ++c < s.length; ) {
      const m = K1(s[c]) ? { type: "Identifier", name: s[c] } : { type: "Literal", value: s[c] };
      d = d ? {
        type: "MemberExpression",
        object: d,
        property: m,
        computed: !!(c && m.type === "Literal"),
        optional: !1
      } : m;
    }
    l = d;
  } else
    l = K1(r) && !/^[a-z]/.test(r) ? { type: "Identifier", name: r } : { type: "Literal", value: r };
  if (l.type === "Literal") {
    const s = (
      /** @type {string | number} */
      l.value
    );
    return Km.call(t.components, s) ? t.components[s] : s;
  }
  if (t.evaluater)
    return t.evaluater.evaluateExpression(l);
  uu(t);
}
function uu(t, r) {
  const a = new Bn(
    "Cannot handle MDX estrees without `createEvaluater`",
    {
      ancestors: t.ancestors,
      place: r,
      ruleId: "mdx-estree",
      source: "hast-util-to-jsx-runtime"
    }
  );
  throw a.file = t.filePath || void 0, a.url = Gb + "#cannot-handle-mdx-estrees-without-createevaluater", a;
}
function r8(t) {
  const r = {};
  let a;
  for (a in t)
    Km.call(t, a) && (r[a8(a)] = t[a]);
  return r;
}
function a8(t) {
  let r = t.replace(q6, i8);
  return r.slice(0, 3) === "ms-" && (r = "-" + r), r;
}
function i8(t) {
  return "-" + t.toLowerCase();
}
const Th = {
  action: ["form"],
  cite: ["blockquote", "del", "ins", "q"],
  data: ["object"],
  formAction: ["button", "input"],
  href: ["a", "area", "base", "link"],
  icon: ["menuitem"],
  itemId: null,
  manifest: ["html"],
  ping: ["a", "area"],
  poster: ["video"],
  src: [
    "audio",
    "embed",
    "iframe",
    "img",
    "input",
    "script",
    "source",
    "track",
    "video"
  ]
}, l8 = {};
function Xm(t, r) {
  const a = l8, l = typeof a.includeImageAlt == "boolean" ? a.includeImageAlt : !0, s = typeof a.includeHtml == "boolean" ? a.includeHtml : !0;
  return Qb(t, l, s);
}
function Qb(t, r, a) {
  if (o8(t)) {
    if ("value" in t)
      return t.type === "html" && !a ? "" : t.value;
    if (r && "alt" in t && t.alt)
      return t.alt;
    if ("children" in t)
      return ry(t.children, r, a);
  }
  return Array.isArray(t) ? ry(t, r, a) : "";
}
function ry(t, r, a) {
  const l = [];
  let s = -1;
  for (; ++s < t.length; )
    l[s] = Qb(t[s], r, a);
  return l.join("");
}
function o8(t) {
  return !!(t && typeof t == "object");
}
const ay = document.createElement("i");
function Wm(t) {
  const r = "&" + t + ";";
  ay.innerHTML = r;
  const a = ay.textContent;
  return (
    // @ts-expect-error: TypeScript is wrong that `textContent` on elements can
    // yield `null`.
    a.charCodeAt(a.length - 1) === 59 && t !== "semi" || a === r ? !1 : a
  );
}
function pr(t, r, a, l) {
  const s = t.length;
  let c = 0, d;
  if (r < 0 ? r = -r > s ? 0 : s + r : r = r > s ? s : r, a = a > 0 ? a : 0, l.length < 1e4)
    d = Array.from(l), d.unshift(r, a), t.splice(...d);
  else
    for (a && t.splice(r, a); c < l.length; )
      d = l.slice(c, c + 1e4), d.unshift(r, 0), t.splice(...d), c += 1e4, r += 1e4;
}
function Tr(t, r) {
  return t.length > 0 ? (pr(t, t.length, 0, r), t) : r;
}
const iy = {}.hasOwnProperty;
function Xb(t) {
  const r = {};
  let a = -1;
  for (; ++a < t.length; )
    s8(r, t[a]);
  return r;
}
function s8(t, r) {
  let a;
  for (a in r) {
    const s = (iy.call(t, a) ? t[a] : void 0) || (t[a] = {}), c = r[a];
    let d;
    if (c)
      for (d in c) {
        iy.call(s, d) || (s[d] = []);
        const m = c[d];
        u8(
          // @ts-expect-error Looks like a list.
          s[d],
          Array.isArray(m) ? m : m ? [m] : []
        );
      }
  }
}
function u8(t, r) {
  let a = -1;
  const l = [];
  for (; ++a < r.length; )
    (r[a].add === "after" ? t : l).push(r[a]);
  pr(t, 0, 0, l);
}
function Wb(t, r) {
  const a = Number.parseInt(t, r);
  return (
    // C0 except for HT, LF, FF, CR, space.
    a < 9 || a === 11 || a > 13 && a < 32 || // Control character (DEL) of C0, and C1 controls.
    a > 126 && a < 160 || // Lone high surrogates and low surrogates.
    a > 55295 && a < 57344 || // Noncharacters.
    a > 64975 && a < 65008 || /* eslint-disable no-bitwise */
    (a & 65535) === 65535 || (a & 65535) === 65534 || /* eslint-enable no-bitwise */
    // Out of range
    a > 1114111 ? "" : String.fromCodePoint(a)
  );
}
function Pr(t) {
  return t.replace(/[\t\n\r ]+/g, " ").replace(/^ | $/g, "").toLowerCase().toUpperCase();
}
const Hn = Ii(/[A-Za-z]/), Ln = Ii(/[\dA-Za-z]/), c8 = Ii(/[#-'*+\--9=?A-Z^-~]/);
function ed(t) {
  return (
    // Special whitespace codes (which have negative values), C0 and Control
    // character DEL
    t !== null && (t < 32 || t === 127)
  );
}
const fm = Ii(/\d/), d8 = Ii(/[\dA-Fa-f]/), f8 = Ii(/[!-/:-@[-`{-~]/);
function et(t) {
  return t !== null && t < -2;
}
function Lt(t) {
  return t !== null && (t < 0 || t === 32);
}
function ht(t) {
  return t === -2 || t === -1 || t === 32;
}
const hd = Ii(new RegExp("\\p{P}|\\p{S}", "u")), jl = Ii(/\s/);
function Ii(t) {
  return r;
  function r(a) {
    return a !== null && a > -1 && t.test(String.fromCharCode(a));
  }
}
function qo(t) {
  const r = [];
  let a = -1, l = 0, s = 0;
  for (; ++a < t.length; ) {
    const c = t.charCodeAt(a);
    let d = "";
    if (c === 37 && Ln(t.charCodeAt(a + 1)) && Ln(t.charCodeAt(a + 2)))
      s = 2;
    else if (c < 128)
      /[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(c)) || (d = String.fromCharCode(c));
    else if (c > 55295 && c < 57344) {
      const m = t.charCodeAt(a + 1);
      c < 56320 && m > 56319 && m < 57344 ? (d = String.fromCharCode(c, m), s = 1) : d = "";
    } else
      d = String.fromCharCode(c);
    d && (r.push(t.slice(l, a), encodeURIComponent(d)), l = a + s + 1, d = ""), s && (a += s, s = 0);
  }
  return r.join("") + t.slice(l);
}
function vt(t, r, a, l) {
  const s = l ? l - 1 : Number.POSITIVE_INFINITY;
  let c = 0;
  return d;
  function d(g) {
    return ht(g) ? (t.enter(a), m(g)) : r(g);
  }
  function m(g) {
    return ht(g) && c++ < s ? (t.consume(g), m) : (t.exit(a), r(g));
  }
}
const h8 = {
  tokenize: m8
};
function m8(t) {
  const r = t.attempt(this.parser.constructs.contentInitial, l, s);
  let a;
  return r;
  function l(m) {
    if (m === null) {
      t.consume(m);
      return;
    }
    return t.enter("lineEnding"), t.consume(m), t.exit("lineEnding"), vt(t, r, "linePrefix");
  }
  function s(m) {
    return t.enter("paragraph"), c(m);
  }
  function c(m) {
    const g = t.enter("chunkText", {
      contentType: "text",
      previous: a
    });
    return a && (a.next = g), a = g, d(m);
  }
  function d(m) {
    if (m === null) {
      t.exit("chunkText"), t.exit("paragraph"), t.consume(m);
      return;
    }
    return et(m) ? (t.consume(m), t.exit("chunkText"), c) : (t.consume(m), d);
  }
}
const p8 = {
  tokenize: g8
}, ly = {
  tokenize: y8
};
function g8(t) {
  const r = this, a = [];
  let l = 0, s, c, d;
  return m;
  function m(K) {
    if (l < a.length) {
      const ge = a[l];
      return r.containerState = ge[1], t.attempt(ge[0].continuation, g, p)(K);
    }
    return p(K);
  }
  function g(K) {
    if (l++, r.containerState._closeFlow) {
      r.containerState._closeFlow = void 0, s && Z();
      const ge = r.events.length;
      let de = ge, I;
      for (; de--; )
        if (r.events[de][0] === "exit" && r.events[de][1].type === "chunkFlow") {
          I = r.events[de][1].end;
          break;
        }
      R(l);
      let V = ge;
      for (; V < r.events.length; )
        r.events[V][1].end = {
          ...I
        }, V++;
      return pr(r.events, de + 1, 0, r.events.slice(ge)), r.events.length = V, p(K);
    }
    return m(K);
  }
  function p(K) {
    if (l === a.length) {
      if (!s)
        return E(K);
      if (s.currentConstruct && s.currentConstruct.concrete)
        return _(K);
      r.interrupt = !!(s.currentConstruct && !s._gfmTableDynamicInterruptHack);
    }
    return r.containerState = {}, t.check(ly, v, x)(K);
  }
  function v(K) {
    return s && Z(), R(l), E(K);
  }
  function x(K) {
    return r.parser.lazy[r.now().line] = l !== a.length, d = r.now().offset, _(K);
  }
  function E(K) {
    return r.containerState = {}, t.attempt(ly, w, _)(K);
  }
  function w(K) {
    return l++, a.push([r.currentConstruct, r.containerState]), E(K);
  }
  function _(K) {
    if (K === null) {
      s && Z(), R(0), t.consume(K);
      return;
    }
    return s = s || r.parser.flow(r.now()), t.enter("chunkFlow", {
      _tokenizer: s,
      contentType: "flow",
      previous: c
    }), A(K);
  }
  function A(K) {
    if (K === null) {
      D(t.exit("chunkFlow"), !0), R(0), t.consume(K);
      return;
    }
    return et(K) ? (t.consume(K), D(t.exit("chunkFlow")), l = 0, r.interrupt = void 0, m) : (t.consume(K), A);
  }
  function D(K, ge) {
    const de = r.sliceStream(K);
    if (ge && de.push(null), K.previous = c, c && (c.next = K), c = K, s.defineSkip(K.start), s.write(de), r.parser.lazy[K.start.line]) {
      let I = s.events.length;
      for (; I--; )
        if (
          // The token starts before the line ending
          s.events[I][1].start.offset < d && // and either is not ended yet
          (!s.events[I][1].end || // or ends after it.
          s.events[I][1].end.offset > d)
        )
          return;
      const V = r.events.length;
      let we = V, Te, X;
      for (; we--; )
        if (r.events[we][0] === "exit" && r.events[we][1].type === "chunkFlow") {
          if (Te) {
            X = r.events[we][1].end;
            break;
          }
          Te = !0;
        }
      for (R(l), I = V; I < r.events.length; )
        r.events[I][1].end = {
          ...X
        }, I++;
      pr(r.events, we + 1, 0, r.events.slice(V)), r.events.length = I;
    }
  }
  function R(K) {
    let ge = a.length;
    for (; ge-- > K; ) {
      const de = a[ge];
      r.containerState = de[1], de[0].exit.call(r, t);
    }
    a.length = K;
  }
  function Z() {
    s.write([null]), c = void 0, s = void 0, r.containerState._closeFlow = void 0;
  }
}
function y8(t, r, a) {
  return vt(t, t.attempt(this.parser.constructs.document, r, a), "linePrefix", this.parser.constructs.disable.null.includes("codeIndented") ? void 0 : 4);
}
function Bo(t) {
  if (t === null || Lt(t) || jl(t))
    return 1;
  if (hd(t))
    return 2;
}
function md(t, r, a) {
  const l = [];
  let s = -1;
  for (; ++s < t.length; ) {
    const c = t[s].resolveAll;
    c && !l.includes(c) && (r = c(r, a), l.push(c));
  }
  return r;
}
const hm = {
  name: "attention",
  resolveAll: b8,
  tokenize: x8
};
function b8(t, r) {
  let a = -1, l, s, c, d, m, g, p, v;
  for (; ++a < t.length; )
    if (t[a][0] === "enter" && t[a][1].type === "attentionSequence" && t[a][1]._close) {
      for (l = a; l--; )
        if (t[l][0] === "exit" && t[l][1].type === "attentionSequence" && t[l][1]._open && // If the markers are the same:
        r.sliceSerialize(t[l][1]).charCodeAt(0) === r.sliceSerialize(t[a][1]).charCodeAt(0)) {
          if ((t[l][1]._close || t[a][1]._open) && (t[a][1].end.offset - t[a][1].start.offset) % 3 && !((t[l][1].end.offset - t[l][1].start.offset + t[a][1].end.offset - t[a][1].start.offset) % 3))
            continue;
          g = t[l][1].end.offset - t[l][1].start.offset > 1 && t[a][1].end.offset - t[a][1].start.offset > 1 ? 2 : 1;
          const x = {
            ...t[l][1].end
          }, E = {
            ...t[a][1].start
          };
          oy(x, -g), oy(E, g), d = {
            type: g > 1 ? "strongSequence" : "emphasisSequence",
            start: x,
            end: {
              ...t[l][1].end
            }
          }, m = {
            type: g > 1 ? "strongSequence" : "emphasisSequence",
            start: {
              ...t[a][1].start
            },
            end: E
          }, c = {
            type: g > 1 ? "strongText" : "emphasisText",
            start: {
              ...t[l][1].end
            },
            end: {
              ...t[a][1].start
            }
          }, s = {
            type: g > 1 ? "strong" : "emphasis",
            start: {
              ...d.start
            },
            end: {
              ...m.end
            }
          }, t[l][1].end = {
            ...d.start
          }, t[a][1].start = {
            ...m.end
          }, p = [], t[l][1].end.offset - t[l][1].start.offset && (p = Tr(p, [["enter", t[l][1], r], ["exit", t[l][1], r]])), p = Tr(p, [["enter", s, r], ["enter", d, r], ["exit", d, r], ["enter", c, r]]), p = Tr(p, md(r.parser.constructs.insideSpan.null, t.slice(l + 1, a), r)), p = Tr(p, [["exit", c, r], ["enter", m, r], ["exit", m, r], ["exit", s, r]]), t[a][1].end.offset - t[a][1].start.offset ? (v = 2, p = Tr(p, [["enter", t[a][1], r], ["exit", t[a][1], r]])) : v = 0, pr(t, l - 1, a - l + 3, p), a = l + p.length - v - 2;
          break;
        }
    }
  for (a = -1; ++a < t.length; )
    t[a][1].type === "attentionSequence" && (t[a][1].type = "data");
  return t;
}
function x8(t, r) {
  const a = this.parser.constructs.attentionMarkers.null, l = this.previous, s = Bo(l);
  let c;
  return d;
  function d(g) {
    return c = g, t.enter("attentionSequence"), m(g);
  }
  function m(g) {
    if (g === c)
      return t.consume(g), m;
    const p = t.exit("attentionSequence"), v = Bo(g), x = !v || v === 2 && s || a.includes(g), E = !s || s === 2 && v || a.includes(l);
    return p._open = !!(c === 42 ? x : x && (s || !E)), p._close = !!(c === 42 ? E : E && (v || !x)), r(g);
  }
}
function oy(t, r) {
  t.column += r, t.offset += r, t._bufferIndex += r;
}
const v8 = {
  name: "autolink",
  tokenize: S8
};
function S8(t, r, a) {
  let l = 0;
  return s;
  function s(w) {
    return t.enter("autolink"), t.enter("autolinkMarker"), t.consume(w), t.exit("autolinkMarker"), t.enter("autolinkProtocol"), c;
  }
  function c(w) {
    return Hn(w) ? (t.consume(w), d) : w === 64 ? a(w) : p(w);
  }
  function d(w) {
    return w === 43 || w === 45 || w === 46 || Ln(w) ? (l = 1, m(w)) : p(w);
  }
  function m(w) {
    return w === 58 ? (t.consume(w), l = 0, g) : (w === 43 || w === 45 || w === 46 || Ln(w)) && l++ < 32 ? (t.consume(w), m) : (l = 0, p(w));
  }
  function g(w) {
    return w === 62 ? (t.exit("autolinkProtocol"), t.enter("autolinkMarker"), t.consume(w), t.exit("autolinkMarker"), t.exit("autolink"), r) : w === null || w === 32 || w === 60 || ed(w) ? a(w) : (t.consume(w), g);
  }
  function p(w) {
    return w === 64 ? (t.consume(w), v) : c8(w) ? (t.consume(w), p) : a(w);
  }
  function v(w) {
    return Ln(w) ? x(w) : a(w);
  }
  function x(w) {
    return w === 46 ? (t.consume(w), l = 0, v) : w === 62 ? (t.exit("autolinkProtocol").type = "autolinkEmail", t.enter("autolinkMarker"), t.consume(w), t.exit("autolinkMarker"), t.exit("autolink"), r) : E(w);
  }
  function E(w) {
    if ((w === 45 || Ln(w)) && l++ < 63) {
      const _ = w === 45 ? E : x;
      return t.consume(w), _;
    }
    return a(w);
  }
}
const bu = {
  partial: !0,
  tokenize: w8
};
function w8(t, r, a) {
  return l;
  function l(c) {
    return ht(c) ? vt(t, s, "linePrefix")(c) : s(c);
  }
  function s(c) {
    return c === null || et(c) ? r(c) : a(c);
  }
}
const Zb = {
  continuation: {
    tokenize: C8
  },
  exit: E8,
  name: "blockQuote",
  tokenize: k8
};
function k8(t, r, a) {
  const l = this;
  return s;
  function s(d) {
    if (d === 62) {
      const m = l.containerState;
      return m.open || (t.enter("blockQuote", {
        _container: !0
      }), m.open = !0), t.enter("blockQuotePrefix"), t.enter("blockQuoteMarker"), t.consume(d), t.exit("blockQuoteMarker"), c;
    }
    return a(d);
  }
  function c(d) {
    return ht(d) ? (t.enter("blockQuotePrefixWhitespace"), t.consume(d), t.exit("blockQuotePrefixWhitespace"), t.exit("blockQuotePrefix"), r) : (t.exit("blockQuotePrefix"), r(d));
  }
}
function C8(t, r, a) {
  const l = this;
  return s;
  function s(d) {
    return ht(d) ? vt(t, c, "linePrefix", l.parser.constructs.disable.null.includes("codeIndented") ? void 0 : 4)(d) : c(d);
  }
  function c(d) {
    return t.attempt(Zb, r, a)(d);
  }
}
function E8(t) {
  t.exit("blockQuote");
}
const Jb = {
  name: "characterEscape",
  tokenize: j8
};
function j8(t, r, a) {
  return l;
  function l(c) {
    return t.enter("characterEscape"), t.enter("escapeMarker"), t.consume(c), t.exit("escapeMarker"), s;
  }
  function s(c) {
    return f8(c) ? (t.enter("characterEscapeValue"), t.consume(c), t.exit("characterEscapeValue"), t.exit("characterEscape"), r) : a(c);
  }
}
const ex = {
  name: "characterReference",
  tokenize: _8
};
function _8(t, r, a) {
  const l = this;
  let s = 0, c, d;
  return m;
  function m(x) {
    return t.enter("characterReference"), t.enter("characterReferenceMarker"), t.consume(x), t.exit("characterReferenceMarker"), g;
  }
  function g(x) {
    return x === 35 ? (t.enter("characterReferenceMarkerNumeric"), t.consume(x), t.exit("characterReferenceMarkerNumeric"), p) : (t.enter("characterReferenceValue"), c = 31, d = Ln, v(x));
  }
  function p(x) {
    return x === 88 || x === 120 ? (t.enter("characterReferenceMarkerHexadecimal"), t.consume(x), t.exit("characterReferenceMarkerHexadecimal"), t.enter("characterReferenceValue"), c = 6, d = d8, v) : (t.enter("characterReferenceValue"), c = 7, d = fm, v(x));
  }
  function v(x) {
    if (x === 59 && s) {
      const E = t.exit("characterReferenceValue");
      return d === Ln && !Wm(l.sliceSerialize(E)) ? a(x) : (t.enter("characterReferenceMarker"), t.consume(x), t.exit("characterReferenceMarker"), t.exit("characterReference"), r);
    }
    return d(x) && s++ < c ? (t.consume(x), v) : a(x);
  }
}
const sy = {
  partial: !0,
  tokenize: T8
}, uy = {
  concrete: !0,
  name: "codeFenced",
  tokenize: N8
};
function N8(t, r, a) {
  const l = this, s = {
    partial: !0,
    tokenize: de
  };
  let c = 0, d = 0, m;
  return g;
  function g(I) {
    return p(I);
  }
  function p(I) {
    const V = l.events[l.events.length - 1];
    return c = V && V[1].type === "linePrefix" ? V[2].sliceSerialize(V[1], !0).length : 0, m = I, t.enter("codeFenced"), t.enter("codeFencedFence"), t.enter("codeFencedFenceSequence"), v(I);
  }
  function v(I) {
    return I === m ? (d++, t.consume(I), v) : d < 3 ? a(I) : (t.exit("codeFencedFenceSequence"), ht(I) ? vt(t, x, "whitespace")(I) : x(I));
  }
  function x(I) {
    return I === null || et(I) ? (t.exit("codeFencedFence"), l.interrupt ? r(I) : t.check(sy, A, ge)(I)) : (t.enter("codeFencedFenceInfo"), t.enter("chunkString", {
      contentType: "string"
    }), E(I));
  }
  function E(I) {
    return I === null || et(I) ? (t.exit("chunkString"), t.exit("codeFencedFenceInfo"), x(I)) : ht(I) ? (t.exit("chunkString"), t.exit("codeFencedFenceInfo"), vt(t, w, "whitespace")(I)) : I === 96 && I === m ? a(I) : (t.consume(I), E);
  }
  function w(I) {
    return I === null || et(I) ? x(I) : (t.enter("codeFencedFenceMeta"), t.enter("chunkString", {
      contentType: "string"
    }), _(I));
  }
  function _(I) {
    return I === null || et(I) ? (t.exit("chunkString"), t.exit("codeFencedFenceMeta"), x(I)) : I === 96 && I === m ? a(I) : (t.consume(I), _);
  }
  function A(I) {
    return t.attempt(s, ge, D)(I);
  }
  function D(I) {
    return t.enter("lineEnding"), t.consume(I), t.exit("lineEnding"), R;
  }
  function R(I) {
    return c > 0 && ht(I) ? vt(t, Z, "linePrefix", c + 1)(I) : Z(I);
  }
  function Z(I) {
    return I === null || et(I) ? t.check(sy, A, ge)(I) : (t.enter("codeFlowValue"), K(I));
  }
  function K(I) {
    return I === null || et(I) ? (t.exit("codeFlowValue"), Z(I)) : (t.consume(I), K);
  }
  function ge(I) {
    return t.exit("codeFenced"), r(I);
  }
  function de(I, V, we) {
    let Te = 0;
    return X;
    function X(je) {
      return I.enter("lineEnding"), I.consume(je), I.exit("lineEnding"), oe;
    }
    function oe(je) {
      return I.enter("codeFencedFence"), ht(je) ? vt(I, se, "linePrefix", l.parser.constructs.disable.null.includes("codeIndented") ? void 0 : 4)(je) : se(je);
    }
    function se(je) {
      return je === m ? (I.enter("codeFencedFenceSequence"), Re(je)) : we(je);
    }
    function Re(je) {
      return je === m ? (Te++, I.consume(je), Re) : Te >= d ? (I.exit("codeFencedFenceSequence"), ht(je) ? vt(I, be, "whitespace")(je) : be(je)) : we(je);
    }
    function be(je) {
      return je === null || et(je) ? (I.exit("codeFencedFence"), V(je)) : we(je);
    }
  }
}
function T8(t, r, a) {
  const l = this;
  return s;
  function s(d) {
    return d === null ? a(d) : (t.enter("lineEnding"), t.consume(d), t.exit("lineEnding"), c);
  }
  function c(d) {
    return l.parser.lazy[l.now().line] ? a(d) : r(d);
  }
}
const Ah = {
  name: "codeIndented",
  tokenize: M8
}, A8 = {
  partial: !0,
  tokenize: z8
};
function M8(t, r, a) {
  const l = this;
  return s;
  function s(p) {
    return t.enter("codeIndented"), vt(t, c, "linePrefix", 5)(p);
  }
  function c(p) {
    const v = l.events[l.events.length - 1];
    return v && v[1].type === "linePrefix" && v[2].sliceSerialize(v[1], !0).length >= 4 ? d(p) : a(p);
  }
  function d(p) {
    return p === null ? g(p) : et(p) ? t.attempt(A8, d, g)(p) : (t.enter("codeFlowValue"), m(p));
  }
  function m(p) {
    return p === null || et(p) ? (t.exit("codeFlowValue"), d(p)) : (t.consume(p), m);
  }
  function g(p) {
    return t.exit("codeIndented"), r(p);
  }
}
function z8(t, r, a) {
  const l = this;
  return s;
  function s(d) {
    return l.parser.lazy[l.now().line] ? a(d) : et(d) ? (t.enter("lineEnding"), t.consume(d), t.exit("lineEnding"), s) : vt(t, c, "linePrefix", 5)(d);
  }
  function c(d) {
    const m = l.events[l.events.length - 1];
    return m && m[1].type === "linePrefix" && m[2].sliceSerialize(m[1], !0).length >= 4 ? r(d) : et(d) ? s(d) : a(d);
  }
}
const R8 = {
  name: "codeText",
  previous: D8,
  resolve: O8,
  tokenize: L8
};
function O8(t) {
  let r = t.length - 4, a = 3, l, s;
  if ((t[a][1].type === "lineEnding" || t[a][1].type === "space") && (t[r][1].type === "lineEnding" || t[r][1].type === "space")) {
    for (l = a; ++l < r; )
      if (t[l][1].type === "codeTextData") {
        t[a][1].type = "codeTextPadding", t[r][1].type = "codeTextPadding", a += 2, r -= 2;
        break;
      }
  }
  for (l = a - 1, r++; ++l <= r; )
    s === void 0 ? l !== r && t[l][1].type !== "lineEnding" && (s = l) : (l === r || t[l][1].type === "lineEnding") && (t[s][1].type = "codeTextData", l !== s + 2 && (t[s][1].end = t[l - 1][1].end, t.splice(s + 2, l - s - 2), r -= l - s - 2, l = s + 2), s = void 0);
  return t;
}
function D8(t) {
  return t !== 96 || this.events[this.events.length - 1][1].type === "characterEscape";
}
function L8(t, r, a) {
  let l = 0, s, c;
  return d;
  function d(x) {
    return t.enter("codeText"), t.enter("codeTextSequence"), m(x);
  }
  function m(x) {
    return x === 96 ? (t.consume(x), l++, m) : (t.exit("codeTextSequence"), g(x));
  }
  function g(x) {
    return x === null ? a(x) : x === 32 ? (t.enter("space"), t.consume(x), t.exit("space"), g) : x === 96 ? (c = t.enter("codeTextSequence"), s = 0, v(x)) : et(x) ? (t.enter("lineEnding"), t.consume(x), t.exit("lineEnding"), g) : (t.enter("codeTextData"), p(x));
  }
  function p(x) {
    return x === null || x === 32 || x === 96 || et(x) ? (t.exit("codeTextData"), g(x)) : (t.consume(x), p);
  }
  function v(x) {
    return x === 96 ? (t.consume(x), s++, v) : s === l ? (t.exit("codeTextSequence"), t.exit("codeText"), r(x)) : (c.type = "codeTextData", p(x));
  }
}
class B8 {
  /**
   * @param {ReadonlyArray<T> | null | undefined} [initial]
   *   Initial items (optional).
   * @returns
   *   Splice buffer.
   */
  constructor(r) {
    this.left = r ? [...r] : [], this.right = [];
  }
  /**
   * Array access;
   * does not move the cursor.
   *
   * @param {number} index
   *   Index.
   * @return {T}
   *   Item.
   */
  get(r) {
    if (r < 0 || r >= this.left.length + this.right.length)
      throw new RangeError("Cannot access index `" + r + "` in a splice buffer of size `" + (this.left.length + this.right.length) + "`");
    return r < this.left.length ? this.left[r] : this.right[this.right.length - r + this.left.length - 1];
  }
  /**
   * The length of the splice buffer, one greater than the largest index in the
   * array.
   */
  get length() {
    return this.left.length + this.right.length;
  }
  /**
   * Remove and return `list[0]`;
   * moves the cursor to `0`.
   *
   * @returns {T | undefined}
   *   Item, optional.
   */
  shift() {
    return this.setCursor(0), this.right.pop();
  }
  /**
   * Slice the buffer to get an array;
   * does not move the cursor.
   *
   * @param {number} start
   *   Start.
   * @param {number | null | undefined} [end]
   *   End (optional).
   * @returns {Array<T>}
   *   Array of items.
   */
  slice(r, a) {
    const l = a ?? Number.POSITIVE_INFINITY;
    return l < this.left.length ? this.left.slice(r, l) : r > this.left.length ? this.right.slice(this.right.length - l + this.left.length, this.right.length - r + this.left.length).reverse() : this.left.slice(r).concat(this.right.slice(this.right.length - l + this.left.length).reverse());
  }
  /**
   * Mimics the behavior of Array.prototype.splice() except for the change of
   * interface necessary to avoid segfaults when patching in very large arrays.
   *
   * This operation moves cursor is moved to `start` and results in the cursor
   * placed after any inserted items.
   *
   * @param {number} start
   *   Start;
   *   zero-based index at which to start changing the array;
   *   negative numbers count backwards from the end of the array and values
   *   that are out-of bounds are clamped to the appropriate end of the array.
   * @param {number | null | undefined} [deleteCount=0]
   *   Delete count (default: `0`);
   *   maximum number of elements to delete, starting from start.
   * @param {Array<T> | null | undefined} [items=[]]
   *   Items to include in place of the deleted items (default: `[]`).
   * @return {Array<T>}
   *   Any removed items.
   */
  splice(r, a, l) {
    const s = a || 0;
    this.setCursor(Math.trunc(r));
    const c = this.right.splice(this.right.length - s, Number.POSITIVE_INFINITY);
    return l && Xs(this.left, l), c.reverse();
  }
  /**
   * Remove and return the highest-numbered item in the array, so
   * `list[list.length - 1]`;
   * Moves the cursor to `length`.
   *
   * @returns {T | undefined}
   *   Item, optional.
   */
  pop() {
    return this.setCursor(Number.POSITIVE_INFINITY), this.left.pop();
  }
  /**
   * Inserts a single item to the high-numbered side of the array;
   * moves the cursor to `length`.
   *
   * @param {T} item
   *   Item.
   * @returns {undefined}
   *   Nothing.
   */
  push(r) {
    this.setCursor(Number.POSITIVE_INFINITY), this.left.push(r);
  }
  /**
   * Inserts many items to the high-numbered side of the array.
   * Moves the cursor to `length`.
   *
   * @param {Array<T>} items
   *   Items.
   * @returns {undefined}
   *   Nothing.
   */
  pushMany(r) {
    this.setCursor(Number.POSITIVE_INFINITY), Xs(this.left, r);
  }
  /**
   * Inserts a single item to the low-numbered side of the array;
   * Moves the cursor to `0`.
   *
   * @param {T} item
   *   Item.
   * @returns {undefined}
   *   Nothing.
   */
  unshift(r) {
    this.setCursor(0), this.right.push(r);
  }
  /**
   * Inserts many items to the low-numbered side of the array;
   * moves the cursor to `0`.
   *
   * @param {Array<T>} items
   *   Items.
   * @returns {undefined}
   *   Nothing.
   */
  unshiftMany(r) {
    this.setCursor(0), Xs(this.right, r.reverse());
  }
  /**
   * Move the cursor to a specific position in the array. Requires
   * time proportional to the distance moved.
   *
   * If `n < 0`, the cursor will end up at the beginning.
   * If `n > length`, the cursor will end up at the end.
   *
   * @param {number} n
   *   Position.
   * @return {undefined}
   *   Nothing.
   */
  setCursor(r) {
    if (!(r === this.left.length || r > this.left.length && this.right.length === 0 || r < 0 && this.left.length === 0))
      if (r < this.left.length) {
        const a = this.left.splice(r, Number.POSITIVE_INFINITY);
        Xs(this.right, a.reverse());
      } else {
        const a = this.right.splice(this.left.length + this.right.length - r, Number.POSITIVE_INFINITY);
        Xs(this.left, a.reverse());
      }
  }
}
function Xs(t, r) {
  let a = 0;
  if (r.length < 1e4)
    t.push(...r);
  else
    for (; a < r.length; )
      t.push(...r.slice(a, a + 1e4)), a += 1e4;
}
function tx(t) {
  const r = {};
  let a = -1, l, s, c, d, m, g, p;
  const v = new B8(t);
  for (; ++a < v.length; ) {
    for (; a in r; )
      a = r[a];
    if (l = v.get(a), a && l[1].type === "chunkFlow" && v.get(a - 1)[1].type === "listItemPrefix" && (g = l[1]._tokenizer.events, c = 0, c < g.length && g[c][1].type === "lineEndingBlank" && (c += 2), c < g.length && g[c][1].type === "content"))
      for (; ++c < g.length && g[c][1].type !== "content"; )
        g[c][1].type === "chunkText" && (g[c][1]._isInFirstContentOfListItem = !0, c++);
    if (l[0] === "enter")
      l[1].contentType && (Object.assign(r, I8(v, a)), a = r[a], p = !0);
    else if (l[1]._container) {
      for (c = a, s = void 0; c--; )
        if (d = v.get(c), d[1].type === "lineEnding" || d[1].type === "lineEndingBlank")
          d[0] === "enter" && (s && (v.get(s)[1].type = "lineEndingBlank"), d[1].type = "lineEnding", s = c);
        else if (!(d[1].type === "linePrefix" || d[1].type === "listItemIndent")) break;
      s && (l[1].end = {
        ...v.get(s)[1].start
      }, m = v.slice(s, a), m.unshift(l), v.splice(s, a - s + 1, m));
    }
  }
  return pr(t, 0, Number.POSITIVE_INFINITY, v.slice(0)), !p;
}
function I8(t, r) {
  const a = t.get(r)[1], l = t.get(r)[2];
  let s = r - 1;
  const c = [];
  let d = a._tokenizer;
  d || (d = l.parser[a.contentType](a.start), a._contentTypeTextTrailing && (d._contentTypeTextTrailing = !0));
  const m = d.events, g = [], p = {};
  let v, x, E = -1, w = a, _ = 0, A = 0;
  const D = [A];
  for (; w; ) {
    for (; t.get(++s)[1] !== w; )
      ;
    c.push(s), w._tokenizer || (v = l.sliceStream(w), w.next || v.push(null), x && d.defineSkip(w.start), w._isInFirstContentOfListItem && (d._gfmTasklistFirstContentOfListItem = !0), d.write(v), w._isInFirstContentOfListItem && (d._gfmTasklistFirstContentOfListItem = void 0)), x = w, w = w.next;
  }
  for (w = a; ++E < m.length; )
    // Find a void token that includes a break.
    m[E][0] === "exit" && m[E - 1][0] === "enter" && m[E][1].type === m[E - 1][1].type && m[E][1].start.line !== m[E][1].end.line && (A = E + 1, D.push(A), w._tokenizer = void 0, w.previous = void 0, w = w.next);
  for (d.events = [], w ? (w._tokenizer = void 0, w.previous = void 0) : D.pop(), E = D.length; E--; ) {
    const R = m.slice(D[E], D[E + 1]), Z = c.pop();
    g.push([Z, Z + R.length - 1]), t.splice(Z, 2, R);
  }
  for (g.reverse(), E = -1; ++E < g.length; )
    p[_ + g[E][0]] = _ + g[E][1], _ += g[E][1] - g[E][0] - 1;
  return p;
}
const U8 = {
  resolve: q8,
  tokenize: H8
}, P8 = {
  partial: !0,
  tokenize: F8
};
function q8(t) {
  return tx(t), t;
}
function H8(t, r) {
  let a;
  return l;
  function l(m) {
    return t.enter("content"), a = t.enter("chunkContent", {
      contentType: "content"
    }), s(m);
  }
  function s(m) {
    return m === null ? c(m) : et(m) ? t.check(P8, d, c)(m) : (t.consume(m), s);
  }
  function c(m) {
    return t.exit("chunkContent"), t.exit("content"), r(m);
  }
  function d(m) {
    return t.consume(m), t.exit("chunkContent"), a.next = t.enter("chunkContent", {
      contentType: "content",
      previous: a
    }), a = a.next, s;
  }
}
function F8(t, r, a) {
  const l = this;
  return s;
  function s(d) {
    return t.exit("chunkContent"), t.enter("lineEnding"), t.consume(d), t.exit("lineEnding"), vt(t, c, "linePrefix");
  }
  function c(d) {
    if (d === null || et(d))
      return a(d);
    const m = l.events[l.events.length - 1];
    return !l.parser.constructs.disable.null.includes("codeIndented") && m && m[1].type === "linePrefix" && m[2].sliceSerialize(m[1], !0).length >= 4 ? r(d) : t.interrupt(l.parser.constructs.flow, a, r)(d);
  }
}
function nx(t, r, a, l, s, c, d, m, g) {
  const p = g || Number.POSITIVE_INFINITY;
  let v = 0;
  return x;
  function x(R) {
    return R === 60 ? (t.enter(l), t.enter(s), t.enter(c), t.consume(R), t.exit(c), E) : R === null || R === 32 || R === 41 || ed(R) ? a(R) : (t.enter(l), t.enter(d), t.enter(m), t.enter("chunkString", {
      contentType: "string"
    }), A(R));
  }
  function E(R) {
    return R === 62 ? (t.enter(c), t.consume(R), t.exit(c), t.exit(s), t.exit(l), r) : (t.enter(m), t.enter("chunkString", {
      contentType: "string"
    }), w(R));
  }
  function w(R) {
    return R === 62 ? (t.exit("chunkString"), t.exit(m), E(R)) : R === null || R === 60 || et(R) ? a(R) : (t.consume(R), R === 92 ? _ : w);
  }
  function _(R) {
    return R === 60 || R === 62 || R === 92 ? (t.consume(R), w) : w(R);
  }
  function A(R) {
    return !v && (R === null || R === 41 || Lt(R)) ? (t.exit("chunkString"), t.exit(m), t.exit(d), t.exit(l), r(R)) : v < p && R === 40 ? (t.consume(R), v++, A) : R === 41 ? (t.consume(R), v--, A) : R === null || R === 32 || R === 40 || ed(R) ? a(R) : (t.consume(R), R === 92 ? D : A);
  }
  function D(R) {
    return R === 40 || R === 41 || R === 92 ? (t.consume(R), A) : A(R);
  }
}
function rx(t, r, a, l, s, c) {
  const d = this;
  let m = 0, g;
  return p;
  function p(w) {
    return t.enter(l), t.enter(s), t.consume(w), t.exit(s), t.enter(c), v;
  }
  function v(w) {
    return m > 999 || w === null || w === 91 || w === 93 && !g || // To do: remove in the future once weve switched from
    // `micromark-extension-footnote` to `micromark-extension-gfm-footnote`,
    // which doesnt need this.
    // Hidden footnotes hook.
    /* c8 ignore next 3 */
    w === 94 && !m && "_hiddenFootnoteSupport" in d.parser.constructs ? a(w) : w === 93 ? (t.exit(c), t.enter(s), t.consume(w), t.exit(s), t.exit(l), r) : et(w) ? (t.enter("lineEnding"), t.consume(w), t.exit("lineEnding"), v) : (t.enter("chunkString", {
      contentType: "string"
    }), x(w));
  }
  function x(w) {
    return w === null || w === 91 || w === 93 || et(w) || m++ > 999 ? (t.exit("chunkString"), v(w)) : (t.consume(w), g || (g = !ht(w)), w === 92 ? E : x);
  }
  function E(w) {
    return w === 91 || w === 92 || w === 93 ? (t.consume(w), m++, x) : x(w);
  }
}
function ax(t, r, a, l, s, c) {
  let d;
  return m;
  function m(E) {
    return E === 34 || E === 39 || E === 40 ? (t.enter(l), t.enter(s), t.consume(E), t.exit(s), d = E === 40 ? 41 : E, g) : a(E);
  }
  function g(E) {
    return E === d ? (t.enter(s), t.consume(E), t.exit(s), t.exit(l), r) : (t.enter(c), p(E));
  }
  function p(E) {
    return E === d ? (t.exit(c), g(d)) : E === null ? a(E) : et(E) ? (t.enter("lineEnding"), t.consume(E), t.exit("lineEnding"), vt(t, p, "linePrefix")) : (t.enter("chunkString", {
      contentType: "string"
    }), v(E));
  }
  function v(E) {
    return E === d || E === null || et(E) ? (t.exit("chunkString"), p(E)) : (t.consume(E), E === 92 ? x : v);
  }
  function x(E) {
    return E === d || E === 92 ? (t.consume(E), v) : v(E);
  }
}
function au(t, r) {
  let a;
  return l;
  function l(s) {
    return et(s) ? (t.enter("lineEnding"), t.consume(s), t.exit("lineEnding"), a = !0, l) : ht(s) ? vt(t, l, a ? "linePrefix" : "lineSuffix")(s) : r(s);
  }
}
const $8 = {
  name: "definition",
  tokenize: V8
}, G8 = {
  partial: !0,
  tokenize: K8
};
function V8(t, r, a) {
  const l = this;
  let s;
  return c;
  function c(w) {
    return t.enter("definition"), d(w);
  }
  function d(w) {
    return rx.call(
      l,
      t,
      m,
      // Note: we dont need to reset the way `markdown-rs` does.
      a,
      "definitionLabel",
      "definitionLabelMarker",
      "definitionLabelString"
    )(w);
  }
  function m(w) {
    return s = Pr(l.sliceSerialize(l.events[l.events.length - 1][1]).slice(1, -1)), w === 58 ? (t.enter("definitionMarker"), t.consume(w), t.exit("definitionMarker"), g) : a(w);
  }
  function g(w) {
    return Lt(w) ? au(t, p)(w) : p(w);
  }
  function p(w) {
    return nx(
      t,
      v,
      // Note: we dont need to reset the way `markdown-rs` does.
      a,
      "definitionDestination",
      "definitionDestinationLiteral",
      "definitionDestinationLiteralMarker",
      "definitionDestinationRaw",
      "definitionDestinationString"
    )(w);
  }
  function v(w) {
    return t.attempt(G8, x, x)(w);
  }
  function x(w) {
    return ht(w) ? vt(t, E, "whitespace")(w) : E(w);
  }
  function E(w) {
    return w === null || et(w) ? (t.exit("definition"), l.parser.defined.push(s), r(w)) : a(w);
  }
}
function K8(t, r, a) {
  return l;
  function l(m) {
    return Lt(m) ? au(t, s)(m) : a(m);
  }
  function s(m) {
    return ax(t, c, a, "definitionTitle", "definitionTitleMarker", "definitionTitleString")(m);
  }
  function c(m) {
    return ht(m) ? vt(t, d, "whitespace")(m) : d(m);
  }
  function d(m) {
    return m === null || et(m) ? r(m) : a(m);
  }
}
const Y8 = {
  name: "hardBreakEscape",
  tokenize: Q8
};
function Q8(t, r, a) {
  return l;
  function l(c) {
    return t.enter("hardBreakEscape"), t.consume(c), s;
  }
  function s(c) {
    return et(c) ? (t.exit("hardBreakEscape"), r(c)) : a(c);
  }
}
const X8 = {
  name: "headingAtx",
  resolve: W8,
  tokenize: Z8
};
function W8(t, r) {
  let a = t.length - 2, l = 3, s, c;
  return t[l][1].type === "whitespace" && (l += 2), a - 2 > l && t[a][1].type === "whitespace" && (a -= 2), t[a][1].type === "atxHeadingSequence" && (l === a - 1 || a - 4 > l && t[a - 2][1].type === "whitespace") && (a -= l + 1 === a ? 2 : 4), a > l && (s = {
    type: "atxHeadingText",
    start: t[l][1].start,
    end: t[a][1].end
  }, c = {
    type: "chunkText",
    start: t[l][1].start,
    end: t[a][1].end,
    contentType: "text"
  }, pr(t, l, a - l + 1, [["enter", s, r], ["enter", c, r], ["exit", c, r], ["exit", s, r]])), t;
}
function Z8(t, r, a) {
  let l = 0;
  return s;
  function s(v) {
    return t.enter("atxHeading"), c(v);
  }
  function c(v) {
    return t.enter("atxHeadingSequence"), d(v);
  }
  function d(v) {
    return v === 35 && l++ < 6 ? (t.consume(v), d) : v === null || Lt(v) ? (t.exit("atxHeadingSequence"), m(v)) : a(v);
  }
  function m(v) {
    return v === 35 ? (t.enter("atxHeadingSequence"), g(v)) : v === null || et(v) ? (t.exit("atxHeading"), r(v)) : ht(v) ? vt(t, m, "whitespace")(v) : (t.enter("atxHeadingText"), p(v));
  }
  function g(v) {
    return v === 35 ? (t.consume(v), g) : (t.exit("atxHeadingSequence"), m(v));
  }
  function p(v) {
    return v === null || v === 35 || Lt(v) ? (t.exit("atxHeadingText"), m(v)) : (t.consume(v), p);
  }
}
const J8 = [
  "address",
  "article",
  "aside",
  "base",
  "basefont",
  "blockquote",
  "body",
  "caption",
  "center",
  "col",
  "colgroup",
  "dd",
  "details",
  "dialog",
  "dir",
  "div",
  "dl",
  "dt",
  "fieldset",
  "figcaption",
  "figure",
  "footer",
  "form",
  "frame",
  "frameset",
  "h1",
  "h2",
  "h3",
  "h4",
  "h5",
  "h6",
  "head",
  "header",
  "hr",
  "html",
  "iframe",
  "legend",
  "li",
  "link",
  "main",
  "menu",
  "menuitem",
  "nav",
  "noframes",
  "ol",
  "optgroup",
  "option",
  "p",
  "param",
  "search",
  "section",
  "summary",
  "table",
  "tbody",
  "td",
  "tfoot",
  "th",
  "thead",
  "title",
  "tr",
  "track",
  "ul"
], cy = ["pre", "script", "style", "textarea"], eS = {
  concrete: !0,
  name: "htmlFlow",
  resolveTo: rS,
  tokenize: aS
}, tS = {
  partial: !0,
  tokenize: lS
}, nS = {
  partial: !0,
  tokenize: iS
};
function rS(t) {
  let r = t.length;
  for (; r-- && !(t[r][0] === "enter" && t[r][1].type === "htmlFlow"); )
    ;
  return r > 1 && t[r - 2][1].type === "linePrefix" && (t[r][1].start = t[r - 2][1].start, t[r + 1][1].start = t[r - 2][1].start, t.splice(r - 2, 2)), t;
}
function aS(t, r, a) {
  const l = this;
  let s, c, d, m, g;
  return p;
  function p(M) {
    return v(M);
  }
  function v(M) {
    return t.enter("htmlFlow"), t.enter("htmlFlowData"), t.consume(M), x;
  }
  function x(M) {
    return M === 33 ? (t.consume(M), E) : M === 47 ? (t.consume(M), c = !0, A) : M === 63 ? (t.consume(M), s = 3, l.interrupt ? r : O) : Hn(M) ? (t.consume(M), d = String.fromCharCode(M), D) : a(M);
  }
  function E(M) {
    return M === 45 ? (t.consume(M), s = 2, w) : M === 91 ? (t.consume(M), s = 5, m = 0, _) : Hn(M) ? (t.consume(M), s = 4, l.interrupt ? r : O) : a(M);
  }
  function w(M) {
    return M === 45 ? (t.consume(M), l.interrupt ? r : O) : a(M);
  }
  function _(M) {
    const Ie = "CDATA[";
    return M === Ie.charCodeAt(m++) ? (t.consume(M), m === Ie.length ? l.interrupt ? r : se : _) : a(M);
  }
  function A(M) {
    return Hn(M) ? (t.consume(M), d = String.fromCharCode(M), D) : a(M);
  }
  function D(M) {
    if (M === null || M === 47 || M === 62 || Lt(M)) {
      const Ie = M === 47, Ye = d.toLowerCase();
      return !Ie && !c && cy.includes(Ye) ? (s = 1, l.interrupt ? r(M) : se(M)) : J8.includes(d.toLowerCase()) ? (s = 6, Ie ? (t.consume(M), R) : l.interrupt ? r(M) : se(M)) : (s = 7, l.interrupt && !l.parser.lazy[l.now().line] ? a(M) : c ? Z(M) : K(M));
    }
    return M === 45 || Ln(M) ? (t.consume(M), d += String.fromCharCode(M), D) : a(M);
  }
  function R(M) {
    return M === 62 ? (t.consume(M), l.interrupt ? r : se) : a(M);
  }
  function Z(M) {
    return ht(M) ? (t.consume(M), Z) : X(M);
  }
  function K(M) {
    return M === 47 ? (t.consume(M), X) : M === 58 || M === 95 || Hn(M) ? (t.consume(M), ge) : ht(M) ? (t.consume(M), K) : X(M);
  }
  function ge(M) {
    return M === 45 || M === 46 || M === 58 || M === 95 || Ln(M) ? (t.consume(M), ge) : de(M);
  }
  function de(M) {
    return M === 61 ? (t.consume(M), I) : ht(M) ? (t.consume(M), de) : K(M);
  }
  function I(M) {
    return M === null || M === 60 || M === 61 || M === 62 || M === 96 ? a(M) : M === 34 || M === 39 ? (t.consume(M), g = M, V) : ht(M) ? (t.consume(M), I) : we(M);
  }
  function V(M) {
    return M === g ? (t.consume(M), g = null, Te) : M === null || et(M) ? a(M) : (t.consume(M), V);
  }
  function we(M) {
    return M === null || M === 34 || M === 39 || M === 47 || M === 60 || M === 61 || M === 62 || M === 96 || Lt(M) ? de(M) : (t.consume(M), we);
  }
  function Te(M) {
    return M === 47 || M === 62 || ht(M) ? K(M) : a(M);
  }
  function X(M) {
    return M === 62 ? (t.consume(M), oe) : a(M);
  }
  function oe(M) {
    return M === null || et(M) ? se(M) : ht(M) ? (t.consume(M), oe) : a(M);
  }
  function se(M) {
    return M === 45 && s === 2 ? (t.consume(M), re) : M === 60 && s === 1 ? (t.consume(M), _e) : M === 62 && s === 4 ? (t.consume(M), L) : M === 63 && s === 3 ? (t.consume(M), O) : M === 93 && s === 5 ? (t.consume(M), Ue) : et(M) && (s === 6 || s === 7) ? (t.exit("htmlFlowData"), t.check(tS, he, Re)(M)) : M === null || et(M) ? (t.exit("htmlFlowData"), Re(M)) : (t.consume(M), se);
  }
  function Re(M) {
    return t.check(nS, be, he)(M);
  }
  function be(M) {
    return t.enter("lineEnding"), t.consume(M), t.exit("lineEnding"), je;
  }
  function je(M) {
    return M === null || et(M) ? Re(M) : (t.enter("htmlFlowData"), se(M));
  }
  function re(M) {
    return M === 45 ? (t.consume(M), O) : se(M);
  }
  function _e(M) {
    return M === 47 ? (t.consume(M), d = "", fe) : se(M);
  }
  function fe(M) {
    if (M === 62) {
      const Ie = d.toLowerCase();
      return cy.includes(Ie) ? (t.consume(M), L) : se(M);
    }
    return Hn(M) && d.length < 8 ? (t.consume(M), d += String.fromCharCode(M), fe) : se(M);
  }
  function Ue(M) {
    return M === 93 ? (t.consume(M), O) : se(M);
  }
  function O(M) {
    return M === 62 ? (t.consume(M), L) : M === 45 && s === 2 ? (t.consume(M), O) : se(M);
  }
  function L(M) {
    return M === null || et(M) ? (t.exit("htmlFlowData"), he(M)) : (t.consume(M), L);
  }
  function he(M) {
    return t.exit("htmlFlow"), r(M);
  }
}
function iS(t, r, a) {
  const l = this;
  return s;
  function s(d) {
    return et(d) ? (t.enter("lineEnding"), t.consume(d), t.exit("lineEnding"), c) : a(d);
  }
  function c(d) {
    return l.parser.lazy[l.now().line] ? a(d) : r(d);
  }
}
function lS(t, r, a) {
  return l;
  function l(s) {
    return t.enter("lineEnding"), t.consume(s), t.exit("lineEnding"), t.attempt(bu, r, a);
  }
}
const oS = {
  name: "htmlText",
  tokenize: sS
};
function sS(t, r, a) {
  const l = this;
  let s, c, d;
  return m;
  function m(O) {
    return t.enter("htmlText"), t.enter("htmlTextData"), t.consume(O), g;
  }
  function g(O) {
    return O === 33 ? (t.consume(O), p) : O === 47 ? (t.consume(O), de) : O === 63 ? (t.consume(O), K) : Hn(O) ? (t.consume(O), we) : a(O);
  }
  function p(O) {
    return O === 45 ? (t.consume(O), v) : O === 91 ? (t.consume(O), c = 0, _) : Hn(O) ? (t.consume(O), Z) : a(O);
  }
  function v(O) {
    return O === 45 ? (t.consume(O), w) : a(O);
  }
  function x(O) {
    return O === null ? a(O) : O === 45 ? (t.consume(O), E) : et(O) ? (d = x, _e(O)) : (t.consume(O), x);
  }
  function E(O) {
    return O === 45 ? (t.consume(O), w) : x(O);
  }
  function w(O) {
    return O === 62 ? re(O) : O === 45 ? E(O) : x(O);
  }
  function _(O) {
    const L = "CDATA[";
    return O === L.charCodeAt(c++) ? (t.consume(O), c === L.length ? A : _) : a(O);
  }
  function A(O) {
    return O === null ? a(O) : O === 93 ? (t.consume(O), D) : et(O) ? (d = A, _e(O)) : (t.consume(O), A);
  }
  function D(O) {
    return O === 93 ? (t.consume(O), R) : A(O);
  }
  function R(O) {
    return O === 62 ? re(O) : O === 93 ? (t.consume(O), R) : A(O);
  }
  function Z(O) {
    return O === null || O === 62 ? re(O) : et(O) ? (d = Z, _e(O)) : (t.consume(O), Z);
  }
  function K(O) {
    return O === null ? a(O) : O === 63 ? (t.consume(O), ge) : et(O) ? (d = K, _e(O)) : (t.consume(O), K);
  }
  function ge(O) {
    return O === 62 ? re(O) : K(O);
  }
  function de(O) {
    return Hn(O) ? (t.consume(O), I) : a(O);
  }
  function I(O) {
    return O === 45 || Ln(O) ? (t.consume(O), I) : V(O);
  }
  function V(O) {
    return et(O) ? (d = V, _e(O)) : ht(O) ? (t.consume(O), V) : re(O);
  }
  function we(O) {
    return O === 45 || Ln(O) ? (t.consume(O), we) : O === 47 || O === 62 || Lt(O) ? Te(O) : a(O);
  }
  function Te(O) {
    return O === 47 ? (t.consume(O), re) : O === 58 || O === 95 || Hn(O) ? (t.consume(O), X) : et(O) ? (d = Te, _e(O)) : ht(O) ? (t.consume(O), Te) : re(O);
  }
  function X(O) {
    return O === 45 || O === 46 || O === 58 || O === 95 || Ln(O) ? (t.consume(O), X) : oe(O);
  }
  function oe(O) {
    return O === 61 ? (t.consume(O), se) : et(O) ? (d = oe, _e(O)) : ht(O) ? (t.consume(O), oe) : Te(O);
  }
  function se(O) {
    return O === null || O === 60 || O === 61 || O === 62 || O === 96 ? a(O) : O === 34 || O === 39 ? (t.consume(O), s = O, Re) : et(O) ? (d = se, _e(O)) : ht(O) ? (t.consume(O), se) : (t.consume(O), be);
  }
  function Re(O) {
    return O === s ? (t.consume(O), s = void 0, je) : O === null ? a(O) : et(O) ? (d = Re, _e(O)) : (t.consume(O), Re);
  }
  function be(O) {
    return O === null || O === 34 || O === 39 || O === 60 || O === 61 || O === 96 ? a(O) : O === 47 || O === 62 || Lt(O) ? Te(O) : (t.consume(O), be);
  }
  function je(O) {
    return O === 47 || O === 62 || Lt(O) ? Te(O) : a(O);
  }
  function re(O) {
    return O === 62 ? (t.consume(O), t.exit("htmlTextData"), t.exit("htmlText"), r) : a(O);
  }
  function _e(O) {
    return t.exit("htmlTextData"), t.enter("lineEnding"), t.consume(O), t.exit("lineEnding"), fe;
  }
  function fe(O) {
    return ht(O) ? vt(t, Ue, "linePrefix", l.parser.constructs.disable.null.includes("codeIndented") ? void 0 : 4)(O) : Ue(O);
  }
  function Ue(O) {
    return t.enter("htmlTextData"), d(O);
  }
}
const Zm = {
  name: "labelEnd",
  resolveAll: fS,
  resolveTo: hS,
  tokenize: mS
}, uS = {
  tokenize: pS
}, cS = {
  tokenize: gS
}, dS = {
  tokenize: yS
};
function fS(t) {
  let r = -1;
  const a = [];
  for (; ++r < t.length; ) {
    const l = t[r][1];
    if (a.push(t[r]), l.type === "labelImage" || l.type === "labelLink" || l.type === "labelEnd") {
      const s = l.type === "labelImage" ? 4 : 2;
      l.type = "data", r += s;
    }
  }
  return t.length !== a.length && pr(t, 0, t.length, a), t;
}
function hS(t, r) {
  let a = t.length, l = 0, s, c, d, m;
  for (; a--; )
    if (s = t[a][1], c) {
      if (s.type === "link" || s.type === "labelLink" && s._inactive)
        break;
      t[a][0] === "enter" && s.type === "labelLink" && (s._inactive = !0);
    } else if (d) {
      if (t[a][0] === "enter" && (s.type === "labelImage" || s.type === "labelLink") && !s._balanced && (c = a, s.type !== "labelLink")) {
        l = 2;
        break;
      }
    } else s.type === "labelEnd" && (d = a);
  const g = {
    type: t[c][1].type === "labelLink" ? "link" : "image",
    start: {
      ...t[c][1].start
    },
    end: {
      ...t[t.length - 1][1].end
    }
  }, p = {
    type: "label",
    start: {
      ...t[c][1].start
    },
    end: {
      ...t[d][1].end
    }
  }, v = {
    type: "labelText",
    start: {
      ...t[c + l + 2][1].end
    },
    end: {
      ...t[d - 2][1].start
    }
  };
  return m = [["enter", g, r], ["enter", p, r]], m = Tr(m, t.slice(c + 1, c + l + 3)), m = Tr(m, [["enter", v, r]]), m = Tr(m, md(r.parser.constructs.insideSpan.null, t.slice(c + l + 4, d - 3), r)), m = Tr(m, [["exit", v, r], t[d - 2], t[d - 1], ["exit", p, r]]), m = Tr(m, t.slice(d + 1)), m = Tr(m, [["exit", g, r]]), pr(t, c, t.length, m), t;
}
function mS(t, r, a) {
  const l = this;
  let s = l.events.length, c, d;
  for (; s--; )
    if ((l.events[s][1].type === "labelImage" || l.events[s][1].type === "labelLink") && !l.events[s][1]._balanced) {
      c = l.events[s][1];
      break;
    }
  return m;
  function m(E) {
    return c ? c._inactive ? x(E) : (d = l.parser.defined.includes(Pr(l.sliceSerialize({
      start: c.end,
      end: l.now()
    }))), t.enter("labelEnd"), t.enter("labelMarker"), t.consume(E), t.exit("labelMarker"), t.exit("labelEnd"), g) : a(E);
  }
  function g(E) {
    return E === 40 ? t.attempt(uS, v, d ? v : x)(E) : E === 91 ? t.attempt(cS, v, d ? p : x)(E) : d ? v(E) : x(E);
  }
  function p(E) {
    return t.attempt(dS, v, x)(E);
  }
  function v(E) {
    return r(E);
  }
  function x(E) {
    return c._balanced = !0, a(E);
  }
}
function pS(t, r, a) {
  return l;
  function l(x) {
    return t.enter("resource"), t.enter("resourceMarker"), t.consume(x), t.exit("resourceMarker"), s;
  }
  function s(x) {
    return Lt(x) ? au(t, c)(x) : c(x);
  }
  function c(x) {
    return x === 41 ? v(x) : nx(t, d, m, "resourceDestination", "resourceDestinationLiteral", "resourceDestinationLiteralMarker", "resourceDestinationRaw", "resourceDestinationString", 32)(x);
  }
  function d(x) {
    return Lt(x) ? au(t, g)(x) : v(x);
  }
  function m(x) {
    return a(x);
  }
  function g(x) {
    return x === 34 || x === 39 || x === 40 ? ax(t, p, a, "resourceTitle", "resourceTitleMarker", "resourceTitleString")(x) : v(x);
  }
  function p(x) {
    return Lt(x) ? au(t, v)(x) : v(x);
  }
  function v(x) {
    return x === 41 ? (t.enter("resourceMarker"), t.consume(x), t.exit("resourceMarker"), t.exit("resource"), r) : a(x);
  }
}
function gS(t, r, a) {
  const l = this;
  return s;
  function s(m) {
    return rx.call(l, t, c, d, "reference", "referenceMarker", "referenceString")(m);
  }
  function c(m) {
    return l.parser.defined.includes(Pr(l.sliceSerialize(l.events[l.events.length - 1][1]).slice(1, -1))) ? r(m) : a(m);
  }
  function d(m) {
    return a(m);
  }
}
function yS(t, r, a) {
  return l;
  function l(c) {
    return t.enter("reference"), t.enter("referenceMarker"), t.consume(c), t.exit("referenceMarker"), s;
  }
  function s(c) {
    return c === 93 ? (t.enter("referenceMarker"), t.consume(c), t.exit("referenceMarker"), t.exit("reference"), r) : a(c);
  }
}
const bS = {
  name: "labelStartImage",
  resolveAll: Zm.resolveAll,
  tokenize: xS
};
function xS(t, r, a) {
  const l = this;
  return s;
  function s(m) {
    return t.enter("labelImage"), t.enter("labelImageMarker"), t.consume(m), t.exit("labelImageMarker"), c;
  }
  function c(m) {
    return m === 91 ? (t.enter("labelMarker"), t.consume(m), t.exit("labelMarker"), t.exit("labelImage"), d) : a(m);
  }
  function d(m) {
    return m === 94 && "_hiddenFootnoteSupport" in l.parser.constructs ? a(m) : r(m);
  }
}
const vS = {
  name: "labelStartLink",
  resolveAll: Zm.resolveAll,
  tokenize: SS
};
function SS(t, r, a) {
  const l = this;
  return s;
  function s(d) {
    return t.enter("labelLink"), t.enter("labelMarker"), t.consume(d), t.exit("labelMarker"), t.exit("labelLink"), c;
  }
  function c(d) {
    return d === 94 && "_hiddenFootnoteSupport" in l.parser.constructs ? a(d) : r(d);
  }
}
const Mh = {
  name: "lineEnding",
  tokenize: wS
};
function wS(t, r) {
  return a;
  function a(l) {
    return t.enter("lineEnding"), t.consume(l), t.exit("lineEnding"), vt(t, r, "linePrefix");
  }
}
const Kc = {
  name: "thematicBreak",
  tokenize: kS
};
function kS(t, r, a) {
  let l = 0, s;
  return c;
  function c(p) {
    return t.enter("thematicBreak"), d(p);
  }
  function d(p) {
    return s = p, m(p);
  }
  function m(p) {
    return p === s ? (t.enter("thematicBreakSequence"), g(p)) : l >= 3 && (p === null || et(p)) ? (t.exit("thematicBreak"), r(p)) : a(p);
  }
  function g(p) {
    return p === s ? (t.consume(p), l++, g) : (t.exit("thematicBreakSequence"), ht(p) ? vt(t, m, "whitespace")(p) : m(p));
  }
}
const Zn = {
  continuation: {
    tokenize: _S
  },
  exit: TS,
  name: "list",
  tokenize: jS
}, CS = {
  partial: !0,
  tokenize: AS
}, ES = {
  partial: !0,
  tokenize: NS
};
function jS(t, r, a) {
  const l = this, s = l.events[l.events.length - 1];
  let c = s && s[1].type === "linePrefix" ? s[2].sliceSerialize(s[1], !0).length : 0, d = 0;
  return m;
  function m(w) {
    const _ = l.containerState.type || (w === 42 || w === 43 || w === 45 ? "listUnordered" : "listOrdered");
    if (_ === "listUnordered" ? !l.containerState.marker || w === l.containerState.marker : fm(w)) {
      if (l.containerState.type || (l.containerState.type = _, t.enter(_, {
        _container: !0
      })), _ === "listUnordered")
        return t.enter("listItemPrefix"), w === 42 || w === 45 ? t.check(Kc, a, p)(w) : p(w);
      if (!l.interrupt || w === 49)
        return t.enter("listItemPrefix"), t.enter("listItemValue"), g(w);
    }
    return a(w);
  }
  function g(w) {
    return fm(w) && ++d < 10 ? (t.consume(w), g) : (!l.interrupt || d < 2) && (l.containerState.marker ? w === l.containerState.marker : w === 41 || w === 46) ? (t.exit("listItemValue"), p(w)) : a(w);
  }
  function p(w) {
    return t.enter("listItemMarker"), t.consume(w), t.exit("listItemMarker"), l.containerState.marker = l.containerState.marker || w, t.check(
      bu,
      // Cant be empty when interrupting.
      l.interrupt ? a : v,
      t.attempt(CS, E, x)
    );
  }
  function v(w) {
    return l.containerState.initialBlankLine = !0, c++, E(w);
  }
  function x(w) {
    return ht(w) ? (t.enter("listItemPrefixWhitespace"), t.consume(w), t.exit("listItemPrefixWhitespace"), E) : a(w);
  }
  function E(w) {
    return l.containerState.size = c + l.sliceSerialize(t.exit("listItemPrefix"), !0).length, r(w);
  }
}
function _S(t, r, a) {
  const l = this;
  return l.containerState._closeFlow = void 0, t.check(bu, s, c);
  function s(m) {
    return l.containerState.furtherBlankLines = l.containerState.furtherBlankLines || l.containerState.initialBlankLine, vt(t, r, "listItemIndent", l.containerState.size + 1)(m);
  }
  function c(m) {
    return l.containerState.furtherBlankLines || !ht(m) ? (l.containerState.furtherBlankLines = void 0, l.containerState.initialBlankLine = void 0, d(m)) : (l.containerState.furtherBlankLines = void 0, l.containerState.initialBlankLine = void 0, t.attempt(ES, r, d)(m));
  }
  function d(m) {
    return l.containerState._closeFlow = !0, l.interrupt = void 0, vt(t, t.attempt(Zn, r, a), "linePrefix", l.parser.constructs.disable.null.includes("codeIndented") ? void 0 : 4)(m);
  }
}
function NS(t, r, a) {
  const l = this;
  return vt(t, s, "listItemIndent", l.containerState.size + 1);
  function s(c) {
    const d = l.events[l.events.length - 1];
    return d && d[1].type === "listItemIndent" && d[2].sliceSerialize(d[1], !0).length === l.containerState.size ? r(c) : a(c);
  }
}
function TS(t) {
  t.exit(this.containerState.type);
}
function AS(t, r, a) {
  const l = this;
  return vt(t, s, "listItemPrefixWhitespace", l.parser.constructs.disable.null.includes("codeIndented") ? void 0 : 5);
  function s(c) {
    const d = l.events[l.events.length - 1];
    return !ht(c) && d && d[1].type === "listItemPrefixWhitespace" ? r(c) : a(c);
  }
}
const dy = {
  name: "setextUnderline",
  resolveTo: MS,
  tokenize: zS
};
function MS(t, r) {
  let a = t.length, l, s, c;
  for (; a--; )
    if (t[a][0] === "enter") {
      if (t[a][1].type === "content") {
        l = a;
        break;
      }
      t[a][1].type === "paragraph" && (s = a);
    } else
      t[a][1].type === "content" && t.splice(a, 1), !c && t[a][1].type === "definition" && (c = a);
  const d = {
    type: "setextHeading",
    start: {
      ...t[l][1].start
    },
    end: {
      ...t[t.length - 1][1].end
    }
  };
  return t[s][1].type = "setextHeadingText", c ? (t.splice(s, 0, ["enter", d, r]), t.splice(c + 1, 0, ["exit", t[l][1], r]), t[l][1].end = {
    ...t[c][1].end
  }) : t[l][1] = d, t.push(["exit", d, r]), t;
}
function zS(t, r, a) {
  const l = this;
  let s;
  return c;
  function c(p) {
    let v = l.events.length, x;
    for (; v--; )
      if (l.events[v][1].type !== "lineEnding" && l.events[v][1].type !== "linePrefix" && l.events[v][1].type !== "content") {
        x = l.events[v][1].type === "paragraph";
        break;
      }
    return !l.parser.lazy[l.now().line] && (l.interrupt || x) ? (t.enter("setextHeadingLine"), s = p, d(p)) : a(p);
  }
  function d(p) {
    return t.enter("setextHeadingLineSequence"), m(p);
  }
  function m(p) {
    return p === s ? (t.consume(p), m) : (t.exit("setextHeadingLineSequence"), ht(p) ? vt(t, g, "lineSuffix")(p) : g(p));
  }
  function g(p) {
    return p === null || et(p) ? (t.exit("setextHeadingLine"), r(p)) : a(p);
  }
}
const RS = {
  tokenize: OS
};
function OS(t) {
  const r = this, a = t.attempt(
    // Try to parse a blank line.
    bu,
    l,
    // Try to parse initial flow (essentially, only code).
    t.attempt(this.parser.constructs.flowInitial, s, vt(t, t.attempt(this.parser.constructs.flow, s, t.attempt(U8, s)), "linePrefix"))
  );
  return a;
  function l(c) {
    if (c === null) {
      t.consume(c);
      return;
    }
    return t.enter("lineEndingBlank"), t.consume(c), t.exit("lineEndingBlank"), r.currentConstruct = void 0, a;
  }
  function s(c) {
    if (c === null) {
      t.consume(c);
      return;
    }
    return t.enter("lineEnding"), t.consume(c), t.exit("lineEnding"), r.currentConstruct = void 0, a;
  }
}
const DS = {
  resolveAll: lx()
}, LS = ix("string"), BS = ix("text");
function ix(t) {
  return {
    resolveAll: lx(t === "text" ? IS : void 0),
    tokenize: r
  };
  function r(a) {
    const l = this, s = this.parser.constructs[t], c = a.attempt(s, d, m);
    return d;
    function d(v) {
      return p(v) ? c(v) : m(v);
    }
    function m(v) {
      if (v === null) {
        a.consume(v);
        return;
      }
      return a.enter("data"), a.consume(v), g;
    }
    function g(v) {
      return p(v) ? (a.exit("data"), c(v)) : (a.consume(v), g);
    }
    function p(v) {
      if (v === null)
        return !0;
      const x = s[v];
      let E = -1;
      if (x)
        for (; ++E < x.length; ) {
          const w = x[E];
          if (!w.previous || w.previous.call(l, l.previous))
            return !0;
        }
      return !1;
    }
  }
}
function lx(t) {
  return r;
  function r(a, l) {
    let s = -1, c;
    for (; ++s <= a.length; )
      c === void 0 ? a[s] && a[s][1].type === "data" && (c = s, s++) : (!a[s] || a[s][1].type !== "data") && (s !== c + 2 && (a[c][1].end = a[s - 1][1].end, a.splice(c + 2, s - c - 2), s = c + 2), c = void 0);
    return t ? t(a, l) : a;
  }
}
function IS(t, r) {
  let a = 0;
  for (; ++a <= t.length; )
    if ((a === t.length || t[a][1].type === "lineEnding") && t[a - 1][1].type === "data") {
      const l = t[a - 1][1], s = r.sliceStream(l);
      let c = s.length, d = -1, m = 0, g;
      for (; c--; ) {
        const p = s[c];
        if (typeof p == "string") {
          for (d = p.length; p.charCodeAt(d - 1) === 32; )
            m++, d--;
          if (d) break;
          d = -1;
        } else if (p === -2)
          g = !0, m++;
        else if (p !== -1) {
          c++;
          break;
        }
      }
      if (r._contentTypeTextTrailing && a === t.length && (m = 0), m) {
        const p = {
          type: a === t.length || g || m < 2 ? "lineSuffix" : "hardBreakTrailing",
          start: {
            _bufferIndex: c ? d : l.start._bufferIndex + d,
            _index: l.start._index + c,
            line: l.end.line,
            column: l.end.column - m,
            offset: l.end.offset - m
          },
          end: {
            ...l.end
          }
        };
        l.end = {
          ...p.start
        }, l.start.offset === l.end.offset ? Object.assign(l, p) : (t.splice(a, 0, ["enter", p, r], ["exit", p, r]), a += 2);
      }
      a++;
    }
  return t;
}
const US = {
  42: Zn,
  43: Zn,
  45: Zn,
  48: Zn,
  49: Zn,
  50: Zn,
  51: Zn,
  52: Zn,
  53: Zn,
  54: Zn,
  55: Zn,
  56: Zn,
  57: Zn,
  62: Zb
}, PS = {
  91: $8
}, qS = {
  [-2]: Ah,
  [-1]: Ah,
  32: Ah
}, HS = {
  35: X8,
  42: Kc,
  45: [dy, Kc],
  60: eS,
  61: dy,
  95: Kc,
  96: uy,
  126: uy
}, FS = {
  38: ex,
  92: Jb
}, $S = {
  [-5]: Mh,
  [-4]: Mh,
  [-3]: Mh,
  33: bS,
  38: ex,
  42: hm,
  60: [v8, oS],
  91: vS,
  92: [Y8, Jb],
  93: Zm,
  95: hm,
  96: R8
}, GS = {
  null: [hm, DS]
}, VS = {
  null: [42, 95]
}, KS = {
  null: []
}, YS = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  attentionMarkers: VS,
  contentInitial: PS,
  disable: KS,
  document: US,
  flow: HS,
  flowInitial: qS,
  insideSpan: GS,
  string: FS,
  text: $S
}, Symbol.toStringTag, { value: "Module" }));
function QS(t, r, a) {
  let l = {
    _bufferIndex: -1,
    _index: 0,
    line: a && a.line || 1,
    column: a && a.column || 1,
    offset: a && a.offset || 0
  };
  const s = {}, c = [];
  let d = [], m = [];
  const g = {
    attempt: V(de),
    check: V(I),
    consume: Z,
    enter: K,
    exit: ge,
    interrupt: V(I, {
      interrupt: !0
    })
  }, p = {
    code: null,
    containerState: {},
    defineSkip: A,
    events: [],
    now: _,
    parser: t,
    previous: null,
    sliceSerialize: E,
    sliceStream: w,
    write: x
  };
  let v = r.tokenize.call(p, g);
  return r.resolveAll && c.push(r), p;
  function x(oe) {
    return d = Tr(d, oe), D(), d[d.length - 1] !== null ? [] : (we(r, 0), p.events = md(c, p.events, p), p.events);
  }
  function E(oe, se) {
    return WS(w(oe), se);
  }
  function w(oe) {
    return XS(d, oe);
  }
  function _() {
    const {
      _bufferIndex: oe,
      _index: se,
      line: Re,
      column: be,
      offset: je
    } = l;
    return {
      _bufferIndex: oe,
      _index: se,
      line: Re,
      column: be,
      offset: je
    };
  }
  function A(oe) {
    s[oe.line] = oe.column, X();
  }
  function D() {
    let oe;
    for (; l._index < d.length; ) {
      const se = d[l._index];
      if (typeof se == "string")
        for (oe = l._index, l._bufferIndex < 0 && (l._bufferIndex = 0); l._index === oe && l._bufferIndex < se.length; )
          R(se.charCodeAt(l._bufferIndex));
      else
        R(se);
    }
  }
  function R(oe) {
    v = v(oe);
  }
  function Z(oe) {
    et(oe) ? (l.line++, l.column = 1, l.offset += oe === -3 ? 2 : 1, X()) : oe !== -1 && (l.column++, l.offset++), l._bufferIndex < 0 ? l._index++ : (l._bufferIndex++, l._bufferIndex === // Points w/ non-negative `_bufferIndex` reference
    // strings.
    /** @type {string} */
    d[l._index].length && (l._bufferIndex = -1, l._index++)), p.previous = oe;
  }
  function K(oe, se) {
    const Re = se || {};
    return Re.type = oe, Re.start = _(), p.events.push(["enter", Re, p]), m.push(Re), Re;
  }
  function ge(oe) {
    const se = m.pop();
    return se.end = _(), p.events.push(["exit", se, p]), se;
  }
  function de(oe, se) {
    we(oe, se.from);
  }
  function I(oe, se) {
    se.restore();
  }
  function V(oe, se) {
    return Re;
    function Re(be, je, re) {
      let _e, fe, Ue, O;
      return Array.isArray(be) ? (
        /* c8 ignore next 1 */
        he(be)
      ) : "tokenize" in be ? (
        // Looks like a construct.
        he([
          /** @type {Construct} */
          be
        ])
      ) : L(be);
      function L(ye) {
        return me;
        function me(Ge) {
          const Ne = Ge !== null && ye[Ge], Rt = Ge !== null && ye.null, tn = [
            // To do: add more extension tests.
            /* c8 ignore next 2 */
            ...Array.isArray(Ne) ? Ne : Ne ? [Ne] : [],
            ...Array.isArray(Rt) ? Rt : Rt ? [Rt] : []
          ];
          return he(tn)(Ge);
        }
      }
      function he(ye) {
        return _e = ye, fe = 0, ye.length === 0 ? re : M(ye[fe]);
      }
      function M(ye) {
        return me;
        function me(Ge) {
          return O = Te(), Ue = ye, ye.partial || (p.currentConstruct = ye), ye.name && p.parser.constructs.disable.null.includes(ye.name) ? Ye() : ye.tokenize.call(
            // If we do have fields, create an object w/ `context` as its
            // prototype.
            // This allows a live binding, which is needed for `interrupt`.
            se ? Object.assign(Object.create(p), se) : p,
            g,
            Ie,
            Ye
          )(Ge);
        }
      }
      function Ie(ye) {
        return oe(Ue, O), je;
      }
      function Ye(ye) {
        return O.restore(), ++fe < _e.length ? M(_e[fe]) : re;
      }
    }
  }
  function we(oe, se) {
    oe.resolveAll && !c.includes(oe) && c.push(oe), oe.resolve && pr(p.events, se, p.events.length - se, oe.resolve(p.events.slice(se), p)), oe.resolveTo && (p.events = oe.resolveTo(p.events, p));
  }
  function Te() {
    const oe = _(), se = p.previous, Re = p.currentConstruct, be = p.events.length, je = Array.from(m);
    return {
      from: be,
      restore: re
    };
    function re() {
      l = oe, p.previous = se, p.currentConstruct = Re, p.events.length = be, m = je, X();
    }
  }
  function X() {
    l.line in s && l.column < 2 && (l.column = s[l.line], l.offset += s[l.line] - 1);
  }
}
function XS(t, r) {
  const a = r.start._index, l = r.start._bufferIndex, s = r.end._index, c = r.end._bufferIndex;
  let d;
  if (a === s)
    d = [t[a].slice(l, c)];
  else {
    if (d = t.slice(a, s), l > -1) {
      const m = d[0];
      typeof m == "string" ? d[0] = m.slice(l) : d.shift();
    }
    c > 0 && d.push(t[s].slice(0, c));
  }
  return d;
}
function WS(t, r) {
  let a = -1;
  const l = [];
  let s;
  for (; ++a < t.length; ) {
    const c = t[a];
    let d;
    if (typeof c == "string")
      d = c;
    else switch (c) {
      case -5: {
        d = "\r";
        break;
      }
      case -4: {
        d = `
`;
        break;
      }
      case -3: {
        d = `\r
`;
        break;
      }
      case -2: {
        d = r ? " " : "	";
        break;
      }
      case -1: {
        if (!r && s) continue;
        d = " ";
        break;
      }
      default:
        d = String.fromCharCode(c);
    }
    s = c === -2, l.push(d);
  }
  return l.join("");
}
function ZS(t) {
  const l = {
    constructs: (
      /** @type {FullNormalizedExtension} */
      Xb([YS, ...(t || {}).extensions || []])
    ),
    content: s(h8),
    defined: [],
    document: s(p8),
    flow: s(RS),
    lazy: {},
    string: s(LS),
    text: s(BS)
  };
  return l;
  function s(c) {
    return d;
    function d(m) {
      return QS(l, c, m);
    }
  }
}
function JS(t) {
  for (; !tx(t); )
    ;
  return t;
}
const fy = /[\0\t\n\r]/g;
function ew() {
  let t = 1, r = "", a = !0, l;
  return s;
  function s(c, d, m) {
    const g = [];
    let p, v, x, E, w;
    for (c = r + (typeof c == "string" ? c.toString() : new TextDecoder(d || void 0).decode(c)), x = 0, r = "", a && (c.charCodeAt(0) === 65279 && x++, a = void 0); x < c.length; ) {
      if (fy.lastIndex = x, p = fy.exec(c), E = p && p.index !== void 0 ? p.index : c.length, w = c.charCodeAt(E), !p) {
        r = c.slice(x);
        break;
      }
      if (w === 10 && x === E && l)
        g.push(-3), l = void 0;
      else
        switch (l && (g.push(-5), l = void 0), x < E && (g.push(c.slice(x, E)), t += E - x), w) {
          case 0: {
            g.push(65533), t++;
            break;
          }
          case 9: {
            for (v = Math.ceil(t / 4) * 4, g.push(-2); t++ < v; ) g.push(-1);
            break;
          }
          case 10: {
            g.push(-4), t = 1;
            break;
          }
          default:
            l = !0, t = 1;
        }
      x = E + 1;
    }
    return m && (l && g.push(-5), r && g.push(r), g.push(null)), g;
  }
}
const tw = /\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;
function nw(t) {
  return t.replace(tw, rw);
}
function rw(t, r, a) {
  if (r)
    return r;
  if (a.charCodeAt(0) === 35) {
    const s = a.charCodeAt(1), c = s === 120 || s === 88;
    return Wb(a.slice(c ? 2 : 1), c ? 16 : 10);
  }
  return Wm(a) || t;
}
const ox = {}.hasOwnProperty;
function aw(t, r, a) {
  return typeof r != "string" && (a = r, r = void 0), iw(a)(JS(ZS(a).document().write(ew()(t, r, !0))));
}
function iw(t) {
  const r = {
    transforms: [],
    canContainEols: ["emphasis", "fragment", "heading", "paragraph", "strong"],
    enter: {
      autolink: c(Va),
      autolinkProtocol: Te,
      autolinkEmail: Te,
      atxHeading: c(Fn),
      blockQuote: c(Rt),
      characterEscape: Te,
      characterReference: Te,
      codeFenced: c(tn),
      codeFencedFenceInfo: d,
      codeFencedFenceMeta: d,
      codeIndented: c(tn, d),
      codeText: c(mt, d),
      codeTextData: Te,
      data: Te,
      codeFlowValue: Te,
      definition: c(qr),
      definitionDestinationString: d,
      definitionLabelString: d,
      definitionTitleString: d,
      emphasis: c(Mr),
      hardBreakEscape: c(Ga),
      hardBreakTrailing: c(Ga),
      htmlFlow: c(Ml, d),
      htmlFlowData: Te,
      htmlText: c(Ml, d),
      htmlTextData: Te,
      image: c(zl),
      label: d,
      link: c(Va),
      listItem: c(Tn),
      listItemValue: E,
      listOrdered: c(Hr, x),
      listUnordered: c(Hr),
      paragraph: c(Rl),
      reference: M,
      referenceString: d,
      resourceDestinationString: d,
      resourceTitleString: d,
      setextHeading: c(Fn),
      strong: c(ha),
      thematicBreak: c(ma)
    },
    exit: {
      atxHeading: g(),
      atxHeadingSequence: de,
      autolink: g(),
      autolinkEmail: Ne,
      autolinkProtocol: Ge,
      blockQuote: g(),
      characterEscapeValue: X,
      characterReferenceMarkerHexadecimal: Ye,
      characterReferenceMarkerNumeric: Ye,
      characterReferenceValue: ye,
      characterReference: me,
      codeFenced: g(D),
      codeFencedFence: A,
      codeFencedFenceInfo: w,
      codeFencedFenceMeta: _,
      codeFlowValue: X,
      codeIndented: g(R),
      codeText: g(je),
      codeTextData: X,
      data: X,
      definition: g(),
      definitionDestinationString: ge,
      definitionLabelString: Z,
      definitionTitleString: K,
      emphasis: g(),
      hardBreakEscape: g(se),
      hardBreakTrailing: g(se),
      htmlFlow: g(Re),
      htmlFlowData: X,
      htmlText: g(be),
      htmlTextData: X,
      image: g(_e),
      label: Ue,
      labelText: fe,
      lineEnding: oe,
      link: g(re),
      listItem: g(),
      listOrdered: g(),
      listUnordered: g(),
      paragraph: g(),
      referenceString: Ie,
      resourceDestinationString: O,
      resourceTitleString: L,
      resource: he,
      setextHeading: g(we),
      setextHeadingLineSequence: V,
      setextHeadingText: I,
      strong: g(),
      thematicBreak: g()
    }
  };
  sx(r, (t || {}).mdastExtensions || []);
  const a = {};
  return l;
  function l(ve) {
    let Oe = {
      type: "root",
      children: []
    };
    const Je = {
      stack: [Oe],
      tokenStack: [],
      config: r,
      enter: m,
      exit: p,
      buffer: d,
      resume: v,
      data: a
    }, it = [];
    let xt = -1;
    for (; ++xt < ve.length; )
      if (ve[xt][1].type === "listOrdered" || ve[xt][1].type === "listUnordered")
        if (ve[xt][0] === "enter")
          it.push(xt);
        else {
          const pn = it.pop();
          xt = s(ve, pn, xt);
        }
    for (xt = -1; ++xt < ve.length; ) {
      const pn = r[ve[xt][0]];
      ox.call(pn, ve[xt][1].type) && pn[ve[xt][1].type].call(Object.assign({
        sliceSerialize: ve[xt][2].sliceSerialize
      }, Je), ve[xt][1]);
    }
    if (Je.tokenStack.length > 0) {
      const pn = Je.tokenStack[Je.tokenStack.length - 1];
      (pn[1] || hy).call(Je, void 0, pn[0]);
    }
    for (Oe.position = {
      start: Ni(ve.length > 0 ? ve[0][1].start : {
        line: 1,
        column: 1,
        offset: 0
      }),
      end: Ni(ve.length > 0 ? ve[ve.length - 2][1].end : {
        line: 1,
        column: 1,
        offset: 0
      })
    }, xt = -1; ++xt < r.transforms.length; )
      Oe = r.transforms[xt](Oe) || Oe;
    return Oe;
  }
  function s(ve, Oe, Je) {
    let it = Oe - 1, xt = -1, pn = !1, Sn, nn, Vt, Kt;
    for (; ++it <= Je; ) {
      const Be = ve[it];
      switch (Be[1].type) {
        case "listUnordered":
        case "listOrdered":
        case "blockQuote": {
          Be[0] === "enter" ? xt++ : xt--, Kt = void 0;
          break;
        }
        case "lineEndingBlank": {
          Be[0] === "enter" && (Sn && !Kt && !xt && !Vt && (Vt = it), Kt = void 0);
          break;
        }
        case "linePrefix":
        case "listItemValue":
        case "listItemMarker":
        case "listItemPrefix":
        case "listItemPrefixWhitespace":
          break;
        default:
          Kt = void 0;
      }
      if (!xt && Be[0] === "enter" && Be[1].type === "listItemPrefix" || xt === -1 && Be[0] === "exit" && (Be[1].type === "listUnordered" || Be[1].type === "listOrdered")) {
        if (Sn) {
          let $n = it;
          for (nn = void 0; $n--; ) {
            const fn = ve[$n];
            if (fn[1].type === "lineEnding" || fn[1].type === "lineEndingBlank") {
              if (fn[0] === "exit") continue;
              nn && (ve[nn][1].type = "lineEndingBlank", pn = !0), fn[1].type = "lineEnding", nn = $n;
            } else if (!(fn[1].type === "linePrefix" || fn[1].type === "blockQuotePrefix" || fn[1].type === "blockQuotePrefixWhitespace" || fn[1].type === "blockQuoteMarker" || fn[1].type === "listItemIndent")) break;
          }
          Vt && (!nn || Vt < nn) && (Sn._spread = !0), Sn.end = Object.assign({}, nn ? ve[nn][1].start : Be[1].end), ve.splice(nn || it, 0, ["exit", Sn, Be[2]]), it++, Je++;
        }
        if (Be[1].type === "listItemPrefix") {
          const $n = {
            type: "listItem",
            _spread: !1,
            start: Object.assign({}, Be[1].start),
            // @ts-expect-error: well add `end` in a second.
            end: void 0
          };
          Sn = $n, ve.splice(it, 0, ["enter", $n, Be[2]]), it++, Je++, Vt = void 0, Kt = !0;
        }
      }
    }
    return ve[Oe][1]._spread = pn, Je;
  }
  function c(ve, Oe) {
    return Je;
    function Je(it) {
      m.call(this, ve(it), it), Oe && Oe.call(this, it);
    }
  }
  function d() {
    this.stack.push({
      type: "fragment",
      children: []
    });
  }
  function m(ve, Oe, Je) {
    this.stack[this.stack.length - 1].children.push(ve), this.stack.push(ve), this.tokenStack.push([Oe, Je || void 0]), ve.position = {
      start: Ni(Oe.start),
      // @ts-expect-error: `end` will be patched later.
      end: void 0
    };
  }
  function g(ve) {
    return Oe;
    function Oe(Je) {
      ve && ve.call(this, Je), p.call(this, Je);
    }
  }
  function p(ve, Oe) {
    const Je = this.stack.pop(), it = this.tokenStack.pop();
    if (it)
      it[0].type !== ve.type && (Oe ? Oe.call(this, ve, it[0]) : (it[1] || hy).call(this, ve, it[0]));
    else throw new Error("Cannot close `" + ve.type + "` (" + ru({
      start: ve.start,
      end: ve.end
    }) + "): its not open");
    Je.position.end = Ni(ve.end);
  }
  function v() {
    return Xm(this.stack.pop());
  }
  function x() {
    this.data.expectingFirstListItemValue = !0;
  }
  function E(ve) {
    if (this.data.expectingFirstListItemValue) {
      const Oe = this.stack[this.stack.length - 2];
      Oe.start = Number.parseInt(this.sliceSerialize(ve), 10), this.data.expectingFirstListItemValue = void 0;
    }
  }
  function w() {
    const ve = this.resume(), Oe = this.stack[this.stack.length - 1];
    Oe.lang = ve;
  }
  function _() {
    const ve = this.resume(), Oe = this.stack[this.stack.length - 1];
    Oe.meta = ve;
  }
  function A() {
    this.data.flowCodeInside || (this.buffer(), this.data.flowCodeInside = !0);
  }
  function D() {
    const ve = this.resume(), Oe = this.stack[this.stack.length - 1];
    Oe.value = ve.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g, ""), this.data.flowCodeInside = void 0;
  }
  function R() {
    const ve = this.resume(), Oe = this.stack[this.stack.length - 1];
    Oe.value = ve.replace(/(\r?\n|\r)$/g, "");
  }
  function Z(ve) {
    const Oe = this.resume(), Je = this.stack[this.stack.length - 1];
    Je.label = Oe, Je.identifier = Pr(this.sliceSerialize(ve)).toLowerCase();
  }
  function K() {
    const ve = this.resume(), Oe = this.stack[this.stack.length - 1];
    Oe.title = ve;
  }
  function ge() {
    const ve = this.resume(), Oe = this.stack[this.stack.length - 1];
    Oe.url = ve;
  }
  function de(ve) {
    const Oe = this.stack[this.stack.length - 1];
    if (!Oe.depth) {
      const Je = this.sliceSerialize(ve).length;
      Oe.depth = Je;
    }
  }
  function I() {
    this.data.setextHeadingSlurpLineEnding = !0;
  }
  function V(ve) {
    const Oe = this.stack[this.stack.length - 1];
    Oe.depth = this.sliceSerialize(ve).codePointAt(0) === 61 ? 1 : 2;
  }
  function we() {
    this.data.setextHeadingSlurpLineEnding = void 0;
  }
  function Te(ve) {
    const Je = this.stack[this.stack.length - 1].children;
    let it = Je[Je.length - 1];
    (!it || it.type !== "text") && (it = mn(), it.position = {
      start: Ni(ve.start),
      // @ts-expect-error: well add `end` later.
      end: void 0
    }, Je.push(it)), this.stack.push(it);
  }
  function X(ve) {
    const Oe = this.stack.pop();
    Oe.value += this.sliceSerialize(ve), Oe.position.end = Ni(ve.end);
  }
  function oe(ve) {
    const Oe = this.stack[this.stack.length - 1];
    if (this.data.atHardBreak) {
      const Je = Oe.children[Oe.children.length - 1];
      Je.position.end = Ni(ve.end), this.data.atHardBreak = void 0;
      return;
    }
    !this.data.setextHeadingSlurpLineEnding && r.canContainEols.includes(Oe.type) && (Te.call(this, ve), X.call(this, ve));
  }
  function se() {
    this.data.atHardBreak = !0;
  }
  function Re() {
    const ve = this.resume(), Oe = this.stack[this.stack.length - 1];
    Oe.value = ve;
  }
  function be() {
    const ve = this.resume(), Oe = this.stack[this.stack.length - 1];
    Oe.value = ve;
  }
  function je() {
    const ve = this.resume(), Oe = this.stack[this.stack.length - 1];
    Oe.value = ve;
  }
  function re() {
    const ve = this.stack[this.stack.length - 1];
    if (this.data.inReference) {
      const Oe = this.data.referenceType || "shortcut";
      ve.type += "Reference", ve.referenceType = Oe, delete ve.url, delete ve.title;
    } else
      delete ve.identifier, delete ve.label;
    this.data.referenceType = void 0;
  }
  function _e() {
    const ve = this.stack[this.stack.length - 1];
    if (this.data.inReference) {
      const Oe = this.data.referenceType || "shortcut";
      ve.type += "Reference", ve.referenceType = Oe, delete ve.url, delete ve.title;
    } else
      delete ve.identifier, delete ve.label;
    this.data.referenceType = void 0;
  }
  function fe(ve) {
    const Oe = this.sliceSerialize(ve), Je = this.stack[this.stack.length - 2];
    Je.label = nw(Oe), Je.identifier = Pr(Oe).toLowerCase();
  }
  function Ue() {
    const ve = this.stack[this.stack.length - 1], Oe = this.resume(), Je = this.stack[this.stack.length - 1];
    if (this.data.inReference = !0, Je.type === "link") {
      const it = ve.children;
      Je.children = it;
    } else
      Je.alt = Oe;
  }
  function O() {
    const ve = this.resume(), Oe = this.stack[this.stack.length - 1];
    Oe.url = ve;
  }
  function L() {
    const ve = this.resume(), Oe = this.stack[this.stack.length - 1];
    Oe.title = ve;
  }
  function he() {
    this.data.inReference = void 0;
  }
  function M() {
    this.data.referenceType = "collapsed";
  }
  function Ie(ve) {
    const Oe = this.resume(), Je = this.stack[this.stack.length - 1];
    Je.label = Oe, Je.identifier = Pr(this.sliceSerialize(ve)).toLowerCase(), this.data.referenceType = "full";
  }
  function Ye(ve) {
    this.data.characterReferenceType = ve.type;
  }
  function ye(ve) {
    const Oe = this.sliceSerialize(ve), Je = this.data.characterReferenceType;
    let it;
    Je ? (it = Wb(Oe, Je === "characterReferenceMarkerNumeric" ? 10 : 16), this.data.characterReferenceType = void 0) : it = Wm(Oe);
    const xt = this.stack[this.stack.length - 1];
    xt.value += it;
  }
  function me(ve) {
    const Oe = this.stack.pop();
    Oe.position.end = Ni(ve.end);
  }
  function Ge(ve) {
    X.call(this, ve);
    const Oe = this.stack[this.stack.length - 1];
    Oe.url = this.sliceSerialize(ve);
  }
  function Ne(ve) {
    X.call(this, ve);
    const Oe = this.stack[this.stack.length - 1];
    Oe.url = "mailto:" + this.sliceSerialize(ve);
  }
  function Rt() {
    return {
      type: "blockquote",
      children: []
    };
  }
  function tn() {
    return {
      type: "code",
      lang: null,
      meta: null,
      value: ""
    };
  }
  function mt() {
    return {
      type: "inlineCode",
      value: ""
    };
  }
  function qr() {
    return {
      type: "definition",
      identifier: "",
      label: null,
      title: null,
      url: ""
    };
  }
  function Mr() {
    return {
      type: "emphasis",
      children: []
    };
  }
  function Fn() {
    return {
      type: "heading",
      // @ts-expect-error `depth` will be set later.
      depth: 0,
      children: []
    };
  }
  function Ga() {
    return {
      type: "break"
    };
  }
  function Ml() {
    return {
      type: "html",
      value: ""
    };
  }
  function zl() {
    return {
      type: "image",
      title: null,
      url: "",
      alt: null
    };
  }
  function Va() {
    return {
      type: "link",
      title: null,
      url: "",
      children: []
    };
  }
  function Hr(ve) {
    return {
      type: "list",
      ordered: ve.type === "listOrdered",
      start: null,
      spread: ve._spread,
      children: []
    };
  }
  function Tn(ve) {
    return {
      type: "listItem",
      spread: ve._spread,
      checked: null,
      children: []
    };
  }
  function Rl() {
    return {
      type: "paragraph",
      children: []
    };
  }
  function ha() {
    return {
      type: "strong",
      children: []
    };
  }
  function mn() {
    return {
      type: "text",
      value: ""
    };
  }
  function ma() {
    return {
      type: "thematicBreak"
    };
  }
}
function Ni(t) {
  return {
    line: t.line,
    column: t.column,
    offset: t.offset
  };
}
function sx(t, r) {
  let a = -1;
  for (; ++a < r.length; ) {
    const l = r[a];
    Array.isArray(l) ? sx(t, l) : lw(t, l);
  }
}
function lw(t, r) {
  let a;
  for (a in r)
    if (ox.call(r, a))
      switch (a) {
        case "canContainEols": {
          const l = r[a];
          l && t[a].push(...l);
          break;
        }
        case "transforms": {
          const l = r[a];
          l && t[a].push(...l);
          break;
        }
        case "enter":
        case "exit": {
          const l = r[a];
          l && Object.assign(t[a], l);
          break;
        }
      }
}
function hy(t, r) {
  throw t ? new Error("Cannot close `" + t.type + "` (" + ru({
    start: t.start,
    end: t.end
  }) + "): a different token (`" + r.type + "`, " + ru({
    start: r.start,
    end: r.end
  }) + ") is open") : new Error("Cannot close document, a token (`" + r.type + "`, " + ru({
    start: r.start,
    end: r.end
  }) + ") is still open");
}
function ow(t) {
  const r = this;
  r.parser = a;
  function a(l) {
    return aw(l, {
      ...r.data("settings"),
      ...t,
      // Note: these options are not in the readme.
      // The goal is for them to be set by plugins on `data` instead of being
      // passed by users.
      extensions: r.data("micromarkExtensions") || [],
      mdastExtensions: r.data("fromMarkdownExtensions") || []
    });
  }
}
function sw(t, r) {
  const a = {
    type: "element",
    tagName: "blockquote",
    properties: {},
    children: t.wrap(t.all(r), !0)
  };
  return t.patch(r, a), t.applyData(r, a);
}
function uw(t, r) {
  const a = { type: "element", tagName: "br", properties: {}, children: [] };
  return t.patch(r, a), [t.applyData(r, a), { type: "text", value: `
` }];
}
function cw(t, r) {
  const a = r.value ? r.value + `
` : "", l = {}, s = r.lang ? r.lang.split(/\s+/) : [];
  s.length > 0 && (l.className = ["language-" + s[0]]);
  let c = {
    type: "element",
    tagName: "code",
    properties: l,
    children: [{ type: "text", value: a }]
  };
  return r.meta && (c.data = { meta: r.meta }), t.patch(r, c), c = t.applyData(r, c), c = { type: "element", tagName: "pre", properties: {}, children: [c] }, t.patch(r, c), c;
}
function dw(t, r) {
  const a = {
    type: "element",
    tagName: "del",
    properties: {},
    children: t.all(r)
  };
  return t.patch(r, a), t.applyData(r, a);
}
function fw(t, r) {
  const a = {
    type: "element",
    tagName: "em",
    properties: {},
    children: t.all(r)
  };
  return t.patch(r, a), t.applyData(r, a);
}
function hw(t, r) {
  const a = typeof t.options.clobberPrefix == "string" ? t.options.clobberPrefix : "user-content-", l = String(r.identifier).toUpperCase(), s = qo(l.toLowerCase()), c = t.footnoteOrder.indexOf(l);
  let d, m = t.footnoteCounts.get(l);
  m === void 0 ? (m = 0, t.footnoteOrder.push(l), d = t.footnoteOrder.length) : d = c + 1, m += 1, t.footnoteCounts.set(l, m);
  const g = {
    type: "element",
    tagName: "a",
    properties: {
      href: "#" + a + "fn-" + s,
      id: a + "fnref-" + s + (m > 1 ? "-" + m : ""),
      dataFootnoteRef: !0,
      ariaDescribedBy: ["footnote-label"]
    },
    children: [{ type: "text", value: String(d) }]
  };
  t.patch(r, g);
  const p = {
    type: "element",
    tagName: "sup",
    properties: {},
    children: [g]
  };
  return t.patch(r, p), t.applyData(r, p);
}
function mw(t, r) {
  const a = {
    type: "element",
    tagName: "h" + r.depth,
    properties: {},
    children: t.all(r)
  };
  return t.patch(r, a), t.applyData(r, a);
}
function pw(t, r) {
  if (t.options.allowDangerousHtml) {
    const a = { type: "raw", value: r.value };
    return t.patch(r, a), t.applyData(r, a);
  }
}
function ux(t, r) {
  const a = r.referenceType;
  let l = "]";
  if (a === "collapsed" ? l += "[]" : a === "full" && (l += "[" + (r.label || r.identifier) + "]"), r.type === "imageReference")
    return [{ type: "text", value: "![" + r.alt + l }];
  const s = t.all(r), c = s[0];
  c && c.type === "text" ? c.value = "[" + c.value : s.unshift({ type: "text", value: "[" });
  const d = s[s.length - 1];
  return d && d.type === "text" ? d.value += l : s.push({ type: "text", value: l }), s;
}
function gw(t, r) {
  const a = String(r.identifier).toUpperCase(), l = t.definitionById.get(a);
  if (!l)
    return ux(t, r);
  const s = { src: qo(l.url || ""), alt: r.alt };
  l.title !== null && l.title !== void 0 && (s.title = l.title);
  const c = { type: "element", tagName: "img", properties: s, children: [] };
  return t.patch(r, c), t.applyData(r, c);
}
function yw(t, r) {
  const a = { src: qo(r.url) };
  r.alt !== null && r.alt !== void 0 && (a.alt = r.alt), r.title !== null && r.title !== void 0 && (a.title = r.title);
  const l = { type: "element", tagName: "img", properties: a, children: [] };
  return t.patch(r, l), t.applyData(r, l);
}
function bw(t, r) {
  const a = { type: "text", value: r.value.replace(/\r?\n|\r/g, " ") };
  t.patch(r, a);
  const l = {
    type: "element",
    tagName: "code",
    properties: {},
    children: [a]
  };
  return t.patch(r, l), t.applyData(r, l);
}
function xw(t, r) {
  const a = String(r.identifier).toUpperCase(), l = t.definitionById.get(a);
  if (!l)
    return ux(t, r);
  const s = { href: qo(l.url || "") };
  l.title !== null && l.title !== void 0 && (s.title = l.title);
  const c = {
    type: "element",
    tagName: "a",
    properties: s,
    children: t.all(r)
  };
  return t.patch(r, c), t.applyData(r, c);
}
function vw(t, r) {
  const a = { href: qo(r.url) };
  r.title !== null && r.title !== void 0 && (a.title = r.title);
  const l = {
    type: "element",
    tagName: "a",
    properties: a,
    children: t.all(r)
  };
  return t.patch(r, l), t.applyData(r, l);
}
function Sw(t, r, a) {
  const l = t.all(r), s = a ? ww(a) : cx(r), c = {}, d = [];
  if (typeof r.checked == "boolean") {
    const v = l[0];
    let x;
    v && v.type === "element" && v.tagName === "p" ? x = v : (x = { type: "element", tagName: "p", properties: {}, children: [] }, l.unshift(x)), x.children.length > 0 && x.children.unshift({ type: "text", value: " " }), x.children.unshift({
      type: "element",
      tagName: "input",
      properties: { type: "checkbox", checked: r.checked, disabled: !0 },
      children: []
    }), c.className = ["task-list-item"];
  }
  let m = -1;
  for (; ++m < l.length; ) {
    const v = l[m];
    (s || m !== 0 || v.type !== "element" || v.tagName !== "p") && d.push({ type: "text", value: `
` }), v.type === "element" && v.tagName === "p" && !s ? d.push(...v.children) : d.push(v);
  }
  const g = l[l.length - 1];
  g && (s || g.type !== "element" || g.tagName !== "p") && d.push({ type: "text", value: `
` });
  const p = { type: "element", tagName: "li", properties: c, children: d };
  return t.patch(r, p), t.applyData(r, p);
}
function ww(t) {
  let r = !1;
  if (t.type === "list") {
    r = t.spread || !1;
    const a = t.children;
    let l = -1;
    for (; !r && ++l < a.length; )
      r = cx(a[l]);
  }
  return r;
}
function cx(t) {
  const r = t.spread;
  return r ?? t.children.length > 1;
}
function kw(t, r) {
  const a = {}, l = t.all(r);
  let s = -1;
  for (typeof r.start == "number" && r.start !== 1 && (a.start = r.start); ++s < l.length; ) {
    const d = l[s];
    if (d.type === "element" && d.tagName === "li" && d.properties && Array.isArray(d.properties.className) && d.properties.className.includes("task-list-item")) {
      a.className = ["contains-task-list"];
      break;
    }
  }
  const c = {
    type: "element",
    tagName: r.ordered ? "ol" : "ul",
    properties: a,
    children: t.wrap(l, !0)
  };
  return t.patch(r, c), t.applyData(r, c);
}
function Cw(t, r) {
  const a = {
    type: "element",
    tagName: "p",
    properties: {},
    children: t.all(r)
  };
  return t.patch(r, a), t.applyData(r, a);
}
function Ew(t, r) {
  const a = { type: "root", children: t.wrap(t.all(r)) };
  return t.patch(r, a), t.applyData(r, a);
}
function jw(t, r) {
  const a = {
    type: "element",
    tagName: "strong",
    properties: {},
    children: t.all(r)
  };
  return t.patch(r, a), t.applyData(r, a);
}
function _w(t, r) {
  const a = t.all(r), l = a.shift(), s = [];
  if (l) {
    const d = {
      type: "element",
      tagName: "thead",
      properties: {},
      children: t.wrap([l], !0)
    };
    t.patch(r.children[0], d), s.push(d);
  }
  if (a.length > 0) {
    const d = {
      type: "element",
      tagName: "tbody",
      properties: {},
      children: t.wrap(a, !0)
    }, m = Vm(r.children[1]), g = Fb(r.children[r.children.length - 1]);
    m && g && (d.position = { start: m, end: g }), s.push(d);
  }
  const c = {
    type: "element",
    tagName: "table",
    properties: {},
    children: t.wrap(s, !0)
  };
  return t.patch(r, c), t.applyData(r, c);
}
function Nw(t, r, a) {
  const l = a ? a.children : void 0, c = (l ? l.indexOf(r) : 1) === 0 ? "th" : "td", d = a && a.type === "table" ? a.align : void 0, m = d ? d.length : r.children.length;
  let g = -1;
  const p = [];
  for (; ++g < m; ) {
    const x = r.children[g], E = {}, w = d ? d[g] : void 0;
    w && (E.align = w);
    let _ = { type: "element", tagName: c, properties: E, children: [] };
    x && (_.children = t.all(x), t.patch(x, _), _ = t.applyData(x, _)), p.push(_);
  }
  const v = {
    type: "element",
    tagName: "tr",
    properties: {},
    children: t.wrap(p, !0)
  };
  return t.patch(r, v), t.applyData(r, v);
}
function Tw(t, r) {
  const a = {
    type: "element",
    tagName: "td",
    // Assume body cell.
    properties: {},
    children: t.all(r)
  };
  return t.patch(r, a), t.applyData(r, a);
}
const my = 9, py = 32;
function Aw(t) {
  const r = String(t), a = /\r?\n|\r/g;
  let l = a.exec(r), s = 0;
  const c = [];
  for (; l; )
    c.push(
      gy(r.slice(s, l.index), s > 0, !0),
      l[0]
    ), s = l.index + l[0].length, l = a.exec(r);
  return c.push(gy(r.slice(s), s > 0, !1)), c.join("");
}
function gy(t, r, a) {
  let l = 0, s = t.length;
  if (r) {
    let c = t.codePointAt(l);
    for (; c === my || c === py; )
      l++, c = t.codePointAt(l);
  }
  if (a) {
    let c = t.codePointAt(s - 1);
    for (; c === my || c === py; )
      s--, c = t.codePointAt(s - 1);
  }
  return s > l ? t.slice(l, s) : "";
}
function Mw(t, r) {
  const a = { type: "text", value: Aw(String(r.value)) };
  return t.patch(r, a), t.applyData(r, a);
}
function zw(t, r) {
  const a = {
    type: "element",
    tagName: "hr",
    properties: {},
    children: []
  };
  return t.patch(r, a), t.applyData(r, a);
}
const Rw = {
  blockquote: sw,
  break: uw,
  code: cw,
  delete: dw,
  emphasis: fw,
  footnoteReference: hw,
  heading: mw,
  html: pw,
  imageReference: gw,
  image: yw,
  inlineCode: bw,
  linkReference: xw,
  link: vw,
  listItem: Sw,
  list: kw,
  paragraph: Cw,
  // @ts-expect-error: root is different, but hard to type.
  root: Ew,
  strong: jw,
  table: _w,
  tableCell: Tw,
  tableRow: Nw,
  text: Mw,
  thematicBreak: zw,
  toml: Ic,
  yaml: Ic,
  definition: Ic,
  footnoteDefinition: Ic
};
function Ic() {
}
const dx = -1, pd = 0, iu = 1, td = 2, Jm = 3, ep = 4, tp = 5, np = 6, fx = 7, hx = 8, yy = typeof self == "object" ? self : globalThis, Ow = (t, r) => {
  const a = (s, c) => (t.set(c, s), s), l = (s) => {
    if (t.has(s))
      return t.get(s);
    const [c, d] = r[s];
    switch (c) {
      case pd:
      case dx:
        return a(d, s);
      case iu: {
        const m = a([], s);
        for (const g of d)
          m.push(l(g));
        return m;
      }
      case td: {
        const m = a({}, s);
        for (const [g, p] of d)
          m[l(g)] = l(p);
        return m;
      }
      case Jm:
        return a(new Date(d), s);
      case ep: {
        const { source: m, flags: g } = d;
        return a(new RegExp(m, g), s);
      }
      case tp: {
        const m = a(/* @__PURE__ */ new Map(), s);
        for (const [g, p] of d)
          m.set(l(g), l(p));
        return m;
      }
      case np: {
        const m = a(/* @__PURE__ */ new Set(), s);
        for (const g of d)
          m.add(l(g));
        return m;
      }
      case fx: {
        const { name: m, message: g } = d;
        return a(new yy[m](g), s);
      }
      case hx:
        return a(BigInt(d), s);
      case "BigInt":
        return a(Object(BigInt(d)), s);
      case "ArrayBuffer":
        return a(new Uint8Array(d).buffer, d);
      case "DataView": {
        const { buffer: m } = new Uint8Array(d);
        return a(new DataView(m), d);
      }
    }
    return a(new yy[c](d), s);
  };
  return l;
}, by = (t) => Ow(/* @__PURE__ */ new Map(), t)(0), No = "", { toString: Dw } = {}, { keys: Lw } = Object, Ws = (t) => {
  const r = typeof t;
  if (r !== "object" || !t)
    return [pd, r];
  const a = Dw.call(t).slice(8, -1);
  switch (a) {
    case "Array":
      return [iu, No];
    case "Object":
      return [td, No];
    case "Date":
      return [Jm, No];
    case "RegExp":
      return [ep, No];
    case "Map":
      return [tp, No];
    case "Set":
      return [np, No];
    case "DataView":
      return [iu, a];
  }
  return a.includes("Array") ? [iu, a] : a.includes("Error") ? [fx, a] : [td, a];
}, Uc = ([t, r]) => t === pd && (r === "function" || r === "symbol"), Bw = (t, r, a, l) => {
  const s = (d, m) => {
    const g = l.push(d) - 1;
    return a.set(m, g), g;
  }, c = (d) => {
    if (a.has(d))
      return a.get(d);
    let [m, g] = Ws(d);
    switch (m) {
      case pd: {
        let v = d;
        switch (g) {
          case "bigint":
            m = hx, v = d.toString();
            break;
          case "function":
          case "symbol":
            if (t)
              throw new TypeError("unable to serialize " + g);
            v = null;
            break;
          case "undefined":
            return s([dx], d);
        }
        return s([m, v], d);
      }
      case iu: {
        if (g) {
          let E = d;
          return g === "DataView" ? E = new Uint8Array(d.buffer) : g === "ArrayBuffer" && (E = new Uint8Array(d)), s([g, [...E]], d);
        }
        const v = [], x = s([m, v], d);
        for (const E of d)
          v.push(c(E));
        return x;
      }
      case td: {
        if (g)
          switch (g) {
            case "BigInt":
              return s([g, d.toString()], d);
            case "Boolean":
            case "Number":
            case "String":
              return s([g, d.valueOf()], d);
          }
        if (r && "toJSON" in d)
          return c(d.toJSON());
        const v = [], x = s([m, v], d);
        for (const E of Lw(d))
          (t || !Uc(Ws(d[E]))) && v.push([c(E), c(d[E])]);
        return x;
      }
      case Jm:
        return s([m, d.toISOString()], d);
      case ep: {
        const { source: v, flags: x } = d;
        return s([m, { source: v, flags: x }], d);
      }
      case tp: {
        const v = [], x = s([m, v], d);
        for (const [E, w] of d)
          (t || !(Uc(Ws(E)) || Uc(Ws(w)))) && v.push([c(E), c(w)]);
        return x;
      }
      case np: {
        const v = [], x = s([m, v], d);
        for (const E of d)
          (t || !Uc(Ws(E))) && v.push(c(E));
        return x;
      }
    }
    const { message: p } = d;
    return s([m, { name: g, message: p }], d);
  };
  return c;
}, xy = (t, { json: r, lossy: a } = {}) => {
  const l = [];
  return Bw(!(r || a), !!r, /* @__PURE__ */ new Map(), l)(t), l;
}, nd = typeof structuredClone == "function" ? (
  /* c8 ignore start */
  (t, r) => r && ("json" in r || "lossy" in r) ? by(xy(t, r)) : structuredClone(t)
) : (t, r) => by(xy(t, r));
function Iw(t, r) {
  const a = [{ type: "text", value: "" }];
  return r > 1 && a.push({
    type: "element",
    tagName: "sup",
    properties: {},
    children: [{ type: "text", value: String(r) }]
  }), a;
}
function Uw(t, r) {
  return "Back to reference " + (t + 1) + (r > 1 ? "-" + r : "");
}
function Pw(t) {
  const r = typeof t.options.clobberPrefix == "string" ? t.options.clobberPrefix : "user-content-", a = t.options.footnoteBackContent || Iw, l = t.options.footnoteBackLabel || Uw, s = t.options.footnoteLabel || "Footnotes", c = t.options.footnoteLabelTagName || "h2", d = t.options.footnoteLabelProperties || {
    className: ["sr-only"]
  }, m = [];
  let g = -1;
  for (; ++g < t.footnoteOrder.length; ) {
    const p = t.footnoteById.get(
      t.footnoteOrder[g]
    );
    if (!p)
      continue;
    const v = t.all(p), x = String(p.identifier).toUpperCase(), E = qo(x.toLowerCase());
    let w = 0;
    const _ = [], A = t.footnoteCounts.get(x);
    for (; A !== void 0 && ++w <= A; ) {
      _.length > 0 && _.push({ type: "text", value: " " });
      let Z = typeof a == "string" ? a : a(g, w);
      typeof Z == "string" && (Z = { type: "text", value: Z }), _.push({
        type: "element",
        tagName: "a",
        properties: {
          href: "#" + r + "fnref-" + E + (w > 1 ? "-" + w : ""),
          dataFootnoteBackref: "",
          ariaLabel: typeof l == "string" ? l : l(g, w),
          className: ["data-footnote-backref"]
        },
        children: Array.isArray(Z) ? Z : [Z]
      });
    }
    const D = v[v.length - 1];
    if (D && D.type === "element" && D.tagName === "p") {
      const Z = D.children[D.children.length - 1];
      Z && Z.type === "text" ? Z.value += " " : D.children.push({ type: "text", value: " " }), D.children.push(..._);
    } else
      v.push(..._);
    const R = {
      type: "element",
      tagName: "li",
      properties: { id: r + "fn-" + E },
      children: t.wrap(v, !0)
    };
    t.patch(p, R), m.push(R);
  }
  if (m.length !== 0)
    return {
      type: "element",
      tagName: "section",
      properties: { dataFootnotes: !0, className: ["footnotes"] },
      children: [
        {
          type: "element",
          tagName: c,
          properties: {
            ...nd(d),
            id: "footnote-label"
          },
          children: [{ type: "text", value: s }]
        },
        { type: "text", value: `
` },
        {
          type: "element",
          tagName: "ol",
          properties: {},
          children: t.wrap(m, !0)
        },
        { type: "text", value: `
` }
      ]
    };
}
const gd = (
  // Note: overloads in JSDoc cant yet use different `@template`s.
  /**
   * @type {(
   *   (<Condition extends string>(test: Condition) => (node: unknown, index?: number | null | undefined, parent?: Parent | null | undefined, context?: unknown) => node is Node & {type: Condition}) &
   *   (<Condition extends Props>(test: Condition) => (node: unknown, index?: number | null | undefined, parent?: Parent | null | undefined, context?: unknown) => node is Node & Condition) &
   *   (<Condition extends TestFunction>(test: Condition) => (node: unknown, index?: number | null | undefined, parent?: Parent | null | undefined, context?: unknown) => node is Node & Predicate<Condition, Node>) &
   *   ((test?: null | undefined) => (node?: unknown, index?: number | null | undefined, parent?: Parent | null | undefined, context?: unknown) => node is Node) &
   *   ((test?: Test) => Check)
   * )}
   */
  /**
   * @param {Test} [test]
   * @returns {Check}
   */
  (function(t) {
    if (t == null)
      return $w;
    if (typeof t == "function")
      return yd(t);
    if (typeof t == "object")
      return Array.isArray(t) ? qw(t) : (
        // Cast because `ReadonlyArray` goes into the above but `isArray`
        // narrows to `Array`.
        Hw(
          /** @type {Props} */
          t
        )
      );
    if (typeof t == "string")
      return Fw(t);
    throw new Error("Expected function, string, or object as test");
  })
);
function qw(t) {
  const r = [];
  let a = -1;
  for (; ++a < t.length; )
    r[a] = gd(t[a]);
  return yd(l);
  function l(...s) {
    let c = -1;
    for (; ++c < r.length; )
      if (r[c].apply(this, s)) return !0;
    return !1;
  }
}
function Hw(t) {
  const r = (
    /** @type {Record<string, unknown>} */
    t
  );
  return yd(a);
  function a(l) {
    const s = (
      /** @type {Record<string, unknown>} */
      /** @type {unknown} */
      l
    );
    let c;
    for (c in t)
      if (s[c] !== r[c]) return !1;
    return !0;
  }
}
function Fw(t) {
  return yd(r);
  function r(a) {
    return a && a.type === t;
  }
}
function yd(t) {
  return r;
  function r(a, l, s) {
    return !!(Gw(a) && t.call(
      this,
      a,
      typeof l == "number" ? l : void 0,
      s || void 0
    ));
  }
}
function $w() {
  return !0;
}
function Gw(t) {
  return t !== null && typeof t == "object" && "type" in t;
}
const mx = [], Vw = !0, mm = !1, Kw = "skip";
function px(t, r, a, l) {
  let s;
  typeof r == "function" && typeof a != "function" ? (l = a, a = r) : s = r;
  const c = gd(s), d = l ? -1 : 1;
  m(t, void 0, [])();
  function m(g, p, v) {
    const x = (
      /** @type {Record<string, unknown>} */
      g && typeof g == "object" ? g : {}
    );
    if (typeof x.type == "string") {
      const w = (
        // `hast`
        typeof x.tagName == "string" ? x.tagName : (
          // `xast`
          typeof x.name == "string" ? x.name : void 0
        )
      );
      Object.defineProperty(E, "name", {
        value: "node (" + (g.type + (w ? "<" + w + ">" : "")) + ")"
      });
    }
    return E;
    function E() {
      let w = mx, _, A, D;
      if ((!r || c(g, p, v[v.length - 1] || void 0)) && (w = Yw(a(g, v)), w[0] === mm))
        return w;
      if ("children" in g && g.children) {
        const R = (
          /** @type {UnistParent} */
          g
        );
        if (R.children && w[0] !== Kw)
          for (A = (l ? R.children.length : -1) + d, D = v.concat(R); A > -1 && A < R.children.length; ) {
            const Z = R.children[A];
            if (_ = m(Z, A, D)(), _[0] === mm)
              return _;
            A = typeof _[1] == "number" ? _[1] : A + d;
          }
      }
      return w;
    }
  }
}
function Yw(t) {
  return Array.isArray(t) ? t : typeof t == "number" ? [Vw, t] : t == null ? mx : [t];
}
function rp(t, r, a, l) {
  let s, c, d;
  typeof r == "function" && typeof a != "function" ? (c = void 0, d = r, s = a) : (c = r, d = a, s = l), px(t, c, m, s);
  function m(g, p) {
    const v = p[p.length - 1], x = v ? v.children.indexOf(g) : void 0;
    return d(g, x, v);
  }
}
const pm = {}.hasOwnProperty, Qw = {};
function Xw(t, r) {
  const a = r || Qw, l = /* @__PURE__ */ new Map(), s = /* @__PURE__ */ new Map(), c = /* @__PURE__ */ new Map(), d = { ...Rw, ...a.handlers }, m = {
    all: p,
    applyData: Zw,
    definitionById: l,
    footnoteById: s,
    footnoteCounts: c,
    footnoteOrder: [],
    handlers: d,
    one: g,
    options: a,
    patch: Ww,
    wrap: ek
  };
  return rp(t, function(v) {
    if (v.type === "definition" || v.type === "footnoteDefinition") {
      const x = v.type === "definition" ? l : s, E = String(v.identifier).toUpperCase();
      x.has(E) || x.set(E, v);
    }
  }), m;
  function g(v, x) {
    const E = v.type, w = m.handlers[E];
    if (pm.call(m.handlers, E) && w)
      return w(m, v, x);
    if (m.options.passThrough && m.options.passThrough.includes(E)) {
      if ("children" in v) {
        const { children: A, ...D } = v, R = nd(D);
        return R.children = m.all(v), R;
      }
      return nd(v);
    }
    return (m.options.unknownHandler || Jw)(m, v, x);
  }
  function p(v) {
    const x = [];
    if ("children" in v) {
      const E = v.children;
      let w = -1;
      for (; ++w < E.length; ) {
        const _ = m.one(E[w], v);
        if (_) {
          if (w && E[w - 1].type === "break" && (!Array.isArray(_) && _.type === "text" && (_.value = vy(_.value)), !Array.isArray(_) && _.type === "element")) {
            const A = _.children[0];
            A && A.type === "text" && (A.value = vy(A.value));
          }
          Array.isArray(_) ? x.push(..._) : x.push(_);
        }
      }
    }
    return x;
  }
}
function Ww(t, r) {
  t.position && (r.position = U6(t));
}
function Zw(t, r) {
  let a = r;
  if (t && t.data) {
    const l = t.data.hName, s = t.data.hChildren, c = t.data.hProperties;
    if (typeof l == "string")
      if (a.type === "element")
        a.tagName = l;
      else {
        const d = "children" in a ? a.children : [a];
        a = { type: "element", tagName: l, properties: {}, children: d };
      }
    a.type === "element" && c && Object.assign(a.properties, nd(c)), "children" in a && a.children && s !== null && s !== void 0 && (a.children = s);
  }
  return a;
}
function Jw(t, r) {
  const a = r.data || {}, l = "value" in r && !(pm.call(a, "hProperties") || pm.call(a, "hChildren")) ? { type: "text", value: r.value } : {
    type: "element",
    tagName: "div",
    properties: {},
    children: t.all(r)
  };
  return t.patch(r, l), t.applyData(r, l);
}
function ek(t, r) {
  const a = [];
  let l = -1;
  for (r && a.push({ type: "text", value: `
` }); ++l < t.length; )
    l && a.push({ type: "text", value: `
` }), a.push(t[l]);
  return r && t.length > 0 && a.push({ type: "text", value: `
` }), a;
}
function vy(t) {
  let r = 0, a = t.charCodeAt(r);
  for (; a === 9 || a === 32; )
    r++, a = t.charCodeAt(r);
  return t.slice(r);
}
function Sy(t, r) {
  const a = Xw(t, r), l = a.one(t, void 0), s = Pw(a), c = Array.isArray(l) ? { type: "root", children: l } : l || { type: "root", children: [] };
  return s && c.children.push({ type: "text", value: `
` }, s), c;
}
function tk(t, r) {
  return t && "run" in t ? async function(a, l) {
    const s = (
      /** @type {HastRoot} */
      Sy(a, { file: l, ...r })
    );
    await t.run(s, l);
  } : function(a, l) {
    return (
      /** @type {HastRoot} */
      Sy(a, { file: l, ...t || r })
    );
  };
}
function wy(t) {
  if (t)
    throw t;
}
var zh, ky;
function nk() {
  if (ky) return zh;
  ky = 1;
  var t = Object.prototype.hasOwnProperty, r = Object.prototype.toString, a = Object.defineProperty, l = Object.getOwnPropertyDescriptor, s = function(p) {
    return typeof Array.isArray == "function" ? Array.isArray(p) : r.call(p) === "[object Array]";
  }, c = function(p) {
    if (!p || r.call(p) !== "[object Object]")
      return !1;
    var v = t.call(p, "constructor"), x = p.constructor && p.constructor.prototype && t.call(p.constructor.prototype, "isPrototypeOf");
    if (p.constructor && !v && !x)
      return !1;
    var E;
    for (E in p)
      ;
    return typeof E > "u" || t.call(p, E);
  }, d = function(p, v) {
    a && v.name === "__proto__" ? a(p, v.name, {
      enumerable: !0,
      configurable: !0,
      value: v.newValue,
      writable: !0
    }) : p[v.name] = v.newValue;
  }, m = function(p, v) {
    if (v === "__proto__")
      if (t.call(p, v)) {
        if (l)
          return l(p, v).value;
      } else return;
    return p[v];
  };
  return zh = function g() {
    var p, v, x, E, w, _, A = arguments[0], D = 1, R = arguments.length, Z = !1;
    for (typeof A == "boolean" && (Z = A, A = arguments[1] || {}, D = 2), (A == null || typeof A != "object" && typeof A != "function") && (A = {}); D < R; ++D)
      if (p = arguments[D], p != null)
        for (v in p)
          x = m(A, v), E = m(p, v), A !== E && (Z && E && (c(E) || (w = s(E))) ? (w ? (w = !1, _ = x && s(x) ? x : []) : _ = x && c(x) ? x : {}, d(A, { name: v, newValue: g(Z, _, E) })) : typeof E < "u" && d(A, { name: v, newValue: E }));
    return A;
  }, zh;
}
var rk = nk();
const Rh = /* @__PURE__ */ Nl(rk);
function gm(t) {
  if (typeof t != "object" || t === null)
    return !1;
  const r = Object.getPrototypeOf(t);
  return (r === null || r === Object.prototype || Object.getPrototypeOf(r) === null) && !(Symbol.toStringTag in t) && !(Symbol.iterator in t);
}
function ak() {
  const t = [], r = { run: a, use: l };
  return r;
  function a(...s) {
    let c = -1;
    const d = s.pop();
    if (typeof d != "function")
      throw new TypeError("Expected function as last argument, not " + d);
    m(null, ...s);
    function m(g, ...p) {
      const v = t[++c];
      let x = -1;
      if (g) {
        d(g);
        return;
      }
      for (; ++x < s.length; )
        (p[x] === null || p[x] === void 0) && (p[x] = s[x]);
      s = p, v ? ik(v, m)(...p) : d(null, ...p);
    }
  }
  function l(s) {
    if (typeof s != "function")
      throw new TypeError(
        "Expected `middelware` to be a function, not " + s
      );
    return t.push(s), r;
  }
}
function ik(t, r) {
  let a;
  return l;
  function l(...d) {
    const m = t.length > d.length;
    let g;
    m && d.push(s);
    try {
      g = t.apply(this, d);
    } catch (p) {
      const v = (
        /** @type {Error} */
        p
      );
      if (m && a)
        throw v;
      return s(v);
    }
    m || (g && g.then && typeof g.then == "function" ? g.then(c, s) : g instanceof Error ? s(g) : c(g));
  }
  function s(d, ...m) {
    a || (a = !0, r(d, ...m));
  }
  function c(d) {
    s(null, d);
  }
}
const aa = { basename: lk, dirname: ok, extname: sk, join: uk, sep: "/" };
function lk(t, r) {
  if (r !== void 0 && typeof r != "string")
    throw new TypeError('"ext" argument must be a string');
  xu(t);
  let a = 0, l = -1, s = t.length, c;
  if (r === void 0 || r.length === 0 || r.length > t.length) {
    for (; s--; )
      if (t.codePointAt(s) === 47) {
        if (c) {
          a = s + 1;
          break;
        }
      } else l < 0 && (c = !0, l = s + 1);
    return l < 0 ? "" : t.slice(a, l);
  }
  if (r === t)
    return "";
  let d = -1, m = r.length - 1;
  for (; s--; )
    if (t.codePointAt(s) === 47) {
      if (c) {
        a = s + 1;
        break;
      }
    } else
      d < 0 && (c = !0, d = s + 1), m > -1 && (t.codePointAt(s) === r.codePointAt(m--) ? m < 0 && (l = s) : (m = -1, l = d));
  return a === l ? l = d : l < 0 && (l = t.length), t.slice(a, l);
}
function ok(t) {
  if (xu(t), t.length === 0)
    return ".";
  let r = -1, a = t.length, l;
  for (; --a; )
    if (t.codePointAt(a) === 47) {
      if (l) {
        r = a;
        break;
      }
    } else l || (l = !0);
  return r < 0 ? t.codePointAt(0) === 47 ? "/" : "." : r === 1 && t.codePointAt(0) === 47 ? "//" : t.slice(0, r);
}
function sk(t) {
  xu(t);
  let r = t.length, a = -1, l = 0, s = -1, c = 0, d;
  for (; r--; ) {
    const m = t.codePointAt(r);
    if (m === 47) {
      if (d) {
        l = r + 1;
        break;
      }
      continue;
    }
    a < 0 && (d = !0, a = r + 1), m === 46 ? s < 0 ? s = r : c !== 1 && (c = 1) : s > -1 && (c = -1);
  }
  return s < 0 || a < 0 || // We saw a non-dot character immediately before the dot.
  c === 0 || // The (right-most) trimmed path component is exactly `..`.
  c === 1 && s === a - 1 && s === l + 1 ? "" : t.slice(s, a);
}
function uk(...t) {
  let r = -1, a;
  for (; ++r < t.length; )
    xu(t[r]), t[r] && (a = a === void 0 ? t[r] : a + "/" + t[r]);
  return a === void 0 ? "." : ck(a);
}
function ck(t) {
  xu(t);
  const r = t.codePointAt(0) === 47;
  let a = dk(t, !r);
  return a.length === 0 && !r && (a = "."), a.length > 0 && t.codePointAt(t.length - 1) === 47 && (a += "/"), r ? "/" + a : a;
}
function dk(t, r) {
  let a = "", l = 0, s = -1, c = 0, d = -1, m, g;
  for (; ++d <= t.length; ) {
    if (d < t.length)
      m = t.codePointAt(d);
    else {
      if (m === 47)
        break;
      m = 47;
    }
    if (m === 47) {
      if (!(s === d - 1 || c === 1)) if (s !== d - 1 && c === 2) {
        if (a.length < 2 || l !== 2 || a.codePointAt(a.length - 1) !== 46 || a.codePointAt(a.length - 2) !== 46) {
          if (a.length > 2) {
            if (g = a.lastIndexOf("/"), g !== a.length - 1) {
              g < 0 ? (a = "", l = 0) : (a = a.slice(0, g), l = a.length - 1 - a.lastIndexOf("/")), s = d, c = 0;
              continue;
            }
          } else if (a.length > 0) {
            a = "", l = 0, s = d, c = 0;
            continue;
          }
        }
        r && (a = a.length > 0 ? a + "/.." : "..", l = 2);
      } else
        a.length > 0 ? a += "/" + t.slice(s + 1, d) : a = t.slice(s + 1, d), l = d - s - 1;
      s = d, c = 0;
    } else m === 46 && c > -1 ? c++ : c = -1;
  }
  return a;
}
function xu(t) {
  if (typeof t != "string")
    throw new TypeError(
      "Path must be a string. Received " + JSON.stringify(t)
    );
}
const fk = { cwd: hk };
function hk() {
  return "/";
}
function ym(t) {
  return !!(t !== null && typeof t == "object" && "href" in t && t.href && "protocol" in t && t.protocol && // @ts-expect-error: indexing is fine.
  t.auth === void 0);
}
function mk(t) {
  if (typeof t == "string")
    t = new URL(t);
  else if (!ym(t)) {
    const r = new TypeError(
      'The "path" argument must be of type string or an instance of URL. Received `' + t + "`"
    );
    throw r.code = "ERR_INVALID_ARG_TYPE", r;
  }
  if (t.protocol !== "file:") {
    const r = new TypeError("The URL must be of scheme file");
    throw r.code = "ERR_INVALID_URL_SCHEME", r;
  }
  return pk(t);
}
function pk(t) {
  if (t.hostname !== "") {
    const l = new TypeError(
      'File URL host must be "localhost" or empty on darwin'
    );
    throw l.code = "ERR_INVALID_FILE_URL_HOST", l;
  }
  const r = t.pathname;
  let a = -1;
  for (; ++a < r.length; )
    if (r.codePointAt(a) === 37 && r.codePointAt(a + 1) === 50) {
      const l = r.codePointAt(a + 2);
      if (l === 70 || l === 102) {
        const s = new TypeError(
          "File URL path must not include encoded / characters"
        );
        throw s.code = "ERR_INVALID_FILE_URL_PATH", s;
      }
    }
  return decodeURIComponent(r);
}
const Oh = (
  /** @type {const} */
  [
    "history",
    "path",
    "basename",
    "stem",
    "extname",
    "dirname"
  ]
);
class gx {
  /**
   * Create a new virtual file.
   *
   * `options` is treated as:
   *
   * *   `string` or `Uint8Array`  `{value: options}`
   * *   `URL`  `{path: options}`
   * *   `VFile`  shallow copies its data over to the new file
   * *   `object`  all fields are shallow copied over to the new file
   *
   * Path related fields are set in the following order (least specific to
   * most specific): `history`, `path`, `basename`, `stem`, `extname`,
   * `dirname`.
   *
   * You cannot set `dirname` or `extname` without setting either `history`,
   * `path`, `basename`, or `stem` too.
   *
   * @param {Compatible | null | undefined} [value]
   *   File value.
   * @returns
   *   New instance.
   */
  constructor(r) {
    let a;
    r ? ym(r) ? a = { path: r } : typeof r == "string" || gk(r) ? a = { value: r } : a = r : a = {}, this.cwd = "cwd" in a ? "" : fk.cwd(), this.data = {}, this.history = [], this.messages = [], this.value, this.map, this.result, this.stored;
    let l = -1;
    for (; ++l < Oh.length; ) {
      const c = Oh[l];
      c in a && a[c] !== void 0 && a[c] !== null && (this[c] = c === "history" ? [...a[c]] : a[c]);
    }
    let s;
    for (s in a)
      Oh.includes(s) || (this[s] = a[s]);
  }
  /**
   * Get the basename (including extname) (example: `'index.min.js'`).
   *
   * @returns {string | undefined}
   *   Basename.
   */
  get basename() {
    return typeof this.path == "string" ? aa.basename(this.path) : void 0;
  }
  /**
   * Set basename (including extname) (`'index.min.js'`).
   *
   * Cannot contain path separators (`'/'` on unix, macOS, and browsers, `'\'`
   * on windows).
   * Cannot be nullified (use `file.path = file.dirname` instead).
   *
   * @param {string} basename
   *   Basename.
   * @returns {undefined}
   *   Nothing.
   */
  set basename(r) {
    Lh(r, "basename"), Dh(r, "basename"), this.path = aa.join(this.dirname || "", r);
  }
  /**
   * Get the parent path (example: `'~'`).
   *
   * @returns {string | undefined}
   *   Dirname.
   */
  get dirname() {
    return typeof this.path == "string" ? aa.dirname(this.path) : void 0;
  }
  /**
   * Set the parent path (example: `'~'`).
   *
   * Cannot be set if theres no `path` yet.
   *
   * @param {string | undefined} dirname
   *   Dirname.
   * @returns {undefined}
   *   Nothing.
   */
  set dirname(r) {
    Cy(this.basename, "dirname"), this.path = aa.join(r || "", this.basename);
  }
  /**
   * Get the extname (including dot) (example: `'.js'`).
   *
   * @returns {string | undefined}
   *   Extname.
   */
  get extname() {
    return typeof this.path == "string" ? aa.extname(this.path) : void 0;
  }
  /**
   * Set the extname (including dot) (example: `'.js'`).
   *
   * Cannot contain path separators (`'/'` on unix, macOS, and browsers, `'\'`
   * on windows).
   * Cannot be set if theres no `path` yet.
   *
   * @param {string | undefined} extname
   *   Extname.
   * @returns {undefined}
   *   Nothing.
   */
  set extname(r) {
    if (Dh(r, "extname"), Cy(this.dirname, "extname"), r) {
      if (r.codePointAt(0) !== 46)
        throw new Error("`extname` must start with `.`");
      if (r.includes(".", 1))
        throw new Error("`extname` cannot contain multiple dots");
    }
    this.path = aa.join(this.dirname, this.stem + (r || ""));
  }
  /**
   * Get the full path (example: `'~/index.min.js'`).
   *
   * @returns {string}
   *   Path.
   */
  get path() {
    return this.history[this.history.length - 1];
  }
  /**
   * Set the full path (example: `'~/index.min.js'`).
   *
   * Cannot be nullified.
   * You can set a file URL (a `URL` object with a `file:` protocol) which will
   * be turned into a path with `url.fileURLToPath`.
   *
   * @param {URL | string} path
   *   Path.
   * @returns {undefined}
   *   Nothing.
   */
  set path(r) {
    ym(r) && (r = mk(r)), Lh(r, "path"), this.path !== r && this.history.push(r);
  }
  /**
   * Get the stem (basename w/o extname) (example: `'index.min'`).
   *
   * @returns {string | undefined}
   *   Stem.
   */
  get stem() {
    return typeof this.path == "string" ? aa.basename(this.path, this.extname) : void 0;
  }
  /**
   * Set the stem (basename w/o extname) (example: `'index.min'`).
   *
   * Cannot contain path separators (`'/'` on unix, macOS, and browsers, `'\'`
   * on windows).
   * Cannot be nullified (use `file.path = file.dirname` instead).
   *
   * @param {string} stem
   *   Stem.
   * @returns {undefined}
   *   Nothing.
   */
  set stem(r) {
    Lh(r, "stem"), Dh(r, "stem"), this.path = aa.join(this.dirname || "", r + (this.extname || ""));
  }
  // Normal prototypal methods.
  /**
   * Create a fatal message for `reason` associated with the file.
   *
   * The `fatal` field of the message is set to `true` (error; file not usable)
   * and the `file` field is set to the current file path.
   * The message is added to the `messages` field on `file`.
   *
   * >  **Note**: also has obsolete signatures.
   *
   * @overload
   * @param {string} reason
   * @param {MessageOptions | null | undefined} [options]
   * @returns {never}
   *
   * @overload
   * @param {string} reason
   * @param {Node | NodeLike | null | undefined} parent
   * @param {string | null | undefined} [origin]
   * @returns {never}
   *
   * @overload
   * @param {string} reason
   * @param {Point | Position | null | undefined} place
   * @param {string | null | undefined} [origin]
   * @returns {never}
   *
   * @overload
   * @param {string} reason
   * @param {string | null | undefined} [origin]
   * @returns {never}
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {Node | NodeLike | null | undefined} parent
   * @param {string | null | undefined} [origin]
   * @returns {never}
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {Point | Position | null | undefined} place
   * @param {string | null | undefined} [origin]
   * @returns {never}
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {string | null | undefined} [origin]
   * @returns {never}
   *
   * @param {Error | VFileMessage | string} causeOrReason
   *   Reason for message, should use markdown.
   * @param {Node | NodeLike | MessageOptions | Point | Position | string | null | undefined} [optionsOrParentOrPlace]
   *   Configuration (optional).
   * @param {string | null | undefined} [origin]
   *   Place in code where the message originates (example:
   *   `'my-package:my-rule'` or `'my-rule'`).
   * @returns {never}
   *   Never.
   * @throws {VFileMessage}
   *   Message.
   */
  fail(r, a, l) {
    const s = this.message(r, a, l);
    throw s.fatal = !0, s;
  }
  /**
   * Create an info message for `reason` associated with the file.
   *
   * The `fatal` field of the message is set to `undefined` (info; change
   * likely not needed) and the `file` field is set to the current file path.
   * The message is added to the `messages` field on `file`.
   *
   * >  **Note**: also has obsolete signatures.
   *
   * @overload
   * @param {string} reason
   * @param {MessageOptions | null | undefined} [options]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {string} reason
   * @param {Node | NodeLike | null | undefined} parent
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {string} reason
   * @param {Point | Position | null | undefined} place
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {string} reason
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {Node | NodeLike | null | undefined} parent
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {Point | Position | null | undefined} place
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @param {Error | VFileMessage | string} causeOrReason
   *   Reason for message, should use markdown.
   * @param {Node | NodeLike | MessageOptions | Point | Position | string | null | undefined} [optionsOrParentOrPlace]
   *   Configuration (optional).
   * @param {string | null | undefined} [origin]
   *   Place in code where the message originates (example:
   *   `'my-package:my-rule'` or `'my-rule'`).
   * @returns {VFileMessage}
   *   Message.
   */
  info(r, a, l) {
    const s = this.message(r, a, l);
    return s.fatal = void 0, s;
  }
  /**
   * Create a message for `reason` associated with the file.
   *
   * The `fatal` field of the message is set to `false` (warning; change may be
   * needed) and the `file` field is set to the current file path.
   * The message is added to the `messages` field on `file`.
   *
   * >  **Note**: also has obsolete signatures.
   *
   * @overload
   * @param {string} reason
   * @param {MessageOptions | null | undefined} [options]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {string} reason
   * @param {Node | NodeLike | null | undefined} parent
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {string} reason
   * @param {Point | Position | null | undefined} place
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {string} reason
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {Node | NodeLike | null | undefined} parent
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {Point | Position | null | undefined} place
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @param {Error | VFileMessage | string} causeOrReason
   *   Reason for message, should use markdown.
   * @param {Node | NodeLike | MessageOptions | Point | Position | string | null | undefined} [optionsOrParentOrPlace]
   *   Configuration (optional).
   * @param {string | null | undefined} [origin]
   *   Place in code where the message originates (example:
   *   `'my-package:my-rule'` or `'my-rule'`).
   * @returns {VFileMessage}
   *   Message.
   */
  message(r, a, l) {
    const s = new Bn(
      // @ts-expect-error: the overloads are fine.
      r,
      a,
      l
    );
    return this.path && (s.name = this.path + ":" + s.name, s.file = this.path), s.fatal = !1, this.messages.push(s), s;
  }
  /**
   * Serialize the file.
   *
   * > **Note**: which encodings are supported depends on the engine.
   * > For info on Node.js, see:
   * > <https://nodejs.org/api/util.html#whatwg-supported-encodings>.
   *
   * @param {string | null | undefined} [encoding='utf8']
   *   Character encoding to understand `value` as when its a `Uint8Array`
   *   (default: `'utf-8'`).
   * @returns {string}
   *   Serialized file.
   */
  toString(r) {
    return this.value === void 0 ? "" : typeof this.value == "string" ? this.value : new TextDecoder(r || void 0).decode(this.value);
  }
}
function Dh(t, r) {
  if (t && t.includes(aa.sep))
    throw new Error(
      "`" + r + "` cannot be a path: did not expect `" + aa.sep + "`"
    );
}
function Lh(t, r) {
  if (!t)
    throw new Error("`" + r + "` cannot be empty");
}
function Cy(t, r) {
  if (!t)
    throw new Error("Setting `" + r + "` requires `path` to be set too");
}
function gk(t) {
  return !!(t && typeof t == "object" && "byteLength" in t && "byteOffset" in t);
}
const yk = (
  /**
   * @type {new <Parameters extends Array<unknown>, Result>(property: string | symbol) => (...parameters: Parameters) => Result}
   */
  /** @type {unknown} */
  /**
   * @this {Function}
   * @param {string | symbol} property
   * @returns {(...parameters: Array<unknown>) => unknown}
   */
  (function(t) {
    const l = (
      /** @type {Record<string | symbol, Function>} */
      // Prototypes do exist.
      // type-coverage:ignore-next-line
      this.constructor.prototype
    ), s = l[t], c = function() {
      return s.apply(c, arguments);
    };
    return Object.setPrototypeOf(c, l), c;
  })
), bk = {}.hasOwnProperty;
class ap extends yk {
  /**
   * Create a processor.
   */
  constructor() {
    super("copy"), this.Compiler = void 0, this.Parser = void 0, this.attachers = [], this.compiler = void 0, this.freezeIndex = -1, this.frozen = void 0, this.namespace = {}, this.parser = void 0, this.transformers = ak();
  }
  /**
   * Copy a processor.
   *
   * @deprecated
   *   This is a private internal method and should not be used.
   * @returns {Processor<ParseTree, HeadTree, TailTree, CompileTree, CompileResult>}
   *   New *unfrozen* processor ({@linkcode Processor}) that is
   *   configured to work the same as its ancestor.
   *   When the descendant processor is configured in the future it does not
   *   affect the ancestral processor.
   */
  copy() {
    const r = (
      /** @type {Processor<ParseTree, HeadTree, TailTree, CompileTree, CompileResult>} */
      new ap()
    );
    let a = -1;
    for (; ++a < this.attachers.length; ) {
      const l = this.attachers[a];
      r.use(...l);
    }
    return r.data(Rh(!0, {}, this.namespace)), r;
  }
  /**
   * Configure the processor with info available to all plugins.
   * Information is stored in an object.
   *
   * Typically, options can be given to a specific plugin, but sometimes it
   * makes sense to have information shared with several plugins.
   * For example, a list of HTML elements that are self-closing, which is
   * needed during all phases.
   *
   * > **Note**: setting information cannot occur on *frozen* processors.
   * > Call the processor first to create a new unfrozen processor.
   *
   * > **Note**: to register custom data in TypeScript, augment the
   * > {@linkcode Data} interface.
   *
   * @example
   *   This example show how to get and set info:
   *
   *   ```js
   *   import {unified} from 'unified'
   *
   *   const processor = unified().data('alpha', 'bravo')
   *
   *   processor.data('alpha') // => 'bravo'
   *
   *   processor.data() // => {alpha: 'bravo'}
   *
   *   processor.data({charlie: 'delta'})
   *
   *   processor.data() // => {charlie: 'delta'}
   *   ```
   *
   * @template {keyof Data} Key
   *
   * @overload
   * @returns {Data}
   *
   * @overload
   * @param {Data} dataset
   * @returns {Processor<ParseTree, HeadTree, TailTree, CompileTree, CompileResult>}
   *
   * @overload
   * @param {Key} key
   * @returns {Data[Key]}
   *
   * @overload
   * @param {Key} key
   * @param {Data[Key]} value
   * @returns {Processor<ParseTree, HeadTree, TailTree, CompileTree, CompileResult>}
   *
   * @param {Data | Key} [key]
   *   Key to get or set, or entire dataset to set, or nothing to get the
   *   entire dataset (optional).
   * @param {Data[Key]} [value]
   *   Value to set (optional).
   * @returns {unknown}
   *   The current processor when setting, the value at `key` when getting, or
   *   the entire dataset when getting without key.
   */
  data(r, a) {
    return typeof r == "string" ? arguments.length === 2 ? (Uh("data", this.frozen), this.namespace[r] = a, this) : bk.call(this.namespace, r) && this.namespace[r] || void 0 : r ? (Uh("data", this.frozen), this.namespace = r, this) : this.namespace;
  }
  /**
   * Freeze a processor.
   *
   * Frozen processors are meant to be extended and not to be configured
   * directly.
   *
   * When a processor is frozen it cannot be unfrozen.
   * New processors working the same way can be created by calling the
   * processor.
   *
   * Its possible to freeze processors explicitly by calling `.freeze()`.
   * Processors freeze automatically when `.parse()`, `.run()`, `.runSync()`,
   * `.stringify()`, `.process()`, or `.processSync()` are called.
   *
   * @returns {Processor<ParseTree, HeadTree, TailTree, CompileTree, CompileResult>}
   *   The current processor.
   */
  freeze() {
    if (this.frozen)
      return this;
    const r = (
      /** @type {Processor} */
      /** @type {unknown} */
      this
    );
    for (; ++this.freezeIndex < this.attachers.length; ) {
      const [a, ...l] = this.attachers[this.freezeIndex];
      if (l[0] === !1)
        continue;
      l[0] === !0 && (l[0] = void 0);
      const s = a.call(r, ...l);
      typeof s == "function" && this.transformers.use(s);
    }
    return this.frozen = !0, this.freezeIndex = Number.POSITIVE_INFINITY, this;
  }
  /**
   * Parse text to a syntax tree.
   *
   * > **Note**: `parse` freezes the processor if not already *frozen*.
   *
   * > **Note**: `parse` performs the parse phase, not the run phase or other
   * > phases.
   *
   * @param {Compatible | undefined} [file]
   *   file to parse (optional); typically `string` or `VFile`; any value
   *   accepted as `x` in `new VFile(x)`.
   * @returns {ParseTree extends undefined ? Node : ParseTree}
   *   Syntax tree representing `file`.
   */
  parse(r) {
    this.freeze();
    const a = Pc(r), l = this.parser || this.Parser;
    return Bh("parse", l), l(String(a), a);
  }
  /**
   * Process the given file as configured on the processor.
   *
   * > **Note**: `process` freezes the processor if not already *frozen*.
   *
   * > **Note**: `process` performs the parse, run, and stringify phases.
   *
   * @overload
   * @param {Compatible | undefined} file
   * @param {ProcessCallback<VFileWithOutput<CompileResult>>} done
   * @returns {undefined}
   *
   * @overload
   * @param {Compatible | undefined} [file]
   * @returns {Promise<VFileWithOutput<CompileResult>>}
   *
   * @param {Compatible | undefined} [file]
   *   File (optional); typically `string` or `VFile`]; any value accepted as
   *   `x` in `new VFile(x)`.
   * @param {ProcessCallback<VFileWithOutput<CompileResult>> | undefined} [done]
   *   Callback (optional).
   * @returns {Promise<VFile> | undefined}
   *   Nothing if `done` is given.
   *   Otherwise a promise, rejected with a fatal error or resolved with the
   *   processed file.
   *
   *   The parsed, transformed, and compiled value is available at
   *   `file.value` (see note).
   *
   *   > **Note**: unified typically compiles by serializing: most
   *   > compilers return `string` (or `Uint8Array`).
   *   > Some compilers, such as the one configured with
   *   > [`rehype-react`][rehype-react], return other values (in this case, a
   *   > React tree).
   *   > If youre using a compiler that doesnt serialize, expect different
   *   > result values.
   *   >
   *   > To register custom results in TypeScript, add them to
   *   > {@linkcode CompileResultMap}.
   *
   *   [rehype-react]: https://github.com/rehypejs/rehype-react
   */
  process(r, a) {
    const l = this;
    return this.freeze(), Bh("process", this.parser || this.Parser), Ih("process", this.compiler || this.Compiler), a ? s(void 0, a) : new Promise(s);
    function s(c, d) {
      const m = Pc(r), g = (
        /** @type {HeadTree extends undefined ? Node : HeadTree} */
        /** @type {unknown} */
        l.parse(m)
      );
      l.run(g, m, function(v, x, E) {
        if (v || !x || !E)
          return p(v);
        const w = (
          /** @type {CompileTree extends undefined ? Node : CompileTree} */
          /** @type {unknown} */
          x
        ), _ = l.stringify(w, E);
        Sk(_) ? E.value = _ : E.result = _, p(
          v,
          /** @type {VFileWithOutput<CompileResult>} */
          E
        );
      });
      function p(v, x) {
        v || !x ? d(v) : c ? c(x) : a(void 0, x);
      }
    }
  }
  /**
   * Process the given file as configured on the processor.
   *
   * An error is thrown if asynchronous transforms are configured.
   *
   * > **Note**: `processSync` freezes the processor if not already *frozen*.
   *
   * > **Note**: `processSync` performs the parse, run, and stringify phases.
   *
   * @param {Compatible | undefined} [file]
   *   File (optional); typically `string` or `VFile`; any value accepted as
   *   `x` in `new VFile(x)`.
   * @returns {VFileWithOutput<CompileResult>}
   *   The processed file.
   *
   *   The parsed, transformed, and compiled value is available at
   *   `file.value` (see note).
   *
   *   > **Note**: unified typically compiles by serializing: most
   *   > compilers return `string` (or `Uint8Array`).
   *   > Some compilers, such as the one configured with
   *   > [`rehype-react`][rehype-react], return other values (in this case, a
   *   > React tree).
   *   > If youre using a compiler that doesnt serialize, expect different
   *   > result values.
   *   >
   *   > To register custom results in TypeScript, add them to
   *   > {@linkcode CompileResultMap}.
   *
   *   [rehype-react]: https://github.com/rehypejs/rehype-react
   */
  processSync(r) {
    let a = !1, l;
    return this.freeze(), Bh("processSync", this.parser || this.Parser), Ih("processSync", this.compiler || this.Compiler), this.process(r, s), jy("processSync", "process", a), l;
    function s(c, d) {
      a = !0, wy(c), l = d;
    }
  }
  /**
   * Run *transformers* on a syntax tree.
   *
   * > **Note**: `run` freezes the processor if not already *frozen*.
   *
   * > **Note**: `run` performs the run phase, not other phases.
   *
   * @overload
   * @param {HeadTree extends undefined ? Node : HeadTree} tree
   * @param {RunCallback<TailTree extends undefined ? Node : TailTree>} done
   * @returns {undefined}
   *
   * @overload
   * @param {HeadTree extends undefined ? Node : HeadTree} tree
   * @param {Compatible | undefined} file
   * @param {RunCallback<TailTree extends undefined ? Node : TailTree>} done
   * @returns {undefined}
   *
   * @overload
   * @param {HeadTree extends undefined ? Node : HeadTree} tree
   * @param {Compatible | undefined} [file]
   * @returns {Promise<TailTree extends undefined ? Node : TailTree>}
   *
   * @param {HeadTree extends undefined ? Node : HeadTree} tree
   *   Tree to transform and inspect.
   * @param {(
   *   RunCallback<TailTree extends undefined ? Node : TailTree> |
   *   Compatible
   * )} [file]
   *   File associated with `node` (optional); any value accepted as `x` in
   *   `new VFile(x)`.
   * @param {RunCallback<TailTree extends undefined ? Node : TailTree>} [done]
   *   Callback (optional).
   * @returns {Promise<TailTree extends undefined ? Node : TailTree> | undefined}
   *   Nothing if `done` is given.
   *   Otherwise, a promise rejected with a fatal error or resolved with the
   *   transformed tree.
   */
  run(r, a, l) {
    Ey(r), this.freeze();
    const s = this.transformers;
    return !l && typeof a == "function" && (l = a, a = void 0), l ? c(void 0, l) : new Promise(c);
    function c(d, m) {
      const g = Pc(a);
      s.run(r, g, p);
      function p(v, x, E) {
        const w = (
          /** @type {TailTree extends undefined ? Node : TailTree} */
          x || r
        );
        v ? m(v) : d ? d(w) : l(void 0, w, E);
      }
    }
  }
  /**
   * Run *transformers* on a syntax tree.
   *
   * An error is thrown if asynchronous transforms are configured.
   *
   * > **Note**: `runSync` freezes the processor if not already *frozen*.
   *
   * > **Note**: `runSync` performs the run phase, not other phases.
   *
   * @param {HeadTree extends undefined ? Node : HeadTree} tree
   *   Tree to transform and inspect.
   * @param {Compatible | undefined} [file]
   *   File associated with `node` (optional); any value accepted as `x` in
   *   `new VFile(x)`.
   * @returns {TailTree extends undefined ? Node : TailTree}
   *   Transformed tree.
   */
  runSync(r, a) {
    let l = !1, s;
    return this.run(r, a, c), jy("runSync", "run", l), s;
    function c(d, m) {
      wy(d), s = m, l = !0;
    }
  }
  /**
   * Compile a syntax tree.
   *
   * > **Note**: `stringify` freezes the processor if not already *frozen*.
   *
   * > **Note**: `stringify` performs the stringify phase, not the run phase
   * > or other phases.
   *
   * @param {CompileTree extends undefined ? Node : CompileTree} tree
   *   Tree to compile.
   * @param {Compatible | undefined} [file]
   *   File associated with `node` (optional); any value accepted as `x` in
   *   `new VFile(x)`.
   * @returns {CompileResult extends undefined ? Value : CompileResult}
   *   Textual representation of the tree (see note).
   *
   *   > **Note**: unified typically compiles by serializing: most compilers
   *   > return `string` (or `Uint8Array`).
   *   > Some compilers, such as the one configured with
   *   > [`rehype-react`][rehype-react], return other values (in this case, a
   *   > React tree).
   *   > If youre using a compiler that doesnt serialize, expect different
   *   > result values.
   *   >
   *   > To register custom results in TypeScript, add them to
   *   > {@linkcode CompileResultMap}.
   *
   *   [rehype-react]: https://github.com/rehypejs/rehype-react
   */
  stringify(r, a) {
    this.freeze();
    const l = Pc(a), s = this.compiler || this.Compiler;
    return Ih("stringify", s), Ey(r), s(r, l);
  }
  /**
   * Configure the processor to use a plugin, a list of usable values, or a
   * preset.
   *
   * If the processor is already using a plugin, the previous plugin
   * configuration is changed based on the options that are passed in.
   * In other words, the plugin is not added a second time.
   *
   * > **Note**: `use` cannot be called on *frozen* processors.
   * > Call the processor first to create a new unfrozen processor.
   *
   * @example
   *   There are many ways to pass plugins to `.use()`.
   *   This example gives an overview:
   *
   *   ```js
   *   import {unified} from 'unified'
   *
   *   unified()
   *     // Plugin with options:
   *     .use(pluginA, {x: true, y: true})
   *     // Passing the same plugin again merges configuration (to `{x: true, y: false, z: true}`):
   *     .use(pluginA, {y: false, z: true})
   *     // Plugins:
   *     .use([pluginB, pluginC])
   *     // Two plugins, the second with options:
   *     .use([pluginD, [pluginE, {}]])
   *     // Preset with plugins and settings:
   *     .use({plugins: [pluginF, [pluginG, {}]], settings: {position: false}})
   *     // Settings only:
   *     .use({settings: {position: false}})
   *   ```
   *
   * @template {Array<unknown>} [Parameters=[]]
   * @template {Node | string | undefined} [Input=undefined]
   * @template [Output=Input]
   *
   * @overload
   * @param {Preset | null | undefined} [preset]
   * @returns {Processor<ParseTree, HeadTree, TailTree, CompileTree, CompileResult>}
   *
   * @overload
   * @param {PluggableList} list
   * @returns {Processor<ParseTree, HeadTree, TailTree, CompileTree, CompileResult>}
   *
   * @overload
   * @param {Plugin<Parameters, Input, Output>} plugin
   * @param {...(Parameters | [boolean])} parameters
   * @returns {UsePlugin<ParseTree, HeadTree, TailTree, CompileTree, CompileResult, Input, Output>}
   *
   * @param {PluggableList | Plugin | Preset | null | undefined} value
   *   Usable value.
   * @param {...unknown} parameters
   *   Parameters, when a plugin is given as a usable value.
   * @returns {Processor<ParseTree, HeadTree, TailTree, CompileTree, CompileResult>}
   *   Current processor.
   */
  use(r, ...a) {
    const l = this.attachers, s = this.namespace;
    if (Uh("use", this.frozen), r != null) if (typeof r == "function")
      g(r, a);
    else if (typeof r == "object")
      Array.isArray(r) ? m(r) : d(r);
    else
      throw new TypeError("Expected usable value, not `" + r + "`");
    return this;
    function c(p) {
      if (typeof p == "function")
        g(p, []);
      else if (typeof p == "object")
        if (Array.isArray(p)) {
          const [v, ...x] = (
            /** @type {PluginTuple<Array<unknown>>} */
            p
          );
          g(v, x);
        } else
          d(p);
      else
        throw new TypeError("Expected usable value, not `" + p + "`");
    }
    function d(p) {
      if (!("plugins" in p) && !("settings" in p))
        throw new Error(
          "Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither"
        );
      m(p.plugins), p.settings && (s.settings = Rh(!0, s.settings, p.settings));
    }
    function m(p) {
      let v = -1;
      if (p != null) if (Array.isArray(p))
        for (; ++v < p.length; ) {
          const x = p[v];
          c(x);
        }
      else
        throw new TypeError("Expected a list of plugins, not `" + p + "`");
    }
    function g(p, v) {
      let x = -1, E = -1;
      for (; ++x < l.length; )
        if (l[x][0] === p) {
          E = x;
          break;
        }
      if (E === -1)
        l.push([p, ...v]);
      else if (v.length > 0) {
        let [w, ..._] = v;
        const A = l[E][1];
        gm(A) && gm(w) && (w = Rh(!0, A, w)), l[E] = [p, w, ..._];
      }
    }
  }
}
const xk = new ap().freeze();
function Bh(t, r) {
  if (typeof r != "function")
    throw new TypeError("Cannot `" + t + "` without `parser`");
}
function Ih(t, r) {
  if (typeof r != "function")
    throw new TypeError("Cannot `" + t + "` without `compiler`");
}
function Uh(t, r) {
  if (r)
    throw new Error(
      "Cannot call `" + t + "` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`."
    );
}
function Ey(t) {
  if (!gm(t) || typeof t.type != "string")
    throw new TypeError("Expected node, got `" + t + "`");
}
function jy(t, r, a) {
  if (!a)
    throw new Error(
      "`" + t + "` finished async. Use `" + r + "` instead"
    );
}
function Pc(t) {
  return vk(t) ? t : new gx(t);
}
function vk(t) {
  return !!(t && typeof t == "object" && "message" in t && "messages" in t);
}
function Sk(t) {
  return typeof t == "string" || wk(t);
}
function wk(t) {
  return !!(t && typeof t == "object" && "byteLength" in t && "byteOffset" in t);
}
const kk = "https://github.com/remarkjs/react-markdown/blob/main/changelog.md", _y = [], Ny = { allowDangerousHtml: !0 }, Ck = /^(https?|ircs?|mailto|xmpp)$/i, Ek = [
  { from: "astPlugins", id: "remove-buggy-html-in-markdown-parser" },
  { from: "allowDangerousHtml", id: "remove-buggy-html-in-markdown-parser" },
  {
    from: "allowNode",
    id: "replace-allownode-allowedtypes-and-disallowedtypes",
    to: "allowElement"
  },
  {
    from: "allowedTypes",
    id: "replace-allownode-allowedtypes-and-disallowedtypes",
    to: "allowedElements"
  },
  { from: "className", id: "remove-classname" },
  {
    from: "disallowedTypes",
    id: "replace-allownode-allowedtypes-and-disallowedtypes",
    to: "disallowedElements"
  },
  { from: "escapeHtml", id: "remove-buggy-html-in-markdown-parser" },
  { from: "includeElementIndex", id: "#remove-includeelementindex" },
  {
    from: "includeNodeIndex",
    id: "change-includenodeindex-to-includeelementindex"
  },
  { from: "linkTarget", id: "remove-linktarget" },
  { from: "plugins", id: "change-plugins-to-remarkplugins", to: "remarkPlugins" },
  { from: "rawSourcePos", id: "#remove-rawsourcepos" },
  { from: "renderers", id: "change-renderers-to-components", to: "components" },
  { from: "source", id: "change-source-to-children", to: "children" },
  { from: "sourcePos", id: "#remove-sourcepos" },
  { from: "transformImageUri", id: "#add-urltransform", to: "urlTransform" },
  { from: "transformLinkUri", id: "#add-urltransform", to: "urlTransform" }
];
function jk(t) {
  const r = _k(t), a = Nk(t);
  return Tk(r.runSync(r.parse(a), a), t);
}
function _k(t) {
  const r = t.rehypePlugins || _y, a = t.remarkPlugins || _y, l = t.remarkRehypeOptions ? { ...t.remarkRehypeOptions, ...Ny } : Ny;
  return xk().use(ow).use(a).use(tk, l).use(r);
}
function Nk(t) {
  const r = t.children || "", a = new gx();
  return typeof r == "string" && (a.value = r), a;
}
function Tk(t, r) {
  const a = r.allowedElements, l = r.allowElement, s = r.components, c = r.disallowedElements, d = r.skipHtml, m = r.unwrapDisallowed, g = r.urlTransform || Ak;
  for (const v of Ek)
    Object.hasOwn(r, v.from) && ("" + v.from + (v.to ? "use `" + v.to + "` instead" : "remove it") + kk + v.id, void 0);
  return rp(t, p), $6(t, {
    Fragment: u.Fragment,
    components: s,
    ignoreInvalidStyle: !0,
    jsx: u.jsx,
    jsxs: u.jsxs,
    passKeys: !0,
    passNode: !0
  });
  function p(v, x, E) {
    if (v.type === "raw" && E && typeof x == "number")
      return d ? E.children.splice(x, 1) : E.children[x] = { type: "text", value: v.value }, x;
    if (v.type === "element") {
      let w;
      for (w in Th)
        if (Object.hasOwn(Th, w) && Object.hasOwn(v.properties, w)) {
          const _ = v.properties[w], A = Th[w];
          (A === null || A.includes(v.tagName)) && (v.properties[w] = g(String(_ || ""), w, v));
        }
    }
    if (v.type === "element") {
      let w = a ? !a.includes(v.tagName) : c ? c.includes(v.tagName) : !1;
      if (!w && l && typeof x == "number" && (w = !l(v, x, E)), w && E && typeof x == "number")
        return m && v.children ? E.children.splice(x, 1, ...v.children) : E.children.splice(x, 1), x;
    }
  }
}
function Ak(t) {
  const r = t.indexOf(":"), a = t.indexOf("?"), l = t.indexOf("#"), s = t.indexOf("/");
  return (
    // If there is no protocol, its relative.
    r === -1 || // If the first colon is after a `?`, `#`, or `/`, its not a protocol.
    s !== -1 && r > s || a !== -1 && r > a || l !== -1 && r > l || // It is a protocol, it should be allowed.
    Ck.test(t.slice(0, r)) ? t : ""
  );
}
function Ty(t, r) {
  const a = String(t);
  if (typeof r != "string")
    throw new TypeError("Expected character");
  let l = 0, s = a.indexOf(r);
  for (; s !== -1; )
    l++, s = a.indexOf(r, s + r.length);
  return l;
}
function Mk(t) {
  if (typeof t != "string")
    throw new TypeError("Expected a string");
  return t.replace(/[|\\{}()[\]^$+*?.]/g, "\\$&").replace(/-/g, "\\x2d");
}
function zk(t, r, a) {
  const s = gd((a || {}).ignore || []), c = Rk(r);
  let d = -1;
  for (; ++d < c.length; )
    px(t, "text", m);
  function m(p, v) {
    let x = -1, E;
    for (; ++x < v.length; ) {
      const w = v[x], _ = E ? E.children : void 0;
      if (s(
        w,
        _ ? _.indexOf(w) : void 0,
        E
      ))
        return;
      E = w;
    }
    if (E)
      return g(p, v);
  }
  function g(p, v) {
    const x = v[v.length - 1], E = c[d][0], w = c[d][1];
    let _ = 0;
    const D = x.children.indexOf(p);
    let R = !1, Z = [];
    E.lastIndex = 0;
    let K = E.exec(p.value);
    for (; K; ) {
      const ge = K.index, de = {
        index: K.index,
        input: K.input,
        stack: [...v, p]
      };
      let I = w(...K, de);
      if (typeof I == "string" && (I = I.length > 0 ? { type: "text", value: I } : void 0), I === !1 ? E.lastIndex = ge + 1 : (_ !== ge && Z.push({
        type: "text",
        value: p.value.slice(_, ge)
      }), Array.isArray(I) ? Z.push(...I) : I && Z.push(I), _ = ge + K[0].length, R = !0), !E.global)
        break;
      K = E.exec(p.value);
    }
    return R ? (_ < p.value.length && Z.push({ type: "text", value: p.value.slice(_) }), x.children.splice(D, 1, ...Z)) : Z = [p], D + Z.length;
  }
}
function Rk(t) {
  const r = [];
  if (!Array.isArray(t))
    throw new TypeError("Expected find and replace tuple or list of tuples");
  const a = !t[0] || Array.isArray(t[0]) ? t : [t];
  let l = -1;
  for (; ++l < a.length; ) {
    const s = a[l];
    r.push([Ok(s[0]), Dk(s[1])]);
  }
  return r;
}
function Ok(t) {
  return typeof t == "string" ? new RegExp(Mk(t), "g") : t;
}
function Dk(t) {
  return typeof t == "function" ? t : function() {
    return t;
  };
}
const Ph = "phrasing", qh = ["autolink", "link", "image", "label"];
function Lk() {
  return {
    transforms: [Fk],
    enter: {
      literalAutolink: Ik,
      literalAutolinkEmail: Hh,
      literalAutolinkHttp: Hh,
      literalAutolinkWww: Hh
    },
    exit: {
      literalAutolink: Hk,
      literalAutolinkEmail: qk,
      literalAutolinkHttp: Uk,
      literalAutolinkWww: Pk
    }
  };
}
function Bk() {
  return {
    unsafe: [
      {
        character: "@",
        before: "[+\\-.\\w]",
        after: "[\\-.\\w]",
        inConstruct: Ph,
        notInConstruct: qh
      },
      {
        character: ".",
        before: "[Ww]",
        after: "[\\-.\\w]",
        inConstruct: Ph,
        notInConstruct: qh
      },
      {
        character: ":",
        before: "[ps]",
        after: "\\/",
        inConstruct: Ph,
        notInConstruct: qh
      }
    ]
  };
}
function Ik(t) {
  this.enter({ type: "link", title: null, url: "", children: [] }, t);
}
function Hh(t) {
  this.config.enter.autolinkProtocol.call(this, t);
}
function Uk(t) {
  this.config.exit.autolinkProtocol.call(this, t);
}
function Pk(t) {
  this.config.exit.data.call(this, t);
  const r = this.stack[this.stack.length - 1];
  r.type, r.url = "http://" + this.sliceSerialize(t);
}
function qk(t) {
  this.config.exit.autolinkEmail.call(this, t);
}
function Hk(t) {
  this.exit(t);
}
function Fk(t) {
  zk(
    t,
    [
      [/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi, $k],
      [new RegExp("(?<=^|\\s|\\p{P}|\\p{S})([-.\\w+]+)@([-\\w]+(?:\\.[-\\w]+)+)", "gu"), Gk]
    ],
    { ignore: ["link", "linkReference"] }
  );
}
function $k(t, r, a, l, s) {
  let c = "";
  if (!yx(s) || (/^w/i.test(r) && (a = r + a, r = "", c = "http://"), !Vk(a)))
    return !1;
  const d = Kk(a + l);
  if (!d[0]) return !1;
  const m = {
    type: "link",
    title: null,
    url: c + r + d[0],
    children: [{ type: "text", value: r + d[0] }]
  };
  return d[1] ? [m, { type: "text", value: d[1] }] : m;
}
function Gk(t, r, a, l) {
  return (
    // Not an expected previous character.
    !yx(l, !0) || // Label ends in not allowed character.
    /[-\d_]$/.test(a) ? !1 : {
      type: "link",
      title: null,
      url: "mailto:" + r + "@" + a,
      children: [{ type: "text", value: r + "@" + a }]
    }
  );
}
function Vk(t) {
  const r = t.split(".");
  return !(r.length < 2 || r[r.length - 1] && (/_/.test(r[r.length - 1]) || !/[a-zA-Z\d]/.test(r[r.length - 1])) || r[r.length - 2] && (/_/.test(r[r.length - 2]) || !/[a-zA-Z\d]/.test(r[r.length - 2])));
}
function Kk(t) {
  const r = /[!"&'),.:;<>?\]}]+$/.exec(t);
  if (!r)
    return [t, void 0];
  t = t.slice(0, r.index);
  let a = r[0], l = a.indexOf(")");
  const s = Ty(t, "(");
  let c = Ty(t, ")");
  for (; l !== -1 && s > c; )
    t += a.slice(0, l + 1), a = a.slice(l + 1), l = a.indexOf(")"), c++;
  return [t, a];
}
function yx(t, r) {
  const a = t.input.charCodeAt(t.index - 1);
  return (t.index === 0 || jl(a) || hd(a)) && // If its an email, the previous character should not be a slash.
  (!r || a !== 47);
}
bx.peek = n7;
function Yk() {
  this.buffer();
}
function Qk(t) {
  this.enter({ type: "footnoteReference", identifier: "", label: "" }, t);
}
function Xk() {
  this.buffer();
}
function Wk(t) {
  this.enter(
    { type: "footnoteDefinition", identifier: "", label: "", children: [] },
    t
  );
}
function Zk(t) {
  const r = this.resume(), a = this.stack[this.stack.length - 1];
  a.type, a.identifier = Pr(
    this.sliceSerialize(t)
  ).toLowerCase(), a.label = r;
}
function Jk(t) {
  this.exit(t);
}
function e7(t) {
  const r = this.resume(), a = this.stack[this.stack.length - 1];
  a.type, a.identifier = Pr(
    this.sliceSerialize(t)
  ).toLowerCase(), a.label = r;
}
function t7(t) {
  this.exit(t);
}
function n7() {
  return "[";
}
function bx(t, r, a, l) {
  const s = a.createTracker(l);
  let c = s.move("[^");
  const d = a.enter("footnoteReference"), m = a.enter("reference");
  return c += s.move(
    a.safe(a.associationId(t), { after: "]", before: c })
  ), m(), d(), c += s.move("]"), c;
}
function r7() {
  return {
    enter: {
      gfmFootnoteCallString: Yk,
      gfmFootnoteCall: Qk,
      gfmFootnoteDefinitionLabelString: Xk,
      gfmFootnoteDefinition: Wk
    },
    exit: {
      gfmFootnoteCallString: Zk,
      gfmFootnoteCall: Jk,
      gfmFootnoteDefinitionLabelString: e7,
      gfmFootnoteDefinition: t7
    }
  };
}
function a7(t) {
  let r = !1;
  return t && t.firstLineBlank && (r = !0), {
    handlers: { footnoteDefinition: a, footnoteReference: bx },
    // This is on by default already.
    unsafe: [{ character: "[", inConstruct: ["label", "phrasing", "reference"] }]
  };
  function a(l, s, c, d) {
    const m = c.createTracker(d);
    let g = m.move("[^");
    const p = c.enter("footnoteDefinition"), v = c.enter("label");
    return g += m.move(
      c.safe(c.associationId(l), { before: g, after: "]" })
    ), v(), g += m.move("]:"), l.children && l.children.length > 0 && (m.shift(4), g += m.move(
      (r ? `
` : " ") + c.indentLines(
        c.containerFlow(l, m.current()),
        r ? xx : i7
      )
    )), p(), g;
  }
}
function i7(t, r, a) {
  return r === 0 ? t : xx(t, r, a);
}
function xx(t, r, a) {
  return (a ? "" : "    ") + t;
}
const l7 = [
  "autolink",
  "destinationLiteral",
  "destinationRaw",
  "reference",
  "titleQuote",
  "titleApostrophe"
];
vx.peek = d7;
function o7() {
  return {
    canContainEols: ["delete"],
    enter: { strikethrough: u7 },
    exit: { strikethrough: c7 }
  };
}
function s7() {
  return {
    unsafe: [
      {
        character: "~",
        inConstruct: "phrasing",
        notInConstruct: l7
      }
    ],
    handlers: { delete: vx }
  };
}
function u7(t) {
  this.enter({ type: "delete", children: [] }, t);
}
function c7(t) {
  this.exit(t);
}
function vx(t, r, a, l) {
  const s = a.createTracker(l), c = a.enter("strikethrough");
  let d = s.move("~~");
  return d += a.containerPhrasing(t, {
    ...s.current(),
    before: d,
    after: "~"
  }), d += s.move("~~"), c(), d;
}
function d7() {
  return "~";
}
function f7(t) {
  return t.length;
}
function h7(t, r) {
  const a = r || {}, l = (a.align || []).concat(), s = a.stringLength || f7, c = [], d = [], m = [], g = [];
  let p = 0, v = -1;
  for (; ++v < t.length; ) {
    const A = [], D = [];
    let R = -1;
    for (t[v].length > p && (p = t[v].length); ++R < t[v].length; ) {
      const Z = m7(t[v][R]);
      if (a.alignDelimiters !== !1) {
        const K = s(Z);
        D[R] = K, (g[R] === void 0 || K > g[R]) && (g[R] = K);
      }
      A.push(Z);
    }
    d[v] = A, m[v] = D;
  }
  let x = -1;
  if (typeof l == "object" && "length" in l)
    for (; ++x < p; )
      c[x] = Ay(l[x]);
  else {
    const A = Ay(l);
    for (; ++x < p; )
      c[x] = A;
  }
  x = -1;
  const E = [], w = [];
  for (; ++x < p; ) {
    const A = c[x];
    let D = "", R = "";
    A === 99 ? (D = ":", R = ":") : A === 108 ? D = ":" : A === 114 && (R = ":");
    let Z = a.alignDelimiters === !1 ? 1 : Math.max(
      1,
      g[x] - D.length - R.length
    );
    const K = D + "-".repeat(Z) + R;
    a.alignDelimiters !== !1 && (Z = D.length + Z + R.length, Z > g[x] && (g[x] = Z), w[x] = Z), E[x] = K;
  }
  d.splice(1, 0, E), m.splice(1, 0, w), v = -1;
  const _ = [];
  for (; ++v < d.length; ) {
    const A = d[v], D = m[v];
    x = -1;
    const R = [];
    for (; ++x < p; ) {
      const Z = A[x] || "";
      let K = "", ge = "";
      if (a.alignDelimiters !== !1) {
        const de = g[x] - (D[x] || 0), I = c[x];
        I === 114 ? K = " ".repeat(de) : I === 99 ? de % 2 ? (K = " ".repeat(de / 2 + 0.5), ge = " ".repeat(de / 2 - 0.5)) : (K = " ".repeat(de / 2), ge = K) : ge = " ".repeat(de);
      }
      a.delimiterStart !== !1 && !x && R.push("|"), a.padding !== !1 && // Dont add the opening space if were not aligning and the cell is
      // empty: there will be a closing space.
      !(a.alignDelimiters === !1 && Z === "") && (a.delimiterStart !== !1 || x) && R.push(" "), a.alignDelimiters !== !1 && R.push(K), R.push(Z), a.alignDelimiters !== !1 && R.push(ge), a.padding !== !1 && R.push(" "), (a.delimiterEnd !== !1 || x !== p - 1) && R.push("|");
    }
    _.push(
      a.delimiterEnd === !1 ? R.join("").replace(/ +$/, "") : R.join("")
    );
  }
  return _.join(`
`);
}
function m7(t) {
  return t == null ? "" : String(t);
}
function Ay(t) {
  const r = typeof t == "string" ? t.codePointAt(0) : 0;
  return r === 67 || r === 99 ? 99 : r === 76 || r === 108 ? 108 : r === 82 || r === 114 ? 114 : 0;
}
function p7(t, r, a, l) {
  const s = a.enter("blockquote"), c = a.createTracker(l);
  c.move("> "), c.shift(2);
  const d = a.indentLines(
    a.containerFlow(t, c.current()),
    g7
  );
  return s(), d;
}
function g7(t, r, a) {
  return ">" + (a ? "" : " ") + t;
}
function y7(t, r) {
  return My(t, r.inConstruct, !0) && !My(t, r.notInConstruct, !1);
}
function My(t, r, a) {
  if (typeof r == "string" && (r = [r]), !r || r.length === 0)
    return a;
  let l = -1;
  for (; ++l < r.length; )
    if (t.includes(r[l]))
      return !0;
  return !1;
}
function zy(t, r, a, l) {
  let s = -1;
  for (; ++s < a.unsafe.length; )
    if (a.unsafe[s].character === `
` && y7(a.stack, a.unsafe[s]))
      return /[ \t]/.test(l.before) ? "" : " ";
  return `\\
`;
}
function b7(t, r) {
  const a = String(t);
  let l = a.indexOf(r), s = l, c = 0, d = 0;
  if (typeof r != "string")
    throw new TypeError("Expected substring");
  for (; l !== -1; )
    l === s ? ++c > d && (d = c) : c = 1, s = l + r.length, l = a.indexOf(r, s);
  return d;
}
function x7(t, r) {
  return !!(r.options.fences === !1 && t.value && // If theres no info
  !t.lang && // And theres a non-whitespace character
  /[^ \r\n]/.test(t.value) && // And the value doesnt start or end in a blank
  !/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(t.value));
}
function v7(t) {
  const r = t.options.fence || "`";
  if (r !== "`" && r !== "~")
    throw new Error(
      "Cannot serialize code with `" + r + "` for `options.fence`, expected `` ` `` or `~`"
    );
  return r;
}
function S7(t, r, a, l) {
  const s = v7(a), c = t.value || "", d = s === "`" ? "GraveAccent" : "Tilde";
  if (x7(t, a)) {
    const x = a.enter("codeIndented"), E = a.indentLines(c, w7);
    return x(), E;
  }
  const m = a.createTracker(l), g = s.repeat(Math.max(b7(c, s) + 1, 3)), p = a.enter("codeFenced");
  let v = m.move(g);
  if (t.lang) {
    const x = a.enter(`codeFencedLang${d}`);
    v += m.move(
      a.safe(t.lang, {
        before: v,
        after: " ",
        encode: ["`"],
        ...m.current()
      })
    ), x();
  }
  if (t.lang && t.meta) {
    const x = a.enter(`codeFencedMeta${d}`);
    v += m.move(" "), v += m.move(
      a.safe(t.meta, {
        before: v,
        after: `
`,
        encode: ["`"],
        ...m.current()
      })
    ), x();
  }
  return v += m.move(`
`), c && (v += m.move(c + `
`)), v += m.move(g), p(), v;
}
function w7(t, r, a) {
  return (a ? "" : "    ") + t;
}
function ip(t) {
  const r = t.options.quote || '"';
  if (r !== '"' && r !== "'")
    throw new Error(
      "Cannot serialize title with `" + r + "` for `options.quote`, expected `\"`, or `'`"
    );
  return r;
}
function k7(t, r, a, l) {
  const s = ip(a), c = s === '"' ? "Quote" : "Apostrophe", d = a.enter("definition");
  let m = a.enter("label");
  const g = a.createTracker(l);
  let p = g.move("[");
  return p += g.move(
    a.safe(a.associationId(t), {
      before: p,
      after: "]",
      ...g.current()
    })
  ), p += g.move("]: "), m(), // If theres no url, or
  !t.url || // If there are control characters or whitespace.
  /[\0- \u007F]/.test(t.url) ? (m = a.enter("destinationLiteral"), p += g.move("<"), p += g.move(
    a.safe(t.url, { before: p, after: ">", ...g.current() })
  ), p += g.move(">")) : (m = a.enter("destinationRaw"), p += g.move(
    a.safe(t.url, {
      before: p,
      after: t.title ? " " : `
`,
      ...g.current()
    })
  )), m(), t.title && (m = a.enter(`title${c}`), p += g.move(" " + s), p += g.move(
    a.safe(t.title, {
      before: p,
      after: s,
      ...g.current()
    })
  ), p += g.move(s), m()), d(), p;
}
function C7(t) {
  const r = t.options.emphasis || "*";
  if (r !== "*" && r !== "_")
    throw new Error(
      "Cannot serialize emphasis with `" + r + "` for `options.emphasis`, expected `*`, or `_`"
    );
  return r;
}
function cu(t) {
  return "&#x" + t.toString(16).toUpperCase() + ";";
}
function rd(t, r, a) {
  const l = Bo(t), s = Bo(r);
  return l === void 0 ? s === void 0 ? (
    // Letter inside:
    // we have to encode *both* letters for `_` as it is looser.
    // it already forms for `*` (and GFMs `~`).
    a === "_" ? { inside: !0, outside: !0 } : { inside: !1, outside: !1 }
  ) : s === 1 ? (
    // Whitespace inside: encode both (letter, whitespace).
    { inside: !0, outside: !0 }
  ) : (
    // Punctuation inside: encode outer (letter)
    { inside: !1, outside: !0 }
  ) : l === 1 ? s === void 0 ? (
    // Letter inside: already forms.
    { inside: !1, outside: !1 }
  ) : s === 1 ? (
    // Whitespace inside: encode both (whitespace).
    { inside: !0, outside: !0 }
  ) : (
    // Punctuation inside: already forms.
    { inside: !1, outside: !1 }
  ) : s === void 0 ? (
    // Letter inside: already forms.
    { inside: !1, outside: !1 }
  ) : s === 1 ? (
    // Whitespace inside: encode inner (whitespace).
    { inside: !0, outside: !1 }
  ) : (
    // Punctuation inside: already forms.
    { inside: !1, outside: !1 }
  );
}
Sx.peek = E7;
function Sx(t, r, a, l) {
  const s = C7(a), c = a.enter("emphasis"), d = a.createTracker(l), m = d.move(s);
  let g = d.move(
    a.containerPhrasing(t, {
      after: s,
      before: m,
      ...d.current()
    })
  );
  const p = g.charCodeAt(0), v = rd(
    l.before.charCodeAt(l.before.length - 1),
    p,
    s
  );
  v.inside && (g = cu(p) + g.slice(1));
  const x = g.charCodeAt(g.length - 1), E = rd(l.after.charCodeAt(0), x, s);
  E.inside && (g = g.slice(0, -1) + cu(x));
  const w = d.move(s);
  return c(), a.attentionEncodeSurroundingInfo = {
    after: E.outside,
    before: v.outside
  }, m + g + w;
}
function E7(t, r, a) {
  return a.options.emphasis || "*";
}
function j7(t, r) {
  let a = !1;
  return rp(t, function(l) {
    if ("value" in l && /\r?\n|\r/.test(l.value) || l.type === "break")
      return a = !0, mm;
  }), !!((!t.depth || t.depth < 3) && Xm(t) && (r.options.setext || a));
}
function _7(t, r, a, l) {
  const s = Math.max(Math.min(6, t.depth || 1), 1), c = a.createTracker(l);
  if (j7(t, a)) {
    const v = a.enter("headingSetext"), x = a.enter("phrasing"), E = a.containerPhrasing(t, {
      ...c.current(),
      before: `
`,
      after: `
`
    });
    return x(), v(), E + `
` + (s === 1 ? "=" : "-").repeat(
      // The whole size
      E.length - // Minus the position of the character after the last EOL (or
      // 0 if there is none)
      (Math.max(E.lastIndexOf("\r"), E.lastIndexOf(`
`)) + 1)
    );
  }
  const d = "#".repeat(s), m = a.enter("headingAtx"), g = a.enter("phrasing");
  c.move(d + " ");
  let p = a.containerPhrasing(t, {
    before: "# ",
    after: `
`,
    ...c.current()
  });
  return /^[\t ]/.test(p) && (p = cu(p.charCodeAt(0)) + p.slice(1)), p = p ? d + " " + p : d, a.options.closeAtx && (p += " " + d), g(), m(), p;
}
wx.peek = N7;
function wx(t) {
  return t.value || "";
}
function N7() {
  return "<";
}
kx.peek = T7;
function kx(t, r, a, l) {
  const s = ip(a), c = s === '"' ? "Quote" : "Apostrophe", d = a.enter("image");
  let m = a.enter("label");
  const g = a.createTracker(l);
  let p = g.move("![");
  return p += g.move(
    a.safe(t.alt, { before: p, after: "]", ...g.current() })
  ), p += g.move("]("), m(), // If theres no url but there is a title
  !t.url && t.title || // If there are control characters or whitespace.
  /[\0- \u007F]/.test(t.url) ? (m = a.enter("destinationLiteral"), p += g.move("<"), p += g.move(
    a.safe(t.url, { before: p, after: ">", ...g.current() })
  ), p += g.move(">")) : (m = a.enter("destinationRaw"), p += g.move(
    a.safe(t.url, {
      before: p,
      after: t.title ? " " : ")",
      ...g.current()
    })
  )), m(), t.title && (m = a.enter(`title${c}`), p += g.move(" " + s), p += g.move(
    a.safe(t.title, {
      before: p,
      after: s,
      ...g.current()
    })
  ), p += g.move(s), m()), p += g.move(")"), d(), p;
}
function T7() {
  return "!";
}
Cx.peek = A7;
function Cx(t, r, a, l) {
  const s = t.referenceType, c = a.enter("imageReference");
  let d = a.enter("label");
  const m = a.createTracker(l);
  let g = m.move("![");
  const p = a.safe(t.alt, {
    before: g,
    after: "]",
    ...m.current()
  });
  g += m.move(p + "]["), d();
  const v = a.stack;
  a.stack = [], d = a.enter("reference");
  const x = a.safe(a.associationId(t), {
    before: g,
    after: "]",
    ...m.current()
  });
  return d(), a.stack = v, c(), s === "full" || !p || p !== x ? g += m.move(x + "]") : s === "shortcut" ? g = g.slice(0, -1) : g += m.move("]"), g;
}
function A7() {
  return "!";
}
Ex.peek = M7;
function Ex(t, r, a) {
  let l = t.value || "", s = "`", c = -1;
  for (; new RegExp("(^|[^`])" + s + "([^`]|$)").test(l); )
    s += "`";
  for (/[^ \r\n]/.test(l) && (/^[ \r\n]/.test(l) && /[ \r\n]$/.test(l) || /^`|`$/.test(l)) && (l = " " + l + " "); ++c < a.unsafe.length; ) {
    const d = a.unsafe[c], m = a.compilePattern(d);
    let g;
    if (d.atBreak)
      for (; g = m.exec(l); ) {
        let p = g.index;
        l.charCodeAt(p) === 10 && l.charCodeAt(p - 1) === 13 && p--, l = l.slice(0, p) + " " + l.slice(g.index + 1);
      }
  }
  return s + l + s;
}
function M7() {
  return "`";
}
function jx(t, r) {
  const a = Xm(t);
  return !!(!r.options.resourceLink && // If theres a url
  t.url && // And theres a no title
  !t.title && // And the content of `node` is a single text node
  t.children && t.children.length === 1 && t.children[0].type === "text" && // And if the url is the same as the content
  (a === t.url || "mailto:" + a === t.url) && // And that starts w/ a protocol
  /^[a-z][a-z+.-]+:/i.test(t.url) && // And that doesnt contain ASCII control codes (character escapes and
  // references dont work), space, or angle brackets
  !/[\0- <>\u007F]/.test(t.url));
}
_x.peek = z7;
function _x(t, r, a, l) {
  const s = ip(a), c = s === '"' ? "Quote" : "Apostrophe", d = a.createTracker(l);
  let m, g;
  if (jx(t, a)) {
    const v = a.stack;
    a.stack = [], m = a.enter("autolink");
    let x = d.move("<");
    return x += d.move(
      a.containerPhrasing(t, {
        before: x,
        after: ">",
        ...d.current()
      })
    ), x += d.move(">"), m(), a.stack = v, x;
  }
  m = a.enter("link"), g = a.enter("label");
  let p = d.move("[");
  return p += d.move(
    a.containerPhrasing(t, {
      before: p,
      after: "](",
      ...d.current()
    })
  ), p += d.move("]("), g(), // If theres no url but there is a title
  !t.url && t.title || // If there are control characters or whitespace.
  /[\0- \u007F]/.test(t.url) ? (g = a.enter("destinationLiteral"), p += d.move("<"), p += d.move(
    a.safe(t.url, { before: p, after: ">", ...d.current() })
  ), p += d.move(">")) : (g = a.enter("destinationRaw"), p += d.move(
    a.safe(t.url, {
      before: p,
      after: t.title ? " " : ")",
      ...d.current()
    })
  )), g(), t.title && (g = a.enter(`title${c}`), p += d.move(" " + s), p += d.move(
    a.safe(t.title, {
      before: p,
      after: s,
      ...d.current()
    })
  ), p += d.move(s), g()), p += d.move(")"), m(), p;
}
function z7(t, r, a) {
  return jx(t, a) ? "<" : "[";
}
Nx.peek = R7;
function Nx(t, r, a, l) {
  const s = t.referenceType, c = a.enter("linkReference");
  let d = a.enter("label");
  const m = a.createTracker(l);
  let g = m.move("[");
  const p = a.containerPhrasing(t, {
    before: g,
    after: "]",
    ...m.current()
  });
  g += m.move(p + "]["), d();
  const v = a.stack;
  a.stack = [], d = a.enter("reference");
  const x = a.safe(a.associationId(t), {
    before: g,
    after: "]",
    ...m.current()
  });
  return d(), a.stack = v, c(), s === "full" || !p || p !== x ? g += m.move(x + "]") : s === "shortcut" ? g = g.slice(0, -1) : g += m.move("]"), g;
}
function R7() {
  return "[";
}
function lp(t) {
  const r = t.options.bullet || "*";
  if (r !== "*" && r !== "+" && r !== "-")
    throw new Error(
      "Cannot serialize items with `" + r + "` for `options.bullet`, expected `*`, `+`, or `-`"
    );
  return r;
}
function O7(t) {
  const r = lp(t), a = t.options.bulletOther;
  if (!a)
    return r === "*" ? "-" : "*";
  if (a !== "*" && a !== "+" && a !== "-")
    throw new Error(
      "Cannot serialize items with `" + a + "` for `options.bulletOther`, expected `*`, `+`, or `-`"
    );
  if (a === r)
    throw new Error(
      "Expected `bullet` (`" + r + "`) and `bulletOther` (`" + a + "`) to be different"
    );
  return a;
}
function D7(t) {
  const r = t.options.bulletOrdered || ".";
  if (r !== "." && r !== ")")
    throw new Error(
      "Cannot serialize items with `" + r + "` for `options.bulletOrdered`, expected `.` or `)`"
    );
  return r;
}
function Tx(t) {
  const r = t.options.rule || "*";
  if (r !== "*" && r !== "-" && r !== "_")
    throw new Error(
      "Cannot serialize rules with `" + r + "` for `options.rule`, expected `*`, `-`, or `_`"
    );
  return r;
}
function L7(t, r, a, l) {
  const s = a.enter("list"), c = a.bulletCurrent;
  let d = t.ordered ? D7(a) : lp(a);
  const m = t.ordered ? d === "." ? ")" : "." : O7(a);
  let g = r && a.bulletLastUsed ? d === a.bulletLastUsed : !1;
  if (!t.ordered) {
    const v = t.children ? t.children[0] : void 0;
    if (
      // Bullet could be used as a thematic break marker:
      (d === "*" || d === "-") && // Empty first list item:
      v && (!v.children || !v.children[0]) && // Directly in two other list items:
      a.stack[a.stack.length - 1] === "list" && a.stack[a.stack.length - 2] === "listItem" && a.stack[a.stack.length - 3] === "list" && a.stack[a.stack.length - 4] === "listItem" && // That are each the first child.
      a.indexStack[a.indexStack.length - 1] === 0 && a.indexStack[a.indexStack.length - 2] === 0 && a.indexStack[a.indexStack.length - 3] === 0 && (g = !0), Tx(a) === d && v
    ) {
      let x = -1;
      for (; ++x < t.children.length; ) {
        const E = t.children[x];
        if (E && E.type === "listItem" && E.children && E.children[0] && E.children[0].type === "thematicBreak") {
          g = !0;
          break;
        }
      }
    }
  }
  g && (d = m), a.bulletCurrent = d;
  const p = a.containerFlow(t, l);
  return a.bulletLastUsed = d, a.bulletCurrent = c, s(), p;
}
function B7(t) {
  const r = t.options.listItemIndent || "one";
  if (r !== "tab" && r !== "one" && r !== "mixed")
    throw new Error(
      "Cannot serialize items with `" + r + "` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`"
    );
  return r;
}
function I7(t, r, a, l) {
  const s = B7(a);
  let c = a.bulletCurrent || lp(a);
  r && r.type === "list" && r.ordered && (c = (typeof r.start == "number" && r.start > -1 ? r.start : 1) + (a.options.incrementListMarker === !1 ? 0 : r.children.indexOf(t)) + c);
  let d = c.length + 1;
  (s === "tab" || s === "mixed" && (r && r.type === "list" && r.spread || t.spread)) && (d = Math.ceil(d / 4) * 4);
  const m = a.createTracker(l);
  m.move(c + " ".repeat(d - c.length)), m.shift(d);
  const g = a.enter("listItem"), p = a.indentLines(
    a.containerFlow(t, m.current()),
    v
  );
  return g(), p;
  function v(x, E, w) {
    return E ? (w ? "" : " ".repeat(d)) + x : (w ? c : c + " ".repeat(d - c.length)) + x;
  }
}
function U7(t, r, a, l) {
  const s = a.enter("paragraph"), c = a.enter("phrasing"), d = a.containerPhrasing(t, l);
  return c(), s(), d;
}
const P7 = (
  /** @type {(node?: unknown) => node is Exclude<PhrasingContent, Html>} */
  gd([
    "break",
    "delete",
    "emphasis",
    // To do: next major: removed since footnotes were added to GFM.
    "footnote",
    "footnoteReference",
    "image",
    "imageReference",
    "inlineCode",
    // Enabled by `mdast-util-math`:
    "inlineMath",
    "link",
    "linkReference",
    // Enabled by `mdast-util-mdx`:
    "mdxJsxTextElement",
    // Enabled by `mdast-util-mdx`:
    "mdxTextExpression",
    "strong",
    "text",
    // Enabled by `mdast-util-directive`:
    "textDirective"
  ])
);
function q7(t, r, a, l) {
  return (t.children.some(function(d) {
    return P7(d);
  }) ? a.containerPhrasing : a.containerFlow).call(a, t, l);
}
function H7(t) {
  const r = t.options.strong || "*";
  if (r !== "*" && r !== "_")
    throw new Error(
      "Cannot serialize strong with `" + r + "` for `options.strong`, expected `*`, or `_`"
    );
  return r;
}
Ax.peek = F7;
function Ax(t, r, a, l) {
  const s = H7(a), c = a.enter("strong"), d = a.createTracker(l), m = d.move(s + s);
  let g = d.move(
    a.containerPhrasing(t, {
      after: s,
      before: m,
      ...d.current()
    })
  );
  const p = g.charCodeAt(0), v = rd(
    l.before.charCodeAt(l.before.length - 1),
    p,
    s
  );
  v.inside && (g = cu(p) + g.slice(1));
  const x = g.charCodeAt(g.length - 1), E = rd(l.after.charCodeAt(0), x, s);
  E.inside && (g = g.slice(0, -1) + cu(x));
  const w = d.move(s + s);
  return c(), a.attentionEncodeSurroundingInfo = {
    after: E.outside,
    before: v.outside
  }, m + g + w;
}
function F7(t, r, a) {
  return a.options.strong || "*";
}
function $7(t, r, a, l) {
  return a.safe(t.value, l);
}
function G7(t) {
  const r = t.options.ruleRepetition || 3;
  if (r < 3)
    throw new Error(
      "Cannot serialize rules with repetition `" + r + "` for `options.ruleRepetition`, expected `3` or more"
    );
  return r;
}
function V7(t, r, a) {
  const l = (Tx(a) + (a.options.ruleSpaces ? " " : "")).repeat(G7(a));
  return a.options.ruleSpaces ? l.slice(0, -1) : l;
}
const Mx = {
  blockquote: p7,
  break: zy,
  code: S7,
  definition: k7,
  emphasis: Sx,
  hardBreak: zy,
  heading: _7,
  html: wx,
  image: kx,
  imageReference: Cx,
  inlineCode: Ex,
  link: _x,
  linkReference: Nx,
  list: L7,
  listItem: I7,
  paragraph: U7,
  root: q7,
  strong: Ax,
  text: $7,
  thematicBreak: V7
};
function K7() {
  return {
    enter: {
      table: Y7,
      tableData: Ry,
      tableHeader: Ry,
      tableRow: X7
    },
    exit: {
      codeText: W7,
      table: Q7,
      tableData: Fh,
      tableHeader: Fh,
      tableRow: Fh
    }
  };
}
function Y7(t) {
  const r = t._align;
  this.enter(
    {
      type: "table",
      align: r.map(function(a) {
        return a === "none" ? null : a;
      }),
      children: []
    },
    t
  ), this.data.inTable = !0;
}
function Q7(t) {
  this.exit(t), this.data.inTable = void 0;
}
function X7(t) {
  this.enter({ type: "tableRow", children: [] }, t);
}
function Fh(t) {
  this.exit(t);
}
function Ry(t) {
  this.enter({ type: "tableCell", children: [] }, t);
}
function W7(t) {
  let r = this.resume();
  this.data.inTable && (r = r.replace(/\\([\\|])/g, Z7));
  const a = this.stack[this.stack.length - 1];
  a.type, a.value = r, this.exit(t);
}
function Z7(t, r) {
  return r === "|" ? r : t;
}
function J7(t) {
  const r = t || {}, a = r.tableCellPadding, l = r.tablePipeAlign, s = r.stringLength, c = a ? " " : "|";
  return {
    unsafe: [
      { character: "\r", inConstruct: "tableCell" },
      { character: `
`, inConstruct: "tableCell" },
      // A pipe, when followed by a tab or space (padding), or a dash or colon
      // (unpadded delimiter row), could result in a table.
      { atBreak: !0, character: "|", after: "[	 :-]" },
      // A pipe in a cell must be encoded.
      { character: "|", inConstruct: "tableCell" },
      // A colon must be followed by a dash, in which case it could start a
      // delimiter row.
      { atBreak: !0, character: ":", after: "-" },
      // A delimiter row can also start with a dash, when followed by more
      // dashes, a colon, or a pipe.
      // This is a stricter version than the built in check for lists, thematic
      // breaks, and setex heading underlines though:
      // <https://github.com/syntax-tree/mdast-util-to-markdown/blob/51a2038/lib/unsafe.js#L57>
      { atBreak: !0, character: "-", after: "[:|-]" }
    ],
    handlers: {
      inlineCode: E,
      table: d,
      tableCell: g,
      tableRow: m
    }
  };
  function d(w, _, A, D) {
    return p(v(w, A, D), w.align);
  }
  function m(w, _, A, D) {
    const R = x(w, A, D), Z = p([R]);
    return Z.slice(0, Z.indexOf(`
`));
  }
  function g(w, _, A, D) {
    const R = A.enter("tableCell"), Z = A.enter("phrasing"), K = A.containerPhrasing(w, {
      ...D,
      before: c,
      after: c
    });
    return Z(), R(), K;
  }
  function p(w, _) {
    return h7(w, {
      align: _,
      // @ts-expect-error: `markdown-table` types should support `null`.
      alignDelimiters: l,
      // @ts-expect-error: `markdown-table` types should support `null`.
      padding: a,
      // @ts-expect-error: `markdown-table` types should support `null`.
      stringLength: s
    });
  }
  function v(w, _, A) {
    const D = w.children;
    let R = -1;
    const Z = [], K = _.enter("table");
    for (; ++R < D.length; )
      Z[R] = x(D[R], _, A);
    return K(), Z;
  }
  function x(w, _, A) {
    const D = w.children;
    let R = -1;
    const Z = [], K = _.enter("tableRow");
    for (; ++R < D.length; )
      Z[R] = g(D[R], w, _, A);
    return K(), Z;
  }
  function E(w, _, A) {
    let D = Mx.inlineCode(w, _, A);
    return A.stack.includes("tableCell") && (D = D.replace(/\|/g, "\\$&")), D;
  }
}
function e9() {
  return {
    exit: {
      taskListCheckValueChecked: Oy,
      taskListCheckValueUnchecked: Oy,
      paragraph: n9
    }
  };
}
function t9() {
  return {
    unsafe: [{ atBreak: !0, character: "-", after: "[:|-]" }],
    handlers: { listItem: r9 }
  };
}
function Oy(t) {
  const r = this.stack[this.stack.length - 2];
  r.type, r.checked = t.type === "taskListCheckValueChecked";
}
function n9(t) {
  const r = this.stack[this.stack.length - 2];
  if (r && r.type === "listItem" && typeof r.checked == "boolean") {
    const a = this.stack[this.stack.length - 1];
    a.type;
    const l = a.children[0];
    if (l && l.type === "text") {
      const s = r.children;
      let c = -1, d;
      for (; ++c < s.length; ) {
        const m = s[c];
        if (m.type === "paragraph") {
          d = m;
          break;
        }
      }
      d === a && (l.value = l.value.slice(1), l.value.length === 0 ? a.children.shift() : a.position && l.position && typeof l.position.start.offset == "number" && (l.position.start.column++, l.position.start.offset++, a.position.start = Object.assign({}, l.position.start)));
    }
  }
  this.exit(t);
}
function r9(t, r, a, l) {
  const s = t.children[0], c = typeof t.checked == "boolean" && s && s.type === "paragraph", d = "[" + (t.checked ? "x" : " ") + "] ", m = a.createTracker(l);
  c && m.move(d);
  let g = Mx.listItem(t, r, a, {
    ...l,
    ...m.current()
  });
  return c && (g = g.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/, p)), g;
  function p(v) {
    return v + d;
  }
}
function a9() {
  return [
    Lk(),
    r7(),
    o7(),
    K7(),
    e9()
  ];
}
function i9(t) {
  return {
    extensions: [
      Bk(),
      a7(t),
      s7(),
      J7(t),
      t9()
    ]
  };
}
const l9 = {
  tokenize: f9,
  partial: !0
}, zx = {
  tokenize: h9,
  partial: !0
}, Rx = {
  tokenize: m9,
  partial: !0
}, Ox = {
  tokenize: p9,
  partial: !0
}, o9 = {
  tokenize: g9,
  partial: !0
}, Dx = {
  name: "wwwAutolink",
  tokenize: c9,
  previous: Bx
}, Lx = {
  name: "protocolAutolink",
  tokenize: d9,
  previous: Ix
}, $a = {
  name: "emailAutolink",
  tokenize: u9,
  previous: Ux
}, fa = {};
function s9() {
  return {
    text: fa
  };
}
let yl = 48;
for (; yl < 123; )
  fa[yl] = $a, yl++, yl === 58 ? yl = 65 : yl === 91 && (yl = 97);
fa[43] = $a;
fa[45] = $a;
fa[46] = $a;
fa[95] = $a;
fa[72] = [$a, Lx];
fa[104] = [$a, Lx];
fa[87] = [$a, Dx];
fa[119] = [$a, Dx];
function u9(t, r, a) {
  const l = this;
  let s, c;
  return d;
  function d(x) {
    return !bm(x) || !Ux.call(l, l.previous) || op(l.events) ? a(x) : (t.enter("literalAutolink"), t.enter("literalAutolinkEmail"), m(x));
  }
  function m(x) {
    return bm(x) ? (t.consume(x), m) : x === 64 ? (t.consume(x), g) : a(x);
  }
  function g(x) {
    return x === 46 ? t.check(o9, v, p)(x) : x === 45 || x === 95 || Ln(x) ? (c = !0, t.consume(x), g) : v(x);
  }
  function p(x) {
    return t.consume(x), s = !0, g;
  }
  function v(x) {
    return c && s && Hn(l.previous) ? (t.exit("literalAutolinkEmail"), t.exit("literalAutolink"), r(x)) : a(x);
  }
}
function c9(t, r, a) {
  const l = this;
  return s;
  function s(d) {
    return d !== 87 && d !== 119 || !Bx.call(l, l.previous) || op(l.events) ? a(d) : (t.enter("literalAutolink"), t.enter("literalAutolinkWww"), t.check(l9, t.attempt(zx, t.attempt(Rx, c), a), a)(d));
  }
  function c(d) {
    return t.exit("literalAutolinkWww"), t.exit("literalAutolink"), r(d);
  }
}
function d9(t, r, a) {
  const l = this;
  let s = "", c = !1;
  return d;
  function d(x) {
    return (x === 72 || x === 104) && Ix.call(l, l.previous) && !op(l.events) ? (t.enter("literalAutolink"), t.enter("literalAutolinkHttp"), s += String.fromCodePoint(x), t.consume(x), m) : a(x);
  }
  function m(x) {
    if (Hn(x) && s.length < 5)
      return s += String.fromCodePoint(x), t.consume(x), m;
    if (x === 58) {
      const E = s.toLowerCase();
      if (E === "http" || E === "https")
        return t.consume(x), g;
    }
    return a(x);
  }
  function g(x) {
    return x === 47 ? (t.consume(x), c ? p : (c = !0, g)) : a(x);
  }
  function p(x) {
    return x === null || ed(x) || Lt(x) || jl(x) || hd(x) ? a(x) : t.attempt(zx, t.attempt(Rx, v), a)(x);
  }
  function v(x) {
    return t.exit("literalAutolinkHttp"), t.exit("literalAutolink"), r(x);
  }
}
function f9(t, r, a) {
  let l = 0;
  return s;
  function s(d) {
    return (d === 87 || d === 119) && l < 3 ? (l++, t.consume(d), s) : d === 46 && l === 3 ? (t.consume(d), c) : a(d);
  }
  function c(d) {
    return d === null ? a(d) : r(d);
  }
}
function h9(t, r, a) {
  let l, s, c;
  return d;
  function d(p) {
    return p === 46 || p === 95 ? t.check(Ox, g, m)(p) : p === null || Lt(p) || jl(p) || p !== 45 && hd(p) ? g(p) : (c = !0, t.consume(p), d);
  }
  function m(p) {
    return p === 95 ? l = !0 : (s = l, l = void 0), t.consume(p), d;
  }
  function g(p) {
    return s || l || !c ? a(p) : r(p);
  }
}
function m9(t, r) {
  let a = 0, l = 0;
  return s;
  function s(d) {
    return d === 40 ? (a++, t.consume(d), s) : d === 41 && l < a ? c(d) : d === 33 || d === 34 || d === 38 || d === 39 || d === 41 || d === 42 || d === 44 || d === 46 || d === 58 || d === 59 || d === 60 || d === 63 || d === 93 || d === 95 || d === 126 ? t.check(Ox, r, c)(d) : d === null || Lt(d) || jl(d) ? r(d) : (t.consume(d), s);
  }
  function c(d) {
    return d === 41 && l++, t.consume(d), s;
  }
}
function p9(t, r, a) {
  return l;
  function l(m) {
    return m === 33 || m === 34 || m === 39 || m === 41 || m === 42 || m === 44 || m === 46 || m === 58 || m === 59 || m === 63 || m === 95 || m === 126 ? (t.consume(m), l) : m === 38 ? (t.consume(m), c) : m === 93 ? (t.consume(m), s) : (
      // `<` is an end.
      m === 60 || // So is whitespace.
      m === null || Lt(m) || jl(m) ? r(m) : a(m)
    );
  }
  function s(m) {
    return m === null || m === 40 || m === 91 || Lt(m) || jl(m) ? r(m) : l(m);
  }
  function c(m) {
    return Hn(m) ? d(m) : a(m);
  }
  function d(m) {
    return m === 59 ? (t.consume(m), l) : Hn(m) ? (t.consume(m), d) : a(m);
  }
}
function g9(t, r, a) {
  return l;
  function l(c) {
    return t.consume(c), s;
  }
  function s(c) {
    return Ln(c) ? a(c) : r(c);
  }
}
function Bx(t) {
  return t === null || t === 40 || t === 42 || t === 95 || t === 91 || t === 93 || t === 126 || Lt(t);
}
function Ix(t) {
  return !Hn(t);
}
function Ux(t) {
  return !(t === 47 || bm(t));
}
function bm(t) {
  return t === 43 || t === 45 || t === 46 || t === 95 || Ln(t);
}
function op(t) {
  let r = t.length, a = !1;
  for (; r--; ) {
    const l = t[r][1];
    if ((l.type === "labelLink" || l.type === "labelImage") && !l._balanced) {
      a = !0;
      break;
    }
    if (l._gfmAutolinkLiteralWalkedInto) {
      a = !1;
      break;
    }
  }
  return t.length > 0 && !a && (t[t.length - 1][1]._gfmAutolinkLiteralWalkedInto = !0), a;
}
const y9 = {
  tokenize: E9,
  partial: !0
};
function b9() {
  return {
    document: {
      91: {
        name: "gfmFootnoteDefinition",
        tokenize: w9,
        continuation: {
          tokenize: k9
        },
        exit: C9
      }
    },
    text: {
      91: {
        name: "gfmFootnoteCall",
        tokenize: S9
      },
      93: {
        name: "gfmPotentialFootnoteCall",
        add: "after",
        tokenize: x9,
        resolveTo: v9
      }
    }
  };
}
function x9(t, r, a) {
  const l = this;
  let s = l.events.length;
  const c = l.parser.gfmFootnotes || (l.parser.gfmFootnotes = []);
  let d;
  for (; s--; ) {
    const g = l.events[s][1];
    if (g.type === "labelImage") {
      d = g;
      break;
    }
    if (g.type === "gfmFootnoteCall" || g.type === "labelLink" || g.type === "label" || g.type === "image" || g.type === "link")
      break;
  }
  return m;
  function m(g) {
    if (!d || !d._balanced)
      return a(g);
    const p = Pr(l.sliceSerialize({
      start: d.end,
      end: l.now()
    }));
    return p.codePointAt(0) !== 94 || !c.includes(p.slice(1)) ? a(g) : (t.enter("gfmFootnoteCallLabelMarker"), t.consume(g), t.exit("gfmFootnoteCallLabelMarker"), r(g));
  }
}
function v9(t, r) {
  let a = t.length;
  for (; a--; )
    if (t[a][1].type === "labelImage" && t[a][0] === "enter") {
      t[a][1];
      break;
    }
  t[a + 1][1].type = "data", t[a + 3][1].type = "gfmFootnoteCallLabelMarker";
  const l = {
    type: "gfmFootnoteCall",
    start: Object.assign({}, t[a + 3][1].start),
    end: Object.assign({}, t[t.length - 1][1].end)
  }, s = {
    type: "gfmFootnoteCallMarker",
    start: Object.assign({}, t[a + 3][1].end),
    end: Object.assign({}, t[a + 3][1].end)
  };
  s.end.column++, s.end.offset++, s.end._bufferIndex++;
  const c = {
    type: "gfmFootnoteCallString",
    start: Object.assign({}, s.end),
    end: Object.assign({}, t[t.length - 1][1].start)
  }, d = {
    type: "chunkString",
    contentType: "string",
    start: Object.assign({}, c.start),
    end: Object.assign({}, c.end)
  }, m = [
    // Take the `labelImageMarker` (now `data`, the `!`)
    t[a + 1],
    t[a + 2],
    ["enter", l, r],
    // The `[`
    t[a + 3],
    t[a + 4],
    // The `^`.
    ["enter", s, r],
    ["exit", s, r],
    // Everything in between.
    ["enter", c, r],
    ["enter", d, r],
    ["exit", d, r],
    ["exit", c, r],
    // The ending (`]`, properly parsed and labelled).
    t[t.length - 2],
    t[t.length - 1],
    ["exit", l, r]
  ];
  return t.splice(a, t.length - a + 1, ...m), t;
}
function S9(t, r, a) {
  const l = this, s = l.parser.gfmFootnotes || (l.parser.gfmFootnotes = []);
  let c = 0, d;
  return m;
  function m(x) {
    return t.enter("gfmFootnoteCall"), t.enter("gfmFootnoteCallLabelMarker"), t.consume(x), t.exit("gfmFootnoteCallLabelMarker"), g;
  }
  function g(x) {
    return x !== 94 ? a(x) : (t.enter("gfmFootnoteCallMarker"), t.consume(x), t.exit("gfmFootnoteCallMarker"), t.enter("gfmFootnoteCallString"), t.enter("chunkString").contentType = "string", p);
  }
  function p(x) {
    if (
      // Too long.
      c > 999 || // Closing brace with nothing.
      x === 93 && !d || // Space or tab is not supported by GFM for some reason.
      // `\n` and `[` not being supported makes sense.
      x === null || x === 91 || Lt(x)
    )
      return a(x);
    if (x === 93) {
      t.exit("chunkString");
      const E = t.exit("gfmFootnoteCallString");
      return s.includes(Pr(l.sliceSerialize(E))) ? (t.enter("gfmFootnoteCallLabelMarker"), t.consume(x), t.exit("gfmFootnoteCallLabelMarker"), t.exit("gfmFootnoteCall"), r) : a(x);
    }
    return Lt(x) || (d = !0), c++, t.consume(x), x === 92 ? v : p;
  }
  function v(x) {
    return x === 91 || x === 92 || x === 93 ? (t.consume(x), c++, p) : p(x);
  }
}
function w9(t, r, a) {
  const l = this, s = l.parser.gfmFootnotes || (l.parser.gfmFootnotes = []);
  let c, d = 0, m;
  return g;
  function g(_) {
    return t.enter("gfmFootnoteDefinition")._container = !0, t.enter("gfmFootnoteDefinitionLabel"), t.enter("gfmFootnoteDefinitionLabelMarker"), t.consume(_), t.exit("gfmFootnoteDefinitionLabelMarker"), p;
  }
  function p(_) {
    return _ === 94 ? (t.enter("gfmFootnoteDefinitionMarker"), t.consume(_), t.exit("gfmFootnoteDefinitionMarker"), t.enter("gfmFootnoteDefinitionLabelString"), t.enter("chunkString").contentType = "string", v) : a(_);
  }
  function v(_) {
    if (
      // Too long.
      d > 999 || // Closing brace with nothing.
      _ === 93 && !m || // Space or tab is not supported by GFM for some reason.
      // `\n` and `[` not being supported makes sense.
      _ === null || _ === 91 || Lt(_)
    )
      return a(_);
    if (_ === 93) {
      t.exit("chunkString");
      const A = t.exit("gfmFootnoteDefinitionLabelString");
      return c = Pr(l.sliceSerialize(A)), t.enter("gfmFootnoteDefinitionLabelMarker"), t.consume(_), t.exit("gfmFootnoteDefinitionLabelMarker"), t.exit("gfmFootnoteDefinitionLabel"), E;
    }
    return Lt(_) || (m = !0), d++, t.consume(_), _ === 92 ? x : v;
  }
  function x(_) {
    return _ === 91 || _ === 92 || _ === 93 ? (t.consume(_), d++, v) : v(_);
  }
  function E(_) {
    return _ === 58 ? (t.enter("definitionMarker"), t.consume(_), t.exit("definitionMarker"), s.includes(c) || s.push(c), vt(t, w, "gfmFootnoteDefinitionWhitespace")) : a(_);
  }
  function w(_) {
    return r(_);
  }
}
function k9(t, r, a) {
  return t.check(bu, r, t.attempt(y9, r, a));
}
function C9(t) {
  t.exit("gfmFootnoteDefinition");
}
function E9(t, r, a) {
  const l = this;
  return vt(t, s, "gfmFootnoteDefinitionIndent", 5);
  function s(c) {
    const d = l.events[l.events.length - 1];
    return d && d[1].type === "gfmFootnoteDefinitionIndent" && d[2].sliceSerialize(d[1], !0).length === 4 ? r(c) : a(c);
  }
}
function j9(t) {
  let a = (t || {}).singleTilde;
  const l = {
    name: "strikethrough",
    tokenize: c,
    resolveAll: s
  };
  return a == null && (a = !0), {
    text: {
      126: l
    },
    insideSpan: {
      null: [l]
    },
    attentionMarkers: {
      null: [126]
    }
  };
  function s(d, m) {
    let g = -1;
    for (; ++g < d.length; )
      if (d[g][0] === "enter" && d[g][1].type === "strikethroughSequenceTemporary" && d[g][1]._close) {
        let p = g;
        for (; p--; )
          if (d[p][0] === "exit" && d[p][1].type === "strikethroughSequenceTemporary" && d[p][1]._open && // If the sizes are the same:
          d[g][1].end.offset - d[g][1].start.offset === d[p][1].end.offset - d[p][1].start.offset) {
            d[g][1].type = "strikethroughSequence", d[p][1].type = "strikethroughSequence";
            const v = {
              type: "strikethrough",
              start: Object.assign({}, d[p][1].start),
              end: Object.assign({}, d[g][1].end)
            }, x = {
              type: "strikethroughText",
              start: Object.assign({}, d[p][1].end),
              end: Object.assign({}, d[g][1].start)
            }, E = [["enter", v, m], ["enter", d[p][1], m], ["exit", d[p][1], m], ["enter", x, m]], w = m.parser.constructs.insideSpan.null;
            w && pr(E, E.length, 0, md(w, d.slice(p + 1, g), m)), pr(E, E.length, 0, [["exit", x, m], ["enter", d[g][1], m], ["exit", d[g][1], m], ["exit", v, m]]), pr(d, p - 1, g - p + 3, E), g = p + E.length - 2;
            break;
          }
      }
    for (g = -1; ++g < d.length; )
      d[g][1].type === "strikethroughSequenceTemporary" && (d[g][1].type = "data");
    return d;
  }
  function c(d, m, g) {
    const p = this.previous, v = this.events;
    let x = 0;
    return E;
    function E(_) {
      return p === 126 && v[v.length - 1][1].type !== "characterEscape" ? g(_) : (d.enter("strikethroughSequenceTemporary"), w(_));
    }
    function w(_) {
      const A = Bo(p);
      if (_ === 126)
        return x > 1 ? g(_) : (d.consume(_), x++, w);
      if (x < 2 && !a) return g(_);
      const D = d.exit("strikethroughSequenceTemporary"), R = Bo(_);
      return D._open = !R || R === 2 && !!A, D._close = !A || A === 2 && !!R, m(_);
    }
  }
}
class _9 {
  /**
   * Create a new edit map.
   */
  constructor() {
    this.map = [];
  }
  /**
   * Create an edit: a remove and/or add at a certain place.
   *
   * @param {number} index
   * @param {number} remove
   * @param {Array<Event>} add
   * @returns {undefined}
   */
  add(r, a, l) {
    N9(this, r, a, l);
  }
  // To do: add this when moving to `micromark`.
  // /**
  //  * Create an edit: but insert `add` before existing additions.
  //  *
  //  * @param {number} index
  //  * @param {number} remove
  //  * @param {Array<Event>} add
  //  * @returns {undefined}
  //  */
  // addBefore(index, remove, add) {
  //   addImplementation(this, index, remove, add, true)
  // }
  /**
   * Done, change the events.
   *
   * @param {Array<Event>} events
   * @returns {undefined}
   */
  consume(r) {
    if (this.map.sort(function(c, d) {
      return c[0] - d[0];
    }), this.map.length === 0)
      return;
    let a = this.map.length;
    const l = [];
    for (; a > 0; )
      a -= 1, l.push(r.slice(this.map[a][0] + this.map[a][1]), this.map[a][2]), r.length = this.map[a][0];
    l.push(r.slice()), r.length = 0;
    let s = l.pop();
    for (; s; ) {
      for (const c of s)
        r.push(c);
      s = l.pop();
    }
    this.map.length = 0;
  }
}
function N9(t, r, a, l) {
  let s = 0;
  if (!(a === 0 && l.length === 0)) {
    for (; s < t.map.length; ) {
      if (t.map[s][0] === r) {
        t.map[s][1] += a, t.map[s][2].push(...l);
        return;
      }
      s += 1;
    }
    t.map.push([r, a, l]);
  }
}
function T9(t, r) {
  let a = !1;
  const l = [];
  for (; r < t.length; ) {
    const s = t[r];
    if (a) {
      if (s[0] === "enter")
        s[1].type === "tableContent" && l.push(t[r + 1][1].type === "tableDelimiterMarker" ? "left" : "none");
      else if (s[1].type === "tableContent") {
        if (t[r - 1][1].type === "tableDelimiterMarker") {
          const c = l.length - 1;
          l[c] = l[c] === "left" ? "center" : "right";
        }
      } else if (s[1].type === "tableDelimiterRow")
        break;
    } else s[0] === "enter" && s[1].type === "tableDelimiterRow" && (a = !0);
    r += 1;
  }
  return l;
}
function A9() {
  return {
    flow: {
      null: {
        name: "table",
        tokenize: M9,
        resolveAll: z9
      }
    }
  };
}
function M9(t, r, a) {
  const l = this;
  let s = 0, c = 0, d;
  return m;
  function m(X) {
    let oe = l.events.length - 1;
    for (; oe > -1; ) {
      const be = l.events[oe][1].type;
      if (be === "lineEnding" || // Note: markdown-rs uses `whitespace` instead of `linePrefix`
      be === "linePrefix") oe--;
      else break;
    }
    const se = oe > -1 ? l.events[oe][1].type : null, Re = se === "tableHead" || se === "tableRow" ? I : g;
    return Re === I && l.parser.lazy[l.now().line] ? a(X) : Re(X);
  }
  function g(X) {
    return t.enter("tableHead"), t.enter("tableRow"), p(X);
  }
  function p(X) {
    return X === 124 || (d = !0, c += 1), v(X);
  }
  function v(X) {
    return X === null ? a(X) : et(X) ? c > 1 ? (c = 0, l.interrupt = !0, t.exit("tableRow"), t.enter("lineEnding"), t.consume(X), t.exit("lineEnding"), w) : a(X) : ht(X) ? vt(t, v, "whitespace")(X) : (c += 1, d && (d = !1, s += 1), X === 124 ? (t.enter("tableCellDivider"), t.consume(X), t.exit("tableCellDivider"), d = !0, v) : (t.enter("data"), x(X)));
  }
  function x(X) {
    return X === null || X === 124 || Lt(X) ? (t.exit("data"), v(X)) : (t.consume(X), X === 92 ? E : x);
  }
  function E(X) {
    return X === 92 || X === 124 ? (t.consume(X), x) : x(X);
  }
  function w(X) {
    return l.interrupt = !1, l.parser.lazy[l.now().line] ? a(X) : (t.enter("tableDelimiterRow"), d = !1, ht(X) ? vt(t, _, "linePrefix", l.parser.constructs.disable.null.includes("codeIndented") ? void 0 : 4)(X) : _(X));
  }
  function _(X) {
    return X === 45 || X === 58 ? D(X) : X === 124 ? (d = !0, t.enter("tableCellDivider"), t.consume(X), t.exit("tableCellDivider"), A) : de(X);
  }
  function A(X) {
    return ht(X) ? vt(t, D, "whitespace")(X) : D(X);
  }
  function D(X) {
    return X === 58 ? (c += 1, d = !0, t.enter("tableDelimiterMarker"), t.consume(X), t.exit("tableDelimiterMarker"), R) : X === 45 ? (c += 1, R(X)) : X === null || et(X) ? ge(X) : de(X);
  }
  function R(X) {
    return X === 45 ? (t.enter("tableDelimiterFiller"), Z(X)) : de(X);
  }
  function Z(X) {
    return X === 45 ? (t.consume(X), Z) : X === 58 ? (d = !0, t.exit("tableDelimiterFiller"), t.enter("tableDelimiterMarker"), t.consume(X), t.exit("tableDelimiterMarker"), K) : (t.exit("tableDelimiterFiller"), K(X));
  }
  function K(X) {
    return ht(X) ? vt(t, ge, "whitespace")(X) : ge(X);
  }
  function ge(X) {
    return X === 124 ? _(X) : X === null || et(X) ? !d || s !== c ? de(X) : (t.exit("tableDelimiterRow"), t.exit("tableHead"), r(X)) : de(X);
  }
  function de(X) {
    return a(X);
  }
  function I(X) {
    return t.enter("tableRow"), V(X);
  }
  function V(X) {
    return X === 124 ? (t.enter("tableCellDivider"), t.consume(X), t.exit("tableCellDivider"), V) : X === null || et(X) ? (t.exit("tableRow"), r(X)) : ht(X) ? vt(t, V, "whitespace")(X) : (t.enter("data"), we(X));
  }
  function we(X) {
    return X === null || X === 124 || Lt(X) ? (t.exit("data"), V(X)) : (t.consume(X), X === 92 ? Te : we);
  }
  function Te(X) {
    return X === 92 || X === 124 ? (t.consume(X), we) : we(X);
  }
}
function z9(t, r) {
  let a = -1, l = !0, s = 0, c = [0, 0, 0, 0], d = [0, 0, 0, 0], m = !1, g = 0, p, v, x;
  const E = new _9();
  for (; ++a < t.length; ) {
    const w = t[a], _ = w[1];
    w[0] === "enter" ? _.type === "tableHead" ? (m = !1, g !== 0 && (Dy(E, r, g, p, v), v = void 0, g = 0), p = {
      type: "table",
      start: Object.assign({}, _.start),
      // Note: correct end is set later.
      end: Object.assign({}, _.end)
    }, E.add(a, 0, [["enter", p, r]])) : _.type === "tableRow" || _.type === "tableDelimiterRow" ? (l = !0, x = void 0, c = [0, 0, 0, 0], d = [0, a + 1, 0, 0], m && (m = !1, v = {
      type: "tableBody",
      start: Object.assign({}, _.start),
      // Note: correct end is set later.
      end: Object.assign({}, _.end)
    }, E.add(a, 0, [["enter", v, r]])), s = _.type === "tableDelimiterRow" ? 2 : v ? 3 : 1) : s && (_.type === "data" || _.type === "tableDelimiterMarker" || _.type === "tableDelimiterFiller") ? (l = !1, d[2] === 0 && (c[1] !== 0 && (d[0] = d[1], x = qc(E, r, c, s, void 0, x), c = [0, 0, 0, 0]), d[2] = a)) : _.type === "tableCellDivider" && (l ? l = !1 : (c[1] !== 0 && (d[0] = d[1], x = qc(E, r, c, s, void 0, x)), c = d, d = [c[1], a, 0, 0])) : _.type === "tableHead" ? (m = !0, g = a) : _.type === "tableRow" || _.type === "tableDelimiterRow" ? (g = a, c[1] !== 0 ? (d[0] = d[1], x = qc(E, r, c, s, a, x)) : d[1] !== 0 && (x = qc(E, r, d, s, a, x)), s = 0) : s && (_.type === "data" || _.type === "tableDelimiterMarker" || _.type === "tableDelimiterFiller") && (d[3] = a);
  }
  for (g !== 0 && Dy(E, r, g, p, v), E.consume(r.events), a = -1; ++a < r.events.length; ) {
    const w = r.events[a];
    w[0] === "enter" && w[1].type === "table" && (w[1]._align = T9(r.events, a));
  }
  return t;
}
function qc(t, r, a, l, s, c) {
  const d = l === 1 ? "tableHeader" : l === 2 ? "tableDelimiter" : "tableData", m = "tableContent";
  a[0] !== 0 && (c.end = Object.assign({}, Oo(r.events, a[0])), t.add(a[0], 0, [["exit", c, r]]));
  const g = Oo(r.events, a[1]);
  if (c = {
    type: d,
    start: Object.assign({}, g),
    // Note: correct end is set later.
    end: Object.assign({}, g)
  }, t.add(a[1], 0, [["enter", c, r]]), a[2] !== 0) {
    const p = Oo(r.events, a[2]), v = Oo(r.events, a[3]), x = {
      type: m,
      start: Object.assign({}, p),
      end: Object.assign({}, v)
    };
    if (t.add(a[2], 0, [["enter", x, r]]), l !== 2) {
      const E = r.events[a[2]], w = r.events[a[3]];
      if (E[1].end = Object.assign({}, w[1].end), E[1].type = "chunkText", E[1].contentType = "text", a[3] > a[2] + 1) {
        const _ = a[2] + 1, A = a[3] - a[2] - 1;
        t.add(_, A, []);
      }
    }
    t.add(a[3] + 1, 0, [["exit", x, r]]);
  }
  return s !== void 0 && (c.end = Object.assign({}, Oo(r.events, s)), t.add(s, 0, [["exit", c, r]]), c = void 0), c;
}
function Dy(t, r, a, l, s) {
  const c = [], d = Oo(r.events, a);
  s && (s.end = Object.assign({}, d), c.push(["exit", s, r])), l.end = Object.assign({}, d), c.push(["exit", l, r]), t.add(a + 1, 0, c);
}
function Oo(t, r) {
  const a = t[r], l = a[0] === "enter" ? "start" : "end";
  return a[1][l];
}
const R9 = {
  name: "tasklistCheck",
  tokenize: D9
};
function O9() {
  return {
    text: {
      91: R9
    }
  };
}
function D9(t, r, a) {
  const l = this;
  return s;
  function s(g) {
    return (
      // Exit if theres stuff before.
      l.previous !== null || // Exit if not in the first content that is the first child of a list
      // item.
      !l._gfmTasklistFirstContentOfListItem ? a(g) : (t.enter("taskListCheck"), t.enter("taskListCheckMarker"), t.consume(g), t.exit("taskListCheckMarker"), c)
    );
  }
  function c(g) {
    return Lt(g) ? (t.enter("taskListCheckValueUnchecked"), t.consume(g), t.exit("taskListCheckValueUnchecked"), d) : g === 88 || g === 120 ? (t.enter("taskListCheckValueChecked"), t.consume(g), t.exit("taskListCheckValueChecked"), d) : a(g);
  }
  function d(g) {
    return g === 93 ? (t.enter("taskListCheckMarker"), t.consume(g), t.exit("taskListCheckMarker"), t.exit("taskListCheck"), m) : a(g);
  }
  function m(g) {
    return et(g) ? r(g) : ht(g) ? t.check({
      tokenize: L9
    }, r, a)(g) : a(g);
  }
}
function L9(t, r, a) {
  return vt(t, l, "whitespace");
  function l(s) {
    return s === null ? a(s) : r(s);
  }
}
function B9(t) {
  return Xb([
    s9(),
    b9(),
    j9(t),
    A9(),
    O9()
  ]);
}
const I9 = {};
function U9(t) {
  const r = (
    /** @type {Processor<Root>} */
    this
  ), a = t || I9, l = r.data(), s = l.micromarkExtensions || (l.micromarkExtensions = []), c = l.fromMarkdownExtensions || (l.fromMarkdownExtensions = []), d = l.toMarkdownExtensions || (l.toMarkdownExtensions = []);
  s.push(B9(a)), c.push(a9()), d.push(i9(a));
}
const P9 = "Engram_project";
async function q9() {
  try {
    const t = await fetch("/api/extensions/update", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        extensionName: P9,
        global: !1
        // Engram 
      })
    });
    if (!t.ok)
      return { success: !1, message: await t.text() || t.statusText };
    const r = await t.json();
    return r.isUpToDate ? { success: !0, message: "", isUpToDate: !0 } : {
      success: !0,
      message: `: ${r.shortCommitHash || "latest"}`,
      isUpToDate: !1
    };
  } catch (t) {
    return console.error("[Engram] :", t), { success: !1, message: String(t) };
  }
}
const H9 = ({ isOpen: t, onClose: r }) => {
  const [a, l] = U.useState(!0), [s, c] = U.useState(null), [d, m] = U.useState(null), [g, p] = U.useState(!1), [v, x] = U.useState(!1), [E, w] = U.useState(!1), [_, A] = U.useState(null), D = Ai.getCurrentVersion();
  U.useEffect(() => {
    t && (R(), A(null));
  }, [t]);
  const R = async () => {
    l(!0);
    try {
      const [de, I, V] = await Promise.all([
        Ai.getLatestVersion(),
        Ai.getChangelog(),
        Ai.hasUpdate()
      ]);
      c(de), m(I), p(V);
    } catch (de) {
      console.error("[Engram] ", de);
    } finally {
      l(!1);
    }
  }, Z = async () => {
    x(!0);
    try {
      const de = s || D;
      console.debug("[Engram] Marking update as read:", de), await Ai.markAsRead(de), r();
    } finally {
      x(!1);
    }
  }, K = async () => {
    w(!0), A(null);
    try {
      const de = await q9();
      de.success && !de.isUpToDate ? (A(" 2 ..."), s && await Ai.markAsRead(s), setTimeout(() => {
        window.location.reload();
      }, 2e3)) : de.isUpToDate ? (A(""), p(!1)) : A(`: ${de.message}`);
    } catch (de) {
      A(`: ${String(de)}`);
    } finally {
      w(!1);
    }
  }, ge = () => {
    Ai.clearCache(), R();
  };
  return t ? /* @__PURE__ */ u.jsxs("div", { className: "fixed inset-0 z-[100] flex items-center justify-center p-4", children: [
    /* @__PURE__ */ u.jsx(
      "div",
      {
        className: "absolute inset-0 bg-black/60 backdrop-blur-sm",
        onClick: r
      }
    ),
    /* @__PURE__ */ u.jsxs("div", { className: "relative bg-card border border-border rounded-xl shadow-2xl w-full max-w-lg max-h-[80vh] flex flex-col overflow-hidden animate-in zoom-in-95 duration-200", children: [
      /* @__PURE__ */ u.jsxs("div", { className: "flex items-center justify-between px-5 py-4 border-b border-border/50", children: [
        /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-3", children: [
          /* @__PURE__ */ u.jsx("div", { className: "w-8 h-8 rounded-lg bg-primary/10 flex items-center justify-center", children: /* @__PURE__ */ u.jsx(tu, { size: 16, className: "text-primary" }) }),
          /* @__PURE__ */ u.jsxs("div", { children: [
            /* @__PURE__ */ u.jsx("h2", { className: "text-base font-semibold text-foreground", children: "" }),
            /* @__PURE__ */ u.jsxs("p", { className: "text-xs text-muted-foreground", children: [
              ": v",
              D
            ] })
          ] })
        ] }),
        /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-2", children: [
          /* @__PURE__ */ u.jsx(
            "button",
            {
              onClick: ge,
              className: "p-2 rounded-lg hover:bg-muted/50 text-muted-foreground hover:text-foreground transition-colors",
              title: "",
              children: /* @__PURE__ */ u.jsx(tr, { size: 16, className: a ? "animate-spin" : "" })
            }
          ),
          /* @__PURE__ */ u.jsx(
            "button",
            {
              onClick: r,
              className: "p-2 rounded-lg hover:bg-muted/50 text-muted-foreground hover:text-foreground transition-colors",
              children: /* @__PURE__ */ u.jsx(Uo, { size: 16 })
            }
          )
        ] })
      ] }),
      /* @__PURE__ */ u.jsx("div", { className: "flex-1 overflow-y-auto p-5", children: a ? /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col items-center justify-center py-12 text-muted-foreground", children: [
        /* @__PURE__ */ u.jsx(tr, { size: 24, className: "animate-spin mb-3" }),
        /* @__PURE__ */ u.jsx("p", { className: "text-sm", children: "..." })
      ] }) : /* @__PURE__ */ u.jsxs("div", { className: "space-y-4", children: [
        /* @__PURE__ */ u.jsx("div", { className: `
                                p-4 rounded-lg border
                                ${g ? "bg-primary/5 border-primary/20" : "bg-green-500/5 border-green-500/20"}
                            `, children: /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-3", children: [
          g ? /* @__PURE__ */ u.jsx(tu, { size: 20, className: "text-primary" }) : /* @__PURE__ */ u.jsx(zm, { size: 20, className: "text-green-500" }),
          /* @__PURE__ */ u.jsxs("div", { className: "flex-1", children: [
            /* @__PURE__ */ u.jsx("p", { className: "font-medium text-foreground", children: g ? `: v${s}` : "" }),
            /* @__PURE__ */ u.jsx("p", { className: "text-xs text-muted-foreground mt-0.5", children: g ? "" : "" })
          ] })
        ] }) }),
        _ && /* @__PURE__ */ u.jsx("div", { className: `
                                    p-3 rounded-lg text-sm
                                    ${_.includes("") ? "bg-green-500/10 text-green-600 border border-green-500/20" : _.includes("") || _.includes("") ? "bg-red-500/10 text-red-600 border border-red-500/20" : "bg-muted/30 text-muted-foreground"}
                                `, children: _ }),
        d && /* @__PURE__ */ u.jsxs("div", { className: "space-y-2", children: [
          /* @__PURE__ */ u.jsx("h3", { className: "text-xs font-medium text-muted-foreground uppercase tracking-wider", children: "" }),
          /* @__PURE__ */ u.jsx("div", { className: "bg-muted/20 rounded-lg p-4 max-h-64 overflow-y-auto engram-changelog-content text-sm", children: /* @__PURE__ */ u.jsx(jk, { remarkPlugins: [U9], children: d }) })
        ] }),
        !d && !a && /* @__PURE__ */ u.jsx("div", { className: "text-center py-8 text-muted-foreground", children: /* @__PURE__ */ u.jsx("p", { className: "text-sm", children: "" }) })
      ] }) }),
      /* @__PURE__ */ u.jsxs("div", { className: "px-5 py-4 border-t border-border/50 flex justify-end gap-3", children: [
        /* @__PURE__ */ u.jsx(
          "button",
          {
            onClick: r,
            className: "px-4 py-2 text-sm text-muted-foreground hover:text-foreground transition-colors",
            children: ""
          }
        ),
        g && /* @__PURE__ */ u.jsxs(u.Fragment, { children: [
          /* @__PURE__ */ u.jsx(
            "button",
            {
              onClick: Z,
              disabled: v || E,
              className: "px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg transition-colors disabled:opacity-50",
              children: ""
            }
          ),
          /* @__PURE__ */ u.jsx(
            "button",
            {
              onClick: K,
              disabled: E || v,
              className: "px-4 py-2 text-sm bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50 flex items-center gap-2",
              children: E ? /* @__PURE__ */ u.jsxs(u.Fragment, { children: [
                /* @__PURE__ */ u.jsx(Tl, { size: 14, className: "animate-spin" }),
                "..."
              ] }) : /* @__PURE__ */ u.jsxs(u.Fragment, { children: [
                /* @__PURE__ */ u.jsx(tu, { size: 14 }),
                ""
              ] })
            }
          )
        ] })
      ] })
    ] })
  ] }) : null;
}, F9 = ({ children: t, activeTab: r, setActiveTab: a, onClose: l }) => {
  const [s, c] = U.useState(!1), [d, m] = U.useState(!1), [g, p] = U.useState(!1);
  U.useEffect(() => {
    (async () => {
      try {
        const w = await Ai.hasUnreadUpdate();
        p(w);
      } catch (w) {
        console.debug("[Engram] ", w);
      }
    })();
  }, []);
  const v = () => {
    m(!0);
  }, x = () => {
    m(!1), p(!1);
  };
  return /* @__PURE__ */ u.jsxs("div", { className: "flex absolute inset-0 w-full h-full bg-background text-foreground overflow-hidden font-sans selection:bg-primary/30 selection:text-primary animate-in fade-in duration-300", id: "engram-layout-root", children: [
    /* @__PURE__ */ u.jsx(qv, {}),
    /* @__PURE__ */ u.jsx(
      H9,
      {
        isOpen: d,
        onClose: x
      }
    ),
    /* @__PURE__ */ u.jsx(
      V1,
      {
        activeTab: r,
        onNavigate: a,
        isMobile: !1,
        onShowUpdateNotice: v,
        hasUnreadUpdate: g
      }
    ),
    /* @__PURE__ */ u.jsx(
      V1,
      {
        activeTab: r,
        onNavigate: a,
        isMobile: !0,
        isOpen: s,
        onClose: () => c(!1),
        onShowUpdateNotice: v,
        hasUnreadUpdate: g
      }
    ),
    /* @__PURE__ */ u.jsxs("div", { className: "flex flex-1 flex-col overflow-hidden", children: [
      /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col flex-shrink-0 border-b border-border bg-sidebar/95 backdrop-blur z-50 transition-all duration-300", children: [
        /* @__PURE__ */ u.jsx(
          h6,
          {
            onToggleSidebar: () => c(!s),
            isMobile: !1,
            onClose: l,
            onNavigate: (E) => a(E.replace("/", ""))
          }
        ),
        /* @__PURE__ */ u.jsx("div", { id: "engram-header-extension", className: "z-40 flex-shrink-0 bg-transparent transition-all empty:hidden" })
      ] }),
      /* @__PURE__ */ u.jsx("main", { className: "flex-1 flex flex-col relative w-full overflow-hidden bg-background", children: /* @__PURE__ */ u.jsx("div", { className: "flex-1 overflow-y-auto overflow-x-hidden pt-0 px-4 pb-4 md:px-8 md:pb-8 lg:px-12 lg:pb-12 scroll-smooth animate-blur-in fill-mode-both", style: { animationDelay: "200ms", animationFillMode: "both" }, children: /* @__PURE__ */ u.jsx("div", { className: "max-w-6xl mx-auto min-h-full pb-20", children: t }) }) })
    ] }),
    "  "
  ] });
}, na = {
  primary: "#FFFFFF",
  grid: "#111111"
}, $9 = ({ onComplete: t }) => {
  const r = U.useRef(null), a = U.useRef(null), l = U.useRef(null), s = U.useRef(null), [c, d] = U.useState(!1);
  U.useEffect(() => {
    if (window.gsap) {
      d(!0);
      return;
    }
    const g = document.createElement("script");
    g.src = "https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js", g.async = !0, g.onload = () => d(!0), document.body.appendChild(g);
  }, []);
  const m = () => {
    var w;
    if (!c || !a.current) return;
    const g = window.gsap, p = a.current, v = p.getTotalLength();
    g.set(p, {
      strokeDasharray: v,
      strokeDashoffset: v,
      stroke: na.primary,
      fillOpacity: 0,
      opacity: 1,
      strokeWidth: 2
    });
    const x = (w = l.current) == null ? void 0 : w.querySelectorAll("path");
    x && g.set(x, { opacity: 0, y: 10 }), g.set(s.current, { scale: 1, opacity: 1 }), g.set(r.current, { opacity: 1 });
    const E = g.timeline({
      onComplete: () => {
        g.to(r.current, {
          opacity: 0,
          duration: 0.8,
          ease: "power2.out",
          onComplete: t
        });
      }
    });
    E.to(p, {
      strokeDashoffset: 0,
      duration: 2.5,
      ease: "power2.inOut"
    }), x && E.to(x, {
      opacity: 1,
      y: 0,
      duration: 1.2,
      stagger: 0.08,
      ease: "power3.out"
    }, "-=0.8"), E.to({}, { duration: 1 });
  };
  return U.useEffect(() => {
    if (c) {
      const g = setTimeout(m, 800);
      return () => clearTimeout(g);
    }
  }, [c]), /* @__PURE__ */ u.jsxs(
    "div",
    {
      ref: r,
      className: "fixed inset-0 z-[200] flex flex-col items-center justify-center bg-black overflow-hidden",
      style: { touchAction: "none" },
      children: [
        /* @__PURE__ */ u.jsx(
          "div",
          {
            className: "absolute inset-0 pointer-events-none",
            style: {
              backgroundImage: `
                        linear-gradient(to right, ${na.grid} 1px, transparent 1px),
                        linear-gradient(to bottom, ${na.grid} 1px, transparent 1px)
                    `,
              backgroundSize: "40px 40px",
              opacity: 0.3
            }
          }
        ),
        /* @__PURE__ */ u.jsx(
          "div",
          {
            className: "absolute inset-0 pointer-events-none",
            style: { background: "radial-gradient(circle at center, transparent 0%, black 100%)", opacity: 0.9 }
          }
        ),
        /* @__PURE__ */ u.jsxs("div", { className: "z-10 relative flex flex-col items-center justify-center w-full h-full p-4", children: [
          /* @__PURE__ */ u.jsx("div", { className: "w-full max-w-[600px] md:max-w-[800px] aspect-[4/3]", children: /* @__PURE__ */ u.jsx(
            "svg",
            {
              version: "1.1",
              xmlns: "http://www.w3.org/2000/svg",
              viewBox: "250 0 550 600",
              className: "w-full h-full overflow-visible",
              children: /* @__PURE__ */ u.jsxs("g", { ref: s, className: "origin-center", children: [
                /* @__PURE__ */ u.jsx(
                  "path",
                  {
                    ref: a,
                    fill: "none",
                    stroke: na.primary,
                    strokeWidth: "2",
                    strokeLinecap: "round",
                    strokeLinejoin: "round",
                    d: "M463.360840,364.455627 C437.246704,381.338409 406.466644,366.209045 404.026672,335.650848 C402.910156,321.667206 412.549713,306.544678 426.813293,300.633850 C430.474335,299.116699 431.826355,297.290924 431.760071,293.302460 C431.519287,278.808716 431.584564,264.307892 431.718292,249.811417 C431.748169,246.574463 430.886292,244.713684 427.681274,243.389038 C412.366425,237.059357 404.237366,225.144638 404.208862,208.867447 C404.179871,192.298615 412.621979,180.486938 428.224701,174.293686 C430.850494,173.251419 431.710938,171.751862 431.696136,169.060089 C431.613586,154.062912 431.568054,139.064117 431.723419,124.068092 C431.759430,120.590492 430.119568,119.052467 427.243103,117.790627 C413.349915,111.695946 405.841095,101.009903 404.195740,85.916542 C402.099884,66.690948 418.566650,47.364159 437.884277,46.682220 C456.888519,46.011345 468.064789,52.989845 476.252197,70.840332 C477.174438,72.851059 478.313995,73.541710 480.422974,73.516098 C499.569031,73.283493 518.722961,73.393646 537.862915,73.456795 C545.529785,73.482086 549.225952,71.767975 552.791809,64.663139 C559.898376,50.503635 576.618042,43.921410 592.447876,47.234680 C608.699890,50.636322 619.276489,62.116261 621.438904,78.701805 C623.839478,97.113228 612.679382,114.371338 595.357910,119.034004 C577.219604,123.916542 558.125427,115.204048 550.887390,98.365906 C549.251465,94.560234 547.316284,93.116508 543.150696,93.160004 C522.989380,93.370483 502.824707,93.284561 482.661285,93.261726 C479.716156,93.258385 477.395905,93.379341 475.956635,96.902077 C474.571899,100.291283 475.702576,102.070137 477.892181,104.225159 C501.524139,127.483910 525.127991,150.771423 548.653259,174.137985 C550.803162,176.273376 552.520325,176.380997 555.207153,175.171799 C569.642334,168.675354 583.205750,171.177368 594.759277,181.252563 C606.783813,191.738449 610.379395,205.504944 605.248840,220.725037 C600.321167,235.343246 589.568848,243.345337 574.305420,245.467117 C567.655396,246.391541 561.334045,245.373352 555.347839,242.591797 C552.373169,241.209595 550.274536,241.303284 547.832886,243.728531 C524.197693,267.205322 500.499634,290.619415 476.704651,313.934174 C474.165771,316.421844 475.106598,318.487793 476.015411,321.059723 C476.869354,323.476318 478.159149,324.356232 480.796143,324.332367 C501.456360,324.145294 522.118530,324.019531 542.778870,324.122131 C546.987793,324.143005 549.216675,322.931549 551.044983,318.871887 C558.230042,302.918091 576.073181,294.652069 593.497131,298.684143 C610.451355,302.607544 622.335205,317.668091 622.119812,334.958160 C621.900024,352.608002 609.316650,367.564362 591.822144,370.969543 C574.585754,374.324463 557.004028,364.861755 550.521484,348.456757 C549.268677,345.286346 547.631836,344.200745 544.294861,344.220337 C523.465576,344.342865 502.634888,344.322540 481.805359,344.218109 C478.697174,344.202545 476.993927,345.152252 475.888916,348.205902 C473.513214,354.771179 469.417969,360.183167 463.360840,364.455627 M472.733368,188.880936 C473.545441,190.333145 474.799072,191.702774 475.088898,193.252655 C476.058929,198.439468 479.434326,198.919983 483.888489,198.861130 C499.042145,198.660889 514.201233,198.707901 529.355957,198.872879 C532.819580,198.910583 534.700989,197.913788 536.177185,194.588806 C537.657104,191.255417 536.060120,189.735016 534.097900,187.805573 C510.706268,164.804840 487.354065,141.764008 463.949341,118.776604 C462.445251,117.299316 461.277863,114.441566 458.282349,116.423027 C455.343719,118.366882 451.028107,118.406143 451.180542,123.994591 C451.584534,138.807007 451.429443,153.638779 451.250458,168.459885 C451.208984,171.894135 452.474548,173.487930 455.559784,174.673798 C462.566864,177.367126 468.343140,181.758774 472.733368,188.880936 M457.308807,300.958954 C460.540070,302.823181 462.218414,300.310028 464.063263,298.488586 C487.164032,275.681519 510.248199,252.857559 533.326538,230.027756 C535.300171,228.075378 537.458679,226.516449 535.970032,222.843750 C534.495117,219.205124 532.067688,218.878906 528.898010,218.890778 C513.414001,218.948746 497.929138,219.002151 482.445862,218.887329 C478.998230,218.861771 477.090668,219.941055 475.670502,223.284790 C471.742218,232.533905 465.159332,239.474701 455.665497,243.103836 C452.239746,244.413376 451.216278,246.302231 451.253540,249.781387 C451.406891,264.098541 451.489380,278.421356 451.223358,292.735107 C451.142975,297.059998 452.224640,299.783386 457.308807,300.958954 z"
                  }
                ),
                /* @__PURE__ */ u.jsxs("g", { ref: l, children: [
                  /* @__PURE__ */ u.jsx("path", { fill: na.primary, d: "M732.215698,483.876190 C732.750061,488.775055 731.110779,490.523590 726.372742,490.479736 C713.642639,490.361908 713.645874,490.566711 713.641113,477.834442 C713.638428,470.668732 713.788818,463.497284 713.552246,456.338928 C713.318970,449.278015 710.633911,445.451111 705.788818,444.403778 C698.667542,442.864441 692.689270,447.076904 692.324463,454.647736 C691.851685,464.458313 691.862549,474.305084 692.048706,484.128967 C692.137085,488.792786 690.778625,490.578705 685.827454,490.500549 C672.843933,490.295532 672.845886,490.510315 672.820435,477.502625 C672.805786,470.003754 672.887146,462.502136 672.708618,455.006927 C672.557556,448.666412 669.519653,444.981689 664.341858,444.320343 C658.234436,443.540314 653.997803,446.541077 652.162415,452.864807 C651.503052,455.136719 651.331299,457.435608 651.335754,459.781158 C651.352234,468.446747 651.306274,477.112488 651.338745,485.777985 C651.348389,488.341766 651.062439,490.138977 647.717529,490.447815 C632.733521,491.831421 632.748596,491.913239 632.764404,477.031830 C632.778870,463.366852 632.738831,449.701782 632.731445,436.036774 C632.727478,428.732941 632.735718,428.732544 640.257812,428.707031 C641.591003,428.702484 642.924194,428.695312 644.257324,428.701721 C647.429321,428.717010 651.058289,427.916016 650.925598,433.229431 C655.308960,431.486603 658.595154,429.192383 662.595154,428.377930 C670.453491,426.777832 677.619019,428.117981 683.735718,433.181641 C686.512207,435.480164 688.239807,435.373474 690.953918,433.250153 C697.176208,428.382202 704.485840,426.832367 712.194946,428.080414 C725.100098,430.169739 731.944641,439.074829 732.175659,453.896454 C732.328857,463.726379 732.212036,473.560547 732.215698,483.876190 z" }),
                  /* @__PURE__ */ u.jsx("path", { fill: na.primary, d: "M487.575867,485.935303 C487.614716,484.616028 487.614716,483.640503 487.614716,481.796417 C479.116760,488.238525 470.153107,489.257660 460.718079,486.787720 C454.401794,485.134186 449.163879,481.675842 445.200134,476.457642 C436.960876,465.610748 437.295532,448.722229 445.889771,438.315796 C455.451538,426.737823 470.295227,425.042450 488.444458,433.733826 C487.913239,428.612457 491.194366,428.604004 494.772766,428.684540 C508.272736,428.988373 506.179840,426.849945 506.294434,440.421967 C506.411133,454.245575 506.366882,468.071228 506.299957,481.895538 C506.205750,501.359833 494.742065,512.847900 475.259460,513.370544 C465.272614,513.638489 455.717651,512.255005 446.682343,507.725311 C443.034790,505.896667 441.336151,503.847290 444.229065,500.105438 C444.329590,499.975464 444.390869,499.814941 444.469086,499.667908 C448.861603,491.411743 448.894196,491.340729 457.207886,495.157196 C463.352356,497.977905 469.817169,498.376801 476.285126,497.456818 C482.543640,496.566620 486.238434,492.476532 487.575867,485.935303 M469.264740,471.577881 C471.084900,471.642700 472.915710,471.865356 474.723328,471.743805 C481.074341,471.316620 486.258820,466.628052 487.489288,460.346558 C488.669373,454.322296 485.713593,448.118378 480.288971,445.234039 C472.426056,441.053253 462.868591,443.867035 459.399658,451.384033 C455.705688,459.388580 459.382996,467.492737 469.264740,471.577881 z" }),
                  /* @__PURE__ */ u.jsx("path", { fill: na.primary, d: "M350.790619,410.644409 C354.007477,410.561554 355.147522,411.945587 355.144592,414.620361 C355.128937,428.846375 356.152588,426.165161 344.558044,426.338898 C335.900940,426.468628 327.237854,426.493591 318.582581,426.315826 C314.804382,426.238220 313.157715,427.376373 313.262451,431.424896 C313.571655,443.375275 312.019470,441.570435 323.204529,441.691742 C330.530579,441.771271 337.860626,441.831665 345.183899,441.671692 C348.853607,441.591553 350.203705,443.056824 350.190338,446.675842 C350.143219,459.433014 350.725433,457.207275 340.024445,457.368561 C332.865692,457.476471 325.700195,457.536346 318.545349,457.339996 C314.731018,457.235291 313.250702,458.478516 313.234222,462.478668 C313.185364,474.308960 313.038177,474.321259 324.813477,474.130890 C334.298523,473.977539 343.772430,475.169159 353.264343,474.338776 C354.864075,474.198792 356.466827,474.576569 356.702301,476.439850 C357.203217,480.403656 357.364838,484.405273 356.646729,488.365631 C356.297211,490.293060 354.652405,490.369568 353.118927,490.370575 C334.801880,490.382568 316.484711,490.350647 298.167847,490.412506 C295.104187,490.422852 294.024323,488.921082 294.024200,486.130402 C294.023224,462.484924 294.047699,438.839325 293.967896,415.194092 C293.954620,411.261261 296.028046,410.593658 299.359711,410.610138 C316.344330,410.694275 333.329620,410.638672 350.790619,410.644409 z" }),
                  /* @__PURE__ */ u.jsx("path", { fill: na.primary, d: "M620.003906,453.402435 C620.062195,464.023071 619.882812,474.188721 620.189575,484.339661 C620.338318,489.262421 618.431458,490.973572 613.757507,490.452362 C611.783386,490.232208 609.754700,490.291412 607.767883,490.444916 C604.889648,490.667267 602.478821,490.168823 601.296570,486.513000 C594.831909,490.991821 587.888184,491.843719 580.600464,491.328247 C565.916626,490.289642 557.201233,476.053131 563.502625,463.374390 C565.502930,459.349640 568.872803,457.136932 572.794861,455.506927 C578.118103,453.294647 583.702881,452.709900 589.425354,452.731232 C592.879822,452.744110 596.387085,453.235260 599.791443,452.317169 C599.855774,446.843750 597.260681,443.903503 591.552673,443.177338 C585.446533,442.400513 579.495911,443.228607 574.179382,446.386688 C570.948853,448.305603 569.535645,447.214966 568.011658,444.340485 C563.043945,434.970917 563.058899,434.663818 573.199219,430.800537 C582.143921,427.392792 591.347961,426.734100 600.678101,428.904358 C613.358643,431.853943 619.173157,440.405762 620.003906,453.402435 M582.869263,466.083313 C579.496887,469.605530 579.013306,473.431427 581.947998,475.906952 C585.513611,478.914764 589.714966,478.291107 593.721985,477.031647 C597.412354,475.871704 599.990784,473.365112 600.658081,469.369629 C601.070496,466.900665 600.409729,465.044220 597.411255,465.098297 C592.800171,465.181488 588.157471,464.530182 582.869263,466.083313 z" }),
                  /* @__PURE__ */ u.jsx("path", { fill: na.primary, d: "M410.915314,457.280090 C410.311127,447.930115 406.925934,444.198608 399.452026,444.194855 C391.667114,444.190948 386.727997,448.953094 386.409271,457.536652 C386.075653,466.521088 386.068634,475.532593 386.350006,484.518738 C386.494904,489.147247 384.896912,490.532959 380.337830,490.481964 C367.440552,490.337616 367.627808,490.513641 367.533173,477.713593 C367.426025,463.226135 368.160004,448.728760 367.168365,434.251617 C366.898468,430.311462 368.239288,428.249725 372.529694,428.668640 C374.840057,428.894196 377.203857,428.868896 379.519684,428.673553 C383.194244,428.363556 385.817352,429.188293 385.487488,434.182526 C390.858826,430.844635 395.856995,428.304504 401.601257,427.794434 C418.292908,426.312286 429.386810,436.518799 429.975342,454.379517 C430.315308,464.696716 429.971527,475.035126 430.046204,485.363190 C430.071198,488.817627 428.985992,490.534210 425.145325,490.442291 C408.307220,490.039520 411.204895,492.848450 410.942963,476.734924 C410.840088,470.406036 410.927368,464.074036 410.915314,457.280090 z" }),
                  /* @__PURE__ */ u.jsx("path", { fill: na.primary, d: "M556.799500,444.921539 C554.214233,445.227783 552.026184,445.174683 549.913574,445.548401 C542.544189,446.852142 538.560974,452.210632 538.387756,461.266998 C538.231995,469.411011 538.239258,477.561676 538.377136,485.705963 C538.433838,489.055634 537.355591,490.537964 533.812988,490.447296 C516.656677,490.008148 519.942505,492.939087 519.712585,476.823181 C519.510925,462.693848 519.801025,448.557343 519.590698,434.428253 C519.527222,430.165985 520.732788,428.169983 525.216187,428.665833 C527.350830,428.901917 529.549255,428.854156 531.692566,428.654297 C535.487610,428.300446 537.940002,429.350586 537.432373,434.447845 C542.475464,431.817810 546.689819,428.862549 551.859985,428.147003 C557.409912,427.378845 558.504028,428.019318 558.285950,433.612213 C558.141113,437.327057 559.514648,441.236115 556.799500,444.921539 z" })
                ] })
              ] })
            }
          ) }),
          /* @__PURE__ */ u.jsx("p", { className: "mt-6 md:mt-8 text-white/30 text-xs md:text-sm tracking-widest uppercase", children: "Where memories leave their trace" })
        ] })
      ]
    }
  );
}, $h = ({
  title: t,
  value: r,
  icon: a,
  subtext: l,
  highlight: s = !1
}) => /* @__PURE__ */ u.jsxs("div", { className: `flex-1 flex flex-col p-4 bg-card border border-border rounded-lg overflow-hidden relative transition-all duration-200 hover:shadow-md ${s ? "bg-primary-10 border-primary-30" : ""}`, children: [
  /* @__PURE__ */ u.jsxs("div", { className: "flex justify-between items-start mb-3", children: [
    /* @__PURE__ */ u.jsx("div", { className: `p-2 rounded-lg ${s ? "bg-primary-20 text-primary" : "bg-secondary text-secondary-foreground"}`, children: /* @__PURE__ */ u.jsx(a, { size: 20 }) }),
    s && /* @__PURE__ */ u.jsx("div", { className: "w-2 h-2 bg-green-500 rounded-full shadow-[0_0_8px_rgba(236,72,153,0.5)]" })
  ] }),
  /* @__PURE__ */ u.jsxs("div", { children: [
    /* @__PURE__ */ u.jsx("div", { className: "text-2xl font-bold text-foreground font-mono", children: r }),
    /* @__PURE__ */ u.jsx("div", { className: "text-[11px] text-muted-foreground font-semibold mt-1 tracking-[0.5px]", children: t }),
    l && /* @__PURE__ */ u.jsx("div", { className: "text-[10px] text-muted-foreground/70 mt-0.5", children: l })
  ] })
] });
async function Ly() {
  const { Logger: t } = await Promise.resolve().then(() => Pm);
  await t.init(), t.info("STBridge", "Engram ...");
  const { SettingsManager: r } = await Promise.resolve().then(() => Mb);
  r.initSettings(), t.info("STBridge", "SettingsManager initialized");
  try {
    const { checkTavernIntegration: l } = await Promise.resolve().then(() => Hx), s = await l();
    t.info("TavernAPI", "", s);
  } catch (l) {
    t.warn("TavernAPI", "", { error: String(l) });
  }
  try {
    const { summarizerService: l } = await Promise.resolve().then(() => ra);
    l.start();
    const s = l.getStatus();
    t.info("Summarizer", "", s);
  } catch (l) {
    t.warn("Summarizer", "", { error: String(l) });
  }
  G9();
  const { ThemeManager: a } = await Promise.resolve().then(() => Gc);
  a.init();
  try {
    const { injector: l } = await Promise.resolve().then(() => HC);
    l.init(), t.info("Injector", "Service initialized");
  } catch (l) {
    t.warn("Injector", "Failed to initialize Injector", { error: String(l) });
  }
  try {
    const { MacroService: l } = await Promise.resolve().then(() => n2);
    await l.init();
  } catch (l) {
    t.warn("MacroService", "Failed to initialize MacroService", { error: String(l) });
  }
  try {
    const { initQuickPanelButton: l } = await Promise.resolve().then(() => kC);
    l(), t.info("QuickPanelButton", "QR ");
  } catch (l) {
    t.warn("QuickPanelButton", "Failed to initialize QuickPanelButton", { error: String(l) });
  }
  Q9();
  try {
    const { CharacterDeleteService: l } = await Promise.resolve().then(() => FC);
    l.init(), t.info("STBridge", "CharacterDeleteService initialized");
  } catch (l) {
    t.warn("STBridge", "Failed to initialize CharacterDeleteService", { error: String(l) });
  }
  t.success("STBridge", "Engram  - Where memories leave their trace.");
}
const Px = '<svg viewBox="0 0 400 592" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M103.875908,522.166260 C75.225380,521.276611 55.289425,503.229828 52.249313,475.852142 C49.879883,454.514191 63.027035,433.000366 83.930901,424.858398 C88.449257,423.098541 89.857674,420.860199 89.801926,416.150269 C89.555420,395.322357 89.621246,374.489380 89.762306,353.659515 C89.787170,349.987000 88.728760,348.057556 85.120293,346.642609 C64.672897,338.625031 52.338894,320.951630 52.085896,299.869415 C51.832878,278.785156 63.730618,260.903198 84.118019,252.449951 C88.288918,250.720566 89.867378,248.680847 89.807304,244.052597 C89.539139,223.391968 89.589142,202.724701 89.796356,182.062561 C89.836380,178.071609 88.518524,176.326385 84.841705,174.787247 C57.730556,163.438416 45.530682,135.966721 55.436111,109.194000 C62.627293,89.757439 81.922821,76.710289 103.282494,76.841476 C124.355003,76.970901 143.082275,89.740875 149.993118,109.121849 C151.315979,112.831749 153.184799,113.869263 156.863403,113.853104 C186.192612,113.724319 215.522736,113.698357 244.851929,113.811600 C248.773117,113.826736 250.677307,112.652130 252.052902,108.765602 C259.013885,89.098465 278.589447,76.365829 300.503601,76.811897 C322.171844,77.252960 341.040283,91.132324 347.255371,111.201912 C356.569763,141.279358 340.344788,170.373184 309.893127,176.623123 C283.359375,182.068970 260.376740,167.450562 251.980011,145.670181 C250.492157,141.810806 248.818085,140.240295 244.552948,140.266785 C215.390915,140.447968 186.227219,140.357330 157.064072,140.375076 C154.628784,140.376556 151.855545,139.805771 151.141357,143.359161 C150.400787,147.043839 146.628937,150.064713 151.136917,154.478546 C184.592346,187.235229 217.778336,220.267349 250.982285,253.280014 C253.021469,255.307434 254.527191,255.254166 257.033264,254.047714 C276.199188,244.820953 294.752930,247.045853 310.978485,259.993408 C328.011017,273.584869 333.936798,292.106659 327.764038,313.282837 C321.779785,333.812378 307.254517,345.637268 286.367889,349.037231 C276.405396,350.658997 266.352570,349.443024 257.275055,344.363342 C254.265045,342.678986 252.301132,343.049744 249.903275,345.441406 C230.205368,365.088531 210.395386,384.623230 190.631638,404.204376 C177.732651,416.984222 164.859726,429.790344 151.962982,442.572388 C148.257980,446.244415 148.113403,452.901764 151.629196,456.671387 C152.707138,457.827148 154.029282,457.681976 155.328629,457.681946 C185.658203,457.681458 215.987854,457.631042 246.317261,457.695557 C249.355972,457.702026 250.687012,456.399414 251.717636,453.698944 C259.314423,433.793579 278.324493,420.868317 299.341309,421.146240 C320.526215,421.426361 339.575745,434.206421 346.686249,452.909271 C354.337341,473.034058 348.794159,495.642761 332.699371,509.956390 C307.061371,532.757202 263.380280,521.715210 251.978027,489.436371 C250.838303,486.209961 249.371201,484.953583 245.964813,484.962799 C216.302094,485.043304 186.639008,484.985840 156.976028,484.969330 C154.436981,484.967896 152.081528,484.923981 150.916916,488.054077 C142.892441,509.621246 126.842339,520.325989 103.875908,522.166260 M141.430466,266.110352 C145.394760,270.906738 148.503693,276.196198 150.388428,282.139069 C151.211502,284.734314 152.692291,285.770782 155.494156,285.760895 C179.139755,285.677429 202.787949,285.547394 226.430206,285.843811 C232.373352,285.918304 231.388184,281.058533 233.335602,278.254700 C235.007233,275.847992 233.916855,274.189880 232.000244,272.304352 C199.956863,240.780380 167.866821,209.301468 136.133682,177.467056 C131.183243,172.500824 127.483856,170.729507 121.013550,174.621368 C117.660522,176.638214 116.183739,178.155136 116.217278,182.042480 C116.398239,203.022598 116.444160,224.006012 116.243645,244.985474 C116.204666,249.064667 117.676285,250.918961 121.328865,252.228989 C128.972488,254.970444 135.505173,259.524170 141.430466,266.110352 M116.349434,377.499908 C116.351860,390.663696 116.870338,403.855377 116.161102,416.980713 C115.742699,424.723846 121.926743,423.801880 125.649162,426.262665 C129.080231,428.530792 130.798965,425.706268 132.741440,423.784821 C165.551407,391.329803 198.234940,358.745361 231.274231,326.525696 C235.764252,322.147095 232.377243,319.155212 231.599960,315.493317 C230.884583,312.123138 228.193359,312.382568 225.670288,312.382812 C202.675171,312.384949 179.679749,312.445435 156.685303,312.323212 C153.331955,312.305389 151.624329,313.386505 150.456299,316.584381 C145.119888,331.194611 135.004120,341.287384 120.496223,346.769958 C117.238434,348.001068 116.190170,349.706024 116.267418,353.006317 C116.450615,360.833862 116.340004,368.668243 116.349434,377.499908z"/></svg>';
function G9() {
  const t = document.querySelector("#top-settings-holder"), r = document.querySelector("#WI-SP-button");
  if (!t) {
    console.warn("[Engram] #top-settings-holder not found, fallback to floating orb"), V9();
    return;
  }
  const a = document.createElement("div");
  a.id = "engram-drawer", a.className = "drawer";
  const l = document.createElement("div");
  l.className = "drawer-toggle drawer-header";
  const s = document.createElement("div");
  s.id = "engram-drawer-icon", s.className = "drawer-icon fa-fw closedIcon", s.title = "Engram - ", s.setAttribute("data-i18n", "[title]Engram - Memory OS"), s.innerHTML = Px, s.addEventListener("click", id), l.appendChild(s), a.appendChild(l), r ? (t.insertBefore(a, r), console.log("[Engram] Top bar button injected before WI-SP-button")) : (t.appendChild(a), console.log("[Engram] Top bar button injected at end (WI-SP-button not found)"));
}
function V9() {
  const t = document.createElement("div");
  t.className = "fixed bottom-5 right-5 w-12 h-12 rounded-full cursor-pointer z-[9999] flex items-center justify-center transition-transform duration-200 bg-gradient-to-br from-orange-500 to-pink-500 shadow-[0_0_20px_rgba(249,115,22,0.5)] hover:scale-110 hover:shadow-[0_0_30px_rgba(249,115,22,0.7)] text-white", t.title = "Engram - ", t.innerHTML = Px, t.addEventListener("click", id), document.body.appendChild(t);
}
let ad = null;
function K9(t) {
  ad = t, ad = t;
}
let xm = null, By = null;
function Y9(t) {
  xm = t;
}
function Q9() {
  if (!xm) {
    console.warn("[Engram] Global renderer not ready");
    return;
  }
  const t = "engram-global-overlay";
  let r = document.getElementById(t);
  r || (r = document.createElement("div"), r.id = t, r.className = "pointer-events-none fixed inset-0 z-[11000]", document.body.appendChild(r)), By || (By = xm(r, () => {
  }), console.log("[Engram] Global overlay mounted"));
}
let Gh = !1, Zs = null, Yc = null;
function id() {
  Gh && Zs ? (Yc && (Yc.unmount(), Yc = null), Zs.remove(), Zs = null, Gh = !1) : (Zs = X9(), document.body.appendChild(Zs), Gh = !0);
}
function X9() {
  var r;
  const t = document.createElement("div");
  return t.className = "fixed inset-0 w-full h-full z-[10000] flex flex-col bg-background text-foreground overflow-hidden", t.style.backgroundColor = "var(--background)", t.style.color = "var(--foreground)", t.style.height = "100dvh", t.style.width = "100vw", t.style.top = "0", t.style.left = "0", t.id = "engram-panel-root", ad ? Yc = ad(t, id) : (t.innerHTML = `
            <div class="flex items-center justify-between p-4 border-b border-slate-400/20">
                <h2 class="m-0 text-lg text-slate-200 flex items-center gap-2"> Engram</h2>
                <button class="bg-transparent border-none text-slate-400 text-2xl cursor-pointer p-1 hover:text-slate-200">&times;</button>
            </div>
            <div class="flex-1 overflow-auto p-5">
                <p style="color: #94a3b8;">React </p>
            </div>
        `, (r = t.querySelector("button")) == null || r.addEventListener("click", id)), t;
}
async function W9(t, r) {
  try {
    const l = await new Function("path", "return import(path)")("/scripts/chats.js");
    l && typeof l.hideChatMessageRange == "function" ? (await l.hideChatMessageRange(t, r, !1), console.log(`[Engram] Hidden messages range: ${t}-${r}`)) : console.warn("[Engram] hideChatMessageRange not found in chats.js");
  } catch (a) {
    console.error("[Engram] Failed to hide messages:", a);
  }
}
async function Z9(t, r = "text", a = "") {
  return window.callPopup ? window.callPopup(t, r, a) : (console.warn("[Engram] callPopup not available"), Promise.resolve(r === "confirm" ? !0 : null));
}
const J9 = (t) => {
  switch (t) {
    case 0:
      return "text-muted-foreground";
    case 1:
      return "text-primary";
    case 2:
      return "text-green-400";
    case 3:
      return "text-yellow-400";
    case 4:
      return "text-red-400";
    default:
      return "text-primary";
  }
}, Iy = ({ onNavigate: t }) => {
  const [r, a] = U.useState([]), [l, s] = U.useState(Fa()), [c, d] = U.useState(0);
  U.useEffect(() => (a(W.getLogs().slice(0, 3)), W.subscribe((x) => {
    a((E) => [x, ...E].slice(0, 3));
  })), []), U.useEffect(() => {
    const v = setInterval(() => {
      d((x) => x + 1);
    }, 1e3);
    return () => clearInterval(v);
  }, []);
  const m = (v) => {
    const x = Math.floor(v / 3600), E = Math.floor(v % 3600 / 60), w = v % 60;
    return `${x.toString().padStart(2, "0")}:${E.toString().padStart(2, "0")}:${w.toString().padStart(2, "0")}`;
  }, g = (l == null ? void 0 : l.name2) || "Unknown", p = (v) => {
    t && t(v);
  };
  return /* @__PURE__ */ u.jsx("div", { className: "h-full overflow-y-auto p-6 [&::-webkit-scrollbar]:hidden", children: /* @__PURE__ */ u.jsxs("div", { className: "grid grid-cols-1 md:grid-cols-2 gap-4 max-w-[1000px] mx-auto", children: [
    /* @__PURE__ */ u.jsxs("div", { className: "grid grid-cols-1 md:grid-cols-3 gap-4 col-span-full", children: [
      /* @__PURE__ */ u.jsx(
        $h,
        {
          title: "ACTIVE MODEL",
          value: l ? "Connected" : "Offline",
          subtext: l ? `Chatting with ${g}` : "Waiting for connection...",
          icon: yb,
          highlight: !!l
        }
      ),
      /* @__PURE__ */ u.jsx(
        $h,
        {
          title: "MEMORY NODES",
          value: "0",
          subtext: "Graph Database",
          icon: hu
        }
      ),
      /* @__PURE__ */ u.jsx(
        $h,
        {
          title: "SYSTEM UPTIME",
          value: m(c),
          subtext: "Session Duration",
          icon: ud
        }
      )
    ] }),
    /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col bg-card border border-border rounded-lg overflow-hidden relative transition-all duration-200 hover:shadow-md", children: [
      /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-2 p-4 text-xs font-bold tracking-widest text-muted-foreground border-b border-border", children: [
        /* @__PURE__ */ u.jsx(Bi, { size: 16 }),
        /* @__PURE__ */ u.jsx("span", { children: "QUICK ACTIONS" })
      ] }),
      /* @__PURE__ */ u.jsxs("div", { className: "flex-1 grid grid-cols-4 gap-3 p-4", children: [
        /* @__PURE__ */ u.jsxs("button", { className: "flex flex-col items-center justify-center gap-2 p-3 bg-background border border-border rounded-xl cursor-pointer transition-all duration-200 text-muted-foreground hover:bg-accent hover:-translate-y-0.5 hover:text-accent-foreground", onClick: () => p("memory"), children: [
          /* @__PURE__ */ u.jsx("span", { className: "text-2xl", children: "" }),
          /* @__PURE__ */ u.jsx("span", { className: "text-xs font-medium", children: "Memory Stream" })
        ] }),
        /* @__PURE__ */ u.jsxs("button", { className: "flex flex-col items-center justify-center gap-2 p-3 bg-background border border-border rounded-xl cursor-pointer transition-all duration-200 text-muted-foreground hover:bg-accent hover:-translate-y-0.5 hover:text-accent-foreground", onClick: () => p("graph"), children: [
          /* @__PURE__ */ u.jsx("span", { className: "text-2xl", children: "" }),
          /* @__PURE__ */ u.jsx("span", { className: "text-xs font-medium", children: "Knowledge Graph" })
        ] }),
        /* @__PURE__ */ u.jsxs("button", { className: "flex flex-col items-center justify-center gap-2 p-3 bg-background border border-border rounded-xl cursor-pointer transition-all duration-200 text-muted-foreground hover:bg-accent hover:-translate-y-0.5 hover:text-accent-foreground", onClick: () => p("processing"), children: [
          /* @__PURE__ */ u.jsx("span", { className: "text-2xl", children: "" }),
          /* @__PURE__ */ u.jsx("span", { className: "text-xs font-medium", children: "Brain Console" })
        ] }),
        /* @__PURE__ */ u.jsxs("button", { className: "flex flex-col items-center justify-center gap-2 p-3 bg-background border border-border rounded-xl cursor-pointer transition-all duration-200 text-muted-foreground hover:bg-accent hover:-translate-y-0.5 hover:text-accent-foreground", onClick: () => p("settings"), children: [
          /* @__PURE__ */ u.jsx("span", { className: "text-2xl", children: "" }),
          /* @__PURE__ */ u.jsx("span", { className: "text-xs font-medium", children: "Settings" })
        ] })
      ] })
    ] }),
    /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col bg-card border border-border rounded-lg overflow-hidden relative transition-all duration-200 hover:shadow-md", children: [
      /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-2 p-4 text-xs font-bold tracking-widest text-muted-foreground border-b border-border", children: [
        /* @__PURE__ */ u.jsx(pu, { size: 16 }),
        /* @__PURE__ */ u.jsx("span", { children: "SYSTEM LOGS" }),
        /* @__PURE__ */ u.jsx("button", { className: "ml-auto text-[10px] text-primary bg-transparent border-none cursor-pointer opacity-80 hover:opacity-100 hover:underline", onClick: () => p("devlog"), children: "VIEW ALL" })
      ] }),
      /* @__PURE__ */ u.jsx("div", { className: "flex-1 p-3 font-mono text-[11px] bg-muted/20 overflow-hidden", children: r.length === 0 ? /* @__PURE__ */ u.jsx("div", { className: "text-muted-foreground text-center mt-5 italic", children: "No activity recorded" }) : r.map((v) => /* @__PURE__ */ u.jsxs("div", { className: `flex gap-2 mb-1.5 opacity-80 ${J9(v.level)}`, children: [
        /* @__PURE__ */ u.jsxs("span", { className: "text-muted-foreground", children: [
          "[",
          new Date(v.timestamp).toLocaleTimeString([], { hour12: !1 }),
          "]"
        ] }),
        /* @__PURE__ */ u.jsx("span", { className: "text-foreground flex-1 min-w-0 whitespace-nowrap overflow-hidden text-ellipsis", children: v.message })
      ] }, v.id)) })
    ] })
  ] }) });
}, eC = U.lazy(() => Promise.resolve().then(() => iE).then((t) => ({ default: t.DevLog }))), tC = U.lazy(() => Promise.resolve().then(() => EE).then((t) => ({ default: t.APIPresets }))), nC = U.lazy(() => Promise.resolve().then(() => NE).then((t) => ({ default: t.Settings }))), rC = U.lazy(() => Promise.resolve().then(() => LE).then((t) => ({ default: t.MemoryStream }))), aC = U.lazy(() => Promise.resolve().then(() => VE).then((t) => ({ default: t.ProcessingView }))), iC = () => /* @__PURE__ */ u.jsx("div", { className: "flex items-center justify-center h-full", children: /* @__PURE__ */ u.jsx("div", { className: "animate-spin h-8 w-8 border-2 border-primary border-t-transparent rounded-full" }) }), lC = ({ onClose: t }) => {
  const [r, a] = U.useState("dashboard"), [l, s] = U.useState(!1), [c, d] = U.useState(!1), m = (v) => {
    const x = v.replace(/^\//, "");
    console.debug("[Engram] Navigating to:", x), a(x);
  };
  U.useEffect(() => {
    const v = setTimeout(() => {
      const x = Ke.get("hasSeenWelcome");
      console.debug("[Engram] hasSeenWelcome:", x), x || s(!0), d(!0);
    }, 1e3);
    return () => clearTimeout(v);
  }, []);
  const g = () => {
    Ke.set("hasSeenWelcome", !0), console.debug("[Engram] hasSeenWelcome saved"), s(!1);
  };
  if (!c)
    return null;
  const p = () => {
    const [v, x] = r.split(":");
    switch (v) {
      case "dashboard":
        return /* @__PURE__ */ u.jsx(Iy, { onNavigate: a });
      case "presets":
        return /* @__PURE__ */ u.jsx(tC, { initialTab: x });
      case "devlog":
        return /* @__PURE__ */ u.jsx(eC, { initialTab: x });
      case "settings":
        return /* @__PURE__ */ u.jsx(nC, {});
      case "memory":
        return /* @__PURE__ */ u.jsx(rC, {});
      case "processing":
        return /* @__PURE__ */ u.jsx(aC, { onNavigate: a });
      default:
        return /* @__PURE__ */ u.jsx(Iy, {});
    }
  };
  return (
    /*  */
    /* @__PURE__ */ u.jsxs(u.Fragment, { children: [
      l && /* @__PURE__ */ u.jsx($9, { onComplete: g }),
      /* @__PURE__ */ u.jsx(F9, { activeTab: r, setActiveTab: m, onClose: t, children: /* @__PURE__ */ u.jsx(U.Suspense, { fallback: /* @__PURE__ */ u.jsx(iC, {}), children: p() }) })
    ] })
  );
}, Ur = {
  // 
  MESSAGE_SENT: "message_sent",
  MESSAGE_RECEIVED: "message_received",
  MESSAGE_EDITED: "message_edited",
  MESSAGE_DELETED: "message_deleted",
  MESSAGE_UPDATED: "message_updated",
  MESSAGE_SWIPED: "message_swiped",
  USER_MESSAGE_RENDERED: "user_message_rendered",
  CHARACTER_MESSAGE_RENDERED: "character_message_rendered",
  // 
  CHAT_CHANGED: "chat_id_changed",
  CHAT_CREATED: "chat_created",
  CHAT_DELETED: "chat_deleted",
  // 
  GENERATION_STARTED: "generation_started",
  GENERATION_STOPPED: "generation_stopped",
  GENERATION_ENDED: "generation_ended",
  GENERATION_AFTER_COMMANDS: "GENERATION_AFTER_COMMANDS",
  STREAM_TOKEN_RECEIVED: "stream_token_received",
  // V0.7: RAG  -  prompt await  handler 
  GENERATE_BEFORE_COMBINE_PROMPTS: "generate_before_combine_prompts",
  GENERATE_AFTER_COMBINE_PROMPTS: "generate_after_combine_prompts",
  GENERATE_AFTER_DATA: "generate_after_data",
  // V0.8: Chat Completion  ()
  CHAT_COMPLETION_PROMPT_READY: "chat_completion_prompt_ready",
  CHAT_COMPLETION_SETTINGS_READY: "chat_completion_settings_ready",
  // 
  WORLDINFO_UPDATED: "worldinfo_updated",
  WORLDINFO_SETTINGS_UPDATED: "worldinfo_settings_updated",
  WORLDINFO_ENTRIES_LOADED: "worldinfo_entries_loaded",
  WORLD_INFO_ACTIVATED: "world_info_activated",
  // 
  APP_READY: "app_ready",
  SETTINGS_LOADED: "settings_loaded",
  SETTINGS_LOADED_AFTER: "settings_loaded_after",
  EXTENSION_SETTINGS_LOADED: "extension_settings_loaded",
  // 
  CHARACTER_EDITED: "character_edited",
  CHARACTER_DELETED: "characterDeleted",
  // 
  ENGRAM_REQUEST_REVISION: "engram:request_revision"
};
function To() {
  try {
    const t = window.SillyTavern;
    if (t != null && t.getContext) {
      const r = t.getContext();
      return (r == null ? void 0 : r.eventSource) || null;
    }
    return null;
  } catch {
    return console.warn("[Engram] EventBus:  SillyTavern eventSource"), null;
  }
}
class Ar {
  /**
   * 
   * @param event 
   * @param callback 
   * @returns 
   */
  static on(r, a) {
    const l = To();
    return l && l.on(r, a), this.listeners.has(r) || this.listeners.set(r, /* @__PURE__ */ new Set()), this.listeners.get(r).add(a), () => {
      this.off(r, a);
    };
  }
  /**
   * 
   * @param event 
   * @param callback 
   */
  static once(r, a) {
    const l = To();
    if (l)
      l.once(r, a);
    else {
      const s = (...c) => {
        this.off(r, s), a(...c);
      };
      this.on(r, s);
    }
  }
  /**
   * 
   * @param event 
   * @param callback 
   */
  static off(r, a) {
    var s;
    const l = To();
    l && l.removeListener(r, a), (s = this.listeners.get(r)) == null || s.delete(a);
  }
  /**
   * 
   * @param event 
   * @param args 
   */
  static async emit(r, ...a) {
    const l = To();
    if (l)
      return l.emit(r, ...a);
  }
  /**
   * 
   * 
   */
  static clearAll() {
    const r = To();
    for (const [a, l] of this.listeners)
      for (const s of l)
        r && r.removeListener(a, s);
    this.listeners.clear();
  }
  /**
   *  EventBus 
   */
  static isAvailable() {
    return To() !== null;
  }
}
Xe(Ar, "listeners", /* @__PURE__ */ new Map());
const oC = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  EventBus: Ar,
  TavernEventType: Ur
}, Symbol.toStringTag, { value: "Module" }));
function sC(t, r) {
  let a = "assistant";
  return t.is_user ? a = "user" : t.is_system && (a = "system"), {
    id: r,
    role: a,
    content: t.mes || "",
    name: t.name || "",
    isHidden: t.is_hidden ?? !1,
    raw: t
  };
}
class qx {
  /**
   * 
   * @param options 
   */
  static getAllMessages(r = {}) {
    const a = Fa();
    if (!(a != null && a.chat))
      return [];
    let l = a.chat.map((s, c) => sC(s, c));
    if (r.includeHidden || (l = l.filter((s) => !s.isHidden)), r.role) {
      const s = Array.isArray(r.role) ? r.role : [r.role];
      l = l.filter((c) => s.includes(c.role));
    }
    return l;
  }
  /**
   *  N 
   * @param count 
   * @param options 
   */
  static getRecentMessages(r, a = {}) {
    return this.getAllMessages(a).slice(-r);
  }
  /**
   * 
   * @param start 
   * @param end 
   * @param options 
   */
  static getMessages(r, a, l = {}) {
    return this.getAllMessages(l).slice(r, a);
  }
  /**
   * 
   * @param options 
   */
  static getFloorCount(r = {}) {
    return this.getAllMessages(r).length;
  }
  /**
   * 
   * @param options 
   */
  static getLastMessage(r = {}) {
    const a = this.getAllMessages(r);
    return a.length > 0 ? a[a.length - 1] : null;
  }
  /**
   * 
   */
  static getCurrentCharacterName() {
    var a;
    const r = Fa();
    return !(r != null && r.characters) || r.characterId < 0 ? null : ((a = r.characters[r.characterId]) == null ? void 0 : a.name) || null;
  }
  /**
   *  LLM
   * @param messages 
   * @param format 
   */
  static formatMessagesAsText(r, a = "simple") {
    return a === "simple" ? r.map((l) => `${l.name}: ${l.content}`).join(`

`) : r.map((l) => `[${l.role.toUpperCase()}] ${l.name}:
${l.content}`).join(`

---

`);
  }
  /**
   *  MessageService 
   */
  static isAvailable() {
    return n6();
  }
}
const uC = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  MessageService: qx
}, Symbol.toStringTag, { value: "Module" }));
async function Uy(t) {
  try {
    const r = window.SillyTavern;
    if (r != null && r.getContext) {
      const a = r.getContext();
      if (a != null && a.getTokenCountAsync)
        return await a.getTokenCountAsync(t);
    }
    return Math.ceil(t.length / 4);
  } catch {
    return console.warn("[Engram] WorldInfoService:  Token "), Math.ceil(t.length / 4);
  }
}
function Jn() {
  try {
    return window.TavernHelper || null;
  } catch {
    return null;
  }
}
const lu = "engram";
class St {
  /**
   *  Token 
   * @param text 
   */
  static async countTokens(r) {
    return Uy(r);
  }
  /**
   *  Engram  Token 
   * 
   * @param worldbookName 
   */
  static async countSummaryTokens(r) {
    const l = (await this.getEntries(r)).filter(
      (d) => d.enabled && d.keys.includes(lu)
    );
    if (l.length === 0) return 0;
    const s = l.map((d) => d.content);
    return (await Promise.all(s.map((d) => this.countTokens(d)))).reduce((d, m) => d + m, 0);
  }
  /**
   *  Engram  {{engramSummaries}} 
   * 
   */
  static async getEngramSummariesContent() {
    const r = this.findExistingWorldbook();
    if (!r)
      return "";
    const l = (await this.getEntries(r)).filter((c) => c.keys.includes(lu));
    return l.length === 0 ? "" : (l.sort((c, d) => c.order - d.order), l.map((c) => {
      const d = c.content.replace(/\{\{\/\/.*?\}\}/gs, "").trim();
      return `${c.name}
${d}`;
    }).join(`

---

`));
  }
  /**
   *  Token 
   * @param texts 
   */
  static async countTokensBatch(r) {
    return Promise.all(r.map((a) => Uy(a)));
  }
  /**
   *  Engram 
   * 
   */
  static findExistingWorldbook() {
    try {
      const r = Jn();
      if (!(r != null && r.getCharWorldbookNames))
        return null;
      const a = r.getCharWorldbookNames("current");
      return a && [...a.additional || [], a.primary].filter(Boolean).find((c) => c == null ? void 0 : c.startsWith("[Engram]")) || null;
    } catch {
      return null;
    }
  }
  /**
   *  Engram 
   * 
   * ****
   * 
   *  the_world 
   * 1. TavernHelper.createWorldbook() 
   * 2. TavernHelper.getCharWorldbookNames() 
   * 3. TavernHelper.rebindCharWorldbooks() 
   */
  static async getOrCreateWorldbook() {
    var r, a;
    try {
      const l = this.findExistingWorldbook();
      if (l)
        return console.debug("[Engram] WorldInfoService: ", l), l;
      const s = Jn();
      if (!s)
        return console.warn("[Engram] WorldInfoService: TavernHelper "), null;
      const c = (a = (r = window.SillyTavern) == null ? void 0 : r.getContext) == null ? void 0 : a.call(r);
      if (!(c != null && c.name2) || c.name2 === "SillyTavern System")
        return console.warn("[Engram] WorldInfoService: "), null;
      const d = c.name2, m = `[Engram] ${d}`;
      if (console.debug("[Engram] WorldInfoService: ", m), s.createWorldbook)
        await s.createWorldbook(m);
      else
        return console.error("[Engram] WorldInfoService: TavernHelper.createWorldbook "), null;
      if (s.getCharWorldbookNames && s.rebindCharWorldbooks) {
        const g = s.getCharWorldbookNames("current");
        g && (g.additional.push(m), await s.rebindCharWorldbooks("current", g), console.info("[Engram] WorldInfoService: ", {
          character: d,
          worldbook: m
        }));
      }
      return m;
    } catch (l) {
      return console.error("[Engram] WorldInfoService: /", l), null;
    }
  }
  /**
   * @deprecated  getOrCreateWorldbook() 
   */
  static async getChatWorldbook() {
    return this.getOrCreateWorldbook();
  }
  /**
   * 
   * @param worldbookName 
   */
  static async getEntries(r) {
    const a = Jn();
    if (!(a != null && a.getWorldbook))
      return console.warn("[Engram] WorldInfoService: TavernHelper "), [];
    try {
      return (await a.getWorldbook(r)).map((s) => {
        const c = s, d = c.strategy, m = c.position, g = c.recursion, p = [];
        if (d != null && d.keys && Array.isArray(d.keys))
          for (const v of d.keys)
            typeof v == "string" ? p.push(v) : v && typeof v == "object" && "source" in v && p.push(v.source);
        return {
          uid: c.uid || 0,
          name: c.name || "",
          content: c.content || "",
          enabled: c.enabled ?? !0,
          constant: (d == null ? void 0 : d.type) === "constant",
          keys: p,
          position: (m == null ? void 0 : m.type) || "before_character_definition",
          depth: (m == null ? void 0 : m.depth) || 0,
          order: (m == null ? void 0 : m.order) || 100,
          recursion: g ? {
            prevent_incoming: g.prevent_incoming,
            prevent_outgoing: g.prevent_outgoing
          } : void 0,
          comment: c.comment || "",
          extra: c.extra || void 0
        };
      });
    } catch (l) {
      return console.error("[Engram] WorldInfoService: ", l), [];
    }
  }
  /**
   * 
   */
  static async getWorldbookNames() {
    const r = Jn();
    try {
      return r != null && r.getWorldbookNames ? r.getWorldbookNames() : [];
    } catch (a) {
      return console.error("[Engram] WorldInfoService: ", a), [];
    }
  }
  /**
   * 
   * @param worldbookName 
   */
  static async deleteWorldbook(r) {
    const a = Jn();
    if (!(a != null && a.deleteWorldbook))
      return console.warn("[Engram] WorldInfoService: TavernHelper.deleteWorldbook "), !1;
    try {
      const l = await a.deleteWorldbook(r);
      return l && console.info("[Engram] WorldInfoService: ", r), l;
    } catch (l) {
      return console.error("[Engram] WorldInfoService: ", l), !1;
    }
  }
  /**
   * 
   *  TavernHelper API the_world 
   * @param worldbookName 
   * @param params 
   */
  static async createEntry(r, a) {
    try {
      const l = Jn();
      if (!(l != null && l.createWorldbookEntries))
        return console.error("[Engram] WorldInfoService: TavernHelper.createWorldbookEntries "), !1;
      const s = {
        name: a.name,
        content: a.content,
        comment: a.name,
        // 
        disable: !(a.enabled ?? !0),
        // TavernHelper  disable 
        strategy: {
          type: a.constant ? "constant" : "selective",
          keys: a.keys || []
        },
        position: {
          type: a.position || "before_character_definition",
          order: a.order ?? 100,
          depth: a.depth ?? 4
        },
        recursion: a.recursion,
        //  Engram 
        extra: {
          engram: !0
        }
      };
      return console.debug("[Engram] WorldInfoService: ", {
        worldbook: r,
        name: a.name,
        contentLength: a.content.length
      }), await l.createWorldbookEntries(r, [s]), console.info("[Engram] WorldInfoService: ", r), !0;
    } catch (l) {
      return console.error("[Engram] WorldInfoService: ", l), !1;
    }
  }
  /**
   * 
   * @param worldbookName 
   * @param uid  UID
   * @param updates 
   */
  /**
   * 
   *  updateWorldbookWith 
   * @param worldbookName 
   * @param uid  UID
   * @param updates 
   */
  static async updateEntry(r, a, l) {
    const s = Jn();
    if (!(s != null && s.updateWorldbookWith))
      return console.warn("[Engram] WorldInfoService: TavernHelper.updateWorldbookWith "), !1;
    try {
      return await s.updateWorldbookWith(r, (c) => {
        var m;
        const d = c.findIndex((g) => g.uid === a);
        if (d !== -1) {
          const g = c[d];
          let p = g.disable;
          "enabled" in l && (p = !l.enabled);
          let v = g.strategy || { type: "selective", keys: [] };
          if ("constant" in l || "keys" in l) {
            const w = l.constant !== void 0 ? l.constant : v.type === "constant", _ = l.keys !== void 0 ? l.keys : v.keys || [];
            v = {
              ...v,
              type: w ? "constant" : "selective",
              keys: _
            };
          }
          let x = g.position || { type: "before_character_definition", order: 0, depth: 0 };
          (l.position || typeof l.order == "number" || typeof l.depth == "number") && (x = {
            ...x,
            type: (typeof l.position == "string" ? l.position : (m = l.position) == null ? void 0 : m.type) || x.type,
            order: l.order ?? x.order,
            depth: l.depth ?? x.depth
          });
          let E = g.recursion;
          l.recursion && (E = l.recursion), c[d] = {
            ...g,
            name: l.name ?? g.name,
            content: l.content ?? g.content,
            comment: l.name ?? g.comment,
            // 
            disable: p,
            strategy: v,
            position: x,
            recursion: E
          }, console.debug("[Engram] WorldInfoService:  (In-Place)", { uid: a, name: c[d].name });
        } else
          console.warn("[Engram] WorldInfoService: updateEntry ", a);
        return c;
      }), !0;
    } catch (c) {
      return console.error("[Engram] WorldInfoService: ", c), !1;
    }
  }
  /**
   * 
   * @param worldbookName 
   * @param uid  UID
   */
  static async deleteEntry(r, a) {
    const l = Jn();
    if (!(l != null && l.deleteWorldbookEntries))
      return console.warn("[Engram] WorldInfoService: TavernHelper.deleteWorldbookEntries "), !1;
    try {
      return await l.deleteWorldbookEntries(r, (s) => s.uid === a), console.debug("[Engram] WorldInfoService: ", { worldbook: r, uid: a }), !0;
    } catch (s) {
      return console.error("[Engram] WorldInfoService: ", s), !1;
    }
  }
  /**
   * 
   * @param worldbookName 
   * @param uids  UID 
   */
  static async deleteEntries(r, a) {
    const l = Jn();
    if (!(l != null && l.deleteWorldbookEntries))
      return console.warn("[Engram] WorldInfoService: TavernHelper.deleteWorldbookEntries "), !1;
    try {
      const s = new Set(a);
      return await l.deleteWorldbookEntries(r, (c) => s.has(c.uid)), console.debug("[Engram] WorldInfoService: ", { worldbook: r, count: a.length }), !0;
    } catch (s) {
      return console.error("[Engram] WorldInfoService: ", s), !1;
    }
  }
  /**
   *  Engram  order 
   * 
   * @param worldbookName 
   */
  static async getSummaryEntries(r) {
    const l = (await this.getEntries(r)).filter((s) => s.keys.includes(lu));
    return l.sort((s, c) => s.order - c.order), l;
  }
  /**
   * 
   * @param entryName  "_1-10"
   * @returns [startFloor, endFloor]  null
   */
  static parseFloorRangeFromName(r) {
    const a = r.match(/_(\d+)-(\d+)/);
    return a ? [parseInt(a[1], 10), parseInt(a[2], 10)] : null;
  }
  /**
   * 
   * 8999:  <summary>
   * 10000:  </summary>
   */
  static async ensureSeparatorEntries(r) {
    await this.findEntryByKey(r, "") || await this.createEntry(r, {
      name: "",
      content: "<summary>",
      keys: [""],
      constant: !0,
      order: 8999,
      enabled: !0,
      position: "before_character_definition"
    }), await this.findEntryByKey(r, "") || await this.createEntry(r, {
      name: "",
      content: "</summary>",
      keys: [""],
      constant: !0,
      order: 1e4,
      enabled: !0,
      position: "before_character_definition"
    });
  }
  /**
   * 
   *  9000
   */
  static async getNextSummaryOrder(r) {
    const l = (await this.getEntries(r)).map((c) => c.order).filter((c) => c >= 9e3 && c < 1e4);
    return l.length === 0 ? 9e3 : Math.max(...l) + 1;
  }
  /**
   *  Key 
   * @param worldbookName 
   * @param key 
   */
  static async findEntryByKey(r, a) {
    const l = await this.getEntries(r);
    let s = l.find((c) => c.keys.includes(a));
    return s || (s = l.find((c) => c.name === a || a === "__ENGRAM_STATE__" && c.name === "Engram System State")), s || null;
  }
  /**
   *  Token 
   * @param worldbookName 
   */
  static async getWorldbookTokenStats(r) {
    const a = await this.getEntries(r), l = await Promise.all(
      a.map(async (c) => ({
        name: c.name,
        tokens: await this.countTokens(c.content)
      }))
    );
    return {
      totalTokens: l.reduce((c, d) => c + d.tokens, 0),
      entryCount: a.length,
      entries: l
    };
  }
  /**
   *  WorldInfoService 
   */
  static isAvailable() {
    return Jn() !== null;
  }
  /**
   *  Token  API
   */
  static async isNativeTokenCountAvailable() {
    try {
      const r = window.SillyTavern;
      if (r != null && r.getContext) {
        const a = r.getContext();
        return typeof (a == null ? void 0 : a.getTokenCountAsync) == "function";
      }
      return !1;
    } catch {
      return !1;
    }
  }
  /**
   * 
   *  getWorldInfoPrompt 
   * + 
   * 
   * @param chatMessages 
   * @returns 
   */
  static async getActivatedWorldInfo(r) {
    var l, s, c;
    const { Logger: a } = await Promise.resolve().then(() => Pm);
    try {
      const m = await new Function("path", "return import(path)")("/scripts/world-info.js"), g = m == null ? void 0 : m.getWorldInfoPrompt, p = m == null ? void 0 : m.getSortedEntries;
      if (typeof p == "function") {
        const V = await p(), we = [...new Set((V == null ? void 0 : V.map((X) => X.world)) || [])], Te = ((l = V == null ? void 0 : V.filter((X) => X.constant)) == null ? void 0 : l.length) || 0;
        a.info("WorldInfo", "getSortedEntries ", {
          totalEntries: (V == null ? void 0 : V.length) || 0,
          worlds: we,
          constantCount: Te,
          sampleEntry: V != null && V[0] ? {
            name: V[0].name,
            world: V[0].world,
            constant: V[0].constant
          } : null
        });
      }
      if (typeof g != "function")
        return a.warn("WorldInfo", "getWorldInfoPrompt "), this.getConstantWorldInfo();
      let v = r;
      if (!v || v.length === 0) {
        const V = (c = (s = window.SillyTavern) == null ? void 0 : s.getContext) == null ? void 0 : c.call(s);
        V != null && V.chat && Array.isArray(V.chat) && (v = V.chat.map((we) => we.mes || "").reverse());
      }
      if (!v || v.length === 0)
        return a.warn("WorldInfo", ""), this.getConstantWorldInfo();
      a.debug("WorldInfo", " getWorldInfoPrompt", {
        messageCount: v.length
      });
      const x = 1e6, E = m == null ? void 0 : m.checkWorldInfo;
      if (typeof E != "function")
        return a.error("WorldInfo", "checkWorldInfo "), this.getConstantWorldInfo();
      const w = await E(v, x, !0, {
        trigger: "normal"
      }), _ = w == null ? void 0 : w.allActivatedEntries, A = _ ? Array.from(_.values()) : [];
      a.info("WorldInfo", ` ${A.length} `);
      const D = await this.loadFilteringState(), { disabledGlobalBooks: R, disabledEntries: Z, globalWorldbooks: K, config: ge } = D, de = A.filter(
        (V) => this.shouldIncludeEntry(V, K, R, Z, ge)
      );
      return a.info("WorldInfo", "", {
        total: A.length,
        kept: de.length,
        filteredOut: A.length - de.length,
        keptWorlds: [...new Set(de.map((V) => V.world))]
      }), de.sort((V, we) => (V.order || 0) - (we.order || 0)), de.map((V) => V.content).filter(Boolean).join(`

`);
    } catch (d) {
      return a.error("WorldInfo", "", d), this.getConstantWorldInfo();
    }
  }
  /**
   * 
   * @private
   */
  static async loadFilteringState() {
    var v, x, E;
    const r = Jn(), a = ((v = r == null ? void 0 : r.getGlobalWorldbookNames) == null ? void 0 : v.call(r)) || [], { SettingsManager: l } = await Promise.resolve().then(() => Mb), c = (x = l.getSettings().apiSettings) == null ? void 0 : x.worldbookConfig, d = (c == null ? void 0 : c.disabledWorldbooks) || [], { WorldBookStateService: m } = await Promise.resolve().then(() => xC), g = (E = r == null ? void 0 : r.getCharWorldbookNames) == null ? void 0 : E.call(r, "current");
    let p = {};
    return g != null && g.primary && (p = (await m.loadState(g.primary)).disabledEntries || {}), {
      globalWorldbooks: a,
      disabledGlobalBooks: d,
      disabledEntries: p,
      config: c
    };
  }
  /**
   * 
   * @private
   */
  static shouldIncludeEntry(r, a, l, s, c) {
    var d, m, g, p;
    if (((d = r.extra) == null ? void 0 : d.engram) === !0 || (m = r.world) != null && m.startsWith("[Engram]")) return !0;
    if (r.world && a.includes(r.world) && ((c == null ? void 0 : c.includeGlobal) === !1 || l.includes(r.world)))
      return !1;
    if (r.world && r.uid) {
      const v = s[r.world];
      if (v && v.includes(r.uid))
        return !1;
    }
    return !((g = r.world) != null && g.startsWith("") || (p = r.world) != null && p.startsWith("---"));
  }
  /**
   *  UI 
   * 
   */
  static async getWorldbookStructure() {
    var d;
    const r = Jn();
    if (!r) return {};
    const a = ((d = r.getGlobalWorldbookNames) == null ? void 0 : d.call(r)) || [];
    let l = [];
    if (r.getCharWorldbookNames) {
      const m = r.getCharWorldbookNames("current");
      m && (l = [...m.additional || [], m.primary].filter(Boolean));
    }
    const s = Array.from(/* @__PURE__ */ new Set([...a, ...l])).sort(), c = {};
    for (const m of s)
      try {
        const g = await this.getEntries(m);
        c[m] = g.map((p) => {
          var v;
          return {
            uid: p.uid,
            name: p.name,
            // 
            keys: p.keys,
            constant: p.constant,
            // 
            comment: p.comment || "",
            content: ((v = p.content) == null ? void 0 : v.substring(0, 50)) + "..."
            // 
          };
        });
      } catch (g) {
        console.warn(`[Engram] WorldInfoService:  ${m} `, g), c[m] = [];
      }
    return c;
  }
  /**
   * 
   *  getActivatedWorldInfo 
   */
  static async getConstantWorldInfo() {
    try {
      const a = await new Function("path", "return import(path)")("/scripts/world-info.js"), l = a == null ? void 0 : a.getSortedEntries;
      if (typeof l != "function")
        return "";
      const s = await l();
      if (!s || !Array.isArray(s))
        return "";
      const c = s.filter((d) => d.constant === !0 && d.disable !== !0 && d.content);
      return c.length === 0 ? "" : (console.debug(`[Engram] WorldInfoService:  ${c.length} `), c.map((d) => d.content).join(`

`));
    } catch {
      return "";
    }
  }
}
const cC = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  SUMMARY_ENTRY_KEY: lu,
  WorldInfoService: St,
  getTavernHelper: Jn
}, Symbol.toStringTag, { value: "Module" }));
async function dC() {
  const { EventBus: t } = await Promise.resolve().then(() => oC), { MessageService: r } = await Promise.resolve().then(() => uC), { WorldInfoService: a } = await Promise.resolve().then(() => cC);
  return {
    eventBus: t.isAvailable(),
    messageService: r.isAvailable(),
    worldInfoService: a.isAvailable(),
    nativeTokenCount: await a.isNativeTokenCountAvailable(),
    floorCount: r.isAvailable() ? r.getFloorCount() : null,
    characterName: r.isAvailable() ? r.getCurrentCharacterName() : null
  };
}
const Hx = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  EventBus: Ar,
  MessageService: qx,
  TavernEventType: Ur,
  WorldInfoService: St,
  checkTavernIntegration: dC
}, Symbol.toStringTag, { value: "Module" })), fC = () => {
  const [t, r] = U.useState(!1), [a, l] = U.useState(null), [s, c] = U.useState("");
  U.useEffect(() => {
    const g = Ar.on(
      Ur.ENGRAM_REQUEST_REVISION,
      (p) => {
        const v = p;
        l(v), c(v.content), r(!0);
      }
    );
    return () => {
      g();
    };
  }, []);
  const d = () => {
    a && (a.onConfirm(s), r(!1), l(null));
  }, m = () => {
    a && a.onCancel(), r(!1), l(null);
  };
  return t ? Bm.createPortal(
    /* @__PURE__ */ u.jsxs(
      "div",
      {
        className: "fixed inset-0 z-[11000] flex items-center justify-center p-4",
        style: { height: "100dvh", width: "100vw" },
        children: [
          /* @__PURE__ */ u.jsx(
            "div",
            {
              className: "absolute inset-0 bg-background/80 backdrop-blur-sm animate-in fade-in duration-200",
              onClick: m
            }
          ),
          /* @__PURE__ */ u.jsxs("div", { className: "relative w-full max-w-2xl bg-popover border border-border rounded-lg shadow-2xl flex flex-col max-h-[85vh] animate-in zoom-in-95 slide-in-from-bottom-2 duration-200", children: [
            /* @__PURE__ */ u.jsxs("div", { className: "flex items-start justify-between p-5 border-b border-border", children: [
              /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col gap-1", children: [
                /* @__PURE__ */ u.jsx("h3", { className: "text-lg font-medium text-foreground tracking-tight", children: (a == null ? void 0 : a.title) || "" }),
                (a == null ? void 0 : a.description) && /* @__PURE__ */ u.jsx("p", { className: "text-sm text-muted-foreground", children: a.description })
              ] }),
              /* @__PURE__ */ u.jsx(
                "button",
                {
                  onClick: m,
                  className: "p-2 -m-2 text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors",
                  "aria-label": "",
                  children: /* @__PURE__ */ u.jsx(Uo, { size: 18 })
                }
              )
            ] }),
            /* @__PURE__ */ u.jsxs("div", { className: "flex-1 p-5 overflow-hidden flex flex-col gap-4", children: [
              /* @__PURE__ */ u.jsxs("div", { className: "flex items-start gap-3 p-3 bg-primary/10 border border-primary/20 rounded-md", children: [
                /* @__PURE__ */ u.jsx(bb, { size: 16, className: "text-primary shrink-0 mt-0.5" }),
                /* @__PURE__ */ u.jsx("p", { className: "text-sm text-foreground/80 leading-relaxed", children: "" })
              ] }),
              /* @__PURE__ */ u.jsx(
                "textarea",
                {
                  value: s,
                  onChange: (g) => c(g.target.value),
                  className: "flex-1 w-full min-h-[200px] p-4 bg-muted border border-border rounded-md font-mono text-sm text-foreground leading-relaxed placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring resize-none",
                  spellCheck: !1,
                  placeholder: "..."
                }
              ),
              /* @__PURE__ */ u.jsxs("div", { className: "text-xs text-muted-foreground text-right font-mono", children: [
                s.length,
                " "
              ] })
            ] }),
            /* @__PURE__ */ u.jsxs("div", { className: "flex items-center justify-end gap-3 px-5 py-4 border-t border-border bg-muted/30", children: [
              /* @__PURE__ */ u.jsx(
                "button",
                {
                  onClick: m,
                  className: "px-4 py-2 text-sm font-medium text-muted-foreground hover:text-foreground border border-border rounded-lg hover:bg-accent transition-colors",
                  children: ""
                }
              ),
              /* @__PURE__ */ u.jsxs(
                "button",
                {
                  onClick: d,
                  className: "inline-flex items-center gap-2 px-4 py-2 text-sm font-medium rounded-lg transition-all duration-200 bg-primary/20 text-primary border border-primary/50 shadow-[0_0_10px_rgba(var(--primary),0.2)] hover:bg-primary/30 hover:shadow-[0_0_15px_rgba(var(--primary),0.4)] focus:outline-none focus:ring-2 focus:ring-primary/50",
                  children: [
                    /* @__PURE__ */ u.jsx(Mm, { size: 16 }),
                    ""
                  ]
                }
              )
            ] })
          ] })
        ]
      }
    ),
    document.body
  ) : null;
}, hC = ({
  isOpen: t,
  onClose: r,
  title: a,
  children: l,
  initialPosition: s,
  width: c = 320,
  minWidth: d = 280,
  maxWidth: m = 600,
  minHeight: g = 150,
  resizable: p = !0
}) => {
  const v = U.useRef(null), [x, E] = U.useState(s || { x: 100, y: 100 }), [w, _] = U.useState({ width: c, height: "auto" }), [A, D] = U.useState(!1), [R, Z] = U.useState(!1), K = U.useRef({ x: 0, y: 0 }), ge = U.useRef({ width: 0, height: 0, x: 0, y: 0 });
  U.useEffect(() => {
    t && !s && E({
      x: Math.max(50, (window.innerWidth - c) / 2),
      y: Math.max(50, window.innerHeight - 450)
    });
  }, [t, s, c]);
  const de = U.useCallback((Te) => {
    if (!v.current) return;
    const X = v.current.getBoundingClientRect();
    K.current = {
      x: Te.clientX - X.left,
      y: Te.clientY - X.top
    }, D(!0);
  }, []), I = U.useCallback((Te) => {
    if (A) {
      const X = Math.max(0, Math.min(window.innerWidth - (typeof w.width == "number" ? w.width : 300), Te.clientX - K.current.x)), oe = Math.max(0, Math.min(window.innerHeight - 100, Te.clientY - K.current.y));
      E({ x: X, y: oe });
    } else if (R && v.current) {
      const X = Te.clientX - ge.current.x, oe = Te.clientY - ge.current.y, se = Math.max(d, Math.min(m, ge.current.width + X)), Re = Math.max(g, ge.current.height + oe);
      _({ width: se, height: Re });
    }
  }, [A, R, w.width, d, m, g]), V = U.useCallback(() => {
    D(!1), Z(!1);
  }, []), we = U.useCallback((Te) => {
    if (Te.preventDefault(), Te.stopPropagation(), !v.current) return;
    const X = v.current.getBoundingClientRect();
    ge.current = {
      width: X.width,
      height: X.height,
      x: Te.clientX,
      y: Te.clientY
    }, Z(!0);
  }, []);
  return U.useEffect(() => {
    if (A || R)
      return window.addEventListener("mousemove", I), window.addEventListener("mouseup", V), () => {
        window.removeEventListener("mousemove", I), window.removeEventListener("mouseup", V);
      };
  }, [A, R, I, V]), t ? Bm.createPortal(
    /* @__PURE__ */ u.jsxs(
      "div",
      {
        ref: v,
        className: "fixed z-[11000] flex flex-col rounded-lg shadow-2xl border border-border overflow-hidden",
        style: {
          left: x.x,
          top: x.y,
          width: w.width,
          height: w.height === "auto" ? "auto" : w.height,
          minHeight: g,
          backgroundColor: "var(--popover, #1a1a2e)",
          backdropFilter: "blur(20px)",
          WebkitBackdropFilter: "blur(20px)"
        },
        children: [
          /* @__PURE__ */ u.jsxs(
            "div",
            {
              className: "flex items-center justify-between px-3 py-2 border-b border-border select-none",
              onMouseDown: de,
              style: {
                cursor: A ? "grabbing" : "grab",
                backgroundColor: "var(--surface, rgba(255,255,255,0.05))"
              },
              children: [
                /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-2", children: [
                  /* @__PURE__ */ u.jsx(I4, { size: 14, className: "text-muted-foreground" }),
                  /* @__PURE__ */ u.jsx("span", { className: "text-sm font-medium text-foreground", children: a })
                ] }),
                /* @__PURE__ */ u.jsx(
                  "button",
                  {
                    onClick: r,
                    className: "p-1 text-muted-foreground hover:text-foreground rounded transition-colors",
                    style: { backgroundColor: "transparent" },
                    "aria-label": "",
                    onMouseDown: (Te) => Te.stopPropagation(),
                    children: /* @__PURE__ */ u.jsx(Uo, { size: 14 })
                  }
                )
              ]
            }
          ),
          /* @__PURE__ */ u.jsx("div", { className: "flex-1 overflow-auto p-3", children: l }),
          p && /* @__PURE__ */ u.jsx(
            "div",
            {
              className: "absolute bottom-0 right-0 w-4 h-4 cursor-se-resize",
              onMouseDown: we,
              style: {
                background: "linear-gradient(135deg, transparent 50%, var(--border, #333) 50%)"
              }
            }
          )
        ]
      }
    ),
    document.body
  ) : null;
}, On = ({
  checked: t,
  onChange: r,
  disabled: a = !1,
  className: l = "",
  id: s
}) => {
  const c = (d) => {
    a || (d.stopPropagation(), r(!t));
  };
  return /* @__PURE__ */ u.jsx(
    "button",
    {
      type: "button",
      role: "switch",
      id: s,
      "aria-checked": t,
      onClick: c,
      disabled: a,
      className: `
                relative inline-flex h-3.5 w-9 shrink-0 cursor-pointer items-center rounded-full border transition-all duration-300 focus:outline-none
                ${t ? "bg-primary/20 border-primary/50 shadow-[0_0_10px_rgba(var(--primary),0.2)]" : "bg-black/20 border-border shadow-inner"}
                ${a ? "opacity-50 cursor-not-allowed" : ""}
                ${l}
            `,
      children: /* @__PURE__ */ u.jsx(
        "span",
        {
          className: `
                    pointer-events-none inline-block h-2.5 w-2.5 transform rounded-full shadow-sm ring-0 transition-all duration-300 cubic-bezier(0.34, 1.56, 0.64, 1)
                    ${t ? "bg-primary shadow-[0_0_8px_rgba(var(--primary),0.8)] border border-primary-foreground/20" : "bg-muted-foreground border border-transparent opacity-60"}
                `,
          style: { transform: t ? "translateX(24px)" : "translateX(2px)" }
        }
      )
    }
  );
};
function Py() {
  try {
    return window.TavernHelper || null;
  } catch {
    return null;
  }
}
function mC() {
  var t, r, a, l;
  try {
    const s = (r = (t = window.SillyTavern) == null ? void 0 : t.getContext) == null ? void 0 : r.call(t);
    return ((l = (a = s == null ? void 0 : s.extensionSettings) == null ? void 0 : a.connectionManager) == null ? void 0 : l.profiles) || [];
  } catch {
    return [];
  }
}
class Fx {
  /**
   *  LLM 
   * @param request 
   */
  async generate(r) {
    var l, s, c, d;
    const a = Py();
    if (!(a != null && a.generateRaw) && !(a != null && a.generate))
      return {
        success: !1,
        content: "",
        error: "TavernHelper "
      };
    try {
      let m;
      const g = Ke.getSettings();
      let p;
      r.presetId && (p = (s = (l = g.apiSettings) == null ? void 0 : l.llmPresets) == null ? void 0 : s.find((K) => K.id === r.presetId)), !p && ((c = g.apiSettings) != null && c.selectedPresetId) && (p = (d = g.apiSettings.llmPresets) == null ? void 0 : d.find((K) => K.id === g.apiSettings.selectedPresetId));
      let v;
      if (p && p.source !== "tavern") {
        if (v = {}, W.info("LLMAdapter", `: ${p.name} (${p.source})`), p.parameters && (v = {
          ...v,
          //  ST API 
          temperature: p.parameters.temperature,
          max_tokens: p.parameters.maxTokens,
          // ST API  max_tokens
          top_p: p.parameters.topP,
          frequency_penalty: p.parameters.frequencyPenalty,
          presence_penalty: p.parameters.presencePenalty
          //  rep_pen  frequency_penalty 
          // rep_pen: preset.parameters.frequencyPenalty,
        }), p.source === "custom" && p.custom)
          v.apiurl = p.custom.apiUrl, v.key = p.custom.apiKey, v.model = p.custom.model, v.source = p.custom.apiSource || "openai";
        else if (p.source === "tavern_profile" && p.tavernProfileId) {
          const ge = mC().find((de) => de.id === p.tavernProfileId);
          ge ? (W.info("LLMAdapter", ` Profile: ${ge.name}`), v.model = ge.model, v.source = ge.api, ge["api-url"] ? v.apiurl = ge["api-url"] : ge.request_url ? v.apiurl = ge.request_url : ge.openai_url && (v.apiurl = ge.openai_url), ge.key ? v.key = ge.key : ge.request_apikey ? v.key = ge.request_apikey : ge.openai_key && (v.key = ge.openai_key)) : (W.warn("LLMAdapter", ` ID  ${p.tavernProfileId} `), v = void 0);
        }
      }
      const x = r.systemPrompt ? `${r.systemPrompt}

${r.userPrompt}` : r.userPrompt, E = {
        prompt: x,
        // 
        body: {
          messages: [
            { role: "system", content: r.systemPrompt },
            { role: "user", content: r.userPrompt }
          ]
        },
        // 
        is_engram: !0
        //  ()
      }, { EventBus: w, TavernEventType: _ } = await Promise.resolve().then(() => Hx);
      await w.emit(_.GENERATION_AFTER_COMMANDS, "engram", {}, !1), await w.emit(_.GENERATE_AFTER_DATA, E);
      const A = typeof E.prompt == "string" ? E.prompt : x;
      let D = r.systemPrompt, R = r.userPrompt;
      A !== x && (D = "", R = A);
      const { regexProcessor: Z } = await Promise.resolve().then(() => pC);
      if (R = Z.process(R, "input"), a.generateRaw) {
        const K = [];
        D && K.push({ role: "system", content: D }), K.push({ role: "user", content: R }), m = await a.generateRaw({
          ordered_prompts: K,
          custom_api: v
          // V0.8.6 Fix
        });
      } else if (a.generate)
        m = await a.generate({
          user_input: R,
          system_prompt: D,
          should_stream: !1,
          max_chat_history: 0,
          custom_api: v
          // V0.8.6 Fix
        });
      else
        throw new Error(" API");
      return {
        success: !0,
        content: m || ""
      };
    } catch (m) {
      const g = m instanceof Error ? m.message : String(m);
      return console.error("[Engram] LLMAdapter :", m), {
        success: !1,
        content: "",
        error: g
      };
    }
  }
  /**
   *  LLM API 
   */
  isAvailable() {
    const r = Py();
    return !!(r != null && r.generate || r != null && r.generateRaw);
  }
  /**
   *  Token 
   * @param text 
   */
  estimateTokens(r) {
    return Math.ceil(r.length / 3);
  }
}
const vu = new Fx(), vm = [
  { value: "input", label: "", description: " LLM " },
  { value: "output", label: "", description: " LLM /" },
  { value: "both", label: "", description: "" }
], Io = [
  {
    id: "remove-think",
    name: "",
    pattern: "<think(?:\\s+[^>]*)?>[\\s\\S]*?<\\/think\\s*>",
    replacement: "",
    enabled: !0,
    flags: "gi",
    scope: "both",
    description: " LLM  <think>...</think> "
  },
  {
    id: "remove-headless-think",
    name: "",
    pattern: "[\\s\\S]*?<\\/think\\s*>",
    replacement: "",
    enabled: !0,
    flags: "gi",
    scope: "both",
    description: " </think> "
  },
  {
    id: "remove-update-variable",
    name: " UpdateVariable",
    pattern: "<UpdateVariable(?:\\s+[^>]*)?>[\\s\\S]*?<\\/UpdateVariable\\s*>",
    replacement: "",
    enabled: !0,
    flags: "gi",
    scope: "both",
    description: " MVU "
  },
  {
    id: "remove-status-placeholder",
    name: " StatusPlaceHolder",
    pattern: "<StatusPlaceHolderImpl(?:\\s+[^>]*)?\\s*\\/>",
    replacement: "",
    enabled: !0,
    flags: "gi",
    scope: "both",
    description: ""
  }
];
class bd {
  constructor(r) {
    Xe(this, "rules", []);
    this.rules = r || [...Io];
  }
  /**
   * 
   * @param text 
   * @param scope 
   */
  process(r, a) {
    let l = r;
    for (const s of this.rules)
      if (s.enabled && !(a && s.scope !== a && s.scope !== "both"))
        try {
          const c = new RegExp(s.pattern, s.flags);
          l = l.replace(c, s.replacement);
        } catch (c) {
          console.warn(`[RegexProcessor]  "${s.name}" :`, c);
        }
    return l;
  }
  /**
   * 
   */
  processWithRule(r, a) {
    try {
      const l = new RegExp(a.pattern, a.flags);
      return r.replace(l, a.replacement);
    } catch (l) {
      return console.warn("[RegexProcessor] :", l), r;
    }
  }
  /**
   * 
   */
  validatePattern(r, a) {
    try {
      return new RegExp(r, a), { valid: !0 };
    } catch (l) {
      return {
        valid: !1,
        error: l instanceof Error ? l.message : ""
      };
    }
  }
  /**
   * 
   */
  getRules() {
    return [...this.rules];
  }
  /**
   * 
   */
  setRules(r) {
    this.rules = [...r];
  }
  /**
   * 
   */
  addRule(r) {
    this.rules.push(r);
  }
  /**
   * 
   */
  updateRule(r, a) {
    const l = this.rules.findIndex((s) => s.id === r);
    l >= 0 && (this.rules[l] = { ...this.rules[l], ...a });
  }
  /**
   * 
   */
  deleteRule(r) {
    this.rules = this.rules.filter((a) => a.id !== r);
  }
  /**
   * /
   */
  toggleRule(r) {
    const a = this.rules.find((l) => l.id === r);
    a && (a.enabled = !a.enabled);
  }
  /**
   * 
   */
  resetToDefaults() {
    this.rules = [...Io];
  }
  /**
   * 
   */
  getEnabledCount() {
    return this.rules.filter((r) => r.enabled).length;
  }
  // ========== V0.8:  ==========
  /**
   * 
   * @param text 
   * @param tagName  ( 'output', 'query')
   * @returns  null
   */
  captureTag(r, a) {
    var l;
    try {
      const s = new RegExp(`<${a}(?:\\s+[^>]*)?>([\\s\\S]*?)<\\/${a}\\s*>`, "i"), c = r.match(s);
      return ((l = c == null ? void 0 : c[1]) == null ? void 0 : l.trim()) || null;
    } catch (s) {
      return console.warn(`[RegexProcessor] : ${a}`, s), null;
    }
  }
  /**
   * 
   * @param text 
   * @param tagName 
   */
  removeTag(r, a) {
    try {
      const l = new RegExp(`<${a}(?:\\s+[^>]*)?>[\\s\\S]*?<\\/${a}\\s*>`, "gi");
      return r.replace(l, "").trim();
    } catch (l) {
      return console.warn(`[RegexProcessor] : ${a}`, l), r;
    }
  }
  /**
   * 
   * @param text 
   * @param tagNames 
   * @returns 
   */
  captureTags(r, a) {
    const l = {};
    for (const s of a)
      l[s] = this.captureTag(r, s);
    return l;
  }
}
const da = new bd(), pC = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  DEFAULT_REGEX_RULES: Io,
  REGEX_SCOPE_OPTIONS: vm,
  RegexProcessor: bd,
  regexProcessor: da
}, Symbol.toStringTag, { value: "Module" })), ld = {
  enabled: !1,
  templateId: "query_enhance",
  autoTrigger: !0,
  preview: !0
  // 
};
function qy(t) {
  var r, a;
  try {
    const l = (a = (r = window.SillyTavern) == null ? void 0 : r.getContext) == null ? void 0 : a.call(r);
    return l != null && l.substituteParams ? l.substituteParams(t) : (W.warn("Preprocessor", "substituteParams "), t);
  } catch (l) {
    return W.warn("Preprocessor", "substituteParams ", l), t;
  }
}
async function gC() {
  var t, r;
  try {
    const a = (r = (t = window.SillyTavern) == null ? void 0 : t.getContext) == null ? void 0 : r.call(t);
    a != null && a.stopGeneration && (a.stopGeneration(), W.info("Preprocessor", " stopGeneration"));
  } catch (a) {
    W.warn("Preprocessor", " stopGeneration ", a);
  }
}
function yC() {
  try {
    const t = ou();
    return t == null ? void 0 : t.name;
  } catch {
  }
}
function bC() {
  try {
    return Fm();
  } catch {
  }
}
const xl = class xl {
  constructor() {
    Xe(this, "cancelRequested", !1);
  }
  // ... (rest of class)
  static getInstance() {
    return xl.instance || (xl.instance = new xl()), xl.instance;
  }
  /**
   * 
   */
  requestStopGeneration() {
    gC();
  }
  /**
   * 
   * @param userInput 
   * @returns 
   */
  async process(r) {
    var c;
    const a = Date.now(), l = this.getConfig();
    if (W.info("Preprocessor", "", {
      enabled: l.enabled,
      templateId: l.templateId,
      inputLength: r.length
    }), !l.enabled)
      return W.debug("Preprocessor", ""), {
        success: !0,
        output: null,
        query: null,
        rawOutput: "",
        processingTime: 0
      };
    this.cancelRequested = !1;
    const s = wt.running("...", "Engram", () => {
      this.cancelRequested = !0, W.info("Preprocessor", ""), this.requestStopGeneration(), wt.warning("...", "Engram");
    });
    try {
      const d = Ke.getPromptTemplateById(l.templateId);
      if (W.debug("Preprocessor", "", {
        templateId: l.templateId,
        found: !!d,
        templateName: d == null ? void 0 : d.name
      }), !d) {
        const _ = ` ${l.templateId}  API `;
        return W.warn("Preprocessor", _), {
          success: !1,
          output: null,
          query: null,
          rawOutput: "",
          processingTime: Date.now() - a,
          error: _
        };
      }
      if (this.cancelRequested)
        return {
          success: !1,
          output: null,
          query: null,
          rawOutput: "",
          processingTime: Date.now() - a,
          error: ""
        };
      let m = d.systemPrompt.replace(/\{\{input\}\}/gi, r), g = d.userPromptTemplate.replace(/\{\{input\}\}/gi, r);
      m = qy(m), g = qy(g), W.debug("Preprocessor", "", {
        systemPromptLength: m.length,
        userPromptLength: g.length,
        userPromptPreview: g.substring(0, 100) + "..."
      });
      const p = Ir.logSend({
        type: "query",
        systemPrompt: m,
        userPrompt: g,
        model: bC() || "Unknown",
        character: yC() || "System"
      }), v = await vu.generate({
        systemPrompt: m,
        userPrompt: g
      });
      if (Ir.logReceive(p, {
        response: v.content,
        status: v.success ? "success" : "error",
        error: v.error,
        duration: Date.now() - a
      }), this.cancelRequested)
        return W.info("Preprocessor", ""), {
          success: !1,
          output: null,
          query: null,
          rawOutput: "",
          processingTime: Date.now() - a,
          error: ""
        };
      if (!v.success || !v.content) {
        const _ = v.error || "LLM ";
        return W.error("Preprocessor", "LLM ", { error: _ }), {
          success: !1,
          output: null,
          query: null,
          rawOutput: "",
          processingTime: Date.now() - a,
          error: _
        };
      }
      const x = da.process(v.content, "output"), E = da.captureTags(x, ["output", "query"]);
      if (l.preview && E.output) {
        W.info("Preprocessor", "");
        try {
          const _ = await new Promise((A) => {
            Ar.emit(Ur.ENGRAM_REQUEST_REVISION, {
              title: "",
              content: E.output,
              description: "",
              onConfirm: (D) => A(D),
              onCancel: () => A(null)
            });
          });
          if (_ !== null)
            E.output = _, W.info("Preprocessor", "");
          else
            return W.info("Preprocessor", ""), {
              success: !1,
              output: null,
              query: null,
              rawOutput: "",
              processingTime: Date.now() - a,
              error: ""
            };
        } catch (_) {
          W.warn("Preprocessor", "", _);
        }
      }
      const w = Date.now() - a;
      return W.info("Preprocessor", "", {
        hasOutput: !!E.output,
        hasQuery: !!E.query,
        outputLength: ((c = E.output) == null ? void 0 : c.length) || 0,
        processingTime: w
      }), wt.success("", "Engram"), {
        success: !0,
        output: E.output,
        query: E.query,
        rawOutput: x,
        processingTime: w
      };
    } catch (d) {
      const m = d instanceof Error ? d.message : "";
      return W.error("Preprocessor", "", { error: m, stack: d.stack }), wt.error(`: ${m}`, "Engram"), {
        success: !1,
        output: null,
        query: null,
        rawOutput: "",
        processingTime: Date.now() - a,
        error: m
      };
    } finally {
      wt.remove(s);
    }
  }
  /**
   * 
   */
  getConfig() {
    return Ke.get("preprocessingConfig") || ld;
  }
  /**
   * 
   */
  saveConfig(r) {
    W.debug("Preprocessor", "", r), Ke.set("preprocessingConfig", r);
  }
  /**
   * /
   */
  toggle() {
    const r = this.getConfig();
    return r.enabled = !r.enabled, this.saveConfig(r), W.info("Preprocessor", `${r.enabled ? "" : ""}`), r.enabled;
  }
};
Xe(xl, "instance");
let Sm = xl;
const ia = Sm.getInstance(), Ao = "__ENGRAM_STATE__", Hc = {
  lastSummarizedFloor: 0,
  totalSummaries: 0,
  totalTokens: 0,
  updatedAt: Date.now()
};
class wm {
  /**
   * 
   */
  static async loadState(r) {
    try {
      const a = await St.findEntryByKey(r, Ao);
      if (!a)
        return { ...Hc };
      try {
        const l = JSON.parse(a.content);
        return { ...Hc, ...l };
      } catch (l) {
        return W.warn("WorldBookStateService", "", l), { ...Hc };
      }
    } catch (a) {
      return W.error("WorldBookStateService", "", a), { ...Hc };
    }
  }
  /**
   * 
   */
  static async saveState(r, a) {
    try {
      const s = {
        ...await this.loadState(r),
        ...a,
        updatedAt: Date.now()
      }, c = JSON.stringify(s, null, 2), m = (await St.getEntries(r)).filter(
        (g) => g.name === "Engram System State" || g.keys.includes(Ao)
      );
      if (m.length > 0) {
        m.sort((x, E) => {
          const w = x.keys.includes(Ao) ? 1 : 0;
          return (E.keys.includes(Ao) ? 1 : 0) - w;
        });
        const [g, ...p] = m;
        if (p.length > 0) {
          W.warn("WorldBookStateService", ` ${p.length} ...`);
          for (const x of p)
            await St.deleteEntry(r, x.uid);
        }
        W.debug("WorldBookStateService", "", { uid: g.uid, state: s });
        const v = {
          content: c,
          name: "Engram System State",
          enabled: !1,
          constant: !1,
          keys: [Ao],
          recursion: {
            prevent_incoming: !0,
            prevent_outgoing: !0
          },
          position: "before_character_definition",
          order: 0
        };
        return await St.updateEntry(r, g.uid, v);
      } else {
        W.debug("WorldBookStateService", "", { state: s });
        const g = {
          name: "Engram System State",
          content: c,
          keys: [Ao],
          enabled: !1,
          constant: !1,
          position: "before_character_definition",
          role: "system",
          order: 0,
          recursion: {
            prevent_incoming: !0,
            prevent_outgoing: !0
          }
        };
        return await St.createEntry(r, g);
      }
    } catch (l) {
      return W.error("WorldBookStateService", "", l), !1;
    }
  }
}
const xC = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  WorldBookStateService: wm
}, Symbol.toStringTag, { value: "Module" }));
function vC(t, r) {
  const a = [];
  for (const s of t.filter((c) => c.isBuiltIn)) {
    let c = r.find((d) => d.id === s.id);
    c || (c = r.find(
      (d) => d.isBuiltIn && d.category === s.category && d.name === s.name
    )), c ? a.push({
      ...c,
      id: s.id
    }) : a.push(s);
  }
  const l = r.filter((s) => !s.isBuiltIn);
  return a.push(...l), a;
}
function $x() {
  const [t, r] = U.useState(F1), [a, l] = U.useState(null), [s, c] = U.useState(null), [d, m] = U.useState(!1), [g, p] = U.useState([...Io]), [v, x] = U.useState(null), [E, w] = U.useState({}), [_, A] = U.useState({}), [D, R] = U.useState(null), Z = U.useCallback(async () => {
    var Ne;
    const ye = await St.getWorldbookStructure();
    w(ye);
    const me = Jn(), Ge = (Ne = me == null ? void 0 : me.getCharWorldbookNames) == null ? void 0 : Ne.call(me, "current");
    if (Ge != null && Ge.primary) {
      R(Ge.primary);
      const Rt = await wm.loadState(Ge.primary);
      Rt.disabledEntries && A(Rt.disabledEntries);
    }
  }, []);
  U.useEffect(() => {
    Z();
  }, [Z]), U.useEffect(() => {
    var Ge;
    const ye = Ke.get("apiSettings");
    if (ye) {
      const Ne = F1(), Rt = {
        ...Ne,
        ...ye,
        // 
        llmPresets: ((Ge = ye.llmPresets) == null ? void 0 : Ge.length) > 0 ? ye.llmPresets : Ne.llmPresets,
        // 
        promptTemplates: vC(
          Ne.promptTemplates,
          ye.promptTemplates || []
        )
      };
      r(Rt);
    }
    const me = Ke.getRegexRules();
    me && me.length > 0 && p(me);
  }, []);
  const K = U.useCallback((ye) => {
    r((me) => ({ ...me, selectedPresetId: ye.id })), l(ye);
  }, []), ge = U.useCallback(() => {
    const ye = Tb(` ${t.llmPresets.length + 1}`);
    ye.isDefault = !1, r((me) => ({
      ...me,
      llmPresets: [...me.llmPresets, ye],
      selectedPresetId: ye.id
    })), l(ye), m(!0);
  }, [t.llmPresets.length]), de = U.useCallback((ye) => {
    r((me) => ({
      ...me,
      llmPresets: me.llmPresets.map((Ge) => Ge.id === ye.id ? ye : Ge)
    })), l(ye), m(!0);
  }, []), I = U.useCallback((ye) => {
    const me = {
      ...ye,
      id: `preset_${Date.now()}`,
      name: `${ye.name} ()`,
      isDefault: !1,
      createdAt: Date.now(),
      updatedAt: Date.now()
    };
    r((Ge) => ({ ...Ge, llmPresets: [...Ge.llmPresets, me] })), m(!0);
  }, []), V = U.useCallback((ye) => {
    ye.isDefault || (r((me) => ({
      ...me,
      llmPresets: me.llmPresets.filter((Ge) => Ge.id !== ye.id),
      selectedPresetId: me.selectedPresetId === ye.id ? null : me.selectedPresetId
    })), l((me) => (me == null ? void 0 : me.id) === ye.id ? null : me), m(!0));
  }, []), we = U.useCallback((ye) => {
    c(ye);
  }, []), Te = U.useCallback((ye) => {
    r((me) => ({
      ...me,
      promptTemplates: [...me.promptTemplates, ye]
    })), m(!0);
  }, []), X = U.useCallback((ye) => {
    r((me) => ({
      ...me,
      promptTemplates: me.promptTemplates.map((Ge) => Ge.id === ye.id ? ye : Ge)
    })), c(ye), m(!0);
  }, []), oe = U.useCallback((ye) => {
    ye.isBuiltIn || (r((me) => ({
      ...me,
      promptTemplates: me.promptTemplates.filter((Ge) => Ge.id !== ye.id)
    })), c((me) => (me == null ? void 0 : me.id) === ye.id ? null : me), m(!0));
  }, []), se = U.useCallback((ye) => {
    r((me) => ({ ...me, vectorConfig: ye })), m(!0);
  }, []), Re = U.useCallback((ye) => {
    r((me) => ({ ...me, rerankConfig: ye })), m(!0);
  }, []), be = U.useCallback((ye) => {
    r((me) => ({ ...me, worldbookConfig: ye })), m(!0);
  }, []), je = U.useCallback((ye) => {
    r((me) => ({ ...me, regexConfig: ye })), m(!0);
  }, []), re = U.useCallback((ye, me) => {
    r((Ge) => {
      const Ne = Ge.worldbookConfig.disabledWorldbooks || [];
      let Rt;
      return me ? Rt = [.../* @__PURE__ */ new Set([...Ne, ye])] : Rt = Ne.filter((tn) => tn !== ye), {
        ...Ge,
        worldbookConfig: {
          ...Ge.worldbookConfig,
          disabledWorldbooks: Rt
        }
      };
    }), m(!0);
  }, []), _e = U.useCallback((ye, me, Ge) => {
    A((Ne) => {
      const Rt = Ne[ye] || [];
      let tn;
      return Ge ? tn = [.../* @__PURE__ */ new Set([...Rt, me])] : tn = Rt.filter((mt) => mt !== me), {
        ...Ne,
        [ye]: tn
      };
    }), m(!0);
  }, []), fe = U.useCallback((ye) => {
    const me = g.find((Ge) => Ge.id === ye);
    x(me || null);
  }, [g]), Ue = U.useCallback(() => {
    const ye = {
      id: `rule_${Date.now()}`,
      name: "",
      pattern: "",
      replacement: "",
      enabled: !0,
      flags: "gi",
      scope: "both",
      description: ""
    };
    p((me) => [...me, ye]), x(ye), m(!0);
  }, []), O = U.useCallback((ye) => {
    if (!v) return;
    const me = { ...v, ...ye };
    x(me), p((Ge) => Ge.map((Ne) => Ne.id === me.id ? me : Ne)), m(!0);
  }, [v]), L = U.useCallback((ye) => {
    p((me) => me.map(
      (Ge) => Ge.id === ye ? { ...Ge, enabled: !Ge.enabled } : Ge
    )), m(!0);
  }, []), he = U.useCallback((ye) => {
    p((me) => me.filter((Ge) => Ge.id !== ye)), x((me) => (me == null ? void 0 : me.id) === ye ? null : me), m(!0);
  }, []), M = U.useCallback(() => {
    p([...Io]), x(null), m(!0);
  }, []), Ie = U.useCallback(async () => {
    Ke.set("apiSettings", t), Ke.setRegexRules(g), D && await wm.saveState(D, {
      disabledEntries: _
    }), console.log("[Engram] :", t, g, _), m(!1);
  }, [t, g, D, _]), Ye = U.useCallback((ye) => {
    r((me) => ({
      ...me,
      recallConfig: ye
    })), m(!0);
  }, []);
  return {
    settings: t,
    editingPreset: a,
    editingTemplate: s,
    hasChanges: d,
    regexRules: g,
    editingRule: v,
    selectPreset: K,
    addPreset: ge,
    updatePreset: de,
    copyPreset: I,
    deletePreset: V,
    selectTemplate: we,
    addTemplate: Te,
    updateTemplate: X,
    deleteTemplate: oe,
    updateVectorConfig: se,
    updateRerankConfig: Re,
    updateWorldbookConfig: be,
    updateRegexConfig: je,
    toggleWorldbook: re,
    toggleEntry: _e,
    refreshWorldbooks: Z,
    worldbookStructure: E,
    disabledEntries: _,
    currentCharWorldbook: D,
    updateRecallConfig: Ye,
    selectRule: fe,
    addRule: Ue,
    updateRule: O,
    toggleRule: L,
    deleteRule: he,
    resetRules: M,
    save: Ie
  };
}
function SC({ isOpen: t, onClose: r }) {
  var v, x, E;
  const [a, l] = U.useState(
    ia.getConfig() || ld
  ), { settings: s, updateRecallConfig: c } = $x(), d = (v = s.apiSettings) == null ? void 0 : v.recallConfig;
  a.enabled && (d == null || d.usePreprocessing);
  const m = U.useMemo(() => s.promptTemplates.filter((w) => w.category === "preprocessing").map((w) => ({
    id: w.id,
    name: w.name,
    description: w.userPromptTemplate.slice(0, 30).replace(/\n/g, " ") + "...",
    // 
    icon: H3
    // 
  })), [s.promptTemplates]);
  U.useEffect(() => {
    t && l(ia.getConfig() || ld);
  }, [t]);
  const g = U.useCallback(() => {
    const _ = !((d == null ? void 0 : d.usePreprocessing) ?? !1);
    d && c({ ...d, usePreprocessing: _ });
    const A = { ...a, enabled: _ };
    l(A), ia.saveConfig(A);
  }, [a, d, c]), p = U.useCallback((w) => {
    const _ = { ...a, templateId: w, enabled: !0 };
    l(_), ia.saveConfig(_), d && !d.usePreprocessing && c({ ...d, usePreprocessing: !0 });
  }, [a, d, c]);
  return !a.templateId || m.some((w) => w.id === a.templateId), /* @__PURE__ */ u.jsx(
    hC,
    {
      isOpen: t,
      onClose: r,
      title: "Engram ",
      width: 300,
      children: /* @__PURE__ */ u.jsxs("div", { className: "space-y-3", children: [
        /* @__PURE__ */ u.jsxs(
          "div",
          {
            className: "flex items-center justify-between p-2 rounded-md",
            style: {
              backgroundColor: "var(--surface, rgba(255,255,255,0.05))",
              border: "1px solid var(--border, rgba(255,255,255,0.1))"
            },
            children: [
              /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-2", children: [
                /* @__PURE__ */ u.jsx(sa, { size: 14, style: { color: "var(--primary, #ef7357)" } }),
                /* @__PURE__ */ u.jsx("span", { className: "text-sm font-medium", children: "" })
              ] }),
              /* @__PURE__ */ u.jsx(
                On,
                {
                  checked: (d == null ? void 0 : d.usePreprocessing) ?? a.enabled,
                  onChange: g
                }
              )
            ]
          }
        ),
        ((d == null ? void 0 : d.usePreprocessing) ?? a.enabled) && /* @__PURE__ */ u.jsxs(
          "div",
          {
            className: "flex items-center justify-between p-2 rounded-md",
            style: {
              backgroundColor: "var(--surface, rgba(255,255,255,0.05))",
              border: "1px solid var(--border, rgba(255,255,255,0.1))"
            },
            children: [
              /* @__PURE__ */ u.jsx("div", { className: "flex items-center gap-2 pl-2", children: /* @__PURE__ */ u.jsx("span", { className: "text-xs text-muted-foreground", children: "" }) }),
              /* @__PURE__ */ u.jsx(
                On,
                {
                  checked: a.preview,
                  onChange: () => {
                    const w = { ...a, preview: !a.preview };
                    l(w), ia.saveConfig(w);
                  }
                }
              )
            ]
          }
        ),
        ((d == null ? void 0 : d.usePreprocessing) ?? a.enabled) && /* @__PURE__ */ u.jsxs("div", { className: "space-y-2", children: [
          /* @__PURE__ */ u.jsx("div", { className: "text-xs px-1", style: { color: "var(--muted-foreground, #888)" }, children: "" }),
          m.length === 0 ? /* @__PURE__ */ u.jsxs(
            "div",
            {
              className: "flex items-start gap-2 p-2 rounded-md text-xs mt-2",
              style: {
                backgroundColor: "rgba(var(--primary-rgb, 239,115,87), 0.1)",
                border: "1px solid rgba(var(--primary-rgb, 239,115,87), 0.3)",
                color: "var(--muted-foreground, #888)"
              },
              children: [
                /* @__PURE__ */ u.jsx(El, { size: 14, style: { color: "var(--primary, #ef7357)", flexShrink: 0, marginTop: 2 } }),
                /* @__PURE__ */ u.jsx("span", { children: " API    'preprocessing' " })
              ]
            }
          ) : /* @__PURE__ */ u.jsx("div", { className: "space-y-1", children: m.map((w) => {
            const _ = w.icon, A = a.templateId === w.id;
            return /* @__PURE__ */ u.jsxs(
              "button",
              {
                onClick: () => p(w.id),
                className: "w-full flex items-center gap-3 p-2 rounded-md transition-all text-left",
                style: {
                  backgroundColor: A ? "rgba(var(--primary-rgb, 239,115,87), 0.15)" : "var(--surface, rgba(255,255,255,0.05))",
                  border: A ? "1px solid var(--primary, #ef7357)" : "1px solid var(--border, rgba(255,255,255,0.1))",
                  color: "var(--foreground, #fff)"
                },
                children: [
                  /* @__PURE__ */ u.jsx(
                    _,
                    {
                      size: 16,
                      style: {
                        color: A ? "var(--primary, #ef7357)" : "var(--muted-foreground, #888)"
                      }
                    }
                  ),
                  /* @__PURE__ */ u.jsxs("div", { className: "flex-1 min-w-0", children: [
                    /* @__PURE__ */ u.jsx("div", { className: "text-sm font-medium truncate", children: w.name }),
                    /* @__PURE__ */ u.jsx(
                      "div",
                      {
                        className: "text-xs truncate",
                        style: { color: "var(--muted-foreground, #888)" },
                        children: w.description
                      }
                    )
                  ] })
                ]
              },
              w.id
            );
          }) })
        ] }),
        /* @__PURE__ */ u.jsx(
          "div",
          {
            className: "text-xs text-center pt-2",
            style: {
              borderTop: "1px solid var(--border, rgba(255,255,255,0.1))",
              color: "var(--muted-foreground, #888)"
            },
            children: (d == null ? void 0 : d.usePreprocessing) ?? a.enabled ? (x = m.find((w) => w.id === a.templateId)) != null && x.name ? `  ${(E = m.find((w) => w.id === a.templateId)) == null ? void 0 : E.name}` : "  " : ""
          }
        )
      ] })
    }
  );
}
let km = !1, Cm = null;
function Gx(t) {
  Cm = t;
}
function Em() {
  if (km)
    return W.debug("QuickPanelButton", ""), !0;
  const t = document.querySelector("#send_form");
  if (!t)
    return W.warn("QuickPanelButton", "#send_form "), !1;
  window.getComputedStyle(t).position === "static" && (t.style.position = "relative");
  const a = document.createElement("div");
  a.id = "engram-quick-panel-trigger", a.className = "fa-solid fa-brain", a.title = "Engram ", a.style.cssText = `
        position: absolute;
        top: 0.5em;
        left: 0.5em;
        width: 1.5em;
        height: 1.5em;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.9em;
        cursor: pointer;
        color: var(--SmartThemeBodyColor, #ccc);
        opacity: 0.6;
        transition: all 0.2s ease;
        z-index: 1000;
    `;
  const l = window.getComputedStyle(t).paddingLeft, s = parseFloat(l) < 30 ? "30px" : l;
  return t.style.paddingLeft = s, a.addEventListener("mouseenter", () => {
    a.style.opacity = "1", a.style.color = "var(--SmartThemeEmColor, #fff)";
  }), a.addEventListener("mouseleave", () => {
    a.style.opacity = "0.7", a.style.color = "var(--SmartThemeBodyColor, #ccc)";
  }), a.addEventListener("click", (c) => {
    c.preventDefault(), c.stopPropagation(), W.debug("QuickPanelButton", ""), Cm ? Cm() : W.warn("QuickPanelButton", "");
  }), t.appendChild(a), km = !0, W.info("QuickPanelButton", " ()"), !0;
}
function wC() {
  if (Em())
    return;
  const t = new MutationObserver((r, a) => {
    Em() && a.disconnect();
  });
  t.observe(document.body, {
    childList: !0,
    subtree: !0
  }), setTimeout(() => {
    t.disconnect(), km || W.warn("QuickPanelButton", " #send_form ");
  }, 1e4);
}
const kC = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  initQuickPanelButton: wC,
  injectQuickPanelButton: Em,
  setQuickPanelCallback: Gx
}, Symbol.toStringTag, { value: "Module" }));
let CC = !1, od = null;
K9((t, r) => {
  const a = ob.createRoot(t);
  return a.render(ib.createElement(lC, { onClose: r })), a;
});
function EC() {
  const [t, r] = U.useState(CC);
  return U.useEffect(() => (od = r, () => {
    od = null;
  }), []), /* @__PURE__ */ u.jsxs("div", { className: "pointer-events-auto", children: [
    /* @__PURE__ */ u.jsx(fC, {}),
    /* @__PURE__ */ u.jsx(
      SC,
      {
        isOpen: t,
        onClose: () => r(!1)
      }
    )
  ] });
}
Y9((t) => {
  const r = ob.createRoot(t);
  return r.render(/* @__PURE__ */ u.jsx(EC, {})), r;
});
Gx(() => {
  od && od(!0);
});
document.readyState === "loading" ? document.addEventListener("DOMContentLoaded", Ly) : Ly();
const jC = [
  // 
  { pattern: /\n{3,}/g, replacement: `

`, description: "" },
  // 
  { pattern: /^[ \t]+|[ \t]+$/gm, replacement: "", description: "" },
  //  Markdown 
  { pattern: /```\w*\n?/g, replacement: "", description: "Markdown" },
  // 
  { pattern: /[""]/g, replacement: '"', description: "" },
  { pattern: /['']/g, replacement: "'", description: "" }
];
class Vx {
  constructor(r) {
    Xe(this, "rules");
    this.rules = r || jC;
  }
  /**
   *  LLM 
   * @param text 
   * @returns 
   */
  clean(r) {
    let a = r;
    for (const l of this.rules)
      a = a.replace(l.pattern, l.replacement);
    return a.trim();
  }
  /**
   * 
   * @param summary 
   * @param metadata 
   */
  formatAsWorldEntry(r, a) {
    let s = `  [${`${a.floorRange[0]}-${a.floorRange[1]}`}]
`;
    return s += r, s;
  }
  /**
   * 
   * @param text 
   */
  extractPlainText(r) {
    return r.replace(/```[\s\S]*?```/g, "").replace(/\[([^\]]+)\]\([^)]+\)/g, "$1").replace(/[*_~`#]/g, "").replace(/\n{2,}/g, `
`).trim();
  }
  /**
   * 
   * @param text 
   * @param maxLength 
   * @param suffix 
   */
  truncate(r, a, l = "...") {
    return r.length <= a ? r : r.slice(0, a - l.length) + l;
  }
  /**
   * 
   */
  addRule(r) {
    this.rules.push(r);
  }
  /**
   * 
   */
  getRules() {
    return [...this.rules];
  }
}
const Kx = new Vx(), vl = class vl {
  constructor() {
    Xe(this, "unsubscribers", []);
    Xe(this, "callbacks", /* @__PURE__ */ new Map());
  }
  /**
   * 
   */
  static getInstance() {
    return vl.instance || (vl.instance = new vl()), vl.instance;
  }
  /**
   * 
   * 
   */
  start() {
    if (this.unsubscribers.length > 0) {
      console.log("[EventWatcher] Already started.");
      return;
    }
    this.unsubscribers.push(
      Ar.on(Ur.MESSAGE_RECEIVED, () => this.emit("messageReceived")),
      Ar.on(Ur.CHAT_CHANGED, () => this.emit("chatChanged")),
      Ar.on(Ur.GENERATION_STARTED, () => this.emit("generationStarted")),
      Ar.on(Ur.GENERATION_ENDED, () => this.emit("generationEnded"))
    ), console.log("[EventWatcher] Started, listening to core events.");
  }
  /**
   * 
   */
  stop() {
    this.unsubscribers.forEach((r) => r()), this.unsubscribers = [], console.log("[EventWatcher] Stopped.");
  }
  /**
   * 
   * @param event 
   * @param callback 
   * @returns 
   */
  on(r, a) {
    const l = this.mapEventKey(r);
    return this.callbacks.has(l) || this.callbacks.set(l, /* @__PURE__ */ new Set()), this.callbacks.get(l).add(a), () => {
      var s;
      (s = this.callbacks.get(l)) == null || s.delete(a);
    };
  }
  /**
   * 
   */
  emit(r) {
    const a = this.callbacks.get(r);
    a && a.forEach((l) => {
      try {
        l();
      } catch (s) {
        console.error(`[EventWatcher] Callback error for ${r}:`, s);
      }
    });
  }
  /**
   * 
   */
  mapEventKey(r) {
    return {
      onMessageReceived: "messageReceived",
      onChatChanged: "chatChanged",
      onGenerationStarted: "generationStarted",
      onGenerationEnded: "generationEnded"
    }[r];
  }
};
Xe(vl, "instance", null);
let jm = vl;
const Vh = jm.getInstance(), Js = {
  last_summarized_floor: 0,
  token_usage_accumulated: 0,
  last_compressed_at: 0,
  active_summary_order: 9e3
}, Kh = "scope_state", Hy = "character_name";
class Yx {
  constructor() {
    Xe(this, "currentChatId", null);
    Xe(this, "currentDb", null);
  }
  /**
   * 
   *  ST  chatId
   */
  getCurrentDb() {
    const r = Dn();
    return r ? (r !== this.currentChatId && (this.currentChatId = r, this.currentDb = kl(r), console.debug(`[ChatManager] Switched to database: Engram_${r}`)), this.currentDb) : (console.warn("[ChatManager] No chat_id available"), null);
  }
  /**
   *  chatId
   */
  getCurrentChatId() {
    return Dn();
  }
  /**
   * 
   */
  getCharacterName() {
    var r;
    return ((r = ou()) == null ? void 0 : r.name) || "Unknown";
  }
  /**
   * 
   */
  async getState() {
    const r = this.getCurrentDb();
    if (!r) return Js;
    try {
      const a = await r.meta.get(Kh);
      return a != null && a.value ? { ...Js, ...a.value } : Js;
    } catch (a) {
      return console.error("[ChatManager] Failed to get state:", a), Js;
    }
  }
  /**
   * 
   */
  async updateState(r) {
    const a = this.getCurrentDb();
    if (a)
      try {
        const s = { ...await this.getState(), ...r };
        await a.meta.put({ key: Kh, value: s });
      } catch (l) {
        console.error("[ChatManager] Failed to update state:", l);
      }
  }
  /**
   *  UI 
   */
  async saveCharacterName() {
    const r = this.getCurrentDb();
    if (!r) return;
    const a = this.getCharacterName();
    await r.meta.put({ key: Hy, value: a });
  }
  /**
   * 
   */
  async getSavedCharacterName() {
    const r = this.getCurrentDb();
    if (!r) return "Unknown";
    const a = await r.meta.get(Hy);
    return (a == null ? void 0 : a.value) || "Unknown";
  }
  /**
   * Debug/Dev only
   */
  async resetState() {
    const r = this.getCurrentDb();
    r && await r.meta.put({ key: Kh, value: Js });
  }
}
const Qc = new Yx(), _C = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  ChatManager: Yx,
  chatManager: Qc
}, Symbol.toStringTag, { value: "Module" }));
function NC() {
  return typeof crypto < "u" && typeof crypto.randomUUID == "function" ? crypto.randomUUID() : "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, (t) => {
    const r = Math.random() * 16 | 0;
    return (t === "x" ? r : r & 3 | 8).toString(16);
  });
}
function Ti() {
  const t = Dn();
  return t ? kl(t) : null;
}
function TC() {
  const t = Dn();
  return t ? Li(t) : null;
}
const _l = Sb((t, r) => ({
  currentChatId: null,
  lastSummarizedFloor: 0,
  isProcessing: !1,
  recentEvents: [],
  // V0.6 
  currentScope: null,
  resolveScope: async (a, l) => {
    t({ currentChatId: a, currentScope: { id: 1 } });
    const s = await Qc.getState();
    return t({ lastSummarizedFloor: s.last_summarized_floor }), { id: 1 };
  },
  initChat: async () => {
    const a = Dn();
    if (!a)
      return console.warn("[MemoryStore] No chat_id available"), null;
    if (a !== r().currentChatId) {
      console.debug(`[MemoryStore] Switching to chat: ${a}`);
      const l = await Qc.getState();
      t({
        currentChatId: a,
        currentScope: { id: 1 },
        // 
        lastSummarizedFloor: l.last_summarized_floor,
        recentEvents: []
      });
    }
    return kl(a);
  },
  saveEvent: async (a) => {
    const l = Ti();
    if (!l)
      throw new Error("[MemoryStore] No current chat");
    const s = {
      ...a,
      id: NC(),
      timestamp: Date.now(),
      is_embedded: a.is_embedded ?? !1,
      // V0.7: 
      is_archived: a.is_archived ?? !1
      // V0.7: 
    };
    return await l.events.add(s), t((c) => ({
      recentEvents: [...c.recentEvents, s].slice(-10)
    })), s;
  },
  getEventSummaries: async (a) => {
    const l = TC();
    if (!l) return "";
    try {
      const s = await l.events.toArray();
      if (s.length === 0) return "";
      const c = a ? new Set(a) : null, d = s.filter(
        (g) => g.level >= 1 || // 
        !g.is_archived || // 
        (c == null ? void 0 : c.has(g.id))
        //  RAG 
      );
      return d.length === 0 ? "" : (d.sort((g, p) => {
        var _, A, D, R;
        const v = ((_ = g.source_range) == null ? void 0 : _.start_index) ?? 0, x = ((A = p.source_range) == null ? void 0 : A.start_index) ?? 0;
        if (v !== x) return v - x;
        const E = ((D = g.source_range) == null ? void 0 : D.end_index) ?? 0, w = ((R = p.source_range) == null ? void 0 : R.end_index) ?? 0;
        return E !== w ? E - w : g.timestamp - p.timestamp;
      }), `<summary>
${d.map((g) => g.summary).join(`

`)}
</summary>`);
    } catch (s) {
      return console.error("[MemoryStore] Failed to get event summaries:", s), "";
    }
  },
  countEventTokens: async () => {
    const a = Ti();
    if (!a) return { totalTokens: 0, eventCount: 0, activeEventCount: 0 };
    try {
      const l = await a.events.toArray();
      if (l.length === 0) return { totalTokens: 0, eventCount: 0, activeEventCount: 0 };
      const s = l.filter((m) => !m.is_archived), c = s.map((m) => m.summary).join(`

`);
      return {
        totalTokens: await St.countTokens(c),
        eventCount: l.length,
        activeEventCount: s.length
        // 
      };
    } catch (l) {
      return console.error("[MemoryStore] Failed to count event tokens:", l), { totalTokens: 0, eventCount: 0, activeEventCount: 0 };
    }
  },
  setLastSummarizedFloor: async (a) => {
    await Qc.updateState({ last_summarized_floor: a }), t({ lastSummarizedFloor: a });
  },
  setProcessing: (a) => t({ isProcessing: a }),
  reset: () => t({
    currentChatId: null,
    currentScope: null,
    lastSummarizedFloor: 0,
    isProcessing: !1,
    recentEvents: []
  }),
  // ==================== Trim  ====================
  /**
   * 
   */
  archiveEvents: async (a) => {
    if (a.length === 0) return;
    const l = Ti();
    if (l)
      try {
        await l.events.where("id").anyOf(a).modify({ is_archived: !0 }), console.log(`[MemoryStore] Archived ${a.length} events`);
      } catch (s) {
        console.error("[MemoryStore] Failed to archive events:", s);
      }
  },
  /**
   * 
   */
  markEventsAsEmbedded: async (a) => {
    if (a.length === 0) return;
    const l = Ti();
    if (l)
      try {
        await l.events.where("id").anyOf(a).modify({ is_embedded: !0 }), console.log(`[MemoryStore] Marked ${a.length} events as embedded`);
      } catch (s) {
        console.error("[MemoryStore] Failed to mark events as embedded:", s);
      }
  },
  getEventsToMerge: async (a = 3) => {
    const l = Ti();
    if (!l) return [];
    try {
      const s = await l.events.orderBy("timestamp").toArray();
      return s.length <= a ? [] : s.slice(0, s.length - a);
    } catch (s) {
      return console.error("[MemoryStore] Failed to get events to merge:", s), [];
    }
  },
  deleteEvents: async (a) => {
    if (a.length === 0) return;
    const l = Ti();
    if (l)
      try {
        await l.events.bulkDelete(a), console.log(`[MemoryStore] Deleted ${a.length} events`);
      } catch (s) {
        throw console.error("[MemoryStore] Failed to delete events:", s), s;
      }
  },
  /**
   * 
   */
  updateEvent: async (a, l) => {
    if (!a) return;
    const s = Ti();
    if (s)
      try {
        const { id: c, timestamp: d, ...m } = l;
        await s.events.update(a, m), console.log(`[MemoryStore] Updated event: ${a}`, m);
      } catch (c) {
        throw console.error("[MemoryStore] Failed to update event:", c), c;
      }
  },
  getAllEvents: async () => {
    const a = Ti();
    if (!a) return [];
    try {
      return await a.events.orderBy("timestamp").toArray();
    } catch (l) {
      return console.error("[MemoryStore] Failed to get all events:", l), [];
    }
  }
})), Qx = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  useMemoryStore: _l
}, Symbol.toStringTag, { value: "Module" }));
class Xx {
  /**
   * Clean and parse JSON from a string.
   * @param input Raw string from LLM
   * @returns Parsed object or null if failed
   */
  static parse(r) {
    const a = da.process(r, "output"), l = this.extractJsonBlock(a);
    if (!l)
      return console.warn("[RobustJsonParser] No JSON block found."), null;
    try {
      return JSON.parse(l);
    } catch {
      const c = this.simpleRepair(l);
      try {
        return JSON.parse(c);
      } catch (d) {
        return console.error("[RobustJsonParser] Parse failed:", d), console.debug("[RobustJsonParser] Failed string:", l), null;
      }
    }
  }
  /**
   * Extracts the likely JSON part from a string.
   * Prioritizes ```json ... ``` blocks, then looks for outer { ... }.
   */
  static extractJsonBlock(r) {
    const a = r.match(/```(?:json)?\s*([\s\S]*?)```/i);
    if (a && a[1])
      return a[1].trim();
    const l = r.indexOf("{"), s = r.lastIndexOf("}");
    return l !== -1 && s !== -1 && s > l ? r.substring(l, s + 1) : null;
  }
  /**
   * Simple JSON repair logic
   * Fixes common LLM JSON errors:
   * - Trailing commas
   * - Unquoted keys (simple cases)
   * - Single quotes
   */
  static simpleRepair(r) {
    let a = r;
    return a = a.replace(/,\s*([}\]])/g, "$1"), a;
  }
}
class AC {
  /**
   *  Pipeline
   * V0.6:  JSON Extractor LLM
   */
  async run(r) {
    const a = _l.getState(), l = Date.now();
    try {
      if (console.log("[Pipeline] Starting..."), a.setProcessing(!0), !await a.initChat())
        return { success: !1, error: "No chat context available" };
      console.log(`[Pipeline] Chat database initialized (${Date.now() - l}ms)`);
      const c = Xx.parse(r.jsonContent);
      if (!c || !c.events || c.events.length === 0)
        return console.warn("[Pipeline] No events found in JSON"), { success: !1, error: "No events in JSON content" };
      console.log(`[Pipeline] Parsed ${c.events.length} events from JSON (${Date.now() - l}ms)`);
      const d = [];
      for (const g of c.events) {
        const p = g.meta, v = [];
        p.time_anchor && v.push(p.time_anchor), p.location && v.push(p.location), p.role && p.role.length > 0 && v.push(p.role.join(", "));
        const x = v.length > 0 ? `(${v.join(" | ")}) ` : "", E = p.event ? `${p.event}:
` : "", w = [];
        p.logic && p.logic.length > 0 && w.push(`[: ${p.logic.join(", ")}]`), p.causality && w.push(`[: ${p.causality}]`);
        const _ = w.length > 0 ? `
${w.join(" ")}` : "", A = `${E}${x}${g.summary}${_}`, D = await a.saveEvent({
          summary: A,
          structured_kv: {
            time_anchor: p.time_anchor || "",
            role: p.role || [],
            location: p.location || "",
            event: p.event || "",
            logic: p.logic || [],
            causality: p.causality || ""
          },
          significance_score: g.significance_score,
          level: 0,
          is_embedded: !1,
          // V0.7: 
          is_archived: !1,
          // V0.7: 
          source_range: {
            start_index: r.sourceRange.start,
            end_index: r.sourceRange.end
          }
        });
        d.push(D);
      }
      console.log(`[Pipeline] Saved ${d.length} events to DB (${Date.now() - l}ms)`);
      const { MacroService: m } = await Promise.resolve().then(() => n2);
      return await m.refreshCache(), console.log(`[Pipeline] Macro cache refreshed (${Date.now() - l}ms)`), await a.setLastSummarizedFloor(r.sourceRange.end), console.log(`[Pipeline] Completed successfully in ${Date.now() - l}ms`), { success: !0, events: d };
    } catch (s) {
      return console.error("[Pipeline] Failed:", s), { success: !1, error: String(s) };
    } finally {
      a.setProcessing(!1);
    }
  }
}
const MC = new AC();
class zC {
  /**
   * 
   * @returns Promise<string> 
   * @throws Error 
   */
  async requestRevision(r, a, l) {
    return new Promise((s, c) => {
      Ar.emit(Ur.ENGRAM_REQUEST_REVISION, {
        title: r,
        description: a,
        content: l,
        onConfirm: (d) => s(d),
        onCancel: () => c(new Error("User cancelled revision"))
      });
    });
  }
}
const sp = new zC(), Wx = {
  enabled: !0,
  triggerMode: "auto",
  floorInterval: 10,
  worldbookMode: "chat",
  previewEnabled: !0,
  promptTemplateId: null,
  // 
  llmPresetId: null,
  // 
  bufferSize: 3,
  //  3 
  autoHide: !1
  // 
}, Mo = "engram";
function Fy() {
  var t, r;
  try {
    return ((r = (t = window.SillyTavern) == null ? void 0 : t.getContext) == null ? void 0 : r.call(t)) || null;
  } catch {
    return null;
  }
}
function $y() {
  var t, r;
  try {
    const a = (r = (t = window.SillyTavern) == null ? void 0 : t.getContext) == null ? void 0 : r.call(t);
    return a != null && a.chat_metadata ? a.chat_metadata : window.chat_metadata || null;
  } catch {
    return null;
  }
}
function RC() {
  var t;
  try {
    (t = window.saveChatDebounced) == null || t.call(window);
  } catch {
    console.warn("[Engram] saveChatDebounced ");
  }
}
class Zx {
  constructor(r, a, l) {
    Xe(this, "config");
    Xe(this, "textProcessor");
    Xe(this, "llmAdapter");
    Xe(this, "currentChatId", null);
    Xe(this, "isRunning", !1);
    Xe(this, "isSummarizing", !1);
    Xe(this, "cancelRequested", !1);
    // 
    Xe(this, "unsubscribeMessage", null);
    Xe(this, "unsubscribeChat", null);
    Xe(this, "summaryHistory", []);
    // 
    Xe(this, "_lastSummarizedFloor", 0);
    const s = Ke.get("summarizerConfig");
    this.config = { ...Wx, ...s, ...r }, this.textProcessor = a || Kx, this.llmAdapter = l || vu;
  }
  // ====================  ====================
  // getInfoFromChatMetadata  saveToChatMetadata 
  //  WorldBookStateService
  /**
   * 
   */
  getFromChatMetadata(r) {
    const a = $y();
    if (a)
      return a.extensions || (a.extensions = {}), a.extensions[Mo] || (a.extensions[Mo] = {}), a.extensions[Mo][r];
  }
  /**
   * 
   */
  saveToChatMetadata(r, a) {
    const l = $y();
    l && (l.extensions || (l.extensions = {}), l.extensions[Mo] || (l.extensions[Mo] = {}), l.extensions[Mo][r] = a, this.log("debug", ` chat_metadata: ${r} = ${a}`), RC());
  }
  /**
   * 
   * V0.5:  memoryStore 
   * V0.8:  chatManager.getState() 
   */
  async getLastSummarizedFloor() {
    if (this._lastSummarizedFloor > 0) return this._lastSummarizedFloor;
    try {
      const { chatManager: r } = await Promise.resolve().then(() => _C), a = await r.getState();
      return this._lastSummarizedFloor = a.last_summarized_floor, this.log("debug", " DB  lastSummarizedFloor", { value: this._lastSummarizedFloor }), this._lastSummarizedFloor;
    } catch (r) {
      return this.log("warn", " lastSummarizedFloor  0", r), 0;
    }
  }
  /**
   * 
   * V0.5:  memoryStore (IndexedDB)
   */
  async setLastSummarizedFloor(r) {
    this._lastSummarizedFloor = r, await _l.getState().setLastSummarizedFloor(r);
  }
  // ====================  ====================
  /**
   * 
   */
  getCurrentFloor() {
    const r = Fy();
    return r != null && r.chat ? r.chat.length : 0;
  }
  /**
   *  ID
   */
  getCurrentChatId() {
    const r = Fy();
    return (r == null ? void 0 : r.chatId) || null;
  }
  // ====================  ====================
  /**
   * 
   * V0.5:  EventWatcher 
   */
  start() {
    if (this.isRunning) {
      this.log("warn", "");
      return;
    }
    this.initializeForCurrentChat(), Vh.start(), this.config.triggerMode === "auto" && (this.unsubscribeMessage = Vh.on(
      "onMessageReceived",
      this.handleMessageReceived.bind(this)
    ), this.log("debug", " EventWatcher ")), this.unsubscribeChat = Vh.on(
      "onChatChanged",
      this.handleChatChanged.bind(this)
    ), this.log("debug", " EventWatcher "), this.isRunning = !0;
    const r = this.getStatus();
    this.log("info", "", r);
  }
  /**
   *  ( 0)
   */
  async resetProgress() {
    await this.setLastSummarizedFloor(0), this.log("info", "");
  }
  /**
   * 
   */
  stop() {
    this.unsubscribeMessage && (this.unsubscribeMessage(), this.unsubscribeMessage = null), this.unsubscribeChat && (this.unsubscribeChat(), this.unsubscribeChat = null), this.isRunning = !1, this.log("info", "");
  }
  /**
   * 
   */
  async initializeForCurrentChat() {
    const r = this.getCurrentChatId(), a = this.getCurrentFloor();
    this.currentChatId = r, this.summaryHistory = [], this._lastSummarizedFloor = 0;
    const l = await this.getLastSummarizedFloor();
    this.log("info", "", {
      chatId: r,
      currentFloor: a,
      lastSummarizedFloor: l,
      pendingFloors: a - l
    });
  }
  // ====================  ====================
  /**
   * 
   */
  async handleMessageReceived() {
    const r = this.getCurrentFloor(), a = await this.getLastSummarizedFloor(), l = r - a;
    this.log("debug", "", {
      currentFloor: r,
      lastSummarized: a,
      pendingFloors: l,
      triggerAt: this.config.floorInterval
    }), l >= this.config.floorInterval && (this.log("info", "", {
      pendingFloors: l,
      interval: this.config.floorInterval
    }), await this.triggerSummary());
  }
  /**
   * 
   */
  handleChatChanged() {
    const r = this.getCurrentChatId();
    this.log("info", "", {
      from: this.currentChatId,
      to: r
    }), this.initializeForCurrentChat();
  }
  // ====================  ====================
  /**
   * /
   */
  async triggerSummary(r = !1) {
    var c, d, m;
    if (this.isSummarizing)
      return this.log("warn", ""), null;
    if (!this.config.enabled && !r)
      return this.log("debug", ""), null;
    const a = this.getCurrentFloor(), l = await this.getLastSummarizedFloor();
    this.isSummarizing = !0, this.cancelRequested = !1, this.log("info", "", {
      floorRange: [l + 1, a],
      manual: r
    });
    const s = wt.running("...", "Engram", () => {
      var g, p, v, x;
      this.cancelRequested = !0, this.log("info", "");
      try {
        (x = (v = (p = (g = window.SillyTavern) == null ? void 0 : g.getContext) == null ? void 0 : p.call(g)) == null ? void 0 : v.stopGeneration) == null || x.call(v), this.log("info", " stopGeneration");
      } catch (E) {
        this.log("warn", " stopGeneration ", E);
      }
      wt.warning("...", "Engram");
    });
    try {
      const { WorldBookSlotService: g } = await Promise.resolve().then(() => KE);
      await g.init();
      const p = this._lastSummarizedFloor + 1, v = this.config.bufferSize || 0, x = a - v;
      if (p > x)
        return r && wt.info(" ()", "Engram"), null;
      const E = this.config.floorInterval || 10, w = p + E - 1, _ = Math.min(x, w);
      if (p > _)
        return null;
      const A = [p, _];
      this.log("info", "", { startFloor: p, endFloor: _, currentFloor: a, buffer: v });
      const R = t6().slice(p - 1, _);
      if (this.log("info", "", {
        range: A,
        msgCount: R.length,
        firstMsg: (((c = R[0]) == null ? void 0 : c.mes) || "").substring(0, 20)
      }), R.length === 0)
        return this.log("warn", "", { floorRange: A }), null;
      const Z = {
        messages: R.map((L) => {
          const he = L.mes || L.content || L.message || "";
          return he || console.warn("[Engram] Message content is empty/undefined:", L), {
            role: L.is_user ? "user" : "assistant",
            content: he,
            name: L.name
          };
        }),
        floorRange: A,
        templateId: this.config.promptTemplateId || void 0
      }, K = R.map((L) => L.mes || L.content || L.message || "").join(`

`), ge = da.process(K, "input");
      this.log("debug", "", {
        originalLength: K.length,
        cleanedLength: ge.length
      });
      let de = "";
      try {
        const L = await St.getActivatedWorldInfo();
        L && (de = `
` + L + `

`, this.log("debug", "", { length: L.length }));
      } catch (L) {
        this.log("warn", "", { error: String(L) });
      }
      const I = Ke.getEnabledPromptTemplate("summary"), V = Hm("summary"), we = (I == null ? void 0 : I.systemPrompt) || (V == null ? void 0 : V.systemPrompt) || "", Te = (I == null ? void 0 : I.userPromptTemplate) || (V == null ? void 0 : V.userPromptTemplate) || "";
      let X = "";
      try {
        X = await St.getEngramSummariesContent(), X && this.log("debug", " Engram ", { length: X.length });
      } catch (L) {
        this.log("warn", " Engram ", { error: String(L) });
      }
      const oe = Te.replace("{{worldbookContext}}", de).replace("{{chatHistory}}", ge).replace("{{context}}", de).replace("{{engramSummaries}}", X);
      this.log("debug", "", {
        source: I ? "APIPresets" : "fallback",
        templateName: (I == null ? void 0 : I.name) || "default"
      });
      const se = Ir.logSend({
        type: "summarize",
        systemPrompt: we,
        userPrompt: oe,
        floorRange: Z.floorRange,
        model: Fm(),
        character: (d = ou()) == null ? void 0 : d.name
      }), Re = Date.now(), be = await this.llmAdapter.generate({
        systemPrompt: we,
        userPrompt: oe
      });
      if (Ir.logReceive(se, {
        response: be.content,
        status: be.success ? "success" : "error",
        error: be.error,
        duration: Date.now() - Re
      }), !be.success)
        return this.log("error", "LLM ", { error: be.error }), wt.error(`: ${be.error}`, "Engram "), null;
      if (this.cancelRequested)
        return this.log("info", ""), wt.info("", "Engram"), null;
      const je = this.textProcessor.clean(be.content), re = da.process(je, "output"), _e = await St.countTokens(re), fe = {
        id: Date.now().toString(),
        content: re,
        sourceFloors: Z.floorRange,
        timestamp: Date.now(),
        tokenCount: _e,
        writtenToWorldbook: !1
      };
      if (this.config.previewEnabled) {
        this.log("info", "", { result: fe });
        try {
          const L = await sp.requestRevision(
            "",
            `: ${Z.floorRange[0]} - ${Z.floorRange[1]}  | Token: ${_e}`,
            fe.content
          );
          fe.content = L, fe.tokenCount = await St.countTokens(L), this.log("info", "");
        } catch {
          return this.log("warn", ""), wt.info("", ""), null;
        }
      }
      const Ue = Dn(), O = ou();
      if (Ue && O)
        try {
          const L = await MC.run({
            jsonContent: fe.content,
            //  JSON
            sourceRange: {
              start: Z.floorRange[0],
              end: Z.floorRange[1]
            }
          });
          L.success ? this.log("info", "Pipeline ", {
            eventsCount: ((m = L.events) == null ? void 0 : m.length) || 0
          }) : this.log("warn", "Pipeline ", { error: L.error });
        } catch (L) {
          this.log("error", "Pipeline ", { error: String(L) });
        }
      if (fe.writtenToWorldbook = !0, await this.setLastSummarizedFloor(Z.floorRange[1]), this.summaryHistory.push(fe), wt.success(` ${Z.floorRange[0]}-${Z.floorRange[1]} `, "Engram"), this.config.autoHide) {
        const L = Z.floorRange[0] - 1, he = Z.floorRange[1] - 1;
        this.log("info", "", { startIndex: L, endIndex: he }), W9(L, he).catch((M) => {
          this.log("error", "", M);
        });
      }
      return fe;
    } catch (g) {
      const p = g instanceof Error ? g.message : String(g);
      return this.log("error", "", { error: p }), wt.error(`: ${p}`, "Engram "), null;
    } finally {
      wt.remove(s), this.isSummarizing = !1;
    }
  }
  // ====================  ====================
  /**
   * 
   */
  getStatus() {
    const r = this.getCurrentFloor(), a = this._lastSummarizedFloor;
    return {
      running: this.isRunning,
      currentFloor: r,
      lastSummarizedFloor: a,
      pendingFloors: Math.max(0, r - a),
      historyCount: this.summaryHistory.length,
      isSummarizing: this.isSummarizing
    };
  }
  /**
   * 
   */
  refreshStatus() {
    return this.initializeForCurrentChat(), this.getStatus();
  }
  /**
   * 
   */
  getConfig() {
    return { ...this.config };
  }
  /**
   * 
   */
  updateConfig(r) {
    this.config = { ...this.config, ...r }, Ke.set("summarizerConfig", this.config), this.log("debug", "", this.config);
  }
  /**
   * 
   */
  getHistory() {
    return [...this.summaryHistory];
  }
  /**
   * 
   */
  async resetBaseFloor() {
    const r = this.getCurrentFloor();
    await this.setLastSummarizedFloor(r), this.log("info", "", { currentFloor: r });
  }
  // ====================  ====================
  /**
   * 
   */
  async log(r, a, l) {
    try {
      const { Logger: s } = await Promise.resolve().then(() => Pm);
      s[r]("Summarizer", a, l);
    } catch {
      console.log(`[Summarizer] ${r}: ${a}`, l);
    }
  }
}
const Jx = new Zx(), e2 = {
  ...X5,
  keepRecentCount: 3,
  preserveOriginal: !1,
  previewEnabled: !0
};
class t2 {
  constructor(r, a) {
    Xe(this, "config");
    Xe(this, "llmAdapter");
    Xe(this, "isTrimming", !1);
    const l = Ke.get("trimmerConfig") || {};
    this.config = { ...e2, ...l, ...r }, this.llmAdapter = a || vu;
  }
  // ====================  ====================
  /**
   * 
   */
  getConfig() {
    return { ...this.config };
  }
  /**
   * 
   */
  updateConfig(r) {
    this.config = { ...this.config, ...r };
    const a = Ke.get("summarizerConfig") || {};
    Ke.set("summarizerConfig", {
      ...a,
      trimmer: this.config
    }), this.log("debug", "", this.config);
  }
  // ====================  ====================
  /**
   * 
   */
  async getStatus() {
    const r = St.findExistingWorldbook();
    if (!r)
      return {
        triggered: !1,
        triggerType: this.config.trigger,
        currentValue: 0,
        threshold: this.getThreshold(),
        pendingEntryCount: 0,
        isTrimming: this.isTrimming
      };
    const a = await St.getSummaryEntries(r), l = Math.max(0, a.length - this.config.keepRecentCount), s = await this.getCurrentTriggerValue(r, a), c = this.getThreshold();
    return {
      triggered: this.config.enabled && s >= c,
      triggerType: this.config.trigger,
      currentValue: s,
      threshold: c,
      pendingEntryCount: l,
      isTrimming: this.isTrimming
    };
  }
  /**
   * 
   */
  getThreshold() {
    switch (this.config.trigger) {
      case "token":
        return this.config.tokenLimit;
      case "count":
        return this.config.countLimit;
      default:
        return 0;
    }
  }
  /**
   * 
   */
  async getCurrentTriggerValue(r, a) {
    switch (this.config.trigger) {
      case "token":
        return await St.countSummaryTokens(r);
      case "count":
        return a.length;
      default:
        return 0;
    }
  }
  /**
   * 
   */
  async checkTrigger() {
    return (await this.getStatus()).triggered;
  }
  // ====================  ====================
  /**
   * 
   *  N 
   */
  async getEntriesToMerge() {
    const r = St.findExistingWorldbook();
    if (!r) return [];
    const a = await St.getSummaryEntries(r), l = this.config.keepRecentCount;
    return a.length <= l ? [] : a.slice(0, a.length - l);
  }
  /**
   * /
   */
  async triggerTrim(r = !1) {
    var s;
    if (this.isTrimming)
      return this.log("warn", ""), null;
    if (!this.config.enabled && !r)
      return this.log("debug", ""), null;
    const a = St.findExistingWorldbook();
    if (!a)
      return this.log("warn", ""), wt.warning(" Engram ", "Engram"), null;
    const l = await this.getEntriesToMerge();
    if (l.length < 2)
      return r && wt.info(" ( 2 )", "Engram"), null;
    this.isTrimming = !0, this.log("info", "", {
      entryCount: l.length,
      manual: r
    });
    try {
      const c = l.map((V) => St.parseFloorRangeFromName(V.name)).filter((V) => V !== null);
      if (c.length === 0)
        return this.log("error", ""), null;
      const d = Math.min(...c.map((V) => V[0])), m = Math.max(...c.map((V) => V[1])), g = [d, m], p = l.map((V) => {
        const we = St.parseFloorRangeFromName(V.name), Te = we ? `${we[0]}-${we[1]}` : `${V.name}`, X = V.content.replace(/\{\{\/\/.*?\}\}/gs, "").trim();
        return `${Te}
${X}`;
      }).join(`

---

`), v = Ke.getEnabledPromptTemplate("trim"), x = Hm("trim"), E = (v == null ? void 0 : v.systemPrompt) || (x == null ? void 0 : x.systemPrompt) || "", _ = ((v == null ? void 0 : v.userPromptTemplate) || (x == null ? void 0 : x.userPromptTemplate) || "").replace("{{engramSummaries}}", p).replace("{{context}}", p);
      this.log("debug", "", {
        source: v ? "APIPresets" : "fallback",
        templateName: (v == null ? void 0 : v.name) || "default",
        inputLength: p.length
      });
      const A = Ir.logSend({
        type: "trim",
        systemPrompt: E,
        userPrompt: _,
        floorRange: g,
        model: Fm(),
        character: (s = ou()) == null ? void 0 : s.name
      }), D = Date.now(), R = await this.llmAdapter.generate({
        systemPrompt: E,
        userPrompt: _
      });
      if (Ir.logReceive(A, {
        response: R.content,
        status: R.success ? "success" : "error",
        error: R.error,
        duration: Date.now() - D
      }), !R.success)
        return this.log("error", "LLM ", { error: R.error }), wt.error(`: ${R.error}`, "Engram "), null;
      const Z = da.process(R.content, "output"), K = await St.countTokens(Z), ge = Math.min(...l.map((V) => V.order)), de = {
        content: Z,
        tokenCount: K,
        sourceEntryIds: l.map((V) => V.uid),
        newFloorRange: g,
        newOrder: ge
      };
      if (this.config.previewEnabled) {
        this.log("info", "", { result: de });
        try {
          const V = await sp.requestRevision(
            "",
            ` ${l.length}  | : ${g[0]}-${g[1]}  | Token: ${K}`,
            de.content
          );
          de.content = V, de.tokenCount = await St.countTokens(V), this.log("info", "");
        } catch {
          return this.log("warn", ""), wt.info("", ""), null;
        }
      }
      return await this.writeCompactedEntry(a, de) ? (await this.removeOriginalEntries(a, de.sourceEntryIds), wt.success(
        ` ${l.length}  1  (${g[0]}-${g[1]} )`,
        "Engram"
      ), de) : (this.log("error", ""), null);
    } catch (c) {
      const d = c instanceof Error ? c.message : String(c);
      return this.log("error", "", { error: d }), wt.error(`: ${d}`, "Engram "), null;
    } finally {
      this.isTrimming = !1;
    }
  }
  /**
   * 
   */
  async writeCompactedEntry(r, a) {
    try {
      const l = `{{// ${JSON.stringify({
        floors: a.newFloorRange,
        tokens: a.tokenCount,
        timestamp: Date.now(),
        layer: 2,
        // 
        mergedFrom: a.sourceEntryIds.length
      })} }}`, s = `${a.content}

${l}`, c = await St.createEntry(r, {
        name: `_${a.newFloorRange[0]}-${a.newFloorRange[1]}`,
        content: s,
        keys: [lu],
        // 
        enabled: !0,
        constant: !0,
        order: a.newOrder
      });
      return c && this.log("success", "", {
        worldbook: r,
        floorRange: a.newFloorRange,
        order: a.newOrder
      }), c;
    } catch (l) {
      return this.log("error", "", { error: String(l) }), !1;
    }
  }
  /**
   * /
   */
  async removeOriginalEntries(r, a) {
    if (this.config.preserveOriginal) {
      for (const l of a)
        await St.updateEntry(r, l, { enabled: !1 });
      this.log("info", "", { count: a.length });
    } else
      await St.deleteEntries(r, a) && this.log("info", "", { count: a.length });
  }
  // ====================  ====================
  /**
   * 
   */
  log(r, a, l) {
    W[r]("Trimmer", a, l);
  }
}
new t2();
const ra = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  DEFAULT_REGEX_RULES: Io,
  DEFAULT_SUMMARIZER_CONFIG: Wx,
  DEFAULT_TRIMMER_CONFIG: e2,
  LLMAdapter: Fx,
  RegexProcessor: bd,
  SummarizerService: Zx,
  TextProcessor: Vx,
  TrimmerService: t2,
  llmAdapter: vu,
  regexProcessor: da,
  summarizerService: Jx,
  textProcessor: Kx
}, Symbol.toStringTag, { value: "Module" })), Nr = class Nr {
  /**
   *  Engram 
   */
  static async init() {
    var r, a;
    if (!this.isInitialized)
      try {
        const l = (a = (r = window.SillyTavern) == null ? void 0 : r.getContext) == null ? void 0 : a.call(r);
        if (!(l != null && l.registerMacro)) {
          W.warn("MacroService", "SillyTavern registerMacro API ");
          return;
        }
        l.registerMacro(
          "engramSummaries",
          () => Nr.cachedSummaries,
          "Engram:  ( IndexedDB)"
        ), l.registerMacro(
          "worldbookContext",
          () => Nr.cachedWorldbookContext,
          "Engram: "
        ), l.registerMacro(
          "userInput",
          () => Nr.cachedUserInput,
          "Engram: "
        ), l.registerMacro(
          "chatHistory",
          (c) => Nr.getChatHistory(c),
          "Engram:  (: , 20)"
        ), l.registerMacro(
          "context",
          () => Nr.cachedCharDescription,
          "Engram: "
        ), this.isInitialized = !0, W.success("MacroService", "", {
          macros: ["{{engramSummaries}}", "{{worldbookContext}}", "{{userInput}}", "{{chatHistory}}", "{{context}}"]
        }), await this.refreshCache();
        const s = l.eventSource;
        s && s.on("chat_id_changed", () => {
          this.refreshCache().catch((c) => W.warn("MacroService", "", c));
        });
      } catch (l) {
        W.error("MacroService", "", l);
      }
  }
  /**
   * 
   */
  static setUserInput(r) {
    this.cachedUserInput = r;
  }
  /**
   *  -  IndexedDB 
   * @param recalledIds RAG  ID 
   */
  static async refreshCache(r) {
    try {
      const a = _l.getState();
      this.cachedSummaries = await a.getEventSummaries(r);
      try {
        const l = await St.getActivatedWorldInfo(), s = await this.processEJSMacros([l]);
        this.cachedWorldbookContext = s[0] || "";
      } catch (l) {
        W.debug("MacroService", "", l), this.cachedWorldbookContext = "";
      }
      this.refreshCharDescription(), W.debug("MacroService", "", {
        summariesLength: this.cachedSummaries.length,
        worldbookLength: this.cachedWorldbookContext.length,
        recalledCount: (r == null ? void 0 : r.length) ?? 0
      });
    } catch (a) {
      W.warn("MacroService", "", a);
    }
  }
  /**
   * V0.8.5:  RAG 
   * 
   * @param nodes RAG 
   */
  static async refreshCacheWithNodes(r) {
    try {
      this.cachedSummaries = r.map((a) => a.summary).join(`

---

`);
      try {
        const a = await St.getActivatedWorldInfo(), l = await this.processEJSMacros([a]);
        this.cachedWorldbookContext = l[0] || "";
      } catch (a) {
        W.debug("MacroService", "", a), this.cachedWorldbookContext = "";
      }
      this.refreshCharDescription(), W.debug("MacroService", "RAG ", {
        summariesLength: this.cachedSummaries.length,
        nodeCount: r.length
      });
    } catch (a) {
      W.warn("MacroService", " RAG ", a);
    }
  }
  /**
   *  ST-Prompt-Template ()  EJS 
   * V0.8.6:  window.EjsTemplate API ( test/.js)
   */
  static async processEJSMacros(r) {
    if (r.length === 0) return r;
    if (!window.EjsTemplate || typeof window.EjsTemplate.evalTemplate != "function")
      return W.debug("MacroService", "ST-Prompt-Template  EJS "), r;
    try {
      const a = await window.EjsTemplate.prepareContext();
      if (typeof window.Mvu < "u" && window.Mvu.getMvuData)
        try {
          const s = window.Mvu.getMvuData({ type: "message", message_id: "latest" });
          s && s.stat_data && (a.mvu = s.stat_data);
        } catch (s) {
          W.warn("MacroService", " MVU ", s);
        }
      return await Promise.all(r.map(async (s) => {
        try {
          return await window.EjsTemplate.evalTemplate(s, a);
        } catch (c) {
          return W.warn("MacroService", "EJS ", c), s;
        }
      }));
    } catch (a) {
      return W.warn("MacroService", "EJS ", a), r;
    }
  }
  /**
   *  ()
   * @param depthStr  ( 20)
   */
  static getChatHistory(r) {
    var a, l;
    try {
      let s = 20;
      if (r) {
        const m = parseInt(r, 10);
        !isNaN(m) && m > 0 && (s = m);
      }
      W.debug("MacroService", "getChatHistory called", { depthStr: r, limit: s });
      const c = (l = (a = window.SillyTavern) == null ? void 0 : a.getContext) == null ? void 0 : l.call(a), d = window.TavernHelper;
      if (c != null && c.chat && Array.isArray(c.chat)) {
        const m = c.chat.slice(-s);
        return W.debug("MacroService", "Got recent messages", { count: m.length }), m.map((g, p) => {
          let v = g.mes || "";
          const x = v;
          if (d && typeof d.formatAsTavernRegexedString == "function")
            try {
              v = d.formatAsTavernRegexedString(v, "ai_output", { isPrompt: !0 });
            } catch (E) {
              W.warn("MacroService", "", E);
            }
          return v = da.process(v, "both"), (p === 0 || p === m.length - 1) && W.debug("MacroService", "Message processed", {
            index: p,
            original: x.substring(0, 50),
            processed: v.substring(0, 50)
          }), v;
        }).join(`
`);
      }
      return W.warn("MacroService", "Context chat is empty or invalid"), "";
    } catch (s) {
      return W.debug("MacroService", "", s), "";
    }
  }
  /**
   * 
   */
  static refreshCharDescription() {
    var r, a;
    try {
      const l = (a = (r = window.SillyTavern) == null ? void 0 : r.getContext) == null ? void 0 : a.call(r);
      if (l != null && l.characters && l.characterId >= 0) {
        const s = l.characters[l.characterId];
        this.cachedCharDescription = (s == null ? void 0 : s.description) || "";
      }
    } catch (l) {
      W.debug("MacroService", "", l);
    }
  }
};
Xe(Nr, "isInitialized", !1), // ---  ---
Xe(Nr, "cachedSummaries", ""), Xe(Nr, "cachedWorldbookContext", ""), Xe(Nr, "cachedUserInput", ""), Xe(Nr, "cachedCharDescription", "");
let zi = Nr;
const n2 = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  MacroService: zi
}, Symbol.toStringTag, { value: "Module" })), Yh = {
  openai: "https://api.openai.com/v1/embeddings",
  ollama: "http://localhost:11434/api/embeddings",
  vllm: "http://localhost:8000/v1/embeddings",
  cohere: "https://api.cohere.ai/v1/embed",
  jina: "https://api.jina.ai/v1/embeddings",
  voyage: "https://api.voyageai.com/v1/embeddings"
}, OC = 5;
class DC {
  constructor() {
    Xe(this, "config", null);
    Xe(this, "concurrency", OC);
    Xe(this, "stopSignal", !1);
  }
  /**
   * 
   */
  setConfig(r) {
    this.config = r;
  }
  /**
   * 
   */
  setConcurrency(r) {
    this.concurrency = Math.max(1, Math.min(20, r));
  }
  /**
   * 
   */
  stop() {
    this.stopSignal = !0;
  }
  /**
   * 
   */
  reset() {
    this.stopSignal = !1;
  }
  // ====================  ====================
  /**
   * 
   */
  async embed(r) {
    if (!this.config)
      throw new Error("EmbeddingService: config not set");
    const a = await this.embedBatch([{ id: "single", text: r }]);
    if (a[0].error)
      throw new Error(a[0].error);
    return a[0].embedding;
  }
  /**
   *  ()
   */
  async embedBatch(r, a) {
    if (!this.config)
      throw new Error("EmbeddingService: config not set");
    this.stopSignal = !1;
    const l = new Array(r.length);
    let s = 0, c = 0;
    const d = async (m) => {
      if (m >= r.length || this.stopSignal) return;
      const g = r[m];
      try {
        const p = await this.callEmbeddingAPI(g.text);
        l[m] = { id: g.id, embedding: p };
      } catch (p) {
        c++, l[m] = { id: g.id, embedding: [], error: p.message }, W.warn("EmbeddingService", `: ${g.id}`, { error: p.message });
      } finally {
        s++, a == null || a(s, r.length, c);
      }
    };
    for (let m = 0; m < r.length && !this.stopSignal; m += this.concurrency) {
      const g = Array.from(
        { length: Math.min(this.concurrency, r.length - m) },
        (p, v) => d(m + v)
      );
      await Promise.all(g);
    }
    return l;
  }
  /**
   *  API
   */
  async callEmbeddingAPI(r) {
    const a = this.config;
    switch (a.source) {
      case "openai":
      case "custom":
      case "vllm":
      case "jina":
      case "voyage":
        return this.callOpenAICompatible(r, a);
      case "ollama":
        return this.callOllama(r, a);
      case "cohere":
        return this.callCohere(r, a);
      case "transformers":
        return this.callTransformers(r, a);
      default:
        throw new Error(`Unsupported vector source: ${a.source}`);
    }
  }
  /**
   * OpenAI  API 
   */
  async callOpenAICompatible(r, a) {
    let l = a.apiUrl || Yh[a.source] || "";
    if ((a.source === "custom" || a.source === "openai") && l) {
      const d = l.replace(/\/+$/, "");
      !d.endsWith("embeddings") && !d.endsWith("embed") && (d.endsWith("/v1") ? l = `${d}/embeddings` : l = `${d}/v1/embeddings`, W.debug("EmbeddingService", ` API URL: ${a.apiUrl} -> ${l}`));
    }
    if (!l)
      throw new Error("API endpoint not configured");
    const s = {
      "Content-Type": "application/json"
    };
    a.apiKey && (s.Authorization = `Bearer ${a.apiKey}`);
    const c = {
      model: a.model || "text-embedding-3-small",
      input: r
    };
    a.dimensions && (c.dimensions = a.dimensions);
    try {
      const d = await fetch(l, {
        method: "POST",
        headers: s,
        body: JSON.stringify(c)
      });
      if (!d.ok) {
        const g = await d.text();
        throw new Error(`API error ${d.status} at ${l}: ${g}`);
      }
      const m = await d.json();
      if (!m.data || m.data.length === 0)
        throw new Error("No embedding data returned");
      return m.data[0].embedding;
    } catch (d) {
      throw d.message.includes("at http") ? d : new Error(`Request to ${l} failed: ${d.message}`);
    }
  }
  /**
   * Ollama API 
   */
  async callOllama(r, a) {
    const l = a.apiUrl || Yh.ollama, s = l.includes("/api/embed") && !l.includes("/api/embeddings"), c = {
      model: a.model || "nomic-embed-text"
    };
    s ? c.input = r : c.prompt = r;
    const d = await fetch(l, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(c)
    });
    if (!d.ok) {
      const g = await d.text();
      throw new Error(`Ollama error ${d.status}: ${g}`);
    }
    const m = await d.json();
    if (m.embedding)
      return m.embedding;
    if (m.embeddings && m.embeddings.length > 0)
      return m.embeddings[0];
    throw new Error(`No embedding data returned in Ollama response. Keys: ${Object.keys(m).join(", ")}`);
  }
  /**
   * Cohere API 
   */
  async callCohere(r, a) {
    const l = Yh.cohere, s = await fetch(l, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        Authorization: `Bearer ${a.apiKey}`
      },
      body: JSON.stringify({
        model: a.model || "embed-multilingual-v3.0",
        texts: [r],
        input_type: "search_document"
      })
    });
    if (!s.ok) {
      const d = await s.text();
      throw new Error(`Cohere error ${s.status}: ${d}`);
    }
    const c = await s.json();
    if (!c.embeddings || c.embeddings.length === 0)
      throw new Error("No embedding data returned");
    return c.embeddings[0];
  }
  /**
   *  Transformers  ()
   */
  async callTransformers(r, a) {
    throw new Error("Transformers embedding not yet implemented");
  }
  // ==================== EventNode  ====================
  /**
   *  EventNode 
   * @param onProgress 
   * @returns 
   */
  async embedUnprocessedEvents(r) {
    const a = Dn();
    if (!a)
      throw new Error("No current chat");
    const l = kl(a), s = await l.events.filter((p) => !p.is_embedded && !p.embedding).toArray();
    if (s.length === 0)
      return { success: 0, failed: 0 };
    W.info("EmbeddingService", ` ${s.length} `);
    const c = s.map((p) => ({
      id: p.id,
      text: p.summary
    })), d = await this.embedBatch(c, r);
    let m = 0, g = 0;
    for (const p of d) {
      if (p.error || p.embedding.length === 0) {
        g++;
        continue;
      }
      await l.events.update(p.id, {
        embedding: p.embedding,
        is_embedded: !0
      }), m++;
    }
    return W.info("EmbeddingService", `: ${m} , ${g} `), { success: m, failed: g };
  }
  /**
   * 
   */
  async embedEvents(r, a) {
    if (r.length === 0)
      return { success: 0, failed: 0 };
    const l = Dn();
    if (!l) throw new Error("No current chat");
    const s = kl(l), c = r.map((p) => ({
      id: p.id,
      text: p.summary
    })), d = await this.embedBatch(c, a);
    let m = 0, g = 0;
    for (const p of d) {
      if (p.error || p.embedding.length === 0) {
        g++;
        continue;
      }
      await s.events.update(p.id, {
        embedding: p.embedding,
        is_embedded: !0
      }), m++;
    }
    return { success: m, failed: g };
  }
  /**
   *  EventNode 
   */
  async embedEvent(r) {
    const a = await this.embed(r.summary), l = Dn();
    if (l) {
      const s = Li(l);
      s && await s.events.update(r.id, {
        embedding: a,
        is_embedded: !0
      });
    }
    return a;
  }
  /**
   *  ()
   */
  async reembedAllEvents(r) {
    const a = Dn();
    if (!a)
      throw new Error("No current chat");
    const l = kl(a), s = await l.events.toArray();
    if (s.length === 0)
      return { success: 0, failed: 0 };
    W.info("EmbeddingService", ` ${s.length} `);
    for (const c of s)
      await l.events.update(c.id, {
        embedding: void 0,
        is_embedded: !1
      });
    return this.embedUnprocessedEvents(r);
  }
  // ====================  ====================
  /**
   * 
   */
  cosineSimilarity(r, a) {
    if (!r || !a || r.length !== a.length) return 0;
    let l = 0, s = 0, c = 0;
    for (let m = 0; m < r.length; m++)
      l += r[m] * a[m], s += r[m] * r[m], c += a[m] * a[m];
    const d = Math.sqrt(s) * Math.sqrt(c);
    return d === 0 ? 0 : l / d;
  }
  /**
   * 
   */
  async getEmbeddingStats() {
    const r = Dn();
    if (!r)
      return { total: 0, embedded: 0, pending: 0 };
    const a = Li(r);
    if (!a)
      return { total: 0, embedded: 0, pending: 0 };
    const l = await a.events.toArray(), s = l.filter((c) => c.is_embedded).length;
    return {
      total: l.length,
      embedded: s,
      pending: l.length - s
    };
  }
}
const Nn = new DC(), Sl = class Sl {
  constructor() {
  }
  static getInstance() {
    return Sl.instance || (Sl.instance = new Sl()), Sl.instance;
  }
  /**
   *  Rerank 
   */
  getConfig() {
    const r = Ke.get("apiSettings");
    return (r == null ? void 0 : r.rerankConfig) || null;
  }
  /**
   *  Rerank 
   */
  isEnabled() {
    const r = this.getConfig();
    return !!(r != null && r.enabled && r.url && r.model);
  }
  /**
   *  Rerank API 
   *
   * @param query 
   * @param documents 
   * @returns 
   */
  async rerank(r, a) {
    var s;
    const l = this.getConfig();
    if (!(l != null && l.enabled))
      return W.debug("RerankService", "Rerank "), a.map((c, d) => ({ index: d, relevance_score: 0 }));
    if (!l.url || !l.model)
      return W.warn("RerankService", "Rerank ", { url: l.url, model: l.model }), a.map((c, d) => ({ index: d, relevance_score: 0 }));
    if (a.length === 0)
      return [];
    try {
      const c = l.url.endsWith("/rerank") ? l.url : `${l.url.replace(/\/$/, "")}/rerank`;
      W.debug("RerankService", " Rerank API", {
        endpoint: c,
        model: l.model,
        queryLength: r.length,
        documentCount: a.length
      });
      const d = await fetch(c, {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          ...l.apiKey && {
            Authorization: `Bearer ${l.apiKey}`
          }
        },
        body: JSON.stringify({
          model: l.model,
          query: r,
          documents: a,
          top_n: l.topN || 5
        })
      });
      if (!d.ok) {
        const p = await d.text();
        throw new Error(`Rerank API  (${d.status}): ${p}`);
      }
      const m = await d.json(), g = m.results || m.data || [];
      return W.info("RerankService", "Rerank ", {
        resultCount: g.length,
        topScore: (s = g[0]) == null ? void 0 : s.relevance_score
      }), g.sort((p, v) => v.relevance_score - p.relevance_score);
    } catch (c) {
      const d = c instanceof Error ? c.message : "";
      return W.error("RerankService", "Rerank ", { error: d }), a.map((m, g) => ({ index: g, relevance_score: 0 }));
    }
  }
  /**
   *  (alpha)
   * 0 = 1 =  Rerank 
   */
  getHybridAlpha() {
    const r = this.getConfig();
    return (r == null ? void 0 : r.hybridAlpha) ?? 0.5;
  }
};
Xe(Sl, "instance");
let _m = Sl;
const Qh = _m.getInstance();
function LC(t, r, a) {
  return t == null && r == null ? 0 : t == null ? r ?? 0 : r == null ? t : (1 - a) * t + a * r;
}
function Nm(t, r) {
  var l;
  const a = t.map((s) => ({
    ...s,
    hybridScore: LC(
      s.embeddingScore,
      s.rerankScore,
      r
    )
  }));
  return a.sort((s, c) => (c.hybridScore ?? 0) - (s.hybridScore ?? 0)), W.debug("HybridScorer", "", {
    candidateCount: a.length,
    topScore: (l = a[0]) == null ? void 0 : l.hybridScore,
    alpha: r
  }), a;
}
function BC(t, r, a, l) {
  for (const c of r) {
    const d = a[c.index];
    if (d && t.has(d.id)) {
      const m = t.get(d.id);
      m.rerankScore = c.relevance_score;
    }
  }
  const s = Array.from(t.values());
  return Nm(s, l);
}
function IC(t, r, a) {
  if (!a.enabled)
    return t;
  const l = t.map((s) => {
    const c = r.getStickyPenalty(s.id, a), m = (s.hybridScore ?? s.embeddingScore ?? 0) * (1 - c);
    return {
      ...s,
      hybridScore: m,
      stickyPenalty: c,
      isSticky: c > 0
    };
  });
  return l.sort((s, c) => (c.hybridScore ?? 0) - (s.hybridScore ?? 0)), W.debug("HybridScorer", "", {
    totalCandidates: t.length,
    stickyCount: l.filter((s) => s.isSticky).length,
    maxPenalty: Math.max(...l.map((s) => s.stickyPenalty ?? 0))
  }), l;
}
class UC {
  constructor() {
    Xe(this, "logs", []);
    Xe(this, "maxLogs", 50);
    Xe(this, "subscribers", /* @__PURE__ */ new Set());
  }
  /**
   * 
   */
  log(r) {
    const a = {
      id: `recall-${Date.now()}-${Math.random().toString(36).slice(2, 8)}`,
      timestamp: Date.now(),
      ...r
    };
    this.logs.unshift(a), this.logs.length > this.maxLogs && (this.logs = this.logs.slice(0, this.maxLogs)), W.debug("RecallLogService", "", {
      query: r.query.substring(0, 50),
      resultCount: r.results.length
    }), this.notifySubscribers();
  }
  /**
   * 
   */
  getLogs() {
    return [...this.logs];
  }
  /**
   * 
   */
  clear() {
    this.logs = [], this.notifySubscribers();
  }
  /**
   * 
   */
  subscribe(r) {
    return this.subscribers.add(r), () => this.subscribers.delete(r);
  }
  /**
   * 
   */
  notifySubscribers() {
    const r = this.getLogs();
    this.subscribers.forEach((a) => a(r));
  }
  /**
   *  JSON 
   */
  exportLogs() {
    const { VERSION: r } = require("@/constants"), a = {
      version: r,
      exportedAt: Date.now(),
      logs: this.getLogs()
    }, l = new Blob([JSON.stringify(a, null, 2)], { type: "application/json" }), s = URL.createObjectURL(l), c = document.createElement("a");
    c.href = s, c.download = `engram_debug_log_${(/* @__PURE__ */ new Date()).toISOString().replace(/[:.]/g, "-")}.json`, document.body.appendChild(c), c.click(), document.body.removeChild(c), URL.revokeObjectURL(s);
  }
}
const Xc = new UC();
class PC {
  /**
   * 
   */
  getRecallConfig() {
    const r = Ke.get("apiSettings");
    return (r == null ? void 0 : r.recallConfig) || fd;
  }
  /**
   * 
   * 
   */
  async hasVectorizedNodes() {
    const r = Dn();
    if (!r) return !1;
    const a = Li(r);
    return a ? await a.events.filter((s) => !!s.embedding && s.embedding.length > 0).limit(1).count() > 0 : !1;
  }
  /**
   * 
   */
  getVectorConfig() {
    const r = Ke.get("apiSettings");
    return r == null ? void 0 : r.vectorConfig;
  }
  /**
   *  Rerank 
   */
  getRerankConfig() {
    const r = Ke.get("apiSettings");
    return (r == null ? void 0 : r.rerankConfig) || null;
  }
  /**
   * 
   *
   * @param userInput 
   * @param unifiedQueries  ()
   * @returns 
   */
  async search(r, a) {
    const l = this.getRecallConfig(), s = this.getVectorConfig();
    if (l.useEmbedding && s && Nn.setConfig(s), Gs.nextRound(), !l.enabled) {
      W.debug("Retriever", "");
      const c = (s == null ? void 0 : s.topK) || 20;
      return this.rollingSearch(c);
    }
    if (l.useBruteForce) {
      W.debug("Retriever", " ()");
      const c = (s == null ? void 0 : s.topK) || 20;
      return this.rollingSearch(c);
    }
    return l.useEmbedding ? this.hybridSearch(r, a, l) : this.rollingSearch(config.embedding.topK);
  }
  /**
   * Embedding + Rerank
   */
  async hybridSearch(r, a, l) {
    const s = Date.now(), c = Date.now(), d = await this.doEmbeddingSearch(
      r,
      a,
      l
    ), m = Date.now() - c;
    if (d.length === 0)
      return W.debug("Retriever", "Embedding "), { entries: [], nodes: [] };
    let g = d, p = 0;
    if (l.useRerank && Qh.isEnabled()) {
      const A = Date.now(), D = (a == null ? void 0 : a[0]) || r, R = d.map((de) => de.summary), Z = await Qh.rerank(D, R);
      p = Date.now() - A;
      const K = new Map(d.map((de) => [de.id, de])), ge = Qh.getHybridAlpha();
      g = BC(
        K,
        Z,
        d,
        ge
      ), W.info("Retriever", "", {
        embeddingCount: d.length,
        rerankCount: Z.length,
        finalCount: g.length,
        embeddingTime: m,
        rerankTime: p
      });
    } else
      g = Nm(d, 0);
    const v = l.sticky || Nb;
    v.enabled && (g = IC(g, Gs, v), W.debug("Retriever", "", {
      candidatesWithPenalty: g.filter((A) => (A.stickyPenalty || 0) > 0).length
    }));
    const x = Date.now() - s;
    Xc.log({
      query: r,
      preprocessedQuery: a == null ? void 0 : a[0],
      mode: "hybrid",
      results: g.map((A) => {
        var D, R, Z, K;
        return {
          eventId: A.id,
          summary: A.summary,
          category: ((R = (D = A.node) == null ? void 0 : D.structured_kv) == null ? void 0 : R.event) || "unknown",
          embeddingScore: A.embeddingScore || 0,
          rerankScore: A.rerankScore,
          hybridScore: A.hybridScore,
          isTopK: !0,
          isReranked: A.rerankScore != null,
          sourceFloor: (K = (Z = A.node) == null ? void 0 : Z.source_range) == null ? void 0 : K.start_index
        };
      }),
      stats: {
        totalCandidates: d.length,
        topKCount: d.length,
        rerankCount: g.length,
        latencyMs: x
      }
    });
    const E = g.map((A) => A.id);
    Gs.markRecalledBatch(E), Gs.cleanup(10);
    const w = g.filter((A) => A.node).map((A) => A.node), _ = g.map((A) => A.summary);
    return W.info("Retriever", "", {
      useEmbedding: l.useEmbedding,
      useRerank: l.useRerank,
      totalTime: x,
      resultCount: w.length,
      stickyRound: Gs.getCurrentRound()
    }), { entries: _, nodes: w };
  }
  /**
   *  Embedding  ()
   */
  async embeddingOnlySearch(r, a, l) {
    const s = await this.doEmbeddingSearch(r, a, l), c = Nm(s, 0), d = c.filter((g) => g.node).map((g) => g.node);
    return { entries: c.map((g) => g.summary), nodes: d };
  }
  /**
   *  Embedding 
   */
  async doEmbeddingSearch(r, a, l) {
    var x, E;
    const s = Dn();
    if (!s)
      return [];
    const c = Li(s);
    if (!c)
      return [];
    const d = await c.events.filter((w) => !!w.embedding && w.embedding.length > 0).toArray();
    if (d.length === 0)
      return W.debug("Retriever", ""), [];
    const m = a && a.length > 0 ? a : [r];
    W.debug("Retriever", "", {
      queryCount: m.length,
      eventCount: d.length
    });
    const g = /* @__PURE__ */ new Map();
    for (const w of m)
      try {
        const _ = await Nn.embed(w);
        for (const A of d) {
          if (!A.embedding) continue;
          const D = Nn.cosineSimilarity(
            _,
            A.embedding
          ), R = ((x = l.embedding) == null ? void 0 : x.minScoreThreshold) ?? 0.3;
          if (D < R) continue;
          const Z = g.get(A.id);
          (!Z || D > (Z.embeddingScore || 0)) && g.set(A.id, {
            id: A.id,
            summary: A.summary,
            embeddingScore: D,
            node: A
          });
        }
      } catch (_) {
        W.error("Retriever", `Query : ${w}`, {
          message: (_ == null ? void 0 : _.message) || _,
          stack: _ == null ? void 0 : _.stack
        });
      }
    const p = this.getVectorConfig(), v = Array.from(g.values()).sort((w, _) => (_.embeddingScore || 0) - (w.embeddingScore || 0)).slice(0, (p == null ? void 0 : p.topK) || 20);
    return W.debug("Retriever", "Embedding ", {
      totalMatched: g.size,
      topK: v.length,
      topScore: (E = v[0]) == null ? void 0 : E.embeddingScore
    }), v;
  }
  /**
   *  ()
   * 
   */
  async rollingSearch(r) {
    const a = Dn();
    if (!a)
      return { entries: [], nodes: [] };
    const l = Li(a);
    if (!l)
      return { entries: [], nodes: [] };
    const s = await l.events.filter((g) => g.level === 0).reverse().limit(r).toArray(), c = await l.events.filter((g) => g.level === 1).reverse().first(), d = [...s];
    return c && d.unshift(c), { entries: d.map((g) => g.summary), nodes: d };
  }
  /**
   * @deprecated  search() 
   */
  async vectorSearch(r, a) {
    return this.search(r);
  }
}
const Gy = new PC();
class r2 {
  constructor() {
    Xe(this, "isInitialized", !1);
    Xe(this, "isProcessing", !1);
  }
  // 
  /**
   * Initialize the Injector
   */
  init() {
    this.isInitialized || (W.info("Injector", " V0.8 ..."), console.log("[Injector] Starting initialization..."), Ar.on(
      Ur.GENERATION_AFTER_COMMANDS,
      async (r, a, l) => {
        console.log("[Injector]  GENERATION_AFTER_COMMANDS triggered", { type: r, dryRun: l }), W.info("Injector", "  GENERATION_AFTER_COMMANDS ", { type: r, dryRun: l }), await this.handleGenerationAfterCommands(r, a, l);
      }
    ), Ar.on(Ur.CHAT_CHANGED, () => {
      W.debug("Injector", " CHAT_CHANGED "), this.isProcessing = !1, zi.refreshCache().catch((r) => {
        W.warn("Injector", "", r);
      });
    }), this.isInitialized = !0, W.success("Injector", "V0.8 Injector "), console.log("[Injector]  V0.8 Initialized - Listening for GENERATION_AFTER_COMMANDS"));
  }
  /**
   *  GENERATION_AFTER_COMMANDS 
   *  async  await
   */
  async handleGenerationAfterCommands(r, a, l) {
    try {
      if (l) {
        W.debug("Injector", "dryRun ");
        return;
      }
      if (r === "regenerate" || r === "swipe" || r === "quiet" || r === "impersonate") {
        W.debug("Injector", ` ${r} `);
        return;
      }
      if (a._engram_processed) {
        W.debug("Injector", "");
        return;
      }
      if (this.isProcessing) {
        W.debug("Injector", "");
        return;
      }
      const s = Dn();
      if (!s) {
        W.warn("Injector", " ID");
        return;
      }
      const c = Fa();
      if (!c || !c.chat || c.chat.length === 0) {
        W.warn("Injector", "");
        return;
      }
      const d = c.chat, m = d.length - 1, g = d[m];
      let p = "", v = "chat";
      if (g && g.is_user)
        p = g.mes;
      else {
        const D = document.getElementById("send_textarea");
        if (D && D.value && D.value.trim().length > 0)
          p = D.value, v = "textarea", W.info("Injector", " Textarea  (Strategy 2)", {
            preview: p.substring(0, 50)
          });
        else {
          W.debug("Injector", "", {
            index: m,
            isUser: g == null ? void 0 : g.is_user
          });
          return;
        }
      }
      if (!p || p.trim().length === 0) {
        W.debug("Injector", "");
        return;
      }
      W.debug("Injector", "...");
      let x, E, w;
      try {
        if (x = Ke.get("apiSettings"), W.debug("Injector", " apiSettings"), E = (x == null ? void 0 : x.recallConfig) || fd, W.debug("Injector", " recallConfig", E), !ia)
          throw new Error("Preprocessor service is undefined");
        w = ia.getConfig(), W.debug("Injector", " preprocessorConfig", w);
      } catch (D) {
        throw W.error("Injector", "", D), D;
      }
      if (W.info("Injector", "", {
        chatId: s,
        userInputLength: p.length,
        userInputPreview: p.substring(0, 50) + "...",
        recallEnabled: E.enabled,
        preprocessingEnabled: E.usePreprocessing && w.enabled,
        autoTrigger: w.autoTrigger,
        templateId: w.templateId
      }), E.usePreprocessing && w.enabled && !w.autoTrigger && (W.debug("Injector", " autoTrigger "), !E.enabled))
        return;
      this.isProcessing = !0, a._engram_processed = !0, g && (g._engram_processed = !0), W.info("Injector", " ...");
      let _ = p, A = [];
      try {
        if (E.usePreprocessing && w.enabled && w.autoTrigger)
          try {
            zi.setUserInput(p), await zi.refreshCache();
            const D = await ia.process(p);
            if (D.success && D.output) {
              W.success("Injector", " ", {
                outputLength: D.output.length,
                hasQuery: !!D.query
              });
              const R = Ke.getPromptTemplateById(w.templateId), Z = (R == null ? void 0 : R.injectionMode) || "replace";
              Z === "append" ? _ = `${p}

${D.output}` : Z === "prepend" ? _ = `${D.output}

${p}` : _ = D.output, D.query && A.push(D.query);
            } else
              W.warn("Injector", "");
          } catch (D) {
            W.warn("Injector", " ", D);
          }
        if (E.enabled)
          try {
            if (!await Gy.hasVectorizedNodes())
              W.info("Injector", " RAG ");
            else {
              W.info("Injector", "  RAG ", {
                queryCount: A.length,
                firstQuery: A[0] || p.substring(0, 50)
              });
              const R = await Gy.search(
                p,
                A.length > 0 ? A : void 0
              );
              R.nodes.length > 0 ? (W.info("Injector", " RAG ", {
                nodeCount: R.nodes.length,
                entries: R.entries.length
              }), await zi.refreshCacheWithNodes(R.nodes)) : W.debug("Injector", "RAG ");
            }
          } catch (D) {
            W.error("Injector", "RAG ", D);
          }
        if (_ = da.process(_, "output"), _ !== p) {
          if (v === "chat") {
            g.mes = _;
            try {
              const D = c.eventSource, R = c.event_types;
              D && (R != null && R.MESSAGE_UPDATED) && (D.emit(R.MESSAGE_UPDATED, m), W.debug("Injector", " MESSAGE_UPDATED "));
            } catch (D) {
              W.warn("Injector", " MESSAGE_UPDATED ", D);
            }
            try {
              const D = document.getElementById("send_textarea");
              D && D.value === p && (D.value = "", D.dispatchEvent(new Event("input", { bubbles: !0 })));
            } catch {
            }
          } else if (v === "textarea") {
            W.info("Injector", " Textarea (Strategy 2)");
            try {
              const D = document.getElementById("send_textarea");
              D && (D.value = _, D.dispatchEvent(new Event("input", { bubbles: !0 }))), a && (a.prompt = _);
            } catch (D) {
              W.warn("Injector", " Textarea ", D);
            }
          }
        }
      } finally {
        setTimeout(() => {
          this.isProcessing = !1;
        }, 1e3);
      }
    } catch (s) {
      this.isProcessing = !1, W.error("Injector", "handleGenerationAfterCommands ", {
        message: (s == null ? void 0 : s.message) || s,
        stack: s == null ? void 0 : s.stack
      }), console.error("[Injector] Error:", s);
    }
  }
}
const qC = new r2(), HC = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  Injector: r2,
  injector: qC
}, Symbol.toStringTag, { value: "Module" }));
class a2 {
  static init() {
    if (!this.isInitialized)
      try {
        const r = Fa();
        if (!(r != null && r.eventSource) || !(r != null && r.event_types)) {
          W.warn("CharacterDeleteService", "");
          return;
        }
        r.event_types.CHARACTER_DELETED && (r.eventSource.on(r.event_types.CHARACTER_DELETED, this.onCharacterDeleted.bind(this)), W.info("CharacterDeleteService", " CHARACTER_DELETED ")), r.event_types.CHAT_DELETED && (r.eventSource.on(r.event_types.CHAT_DELETED, this.onChatDeleted.bind(this)), W.info("CharacterDeleteService", " CHAT_DELETED ")), r.event_types.GROUP_CHAT_DELETED && (r.eventSource.on(r.event_types.GROUP_CHAT_DELETED, this.onChatDeleted.bind(this)), W.info("CharacterDeleteService", " GROUP_CHAT_DELETED ")), this.isInitialized = !0;
      } catch (r) {
        W.error("CharacterDeleteService", "", r);
      }
  }
  /**
   * 
   */
  static async onCharacterDeleted(r) {
    var c;
    const a = Ke.getSettings().linkedDeletion;
    if (!(a != null && a.enabled) || !(a != null && a.deleteWorldbook)) return;
    W.debug("CharacterDeleteService", "", r);
    const l = r.character, s = (l == null ? void 0 : l.name) || (l == null ? void 0 : l.avatar) || (l == null ? void 0 : l.ch_name) || ((c = l == null ? void 0 : l.data) == null ? void 0 : c.name);
    if (!s) {
      W.warn("CharacterDeleteService", "");
      return;
    }
    await this.deleteEngramWorldbooks(s, "", a.showConfirmation);
  }
  /**
   * 
   * @param chatId  ID "CharName - 2024-1-1@12h30m" 
   */
  static async onChatDeleted(r) {
    const a = Ke.getSettings().linkedDeletion;
    if (!(a != null && a.enabled)) return;
    W.debug("CharacterDeleteService", "", r);
    try {
      const { deleteDatabase: s, hasDbForChat: c } = await Promise.resolve().then(() => s6);
      c(r) && (await s(r), W.info("CharacterDeleteService", ` IndexedDB: Engram_${r}`), wt.info(" Engram ", "Engram"));
    } catch (s) {
      W.error("CharacterDeleteService", `: Engram_${r}`, s);
    }
    if (!a.deleteChatWorldbook) return;
    const l = this.extractCharacterNameFromChatId(r);
    if (!l) {
      W.debug("CharacterDeleteService", ` chatId : ${r}`);
      return;
    }
    await this.deleteEngramWorldbooks(l, "", a.showConfirmation);
  }
  /**
   *  chatId 
   */
  static extractCharacterNameFromChatId(r) {
    if (!r) return null;
    let a = r.match(/^(.+?)\s*-\s*\d{4}/);
    return a || (a = r.match(/^(.+?)_\d{4}/), a) ? a[1].trim() : null;
  }
  /**
   *  Engram 
   */
  static async deleteEngramWorldbooks(r, a, l) {
    const s = /* @__PURE__ */ new Set();
    s.add(`[Engram] ${r}`), s.add(`Engram_${r}`);
    const c = await St.getWorldbookNames(), d = new Set(c), m = Array.from(s).filter((v) => {
      if (!d.has(v)) return !1;
      const x = v.toLowerCase().includes("engram");
      return x || W.info("CharacterDeleteService", ` Engram : ${v}`), x;
    });
    if (m.length === 0) {
      W.debug("CharacterDeleteService", ` "${r}"  Engram `);
      return;
    }
    if (W.info("CharacterDeleteService", `: ${m.join(", ")}`), l) {
      const v = `
                <div style="font-size: 0.9em;">
                    <h3> Engram </h3>
                    <p>${a} <b>${r}</b> </p>
                    <p> Engram </p>
                    <ul style="max-height: 100px; overflow-y: auto; background: var(--black50a); padding: 5px; border-radius: 4px; list-style: none; margin: 10px 0;">
                        ${m.map((E) => `<li style="padding: 2px 0;"> ${E}</li>`).join("")}
                    </ul>
                    <p></p>
                    <small style="opacity: 0.7;"></small>
                </div>
            `;
      if (!await Z9(v, "confirm")) {
        W.info("CharacterDeleteService", "");
        return;
      }
    }
    let g = 0;
    const p = [];
    wt.info(" Engram ...", "Engram");
    for (const v of m)
      try {
        await St.deleteWorldbook(v) ? (g++, W.info("CharacterDeleteService", `: ${v}`)) : p.push(v);
      } catch (x) {
        W.error("CharacterDeleteService", ` ${v} `, x), p.push(v);
      }
    g > 0 && wt.success(` ${g} `, "Engram"), p.length > 0 && wt.warning(`: ${p.join(", ")}`, "Engram");
  }
}
Xe(a2, "isInitialized", !1);
const FC = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  CharacterDeleteService: a2
}, Symbol.toStringTag, { value: "Module" }));
function $C(t) {
  return new Date(t).toTimeString().slice(0, 8);
}
const GC = {
  [Ut.DEBUG]: { text: "text-zinc-500", bg: "bg-zinc-500/10" },
  [Ut.INFO]: { text: "text-blue-400", bg: "bg-blue-500/10" },
  [Ut.SUCCESS]: { text: "text-emerald-400", bg: "bg-emerald-500/10" },
  [Ut.WARN]: { text: "text-amber-400", bg: "bg-amber-500/10" },
  [Ut.ERROR]: { text: "text-red-400", bg: "bg-red-500/10" }
}, VC = ({ entry: t }) => {
  const [r, a] = U.useState(!1), l = t.data !== void 0, s = Zc[t.level], c = GC[t.level];
  return /* @__PURE__ */ u.jsxs("div", { className: "group", children: [
    /* @__PURE__ */ u.jsxs(
      "div",
      {
        className: `
                    flex items-start gap-3 px-2 py-1 rounded-sm transition-colors
                    hover:bg-white/[0.02]
                    ${l ? "cursor-pointer" : ""}
                `,
        onClick: () => l && a(!r),
        children: [
          /* @__PURE__ */ u.jsx("span", { className: "flex items-center text-zinc-600 shrink-0 mt-0.5 w-3", children: l ? r ? /* @__PURE__ */ u.jsx(Cl, { size: 12 }) : /* @__PURE__ */ u.jsx(fu, { size: 12 }) : null }),
          /* @__PURE__ */ u.jsx("span", { className: "text-zinc-600 shrink-0 tabular-nums text-[11px]", children: $C(t.timestamp) }),
          /* @__PURE__ */ u.jsx("span", { className: `
                    shrink-0 text-[10px] font-medium px-1.5 py-0.5 rounded
                    ${c.text} ${c.bg}
                `, children: s.label }),
          /* @__PURE__ */ u.jsx("span", { className: "text-zinc-500 shrink-0 text-[11px]", children: t.module }),
          /* @__PURE__ */ u.jsx("span", { className: "text-zinc-300 text-[11px] break-words flex-1 leading-relaxed", children: t.message })
        ]
      }
    ),
    r && l && /* @__PURE__ */ u.jsx("div", { className: "ml-10 mr-2 mb-1 px-3 py-2 bg-zinc-900/50 border-l-2 border-zinc-700 rounded-r text-[10px]", children: /* @__PURE__ */ u.jsx("pre", { className: "m-0 text-zinc-400 whitespace-pre-wrap break-words font-mono", children: JSON.stringify(t.data, null, 2) }) })
  ] });
}, KC = {
  summarize: { label: "", color: "bg-blue-500/20 text-blue-400" },
  trim: { label: "", color: "bg-yellow-500/20 text-yellow-500" },
  vectorize: { label: "", color: "bg-purple-500/20 text-purple-400" },
  query: { label: "", color: "bg-green-500/20 text-green-400" },
  other: { label: "", color: "bg-gray-500/20 text-gray-400" }
}, YC = ({ status: t }) => {
  switch (t) {
    case "pending":
      return /* @__PURE__ */ u.jsx(Tl, { size: 14, className: "animate-spin text-yellow-400" });
    case "success":
      return /* @__PURE__ */ u.jsx(zm, { size: 14, className: "text-green-400" });
    case "error":
      return /* @__PURE__ */ u.jsx(El, { size: 14, className: "text-red-400" });
  }
}, QC = (t) => new Date(t).toLocaleTimeString("zh-CN", {
  hour12: !1,
  hour: "2-digit",
  minute: "2-digit",
  second: "2-digit"
}), XC = (t) => t === void 0 ? "-" : t < 1e3 ? `${t}ms` : `${(t / 1e3).toFixed(1)}s`, WC = ({ sent: t, received: r }) => {
  const [a, l] = U.useState(!1), s = KC[t.type];
  return /* @__PURE__ */ u.jsxs("div", { className: "border border-border rounded-lg overflow-hidden bg-card", children: [
    /* @__PURE__ */ u.jsxs(
      "div",
      {
        className: "flex items-center gap-2 px-3 py-2 bg-muted-20 cursor-pointer hover:bg-muted-30",
        onClick: () => l(!a),
        children: [
          a ? /* @__PURE__ */ u.jsx(Cl, { size: 14 }) : /* @__PURE__ */ u.jsx(fu, { size: 14 }),
          /* @__PURE__ */ u.jsx("span", { className: `px-2 py-0.5 rounded text-xs font-medium ${s.color}`, children: s.label }),
          t.model && /* @__PURE__ */ u.jsx("span", { className: "px-1.5 py-0.5 rounded text-[10px] font-medium bg-indigo-500/10 text-indigo-400 border border-indigo-500/20 truncate max-w-[150px]", title: `: ${t.model}`, children: t.model }),
          t.character && /* @__PURE__ */ u.jsx("span", { className: "px-1.5 py-0.5 rounded text-[10px] font-medium bg-orange-500/10 text-orange-400 border border-orange-500/20 truncate max-w-[120px]", title: `: ${t.character}`, children: t.character }),
          /* @__PURE__ */ u.jsx("span", { className: "text-xs text-muted-foreground", children: QC(t.timestamp) }),
          /* @__PURE__ */ u.jsx(YC, { status: (r == null ? void 0 : r.status) || t.status }),
          t.floorRange && /* @__PURE__ */ u.jsxs("span", { className: "text-xs text-muted-foreground", children: [
            " #",
            t.floorRange[0],
            "-",
            t.floorRange[1]
          ] }),
          /* @__PURE__ */ u.jsxs("span", { className: "ml-auto text-xs text-muted-foreground flex items-center gap-1", children: [
            /* @__PURE__ */ u.jsx(db, { size: 12 }),
            XC((r == null ? void 0 : r.duration) || t.duration)
          ] })
        ]
      }
    ),
    a && /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col md:flex-row", children: [
      /* @__PURE__ */ u.jsxs("div", { className: "flex-1 border-r border-border p-3", children: [
        /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-2 mb-2 text-sm font-medium text-blue-400", children: [
          /* @__PURE__ */ u.jsx(E3, { size: 14 }),
          "",
          t.tokensSent && /* @__PURE__ */ u.jsxs("span", { className: "text-xs text-muted-foreground ml-auto", children: [
            "~",
            t.tokensSent,
            " tokens"
          ] })
        ] }),
        t.systemPrompt && /* @__PURE__ */ u.jsxs("div", { className: "mb-3", children: [
          /* @__PURE__ */ u.jsx("div", { className: "text-xs text-muted-foreground mb-1", children: "System" }),
          /* @__PURE__ */ u.jsx("div", { className: "text-sm p-2 bg-muted-20 rounded max-h-[500px] overflow-y-auto whitespace-pre-wrap", children: t.systemPrompt })
        ] }),
        t.userPrompt && /* @__PURE__ */ u.jsxs("div", { children: [
          /* @__PURE__ */ u.jsx("div", { className: "text-xs text-muted-foreground mb-1", children: "User" }),
          /* @__PURE__ */ u.jsx("div", { className: "text-sm p-2 bg-muted-20 rounded max-h-[500px] overflow-y-auto whitespace-pre-wrap", children: t.userPrompt })
        ] })
      ] }),
      /* @__PURE__ */ u.jsxs("div", { className: "flex-1 p-3", children: [
        /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-2 mb-2 text-sm font-medium text-green-400", children: [
          /* @__PURE__ */ u.jsx(ub, { size: 14 }),
          "",
          (r == null ? void 0 : r.tokensReceived) && /* @__PURE__ */ u.jsxs("span", { className: "text-xs text-muted-foreground ml-auto", children: [
            "~",
            r.tokensReceived,
            " tokens"
          ] })
        ] }),
        (r == null ? void 0 : r.status) === "error" && r.error && /* @__PURE__ */ u.jsx("div", { className: "p-2 bg-red-500/10 border border-red-500/30 rounded text-sm text-red-400", children: r.error }),
        (r == null ? void 0 : r.response) && /* @__PURE__ */ u.jsx("div", { className: "text-sm p-2 bg-muted-20 rounded max-h-[500px] overflow-y-auto whitespace-pre-wrap", children: r.response }),
        !r && t.status === "pending" && /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-2 text-sm text-muted-foreground", children: [
          /* @__PURE__ */ u.jsx(Tl, { size: 14, className: "animate-spin" }),
          "..."
        ] })
      ] })
    ] })
  ] });
}, ZC = () => {
  const [t, r] = U.useState(Ir.getPaired());
  return U.useEffect(() => Ir.subscribe(() => {
    r(Ir.getPaired());
  }), []), /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col h-full", children: [
    /* @__PURE__ */ u.jsxs("div", { className: "flex items-center justify-between px-4 py-3 border-b border-border shrink-0", children: [
      /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-2", children: [
        /* @__PURE__ */ u.jsx(Bi, { size: 16, className: "text-primary" }),
        /* @__PURE__ */ u.jsx("span", { className: "font-medium text-foreground", children: "" }),
        /* @__PURE__ */ u.jsxs("span", { className: "text-xs text-muted-foreground", children: [
          "(",
          t.length,
          ")"
        ] })
      ] }),
      /* @__PURE__ */ u.jsx(
        "button",
        {
          className: "p-1.5 rounded-md hover:bg-destructive hover:text-destructive-foreground transition-colors text-muted-foreground",
          onClick: () => Ir.clear(),
          title: "",
          children: /* @__PURE__ */ u.jsx(ca, { size: 14 })
        }
      )
    ] }),
    /* @__PURE__ */ u.jsx("div", { className: "flex-1 overflow-y-auto p-4", children: t.length === 0 ? /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col items-center justify-center h-full text-muted-foreground gap-3", children: [
      /* @__PURE__ */ u.jsx(ub, { size: 48, className: "opacity-30" }),
      /* @__PURE__ */ u.jsx("p", { className: "text-sm", children: "" }),
      /* @__PURE__ */ u.jsx("p", { className: "text-xs", children: "" })
    ] }) : /* @__PURE__ */ u.jsx("div", { className: "flex flex-col gap-3", children: t.map(({ sent: a, received: l }) => /* @__PURE__ */ u.jsx(WC, { sent: a, received: l }, a.id)) }) })
  ] });
}, Vy = 768, i2 = (t) => new Date(t).toLocaleTimeString("zh-CN", {
  hour12: !1,
  hour: "2-digit",
  minute: "2-digit",
  second: "2-digit"
}), l2 = (t) => t === void 0 ? "-" : t < 1e3 ? `${t}ms` : `${(t / 1e3).toFixed(1)}s`, JC = ({ entry: t, isSelected: r, onSelect: a }) => /* @__PURE__ */ u.jsxs(
  "div",
  {
    className: `
                px-3 py-2 cursor-pointer border-b border-border/30 transition-colors
                ${r ? "bg-primary/10 border-l-2 border-l-primary" : "hover:bg-muted/30"}
            `,
    onClick: a,
    children: [
      /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-2 mb-1", children: [
        /* @__PURE__ */ u.jsx("span", { className: `px-1.5 py-0.5 rounded text-[10px] font-medium ${t.mode === "hybrid" ? "bg-purple-500/20 text-purple-400" : "bg-blue-500/20 text-blue-400"}`, children: t.mode === "hybrid" ? "" : "Embed" }),
        /* @__PURE__ */ u.jsxs("span", { className: "text-[10px] text-muted-foreground", children: [
          t.stats.rerankCount,
          "/",
          t.stats.topKCount,
          " "
        ] }),
        /* @__PURE__ */ u.jsxs("span", { className: "text-[10px] text-muted-foreground ml-auto flex items-center gap-1", children: [
          /* @__PURE__ */ u.jsx(db, { size: 10 }),
          i2(t.timestamp)
        ] })
      ] }),
      /* @__PURE__ */ u.jsx("p", { className: "text-sm text-foreground line-clamp-2", children: t.query }),
      /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-2 mt-1 text-[10px] text-muted-foreground", children: [
        /* @__PURE__ */ u.jsx(Bi, { size: 10 }),
        l2(t.stats.latencyMs)
      ] })
    ]
  }
), Xh = ({ label: t, score: r, color: a }) => {
  const l = Math.min(100, r * 100);
  return /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-2 text-xs", children: [
    /* @__PURE__ */ u.jsx("span", { className: "text-muted-foreground w-16 shrink-0", children: t }),
    /* @__PURE__ */ u.jsx("div", { className: "flex-1 h-1.5 bg-muted/30 rounded-full overflow-hidden", children: /* @__PURE__ */ u.jsx(
      "div",
      {
        className: `h-full ${a} rounded-full transition-all duration-300`,
        style: { width: `${l}%` }
      }
    ) }),
    /* @__PURE__ */ u.jsx("span", { className: "text-muted-foreground w-14 text-right font-mono shrink-0", children: r.toFixed(3) })
  ] });
}, eE = ({ item: t }) => {
  const [r, a] = U.useState(!1);
  return /* @__PURE__ */ u.jsxs(
    "div",
    {
      className: `
                border-b border-border/30 py-3 px-4 cursor-pointer
                hover:bg-muted/10 transition-colors
                ${t.isReranked ? "bg-purple-500/5" : t.isTopK ? "bg-blue-500/5" : ""}
            `,
      onClick: () => a(!r),
      children: [
        /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-2 mb-1.5", children: [
          t.isReranked && /* @__PURE__ */ u.jsx("span", { className: "px-1.5 py-0.5 text-[10px] bg-purple-500/20 text-purple-400 rounded", children: "Rerank" }),
          t.isTopK && !t.isReranked && /* @__PURE__ */ u.jsx("span", { className: "px-1.5 py-0.5 text-[10px] bg-blue-500/20 text-blue-400 rounded", children: "TopK" }),
          /* @__PURE__ */ u.jsx("span", { className: "text-[10px] text-muted-foreground truncate max-w-[150px]", children: t.category }),
          t.sourceFloor && /* @__PURE__ */ u.jsxs("span", { className: "text-[10px] text-muted-foreground", children: [
            " #",
            t.sourceFloor
          ] }),
          /* @__PURE__ */ u.jsx(fu, { size: 12, className: `ml-auto text-muted-foreground transition-transform ${r ? "rotate-90" : ""}` })
        ] }),
        /* @__PURE__ */ u.jsx("p", { className: `text-sm text-foreground ${r ? "" : "line-clamp-2"}`, children: t.summary }),
        r && /* @__PURE__ */ u.jsxs("div", { className: "mt-3 space-y-1.5 pt-2 border-t border-border/20", children: [
          /* @__PURE__ */ u.jsx(Xh, { label: "Embedding", score: t.embeddingScore, color: "bg-blue-500" }),
          t.rerankScore != null && /* @__PURE__ */ u.jsx(Xh, { label: "Rerank", score: t.rerankScore, color: "bg-orange-500" }),
          t.hybridScore != null && /* @__PURE__ */ u.jsx(Xh, { label: "Hybrid", score: t.hybridScore, color: "bg-purple-500" })
        ] })
      ]
    }
  );
}, Ky = ({ entry: t, isFullScreen: r, onClose: a }) => {
  const [l, s] = U.useState("all"), [c, d] = U.useState("hybrid"), [m, g] = U.useState(""), p = U.useMemo(() => {
    if (!t) return [];
    let v = [...t.results];
    if (m.trim()) {
      const x = m.toLowerCase();
      v = v.filter((E) => E.summary.toLowerCase().includes(x));
    }
    return l === "topK" ? v = v.filter((x) => x.isTopK) : l === "reranked" && (v = v.filter((x) => x.isReranked)), v.sort((x, E) => {
      const w = (_) => {
        switch (c) {
          case "embedding":
            return _.embeddingScore;
          case "rerank":
            return _.rerankScore ?? 0;
          case "hybrid":
            return _.hybridScore ?? (_.rerankScore != null ? (_.embeddingScore + _.rerankScore) / 2 : _.embeddingScore);
        }
      };
      return w(E) - w(x);
    }), v;
  }, [t, l, c, m]);
  return t ? /* @__PURE__ */ u.jsxs("div", { className: `flex flex-col h-full ${r ? "p-4" : ""}`, children: [
    r && a && /* @__PURE__ */ u.jsxs(
      "button",
      {
        onClick: a,
        className: "flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground mb-4",
        children: [
          /* @__PURE__ */ u.jsx(Am, { size: 16 }),
          ""
        ]
      }
    ),
    /* @__PURE__ */ u.jsxs("div", { className: "mb-4 pb-4 border-b border-border shrink-0", children: [
      /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-2 mb-2", children: [
        /* @__PURE__ */ u.jsx("span", { className: `px-2 py-0.5 rounded text-xs font-medium ${t.mode === "hybrid" ? "bg-purple-500/20 text-purple-400" : "bg-blue-500/20 text-blue-400"}`, children: t.mode === "hybrid" ? "" : "" }),
        /* @__PURE__ */ u.jsx("span", { className: "text-xs text-muted-foreground", children: i2(t.timestamp) })
      ] }),
      /* @__PURE__ */ u.jsx("p", { className: "text-sm text-foreground mb-2", children: t.query }),
      t.preprocessedQuery && t.preprocessedQuery !== t.query && /* @__PURE__ */ u.jsxs("p", { className: "text-xs text-muted-foreground", children: [
        " : ",
        t.preprocessedQuery
      ] }),
      /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-4 mt-3 text-xs text-muted-foreground", children: [
        /* @__PURE__ */ u.jsxs("span", { children: [
          ": ",
          t.stats.totalCandidates
        ] }),
        /* @__PURE__ */ u.jsxs("span", { children: [
          "TopK: ",
          t.stats.topKCount
        ] }),
        /* @__PURE__ */ u.jsxs("span", { children: [
          "Rerank: ",
          t.stats.rerankCount
        ] }),
        /* @__PURE__ */ u.jsxs("span", { className: "flex items-center gap-1", children: [
          /* @__PURE__ */ u.jsx(Bi, { size: 10 }),
          l2(t.stats.latencyMs)
        ] })
      ] })
    ] }),
    /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-3 flex-wrap mb-3 shrink-0", children: [
      /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-1 text-xs", children: [
        /* @__PURE__ */ u.jsx(R4, { size: 12, className: "text-muted-foreground" }),
        ["all", "topK", "reranked"].map((v) => /* @__PURE__ */ u.jsx(
          "button",
          {
            className: `px-2 py-1 rounded transition-colors ${l === v ? "bg-primary/20 text-primary" : "text-muted-foreground hover:text-foreground"}`,
            onClick: () => s(v),
            children: v === "all" ? "" : v === "topK" ? "TopK" : "Reranked"
          },
          v
        ))
      ] }),
      /* @__PURE__ */ u.jsx("div", { className: "w-px h-4 bg-border" }),
      /* @__PURE__ */ u.jsx("div", { className: "flex items-center gap-1 text-xs", children: ["embedding", "rerank", "hybrid"].map((v) => /* @__PURE__ */ u.jsx(
        "button",
        {
          className: `px-2 py-1 rounded transition-colors ${c === v ? "bg-primary/20 text-primary" : "text-muted-foreground hover:text-foreground"}`,
          onClick: () => d(v),
          children: v.charAt(0).toUpperCase() + v.slice(1)
        },
        v
      )) }),
      /* @__PURE__ */ u.jsx("div", { className: "w-px h-4 bg-border" }),
      /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-1.5 text-muted-foreground", children: [
        /* @__PURE__ */ u.jsx(sa, { size: 12 }),
        /* @__PURE__ */ u.jsx(
          "input",
          {
            type: "text",
            placeholder: "...",
            value: m,
            onChange: (v) => g(v.target.value),
            className: "bg-transparent border-none outline-none text-xs text-foreground placeholder:text-muted-foreground w-24"
          }
        )
      ] })
    ] }),
    /* @__PURE__ */ u.jsx("div", { className: "flex-1 overflow-y-auto -mx-4 md:mx-0", children: p.length === 0 ? /* @__PURE__ */ u.jsx("div", { className: "py-8 text-center text-muted-foreground text-sm", children: "" }) : p.map((v, x) => /* @__PURE__ */ u.jsx(eE, { item: v }, x)) }),
    /* @__PURE__ */ u.jsxs("div", { className: "text-[10px] text-muted-foreground py-2 border-t border-border mt-2 shrink-0", children: [
      " ",
      p.length,
      " / ",
      t.results.length,
      " "
    ] })
  ] }) : /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col items-center justify-center h-full text-muted-foreground gap-3", children: [
    /* @__PURE__ */ u.jsx(Lm, { size: 32, className: "opacity-30" }),
    /* @__PURE__ */ u.jsx("p", { className: "text-sm font-light", children: "" })
  ] });
}, tE = () => {
  const [t, r] = U.useState(Xc.getLogs()), [a, l] = U.useState(null), [s, c] = U.useState(window.innerWidth < Vy), [d, m] = U.useState(!1);
  U.useEffect(() => {
    const x = () => {
      c(window.innerWidth < Vy);
    };
    return window.addEventListener("resize", x), () => window.removeEventListener("resize", x);
  }, []), U.useEffect(() => Xc.subscribe((E) => {
    r(E);
  }), []);
  const g = U.useMemo(() => t.find((x) => x.id === a) || null, [t, a]), p = (x) => {
    l(x), s && m(!0);
  }, v = () => {
    m(!1), s && l(null);
  };
  return s && d && g ? /* @__PURE__ */ u.jsx(
    Ky,
    {
      entry: g,
      isFullScreen: !0,
      onClose: v
    }
  ) : /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col h-full", children: [
    /* @__PURE__ */ u.jsxs("div", { className: "flex items-center justify-between px-4 py-3 border-b border-border shrink-0", children: [
      /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-2", children: [
        /* @__PURE__ */ u.jsx(Lm, { size: 16, className: "text-primary" }),
        /* @__PURE__ */ u.jsx("span", { className: "font-medium text-foreground", children: "" }),
        /* @__PURE__ */ u.jsxs("span", { className: "text-xs text-muted-foreground", children: [
          "(",
          t.length,
          ")"
        ] })
      ] }),
      /* @__PURE__ */ u.jsx(
        "button",
        {
          className: "p-1.5 rounded-md hover:bg-destructive hover:text-destructive-foreground transition-colors text-muted-foreground",
          onClick: () => Xc.clear(),
          title: "",
          children: /* @__PURE__ */ u.jsx(ca, { size: 14 })
        }
      )
    ] }),
    /* @__PURE__ */ u.jsxs("div", { className: "flex-1 flex min-h-0", children: [
      /* @__PURE__ */ u.jsx("div", { className: `
                    ${s ? "w-full" : "w-[30%] min-w-[240px]"}
                    overflow-y-auto
                    ${s ? "" : "border-r border-border/50"}
                `, children: t.length === 0 ? /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col items-center justify-center h-full text-muted-foreground gap-3 p-4", children: [
        /* @__PURE__ */ u.jsx(hu, { size: 32, className: "opacity-30" }),
        /* @__PURE__ */ u.jsx("p", { className: "text-sm font-light", children: "" }),
        /* @__PURE__ */ u.jsx("p", { className: "text-xs opacity-70", children: " RAG " })
      ] }) : t.map((x) => /* @__PURE__ */ u.jsx(
        JC,
        {
          entry: x,
          isSelected: x.id === a,
          onSelect: () => p(x.id)
        },
        x.id
      )) }),
      !s && /* @__PURE__ */ u.jsx("div", { className: "flex-1 overflow-y-auto p-4", children: /* @__PURE__ */ u.jsx(Ky, { entry: g }) })
    ] })
  ] });
}, o2 = ({ tabs: t, activeTab: r, onChange: a, sticky: l = !0, top: s = 0, className: c = "", actions: d }) => /* @__PURE__ */ u.jsxs(
  "div",
  {
    className: `
            flex items-center justify-between gap-4 mb-6 border-b border-border
            ${l ? "glass-sticky sticky z-20 pt-4 pb-0 -mt-4 -mx-4 px-4 md:-mx-8 md:px-8 lg:-mx-12 lg:px-12" : "px-0"}
            ${c}
        `,
    style: l ? {
      top: s
    } : void 0,
    children: [
      /* @__PURE__ */ u.jsx("div", { className: "flex overflow-x-auto gap-2 pb-1 no-scrollbar", children: t.map((m) => /* @__PURE__ */ u.jsxs(
        "button",
        {
          onClick: () => a(m.id),
          className: `flex items-center gap-2 whitespace-nowrap px-4 py-1.5 text-sm transition-all relative ${r === m.id ? "text-foreground" : "text-muted-foreground hover:text-foreground"}`,
          children: [
            m.icon && /* @__PURE__ */ u.jsx("span", { className: "w-4 h-4", children: m.icon }),
            m.label,
            r === m.id && /* @__PURE__ */ u.jsx("div", { className: "absolute -bottom-[1px] left-0 right-0 h-[2px] bg-primary shadow-[0_0_8px_var(--primary)] z-10 transition-all duration-300" })
          ]
        },
        m.id
      )) }),
      d && /* @__PURE__ */ u.jsx("div", { className: "flex items-center gap-2 pb-1 shrink-0", children: d })
    ]
  }
), xd = (t) => {
  const [r, a] = U.useState(!1);
  U.useEffect(() => (a(!0), () => a(!1)), []);
  const l = document.getElementById("engram-header-extension");
  if (!r || !l)
    return null;
  const s = {
    ...t,
    sticky: !1,
    className: `!mb-0 !border-0 !bg-transparent px-4 md:px-8 lg:px-12 ${t.className || ""}`
  };
  return xb.createPortal(
    /* @__PURE__ */ u.jsx(o2, { ...s }),
    l
  );
}, nE = [
  { id: "runtime", label: "", icon: /* @__PURE__ */ u.jsx(pu, { size: 14 }) },
  { id: "model", label: "", icon: /* @__PURE__ */ u.jsx(Bi, { size: 14 }) },
  { id: "recall", label: "", icon: /* @__PURE__ */ u.jsx(Lm, { size: 14 }) }
], rE = [
  "ALL",
  "Logger",
  "EventBus",
  "Summarizer",
  "CORE/Pipeline",
  "CORE/RAG",
  "CORE/Memory",
  "UI/GraphView",
  "UI/MemoryStream"
], aE = ({ initialTab: t }) => {
  const [r, a] = U.useState(t || "runtime"), [l, s] = U.useState([]), [c, d] = U.useState([]), [m, g] = U.useState(""), [p, v] = U.useState(-1), [x, E] = U.useState("ALL"), [w, _] = U.useState(!0), [A, D] = U.useState(!1), [R, Z] = U.useState(!1), K = U.useRef(null);
  U.useEffect(() => {
    s(W.getLogs());
    const I = W.subscribe((V) => {
      s((we) => [...we, V]);
    });
    return () => I();
  }, []), U.useEffect(() => {
    let I = l;
    if (p !== -1 && (I = I.filter((V) => V.level >= p)), x !== "ALL" && (I = I.filter((V) => V.module.startsWith(x))), m.trim()) {
      const V = m.toLowerCase();
      I = I.filter(
        (we) => we.message.toLowerCase().includes(V) || we.module.toLowerCase().includes(V)
      );
    }
    d(I);
  }, [l, p, x, m]), U.useEffect(() => {
    w && K.current && K.current.scrollIntoView({ behavior: "smooth", block: "nearest" });
  }, [c, w]);
  const ge = U.useCallback(async () => {
    await W.clear(), s([]);
  }, []), de = U.useCallback(() => {
    const I = W.exportToMarkdown(), V = W.getExportFilename(), we = new Blob([I], { type: "text/markdown" }), Te = URL.createObjectURL(we), X = document.createElement("a");
    X.href = Te, X.download = V, X.click(), URL.revokeObjectURL(Te), W.success("DevLog", `: ${V}`);
  }, []);
  return /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col h-full", children: [
    /* @__PURE__ */ u.jsxs("div", { className: "mb-2", children: [
      /* @__PURE__ */ u.jsx("h1", { className: "text-2xl font-light text-foreground tracking-tight mb-2", children: "" }),
      /* @__PURE__ */ u.jsx("p", { className: "text-sm text-muted-foreground", children: "" })
    ] }),
    /* @__PURE__ */ u.jsx(
      xd,
      {
        tabs: nE,
        activeTab: r,
        onChange: (I) => a(I)
      }
    ),
    r === "runtime" && /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col flex-1 min-h-0", children: [
      /* @__PURE__ */ u.jsx("div", { className: "sticky top-0 z-10 bg-background/95 backdrop-blur-sm py-3 -mx-4 px-4 md:-mx-8 md:px-8 lg:-mx-12 lg:px-12 border-b border-border", children: /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-2 flex-wrap", children: [
        /* @__PURE__ */ u.jsxs("div", { className: "relative", children: [
          /* @__PURE__ */ u.jsxs(
            "button",
            {
              className: "inline-flex items-center gap-1.5 px-2.5 py-1.5 text-xs text-muted-foreground hover:text-foreground transition-colors",
              onClick: () => D(!A),
              children: [
                p === -1 ? "" : Zc[p].label,
                /* @__PURE__ */ u.jsx(Cl, { size: 12 })
              ]
            }
          ),
          A && /* @__PURE__ */ u.jsxs("div", { className: "absolute top-full left-0 mt-1 bg-popover border border-border rounded-md shadow-lg z-20 min-w-[100px] py-1 flex flex-col", children: [
            /* @__PURE__ */ u.jsx(
              "button",
              {
                className: "block w-full text-left px-3 py-1.5 text-xs hover:bg-accent transition-colors",
                onClick: () => {
                  v(-1), D(!1);
                },
                children: ""
              }
            ),
            Object.entries(Zc).map(([I, V]) => /* @__PURE__ */ u.jsxs(
              "button",
              {
                className: "block w-full text-left px-3 py-1.5 text-xs hover:bg-accent transition-colors",
                onClick: () => {
                  v(Number(I)), D(!1);
                },
                children: [
                  V.icon,
                  " ",
                  V.label
                ]
              },
              I
            ))
          ] })
        ] }),
        /* @__PURE__ */ u.jsx("div", { className: "w-px h-4 bg-border" }),
        /* @__PURE__ */ u.jsxs("div", { className: "relative", children: [
          /* @__PURE__ */ u.jsxs(
            "button",
            {
              className: "inline-flex items-center gap-1.5 px-2.5 py-1.5 text-xs text-muted-foreground hover:text-foreground transition-colors",
              onClick: () => Z(!R),
              children: [
                x,
                /* @__PURE__ */ u.jsx(Cl, { size: 12 })
              ]
            }
          ),
          R && /* @__PURE__ */ u.jsx("div", { className: "absolute top-full left-0 mt-1 bg-popover border border-border rounded-md shadow-lg z-20 min-w-[120px] py-1 max-h-48 overflow-y-auto flex flex-col", children: rE.map((I) => /* @__PURE__ */ u.jsx(
            "button",
            {
              className: "block w-full text-left px-3 py-1.5 text-xs hover:bg-accent transition-colors",
              onClick: () => {
                E(I), Z(!1);
              },
              children: I
            },
            I
          )) })
        ] }),
        /* @__PURE__ */ u.jsx("div", { className: "w-px h-4 bg-border" }),
        /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-1.5 text-muted-foreground", children: [
          /* @__PURE__ */ u.jsx(sa, { size: 12 }),
          /* @__PURE__ */ u.jsx(
            "input",
            {
              type: "text",
              placeholder: "...",
              value: m,
              onChange: (I) => g(I.target.value),
              className: "bg-transparent border-none outline-none text-xs text-foreground placeholder:text-muted-foreground w-24 md:w-40"
            }
          )
        ] }),
        /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-1 ml-auto", children: [
          /* @__PURE__ */ u.jsx(
            "button",
            {
              className: `p-1.5 rounded transition-colors ${w ? "text-primary" : "text-muted-foreground hover:text-foreground"}`,
              onClick: () => _(!w),
              title: "",
              children: /* @__PURE__ */ u.jsx(Yv, { size: 14 })
            }
          ),
          /* @__PURE__ */ u.jsx(
            "button",
            {
              className: "p-1.5 rounded text-muted-foreground hover:text-foreground transition-colors",
              onClick: ge,
              title: "",
              children: /* @__PURE__ */ u.jsx(ca, { size: 14 })
            }
          ),
          /* @__PURE__ */ u.jsxs(
            "button",
            {
              className: "inline-flex items-center gap-1 px-2 py-1 text-xs text-muted-foreground hover:text-foreground transition-colors",
              onClick: de,
              children: [
                /* @__PURE__ */ u.jsx(tu, { size: 12 }),
                ""
              ]
            }
          )
        ] })
      ] }) }),
      /* @__PURE__ */ u.jsx("div", { className: "flex-1 overflow-y-auto font-mono text-xs leading-relaxed py-2", children: c.length === 0 ? /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col items-center justify-center h-full gap-3 text-muted-foreground", children: [
        /* @__PURE__ */ u.jsx(pu, { size: 32, strokeWidth: 1, className: "opacity-30" }),
        /* @__PURE__ */ u.jsx("p", { className: "text-sm font-light", children: "" })
      ] }) : /* @__PURE__ */ u.jsxs(u.Fragment, { children: [
        c.map((I) => /* @__PURE__ */ u.jsx(VC, { entry: I }, I.id)),
        /* @__PURE__ */ u.jsx("div", { ref: K })
      ] }) }),
      /* @__PURE__ */ u.jsxs("div", { className: "text-[10px] text-muted-foreground py-2 border-t border-border", children: [
        l.length,
        " ",
        c.length !== l.length && `  ${c.length} `
      ] })
    ] }),
    r === "model" && /* @__PURE__ */ u.jsx("div", { className: "flex-1 overflow-hidden", children: /* @__PURE__ */ u.jsx(ZC, {}) }),
    r === "recall" && /* @__PURE__ */ u.jsx("div", { className: "flex-1 overflow-hidden", children: /* @__PURE__ */ u.jsx(tE, {}) })
  ] });
}, iE = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  DevLog: aE
}, Symbol.toStringTag, { value: "Module" })), lE = {
  default: "text-muted-foreground bg-muted/50",
  primary: "text-primary bg-primary/10",
  blue: "text-blue-500 bg-blue-500/10",
  purple: "text-purple-500 bg-purple-500/10",
  orange: "text-orange-500 bg-orange-500/10",
  emerald: "text-emerald-500 bg-emerald-500/10"
}, oE = ({
  icon: t,
  title: r,
  subtitle: a,
  meta: l,
  badges: s = [],
  selected: c = !1,
  disabled: d = !1,
  toggle: m,
  onClick: g,
  actions: p = [],
  className: v = "",
  compact: x = !1
}) => {
  const E = p.filter((_) => !_.hidden), w = !!m;
  return /* @__PURE__ */ u.jsxs(
    "div",
    {
      className: `
                group relative flex items-center gap-3 
                ${x ? "py-2 px-2" : "py-3 px-3"}
                rounded-lg cursor-pointer transition-all duration-150
                ${c ? "bg-accent/60" : "hover:bg-muted/40"}
                ${d ? "opacity-50 pointer-events-none" : ""}
                ${v}
            `,
      onClick: g,
      children: [
        (t || w) && /* @__PURE__ */ u.jsx("div", { className: "flex-shrink-0", children: w ? /* @__PURE__ */ u.jsx(
          "button",
          {
            className: `
                                w-7 h-7 flex items-center justify-center rounded-md transition-colors
                                ${m.checked ? "text-primary" : "text-muted-foreground hover:text-foreground"}
                            `,
            onClick: (_) => {
              _.stopPropagation(), m.onChange(!m.checked);
            },
            children: /* @__PURE__ */ u.jsx(Dm, { size: 14 })
          }
        ) : /* @__PURE__ */ u.jsx("div", { className: `
                            w-7 h-7 flex items-center justify-center rounded-md transition-colors
                            ${c ? "text-primary" : "text-muted-foreground group-hover:text-foreground"}
                        `, children: t }) }),
        /* @__PURE__ */ u.jsxs("div", { className: "flex-1 min-w-0", children: [
          /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-2", children: [
            /* @__PURE__ */ u.jsx("span", { className: `
                        text-sm font-medium truncate transition-colors
                        ${c ? "text-foreground" : "text-muted-foreground group-hover:text-foreground"}
                        ${m && !m.checked ? "line-through opacity-60" : ""}
                    `, children: r }),
            s.map((_, A) => /* @__PURE__ */ u.jsx(
              "span",
              {
                className: `
                                text-[10px] px-1.5 py-0.5 rounded-sm font-medium flex-shrink-0
                                ${lE[_.color || "default"]}
                            `,
                children: _.text
              },
              A
            ))
          ] }),
          (a || l) && /* @__PURE__ */ u.jsxs("div", { className: "flex items-center justify-between mt-0.5 text-[11px] text-muted-foreground/70", children: [
            a && /* @__PURE__ */ u.jsx("span", { className: "truncate", children: a }),
            l && /* @__PURE__ */ u.jsx("span", { className: "flex-shrink-0 font-mono", children: l })
          ] })
        ] }),
        c && !E.length && /* @__PURE__ */ u.jsx(Mm, { size: 14, className: "text-primary flex-shrink-0" }),
        E.length > 0 && /* @__PURE__ */ u.jsx("div", { className: `
                    flex items-center gap-0.5 flex-shrink-0
                    ${c ? "opacity-100" : "opacity-0 group-hover:opacity-100"}
                    transition-opacity
                `, children: E.map((_, A) => /* @__PURE__ */ u.jsx(
          "button",
          {
            className: `
                                p-1.5 rounded transition-colors
                                ${_.danger ? "text-muted-foreground hover:text-destructive hover:bg-destructive/10" : "text-muted-foreground hover:text-foreground hover:bg-muted"}
                            `,
            onClick: (D) => {
              D.stopPropagation(), _.onClick(D);
            },
            title: _.title,
            children: _.icon
          },
          A
        )) })
      ]
    }
  );
}, sE = ({
  preset: t,
  isSelected: r,
  onSelect: a,
  onEdit: l,
  onCopy: s,
  onDelete: c
}) => {
  var g;
  const d = t.source === "tavern" || t.source === "tavern_profile" ? yb : S4, m = t.source === "custom" ? ((g = t.custom) == null ? void 0 : g.model) || "" : "";
  return /* @__PURE__ */ u.jsx(
    oE,
    {
      icon: /* @__PURE__ */ u.jsx(d, { size: 14 }),
      title: t.name,
      subtitle: m,
      meta: `T:${t.parameters.temperature}`,
      badges: t.isDefault ? [{ text: "DEFAULT", color: "primary" }] : [],
      selected: r,
      onClick: a,
      actions: [
        { icon: /* @__PURE__ */ u.jsx(c3, { size: 12 }), onClick: () => l(), title: "" },
        { icon: /* @__PURE__ */ u.jsx(fb, { size: 12 }), onClick: () => s(), title: "" },
        { icon: /* @__PURE__ */ u.jsx(ca, { size: 12 }), onClick: () => c(), title: "", danger: !0, hidden: t.isDefault }
      ]
    }
  );
}, mr = ({ title: t, description: r, children: a, className: l = "" }) => /* @__PURE__ */ u.jsxs("div", { className: `mb-8 ${l}`, children: [
  /* @__PURE__ */ u.jsxs("div", { className: "mb-4", children: [
    /* @__PURE__ */ u.jsx("h3", { className: "text-sm font-medium text-primary", children: t }),
    r && /* @__PURE__ */ u.jsx("p", { className: "text-xs text-muted-foreground mt-1 break-words", children: r })
  ] }),
  /* @__PURE__ */ u.jsx("div", { className: "space-y-4", children: a })
] }), er = ({
  label: t,
  description: r,
  error: a,
  required: l,
  className: s = "",
  value: c,
  onChange: d,
  placeholder: m,
  type: g = "text",
  disabled: p,
  multiline: v,
  rows: x = 3
}) => {
  const E = {
    background: "transparent",
    backgroundColor: "transparent",
    border: "none",
    borderBottom: "1px solid var(--border)",
    borderRadius: 0,
    boxShadow: "none",
    outline: "none",
    padding: "8px 0",
    fontSize: "14px",
    width: "100%",
    color: "var(--foreground, inherit)"
  };
  return /* @__PURE__ */ u.jsxs("div", { className: `flex flex-col gap-1 ${s}`, children: [
    /* @__PURE__ */ u.jsxs("label", { className: "text-xs text-muted-foreground flex items-center gap-1", children: [
      t,
      l && /* @__PURE__ */ u.jsx("span", { className: "text-destructive", children: "*" })
    ] }),
    v ? /* @__PURE__ */ u.jsx(
      "textarea",
      {
        value: c,
        onChange: (w) => d(w.target.value),
        placeholder: m,
        disabled: p,
        rows: x,
        style: E,
        className: "font-mono resize-y min-h-[80px] placeholder:text-muted-foreground/40 disabled:opacity-50 focus:border-primary transition-colors"
      }
    ) : /* @__PURE__ */ u.jsx(
      "input",
      {
        type: g,
        value: c,
        onChange: (w) => d(w.target.value),
        placeholder: m,
        disabled: p,
        style: E,
        className: "placeholder:text-muted-foreground/40 disabled:opacity-50 focus:border-primary transition-colors"
      }
    ),
    r && /* @__PURE__ */ u.jsx("p", { className: "text-[10px] text-muted-foreground/70 break-words", children: r }),
    a && /* @__PURE__ */ u.jsx("p", { className: "text-[10px] text-destructive", children: a })
  ] });
}, hr = ({
  label: t,
  description: r,
  error: a,
  required: l,
  className: s = "",
  value: c,
  onChange: d,
  min: m,
  max: g,
  step: p = 1,
  showSlider: v = !0,
  suffix: x
}) => {
  const E = {
    background: "transparent",
    backgroundColor: "transparent",
    border: "none",
    borderRadius: 0,
    boxShadow: "none",
    outline: "none",
    padding: "0",
    fontSize: "12px",
    width: "auto",
    minWidth: "40px",
    textAlign: "right",
    fontFamily: "monospace",
    color: "var(--foreground, inherit)"
  }, w = m !== void 0 && g !== void 0 ? Math.min(100, Math.max(0, (c - m) / (g - m) * 100)) : 0;
  return /* @__PURE__ */ u.jsxs("div", { className: `flex flex-col gap-2 ${s}`, children: [
    /* @__PURE__ */ u.jsxs("div", { className: "flex justify-between items-center", children: [
      /* @__PURE__ */ u.jsxs("label", { className: "text-xs text-muted-foreground flex items-center gap-1", children: [
        t,
        l && /* @__PURE__ */ u.jsx("span", { className: "text-destructive", children: "*" })
      ] }),
      /* @__PURE__ */ u.jsx(
        "input",
        {
          type: "number",
          min: m,
          max: g,
          step: p,
          value: c,
          onChange: (_) => d(Number(_.target.value)),
          style: E,
          className: "focus:text-primary transition-colors [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"
        }
      )
    ] }),
    /* @__PURE__ */ u.jsx("div", { className: "flex items-center gap-3 pt-1", children: v && m !== void 0 && g !== void 0 && /* @__PURE__ */ u.jsxs("div", { className: "flex-1 relative h-4 flex items-center group cursor-pointer", children: [
      /* @__PURE__ */ u.jsx(
        "div",
        {
          className: "absolute inset-x-0 h-[1px]",
          style: { backgroundColor: "var(--border)" }
        }
      ),
      /* @__PURE__ */ u.jsx(
        "div",
        {
          className: "absolute top-1/2 -translate-y-1/2 w-2.5 h-2.5 bg-muted-foreground/80 rounded-full shadow-sm pointer-events-none transition-transform duration-75 ease-out group-hover:scale-125 group-hover:bg-foreground",
          style: { left: `${w}%`, transform: "translate(-50%, -50%)" }
        }
      ),
      /* @__PURE__ */ u.jsx(
        "input",
        {
          type: "range",
          min: m,
          max: g,
          step: p,
          value: c,
          onChange: (_) => d(Number(_.target.value)),
          className: "absolute inset-x-0 w-full h-full opacity-0 cursor-pointer z-10 m-0",
          style: { appearance: "none", WebkitAppearance: "none" }
        }
      )
    ] }) }),
    r && /* @__PURE__ */ u.jsx("p", { className: "text-[10px] text-muted-foreground/70 break-words", children: r }),
    a && /* @__PURE__ */ u.jsx("p", { className: "text-[10px] text-destructive", children: a })
  ] });
}, Ri = ({
  label: t,
  description: r,
  error: a,
  required: l,
  className: s = "",
  value: c,
  onChange: d,
  options: m,
  placeholder: g = "...",
  disabled: p
}) => {
  const v = {
    background: "transparent",
    backgroundColor: "transparent",
    border: "none",
    borderBottom: "1px solid var(--border)",
    borderRadius: 0,
    boxShadow: "none",
    outline: "none",
    padding: "8px 24px 8px 0",
    fontSize: "14px",
    width: "100%",
    cursor: "pointer",
    color: "var(--foreground, inherit)",
    appearance: "none",
    WebkitAppearance: "none"
  };
  return /* @__PURE__ */ u.jsxs("div", { className: `flex flex-col gap-1 ${s}`, children: [
    /* @__PURE__ */ u.jsxs("label", { className: "text-xs text-muted-foreground flex items-center gap-1", children: [
      t,
      l && /* @__PURE__ */ u.jsx("span", { className: "text-destructive", children: "*" })
    ] }),
    /* @__PURE__ */ u.jsxs("div", { className: "relative", children: [
      /* @__PURE__ */ u.jsxs(
        "select",
        {
          value: c,
          onChange: (x) => d(x.target.value),
          disabled: p,
          style: v,
          className: "disabled:opacity-50 disabled:cursor-not-allowed focus:border-primary transition-colors",
          children: [
            /* @__PURE__ */ u.jsx("option", { value: "", disabled: !0, className: "bg-popover text-muted-foreground", children: g }),
            m.map((x) => /* @__PURE__ */ u.jsx("option", { value: x.value, className: "bg-popover text-foreground", children: x.label }, x.value))
          ]
        }
      ),
      /* @__PURE__ */ u.jsx(Cl, { size: 14, className: "absolute right-0 top-1/2 -translate-y-1/2 text-muted-foreground/50 pointer-events-none" })
    ] }),
    r && /* @__PURE__ */ u.jsx("p", { className: "text-[10px] text-muted-foreground/70 break-words", children: r }),
    a && /* @__PURE__ */ u.jsx("p", { className: "text-[10px] text-destructive", children: a })
  ] });
}, la = ({
  label: t,
  description: r,
  error: a,
  className: l = "",
  checked: s,
  onChange: c,
  disabled: d,
  compact: m
}) => /* @__PURE__ */ u.jsxs("div", { className: `flex items-start justify-between gap-4 ${m ? "py-0" : "py-1"} ${l} ${d ? "opacity-50 pointer-events-none" : ""}`, children: [
  t && /* @__PURE__ */ u.jsxs("div", { className: "flex-1 min-w-0", children: [
    /* @__PURE__ */ u.jsx(
      "label",
      {
        className: "text-xs text-foreground cursor-pointer block truncate",
        onClick: () => !d && c(!s),
        children: t
      }
    ),
    r && /* @__PURE__ */ u.jsx("p", { className: "text-[10px] text-muted-foreground/70 mt-0.5 break-words", children: r }),
    a && /* @__PURE__ */ u.jsx("p", { className: "text-[10px] text-destructive mt-0.5", children: a })
  ] }),
  /* @__PURE__ */ u.jsx(
    On,
    {
      checked: s,
      onChange: c,
      disabled: d
    }
  )
] }), s2 = ({
  label: t,
  description: r,
  error: a,
  required: l,
  className: s = "",
  value: c,
  onChange: d,
  options: m,
  placeholder: g = "...",
  disabled: p,
  emptyText: v = ""
}) => {
  var ge;
  const [x, E] = U.useState(!1), [w, _] = U.useState(""), A = U.useRef(null), D = U.useRef(null), R = m.filter(
    (de) => de.label.toLowerCase().includes(w.toLowerCase()) || de.value.toLowerCase().includes(w.toLowerCase())
  ), Z = ((ge = m.find((de) => de.value === c)) == null ? void 0 : ge.label) || c || g;
  U.useEffect(() => {
    const de = (I) => {
      A.current && !A.current.contains(I.target) && (E(!1), _(""));
    };
    return document.addEventListener("mousedown", de), () => document.removeEventListener("mousedown", de);
  }, []), U.useEffect(() => {
    x && D.current && D.current.focus();
  }, [x]);
  const K = (de) => {
    d(de), E(!1), _("");
  };
  return /* @__PURE__ */ u.jsxs("div", { className: `flex flex-col gap-1 ${s}`, ref: A, children: [
    /* @__PURE__ */ u.jsxs("label", { className: "text-xs text-muted-foreground flex items-center gap-1", children: [
      t,
      l && /* @__PURE__ */ u.jsx("span", { className: "text-destructive", children: "*" })
    ] }),
    /* @__PURE__ */ u.jsxs(
      "button",
      {
        type: "button",
        onClick: () => !p && E(!x),
        disabled: p,
        className: "relative w-full text-left py-2 pr-6 border-0 border-b border-border bg-transparent text-sm text-foreground cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed focus:border-primary transition-colors",
        children: [
          /* @__PURE__ */ u.jsx("span", { className: c ? "" : "text-muted-foreground", children: Z }),
          /* @__PURE__ */ u.jsx(
            Cl,
            {
              size: 14,
              className: `absolute right-0 top-1/2 -translate-y-1/2 text-muted-foreground/50 transition-transform ${x ? "rotate-180" : ""}`
            }
          )
        ]
      }
    ),
    x && /* @__PURE__ */ u.jsxs(
      "div",
      {
        className: "glass-panel absolute z-50 mt-1 w-full max-h-64 border border-border rounded-lg shadow-xl overflow-hidden flex flex-col animate-in fade-in slide-in-from-top-1 duration-150",
        style: { top: "100%", left: 0, right: 0 },
        children: [
          /* @__PURE__ */ u.jsxs("div", { className: "p-2 border-b border-border flex items-center gap-2", children: [
            /* @__PURE__ */ u.jsx(sa, { size: 14, className: "text-muted-foreground flex-shrink-0" }),
            /* @__PURE__ */ u.jsx(
              "input",
              {
                ref: D,
                type: "text",
                value: w,
                onChange: (de) => _(de.target.value),
                placeholder: "...",
                className: "flex-1 bg-transparent border-none outline-none text-sm text-foreground placeholder:text-muted-foreground/50"
              }
            ),
            w && /* @__PURE__ */ u.jsx(
              "button",
              {
                type: "button",
                onClick: () => _(""),
                className: "p-0.5 hover:bg-muted rounded",
                children: /* @__PURE__ */ u.jsx(Uo, { size: 12, className: "text-muted-foreground" })
              }
            )
          ] }),
          /* @__PURE__ */ u.jsx("div", { className: "overflow-y-auto max-h-48", children: R.length > 0 ? R.map((de) => /* @__PURE__ */ u.jsx(
            "div",
            {
              onClick: () => K(de.value),
              className: `px-3 py-2 cursor-pointer text-sm truncate transition-colors ${de.value === c ? "bg-primary/15 text-primary" : "hover:bg-muted text-foreground"}`,
              title: de.label,
              children: de.label
            },
            de.value
          )) : /* @__PURE__ */ u.jsx("div", { className: "px-3 py-4 text-center text-sm text-muted-foreground", children: w ? "" : v }) }),
          m.length > 10 && /* @__PURE__ */ u.jsxs("div", { className: "px-3 py-1 border-t border-border text-xs text-muted-foreground/70", children: [
            R.length,
            " / ",
            m.length,
            " "
          ] })
        ]
      }
    ),
    r && /* @__PURE__ */ u.jsx("p", { className: "text-[10px] text-muted-foreground/70 break-words", children: r }),
    a && /* @__PURE__ */ u.jsx("p", { className: "text-[10px] text-destructive", children: a })
  ] });
};
class oa {
  // 10
  /**
   *  API 
   */
  static async fetchModels(r, a) {
    switch (r) {
      case "openai":
        return this.fetchOpenAIModels(a);
      case "ollama":
        return this.fetchOllamaModels(a);
      case "vllm":
        return this.fetchVLLMModels(a);
      case "cohere":
        return this.fetchCohereModels(a);
      case "jina":
      case "voyage":
        return this.getPresetModels(r);
      default:
        return W.warn("ModelService", `Unknown API type: ${r}`), [];
    }
  }
  /**
   *  OpenAI  API 
   * : OpenAI, Azure,  OpenAI 
   */
  static async fetchOpenAIModels(r) {
    const { apiUrl: a, apiKey: l, timeout: s = this.DEFAULT_TIMEOUT } = r, c = a.replace(/\/+$/, ""), d = c.endsWith("/v1") ? `${c}/models` : `${c}/v1/models`;
    try {
      const m = new AbortController(), g = setTimeout(() => m.abort(), s), p = {
        "Content-Type": "application/json"
      };
      l && (p.Authorization = `Bearer ${l}`);
      const v = await fetch(d, {
        method: "GET",
        headers: p,
        signal: m.signal
      });
      if (clearTimeout(g), !v.ok)
        throw new Error(`HTTP ${v.status}: ${v.statusText}`);
      const x = await v.json(), E = (x.data || x || []).map((w) => ({
        id: w.id || w.model,
        name: w.name || w.id || w.model,
        owned_by: w.owned_by
      }));
      return W.info("ModelService", `Fetched ${E.length} models from OpenAI API`), E.sort((w, _) => w.id.localeCompare(_.id));
    } catch (m) {
      throw m.name === "AbortError" ? W.error("ModelService", "OpenAI API request timeout") : W.error("ModelService", `OpenAI API error: ${m.message}`), m;
    }
  }
  /**
   *  Ollama 
   */
  static async fetchOllamaModels(r) {
    const { apiUrl: a, timeout: l = this.DEFAULT_TIMEOUT } = r, c = `${a.replace(/\/+$/, "")}/api/tags`;
    try {
      const d = new AbortController(), m = setTimeout(() => d.abort(), l), g = await fetch(c, {
        method: "GET",
        signal: d.signal
      });
      if (clearTimeout(m), !g.ok)
        throw new Error(`HTTP ${g.status}: ${g.statusText}`);
      const v = ((await g.json()).models || []).map((x) => ({
        id: x.name || x.model,
        name: x.name || x.model
      }));
      return W.info("ModelService", `Fetched ${v.length} models from Ollama`), v;
    } catch (d) {
      throw W.error("ModelService", `Ollama API error: ${d.message}`), d;
    }
  }
  /**
   *  vLLM 
   * vLLM  OpenAI  API
   */
  static async fetchVLLMModels(r) {
    return this.fetchOpenAIModels(r);
  }
  /**
   *  Cohere 
   */
  static async fetchCohereModels(r) {
    const { apiKey: a, timeout: l = this.DEFAULT_TIMEOUT } = r;
    if (!a)
      return W.warn("ModelService", "Cohere API key required"), this.getPresetModels("cohere");
    try {
      const s = new AbortController(), c = setTimeout(() => s.abort(), l), d = await fetch("https://api.cohere.ai/v1/models", {
        method: "GET",
        headers: {
          Authorization: `Bearer ${a}`,
          "Content-Type": "application/json"
        },
        signal: s.signal
      });
      if (clearTimeout(c), !d.ok)
        throw new Error(`HTTP ${d.status}: ${d.statusText}`);
      const g = ((await d.json()).models || []).filter((p) => {
        var v;
        return (v = p.endpoints) == null ? void 0 : v.includes("embed");
      }).map((p) => ({
        id: p.name,
        name: p.name,
        contextLength: p.context_length
      }));
      return W.info("ModelService", `Fetched ${g.length} embed models from Cohere`), g;
    } catch (s) {
      return W.error("ModelService", `Cohere API error: ${s.message}`), this.getPresetModels("cohere");
    }
  }
  /**
   * 
   */
  static getPresetModels(r) {
    return {
      cohere: [
        { id: "embed-multilingual-v3.0", name: "Embed Multilingual v3.0" },
        { id: "embed-english-v3.0", name: "Embed English v3.0" },
        { id: "embed-multilingual-light-v3.0", name: "Embed Multilingual Light v3.0" },
        { id: "embed-english-light-v3.0", name: "Embed English Light v3.0" }
      ],
      jina: [
        { id: "jina-embeddings-v3", name: "Jina Embeddings v3" },
        { id: "jina-embeddings-v2-base-en", name: "Jina Embeddings v2 Base EN" },
        { id: "jina-embeddings-v2-base-zh", name: "Jina Embeddings v2 Base ZH" },
        { id: "jina-colbert-v2", name: "Jina ColBERT v2" }
      ],
      voyage: [
        { id: "voyage-3", name: "Voyage 3" },
        { id: "voyage-3-lite", name: "Voyage 3 Lite" },
        { id: "voyage-large-2", name: "Voyage Large 2" },
        { id: "voyage-code-2", name: "Voyage Code 2" },
        { id: "voyage-multilingual-2", name: "Voyage Multilingual 2" }
      ],
      openai: [
        { id: "text-embedding-3-large", name: "Text Embedding 3 Large" },
        { id: "text-embedding-3-small", name: "Text Embedding 3 Small" },
        { id: "text-embedding-ada-002", name: "Text Embedding Ada 002" }
      ]
    }[r] || [];
  }
  /**
   *  Rerank 
   */
  static getCommonRerankModels() {
    return [
      { id: "BAAI/bge-reranker-v2-m3", name: "BGE Reranker v2 m3" },
      { id: "BAAI/bge-reranker-large", name: "BGE Reranker Large" },
      { id: "BAAI/bge-reranker-base", name: "BGE Reranker Base" },
      { id: "cross-encoder/ms-marco-MiniLM-L-12-v2", name: "MS MARCO MiniLM L12" },
      { id: "Xenova/ms-marco-MiniLM-L-6-v2", name: "MS MARCO MiniLM L6 (ONNX)" },
      { id: "jinaai/jina-reranker-v2-base-multilingual", name: "Jina Reranker v2 Multilingual" }
    ];
  }
}
Xe(oa, "DEFAULT_TIMEOUT", 1e4);
const uE = [
  { value: "openai", label: "OpenAI" },
  { value: "anthropic", label: "Anthropic" },
  { value: "ollama", label: "Ollama" },
  { value: "vllm", label: "vLLM" },
  { value: "azure", label: "Azure OpenAI" },
  { value: "custom", label: "" }
], cE = [
  { value: "tavern", label: "" },
  { value: "tavern_profile", label: "" },
  { value: "custom", label: " API " }
];
function dE() {
  var t, r, a, l;
  try {
    const s = (a = (r = (t = window.SillyTavern) == null ? void 0 : t.getContext) == null ? void 0 : r.call(t)) == null ? void 0 : a.extensionSettings;
    return ((l = s == null ? void 0 : s.connectionManager) == null ? void 0 : l.profiles) || [];
  } catch (s) {
    return console.warn("[Engram]  connection_profiles:", s), [];
  }
}
const Yy = ({
  preset: t,
  onChange: r,
  isNew: a = !1
}) => {
  var de, I, V, we, Te, X;
  const [l, s] = U.useState([]), [c, d] = U.useState(!1), [m, g] = U.useState([]), [p, v] = U.useState(!1), [x, E] = U.useState(null), w = () => {
    d(!0);
    try {
      const oe = dE();
      s(oe);
    } finally {
      d(!1);
    }
  }, _ = async () => {
    const { apiUrl: oe, apiKey: se, apiSource: Re } = t.custom || {};
    if (!oe) {
      E(" API URL");
      return;
    }
    v(!0), E(null);
    try {
      let be = [];
      Re === "ollama" ? be = await oa.fetchOllamaModels({ apiUrl: oe }) : be = await oa.fetchOpenAIModels({ apiUrl: oe, apiKey: se }), g(be), be.length === 0 && E("");
    } catch (be) {
      E(be.message || ""), g([]);
    } finally {
      v(!1);
    }
  };
  U.useEffect(() => {
    w();
  }, []);
  const A = (oe) => {
    r({ ...t, ...oe, updatedAt: Date.now() });
  }, D = (oe, se) => {
    A({
      parameters: { ...t.parameters, [oe]: se }
    });
  }, R = (oe, se) => {
    var Re, be, je, re;
    A({
      custom: {
        apiUrl: ((Re = t.custom) == null ? void 0 : Re.apiUrl) || "",
        apiKey: ((be = t.custom) == null ? void 0 : be.apiKey) || "",
        model: ((je = t.custom) == null ? void 0 : je.model) || "",
        apiSource: ((re = t.custom) == null ? void 0 : re.apiSource) || "openai",
        [oe]: se
      }
    });
  }, Z = (oe) => {
    const se = oe;
    A({
      source: se,
      tavernProfileId: se === "tavern_profile" ? t.tavernProfileId : void 0
    }), se === "tavern_profile" && w();
  }, K = l.map((oe) => ({
    value: oe.id,
    label: `${oe.name} (${oe.api || "Unknown"} - ${oe.model || "Unknown"})`
  })), ge = l.find((oe) => oe.id === t.tavernProfileId);
  return /* @__PURE__ */ u.jsxs("div", { className: "", children: [
    /* @__PURE__ */ u.jsxs(mr, { title: "", children: [
      /* @__PURE__ */ u.jsx(
        er,
        {
          label: "",
          value: t.name,
          onChange: (oe) => A({ name: oe }),
          placeholder: "",
          required: !0
        }
      ),
      /* @__PURE__ */ u.jsx(
        Ri,
        {
          label: "",
          value: t.source,
          onChange: Z,
          options: cE,
          description: " API "
        }
      )
    ] }),
    t.source === "tavern_profile" && /* @__PURE__ */ u.jsxs(mr, { title: "", description: "", children: [
      /* @__PURE__ */ u.jsxs("div", { className: "flex items-end gap-2", children: [
        /* @__PURE__ */ u.jsx(
          Ri,
          {
            className: "flex-1 !mb-0",
            label: "",
            value: t.tavernProfileId || "",
            onChange: (oe) => A({ tavernProfileId: oe }),
            options: K,
            placeholder: c ? "..." : "",
            disabled: c || K.length === 0
          }
        ),
        /* @__PURE__ */ u.jsx(
          "button",
          {
            type: "button",
            className: "h-[42px] w-[42px] min-w-[42px] flex items-center justify-center border-none rounded-md bg-muted text-muted-foreground cursor-pointer transition-all hover:bg-accent hover:text-foreground",
            onClick: w,
            disabled: c,
            title: "",
            children: /* @__PURE__ */ u.jsx(tr, { size: 16, className: c ? "animate-spin" : "" })
          }
        )
      ] }),
      K.length === 0 && !c && /* @__PURE__ */ u.jsx("div", { className: "p-3 bg-muted/30 border border-dashed border-border rounded-lg text-muted-foreground text-sm text-center mt-3", children: "" }),
      ge && /* @__PURE__ */ u.jsxs("div", { className: "mt-4 p-3 bg-card rounded-lg border border-border", children: [
        /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-2 py-1 text-sm border-b border-border last:border-0", children: [
          /* @__PURE__ */ u.jsx("span", { className: "text-muted-foreground min-w-[60px]", children: "API:" }),
          /* @__PURE__ */ u.jsx("span", { className: "text-foreground font-mono", children: ge.api || "-" })
        ] }),
        /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-2 py-1 text-sm border-b border-border last:border-0", children: [
          /* @__PURE__ */ u.jsx("span", { className: "text-muted-foreground min-w-[60px]", children: ":" }),
          /* @__PURE__ */ u.jsx("span", { className: "text-foreground font-mono", children: ge.model || "-" })
        ] }),
        /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-2 py-1 text-sm border-b border-border last:border-0", children: [
          /* @__PURE__ */ u.jsx("span", { className: "text-muted-foreground min-w-[60px]", children: ":" }),
          /* @__PURE__ */ u.jsx("span", { className: "text-foreground font-mono", children: ge.preset || "-" })
        ] })
      ] })
    ] }),
    t.source === "custom" && /* @__PURE__ */ u.jsxs(mr, { title: "API ", description: " API ", children: [
      /* @__PURE__ */ u.jsx(
        Ri,
        {
          label: "API ",
          value: ((de = t.custom) == null ? void 0 : de.apiSource) || "openai",
          onChange: (oe) => R("apiSource", oe),
          options: uE
        }
      ),
      /* @__PURE__ */ u.jsx(
        er,
        {
          label: "API URL",
          type: "url",
          value: ((I = t.custom) == null ? void 0 : I.apiUrl) || "",
          onChange: (oe) => R("apiUrl", oe),
          placeholder: "https://api.openai.com/v1",
          required: !0
        }
      ),
      /* @__PURE__ */ u.jsx(
        er,
        {
          label: "API Key",
          type: "password",
          value: ((V = t.custom) == null ? void 0 : V.apiKey) || "",
          onChange: (oe) => R("apiKey", oe),
          placeholder: "sk-..."
        }
      ),
      /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col gap-2", children: [
        /* @__PURE__ */ u.jsxs("div", { className: "flex items-end gap-2", children: [
          m.length > 0 ? /* @__PURE__ */ u.jsx(
            Ri,
            {
              className: "flex-1 !mb-0",
              label: "",
              value: ((we = t.custom) == null ? void 0 : we.model) || "",
              onChange: (oe) => R("model", oe),
              options: m.map((oe) => ({ value: oe.id, label: oe.name || oe.id })),
              placeholder: ""
            }
          ) : /* @__PURE__ */ u.jsx(
            er,
            {
              className: "flex-1 !mb-0",
              label: "",
              value: ((Te = t.custom) == null ? void 0 : Te.model) || "",
              onChange: (oe) => R("model", oe),
              placeholder: "gpt-4o-mini",
              required: !0
            }
          ),
          /* @__PURE__ */ u.jsx(
            "button",
            {
              type: "button",
              className: "h-[42px] w-[42px] min-w-[42px] flex items-center justify-center border-none rounded-md bg-muted text-muted-foreground cursor-pointer transition-all hover:bg-accent hover:text-foreground disabled:opacity-50 disabled:cursor-not-allowed",
              onClick: _,
              disabled: p || !((X = t.custom) != null && X.apiUrl),
              title: "",
              children: p ? /* @__PURE__ */ u.jsx(Tl, { size: 16, className: "animate-spin" }) : /* @__PURE__ */ u.jsx(tr, { size: 16 })
            }
          )
        ] }),
        x && /* @__PURE__ */ u.jsx("p", { className: "text-xs text-destructive", children: x }),
        m.length > 0 && /* @__PURE__ */ u.jsxs("p", { className: "text-xs text-muted-foreground", children: [
          " ",
          m.length,
          " "
        ] })
      ] })
    ] }),
    /* @__PURE__ */ u.jsxs(mr, { title: "", description: "", children: [
      /* @__PURE__ */ u.jsx(
        hr,
        {
          label: " (Temperature)",
          value: t.parameters.temperature,
          onChange: (oe) => D("temperature", oe),
          min: 0,
          max: 2,
          step: 0.1,
          description: ""
        }
      ),
      /* @__PURE__ */ u.jsx(
        hr,
        {
          label: "Top-P",
          value: t.parameters.topP,
          onChange: (oe) => D("topP", oe),
          min: 0,
          max: 1,
          step: 0.05,
          description: " token "
        }
      ),
      /* @__PURE__ */ u.jsx(
        hr,
        {
          label: " Tokens",
          value: t.parameters.maxTokens,
          onChange: (oe) => D("maxTokens", oe),
          min: 64,
          max: 16384,
          step: 64,
          showSlider: !1
        }
      ),
      /* @__PURE__ */ u.jsx(
        hr,
        {
          label: "",
          value: t.parameters.frequencyPenalty,
          onChange: (oe) => D("frequencyPenalty", oe),
          min: -2,
          max: 2,
          step: 0.1,
          description: " token "
        }
      ),
      /* @__PURE__ */ u.jsx(
        hr,
        {
          label: "",
          value: t.parameters.presencePenalty,
          onChange: (oe) => D("presencePenalty", oe),
          min: -2,
          max: 2,
          step: 0.1,
          description: ""
        }
      )
    ] })
  ] });
}, fE = [
  { value: "custom", label: " (OpenAI )" },
  { value: "transformers", label: "Transformers ()" },
  { value: "openai", label: "OpenAI Embeddings" },
  { value: "ollama", label: "Ollama" },
  { value: "vllm", label: "vLLM" },
  { value: "cohere", label: "Cohere" },
  { value: "jina", label: "Jina AI" },
  { value: "voyage", label: "Voyage AI" }
], Qy = {
  custom: "text-embedding-3-small",
  transformers: "Xenova/all-MiniLM-L6-v2",
  openai: "text-embedding-3-small",
  ollama: "nomic-embed-text",
  vllm: "BAAI/bge-m3",
  cohere: "embed-multilingual-v3.0",
  jina: "jina-embeddings-v3",
  voyage: "voyage-large-2"
}, Xy = ["custom", "ollama", "vllm"], Wy = ["custom", "openai", "cohere", "jina", "voyage"], hE = ({
  config: t,
  onChange: r
}) => {
  var w;
  const a = (_) => {
    r({ ...t, ..._ });
  }, l = (_) => {
    a({
      source: _,
      model: Qy[_],
      apiUrl: Xy.includes(_) ? t.apiUrl : void 0,
      apiKey: Wy.includes(_) ? t.apiKey : void 0
    });
  }, s = Xy.includes(t.source), c = Wy.includes(t.source), [d, m] = U.useState([]), [g, p] = U.useState(!1), [v, x] = U.useState(null), E = async () => {
    p(!0), x(null);
    try {
      let _ = [];
      const A = { apiUrl: t.apiUrl || "", apiKey: t.apiKey };
      switch (t.source) {
        case "custom":
          if (!t.apiUrl) {
            x(" API URL");
            return;
          }
          _ = await oa.fetchOpenAIModels(A);
          break;
        case "ollama":
          if (!t.apiUrl) {
            x(" API URL");
            return;
          }
          _ = await oa.fetchOllamaModels(A);
          break;
        case "vllm":
          if (!t.apiUrl) {
            x(" API URL");
            return;
          }
          _ = await oa.fetchVLLMModels(A);
          break;
        case "openai":
        case "cohere":
        case "jina":
        case "voyage":
          _ = oa.getPresetModels(t.source);
          break;
        default:
          _ = [];
      }
      m(_), _.length === 0 && x("");
    } catch (_) {
      x(_.message || ""), m([]);
    } finally {
      p(!1);
    }
  };
  return /* @__PURE__ */ u.jsxs("div", { className: "", children: [
    /* @__PURE__ */ u.jsxs(mr, { title: "", description: "", children: [
      /* @__PURE__ */ u.jsx(
        Ri,
        {
          label: "",
          value: t.source,
          onChange: (_) => l(_),
          options: fE,
          description: ""
        }
      ),
      s && /* @__PURE__ */ u.jsx(
        er,
        {
          label: t.source === "ollama" ? "API Endpoint ()" : " API URL",
          type: "url",
          value: t.apiUrl || "",
          onChange: (_) => a({ apiUrl: _ }),
          placeholder: t.source === "ollama" ? "http://localhost:11434/api/embeddings" : "https://api.openai.com/v1/embeddings",
          description: t.source === "ollama" ? ": http://localhost:11434/api/embeddings" : " /v1/embeddings"
        }
      ),
      c && /* @__PURE__ */ u.jsx(
        er,
        {
          label: "API Key",
          type: "password",
          value: t.apiKey || "",
          onChange: (_) => a({ apiKey: _ }),
          placeholder: " API "
        }
      ),
      /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col gap-2", children: [
        /* @__PURE__ */ u.jsxs("div", { className: "flex items-end gap-2", children: [
          d.length > 0 ? /* @__PURE__ */ u.jsx("div", { className: "flex-1 relative", children: /* @__PURE__ */ u.jsx(
            s2,
            {
              className: "!mb-0",
              label: "",
              value: t.model || "",
              onChange: (_) => a({ model: _ }),
              options: d.map((_) => ({ value: _.id, label: _.name || _.id })),
              placeholder: "",
              emptyText: ""
            }
          ) }) : /* @__PURE__ */ u.jsx(
            er,
            {
              className: "flex-1 !mb-0",
              label: "",
              value: t.model || "",
              onChange: (_) => a({ model: _ }),
              placeholder: Qy[t.source],
              description: ""
            }
          ),
          (s || c) && /* @__PURE__ */ u.jsx(
            "button",
            {
              type: "button",
              className: "h-[42px] w-[42px] min-w-[42px] flex items-center justify-center border-none rounded-md bg-muted text-muted-foreground cursor-pointer transition-all hover:bg-accent hover:text-foreground disabled:opacity-50 disabled:cursor-not-allowed",
              onClick: E,
              disabled: g,
              title: "",
              children: g ? /* @__PURE__ */ u.jsx(Tl, { size: 16, className: "animate-spin" }) : /* @__PURE__ */ u.jsx(tr, { size: 16 })
            }
          )
        ] }),
        v && /* @__PURE__ */ u.jsx("p", { className: "text-xs text-destructive", children: v }),
        d.length > 0 && /* @__PURE__ */ u.jsxs("p", { className: "text-xs text-muted-foreground", children: [
          " ",
          d.length,
          " "
        ] })
      ] })
    ] }),
    /* @__PURE__ */ u.jsx(mr, { title: "", collapsible: !0, defaultCollapsed: !0, children: /* @__PURE__ */ u.jsx(
      er,
      {
        label: "",
        value: ((w = t.dimensions) == null ? void 0 : w.toString()) || "",
        onChange: (_) => {
          const A = parseInt(_, 10);
          a({ dimensions: isNaN(A) ? void 0 : A });
        },
        placeholder: "",
        description: ""
      }
    ) })
  ] });
}, mE = ({
  config: t,
  onChange: r
}) => {
  const a = (v) => {
    r({ ...t, ...v });
  }, [l, s] = U.useState([]), [c, d] = U.useState(!1), [m, g] = U.useState(null), p = async () => {
    if (!t.url) {
      g(" API URL");
      return;
    }
    d(!0), g(null);
    try {
      const v = await oa.fetchOpenAIModels({
        apiUrl: t.url,
        apiKey: t.apiKey
      });
      v.length > 0 ? s(v) : s(oa.getCommonRerankModels());
    } catch {
      s(oa.getCommonRerankModels());
    } finally {
      d(!1);
    }
  };
  return /* @__PURE__ */ u.jsxs("div", { className: "", children: [
    /* @__PURE__ */ u.jsx(mr, { title: "Rerank ", description: "", children: /* @__PURE__ */ u.jsx(
      la,
      {
        label: " Rerank",
        checked: t.enabled,
        onChange: (v) => a({ enabled: v }),
        description: " Rerank "
      }
    ) }),
    t.enabled && /* @__PURE__ */ u.jsxs(u.Fragment, { children: [
      /* @__PURE__ */ u.jsxs(mr, { title: "API ", children: [
        /* @__PURE__ */ u.jsx(
          er,
          {
            label: "API URL",
            type: "url",
            value: t.url,
            onChange: (v) => a({ url: v }),
            placeholder: "http://localhost:8000/rerank",
            description: "Rerank  API ",
            required: !0
          }
        ),
        /* @__PURE__ */ u.jsx(
          er,
          {
            label: "API Key",
            type: "password",
            value: t.apiKey,
            onChange: (v) => a({ apiKey: v }),
            placeholder: " API "
          }
        ),
        /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col gap-2", children: [
          /* @__PURE__ */ u.jsxs("div", { className: "flex items-end gap-2", children: [
            l.length > 0 ? /* @__PURE__ */ u.jsx("div", { className: "flex-1 relative", children: /* @__PURE__ */ u.jsx(
              s2,
              {
                className: "!mb-0",
                label: "",
                value: t.model,
                onChange: (v) => a({ model: v }),
                options: l.map((v) => ({ value: v.id, label: v.name || v.id })),
                placeholder: "",
                emptyText: ""
              }
            ) }) : /* @__PURE__ */ u.jsx(
              er,
              {
                className: "flex-1 !mb-0",
                label: "",
                value: t.model,
                onChange: (v) => a({ model: v }),
                placeholder: "BAAI/bge-reranker-v2-m3",
                description: " Rerank ",
                required: !0
              }
            ),
            /* @__PURE__ */ u.jsx(
              "button",
              {
                type: "button",
                className: "h-[42px] w-[42px] min-w-[42px] flex items-center justify-center border-none rounded-md bg-muted text-muted-foreground cursor-pointer transition-all hover:bg-accent hover:text-foreground disabled:opacity-50 disabled:cursor-not-allowed",
                onClick: p,
                disabled: c,
                title: "",
                children: c ? /* @__PURE__ */ u.jsx(Tl, { size: 16, className: "animate-spin" }) : /* @__PURE__ */ u.jsx(tr, { size: 16 })
              }
            )
          ] }),
          m && /* @__PURE__ */ u.jsx("p", { className: "text-xs text-destructive", children: m }),
          l.length > 0 && /* @__PURE__ */ u.jsxs("p", { className: "text-xs text-muted-foreground", children: [
            " ",
            l.length,
            " "
          ] })
        ] })
      ] }),
      /* @__PURE__ */ u.jsxs(mr, { title: "", children: [
        /* @__PURE__ */ u.jsx(
          hr,
          {
            label: "Top-N",
            value: t.topN,
            onChange: (v) => a({ topN: v }),
            min: 1,
            max: 50,
            step: 1,
            description: ""
          }
        ),
        /* @__PURE__ */ u.jsx(
          hr,
          {
            label: " (Hybrid Alpha)",
            value: t.hybridAlpha,
            onChange: (v) => a({ hybridAlpha: v }),
            min: 0,
            max: 1,
            step: 0.1,
            description: "0 = 1 =  Rerank "
          }
        )
      ] })
    ] })
  ] });
}, u2 = ({ config: t, onChange: r }) => {
  var l, s, c, d;
  const a = (m) => {
    const g = { ...t, ...m };
    r(g);
  };
  return /* @__PURE__ */ u.jsxs("div", { className: "space-y-6 animate-in fade-in slide-in-from-right-4 duration-500", children: [
    /* @__PURE__ */ u.jsx("div", { className: "bg-secondary/20 p-4 rounded-lg border border-border/50", children: /* @__PURE__ */ u.jsxs("div", { className: "flex items-center justify-between", children: [
      /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-3", children: [
        /* @__PURE__ */ u.jsx("div", { className: `p-2 rounded-md ${t.enabled ? "bg-primary/20 text-primary" : "bg-muted text-muted-foreground"}`, children: /* @__PURE__ */ u.jsx(mb, { size: 20 }) }),
        /* @__PURE__ */ u.jsxs("div", { children: [
          /* @__PURE__ */ u.jsx("div", { className: "font-medium", children: " RAG " }),
          /* @__PURE__ */ u.jsx("div", { className: "text-xs text-muted-foreground", children: "" })
        ] })
      ] }),
      /* @__PURE__ */ u.jsx(
        On,
        {
          checked: t.enabled,
          onChange: (m) => a({ enabled: m })
        }
      )
    ] }) }),
    /* @__PURE__ */ u.jsxs("div", { className: "space-y-4", children: [
      /* @__PURE__ */ u.jsx("h3", { className: "text-sm font-medium text-muted-foreground uppercase tracking-wider px-1", children: "" }),
      /* @__PURE__ */ u.jsxs("div", { className: "grid grid-cols-1 md:grid-cols-2 gap-4", children: [
        /* @__PURE__ */ u.jsxs("div", { className: `p-4 rounded-lg border transition-all ${t.useBruteForce ? "bg-primary/5 border-primary/30" : "bg-card border-border/50 hover:border-border"}`, children: [
          /* @__PURE__ */ u.jsxs("div", { className: "flex items-start justify-between mb-2", children: [
            /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-2 text-sm font-medium", children: [
              /* @__PURE__ */ u.jsx(Bi, { size: 16, className: t.useBruteForce ? "text-primary" : "text-muted-foreground" }),
              " (Brute Force)"
            ] }),
            /* @__PURE__ */ u.jsx(
              On,
              {
                checked: t.useBruteForce,
                onChange: (m) => a({ useBruteForce: m })
              }
            )
          ] }),
          /* @__PURE__ */ u.jsx("p", { className: "text-xs text-muted-foreground leading-relaxed", children: "" })
        ] }),
        /* @__PURE__ */ u.jsxs("div", { className: `p-4 rounded-lg border transition-all ${t.useEmbedding ? "bg-primary/5 border-primary/30" : "bg-card border-border/50 hover:border-border"}`, children: [
          /* @__PURE__ */ u.jsxs("div", { className: "flex items-start justify-between mb-2", children: [
            /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-2 text-sm font-medium", children: [
              /* @__PURE__ */ u.jsx(hu, { size: 16, className: t.useEmbedding ? "text-primary" : "text-muted-foreground" }),
              " (Embedding)"
            ] }),
            /* @__PURE__ */ u.jsx(
              On,
              {
                checked: t.useEmbedding,
                onChange: (m) => a({ useEmbedding: m })
              }
            )
          ] }),
          /* @__PURE__ */ u.jsx("p", { className: "text-xs text-muted-foreground leading-relaxed", children: "RAG " })
        ] }),
        /* @__PURE__ */ u.jsxs("div", { className: `p-4 rounded-lg border transition-all ${t.usePreprocessing ? "bg-primary/5 border-primary/30" : "bg-card border-border/50 hover:border-border"}`, children: [
          /* @__PURE__ */ u.jsxs("div", { className: "flex items-start justify-between mb-2", children: [
            /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-2 text-sm font-medium", children: [
              /* @__PURE__ */ u.jsx(l4, { size: 16, className: t.usePreprocessing ? "text-primary" : "text-muted-foreground" }),
              "LLM "
            ] }),
            /* @__PURE__ */ u.jsx(
              On,
              {
                checked: t.usePreprocessing,
                onChange: (m) => a({ usePreprocessing: m })
              }
            )
          ] }),
          /* @__PURE__ */ u.jsx("p", { className: "text-xs text-muted-foreground leading-relaxed", children: " LLM " })
        ] }),
        /* @__PURE__ */ u.jsxs("div", { className: `p-4 rounded-lg border transition-all ${t.useRerank ? "bg-primary/5 border-primary/30" : "bg-card border-border/50 hover:border-border"}`, children: [
          /* @__PURE__ */ u.jsxs("div", { className: "flex items-start justify-between mb-2", children: [
            /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-2 text-sm font-medium", children: [
              /* @__PURE__ */ u.jsx(Rm, { size: 16, className: t.useRerank ? "text-primary" : "text-muted-foreground" }),
              "Rerank "
            ] }),
            /* @__PURE__ */ u.jsx(
              On,
              {
                checked: t.useRerank,
                disabled: !t.useEmbedding,
                onChange: (m) => a({ useRerank: m })
              }
            )
          ] }),
          /* @__PURE__ */ u.jsxs("p", { className: "text-xs text-muted-foreground leading-relaxed", children: [
            " Rerank ",
            !t.useEmbedding && /* @__PURE__ */ u.jsxs("span", { className: "text-yellow-500 block mt-1 text-[10px] flex items-center gap-1", children: [
              /* @__PURE__ */ u.jsx(bb, { size: 10 }),
              " "
            ] })
          ] })
        ] })
      ] })
    ] }),
    /* @__PURE__ */ u.jsxs("div", { className: "grid grid-cols-1 md:grid-cols-2 gap-6 pt-4 border-t border-border/30", children: [
      /* @__PURE__ */ u.jsx(
        hr,
        {
          label: " (Top-K)",
          description: "",
          min: 1,
          max: 100,
          value: ((l = t.embedding) == null ? void 0 : l.topK) ?? 20,
          onChange: (m) => {
            var g;
            return a({
              embedding: {
                topK: m,
                minScoreThreshold: ((g = t.embedding) == null ? void 0 : g.minScoreThreshold) ?? 0.3
              }
            });
          }
        }
      ),
      /* @__PURE__ */ u.jsx(
        hr,
        {
          label: "",
          description: " (0.0 - 1.0)",
          min: 0,
          max: 1,
          step: 0.05,
          value: ((s = t.embedding) == null ? void 0 : s.minScoreThreshold) ?? 0.3,
          onChange: (m) => {
            var g;
            return a({
              embedding: {
                topK: ((g = t.embedding) == null ? void 0 : g.topK) ?? 20,
                minScoreThreshold: m
              }
            });
          }
        }
      )
    ] }),
    /* @__PURE__ */ u.jsxs("div", { className: "space-y-4 pt-4 border-t border-border/30", children: [
      /* @__PURE__ */ u.jsxs("div", { className: "flex items-center justify-between", children: [
        /* @__PURE__ */ u.jsx("h3", { className: "text-sm font-medium text-muted-foreground uppercase tracking-wider", children: " (Sticky)" }),
        /* @__PURE__ */ u.jsx(
          On,
          {
            checked: ((c = t.sticky) == null ? void 0 : c.enabled) ?? !0,
            onChange: (m) => a({
              sticky: {
                ...t.sticky || { decayFactor: 0.15, maxStickRounds: 3 },
                enabled: m
              }
            })
          }
        )
      ] }),
      ((d = t.sticky) == null ? void 0 : d.enabled) && /* @__PURE__ */ u.jsx("div", { className: "grid grid-cols-1 md:grid-cols-2 gap-6", children: /* @__PURE__ */ u.jsx(
        hr,
        {
          label: "",
          description: " (0-1)",
          min: 0,
          max: 1,
          step: 0.05,
          value: t.sticky.decayFactor,
          onChange: (m) => a({
            sticky: { ...t.sticky, decayFactor: m }
          })
        }
      ) })
    ] })
  ] });
};
function pE(t) {
  switch (t) {
    case "summary":
      return "text-blue-500 bg-blue-500/10 border border-blue-500/20";
    case "trim":
      return "text-orange-500 bg-orange-500/10 border border-orange-500/20";
    case "preprocessing":
      return "text-emerald-500 bg-emerald-500/10 border border-emerald-500/20";
    default:
      return "text-muted-foreground bg-muted border border-border";
  }
}
function gE(t) {
  var r;
  return ((r = Jc.find((a) => a.value === t)) == null ? void 0 : r.label) || t;
}
const yE = ({
  template: t,
  isSelected: r = !1,
  onSelect: a,
  onCopy: l,
  onDelete: s,
  onToggleEnabled: c,
  onImport: d,
  onResetToDefault: m
}) => {
  const g = U.useRef(null), p = (w) => {
    w.stopPropagation();
    const _ = {
      version: "1.0",
      exportedAt: Date.now(),
      template: {
        name: t.name,
        category: t.category,
        boundPresetId: t.boundPresetId,
        systemPrompt: t.systemPrompt,
        userPromptTemplate: t.userPromptTemplate,
        outputFormat: t.outputFormat,
        availableVariables: t.availableVariables
      }
    }, A = new Blob([JSON.stringify(_, null, 2)], { type: "application/json" }), D = URL.createObjectURL(A), R = document.createElement("a");
    R.href = D, R.download = `engram_template_${t.name.replace(/\s+/g, "_")}.json`, R.click(), URL.revokeObjectURL(D);
  }, v = (w) => {
    var _;
    w.stopPropagation(), (_ = g.current) == null || _.click();
  }, x = (w) => {
    var D;
    const _ = (D = w.target.files) == null ? void 0 : D[0];
    if (!_ || !d) return;
    const A = new FileReader();
    A.onload = (R) => {
      var Z;
      try {
        const K = JSON.parse((Z = R.target) == null ? void 0 : Z.result);
        if (K.version && K.template) {
          const ge = Mi(
            K.template.name,
            K.template.category,
            {
              enabled: t.enabled,
              // 
              isBuiltIn: t.isBuiltIn,
              // 
              boundPresetId: K.template.boundPresetId,
              systemPrompt: K.template.systemPrompt,
              userPromptTemplate: K.template.userPromptTemplate,
              outputFormat: K.template.outputFormat,
              availableVariables: K.template.availableVariables
            }
          );
          ge.id = t.id, d(ge);
        }
      } catch (K) {
        console.error(":", K);
      }
    }, A.readAsText(_), g.current && (g.current.value = "");
  }, E = t.category === "preprocessing";
  return /* @__PURE__ */ u.jsxs(
    "div",
    {
      className: `
                group relative p-3 rounded-lg border cursor-pointer transition-all duration-200
                ${r ? "bg-accent/50 border-input" : "bg-transparent border-transparent hover:bg-muted/50 hover:border-border"}
                ${!t.enabled && !E && "opacity-50"}
            `,
      onClick: a,
      children: [
        /* @__PURE__ */ u.jsxs("div", { className: "flex items-start gap-3", children: [
          E ? (
            // ""
            /* @__PURE__ */ u.jsx(
              "div",
              {
                className: "w-8 h-8 flex items-center justify-center rounded-lg bg-emerald-500/10 text-emerald-500 flex-shrink-0",
                title: " ()",
                children: /* @__PURE__ */ u.jsx(Mm, { size: 16 })
              }
            )
          ) : /* @__PURE__ */ u.jsx(
            "button",
            {
              className: `
                            w-8 h-8 flex items-center justify-center rounded-lg transition-colors flex-shrink-0
                            ${t.enabled ? "bg-primary/10 text-primary" : "bg-muted text-muted-foreground hover:bg-muted/80"}
                        `,
              onClick: (w) => {
                w.stopPropagation(), c == null || c(!t.enabled);
              },
              title: t.enabled ? "" : "",
              children: /* @__PURE__ */ u.jsx(Dm, { size: 16 })
            }
          ),
          /* @__PURE__ */ u.jsxs("div", { className: "flex-1 min-w-0", children: [
            /* @__PURE__ */ u.jsxs("div", { className: "flex items-center justify-between gap-2", children: [
              /* @__PURE__ */ u.jsx("h4", { className: `text-sm font-medium truncate ${r ? "text-foreground" : "text-muted-foreground group-hover:text-foreground"} ${!t.enabled && "line-through"}`, children: t.name }),
              /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-1.5 flex-shrink-0", children: [
                /* @__PURE__ */ u.jsx("span", { className: `text-[10px] px-1.5 py-0.5 rounded-sm font-medium ${pE(t.category)}`, children: gE(t.category) }),
                t.isBuiltIn && /* @__PURE__ */ u.jsx("span", { className: "text-[10px] px-1.5 py-0.5 rounded-sm bg-muted text-muted-foreground", children: "BUILTIN" })
              ] })
            ] }),
            /* @__PURE__ */ u.jsxs("div", { className: "mt-1 flex items-center justify-between text-[10px] text-muted-foreground/70 font-mono", children: [
              /* @__PURE__ */ u.jsx("span", { className: "truncate max-w-[120px]", children: t.boundPresetId ? `BOUND: ${t.boundPresetId}` : "DEFAULT PRESET" }),
              /* @__PURE__ */ u.jsx("span", { children: t.outputFormat.toUpperCase() })
            ] })
          ] })
        ] }),
        /* @__PURE__ */ u.jsxs("div", { className: `mt-2 flex justify-end gap-1 ${r || "opacity-0 group-hover:opacity-100"} transition-opacity`, children: [
          /* @__PURE__ */ u.jsx("button", { className: "p-1.5 hover:bg-muted rounded text-muted-foreground hover:text-foreground transition-colors", onClick: v, title: "Import", children: /* @__PURE__ */ u.jsx(P3, { size: 12 }) }),
          /* @__PURE__ */ u.jsx("button", { className: "p-1.5 hover:bg-muted rounded text-muted-foreground hover:text-foreground transition-colors", onClick: p, title: "Export", children: /* @__PURE__ */ u.jsx(tu, { size: 12 }) }),
          /* @__PURE__ */ u.jsx("button", { className: "p-1.5 hover:bg-muted rounded text-muted-foreground hover:text-foreground transition-colors", onClick: (w) => {
            w.stopPropagation(), l == null || l();
          }, title: "Copy", children: /* @__PURE__ */ u.jsx(fb, { size: 12 }) }),
          t.isBuiltIn && /* @__PURE__ */ u.jsx(
            "button",
            {
              className: "p-1.5 hover:bg-amber-500/10 rounded text-muted-foreground hover:text-amber-500 transition-colors",
              onClick: (w) => {
                w.stopPropagation();
                let _ = Ab(t.id);
                _ || (_ = Hm(t.category)), _ && m && m({
                  ..._,
                  id: t.id,
                  enabled: t.enabled
                });
              },
              title: "",
              children: /* @__PURE__ */ u.jsx(y3, { size: 12 })
            }
          ),
          !t.isBuiltIn && /* @__PURE__ */ u.jsx("button", { className: "p-1.5 hover:bg-destructive/10 rounded text-muted-foreground hover:text-destructive transition-colors", onClick: (w) => {
            w.stopPropagation(), s == null || s();
          }, title: "Delete", children: /* @__PURE__ */ u.jsx(ca, { size: 12 }) })
        ] }),
        /* @__PURE__ */ u.jsx(
          "input",
          {
            ref: g,
            type: "file",
            accept: ".json",
            onChange: x,
            className: "hidden"
          }
        )
      ]
    }
  );
}, bE = ({
  templates: t,
  selectedId: r,
  onSelect: a,
  onAdd: l,
  onUpdate: s,
  onDelete: c
}) => {
  const d = () => {
    const x = Mi(
      ` ${t.length + 1}`,
      "summary"
    );
    l(x), a(x);
  }, m = (x) => {
    const E = Mi(
      `${x.name} ()`,
      x.category,
      {
        enabled: !1,
        // 
        boundPresetId: x.boundPresetId,
        systemPrompt: x.systemPrompt,
        userPromptTemplate: x.userPromptTemplate,
        outputFormat: x.outputFormat,
        availableVariables: [...x.availableVariables]
      }
    );
    l(E);
  }, g = (x, E) => {
    E && t.filter((w) => w.category === x.category && w.id !== x.id && w.enabled).forEach((w) => s({ ...w, enabled: !1 })), s({ ...x, enabled: E });
  }, p = (x) => {
    s(x);
  }, v = Jc.map((x) => ({
    ...x,
    templates: t.filter((E) => E.category === x.value)
  })).filter((x) => x.templates.length > 0);
  return /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col gap-4 h-full", children: [
    /* @__PURE__ */ u.jsxs("div", { className: "flex items-center justify-between gap-2", children: [
      /* @__PURE__ */ u.jsx("h3", { className: "text-xs font-bold text-muted-foreground uppercase tracking-wider", children: "" }),
      /* @__PURE__ */ u.jsx(
        "button",
        {
          className: "text-muted-foreground hover:text-foreground transition-colors",
          onClick: d,
          children: /* @__PURE__ */ u.jsx(pb, { size: 16 })
        }
      )
    ] }),
    /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col gap-6 overflow-y-auto flex-1 no-scrollbar", children: [
      v.map((x) => /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col gap-2", children: [
        /* @__PURE__ */ u.jsxs("div", { className: "text-[10px] items-center gap-2 text-muted-foreground font-medium px-1 uppercase tracking-wider flex", children: [
          x.label,
          /* @__PURE__ */ u.jsx("div", { className: "h-px bg-border flex-1" })
        ] }),
        /* @__PURE__ */ u.jsx("div", { className: "flex flex-col gap-1", children: x.templates.map((E) => /* @__PURE__ */ u.jsx(
          yE,
          {
            template: E,
            isSelected: r === E.id,
            onSelect: () => a(E),
            onCopy: () => m(E),
            onDelete: () => c(E),
            onToggleEnabled: (w) => g(E, w),
            onImport: p,
            onResetToDefault: (w) => s(w)
          },
          E.id
        )) })
      ] }, x.value)),
      t.length === 0 && /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col items-center justify-center py-12 text-muted-foreground gap-2 border border-dashed border-border rounded-lg", children: [
        /* @__PURE__ */ u.jsx(mu, { size: 24, className: "opacity-50" }),
        /* @__PURE__ */ u.jsx("p", { className: "text-xs", children: "" })
      ] })
    ] })
  ] });
}, xE = [
  { name: "{{chatHistory}}", desc: "" },
  { name: "{{context}}", desc: "" },
  { name: "{{char}}", desc: "" },
  { name: "{{user}}", desc: "" },
  { name: "{{userInput}}", desc: "" },
  { name: "{{worldbookContext}}", desc: "" },
  { name: "{{engramSummaries}}", desc: "Engram " }
], Zy = ({
  template: t,
  llmPresets: r,
  defaultPresetId: a,
  onChange: l
}) => {
  var d, m;
  const s = [
    { value: "", label: "" + (a ? ` (${((d = r.find((g) => g.id === a)) == null ? void 0 : d.name) || a})` : "") },
    ...r.map((g) => ({ value: g.id, label: g.name }))
  ], c = (g) => {
    l({ ...t, ...g, updatedAt: Date.now() });
  };
  return /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col gap-4", children: [
    /* @__PURE__ */ u.jsxs(mr, { title: "", children: [
      /* @__PURE__ */ u.jsx(
        er,
        {
          label: "",
          value: t.name,
          onChange: (g) => c({ name: g }),
          placeholder: "",
          required: !0,
          disabled: t.isBuiltIn
        }
      ),
      /* @__PURE__ */ u.jsx(
        Ri,
        {
          label: "",
          value: t.category,
          onChange: (g) => c({ category: g }),
          options: Jc.map((g) => ({ value: g.value, label: g.label })),
          description: (m = Jc.find((g) => g.value === t.category)) == null ? void 0 : m.description
        }
      ),
      /* @__PURE__ */ u.jsx(
        Ri,
        {
          label: "",
          value: t.boundPresetId || "",
          onChange: (g) => c({ boundPresetId: g || null }),
          options: s,
          description: " LLM "
        }
      )
    ] }),
    /* @__PURE__ */ u.jsxs(mr, { title: "", children: [
      /* @__PURE__ */ u.jsx(
        er,
        {
          label: "",
          value: t.systemPrompt,
          onChange: (g) => c({ systemPrompt: g }),
          placeholder: "...",
          multiline: !0,
          rows: 4
        }
      ),
      /* @__PURE__ */ u.jsx(
        er,
        {
          label: "",
          value: t.userPromptTemplate,
          onChange: (g) => c({ userPromptTemplate: g }),
          placeholder: "...",
          multiline: !0,
          rows: 6
        }
      )
    ] }),
    /* @__PURE__ */ u.jsxs("div", { className: "px-3 py-2 bg-muted/30 rounded border border-border", children: [
      /* @__PURE__ */ u.jsx("div", { className: "text-[10px] text-muted-foreground mb-2 font-medium uppercase tracking-wider", children: "" }),
      /* @__PURE__ */ u.jsx("div", { className: "flex flex-col gap-1", children: xE.map((g) => /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-2 text-[10px]", children: [
        /* @__PURE__ */ u.jsx("code", { className: "px-1.5 py-0.5 bg-muted rounded text-primary font-mono whitespace-nowrap", children: g.name }),
        /* @__PURE__ */ u.jsx("span", { className: "text-muted-foreground", children: g.desc })
      ] }, g.name)) })
    ] })
  ] });
}, vE = ({
  rules: t,
  selectedId: r,
  onSelect: a,
  onToggle: l,
  onDelete: s,
  onAdd: c,
  onReset: d,
  enableNativeRegex: m,
  onToggleNativeRegex: g
}) => /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col gap-4", children: [
  /* @__PURE__ */ u.jsxs("div", { className: "flex items-center justify-between", children: [
    /* @__PURE__ */ u.jsx("h3", { className: "text-xs font-bold text-muted-foreground uppercase tracking-wider", children: "" }),
    /* @__PURE__ */ u.jsxs("div", { className: "flex gap-2", children: [
      /* @__PURE__ */ u.jsx(
        "button",
        {
          className: "text-[10px] text-muted-foreground hover:text-destructive transition-colors",
          onClick: d,
          children: ""
        }
      ),
      /* @__PURE__ */ u.jsx(
        "button",
        {
          className: "text-muted-foreground hover:text-foreground transition-colors",
          onClick: c,
          children: /* @__PURE__ */ u.jsx(gb, { size: 16 })
        }
      )
    ] })
  ] }),
  /* @__PURE__ */ u.jsx("div", { className: "bg-muted/10 border border-border/50 rounded-lg p-3 mb-2", children: /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4", children: [
    /* @__PURE__ */ u.jsxs("div", { className: "flex-1 min-w-0", children: [
      /* @__PURE__ */ u.jsx("h4", { className: "text-sm font-medium", children: " Regex " }),
      /* @__PURE__ */ u.jsx("p", { className: "text-xs text-muted-foreground mt-0.5 break-words", children: " SillyTavern  Regex " })
    ] }),
    /* @__PURE__ */ u.jsx(
      On,
      {
        checked: m ?? !0,
        onChange: (p) => g == null ? void 0 : g(p)
      }
    )
  ] }) }),
  /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col gap-1", children: [
    t.map((p) => /* @__PURE__ */ u.jsxs(
      "div",
      {
        className: `
                            group p-3 rounded-lg transition-all duration-200 cursor-pointer border flex items-center gap-3
                            ${r === p.id ? "bg-accent/50 border-input" : "bg-transparent border-transparent hover:bg-muted/50 hover:border-border"}
                            ${!p.enabled && "opacity-50"}
                        `,
        onClick: () => a(p.id),
        children: [
          /* @__PURE__ */ u.jsx(
            "button",
            {
              className: `
                                w-8 h-8 flex items-center justify-center rounded-lg transition-colors
                                ${p.enabled ? r === p.id ? "bg-primary/20 text-primary" : "bg-muted text-primary" : "bg-muted text-muted-foreground"}
                            `,
              onClick: (v) => {
                v.stopPropagation(), l(p.id);
              },
              title: p.enabled ? "" : "",
              children: /* @__PURE__ */ u.jsx(Dm, { size: 14 })
            }
          ),
          /* @__PURE__ */ u.jsxs("div", { className: "flex-1 min-w-0", children: [
            /* @__PURE__ */ u.jsx("div", { className: "flex items-center justify-between", children: /* @__PURE__ */ u.jsx("h4", { className: `text-sm font-medium truncate ${r === p.id ? "text-foreground" : "text-muted-foreground group-hover:text-foreground"} ${!p.enabled && "opacity-50 line-through"}`, children: p.name }) }),
            /* @__PURE__ */ u.jsx("div", { className: "mt-0.5 flex items-center gap-2", children: /* @__PURE__ */ u.jsxs("code", { className: "text-[10px] bg-muted px-1 rounded text-muted-foreground font-mono truncate max-w-[120px]", children: [
              "/",
              p.pattern,
              "/",
              p.flags
            ] }) })
          ] }),
          /* @__PURE__ */ u.jsx("div", { className: `flex items-center ${r === p.id ? "opacity-100" : "opacity-0 group-hover:opacity-100"} transition-opacity`, children: /* @__PURE__ */ u.jsx(
            "button",
            {
              className: "p-1.5 hover:bg-destructive/10 rounded text-muted-foreground hover:text-destructive transition-colors",
              onClick: (v) => {
                v.stopPropagation(), s(p.id);
              },
              children: /* @__PURE__ */ u.jsx(ca, { size: 12 })
            }
          ) })
        ]
      },
      p.id
    )),
    t.length === 0 && /* @__PURE__ */ u.jsx("div", { className: "text-center p-8 border border-dashed border-border rounded-lg", children: /* @__PURE__ */ u.jsx("p", { className: "text-xs text-muted-foreground", children: "" }) })
  ] })
] }), SE = [
  { value: "g", label: "", description: "" },
  { value: "i", label: "", description: "" },
  { value: "m", label: "", description: "^$ " },
  { value: "s", label: "", description: ". " }
], Jy = ({ rule: t, onChange: r }) => {
  var v;
  const [a, l] = U.useState(""), [s, c] = U.useState(""), [d, m] = U.useState({ valid: !0 }), g = new bd();
  U.useEffect(() => {
    const x = g.validatePattern(t.pattern, t.flags);
    m(x);
  }, [t.pattern, t.flags]), U.useEffect(() => {
    if (a && d.valid) {
      const x = g.processWithRule(a, t);
      c(x);
    } else
      c("");
  }, [a, t, d.valid]);
  const p = (x) => {
    const E = t.flags.split(""), w = E.indexOf(x);
    w >= 0 ? E.splice(w, 1) : E.push(x), r({ flags: E.join("") });
  };
  return /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col gap-4", children: [
    /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col gap-3", children: [
      /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col gap-1.5", children: [
        /* @__PURE__ */ u.jsx("label", { className: "text-sm font-medium text-foreground", children: "" }),
        /* @__PURE__ */ u.jsx(
          "input",
          {
            type: "text",
            className: "w-full px-3 py-2 rounded-md border border-input bg-background text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring",
            value: t.name,
            onChange: (x) => r({ name: x.target.value }),
            placeholder: ""
          }
        )
      ] }),
      /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col gap-1.5", children: [
        /* @__PURE__ */ u.jsx("label", { className: "text-sm font-medium text-foreground", children: "" }),
        /* @__PURE__ */ u.jsx(
          "input",
          {
            type: "text",
            className: "w-full px-3 py-2 rounded-md border border-input bg-background text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring",
            value: t.description || "",
            onChange: (x) => r({ description: x.target.value }),
            placeholder: ""
          }
        )
      ] }),
      /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col gap-1.5", children: [
        /* @__PURE__ */ u.jsx("label", { className: "text-sm font-medium text-foreground", children: "" }),
        /* @__PURE__ */ u.jsx("div", { className: "flex gap-2", children: vm.map((x) => /* @__PURE__ */ u.jsx(
          "button",
          {
            className: `flex-1 px-3 py-2 text-sm rounded-md border transition-colors ${t.scope === x.value ? "bg-primary-20 border-primary text-primary" : "bg-background border-border text-muted-foreground hover:bg-muted"}`,
            onClick: () => r({ scope: x.value }),
            title: x.description,
            children: x.label
          },
          x.value
        )) }),
        /* @__PURE__ */ u.jsx("p", { className: "text-xs text-muted-foreground", children: (v = vm.find((x) => x.value === t.scope)) == null ? void 0 : v.description })
      ] })
    ] }),
    /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col gap-3 p-4 bg-card border border-border rounded-lg", children: [
      /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col gap-1.5", children: [
        /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-2", children: [
          /* @__PURE__ */ u.jsx("label", { className: "text-sm font-medium text-foreground", children: "" }),
          d.valid ? /* @__PURE__ */ u.jsx(zm, { size: 14, className: "text-green-500" }) : /* @__PURE__ */ u.jsx(El, { size: 14, className: "text-red-500" })
        ] }),
        /* @__PURE__ */ u.jsx(
          "input",
          {
            type: "text",
            className: `w-full px-3 py-2 rounded-md border bg-background text-foreground font-mono text-sm placeholder:text-muted-foreground focus:outline-none focus:ring-2 ${d.valid ? "border-input focus:ring-ring" : "border-red-500 focus:ring-red-500"}`,
            value: t.pattern,
            onChange: (x) => r({ pattern: x.target.value }),
            placeholder: "<think>[\\s\\S]*?</think>"
          }
        ),
        !d.valid && d.error && /* @__PURE__ */ u.jsx("p", { className: "text-xs text-red-500", children: d.error })
      ] }),
      /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col gap-1.5", children: [
        /* @__PURE__ */ u.jsx("label", { className: "text-sm font-medium text-foreground", children: "" }),
        /* @__PURE__ */ u.jsx(
          "input",
          {
            type: "text",
            className: "w-full px-3 py-2 rounded-md border border-input bg-background text-foreground font-mono text-sm placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring",
            value: t.replacement,
            onChange: (x) => r({ replacement: x.target.value }),
            placeholder: ""
          }
        )
      ] }),
      /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col gap-1.5", children: [
        /* @__PURE__ */ u.jsx("label", { className: "text-sm font-medium text-foreground", children: "" }),
        /* @__PURE__ */ u.jsx("div", { className: "flex flex-wrap gap-2", children: SE.map((x) => /* @__PURE__ */ u.jsxs(
          "button",
          {
            className: `px-2 py-1 text-xs rounded-md border transition-colors ${t.flags.includes(x.value) ? "bg-primary-20 border-primary text-primary" : "bg-background border-border text-muted-foreground hover:bg-muted"}`,
            onClick: () => p(x.value),
            title: x.description,
            children: [
              x.label,
              " (",
              x.value,
              ")"
            ]
          },
          x.value
        )) })
      ] })
    ] }),
    /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col gap-3 p-4 bg-muted-20 border border-border rounded-lg", children: [
      /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-2 text-sm font-medium text-foreground", children: [
        /* @__PURE__ */ u.jsx(Om, { size: 14 }),
        ""
      ] }),
      /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col gap-1.5", children: [
        /* @__PURE__ */ u.jsx("label", { className: "text-xs text-muted-foreground", children: "" }),
        /* @__PURE__ */ u.jsx(
          "textarea",
          {
            className: "w-full min-h-[80px] px-3 py-2 rounded-md border border-input bg-background text-foreground text-sm resize-y focus:outline-none focus:ring-2 focus:ring-ring",
            value: a,
            onChange: (x) => l(x.target.value),
            placeholder: `
<think></think>
`
          }
        )
      ] }),
      a && d.valid && /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col gap-1.5", children: [
        /* @__PURE__ */ u.jsx("label", { className: "text-xs text-muted-foreground", children: "" }),
        /* @__PURE__ */ u.jsx("div", { className: "min-h-[60px] px-3 py-2 rounded-md border border-border bg-background text-sm whitespace-pre-wrap", children: s || /* @__PURE__ */ u.jsx("span", { className: "text-muted-foreground italic", children: "" }) })
      ] })
    ] }),
    /* @__PURE__ */ u.jsxs("div", { className: "flex items-start gap-2 p-3 bg-blue-500/10 border border-blue-500/30 rounded-lg text-sm text-blue-400", children: [
      /* @__PURE__ */ u.jsx($4, { size: 16, className: "shrink-0 mt-0.5" }),
      /* @__PURE__ */ u.jsxs("div", { children: [
        /* @__PURE__ */ u.jsx("strong", { children: "" }),
        " LLM ",
        /* @__PURE__ */ u.jsx("strong", { children: "" }),
        " LLM  ",
        /* @__PURE__ */ u.jsx("code", { className: "bg-blue-500/20 px-1 rounded", children: "<think>" }),
        ""
      ] })
    ] })
  ] });
}, wE = ({
  config: t,
  onChange: r,
  worldbookStructure: a = {},
  disabledEntries: l = {},
  onToggleWorldbook: s,
  onToggleEntry: c,
  onRefresh: d
}) => {
  const [m, g] = U.useState(/* @__PURE__ */ new Set()), [p, v] = U.useState(""), x = (R) => {
    r({
      ...t,
      [R]: !t[R]
    });
  }, E = (R) => {
    const Z = new Set(m);
    Z.has(R) ? Z.delete(R) : Z.add(R), g(Z);
  }, w = (R) => {
    var Z;
    return ((Z = t.disabledWorldbooks) == null ? void 0 : Z.includes(R)) || !1;
  }, _ = (R, Z) => {
    var K;
    return ((K = l[R]) == null ? void 0 : K.includes(Z)) || !1;
  }, D = Object.keys(a).sort().filter(
    (R) => R.toLowerCase().includes(p.toLowerCase()) || a[R].some(
      (Z) => {
        var K, ge;
        return ((K = Z.names) == null ? void 0 : K.join(" ").toLowerCase().includes(p.toLowerCase())) || ((ge = Z.comment) == null ? void 0 : ge.toLowerCase().includes(p.toLowerCase()));
      }
    )
  );
  return /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col gap-6", children: [
    /* @__PURE__ */ u.jsxs(mr, { title: "", description: "", children: [
      /* @__PURE__ */ u.jsx(
        la,
        {
          label: "",
          description: "",
          checked: t.enabled,
          onChange: () => x("enabled")
        }
      ),
      /* @__PURE__ */ u.jsx(
        la,
        {
          label: "",
          description: " / ",
          checked: t.includeGlobal,
          onChange: () => x("includeGlobal"),
          disabled: !t.enabled
        }
      ),
      /* @__PURE__ */ u.jsx(
        la,
        {
          label: " EJS  (ST-Prompt-Template)",
          description: "[]  WorldInfo  EJS  ST-Prompt-Template",
          checked: t.enableEJS ?? !0,
          onChange: () => x("enableEJS"),
          disabled: !t.enabled
        }
      )
    ] }),
    t.enabled && /* @__PURE__ */ u.jsxs(mr, { title: "", description: "", children: [
      /* @__PURE__ */ u.jsxs("div", { className: "flex items-center justify-between mb-4 gap-4", children: [
        /* @__PURE__ */ u.jsxs("div", { className: "relative flex-1", children: [
          /* @__PURE__ */ u.jsx(sa, { className: "absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground w-4 h-4" }),
          /* @__PURE__ */ u.jsx(
            "input",
            {
              type: "text",
              placeholder: "...",
              className: "w-full h-9 pl-9 pr-3 rounded-md border border-input bg-transparent text-sm shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring",
              value: p,
              onChange: (R) => v(R.target.value)
            }
          )
        ] }),
        /* @__PURE__ */ u.jsx(
          "button",
          {
            onClick: d,
            className: "inline-flex items-center justify-center rounded-md w-9 h-9 hover:bg-accent hover:text-accent-foreground transition-colors",
            title: "",
            children: /* @__PURE__ */ u.jsx(tr, { size: 16 })
          }
        )
      ] }),
      /* @__PURE__ */ u.jsx("div", { className: "flex flex-col gap-2", children: D.length === 0 ? /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col items-center justify-center py-8 text-muted-foreground gap-2 border border-dashed rounded-lg", children: [
        /* @__PURE__ */ u.jsx(El, { size: 24, className: "opacity-50" }),
        /* @__PURE__ */ u.jsx("span", { className: "text-sm", children: "" })
      ] }) : D.map((R) => {
        const Z = w(R), K = a[R] || [], ge = m.has(R), de = K.filter((I) => !_(R, I.uid)).length;
        return /* @__PURE__ */ u.jsxs("div", { className: `transition-all border-b border-border last:border-0 ${Z ? "bg-muted/10 opacity-60 grayscale" : ""}`, children: [
          /* @__PURE__ */ u.jsxs("div", { className: "flex items-center justify-between p-3", children: [
            /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-3 flex-1 overflow-hidden", children: [
              /* @__PURE__ */ u.jsx(
                "button",
                {
                  onClick: () => E(R),
                  className: "p-1 hover:bg-accent rounded-sm transition-colors",
                  children: ge ? /* @__PURE__ */ u.jsx(Cl, { size: 16 }) : /* @__PURE__ */ u.jsx(fu, { size: 16 })
                }
              ),
              /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-2 min-w-0", children: [
                /* @__PURE__ */ u.jsx(t4, { size: 16, className: Z ? "text-muted-foreground" : "text-primary" }),
                /* @__PURE__ */ u.jsx("span", { className: `font-medium truncate ${Z ? "text-muted-foreground line-through" : ""}`, children: R }),
                /* @__PURE__ */ u.jsxs("span", { className: "text-xs text-muted-foreground px-2 py-0.5 bg-muted rounded-full whitespace-nowrap", children: [
                  de,
                  " / ",
                  K.length,
                  " "
                ] })
              ] })
            ] }),
            /* @__PURE__ */ u.jsx("div", { className: "flex items-center gap-4", children: /* @__PURE__ */ u.jsx(
              la,
              {
                label: "",
                checked: !Z,
                onChange: (I) => s == null ? void 0 : s(R, !I),
                compact: !0
              }
            ) })
          ] }),
          ge && !Z && /* @__PURE__ */ u.jsx("div", { className: "pl-4 pr-1 py-1 flex flex-col gap-0 animate-in slide-in-from-top-1 duration-200", children: K.length === 0 ? /* @__PURE__ */ u.jsx("div", { className: "text-xs text-muted-foreground text-center py-4", children: "" }) : K.map((I) => {
            const V = _(R, I.uid);
            return /* @__PURE__ */ u.jsxs("div", { className: `flex items-start justify-between py-2 -mx-2 px-2 rounded hover:bg-accent/40 transition-colors group ${V ? "bg-muted/10 opacity-60 grayscale" : ""}`, children: [
              /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col gap-1 min-w-0 flex-1 pr-4", children: [
                /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-2 flex-wrap min-w-0", children: [
                  /* @__PURE__ */ u.jsx(
                    "div",
                    {
                      className: `w-1.5 h-1.5 rounded-full flex-shrink-0 ${I.constant ? "bg-primary" : "bg-emerald-500"}`,
                      title: I.constant ? " (Constant)" : " (Selective)"
                    }
                  ),
                  /* @__PURE__ */ u.jsx("span", { className: `text-sm font-medium truncate max-w-full ${V ? "text-muted-foreground line-through" : "text-foreground"}`, children: I.name || ` #${I.uid}` }),
                  (I.keys || []).length > 0 && /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-1 ml-auto md:ml-2 overflow-hidden max-w-full", children: [
                    I.keys.slice(0, 3).map((we, Te) => /* @__PURE__ */ u.jsx("span", { className: "text-[10px] px-1 py-0.5 rounded border border-border bg-muted/20 text-muted-foreground whitespace-nowrap overflow-hidden text-ellipsis max-w-[80px]", children: we }, Te)),
                    I.keys.length > 3 && /* @__PURE__ */ u.jsxs("span", { className: "text-[10px] text-muted-foreground", children: [
                      "+",
                      I.keys.length - 3
                    ] })
                  ] })
                ] }),
                (I.comment || I.content) && /* @__PURE__ */ u.jsx("p", { className: "text-xs text-muted-foreground/80 pl-3.5 break-words line-clamp-2", children: I.comment || I.content })
              ] }),
              /* @__PURE__ */ u.jsx("div", { className: "flex-shrink-0", children: /* @__PURE__ */ u.jsx(
                la,
                {
                  label: "",
                  checked: !V,
                  onChange: (we) => c == null ? void 0 : c(R, I.uid, !we),
                  compact: !0
                }
              ) })
            ] }, I.uid);
          }) })
        ] }, R);
      }) })
    ] })
  ] });
}, up = ({ title: t, subtitle: r, actions: a, className: l = "" }) => /* @__PURE__ */ u.jsxs("div", { className: `mb-8 px-4 md:px-0 flex justify-between items-start animate-in fade-in slide-in-from-bottom-2 duration-500 ${l}`, children: [
  /* @__PURE__ */ u.jsxs("div", { children: [
    /* @__PURE__ */ u.jsx("h1", { className: "text-3xl font-light tracking-tight text-foreground", children: t }),
    r && /* @__PURE__ */ u.jsx("p", { className: "mt-2 text-muted-foreground text-sm font-light", children: r })
  ] }),
  a && /* @__PURE__ */ u.jsx("div", { className: "flex gap-2", children: a })
] }), Wh = ({
  title: t,
  onClose: r,
  children: a,
  actions: l
}) => /* @__PURE__ */ u.jsxs(
  "div",
  {
    className: "fixed inset-0 bg-background z-50 flex flex-col animate-in slide-in-from-right-4 duration-200",
    style: { height: "100dvh", width: "100vw" },
    children: [
      /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-3 px-4 py-3 border-b border-border shrink-0", children: [
        /* @__PURE__ */ u.jsx(
          "button",
          {
            onClick: r,
            className: "p-1 hover:bg-accent rounded",
            children: /* @__PURE__ */ u.jsx(Am, { size: 20 })
          }
        ),
        /* @__PURE__ */ u.jsx("h2", { className: "text-lg font-light flex-1", children: t }),
        l
      ] }),
      /* @__PURE__ */ u.jsx("div", { className: "flex-1 overflow-y-auto p-4 no-scrollbar", children: a })
    ]
  }
), eb = 768, kE = [
  { id: "llm", label: "LLM ", icon: cd },
  { id: "vector", label: "", icon: ud },
  { id: "rerank", label: "Rerank", icon: Rm },
  { id: "recall", label: "", icon: mb }
  // Added tab
], CE = ({ initialTab: t }) => {
  var ye;
  const [r, a] = U.useState(t || "model"), [l, s] = U.useState("llm"), [c, d] = U.useState(window.innerWidth < eb), [m, g] = U.useState(!1);
  U.useEffect(() => {
    const me = () => {
      const Ge = window.innerWidth < eb;
      d(Ge), Ge || g(!1);
    };
    return window.addEventListener("resize", me), () => window.removeEventListener("resize", me);
  }, []);
  const {
    settings: p,
    editingPreset: v,
    editingTemplate: x,
    hasChanges: E,
    regexRules: w,
    editingRule: _,
    selectPreset: A,
    addPreset: D,
    updatePreset: R,
    copyPreset: Z,
    deletePreset: K,
    selectTemplate: ge,
    addTemplate: de,
    updateTemplate: I,
    deleteTemplate: V,
    updateVectorConfig: we,
    updateRerankConfig: Te,
    updateWorldbookConfig: X,
    updateRegexConfig: oe,
    // New!
    selectRule: se,
    addRule: Re,
    updateRule: be,
    toggleRule: je,
    deleteRule: re,
    resetRules: _e,
    save: fe,
    // Worldbook filtering
    worldbookStructure: Ue,
    disabledEntries: O,
    toggleWorldbook: L,
    toggleEntry: he,
    refreshWorldbooks: M
  } = $x(), Ie = (me) => {
    me(), c && g(!0);
  }, Ye = () => {
    g(!1);
  };
  return c && m && l === "llm" && v ? /* @__PURE__ */ u.jsx(
    Wh,
    {
      title: " LLM ",
      onClose: Ye,
      actions: E && /* @__PURE__ */ u.jsx(
        "button",
        {
          className: "p-2 text-primary",
          onClick: fe,
          children: /* @__PURE__ */ u.jsx(eu, { size: 18 })
        }
      ),
      children: /* @__PURE__ */ u.jsx(Yy, { preset: v, onChange: R })
    }
  ) : c && m && r === "prompt" && x ? /* @__PURE__ */ u.jsx(
    Wh,
    {
      title: "",
      onClose: Ye,
      actions: E && /* @__PURE__ */ u.jsx(
        "button",
        {
          className: "p-2 text-primary",
          onClick: fe,
          children: /* @__PURE__ */ u.jsx(eu, { size: 18 })
        }
      ),
      children: /* @__PURE__ */ u.jsx(
        Zy,
        {
          template: x,
          llmPresets: p.llmPresets,
          defaultPresetId: p.selectedPresetId,
          onChange: I
        }
      )
    }
  ) : c && m && r === "regex" && _ ? /* @__PURE__ */ u.jsx(
    Wh,
    {
      title: "",
      onClose: Ye,
      actions: E && /* @__PURE__ */ u.jsx(
        "button",
        {
          className: "p-2 text-primary",
          onClick: fe,
          children: /* @__PURE__ */ u.jsx(eu, { size: 18 })
        }
      ),
      children: /* @__PURE__ */ u.jsx(Jy, { rule: _, onChange: be })
    }
  ) : /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col h-full animate-in fade-in", children: [
    /* @__PURE__ */ u.jsx(
      up,
      {
        title: "API ",
        subtitle: "",
        className: "mb-2"
      }
    ),
    /* @__PURE__ */ u.jsx(
      xd,
      {
        tabs: [
          { id: "model", label: "" },
          { id: "prompt", label: "" },
          { id: "regex", label: "" },
          { id: "worldbook", label: "" }
        ],
        activeTab: r,
        onChange: (me) => a(me),
        actions: E && /* @__PURE__ */ u.jsxs(
          "button",
          {
            className: "inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-primary hover:text-primary-foreground hover:bg-primary border border-primary/50 rounded transition-colors",
            onClick: fe,
            children: [
              /* @__PURE__ */ u.jsx(eu, { size: 12 }),
              ""
            ]
          }
        )
      }
    ),
    /* @__PURE__ */ u.jsxs("div", { className: "flex-1 overflow-y-auto no-scrollbar", children: [
      r === "model" && /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col gap-2", children: [
        /* @__PURE__ */ u.jsx(
          o2,
          {
            tabs: kE.map((me) => ({ ...me, icon: /* @__PURE__ */ u.jsx(me.icon, { size: 14 }) })),
            activeTab: l,
            onChange: (me) => s(me),
            sticky: !1,
            top: 0,
            className: "-mx-4 px-4 !mb-4"
          }
        ),
        l === "llm" && /* @__PURE__ */ u.jsxs("div", { className: `flex gap-6 ${c ? "flex-col" : ""}`, children: [
          /* @__PURE__ */ u.jsxs("div", { className: `
                                    flex flex-col gap-4
                                    ${c ? "w-full" : "w-[30%] min-w-[240px] border-r border-border/50 pr-4"}
                                `, children: [
            /* @__PURE__ */ u.jsxs("div", { className: "flex items-center justify-between", children: [
              /* @__PURE__ */ u.jsx("h3", { className: "text-xs font-bold text-muted-foreground uppercase tracking-wider", children: "" }),
              /* @__PURE__ */ u.jsx("button", { className: "text-muted-foreground hover:text-foreground transition-colors", onClick: D, children: /* @__PURE__ */ u.jsx(pb, { size: 16 }) })
            ] }),
            /* @__PURE__ */ u.jsx("div", { className: "flex flex-col gap-1", children: p.llmPresets.map((me) => /* @__PURE__ */ u.jsx(
              sE,
              {
                preset: me,
                isSelected: p.selectedPresetId === me.id,
                onSelect: () => Ie(() => A(me)),
                onEdit: () => Ie(() => A(me)),
                onCopy: () => Z(me),
                onDelete: () => K(me)
              },
              me.id
            )) })
          ] }),
          !c && /* @__PURE__ */ u.jsx("div", { className: "flex-1", children: v ? /* @__PURE__ */ u.jsx("div", { className: "animate-in fade-in slide-in-from-right-2 duration-300", children: /* @__PURE__ */ u.jsx(Yy, { preset: v, onChange: R }) }) : /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col items-center justify-center p-12 text-muted-foreground gap-4", children: [
            /* @__PURE__ */ u.jsx(cd, { size: 32, className: "opacity-20" }),
            /* @__PURE__ */ u.jsx("p", { className: "text-sm font-light", children: "" })
          ] }) })
        ] }),
        l === "vector" && /* @__PURE__ */ u.jsx(hE, { config: p.vectorConfig, onChange: we }),
        l === "rerank" && /* @__PURE__ */ u.jsx(mE, { config: p.rerankConfig, onChange: Te }),
        l === "recall" && p.recallConfig && /* @__PURE__ */ u.jsx(u2, { config: p.recallConfig, onChange: updateRecallConfig })
      ] }),
      r === "prompt" && /* @__PURE__ */ u.jsxs("div", { className: `flex gap-6 h-full ${c ? "flex-col" : ""}`, children: [
        /* @__PURE__ */ u.jsx("div", { className: `
                            ${c ? "w-full" : "w-[30%] min-w-[280px] border-r border-border/50 pr-4"}
                        `, children: /* @__PURE__ */ u.jsx(
          bE,
          {
            templates: p.promptTemplates,
            selectedId: (x == null ? void 0 : x.id) || null,
            onSelect: (me) => Ie(() => ge(me)),
            onAdd: de,
            onUpdate: I,
            onDelete: V
          }
        ) }),
        !c && /* @__PURE__ */ u.jsx("div", { className: "flex-1 overflow-y-auto no-scrollbar", children: x ? /* @__PURE__ */ u.jsx(
          Zy,
          {
            template: x,
            llmPresets: p.llmPresets,
            defaultPresetId: p.selectedPresetId,
            onChange: I
          }
        ) : /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col items-center justify-center p-12 text-muted-foreground gap-4", children: [
          /* @__PURE__ */ u.jsx(mu, { size: 32, className: "opacity-20" }),
          /* @__PURE__ */ u.jsx("p", { className: "text-sm font-light", children: "" })
        ] }) })
      ] }),
      r === "regex" && /* @__PURE__ */ u.jsxs("div", { className: `flex gap-6 h-full ${c ? "flex-col" : ""}`, children: [
        /* @__PURE__ */ u.jsx("div", { className: `
                            ${c ? "w-full" : "w-[30%] min-w-[280px] border-r border-border/50 pr-4"}
                        `, children: /* @__PURE__ */ u.jsx(
          vE,
          {
            rules: w,
            selectedId: (_ == null ? void 0 : _.id) || null,
            onSelect: (me) => Ie(() => se(me)),
            onToggle: je,
            onDelete: re,
            onAdd: Re,
            onReset: _e,
            enableNativeRegex: ((ye = p.regexConfig) == null ? void 0 : ye.enableNativeRegex) ?? !0,
            onToggleNativeRegex: (me) => oe({
              ...p.regexConfig,
              enableNativeRegex: me
            })
          }
        ) }),
        !c && /* @__PURE__ */ u.jsx("div", { className: "flex-1 overflow-y-auto no-scrollbar", children: _ ? /* @__PURE__ */ u.jsx(Jy, { rule: _, onChange: be }) : /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col items-center justify-center p-12 text-muted-foreground gap-4", children: [
          /* @__PURE__ */ u.jsx(gb, { size: 32, className: "opacity-20" }),
          /* @__PURE__ */ u.jsx("p", { className: "text-sm font-light", children: "" })
        ] }) })
      ] }),
      r === "worldbook" && /* @__PURE__ */ u.jsx("div", { className: "max-w-2xl py-4", children: /* @__PURE__ */ u.jsx(
        wE,
        {
          config: p.worldbookConfig,
          onChange: X,
          worldbookStructure: Ue,
          disabledEntries: O,
          onToggleWorldbook: L,
          onToggleEntry: he,
          onRefresh: M
        }
      ) })
    ] })
  ] });
}, EE = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  APIPresets: CE
}, Symbol.toStringTag, { value: "Module" })), jE = () => {
  const [t, r] = U.useState("claudeDark");
  U.useEffect(() => {
    r(Di.getTheme());
  }, []);
  const a = (s) => {
    Di.setTheme(s), Ke.set("theme", s), r(s);
  }, l = Object.entries(Fc).map(([s, c]) => {
    let d = c.colors.background, m = c.colors.primary;
    return {
      id: s,
      name: c.name,
      background: d,
      sidebar: c.colors.sidebar,
      // Add sidebar color
      primary: m
    };
  });
  return /* @__PURE__ */ u.jsxs("div", { className: "space-y-4", children: [
    /* @__PURE__ */ u.jsx("h3", { className: "text-lg font-medium", children: "" }),
    /* @__PURE__ */ u.jsx("div", { className: "grid grid-cols-2 sm:grid-cols-4 gap-4", children: l.map((s) => /* @__PURE__ */ u.jsxs(
      "button",
      {
        onClick: () => a(s.id),
        className: `
                            relative group flex flex-col items-center gap-2 p-3 rounded-xl border-2 transition-all
                            ${t === s.id ? "border-primary bg-accent/10" : "border-transparent hover:bg-accent/5"}
                        `,
        children: [
          /* @__PURE__ */ u.jsxs("div", { className: "flex items-center justify-center -space-x-3 mb-2", children: [
            /* @__PURE__ */ u.jsx(
              "div",
              {
                className: "w-8 h-8 rounded-full border border-border shadow-sm z-10",
                style: { background: s.background },
                title: "Background"
              }
            ),
            /* @__PURE__ */ u.jsx(
              "div",
              {
                className: "w-8 h-8 rounded-full border border-border shadow-sm z-20",
                style: { background: s.sidebar },
                title: "Sidebar"
              }
            ),
            /* @__PURE__ */ u.jsx(
              "div",
              {
                className: "w-8 h-8 rounded-full border border-border shadow-sm z-30 ring-2 ring-background",
                style: { background: s.primary },
                title: "Primary"
              }
            )
          ] }),
          /* @__PURE__ */ u.jsx("span", { className: `text-sm font-medium ${t === s.id ? "text-primary" : "text-muted-foreground"}`, children: s.name }),
          t === s.id && /* @__PURE__ */ u.jsx("div", { className: "absolute top-2 right-2 w-2 h-2 rounded-full bg-primary" })
        ]
      },
      s.id
    )) })
  ] });
}, _E = () => {
  var m, g, p, v, x, E;
  const [t, r] = U.useState(((m = Ke.getSettings().summarizerConfig) == null ? void 0 : m.previewEnabled) ?? !0), [a, l] = U.useState(((g = Ke.getSettings().preprocessingConfig) == null ? void 0 : g.preview) ?? ld.preview), [, s] = U.useState({});
  U.useEffect(() => {
    Ke.loadSettings();
  }, []);
  const [c, d] = U.useState(Ke.getSettings().linkedDeletion);
  return /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col h-full animate-in fade-in", children: [
    /* @__PURE__ */ u.jsx(up, { title: "", subtitle: "" }),
    /* @__PURE__ */ u.jsxs("div", { className: "p-6 space-y-8", children: [
      /* @__PURE__ */ u.jsxs("section", { children: [
        /* @__PURE__ */ u.jsx("h3", { className: "text-sm font-medium text-muted-foreground uppercase tracking-wider mb-4", children: "" }),
        /* @__PURE__ */ u.jsx(jE, {})
      ] }),
      /* @__PURE__ */ u.jsxs("section", { children: [
        /* @__PURE__ */ u.jsx("h3", { className: "text-sm font-medium text-muted-foreground uppercase tracking-wider mb-4", children: " (Glass Effect)" }),
        /* @__PURE__ */ u.jsxs("div", { className: "bg-muted/30 border border-border rounded-lg p-4 space-y-6", children: [
          /* @__PURE__ */ u.jsxs("div", { className: "flex items-center justify-between", children: [
            /* @__PURE__ */ u.jsx("div", { className: "flex items-center gap-3", children: /* @__PURE__ */ u.jsxs("div", { children: [
              /* @__PURE__ */ u.jsx("h4", { className: "font-medium text-foreground", children: "" }),
              /* @__PURE__ */ u.jsx("p", { className: "text-sm text-muted-foreground break-words max-w-[200px] sm:max-w-none", children: "" })
            ] }) }),
            /* @__PURE__ */ u.jsx(
              On,
              {
                checked: ((p = Ke.getSettings().glassSettings) == null ? void 0 : p.enabled) ?? !0,
                onChange: (w) => {
                  const A = {
                    ...Ke.getSettings().glassSettings,
                    enabled: w
                  };
                  Ke.set("glassSettings", A), Promise.resolve().then(() => Gc).then(({ ThemeManager: D }) => {
                    D.setTheme(D.getTheme());
                  }), s({});
                }
              }
            )
          ] }),
          (((v = Ke.getSettings().glassSettings) == null ? void 0 : v.enabled) ?? !0) && /* @__PURE__ */ u.jsxs(u.Fragment, { children: [
            /* @__PURE__ */ u.jsx(
              hr,
              {
                label: " (Opacity)",
                description: "",
                value: ((x = Ke.getSettings().glassSettings) == null ? void 0 : x.opacity) ?? 0.8,
                onChange: (w) => {
                  const A = {
                    ...Ke.getSettings().glassSettings,
                    opacity: w
                  };
                  Ke.set("glassSettings", A), Promise.resolve().then(() => Gc).then(({ ThemeManager: D }) => {
                    D.setTheme(D.getTheme());
                  }), s({});
                },
                min: 0,
                max: 1,
                step: 0.05,
                showSlider: !0
              }
            ),
            /* @__PURE__ */ u.jsx(
              hr,
              {
                label: " (Blur)",
                description: " (px)",
                value: ((E = Ke.getSettings().glassSettings) == null ? void 0 : E.blur) ?? 10,
                onChange: (w) => {
                  const A = {
                    ...Ke.getSettings().glassSettings,
                    blur: w
                  };
                  Ke.set("glassSettings", A), Promise.resolve().then(() => Gc).then(({ ThemeManager: D }) => {
                    D.setTheme(D.getTheme());
                  }), s({});
                },
                min: 0,
                max: 50,
                step: 1,
                showSlider: !0
              }
            )
          ] })
        ] })
      ] }),
      /* @__PURE__ */ u.jsxs("section", { children: [
        /* @__PURE__ */ u.jsx("h3", { className: "text-sm font-medium text-muted-foreground uppercase tracking-wider mb-4", children: "" }),
        /* @__PURE__ */ u.jsx("div", { className: "bg-muted/30 border border-border rounded-lg p-4", children: /* @__PURE__ */ u.jsxs("div", { className: "flex items-center justify-between", children: [
          /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-3", children: [
            /* @__PURE__ */ u.jsx("div", { className: "p-2 rounded-lg bg-primary/10 text-primary", children: /* @__PURE__ */ u.jsx(C1, { size: 20 }) }),
            /* @__PURE__ */ u.jsxs("div", { children: [
              /* @__PURE__ */ u.jsx("h4", { className: "font-medium text-foreground", children: "" }),
              /* @__PURE__ */ u.jsx("p", { className: "text-sm text-muted-foreground break-words", children: "" })
            ] })
          ] }),
          /* @__PURE__ */ u.jsx(
            On,
            {
              checked: t,
              onChange: (w) => {
                r(w), Jx.updateConfig({ previewEnabled: w });
              }
            }
          )
        ] }) })
      ] }),
      /* @__PURE__ */ u.jsxs("section", { children: [
        /* @__PURE__ */ u.jsx("h3", { className: "text-sm font-medium text-muted-foreground uppercase tracking-wider mb-4", children: "" }),
        /* @__PURE__ */ u.jsx("div", { className: "bg-muted/30 border border-border rounded-lg p-4", children: /* @__PURE__ */ u.jsxs("div", { className: "flex items-center justify-between", children: [
          /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-3", children: [
            /* @__PURE__ */ u.jsx("div", { className: "p-2 rounded-lg bg-primary/10 text-primary", children: /* @__PURE__ */ u.jsx(C1, { size: 20 }) }),
            /* @__PURE__ */ u.jsxs("div", { children: [
              /* @__PURE__ */ u.jsx("h4", { className: "font-medium text-foreground", children: "" }),
              /* @__PURE__ */ u.jsx("p", { className: "text-sm text-muted-foreground break-words", children: "" })
            ] })
          ] }),
          /* @__PURE__ */ u.jsx(
            On,
            {
              checked: a,
              onChange: (w) => {
                l(w);
                const _ = ia.getConfig();
                ia.saveConfig({ ..._, preview: w });
              }
            }
          )
        ] }) })
      ] }),
      /* @__PURE__ */ u.jsxs("section", { children: [
        /* @__PURE__ */ u.jsx("h3", { className: "text-sm font-medium text-muted-foreground uppercase tracking-wider mb-4", children: "" }),
        /* @__PURE__ */ u.jsxs("div", { className: "bg-muted/30 border border-border rounded-lg p-4 space-y-4", children: [
          /* @__PURE__ */ u.jsxs("div", { className: "flex items-center justify-between", children: [
            /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-3", children: [
              /* @__PURE__ */ u.jsx("div", { className: "p-2 rounded-lg bg-red-500/10 text-red-500", children: /* @__PURE__ */ u.jsx(ca, { size: 20 }) }),
              /* @__PURE__ */ u.jsxs("div", { children: [
                /* @__PURE__ */ u.jsx("h4", { className: "font-medium text-foreground", children: "" }),
                /* @__PURE__ */ u.jsx("p", { className: "text-sm text-muted-foreground break-words", children: "/" })
              ] })
            ] }),
            /* @__PURE__ */ u.jsx(
              On,
              {
                checked: c.enabled,
                onChange: (w) => {
                  const _ = { ...c, enabled: w };
                  d(_), Ke.set("linkedDeletion", _);
                }
              }
            )
          ] }),
          c.enabled && /* @__PURE__ */ u.jsxs("div", { className: "pl-14 space-y-3 border-t border-border pt-3", children: [
            /* @__PURE__ */ u.jsxs("div", { className: "flex items-center justify-between", children: [
              /* @__PURE__ */ u.jsx("span", { className: "text-sm text-muted-foreground", children: "" }),
              /* @__PURE__ */ u.jsx(
                On,
                {
                  checked: c.showConfirmation,
                  onChange: (w) => {
                    const _ = { ...c, showConfirmation: w };
                    d(_), Ke.set("linkedDeletion", _);
                  },
                  className: "scale-90"
                }
              )
            ] }),
            /* @__PURE__ */ u.jsxs("div", { className: "flex items-center justify-between", children: [
              /* @__PURE__ */ u.jsxs("div", { children: [
                /* @__PURE__ */ u.jsx("span", { className: "text-sm text-muted-foreground", children: " Worldbook" }),
                /* @__PURE__ */ u.jsx("p", { className: "text-xs text-muted-foreground/60 break-words", children: ":  Worldbook " })
              ] }),
              /* @__PURE__ */ u.jsx(
                On,
                {
                  checked: c.deleteChatWorldbook ?? !1,
                  onChange: (w) => {
                    const _ = { ...c, deleteChatWorldbook: w };
                    d(_), Ke.set("linkedDeletion", _);
                  },
                  className: "scale-90"
                }
              )
            ] })
          ] })
        ] })
      ] }),
      /* @__PURE__ */ u.jsx("div", { className: "mt-8 pt-8 border-t border-border", children: /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col items-center justify-center text-muted-foreground gap-2 py-8 opacity-50", children: [
        /* @__PURE__ */ u.jsx(Wc, { size: 32 }),
        /* @__PURE__ */ u.jsx("p", { className: "text-sm", children: "..." })
      ] }) })
    ] })
  ] });
}, NE = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  Settings: _E
}, Symbol.toStringTag, { value: "Module" })), TE = {
  none: "",
  sm: "my-2",
  md: "my-4",
  lg: "my-6"
}, Oi = ({
  orientation: t = "horizontal",
  length: r = 100,
  className: a = "",
  responsive: l = !1,
  spacing: s = "none"
}) => {
  const c = TE[s];
  return l ? /* @__PURE__ */ u.jsxs(u.Fragment, { children: [
    /* @__PURE__ */ u.jsx(
      "div",
      {
        className: `hidden lg:block absolute left-0 top-1/2 -translate-y-1/2 border-l border-border ${a}`,
        style: { height: `${r}%` }
      }
    ),
    /* @__PURE__ */ u.jsx(
      "div",
      {
        className: `lg:hidden border-t border-border/30 mx-auto ${c} ${a}`,
        style: { width: `${r}%` }
      }
    )
  ] }) : t === "vertical" ? /* @__PURE__ */ u.jsx(
    "div",
    {
      className: `border-l border-border/30 mx-auto ${a}`,
      style: { height: `${r}%` }
    }
  ) : /* @__PURE__ */ u.jsx(
    "div",
    {
      className: `border-t border-border/30 ${c} ${a}`,
      style: { width: `${r}%` }
    }
  );
};
function AE({ score: t }) {
  const r = Math.round(t * 5);
  return /* @__PURE__ */ u.jsx("div", { className: "flex gap-0.5", children: [0, 1, 2, 3, 4].map((a) => /* @__PURE__ */ u.jsx(
    "span",
    {
      className: `w-1.5 h-1.5 rounded-full ${a < r ? "bg-primary" : "bg-muted"}`
    },
    a
  )) });
}
function ME({ isEmbedded: t }) {
  return t ? /* @__PURE__ */ u.jsxs(
    "span",
    {
      className: "inline-flex items-center gap-0.5 px-1.5 py-0.5 bg-primary/10 text-primary rounded text-[10px] font-medium",
      title: "",
      children: [
        /* @__PURE__ */ u.jsx(Bi, { size: 10 }),
        /* @__PURE__ */ u.jsx("span", { children: "" })
      ]
    }
  ) : null;
}
function zE({ event: t }) {
  const r = t.structured_kv, a = [];
  return r.time_anchor && a.push(r.time_anchor), r.location && a.push(r.location), r.role && r.role.length > 0 && a.push(r.role.join(", ")), a.length === 0 ? null : /* @__PURE__ */ u.jsxs("p", { className: "text-xs text-muted-foreground truncate", children: [
    "(",
    a.join(" | "),
    ")"
  ] });
}
const RE = ({
  event: t,
  isSelected: r = !1,
  isCompact: a = !1,
  onSelect: l,
  onCheck: s,
  checked: c = !1,
  hasChanges: d = !1
}) => {
  var x;
  const m = t.structured_kv, g = t.summary.split(`
`), p = m.event || ((x = g[0]) == null ? void 0 : x.replace(/:\s*$/, "")) || "", v = g.length > 1 ? g.slice(1).join(" ").trim() : t.summary;
  return a ? /* @__PURE__ */ u.jsxs(
    "div",
    {
      className: `
                    flex items-center gap-3 p-3 cursor-pointer
                    border-b border-border
                    transition-colors duration-150
                    ${r ? "border-l-2 border-l-primary bg-transparent" : "hover:bg-accent/30"}
                `,
      onClick: l,
      children: [
        /* @__PURE__ */ u.jsx(
          "input",
          {
            type: "checkbox",
            checked: c,
            onChange: (E) => {
              E.stopPropagation(), s == null || s(E.target.checked);
            },
            className: "w-4 h-4 rounded border-border accent-primary"
          }
        ),
        /* @__PURE__ */ u.jsxs("div", { className: "flex-1 min-w-0", children: [
          /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-2", children: [
            /* @__PURE__ */ u.jsx("span", { className: "text-xs font-medium text-primary", children: p }),
            t.is_embedded && /* @__PURE__ */ u.jsx(Bi, { size: 10, className: "text-primary" }),
            /* @__PURE__ */ u.jsx("span", { className: "text-xs text-muted-foreground", children: t.significance_score.toFixed(1) })
          ] }),
          /* @__PURE__ */ u.jsxs("p", { className: "text-sm text-foreground truncate mt-1", children: [
            v.substring(0, 50),
            "..."
          ] })
        ] }),
        /* @__PURE__ */ u.jsx(fu, { size: 16, className: "text-muted-foreground" })
      ]
    }
  ) : /* @__PURE__ */ u.jsxs(
    "div",
    {
      className: `
                p-4 cursor-pointer rounded-lg
                transition-all duration-150
                ${r ? "border border-primary bg-transparent" : "border border-transparent hover:border-border/50"}
            `,
      onClick: l,
      children: [
        /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-3 mb-2", children: [
          /* @__PURE__ */ u.jsx(
            "input",
            {
              type: "checkbox",
              checked: c,
              onChange: (E) => {
                E.stopPropagation(), s == null || s(E.target.checked);
              },
              className: "w-4 h-4 rounded border-border accent-primary"
            }
          ),
          /* @__PURE__ */ u.jsx("span", { className: "text-xs font-medium text-primary", children: p }),
          /* @__PURE__ */ u.jsx(ME, { isEmbedded: t.is_embedded }),
          d && /* @__PURE__ */ u.jsx("span", { className: "w-2 h-2 rounded-full bg-yellow-500", title: "" }),
          /* @__PURE__ */ u.jsx("div", { className: "flex-1" }),
          /* @__PURE__ */ u.jsx(AE, { score: t.significance_score })
        ] }),
        /* @__PURE__ */ u.jsx(zE, { event: t }),
        /* @__PURE__ */ u.jsx("p", { className: "text-sm text-foreground mt-1 line-clamp-2", children: v }),
        /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-2 mt-2 text-xs text-muted-foreground", children: [
          /* @__PURE__ */ u.jsxs("span", { children: [
            "Level ",
            t.level
          ] }),
          t.source_range && /* @__PURE__ */ u.jsxs(u.Fragment, { children: [
            /* @__PURE__ */ u.jsx("span", { children: "" }),
            /* @__PURE__ */ u.jsxs("span", { children: [
              ": ",
              t.source_range.start_index,
              "-",
              t.source_range.end_index,
              ""
            ] })
          ] })
        ] })
      ]
    }
  );
}, Do = {
  background: "transparent",
  backgroundColor: "transparent",
  border: "none",
  borderBottom: "1px solid var(--border)",
  borderRadius: 0,
  boxShadow: "none",
  outline: "none",
  padding: "8px 0",
  fontSize: "14px",
  width: "100%",
  color: "var(--foreground, inherit)"
};
({
  ...Do
});
function tb(t) {
  const r = [];
  return t.time_anchor && t.location ? r.push(`${t.time_anchor}${t.location}`) : t.time_anchor ? r.push(`${t.time_anchor}`) : t.location && r.push(`${t.location}`), t.role && t.role.length > 0 && r.push(t.role.join("")), t.event && r.push(t.event), t.logic && t.logic.length > 0 && r.push(`(${t.logic.join("/")})`), r.join(" ");
}
const Tm = U.forwardRef(({
  event: t,
  isFullScreen: r = !1,
  onSave: a,
  onDelete: l,
  onClose: s
}, c) => {
  const [d, m] = U.useState(""), [g, p] = U.useState(""), [v, x] = U.useState(""), [E, w] = U.useState(""), [_, A] = U.useState(""), [D, R] = U.useState(""), [Z, K] = U.useState(0.5), [ge, de] = U.useState(!1), [I, V] = U.useState(null);
  U.useEffect(() => {
    var be, je;
    t && t.id !== I && (m(t.summary), p(t.structured_kv.event || ""), x(t.structured_kv.time_anchor || ""), w(t.structured_kv.location || ""), A(((be = t.structured_kv.role) == null ? void 0 : be.join(", ")) || ""), R(((je = t.structured_kv.logic) == null ? void 0 : je.join(", ")) || ""), K(t.significance_score), de(!1), V(t.id));
  }, [t, I]);
  const we = U.useCallback(() => {
    var re;
    const be = {
      event: g,
      time_anchor: v,
      location: E,
      role: _.split(",").map((_e) => _e.trim()).filter(Boolean),
      logic: D.split(",").map((_e) => _e.trim()).filter(Boolean),
      causality: ((re = t == null ? void 0 : t.structured_kv) == null ? void 0 : re.causality) || ""
    };
    return {
      summary: tb(be) || d,
      structured_kv: {
        ...(t == null ? void 0 : t.structured_kv) || {},
        ...be
      },
      significance_score: Z
    };
  }, [t, g, v, E, _, D, Z, d]), Te = U.useCallback(() => {
    t && (de(!0), setTimeout(() => {
      const be = we();
      a == null || a(t.id, be);
    }, 0));
  }, [t, we, a]);
  U.useImperativeHandle(c, () => ({
    save: Te,
    isDirty: () => ge
  }), [Te, ge]);
  const X = () => {
    confirm("") && (l == null || l(t.id));
  }, oe = (be, je) => {
    be(je), setTimeout(Te, 10);
  }, se = (be) => {
    K(be), setTimeout(Te, 10);
  };
  if (!t)
    return /* @__PURE__ */ u.jsx("div", { className: "flex flex-col items-center justify-center h-full text-muted-foreground gap-2 p-8", children: /* @__PURE__ */ u.jsx("p", { className: "text-sm font-light", children: "" }) });
  const Re = /* @__PURE__ */ u.jsxs(u.Fragment, { children: [
    /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col gap-1", children: [
      /* @__PURE__ */ u.jsx("label", { className: "text-xs text-muted-foreground", children: "" }),
      /* @__PURE__ */ u.jsx(
        "input",
        {
          type: "text",
          value: g,
          onChange: (be) => oe(p, be.target.value),
          style: Do,
          className: "placeholder:text-muted-foreground/40 focus:border-primary transition-colors",
          placeholder: ""
        }
      )
    ] }),
    /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col gap-1", children: [
      /* @__PURE__ */ u.jsx("label", { className: "text-xs text-muted-foreground", children: " ()" }),
      /* @__PURE__ */ u.jsx(
        "div",
        {
          className: "p-2 text-sm text-foreground/80 bg-muted/30 rounded border border-border/50 min-h-[60px]",
          children: tb({
            event: g,
            time_anchor: v,
            location: E,
            role: _.split(",").map((be) => be.trim()).filter(Boolean),
            logic: D.split(",").map((be) => be.trim()).filter(Boolean)
          }) || /* @__PURE__ */ u.jsx("span", { className: "text-muted-foreground/50", children: "..." })
        }
      )
    ] }),
    /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col gap-1", children: [
      /* @__PURE__ */ u.jsx("label", { className: "text-xs text-muted-foreground", children: "" }),
      /* @__PURE__ */ u.jsx(
        "input",
        {
          type: "text",
          value: v,
          onChange: (be) => oe(x, be.target.value),
          style: Do,
          className: "placeholder:text-muted-foreground/40 focus:border-primary transition-colors",
          placeholder: "102344"
        }
      )
    ] }),
    /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col gap-1", children: [
      /* @__PURE__ */ u.jsx("label", { className: "text-xs text-muted-foreground", children: "" }),
      /* @__PURE__ */ u.jsx(
        "input",
        {
          type: "text",
          value: E,
          onChange: (be) => oe(w, be.target.value),
          style: Do,
          className: "placeholder:text-muted-foreground/40 focus:border-primary transition-colors",
          placeholder: ""
        }
      )
    ] }),
    /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col gap-1", children: [
      /* @__PURE__ */ u.jsx("label", { className: "text-xs text-muted-foreground", children: "" }),
      /* @__PURE__ */ u.jsx(
        "input",
        {
          type: "text",
          value: _,
          onChange: (be) => oe(A, be.target.value),
          style: Do,
          className: "placeholder:text-muted-foreground/40 focus:border-primary transition-colors",
          placeholder: "{{user}}, "
        }
      )
    ] }),
    /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col gap-1", children: [
      /* @__PURE__ */ u.jsx("label", { className: "text-xs text-muted-foreground", children: "" }),
      /* @__PURE__ */ u.jsx(
        "input",
        {
          type: "text",
          value: D,
          onChange: (be) => oe(R, be.target.value),
          style: Do,
          className: "placeholder:text-muted-foreground/40 focus:border-primary transition-colors",
          placeholder: ", "
        }
      )
    ] }),
    /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col gap-2", children: [
      /* @__PURE__ */ u.jsxs("div", { className: "flex justify-between items-center", children: [
        /* @__PURE__ */ u.jsx("label", { className: "text-xs text-muted-foreground", children: "" }),
        /* @__PURE__ */ u.jsx("span", { className: "text-xs font-mono text-foreground", children: Z.toFixed(2) })
      ] }),
      /* @__PURE__ */ u.jsxs("div", { className: "relative h-4 flex items-center group cursor-pointer", children: [
        /* @__PURE__ */ u.jsx(
          "div",
          {
            className: "absolute inset-x-0 h-[1px]",
            style: { backgroundColor: "var(--border)" }
          }
        ),
        /* @__PURE__ */ u.jsx(
          "div",
          {
            className: "absolute top-1/2 -translate-y-1/2 w-2.5 h-2.5 bg-muted-foreground/80 rounded-full shadow-sm pointer-events-none transition-transform duration-75 ease-out group-hover:scale-125 group-hover:bg-foreground",
            style: { left: `${Z * 100}%`, transform: "translate(-50%, -50%)" }
          }
        ),
        /* @__PURE__ */ u.jsx(
          "input",
          {
            type: "range",
            min: "0",
            max: "1",
            step: "0.05",
            value: Z,
            onChange: (be) => se(parseFloat(be.target.value)),
            className: "absolute inset-x-0 w-full h-full opacity-0 cursor-pointer z-10 m-0",
            style: { appearance: "none", WebkitAppearance: "none" }
          }
        )
      ] })
    ] }),
    /* @__PURE__ */ u.jsx(Oi, { spacing: "md" }),
    /* @__PURE__ */ u.jsxs("div", { className: "space-y-1 text-xs text-muted-foreground", children: [
      /* @__PURE__ */ u.jsxs("p", { children: [
        "ID: ",
        /* @__PURE__ */ u.jsxs("span", { className: "font-mono", children: [
          t.id.substring(0, 8),
          "..."
        ] })
      ] }),
      /* @__PURE__ */ u.jsxs("p", { children: [
        "Level: ",
        t.level
      ] }),
      t.source_range && /* @__PURE__ */ u.jsxs("p", { children: [
        ": ",
        t.source_range.start_index,
        "-",
        t.source_range.end_index,
        ""
      ] }),
      /* @__PURE__ */ u.jsxs("p", { children: [
        ": ",
        new Date(t.timestamp).toLocaleString()
      ] }),
      /* @__PURE__ */ u.jsxs("p", { children: [
        ":",
        t.is_archived && /* @__PURE__ */ u.jsx("span", { className: "ml-1 text-yellow-500", children: "" }),
        t.is_embedded && /* @__PURE__ */ u.jsx("span", { className: "ml-1 text-green-500", children: "" }),
        !t.is_archived && !t.is_embedded && /* @__PURE__ */ u.jsx("span", { className: "ml-1", children: "" })
      ] })
    ] })
  ] });
  return r ? /* @__PURE__ */ u.jsxs("div", { className: "fixed inset-0 bg-background z-50 flex flex-col", style: { height: "100dvh" }, children: [
    /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-3 px-4 py-3 border-b border-border shrink-0", children: [
      /* @__PURE__ */ u.jsx(
        "button",
        {
          onClick: s,
          className: "p-1 hover:bg-accent rounded",
          children: /* @__PURE__ */ u.jsx(Am, { size: 20 })
        }
      ),
      /* @__PURE__ */ u.jsx("h2", { className: "text-lg font-light flex-1", children: "" }),
      /* @__PURE__ */ u.jsx(
        "button",
        {
          onClick: X,
          className: "p-2 text-destructive hover:bg-destructive/10 rounded",
          children: /* @__PURE__ */ u.jsx(ca, { size: 18 })
        }
      )
    ] }),
    /* @__PURE__ */ u.jsx("div", { className: "flex-1 overflow-y-auto p-4 space-y-4", children: Re }),
    /* @__PURE__ */ u.jsx("div", { className: "p-4 border-t border-border shrink-0", children: /* @__PURE__ */ u.jsx(
      "button",
      {
        onClick: s,
        className: "w-full py-2 text-sm border border-border rounded-md hover:bg-accent",
        children: ""
      }
    ) })
  ] }) : /* @__PURE__ */ u.jsxs("div", { className: "h-full flex flex-col", children: [
    /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-2 pb-4 border-b border-border shrink-0", children: [
      /* @__PURE__ */ u.jsx("h3", { className: "text-sm font-medium text-primary flex-1", children: "" }),
      /* @__PURE__ */ u.jsx(
        "button",
        {
          onClick: X,
          className: "p-1.5 text-destructive hover:bg-destructive/10 rounded",
          title: "",
          children: /* @__PURE__ */ u.jsx(ca, { size: 16 })
        }
      )
    ] }),
    /* @__PURE__ */ u.jsx("div", { className: "flex-1 overflow-y-auto py-4 space-y-4 no-scrollbar", children: Re })
  ] });
});
Tm.displayName = "EventEditor";
const nb = 768, OE = [
  { id: "list", label: "", icon: /* @__PURE__ */ u.jsx(Z4, { size: 14 }) },
  { id: "graph", label: "", icon: /* @__PURE__ */ u.jsx(hb, { size: 14 }) }
], DE = () => {
  const [t, r] = U.useState([]), [a, l] = U.useState(null), [s, c] = U.useState(/* @__PURE__ */ new Set()), [d, m] = U.useState(""), [g, p] = U.useState(!0), [v, x] = U.useState(window.innerWidth < nb), [E, w] = U.useState(!1), [_, A] = U.useState("list"), [D, R] = U.useState(/* @__PURE__ */ new Map()), Z = D.size > 0, [K, ge] = U.useState(!1), de = _l.getState(), I = U.useRef(null);
  U.useEffect(() => {
    const fe = () => {
      x(window.innerWidth < nb);
    };
    return window.addEventListener("resize", fe), () => window.removeEventListener("resize", fe);
  }, []);
  const V = async () => {
    p(!0);
    try {
      const fe = await de.getAllEvents();
      r(fe.sort((Ue, O) => O.timestamp - Ue.timestamp));
    } catch (fe) {
      console.error("[MemoryStream] Failed to load events:", fe);
    } finally {
      p(!1);
    }
  };
  U.useEffect(() => {
    V();
  }, []);
  const we = U.useMemo(() => {
    if (!d.trim()) return t;
    const fe = d.toLowerCase();
    return t.filter(
      (Ue) => {
        var O, L;
        return Ue.summary.toLowerCase().includes(fe) || ((O = Ue.structured_kv.event) == null ? void 0 : O.toLowerCase().includes(fe)) || ((L = Ue.structured_kv.role) == null ? void 0 : L.some((he) => he.toLowerCase().includes(fe)));
      }
    );
  }, [t, d]), Te = U.useMemo(() => {
    const fe = t.find((O) => O.id === a);
    if (!fe) return null;
    const Ue = D.get(fe.id);
    return Ue ? { ...fe, ...Ue } : fe;
  }, [t, a, D]), X = (fe) => {
    l(fe), v && w(!0);
  }, oe = (fe, Ue) => {
    const O = new Set(s);
    Ue ? O.add(fe) : O.delete(fe), c(O);
  }, se = U.useCallback((fe, Ue) => {
    R((O) => {
      const L = new Map(O), he = L.get(fe) || {};
      return L.set(fe, { ...he, ...Ue }), L;
    }), r((O) => O.map(
      (L) => L.id === fe ? { ...L, ...Ue } : L
    ));
  }, []), Re = async () => {
    if (D.size !== 0)
      try {
        const fe = Array.from(D.entries()).map(
          ([Ue, O]) => de.updateEvent(Ue, O)
        );
        await Promise.all(fe), console.log(`[MemoryStream] Batch saved ${D.size} events`), R(/* @__PURE__ */ new Map());
      } catch (fe) {
        console.error("[MemoryStream] Batch save failed:", fe);
      }
  }, be = async () => {
    const fe = Ke.get("apiSettings"), Ue = fe == null ? void 0 : fe.vectorConfig;
    if (!Ue) {
      alert(" API ");
      return;
    }
    if (confirm("")) {
      ge(!0);
      try {
        Nn.setConfig(Ue);
        const O = fe == null ? void 0 : fe.embeddingConfig;
        O != null && O.concurrency && Nn.setConcurrency(O.concurrency), await Nn.reembedAllEvents((L, he, M) => {
          console.log(`[MemoryStream] Reembedding: ${L}/${he}, errors: ${M}`);
        }), await V(), alert("");
      } catch (O) {
        console.error("[MemoryStream] Reembed failed:", O), alert(": " + (O.message || ""));
      } finally {
        ge(!1);
      }
    }
  }, je = async (fe) => {
    await de.deleteEvents([fe]), r((Ue) => Ue.filter((O) => O.id !== fe)), l(null), w(!1), R((Ue) => {
      const O = new Map(Ue);
      return O.delete(fe), O;
    });
  }, re = async () => {
    s.size !== 0 && confirm(` ${s.size} `) && (await de.deleteEvents(Array.from(s)), r((fe) => fe.filter((Ue) => !s.has(Ue.id))), c(/* @__PURE__ */ new Set()), R((fe) => {
      const Ue = new Map(fe);
      return s.forEach((O) => Ue.delete(O)), Ue;
    }));
  }, _e = () => {
    w(!1), v && l(null);
  };
  return v && E && Te ? /* @__PURE__ */ u.jsx(
    Tm,
    {
      ref: I,
      event: Te,
      isFullScreen: !0,
      onSave: se,
      onDelete: je,
      onClose: _e
    }
  ) : /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col h-full animate-in fade-in overflow-hidden", children: [
    /* @__PURE__ */ u.jsx(up, { title: "", subtitle: "" }),
    /* @__PURE__ */ u.jsx(Oi, { className: "mb-6" }),
    /* @__PURE__ */ u.jsx(
      xd,
      {
        tabs: OE,
        activeTab: _,
        onChange: (fe) => A(fe),
        actions: /* @__PURE__ */ u.jsxs("div", { className: "flex items-center gap-2", children: [
          Z && /* @__PURE__ */ u.jsxs(
            "button",
            {
              className: "inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-primary hover:text-primary-foreground hover:bg-primary border border-primary/50 rounded transition-colors",
              onClick: Re,
              children: [
                /* @__PURE__ */ u.jsx(eu, { size: 12 }),
                " (",
                D.size,
                ")"
              ]
            }
          ),
          /* @__PURE__ */ u.jsxs(
            "button",
            {
              onClick: be,
              disabled: K,
              className: "inline-flex items-center gap-1.5 px-2 py-1.5 text-xs text-muted-foreground hover:text-foreground hover:bg-accent rounded transition-colors disabled:opacity-50",
              title: "",
              children: [
                /* @__PURE__ */ u.jsx(A3, { size: 12, className: K ? "animate-pulse" : "" }),
                K ? "..." : ""
              ]
            }
          ),
          /* @__PURE__ */ u.jsx(
            "button",
            {
              onClick: V,
              className: "p-1.5 hover:bg-accent rounded-md text-muted-foreground hover:text-foreground transition-colors",
              title: "",
              children: /* @__PURE__ */ u.jsx(tr, { size: 14, className: g ? "animate-spin" : "" })
            }
          ),
          s.size > 0 && /* @__PURE__ */ u.jsxs(
            "button",
            {
              onClick: re,
              className: "flex items-center gap-1 px-2 py-1 text-xs text-destructive hover:bg-destructive/10 rounded-md",
              children: [
                /* @__PURE__ */ u.jsx(ca, { size: 12 }),
                " (",
                s.size,
                ")"
              ]
            }
          )
        ] })
      }
    ),
    _ === "list" && /* @__PURE__ */ u.jsxs(
      "div",
      {
        className: "flex flex-col overflow-hidden",
        style: {
          //  - header(~50px) - tabs(~80px) - title(~60px) - (~80px)
          height: "calc(100vh - 270px)",
          minHeight: "300px"
        },
        children: [
          /* @__PURE__ */ u.jsxs("div", { className: "relative mb-4 shrink-0", children: [
            /* @__PURE__ */ u.jsx(sa, { size: 14, className: "absolute left-0 top-1/2 -translate-y-1/2 text-muted-foreground" }),
            /* @__PURE__ */ u.jsx(
              "input",
              {
                type: "text",
                value: d,
                onChange: (fe) => m(fe.target.value),
                placeholder: "...",
                style: {
                  background: "transparent",
                  border: "none",
                  borderBottom: "1px solid var(--border)",
                  borderRadius: 0,
                  outline: "none",
                  padding: "8px 0 8px 24px",
                  fontSize: "14px",
                  width: "100%",
                  color: "var(--foreground)"
                },
                className: "placeholder:text-muted-foreground/40 focus:border-primary transition-colors"
              }
            )
          ] }),
          /* @__PURE__ */ u.jsxs("div", { className: "flex-1 flex gap-6 min-h-0", children: [
            /* @__PURE__ */ u.jsx("div", { className: `
                            ${v ? "w-full" : "w-[30%] min-w-[240px]"}
                            overflow-y-auto no-scrollbar
                            ${v ? "" : "border-r border-border/50 pr-4"}
                        `, children: g ? /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col items-center justify-center h-48 text-muted-foreground gap-2", children: [
              /* @__PURE__ */ u.jsx(tr, { size: 24, className: "animate-spin" }),
              /* @__PURE__ */ u.jsx("p", { className: "text-sm font-light", children: "..." })
            ] }) : we.length === 0 ? /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col items-center justify-center h-48 text-muted-foreground gap-4", children: [
              /* @__PURE__ */ u.jsx(s4, { size: 48, className: "opacity-20" }),
              /* @__PURE__ */ u.jsx("p", { className: "text-sm font-light", children: d ? "" : "" })
            ] }) : /* @__PURE__ */ u.jsx("div", { className: v ? "" : "space-y-1 pb-4", children: we.map((fe) => /* @__PURE__ */ u.jsx(
              RE,
              {
                event: fe,
                isSelected: fe.id === a,
                isCompact: v,
                checked: s.has(fe.id),
                hasChanges: D.has(fe.id),
                onSelect: () => X(fe.id),
                onCheck: (Ue) => oe(fe.id, Ue)
              },
              fe.id
            )) }) }),
            !v && /* @__PURE__ */ u.jsx("div", { className: "flex-1 overflow-y-auto no-scrollbar", children: /* @__PURE__ */ u.jsx(
              Tm,
              {
                ref: I,
                event: Te,
                isFullScreen: !1,
                onSave: se,
                onDelete: je,
                onClose: () => l(null)
              }
            ) })
          ] })
        ]
      }
    ),
    _ === "graph" && /* @__PURE__ */ u.jsxs("div", { className: "flex-1 flex flex-col items-center justify-center text-muted-foreground gap-4", children: [
      /* @__PURE__ */ u.jsx(hb, { size: 48, className: "opacity-20" }),
      /* @__PURE__ */ u.jsx("p", { className: "text-sm font-light", children: "..." })
    ] })
  ] });
}, LE = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  MemoryStream: DE
}, Symbol.toStringTag, { value: "Module" })), BE = ({ links: t, onNavigate: r, className: a = "" }) => t.length === 0 ? null : /* @__PURE__ */ u.jsx("div", { className: `flex items-center gap-4 ${a}`, children: t.map((l) => {
  const s = l.icon || T4;
  return /* @__PURE__ */ u.jsxs(
    "button",
    {
      className: "inline-flex items-center gap-1.5 text-xs text-muted-foreground hover:text-foreground transition-colors",
      onClick: () => r(l.linkTo),
      title: l.label,
      children: [
        /* @__PURE__ */ u.jsx(s, { size: 12 }),
        /* @__PURE__ */ u.jsx("span", { children: l.label })
      ]
    },
    l.id
  );
}) }), sd = {
  keepRecentCount: 3,
  previewEnabled: !0
};
class c2 {
  constructor(r) {
    Xe(this, "config");
    Xe(this, "isTrimming", !1);
    this.config = { ...sd, ...r };
  }
  /**
   * 
   */
  updateConfig(r) {
    this.config = { ...this.config, ...r };
  }
  /**
   * 
   */
  async canTrim() {
    const a = await _l.getState().getAllEvents(), l = Math.max(0, a.length - this.config.keepRecentCount);
    return {
      canTrim: l >= 2,
      //  2 
      eventCount: a.length,
      pendingCount: l
    };
  }
  /**
   * 
   *  1 
   */
  async trim(r = !1) {
    if (this.isTrimming)
      return W.warn("EventTrimmer", ""), null;
    const a = _l.getState(), l = await a.getEventsToMerge(this.config.keepRecentCount);
    if (l.length < 2)
      return r && wt.info(" ( 2 )", "Engram"), null;
    this.isTrimming = !0, W.info("EventTrimmer", "", { eventCount: l.length });
    try {
      const s = this.formatEventsForTrim(l), c = await vu.generate({
        systemPrompt: _b,
        userPrompt: `

${s}`
      });
      if (!c.success || !c.content)
        return W.error("EventTrimmer", "LLM ", { error: c.error }), wt.error("LLM ", "Engram"), null;
      const d = Xx.parse(c.content);
      if (!d || !d.events || d.events.length === 0)
        return W.error("EventTrimmer", "JSON "), wt.error("", "Engram"), null;
      let m = d.events.map((w) => w.summary).join(`

`);
      if (this.config.previewEnabled)
        try {
          m = await sp.requestRevision(
            "",
            ` ${l.length} `,
            m
          );
        } catch {
          return W.warn("EventTrimmer", ""), wt.info("", ""), null;
        }
      const g = d.events[0], p = await a.saveEvent({
        summary: m,
        structured_kv: {
          time_anchor: g.meta.time_anchor || "",
          role: this.mergeArrays(l.map((w) => w.structured_kv.role)),
          location: g.meta.location || "",
          event: "",
          logic: this.mergeArrays(l.map((w) => w.structured_kv.logic)),
          causality: "Chain"
        },
        significance_score: Math.max(...l.map((w) => w.significance_score)),
        level: 1,
        // 
        is_embedded: !1,
        //  ( Trim )
        is_archived: !1,
        // 
        source_range: {
          start_index: Math.min(...l.map((w) => {
            var _;
            return ((_ = w.source_range) == null ? void 0 : _.start_index) ?? 0;
          })),
          end_index: Math.max(...l.map((w) => {
            var _;
            return ((_ = w.source_range) == null ? void 0 : _.end_index) ?? 0;
          }))
        }
      }), v = l.map((w) => w.id), x = Ke.get("apiSettings"), E = x == null ? void 0 : x.embeddingConfig;
      if (E != null && E.enabled && E.trigger === "with_trim") {
        W.info("EventTrimmer", "", { count: l.length });
        try {
          await Nn.embedEvents(l), await a.markEventsAsEmbedded(v);
        } catch (w) {
          W.error("EventTrimmer", "", { error: w }), wt.warning("", "Engram");
        }
      }
      return await a.archiveEvents(v), await zi.refreshCache(), W.success("EventTrimmer", "", {
        merged: l.length,
        newEventId: p.id
      }), wt.success(
        ` ${l.length}  1 `,
        "Engram"
      ), {
        newEvent: p,
        deletedCount: 0,
        // V0.7: 
        sourceEventIds: v
      };
    } catch (s) {
      const c = s instanceof Error ? s.message : String(s);
      return W.error("EventTrimmer", "", { error: c }), wt.error(`: ${c}`, "Engram "), null;
    } finally {
      this.isTrimming = !1;
    }
  }
  /**
   *  ()
   */
  formatEventsForTrim(r) {
    return r.map((a) => {
      const l = a.structured_kv;
      return `${a.summary}
Role: [${l.role.join(", ")}]
Loc: ${l.location}
Event: ${l.event}
Logic: [${l.logic.join(", ")}]
Causality: ${l.causality}
Significance: ${a.significance_score}`;
    }).join(`

---

`);
  }
  /**
   * 
   */
  mergeArrays(r) {
    const a = /* @__PURE__ */ new Set();
    for (const l of r)
      for (const s of l)
        a.add(s);
    return Array.from(a);
  }
  /**
   * 
   */
  getConfig() {
    return { ...this.config };
  }
  /**
   *  (UI )
   */
  async getStatus() {
    var A;
    const { useMemoryStore: r } = await Promise.resolve().then(() => Qx), a = r.getState(), { totalTokens: l, eventCount: s } = await a.countEventTokens();
    let c = !1, d = 0, m = 0;
    const p = ((A = Ke.getSummarizerSettings()) == null ? void 0 : A.trimConfig) || this.config, v = p.trigger || "token", x = p.tokenLimit || 10240, E = p.countLimit || 5;
    v === "token" ? (d = l, m = x) : (d = s, m = E), c = d >= m;
    const w = p.keepRecentCount || 3, _ = Math.max(0, s - w);
    return {
      triggered: c,
      triggerType: v,
      currentValue: d,
      threshold: m,
      pendingEntryCount: _,
      isTrimming: this.isTrimming
    };
  }
}
const IE = new c2(), Zh = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  DEFAULT_TRIM_CONFIG: sd,
  EventTrimmer: c2,
  eventTrimmer: IE
}, Symbol.toStringTag, { value: "Module" })), UE = [
  { id: "token", label: "Token ", icon: f4 },
  { id: "count", label: "", icon: P4 }
], PE = () => {
  const [t, r] = U.useState(null), [a, l] = U.useState(!1), [s, c] = U.useState(!1), [d, m] = U.useState({
    autoEnabled: !0,
    floorInterval: 10,
    bufferSize: 3,
    autoHide: !1
  }), [g, p] = U.useState({ ...sd, keepRecentCount: 3 }), [v, x] = U.useState(null), [E, w] = U.useState(0), [_, A] = U.useState(0);
  U.useEffect(() => {
    D();
  }, []);
  const D = async () => {
    var se;
    try {
      const { summarizerService: Re } = await Promise.resolve().then(() => ra);
      await Re.initializeForCurrentChat();
      const be = Re.getStatus();
      r(be);
      const je = Re.getConfig();
      m({
        autoEnabled: je.enabled,
        floorInterval: je.floorInterval,
        bufferSize: je.bufferSize || 3,
        autoHide: je.autoHide || !1
      });
      const re = (se = Ke.getSummarizerSettings()) == null ? void 0 : se.trimConfig;
      re && p({ ...sd, ...re });
      const { eventTrimmer: _e } = await Promise.resolve().then(() => Zh), fe = await _e.getStatus();
      x(fe);
      const { useMemoryStore: Ue } = await Promise.resolve().then(() => Qx), O = Ue.getState(), { totalTokens: L, activeEventCount: he } = await O.countEventTokens();
      w(L), A(he);
    } catch (Re) {
      console.error(" Summarizer :", Re);
    }
  }, R = async () => {
    try {
      const { summarizerService: se } = await Promise.resolve().then(() => ra);
      se.start(), await D();
    } catch (se) {
      console.error(":", se);
    }
  }, Z = async () => {
    try {
      const { summarizerService: se } = await Promise.resolve().then(() => ra);
      se.stop(), await D();
    } catch (se) {
      console.error(":", se);
    }
  }, K = async () => {
    l(!0);
    try {
      const { summarizerService: se } = await Promise.resolve().then(() => ra);
      await se.triggerSummary(!0), await D();
    } catch (se) {
      console.error(":", se);
    } finally {
      l(!1);
    }
  }, ge = async () => {
    if (confirm("")) {
      l(!0);
      try {
        const { summarizerService: se } = await Promise.resolve().then(() => ra);
        await se.setLastSummarizedFloor(0), await D();
      } catch (se) {
        console.error(":", se);
      } finally {
        l(!1);
      }
    }
  }, de = (se) => {
    const Re = { ...g, trigger: se };
    p(Re), V(Re);
  }, I = (se, Re) => {
    const be = { ...g, [se]: Re };
    p(be), V(be);
  }, V = (se) => {
    Ke.setSummarizerSettings({ trimConfig: se });
  }, we = async () => {
    const se = { ...g, enabled: !g.enabled };
    p(se), V(se);
    const { eventTrimmer: Re } = await Promise.resolve().then(() => Zh);
    Re.updateConfig({ enabled: se.enabled });
  }, Te = async () => {
    c(!0);
    try {
      const { eventTrimmer: se } = await Promise.resolve().then(() => Zh);
      await se.trim(!0), await D();
    } catch (se) {
      console.error(":", se);
    } finally {
      c(!1);
    }
  }, oe = (() => {
    switch (g.trigger) {
      case "token":
        return { value: g.tokenLimit ?? 10240, min: 1024, max: 1e5, step: 1024, label: "Token " };
      case "count":
        return { value: g.countLimit ?? 5, min: 2, max: 20, step: 1, label: "" };
      default:
        return { value: 10240, min: 1024, max: 1e5, step: 1024, label: "Token " };
    }
  })();
  return /* @__PURE__ */ u.jsxs("div", { className: "grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-12", children: [
    /* @__PURE__ */ u.jsxs("section", { className: "space-y-8", children: [
      /* @__PURE__ */ u.jsxs("div", { children: [
        /* @__PURE__ */ u.jsxs("div", { className: "flex items-center justify-between mb-6", children: [
          /* @__PURE__ */ u.jsx("h2", { className: "text-xs font-medium text-muted-foreground uppercase tracking-wider", children: "" }),
          /* @__PURE__ */ u.jsx(
            "button",
            {
              className: "p-1 rounded text-muted-foreground hover:text-foreground transition-colors",
              onClick: D,
              title: "",
              children: /* @__PURE__ */ u.jsx(tr, { size: 14 })
            }
          )
        ] }),
        t ? /* @__PURE__ */ u.jsxs("div", { className: "space-y-6", children: [
          /* @__PURE__ */ u.jsxs("div", { className: "grid grid-cols-2 gap-6", children: [
            /* @__PURE__ */ u.jsxs("div", { children: [
              /* @__PURE__ */ u.jsx("span", { className: "text-xs text-muted-foreground block mb-1", children: "" }),
              /* @__PURE__ */ u.jsxs("div", { className: `flex items-center gap-2 text-lg font-medium ${t.running ? "text-green-500" : "text-muted-foreground"}`, children: [
                t.running ? /* @__PURE__ */ u.jsx(cb, { size: 18 }) : /* @__PURE__ */ u.jsx(El, { size: 18 }),
                t.running ? "" : ""
              ] })
            ] }),
            /* @__PURE__ */ u.jsxs("div", { children: [
              /* @__PURE__ */ u.jsx("span", { className: "text-xs text-muted-foreground block mb-1", children: "" }),
              /* @__PURE__ */ u.jsx("div", { className: "text-3xl font-light text-amber-500 font-mono", children: t.pendingFloors })
            ] })
          ] }),
          /* @__PURE__ */ u.jsx(Oi, { length: 100, spacing: "md" }),
          /* @__PURE__ */ u.jsxs("div", { className: "grid grid-cols-2 gap-6", children: [
            /* @__PURE__ */ u.jsxs("div", { children: [
              /* @__PURE__ */ u.jsx("span", { className: "text-[10px] text-muted-foreground/70 uppercase tracking-wider block mb-1", children: "" }),
              /* @__PURE__ */ u.jsx("div", { className: "text-xl font-mono text-foreground/80", children: t.currentFloor })
            ] }),
            /* @__PURE__ */ u.jsxs("div", { children: [
              /* @__PURE__ */ u.jsx("span", { className: "text-[10px] text-muted-foreground/70 uppercase tracking-wider block mb-1", children: " ()" }),
              /* @__PURE__ */ u.jsx("div", { className: "text-xl font-mono text-foreground/80", children: _ })
            ] })
          ] }),
          /* @__PURE__ */ u.jsx(Oi, { length: 30, spacing: "md" }),
          /* @__PURE__ */ u.jsxs("div", { children: [
            /* @__PURE__ */ u.jsx("span", { className: "text-[10px] text-muted-foreground/60 uppercase tracking-wider block mb-1", children: " Token (Engram)" }),
            /* @__PURE__ */ u.jsx("div", { className: "text-sm font-mono text-primary/80", children: E.toLocaleString() })
          ] })
        ] }) : /* @__PURE__ */ u.jsx("p", { className: "text-sm text-muted-foreground", children: "..." })
      ] }),
      /* @__PURE__ */ u.jsxs("div", { className: "flex gap-3", children: [
        t != null && t.running ? /* @__PURE__ */ u.jsxs(
          "button",
          {
            className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg transition-colors",
            onClick: Z,
            children: [
              /* @__PURE__ */ u.jsx(s3, { size: 14 }),
              ""
            ]
          }
        ) : /* @__PURE__ */ u.jsxs(
          "button",
          {
            className: "inline-flex items-center gap-2 px-4 py-2 text-sm bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors",
            onClick: R,
            children: [
              /* @__PURE__ */ u.jsx(Om, { size: 14 }),
              ""
            ]
          }
        ),
        /* @__PURE__ */ u.jsxs(
          "button",
          {
            className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg transition-colors disabled:opacity-50",
            onClick: K,
            disabled: a || (t == null ? void 0 : t.isSummarizing),
            children: [
              /* @__PURE__ */ u.jsx(tr, { size: 14, className: a ? "animate-spin" : "" }),
              a ? "..." : ""
            ]
          }
        )
      ] }),
      /* @__PURE__ */ u.jsxs("div", { className: "pt-6 space-y-6", children: [
        /* @__PURE__ */ u.jsx(Oi, { length: 100 }),
        /* @__PURE__ */ u.jsxs("div", { className: "grid grid-cols-2 gap-4", children: [
          /* @__PURE__ */ u.jsxs("div", { className: "flex items-center justify-between", children: [
            /* @__PURE__ */ u.jsx("span", { className: "text-sm text-foreground", children: "" }),
            /* @__PURE__ */ u.jsx(
              la,
              {
                label: "",
                checked: d.autoEnabled,
                onChange: async (se) => {
                  m((be) => ({ ...be, autoEnabled: se }));
                  const { summarizerService: Re } = await Promise.resolve().then(() => ra);
                  Re.updateConfig({ enabled: se });
                }
              }
            )
          ] }),
          /* @__PURE__ */ u.jsxs("div", { className: "flex items-center justify-between", children: [
            /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col", children: [
              /* @__PURE__ */ u.jsx("span", { className: "text-sm text-foreground", children: "" }),
              /* @__PURE__ */ u.jsx("span", { className: "text-[10px] text-muted-foreground", children: "" })
            ] }),
            /* @__PURE__ */ u.jsx(
              la,
              {
                label: "",
                checked: d.autoHide,
                onChange: (se) => {
                  m((Re) => ({ ...Re, autoHide: se })), Promise.resolve().then(() => ra).then(({ summarizerService: Re }) => {
                    Re.updateConfig({ autoHide: se });
                  });
                }
              }
            )
          ] })
        ] }),
        d.autoEnabled && /* @__PURE__ */ u.jsx(u.Fragment, { children: /* @__PURE__ */ u.jsxs("div", { className: "grid grid-cols-2 gap-6", children: [
          /* @__PURE__ */ u.jsxs("div", { className: "space-y-3", children: [
            /* @__PURE__ */ u.jsxs("div", { className: "text-xs text-muted-foreground", children: [
              " ",
              /* @__PURE__ */ u.jsx("span", { className: "text-base font-medium text-foreground mx-0.5", children: d.floorInterval }),
              " "
            ] }),
            /* @__PURE__ */ u.jsxs("div", { className: "relative h-4 flex items-center group cursor-pointer", children: [
              /* @__PURE__ */ u.jsx("div", { className: "absolute inset-x-0 h-[1px]", style: { backgroundColor: "var(--border)" } }),
              /* @__PURE__ */ u.jsx(
                "div",
                {
                  className: "absolute top-1/2 -translate-y-1/2 w-2.5 h-2.5 bg-muted-foreground/80 rounded-full shadow-sm pointer-events-none transition-transform duration-75 ease-out group-hover:scale-125 group-hover:bg-foreground",
                  style: { left: `${(d.floorInterval - 5) / 95 * 100}%`, transform: "translate(-50%, -50%)" }
                }
              ),
              /* @__PURE__ */ u.jsx(
                "input",
                {
                  type: "range",
                  min: 5,
                  max: 100,
                  step: 5,
                  value: d.floorInterval,
                  onChange: async (se) => {
                    const Re = Number(se.target.value);
                    m((je) => ({ ...je, floorInterval: Re }));
                    const { summarizerService: be } = await Promise.resolve().then(() => ra);
                    be.updateConfig({ floorInterval: Re });
                  },
                  className: "absolute inset-x-0 w-full h-full opacity-0 cursor-pointer z-10 m-0",
                  style: { appearance: "none", WebkitAppearance: "none" }
                }
              )
            ] })
          ] }),
          /* @__PURE__ */ u.jsxs("div", { className: "space-y-3", children: [
            /* @__PURE__ */ u.jsxs("div", { className: "text-xs text-muted-foreground", children: [
              " ",
              /* @__PURE__ */ u.jsx("span", { className: "text-base font-medium text-foreground mx-0.5", children: d.bufferSize }),
              " "
            ] }),
            /* @__PURE__ */ u.jsxs("div", { className: "relative h-4 flex items-center group cursor-pointer", children: [
              /* @__PURE__ */ u.jsx("div", { className: "absolute inset-x-0 h-[1px]", style: { backgroundColor: "var(--border)" } }),
              /* @__PURE__ */ u.jsx(
                "div",
                {
                  className: "absolute top-1/2 -translate-y-1/2 w-2.5 h-2.5 bg-muted-foreground/80 rounded-full shadow-sm pointer-events-none transition-transform duration-75 ease-out group-hover:scale-125 group-hover:bg-foreground",
                  style: { left: `${d.bufferSize / 20 * 100}%`, transform: "translate(-50%, -50%)" }
                }
              ),
              /* @__PURE__ */ u.jsx(
                "input",
                {
                  type: "range",
                  min: 0,
                  max: 20,
                  step: 1,
                  value: d.bufferSize,
                  onChange: (se) => {
                    const Re = Number(se.target.value);
                    m((be) => ({ ...be, bufferSize: Re })), Promise.resolve().then(() => ra).then(({ summarizerService: be }) => {
                      be.updateConfig({ bufferSize: Re });
                    });
                  },
                  className: "absolute inset-x-0 w-full h-full opacity-0 cursor-pointer z-10 m-0",
                  style: { appearance: "none", WebkitAppearance: "none" }
                }
              )
            ] })
          ] })
        ] }) })
      ] }),
      /* @__PURE__ */ u.jsx("div", { className: "flex justify-end", children: /* @__PURE__ */ u.jsxs(
        "button",
        {
          className: "inline-flex items-center gap-2 px-3 py-1.5 text-xs text-red-500 hover:bg-red-50 border border-red-200 rounded transition-colors",
          onClick: ge,
          disabled: a,
          title: " ()",
          children: [
            /* @__PURE__ */ u.jsx(tr, { size: 12, className: a ? "animate-spin" : "" }),
            ""
          ]
        }
      ) })
    ] }),
    /* @__PURE__ */ u.jsxs("section", { className: "space-y-6 lg:pl-8 relative", children: [
      /* @__PURE__ */ u.jsx(Oi, { responsive: !0, length: 30 }),
      /* @__PURE__ */ u.jsxs("div", { className: "flex items-center justify-between", children: [
        /* @__PURE__ */ u.jsxs("div", { children: [
          /* @__PURE__ */ u.jsx("h2", { className: "text-sm font-medium text-foreground", children: "" }),
          /* @__PURE__ */ u.jsx("p", { className: "text-xs text-muted-foreground mt-0.5", children: "" })
        ] }),
        /* @__PURE__ */ u.jsx(
          la,
          {
            label: "",
            checked: g.enabled ?? !1,
            onChange: we
          }
        )
      ] }),
      /* @__PURE__ */ u.jsxs("div", { className: `space-y-6 transition-opacity ${g.enabled ? "opacity-100" : "opacity-40 pointer-events-none"}`, children: [
        /* @__PURE__ */ u.jsxs("div", { className: "space-y-3", children: [
          /* @__PURE__ */ u.jsx("span", { className: "text-xs text-muted-foreground", children: "" }),
          /* @__PURE__ */ u.jsx("div", { className: "flex gap-6", children: UE.map((se) => /* @__PURE__ */ u.jsxs(
            "label",
            {
              className: "flex items-center gap-2 cursor-pointer group",
              onClick: () => de(se.id),
              children: [
                /* @__PURE__ */ u.jsx(
                  "span",
                  {
                    className: `w-4 h-4 rounded-full border-2 flex items-center justify-center transition-colors
                                        ${g.trigger === se.id ? "border-primary bg-primary" : "border-border group-hover:border-muted-foreground"}`,
                    children: g.trigger === se.id && /* @__PURE__ */ u.jsx("span", { className: "w-1.5 h-1.5 rounded-full bg-primary-foreground" })
                  }
                ),
                /* @__PURE__ */ u.jsx("span", { className: `text-sm transition-colors ${g.trigger === se.id ? "text-foreground" : "text-muted-foreground"}`, children: se.label })
              ]
            },
            se.id
          )) })
        ] }),
        /* @__PURE__ */ u.jsxs("div", { className: "space-y-3", children: [
          /* @__PURE__ */ u.jsx("div", { className: "text-xs text-muted-foreground", children: oe.label === "Token " ? /* @__PURE__ */ u.jsxs(u.Fragment, { children: [
            " Token  ",
            /* @__PURE__ */ u.jsx("span", { className: "text-base font-medium text-foreground mx-0.5", children: oe.value }),
            " "
          ] }) : /* @__PURE__ */ u.jsxs(u.Fragment, { children: [
            " ",
            /* @__PURE__ */ u.jsx("span", { className: "text-base font-medium text-foreground mx-0.5", children: oe.value }),
            " "
          ] }) }),
          /* @__PURE__ */ u.jsxs("div", { className: "relative h-4 flex items-center group cursor-pointer", children: [
            /* @__PURE__ */ u.jsx("div", { className: "absolute inset-x-0 h-[1px]", style: { backgroundColor: "var(--border)" } }),
            /* @__PURE__ */ u.jsx(
              "div",
              {
                className: "absolute top-1/2 -translate-y-1/2 w-2.5 h-2.5 bg-muted-foreground/80 rounded-full shadow-sm pointer-events-none transition-transform duration-75 ease-out group-hover:scale-125 group-hover:bg-foreground",
                style: { left: `${(oe.value - oe.min) / (oe.max - oe.min) * 100}%`, transform: "translate(-50%, -50%)" }
              }
            ),
            /* @__PURE__ */ u.jsx(
              "input",
              {
                type: "range",
                min: oe.min,
                max: oe.max,
                step: oe.step,
                value: oe.value,
                onChange: (se) => {
                  const Re = Number(se.target.value), be = g.trigger === "token" ? "tokenLimit" : "countLimit";
                  I(be, Re);
                },
                className: "absolute inset-x-0 w-full h-full opacity-0 cursor-pointer z-10 m-0",
                style: { appearance: "none", WebkitAppearance: "none" }
              }
            )
          ] })
        ] }),
        /* @__PURE__ */ u.jsxs("div", { className: "space-y-3", children: [
          /* @__PURE__ */ u.jsxs("div", { className: "text-xs text-muted-foreground", children: [
            " ",
            /* @__PURE__ */ u.jsx("span", { className: "text-base font-medium text-foreground mx-0.5", children: g.keepRecentCount ?? 3 }),
            " "
          ] }),
          /* @__PURE__ */ u.jsxs("div", { className: "relative h-4 flex items-center group cursor-pointer", children: [
            /* @__PURE__ */ u.jsx("div", { className: "absolute inset-x-0 h-[1px]", style: { backgroundColor: "var(--border)" } }),
            /* @__PURE__ */ u.jsx(
              "div",
              {
                className: "absolute top-1/2 -translate-y-1/2 w-2.5 h-2.5 bg-muted-foreground/80 rounded-full shadow-sm pointer-events-none transition-transform duration-75 ease-out group-hover:scale-125 group-hover:bg-foreground",
                style: { left: `${(g.keepRecentCount ?? 3) / 10 * 100}%`, transform: "translate(-50%, -50%)" }
              }
            ),
            /* @__PURE__ */ u.jsx(
              "input",
              {
                type: "range",
                min: 0,
                max: 10,
                step: 1,
                value: g.keepRecentCount ?? 3,
                onChange: (se) => I("keepRecentCount", Number(se.target.value)),
                className: "absolute inset-x-0 w-full h-full opacity-0 cursor-pointer z-10 m-0",
                style: { appearance: "none", WebkitAppearance: "none" }
              }
            )
          ] })
        ] }),
        v && /* @__PURE__ */ u.jsxs("div", { className: "text-xs text-muted-foreground space-y-1", children: [
          /* @__PURE__ */ u.jsxs("div", { className: "flex justify-between", children: [
            /* @__PURE__ */ u.jsx("span", { children: ":" }),
            /* @__PURE__ */ u.jsx("span", { className: "font-mono", children: v.pendingEntryCount })
          ] }),
          /* @__PURE__ */ u.jsxs("div", { className: "flex justify-between", children: [
            /* @__PURE__ */ u.jsxs("span", { children: [
              "",
              g.trigger === "token" ? "Token" : "",
              ":"
            ] }),
            /* @__PURE__ */ u.jsxs("span", { className: `font-mono ${v.triggered ? "text-amber-500" : ""}`, children: [
              v.currentValue,
              " / ",
              oe.value
            ] })
          ] })
        ] }),
        /* @__PURE__ */ u.jsxs(
          "button",
          {
            type: "button",
            className: "inline-flex items-center gap-2 px-4 py-2 text-sm bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50",
            onClick: Te,
            disabled: s || ((v == null ? void 0 : v.pendingEntryCount) ?? 0) < 2,
            children: [
              /* @__PURE__ */ u.jsx(v3, { size: 14, className: s ? "animate-pulse" : "" }),
              s ? "..." : ""
            ]
          }
        ),
        /* @__PURE__ */ u.jsx("p", { className: "text-xs text-muted-foreground/70 leading-relaxed", children: " Token " })
      ] })
    ] })
  ] });
}, qE = () => {
  const [t, r] = U.useState({ total: 0, embedded: 0, pending: 0 }), [a, l] = U.useState(null), [s, c] = U.useState(!1), [d, m] = U.useState(!0), [g, p] = U.useState(null), [v, x] = U.useState(null), [E, w] = U.useState({ ...H1 }), [_, A] = U.useState(null);
  U.useEffect(() => {
    D();
  }, []);
  const D = async () => {
    m(!0), p(null);
    try {
      const we = Ke.get("apiSettings");
      we != null && we.vectorConfig && (A(we.vectorConfig), Nn.setConfig(we.vectorConfig)), we != null && we.embeddingConfig && w({ ...H1, ...we.embeddingConfig });
      const Te = await Nn.getEmbeddingStats();
      r(Te);
    } catch (we) {
      p(we.message || "");
    } finally {
      m(!1);
    }
  }, R = U.useCallback(async () => {
    const we = await Nn.getEmbeddingStats();
    r(we);
  }, []), Z = async () => {
    if (!_) {
      p("");
      return;
    }
    c(!0), l({ current: 0, total: t.pending, errors: 0 }), p(null), x(null);
    try {
      Nn.setConfig(_), Nn.setConcurrency(E.concurrency);
      const we = await Nn.embedUnprocessedEvents((Te, X, oe) => {
        l({ current: Te, total: X, errors: oe });
      });
      x(we), await R();
    } catch (we) {
      p(we.message || "");
    } finally {
      c(!1), l(null);
    }
  }, K = () => {
    Nn.stop();
  }, ge = async () => {
    if (!_) {
      p("");
      return;
    }
    if (confirm("")) {
      c(!0), l({ current: 0, total: t.total, errors: 0 }), p(null), x(null);
      try {
        Nn.setConfig(_), Nn.setConcurrency(E.concurrency);
        const we = await Nn.reembedAllEvents((Te, X, oe) => {
          l({ current: Te, total: X, errors: oe });
        });
        x(we), await R();
      } catch (we) {
        p(we.message || "");
      } finally {
        c(!1), l(null);
      }
    }
  }, de = (we) => {
    const Te = { ...E, ...we };
    w(Te);
    const X = Ke.get("apiSettings");
    X && Ke.set("apiSettings", {
      ...X,
      embeddingConfig: Te
    });
  }, I = a && a.total > 0 ? Math.round(a.current / a.total * 100) : 0, V = _ && (_.source === "transformers" || _.model);
  return d ? /* @__PURE__ */ u.jsxs("div", { className: "flex items-center justify-center h-48 text-muted-foreground gap-2", children: [
    /* @__PURE__ */ u.jsx(Tl, { size: 20, className: "animate-spin" }),
    /* @__PURE__ */ u.jsx("span", { className: "text-sm font-light", children: "..." })
  ] }) : /* @__PURE__ */ u.jsxs("div", { className: "py-4", children: [
    /* @__PURE__ */ u.jsxs("div", { className: "grid grid-cols-3 gap-4 mb-6", children: [
      /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col gap-1", children: [
        /* @__PURE__ */ u.jsx("span", { className: "text-xs text-muted-foreground uppercase tracking-wider", children: "" }),
        /* @__PURE__ */ u.jsx("span", { className: "text-2xl font-light", children: t.total })
      ] }),
      /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col gap-1", children: [
        /* @__PURE__ */ u.jsx("span", { className: "text-xs text-muted-foreground uppercase tracking-wider", children: "" }),
        /* @__PURE__ */ u.jsx("span", { className: "text-2xl font-light text-primary", children: t.embedded })
      ] }),
      /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col gap-1", children: [
        /* @__PURE__ */ u.jsx("span", { className: "text-xs text-muted-foreground uppercase tracking-wider", children: "" }),
        /* @__PURE__ */ u.jsx("span", { className: "text-2xl font-light text-warning", children: t.pending })
      ] })
    ] }),
    a && /* @__PURE__ */ u.jsxs("div", { className: "mb-6 p-4 bg-muted/30 rounded-lg", children: [
      /* @__PURE__ */ u.jsxs("div", { className: "flex items-center justify-between mb-2", children: [
        /* @__PURE__ */ u.jsxs("span", { className: "text-sm text-muted-foreground", children: [
          " ",
          a.current,
          "/",
          a.total
        ] }),
        /* @__PURE__ */ u.jsxs("span", { className: "text-sm font-medium", children: [
          I,
          "%"
        ] })
      ] }),
      /* @__PURE__ */ u.jsx("div", { className: "h-2 bg-muted rounded-full overflow-hidden", children: /* @__PURE__ */ u.jsx(
        "div",
        {
          className: "h-full bg-primary transition-all duration-300",
          style: { width: `${I}%` }
        }
      ) }),
      a.errors > 0 && /* @__PURE__ */ u.jsxs("p", { className: "text-xs text-destructive mt-2", children: [
        a.errors,
        " "
      ] })
    ] }),
    v && /* @__PURE__ */ u.jsxs("div", { className: `mb-6 p-3 rounded-lg flex items-center gap-2 ${v.failed > 0 ? "bg-warning/10 text-warning" : "bg-primary/10 text-primary"}`, children: [
      v.failed > 0 ? /* @__PURE__ */ u.jsx(El, { size: 16 }) : /* @__PURE__ */ u.jsx(cb, { size: 16 }),
      /* @__PURE__ */ u.jsxs("span", { className: "text-sm", children: [
        "",
        v.success,
        " ",
        v.failed > 0 && `${v.failed} `
      ] })
    ] }),
    g && /* @__PURE__ */ u.jsxs("div", { className: "mb-6 p-3 bg-destructive/10 text-destructive rounded-lg flex items-center gap-2", children: [
      /* @__PURE__ */ u.jsx(El, { size: 16 }),
      /* @__PURE__ */ u.jsx("span", { className: "text-sm", children: g })
    ] }),
    !V && /* @__PURE__ */ u.jsx("div", { className: "mb-6 p-3 bg-muted/50 rounded-lg", children: /* @__PURE__ */ u.jsxs("p", { className: "text-sm text-muted-foreground", children: [
      "",
      /* @__PURE__ */ u.jsx("span", { className: "text-primary mx-1", children: "API     " }),
      ""
    ] }) }),
    /* @__PURE__ */ u.jsx("div", { className: "flex flex-wrap gap-3 mb-6", children: s ? /* @__PURE__ */ u.jsxs(
      "button",
      {
        onClick: K,
        className: "inline-flex items-center gap-2 px-4 py-2 bg-destructive text-destructive-foreground rounded-md hover:bg-destructive/90 transition-colors",
        children: [
          /* @__PURE__ */ u.jsx(z3, { size: 16 }),
          ""
        ]
      }
    ) : /* @__PURE__ */ u.jsxs(u.Fragment, { children: [
      /* @__PURE__ */ u.jsxs(
        "button",
        {
          onClick: Z,
          disabled: t.pending === 0 || !V,
          className: "inline-flex items-center gap-2 px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",
          children: [
            /* @__PURE__ */ u.jsx(Om, { size: 16 }),
            " (",
            t.pending,
            ")"
          ]
        }
      ),
      /* @__PURE__ */ u.jsxs(
        "button",
        {
          onClick: ge,
          disabled: t.total === 0 || !V,
          className: "inline-flex items-center gap-2 px-4 py-2 border border-border text-foreground rounded-md hover:bg-muted transition-colors disabled:opacity-50 disabled:cursor-not-allowed",
          children: [
            /* @__PURE__ */ u.jsx(tr, { size: 16 }),
            ""
          ]
        }
      ),
      /* @__PURE__ */ u.jsx(
        "button",
        {
          onClick: R,
          className: "inline-flex items-center gap-2 px-3 py-2 text-muted-foreground hover:text-foreground transition-colors",
          children: /* @__PURE__ */ u.jsx(tr, { size: 16 })
        }
      )
    ] }) }),
    /* @__PURE__ */ u.jsx(Oi, { className: "my-6" }),
    /* @__PURE__ */ u.jsxs("div", { className: "space-y-4", children: [
      /* @__PURE__ */ u.jsx("h3", { className: "text-sm font-medium text-muted-foreground uppercase tracking-wider", children: "" }),
      /* @__PURE__ */ u.jsx(
        la,
        {
          label: "",
          checked: E.enabled,
          onChange: (we) => de({ enabled: we }),
          description: ""
        }
      ),
      /* @__PURE__ */ u.jsx(
        Ri,
        {
          label: "",
          value: E.trigger,
          onChange: (we) => de({ trigger: we }),
          options: [
            { value: "with_trim", label: " Trim " },
            { value: "standalone", label: "" },
            { value: "manual", label: "" }
          ],
          description: "with_trim: Trim  | standalone: "
        }
      ),
      /* @__PURE__ */ u.jsx(
        hr,
        {
          label: "",
          value: E.concurrency,
          onChange: (we) => de({ concurrency: Math.max(1, Math.min(20, we)) }),
          min: 1,
          max: 20,
          description: " (1-20)"
        }
      ),
      _ && /* @__PURE__ */ u.jsxs("div", { className: "p-3 bg-muted/30 rounded-lg", children: [
        /* @__PURE__ */ u.jsx("p", { className: "text-xs text-muted-foreground mb-1", children: "" }),
        /* @__PURE__ */ u.jsxs("p", { className: "text-sm", children: [
          /* @__PURE__ */ u.jsx("span", { className: "text-primary", children: _.source }),
          _.model && /* @__PURE__ */ u.jsxs("span", { className: "text-muted-foreground ml-2", children: [
            "/ ",
            _.model
          ] })
        ] })
      ] })
    ] })
  ] });
}, HE = () => {
  const [t, r] = U.useState(fd);
  U.useEffect(() => {
    const l = Ke.get("apiSettings");
    l != null && l.recallConfig && r(l.recallConfig);
  }, []);
  const a = (l) => {
    r(l);
    const s = Ke.get("apiSettings");
    s && (Ke.set("apiSettings", {
      ...s,
      recallConfig: l
    }), W.debug("RecallPanel", "", l));
  };
  return /* @__PURE__ */ u.jsx("div", { className: "p-1", children: /* @__PURE__ */ u.jsx(u2, { config: t, onChange: a }) });
}, FE = [
  { id: "summary", label: "", icon: /* @__PURE__ */ u.jsx(mu, { size: 16 }) },
  { id: "vectorization", label: "", icon: /* @__PURE__ */ u.jsx(hu, { size: 16 }) },
  { id: "recall", label: "", icon: /* @__PURE__ */ u.jsx(sa, { size: 16 }) },
  { id: "batch", label: "", icon: /* @__PURE__ */ u.jsx(Rm, { size: 16 }) }
], $E = [
  { id: "devlog", label: "", icon: w3, linkTo: "devlog:model" },
  { id: "presets", label: "", icon: Jv, linkTo: "presets:prompt" }
], GE = ({ onNavigate: t }) => {
  const [r, a] = U.useState("summary");
  return /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col h-full", children: [
    /* @__PURE__ */ u.jsxs("div", { className: "mb-6", children: [
      /* @__PURE__ */ u.jsx("h1", { className: "text-2xl font-light text-foreground tracking-tight mb-2", children: "" }),
      /* @__PURE__ */ u.jsx("p", { className: "text-sm text-muted-foreground", children: " RAG " })
    ] }),
    /* @__PURE__ */ u.jsx(Oi, { className: "mb-6" }),
    /* @__PURE__ */ u.jsx(
      xd,
      {
        tabs: FE,
        activeTab: r,
        onChange: (l) => a(l),
        actions: /* @__PURE__ */ u.jsx(
          BE,
          {
            links: $E,
            onNavigate: (l) => t == null ? void 0 : t(l)
          }
        )
      }
    ),
    /* @__PURE__ */ u.jsxs("div", { className: "flex-1 overflow-y-auto no-scrollbar", children: [
      r === "summary" && /* @__PURE__ */ u.jsx(PE, {}),
      r === "vectorization" && /* @__PURE__ */ u.jsx(qE, {}),
      r === "recall" && /* @__PURE__ */ u.jsx(HE, {}),
      r === "batch" && /* @__PURE__ */ u.jsxs("div", { className: "flex flex-col items-center justify-center h-48 text-muted-foreground gap-2", children: [
        /* @__PURE__ */ u.jsx(a4, { size: 32, strokeWidth: 1, className: "opacity-30" }),
        /* @__PURE__ */ u.jsx("p", { className: "text-sm font-light", children: "..." })
      ] })
    ] })
  ] });
}, VE = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  ProcessingView: GE
}, Symbol.toStringTag, { value: "Module" })), rb = "engram_macro_slot", ab = "Engram Memory Context";
class d2 {
  /**
   *  WorldBook 
   * 
   */
  static async init() {
    if (!this.isInitialized)
      try {
        const r = await St.getOrCreateWorldbook();
        if (!r) {
          W.warn("WorldBookSlotService", "");
          return;
        }
        const a = await St.findEntryByKey(r, rb);
        if (a) {
          W.debug("WorldBookSlotService", "", {
            uid: a.uid,
            name: a.name
          }), this.isInitialized = !0;
          return;
        }
        await St.createEntry(r, {
          name: ab,
          content: "{{engramSummaries}}",
          keys: [rb],
          constant: !0,
          enabled: !0,
          position: "at_depth",
          role: "system",
          depth: 999,
          order: 9e3
          //  order
        }) ? (W.success("WorldBookSlotService", "", {
          worldbook: r,
          name: ab
        }), this.isInitialized = !0) : W.error("WorldBookSlotService", "");
      } catch (r) {
        W.error("WorldBookSlotService", "", r);
      }
  }
  /**
   * 
   */
  static isReady() {
    return this.isInitialized;
  }
  /**
   * 
   */
  static reset() {
    this.isInitialized = !1;
  }
}
Xe(d2, "isInitialized", !1);
const KE = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  WorldBookSlotService: d2
}, Symbol.toStringTag, { value: "Module" }));
//# sourceMappingURL=index.js.map
