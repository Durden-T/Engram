var lO = Object.defineProperty;
var uO = (e, t, n) => t in e ? lO(e, t, { enumerable: !0, configurable: !0, writable: !0, value: n }) : e[t] = n;
var mt = (e, t, n) => uO(e, typeof t != "symbol" ? t + "" : t, n);
var tu = typeof globalThis < "u" ? globalThis : typeof window < "u" ? window : typeof global < "u" ? global : typeof self < "u" ? self : {};
function bc(e) {
  return e && e.__esModule && Object.prototype.hasOwnProperty.call(e, "default") ? e.default : e;
}
var cx = { exports: {} }, Pp = {};
/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var O5;
function cO() {
  if (O5) return Pp;
  O5 = 1;
  var e = Symbol.for("react.transitional.element"), t = Symbol.for("react.fragment");
  function n(r, a, o) {
    var l = null;
    if (o !== void 0 && (l = "" + o), a.key !== void 0 && (l = "" + a.key), "key" in a) {
      o = {};
      for (var c in a)
        c !== "key" && (o[c] = a[c]);
    } else o = a;
    return a = o.ref, {
      $$typeof: e,
      type: r,
      key: l,
      ref: a !== void 0 ? a : null,
      props: o
    };
  }
  return Pp.Fragment = t, Pp.jsx = n, Pp.jsxs = n, Pp;
}
var z5;
function fO() {
  return z5 || (z5 = 1, cx.exports = cO()), cx.exports;
}
var m = fO(), fx = { exports: {} }, Bt = {};
/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var D5;
function dO() {
  if (D5) return Bt;
  D5 = 1;
  var e = Symbol.for("react.transitional.element"), t = Symbol.for("react.portal"), n = Symbol.for("react.fragment"), r = Symbol.for("react.strict_mode"), a = Symbol.for("react.profiler"), o = Symbol.for("react.consumer"), l = Symbol.for("react.context"), c = Symbol.for("react.forward_ref"), d = Symbol.for("react.suspense"), h = Symbol.for("react.memo"), p = Symbol.for("react.lazy"), g = Symbol.for("react.activity"), x = Symbol.iterator;
  function b(U) {
    return U === null || typeof U != "object" ? null : (U = x && U[x] || U["@@iterator"], typeof U == "function" ? U : null);
  }
  var C = {
    isMounted: function() {
      return !1;
    },
    enqueueForceUpdate: function() {
    },
    enqueueReplaceState: function() {
    },
    enqueueSetState: function() {
    }
  }, N = Object.assign, T = {};
  function j(U, ue, Y) {
    this.props = U, this.context = ue, this.refs = T, this.updater = Y || C;
  }
  j.prototype.isReactComponent = {}, j.prototype.setState = function(U, ue) {
    if (typeof U != "object" && typeof U != "function" && U != null)
      throw Error(
        "takes an object of state variables to update or a function which returns an object of state variables."
      );
    this.updater.enqueueSetState(this, U, ue, "setState");
  }, j.prototype.forceUpdate = function(U) {
    this.updater.enqueueForceUpdate(this, U, "forceUpdate");
  };
  function R() {
  }
  R.prototype = j.prototype;
  function A(U, ue, Y) {
    this.props = U, this.context = ue, this.refs = T, this.updater = Y || C;
  }
  var z = A.prototype = new R();
  z.constructor = A, N(z, j.prototype), z.isPureReactComponent = !0;
  var q = Array.isArray;
  function D() {
  }
  var P = { H: null, A: null, T: null, S: null }, re = Object.prototype.hasOwnProperty;
  function ie(U, ue, Y) {
    var le = Y.ref;
    return {
      $$typeof: e,
      type: U,
      key: ue,
      ref: le !== void 0 ? le : null,
      props: Y
    };
  }
  function X(U, ue) {
    return ie(U.type, ue, U.props);
  }
  function K(U) {
    return typeof U == "object" && U !== null && U.$$typeof === e;
  }
  function V(U) {
    var ue = { "=": "=0", ":": "=2" };
    return "$" + U.replace(/[=:]/g, function(Y) {
      return ue[Y];
    });
  }
  var de = /\/+/g;
  function H(U, ue) {
    return typeof U == "object" && U !== null && U.key != null ? V("" + U.key) : ue.toString(36);
  }
  function se(U) {
    switch (U.status) {
      case "fulfilled":
        return U.value;
      case "rejected":
        throw U.reason;
      default:
        switch (typeof U.status == "string" ? U.then(D, D) : (U.status = "pending", U.then(
          function(ue) {
            U.status === "pending" && (U.status = "fulfilled", U.value = ue);
          },
          function(ue) {
            U.status === "pending" && (U.status = "rejected", U.reason = ue);
          }
        )), U.status) {
          case "fulfilled":
            return U.value;
          case "rejected":
            throw U.reason;
        }
    }
    throw U;
  }
  function Z(U, ue, Y, le, xe) {
    var Se = typeof U;
    (Se === "undefined" || Se === "boolean") && (U = null);
    var Oe = !1;
    if (U === null) Oe = !0;
    else
      switch (Se) {
        case "bigint":
        case "string":
        case "number":
          Oe = !0;
          break;
        case "object":
          switch (U.$$typeof) {
            case e:
            case t:
              Oe = !0;
              break;
            case p:
              return Oe = U._init, Z(
                Oe(U._payload),
                ue,
                Y,
                le,
                xe
              );
          }
      }
    if (Oe)
      return xe = xe(U), Oe = le === "" ? "." + H(U, 0) : le, q(xe) ? (Y = "", Oe != null && (Y = Oe.replace(de, "$&/") + "/"), Z(xe, ue, Y, "", function(Pe) {
        return Pe;
      })) : xe != null && (K(xe) && (xe = X(
        xe,
        Y + (xe.key == null || U && U.key === xe.key ? "" : ("" + xe.key).replace(
          de,
          "$&/"
        ) + "/") + Oe
      )), ue.push(xe)), 1;
    Oe = 0;
    var qe = le === "" ? "." : le + ":";
    if (q(U))
      for (var Me = 0; Me < U.length; Me++)
        le = U[Me], Se = qe + H(le, Me), Oe += Z(
          le,
          ue,
          Y,
          Se,
          xe
        );
    else if (Me = b(U), typeof Me == "function")
      for (U = Me.call(U), Me = 0; !(le = U.next()).done; )
        le = le.value, Se = qe + H(le, Me++), Oe += Z(
          le,
          ue,
          Y,
          Se,
          xe
        );
    else if (Se === "object") {
      if (typeof U.then == "function")
        return Z(
          se(U),
          ue,
          Y,
          le,
          xe
        );
      throw ue = String(U), Error(
        "Objects are not valid as a React child (found: " + (ue === "[object Object]" ? "object with keys {" + Object.keys(U).join(", ") + "}" : ue) + "). If you meant to render a collection of children, use an array instead."
      );
    }
    return Oe;
  }
  function fe(U, ue, Y) {
    if (U == null) return U;
    var le = [], xe = 0;
    return Z(U, le, "", "", function(Se) {
      return ue.call(Y, Se, xe++);
    }), le;
  }
  function he(U) {
    if (U._status === -1) {
      var ue = U._result;
      ue = ue(), ue.then(
        function(Y) {
          (U._status === 0 || U._status === -1) && (U._status = 1, U._result = Y);
        },
        function(Y) {
          (U._status === 0 || U._status === -1) && (U._status = 2, U._result = Y);
        }
      ), U._status === -1 && (U._status = 0, U._result = ue);
    }
    if (U._status === 1) return U._result.default;
    throw U._result;
  }
  var ge = typeof reportError == "function" ? reportError : function(U) {
    if (typeof window == "object" && typeof window.ErrorEvent == "function") {
      var ue = new window.ErrorEvent("error", {
        bubbles: !0,
        cancelable: !0,
        message: typeof U == "object" && U !== null && typeof U.message == "string" ? String(U.message) : String(U),
        error: U
      });
      if (!window.dispatchEvent(ue)) return;
    } else if (typeof process == "object" && typeof process.emit == "function") {
      process.emit("uncaughtException", U);
      return;
    }
    console.error(U);
  }, Q = {
    map: fe,
    forEach: function(U, ue, Y) {
      fe(
        U,
        function() {
          ue.apply(this, arguments);
        },
        Y
      );
    },
    count: function(U) {
      var ue = 0;
      return fe(U, function() {
        ue++;
      }), ue;
    },
    toArray: function(U) {
      return fe(U, function(ue) {
        return ue;
      }) || [];
    },
    only: function(U) {
      if (!K(U))
        throw Error(
          "React.Children.only expected to receive a single React element child."
        );
      return U;
    }
  };
  return Bt.Activity = g, Bt.Children = Q, Bt.Component = j, Bt.Fragment = n, Bt.Profiler = a, Bt.PureComponent = A, Bt.StrictMode = r, Bt.Suspense = d, Bt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE = P, Bt.__COMPILER_RUNTIME = {
    __proto__: null,
    c: function(U) {
      return P.H.useMemoCache(U);
    }
  }, Bt.cache = function(U) {
    return function() {
      return U.apply(null, arguments);
    };
  }, Bt.cacheSignal = function() {
    return null;
  }, Bt.cloneElement = function(U, ue, Y) {
    if (U == null)
      throw Error(
        "The argument must be a React element, but you passed " + U + "."
      );
    var le = N({}, U.props), xe = U.key;
    if (ue != null)
      for (Se in ue.key !== void 0 && (xe = "" + ue.key), ue)
        !re.call(ue, Se) || Se === "key" || Se === "__self" || Se === "__source" || Se === "ref" && ue.ref === void 0 || (le[Se] = ue[Se]);
    var Se = arguments.length - 2;
    if (Se === 1) le.children = Y;
    else if (1 < Se) {
      for (var Oe = Array(Se), qe = 0; qe < Se; qe++)
        Oe[qe] = arguments[qe + 2];
      le.children = Oe;
    }
    return ie(U.type, xe, le);
  }, Bt.createContext = function(U) {
    return U = {
      $$typeof: l,
      _currentValue: U,
      _currentValue2: U,
      _threadCount: 0,
      Provider: null,
      Consumer: null
    }, U.Provider = U, U.Consumer = {
      $$typeof: o,
      _context: U
    }, U;
  }, Bt.createElement = function(U, ue, Y) {
    var le, xe = {}, Se = null;
    if (ue != null)
      for (le in ue.key !== void 0 && (Se = "" + ue.key), ue)
        re.call(ue, le) && le !== "key" && le !== "__self" && le !== "__source" && (xe[le] = ue[le]);
    var Oe = arguments.length - 2;
    if (Oe === 1) xe.children = Y;
    else if (1 < Oe) {
      for (var qe = Array(Oe), Me = 0; Me < Oe; Me++)
        qe[Me] = arguments[Me + 2];
      xe.children = qe;
    }
    if (U && U.defaultProps)
      for (le in Oe = U.defaultProps, Oe)
        xe[le] === void 0 && (xe[le] = Oe[le]);
    return ie(U, Se, xe);
  }, Bt.createRef = function() {
    return { current: null };
  }, Bt.forwardRef = function(U) {
    return { $$typeof: c, render: U };
  }, Bt.isValidElement = K, Bt.lazy = function(U) {
    return {
      $$typeof: p,
      _payload: { _status: -1, _result: U },
      _init: he
    };
  }, Bt.memo = function(U, ue) {
    return {
      $$typeof: h,
      type: U,
      compare: ue === void 0 ? null : ue
    };
  }, Bt.startTransition = function(U) {
    var ue = P.T, Y = {};
    P.T = Y;
    try {
      var le = U(), xe = P.S;
      xe !== null && xe(Y, le), typeof le == "object" && le !== null && typeof le.then == "function" && le.then(D, ge);
    } catch (Se) {
      ge(Se);
    } finally {
      ue !== null && Y.types !== null && (ue.types = Y.types), P.T = ue;
    }
  }, Bt.unstable_useCacheRefresh = function() {
    return P.H.useCacheRefresh();
  }, Bt.use = function(U) {
    return P.H.use(U);
  }, Bt.useActionState = function(U, ue, Y) {
    return P.H.useActionState(U, ue, Y);
  }, Bt.useCallback = function(U, ue) {
    return P.H.useCallback(U, ue);
  }, Bt.useContext = function(U) {
    return P.H.useContext(U);
  }, Bt.useDebugValue = function() {
  }, Bt.useDeferredValue = function(U, ue) {
    return P.H.useDeferredValue(U, ue);
  }, Bt.useEffect = function(U, ue) {
    return P.H.useEffect(U, ue);
  }, Bt.useEffectEvent = function(U) {
    return P.H.useEffectEvent(U);
  }, Bt.useId = function() {
    return P.H.useId();
  }, Bt.useImperativeHandle = function(U, ue, Y) {
    return P.H.useImperativeHandle(U, ue, Y);
  }, Bt.useInsertionEffect = function(U, ue) {
    return P.H.useInsertionEffect(U, ue);
  }, Bt.useLayoutEffect = function(U, ue) {
    return P.H.useLayoutEffect(U, ue);
  }, Bt.useMemo = function(U, ue) {
    return P.H.useMemo(U, ue);
  }, Bt.useOptimistic = function(U, ue) {
    return P.H.useOptimistic(U, ue);
  }, Bt.useReducer = function(U, ue, Y) {
    return P.H.useReducer(U, ue, Y);
  }, Bt.useRef = function(U) {
    return P.H.useRef(U);
  }, Bt.useState = function(U) {
    return P.H.useState(U);
  }, Bt.useSyncExternalStore = function(U, ue, Y) {
    return P.H.useSyncExternalStore(
      U,
      ue,
      Y
    );
  }, Bt.useTransition = function() {
    return P.H.useTransition();
  }, Bt.version = "19.2.3", Bt;
}
var I5;
function jg() {
  return I5 || (I5 = 1, fx.exports = dO()), fx.exports;
}
var G = jg();
const hS = /* @__PURE__ */ bc(G);
var dx = { exports: {} }, qp = {}, hx = { exports: {} }, mx = {};
/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var L5;
function hO() {
  return L5 || (L5 = 1, (function(e) {
    function t(Z, fe) {
      var he = Z.length;
      Z.push(fe);
      e: for (; 0 < he; ) {
        var ge = he - 1 >>> 1, Q = Z[ge];
        if (0 < a(Q, fe))
          Z[ge] = fe, Z[he] = Q, he = ge;
        else break e;
      }
    }
    function n(Z) {
      return Z.length === 0 ? null : Z[0];
    }
    function r(Z) {
      if (Z.length === 0) return null;
      var fe = Z[0], he = Z.pop();
      if (he !== fe) {
        Z[0] = he;
        e: for (var ge = 0, Q = Z.length, U = Q >>> 1; ge < U; ) {
          var ue = 2 * (ge + 1) - 1, Y = Z[ue], le = ue + 1, xe = Z[le];
          if (0 > a(Y, he))
            le < Q && 0 > a(xe, Y) ? (Z[ge] = xe, Z[le] = he, ge = le) : (Z[ge] = Y, Z[ue] = he, ge = ue);
          else if (le < Q && 0 > a(xe, he))
            Z[ge] = xe, Z[le] = he, ge = le;
          else break e;
        }
      }
      return fe;
    }
    function a(Z, fe) {
      var he = Z.sortIndex - fe.sortIndex;
      return he !== 0 ? he : Z.id - fe.id;
    }
    if (e.unstable_now = void 0, typeof performance == "object" && typeof performance.now == "function") {
      var o = performance;
      e.unstable_now = function() {
        return o.now();
      };
    } else {
      var l = Date, c = l.now();
      e.unstable_now = function() {
        return l.now() - c;
      };
    }
    var d = [], h = [], p = 1, g = null, x = 3, b = !1, C = !1, N = !1, T = !1, j = typeof setTimeout == "function" ? setTimeout : null, R = typeof clearTimeout == "function" ? clearTimeout : null, A = typeof setImmediate < "u" ? setImmediate : null;
    function z(Z) {
      for (var fe = n(h); fe !== null; ) {
        if (fe.callback === null) r(h);
        else if (fe.startTime <= Z)
          r(h), fe.sortIndex = fe.expirationTime, t(d, fe);
        else break;
        fe = n(h);
      }
    }
    function q(Z) {
      if (N = !1, z(Z), !C)
        if (n(d) !== null)
          C = !0, D || (D = !0, V());
        else {
          var fe = n(h);
          fe !== null && se(q, fe.startTime - Z);
        }
    }
    var D = !1, P = -1, re = 5, ie = -1;
    function X() {
      return T ? !0 : !(e.unstable_now() - ie < re);
    }
    function K() {
      if (T = !1, D) {
        var Z = e.unstable_now();
        ie = Z;
        var fe = !0;
        try {
          e: {
            C = !1, N && (N = !1, R(P), P = -1), b = !0;
            var he = x;
            try {
              t: {
                for (z(Z), g = n(d); g !== null && !(g.expirationTime > Z && X()); ) {
                  var ge = g.callback;
                  if (typeof ge == "function") {
                    g.callback = null, x = g.priorityLevel;
                    var Q = ge(
                      g.expirationTime <= Z
                    );
                    if (Z = e.unstable_now(), typeof Q == "function") {
                      g.callback = Q, z(Z), fe = !0;
                      break t;
                    }
                    g === n(d) && r(d), z(Z);
                  } else r(d);
                  g = n(d);
                }
                if (g !== null) fe = !0;
                else {
                  var U = n(h);
                  U !== null && se(
                    q,
                    U.startTime - Z
                  ), fe = !1;
                }
              }
              break e;
            } finally {
              g = null, x = he, b = !1;
            }
            fe = void 0;
          }
        } finally {
          fe ? V() : D = !1;
        }
      }
    }
    var V;
    if (typeof A == "function")
      V = function() {
        A(K);
      };
    else if (typeof MessageChannel < "u") {
      var de = new MessageChannel(), H = de.port2;
      de.port1.onmessage = K, V = function() {
        H.postMessage(null);
      };
    } else
      V = function() {
        j(K, 0);
      };
    function se(Z, fe) {
      P = j(function() {
        Z(e.unstable_now());
      }, fe);
    }
    e.unstable_IdlePriority = 5, e.unstable_ImmediatePriority = 1, e.unstable_LowPriority = 4, e.unstable_NormalPriority = 3, e.unstable_Profiling = null, e.unstable_UserBlockingPriority = 2, e.unstable_cancelCallback = function(Z) {
      Z.callback = null;
    }, e.unstable_forceFrameRate = function(Z) {
      0 > Z || 125 < Z ? console.error(
        "forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"
      ) : re = 0 < Z ? Math.floor(1e3 / Z) : 5;
    }, e.unstable_getCurrentPriorityLevel = function() {
      return x;
    }, e.unstable_next = function(Z) {
      switch (x) {
        case 1:
        case 2:
        case 3:
          var fe = 3;
          break;
        default:
          fe = x;
      }
      var he = x;
      x = fe;
      try {
        return Z();
      } finally {
        x = he;
      }
    }, e.unstable_requestPaint = function() {
      T = !0;
    }, e.unstable_runWithPriority = function(Z, fe) {
      switch (Z) {
        case 1:
        case 2:
        case 3:
        case 4:
        case 5:
          break;
        default:
          Z = 3;
      }
      var he = x;
      x = Z;
      try {
        return fe();
      } finally {
        x = he;
      }
    }, e.unstable_scheduleCallback = function(Z, fe, he) {
      var ge = e.unstable_now();
      switch (typeof he == "object" && he !== null ? (he = he.delay, he = typeof he == "number" && 0 < he ? ge + he : ge) : he = ge, Z) {
        case 1:
          var Q = -1;
          break;
        case 2:
          Q = 250;
          break;
        case 5:
          Q = 1073741823;
          break;
        case 4:
          Q = 1e4;
          break;
        default:
          Q = 5e3;
      }
      return Q = he + Q, Z = {
        id: p++,
        callback: fe,
        priorityLevel: Z,
        startTime: he,
        expirationTime: Q,
        sortIndex: -1
      }, he > ge ? (Z.sortIndex = he, t(h, Z), n(d) === null && Z === n(h) && (N ? (R(P), P = -1) : N = !0, se(q, he - ge))) : (Z.sortIndex = Q, t(d, Z), C || b || (C = !0, D || (D = !0, V()))), Z;
    }, e.unstable_shouldYield = X, e.unstable_wrapCallback = function(Z) {
      var fe = x;
      return function() {
        var he = x;
        x = fe;
        try {
          return Z.apply(this, arguments);
        } finally {
          x = he;
        }
      };
    };
  })(mx)), mx;
}
var P5;
function mO() {
  return P5 || (P5 = 1, hx.exports = hO()), hx.exports;
}
var px = { exports: {} }, Ai = {};
/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var q5;
function pO() {
  if (q5) return Ai;
  q5 = 1;
  var e = jg();
  function t(d) {
    var h = "https://react.dev/errors/" + d;
    if (1 < arguments.length) {
      h += "?args[]=" + encodeURIComponent(arguments[1]);
      for (var p = 2; p < arguments.length; p++)
        h += "&args[]=" + encodeURIComponent(arguments[p]);
    }
    return "Minified React error #" + d + "; visit " + h + " for the full message or use the non-minified dev environment for full errors and additional helpful warnings.";
  }
  function n() {
  }
  var r = {
    d: {
      f: n,
      r: function() {
        throw Error(t(522));
      },
      D: n,
      C: n,
      L: n,
      m: n,
      X: n,
      S: n,
      M: n
    },
    p: 0,
    findDOMNode: null
  }, a = Symbol.for("react.portal");
  function o(d, h, p) {
    var g = 3 < arguments.length && arguments[3] !== void 0 ? arguments[3] : null;
    return {
      $$typeof: a,
      key: g == null ? null : "" + g,
      children: d,
      containerInfo: h,
      implementation: p
    };
  }
  var l = e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;
  function c(d, h) {
    if (d === "font") return "";
    if (typeof h == "string")
      return h === "use-credentials" ? h : "";
  }
  return Ai.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE = r, Ai.createPortal = function(d, h) {
    var p = 2 < arguments.length && arguments[2] !== void 0 ? arguments[2] : null;
    if (!h || h.nodeType !== 1 && h.nodeType !== 9 && h.nodeType !== 11)
      throw Error(t(299));
    return o(d, h, null, p);
  }, Ai.flushSync = function(d) {
    var h = l.T, p = r.p;
    try {
      if (l.T = null, r.p = 2, d) return d();
    } finally {
      l.T = h, r.p = p, r.d.f();
    }
  }, Ai.preconnect = function(d, h) {
    typeof d == "string" && (h ? (h = h.crossOrigin, h = typeof h == "string" ? h === "use-credentials" ? h : "" : void 0) : h = null, r.d.C(d, h));
  }, Ai.prefetchDNS = function(d) {
    typeof d == "string" && r.d.D(d);
  }, Ai.preinit = function(d, h) {
    if (typeof d == "string" && h && typeof h.as == "string") {
      var p = h.as, g = c(p, h.crossOrigin), x = typeof h.integrity == "string" ? h.integrity : void 0, b = typeof h.fetchPriority == "string" ? h.fetchPriority : void 0;
      p === "style" ? r.d.S(
        d,
        typeof h.precedence == "string" ? h.precedence : void 0,
        {
          crossOrigin: g,
          integrity: x,
          fetchPriority: b
        }
      ) : p === "script" && r.d.X(d, {
        crossOrigin: g,
        integrity: x,
        fetchPriority: b,
        nonce: typeof h.nonce == "string" ? h.nonce : void 0
      });
    }
  }, Ai.preinitModule = function(d, h) {
    if (typeof d == "string")
      if (typeof h == "object" && h !== null) {
        if (h.as == null || h.as === "script") {
          var p = c(
            h.as,
            h.crossOrigin
          );
          r.d.M(d, {
            crossOrigin: p,
            integrity: typeof h.integrity == "string" ? h.integrity : void 0,
            nonce: typeof h.nonce == "string" ? h.nonce : void 0
          });
        }
      } else h == null && r.d.M(d);
  }, Ai.preload = function(d, h) {
    if (typeof d == "string" && typeof h == "object" && h !== null && typeof h.as == "string") {
      var p = h.as, g = c(p, h.crossOrigin);
      r.d.L(d, p, {
        crossOrigin: g,
        integrity: typeof h.integrity == "string" ? h.integrity : void 0,
        nonce: typeof h.nonce == "string" ? h.nonce : void 0,
        type: typeof h.type == "string" ? h.type : void 0,
        fetchPriority: typeof h.fetchPriority == "string" ? h.fetchPriority : void 0,
        referrerPolicy: typeof h.referrerPolicy == "string" ? h.referrerPolicy : void 0,
        imageSrcSet: typeof h.imageSrcSet == "string" ? h.imageSrcSet : void 0,
        imageSizes: typeof h.imageSizes == "string" ? h.imageSizes : void 0,
        media: typeof h.media == "string" ? h.media : void 0
      });
    }
  }, Ai.preloadModule = function(d, h) {
    if (typeof d == "string")
      if (h) {
        var p = c(h.as, h.crossOrigin);
        r.d.m(d, {
          as: typeof h.as == "string" && h.as !== "script" ? h.as : void 0,
          crossOrigin: p,
          integrity: typeof h.integrity == "string" ? h.integrity : void 0
        });
      } else r.d.m(d);
  }, Ai.requestFormReset = function(d) {
    r.d.r(d);
  }, Ai.unstable_batchedUpdates = function(d, h) {
    return d(h);
  }, Ai.useFormState = function(d, h, p) {
    return l.H.useFormState(d, h, p);
  }, Ai.useFormStatus = function() {
    return l.H.useHostTransitionStatus();
  }, Ai.version = "19.2.3", Ai;
}
var B5;
function ZT() {
  if (B5) return px.exports;
  B5 = 1;
  function e() {
    if (!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ > "u" || typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE != "function"))
      try {
        __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e);
      } catch (t) {
        console.error(t);
      }
  }
  return e(), px.exports = pO(), px.exports;
}
/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var F5;
function gO() {
  if (F5) return qp;
  F5 = 1;
  var e = mO(), t = jg(), n = ZT();
  function r(i) {
    var s = "https://react.dev/errors/" + i;
    if (1 < arguments.length) {
      s += "?args[]=" + encodeURIComponent(arguments[1]);
      for (var u = 2; u < arguments.length; u++)
        s += "&args[]=" + encodeURIComponent(arguments[u]);
    }
    return "Minified React error #" + i + "; visit " + s + " for the full message or use the non-minified dev environment for full errors and additional helpful warnings.";
  }
  function a(i) {
    return !(!i || i.nodeType !== 1 && i.nodeType !== 9 && i.nodeType !== 11);
  }
  function o(i) {
    var s = i, u = i;
    if (i.alternate) for (; s.return; ) s = s.return;
    else {
      i = s;
      do
        s = i, (s.flags & 4098) !== 0 && (u = s.return), i = s.return;
      while (i);
    }
    return s.tag === 3 ? u : null;
  }
  function l(i) {
    if (i.tag === 13) {
      var s = i.memoizedState;
      if (s === null && (i = i.alternate, i !== null && (s = i.memoizedState)), s !== null) return s.dehydrated;
    }
    return null;
  }
  function c(i) {
    if (i.tag === 31) {
      var s = i.memoizedState;
      if (s === null && (i = i.alternate, i !== null && (s = i.memoizedState)), s !== null) return s.dehydrated;
    }
    return null;
  }
  function d(i) {
    if (o(i) !== i)
      throw Error(r(188));
  }
  function h(i) {
    var s = i.alternate;
    if (!s) {
      if (s = o(i), s === null) throw Error(r(188));
      return s !== i ? null : i;
    }
    for (var u = i, y = s; ; ) {
      var _ = u.return;
      if (_ === null) break;
      var k = _.alternate;
      if (k === null) {
        if (y = _.return, y !== null) {
          u = y;
          continue;
        }
        break;
      }
      if (_.child === k.child) {
        for (k = _.child; k; ) {
          if (k === u) return d(_), i;
          if (k === y) return d(_), s;
          k = k.sibling;
        }
        throw Error(r(188));
      }
      if (u.return !== y.return) u = _, y = k;
      else {
        for (var L = !1, J = _.child; J; ) {
          if (J === u) {
            L = !0, u = _, y = k;
            break;
          }
          if (J === y) {
            L = !0, y = _, u = k;
            break;
          }
          J = J.sibling;
        }
        if (!L) {
          for (J = k.child; J; ) {
            if (J === u) {
              L = !0, u = k, y = _;
              break;
            }
            if (J === y) {
              L = !0, y = k, u = _;
              break;
            }
            J = J.sibling;
          }
          if (!L) throw Error(r(189));
        }
      }
      if (u.alternate !== y) throw Error(r(190));
    }
    if (u.tag !== 3) throw Error(r(188));
    return u.stateNode.current === u ? i : s;
  }
  function p(i) {
    var s = i.tag;
    if (s === 5 || s === 26 || s === 27 || s === 6) return i;
    for (i = i.child; i !== null; ) {
      if (s = p(i), s !== null) return s;
      i = i.sibling;
    }
    return null;
  }
  var g = Object.assign, x = Symbol.for("react.element"), b = Symbol.for("react.transitional.element"), C = Symbol.for("react.portal"), N = Symbol.for("react.fragment"), T = Symbol.for("react.strict_mode"), j = Symbol.for("react.profiler"), R = Symbol.for("react.consumer"), A = Symbol.for("react.context"), z = Symbol.for("react.forward_ref"), q = Symbol.for("react.suspense"), D = Symbol.for("react.suspense_list"), P = Symbol.for("react.memo"), re = Symbol.for("react.lazy"), ie = Symbol.for("react.activity"), X = Symbol.for("react.memo_cache_sentinel"), K = Symbol.iterator;
  function V(i) {
    return i === null || typeof i != "object" ? null : (i = K && i[K] || i["@@iterator"], typeof i == "function" ? i : null);
  }
  var de = Symbol.for("react.client.reference");
  function H(i) {
    if (i == null) return null;
    if (typeof i == "function")
      return i.$$typeof === de ? null : i.displayName || i.name || null;
    if (typeof i == "string") return i;
    switch (i) {
      case N:
        return "Fragment";
      case j:
        return "Profiler";
      case T:
        return "StrictMode";
      case q:
        return "Suspense";
      case D:
        return "SuspenseList";
      case ie:
        return "Activity";
    }
    if (typeof i == "object")
      switch (i.$$typeof) {
        case C:
          return "Portal";
        case A:
          return i.displayName || "Context";
        case R:
          return (i._context.displayName || "Context") + ".Consumer";
        case z:
          var s = i.render;
          return i = i.displayName, i || (i = s.displayName || s.name || "", i = i !== "" ? "ForwardRef(" + i + ")" : "ForwardRef"), i;
        case P:
          return s = i.displayName || null, s !== null ? s : H(i.type) || "Memo";
        case re:
          s = i._payload, i = i._init;
          try {
            return H(i(s));
          } catch {
          }
      }
    return null;
  }
  var se = Array.isArray, Z = t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE, fe = n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE, he = {
    pending: !1,
    data: null,
    method: null,
    action: null
  }, ge = [], Q = -1;
  function U(i) {
    return { current: i };
  }
  function ue(i) {
    0 > Q || (i.current = ge[Q], ge[Q] = null, Q--);
  }
  function Y(i, s) {
    Q++, ge[Q] = i.current, i.current = s;
  }
  var le = U(null), xe = U(null), Se = U(null), Oe = U(null);
  function qe(i, s) {
    switch (Y(Se, s), Y(xe, i), Y(le, null), s.nodeType) {
      case 9:
      case 11:
        i = (i = s.documentElement) && (i = i.namespaceURI) ? Mf(i) : 0;
        break;
      default:
        if (i = s.tagName, s = s.namespaceURI)
          s = Mf(s), i = ji(s, i);
        else
          switch (i) {
            case "svg":
              i = 1;
              break;
            case "math":
              i = 2;
              break;
            default:
              i = 0;
          }
    }
    ue(le), Y(le, i);
  }
  function Me() {
    ue(le), ue(xe), ue(Se);
  }
  function Pe(i) {
    i.memoizedState !== null && Y(Oe, i);
    var s = le.current, u = ji(s, i.type);
    s !== u && (Y(xe, i), Y(le, u));
  }
  function Re(i) {
    xe.current === i && (ue(le), ue(xe)), Oe.current === i && (ue(Oe), lc._currentValue = he);
  }
  var Be, Je;
  function ot(i) {
    if (Be === void 0)
      try {
        throw Error();
      } catch (u) {
        var s = u.stack.trim().match(/\n( *(at )?)/);
        Be = s && s[1] || "", Je = -1 < u.stack.indexOf(`
    at`) ? " (<anonymous>)" : -1 < u.stack.indexOf("@") ? "@unknown:0:0" : "";
      }
    return `
` + Be + i + Je;
  }
  var We = !1;
  function bt(i, s) {
    if (!i || We) return "";
    We = !0;
    var u = Error.prepareStackTrace;
    Error.prepareStackTrace = void 0;
    try {
      var y = {
        DetermineComponentFrameRoot: function() {
          try {
            if (s) {
              var Ye = function() {
                throw Error();
              };
              if (Object.defineProperty(Ye.prototype, "props", {
                set: function() {
                  throw Error();
                }
              }), typeof Reflect == "object" && Reflect.construct) {
                try {
                  Reflect.construct(Ye, []);
                } catch (Fe) {
                  var Le = Fe;
                }
                Reflect.construct(i, [], Ye);
              } else {
                try {
                  Ye.call();
                } catch (Fe) {
                  Le = Fe;
                }
                i.call(Ye.prototype);
              }
            } else {
              try {
                throw Error();
              } catch (Fe) {
                Le = Fe;
              }
              (Ye = i()) && typeof Ye.catch == "function" && Ye.catch(function() {
              });
            }
          } catch (Fe) {
            if (Fe && Le && typeof Fe.stack == "string")
              return [Fe.stack, Le.stack];
          }
          return [null, null];
        }
      };
      y.DetermineComponentFrameRoot.displayName = "DetermineComponentFrameRoot";
      var _ = Object.getOwnPropertyDescriptor(
        y.DetermineComponentFrameRoot,
        "name"
      );
      _ && _.configurable && Object.defineProperty(
        y.DetermineComponentFrameRoot,
        "name",
        { value: "DetermineComponentFrameRoot" }
      );
      var k = y.DetermineComponentFrameRoot(), L = k[0], J = k[1];
      if (L && J) {
        var ve = L.split(`
`), De = J.split(`
`);
        for (_ = y = 0; y < ve.length && !ve[y].includes("DetermineComponentFrameRoot"); )
          y++;
        for (; _ < De.length && !De[_].includes(
          "DetermineComponentFrameRoot"
        ); )
          _++;
        if (y === ve.length || _ === De.length)
          for (y = ve.length - 1, _ = De.length - 1; 1 <= y && 0 <= _ && ve[y] !== De[_]; )
            _--;
        for (; 1 <= y && 0 <= _; y--, _--)
          if (ve[y] !== De[_]) {
            if (y !== 1 || _ !== 1)
              do
                if (y--, _--, 0 > _ || ve[y] !== De[_]) {
                  var He = `
` + ve[y].replace(" at new ", " at ");
                  return i.displayName && He.includes("<anonymous>") && (He = He.replace("<anonymous>", i.displayName)), He;
                }
              while (1 <= y && 0 <= _);
            break;
          }
      }
    } finally {
      We = !1, Error.prepareStackTrace = u;
    }
    return (u = i ? i.displayName || i.name : "") ? ot(u) : "";
  }
  function vt(i, s) {
    switch (i.tag) {
      case 26:
      case 27:
      case 5:
        return ot(i.type);
      case 16:
        return ot("Lazy");
      case 13:
        return i.child !== s && s !== null ? ot("Suspense Fallback") : ot("Suspense");
      case 19:
        return ot("SuspenseList");
      case 0:
      case 15:
        return bt(i.type, !1);
      case 11:
        return bt(i.type.render, !1);
      case 1:
        return bt(i.type, !0);
      case 31:
        return ot("Activity");
      default:
        return "";
    }
  }
  function Yn(i) {
    try {
      var s = "", u = null;
      do
        s += vt(i, u), u = i, i = i.return;
      while (i);
      return s;
    } catch (y) {
      return `
Error generating stack: ` + y.message + `
` + y.stack;
    }
  }
  var Mn = Object.prototype.hasOwnProperty, Fn = e.unstable_scheduleCallback, Ht = e.unstable_cancelCallback, Rn = e.unstable_shouldYield, rn = e.unstable_requestPaint, Cn = e.unstable_now, Wn = e.unstable_getCurrentPriorityLevel, Ue = e.unstable_ImmediatePriority, Ze = e.unstable_UserBlockingPriority, gt = e.unstable_NormalPriority, Nt = e.unstable_LowPriority, Dt = e.unstable_IdlePriority, Un = e.log, $n = e.unstable_setDisableYieldValue, an = null, Qt = null;
  function En(i) {
    if (typeof Un == "function" && $n(i), Qt && typeof Qt.setStrictMode == "function")
      try {
        Qt.setStrictMode(an, i);
      } catch {
      }
  }
  var it = Math.clz32 ? Math.clz32 : xo, jr = Math.log, lr = Math.LN2;
  function xo(i) {
    return i >>>= 0, i === 0 ? 32 : 31 - (jr(i) / lr | 0) | 0;
  }
  var ct = 256, Oa = 262144, as = 4194304;
  function Di(i) {
    var s = i & 42;
    if (s !== 0) return s;
    switch (i & -i) {
      case 1:
        return 1;
      case 2:
        return 2;
      case 4:
        return 4;
      case 8:
        return 8;
      case 16:
        return 16;
      case 32:
        return 32;
      case 64:
        return 64;
      case 128:
        return 128;
      case 256:
      case 512:
      case 1024:
      case 2048:
      case 4096:
      case 8192:
      case 16384:
      case 32768:
      case 65536:
      case 131072:
        return i & 261888;
      case 262144:
      case 524288:
      case 1048576:
      case 2097152:
        return i & 3932160;
      case 4194304:
      case 8388608:
      case 16777216:
      case 33554432:
        return i & 62914560;
      case 67108864:
        return 67108864;
      case 134217728:
        return 134217728;
      case 268435456:
        return 268435456;
      case 536870912:
        return 536870912;
      case 1073741824:
        return 0;
      default:
        return i;
    }
  }
  function js(i, s, u) {
    var y = i.pendingLanes;
    if (y === 0) return 0;
    var _ = 0, k = i.suspendedLanes, L = i.pingedLanes;
    i = i.warmLanes;
    var J = y & 134217727;
    return J !== 0 ? (y = J & ~k, y !== 0 ? _ = Di(y) : (L &= J, L !== 0 ? _ = Di(L) : u || (u = J & ~i, u !== 0 && (_ = Di(u))))) : (J = y & ~k, J !== 0 ? _ = Di(J) : L !== 0 ? _ = Di(L) : u || (u = y & ~i, u !== 0 && (_ = Di(u)))), _ === 0 ? 0 : s !== 0 && s !== _ && (s & k) === 0 && (k = _ & -_, u = s & -s, k >= u || k === 32 && (u & 4194048) !== 0) ? s : _;
  }
  function za(i, s) {
    return (i.pendingLanes & ~(i.suspendedLanes & ~i.pingedLanes) & s) === 0;
  }
  function Sc(i, s) {
    switch (i) {
      case 1:
      case 2:
      case 4:
      case 8:
      case 64:
        return s + 250;
      case 16:
      case 32:
      case 128:
      case 256:
      case 512:
      case 1024:
      case 2048:
      case 4096:
      case 8192:
      case 16384:
      case 32768:
      case 65536:
      case 131072:
      case 262144:
      case 524288:
      case 1048576:
      case 2097152:
        return s + 5e3;
      case 4194304:
      case 8388608:
      case 16777216:
      case 33554432:
        return -1;
      case 67108864:
      case 134217728:
      case 268435456:
      case 536870912:
      case 1073741824:
        return -1;
      default:
        return -1;
    }
  }
  function bl() {
    var i = as;
    return as <<= 1, (as & 62914560) === 0 && (as = 4194304), i;
  }
  function ra(i) {
    for (var s = [], u = 0; 31 > u; u++) s.push(i);
    return s;
  }
  function pi(i, s) {
    i.pendingLanes |= s, s !== 268435456 && (i.suspendedLanes = 0, i.pingedLanes = 0, i.warmLanes = 0);
  }
  function wl(i, s, u, y, _, k) {
    var L = i.pendingLanes;
    i.pendingLanes = u, i.suspendedLanes = 0, i.pingedLanes = 0, i.warmLanes = 0, i.expiredLanes &= u, i.entangledLanes &= u, i.errorRecoveryDisabledLanes &= u, i.shellSuspendCounter = 0;
    var J = i.entanglements, ve = i.expirationTimes, De = i.hiddenUpdates;
    for (u = L & ~u; 0 < u; ) {
      var He = 31 - it(u), Ye = 1 << He;
      J[He] = 0, ve[He] = -1;
      var Le = De[He];
      if (Le !== null)
        for (De[He] = null, He = 0; He < Le.length; He++) {
          var Fe = Le[He];
          Fe !== null && (Fe.lane &= -536870913);
        }
      u &= ~Ye;
    }
    y !== 0 && Da(i, y, 0), k !== 0 && _ === 0 && i.tag !== 0 && (i.suspendedLanes |= k & ~(L & ~s));
  }
  function Da(i, s, u) {
    i.pendingLanes |= s, i.suspendedLanes &= ~s;
    var y = 31 - it(s);
    i.entangledLanes |= s, i.entanglements[y] = i.entanglements[y] | 1073741824 | u & 261930;
  }
  function yn(i, s) {
    var u = i.entangledLanes |= s;
    for (i = i.entanglements; u; ) {
      var y = 31 - it(u), _ = 1 << y;
      _ & s | i[y] & s && (i[y] |= s), u &= ~_;
    }
  }
  function On(i, s) {
    var u = s & -s;
    return u = (u & 42) !== 0 ? 1 : _l(u), (u & (i.suspendedLanes | s)) !== 0 ? 0 : u;
  }
  function _l(i) {
    switch (i) {
      case 2:
        i = 1;
        break;
      case 8:
        i = 4;
        break;
      case 32:
        i = 16;
        break;
      case 256:
      case 512:
      case 1024:
      case 2048:
      case 4096:
      case 8192:
      case 16384:
      case 32768:
      case 65536:
      case 131072:
      case 262144:
      case 524288:
      case 1048576:
      case 2097152:
      case 4194304:
      case 8388608:
      case 16777216:
      case 33554432:
        i = 128;
        break;
      case 268435456:
        i = 134217728;
        break;
      default:
        i = 0;
    }
    return i;
  }
  function ss(i) {
    return i &= -i, 2 < i ? 8 < i ? (i & 134217727) !== 0 ? 32 : 268435456 : 8 : 2;
  }
  function Ts() {
    var i = fe.p;
    return i !== 0 ? i : (i = window.event, i === void 0 ? 32 : _y(i.type));
  }
  function As(i, s) {
    var u = fe.p;
    try {
      return fe.p = i, s();
    } finally {
      fe.p = u;
    }
  }
  var ia = Math.random().toString(36).slice(2), bn = "__reactFiber$" + ia, Xn = "__reactProps$" + ia, Tr = "__reactContainer$" + ia, aa = "__reactEvents$" + ia, cu = "__reactListeners$" + ia, sa = "__reactHandles$" + ia, Sl = "__reactResources$" + ia, ri = "__reactMarker$" + ia;
  function bo(i) {
    delete i[bn], delete i[Xn], delete i[aa], delete i[cu], delete i[sa];
  }
  function oa(i) {
    var s = i[bn];
    if (s) return s;
    for (var u = i.parentNode; u; ) {
      if (s = u[Tr] || u[bn]) {
        if (u = s.alternate, s.child !== null || u !== null && u.child !== null)
          for (i = ay(i); i !== null; ) {
            if (u = i[bn]) return u;
            i = ay(i);
          }
        return s;
      }
      i = u, u = i.parentNode;
    }
    return null;
  }
  function sn(i) {
    if (i = i[bn] || i[Tr]) {
      var s = i.tag;
      if (s === 5 || s === 6 || s === 13 || s === 31 || s === 26 || s === 27 || s === 3)
        return i;
    }
    return null;
  }
  function Yr(i) {
    var s = i.tag;
    if (s === 5 || s === 26 || s === 27 || s === 6) return i.stateNode;
    throw Error(r(33));
  }
  function ur(i) {
    var s = i[Sl];
    return s || (s = i[Sl] = { hoistableStyles: /* @__PURE__ */ new Map(), hoistableScripts: /* @__PURE__ */ new Map() }), s;
  }
  function Qn(i) {
    i[ri] = !0;
  }
  var Ia = /* @__PURE__ */ new Set(), Ms = {};
  function gi(i, s) {
    Ii(i, s), Ii(i + "Capture", s);
  }
  function Ii(i, s) {
    for (Ms[i] = s, i = 0; i < s.length; i++)
      Ia.add(s[i]);
  }
  var la = RegExp(
    "^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"
  ), wo = {}, Rs = {};
  function fu(i) {
    return Mn.call(Rs, i) ? !0 : Mn.call(wo, i) ? !1 : la.test(i) ? Rs[i] = !0 : (wo[i] = !0, !1);
  }
  function It(i, s, u) {
    if (fu(s))
      if (u === null) i.removeAttribute(s);
      else {
        switch (typeof u) {
          case "undefined":
          case "function":
          case "symbol":
            i.removeAttribute(s);
            return;
          case "boolean":
            var y = s.toLowerCase().slice(0, 5);
            if (y !== "data-" && y !== "aria-") {
              i.removeAttribute(s);
              return;
            }
        }
        i.setAttribute(s, "" + u);
      }
  }
  function os(i, s, u) {
    if (u === null) i.removeAttribute(s);
    else {
      switch (typeof u) {
        case "undefined":
        case "function":
        case "symbol":
        case "boolean":
          i.removeAttribute(s);
          return;
      }
      i.setAttribute(s, "" + u);
    }
  }
  function ii(i, s, u, y) {
    if (y === null) i.removeAttribute(u);
    else {
      switch (typeof y) {
        case "undefined":
        case "function":
        case "symbol":
        case "boolean":
          i.removeAttribute(u);
          return;
      }
      i.setAttributeNS(s, u, "" + y);
    }
  }
  function gr(i) {
    switch (typeof i) {
      case "bigint":
      case "boolean":
      case "number":
      case "string":
      case "undefined":
        return i;
      case "object":
        return i;
      default:
        return "";
    }
  }
  function ua(i) {
    var s = i.type;
    return (i = i.nodeName) && i.toLowerCase() === "input" && (s === "checkbox" || s === "radio");
  }
  function du(i, s, u) {
    var y = Object.getOwnPropertyDescriptor(
      i.constructor.prototype,
      s
    );
    if (!i.hasOwnProperty(s) && typeof y < "u" && typeof y.get == "function" && typeof y.set == "function") {
      var _ = y.get, k = y.set;
      return Object.defineProperty(i, s, {
        configurable: !0,
        get: function() {
          return _.call(this);
        },
        set: function(L) {
          u = "" + L, k.call(this, L);
        }
      }), Object.defineProperty(i, s, {
        enumerable: y.enumerable
      }), {
        getValue: function() {
          return u;
        },
        setValue: function(L) {
          u = "" + L;
        },
        stopTracking: function() {
          i._valueTracker = null, delete i[s];
        }
      };
    }
  }
  function ca(i) {
    if (!i._valueTracker) {
      var s = ua(i) ? "checked" : "value";
      i._valueTracker = du(
        i,
        s,
        "" + i[s]
      );
    }
  }
  function ls(i) {
    if (!i) return !1;
    var s = i._valueTracker;
    if (!s) return !0;
    var u = s.getValue(), y = "";
    return i && (y = ua(i) ? i.checked ? "true" : "false" : i.value), i = y, i !== u ? (s.setValue(i), !0) : !1;
  }
  function Zt(i) {
    if (i = i || (typeof document < "u" ? document : void 0), typeof i > "u") return null;
    try {
      return i.activeElement || i.body;
    } catch {
      return i.body;
    }
  }
  var Os = /[\n"\\]/g;
  function cr(i) {
    return i.replace(
      Os,
      function(s) {
        return "\\" + s.charCodeAt(0).toString(16) + " ";
      }
    );
  }
  function ai(i, s, u, y, _, k, L, J) {
    i.name = "", L != null && typeof L != "function" && typeof L != "symbol" && typeof L != "boolean" ? i.type = L : i.removeAttribute("type"), s != null ? L === "number" ? (s === 0 && i.value === "" || i.value != s) && (i.value = "" + gr(s)) : i.value !== "" + gr(s) && (i.value = "" + gr(s)) : L !== "submit" && L !== "reset" || i.removeAttribute("value"), s != null ? zs(i, L, gr(s)) : u != null ? zs(i, L, gr(u)) : y != null && i.removeAttribute("value"), _ == null && k != null && (i.defaultChecked = !!k), _ != null && (i.checked = _ && typeof _ != "function" && typeof _ != "symbol"), J != null && typeof J != "function" && typeof J != "symbol" && typeof J != "boolean" ? i.name = "" + gr(J) : i.removeAttribute("name");
  }
  function us(i, s, u, y, _, k, L, J) {
    if (k != null && typeof k != "function" && typeof k != "symbol" && typeof k != "boolean" && (i.type = k), s != null || u != null) {
      if (!(k !== "submit" && k !== "reset" || s != null)) {
        ca(i);
        return;
      }
      u = u != null ? "" + gr(u) : "", s = s != null ? "" + gr(s) : u, J || s === i.value || (i.value = s), i.defaultValue = s;
    }
    y = y ?? _, y = typeof y != "function" && typeof y != "symbol" && !!y, i.checked = J ? i.checked : !!y, i.defaultChecked = !!y, L != null && typeof L != "function" && typeof L != "symbol" && typeof L != "boolean" && (i.name = L), ca(i);
  }
  function zs(i, s, u) {
    s === "number" && Zt(i.ownerDocument) === i || i.defaultValue === "" + u || (i.defaultValue = "" + u);
  }
  function si(i, s, u, y) {
    if (i = i.options, s) {
      s = {};
      for (var _ = 0; _ < u.length; _++)
        s["$" + u[_]] = !0;
      for (u = 0; u < i.length; u++)
        _ = s.hasOwnProperty("$" + i[u].value), i[u].selected !== _ && (i[u].selected = _), _ && y && (i[u].defaultSelected = !0);
    } else {
      for (u = "" + gr(u), s = null, _ = 0; _ < i.length; _++) {
        if (i[_].value === u) {
          i[_].selected = !0, y && (i[_].defaultSelected = !0);
          return;
        }
        s !== null || i[_].disabled || (s = i[_]);
      }
      s !== null && (s.selected = !0);
    }
  }
  function Cl(i, s, u) {
    if (s != null && (s = "" + gr(s), s !== i.value && (i.value = s), u == null)) {
      i.defaultValue !== s && (i.defaultValue = s);
      return;
    }
    i.defaultValue = u != null ? "" + gr(u) : "";
  }
  function Ds(i, s, u, y) {
    if (s == null) {
      if (y != null) {
        if (u != null) throw Error(r(92));
        if (se(y)) {
          if (1 < y.length) throw Error(r(93));
          y = y[0];
        }
        u = y;
      }
      u == null && (u = ""), s = u;
    }
    u = gr(s), i.defaultValue = u, y = i.textContent, y === u && y !== "" && y !== null && (i.value = y), ca(i);
  }
  function yi(i, s) {
    if (s) {
      var u = i.firstChild;
      if (u && u === i.lastChild && u.nodeType === 3) {
        u.nodeValue = s;
        return;
      }
    }
    i.textContent = s;
  }
  var hd = new Set(
    "animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(
      " "
    )
  );
  function Yt(i, s, u) {
    var y = s.indexOf("--") === 0;
    u == null || typeof u == "boolean" || u === "" ? y ? i.setProperty(s, "") : s === "float" ? i.cssFloat = "" : i[s] = "" : y ? i.setProperty(s, u) : typeof u != "number" || u === 0 || hd.has(s) ? s === "float" ? i.cssFloat = u : i[s] = ("" + u).trim() : i[s] = u + "px";
  }
  function Cc(i, s, u) {
    if (s != null && typeof s != "object")
      throw Error(r(62));
    if (i = i.style, u != null) {
      for (var y in u)
        !u.hasOwnProperty(y) || s != null && s.hasOwnProperty(y) || (y.indexOf("--") === 0 ? i.setProperty(y, "") : y === "float" ? i.cssFloat = "" : i[y] = "");
      for (var _ in s)
        y = s[_], s.hasOwnProperty(_) && u[_] !== y && Yt(i, _, y);
    } else
      for (var k in s)
        s.hasOwnProperty(k) && Yt(i, k, s[k]);
  }
  function hu(i) {
    if (i.indexOf("-") === -1) return !1;
    switch (i) {
      case "annotation-xml":
      case "color-profile":
      case "font-face":
      case "font-face-src":
      case "font-face-uri":
      case "font-face-format":
      case "font-face-name":
      case "missing-glyph":
        return !1;
      default:
        return !0;
    }
  }
  var md = /* @__PURE__ */ new Map([
    ["acceptCharset", "accept-charset"],
    ["htmlFor", "for"],
    ["httpEquiv", "http-equiv"],
    ["crossOrigin", "crossorigin"],
    ["accentHeight", "accent-height"],
    ["alignmentBaseline", "alignment-baseline"],
    ["arabicForm", "arabic-form"],
    ["baselineShift", "baseline-shift"],
    ["capHeight", "cap-height"],
    ["clipPath", "clip-path"],
    ["clipRule", "clip-rule"],
    ["colorInterpolation", "color-interpolation"],
    ["colorInterpolationFilters", "color-interpolation-filters"],
    ["colorProfile", "color-profile"],
    ["colorRendering", "color-rendering"],
    ["dominantBaseline", "dominant-baseline"],
    ["enableBackground", "enable-background"],
    ["fillOpacity", "fill-opacity"],
    ["fillRule", "fill-rule"],
    ["floodColor", "flood-color"],
    ["floodOpacity", "flood-opacity"],
    ["fontFamily", "font-family"],
    ["fontSize", "font-size"],
    ["fontSizeAdjust", "font-size-adjust"],
    ["fontStretch", "font-stretch"],
    ["fontStyle", "font-style"],
    ["fontVariant", "font-variant"],
    ["fontWeight", "font-weight"],
    ["glyphName", "glyph-name"],
    ["glyphOrientationHorizontal", "glyph-orientation-horizontal"],
    ["glyphOrientationVertical", "glyph-orientation-vertical"],
    ["horizAdvX", "horiz-adv-x"],
    ["horizOriginX", "horiz-origin-x"],
    ["imageRendering", "image-rendering"],
    ["letterSpacing", "letter-spacing"],
    ["lightingColor", "lighting-color"],
    ["markerEnd", "marker-end"],
    ["markerMid", "marker-mid"],
    ["markerStart", "marker-start"],
    ["overlinePosition", "overline-position"],
    ["overlineThickness", "overline-thickness"],
    ["paintOrder", "paint-order"],
    ["panose-1", "panose-1"],
    ["pointerEvents", "pointer-events"],
    ["renderingIntent", "rendering-intent"],
    ["shapeRendering", "shape-rendering"],
    ["stopColor", "stop-color"],
    ["stopOpacity", "stop-opacity"],
    ["strikethroughPosition", "strikethrough-position"],
    ["strikethroughThickness", "strikethrough-thickness"],
    ["strokeDasharray", "stroke-dasharray"],
    ["strokeDashoffset", "stroke-dashoffset"],
    ["strokeLinecap", "stroke-linecap"],
    ["strokeLinejoin", "stroke-linejoin"],
    ["strokeMiterlimit", "stroke-miterlimit"],
    ["strokeOpacity", "stroke-opacity"],
    ["strokeWidth", "stroke-width"],
    ["textAnchor", "text-anchor"],
    ["textDecoration", "text-decoration"],
    ["textRendering", "text-rendering"],
    ["transformOrigin", "transform-origin"],
    ["underlinePosition", "underline-position"],
    ["underlineThickness", "underline-thickness"],
    ["unicodeBidi", "unicode-bidi"],
    ["unicodeRange", "unicode-range"],
    ["unitsPerEm", "units-per-em"],
    ["vAlphabetic", "v-alphabetic"],
    ["vHanging", "v-hanging"],
    ["vIdeographic", "v-ideographic"],
    ["vMathematical", "v-mathematical"],
    ["vectorEffect", "vector-effect"],
    ["vertAdvY", "vert-adv-y"],
    ["vertOriginX", "vert-origin-x"],
    ["vertOriginY", "vert-origin-y"],
    ["wordSpacing", "word-spacing"],
    ["writingMode", "writing-mode"],
    ["xmlnsXlink", "xmlns:xlink"],
    ["xHeight", "x-height"]
  ]), Wr = /^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;
  function fa(i) {
    return Wr.test("" + i) ? "javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')" : i;
  }
  function vi() {
  }
  var da = null;
  function mu(i) {
    return i = i.target || i.srcElement || window, i.correspondingUseElement && (i = i.correspondingUseElement), i.nodeType === 3 ? i.parentNode : i;
  }
  var cs = null, zn = null;
  function Li(i) {
    var s = sn(i);
    if (s && (i = s.stateNode)) {
      var u = i[Xn] || null;
      e: switch (i = s.stateNode, s.type) {
        case "input":
          if (ai(
            i,
            u.value,
            u.defaultValue,
            u.defaultValue,
            u.checked,
            u.defaultChecked,
            u.type,
            u.name
          ), s = u.name, u.type === "radio" && s != null) {
            for (u = i; u.parentNode; ) u = u.parentNode;
            for (u = u.querySelectorAll(
              'input[name="' + cr(
                "" + s
              ) + '"][type="radio"]'
            ), s = 0; s < u.length; s++) {
              var y = u[s];
              if (y !== i && y.form === i.form) {
                var _ = y[Xn] || null;
                if (!_) throw Error(r(90));
                ai(
                  y,
                  _.value,
                  _.defaultValue,
                  _.defaultValue,
                  _.checked,
                  _.defaultChecked,
                  _.type,
                  _.name
                );
              }
            }
            for (s = 0; s < u.length; s++)
              y = u[s], y.form === i.form && ls(y);
          }
          break e;
        case "textarea":
          Cl(i, u.value, u.defaultValue);
          break e;
        case "select":
          s = u.value, s != null && si(i, !!u.multiple, s, !1);
      }
    }
  }
  var Is = !1;
  function _o(i, s, u) {
    if (Is) return i(s, u);
    Is = !0;
    try {
      var y = i(s);
      return y;
    } finally {
      if (Is = !1, (cs !== null || zn !== null) && (rh(), cs && (s = cs, i = zn, zn = cs = null, Li(s), i)))
        for (s = 0; s < i.length; s++) Li(i[s]);
    }
  }
  function La(i, s) {
    var u = i.stateNode;
    if (u === null) return null;
    var y = u[Xn] || null;
    if (y === null) return null;
    u = y[s];
    e: switch (s) {
      case "onClick":
      case "onClickCapture":
      case "onDoubleClick":
      case "onDoubleClickCapture":
      case "onMouseDown":
      case "onMouseDownCapture":
      case "onMouseMove":
      case "onMouseMoveCapture":
      case "onMouseUp":
      case "onMouseUpCapture":
      case "onMouseEnter":
        (y = !y.disabled) || (i = i.type, y = !(i === "button" || i === "input" || i === "select" || i === "textarea")), i = !y;
        break e;
      default:
        i = !1;
    }
    if (i) return null;
    if (u && typeof u != "function")
      throw Error(
        r(231, s, typeof u)
      );
    return u;
  }
  var Ar = !(typeof window > "u" || typeof window.document > "u" || typeof window.document.createElement > "u"), Ec = !1;
  if (Ar)
    try {
      var Xr = {};
      Object.defineProperty(Xr, "passive", {
        get: function() {
          Ec = !0;
        }
      }), window.addEventListener("test", Xr, Xr), window.removeEventListener("test", Xr, Xr);
    } catch {
      Ec = !1;
    }
  var ha = null, pu = null, un = null;
  function on() {
    if (un) return un;
    var i, s = pu, u = s.length, y, _ = "value" in ha ? ha.value : ha.textContent, k = _.length;
    for (i = 0; i < u && s[i] === _[i]; i++) ;
    var L = u - i;
    for (y = 1; y <= L && s[u - y] === _[k - y]; y++) ;
    return un = _.slice(i, 1 < y ? 1 - y : void 0);
  }
  function So(i) {
    var s = i.keyCode;
    return "charCode" in i ? (i = i.charCode, i === 0 && s === 13 && (i = 13)) : i = s, i === 10 && (i = 13), 32 <= i || i === 13 ? i : 0;
  }
  function El() {
    return !0;
  }
  function pd() {
    return !1;
  }
  function yr(i) {
    function s(u, y, _, k, L) {
      this._reactName = u, this._targetInst = _, this.type = y, this.nativeEvent = k, this.target = L, this.currentTarget = null;
      for (var J in i)
        i.hasOwnProperty(J) && (u = i[J], this[J] = u ? u(k) : k[J]);
      return this.isDefaultPrevented = (k.defaultPrevented != null ? k.defaultPrevented : k.returnValue === !1) ? El : pd, this.isPropagationStopped = pd, this;
    }
    return g(s.prototype, {
      preventDefault: function() {
        this.defaultPrevented = !0;
        var u = this.nativeEvent;
        u && (u.preventDefault ? u.preventDefault() : typeof u.returnValue != "unknown" && (u.returnValue = !1), this.isDefaultPrevented = El);
      },
      stopPropagation: function() {
        var u = this.nativeEvent;
        u && (u.stopPropagation ? u.stopPropagation() : typeof u.cancelBubble != "unknown" && (u.cancelBubble = !0), this.isPropagationStopped = El);
      },
      persist: function() {
      },
      isPersistent: El
    }), s;
  }
  var Ls = {
    eventPhase: 0,
    bubbles: 0,
    cancelable: 0,
    timeStamp: function(i) {
      return i.timeStamp || Date.now();
    },
    defaultPrevented: 0,
    isTrusted: 0
  }, gu = yr(Ls), Pa = g({}, Ls, { view: 0, detail: 0 }), yu = yr(Pa), Zn, kl, Pi, Nl = g({}, Pa, {
    screenX: 0,
    screenY: 0,
    clientX: 0,
    clientY: 0,
    pageX: 0,
    pageY: 0,
    ctrlKey: 0,
    shiftKey: 0,
    altKey: 0,
    metaKey: 0,
    getModifierState: qa,
    button: 0,
    buttons: 0,
    relatedTarget: function(i) {
      return i.relatedTarget === void 0 ? i.fromElement === i.srcElement ? i.toElement : i.fromElement : i.relatedTarget;
    },
    movementX: function(i) {
      return "movementX" in i ? i.movementX : (i !== Pi && (Pi && i.type === "mousemove" ? (Zn = i.screenX - Pi.screenX, kl = i.screenY - Pi.screenY) : kl = Zn = 0, Pi = i), Zn);
    },
    movementY: function(i) {
      return "movementY" in i ? i.movementY : kl;
    }
  }), Co = yr(Nl), Qr = g({}, Nl, { dataTransfer: 0 }), kc = yr(Qr), jl = g({}, Pa, { relatedTarget: 0 }), Ps = yr(jl), Tl = g({}, Ls, {
    animationName: 0,
    elapsedTime: 0,
    pseudoElement: 0
  }), Nc = yr(Tl), gd = g({}, Ls, {
    clipboardData: function(i) {
      return "clipboardData" in i ? i.clipboardData : window.clipboardData;
    }
  }), vr = yr(gd), jc = g({}, Ls, { data: 0 }), Lr = yr(jc), Tc = {
    Esc: "Escape",
    Spacebar: " ",
    Left: "ArrowLeft",
    Up: "ArrowUp",
    Right: "ArrowRight",
    Down: "ArrowDown",
    Del: "Delete",
    Win: "OS",
    Menu: "ContextMenu",
    Apps: "ContextMenu",
    Scroll: "ScrollLock",
    MozPrintableKey: "Unidentified"
  }, vu = {
    8: "Backspace",
    9: "Tab",
    12: "Clear",
    13: "Enter",
    16: "Shift",
    17: "Control",
    18: "Alt",
    19: "Pause",
    20: "CapsLock",
    27: "Escape",
    32: " ",
    33: "PageUp",
    34: "PageDown",
    35: "End",
    36: "Home",
    37: "ArrowLeft",
    38: "ArrowUp",
    39: "ArrowRight",
    40: "ArrowDown",
    45: "Insert",
    46: "Delete",
    112: "F1",
    113: "F2",
    114: "F3",
    115: "F4",
    116: "F5",
    117: "F6",
    118: "F7",
    119: "F8",
    120: "F9",
    121: "F10",
    122: "F11",
    123: "F12",
    144: "NumLock",
    145: "ScrollLock",
    224: "Meta"
  }, Dn = {
    Alt: "altKey",
    Control: "ctrlKey",
    Meta: "metaKey",
    Shift: "shiftKey"
  };
  function fs(i) {
    var s = this.nativeEvent;
    return s.getModifierState ? s.getModifierState(i) : (i = Dn[i]) ? !!s[i] : !1;
  }
  function qa() {
    return fs;
  }
  var kn = g({}, Pa, {
    key: function(i) {
      if (i.key) {
        var s = Tc[i.key] || i.key;
        if (s !== "Unidentified") return s;
      }
      return i.type === "keypress" ? (i = So(i), i === 13 ? "Enter" : String.fromCharCode(i)) : i.type === "keydown" || i.type === "keyup" ? vu[i.keyCode] || "Unidentified" : "";
    },
    code: 0,
    location: 0,
    ctrlKey: 0,
    shiftKey: 0,
    altKey: 0,
    metaKey: 0,
    repeat: 0,
    locale: 0,
    getModifierState: qa,
    charCode: function(i) {
      return i.type === "keypress" ? So(i) : 0;
    },
    keyCode: function(i) {
      return i.type === "keydown" || i.type === "keyup" ? i.keyCode : 0;
    },
    which: function(i) {
      return i.type === "keypress" ? So(i) : i.type === "keydown" || i.type === "keyup" ? i.keyCode : 0;
    }
  }), qi = yr(kn), xu = g({}, Nl, {
    pointerId: 0,
    width: 0,
    height: 0,
    pressure: 0,
    tangentialPressure: 0,
    tiltX: 0,
    tiltY: 0,
    twist: 0,
    pointerType: 0,
    isPrimary: 0
  }), Ac = yr(xu), Eo = g({}, Pa, {
    touches: 0,
    targetTouches: 0,
    changedTouches: 0,
    altKey: 0,
    metaKey: 0,
    ctrlKey: 0,
    shiftKey: 0,
    getModifierState: qa
  }), Mc = yr(Eo), qs = g({}, Ls, {
    propertyName: 0,
    elapsedTime: 0,
    pseudoElement: 0
  }), Rc = yr(qs), bu = g({}, Nl, {
    deltaX: function(i) {
      return "deltaX" in i ? i.deltaX : "wheelDeltaX" in i ? -i.wheelDeltaX : 0;
    },
    deltaY: function(i) {
      return "deltaY" in i ? i.deltaY : "wheelDeltaY" in i ? -i.wheelDeltaY : "wheelDelta" in i ? -i.wheelDelta : 0;
    },
    deltaZ: 0,
    deltaMode: 0
  }), Bs = yr(bu), ds = g({}, Ls, {
    newState: 0,
    oldState: 0
  }), yd = yr(ds), vd = [9, 13, 27, 32], ko = Ar && "CompositionEvent" in window, ma = null;
  Ar && "documentMode" in document && (ma = document.documentMode);
  var Oc = Ar && "TextEvent" in window && !ma, Al = Ar && (!ko || ma && 8 < ma && 11 >= ma), wu = " ", _u = !1;
  function Ml(i, s) {
    switch (i) {
      case "keyup":
        return vd.indexOf(s.keyCode) !== -1;
      case "keydown":
        return s.keyCode !== 229;
      case "keypress":
      case "mousedown":
      case "focusout":
        return !0;
      default:
        return !1;
    }
  }
  function xd(i) {
    return i = i.detail, typeof i == "object" && "data" in i ? i.data : null;
  }
  var hs = !1;
  function Zr(i, s) {
    switch (i) {
      case "compositionend":
        return xd(s);
      case "keypress":
        return s.which !== 32 ? null : (_u = !0, wu);
      case "textInput":
        return i = s.data, i === wu && _u ? null : i;
      default:
        return null;
    }
  }
  function zc(i, s) {
    if (hs)
      return i === "compositionend" || !ko && Ml(i, s) ? (i = on(), un = pu = ha = null, hs = !1, i) : null;
    switch (i) {
      case "paste":
        return null;
      case "keypress":
        if (!(s.ctrlKey || s.altKey || s.metaKey) || s.ctrlKey && s.altKey) {
          if (s.char && 1 < s.char.length)
            return s.char;
          if (s.which) return String.fromCharCode(s.which);
        }
        return null;
      case "compositionend":
        return Al && s.locale !== "ko" ? null : s.data;
      default:
        return null;
    }
  }
  var No = {
    color: !0,
    date: !0,
    datetime: !0,
    "datetime-local": !0,
    email: !0,
    month: !0,
    number: !0,
    password: !0,
    range: !0,
    search: !0,
    tel: !0,
    text: !0,
    time: !0,
    url: !0,
    week: !0
  };
  function Rl(i) {
    var s = i && i.nodeName && i.nodeName.toLowerCase();
    return s === "input" ? !!No[i.type] : s === "textarea";
  }
  function Su(i, s, u, y) {
    cs ? zn ? zn.push(y) : zn = [y] : cs = y, s = Nf(s, "onChange"), 0 < s.length && (u = new gu(
      "onChange",
      "change",
      null,
      u,
      y
    ), i.push({ event: u, listeners: s }));
  }
  var jo = null, Ol = null;
  function um(i) {
    X0(i, 0);
  }
  function Cu(i) {
    var s = Yr(i);
    if (ls(s)) return i;
  }
  function zl(i, s) {
    if (i === "change") return s;
  }
  var Pr = !1;
  if (Ar) {
    var In;
    if (Ar) {
      var To = "oninput" in document;
      if (!To) {
        var qr = document.createElement("div");
        qr.setAttribute("oninput", "return;"), To = typeof qr.oninput == "function";
      }
      In = To;
    } else In = !1;
    Pr = In && (!document.documentMode || 9 < document.documentMode);
  }
  function Dc() {
    jo && (jo.detachEvent("onpropertychange", Bi), Ol = jo = null);
  }
  function Bi(i) {
    if (i.propertyName === "value" && Cu(Ol)) {
      var s = [];
      Su(
        s,
        Ol,
        i,
        mu(i)
      ), _o(um, s);
    }
  }
  function Dl(i, s, u) {
    i === "focusin" ? (Dc(), jo = s, Ol = u, jo.attachEvent("onpropertychange", Bi)) : i === "focusout" && Dc();
  }
  function Fs(i) {
    if (i === "selectionchange" || i === "keyup" || i === "keydown")
      return Cu(Ol);
  }
  function Ic(i, s) {
    if (i === "click") return Cu(s);
  }
  function Ao(i, s) {
    if (i === "input" || i === "change")
      return Cu(s);
  }
  function oi(i, s) {
    return i === s && (i !== 0 || 1 / i === 1 / s) || i !== i && s !== s;
  }
  var An = typeof Object.is == "function" ? Object.is : oi;
  function w(i, s) {
    if (An(i, s)) return !0;
    if (typeof i != "object" || i === null || typeof s != "object" || s === null)
      return !1;
    var u = Object.keys(i), y = Object.keys(s);
    if (u.length !== y.length) return !1;
    for (y = 0; y < u.length; y++) {
      var _ = u[y];
      if (!Mn.call(s, _) || !An(i[_], s[_]))
        return !1;
    }
    return !0;
  }
  function E(i) {
    for (; i && i.firstChild; ) i = i.firstChild;
    return i;
  }
  function M(i, s) {
    var u = E(i);
    i = 0;
    for (var y; u; ) {
      if (u.nodeType === 3) {
        if (y = i + u.textContent.length, i <= s && y >= s)
          return { node: u, offset: s - i };
        i = y;
      }
      e: {
        for (; u; ) {
          if (u.nextSibling) {
            u = u.nextSibling;
            break e;
          }
          u = u.parentNode;
        }
        u = void 0;
      }
      u = E(u);
    }
  }
  function I(i, s) {
    return i && s ? i === s ? !0 : i && i.nodeType === 3 ? !1 : s && s.nodeType === 3 ? I(i, s.parentNode) : "contains" in i ? i.contains(s) : i.compareDocumentPosition ? !!(i.compareDocumentPosition(s) & 16) : !1 : !1;
  }
  function B(i) {
    i = i != null && i.ownerDocument != null && i.ownerDocument.defaultView != null ? i.ownerDocument.defaultView : window;
    for (var s = Zt(i.document); s instanceof i.HTMLIFrameElement; ) {
      try {
        var u = typeof s.contentWindow.location.href == "string";
      } catch {
        u = !1;
      }
      if (u) i = s.contentWindow;
      else break;
      s = Zt(i.document);
    }
    return s;
  }
  function W(i) {
    var s = i && i.nodeName && i.nodeName.toLowerCase();
    return s && (s === "input" && (i.type === "text" || i.type === "search" || i.type === "tel" || i.type === "url" || i.type === "password") || s === "textarea" || i.contentEditable === "true");
  }
  var oe = Ar && "documentMode" in document && 11 >= document.documentMode, F = null, ne = null, te = null, me = !1;
  function ce(i, s, u) {
    var y = u.window === u ? u.document : u.nodeType === 9 ? u : u.ownerDocument;
    me || F == null || F !== Zt(y) || (y = F, "selectionStart" in y && W(y) ? y = { start: y.selectionStart, end: y.selectionEnd } : (y = (y.ownerDocument && y.ownerDocument.defaultView || window).getSelection(), y = {
      anchorNode: y.anchorNode,
      anchorOffset: y.anchorOffset,
      focusNode: y.focusNode,
      focusOffset: y.focusOffset
    }), te && w(te, y) || (te = y, y = Nf(ne, "onSelect"), 0 < y.length && (s = new gu(
      "onSelect",
      "select",
      null,
      s,
      u
    ), i.push({ event: s, listeners: y }), s.target = F)));
  }
  function _e(i, s) {
    var u = {};
    return u[i.toLowerCase()] = s.toLowerCase(), u["Webkit" + i] = "webkit" + s, u["Moz" + i] = "moz" + s, u;
  }
  var be = {
    animationend: _e("Animation", "AnimationEnd"),
    animationiteration: _e("Animation", "AnimationIteration"),
    animationstart: _e("Animation", "AnimationStart"),
    transitionrun: _e("Transition", "TransitionRun"),
    transitionstart: _e("Transition", "TransitionStart"),
    transitioncancel: _e("Transition", "TransitionCancel"),
    transitionend: _e("Transition", "TransitionEnd")
  }, we = {}, ke = {};
  Ar && (ke = document.createElement("div").style, "AnimationEvent" in window || (delete be.animationend.animation, delete be.animationiteration.animation, delete be.animationstart.animation), "TransitionEvent" in window || delete be.transitionend.transition);
  function Ne(i) {
    if (we[i]) return we[i];
    if (!be[i]) return i;
    var s = be[i], u;
    for (u in s)
      if (s.hasOwnProperty(u) && u in ke)
        return we[i] = s[u];
    return i;
  }
  var Te = Ne("animationend"), Ie = Ne("animationiteration"), $e = Ne("animationstart"), Ve = Ne("transitionrun"), rt = Ne("transitionstart"), lt = Ne("transitioncancel"), Ge = Ne("transitionend"), st = /* @__PURE__ */ new Map(), ut = "abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(
    " "
  );
  ut.push("scrollEnd");
  function tt(i, s) {
    st.set(i, s), gi(s, [i]);
  }
  var ht = typeof reportError == "function" ? reportError : function(i) {
    if (typeof window == "object" && typeof window.ErrorEvent == "function") {
      var s = new window.ErrorEvent("error", {
        bubbles: !0,
        cancelable: !0,
        message: typeof i == "object" && i !== null && typeof i.message == "string" ? String(i.message) : String(i),
        error: i
      });
      if (!window.dispatchEvent(s)) return;
    } else if (typeof process == "object" && typeof process.emit == "function") {
      process.emit("uncaughtException", i);
      return;
    }
    console.error(i);
  }, _t = [], Rt = 0, Ot = 0;
  function Ln() {
    for (var i = Rt, s = Ot = Rt = 0; s < i; ) {
      var u = _t[s];
      _t[s++] = null;
      var y = _t[s];
      _t[s++] = null;
      var _ = _t[s];
      _t[s++] = null;
      var k = _t[s];
      if (_t[s++] = null, y !== null && _ !== null) {
        var L = y.pending;
        L === null ? _.next = _ : (_.next = L.next, L.next = _), y.pending = _;
      }
      k !== 0 && Mo(u, _, k);
    }
  }
  function Et(i, s, u, y) {
    _t[Rt++] = i, _t[Rt++] = s, _t[Rt++] = u, _t[Rt++] = y, Ot |= y, i.lanes |= y, i = i.alternate, i !== null && (i.lanes |= y);
  }
  function fr(i, s, u, y) {
    return Et(i, s, u, y), dr(i);
  }
  function Nn(i, s) {
    return Et(i, null, null, s), dr(i);
  }
  function Mo(i, s, u) {
    i.lanes |= u;
    var y = i.alternate;
    y !== null && (y.lanes |= u);
    for (var _ = !1, k = i.return; k !== null; )
      k.childLanes |= u, y = k.alternate, y !== null && (y.childLanes |= u), k.tag === 22 && (i = k.stateNode, i === null || i._visibility & 1 || (_ = !0)), i = k, k = k.return;
    return i.tag === 3 ? (k = i.stateNode, _ && s !== null && (_ = 31 - it(u), i = k.hiddenUpdates, y = i[_], y === null ? i[_] = [s] : y.push(s), s.lane = u | 536870912), k) : null;
  }
  function dr(i) {
    if (50 < bf)
      throw bf = 0, lp = null, Error(r(185));
    for (var s = i.return; s !== null; )
      i = s, s = i.return;
    return i.tag === 3 ? i.stateNode : null;
  }
  var Br = {};
  function Eu(i, s, u, y) {
    this.tag = i, this.key = u, this.sibling = this.child = this.return = this.stateNode = this.type = this.elementType = null, this.index = 0, this.refCleanup = this.ref = null, this.pendingProps = s, this.dependencies = this.memoizedState = this.updateQueue = this.memoizedProps = null, this.mode = y, this.subtreeFlags = this.flags = 0, this.deletions = null, this.childLanes = this.lanes = 0, this.alternate = null;
  }
  function Fr(i, s, u, y) {
    return new Eu(i, s, u, y);
  }
  function Us(i) {
    return i = i.prototype, !(!i || !i.isReactComponent);
  }
  function pa(i, s) {
    var u = i.alternate;
    return u === null ? (u = Fr(
      i.tag,
      s,
      i.key,
      i.mode
    ), u.elementType = i.elementType, u.type = i.type, u.stateNode = i.stateNode, u.alternate = i, i.alternate = u) : (u.pendingProps = s, u.type = i.type, u.flags = 0, u.subtreeFlags = 0, u.deletions = null), u.flags = i.flags & 65011712, u.childLanes = i.childLanes, u.lanes = i.lanes, u.child = i.child, u.memoizedProps = i.memoizedProps, u.memoizedState = i.memoizedState, u.updateQueue = i.updateQueue, s = i.dependencies, u.dependencies = s === null ? null : { lanes: s.lanes, firstContext: s.firstContext }, u.sibling = i.sibling, u.index = i.index, u.ref = i.ref, u.refCleanup = i.refCleanup, u;
  }
  function Gg(i, s) {
    i.flags &= 65011714;
    var u = i.alternate;
    return u === null ? (i.childLanes = 0, i.lanes = s, i.child = null, i.subtreeFlags = 0, i.memoizedProps = null, i.memoizedState = null, i.updateQueue = null, i.dependencies = null, i.stateNode = null) : (i.childLanes = u.childLanes, i.lanes = u.lanes, i.child = u.child, i.subtreeFlags = 0, i.deletions = null, i.memoizedProps = u.memoizedProps, i.memoizedState = u.memoizedState, i.updateQueue = u.updateQueue, i.type = u.type, s = u.dependencies, i.dependencies = s === null ? null : {
      lanes: s.lanes,
      firstContext: s.firstContext
    }), i;
  }
  function bd(i, s, u, y, _, k) {
    var L = 0;
    if (y = i, typeof i == "function") Us(i) && (L = 1);
    else if (typeof i == "string")
      L = tx(
        i,
        u,
        le.current
      ) ? 26 : i === "html" || i === "head" || i === "body" ? 27 : 5;
    else
      e: switch (i) {
        case ie:
          return i = Fr(31, u, s, _), i.elementType = ie, i.lanes = k, i;
        case N:
          return Il(u.children, _, k, s);
        case T:
          L = 8, _ |= 24;
          break;
        case j:
          return i = Fr(12, u, s, _ | 2), i.elementType = j, i.lanes = k, i;
        case q:
          return i = Fr(13, u, s, _), i.elementType = q, i.lanes = k, i;
        case D:
          return i = Fr(19, u, s, _), i.elementType = D, i.lanes = k, i;
        default:
          if (typeof i == "object" && i !== null)
            switch (i.$$typeof) {
              case A:
                L = 10;
                break e;
              case R:
                L = 9;
                break e;
              case z:
                L = 11;
                break e;
              case P:
                L = 14;
                break e;
              case re:
                L = 16, y = null;
                break e;
            }
          L = 29, u = Error(
            r(130, i === null ? "null" : typeof i, "")
          ), y = null;
      }
    return s = Fr(L, u, s, _), s.elementType = i, s.type = y, s.lanes = k, s;
  }
  function Il(i, s, u, y) {
    return i = Fr(7, i, y, s), i.lanes = u, i;
  }
  function ku(i, s, u) {
    return i = Fr(6, i, null, s), i.lanes = u, i;
  }
  function Lc(i) {
    var s = Fr(18, null, null, 0);
    return s.stateNode = i, s;
  }
  function Pc(i, s, u) {
    return s = Fr(
      4,
      i.children !== null ? i.children : [],
      i.key,
      s
    ), s.lanes = u, s.stateNode = {
      containerInfo: i.containerInfo,
      pendingChildren: null,
      implementation: i.implementation
    }, s;
  }
  var Vg = /* @__PURE__ */ new WeakMap();
  function Fi(i, s) {
    if (typeof i == "object" && i !== null) {
      var u = Vg.get(i);
      return u !== void 0 ? u : (s = {
        value: i,
        source: s,
        stack: Yn(s)
      }, Vg.set(i, s), s);
    }
    return {
      value: i,
      source: s,
      stack: Yn(s)
    };
  }
  var Nu = [], ju = 0, tr = null, xr = 0, ga = [], ya = 0, $s = null, ms = 1, va = "";
  function Ui(i, s) {
    Nu[ju++] = xr, Nu[ju++] = tr, tr = i, xr = s;
  }
  function wd(i, s, u) {
    ga[ya++] = ms, ga[ya++] = va, ga[ya++] = $s, $s = i;
    var y = ms;
    i = va;
    var _ = 32 - it(y) - 1;
    y &= ~(1 << _), u += 1;
    var k = 32 - it(s) + _;
    if (30 < k) {
      var L = _ - _ % 5;
      k = (y & (1 << L) - 1).toString(32), y >>= L, _ -= L, ms = 1 << 32 - it(s) + _ | u << _ | y, va = k + i;
    } else
      ms = 1 << k | u << _ | y, va = i;
  }
  function Ro(i) {
    i.return !== null && (Ui(i, 1), wd(i, 1, 0));
  }
  function Ll(i) {
    for (; i === tr; )
      tr = Nu[--ju], Nu[ju] = null, xr = Nu[--ju], Nu[ju] = null;
    for (; i === $s; )
      $s = ga[--ya], ga[ya] = null, va = ga[--ya], ga[ya] = null, ms = ga[--ya], ga[ya] = null;
  }
  function Tu(i, s) {
    ga[ya++] = ms, ga[ya++] = va, ga[ya++] = $s, ms = s.id, va = s.overflow, $s = i;
  }
  var br = null, pn = null, Jt = !1, Oo = null, xa = !1, cm = Error(r(519));
  function zo(i) {
    var s = Error(
      r(
        418,
        1 < arguments.length && arguments[1] !== void 0 && arguments[1] ? "text" : "HTML",
        ""
      )
    );
    throw Io(Fi(s, i)), cm;
  }
  function qc(i) {
    var s = i.stateNode, u = i.type, y = i.memoizedProps;
    switch (s[bn] = i, s[Xn] = y, u) {
      case "dialog":
        Vt("cancel", s), Vt("close", s);
        break;
      case "iframe":
      case "object":
      case "embed":
        Vt("load", s);
        break;
      case "video":
      case "audio":
        for (u = 0; u < kf.length; u++)
          Vt(kf[u], s);
        break;
      case "source":
        Vt("error", s);
        break;
      case "img":
      case "image":
      case "link":
        Vt("error", s), Vt("load", s);
        break;
      case "details":
        Vt("toggle", s);
        break;
      case "input":
        Vt("invalid", s), us(
          s,
          y.value,
          y.defaultValue,
          y.checked,
          y.defaultChecked,
          y.type,
          y.name,
          !0
        );
        break;
      case "select":
        Vt("invalid", s);
        break;
      case "textarea":
        Vt("invalid", s), Ds(s, y.value, y.defaultValue, y.children);
    }
    u = y.children, typeof u != "string" && typeof u != "number" && typeof u != "bigint" || s.textContent === "" + u || y.suppressHydrationWarning === !0 || J0(s.textContent, u) ? (y.popover != null && (Vt("beforetoggle", s), Vt("toggle", s)), y.onScroll != null && Vt("scroll", s), y.onScrollEnd != null && Vt("scrollend", s), y.onClick != null && (s.onclick = vi), s = !0) : s = !1, s || zo(i, !0);
  }
  function Au(i) {
    for (br = i.return; br; )
      switch (br.tag) {
        case 5:
        case 31:
        case 13:
          xa = !1;
          return;
        case 27:
        case 3:
          xa = !0;
          return;
        default:
          br = br.return;
      }
  }
  function Pl(i) {
    if (i !== br) return !1;
    if (!Jt) return Au(i), Jt = !0, !1;
    var s = i.tag, u;
    if ((u = s !== 3 && s !== 27) && ((u = s === 5) && (u = i.type, u = !(u !== "form" && u !== "button") || Zo(i.type, i.memoizedProps)), u = !u), u && pn && zo(i), Au(i), s === 13) {
      if (i = i.memoizedState, i = i !== null ? i.dehydrated : null, !i) throw Error(r(317));
      pn = iy(i);
    } else if (s === 31) {
      if (i = i.memoizedState, i = i !== null ? i.dehydrated : null, !i) throw Error(r(317));
      pn = iy(i);
    } else
      s === 27 ? (s = pn, Tt(i.type) ? (i = jp, jp = null, pn = i) : pn = s) : pn = br ? ka(i.stateNode.nextSibling) : null;
    return !0;
  }
  function ee() {
    pn = br = null, Jt = !1;
  }
  function Do() {
    var i = Oo;
    return i !== null && (Ei === null ? Ei = i : Ei.push.apply(
      Ei,
      i
    ), Oo = null), i;
  }
  function Io(i) {
    Oo === null ? Oo = [i] : Oo.push(i);
  }
  var xi = U(null), Lt = null, Hs = null;
  function Lo(i, s, u) {
    Y(xi, s._currentValue), s._currentValue = u;
  }
  function Gs(i) {
    i._currentValue = xi.current, ue(xi);
  }
  function Vs(i, s, u) {
    for (; i !== null; ) {
      var y = i.alternate;
      if ((i.childLanes & s) !== s ? (i.childLanes |= s, y !== null && (y.childLanes |= s)) : y !== null && (y.childLanes & s) !== s && (y.childLanes |= s), i === u) break;
      i = i.return;
    }
  }
  function fm(i, s, u, y) {
    var _ = i.child;
    for (_ !== null && (_.return = i); _ !== null; ) {
      var k = _.dependencies;
      if (k !== null) {
        var L = _.child;
        k = k.firstContext;
        e: for (; k !== null; ) {
          var J = k;
          k = _;
          for (var ve = 0; ve < s.length; ve++)
            if (J.context === s[ve]) {
              k.lanes |= u, J = k.alternate, J !== null && (J.lanes |= u), Vs(
                k.return,
                u,
                i
              ), y || (L = null);
              break e;
            }
          k = J.next;
        }
      } else if (_.tag === 18) {
        if (L = _.return, L === null) throw Error(r(341));
        L.lanes |= u, k = L.alternate, k !== null && (k.lanes |= u), Vs(L, u, i), L = null;
      } else L = _.child;
      if (L !== null) L.return = _;
      else
        for (L = _; L !== null; ) {
          if (L === i) {
            L = null;
            break;
          }
          if (_ = L.sibling, _ !== null) {
            _.return = L.return, L = _;
            break;
          }
          L = L.return;
        }
      _ = L;
    }
  }
  function Mu(i, s, u, y) {
    i = null;
    for (var _ = s, k = !1; _ !== null; ) {
      if (!k) {
        if ((_.flags & 524288) !== 0) k = !0;
        else if ((_.flags & 262144) !== 0) break;
      }
      if (_.tag === 10) {
        var L = _.alternate;
        if (L === null) throw Error(r(387));
        if (L = L.memoizedProps, L !== null) {
          var J = _.type;
          An(_.pendingProps.value, L.value) || (i !== null ? i.push(J) : i = [J]);
        }
      } else if (_ === Oe.current) {
        if (L = _.alternate, L === null) throw Error(r(387));
        L.memoizedState.memoizedState !== _.memoizedState.memoizedState && (i !== null ? i.push(lc) : i = [lc]);
      }
      _ = _.return;
    }
    i !== null && fm(
      s,
      i,
      u,
      y
    ), s.flags |= 262144;
  }
  function _d(i) {
    for (i = i.firstContext; i !== null; ) {
      if (!An(
        i.context._currentValue,
        i.memoizedValue
      ))
        return !0;
      i = i.next;
    }
    return !1;
  }
  function ql(i) {
    Lt = i, Hs = null, i = i.dependencies, i !== null && (i.firstContext = null);
  }
  function Ur(i) {
    return Kg(Lt, i);
  }
  function ba(i, s) {
    return Lt === null && ql(i), Kg(i, s);
  }
  function Kg(i, s) {
    var u = s._currentValue;
    if (s = { context: s, memoizedValue: u, next: null }, Hs === null) {
      if (i === null) throw Error(r(308));
      Hs = s, i.dependencies = { lanes: 0, firstContext: s }, i.flags |= 524288;
    } else Hs = Hs.next = s;
    return u;
  }
  var wv = typeof AbortController < "u" ? AbortController : function() {
    var i = [], s = this.signal = {
      aborted: !1,
      addEventListener: function(u, y) {
        i.push(y);
      }
    };
    this.abort = function() {
      s.aborted = !0, i.forEach(function(u) {
        return u();
      });
    };
  }, _v = e.unstable_scheduleCallback, Sv = e.unstable_NormalPriority, wr = {
    $$typeof: A,
    Consumer: null,
    Provider: null,
    _currentValue: null,
    _currentValue2: null,
    _threadCount: 0
  };
  function Ba() {
    return {
      controller: new wv(),
      data: /* @__PURE__ */ new Map(),
      refCount: 0
    };
  }
  function Bc(i) {
    i.refCount--, i.refCount === 0 && _v(Sv, function() {
      i.controller.abort();
    });
  }
  var Fc = null, dm = 0, Ru = 0, Ou = null;
  function Bl(i, s) {
    if (Fc === null) {
      var u = Fc = [];
      dm = 0, Ru = Qi(), Ou = {
        status: "pending",
        value: void 0,
        then: function(y) {
          u.push(y);
        }
      };
    }
    return dm++, s.then(Yg, Yg), s;
  }
  function Yg() {
    if (--dm === 0 && Fc !== null) {
      Ou !== null && (Ou.status = "fulfilled");
      var i = Fc;
      Fc = null, Ru = 0, Ou = null;
      for (var s = 0; s < i.length; s++) (0, i[s])();
    }
  }
  function Cv(i, s) {
    var u = [], y = {
      status: "pending",
      value: null,
      reason: null,
      then: function(_) {
        u.push(_);
      }
    };
    return i.then(
      function() {
        y.status = "fulfilled", y.value = s;
        for (var _ = 0; _ < u.length; _++) (0, u[_])(s);
      },
      function(_) {
        for (y.status = "rejected", y.reason = _, _ = 0; _ < u.length; _++)
          (0, u[_])(void 0);
      }
    ), y;
  }
  var wa = Z.S;
  Z.S = function(i, s) {
    R0 = Cn(), typeof s == "object" && s !== null && typeof s.then == "function" && Bl(i, s), wa !== null && wa(i, s);
  };
  var Fl = U(null);
  function hm() {
    var i = Fl.current;
    return i !== null ? i : Tn.pooledCache;
  }
  function Sd(i, s) {
    s === null ? Y(Fl, Fl.current) : Y(Fl, s.pool);
  }
  function Wg() {
    var i = hm();
    return i === null ? null : { parent: wr._currentValue, pool: i };
  }
  var zu = Error(r(460)), Cd = Error(r(474)), Uc = Error(r(542)), Ed = { then: function() {
  } };
  function Xg(i) {
    return i = i.status, i === "fulfilled" || i === "rejected";
  }
  function kd(i, s, u) {
    switch (u = i[u], u === void 0 ? i.push(s) : u !== s && (s.then(vi, vi), s = u), s.status) {
      case "fulfilled":
        return s.value;
      case "rejected":
        throw i = s.reason, mm(i), i;
      default:
        if (typeof s.status == "string") s.then(vi, vi);
        else {
          if (i = Tn, i !== null && 100 < i.shellSuspendCounter)
            throw Error(r(482));
          i = s, i.status = "pending", i.then(
            function(y) {
              if (s.status === "pending") {
                var _ = s;
                _.status = "fulfilled", _.value = y;
              }
            },
            function(y) {
              if (s.status === "pending") {
                var _ = s;
                _.status = "rejected", _.reason = y;
              }
            }
          );
        }
        switch (s.status) {
          case "fulfilled":
            return s.value;
          case "rejected":
            throw i = s.reason, mm(i), i;
        }
        throw ps = s, zu;
    }
  }
  function Fa(i) {
    try {
      var s = i._init;
      return s(i._payload);
    } catch (u) {
      throw u !== null && typeof u == "object" && typeof u.then == "function" ? (ps = u, zu) : u;
    }
  }
  var ps = null;
  function Qg() {
    if (ps === null) throw Error(r(459));
    var i = ps;
    return ps = null, i;
  }
  function mm(i) {
    if (i === zu || i === Uc)
      throw Error(r(483));
  }
  var Du = null, $i = 0;
  function Iu(i) {
    var s = $i;
    return $i += 1, Du === null && (Du = []), kd(Du, i, s);
  }
  function Ua(i, s) {
    s = s.props.ref, i.ref = s !== void 0 ? s : null;
  }
  function li(i, s) {
    throw s.$$typeof === x ? Error(r(525)) : (i = Object.prototype.toString.call(s), Error(
      r(
        31,
        i === "[object Object]" ? "object with keys {" + Object.keys(s).join(", ") + "}" : i
      )
    ));
  }
  function Zg(i) {
    function s(je, Ee) {
      if (i) {
        var ze = je.deletions;
        ze === null ? (je.deletions = [Ee], je.flags |= 16) : ze.push(Ee);
      }
    }
    function u(je, Ee) {
      if (!i) return null;
      for (; Ee !== null; )
        s(je, Ee), Ee = Ee.sibling;
      return null;
    }
    function y(je) {
      for (var Ee = /* @__PURE__ */ new Map(); je !== null; )
        je.key !== null ? Ee.set(je.key, je) : Ee.set(je.index, je), je = je.sibling;
      return Ee;
    }
    function _(je, Ee) {
      return je = pa(je, Ee), je.index = 0, je.sibling = null, je;
    }
    function k(je, Ee, ze) {
      return je.index = ze, i ? (ze = je.alternate, ze !== null ? (ze = ze.index, ze < Ee ? (je.flags |= 67108866, Ee) : ze) : (je.flags |= 67108866, Ee)) : (je.flags |= 1048576, Ee);
    }
    function L(je) {
      return i && je.alternate === null && (je.flags |= 67108866), je;
    }
    function J(je, Ee, ze, Ke) {
      return Ee === null || Ee.tag !== 6 ? (Ee = ku(ze, je.mode, Ke), Ee.return = je, Ee) : (Ee = _(Ee, ze), Ee.return = je, Ee);
    }
    function ve(je, Ee, ze, Ke) {
      var St = ze.type;
      return St === N ? He(
        je,
        Ee,
        ze.props.children,
        Ke,
        ze.key
      ) : Ee !== null && (Ee.elementType === St || typeof St == "object" && St !== null && St.$$typeof === re && Fa(St) === Ee.type) ? (Ee = _(Ee, ze.props), Ua(Ee, ze), Ee.return = je, Ee) : (Ee = bd(
        ze.type,
        ze.key,
        ze.props,
        null,
        je.mode,
        Ke
      ), Ua(Ee, ze), Ee.return = je, Ee);
    }
    function De(je, Ee, ze, Ke) {
      return Ee === null || Ee.tag !== 4 || Ee.stateNode.containerInfo !== ze.containerInfo || Ee.stateNode.implementation !== ze.implementation ? (Ee = Pc(ze, je.mode, Ke), Ee.return = je, Ee) : (Ee = _(Ee, ze.children || []), Ee.return = je, Ee);
    }
    function He(je, Ee, ze, Ke, St) {
      return Ee === null || Ee.tag !== 7 ? (Ee = Il(
        ze,
        je.mode,
        Ke,
        St
      ), Ee.return = je, Ee) : (Ee = _(Ee, ze), Ee.return = je, Ee);
    }
    function Ye(je, Ee, ze) {
      if (typeof Ee == "string" && Ee !== "" || typeof Ee == "number" || typeof Ee == "bigint")
        return Ee = ku(
          "" + Ee,
          je.mode,
          ze
        ), Ee.return = je, Ee;
      if (typeof Ee == "object" && Ee !== null) {
        switch (Ee.$$typeof) {
          case b:
            return ze = bd(
              Ee.type,
              Ee.key,
              Ee.props,
              null,
              je.mode,
              ze
            ), Ua(ze, Ee), ze.return = je, ze;
          case C:
            return Ee = Pc(
              Ee,
              je.mode,
              ze
            ), Ee.return = je, Ee;
          case re:
            return Ee = Fa(Ee), Ye(je, Ee, ze);
        }
        if (se(Ee) || V(Ee))
          return Ee = Il(
            Ee,
            je.mode,
            ze,
            null
          ), Ee.return = je, Ee;
        if (typeof Ee.then == "function")
          return Ye(je, Iu(Ee), ze);
        if (Ee.$$typeof === A)
          return Ye(
            je,
            ba(je, Ee),
            ze
          );
        li(je, Ee);
      }
      return null;
    }
    function Le(je, Ee, ze, Ke) {
      var St = Ee !== null ? Ee.key : null;
      if (typeof ze == "string" && ze !== "" || typeof ze == "number" || typeof ze == "bigint")
        return St !== null ? null : J(je, Ee, "" + ze, Ke);
      if (typeof ze == "object" && ze !== null) {
        switch (ze.$$typeof) {
          case b:
            return ze.key === St ? ve(je, Ee, ze, Ke) : null;
          case C:
            return ze.key === St ? De(je, Ee, ze, Ke) : null;
          case re:
            return ze = Fa(ze), Le(je, Ee, ze, Ke);
        }
        if (se(ze) || V(ze))
          return St !== null ? null : He(je, Ee, ze, Ke, null);
        if (typeof ze.then == "function")
          return Le(
            je,
            Ee,
            Iu(ze),
            Ke
          );
        if (ze.$$typeof === A)
          return Le(
            je,
            Ee,
            ba(je, ze),
            Ke
          );
        li(je, ze);
      }
      return null;
    }
    function Fe(je, Ee, ze, Ke, St) {
      if (typeof Ke == "string" && Ke !== "" || typeof Ke == "number" || typeof Ke == "bigint")
        return je = je.get(ze) || null, J(Ee, je, "" + Ke, St);
      if (typeof Ke == "object" && Ke !== null) {
        switch (Ke.$$typeof) {
          case b:
            return je = je.get(
              Ke.key === null ? ze : Ke.key
            ) || null, ve(Ee, je, Ke, St);
          case C:
            return je = je.get(
              Ke.key === null ? ze : Ke.key
            ) || null, De(Ee, je, Ke, St);
          case re:
            return Ke = Fa(Ke), Fe(
              je,
              Ee,
              ze,
              Ke,
              St
            );
        }
        if (se(Ke) || V(Ke))
          return je = je.get(ze) || null, He(Ee, je, Ke, St, null);
        if (typeof Ke.then == "function")
          return Fe(
            je,
            Ee,
            ze,
            Iu(Ke),
            St
          );
        if (Ke.$$typeof === A)
          return Fe(
            je,
            Ee,
            ze,
            ba(Ee, Ke),
            St
          );
        li(Ee, Ke);
      }
      return null;
    }
    function yt(je, Ee, ze, Ke) {
      for (var St = null, cn = null, xt = Ee, Ft = Ee = 0, Xt = null; xt !== null && Ft < ze.length; Ft++) {
        xt.index > Ft ? (Xt = xt, xt = null) : Xt = xt.sibling;
        var fn = Le(
          je,
          xt,
          ze[Ft],
          Ke
        );
        if (fn === null) {
          xt === null && (xt = Xt);
          break;
        }
        i && xt && fn.alternate === null && s(je, xt), Ee = k(fn, Ee, Ft), cn === null ? St = fn : cn.sibling = fn, cn = fn, xt = Xt;
      }
      if (Ft === ze.length)
        return u(je, xt), Jt && Ui(je, Ft), St;
      if (xt === null) {
        for (; Ft < ze.length; Ft++)
          xt = Ye(je, ze[Ft], Ke), xt !== null && (Ee = k(
            xt,
            Ee,
            Ft
          ), cn === null ? St = xt : cn.sibling = xt, cn = xt);
        return Jt && Ui(je, Ft), St;
      }
      for (xt = y(xt); Ft < ze.length; Ft++)
        Xt = Fe(
          xt,
          je,
          Ft,
          ze[Ft],
          Ke
        ), Xt !== null && (i && Xt.alternate !== null && xt.delete(
          Xt.key === null ? Ft : Xt.key
        ), Ee = k(
          Xt,
          Ee,
          Ft
        ), cn === null ? St = Xt : cn.sibling = Xt, cn = Xt);
      return i && xt.forEach(function(il) {
        return s(je, il);
      }), Jt && Ui(je, Ft), St;
    }
    function kt(je, Ee, ze, Ke) {
      if (ze == null) throw Error(r(151));
      for (var St = null, cn = null, xt = Ee, Ft = Ee = 0, Xt = null, fn = ze.next(); xt !== null && !fn.done; Ft++, fn = ze.next()) {
        xt.index > Ft ? (Xt = xt, xt = null) : Xt = xt.sibling;
        var il = Le(je, xt, fn.value, Ke);
        if (il === null) {
          xt === null && (xt = Xt);
          break;
        }
        i && xt && il.alternate === null && s(je, xt), Ee = k(il, Ee, Ft), cn === null ? St = il : cn.sibling = il, cn = il, xt = Xt;
      }
      if (fn.done)
        return u(je, xt), Jt && Ui(je, Ft), St;
      if (xt === null) {
        for (; !fn.done; Ft++, fn = ze.next())
          fn = Ye(je, fn.value, Ke), fn !== null && (Ee = k(fn, Ee, Ft), cn === null ? St = fn : cn.sibling = fn, cn = fn);
        return Jt && Ui(je, Ft), St;
      }
      for (xt = y(xt); !fn.done; Ft++, fn = ze.next())
        fn = Fe(xt, je, Ft, fn.value, Ke), fn !== null && (i && fn.alternate !== null && xt.delete(fn.key === null ? Ft : fn.key), Ee = k(fn, Ee, Ft), cn === null ? St = fn : cn.sibling = fn, cn = fn);
      return i && xt.forEach(function(ux) {
        return s(je, ux);
      }), Jt && Ui(je, Ft), St;
    }
    function Sn(je, Ee, ze, Ke) {
      if (typeof ze == "object" && ze !== null && ze.type === N && ze.key === null && (ze = ze.props.children), typeof ze == "object" && ze !== null) {
        switch (ze.$$typeof) {
          case b:
            e: {
              for (var St = ze.key; Ee !== null; ) {
                if (Ee.key === St) {
                  if (St = ze.type, St === N) {
                    if (Ee.tag === 7) {
                      u(
                        je,
                        Ee.sibling
                      ), Ke = _(
                        Ee,
                        ze.props.children
                      ), Ke.return = je, je = Ke;
                      break e;
                    }
                  } else if (Ee.elementType === St || typeof St == "object" && St !== null && St.$$typeof === re && Fa(St) === Ee.type) {
                    u(
                      je,
                      Ee.sibling
                    ), Ke = _(Ee, ze.props), Ua(Ke, ze), Ke.return = je, je = Ke;
                    break e;
                  }
                  u(je, Ee);
                  break;
                } else s(je, Ee);
                Ee = Ee.sibling;
              }
              ze.type === N ? (Ke = Il(
                ze.props.children,
                je.mode,
                Ke,
                ze.key
              ), Ke.return = je, je = Ke) : (Ke = bd(
                ze.type,
                ze.key,
                ze.props,
                null,
                je.mode,
                Ke
              ), Ua(Ke, ze), Ke.return = je, je = Ke);
            }
            return L(je);
          case C:
            e: {
              for (St = ze.key; Ee !== null; ) {
                if (Ee.key === St)
                  if (Ee.tag === 4 && Ee.stateNode.containerInfo === ze.containerInfo && Ee.stateNode.implementation === ze.implementation) {
                    u(
                      je,
                      Ee.sibling
                    ), Ke = _(Ee, ze.children || []), Ke.return = je, je = Ke;
                    break e;
                  } else {
                    u(je, Ee);
                    break;
                  }
                else s(je, Ee);
                Ee = Ee.sibling;
              }
              Ke = Pc(ze, je.mode, Ke), Ke.return = je, je = Ke;
            }
            return L(je);
          case re:
            return ze = Fa(ze), Sn(
              je,
              Ee,
              ze,
              Ke
            );
        }
        if (se(ze))
          return yt(
            je,
            Ee,
            ze,
            Ke
          );
        if (V(ze)) {
          if (St = V(ze), typeof St != "function") throw Error(r(150));
          return ze = St.call(ze), kt(
            je,
            Ee,
            ze,
            Ke
          );
        }
        if (typeof ze.then == "function")
          return Sn(
            je,
            Ee,
            Iu(ze),
            Ke
          );
        if (ze.$$typeof === A)
          return Sn(
            je,
            Ee,
            ba(je, ze),
            Ke
          );
        li(je, ze);
      }
      return typeof ze == "string" && ze !== "" || typeof ze == "number" || typeof ze == "bigint" ? (ze = "" + ze, Ee !== null && Ee.tag === 6 ? (u(je, Ee.sibling), Ke = _(Ee, ze), Ke.return = je, je = Ke) : (u(je, Ee), Ke = ku(ze, je.mode, Ke), Ke.return = je, je = Ke), L(je)) : u(je, Ee);
    }
    return function(je, Ee, ze, Ke) {
      try {
        $i = 0;
        var St = Sn(
          je,
          Ee,
          ze,
          Ke
        );
        return Du = null, St;
      } catch (xt) {
        if (xt === zu || xt === Uc) throw xt;
        var cn = Fr(29, xt, null, je.mode);
        return cn.lanes = Ke, cn.return = je, cn;
      } finally {
      }
    };
  }
  var Po = Zg(!0), pm = Zg(!1), _a = !1;
  function gs(i) {
    i.updateQueue = {
      baseState: i.memoizedState,
      firstBaseUpdate: null,
      lastBaseUpdate: null,
      shared: { pending: null, lanes: 0, hiddenCallbacks: null },
      callbacks: null
    };
  }
  function Nd(i, s) {
    i = i.updateQueue, s.updateQueue === i && (s.updateQueue = {
      baseState: i.baseState,
      firstBaseUpdate: i.firstBaseUpdate,
      lastBaseUpdate: i.lastBaseUpdate,
      shared: i.shared,
      callbacks: null
    });
  }
  function qo(i) {
    return { lane: i, tag: 0, payload: null, callback: null, next: null };
  }
  function $a(i, s, u) {
    var y = i.updateQueue;
    if (y === null) return null;
    if (y = y.shared, (hn & 2) !== 0) {
      var _ = y.pending;
      return _ === null ? s.next = s : (s.next = _.next, _.next = s), y.pending = s, s = dr(i), Mo(i, null, u), s;
    }
    return Et(i, y, s, u), dr(i);
  }
  function $c(i, s, u) {
    if (s = s.updateQueue, s !== null && (s = s.shared, (u & 4194048) !== 0)) {
      var y = s.lanes;
      y &= i.pendingLanes, u |= y, s.lanes = u, yn(i, u);
    }
  }
  function jd(i, s) {
    var u = i.updateQueue, y = i.alternate;
    if (y !== null && (y = y.updateQueue, u === y)) {
      var _ = null, k = null;
      if (u = u.firstBaseUpdate, u !== null) {
        do {
          var L = {
            lane: u.lane,
            tag: u.tag,
            payload: u.payload,
            callback: null,
            next: null
          };
          k === null ? _ = k = L : k = k.next = L, u = u.next;
        } while (u !== null);
        k === null ? _ = k = s : k = k.next = s;
      } else _ = k = s;
      u = {
        baseState: y.baseState,
        firstBaseUpdate: _,
        lastBaseUpdate: k,
        shared: y.shared,
        callbacks: y.callbacks
      }, i.updateQueue = u;
      return;
    }
    i = u.lastBaseUpdate, i === null ? u.firstBaseUpdate = s : i.next = s, u.lastBaseUpdate = s;
  }
  var Cr = !1;
  function Ul() {
    if (Cr) {
      var i = Ou;
      if (i !== null) throw i;
    }
  }
  function Lu(i, s, u, y) {
    Cr = !1;
    var _ = i.updateQueue;
    _a = !1;
    var k = _.firstBaseUpdate, L = _.lastBaseUpdate, J = _.shared.pending;
    if (J !== null) {
      _.shared.pending = null;
      var ve = J, De = ve.next;
      ve.next = null, L === null ? k = De : L.next = De, L = ve;
      var He = i.alternate;
      He !== null && (He = He.updateQueue, J = He.lastBaseUpdate, J !== L && (J === null ? He.firstBaseUpdate = De : J.next = De, He.lastBaseUpdate = ve));
    }
    if (k !== null) {
      var Ye = _.baseState;
      L = 0, He = De = ve = null, J = k;
      do {
        var Le = J.lane & -536870913, Fe = Le !== J.lane;
        if (Fe ? (Wt & Le) === Le : (y & Le) === Le) {
          Le !== 0 && Le === Ru && (Cr = !0), He !== null && (He = He.next = {
            lane: 0,
            tag: J.tag,
            payload: J.payload,
            callback: null,
            next: null
          });
          e: {
            var yt = i, kt = J;
            Le = s;
            var Sn = u;
            switch (kt.tag) {
              case 1:
                if (yt = kt.payload, typeof yt == "function") {
                  Ye = yt.call(Sn, Ye, Le);
                  break e;
                }
                Ye = yt;
                break e;
              case 3:
                yt.flags = yt.flags & -65537 | 128;
              case 0:
                if (yt = kt.payload, Le = typeof yt == "function" ? yt.call(Sn, Ye, Le) : yt, Le == null) break e;
                Ye = g({}, Ye, Le);
                break e;
              case 2:
                _a = !0;
            }
          }
          Le = J.callback, Le !== null && (i.flags |= 64, Fe && (i.flags |= 8192), Fe = _.callbacks, Fe === null ? _.callbacks = [Le] : Fe.push(Le));
        } else
          Fe = {
            lane: Le,
            tag: J.tag,
            payload: J.payload,
            callback: J.callback,
            next: null
          }, He === null ? (De = He = Fe, ve = Ye) : He = He.next = Fe, L |= Le;
        if (J = J.next, J === null) {
          if (J = _.shared.pending, J === null)
            break;
          Fe = J, J = Fe.next, Fe.next = null, _.lastBaseUpdate = Fe, _.shared.pending = null;
        }
      } while (!0);
      He === null && (ve = Ye), _.baseState = ve, _.firstBaseUpdate = De, _.lastBaseUpdate = He, k === null && (_.shared.lanes = 0), Ko |= L, i.lanes = L, i.memoizedState = Ye;
    }
  }
  function Ha(i, s) {
    if (typeof i != "function")
      throw Error(r(191, i));
    i.call(s);
  }
  function Td(i, s) {
    var u = i.callbacks;
    if (u !== null)
      for (i.callbacks = null, i = 0; i < u.length; i++)
        Ha(u[i], s);
  }
  var Ks = U(null), ys = U(0);
  function gm(i, s) {
    i = Xa, Y(ys, i), Y(Ks, s), Xa = i | s.baseLanes;
  }
  function $r() {
    Y(ys, Xa), Y(Ks, Ks.current);
  }
  function Hc() {
    Xa = ys.current, ue(Ks), ue(ys);
  }
  var Hi = U(null), Sa = null;
  function Bo(i) {
    var s = i.alternate;
    Y(hr, hr.current & 1), Y(Hi, i), Sa === null && (s === null || Ks.current !== null || s.memoizedState !== null) && (Sa = i);
  }
  function Gc(i) {
    Y(hr, hr.current), Y(Hi, i), Sa === null && (Sa = i);
  }
  function Jg(i) {
    i.tag === 22 ? (Y(hr, hr.current), Y(Hi, i), Sa === null && (Sa = i)) : Ca();
  }
  function Ca() {
    Y(hr, hr.current), Y(Hi, Hi.current);
  }
  function bi(i) {
    ue(Hi), Sa === i && (Sa = null), ue(hr);
  }
  var hr = U(0);
  function Ad(i) {
    for (var s = i; s !== null; ) {
      if (s.tag === 13) {
        var u = s.memoizedState;
        if (u !== null && (u = u.dehydrated, u === null || hh(u) || nc(u)))
          return s;
      } else if (s.tag === 19 && (s.memoizedProps.revealOrder === "forwards" || s.memoizedProps.revealOrder === "backwards" || s.memoizedProps.revealOrder === "unstable_legacy-backwards" || s.memoizedProps.revealOrder === "together")) {
        if ((s.flags & 128) !== 0) return s;
      } else if (s.child !== null) {
        s.child.return = s, s = s.child;
        continue;
      }
      if (s === i) break;
      for (; s.sibling === null; ) {
        if (s.return === null || s.return === i) return null;
        s = s.return;
      }
      s.sibling.return = s.return, s = s.sibling;
    }
    return null;
  }
  var Gi = 0, Pt = null, wn = null, nr = null, Vc = !1, Pu = !1, $l = !1, Md = 0, qu = 0, Fo = null, Ev = 0;
  function Hn() {
    throw Error(r(321));
  }
  function Rd(i, s) {
    if (s === null) return !1;
    for (var u = 0; u < s.length && u < i.length; u++)
      if (!An(i[u], s[u])) return !1;
    return !0;
  }
  function Od(i, s, u, y, _, k) {
    return Gi = k, Pt = s, s.memoizedState = null, s.updateQueue = null, s.lanes = 0, Z.H = i === null || i.memoizedState === null ? c0 : Ud, $l = !1, k = u(y, _), $l = !1, Pu && (k = Kc(
      s,
      u,
      y,
      _
    )), ym(i), k;
  }
  function ym(i) {
    Z.H = $o;
    var s = wn !== null && wn.next !== null;
    if (Gi = 0, nr = wn = Pt = null, Vc = !1, qu = 0, Fo = null, s) throw Error(r(300));
    i === null || Jn || (i = i.dependencies, i !== null && _d(i) && (Jn = !0));
  }
  function Kc(i, s, u, y) {
    Pt = i;
    var _ = 0;
    do {
      if (Pu && (Fo = null), qu = 0, Pu = !1, 25 <= _) throw Error(r(301));
      if (_ += 1, nr = wn = null, i.updateQueue != null) {
        var k = i.updateQueue;
        k.lastEffect = null, k.events = null, k.stores = null, k.memoCache != null && (k.memoCache.index = 0);
      }
      Z.H = tf, k = s(u, y);
    } while (Pu);
    return k;
  }
  function kv() {
    var i = Z.H, s = i.useState()[0];
    return s = typeof s.then == "function" ? Fu(s) : s, i = i.useState()[0], (wn !== null ? wn.memoizedState : null) !== i && (Pt.flags |= 1024), s;
  }
  function zd() {
    var i = Md !== 0;
    return Md = 0, i;
  }
  function Dd(i, s, u) {
    s.updateQueue = i.updateQueue, s.flags &= -2053, i.lanes &= ~u;
  }
  function vm(i) {
    if (Vc) {
      for (i = i.memoizedState; i !== null; ) {
        var s = i.queue;
        s !== null && (s.pending = null), i = i.next;
      }
      Vc = !1;
    }
    Gi = 0, nr = wn = Pt = null, Pu = !1, qu = Md = 0, Fo = null;
  }
  function Jr() {
    var i = {
      memoizedState: null,
      baseState: null,
      baseQueue: null,
      queue: null,
      next: null
    };
    return nr === null ? Pt.memoizedState = nr = i : nr = nr.next = i, nr;
  }
  function mr() {
    if (wn === null) {
      var i = Pt.alternate;
      i = i !== null ? i.memoizedState : null;
    } else i = wn.next;
    var s = nr === null ? Pt.memoizedState : nr.next;
    if (s !== null)
      nr = s, wn = i;
    else {
      if (i === null)
        throw Pt.alternate === null ? Error(r(467)) : Error(r(310));
      wn = i, i = {
        memoizedState: wn.memoizedState,
        baseState: wn.baseState,
        baseQueue: wn.baseQueue,
        queue: wn.queue,
        next: null
      }, nr === null ? Pt.memoizedState = nr = i : nr = nr.next = i;
    }
    return nr;
  }
  function Bu() {
    return { lastEffect: null, events: null, stores: null, memoCache: null };
  }
  function Fu(i) {
    var s = qu;
    return qu += 1, Fo === null && (Fo = []), i = kd(Fo, i, s), s = Pt, (nr === null ? s.memoizedState : nr.next) === null && (s = s.alternate, Z.H = s === null || s.memoizedState === null ? c0 : Ud), i;
  }
  function Uu(i) {
    if (i !== null && typeof i == "object") {
      if (typeof i.then == "function") return Fu(i);
      if (i.$$typeof === A) return Ur(i);
    }
    throw Error(r(438, String(i)));
  }
  function xm(i) {
    var s = null, u = Pt.updateQueue;
    if (u !== null && (s = u.memoCache), s == null) {
      var y = Pt.alternate;
      y !== null && (y = y.updateQueue, y !== null && (y = y.memoCache, y != null && (s = {
        data: y.data.map(function(_) {
          return _.slice();
        }),
        index: 0
      })));
    }
    if (s == null && (s = { data: [], index: 0 }), u === null && (u = Bu(), Pt.updateQueue = u), u.memoCache = s, u = s.data[s.index], u === void 0)
      for (u = s.data[s.index] = Array(i), y = 0; y < i; y++)
        u[y] = X;
    return s.index++, u;
  }
  function Ga(i, s) {
    return typeof s == "function" ? s(i) : s;
  }
  function qt(i) {
    var s = mr();
    return bm(s, wn, i);
  }
  function bm(i, s, u) {
    var y = i.queue;
    if (y === null) throw Error(r(311));
    y.lastRenderedReducer = u;
    var _ = i.baseQueue, k = y.pending;
    if (k !== null) {
      if (_ !== null) {
        var L = _.next;
        _.next = k.next, k.next = L;
      }
      s.baseQueue = _ = k, y.pending = null;
    }
    if (k = i.baseState, _ === null) i.memoizedState = k;
    else {
      s = _.next;
      var J = L = null, ve = null, De = s, He = !1;
      do {
        var Ye = De.lane & -536870913;
        if (Ye !== De.lane ? (Wt & Ye) === Ye : (Gi & Ye) === Ye) {
          var Le = De.revertLane;
          if (Le === 0)
            ve !== null && (ve = ve.next = {
              lane: 0,
              revertLane: 0,
              gesture: null,
              action: De.action,
              hasEagerState: De.hasEagerState,
              eagerState: De.eagerState,
              next: null
            }), Ye === Ru && (He = !0);
          else if ((Gi & Le) === Le) {
            De = De.next, Le === Ru && (He = !0);
            continue;
          } else
            Ye = {
              lane: 0,
              revertLane: De.revertLane,
              gesture: null,
              action: De.action,
              hasEagerState: De.hasEagerState,
              eagerState: De.eagerState,
              next: null
            }, ve === null ? (J = ve = Ye, L = k) : ve = ve.next = Ye, Pt.lanes |= Le, Ko |= Le;
          Ye = De.action, $l && u(k, Ye), k = De.hasEagerState ? De.eagerState : u(k, Ye);
        } else
          Le = {
            lane: Ye,
            revertLane: De.revertLane,
            gesture: De.gesture,
            action: De.action,
            hasEagerState: De.hasEagerState,
            eagerState: De.eagerState,
            next: null
          }, ve === null ? (J = ve = Le, L = k) : ve = ve.next = Le, Pt.lanes |= Ye, Ko |= Ye;
        De = De.next;
      } while (De !== null && De !== s);
      if (ve === null ? L = k : ve.next = J, !An(k, i.memoizedState) && (Jn = !0, He && (u = Ou, u !== null)))
        throw u;
      i.memoizedState = k, i.baseState = L, i.baseQueue = ve, y.lastRenderedState = k;
    }
    return _ === null && (y.lanes = 0), [i.memoizedState, y.dispatch];
  }
  function wm(i) {
    var s = mr(), u = s.queue;
    if (u === null) throw Error(r(311));
    u.lastRenderedReducer = i;
    var y = u.dispatch, _ = u.pending, k = s.memoizedState;
    if (_ !== null) {
      u.pending = null;
      var L = _ = _.next;
      do
        k = i(k, L.action), L = L.next;
      while (L !== _);
      An(k, s.memoizedState) || (Jn = !0), s.memoizedState = k, s.baseQueue === null && (s.baseState = k), u.lastRenderedState = k;
    }
    return [k, y];
  }
  function $u(i, s, u) {
    var y = Pt, _ = mr(), k = Jt;
    if (k) {
      if (u === void 0) throw Error(r(407));
      u = u();
    } else u = s();
    var L = !An(
      (wn || _).memoizedState,
      u
    );
    if (L && (_.memoizedState = u, Jn = !0), _ = _.queue, Qc(t0.bind(null, y, _, i), [
      i
    ]), _.getSnapshot !== s || L || nr !== null && nr.memoizedState.tag & 1) {
      if (y.flags |= 2048, Ki(
        9,
        { destroy: void 0 },
        e0.bind(
          null,
          y,
          _,
          u,
          s
        ),
        null
      ), Tn === null) throw Error(r(349));
      k || (Gi & 127) !== 0 || _m(y, s, u);
    }
    return u;
  }
  function _m(i, s, u) {
    i.flags |= 16384, i = { getSnapshot: s, value: u }, s = Pt.updateQueue, s === null ? (s = Bu(), Pt.updateQueue = s, s.stores = [i]) : (u = s.stores, u === null ? s.stores = [i] : u.push(i));
  }
  function e0(i, s, u, y) {
    s.value = u, s.getSnapshot = y, Vi(s) && n0(i);
  }
  function t0(i, s, u) {
    return u(function() {
      Vi(s) && n0(i);
    });
  }
  function Vi(i) {
    var s = i.getSnapshot;
    i = i.value;
    try {
      var u = s();
      return !An(i, u);
    } catch {
      return !0;
    }
  }
  function n0(i) {
    var s = Nn(i, 2);
    s !== null && ki(s, i, 2);
  }
  function Hu(i) {
    var s = Jr();
    if (typeof i == "function") {
      var u = i;
      if (i = u(), $l) {
        En(!0);
        try {
          u();
        } finally {
          En(!1);
        }
      }
    }
    return s.memoizedState = s.baseState = i, s.queue = {
      pending: null,
      lanes: 0,
      dispatch: null,
      lastRenderedReducer: Ga,
      lastRenderedState: i
    }, s;
  }
  function Id(i, s, u, y) {
    return i.baseState = u, bm(
      i,
      wn,
      typeof y == "function" ? y : Ga
    );
  }
  function r0(i, s, u, y, _) {
    if (Jc(i)) throw Error(r(485));
    if (i = s.action, i !== null) {
      var k = {
        payload: _,
        action: i,
        next: null,
        isTransition: !0,
        status: "pending",
        value: null,
        reason: null,
        listeners: [],
        then: function(L) {
          k.listeners.push(L);
        }
      };
      Z.T !== null ? u(!0) : k.isTransition = !1, y(k), u = s.pending, u === null ? (k.next = s.pending = k, Sm(s, k)) : (k.next = u.next, s.pending = u.next = k);
    }
  }
  function Sm(i, s) {
    var u = s.action, y = s.payload, _ = i.state;
    if (s.isTransition) {
      var k = Z.T, L = {};
      Z.T = L;
      try {
        var J = u(_, y), ve = Z.S;
        ve !== null && ve(L, J), wi(i, s, J);
      } catch (De) {
        Yc(i, s, De);
      } finally {
        k !== null && L.types !== null && (k.types = L.types), Z.T = k;
      }
    } else
      try {
        k = u(_, y), wi(i, s, k);
      } catch (De) {
        Yc(i, s, De);
      }
  }
  function wi(i, s, u) {
    u !== null && typeof u == "object" && typeof u.then == "function" ? u.then(
      function(y) {
        Ys(i, s, y);
      },
      function(y) {
        return Yc(i, s, y);
      }
    ) : Ys(i, s, u);
  }
  function Ys(i, s, u) {
    s.status = "fulfilled", s.value = u, Cm(s), i.state = u, s = i.pending, s !== null && (u = s.next, u === s ? i.pending = null : (u = u.next, s.next = u, Sm(i, u)));
  }
  function Yc(i, s, u) {
    var y = i.pending;
    if (i.pending = null, y !== null) {
      y = y.next;
      do
        s.status = "rejected", s.reason = u, Cm(s), s = s.next;
      while (s !== y);
    }
    i.action = null;
  }
  function Cm(i) {
    i = i.listeners;
    for (var s = 0; s < i.length; s++) (0, i[s])();
  }
  function Wc(i, s) {
    return s;
  }
  function Em(i, s) {
    if (Jt) {
      var u = Tn.formState;
      if (u !== null) {
        e: {
          var y = Pt;
          if (Jt) {
            if (pn) {
              t: {
                for (var _ = pn, k = xa; _.nodeType !== 8; ) {
                  if (!k) {
                    _ = null;
                    break t;
                  }
                  if (_ = ka(
                    _.nextSibling
                  ), _ === null) {
                    _ = null;
                    break t;
                  }
                }
                k = _.data, _ = k === "F!" || k === "F" ? _ : null;
              }
              if (_) {
                pn = ka(
                  _.nextSibling
                ), y = _.data === "F!";
                break e;
              }
            }
            zo(y);
          }
          y = !1;
        }
        y && (s = u[0]);
      }
    }
    return u = Jr(), u.memoizedState = u.baseState = s, y = {
      pending: null,
      lanes: 0,
      dispatch: null,
      lastRenderedReducer: Wc,
      lastRenderedState: s
    }, u.queue = y, u = Im.bind(
      null,
      Pt,
      y
    ), y.dispatch = u, y = Hu(!1), k = Vu.bind(
      null,
      Pt,
      !1,
      y.queue
    ), y = Jr(), _ = {
      state: s,
      dispatch: null,
      action: i,
      pending: null
    }, y.queue = _, u = r0.bind(
      null,
      Pt,
      _,
      k,
      u
    ), _.dispatch = u, y.memoizedState = i, [s, u, !1];
  }
  function Ld(i) {
    var s = mr();
    return km(s, wn, i);
  }
  function km(i, s, u) {
    if (s = bm(
      i,
      s,
      Wc
    )[0], i = qt(Ga)[0], typeof s == "object" && s !== null && typeof s.then == "function")
      try {
        var y = Fu(s);
      } catch (L) {
        throw L === zu ? Uc : L;
      }
    else y = s;
    s = mr();
    var _ = s.queue, k = _.dispatch;
    return u !== s.memoizedState && (Pt.flags |= 2048, Ki(
      9,
      { destroy: void 0 },
      Nm.bind(null, _, u),
      null
    )), [y, k, i];
  }
  function Nm(i, s) {
    i.action = s;
  }
  function Pd(i) {
    var s = mr(), u = wn;
    if (u !== null)
      return km(s, u, i);
    mr(), s = s.memoizedState, u = mr();
    var y = u.queue.dispatch;
    return u.memoizedState = i, [s, y, !1];
  }
  function Ki(i, s, u, y) {
    return i = { tag: i, create: u, deps: y, inst: s, next: null }, s = Pt.updateQueue, s === null && (s = Bu(), Pt.updateQueue = s), u = s.lastEffect, u === null ? s.lastEffect = i.next = i : (y = u.next, u.next = i, i.next = y, s.lastEffect = i), i;
  }
  function i0() {
    return mr().memoizedState;
  }
  function Va(i, s, u, y) {
    var _ = Jr();
    Pt.flags |= i, _.memoizedState = Ki(
      1 | s,
      { destroy: void 0 },
      u,
      y === void 0 ? null : y
    );
  }
  function Xc(i, s, u, y) {
    var _ = mr();
    y = y === void 0 ? null : y;
    var k = _.memoizedState.inst;
    wn !== null && y !== null && Rd(y, wn.memoizedState.deps) ? _.memoizedState = Ki(s, k, u, y) : (Pt.flags |= i, _.memoizedState = Ki(
      1 | s,
      k,
      u,
      y
    ));
  }
  function jm(i, s) {
    Va(8390656, 8, i, s);
  }
  function Qc(i, s) {
    Xc(2048, 8, i, s);
  }
  function Nv(i) {
    Pt.flags |= 4;
    var s = Pt.updateQueue;
    if (s === null)
      s = Bu(), Pt.updateQueue = s, s.events = [i];
    else {
      var u = s.events;
      u === null ? s.events = [i] : u.push(i);
    }
  }
  function a0(i) {
    var s = mr().memoizedState;
    return Nv({ ref: s, nextImpl: i }), function() {
      if ((hn & 2) !== 0) throw Error(r(440));
      return s.impl.apply(void 0, arguments);
    };
  }
  function s0(i, s) {
    return Xc(4, 2, i, s);
  }
  function Tm(i, s) {
    return Xc(4, 4, i, s);
  }
  function Am(i, s) {
    if (typeof s == "function") {
      i = i();
      var u = s(i);
      return function() {
        typeof u == "function" ? u() : s(null);
      };
    }
    if (s != null)
      return i = i(), s.current = i, function() {
        s.current = null;
      };
  }
  function o0(i, s, u) {
    u = u != null ? u.concat([i]) : null, Xc(4, 4, Am.bind(null, s, i), u);
  }
  function qd() {
  }
  function Mm(i, s) {
    var u = mr();
    s = s === void 0 ? null : s;
    var y = u.memoizedState;
    return s !== null && Rd(s, y[1]) ? y[0] : (u.memoizedState = [i, s], i);
  }
  function ui(i, s) {
    var u = mr();
    s = s === void 0 ? null : s;
    var y = u.memoizedState;
    if (s !== null && Rd(s, y[1]))
      return y[0];
    if (y = i(), $l) {
      En(!0);
      try {
        i();
      } finally {
        En(!1);
      }
    }
    return u.memoizedState = [y, s], y;
  }
  function Ea(i, s, u) {
    return u === void 0 || (Gi & 1073741824) !== 0 && (Wt & 261930) === 0 ? i.memoizedState = s : (i.memoizedState = u, i = z0(), Pt.lanes |= i, Ko |= i, u);
  }
  function l0(i, s, u, y) {
    return An(u, s) ? u : Ks.current !== null ? (i = Ea(i, u, y), An(i, s) || (Jn = !0), i) : (Gi & 42) === 0 || (Gi & 1073741824) !== 0 && (Wt & 261930) === 0 ? (Jn = !0, i.memoizedState = u) : (i = z0(), Pt.lanes |= i, Ko |= i, s);
  }
  function u0(i, s, u, y, _) {
    var k = fe.p;
    fe.p = k !== 0 && 8 > k ? k : 8;
    var L = Z.T, J = {};
    Z.T = J, Vu(i, !1, s, u);
    try {
      var ve = _(), De = Z.S;
      if (De !== null && De(J, ve), ve !== null && typeof ve == "object" && typeof ve.then == "function") {
        var He = Cv(
          ve,
          y
        );
        Gu(
          i,
          s,
          He,
          Xi(i)
        );
      } else
        Gu(
          i,
          s,
          y,
          Xi(i)
        );
    } catch (Ye) {
      Gu(
        i,
        s,
        { then: function() {
        }, status: "rejected", reason: Ye },
        Xi()
      );
    } finally {
      fe.p = k, L !== null && J.types !== null && (L.types = J.types), Z.T = L;
    }
  }
  function Bd() {
  }
  function Uo(i, s, u, y) {
    if (i.tag !== 5) throw Error(r(476));
    var _ = Rm(i).queue;
    u0(
      i,
      _,
      s,
      he,
      u === null ? Bd : function() {
        return Om(i), u(y);
      }
    );
  }
  function Rm(i) {
    var s = i.memoizedState;
    if (s !== null) return s;
    s = {
      memoizedState: he,
      baseState: he,
      baseQueue: null,
      queue: {
        pending: null,
        lanes: 0,
        dispatch: null,
        lastRenderedReducer: Ga,
        lastRenderedState: he
      },
      next: null
    };
    var u = {};
    return s.next = {
      memoizedState: u,
      baseState: u,
      baseQueue: null,
      queue: {
        pending: null,
        lanes: 0,
        dispatch: null,
        lastRenderedReducer: Ga,
        lastRenderedState: u
      },
      next: null
    }, i.memoizedState = s, i = i.alternate, i !== null && (i.memoizedState = s), s;
  }
  function Om(i) {
    var s = Rm(i);
    s.next === null && (s = i.alternate.memoizedState), Gu(
      i,
      s.next.queue,
      {},
      Xi()
    );
  }
  function zm() {
    return Ur(lc);
  }
  function Dm() {
    return mr().memoizedState;
  }
  function Hl() {
    return mr().memoizedState;
  }
  function Zc(i) {
    for (var s = i.return; s !== null; ) {
      switch (s.tag) {
        case 24:
        case 3:
          var u = Xi();
          i = qo(u);
          var y = $a(s, i, u);
          y !== null && (ki(y, s, u), $c(y, s, u)), s = { cache: Ba() }, i.payload = s;
          return;
      }
      s = s.return;
    }
  }
  function jv(i, s, u) {
    var y = Xi();
    u = {
      lane: y,
      revertLane: 0,
      gesture: null,
      action: u,
      hasEagerState: !1,
      eagerState: null,
      next: null
    }, Jc(i) ? ef(s, u) : (u = fr(i, s, u, y), u !== null && (ki(u, i, y), Fd(u, s, y)));
  }
  function Im(i, s, u) {
    var y = Xi();
    Gu(i, s, u, y);
  }
  function Gu(i, s, u, y) {
    var _ = {
      lane: y,
      revertLane: 0,
      gesture: null,
      action: u,
      hasEagerState: !1,
      eagerState: null,
      next: null
    };
    if (Jc(i)) ef(s, _);
    else {
      var k = i.alternate;
      if (i.lanes === 0 && (k === null || k.lanes === 0) && (k = s.lastRenderedReducer, k !== null))
        try {
          var L = s.lastRenderedState, J = k(L, u);
          if (_.hasEagerState = !0, _.eagerState = J, An(J, L))
            return Et(i, s, _, 0), Tn === null && Ln(), !1;
        } catch {
        } finally {
        }
      if (u = fr(i, s, _, y), u !== null)
        return ki(u, i, y), Fd(u, s, y), !0;
    }
    return !1;
  }
  function Vu(i, s, u, y) {
    if (y = {
      lane: 2,
      revertLane: Qi(),
      gesture: null,
      action: y,
      hasEagerState: !1,
      eagerState: null,
      next: null
    }, Jc(i)) {
      if (s) throw Error(r(479));
    } else
      s = fr(
        i,
        u,
        y,
        2
      ), s !== null && ki(s, i, 2);
  }
  function Jc(i) {
    var s = i.alternate;
    return i === Pt || s !== null && s === Pt;
  }
  function ef(i, s) {
    Pu = Vc = !0;
    var u = i.pending;
    u === null ? s.next = s : (s.next = u.next, u.next = s), i.pending = s;
  }
  function Fd(i, s, u) {
    if ((u & 4194048) !== 0) {
      var y = s.lanes;
      y &= i.pendingLanes, u |= y, s.lanes = u, yn(i, u);
    }
  }
  var $o = {
    readContext: Ur,
    use: Uu,
    useCallback: Hn,
    useContext: Hn,
    useEffect: Hn,
    useImperativeHandle: Hn,
    useLayoutEffect: Hn,
    useInsertionEffect: Hn,
    useMemo: Hn,
    useReducer: Hn,
    useRef: Hn,
    useState: Hn,
    useDebugValue: Hn,
    useDeferredValue: Hn,
    useTransition: Hn,
    useSyncExternalStore: Hn,
    useId: Hn,
    useHostTransitionStatus: Hn,
    useFormState: Hn,
    useActionState: Hn,
    useOptimistic: Hn,
    useMemoCache: Hn,
    useCacheRefresh: Hn
  };
  $o.useEffectEvent = Hn;
  var c0 = {
    readContext: Ur,
    use: Uu,
    useCallback: function(i, s) {
      return Jr().memoizedState = [
        i,
        s === void 0 ? null : s
      ], i;
    },
    useContext: Ur,
    useEffect: jm,
    useImperativeHandle: function(i, s, u) {
      u = u != null ? u.concat([i]) : null, Va(
        4194308,
        4,
        Am.bind(null, s, i),
        u
      );
    },
    useLayoutEffect: function(i, s) {
      return Va(4194308, 4, i, s);
    },
    useInsertionEffect: function(i, s) {
      Va(4, 2, i, s);
    },
    useMemo: function(i, s) {
      var u = Jr();
      s = s === void 0 ? null : s;
      var y = i();
      if ($l) {
        En(!0);
        try {
          i();
        } finally {
          En(!1);
        }
      }
      return u.memoizedState = [y, s], y;
    },
    useReducer: function(i, s, u) {
      var y = Jr();
      if (u !== void 0) {
        var _ = u(s);
        if ($l) {
          En(!0);
          try {
            u(s);
          } finally {
            En(!1);
          }
        }
      } else _ = s;
      return y.memoizedState = y.baseState = _, i = {
        pending: null,
        lanes: 0,
        dispatch: null,
        lastRenderedReducer: i,
        lastRenderedState: _
      }, y.queue = i, i = i.dispatch = jv.bind(
        null,
        Pt,
        i
      ), [y.memoizedState, i];
    },
    useRef: function(i) {
      var s = Jr();
      return i = { current: i }, s.memoizedState = i;
    },
    useState: function(i) {
      i = Hu(i);
      var s = i.queue, u = Im.bind(null, Pt, s);
      return s.dispatch = u, [i.memoizedState, u];
    },
    useDebugValue: qd,
    useDeferredValue: function(i, s) {
      var u = Jr();
      return Ea(u, i, s);
    },
    useTransition: function() {
      var i = Hu(!1);
      return i = u0.bind(
        null,
        Pt,
        i.queue,
        !0,
        !1
      ), Jr().memoizedState = i, [!1, i];
    },
    useSyncExternalStore: function(i, s, u) {
      var y = Pt, _ = Jr();
      if (Jt) {
        if (u === void 0)
          throw Error(r(407));
        u = u();
      } else {
        if (u = s(), Tn === null)
          throw Error(r(349));
        (Wt & 127) !== 0 || _m(y, s, u);
      }
      _.memoizedState = u;
      var k = { value: u, getSnapshot: s };
      return _.queue = k, jm(t0.bind(null, y, k, i), [
        i
      ]), y.flags |= 2048, Ki(
        9,
        { destroy: void 0 },
        e0.bind(
          null,
          y,
          k,
          u,
          s
        ),
        null
      ), u;
    },
    useId: function() {
      var i = Jr(), s = Tn.identifierPrefix;
      if (Jt) {
        var u = va, y = ms;
        u = (y & ~(1 << 32 - it(y) - 1)).toString(32) + u, s = "_" + s + "R_" + u, u = Md++, 0 < u && (s += "H" + u.toString(32)), s += "_";
      } else
        u = Ev++, s = "_" + s + "r_" + u.toString(32) + "_";
      return i.memoizedState = s;
    },
    useHostTransitionStatus: zm,
    useFormState: Em,
    useActionState: Em,
    useOptimistic: function(i) {
      var s = Jr();
      s.memoizedState = s.baseState = i;
      var u = {
        pending: null,
        lanes: 0,
        dispatch: null,
        lastRenderedReducer: null,
        lastRenderedState: null
      };
      return s.queue = u, s = Vu.bind(
        null,
        Pt,
        !0,
        u
      ), u.dispatch = s, [i, s];
    },
    useMemoCache: xm,
    useCacheRefresh: function() {
      return Jr().memoizedState = Zc.bind(
        null,
        Pt
      );
    },
    useEffectEvent: function(i) {
      var s = Jr(), u = { impl: i };
      return s.memoizedState = u, function() {
        if ((hn & 2) !== 0)
          throw Error(r(440));
        return u.impl.apply(void 0, arguments);
      };
    }
  }, Ud = {
    readContext: Ur,
    use: Uu,
    useCallback: Mm,
    useContext: Ur,
    useEffect: Qc,
    useImperativeHandle: o0,
    useInsertionEffect: s0,
    useLayoutEffect: Tm,
    useMemo: ui,
    useReducer: qt,
    useRef: i0,
    useState: function() {
      return qt(Ga);
    },
    useDebugValue: qd,
    useDeferredValue: function(i, s) {
      var u = mr();
      return l0(
        u,
        wn.memoizedState,
        i,
        s
      );
    },
    useTransition: function() {
      var i = qt(Ga)[0], s = mr().memoizedState;
      return [
        typeof i == "boolean" ? i : Fu(i),
        s
      ];
    },
    useSyncExternalStore: $u,
    useId: Dm,
    useHostTransitionStatus: zm,
    useFormState: Ld,
    useActionState: Ld,
    useOptimistic: function(i, s) {
      var u = mr();
      return Id(u, wn, i, s);
    },
    useMemoCache: xm,
    useCacheRefresh: Hl
  };
  Ud.useEffectEvent = a0;
  var tf = {
    readContext: Ur,
    use: Uu,
    useCallback: Mm,
    useContext: Ur,
    useEffect: Qc,
    useImperativeHandle: o0,
    useInsertionEffect: s0,
    useLayoutEffect: Tm,
    useMemo: ui,
    useReducer: wm,
    useRef: i0,
    useState: function() {
      return wm(Ga);
    },
    useDebugValue: qd,
    useDeferredValue: function(i, s) {
      var u = mr();
      return wn === null ? Ea(u, i, s) : l0(
        u,
        wn.memoizedState,
        i,
        s
      );
    },
    useTransition: function() {
      var i = wm(Ga)[0], s = mr().memoizedState;
      return [
        typeof i == "boolean" ? i : Fu(i),
        s
      ];
    },
    useSyncExternalStore: $u,
    useId: Dm,
    useHostTransitionStatus: zm,
    useFormState: Pd,
    useActionState: Pd,
    useOptimistic: function(i, s) {
      var u = mr();
      return wn !== null ? Id(u, wn, i, s) : (u.baseState = i, [i, u.queue.dispatch]);
    },
    useMemoCache: xm,
    useCacheRefresh: Hl
  };
  tf.useEffectEvent = a0;
  function $d(i, s, u, y) {
    s = i.memoizedState, u = u(y, s), u = u == null ? s : g({}, s, u), i.memoizedState = u, i.lanes === 0 && (i.updateQueue.baseState = u);
  }
  var nf = {
    enqueueSetState: function(i, s, u) {
      i = i._reactInternals;
      var y = Xi(), _ = qo(y);
      _.payload = s, u != null && (_.callback = u), s = $a(i, _, y), s !== null && (ki(s, i, y), $c(s, i, y));
    },
    enqueueReplaceState: function(i, s, u) {
      i = i._reactInternals;
      var y = Xi(), _ = qo(y);
      _.tag = 1, _.payload = s, u != null && (_.callback = u), s = $a(i, _, y), s !== null && (ki(s, i, y), $c(s, i, y));
    },
    enqueueForceUpdate: function(i, s) {
      i = i._reactInternals;
      var u = Xi(), y = qo(u);
      y.tag = 2, s != null && (y.callback = s), s = $a(i, y, u), s !== null && (ki(s, i, u), $c(s, i, u));
    }
  };
  function f0(i, s, u, y, _, k, L) {
    return i = i.stateNode, typeof i.shouldComponentUpdate == "function" ? i.shouldComponentUpdate(y, k, L) : s.prototype && s.prototype.isPureReactComponent ? !w(u, y) || !w(_, k) : !0;
  }
  function Lm(i, s, u, y) {
    i = s.state, typeof s.componentWillReceiveProps == "function" && s.componentWillReceiveProps(u, y), typeof s.UNSAFE_componentWillReceiveProps == "function" && s.UNSAFE_componentWillReceiveProps(u, y), s.state !== i && nf.enqueueReplaceState(s, s.state, null);
  }
  function ci(i, s) {
    var u = s;
    if ("ref" in s) {
      u = {};
      for (var y in s)
        y !== "ref" && (u[y] = s[y]);
    }
    if (i = i.defaultProps) {
      u === s && (u = g({}, u));
      for (var _ in i)
        u[_] === void 0 && (u[_] = i[_]);
    }
    return u;
  }
  function Pm(i) {
    ht(i);
  }
  function qm(i) {
    console.error(i);
  }
  function d0(i) {
    ht(i);
  }
  function rf(i, s) {
    try {
      var u = i.onUncaughtError;
      u(s.value, { componentStack: s.stack });
    } catch (y) {
      setTimeout(function() {
        throw y;
      });
    }
  }
  function h0(i, s, u) {
    try {
      var y = i.onCaughtError;
      y(u.value, {
        componentStack: u.stack,
        errorBoundary: s.tag === 1 ? s.stateNode : null
      });
    } catch (_) {
      setTimeout(function() {
        throw _;
      });
    }
  }
  function Bm(i, s, u) {
    return u = qo(u), u.tag = 3, u.payload = { element: null }, u.callback = function() {
      rf(i, s);
    }, u;
  }
  function vs(i) {
    return i = qo(i), i.tag = 3, i;
  }
  function Hd(i, s, u, y) {
    var _ = u.type.getDerivedStateFromError;
    if (typeof _ == "function") {
      var k = y.value;
      i.payload = function() {
        return _(k);
      }, i.callback = function() {
        h0(s, u, y);
      };
    }
    var L = u.stateNode;
    L !== null && typeof L.componentDidCatch == "function" && (i.callback = function() {
      h0(s, u, y), typeof _ != "function" && (Yo === null ? Yo = /* @__PURE__ */ new Set([this]) : Yo.add(this));
      var J = y.stack;
      this.componentDidCatch(y.value, {
        componentStack: J !== null ? J : ""
      });
    });
  }
  function Fm(i, s, u, y, _) {
    if (u.flags |= 32768, y !== null && typeof y == "object" && typeof y.then == "function") {
      if (s = u.alternate, s !== null && Mu(
        s,
        u,
        _,
        !0
      ), u = Hi.current, u !== null) {
        switch (u.tag) {
          case 31:
          case 13:
            return Sa === null ? ih() : u.alternate === null && er === 0 && (er = 3), u.flags &= -257, u.flags |= 65536, u.lanes = _, y === Ed ? u.flags |= 16384 : (s = u.updateQueue, s === null ? u.updateQueue = /* @__PURE__ */ new Set([y]) : s.add(y), gp(i, y, _)), !1;
          case 22:
            return u.flags |= 65536, y === Ed ? u.flags |= 16384 : (s = u.updateQueue, s === null ? (s = {
              transitions: null,
              markerInstances: null,
              retryQueue: /* @__PURE__ */ new Set([y])
            }, u.updateQueue = s) : (u = s.retryQueue, u === null ? s.retryQueue = /* @__PURE__ */ new Set([y]) : u.add(y)), gp(i, y, _)), !1;
        }
        throw Error(r(435, u.tag));
      }
      return gp(i, y, _), ih(), !1;
    }
    if (Jt)
      return s = Hi.current, s !== null ? ((s.flags & 65536) === 0 && (s.flags |= 256), s.flags |= 65536, s.lanes = _, y !== cm && (i = Error(r(422), { cause: y }), Io(Fi(i, u)))) : (y !== cm && (s = Error(r(423), {
        cause: y
      }), Io(
        Fi(s, u)
      )), i = i.current.alternate, i.flags |= 65536, _ &= -_, i.lanes |= _, y = Fi(y, u), _ = Bm(
        i.stateNode,
        y,
        _
      ), jd(i, _), er !== 4 && (er = 2)), !1;
    var k = Error(r(520), { cause: y });
    if (k = Fi(k, u), vf === null ? vf = [k] : vf.push(k), er !== 4 && (er = 2), s === null) return !0;
    y = Fi(y, u), u = s;
    do {
      switch (u.tag) {
        case 3:
          return u.flags |= 65536, i = _ & -_, u.lanes |= i, i = Bm(u.stateNode, y, i), jd(u, i), !1;
        case 1:
          if (s = u.type, k = u.stateNode, (u.flags & 128) === 0 && (typeof s.getDerivedStateFromError == "function" || k !== null && typeof k.componentDidCatch == "function" && (Yo === null || !Yo.has(k))))
            return u.flags |= 65536, _ &= -_, u.lanes |= _, _ = vs(_), Hd(
              _,
              i,
              u,
              y
            ), jd(u, _), !1;
      }
      u = u.return;
    } while (u !== null);
    return !1;
  }
  var af = Error(r(461)), Jn = !1;
  function rr(i, s, u, y) {
    s.child = i === null ? pm(s, null, u, y) : Po(
      s,
      i.child,
      u,
      y
    );
  }
  function Ct(i, s, u, y, _) {
    u = u.render;
    var k = s.ref;
    if ("ref" in y) {
      var L = {};
      for (var J in y)
        J !== "ref" && (L[J] = y[J]);
    } else L = y;
    return ql(s), y = Od(
      i,
      s,
      u,
      L,
      k,
      _
    ), J = zd(), i !== null && !Jn ? (Dd(i, s, _), xs(i, s, _)) : (Jt && J && Ro(s), s.flags |= 1, rr(i, s, y, _), s.child);
  }
  function sf(i, s, u, y, _) {
    if (i === null) {
      var k = u.type;
      return typeof k == "function" && !Us(k) && k.defaultProps === void 0 && u.compare === null ? (s.tag = 15, s.type = k, Gd(
        i,
        s,
        k,
        y,
        _
      )) : (i = bd(
        u.type,
        null,
        y,
        s,
        s.mode,
        _
      ), i.ref = s.ref, i.return = s, s.child = i);
    }
    if (k = i.child, !Xd(i, _)) {
      var L = k.memoizedProps;
      if (u = u.compare, u = u !== null ? u : w, u(L, y) && i.ref === s.ref)
        return xs(i, s, _);
    }
    return s.flags |= 1, i = pa(k, y), i.ref = s.ref, i.return = s, s.child = i;
  }
  function Gd(i, s, u, y, _) {
    if (i !== null) {
      var k = i.memoizedProps;
      if (w(k, y) && i.ref === s.ref)
        if (Jn = !1, s.pendingProps = y = k, Xd(i, _))
          (i.flags & 131072) !== 0 && (Jn = !0);
        else
          return s.lanes = i.lanes, xs(i, s, _);
    }
    return Yd(
      i,
      s,
      u,
      y,
      _
    );
  }
  function Ho(i, s, u, y) {
    var _ = y.children, k = i !== null ? i.memoizedState : null;
    if (i === null && s.stateNode === null && (s.stateNode = {
      _visibility: 1,
      _pendingMarkers: null,
      _retryCache: null,
      _transitions: null
    }), y.mode === "hidden") {
      if ((s.flags & 128) !== 0) {
        if (k = k !== null ? k.baseLanes | u : u, i !== null) {
          for (y = s.child = i.child, _ = 0; y !== null; )
            _ = _ | y.lanes | y.childLanes, y = y.sibling;
          y = _ & ~k;
        } else y = 0, s.child = null;
        return Vd(
          i,
          s,
          k,
          u,
          y
        );
      }
      if ((u & 536870912) !== 0)
        s.memoizedState = { baseLanes: 0, cachePool: null }, i !== null && Sd(
          s,
          k !== null ? k.cachePool : null
        ), k !== null ? gm(s, k) : $r(), Jg(s);
      else
        return y = s.lanes = 536870912, Vd(
          i,
          s,
          k !== null ? k.baseLanes | u : u,
          u,
          y
        );
    } else
      k !== null ? (Sd(s, k.cachePool), gm(s, k), Ca(), s.memoizedState = null) : (i !== null && Sd(s, null), $r(), Ca());
    return rr(i, s, _, u), s.child;
  }
  function of(i, s) {
    return i !== null && i.tag === 22 || s.stateNode !== null || (s.stateNode = {
      _visibility: 1,
      _pendingMarkers: null,
      _retryCache: null,
      _transitions: null
    }), s.sibling;
  }
  function Vd(i, s, u, y, _) {
    var k = hm();
    return k = k === null ? null : { parent: wr._currentValue, pool: k }, s.memoizedState = {
      baseLanes: u,
      cachePool: k
    }, i !== null && Sd(s, null), $r(), Jg(s), i !== null && Mu(i, s, y, !0), s.childLanes = _, null;
  }
  function lf(i, s) {
    return s = Wd(
      { mode: s.mode, children: s.children },
      i.mode
    ), s.ref = i.ref, i.child = s, s.return = i, s;
  }
  function Hr(i, s, u) {
    return Po(s, i.child, null, u), i = lf(s, s.pendingProps), i.flags |= 2, bi(s), s.memoizedState = null, i;
  }
  function Tv(i, s, u) {
    var y = s.pendingProps, _ = (s.flags & 128) !== 0;
    if (s.flags &= -129, i === null) {
      if (Jt) {
        if (y.mode === "hidden")
          return i = lf(s, y), s.lanes = 536870912, of(null, i);
        if (Gc(s), (i = pn) ? (i = ry(
          i,
          xa
        ), i = i !== null && i.data === "&" ? i : null, i !== null && (s.memoizedState = {
          dehydrated: i,
          treeContext: $s !== null ? { id: ms, overflow: va } : null,
          retryLane: 536870912,
          hydrationErrors: null
        }, u = Lc(i), u.return = s, s.child = u, br = s, pn = null)) : i = null, i === null) throw zo(s);
        return s.lanes = 536870912, null;
      }
      return lf(s, y);
    }
    var k = i.memoizedState;
    if (k !== null) {
      var L = k.dehydrated;
      if (Gc(s), _)
        if (s.flags & 256)
          s.flags &= -257, s = Hr(
            i,
            s,
            u
          );
        else if (s.memoizedState !== null)
          s.child = i.child, s.flags |= 128, s = null;
        else throw Error(r(558));
      else if (Jn || Mu(i, s, u, !1), _ = (u & i.childLanes) !== 0, Jn || _) {
        if (y = Tn, y !== null && (L = On(y, u), L !== 0 && L !== k.retryLane))
          throw k.retryLane = L, Nn(i, L), ki(y, i, L), af;
        ih(), s = Hr(
          i,
          s,
          u
        );
      } else
        i = k.treeContext, pn = ka(L.nextSibling), br = s, Jt = !0, Oo = null, xa = !1, i !== null && Tu(s, i), s = lf(s, y), s.flags |= 4096;
      return s;
    }
    return i = pa(i.child, {
      mode: y.mode,
      children: y.children
    }), i.ref = s.ref, s.child = i, i.return = s, i;
  }
  function Kd(i, s) {
    var u = s.ref;
    if (u === null)
      i !== null && i.ref !== null && (s.flags |= 4194816);
    else {
      if (typeof u != "function" && typeof u != "object")
        throw Error(r(284));
      (i === null || i.ref !== u) && (s.flags |= 4194816);
    }
  }
  function Yd(i, s, u, y, _) {
    return ql(s), u = Od(
      i,
      s,
      u,
      y,
      void 0,
      _
    ), y = zd(), i !== null && !Jn ? (Dd(i, s, _), xs(i, s, _)) : (Jt && y && Ro(s), s.flags |= 1, rr(i, s, u, _), s.child);
  }
  function m0(i, s, u, y, _, k) {
    return ql(s), s.updateQueue = null, u = Kc(
      s,
      y,
      u,
      _
    ), ym(i), y = zd(), i !== null && !Jn ? (Dd(i, s, k), xs(i, s, k)) : (Jt && y && Ro(s), s.flags |= 1, rr(i, s, u, k), s.child);
  }
  function Um(i, s, u, y, _) {
    if (ql(s), s.stateNode === null) {
      var k = Br, L = u.contextType;
      typeof L == "object" && L !== null && (k = Ur(L)), k = new u(y, k), s.memoizedState = k.state !== null && k.state !== void 0 ? k.state : null, k.updater = nf, s.stateNode = k, k._reactInternals = s, k = s.stateNode, k.props = y, k.state = s.memoizedState, k.refs = {}, gs(s), L = u.contextType, k.context = typeof L == "object" && L !== null ? Ur(L) : Br, k.state = s.memoizedState, L = u.getDerivedStateFromProps, typeof L == "function" && ($d(
        s,
        u,
        L,
        y
      ), k.state = s.memoizedState), typeof u.getDerivedStateFromProps == "function" || typeof k.getSnapshotBeforeUpdate == "function" || typeof k.UNSAFE_componentWillMount != "function" && typeof k.componentWillMount != "function" || (L = k.state, typeof k.componentWillMount == "function" && k.componentWillMount(), typeof k.UNSAFE_componentWillMount == "function" && k.UNSAFE_componentWillMount(), L !== k.state && nf.enqueueReplaceState(k, k.state, null), Lu(s, y, k, _), Ul(), k.state = s.memoizedState), typeof k.componentDidMount == "function" && (s.flags |= 4194308), y = !0;
    } else if (i === null) {
      k = s.stateNode;
      var J = s.memoizedProps, ve = ci(u, J);
      k.props = ve;
      var De = k.context, He = u.contextType;
      L = Br, typeof He == "object" && He !== null && (L = Ur(He));
      var Ye = u.getDerivedStateFromProps;
      He = typeof Ye == "function" || typeof k.getSnapshotBeforeUpdate == "function", J = s.pendingProps !== J, He || typeof k.UNSAFE_componentWillReceiveProps != "function" && typeof k.componentWillReceiveProps != "function" || (J || De !== L) && Lm(
        s,
        k,
        y,
        L
      ), _a = !1;
      var Le = s.memoizedState;
      k.state = Le, Lu(s, y, k, _), Ul(), De = s.memoizedState, J || Le !== De || _a ? (typeof Ye == "function" && ($d(
        s,
        u,
        Ye,
        y
      ), De = s.memoizedState), (ve = _a || f0(
        s,
        u,
        ve,
        y,
        Le,
        De,
        L
      )) ? (He || typeof k.UNSAFE_componentWillMount != "function" && typeof k.componentWillMount != "function" || (typeof k.componentWillMount == "function" && k.componentWillMount(), typeof k.UNSAFE_componentWillMount == "function" && k.UNSAFE_componentWillMount()), typeof k.componentDidMount == "function" && (s.flags |= 4194308)) : (typeof k.componentDidMount == "function" && (s.flags |= 4194308), s.memoizedProps = y, s.memoizedState = De), k.props = y, k.state = De, k.context = L, y = ve) : (typeof k.componentDidMount == "function" && (s.flags |= 4194308), y = !1);
    } else {
      k = s.stateNode, Nd(i, s), L = s.memoizedProps, He = ci(u, L), k.props = He, Ye = s.pendingProps, Le = k.context, De = u.contextType, ve = Br, typeof De == "object" && De !== null && (ve = Ur(De)), J = u.getDerivedStateFromProps, (De = typeof J == "function" || typeof k.getSnapshotBeforeUpdate == "function") || typeof k.UNSAFE_componentWillReceiveProps != "function" && typeof k.componentWillReceiveProps != "function" || (L !== Ye || Le !== ve) && Lm(
        s,
        k,
        y,
        ve
      ), _a = !1, Le = s.memoizedState, k.state = Le, Lu(s, y, k, _), Ul();
      var Fe = s.memoizedState;
      L !== Ye || Le !== Fe || _a || i !== null && i.dependencies !== null && _d(i.dependencies) ? (typeof J == "function" && ($d(
        s,
        u,
        J,
        y
      ), Fe = s.memoizedState), (He = _a || f0(
        s,
        u,
        He,
        y,
        Le,
        Fe,
        ve
      ) || i !== null && i.dependencies !== null && _d(i.dependencies)) ? (De || typeof k.UNSAFE_componentWillUpdate != "function" && typeof k.componentWillUpdate != "function" || (typeof k.componentWillUpdate == "function" && k.componentWillUpdate(y, Fe, ve), typeof k.UNSAFE_componentWillUpdate == "function" && k.UNSAFE_componentWillUpdate(
        y,
        Fe,
        ve
      )), typeof k.componentDidUpdate == "function" && (s.flags |= 4), typeof k.getSnapshotBeforeUpdate == "function" && (s.flags |= 1024)) : (typeof k.componentDidUpdate != "function" || L === i.memoizedProps && Le === i.memoizedState || (s.flags |= 4), typeof k.getSnapshotBeforeUpdate != "function" || L === i.memoizedProps && Le === i.memoizedState || (s.flags |= 1024), s.memoizedProps = y, s.memoizedState = Fe), k.props = y, k.state = Fe, k.context = ve, y = He) : (typeof k.componentDidUpdate != "function" || L === i.memoizedProps && Le === i.memoizedState || (s.flags |= 4), typeof k.getSnapshotBeforeUpdate != "function" || L === i.memoizedProps && Le === i.memoizedState || (s.flags |= 1024), y = !1);
    }
    return k = y, Kd(i, s), y = (s.flags & 128) !== 0, k || y ? (k = s.stateNode, u = y && typeof u.getDerivedStateFromError != "function" ? null : k.render(), s.flags |= 1, i !== null && y ? (s.child = Po(
      s,
      i.child,
      null,
      _
    ), s.child = Po(
      s,
      null,
      u,
      _
    )) : rr(i, s, u, _), s.memoizedState = k.state, i = s.child) : i = xs(
      i,
      s,
      _
    ), i;
  }
  function p0(i, s, u, y) {
    return ee(), s.flags |= 256, rr(i, s, u, y), s.child;
  }
  var $m = {
    dehydrated: null,
    treeContext: null,
    retryLane: 0,
    hydrationErrors: null
  };
  function Hm(i) {
    return { baseLanes: i, cachePool: Wg() };
  }
  function Ka(i, s, u) {
    return i = i !== null ? i.childLanes & ~u : 0, s && (i |= Wi), i;
  }
  function ei(i, s, u) {
    var y = s.pendingProps, _ = !1, k = (s.flags & 128) !== 0, L;
    if ((L = k) || (L = i !== null && i.memoizedState === null ? !1 : (hr.current & 2) !== 0), L && (_ = !0, s.flags &= -129), L = (s.flags & 32) !== 0, s.flags &= -33, i === null) {
      if (Jt) {
        if (_ ? Bo(s) : Ca(), (i = pn) ? (i = ry(
          i,
          xa
        ), i = i !== null && i.data !== "&" ? i : null, i !== null && (s.memoizedState = {
          dehydrated: i,
          treeContext: $s !== null ? { id: ms, overflow: va } : null,
          retryLane: 536870912,
          hydrationErrors: null
        }, u = Lc(i), u.return = s, s.child = u, br = s, pn = null)) : i = null, i === null) throw zo(s);
        return nc(i) ? s.lanes = 32 : s.lanes = 536870912, null;
      }
      var J = y.children;
      return y = y.fallback, _ ? (Ca(), _ = s.mode, J = Wd(
        { mode: "hidden", children: J },
        _
      ), y = Il(
        y,
        _,
        u,
        null
      ), J.return = s, y.return = s, J.sibling = y, s.child = J, y = s.child, y.memoizedState = Hm(u), y.childLanes = Ka(
        i,
        L,
        u
      ), s.memoizedState = $m, of(null, y)) : (Bo(s), uf(s, J));
    }
    var ve = i.memoizedState;
    if (ve !== null && (J = ve.dehydrated, J !== null)) {
      if (k)
        s.flags & 256 ? (Bo(s), s.flags &= -257, s = cf(
          i,
          s,
          u
        )) : s.memoizedState !== null ? (Ca(), s.child = i.child, s.flags |= 128, s = null) : (Ca(), J = y.fallback, _ = s.mode, y = Wd(
          { mode: "visible", children: y.children },
          _
        ), J = Il(
          J,
          _,
          u,
          null
        ), J.flags |= 2, y.return = s, J.return = s, y.sibling = J, s.child = y, Po(
          s,
          i.child,
          null,
          u
        ), y = s.child, y.memoizedState = Hm(u), y.childLanes = Ka(
          i,
          L,
          u
        ), s.memoizedState = $m, s = of(null, y));
      else if (Bo(s), nc(J)) {
        if (L = J.nextSibling && J.nextSibling.dataset, L) var De = L.dgst;
        L = De, y = Error(r(419)), y.stack = "", y.digest = L, Io({ value: y, source: null, stack: null }), s = cf(
          i,
          s,
          u
        );
      } else if (Jn || Mu(i, s, u, !1), L = (u & i.childLanes) !== 0, Jn || L) {
        if (L = Tn, L !== null && (y = On(L, u), y !== 0 && y !== ve.retryLane))
          throw ve.retryLane = y, Nn(i, y), ki(L, i, y), af;
        hh(J) || ih(), s = cf(
          i,
          s,
          u
        );
      } else
        hh(J) ? (s.flags |= 192, s.child = i.child, s = null) : (i = ve.treeContext, pn = ka(
          J.nextSibling
        ), br = s, Jt = !0, Oo = null, xa = !1, i !== null && Tu(s, i), s = uf(
          s,
          y.children
        ), s.flags |= 4096);
      return s;
    }
    return _ ? (Ca(), J = y.fallback, _ = s.mode, ve = i.child, De = ve.sibling, y = pa(ve, {
      mode: "hidden",
      children: y.children
    }), y.subtreeFlags = ve.subtreeFlags & 65011712, De !== null ? J = pa(
      De,
      J
    ) : (J = Il(
      J,
      _,
      u,
      null
    ), J.flags |= 2), J.return = s, y.return = s, y.sibling = J, s.child = y, of(null, y), y = s.child, J = i.child.memoizedState, J === null ? J = Hm(u) : (_ = J.cachePool, _ !== null ? (ve = wr._currentValue, _ = _.parent !== ve ? { parent: ve, pool: ve } : _) : _ = Wg(), J = {
      baseLanes: J.baseLanes | u,
      cachePool: _
    }), y.memoizedState = J, y.childLanes = Ka(
      i,
      L,
      u
    ), s.memoizedState = $m, of(i.child, y)) : (Bo(s), u = i.child, i = u.sibling, u = pa(u, {
      mode: "visible",
      children: y.children
    }), u.return = s, u.sibling = null, i !== null && (L = s.deletions, L === null ? (s.deletions = [i], s.flags |= 16) : L.push(i)), s.child = u, s.memoizedState = null, u);
  }
  function uf(i, s) {
    return s = Wd(
      { mode: "visible", children: s },
      i.mode
    ), s.return = i, i.child = s;
  }
  function Wd(i, s) {
    return i = Fr(22, i, null, s), i.lanes = 0, i;
  }
  function cf(i, s, u) {
    return Po(s, i.child, null, u), i = uf(
      s,
      s.pendingProps.children
    ), i.flags |= 2, s.memoizedState = null, i;
  }
  function g0(i, s, u) {
    i.lanes |= s;
    var y = i.alternate;
    y !== null && (y.lanes |= s), Vs(i.return, s, u);
  }
  function Gm(i, s, u, y, _, k) {
    var L = i.memoizedState;
    L === null ? i.memoizedState = {
      isBackwards: s,
      rendering: null,
      renderingStartTime: 0,
      last: y,
      tail: u,
      tailMode: _,
      treeForkCount: k
    } : (L.isBackwards = s, L.rendering = null, L.renderingStartTime = 0, L.last = y, L.tail = u, L.tailMode = _, L.treeForkCount = k);
  }
  function Ku(i, s, u) {
    var y = s.pendingProps, _ = y.revealOrder, k = y.tail;
    y = y.children;
    var L = hr.current, J = (L & 2) !== 0;
    if (J ? (L = L & 1 | 2, s.flags |= 128) : L &= 1, Y(hr, L), rr(i, s, y, u), y = Jt ? xr : 0, !J && i !== null && (i.flags & 128) !== 0)
      e: for (i = s.child; i !== null; ) {
        if (i.tag === 13)
          i.memoizedState !== null && g0(i, u, s);
        else if (i.tag === 19)
          g0(i, u, s);
        else if (i.child !== null) {
          i.child.return = i, i = i.child;
          continue;
        }
        if (i === s) break e;
        for (; i.sibling === null; ) {
          if (i.return === null || i.return === s)
            break e;
          i = i.return;
        }
        i.sibling.return = i.return, i = i.sibling;
      }
    switch (_) {
      case "forwards":
        for (u = s.child, _ = null; u !== null; )
          i = u.alternate, i !== null && Ad(i) === null && (_ = u), u = u.sibling;
        u = _, u === null ? (_ = s.child, s.child = null) : (_ = u.sibling, u.sibling = null), Gm(
          s,
          !1,
          _,
          u,
          k,
          y
        );
        break;
      case "backwards":
      case "unstable_legacy-backwards":
        for (u = null, _ = s.child, s.child = null; _ !== null; ) {
          if (i = _.alternate, i !== null && Ad(i) === null) {
            s.child = _;
            break;
          }
          i = _.sibling, _.sibling = u, u = _, _ = i;
        }
        Gm(
          s,
          !0,
          u,
          null,
          k,
          y
        );
        break;
      case "together":
        Gm(
          s,
          !1,
          null,
          null,
          void 0,
          y
        );
        break;
      default:
        s.memoizedState = null;
    }
    return s.child;
  }
  function xs(i, s, u) {
    if (i !== null && (s.dependencies = i.dependencies), Ko |= s.lanes, (u & s.childLanes) === 0)
      if (i !== null) {
        if (Mu(
          i,
          s,
          u,
          !1
        ), (u & s.childLanes) === 0)
          return null;
      } else return null;
    if (i !== null && s.child !== i.child)
      throw Error(r(153));
    if (s.child !== null) {
      for (i = s.child, u = pa(i, i.pendingProps), s.child = u, u.return = s; i.sibling !== null; )
        i = i.sibling, u = u.sibling = pa(i, i.pendingProps), u.return = s;
      u.sibling = null;
    }
    return s.child;
  }
  function Xd(i, s) {
    return (i.lanes & s) !== 0 ? !0 : (i = i.dependencies, !!(i !== null && _d(i)));
  }
  function Av(i, s, u) {
    switch (s.tag) {
      case 3:
        qe(s, s.stateNode.containerInfo), Lo(s, wr, i.memoizedState.cache), ee();
        break;
      case 27:
      case 5:
        Pe(s);
        break;
      case 4:
        qe(s, s.stateNode.containerInfo);
        break;
      case 10:
        Lo(
          s,
          s.type,
          s.memoizedProps.value
        );
        break;
      case 31:
        if (s.memoizedState !== null)
          return s.flags |= 128, Gc(s), null;
        break;
      case 13:
        var y = s.memoizedState;
        if (y !== null)
          return y.dehydrated !== null ? (Bo(s), s.flags |= 128, null) : (u & s.child.childLanes) !== 0 ? ei(i, s, u) : (Bo(s), i = xs(
            i,
            s,
            u
          ), i !== null ? i.sibling : null);
        Bo(s);
        break;
      case 19:
        var _ = (i.flags & 128) !== 0;
        if (y = (u & s.childLanes) !== 0, y || (Mu(
          i,
          s,
          u,
          !1
        ), y = (u & s.childLanes) !== 0), _) {
          if (y)
            return Ku(
              i,
              s,
              u
            );
          s.flags |= 128;
        }
        if (_ = s.memoizedState, _ !== null && (_.rendering = null, _.tail = null, _.lastEffect = null), Y(hr, hr.current), y) break;
        return null;
      case 22:
        return s.lanes = 0, Ho(
          i,
          s,
          u,
          s.pendingProps
        );
      case 24:
        Lo(s, wr, i.memoizedState.cache);
    }
    return xs(i, s, u);
  }
  function y0(i, s, u) {
    if (i !== null)
      if (i.memoizedProps !== s.pendingProps)
        Jn = !0;
      else {
        if (!Xd(i, u) && (s.flags & 128) === 0)
          return Jn = !1, Av(
            i,
            s,
            u
          );
        Jn = (i.flags & 131072) !== 0;
      }
    else
      Jn = !1, Jt && (s.flags & 1048576) !== 0 && wd(s, xr, s.index);
    switch (s.lanes = 0, s.tag) {
      case 16:
        e: {
          var y = s.pendingProps;
          if (i = Fa(s.elementType), s.type = i, typeof i == "function")
            Us(i) ? (y = ci(i, y), s.tag = 1, s = Um(
              null,
              s,
              i,
              y,
              u
            )) : (s.tag = 0, s = Yd(
              null,
              s,
              i,
              y,
              u
            ));
          else {
            if (i != null) {
              var _ = i.$$typeof;
              if (_ === z) {
                s.tag = 11, s = Ct(
                  null,
                  s,
                  i,
                  y,
                  u
                );
                break e;
              } else if (_ === P) {
                s.tag = 14, s = sf(
                  null,
                  s,
                  i,
                  y,
                  u
                );
                break e;
              }
            }
            throw s = H(i) || i, Error(r(306, s, ""));
          }
        }
        return s;
      case 0:
        return Yd(
          i,
          s,
          s.type,
          s.pendingProps,
          u
        );
      case 1:
        return y = s.type, _ = ci(
          y,
          s.pendingProps
        ), Um(
          i,
          s,
          y,
          _,
          u
        );
      case 3:
        e: {
          if (qe(
            s,
            s.stateNode.containerInfo
          ), i === null) throw Error(r(387));
          y = s.pendingProps;
          var k = s.memoizedState;
          _ = k.element, Nd(i, s), Lu(s, y, null, u);
          var L = s.memoizedState;
          if (y = L.cache, Lo(s, wr, y), y !== k.cache && fm(
            s,
            [wr],
            u,
            !0
          ), Ul(), y = L.element, k.isDehydrated)
            if (k = {
              element: y,
              isDehydrated: !1,
              cache: L.cache
            }, s.updateQueue.baseState = k, s.memoizedState = k, s.flags & 256) {
              s = p0(
                i,
                s,
                y,
                u
              );
              break e;
            } else if (y !== _) {
              _ = Fi(
                Error(r(424)),
                s
              ), Io(_), s = p0(
                i,
                s,
                y,
                u
              );
              break e;
            } else {
              switch (i = s.stateNode.containerInfo, i.nodeType) {
                case 9:
                  i = i.body;
                  break;
                default:
                  i = i.nodeName === "HTML" ? i.ownerDocument.body : i;
              }
              for (pn = ka(i.firstChild), br = s, Jt = !0, Oo = null, xa = !0, u = pm(
                s,
                null,
                y,
                u
              ), s.child = u; u; )
                u.flags = u.flags & -3 | 4096, u = u.sibling;
            }
          else {
            if (ee(), y === _) {
              s = xs(
                i,
                s,
                u
              );
              break e;
            }
            rr(i, s, y, u);
          }
          s = s.child;
        }
        return s;
      case 26:
        return Kd(i, s), i === null ? (u = uy(
          s.type,
          null,
          s.pendingProps,
          null
        )) ? s.memoizedState = u : Jt || (u = s.type, i = s.pendingProps, y = Af(
          Se.current
        ).createElement(u), y[bn] = s, y[Xn] = i, Gr(y, u, i), Qn(y), s.stateNode = y) : s.memoizedState = uy(
          s.type,
          i.memoizedProps,
          s.pendingProps,
          i.memoizedState
        ), null;
      case 27:
        return Pe(s), i === null && Jt && (y = s.stateNode = sy(
          s.type,
          s.pendingProps,
          Se.current
        ), br = s, xa = !0, _ = pn, Tt(s.type) ? (jp = _, pn = ka(y.firstChild)) : pn = _), rr(
          i,
          s,
          s.pendingProps.children,
          u
        ), Kd(i, s), i === null && (s.flags |= 4194304), s.child;
      case 5:
        return i === null && Jt && ((_ = y = pn) && (y = Vv(
          y,
          s.type,
          s.pendingProps,
          xa
        ), y !== null ? (s.stateNode = y, br = s, pn = ka(y.firstChild), xa = !1, _ = !0) : _ = !1), _ || zo(s)), Pe(s), _ = s.type, k = s.pendingProps, L = i !== null ? i.memoizedProps : null, y = k.children, Zo(_, k) ? y = null : L !== null && Zo(_, L) && (s.flags |= 32), s.memoizedState !== null && (_ = Od(
          i,
          s,
          kv,
          null,
          null,
          u
        ), lc._currentValue = _), Kd(i, s), rr(i, s, y, u), s.child;
      case 6:
        return i === null && Jt && ((i = u = pn) && (u = gn(
          u,
          s.pendingProps,
          xa
        ), u !== null ? (s.stateNode = u, br = s, pn = null, i = !0) : i = !1), i || zo(s)), null;
      case 13:
        return ei(i, s, u);
      case 4:
        return qe(
          s,
          s.stateNode.containerInfo
        ), y = s.pendingProps, i === null ? s.child = Po(
          s,
          null,
          y,
          u
        ) : rr(i, s, y, u), s.child;
      case 11:
        return Ct(
          i,
          s,
          s.type,
          s.pendingProps,
          u
        );
      case 7:
        return rr(
          i,
          s,
          s.pendingProps,
          u
        ), s.child;
      case 8:
        return rr(
          i,
          s,
          s.pendingProps.children,
          u
        ), s.child;
      case 12:
        return rr(
          i,
          s,
          s.pendingProps.children,
          u
        ), s.child;
      case 10:
        return y = s.pendingProps, Lo(s, s.type, y.value), rr(i, s, y.children, u), s.child;
      case 9:
        return _ = s.type._context, y = s.pendingProps.children, ql(s), _ = Ur(_), y = y(_), s.flags |= 1, rr(i, s, y, u), s.child;
      case 14:
        return sf(
          i,
          s,
          s.type,
          s.pendingProps,
          u
        );
      case 15:
        return Gd(
          i,
          s,
          s.type,
          s.pendingProps,
          u
        );
      case 19:
        return Ku(i, s, u);
      case 31:
        return Tv(i, s, u);
      case 22:
        return Ho(
          i,
          s,
          u,
          s.pendingProps
        );
      case 24:
        return ql(s), y = Ur(wr), i === null ? (_ = hm(), _ === null && (_ = Tn, k = Ba(), _.pooledCache = k, k.refCount++, k !== null && (_.pooledCacheLanes |= u), _ = k), s.memoizedState = { parent: y, cache: _ }, gs(s), Lo(s, wr, _)) : ((i.lanes & u) !== 0 && (Nd(i, s), Lu(s, null, null, u), Ul()), _ = i.memoizedState, k = s.memoizedState, _.parent !== y ? (_ = { parent: y, cache: y }, s.memoizedState = _, s.lanes === 0 && (s.memoizedState = s.updateQueue.baseState = _), Lo(s, wr, y)) : (y = k.cache, Lo(s, wr, y), y !== _.cache && fm(
          s,
          [wr],
          u,
          !0
        ))), rr(
          i,
          s,
          s.pendingProps.children,
          u
        ), s.child;
      case 29:
        throw s.pendingProps;
    }
    throw Error(r(156, s.tag));
  }
  function Ws(i) {
    i.flags |= 4;
  }
  function Vm(i, s, u, y, _) {
    if ((s = (i.mode & 32) !== 0) && (s = !1), s) {
      if (i.flags |= 16777216, (_ & 335544128) === _)
        if (i.stateNode.complete) i.flags |= 8192;
        else if (wf()) i.flags |= 8192;
        else
          throw ps = Ed, Cd;
    } else i.flags &= -16777217;
  }
  function Km(i, s) {
    if (s.type !== "stylesheet" || (s.state.loading & 4) !== 0)
      i.flags &= -16777217;
    else if (i.flags |= 16777216, !my(s))
      if (wf()) i.flags |= 8192;
      else
        throw ps = Ed, Cd;
  }
  function ff(i, s) {
    s !== null && (i.flags |= 4), i.flags & 16384 && (s = i.tag !== 22 ? bl() : 536870912, i.lanes |= s, Qu |= s);
  }
  function df(i, s) {
    if (!Jt)
      switch (i.tailMode) {
        case "hidden":
          s = i.tail;
          for (var u = null; s !== null; )
            s.alternate !== null && (u = s), s = s.sibling;
          u === null ? i.tail = null : u.sibling = null;
          break;
        case "collapsed":
          u = i.tail;
          for (var y = null; u !== null; )
            u.alternate !== null && (y = u), u = u.sibling;
          y === null ? s || i.tail === null ? i.tail = null : i.tail.sibling = null : y.sibling = null;
      }
  }
  function jn(i) {
    var s = i.alternate !== null && i.alternate.child === i.child, u = 0, y = 0;
    if (s)
      for (var _ = i.child; _ !== null; )
        u |= _.lanes | _.childLanes, y |= _.subtreeFlags & 65011712, y |= _.flags & 65011712, _.return = i, _ = _.sibling;
    else
      for (_ = i.child; _ !== null; )
        u |= _.lanes | _.childLanes, y |= _.subtreeFlags, y |= _.flags, _.return = i, _ = _.sibling;
    return i.subtreeFlags |= y, i.childLanes = u, s;
  }
  function v0(i, s, u) {
    var y = s.pendingProps;
    switch (Ll(s), s.tag) {
      case 16:
      case 15:
      case 0:
      case 11:
      case 7:
      case 8:
      case 12:
      case 9:
      case 14:
        return jn(s), null;
      case 1:
        return jn(s), null;
      case 3:
        return u = s.stateNode, y = null, i !== null && (y = i.memoizedState.cache), s.memoizedState.cache !== y && (s.flags |= 2048), Gs(wr), Me(), u.pendingContext && (u.context = u.pendingContext, u.pendingContext = null), (i === null || i.child === null) && (Pl(s) ? Ws(s) : i === null || i.memoizedState.isDehydrated && (s.flags & 256) === 0 || (s.flags |= 1024, Do())), jn(s), null;
      case 26:
        var _ = s.type, k = s.memoizedState;
        return i === null ? (Ws(s), k !== null ? (jn(s), Km(s, k)) : (jn(s), Vm(
          s,
          _,
          null,
          y,
          u
        ))) : k ? k !== i.memoizedState ? (Ws(s), jn(s), Km(s, k)) : (jn(s), s.flags &= -16777217) : (i = i.memoizedProps, i !== y && Ws(s), jn(s), Vm(
          s,
          _,
          i,
          y,
          u
        )), null;
      case 27:
        if (Re(s), u = Se.current, _ = s.type, i !== null && s.stateNode != null)
          i.memoizedProps !== y && Ws(s);
        else {
          if (!y) {
            if (s.stateNode === null)
              throw Error(r(166));
            return jn(s), null;
          }
          i = le.current, Pl(s) ? qc(s) : (i = sy(_, y, u), s.stateNode = i, Ws(s));
        }
        return jn(s), null;
      case 5:
        if (Re(s), _ = s.type, i !== null && s.stateNode != null)
          i.memoizedProps !== y && Ws(s);
        else {
          if (!y) {
            if (s.stateNode === null)
              throw Error(r(166));
            return jn(s), null;
          }
          if (k = le.current, Pl(s))
            qc(s);
          else {
            var L = Af(
              Se.current
            );
            switch (k) {
              case 1:
                k = L.createElementNS(
                  "http://www.w3.org/2000/svg",
                  _
                );
                break;
              case 2:
                k = L.createElementNS(
                  "http://www.w3.org/1998/Math/MathML",
                  _
                );
                break;
              default:
                switch (_) {
                  case "svg":
                    k = L.createElementNS(
                      "http://www.w3.org/2000/svg",
                      _
                    );
                    break;
                  case "math":
                    k = L.createElementNS(
                      "http://www.w3.org/1998/Math/MathML",
                      _
                    );
                    break;
                  case "script":
                    k = L.createElement("div"), k.innerHTML = "<script><\/script>", k = k.removeChild(
                      k.firstChild
                    );
                    break;
                  case "select":
                    k = typeof y.is == "string" ? L.createElement("select", {
                      is: y.is
                    }) : L.createElement("select"), y.multiple ? k.multiple = !0 : y.size && (k.size = y.size);
                    break;
                  default:
                    k = typeof y.is == "string" ? L.createElement(_, { is: y.is }) : L.createElement(_);
                }
            }
            k[bn] = s, k[Xn] = y;
            e: for (L = s.child; L !== null; ) {
              if (L.tag === 5 || L.tag === 6)
                k.appendChild(L.stateNode);
              else if (L.tag !== 4 && L.tag !== 27 && L.child !== null) {
                L.child.return = L, L = L.child;
                continue;
              }
              if (L === s) break e;
              for (; L.sibling === null; ) {
                if (L.return === null || L.return === s)
                  break e;
                L = L.return;
              }
              L.sibling.return = L.return, L = L.sibling;
            }
            s.stateNode = k;
            e: switch (Gr(k, _, y), _) {
              case "button":
              case "input":
              case "select":
              case "textarea":
                y = !!y.autoFocus;
                break e;
              case "img":
                y = !0;
                break e;
              default:
                y = !1;
            }
            y && Ws(s);
          }
        }
        return jn(s), Vm(
          s,
          s.type,
          i === null ? null : i.memoizedProps,
          s.pendingProps,
          u
        ), null;
      case 6:
        if (i && s.stateNode != null)
          i.memoizedProps !== y && Ws(s);
        else {
          if (typeof y != "string" && s.stateNode === null)
            throw Error(r(166));
          if (i = Se.current, Pl(s)) {
            if (i = s.stateNode, u = s.memoizedProps, y = null, _ = br, _ !== null)
              switch (_.tag) {
                case 27:
                case 5:
                  y = _.memoizedProps;
              }
            i[bn] = s, i = !!(i.nodeValue === u || y !== null && y.suppressHydrationWarning === !0 || J0(i.nodeValue, u)), i || zo(s, !0);
          } else
            i = Af(i).createTextNode(
              y
            ), i[bn] = s, s.stateNode = i;
        }
        return jn(s), null;
      case 31:
        if (u = s.memoizedState, i === null || i.memoizedState !== null) {
          if (y = Pl(s), u !== null) {
            if (i === null) {
              if (!y) throw Error(r(318));
              if (i = s.memoizedState, i = i !== null ? i.dehydrated : null, !i) throw Error(r(557));
              i[bn] = s;
            } else
              ee(), (s.flags & 128) === 0 && (s.memoizedState = null), s.flags |= 4;
            jn(s), i = !1;
          } else
            u = Do(), i !== null && i.memoizedState !== null && (i.memoizedState.hydrationErrors = u), i = !0;
          if (!i)
            return s.flags & 256 ? (bi(s), s) : (bi(s), null);
          if ((s.flags & 128) !== 0)
            throw Error(r(558));
        }
        return jn(s), null;
      case 13:
        if (y = s.memoizedState, i === null || i.memoizedState !== null && i.memoizedState.dehydrated !== null) {
          if (_ = Pl(s), y !== null && y.dehydrated !== null) {
            if (i === null) {
              if (!_) throw Error(r(318));
              if (_ = s.memoizedState, _ = _ !== null ? _.dehydrated : null, !_) throw Error(r(317));
              _[bn] = s;
            } else
              ee(), (s.flags & 128) === 0 && (s.memoizedState = null), s.flags |= 4;
            jn(s), _ = !1;
          } else
            _ = Do(), i !== null && i.memoizedState !== null && (i.memoizedState.hydrationErrors = _), _ = !0;
          if (!_)
            return s.flags & 256 ? (bi(s), s) : (bi(s), null);
        }
        return bi(s), (s.flags & 128) !== 0 ? (s.lanes = u, s) : (u = y !== null, i = i !== null && i.memoizedState !== null, u && (y = s.child, _ = null, y.alternate !== null && y.alternate.memoizedState !== null && y.alternate.memoizedState.cachePool !== null && (_ = y.alternate.memoizedState.cachePool.pool), k = null, y.memoizedState !== null && y.memoizedState.cachePool !== null && (k = y.memoizedState.cachePool.pool), k !== _ && (y.flags |= 2048)), u !== i && u && (s.child.flags |= 8192), ff(s, s.updateQueue), jn(s), null);
      case 4:
        return Me(), i === null && wp(s.stateNode.containerInfo), jn(s), null;
      case 10:
        return Gs(s.type), jn(s), null;
      case 19:
        if (ue(hr), y = s.memoizedState, y === null) return jn(s), null;
        if (_ = (s.flags & 128) !== 0, k = y.rendering, k === null)
          if (_) df(y, !1);
          else {
            if (er !== 0 || i !== null && (i.flags & 128) !== 0)
              for (i = s.child; i !== null; ) {
                if (k = Ad(i), k !== null) {
                  for (s.flags |= 128, df(y, !1), i = k.updateQueue, s.updateQueue = i, ff(s, i), s.subtreeFlags = 0, i = u, u = s.child; u !== null; )
                    Gg(u, i), u = u.sibling;
                  return Y(
                    hr,
                    hr.current & 1 | 2
                  ), Jt && Ui(s, y.treeForkCount), s.child;
                }
                i = i.sibling;
              }
            y.tail !== null && Cn() > Kl && (s.flags |= 128, _ = !0, df(y, !1), s.lanes = 4194304);
          }
        else {
          if (!_)
            if (i = Ad(k), i !== null) {
              if (s.flags |= 128, _ = !0, i = i.updateQueue, s.updateQueue = i, ff(s, i), df(y, !0), y.tail === null && y.tailMode === "hidden" && !k.alternate && !Jt)
                return jn(s), null;
            } else
              2 * Cn() - y.renderingStartTime > Kl && u !== 536870912 && (s.flags |= 128, _ = !0, df(y, !1), s.lanes = 4194304);
          y.isBackwards ? (k.sibling = s.child, s.child = k) : (i = y.last, i !== null ? i.sibling = k : s.child = k, y.last = k);
        }
        return y.tail !== null ? (i = y.tail, y.rendering = i, y.tail = i.sibling, y.renderingStartTime = Cn(), i.sibling = null, u = hr.current, Y(
          hr,
          _ ? u & 1 | 2 : u & 1
        ), Jt && Ui(s, y.treeForkCount), i) : (jn(s), null);
      case 22:
      case 23:
        return bi(s), Hc(), y = s.memoizedState !== null, i !== null ? i.memoizedState !== null !== y && (s.flags |= 8192) : y && (s.flags |= 8192), y ? (u & 536870912) !== 0 && (s.flags & 128) === 0 && (jn(s), s.subtreeFlags & 6 && (s.flags |= 8192)) : jn(s), u = s.updateQueue, u !== null && ff(s, u.retryQueue), u = null, i !== null && i.memoizedState !== null && i.memoizedState.cachePool !== null && (u = i.memoizedState.cachePool.pool), y = null, s.memoizedState !== null && s.memoizedState.cachePool !== null && (y = s.memoizedState.cachePool.pool), y !== u && (s.flags |= 2048), i !== null && ue(Fl), null;
      case 24:
        return u = null, i !== null && (u = i.memoizedState.cache), s.memoizedState.cache !== u && (s.flags |= 2048), Gs(wr), jn(s), null;
      case 25:
        return null;
      case 30:
        return null;
    }
    throw Error(r(156, s.tag));
  }
  function hf(i, s) {
    switch (Ll(s), s.tag) {
      case 1:
        return i = s.flags, i & 65536 ? (s.flags = i & -65537 | 128, s) : null;
      case 3:
        return Gs(wr), Me(), i = s.flags, (i & 65536) !== 0 && (i & 128) === 0 ? (s.flags = i & -65537 | 128, s) : null;
      case 26:
      case 27:
      case 5:
        return Re(s), null;
      case 31:
        if (s.memoizedState !== null) {
          if (bi(s), s.alternate === null)
            throw Error(r(340));
          ee();
        }
        return i = s.flags, i & 65536 ? (s.flags = i & -65537 | 128, s) : null;
      case 13:
        if (bi(s), i = s.memoizedState, i !== null && i.dehydrated !== null) {
          if (s.alternate === null)
            throw Error(r(340));
          ee();
        }
        return i = s.flags, i & 65536 ? (s.flags = i & -65537 | 128, s) : null;
      case 19:
        return ue(hr), null;
      case 4:
        return Me(), null;
      case 10:
        return Gs(s.type), null;
      case 22:
      case 23:
        return bi(s), Hc(), i !== null && ue(Fl), i = s.flags, i & 65536 ? (s.flags = i & -65537 | 128, s) : null;
      case 24:
        return Gs(wr), null;
      case 25:
        return null;
      default:
        return null;
    }
  }
  function Qd(i, s) {
    switch (Ll(s), s.tag) {
      case 3:
        Gs(wr), Me();
        break;
      case 26:
      case 27:
      case 5:
        Re(s);
        break;
      case 4:
        Me();
        break;
      case 31:
        s.memoizedState !== null && bi(s);
        break;
      case 13:
        bi(s);
        break;
      case 19:
        ue(hr);
        break;
      case 10:
        Gs(s.type);
        break;
      case 22:
      case 23:
        bi(s), Hc(), i !== null && ue(Fl);
        break;
      case 24:
        Gs(wr);
    }
  }
  function Yu(i, s) {
    try {
      var u = s.updateQueue, y = u !== null ? u.lastEffect : null;
      if (y !== null) {
        var _ = y.next;
        u = _;
        do {
          if ((u.tag & i) === i) {
            y = void 0;
            var k = u.create, L = u.inst;
            y = k(), L.destroy = y;
          }
          u = u.next;
        } while (u !== _);
      }
    } catch (J) {
      xn(s, s.return, J);
    }
  }
  function Xs(i, s, u) {
    try {
      var y = s.updateQueue, _ = y !== null ? y.lastEffect : null;
      if (_ !== null) {
        var k = _.next;
        y = k;
        do {
          if ((y.tag & i) === i) {
            var L = y.inst, J = L.destroy;
            if (J !== void 0) {
              L.destroy = void 0, _ = s;
              var ve = u, De = J;
              try {
                De();
              } catch (He) {
                xn(
                  _,
                  ve,
                  He
                );
              }
            }
          }
          y = y.next;
        } while (y !== k);
      }
    } catch (He) {
      xn(s, s.return, He);
    }
  }
  function mf(i) {
    var s = i.updateQueue;
    if (s !== null) {
      var u = i.stateNode;
      try {
        Td(s, u);
      } catch (y) {
        xn(i, i.return, y);
      }
    }
  }
  function Ym(i, s, u) {
    u.props = ci(
      i.type,
      i.memoizedProps
    ), u.state = i.memoizedState;
    try {
      u.componentWillUnmount();
    } catch (y) {
      xn(i, s, y);
    }
  }
  function _i(i, s) {
    try {
      var u = i.ref;
      if (u !== null) {
        switch (i.tag) {
          case 26:
          case 27:
          case 5:
            var y = i.stateNode;
            break;
          case 30:
            y = i.stateNode;
            break;
          default:
            y = i.stateNode;
        }
        typeof u == "function" ? i.refCleanup = u(y) : u.current = y;
      }
    } catch (_) {
      xn(i, s, _);
    }
  }
  function ti(i, s) {
    var u = i.ref, y = i.refCleanup;
    if (u !== null)
      if (typeof y == "function")
        try {
          y();
        } catch (_) {
          xn(i, s, _);
        } finally {
          i.refCleanup = null, i = i.alternate, i != null && (i.refCleanup = null);
        }
      else if (typeof u == "function")
        try {
          u(null);
        } catch (_) {
          xn(i, s, _);
        }
      else u.current = null;
  }
  function x0(i) {
    var s = i.type, u = i.memoizedProps, y = i.stateNode;
    try {
      e: switch (s) {
        case "button":
        case "input":
        case "select":
        case "textarea":
          u.autoFocus && y.focus();
          break e;
        case "img":
          u.src ? y.src = u.src : u.srcSet && (y.srcset = u.srcSet);
      }
    } catch (_) {
      xn(i, i.return, _);
    }
  }
  function Zd(i, s, u) {
    try {
      var y = i.stateNode;
      $v(y, i.type, u, s), y[Xn] = s;
    } catch (_) {
      xn(i, i.return, _);
    }
  }
  function b0(i) {
    return i.tag === 5 || i.tag === 3 || i.tag === 26 || i.tag === 27 && Tt(i.type) || i.tag === 4;
  }
  function Wm(i) {
    e: for (; ; ) {
      for (; i.sibling === null; ) {
        if (i.return === null || b0(i.return)) return null;
        i = i.return;
      }
      for (i.sibling.return = i.return, i = i.sibling; i.tag !== 5 && i.tag !== 6 && i.tag !== 18; ) {
        if (i.tag === 27 && Tt(i.type) || i.flags & 2 || i.child === null || i.tag === 4) continue e;
        i.child.return = i, i = i.child;
      }
      if (!(i.flags & 2)) return i.stateNode;
    }
  }
  function Xm(i, s, u) {
    var y = i.tag;
    if (y === 5 || y === 6)
      i = i.stateNode, s ? (u.nodeType === 9 ? u.body : u.nodeName === "HTML" ? u.ownerDocument.body : u).insertBefore(i, s) : (s = u.nodeType === 9 ? u.body : u.nodeName === "HTML" ? u.ownerDocument.body : u, s.appendChild(i), u = u._reactRootContainer, u != null || s.onclick !== null || (s.onclick = vi));
    else if (y !== 4 && (y === 27 && Tt(i.type) && (u = i.stateNode, s = null), i = i.child, i !== null))
      for (Xm(i, s, u), i = i.sibling; i !== null; )
        Xm(i, s, u), i = i.sibling;
  }
  function Jd(i, s, u) {
    var y = i.tag;
    if (y === 5 || y === 6)
      i = i.stateNode, s ? u.insertBefore(i, s) : u.appendChild(i);
    else if (y !== 4 && (y === 27 && Tt(i.type) && (u = i.stateNode), i = i.child, i !== null))
      for (Jd(i, s, u), i = i.sibling; i !== null; )
        Jd(i, s, u), i = i.sibling;
  }
  function w0(i) {
    var s = i.stateNode, u = i.memoizedProps;
    try {
      for (var y = i.type, _ = s.attributes; _.length; )
        s.removeAttributeNode(_[0]);
      Gr(s, y, u), s[bn] = i, s[Xn] = u;
    } catch (k) {
      xn(i, i.return, k);
    }
  }
  var Qs = !1, _r = !1, Qm = !1, _0 = typeof WeakSet == "function" ? WeakSet : Set, Mr = null;
  function Mv(i, s) {
    if (i = i.containerInfo, Tf = bh, i = B(i), W(i)) {
      if ("selectionStart" in i)
        var u = {
          start: i.selectionStart,
          end: i.selectionEnd
        };
      else
        e: {
          u = (u = i.ownerDocument) && u.defaultView || window;
          var y = u.getSelection && u.getSelection();
          if (y && y.rangeCount !== 0) {
            u = y.anchorNode;
            var _ = y.anchorOffset, k = y.focusNode;
            y = y.focusOffset;
            try {
              u.nodeType, k.nodeType;
            } catch {
              u = null;
              break e;
            }
            var L = 0, J = -1, ve = -1, De = 0, He = 0, Ye = i, Le = null;
            t: for (; ; ) {
              for (var Fe; Ye !== u || _ !== 0 && Ye.nodeType !== 3 || (J = L + _), Ye !== k || y !== 0 && Ye.nodeType !== 3 || (ve = L + y), Ye.nodeType === 3 && (L += Ye.nodeValue.length), (Fe = Ye.firstChild) !== null; )
                Le = Ye, Ye = Fe;
              for (; ; ) {
                if (Ye === i) break t;
                if (Le === u && ++De === _ && (J = L), Le === k && ++He === y && (ve = L), (Fe = Ye.nextSibling) !== null) break;
                Ye = Le, Le = Ye.parentNode;
              }
              Ye = Fe;
            }
            u = J === -1 || ve === -1 ? null : { start: J, end: ve };
          } else u = null;
        }
      u = u || { start: 0, end: 0 };
    } else u = null;
    for (Ep = { focusedElem: i, selectionRange: u }, bh = !1, Mr = s; Mr !== null; )
      if (s = Mr, i = s.child, (s.subtreeFlags & 1028) !== 0 && i !== null)
        i.return = s, Mr = i;
      else
        for (; Mr !== null; ) {
          switch (s = Mr, k = s.alternate, i = s.flags, s.tag) {
            case 0:
              if ((i & 4) !== 0 && (i = s.updateQueue, i = i !== null ? i.events : null, i !== null))
                for (u = 0; u < i.length; u++)
                  _ = i[u], _.ref.impl = _.nextImpl;
              break;
            case 11:
            case 15:
              break;
            case 1:
              if ((i & 1024) !== 0 && k !== null) {
                i = void 0, u = s, _ = k.memoizedProps, k = k.memoizedState, y = u.stateNode;
                try {
                  var yt = ci(
                    u.type,
                    _
                  );
                  i = y.getSnapshotBeforeUpdate(
                    yt,
                    k
                  ), y.__reactInternalSnapshotBeforeUpdate = i;
                } catch (kt) {
                  xn(
                    u,
                    u.return,
                    kt
                  );
                }
              }
              break;
            case 3:
              if ((i & 1024) !== 0) {
                if (i = s.stateNode.containerInfo, u = i.nodeType, u === 9)
                  dh(i);
                else if (u === 1)
                  switch (i.nodeName) {
                    case "HEAD":
                    case "HTML":
                    case "BODY":
                      dh(i);
                      break;
                    default:
                      i.textContent = "";
                  }
              }
              break;
            case 5:
            case 26:
            case 27:
            case 6:
            case 4:
            case 17:
              break;
            default:
              if ((i & 1024) !== 0) throw Error(r(163));
          }
          if (i = s.sibling, i !== null) {
            i.return = s.return, Mr = i;
            break;
          }
          Mr = s.return;
        }
  }
  function Zm(i, s, u) {
    var y = u.flags;
    switch (u.tag) {
      case 0:
      case 11:
      case 15:
        Js(i, u), y & 4 && Yu(5, u);
        break;
      case 1:
        if (Js(i, u), y & 4)
          if (i = u.stateNode, s === null)
            try {
              i.componentDidMount();
            } catch (L) {
              xn(u, u.return, L);
            }
          else {
            var _ = ci(
              u.type,
              s.memoizedProps
            );
            s = s.memoizedState;
            try {
              i.componentDidUpdate(
                _,
                s,
                i.__reactInternalSnapshotBeforeUpdate
              );
            } catch (L) {
              xn(
                u,
                u.return,
                L
              );
            }
          }
        y & 64 && mf(u), y & 512 && _i(u, u.return);
        break;
      case 3:
        if (Js(i, u), y & 64 && (i = u.updateQueue, i !== null)) {
          if (s = null, u.child !== null)
            switch (u.child.tag) {
              case 27:
              case 5:
                s = u.child.stateNode;
                break;
              case 1:
                s = u.child.stateNode;
            }
          try {
            Td(i, s);
          } catch (L) {
            xn(u, u.return, L);
          }
        }
        break;
      case 27:
        s === null && y & 4 && w0(u);
      case 26:
      case 5:
        Js(i, u), s === null && y & 4 && x0(u), y & 512 && _i(u, u.return);
        break;
      case 12:
        Js(i, u);
        break;
      case 31:
        Js(i, u), y & 4 && ep(i, u);
        break;
      case 13:
        Js(i, u), y & 4 && C0(i, u), y & 64 && (i = u.memoizedState, i !== null && (i = i.dehydrated, i !== null && (u = oh.bind(
          null,
          u
        ), Kv(i, u))));
        break;
      case 22:
        if (y = u.memoizedState !== null || Qs, !y) {
          s = s !== null && s.memoizedState !== null || _r, _ = Qs;
          var k = _r;
          Qs = y, (_r = s) && !k ? bs(
            i,
            u,
            (u.subtreeFlags & 8772) !== 0
          ) : Js(i, u), Qs = _, _r = k;
        }
        break;
      case 30:
        break;
      default:
        Js(i, u);
    }
  }
  function Jm(i) {
    var s = i.alternate;
    s !== null && (i.alternate = null, Jm(s)), i.child = null, i.deletions = null, i.sibling = null, i.tag === 5 && (s = i.stateNode, s !== null && bo(s)), i.stateNode = null, i.return = null, i.dependencies = null, i.memoizedProps = null, i.memoizedState = null, i.pendingProps = null, i.stateNode = null, i.updateQueue = null;
  }
  var Pn = null, Si = !1;
  function Zs(i, s, u) {
    for (u = u.child; u !== null; )
      S0(i, s, u), u = u.sibling;
  }
  function S0(i, s, u) {
    if (Qt && typeof Qt.onCommitFiberUnmount == "function")
      try {
        Qt.onCommitFiberUnmount(an, u);
      } catch {
      }
    switch (u.tag) {
      case 26:
        _r || ti(u, s), Zs(
          i,
          s,
          u
        ), u.memoizedState ? u.memoizedState.count-- : u.stateNode && (u = u.stateNode, u.parentNode.removeChild(u));
        break;
      case 27:
        _r || ti(u, s);
        var y = Pn, _ = Si;
        Tt(u.type) && (Pn = u.stateNode, Si = !1), Zs(
          i,
          s,
          u
        ), Rf(u.stateNode), Pn = y, Si = _;
        break;
      case 5:
        _r || ti(u, s);
      case 6:
        if (y = Pn, _ = Si, Pn = null, Zs(
          i,
          s,
          u
        ), Pn = y, Si = _, Pn !== null)
          if (Si)
            try {
              (Pn.nodeType === 9 ? Pn.body : Pn.nodeName === "HTML" ? Pn.ownerDocument.body : Pn).removeChild(u.stateNode);
            } catch (k) {
              xn(
                u,
                s,
                k
              );
            }
          else
            try {
              Pn.removeChild(u.stateNode);
            } catch (k) {
              xn(
                u,
                s,
                k
              );
            }
        break;
      case 18:
        Pn !== null && (Si ? (i = Pn, Np(
          i.nodeType === 9 ? i.body : i.nodeName === "HTML" ? i.ownerDocument.body : i,
          u.stateNode
        ), cc(i)) : Np(Pn, u.stateNode));
        break;
      case 4:
        y = Pn, _ = Si, Pn = u.stateNode.containerInfo, Si = !0, Zs(
          i,
          s,
          u
        ), Pn = y, Si = _;
        break;
      case 0:
      case 11:
      case 14:
      case 15:
        Xs(2, u, s), _r || Xs(4, u, s), Zs(
          i,
          s,
          u
        );
        break;
      case 1:
        _r || (ti(u, s), y = u.stateNode, typeof y.componentWillUnmount == "function" && Ym(
          u,
          s,
          y
        )), Zs(
          i,
          s,
          u
        );
        break;
      case 21:
        Zs(
          i,
          s,
          u
        );
        break;
      case 22:
        _r = (y = _r) || u.memoizedState !== null, Zs(
          i,
          s,
          u
        ), _r = y;
        break;
      default:
        Zs(
          i,
          s,
          u
        );
    }
  }
  function ep(i, s) {
    if (s.memoizedState === null && (i = s.alternate, i !== null && (i = i.memoizedState, i !== null))) {
      i = i.dehydrated;
      try {
        cc(i);
      } catch (u) {
        xn(s, s.return, u);
      }
    }
  }
  function C0(i, s) {
    if (s.memoizedState === null && (i = s.alternate, i !== null && (i = i.memoizedState, i !== null && (i = i.dehydrated, i !== null))))
      try {
        cc(i);
      } catch (u) {
        xn(s, s.return, u);
      }
  }
  function Rv(i) {
    switch (i.tag) {
      case 31:
      case 13:
      case 19:
        var s = i.stateNode;
        return s === null && (s = i.stateNode = new _0()), s;
      case 22:
        return i = i.stateNode, s = i._retryCache, s === null && (s = i._retryCache = new _0()), s;
      default:
        throw Error(r(435, i.tag));
    }
  }
  function eh(i, s) {
    var u = Rv(i);
    s.forEach(function(y) {
      if (!u.has(y)) {
        u.add(y);
        var _ = qv.bind(null, i, y);
        y.then(_, _);
      }
    });
  }
  function Ci(i, s) {
    var u = s.deletions;
    if (u !== null)
      for (var y = 0; y < u.length; y++) {
        var _ = u[y], k = i, L = s, J = L;
        e: for (; J !== null; ) {
          switch (J.tag) {
            case 27:
              if (Tt(J.type)) {
                Pn = J.stateNode, Si = !1;
                break e;
              }
              break;
            case 5:
              Pn = J.stateNode, Si = !1;
              break e;
            case 3:
            case 4:
              Pn = J.stateNode.containerInfo, Si = !0;
              break e;
          }
          J = J.return;
        }
        if (Pn === null) throw Error(r(160));
        S0(k, L, _), Pn = null, Si = !1, k = _.alternate, k !== null && (k.return = null), _.return = null;
      }
    if (s.subtreeFlags & 13886)
      for (s = s.child; s !== null; )
        E0(s, i), s = s.sibling;
  }
  var Ya = null;
  function E0(i, s) {
    var u = i.alternate, y = i.flags;
    switch (i.tag) {
      case 0:
      case 11:
      case 14:
      case 15:
        Ci(s, i), qn(i), y & 4 && (Xs(3, i, i.return), Yu(3, i), Xs(5, i, i.return));
        break;
      case 1:
        Ci(s, i), qn(i), y & 512 && (_r || u === null || ti(u, u.return)), y & 64 && Qs && (i = i.updateQueue, i !== null && (y = i.callbacks, y !== null && (u = i.shared.hiddenCallbacks, i.shared.hiddenCallbacks = u === null ? y : u.concat(y))));
        break;
      case 26:
        var _ = Ya;
        if (Ci(s, i), qn(i), y & 512 && (_r || u === null || ti(u, u.return)), y & 4) {
          var k = u !== null ? u.memoizedState : null;
          if (y = i.memoizedState, u === null)
            if (y === null)
              if (i.stateNode === null) {
                e: {
                  y = i.type, u = i.memoizedProps, _ = _.ownerDocument || _;
                  t: switch (y) {
                    case "title":
                      k = _.getElementsByTagName("title")[0], (!k || k[ri] || k[bn] || k.namespaceURI === "http://www.w3.org/2000/svg" || k.hasAttribute("itemprop")) && (k = _.createElement(y), _.head.insertBefore(
                        k,
                        _.querySelector("head > title")
                      )), Gr(k, y, u), k[bn] = i, Qn(k), y = k;
                      break e;
                    case "link":
                      var L = dy(
                        "link",
                        "href",
                        _
                      ).get(y + (u.href || ""));
                      if (L) {
                        for (var J = 0; J < L.length; J++)
                          if (k = L[J], k.getAttribute("href") === (u.href == null || u.href === "" ? null : u.href) && k.getAttribute("rel") === (u.rel == null ? null : u.rel) && k.getAttribute("title") === (u.title == null ? null : u.title) && k.getAttribute("crossorigin") === (u.crossOrigin == null ? null : u.crossOrigin)) {
                            L.splice(J, 1);
                            break t;
                          }
                      }
                      k = _.createElement(y), Gr(k, y, u), _.head.appendChild(k);
                      break;
                    case "meta":
                      if (L = dy(
                        "meta",
                        "content",
                        _
                      ).get(y + (u.content || ""))) {
                        for (J = 0; J < L.length; J++)
                          if (k = L[J], k.getAttribute("content") === (u.content == null ? null : "" + u.content) && k.getAttribute("name") === (u.name == null ? null : u.name) && k.getAttribute("property") === (u.property == null ? null : u.property) && k.getAttribute("http-equiv") === (u.httpEquiv == null ? null : u.httpEquiv) && k.getAttribute("charset") === (u.charSet == null ? null : u.charSet)) {
                            L.splice(J, 1);
                            break t;
                          }
                      }
                      k = _.createElement(y), Gr(k, y, u), _.head.appendChild(k);
                      break;
                    default:
                      throw Error(r(468, y));
                  }
                  k[bn] = i, Qn(k), y = k;
                }
                i.stateNode = y;
              } else
                hy(
                  _,
                  i.type,
                  i.stateNode
                );
            else
              i.stateNode = fy(
                _,
                y,
                i.memoizedProps
              );
          else
            k !== y ? (k === null ? u.stateNode !== null && (u = u.stateNode, u.parentNode.removeChild(u)) : k.count--, y === null ? hy(
              _,
              i.type,
              i.stateNode
            ) : fy(
              _,
              y,
              i.memoizedProps
            )) : y === null && i.stateNode !== null && Zd(
              i,
              i.memoizedProps,
              u.memoizedProps
            );
        }
        break;
      case 27:
        Ci(s, i), qn(i), y & 512 && (_r || u === null || ti(u, u.return)), u !== null && y & 4 && Zd(
          i,
          i.memoizedProps,
          u.memoizedProps
        );
        break;
      case 5:
        if (Ci(s, i), qn(i), y & 512 && (_r || u === null || ti(u, u.return)), i.flags & 32) {
          _ = i.stateNode;
          try {
            yi(_, "");
          } catch (yt) {
            xn(i, i.return, yt);
          }
        }
        y & 4 && i.stateNode != null && (_ = i.memoizedProps, Zd(
          i,
          _,
          u !== null ? u.memoizedProps : _
        )), y & 1024 && (Qm = !0);
        break;
      case 6:
        if (Ci(s, i), qn(i), y & 4) {
          if (i.stateNode === null)
            throw Error(r(162));
          y = i.memoizedProps, u = i.stateNode;
          try {
            u.nodeValue = y;
          } catch (yt) {
            xn(i, i.return, yt);
          }
        }
        break;
      case 3:
        if (Of = null, _ = Ya, Ya = mh(s.containerInfo), Ci(s, i), Ya = _, qn(i), y & 4 && u !== null && u.memoizedState.isDehydrated)
          try {
            cc(s.containerInfo);
          } catch (yt) {
            xn(i, i.return, yt);
          }
        Qm && (Qm = !1, k0(i));
        break;
      case 4:
        y = Ya, Ya = mh(
          i.stateNode.containerInfo
        ), Ci(s, i), qn(i), Ya = y;
        break;
      case 12:
        Ci(s, i), qn(i);
        break;
      case 31:
        Ci(s, i), qn(i), y & 4 && (y = i.updateQueue, y !== null && (i.updateQueue = null, eh(i, y)));
        break;
      case 13:
        Ci(s, i), qn(i), i.child.flags & 8192 && i.memoizedState !== null != (u !== null && u.memoizedState !== null) && (xf = Cn()), y & 4 && (y = i.updateQueue, y !== null && (i.updateQueue = null, eh(i, y)));
        break;
      case 22:
        _ = i.memoizedState !== null;
        var ve = u !== null && u.memoizedState !== null, De = Qs, He = _r;
        if (Qs = De || _, _r = He || ve, Ci(s, i), _r = He, Qs = De, qn(i), y & 8192)
          e: for (s = i.stateNode, s._visibility = _ ? s._visibility & -2 : s._visibility | 1, _ && (u === null || ve || Qs || _r || Gl(i)), u = null, s = i; ; ) {
            if (s.tag === 5 || s.tag === 26) {
              if (u === null) {
                ve = u = s;
                try {
                  if (k = ve.stateNode, _)
                    L = k.style, typeof L.setProperty == "function" ? L.setProperty("display", "none", "important") : L.display = "none";
                  else {
                    J = ve.stateNode;
                    var Ye = ve.memoizedProps.style, Le = Ye != null && Ye.hasOwnProperty("display") ? Ye.display : null;
                    J.style.display = Le == null || typeof Le == "boolean" ? "" : ("" + Le).trim();
                  }
                } catch (yt) {
                  xn(ve, ve.return, yt);
                }
              }
            } else if (s.tag === 6) {
              if (u === null) {
                ve = s;
                try {
                  ve.stateNode.nodeValue = _ ? "" : ve.memoizedProps;
                } catch (yt) {
                  xn(ve, ve.return, yt);
                }
              }
            } else if (s.tag === 18) {
              if (u === null) {
                ve = s;
                try {
                  var Fe = ve.stateNode;
                  _ ? Ji(Fe, !0) : Ji(ve.stateNode, !1);
                } catch (yt) {
                  xn(ve, ve.return, yt);
                }
              }
            } else if ((s.tag !== 22 && s.tag !== 23 || s.memoizedState === null || s === i) && s.child !== null) {
              s.child.return = s, s = s.child;
              continue;
            }
            if (s === i) break e;
            for (; s.sibling === null; ) {
              if (s.return === null || s.return === i) break e;
              u === s && (u = null), s = s.return;
            }
            u === s && (u = null), s.sibling.return = s.return, s = s.sibling;
          }
        y & 4 && (y = i.updateQueue, y !== null && (u = y.retryQueue, u !== null && (y.retryQueue = null, eh(i, u))));
        break;
      case 19:
        Ci(s, i), qn(i), y & 4 && (y = i.updateQueue, y !== null && (i.updateQueue = null, eh(i, y)));
        break;
      case 30:
        break;
      case 21:
        break;
      default:
        Ci(s, i), qn(i);
    }
  }
  function qn(i) {
    var s = i.flags;
    if (s & 2) {
      try {
        for (var u, y = i.return; y !== null; ) {
          if (b0(y)) {
            u = y;
            break;
          }
          y = y.return;
        }
        if (u == null) throw Error(r(160));
        switch (u.tag) {
          case 27:
            var _ = u.stateNode, k = Wm(i);
            Jd(i, k, _);
            break;
          case 5:
            var L = u.stateNode;
            u.flags & 32 && (yi(L, ""), u.flags &= -33);
            var J = Wm(i);
            Jd(i, J, L);
            break;
          case 3:
          case 4:
            var ve = u.stateNode.containerInfo, De = Wm(i);
            Xm(
              i,
              De,
              ve
            );
            break;
          default:
            throw Error(r(161));
        }
      } catch (He) {
        xn(i, i.return, He);
      }
      i.flags &= -3;
    }
    s & 4096 && (i.flags &= -4097);
  }
  function k0(i) {
    if (i.subtreeFlags & 1024)
      for (i = i.child; i !== null; ) {
        var s = i;
        k0(s), s.tag === 5 && s.flags & 1024 && s.stateNode.reset(), i = i.sibling;
      }
  }
  function Js(i, s) {
    if (s.subtreeFlags & 8772)
      for (s = s.child; s !== null; )
        Zm(i, s.alternate, s), s = s.sibling;
  }
  function Gl(i) {
    for (i = i.child; i !== null; ) {
      var s = i;
      switch (s.tag) {
        case 0:
        case 11:
        case 14:
        case 15:
          Xs(4, s, s.return), Gl(s);
          break;
        case 1:
          ti(s, s.return);
          var u = s.stateNode;
          typeof u.componentWillUnmount == "function" && Ym(
            s,
            s.return,
            u
          ), Gl(s);
          break;
        case 27:
          Rf(s.stateNode);
        case 26:
        case 5:
          ti(s, s.return), Gl(s);
          break;
        case 22:
          s.memoizedState === null && Gl(s);
          break;
        case 30:
          Gl(s);
          break;
        default:
          Gl(s);
      }
      i = i.sibling;
    }
  }
  function bs(i, s, u) {
    for (u = u && (s.subtreeFlags & 8772) !== 0, s = s.child; s !== null; ) {
      var y = s.alternate, _ = i, k = s, L = k.flags;
      switch (k.tag) {
        case 0:
        case 11:
        case 15:
          bs(
            _,
            k,
            u
          ), Yu(4, k);
          break;
        case 1:
          if (bs(
            _,
            k,
            u
          ), y = k, _ = y.stateNode, typeof _.componentDidMount == "function")
            try {
              _.componentDidMount();
            } catch (De) {
              xn(y, y.return, De);
            }
          if (y = k, _ = y.updateQueue, _ !== null) {
            var J = y.stateNode;
            try {
              var ve = _.shared.hiddenCallbacks;
              if (ve !== null)
                for (_.shared.hiddenCallbacks = null, _ = 0; _ < ve.length; _++)
                  Ha(ve[_], J);
            } catch (De) {
              xn(y, y.return, De);
            }
          }
          u && L & 64 && mf(k), _i(k, k.return);
          break;
        case 27:
          w0(k);
        case 26:
        case 5:
          bs(
            _,
            k,
            u
          ), u && y === null && L & 4 && x0(k), _i(k, k.return);
          break;
        case 12:
          bs(
            _,
            k,
            u
          );
          break;
        case 31:
          bs(
            _,
            k,
            u
          ), u && L & 4 && ep(_, k);
          break;
        case 13:
          bs(
            _,
            k,
            u
          ), u && L & 4 && C0(_, k);
          break;
        case 22:
          k.memoizedState === null && bs(
            _,
            k,
            u
          ), _i(k, k.return);
          break;
        case 30:
          break;
        default:
          bs(
            _,
            k,
            u
          );
      }
      s = s.sibling;
    }
  }
  function tp(i, s) {
    var u = null;
    i !== null && i.memoizedState !== null && i.memoizedState.cachePool !== null && (u = i.memoizedState.cachePool.pool), i = null, s.memoizedState !== null && s.memoizedState.cachePool !== null && (i = s.memoizedState.cachePool.pool), i !== u && (i != null && i.refCount++, u != null && Bc(u));
  }
  function np(i, s) {
    i = null, s.alternate !== null && (i = s.alternate.memoizedState.cache), s = s.memoizedState.cache, s !== i && (s.refCount++, i != null && Bc(i));
  }
  function Wa(i, s, u, y) {
    if (s.subtreeFlags & 10256)
      for (s = s.child; s !== null; )
        N0(
          i,
          s,
          u,
          y
        ), s = s.sibling;
  }
  function N0(i, s, u, y) {
    var _ = s.flags;
    switch (s.tag) {
      case 0:
      case 11:
      case 15:
        Wa(
          i,
          s,
          u,
          y
        ), _ & 2048 && Yu(9, s);
        break;
      case 1:
        Wa(
          i,
          s,
          u,
          y
        );
        break;
      case 3:
        Wa(
          i,
          s,
          u,
          y
        ), _ & 2048 && (i = null, s.alternate !== null && (i = s.alternate.memoizedState.cache), s = s.memoizedState.cache, s !== i && (s.refCount++, i != null && Bc(i)));
        break;
      case 12:
        if (_ & 2048) {
          Wa(
            i,
            s,
            u,
            y
          ), i = s.stateNode;
          try {
            var k = s.memoizedProps, L = k.id, J = k.onPostCommit;
            typeof J == "function" && J(
              L,
              s.alternate === null ? "mount" : "update",
              i.passiveEffectDuration,
              -0
            );
          } catch (ve) {
            xn(s, s.return, ve);
          }
        } else
          Wa(
            i,
            s,
            u,
            y
          );
        break;
      case 31:
        Wa(
          i,
          s,
          u,
          y
        );
        break;
      case 13:
        Wa(
          i,
          s,
          u,
          y
        );
        break;
      case 23:
        break;
      case 22:
        k = s.stateNode, L = s.alternate, s.memoizedState !== null ? k._visibility & 2 ? Wa(
          i,
          s,
          u,
          y
        ) : pf(i, s) : k._visibility & 2 ? Wa(
          i,
          s,
          u,
          y
        ) : (k._visibility |= 2, Go(
          i,
          s,
          u,
          y,
          (s.subtreeFlags & 10256) !== 0 || !1
        )), _ & 2048 && tp(L, s);
        break;
      case 24:
        Wa(
          i,
          s,
          u,
          y
        ), _ & 2048 && np(s.alternate, s);
        break;
      default:
        Wa(
          i,
          s,
          u,
          y
        );
    }
  }
  function Go(i, s, u, y, _) {
    for (_ = _ && ((s.subtreeFlags & 10256) !== 0 || !1), s = s.child; s !== null; ) {
      var k = i, L = s, J = u, ve = y, De = L.flags;
      switch (L.tag) {
        case 0:
        case 11:
        case 15:
          Go(
            k,
            L,
            J,
            ve,
            _
          ), Yu(8, L);
          break;
        case 23:
          break;
        case 22:
          var He = L.stateNode;
          L.memoizedState !== null ? He._visibility & 2 ? Go(
            k,
            L,
            J,
            ve,
            _
          ) : pf(
            k,
            L
          ) : (He._visibility |= 2, Go(
            k,
            L,
            J,
            ve,
            _
          )), _ && De & 2048 && tp(
            L.alternate,
            L
          );
          break;
        case 24:
          Go(
            k,
            L,
            J,
            ve,
            _
          ), _ && De & 2048 && np(L.alternate, L);
          break;
        default:
          Go(
            k,
            L,
            J,
            ve,
            _
          );
      }
      s = s.sibling;
    }
  }
  function pf(i, s) {
    if (s.subtreeFlags & 10256)
      for (s = s.child; s !== null; ) {
        var u = i, y = s, _ = y.flags;
        switch (y.tag) {
          case 22:
            pf(u, y), _ & 2048 && tp(
              y.alternate,
              y
            );
            break;
          case 24:
            pf(u, y), _ & 2048 && np(y.alternate, y);
            break;
          default:
            pf(u, y);
        }
        s = s.sibling;
      }
  }
  var gf = 8192;
  function Wu(i, s, u) {
    if (i.subtreeFlags & gf)
      for (i = i.child; i !== null; )
        j0(
          i,
          s,
          u
        ), i = i.sibling;
  }
  function j0(i, s, u) {
    switch (i.tag) {
      case 26:
        Wu(
          i,
          s,
          u
        ), i.flags & gf && i.memoizedState !== null && oc(
          u,
          Ya,
          i.memoizedState,
          i.memoizedProps
        );
        break;
      case 5:
        Wu(
          i,
          s,
          u
        );
        break;
      case 3:
      case 4:
        var y = Ya;
        Ya = mh(i.stateNode.containerInfo), Wu(
          i,
          s,
          u
        ), Ya = y;
        break;
      case 22:
        i.memoizedState === null && (y = i.alternate, y !== null && y.memoizedState !== null ? (y = gf, gf = 16777216, Wu(
          i,
          s,
          u
        ), gf = y) : Wu(
          i,
          s,
          u
        ));
        break;
      default:
        Wu(
          i,
          s,
          u
        );
    }
  }
  function T0(i) {
    var s = i.alternate;
    if (s !== null && (i = s.child, i !== null)) {
      s.child = null;
      do
        s = i.sibling, i.sibling = null, i = s;
      while (i !== null);
    }
  }
  function yf(i) {
    var s = i.deletions;
    if ((i.flags & 16) !== 0) {
      if (s !== null)
        for (var u = 0; u < s.length; u++) {
          var y = s[u];
          Mr = y, M0(
            y,
            i
          );
        }
      T0(i);
    }
    if (i.subtreeFlags & 10256)
      for (i = i.child; i !== null; )
        A0(i), i = i.sibling;
  }
  function A0(i) {
    switch (i.tag) {
      case 0:
      case 11:
      case 15:
        yf(i), i.flags & 2048 && Xs(9, i, i.return);
        break;
      case 3:
        yf(i);
        break;
      case 12:
        yf(i);
        break;
      case 22:
        var s = i.stateNode;
        i.memoizedState !== null && s._visibility & 2 && (i.return === null || i.return.tag !== 13) ? (s._visibility &= -3, th(i)) : yf(i);
        break;
      default:
        yf(i);
    }
  }
  function th(i) {
    var s = i.deletions;
    if ((i.flags & 16) !== 0) {
      if (s !== null)
        for (var u = 0; u < s.length; u++) {
          var y = s[u];
          Mr = y, M0(
            y,
            i
          );
        }
      T0(i);
    }
    for (i = i.child; i !== null; ) {
      switch (s = i, s.tag) {
        case 0:
        case 11:
        case 15:
          Xs(8, s, s.return), th(s);
          break;
        case 22:
          u = s.stateNode, u._visibility & 2 && (u._visibility &= -3, th(s));
          break;
        default:
          th(s);
      }
      i = i.sibling;
    }
  }
  function M0(i, s) {
    for (; Mr !== null; ) {
      var u = Mr;
      switch (u.tag) {
        case 0:
        case 11:
        case 15:
          Xs(8, u, s);
          break;
        case 23:
        case 22:
          if (u.memoizedState !== null && u.memoizedState.cachePool !== null) {
            var y = u.memoizedState.cachePool.pool;
            y != null && y.refCount++;
          }
          break;
        case 24:
          Bc(u.memoizedState.cache);
      }
      if (y = u.child, y !== null) y.return = u, Mr = y;
      else
        e: for (u = i; Mr !== null; ) {
          y = Mr;
          var _ = y.sibling, k = y.return;
          if (Jm(y), y === u) {
            Mr = null;
            break e;
          }
          if (_ !== null) {
            _.return = k, Mr = _;
            break e;
          }
          Mr = k;
        }
    }
  }
  var Ov = {
    getCacheForType: function(i) {
      var s = Ur(wr), u = s.data.get(i);
      return u === void 0 && (u = i(), s.data.set(i, u)), u;
    },
    cacheSignal: function() {
      return Ur(wr).controller.signal;
    }
  }, zv = typeof WeakMap == "function" ? WeakMap : Map, hn = 0, Tn = null, Gt = null, Wt = 0, vn = 0, Yi = null, Vo = !1, Xu = !1, rp = !1, Xa = 0, er = 0, Ko = 0, Vl = 0, ip = 0, Wi = 0, Qu = 0, vf = null, Ei = null, ap = !1, xf = 0, R0 = 0, Kl = 1 / 0, nh = null, Yo = null, Er = 0, Wo = null, Zu = null, eo = 0, sp = 0, op = null, O0 = null, bf = 0, lp = null;
  function Xi() {
    return (hn & 2) !== 0 && Wt !== 0 ? Wt & -Wt : Z.T !== null ? Qi() : Ts();
  }
  function z0() {
    if (Wi === 0)
      if ((Wt & 536870912) === 0 || Jt) {
        var i = Oa;
        Oa <<= 1, (Oa & 3932160) === 0 && (Oa = 262144), Wi = i;
      } else Wi = 536870912;
    return i = Hi.current, i !== null && (i.flags |= 32), Wi;
  }
  function ki(i, s, u) {
    (i === Tn && (vn === 2 || vn === 9) || i.cancelPendingCommit !== null) && (Ju(i, 0), to(
      i,
      Wt,
      Wi,
      !1
    )), pi(i, u), ((hn & 2) === 0 || i !== Tn) && (i === Tn && ((hn & 2) === 0 && (Vl |= u), er === 4 && to(
      i,
      Wt,
      Wi,
      !1
    )), ws(i));
  }
  function D0(i, s, u) {
    if ((hn & 6) !== 0) throw Error(r(327));
    var y = !u && (s & 127) === 0 && (s & i.expiredLanes) === 0 || za(i, s), _ = y ? Iv(i, s) : cp(i, s, !0), k = y;
    do {
      if (_ === 0) {
        Xu && !y && to(i, s, 0, !1);
        break;
      } else {
        if (u = i.current.alternate, k && !L0(u)) {
          _ = cp(i, s, !1), k = !1;
          continue;
        }
        if (_ === 2) {
          if (k = s, i.errorRecoveryDisabledLanes & k)
            var L = 0;
          else
            L = i.pendingLanes & -536870913, L = L !== 0 ? L : L & 536870912 ? 536870912 : 0;
          if (L !== 0) {
            s = L;
            e: {
              var J = i;
              _ = vf;
              var ve = J.current.memoizedState.isDehydrated;
              if (ve && (Ju(J, L).flags |= 256), L = cp(
                J,
                L,
                !1
              ), L !== 2) {
                if (rp && !ve) {
                  J.errorRecoveryDisabledLanes |= k, Vl |= k, _ = 4;
                  break e;
                }
                k = Ei, Ei = _, k !== null && (Ei === null ? Ei = k : Ei.push.apply(
                  Ei,
                  k
                ));
              }
              _ = L;
            }
            if (k = !1, _ !== 2) continue;
          }
        }
        if (_ === 1) {
          Ju(i, 0), to(i, s, 0, !0);
          break;
        }
        e: {
          switch (y = i, k = _, k) {
            case 0:
            case 1:
              throw Error(r(345));
            case 4:
              if ((s & 4194048) !== s) break;
            case 6:
              to(
                y,
                s,
                Wi,
                !Vo
              );
              break e;
            case 2:
              Ei = null;
              break;
            case 3:
            case 5:
              break;
            default:
              throw Error(r(329));
          }
          if ((s & 62914560) === s && (_ = xf + 300 - Cn(), 10 < _)) {
            if (to(
              y,
              s,
              Wi,
              !Vo
            ), js(y, 0, !0) !== 0) break e;
            eo = s, y.timeoutHandle = ey(
              I0.bind(
                null,
                y,
                u,
                Ei,
                nh,
                ap,
                s,
                Wi,
                Vl,
                Qu,
                Vo,
                k,
                "Throttled",
                -0,
                0
              ),
              _
            );
            break e;
          }
          I0(
            y,
            u,
            Ei,
            nh,
            ap,
            s,
            Wi,
            Vl,
            Qu,
            Vo,
            k,
            null,
            -0,
            0
          );
        }
      }
      break;
    } while (!0);
    ws(i);
  }
  function I0(i, s, u, y, _, k, L, J, ve, De, He, Ye, Le, Fe) {
    if (i.timeoutHandle = -1, Ye = s.subtreeFlags, Ye & 8192 || (Ye & 16785408) === 16785408) {
      Ye = {
        stylesheets: null,
        count: 0,
        imgCount: 0,
        imgBytes: 0,
        suspenseyImages: [],
        waitingForImages: !0,
        waitingForViewTransition: !1,
        unsuspend: vi
      }, j0(
        s,
        k,
        Ye
      );
      var yt = (k & 62914560) === k ? xf - Cn() : (k & 4194048) === k ? R0 - Cn() : 0;
      if (yt = nx(
        Ye,
        yt
      ), yt !== null) {
        eo = k, i.cancelPendingCommit = yt(
          $0.bind(
            null,
            i,
            s,
            k,
            u,
            y,
            _,
            L,
            J,
            ve,
            He,
            Ye,
            null,
            Le,
            Fe
          )
        ), to(i, k, L, !De);
        return;
      }
    }
    $0(
      i,
      s,
      k,
      u,
      y,
      _,
      L,
      J,
      ve
    );
  }
  function L0(i) {
    for (var s = i; ; ) {
      var u = s.tag;
      if ((u === 0 || u === 11 || u === 15) && s.flags & 16384 && (u = s.updateQueue, u !== null && (u = u.stores, u !== null)))
        for (var y = 0; y < u.length; y++) {
          var _ = u[y], k = _.getSnapshot;
          _ = _.value;
          try {
            if (!An(k(), _)) return !1;
          } catch {
            return !1;
          }
        }
      if (u = s.child, s.subtreeFlags & 16384 && u !== null)
        u.return = s, s = u;
      else {
        if (s === i) break;
        for (; s.sibling === null; ) {
          if (s.return === null || s.return === i) return !0;
          s = s.return;
        }
        s.sibling.return = s.return, s = s.sibling;
      }
    }
    return !0;
  }
  function to(i, s, u, y) {
    s &= ~ip, s &= ~Vl, i.suspendedLanes |= s, i.pingedLanes &= ~s, y && (i.warmLanes |= s), y = i.expirationTimes;
    for (var _ = s; 0 < _; ) {
      var k = 31 - it(_), L = 1 << k;
      y[k] = -1, _ &= ~L;
    }
    u !== 0 && Da(i, u, s);
  }
  function rh() {
    return (hn & 6) === 0 ? (Ef(0), !1) : !0;
  }
  function up() {
    if (Gt !== null) {
      if (vn === 0)
        var i = Gt.return;
      else
        i = Gt, Hs = Lt = null, vm(i), Du = null, $i = 0, i = Gt;
      for (; i !== null; )
        Qd(i.alternate, i), i = i.return;
      Gt = null;
    }
  }
  function Ju(i, s) {
    var u = i.timeoutHandle;
    u !== -1 && (i.timeoutHandle = -1, Gv(u)), u = i.cancelPendingCommit, u !== null && (i.cancelPendingCommit = null, u()), eo = 0, up(), Tn = i, Gt = u = pa(i.current, null), Wt = s, vn = 0, Yi = null, Vo = !1, Xu = za(i, s), rp = !1, Qu = Wi = ip = Vl = Ko = er = 0, Ei = vf = null, ap = !1, (s & 8) !== 0 && (s |= s & 32);
    var y = i.entangledLanes;
    if (y !== 0)
      for (i = i.entanglements, y &= s; 0 < y; ) {
        var _ = 31 - it(y), k = 1 << _;
        s |= i[_], y &= ~k;
      }
    return Xa = s, Ln(), u;
  }
  function P0(i, s) {
    Pt = null, Z.H = $o, s === zu || s === Uc ? (s = Qg(), vn = 3) : s === Cd ? (s = Qg(), vn = 4) : vn = s === af ? 8 : s !== null && typeof s == "object" && typeof s.then == "function" ? 6 : 1, Yi = s, Gt === null && (er = 1, rf(
      i,
      Fi(s, i.current)
    ));
  }
  function wf() {
    var i = Hi.current;
    return i === null ? !0 : (Wt & 4194048) === Wt ? Sa === null : (Wt & 62914560) === Wt || (Wt & 536870912) !== 0 ? i === Sa : !1;
  }
  function q0() {
    var i = Z.H;
    return Z.H = $o, i === null ? $o : i;
  }
  function B0() {
    var i = Z.A;
    return Z.A = Ov, i;
  }
  function ih() {
    er = 4, Vo || (Wt & 4194048) !== Wt && Hi.current !== null || (Xu = !0), (Ko & 134217727) === 0 && (Vl & 134217727) === 0 || Tn === null || to(
      Tn,
      Wt,
      Wi,
      !1
    );
  }
  function cp(i, s, u) {
    var y = hn;
    hn |= 2;
    var _ = q0(), k = B0();
    (Tn !== i || Wt !== s) && (nh = null, Ju(i, s)), s = !1;
    var L = er;
    e: do
      try {
        if (vn !== 0 && Gt !== null) {
          var J = Gt, ve = Yi;
          switch (vn) {
            case 8:
              up(), L = 6;
              break e;
            case 3:
            case 2:
            case 9:
            case 6:
              Hi.current === null && (s = !0);
              var De = vn;
              if (vn = 0, Yi = null, ec(i, J, ve, De), u && Xu) {
                L = 0;
                break e;
              }
              break;
            default:
              De = vn, vn = 0, Yi = null, ec(i, J, ve, De);
          }
        }
        Dv(), L = er;
        break;
      } catch (He) {
        P0(i, He);
      }
    while (!0);
    return s && i.shellSuspendCounter++, Hs = Lt = null, hn = y, Z.H = _, Z.A = k, Gt === null && (Tn = null, Wt = 0, Ln()), L;
  }
  function Dv() {
    for (; Gt !== null; ) F0(Gt);
  }
  function Iv(i, s) {
    var u = hn;
    hn |= 2;
    var y = q0(), _ = B0();
    Tn !== i || Wt !== s ? (nh = null, Kl = Cn() + 500, Ju(i, s)) : Xu = za(
      i,
      s
    );
    e: do
      try {
        if (vn !== 0 && Gt !== null) {
          s = Gt;
          var k = Yi;
          t: switch (vn) {
            case 1:
              vn = 0, Yi = null, ec(i, s, k, 1);
              break;
            case 2:
            case 9:
              if (Xg(k)) {
                vn = 0, Yi = null, U0(s);
                break;
              }
              s = function() {
                vn !== 2 && vn !== 9 || Tn !== i || (vn = 7), ws(i);
              }, k.then(s, s);
              break e;
            case 3:
              vn = 7;
              break e;
            case 4:
              vn = 5;
              break e;
            case 7:
              Xg(k) ? (vn = 0, Yi = null, U0(s)) : (vn = 0, Yi = null, ec(i, s, k, 7));
              break;
            case 5:
              var L = null;
              switch (Gt.tag) {
                case 26:
                  L = Gt.memoizedState;
                case 5:
                case 27:
                  var J = Gt;
                  if (L ? my(L) : J.stateNode.complete) {
                    vn = 0, Yi = null;
                    var ve = J.sibling;
                    if (ve !== null) Gt = ve;
                    else {
                      var De = J.return;
                      De !== null ? (Gt = De, ah(De)) : Gt = null;
                    }
                    break t;
                  }
              }
              vn = 0, Yi = null, ec(i, s, k, 5);
              break;
            case 6:
              vn = 0, Yi = null, ec(i, s, k, 6);
              break;
            case 8:
              up(), er = 6;
              break e;
            default:
              throw Error(r(462));
          }
        }
        Lv();
        break;
      } catch (He) {
        P0(i, He);
      }
    while (!0);
    return Hs = Lt = null, Z.H = y, Z.A = _, hn = u, Gt !== null ? 0 : (Tn = null, Wt = 0, Ln(), er);
  }
  function Lv() {
    for (; Gt !== null && !Rn(); )
      F0(Gt);
  }
  function F0(i) {
    var s = y0(i.alternate, i, Xa);
    i.memoizedProps = i.pendingProps, s === null ? ah(i) : Gt = s;
  }
  function U0(i) {
    var s = i, u = s.alternate;
    switch (s.tag) {
      case 15:
      case 0:
        s = m0(
          u,
          s,
          s.pendingProps,
          s.type,
          void 0,
          Wt
        );
        break;
      case 11:
        s = m0(
          u,
          s,
          s.pendingProps,
          s.type.render,
          s.ref,
          Wt
        );
        break;
      case 5:
        vm(s);
      default:
        Qd(u, s), s = Gt = Gg(s, Xa), s = y0(u, s, Xa);
    }
    i.memoizedProps = i.pendingProps, s === null ? ah(i) : Gt = s;
  }
  function ec(i, s, u, y) {
    Hs = Lt = null, vm(s), Du = null, $i = 0;
    var _ = s.return;
    try {
      if (Fm(
        i,
        _,
        s,
        u,
        Wt
      )) {
        er = 1, rf(
          i,
          Fi(u, i.current)
        ), Gt = null;
        return;
      }
    } catch (k) {
      if (_ !== null) throw Gt = _, k;
      er = 1, rf(
        i,
        Fi(u, i.current)
      ), Gt = null;
      return;
    }
    s.flags & 32768 ? (Jt || y === 1 ? i = !0 : Xu || (Wt & 536870912) !== 0 ? i = !1 : (Vo = i = !0, (y === 2 || y === 9 || y === 3 || y === 6) && (y = Hi.current, y !== null && y.tag === 13 && (y.flags |= 16384))), _f(s, i)) : ah(s);
  }
  function ah(i) {
    var s = i;
    do {
      if ((s.flags & 32768) !== 0) {
        _f(
          s,
          Vo
        );
        return;
      }
      i = s.return;
      var u = v0(
        s.alternate,
        s,
        Xa
      );
      if (u !== null) {
        Gt = u;
        return;
      }
      if (s = s.sibling, s !== null) {
        Gt = s;
        return;
      }
      Gt = s = i;
    } while (s !== null);
    er === 0 && (er = 5);
  }
  function _f(i, s) {
    do {
      var u = hf(i.alternate, i);
      if (u !== null) {
        u.flags &= 32767, Gt = u;
        return;
      }
      if (u = i.return, u !== null && (u.flags |= 32768, u.subtreeFlags = 0, u.deletions = null), !s && (i = i.sibling, i !== null)) {
        Gt = i;
        return;
      }
      Gt = i = u;
    } while (i !== null);
    er = 6, Gt = null;
  }
  function $0(i, s, u, y, _, k, L, J, ve) {
    i.cancelPendingCommit = null;
    do
      Sf();
    while (Er !== 0);
    if ((hn & 6) !== 0) throw Error(r(327));
    if (s !== null) {
      if (s === i.current) throw Error(r(177));
      if (k = s.lanes | s.childLanes, k |= Ot, wl(
        i,
        u,
        k,
        L,
        J,
        ve
      ), i === Tn && (Gt = Tn = null, Wt = 0), Zu = s, Wo = i, eo = u, sp = k, op = _, O0 = y, (s.subtreeFlags & 10256) !== 0 || (s.flags & 10256) !== 0 ? (i.callbackNode = null, i.callbackPriority = 0, Bv(gt, function() {
        return mp(), null;
      })) : (i.callbackNode = null, i.callbackPriority = 0), y = (s.flags & 13878) !== 0, (s.subtreeFlags & 13878) !== 0 || y) {
        y = Z.T, Z.T = null, _ = fe.p, fe.p = 2, L = hn, hn |= 4;
        try {
          Mv(i, s, u);
        } finally {
          hn = L, fe.p = _, Z.T = y;
        }
      }
      Er = 1, fp(), dp(), sh();
    }
  }
  function fp() {
    if (Er === 1) {
      Er = 0;
      var i = Wo, s = Zu, u = (s.flags & 13878) !== 0;
      if ((s.subtreeFlags & 13878) !== 0 || u) {
        u = Z.T, Z.T = null;
        var y = fe.p;
        fe.p = 2;
        var _ = hn;
        hn |= 4;
        try {
          E0(s, i);
          var k = Ep, L = B(i.containerInfo), J = k.focusedElem, ve = k.selectionRange;
          if (L !== J && J && J.ownerDocument && I(
            J.ownerDocument.documentElement,
            J
          )) {
            if (ve !== null && W(J)) {
              var De = ve.start, He = ve.end;
              if (He === void 0 && (He = De), "selectionStart" in J)
                J.selectionStart = De, J.selectionEnd = Math.min(
                  He,
                  J.value.length
                );
              else {
                var Ye = J.ownerDocument || document, Le = Ye && Ye.defaultView || window;
                if (Le.getSelection) {
                  var Fe = Le.getSelection(), yt = J.textContent.length, kt = Math.min(ve.start, yt), Sn = ve.end === void 0 ? kt : Math.min(ve.end, yt);
                  !Fe.extend && kt > Sn && (L = Sn, Sn = kt, kt = L);
                  var je = M(
                    J,
                    kt
                  ), Ee = M(
                    J,
                    Sn
                  );
                  if (je && Ee && (Fe.rangeCount !== 1 || Fe.anchorNode !== je.node || Fe.anchorOffset !== je.offset || Fe.focusNode !== Ee.node || Fe.focusOffset !== Ee.offset)) {
                    var ze = Ye.createRange();
                    ze.setStart(je.node, je.offset), Fe.removeAllRanges(), kt > Sn ? (Fe.addRange(ze), Fe.extend(Ee.node, Ee.offset)) : (ze.setEnd(Ee.node, Ee.offset), Fe.addRange(ze));
                  }
                }
              }
            }
            for (Ye = [], Fe = J; Fe = Fe.parentNode; )
              Fe.nodeType === 1 && Ye.push({
                element: Fe,
                left: Fe.scrollLeft,
                top: Fe.scrollTop
              });
            for (typeof J.focus == "function" && J.focus(), J = 0; J < Ye.length; J++) {
              var Ke = Ye[J];
              Ke.element.scrollLeft = Ke.left, Ke.element.scrollTop = Ke.top;
            }
          }
          bh = !!Tf, Ep = Tf = null;
        } finally {
          hn = _, fe.p = y, Z.T = u;
        }
      }
      i.current = s, Er = 2;
    }
  }
  function dp() {
    if (Er === 2) {
      Er = 0;
      var i = Wo, s = Zu, u = (s.flags & 8772) !== 0;
      if ((s.subtreeFlags & 8772) !== 0 || u) {
        u = Z.T, Z.T = null;
        var y = fe.p;
        fe.p = 2;
        var _ = hn;
        hn |= 4;
        try {
          Zm(i, s.alternate, s);
        } finally {
          hn = _, fe.p = y, Z.T = u;
        }
      }
      Er = 3;
    }
  }
  function sh() {
    if (Er === 4 || Er === 3) {
      Er = 0, rn();
      var i = Wo, s = Zu, u = eo, y = O0;
      (s.subtreeFlags & 10256) !== 0 || (s.flags & 10256) !== 0 ? Er = 5 : (Er = 0, Zu = Wo = null, hp(i, i.pendingLanes));
      var _ = i.pendingLanes;
      if (_ === 0 && (Yo = null), ss(u), s = s.stateNode, Qt && typeof Qt.onCommitFiberRoot == "function")
        try {
          Qt.onCommitFiberRoot(
            an,
            s,
            void 0,
            (s.current.flags & 128) === 128
          );
        } catch {
        }
      if (y !== null) {
        s = Z.T, _ = fe.p, fe.p = 2, Z.T = null;
        try {
          for (var k = i.onRecoverableError, L = 0; L < y.length; L++) {
            var J = y[L];
            k(J.value, {
              componentStack: J.stack
            });
          }
        } finally {
          Z.T = s, fe.p = _;
        }
      }
      (eo & 3) !== 0 && Sf(), ws(i), _ = i.pendingLanes, (u & 261930) !== 0 && (_ & 42) !== 0 ? i === lp ? bf++ : (bf = 0, lp = i) : bf = 0, Ef(0);
    }
  }
  function hp(i, s) {
    (i.pooledCacheLanes &= s) === 0 && (s = i.pooledCache, s != null && (i.pooledCache = null, Bc(s)));
  }
  function Sf() {
    return fp(), dp(), sh(), mp();
  }
  function mp() {
    if (Er !== 5) return !1;
    var i = Wo, s = sp;
    sp = 0;
    var u = ss(eo), y = Z.T, _ = fe.p;
    try {
      fe.p = 32 > u ? 32 : u, Z.T = null, u = op, op = null;
      var k = Wo, L = eo;
      if (Er = 0, Zu = Wo = null, eo = 0, (hn & 6) !== 0) throw Error(r(331));
      var J = hn;
      if (hn |= 4, A0(k.current), N0(
        k,
        k.current,
        L,
        u
      ), hn = J, Ef(0, !1), Qt && typeof Qt.onPostCommitFiberRoot == "function")
        try {
          Qt.onPostCommitFiberRoot(an, k);
        } catch {
        }
      return !0;
    } finally {
      fe.p = _, Z.T = y, hp(i, s);
    }
  }
  function pp(i, s, u) {
    s = Fi(u, s), s = Bm(i.stateNode, s, 2), i = $a(i, s, 2), i !== null && (pi(i, 2), ws(i));
  }
  function xn(i, s, u) {
    if (i.tag === 3)
      pp(i, i, u);
    else
      for (; s !== null; ) {
        if (s.tag === 3) {
          pp(
            s,
            i,
            u
          );
          break;
        } else if (s.tag === 1) {
          var y = s.stateNode;
          if (typeof s.type.getDerivedStateFromError == "function" || typeof y.componentDidCatch == "function" && (Yo === null || !Yo.has(y))) {
            i = Fi(u, i), u = vs(2), y = $a(s, u, 2), y !== null && (Hd(
              u,
              y,
              s,
              i
            ), pi(y, 2), ws(y));
            break;
          }
        }
        s = s.return;
      }
  }
  function gp(i, s, u) {
    var y = i.pingCache;
    if (y === null) {
      y = i.pingCache = new zv();
      var _ = /* @__PURE__ */ new Set();
      y.set(s, _);
    } else
      _ = y.get(s), _ === void 0 && (_ = /* @__PURE__ */ new Set(), y.set(s, _));
    _.has(u) || (rp = !0, _.add(u), i = Pv.bind(null, i, s, u), s.then(i, i));
  }
  function Pv(i, s, u) {
    var y = i.pingCache;
    y !== null && y.delete(s), i.pingedLanes |= i.suspendedLanes & u, i.warmLanes &= ~u, Tn === i && (Wt & u) === u && (er === 4 || er === 3 && (Wt & 62914560) === Wt && 300 > Cn() - xf ? (hn & 2) === 0 && Ju(i, 0) : ip |= u, Qu === Wt && (Qu = 0)), ws(i);
  }
  function Cf(i, s) {
    s === 0 && (s = bl()), i = Nn(i, s), i !== null && (pi(i, s), ws(i));
  }
  function oh(i) {
    var s = i.memoizedState, u = 0;
    s !== null && (u = s.retryLane), Cf(i, u);
  }
  function qv(i, s) {
    var u = 0;
    switch (i.tag) {
      case 31:
      case 13:
        var y = i.stateNode, _ = i.memoizedState;
        _ !== null && (u = _.retryLane);
        break;
      case 19:
        y = i.stateNode;
        break;
      case 22:
        y = i.stateNode._retryCache;
        break;
      default:
        throw Error(r(314));
    }
    y !== null && y.delete(s), Cf(i, u);
  }
  function Bv(i, s) {
    return Fn(i, s);
  }
  var tc = null, Yl = null, yp = !1, lh = !1, vp = !1, Xo = 0;
  function ws(i) {
    i !== Yl && i.next === null && (Yl === null ? tc = Yl = i : Yl = Yl.next = i), lh = !0, yp || (yp = !0, Uv());
  }
  function Ef(i, s) {
    if (!vp && lh) {
      vp = !0;
      do
        for (var u = !1, y = tc; y !== null; ) {
          if (i !== 0) {
            var _ = y.pendingLanes;
            if (_ === 0) var k = 0;
            else {
              var L = y.suspendedLanes, J = y.pingedLanes;
              k = (1 << 31 - it(42 | i) + 1) - 1, k &= _ & ~(L & ~J), k = k & 201326741 ? k & 201326741 | 1 : k ? k | 2 : 0;
            }
            k !== 0 && (u = !0, K0(y, k));
          } else
            k = Wt, k = js(
              y,
              y === Tn ? k : 0,
              y.cancelPendingCommit !== null || y.timeoutHandle !== -1
            ), (k & 3) === 0 || za(y, k) || (u = !0, K0(y, k));
          y = y.next;
        }
      while (u);
      vp = !1;
    }
  }
  function Fv() {
    H0();
  }
  function H0() {
    lh = yp = !1;
    var i = 0;
    Xo !== 0 && Hv() && (i = Xo);
    for (var s = Cn(), u = null, y = tc; y !== null; ) {
      var _ = y.next, k = G0(y, s);
      k === 0 ? (y.next = null, u === null ? tc = _ : u.next = _, _ === null && (Yl = u)) : (u = y, (i !== 0 || (k & 3) !== 0) && (lh = !0)), y = _;
    }
    Er !== 0 && Er !== 5 || Ef(i), Xo !== 0 && (Xo = 0);
  }
  function G0(i, s) {
    for (var u = i.suspendedLanes, y = i.pingedLanes, _ = i.expirationTimes, k = i.pendingLanes & -62914561; 0 < k; ) {
      var L = 31 - it(k), J = 1 << L, ve = _[L];
      ve === -1 ? ((J & u) === 0 || (J & y) !== 0) && (_[L] = Sc(J, s)) : ve <= s && (i.expiredLanes |= J), k &= ~J;
    }
    if (s = Tn, u = Wt, u = js(
      i,
      i === s ? u : 0,
      i.cancelPendingCommit !== null || i.timeoutHandle !== -1
    ), y = i.callbackNode, u === 0 || i === s && (vn === 2 || vn === 9) || i.cancelPendingCommit !== null)
      return y !== null && y !== null && Ht(y), i.callbackNode = null, i.callbackPriority = 0;
    if ((u & 3) === 0 || za(i, u)) {
      if (s = u & -u, s === i.callbackPriority) return s;
      switch (y !== null && Ht(y), ss(u)) {
        case 2:
        case 8:
          u = Ze;
          break;
        case 32:
          u = gt;
          break;
        case 268435456:
          u = Dt;
          break;
        default:
          u = gt;
      }
      return y = V0.bind(null, i), u = Fn(u, y), i.callbackPriority = s, i.callbackNode = u, s;
    }
    return y !== null && y !== null && Ht(y), i.callbackPriority = 2, i.callbackNode = null, 2;
  }
  function V0(i, s) {
    if (Er !== 0 && Er !== 5)
      return i.callbackNode = null, i.callbackPriority = 0, null;
    var u = i.callbackNode;
    if (Sf() && i.callbackNode !== u)
      return null;
    var y = Wt;
    return y = js(
      i,
      i === Tn ? y : 0,
      i.cancelPendingCommit !== null || i.timeoutHandle !== -1
    ), y === 0 ? null : (D0(i, y, s), G0(i, Cn()), i.callbackNode != null && i.callbackNode === u ? V0.bind(null, i) : null);
  }
  function K0(i, s) {
    if (Sf()) return null;
    D0(i, s, !0);
  }
  function Uv() {
    ny(function() {
      (hn & 6) !== 0 ? Fn(
        Ue,
        Fv
      ) : H0();
    });
  }
  function Qi() {
    if (Xo === 0) {
      var i = Ru;
      i === 0 && (i = ct, ct <<= 1, (ct & 261888) === 0 && (ct = 256)), Xo = i;
    }
    return Xo;
  }
  function Y0(i) {
    return i == null || typeof i == "symbol" || typeof i == "boolean" ? null : typeof i == "function" ? i : fa("" + i);
  }
  function W0(i, s) {
    var u = s.ownerDocument.createElement("input");
    return u.name = s.name, u.value = s.value, i.id && u.setAttribute("form", i.id), s.parentNode.insertBefore(u, s), i = new FormData(i), u.parentNode.removeChild(u), i;
  }
  function Wl(i, s, u, y, _) {
    if (s === "submit" && u && u.stateNode === _) {
      var k = Y0(
        (_[Xn] || null).action
      ), L = y.submitter;
      L && (s = (s = L[Xn] || null) ? Y0(s.formAction) : L.getAttribute("formAction"), s !== null && (k = s, L = null));
      var J = new gu(
        "action",
        "action",
        null,
        y,
        _
      );
      i.push({
        event: J,
        listeners: [
          {
            instance: null,
            listener: function() {
              if (y.defaultPrevented) {
                if (Xo !== 0) {
                  var ve = L ? W0(_, L) : new FormData(_);
                  Uo(
                    u,
                    {
                      pending: !0,
                      data: ve,
                      method: _.method,
                      action: k
                    },
                    null,
                    ve
                  );
                }
              } else
                typeof k == "function" && (J.preventDefault(), ve = L ? W0(_, L) : new FormData(_), Uo(
                  u,
                  {
                    pending: !0,
                    data: ve,
                    method: _.method,
                    action: k
                  },
                  k,
                  ve
                ));
            },
            currentTarget: _
          }
        ]
      });
    }
  }
  for (var zt = 0; zt < ut.length; zt++) {
    var xp = ut[zt], Ni = xp.toLowerCase(), pr = xp[0].toUpperCase() + xp.slice(1);
    tt(
      Ni,
      "on" + pr
    );
  }
  tt(Te, "onAnimationEnd"), tt(Ie, "onAnimationIteration"), tt($e, "onAnimationStart"), tt("dblclick", "onDoubleClick"), tt("focusin", "onFocus"), tt("focusout", "onBlur"), tt(Ve, "onTransitionRun"), tt(rt, "onTransitionStart"), tt(lt, "onTransitionCancel"), tt(Ge, "onTransitionEnd"), Ii("onMouseEnter", ["mouseout", "mouseover"]), Ii("onMouseLeave", ["mouseout", "mouseover"]), Ii("onPointerEnter", ["pointerout", "pointerover"]), Ii("onPointerLeave", ["pointerout", "pointerover"]), gi(
    "onChange",
    "change click focusin focusout input keydown keyup selectionchange".split(" ")
  ), gi(
    "onSelect",
    "focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(
      " "
    )
  ), gi("onBeforeInput", [
    "compositionend",
    "keypress",
    "textInput",
    "paste"
  ]), gi(
    "onCompositionEnd",
    "compositionend focusout keydown keypress keyup mousedown".split(" ")
  ), gi(
    "onCompositionStart",
    "compositionstart focusout keydown keypress keyup mousedown".split(" ")
  ), gi(
    "onCompositionUpdate",
    "compositionupdate focusout keydown keypress keyup mousedown".split(" ")
  );
  var kf = "abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(
    " "
  ), Qo = new Set(
    "beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(kf)
  );
  function X0(i, s) {
    s = (s & 4) !== 0;
    for (var u = 0; u < i.length; u++) {
      var y = i[u], _ = y.event;
      y = y.listeners;
      e: {
        var k = void 0;
        if (s)
          for (var L = y.length - 1; 0 <= L; L--) {
            var J = y[L], ve = J.instance, De = J.currentTarget;
            if (J = J.listener, ve !== k && _.isPropagationStopped())
              break e;
            k = J, _.currentTarget = De;
            try {
              k(_);
            } catch (He) {
              ht(He);
            }
            _.currentTarget = null, k = ve;
          }
        else
          for (L = 0; L < y.length; L++) {
            if (J = y[L], ve = J.instance, De = J.currentTarget, J = J.listener, ve !== k && _.isPropagationStopped())
              break e;
            k = J, _.currentTarget = De;
            try {
              k(_);
            } catch (He) {
              ht(He);
            }
            _.currentTarget = null, k = ve;
          }
      }
    }
  }
  function Vt(i, s) {
    var u = s[aa];
    u === void 0 && (u = s[aa] = /* @__PURE__ */ new Set());
    var y = i + "__bubble";
    u.has(y) || (ch(s, i, 2, !1), u.add(y));
  }
  function bp(i, s, u) {
    var y = 0;
    s && (y |= 4), ch(
      u,
      i,
      y,
      s
    );
  }
  var uh = "_reactListening" + Math.random().toString(36).slice(2);
  function wp(i) {
    if (!i[uh]) {
      i[uh] = !0, Ia.forEach(function(u) {
        u !== "selectionchange" && (Qo.has(u) || bp(u, !1, i), bp(u, !0, i));
      });
      var s = i.nodeType === 9 ? i : i.ownerDocument;
      s === null || s[uh] || (s[uh] = !0, bp("selectionchange", !1, s));
    }
  }
  function ch(i, s, u, y) {
    switch (_y(s)) {
      case 2:
        var _ = ix;
        break;
      case 8:
        _ = ax;
        break;
      default:
        _ = Op;
    }
    u = _.bind(
      null,
      s,
      u,
      i
    ), _ = void 0, !Ec || s !== "touchstart" && s !== "touchmove" && s !== "wheel" || (_ = !0), y ? _ !== void 0 ? i.addEventListener(s, u, {
      capture: !0,
      passive: _
    }) : i.addEventListener(s, u, !0) : _ !== void 0 ? i.addEventListener(s, u, {
      passive: _
    }) : i.addEventListener(s, u, !1);
  }
  function _p(i, s, u, y, _) {
    var k = y;
    if ((s & 1) === 0 && (s & 2) === 0 && y !== null)
      e: for (; ; ) {
        if (y === null) return;
        var L = y.tag;
        if (L === 3 || L === 4) {
          var J = y.stateNode.containerInfo;
          if (J === _) break;
          if (L === 4)
            for (L = y.return; L !== null; ) {
              var ve = L.tag;
              if ((ve === 3 || ve === 4) && L.stateNode.containerInfo === _)
                return;
              L = L.return;
            }
          for (; J !== null; ) {
            if (L = oa(J), L === null) return;
            if (ve = L.tag, ve === 5 || ve === 6 || ve === 26 || ve === 27) {
              y = k = L;
              continue e;
            }
            J = J.parentNode;
          }
        }
        y = y.return;
      }
    _o(function() {
      var De = k, He = mu(u), Ye = [];
      e: {
        var Le = st.get(i);
        if (Le !== void 0) {
          var Fe = gu, yt = i;
          switch (i) {
            case "keypress":
              if (So(u) === 0) break e;
            case "keydown":
            case "keyup":
              Fe = qi;
              break;
            case "focusin":
              yt = "focus", Fe = Ps;
              break;
            case "focusout":
              yt = "blur", Fe = Ps;
              break;
            case "beforeblur":
            case "afterblur":
              Fe = Ps;
              break;
            case "click":
              if (u.button === 2) break e;
            case "auxclick":
            case "dblclick":
            case "mousedown":
            case "mousemove":
            case "mouseup":
            case "mouseout":
            case "mouseover":
            case "contextmenu":
              Fe = Co;
              break;
            case "drag":
            case "dragend":
            case "dragenter":
            case "dragexit":
            case "dragleave":
            case "dragover":
            case "dragstart":
            case "drop":
              Fe = kc;
              break;
            case "touchcancel":
            case "touchend":
            case "touchmove":
            case "touchstart":
              Fe = Mc;
              break;
            case Te:
            case Ie:
            case $e:
              Fe = Nc;
              break;
            case Ge:
              Fe = Rc;
              break;
            case "scroll":
            case "scrollend":
              Fe = yu;
              break;
            case "wheel":
              Fe = Bs;
              break;
            case "copy":
            case "cut":
            case "paste":
              Fe = vr;
              break;
            case "gotpointercapture":
            case "lostpointercapture":
            case "pointercancel":
            case "pointerdown":
            case "pointermove":
            case "pointerout":
            case "pointerover":
            case "pointerup":
              Fe = Ac;
              break;
            case "toggle":
            case "beforetoggle":
              Fe = yd;
          }
          var kt = (s & 4) !== 0, Sn = !kt && (i === "scroll" || i === "scrollend"), je = kt ? Le !== null ? Le + "Capture" : null : Le;
          kt = [];
          for (var Ee = De, ze; Ee !== null; ) {
            var Ke = Ee;
            if (ze = Ke.stateNode, Ke = Ke.tag, Ke !== 5 && Ke !== 26 && Ke !== 27 || ze === null || je === null || (Ke = La(Ee, je), Ke != null && kt.push(
              Zi(Ee, Ke, ze)
            )), Sn) break;
            Ee = Ee.return;
          }
          0 < kt.length && (Le = new Fe(
            Le,
            yt,
            null,
            u,
            He
          ), Ye.push({ event: Le, listeners: kt }));
        }
      }
      if ((s & 7) === 0) {
        e: {
          if (Le = i === "mouseover" || i === "pointerover", Fe = i === "mouseout" || i === "pointerout", Le && u !== da && (yt = u.relatedTarget || u.fromElement) && (oa(yt) || yt[Tr]))
            break e;
          if ((Fe || Le) && (Le = He.window === He ? He : (Le = He.ownerDocument) ? Le.defaultView || Le.parentWindow : window, Fe ? (yt = u.relatedTarget || u.toElement, Fe = De, yt = yt ? oa(yt) : null, yt !== null && (Sn = o(yt), kt = yt.tag, yt !== Sn || kt !== 5 && kt !== 27 && kt !== 6) && (yt = null)) : (Fe = null, yt = De), Fe !== yt)) {
            if (kt = Co, Ke = "onMouseLeave", je = "onMouseEnter", Ee = "mouse", (i === "pointerout" || i === "pointerover") && (kt = Ac, Ke = "onPointerLeave", je = "onPointerEnter", Ee = "pointer"), Sn = Fe == null ? Le : Yr(Fe), ze = yt == null ? Le : Yr(yt), Le = new kt(
              Ke,
              Ee + "leave",
              Fe,
              u,
              He
            ), Le.target = Sn, Le.relatedTarget = ze, Ke = null, oa(He) === De && (kt = new kt(
              je,
              Ee + "enter",
              yt,
              u,
              He
            ), kt.target = ze, kt.relatedTarget = Sn, Ke = kt), Sn = Ke, Fe && yt)
              t: {
                for (kt = fh, je = Fe, Ee = yt, ze = 0, Ke = je; Ke; Ke = kt(Ke))
                  ze++;
                Ke = 0;
                for (var St = Ee; St; St = kt(St))
                  Ke++;
                for (; 0 < ze - Ke; )
                  je = kt(je), ze--;
                for (; 0 < Ke - ze; )
                  Ee = kt(Ee), Ke--;
                for (; ze--; ) {
                  if (je === Ee || Ee !== null && je === Ee.alternate) {
                    kt = je;
                    break t;
                  }
                  je = kt(je), Ee = kt(Ee);
                }
                kt = null;
              }
            else kt = null;
            Fe !== null && Gn(
              Ye,
              Le,
              Fe,
              kt,
              !1
            ), yt !== null && Sn !== null && Gn(
              Ye,
              Sn,
              yt,
              kt,
              !0
            );
          }
        }
        e: {
          if (Le = De ? Yr(De) : window, Fe = Le.nodeName && Le.nodeName.toLowerCase(), Fe === "select" || Fe === "input" && Le.type === "file")
            var cn = zl;
          else if (Rl(Le))
            if (Pr)
              cn = Ao;
            else {
              cn = Fs;
              var xt = Dl;
            }
          else
            Fe = Le.nodeName, !Fe || Fe.toLowerCase() !== "input" || Le.type !== "checkbox" && Le.type !== "radio" ? De && hu(De.elementType) && (cn = zl) : cn = Ic;
          if (cn && (cn = cn(i, De))) {
            Su(
              Ye,
              cn,
              u,
              He
            );
            break e;
          }
          xt && xt(i, Le, De), i === "focusout" && De && Le.type === "number" && De.memoizedProps.value != null && zs(Le, "number", Le.value);
        }
        switch (xt = De ? Yr(De) : window, i) {
          case "focusin":
            (Rl(xt) || xt.contentEditable === "true") && (F = xt, ne = De, te = null);
            break;
          case "focusout":
            te = ne = F = null;
            break;
          case "mousedown":
            me = !0;
            break;
          case "contextmenu":
          case "mouseup":
          case "dragend":
            me = !1, ce(Ye, u, He);
            break;
          case "selectionchange":
            if (oe) break;
          case "keydown":
          case "keyup":
            ce(Ye, u, He);
        }
        var Ft;
        if (ko)
          e: {
            switch (i) {
              case "compositionstart":
                var Xt = "onCompositionStart";
                break e;
              case "compositionend":
                Xt = "onCompositionEnd";
                break e;
              case "compositionupdate":
                Xt = "onCompositionUpdate";
                break e;
            }
            Xt = void 0;
          }
        else
          hs ? Ml(i, u) && (Xt = "onCompositionEnd") : i === "keydown" && u.keyCode === 229 && (Xt = "onCompositionStart");
        Xt && (Al && u.locale !== "ko" && (hs || Xt !== "onCompositionStart" ? Xt === "onCompositionEnd" && hs && (Ft = on()) : (ha = He, pu = "value" in ha ? ha.value : ha.textContent, hs = !0)), xt = Nf(De, Xt), 0 < xt.length && (Xt = new Lr(
          Xt,
          i,
          null,
          u,
          He
        ), Ye.push({ event: Xt, listeners: xt }), Ft ? Xt.data = Ft : (Ft = xd(u), Ft !== null && (Xt.data = Ft)))), (Ft = Oc ? Zr(i, u) : zc(i, u)) && (Xt = Nf(De, "onBeforeInput"), 0 < Xt.length && (xt = new Lr(
          "onBeforeInput",
          "beforeinput",
          null,
          u,
          He
        ), Ye.push({
          event: xt,
          listeners: Xt
        }), xt.data = Ft)), Wl(
          Ye,
          i,
          De,
          u,
          He
        );
      }
      X0(Ye, s);
    });
  }
  function Zi(i, s, u) {
    return {
      instance: i,
      listener: s,
      currentTarget: u
    };
  }
  function Nf(i, s) {
    for (var u = s + "Capture", y = []; i !== null; ) {
      var _ = i, k = _.stateNode;
      if (_ = _.tag, _ !== 5 && _ !== 26 && _ !== 27 || k === null || (_ = La(i, u), _ != null && y.unshift(
        Zi(i, _, k)
      ), _ = La(i, s), _ != null && y.push(
        Zi(i, _, k)
      )), i.tag === 3) return y;
      i = i.return;
    }
    return [];
  }
  function fh(i) {
    if (i === null) return null;
    do
      i = i.return;
    while (i && i.tag !== 5 && i.tag !== 27);
    return i || null;
  }
  function Gn(i, s, u, y, _) {
    for (var k = s._reactName, L = []; u !== null && u !== y; ) {
      var J = u, ve = J.alternate, De = J.stateNode;
      if (J = J.tag, ve !== null && ve === y) break;
      J !== 5 && J !== 26 && J !== 27 || De === null || (ve = De, _ ? (De = La(u, k), De != null && L.unshift(
        Zi(u, De, ve)
      )) : _ || (De = La(u, k), De != null && L.push(
        Zi(u, De, ve)
      ))), u = u.return;
    }
    L.length !== 0 && i.push({ event: s, listeners: L });
  }
  var ir = /\r\n?/g, Q0 = /\u0000|\uFFFD/g;
  function Z0(i) {
    return (typeof i == "string" ? i : "" + i).replace(ir, `
`).replace(Q0, "");
  }
  function J0(i, s) {
    return s = Z0(s), Z0(i) === s;
  }
  function _n(i, s, u, y, _, k) {
    switch (u) {
      case "children":
        typeof y == "string" ? s === "body" || s === "textarea" && y === "" || yi(i, y) : (typeof y == "number" || typeof y == "bigint") && s !== "body" && yi(i, "" + y);
        break;
      case "className":
        os(i, "class", y);
        break;
      case "tabIndex":
        os(i, "tabindex", y);
        break;
      case "dir":
      case "role":
      case "viewBox":
      case "width":
      case "height":
        os(i, u, y);
        break;
      case "style":
        Cc(i, y, k);
        break;
      case "data":
        if (s !== "object") {
          os(i, "data", y);
          break;
        }
      case "src":
      case "href":
        if (y === "" && (s !== "a" || u !== "href")) {
          i.removeAttribute(u);
          break;
        }
        if (y == null || typeof y == "function" || typeof y == "symbol" || typeof y == "boolean") {
          i.removeAttribute(u);
          break;
        }
        y = fa("" + y), i.setAttribute(u, y);
        break;
      case "action":
      case "formAction":
        if (typeof y == "function") {
          i.setAttribute(
            u,
            "javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')"
          );
          break;
        } else
          typeof k == "function" && (u === "formAction" ? (s !== "input" && _n(i, s, "name", _.name, _, null), _n(
            i,
            s,
            "formEncType",
            _.formEncType,
            _,
            null
          ), _n(
            i,
            s,
            "formMethod",
            _.formMethod,
            _,
            null
          ), _n(
            i,
            s,
            "formTarget",
            _.formTarget,
            _,
            null
          )) : (_n(i, s, "encType", _.encType, _, null), _n(i, s, "method", _.method, _, null), _n(i, s, "target", _.target, _, null)));
        if (y == null || typeof y == "symbol" || typeof y == "boolean") {
          i.removeAttribute(u);
          break;
        }
        y = fa("" + y), i.setAttribute(u, y);
        break;
      case "onClick":
        y != null && (i.onclick = vi);
        break;
      case "onScroll":
        y != null && Vt("scroll", i);
        break;
      case "onScrollEnd":
        y != null && Vt("scrollend", i);
        break;
      case "dangerouslySetInnerHTML":
        if (y != null) {
          if (typeof y != "object" || !("__html" in y))
            throw Error(r(61));
          if (u = y.__html, u != null) {
            if (_.children != null) throw Error(r(60));
            i.innerHTML = u;
          }
        }
        break;
      case "multiple":
        i.multiple = y && typeof y != "function" && typeof y != "symbol";
        break;
      case "muted":
        i.muted = y && typeof y != "function" && typeof y != "symbol";
        break;
      case "suppressContentEditableWarning":
      case "suppressHydrationWarning":
      case "defaultValue":
      case "defaultChecked":
      case "innerHTML":
      case "ref":
        break;
      case "autoFocus":
        break;
      case "xlinkHref":
        if (y == null || typeof y == "function" || typeof y == "boolean" || typeof y == "symbol") {
          i.removeAttribute("xlink:href");
          break;
        }
        u = fa("" + y), i.setAttributeNS(
          "http://www.w3.org/1999/xlink",
          "xlink:href",
          u
        );
        break;
      case "contentEditable":
      case "spellCheck":
      case "draggable":
      case "value":
      case "autoReverse":
      case "externalResourcesRequired":
      case "focusable":
      case "preserveAlpha":
        y != null && typeof y != "function" && typeof y != "symbol" ? i.setAttribute(u, "" + y) : i.removeAttribute(u);
        break;
      case "inert":
      case "allowFullScreen":
      case "async":
      case "autoPlay":
      case "controls":
      case "default":
      case "defer":
      case "disabled":
      case "disablePictureInPicture":
      case "disableRemotePlayback":
      case "formNoValidate":
      case "hidden":
      case "loop":
      case "noModule":
      case "noValidate":
      case "open":
      case "playsInline":
      case "readOnly":
      case "required":
      case "reversed":
      case "scoped":
      case "seamless":
      case "itemScope":
        y && typeof y != "function" && typeof y != "symbol" ? i.setAttribute(u, "") : i.removeAttribute(u);
        break;
      case "capture":
      case "download":
        y === !0 ? i.setAttribute(u, "") : y !== !1 && y != null && typeof y != "function" && typeof y != "symbol" ? i.setAttribute(u, y) : i.removeAttribute(u);
        break;
      case "cols":
      case "rows":
      case "size":
      case "span":
        y != null && typeof y != "function" && typeof y != "symbol" && !isNaN(y) && 1 <= y ? i.setAttribute(u, y) : i.removeAttribute(u);
        break;
      case "rowSpan":
      case "start":
        y == null || typeof y == "function" || typeof y == "symbol" || isNaN(y) ? i.removeAttribute(u) : i.setAttribute(u, y);
        break;
      case "popover":
        Vt("beforetoggle", i), Vt("toggle", i), It(i, "popover", y);
        break;
      case "xlinkActuate":
        ii(
          i,
          "http://www.w3.org/1999/xlink",
          "xlink:actuate",
          y
        );
        break;
      case "xlinkArcrole":
        ii(
          i,
          "http://www.w3.org/1999/xlink",
          "xlink:arcrole",
          y
        );
        break;
      case "xlinkRole":
        ii(
          i,
          "http://www.w3.org/1999/xlink",
          "xlink:role",
          y
        );
        break;
      case "xlinkShow":
        ii(
          i,
          "http://www.w3.org/1999/xlink",
          "xlink:show",
          y
        );
        break;
      case "xlinkTitle":
        ii(
          i,
          "http://www.w3.org/1999/xlink",
          "xlink:title",
          y
        );
        break;
      case "xlinkType":
        ii(
          i,
          "http://www.w3.org/1999/xlink",
          "xlink:type",
          y
        );
        break;
      case "xmlBase":
        ii(
          i,
          "http://www.w3.org/XML/1998/namespace",
          "xml:base",
          y
        );
        break;
      case "xmlLang":
        ii(
          i,
          "http://www.w3.org/XML/1998/namespace",
          "xml:lang",
          y
        );
        break;
      case "xmlSpace":
        ii(
          i,
          "http://www.w3.org/XML/1998/namespace",
          "xml:space",
          y
        );
        break;
      case "is":
        It(i, "is", y);
        break;
      case "innerText":
      case "textContent":
        break;
      default:
        (!(2 < u.length) || u[0] !== "o" && u[0] !== "O" || u[1] !== "n" && u[1] !== "N") && (u = md.get(u) || u, It(i, u, y));
    }
  }
  function Sp(i, s, u, y, _, k) {
    switch (u) {
      case "style":
        Cc(i, y, k);
        break;
      case "dangerouslySetInnerHTML":
        if (y != null) {
          if (typeof y != "object" || !("__html" in y))
            throw Error(r(61));
          if (u = y.__html, u != null) {
            if (_.children != null) throw Error(r(60));
            i.innerHTML = u;
          }
        }
        break;
      case "children":
        typeof y == "string" ? yi(i, y) : (typeof y == "number" || typeof y == "bigint") && yi(i, "" + y);
        break;
      case "onScroll":
        y != null && Vt("scroll", i);
        break;
      case "onScrollEnd":
        y != null && Vt("scrollend", i);
        break;
      case "onClick":
        y != null && (i.onclick = vi);
        break;
      case "suppressContentEditableWarning":
      case "suppressHydrationWarning":
      case "innerHTML":
      case "ref":
        break;
      case "innerText":
      case "textContent":
        break;
      default:
        if (!Ms.hasOwnProperty(u))
          e: {
            if (u[0] === "o" && u[1] === "n" && (_ = u.endsWith("Capture"), s = u.slice(2, _ ? u.length - 7 : void 0), k = i[Xn] || null, k = k != null ? k[u] : null, typeof k == "function" && i.removeEventListener(s, k, _), typeof y == "function")) {
              typeof k != "function" && k !== null && (u in i ? i[u] = null : i.hasAttribute(u) && i.removeAttribute(u)), i.addEventListener(s, y, _);
              break e;
            }
            u in i ? i[u] = y : y === !0 ? i.setAttribute(u, "") : It(i, u, y);
          }
    }
  }
  function Gr(i, s, u) {
    switch (s) {
      case "div":
      case "span":
      case "svg":
      case "path":
      case "a":
      case "g":
      case "p":
      case "li":
        break;
      case "img":
        Vt("error", i), Vt("load", i);
        var y = !1, _ = !1, k;
        for (k in u)
          if (u.hasOwnProperty(k)) {
            var L = u[k];
            if (L != null)
              switch (k) {
                case "src":
                  y = !0;
                  break;
                case "srcSet":
                  _ = !0;
                  break;
                case "children":
                case "dangerouslySetInnerHTML":
                  throw Error(r(137, s));
                default:
                  _n(i, s, k, L, u, null);
              }
          }
        _ && _n(i, s, "srcSet", u.srcSet, u, null), y && _n(i, s, "src", u.src, u, null);
        return;
      case "input":
        Vt("invalid", i);
        var J = k = L = _ = null, ve = null, De = null;
        for (y in u)
          if (u.hasOwnProperty(y)) {
            var He = u[y];
            if (He != null)
              switch (y) {
                case "name":
                  _ = He;
                  break;
                case "type":
                  L = He;
                  break;
                case "checked":
                  ve = He;
                  break;
                case "defaultChecked":
                  De = He;
                  break;
                case "value":
                  k = He;
                  break;
                case "defaultValue":
                  J = He;
                  break;
                case "children":
                case "dangerouslySetInnerHTML":
                  if (He != null)
                    throw Error(r(137, s));
                  break;
                default:
                  _n(i, s, y, He, u, null);
              }
          }
        us(
          i,
          k,
          J,
          ve,
          De,
          L,
          _,
          !1
        );
        return;
      case "select":
        Vt("invalid", i), y = L = k = null;
        for (_ in u)
          if (u.hasOwnProperty(_) && (J = u[_], J != null))
            switch (_) {
              case "value":
                k = J;
                break;
              case "defaultValue":
                L = J;
                break;
              case "multiple":
                y = J;
              default:
                _n(i, s, _, J, u, null);
            }
        s = k, u = L, i.multiple = !!y, s != null ? si(i, !!y, s, !1) : u != null && si(i, !!y, u, !0);
        return;
      case "textarea":
        Vt("invalid", i), k = _ = y = null;
        for (L in u)
          if (u.hasOwnProperty(L) && (J = u[L], J != null))
            switch (L) {
              case "value":
                y = J;
                break;
              case "defaultValue":
                _ = J;
                break;
              case "children":
                k = J;
                break;
              case "dangerouslySetInnerHTML":
                if (J != null) throw Error(r(91));
                break;
              default:
                _n(i, s, L, J, u, null);
            }
        Ds(i, y, _, k);
        return;
      case "option":
        for (ve in u)
          if (u.hasOwnProperty(ve) && (y = u[ve], y != null))
            switch (ve) {
              case "selected":
                i.selected = y && typeof y != "function" && typeof y != "symbol";
                break;
              default:
                _n(i, s, ve, y, u, null);
            }
        return;
      case "dialog":
        Vt("beforetoggle", i), Vt("toggle", i), Vt("cancel", i), Vt("close", i);
        break;
      case "iframe":
      case "object":
        Vt("load", i);
        break;
      case "video":
      case "audio":
        for (y = 0; y < kf.length; y++)
          Vt(kf[y], i);
        break;
      case "image":
        Vt("error", i), Vt("load", i);
        break;
      case "details":
        Vt("toggle", i);
        break;
      case "embed":
      case "source":
      case "link":
        Vt("error", i), Vt("load", i);
      case "area":
      case "base":
      case "br":
      case "col":
      case "hr":
      case "keygen":
      case "meta":
      case "param":
      case "track":
      case "wbr":
      case "menuitem":
        for (De in u)
          if (u.hasOwnProperty(De) && (y = u[De], y != null))
            switch (De) {
              case "children":
              case "dangerouslySetInnerHTML":
                throw Error(r(137, s));
              default:
                _n(i, s, De, y, u, null);
            }
        return;
      default:
        if (hu(s)) {
          for (He in u)
            u.hasOwnProperty(He) && (y = u[He], y !== void 0 && Sp(
              i,
              s,
              He,
              y,
              u,
              void 0
            ));
          return;
        }
    }
    for (J in u)
      u.hasOwnProperty(J) && (y = u[J], y != null && _n(i, s, J, y, u, null));
  }
  function $v(i, s, u, y) {
    switch (s) {
      case "div":
      case "span":
      case "svg":
      case "path":
      case "a":
      case "g":
      case "p":
      case "li":
        break;
      case "input":
        var _ = null, k = null, L = null, J = null, ve = null, De = null, He = null;
        for (Fe in u) {
          var Ye = u[Fe];
          if (u.hasOwnProperty(Fe) && Ye != null)
            switch (Fe) {
              case "checked":
                break;
              case "value":
                break;
              case "defaultValue":
                ve = Ye;
              default:
                y.hasOwnProperty(Fe) || _n(i, s, Fe, null, y, Ye);
            }
        }
        for (var Le in y) {
          var Fe = y[Le];
          if (Ye = u[Le], y.hasOwnProperty(Le) && (Fe != null || Ye != null))
            switch (Le) {
              case "type":
                k = Fe;
                break;
              case "name":
                _ = Fe;
                break;
              case "checked":
                De = Fe;
                break;
              case "defaultChecked":
                He = Fe;
                break;
              case "value":
                L = Fe;
                break;
              case "defaultValue":
                J = Fe;
                break;
              case "children":
              case "dangerouslySetInnerHTML":
                if (Fe != null)
                  throw Error(r(137, s));
                break;
              default:
                Fe !== Ye && _n(
                  i,
                  s,
                  Le,
                  Fe,
                  y,
                  Ye
                );
            }
        }
        ai(
          i,
          L,
          J,
          ve,
          De,
          He,
          k,
          _
        );
        return;
      case "select":
        Fe = L = J = Le = null;
        for (k in u)
          if (ve = u[k], u.hasOwnProperty(k) && ve != null)
            switch (k) {
              case "value":
                break;
              case "multiple":
                Fe = ve;
              default:
                y.hasOwnProperty(k) || _n(
                  i,
                  s,
                  k,
                  null,
                  y,
                  ve
                );
            }
        for (_ in y)
          if (k = y[_], ve = u[_], y.hasOwnProperty(_) && (k != null || ve != null))
            switch (_) {
              case "value":
                Le = k;
                break;
              case "defaultValue":
                J = k;
                break;
              case "multiple":
                L = k;
              default:
                k !== ve && _n(
                  i,
                  s,
                  _,
                  k,
                  y,
                  ve
                );
            }
        s = J, u = L, y = Fe, Le != null ? si(i, !!u, Le, !1) : !!y != !!u && (s != null ? si(i, !!u, s, !0) : si(i, !!u, u ? [] : "", !1));
        return;
      case "textarea":
        Fe = Le = null;
        for (J in u)
          if (_ = u[J], u.hasOwnProperty(J) && _ != null && !y.hasOwnProperty(J))
            switch (J) {
              case "value":
                break;
              case "children":
                break;
              default:
                _n(i, s, J, null, y, _);
            }
        for (L in y)
          if (_ = y[L], k = u[L], y.hasOwnProperty(L) && (_ != null || k != null))
            switch (L) {
              case "value":
                Le = _;
                break;
              case "defaultValue":
                Fe = _;
                break;
              case "children":
                break;
              case "dangerouslySetInnerHTML":
                if (_ != null) throw Error(r(91));
                break;
              default:
                _ !== k && _n(i, s, L, _, y, k);
            }
        Cl(i, Le, Fe);
        return;
      case "option":
        for (var yt in u)
          if (Le = u[yt], u.hasOwnProperty(yt) && Le != null && !y.hasOwnProperty(yt))
            switch (yt) {
              case "selected":
                i.selected = !1;
                break;
              default:
                _n(
                  i,
                  s,
                  yt,
                  null,
                  y,
                  Le
                );
            }
        for (ve in y)
          if (Le = y[ve], Fe = u[ve], y.hasOwnProperty(ve) && Le !== Fe && (Le != null || Fe != null))
            switch (ve) {
              case "selected":
                i.selected = Le && typeof Le != "function" && typeof Le != "symbol";
                break;
              default:
                _n(
                  i,
                  s,
                  ve,
                  Le,
                  y,
                  Fe
                );
            }
        return;
      case "img":
      case "link":
      case "area":
      case "base":
      case "br":
      case "col":
      case "embed":
      case "hr":
      case "keygen":
      case "meta":
      case "param":
      case "source":
      case "track":
      case "wbr":
      case "menuitem":
        for (var kt in u)
          Le = u[kt], u.hasOwnProperty(kt) && Le != null && !y.hasOwnProperty(kt) && _n(i, s, kt, null, y, Le);
        for (De in y)
          if (Le = y[De], Fe = u[De], y.hasOwnProperty(De) && Le !== Fe && (Le != null || Fe != null))
            switch (De) {
              case "children":
              case "dangerouslySetInnerHTML":
                if (Le != null)
                  throw Error(r(137, s));
                break;
              default:
                _n(
                  i,
                  s,
                  De,
                  Le,
                  y,
                  Fe
                );
            }
        return;
      default:
        if (hu(s)) {
          for (var Sn in u)
            Le = u[Sn], u.hasOwnProperty(Sn) && Le !== void 0 && !y.hasOwnProperty(Sn) && Sp(
              i,
              s,
              Sn,
              void 0,
              y,
              Le
            );
          for (He in y)
            Le = y[He], Fe = u[He], !y.hasOwnProperty(He) || Le === Fe || Le === void 0 && Fe === void 0 || Sp(
              i,
              s,
              He,
              Le,
              y,
              Fe
            );
          return;
        }
    }
    for (var je in u)
      Le = u[je], u.hasOwnProperty(je) && Le != null && !y.hasOwnProperty(je) && _n(i, s, je, null, y, Le);
    for (Ye in y)
      Le = y[Ye], Fe = u[Ye], !y.hasOwnProperty(Ye) || Le === Fe || Le == null && Fe == null || _n(i, s, Ye, Le, y, Fe);
  }
  function Cp(i) {
    switch (i) {
      case "css":
      case "script":
      case "font":
      case "img":
      case "image":
      case "input":
      case "link":
        return !0;
      default:
        return !1;
    }
  }
  function jf() {
    if (typeof performance.getEntriesByType == "function") {
      for (var i = 0, s = 0, u = performance.getEntriesByType("resource"), y = 0; y < u.length; y++) {
        var _ = u[y], k = _.transferSize, L = _.initiatorType, J = _.duration;
        if (k && J && Cp(L)) {
          for (L = 0, J = _.responseEnd, y += 1; y < u.length; y++) {
            var ve = u[y], De = ve.startTime;
            if (De > J) break;
            var He = ve.transferSize, Ye = ve.initiatorType;
            He && Cp(Ye) && (ve = ve.responseEnd, L += He * (ve < J ? 1 : (J - De) / (ve - De)));
          }
          if (--y, s += 8 * (k + L) / (_.duration / 1e3), i++, 10 < i) break;
        }
      }
      if (0 < i) return s / i / 1e6;
    }
    return navigator.connection && (i = navigator.connection.downlink, typeof i == "number") ? i : 5;
  }
  var Tf = null, Ep = null;
  function Af(i) {
    return i.nodeType === 9 ? i : i.ownerDocument;
  }
  function Mf(i) {
    switch (i) {
      case "http://www.w3.org/2000/svg":
        return 1;
      case "http://www.w3.org/1998/Math/MathML":
        return 2;
      default:
        return 0;
    }
  }
  function ji(i, s) {
    if (i === 0)
      switch (s) {
        case "svg":
          return 1;
        case "math":
          return 2;
        default:
          return 0;
      }
    return i === 1 && s === "foreignObject" ? 0 : i;
  }
  function Zo(i, s) {
    return i === "textarea" || i === "noscript" || typeof s.children == "string" || typeof s.children == "number" || typeof s.children == "bigint" || typeof s.dangerouslySetInnerHTML == "object" && s.dangerouslySetInnerHTML !== null && s.dangerouslySetInnerHTML.__html != null;
  }
  var kp = null;
  function Hv() {
    var i = window.event;
    return i && i.type === "popstate" ? i === kp ? !1 : (kp = i, !0) : (kp = null, !1);
  }
  var ey = typeof setTimeout == "function" ? setTimeout : void 0, Gv = typeof clearTimeout == "function" ? clearTimeout : void 0, ty = typeof Promise == "function" ? Promise : void 0, ny = typeof queueMicrotask == "function" ? queueMicrotask : typeof ty < "u" ? function(i) {
    return ty.resolve(null).then(i).catch(no);
  } : ey;
  function no(i) {
    setTimeout(function() {
      throw i;
    });
  }
  function Tt(i) {
    return i === "head";
  }
  function Np(i, s) {
    var u = s, y = 0;
    do {
      var _ = u.nextSibling;
      if (i.removeChild(u), _ && _.nodeType === 8)
        if (u = _.data, u === "/$" || u === "/&") {
          if (y === 0) {
            i.removeChild(_), cc(s);
            return;
          }
          y--;
        } else if (u === "$" || u === "$?" || u === "$~" || u === "$!" || u === "&")
          y++;
        else if (u === "html")
          Rf(i.ownerDocument.documentElement);
        else if (u === "head") {
          u = i.ownerDocument.head, Rf(u);
          for (var k = u.firstChild; k; ) {
            var L = k.nextSibling, J = k.nodeName;
            k[ri] || J === "SCRIPT" || J === "STYLE" || J === "LINK" && k.rel.toLowerCase() === "stylesheet" || u.removeChild(k), k = L;
          }
        } else
          u === "body" && Rf(i.ownerDocument.body);
      u = _;
    } while (u);
    cc(s);
  }
  function Ji(i, s) {
    var u = i;
    i = 0;
    do {
      var y = u.nextSibling;
      if (u.nodeType === 1 ? s ? (u._stashedDisplay = u.style.display, u.style.display = "none") : (u.style.display = u._stashedDisplay || "", u.getAttribute("style") === "" && u.removeAttribute("style")) : u.nodeType === 3 && (s ? (u._stashedText = u.nodeValue, u.nodeValue = "") : u.nodeValue = u._stashedText || ""), y && y.nodeType === 8)
        if (u = y.data, u === "/$") {
          if (i === 0) break;
          i--;
        } else
          u !== "$" && u !== "$?" && u !== "$~" && u !== "$!" || i++;
      u = y;
    } while (u);
  }
  function dh(i) {
    var s = i.firstChild;
    for (s && s.nodeType === 10 && (s = s.nextSibling); s; ) {
      var u = s;
      switch (s = s.nextSibling, u.nodeName) {
        case "HTML":
        case "HEAD":
        case "BODY":
          dh(u), bo(u);
          continue;
        case "SCRIPT":
        case "STYLE":
          continue;
        case "LINK":
          if (u.rel.toLowerCase() === "stylesheet") continue;
      }
      i.removeChild(u);
    }
  }
  function Vv(i, s, u, y) {
    for (; i.nodeType === 1; ) {
      var _ = u;
      if (i.nodeName.toLowerCase() !== s.toLowerCase()) {
        if (!y && (i.nodeName !== "INPUT" || i.type !== "hidden"))
          break;
      } else if (y) {
        if (!i[ri])
          switch (s) {
            case "meta":
              if (!i.hasAttribute("itemprop")) break;
              return i;
            case "link":
              if (k = i.getAttribute("rel"), k === "stylesheet" && i.hasAttribute("data-precedence"))
                break;
              if (k !== _.rel || i.getAttribute("href") !== (_.href == null || _.href === "" ? null : _.href) || i.getAttribute("crossorigin") !== (_.crossOrigin == null ? null : _.crossOrigin) || i.getAttribute("title") !== (_.title == null ? null : _.title))
                break;
              return i;
            case "style":
              if (i.hasAttribute("data-precedence")) break;
              return i;
            case "script":
              if (k = i.getAttribute("src"), (k !== (_.src == null ? null : _.src) || i.getAttribute("type") !== (_.type == null ? null : _.type) || i.getAttribute("crossorigin") !== (_.crossOrigin == null ? null : _.crossOrigin)) && k && i.hasAttribute("async") && !i.hasAttribute("itemprop"))
                break;
              return i;
            default:
              return i;
          }
      } else if (s === "input" && i.type === "hidden") {
        var k = _.name == null ? null : "" + _.name;
        if (_.type === "hidden" && i.getAttribute("name") === k)
          return i;
      } else return i;
      if (i = ka(i.nextSibling), i === null) break;
    }
    return null;
  }
  function gn(i, s, u) {
    if (s === "") return null;
    for (; i.nodeType !== 3; )
      if ((i.nodeType !== 1 || i.nodeName !== "INPUT" || i.type !== "hidden") && !u || (i = ka(i.nextSibling), i === null)) return null;
    return i;
  }
  function ry(i, s) {
    for (; i.nodeType !== 8; )
      if ((i.nodeType !== 1 || i.nodeName !== "INPUT" || i.type !== "hidden") && !s || (i = ka(i.nextSibling), i === null)) return null;
    return i;
  }
  function hh(i) {
    return i.data === "$?" || i.data === "$~";
  }
  function nc(i) {
    return i.data === "$!" || i.data === "$?" && i.ownerDocument.readyState !== "loading";
  }
  function Kv(i, s) {
    var u = i.ownerDocument;
    if (i.data === "$~") i._reactRetry = s;
    else if (i.data !== "$?" || u.readyState !== "loading")
      s();
    else {
      var y = function() {
        s(), u.removeEventListener("DOMContentLoaded", y);
      };
      u.addEventListener("DOMContentLoaded", y), i._reactRetry = y;
    }
  }
  function ka(i) {
    for (; i != null; i = i.nextSibling) {
      var s = i.nodeType;
      if (s === 1 || s === 3) break;
      if (s === 8) {
        if (s = i.data, s === "$" || s === "$!" || s === "$?" || s === "$~" || s === "&" || s === "F!" || s === "F")
          break;
        if (s === "/$" || s === "/&") return null;
      }
    }
    return i;
  }
  var jp = null;
  function iy(i) {
    i = i.nextSibling;
    for (var s = 0; i; ) {
      if (i.nodeType === 8) {
        var u = i.data;
        if (u === "/$" || u === "/&") {
          if (s === 0)
            return ka(i.nextSibling);
          s--;
        } else
          u !== "$" && u !== "$!" && u !== "$?" && u !== "$~" && u !== "&" || s++;
      }
      i = i.nextSibling;
    }
    return null;
  }
  function ay(i) {
    i = i.previousSibling;
    for (var s = 0; i; ) {
      if (i.nodeType === 8) {
        var u = i.data;
        if (u === "$" || u === "$!" || u === "$?" || u === "$~" || u === "&") {
          if (s === 0) return i;
          s--;
        } else u !== "/$" && u !== "/&" || s++;
      }
      i = i.previousSibling;
    }
    return null;
  }
  function sy(i, s, u) {
    switch (s = Af(u), i) {
      case "html":
        if (i = s.documentElement, !i) throw Error(r(452));
        return i;
      case "head":
        if (i = s.head, !i) throw Error(r(453));
        return i;
      case "body":
        if (i = s.body, !i) throw Error(r(454));
        return i;
      default:
        throw Error(r(451));
    }
  }
  function Rf(i) {
    for (var s = i.attributes; s.length; )
      i.removeAttributeNode(s[0]);
    bo(i);
  }
  var Na = /* @__PURE__ */ new Map(), oy = /* @__PURE__ */ new Set();
  function mh(i) {
    return typeof i.getRootNode == "function" ? i.getRootNode() : i.nodeType === 9 ? i : i.ownerDocument;
  }
  var ro = fe.d;
  fe.d = {
    f: Yv,
    r: Wv,
    D: Tp,
    C: Xv,
    L: Qv,
    m: Zv,
    X: Ti,
    S: Rr,
    M: Jv
  };
  function Yv() {
    var i = ro.f(), s = rh();
    return i || s;
  }
  function Wv(i) {
    var s = sn(i);
    s !== null && s.tag === 5 && s.type === "form" ? Om(s) : ro.r(i);
  }
  var Jo = typeof document > "u" ? null : document;
  function ly(i, s, u) {
    var y = Jo;
    if (y && typeof s == "string" && s) {
      var _ = cr(s);
      _ = 'link[rel="' + i + '"][href="' + _ + '"]', typeof u == "string" && (_ += '[crossorigin="' + u + '"]'), oy.has(_) || (oy.add(_), i = { rel: i, crossOrigin: u, href: s }, y.querySelector(_) === null && (s = y.createElement("link"), Gr(s, "link", i), Qn(s), y.head.appendChild(s)));
    }
  }
  function Tp(i) {
    ro.D(i), ly("dns-prefetch", i, null);
  }
  function Xv(i, s) {
    ro.C(i, s), ly("preconnect", i, s);
  }
  function Qv(i, s, u) {
    ro.L(i, s, u);
    var y = Jo;
    if (y && i && s) {
      var _ = 'link[rel="preload"][as="' + cr(s) + '"]';
      s === "image" && u && u.imageSrcSet ? (_ += '[imagesrcset="' + cr(
        u.imageSrcSet
      ) + '"]', typeof u.imageSizes == "string" && (_ += '[imagesizes="' + cr(
        u.imageSizes
      ) + '"]')) : _ += '[href="' + cr(i) + '"]';
      var k = _;
      switch (s) {
        case "style":
          k = rc(i);
          break;
        case "script":
          k = ac(i);
      }
      Na.has(k) || (i = g(
        {
          rel: "preload",
          href: s === "image" && u && u.imageSrcSet ? void 0 : i,
          as: s
        },
        u
      ), Na.set(k, i), y.querySelector(_) !== null || s === "style" && y.querySelector(ic(k)) || s === "script" && y.querySelector(sc(k)) || (s = y.createElement("link"), Gr(s, "link", i), Qn(s), y.head.appendChild(s)));
    }
  }
  function Zv(i, s) {
    ro.m(i, s);
    var u = Jo;
    if (u && i) {
      var y = s && typeof s.as == "string" ? s.as : "script", _ = 'link[rel="modulepreload"][as="' + cr(y) + '"][href="' + cr(i) + '"]', k = _;
      switch (y) {
        case "audioworklet":
        case "paintworklet":
        case "serviceworker":
        case "sharedworker":
        case "worker":
        case "script":
          k = ac(i);
      }
      if (!Na.has(k) && (i = g({ rel: "modulepreload", href: i }, s), Na.set(k, i), u.querySelector(_) === null)) {
        switch (y) {
          case "audioworklet":
          case "paintworklet":
          case "serviceworker":
          case "sharedworker":
          case "worker":
          case "script":
            if (u.querySelector(sc(k)))
              return;
        }
        y = u.createElement("link"), Gr(y, "link", i), Qn(y), u.head.appendChild(y);
      }
    }
  }
  function Rr(i, s, u) {
    ro.S(i, s, u);
    var y = Jo;
    if (y && i) {
      var _ = ur(y).hoistableStyles, k = rc(i);
      s = s || "default";
      var L = _.get(k);
      if (!L) {
        var J = { loading: 0, preload: null };
        if (L = y.querySelector(
          ic(k)
        ))
          J.loading = 5;
        else {
          i = g(
            { rel: "stylesheet", href: i, "data-precedence": s },
            u
          ), (u = Na.get(k)) && Ap(i, u);
          var ve = L = y.createElement("link");
          Qn(ve), Gr(ve, "link", i), ve._p = new Promise(function(De, He) {
            ve.onload = De, ve.onerror = He;
          }), ve.addEventListener("load", function() {
            J.loading |= 1;
          }), ve.addEventListener("error", function() {
            J.loading |= 2;
          }), J.loading |= 4, ph(L, s, y);
        }
        L = {
          type: "stylesheet",
          instance: L,
          count: 1,
          state: J
        }, _.set(k, L);
      }
    }
  }
  function Ti(i, s) {
    ro.X(i, s);
    var u = Jo;
    if (u && i) {
      var y = ur(u).hoistableScripts, _ = ac(i), k = y.get(_);
      k || (k = u.querySelector(sc(_)), k || (i = g({ src: i, async: !0 }, s), (s = Na.get(_)) && gh(i, s), k = u.createElement("script"), Qn(k), Gr(k, "link", i), u.head.appendChild(k)), k = {
        type: "script",
        instance: k,
        count: 1,
        state: null
      }, y.set(_, k));
    }
  }
  function Jv(i, s) {
    ro.M(i, s);
    var u = Jo;
    if (u && i) {
      var y = ur(u).hoistableScripts, _ = ac(i), k = y.get(_);
      k || (k = u.querySelector(sc(_)), k || (i = g({ src: i, async: !0, type: "module" }, s), (s = Na.get(_)) && gh(i, s), k = u.createElement("script"), Qn(k), Gr(k, "link", i), u.head.appendChild(k)), k = {
        type: "script",
        instance: k,
        count: 1,
        state: null
      }, y.set(_, k));
    }
  }
  function uy(i, s, u, y) {
    var _ = (_ = Se.current) ? mh(_) : null;
    if (!_) throw Error(r(446));
    switch (i) {
      case "meta":
      case "title":
        return null;
      case "style":
        return typeof u.precedence == "string" && typeof u.href == "string" ? (s = rc(u.href), u = ur(
          _
        ).hoistableStyles, y = u.get(s), y || (y = {
          type: "style",
          instance: null,
          count: 0,
          state: null
        }, u.set(s, y)), y) : { type: "void", instance: null, count: 0, state: null };
      case "link":
        if (u.rel === "stylesheet" && typeof u.href == "string" && typeof u.precedence == "string") {
          i = rc(u.href);
          var k = ur(
            _
          ).hoistableStyles, L = k.get(i);
          if (L || (_ = _.ownerDocument || _, L = {
            type: "stylesheet",
            instance: null,
            count: 0,
            state: { loading: 0, preload: null }
          }, k.set(i, L), (k = _.querySelector(
            ic(i)
          )) && !k._p && (L.instance = k, L.state.loading = 5), Na.has(i) || (u = {
            rel: "preload",
            as: "style",
            href: u.href,
            crossOrigin: u.crossOrigin,
            integrity: u.integrity,
            media: u.media,
            hrefLang: u.hrefLang,
            referrerPolicy: u.referrerPolicy
          }, Na.set(i, u), k || ex(
            _,
            i,
            u,
            L.state
          ))), s && y === null)
            throw Error(r(528, ""));
          return L;
        }
        if (s && y !== null)
          throw Error(r(529, ""));
        return null;
      case "script":
        return s = u.async, u = u.src, typeof u == "string" && s && typeof s != "function" && typeof s != "symbol" ? (s = ac(u), u = ur(
          _
        ).hoistableScripts, y = u.get(s), y || (y = {
          type: "script",
          instance: null,
          count: 0,
          state: null
        }, u.set(s, y)), y) : { type: "void", instance: null, count: 0, state: null };
      default:
        throw Error(r(444, i));
    }
  }
  function rc(i) {
    return 'href="' + cr(i) + '"';
  }
  function ic(i) {
    return 'link[rel="stylesheet"][' + i + "]";
  }
  function cy(i) {
    return g({}, i, {
      "data-precedence": i.precedence,
      precedence: null
    });
  }
  function ex(i, s, u, y) {
    i.querySelector('link[rel="preload"][as="style"][' + s + "]") ? y.loading = 1 : (s = i.createElement("link"), y.preload = s, s.addEventListener("load", function() {
      return y.loading |= 1;
    }), s.addEventListener("error", function() {
      return y.loading |= 2;
    }), Gr(s, "link", u), Qn(s), i.head.appendChild(s));
  }
  function ac(i) {
    return '[src="' + cr(i) + '"]';
  }
  function sc(i) {
    return "script[async]" + i;
  }
  function fy(i, s, u) {
    if (s.count++, s.instance === null)
      switch (s.type) {
        case "style":
          var y = i.querySelector(
            'style[data-href~="' + cr(u.href) + '"]'
          );
          if (y)
            return s.instance = y, Qn(y), y;
          var _ = g({}, u, {
            "data-href": u.href,
            "data-precedence": u.precedence,
            href: null,
            precedence: null
          });
          return y = (i.ownerDocument || i).createElement(
            "style"
          ), Qn(y), Gr(y, "style", _), ph(y, u.precedence, i), s.instance = y;
        case "stylesheet":
          _ = rc(u.href);
          var k = i.querySelector(
            ic(_)
          );
          if (k)
            return s.state.loading |= 4, s.instance = k, Qn(k), k;
          y = cy(u), (_ = Na.get(_)) && Ap(y, _), k = (i.ownerDocument || i).createElement("link"), Qn(k);
          var L = k;
          return L._p = new Promise(function(J, ve) {
            L.onload = J, L.onerror = ve;
          }), Gr(k, "link", y), s.state.loading |= 4, ph(k, u.precedence, i), s.instance = k;
        case "script":
          return k = ac(u.src), (_ = i.querySelector(
            sc(k)
          )) ? (s.instance = _, Qn(_), _) : (y = u, (_ = Na.get(k)) && (y = g({}, u), gh(y, _)), i = i.ownerDocument || i, _ = i.createElement("script"), Qn(_), Gr(_, "link", y), i.head.appendChild(_), s.instance = _);
        case "void":
          return null;
        default:
          throw Error(r(443, s.type));
      }
    else
      s.type === "stylesheet" && (s.state.loading & 4) === 0 && (y = s.instance, s.state.loading |= 4, ph(y, u.precedence, i));
    return s.instance;
  }
  function ph(i, s, u) {
    for (var y = u.querySelectorAll(
      'link[rel="stylesheet"][data-precedence],style[data-precedence]'
    ), _ = y.length ? y[y.length - 1] : null, k = _, L = 0; L < y.length; L++) {
      var J = y[L];
      if (J.dataset.precedence === s) k = J;
      else if (k !== _) break;
    }
    k ? k.parentNode.insertBefore(i, k.nextSibling) : (s = u.nodeType === 9 ? u.head : u, s.insertBefore(i, s.firstChild));
  }
  function Ap(i, s) {
    i.crossOrigin == null && (i.crossOrigin = s.crossOrigin), i.referrerPolicy == null && (i.referrerPolicy = s.referrerPolicy), i.title == null && (i.title = s.title);
  }
  function gh(i, s) {
    i.crossOrigin == null && (i.crossOrigin = s.crossOrigin), i.referrerPolicy == null && (i.referrerPolicy = s.referrerPolicy), i.integrity == null && (i.integrity = s.integrity);
  }
  var Of = null;
  function dy(i, s, u) {
    if (Of === null) {
      var y = /* @__PURE__ */ new Map(), _ = Of = /* @__PURE__ */ new Map();
      _.set(u, y);
    } else
      _ = Of, y = _.get(u), y || (y = /* @__PURE__ */ new Map(), _.set(u, y));
    if (y.has(i)) return y;
    for (y.set(i, null), u = u.getElementsByTagName(i), _ = 0; _ < u.length; _++) {
      var k = u[_];
      if (!(k[ri] || k[bn] || i === "link" && k.getAttribute("rel") === "stylesheet") && k.namespaceURI !== "http://www.w3.org/2000/svg") {
        var L = k.getAttribute(s) || "";
        L = i + L;
        var J = y.get(L);
        J ? J.push(k) : y.set(L, [k]);
      }
    }
    return y;
  }
  function hy(i, s, u) {
    i = i.ownerDocument || i, i.head.insertBefore(
      u,
      s === "title" ? i.querySelector("head > title") : null
    );
  }
  function tx(i, s, u) {
    if (u === 1 || s.itemProp != null) return !1;
    switch (i) {
      case "meta":
      case "title":
        return !0;
      case "style":
        if (typeof s.precedence != "string" || typeof s.href != "string" || s.href === "")
          break;
        return !0;
      case "link":
        if (typeof s.rel != "string" || typeof s.href != "string" || s.href === "" || s.onLoad || s.onError)
          break;
        switch (s.rel) {
          case "stylesheet":
            return i = s.disabled, typeof s.precedence == "string" && i == null;
          default:
            return !0;
        }
      case "script":
        if (s.async && typeof s.async != "function" && typeof s.async != "symbol" && !s.onLoad && !s.onError && s.src && typeof s.src == "string")
          return !0;
    }
    return !1;
  }
  function my(i) {
    return !(i.type === "stylesheet" && (i.state.loading & 3) === 0);
  }
  function oc(i, s, u, y) {
    if (u.type === "stylesheet" && (typeof y.media != "string" || matchMedia(y.media).matches !== !1) && (u.state.loading & 4) === 0) {
      if (u.instance === null) {
        var _ = rc(y.href), k = s.querySelector(
          ic(_)
        );
        if (k) {
          s = k._p, s !== null && typeof s == "object" && typeof s.then == "function" && (i.count++, i = yh.bind(i), s.then(i, i)), u.state.loading |= 4, u.instance = k, Qn(k);
          return;
        }
        k = s.ownerDocument || s, y = cy(y), (_ = Na.get(_)) && Ap(y, _), k = k.createElement("link"), Qn(k);
        var L = k;
        L._p = new Promise(function(J, ve) {
          L.onload = J, L.onerror = ve;
        }), Gr(k, "link", y), u.instance = k;
      }
      i.stylesheets === null && (i.stylesheets = /* @__PURE__ */ new Map()), i.stylesheets.set(u, s), (s = u.state.preload) && (u.state.loading & 3) === 0 && (i.count++, u = yh.bind(i), s.addEventListener("load", u), s.addEventListener("error", u));
    }
  }
  var Mp = 0;
  function nx(i, s) {
    return i.stylesheets && i.count === 0 && xh(i, i.stylesheets), 0 < i.count || 0 < i.imgCount ? function(u) {
      var y = setTimeout(function() {
        if (i.stylesheets && xh(i, i.stylesheets), i.unsuspend) {
          var k = i.unsuspend;
          i.unsuspend = null, k();
        }
      }, 6e4 + s);
      0 < i.imgBytes && Mp === 0 && (Mp = 62500 * jf());
      var _ = setTimeout(
        function() {
          if (i.waitingForImages = !1, i.count === 0 && (i.stylesheets && xh(i, i.stylesheets), i.unsuspend)) {
            var k = i.unsuspend;
            i.unsuspend = null, k();
          }
        },
        (i.imgBytes > Mp ? 50 : 800) + s
      );
      return i.unsuspend = u, function() {
        i.unsuspend = null, clearTimeout(y), clearTimeout(_);
      };
    } : null;
  }
  function yh() {
    if (this.count--, this.count === 0 && (this.imgCount === 0 || !this.waitingForImages)) {
      if (this.stylesheets) xh(this, this.stylesheets);
      else if (this.unsuspend) {
        var i = this.unsuspend;
        this.unsuspend = null, i();
      }
    }
  }
  var vh = null;
  function xh(i, s) {
    i.stylesheets = null, i.unsuspend !== null && (i.count++, vh = /* @__PURE__ */ new Map(), s.forEach(py, i), vh = null, yh.call(i));
  }
  function py(i, s) {
    if (!(s.state.loading & 4)) {
      var u = vh.get(i);
      if (u) var y = u.get(null);
      else {
        u = /* @__PURE__ */ new Map(), vh.set(i, u);
        for (var _ = i.querySelectorAll(
          "link[data-precedence],style[data-precedence]"
        ), k = 0; k < _.length; k++) {
          var L = _[k];
          (L.nodeName === "LINK" || L.getAttribute("media") !== "not all") && (u.set(L.dataset.precedence, L), y = L);
        }
        y && u.set(null, y);
      }
      _ = s.instance, L = _.getAttribute("data-precedence"), k = u.get(L) || y, k === y && u.set(null, _), u.set(L, _), this.count++, y = yh.bind(this), _.addEventListener("load", y), _.addEventListener("error", y), k ? k.parentNode.insertBefore(_, k.nextSibling) : (i = i.nodeType === 9 ? i.head : i, i.insertBefore(_, i.firstChild)), s.state.loading |= 4;
    }
  }
  var lc = {
    $$typeof: A,
    Provider: null,
    Consumer: null,
    _currentValue: he,
    _currentValue2: he,
    _threadCount: 0
  };
  function rx(i, s, u, y, _, k, L, J, ve) {
    this.tag = 1, this.containerInfo = i, this.pingCache = this.current = this.pendingChildren = null, this.timeoutHandle = -1, this.callbackNode = this.next = this.pendingContext = this.context = this.cancelPendingCommit = null, this.callbackPriority = 0, this.expirationTimes = ra(-1), this.entangledLanes = this.shellSuspendCounter = this.errorRecoveryDisabledLanes = this.expiredLanes = this.warmLanes = this.pingedLanes = this.suspendedLanes = this.pendingLanes = 0, this.entanglements = ra(0), this.hiddenUpdates = ra(null), this.identifierPrefix = y, this.onUncaughtError = _, this.onCaughtError = k, this.onRecoverableError = L, this.pooledCache = null, this.pooledCacheLanes = 0, this.formState = ve, this.incompleteTransitions = /* @__PURE__ */ new Map();
  }
  function gy(i, s, u, y, _, k, L, J, ve, De, He, Ye) {
    return i = new rx(
      i,
      s,
      u,
      L,
      ve,
      De,
      He,
      Ye,
      J
    ), s = 1, k === !0 && (s |= 24), k = Fr(3, null, null, s), i.current = k, k.stateNode = i, s = Ba(), s.refCount++, i.pooledCache = s, s.refCount++, k.memoizedState = {
      element: y,
      isDehydrated: u,
      cache: s
    }, gs(k), i;
  }
  function yy(i) {
    return i ? (i = Br, i) : Br;
  }
  function vy(i, s, u, y, _, k) {
    _ = yy(_), y.context === null ? y.context = _ : y.pendingContext = _, y = qo(s), y.payload = { element: u }, k = k === void 0 ? null : k, k !== null && (y.callback = k), u = $a(i, y, s), u !== null && (ki(u, i, s), $c(u, i, s));
  }
  function xy(i, s) {
    if (i = i.memoizedState, i !== null && i.dehydrated !== null) {
      var u = i.retryLane;
      i.retryLane = u !== 0 && u < s ? u : s;
    }
  }
  function Rp(i, s) {
    xy(i, s), (i = i.alternate) && xy(i, s);
  }
  function by(i) {
    if (i.tag === 13 || i.tag === 31) {
      var s = Nn(i, 67108864);
      s !== null && ki(s, i, 67108864), Rp(i, 67108864);
    }
  }
  function wy(i) {
    if (i.tag === 13 || i.tag === 31) {
      var s = Xi();
      s = _l(s);
      var u = Nn(i, s);
      u !== null && ki(u, i, s), Rp(i, s);
    }
  }
  var bh = !0;
  function ix(i, s, u, y) {
    var _ = Z.T;
    Z.T = null;
    var k = fe.p;
    try {
      fe.p = 2, Op(i, s, u, y);
    } finally {
      fe.p = k, Z.T = _;
    }
  }
  function ax(i, s, u, y) {
    var _ = Z.T;
    Z.T = null;
    var k = fe.p;
    try {
      fe.p = 8, Op(i, s, u, y);
    } finally {
      fe.p = k, Z.T = _;
    }
  }
  function Op(i, s, u, y) {
    if (bh) {
      var _ = zp(y);
      if (_ === null)
        _p(
          i,
          s,
          y,
          wh,
          u
        ), Sy(i, y);
      else if (Cy(
        _,
        i,
        s,
        u,
        y
      ))
        y.stopPropagation();
      else if (Sy(i, y), s & 4 && -1 < sx.indexOf(i)) {
        for (; _ !== null; ) {
          var k = sn(_);
          if (k !== null)
            switch (k.tag) {
              case 3:
                if (k = k.stateNode, k.current.memoizedState.isDehydrated) {
                  var L = Di(k.pendingLanes);
                  if (L !== 0) {
                    var J = k;
                    for (J.pendingLanes |= 2, J.entangledLanes |= 2; L; ) {
                      var ve = 1 << 31 - it(L);
                      J.entanglements[1] |= ve, L &= ~ve;
                    }
                    ws(k), (hn & 6) === 0 && (Kl = Cn() + 500, Ef(0));
                  }
                }
                break;
              case 31:
              case 13:
                J = Nn(k, 2), J !== null && ki(J, k, 2), rh(), Rp(k, 2);
            }
          if (k = zp(y), k === null && _p(
            i,
            s,
            y,
            wh,
            u
          ), k === _) break;
          _ = k;
        }
        _ !== null && y.stopPropagation();
      } else
        _p(
          i,
          s,
          y,
          null,
          u
        );
    }
  }
  function zp(i) {
    return i = mu(i), Dp(i);
  }
  var wh = null;
  function Dp(i) {
    if (wh = null, i = oa(i), i !== null) {
      var s = o(i);
      if (s === null) i = null;
      else {
        var u = s.tag;
        if (u === 13) {
          if (i = l(s), i !== null) return i;
          i = null;
        } else if (u === 31) {
          if (i = c(s), i !== null) return i;
          i = null;
        } else if (u === 3) {
          if (s.stateNode.current.memoizedState.isDehydrated)
            return s.tag === 3 ? s.stateNode.containerInfo : null;
          i = null;
        } else s !== i && (i = null);
      }
    }
    return wh = i, null;
  }
  function _y(i) {
    switch (i) {
      case "beforetoggle":
      case "cancel":
      case "click":
      case "close":
      case "contextmenu":
      case "copy":
      case "cut":
      case "auxclick":
      case "dblclick":
      case "dragend":
      case "dragstart":
      case "drop":
      case "focusin":
      case "focusout":
      case "input":
      case "invalid":
      case "keydown":
      case "keypress":
      case "keyup":
      case "mousedown":
      case "mouseup":
      case "paste":
      case "pause":
      case "play":
      case "pointercancel":
      case "pointerdown":
      case "pointerup":
      case "ratechange":
      case "reset":
      case "resize":
      case "seeked":
      case "submit":
      case "toggle":
      case "touchcancel":
      case "touchend":
      case "touchstart":
      case "volumechange":
      case "change":
      case "selectionchange":
      case "textInput":
      case "compositionstart":
      case "compositionend":
      case "compositionupdate":
      case "beforeblur":
      case "afterblur":
      case "beforeinput":
      case "blur":
      case "fullscreenchange":
      case "focus":
      case "hashchange":
      case "popstate":
      case "select":
      case "selectstart":
        return 2;
      case "drag":
      case "dragenter":
      case "dragexit":
      case "dragleave":
      case "dragover":
      case "mousemove":
      case "mouseout":
      case "mouseover":
      case "pointermove":
      case "pointerout":
      case "pointerover":
      case "scroll":
      case "touchmove":
      case "wheel":
      case "mouseenter":
      case "mouseleave":
      case "pointerenter":
      case "pointerleave":
        return 8;
      case "message":
        switch (Wn()) {
          case Ue:
            return 2;
          case Ze:
            return 8;
          case gt:
          case Nt:
            return 32;
          case Dt:
            return 268435456;
          default:
            return 32;
        }
      default:
        return 32;
    }
  }
  var Ip = !1, el = null, tl = null, nl = null, zf = /* @__PURE__ */ new Map(), Df = /* @__PURE__ */ new Map(), rl = [], sx = "mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(
    " "
  );
  function Sy(i, s) {
    switch (i) {
      case "focusin":
      case "focusout":
        el = null;
        break;
      case "dragenter":
      case "dragleave":
        tl = null;
        break;
      case "mouseover":
      case "mouseout":
        nl = null;
        break;
      case "pointerover":
      case "pointerout":
        zf.delete(s.pointerId);
        break;
      case "gotpointercapture":
      case "lostpointercapture":
        Df.delete(s.pointerId);
    }
  }
  function Xl(i, s, u, y, _, k) {
    return i === null || i.nativeEvent !== k ? (i = {
      blockedOn: s,
      domEventName: u,
      eventSystemFlags: y,
      nativeEvent: k,
      targetContainers: [_]
    }, s !== null && (s = sn(s), s !== null && by(s)), i) : (i.eventSystemFlags |= y, s = i.targetContainers, _ !== null && s.indexOf(_) === -1 && s.push(_), i);
  }
  function Cy(i, s, u, y, _) {
    switch (s) {
      case "focusin":
        return el = Xl(
          el,
          i,
          s,
          u,
          y,
          _
        ), !0;
      case "dragenter":
        return tl = Xl(
          tl,
          i,
          s,
          u,
          y,
          _
        ), !0;
      case "mouseover":
        return nl = Xl(
          nl,
          i,
          s,
          u,
          y,
          _
        ), !0;
      case "pointerover":
        var k = _.pointerId;
        return zf.set(
          k,
          Xl(
            zf.get(k) || null,
            i,
            s,
            u,
            y,
            _
          )
        ), !0;
      case "gotpointercapture":
        return k = _.pointerId, Df.set(
          k,
          Xl(
            Df.get(k) || null,
            i,
            s,
            u,
            y,
            _
          )
        ), !0;
    }
    return !1;
  }
  function Lp(i) {
    var s = oa(i.target);
    if (s !== null) {
      var u = o(s);
      if (u !== null) {
        if (s = u.tag, s === 13) {
          if (s = l(u), s !== null) {
            i.blockedOn = s, As(i.priority, function() {
              wy(u);
            });
            return;
          }
        } else if (s === 31) {
          if (s = c(u), s !== null) {
            i.blockedOn = s, As(i.priority, function() {
              wy(u);
            });
            return;
          }
        } else if (s === 3 && u.stateNode.current.memoizedState.isDehydrated) {
          i.blockedOn = u.tag === 3 ? u.stateNode.containerInfo : null;
          return;
        }
      }
    }
    i.blockedOn = null;
  }
  function _h(i) {
    if (i.blockedOn !== null) return !1;
    for (var s = i.targetContainers; 0 < s.length; ) {
      var u = zp(i.nativeEvent);
      if (u === null) {
        u = i.nativeEvent;
        var y = new u.constructor(
          u.type,
          u
        );
        da = y, u.target.dispatchEvent(y), da = null;
      } else
        return s = sn(u), s !== null && by(s), i.blockedOn = u, !1;
      s.shift();
    }
    return !0;
  }
  function Ey(i, s, u) {
    _h(i) && u.delete(s);
  }
  function ox() {
    Ip = !1, el !== null && _h(el) && (el = null), tl !== null && _h(tl) && (tl = null), nl !== null && _h(nl) && (nl = null), zf.forEach(Ey), Df.forEach(Ey);
  }
  function uc(i, s) {
    i.blockedOn === s && (i.blockedOn = null, Ip || (Ip = !0, e.unstable_scheduleCallback(
      e.unstable_NormalPriority,
      ox
    )));
  }
  var Sh = null;
  function ky(i) {
    Sh !== i && (Sh = i, e.unstable_scheduleCallback(
      e.unstable_NormalPriority,
      function() {
        Sh === i && (Sh = null);
        for (var s = 0; s < i.length; s += 3) {
          var u = i[s], y = i[s + 1], _ = i[s + 2];
          if (typeof y != "function") {
            if (Dp(y || u) === null)
              continue;
            break;
          }
          var k = sn(u);
          k !== null && (i.splice(s, 3), s -= 3, Uo(
            k,
            {
              pending: !0,
              data: _,
              method: u.method,
              action: y
            },
            y,
            _
          ));
        }
      }
    ));
  }
  function cc(i) {
    function s(ve) {
      return uc(ve, i);
    }
    el !== null && uc(el, i), tl !== null && uc(tl, i), nl !== null && uc(nl, i), zf.forEach(s), Df.forEach(s);
    for (var u = 0; u < rl.length; u++) {
      var y = rl[u];
      y.blockedOn === i && (y.blockedOn = null);
    }
    for (; 0 < rl.length && (u = rl[0], u.blockedOn === null); )
      Lp(u), u.blockedOn === null && rl.shift();
    if (u = (i.ownerDocument || i).$$reactFormReplay, u != null)
      for (y = 0; y < u.length; y += 3) {
        var _ = u[y], k = u[y + 1], L = _[Xn] || null;
        if (typeof k == "function")
          L || ky(u);
        else if (L) {
          var J = null;
          if (k && k.hasAttribute("formAction")) {
            if (_ = k, L = k[Xn] || null)
              J = L.formAction;
            else if (Dp(_) !== null) continue;
          } else J = L.action;
          typeof J == "function" ? u[y + 1] = J : (u.splice(y, 3), y -= 3), ky(u);
        }
      }
  }
  function fi() {
    function i(k) {
      k.canIntercept && k.info === "react-transition" && k.intercept({
        handler: function() {
          return new Promise(function(L) {
            return _ = L;
          });
        },
        focusReset: "manual",
        scroll: "manual"
      });
    }
    function s() {
      _ !== null && (_(), _ = null), y || setTimeout(u, 20);
    }
    function u() {
      if (!y && !navigation.transition) {
        var k = navigation.currentEntry;
        k && k.url != null && navigation.navigate(k.url, {
          state: k.getState(),
          info: "react-transition",
          history: "replace"
        });
      }
    }
    if (typeof navigation == "object") {
      var y = !1, _ = null;
      return navigation.addEventListener("navigate", i), navigation.addEventListener("navigatesuccess", s), navigation.addEventListener("navigateerror", s), setTimeout(u, 100), function() {
        y = !0, navigation.removeEventListener("navigate", i), navigation.removeEventListener("navigatesuccess", s), navigation.removeEventListener("navigateerror", s), _ !== null && (_(), _ = null);
      };
    }
  }
  function If(i) {
    this._internalRoot = i;
  }
  Ch.prototype.render = If.prototype.render = function(i) {
    var s = this._internalRoot;
    if (s === null) throw Error(r(409));
    var u = s.current, y = Xi();
    vy(u, y, i, s, null, null);
  }, Ch.prototype.unmount = If.prototype.unmount = function() {
    var i = this._internalRoot;
    if (i !== null) {
      this._internalRoot = null;
      var s = i.containerInfo;
      vy(i.current, 2, null, i, null, null), rh(), s[Tr] = null;
    }
  };
  function Ch(i) {
    this._internalRoot = i;
  }
  Ch.prototype.unstable_scheduleHydration = function(i) {
    if (i) {
      var s = Ts();
      i = { blockedOn: null, target: i, priority: s };
      for (var u = 0; u < rl.length && s !== 0 && s < rl[u].priority; u++) ;
      rl.splice(u, 0, i), u === 0 && Lp(i);
    }
  };
  var Ny = t.version;
  if (Ny !== "19.2.3")
    throw Error(
      r(
        527,
        Ny,
        "19.2.3"
      )
    );
  fe.findDOMNode = function(i) {
    var s = i._reactInternals;
    if (s === void 0)
      throw typeof i.render == "function" ? Error(r(188)) : (i = Object.keys(i).join(","), Error(r(268, i)));
    return i = h(s), i = i !== null ? p(i) : null, i = i === null ? null : i.stateNode, i;
  };
  var lx = {
    bundleType: 0,
    version: "19.2.3",
    rendererPackageName: "react-dom",
    currentDispatcherRef: Z,
    reconcilerVersion: "19.2.3"
  };
  if (typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ < "u") {
    var Eh = __REACT_DEVTOOLS_GLOBAL_HOOK__;
    if (!Eh.isDisabled && Eh.supportsFiber)
      try {
        an = Eh.inject(
          lx
        ), Qt = Eh;
      } catch {
      }
  }
  return qp.createRoot = function(i, s) {
    if (!a(i)) throw Error(r(299));
    var u = !1, y = "", _ = Pm, k = qm, L = d0;
    return s != null && (s.unstable_strictMode === !0 && (u = !0), s.identifierPrefix !== void 0 && (y = s.identifierPrefix), s.onUncaughtError !== void 0 && (_ = s.onUncaughtError), s.onCaughtError !== void 0 && (k = s.onCaughtError), s.onRecoverableError !== void 0 && (L = s.onRecoverableError)), s = gy(
      i,
      1,
      !1,
      null,
      null,
      u,
      y,
      null,
      _,
      k,
      L,
      fi
    ), i[Tr] = s.current, wp(i), new If(s);
  }, qp.hydrateRoot = function(i, s, u) {
    if (!a(i)) throw Error(r(299));
    var y = !1, _ = "", k = Pm, L = qm, J = d0, ve = null;
    return u != null && (u.unstable_strictMode === !0 && (y = !0), u.identifierPrefix !== void 0 && (_ = u.identifierPrefix), u.onUncaughtError !== void 0 && (k = u.onUncaughtError), u.onCaughtError !== void 0 && (L = u.onCaughtError), u.onRecoverableError !== void 0 && (J = u.onRecoverableError), u.formState !== void 0 && (ve = u.formState)), s = gy(
      i,
      1,
      !0,
      s,
      u ?? null,
      y,
      _,
      ve,
      k,
      L,
      J,
      fi
    ), s.context = yy(null), u = s.current, y = Xi(), y = _l(y), _ = qo(y), _.callback = null, $a(u, _, y), u = y, s.current.lanes = u, pi(s, u), ws(s), i[Tr] = s.current, wp(i), new Ch(s);
  }, qp.version = "19.2.3", qp;
}
var U5;
function yO() {
  if (U5) return dx.exports;
  U5 = 1;
  function e() {
    if (!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ > "u" || typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE != "function"))
      try {
        __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e);
      } catch (t) {
        console.error(t);
      }
  }
  return e(), dx.exports = gO(), dx.exports;
}
var vO = yO();
const JT = /* @__PURE__ */ bc(vO), xO = () => {
  if (document.getElementById("engram-font-preload")) return;
  [
    "https://fonts.googleapis.com/css2?family=Inter:wght@200;300;400;500;600&display=swap",
    "https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500&display=swap"
  ].forEach((t, n) => {
    const r = document.createElement("link");
    r.rel = "preload", r.as = "style", r.href = t, n === 0 && (r.id = "engram-font-preload"), document.head.appendChild(r);
    const a = document.createElement("link");
    a.rel = "stylesheet", a.href = t, document.head.appendChild(a);
  });
}, bO = () => (G.useEffect(() => {
  xO();
}, []), /* @__PURE__ */ m.jsx("style", { children: `
    :root {
      --font-sans: 'Inter', system-ui, -apple-system, sans-serif;
      --font-mono: 'JetBrains Mono', monospace;
    }

    body {
      font-family: var(--font-sans);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    
    .font-mono {
      font-family: var(--font-mono);
    }
    
    /* Custom Scrollbar for dark theme - Minimalist */
    ::-webkit-scrollbar {
      width: 6px;
      height: 6px;
    }
    ::-webkit-scrollbar-track {
      background: transparent;
    }
    ::-webkit-scrollbar-thumb {
      background: rgba(63, 63, 70, 0.4); /* zinc-700 with opacity */
      border-radius: 3px;
    }
    ::-webkit-scrollbar-thumb:hover {
      background: rgba(82, 82, 91, 0.6); /* zinc-600 with opacity */
    }

    /* Animation Utilities */
    .animate-float {
      animation: float 6s ease-in-out infinite;
    }
    .animate-in {
      animation: fadeIn 0.3s ease-out forwards;
    }
    .fade-in {
      opacity: 0;
      animation: fadeIn 0.3s ease-out forwards;
    }
    
    @keyframes float {
      0% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
      100% { transform: translateY(0px); }
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(5px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Utility to hide scrollbar but keep functionality */
    .no-scrollbar::-webkit-scrollbar {
      display: none;
    }
    .no-scrollbar {
      -ms-overflow-style: none;
      scrollbar-width: none;
    }
  ` }));
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const wO = (e) => e.replace(/([a-z0-9])([A-Z])/g, "$1-$2").toLowerCase(), _O = (e) => e.replace(
  /^([A-Z])|[\s-_]+(\w)/g,
  (t, n, r) => r ? r.toUpperCase() : n.toLowerCase()
), $5 = (e) => {
  const t = _O(e);
  return t.charAt(0).toUpperCase() + t.slice(1);
}, e7 = (...e) => e.filter((t, n, r) => !!t && t.trim() !== "" && r.indexOf(t) === n).join(" ").trim(), SO = (e) => {
  for (const t in e)
    if (t.startsWith("aria-") || t === "role" || t === "title")
      return !0;
};
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
var CO = {
  xmlns: "http://www.w3.org/2000/svg",
  width: 24,
  height: 24,
  viewBox: "0 0 24 24",
  fill: "none",
  stroke: "currentColor",
  strokeWidth: 2,
  strokeLinecap: "round",
  strokeLinejoin: "round"
};
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const EO = G.forwardRef(
  ({
    color: e = "currentColor",
    size: t = 24,
    strokeWidth: n = 2,
    absoluteStrokeWidth: r,
    className: a = "",
    children: o,
    iconNode: l,
    ...c
  }, d) => G.createElement(
    "svg",
    {
      ref: d,
      ...CO,
      width: t,
      height: t,
      stroke: e,
      strokeWidth: r ? Number(n) * 24 / Number(t) : n,
      className: e7("lucide", a),
      ...!o && !SO(c) && { "aria-hidden": "true" },
      ...c
    },
    [
      ...l.map(([h, p]) => G.createElement(h, p)),
      ...Array.isArray(o) ? o : [o]
    ]
  )
);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const dt = (e, t) => {
  const n = G.forwardRef(
    ({ className: r, ...a }, o) => G.createElement(EO, {
      ref: o,
      iconNode: t,
      className: e7(
        `lucide-${wO($5(e))}`,
        `lucide-${e}`,
        r
      ),
      ...a
    })
  );
  return n.displayName = $5(e), n;
};
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const kO = [
  ["path", { d: "M12 17V3", key: "1cwfxf" }],
  ["path", { d: "m6 11 6 6 6-6", key: "12ii2o" }],
  ["path", { d: "M19 21H5", key: "150jfl" }]
], NO = dt("arrow-down-to-line", kO);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const jO = [
  ["path", { d: "m12 19-7-7 7-7", key: "1l729n" }],
  ["path", { d: "M19 12H5", key: "x3x0zl" }]
], mS = dt("arrow-left", jO);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const TO = [
  ["path", { d: "M10.268 21a2 2 0 0 0 3.464 0", key: "vwvbt9" }],
  [
    "path",
    {
      d: "M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",
      key: "11g9vi"
    }
  ]
], AO = dt("bell", TO);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const MO = [
  ["path", { d: "M12 7v14", key: "1akyts" }],
  [
    "path",
    {
      d: "M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",
      key: "ruj8y"
    }
  ]
], RO = dt("book-open", MO);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const OO = [
  [
    "path",
    {
      d: "M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",
      key: "k3hazp"
    }
  ]
], zO = dt("book", OO);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const DO = [
  ["path", { d: "M12 8V4H8", key: "hb8ula" }],
  ["rect", { width: "16", height: "12", x: "4", y: "8", rx: "2", key: "enze0r" }],
  ["path", { d: "M2 14h2", key: "vft8re" }],
  ["path", { d: "M20 14h2", key: "4cs60a" }],
  ["path", { d: "M15 13v2", key: "1xurst" }],
  ["path", { d: "M9 13v2", key: "rq6x2g" }]
], t7 = dt("bot", DO);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const IO = [
  [
    "path",
    { d: "M8 3H7a2 2 0 0 0-2 2v5a2 2 0 0 1-2 2 2 2 0 0 1 2 2v5c0 1.1.9 2 2 2h1", key: "ezmyqa" }
  ],
  [
    "path",
    {
      d: "M16 21h1a2 2 0 0 0 2-2v-5c0-1.1.9-2 2-2a2 2 0 0 1-2-2V5a2 2 0 0 0-2-2h-1",
      key: "e1hn23"
    }
  ]
], n7 = dt("braces", IO);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const LO = [
  [
    "path",
    {
      d: "M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",
      key: "l5xja"
    }
  ],
  ["path", { d: "M9 13a4.5 4.5 0 0 0 3-4", key: "10igwf" }],
  ["path", { d: "M6.003 5.125A3 3 0 0 0 6.401 6.5", key: "105sqy" }],
  ["path", { d: "M3.477 10.896a4 4 0 0 1 .585-.396", key: "ql3yin" }],
  ["path", { d: "M6 18a4 4 0 0 1-1.967-.516", key: "2e4loj" }],
  ["path", { d: "M12 13h4", key: "1ku699" }],
  ["path", { d: "M12 18h6a2 2 0 0 1 2 2v1", key: "105ag5" }],
  ["path", { d: "M12 8h8", key: "1lhi5i" }],
  ["path", { d: "M16 8V5a2 2 0 0 1 2-2", key: "u6izg6" }],
  ["circle", { cx: "16", cy: "13", r: ".5", key: "ry7gng" }],
  ["circle", { cx: "18", cy: "3", r: ".5", key: "1aiba7" }],
  ["circle", { cx: "20", cy: "21", r: ".5", key: "yhc1fs" }],
  ["circle", { cx: "20", cy: "8", r: ".5", key: "1e43v0" }]
], PO = dt("brain-circuit", LO);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const qO = [
  ["path", { d: "M12 18V5", key: "adv99a" }],
  ["path", { d: "M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4", key: "1e3is1" }],
  ["path", { d: "M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5", key: "1gqd8o" }],
  ["path", { d: "M17.997 5.125a4 4 0 0 1 2.526 5.77", key: "iwvgf7" }],
  ["path", { d: "M18 18a4 4 0 0 0 2-7.464", key: "efp6ie" }],
  ["path", { d: "M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517", key: "1gq6am" }],
  ["path", { d: "M6 18a4 4 0 0 1-2-7.464", key: "k1g0md" }],
  ["path", { d: "M6.003 5.125a4 4 0 0 0-2.526 5.77", key: "q97ue3" }]
], r7 = dt("brain", qO);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const BO = [
  ["path", { d: "M12 20v-9", key: "1qisl0" }],
  ["path", { d: "M14 7a4 4 0 0 1 4 4v3a6 6 0 0 1-12 0v-3a4 4 0 0 1 4-4z", key: "uouzyp" }],
  ["path", { d: "M14.12 3.88 16 2", key: "qol33r" }],
  ["path", { d: "M21 21a4 4 0 0 0-3.81-4", key: "1b0z45" }],
  ["path", { d: "M21 5a4 4 0 0 1-3.55 3.97", key: "5cxbf6" }],
  ["path", { d: "M22 13h-4", key: "1jl80f" }],
  ["path", { d: "M3 21a4 4 0 0 1 3.81-4", key: "1fjd4g" }],
  ["path", { d: "M3 5a4 4 0 0 0 3.55 3.97", key: "1d7oge" }],
  ["path", { d: "M6 13H2", key: "82j7cp" }],
  ["path", { d: "m8 2 1.88 1.88", key: "fmnt4t" }],
  ["path", { d: "M9 7.13V6a3 3 0 1 1 6 0v1.13", key: "1vgav8" }]
], FO = dt("bug", BO);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const UO = [
  ["rect", { width: "16", height: "20", x: "4", y: "2", rx: "2", key: "1nb95v" }],
  ["line", { x1: "8", x2: "16", y1: "6", y2: "6", key: "x4nwl0" }],
  ["line", { x1: "16", x2: "16", y1: "14", y2: "18", key: "wjye3r" }],
  ["path", { d: "M16 10h.01", key: "1m94wz" }],
  ["path", { d: "M12 10h.01", key: "1nrarc" }],
  ["path", { d: "M8 10h.01", key: "19clt8" }],
  ["path", { d: "M12 14h.01", key: "1etili" }],
  ["path", { d: "M8 14h.01", key: "6423bh" }],
  ["path", { d: "M12 18h.01", key: "mhygvu" }],
  ["path", { d: "M8 18h.01", key: "lrp35t" }]
], $O = dt("calculator", UO);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const HO = [["path", { d: "M20 6 9 17l-5-5", key: "1gmf2c" }]], T1 = dt("check", HO);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const GO = [["path", { d: "m6 9 6 6 6-6", key: "qrunsl" }]], ed = dt("chevron-down", GO);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const VO = [["path", { d: "m9 18 6-6-6-6", key: "mthhwq" }]], Jh = dt("chevron-right", VO);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const KO = [
  ["circle", { cx: "12", cy: "12", r: "10", key: "1mglay" }],
  ["line", { x1: "12", x2: "12", y1: "8", y2: "12", key: "1pkeuh" }],
  ["line", { x1: "12", x2: "12.01", y1: "16", y2: "16", key: "4dfq90" }]
], xc = dt("circle-alert", KO);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const YO = [
  ["path", { d: "M21.801 10A10 10 0 1 1 17 3.335", key: "yps3ct" }],
  ["path", { d: "m9 11 3 3L22 4", key: "1pflzl" }]
], pS = dt("circle-check-big", YO);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const WO = [
  ["circle", { cx: "12", cy: "12", r: "10", key: "1mglay" }],
  ["path", { d: "m9 12 2 2 4-4", key: "dzmm74" }]
], A1 = dt("circle-check", WO);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const XO = [
  ["circle", { cx: "12", cy: "12", r: "10", key: "1mglay" }],
  ["path", { d: "m15 9-6 6", key: "1uzhvr" }],
  ["path", { d: "m9 9 6 6", key: "z0biqf" }]
], QO = dt("circle-x", XO);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const ZO = [
  ["path", { d: "M12 6v6l4 2", key: "mmk7yg" }],
  ["circle", { cx: "12", cy: "12", r: "10", key: "1mglay" }]
], a1 = dt("clock", ZO);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const JO = [
  ["path", { d: "M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z", key: "p7xjir" }]
], ez = dt("cloud", JO);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const tz = [
  [
    "path",
    { d: "M15 6v12a3 3 0 1 0 3-3H6a3 3 0 1 0 3 3V6a3 3 0 1 0-3 3h12a3 3 0 1 0-3-3", key: "11bfej" }
  ]
], H5 = dt("command", tz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const nz = [
  ["rect", { width: "14", height: "14", x: "8", y: "8", rx: "2", ry: "2", key: "17jyea" }],
  ["path", { d: "M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2", key: "zix9uf" }]
], gS = dt("copy", nz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const rz = [
  ["path", { d: "M20 4v7a4 4 0 0 1-4 4H4", key: "6o5b7l" }],
  ["path", { d: "m9 10-5 5 5 5", key: "1kshq7" }]
], G5 = dt("corner-down-left", rz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const iz = [
  ["path", { d: "M12 20v2", key: "1lh1kg" }],
  ["path", { d: "M12 2v2", key: "tus03m" }],
  ["path", { d: "M17 20v2", key: "1rnc9c" }],
  ["path", { d: "M17 2v2", key: "11trls" }],
  ["path", { d: "M2 12h2", key: "1t8f8n" }],
  ["path", { d: "M2 17h2", key: "7oei6x" }],
  ["path", { d: "M2 7h2", key: "asdhe0" }],
  ["path", { d: "M20 12h2", key: "1q8mjw" }],
  ["path", { d: "M20 17h2", key: "1fpfkl" }],
  ["path", { d: "M20 7h2", key: "1o8tra" }],
  ["path", { d: "M7 20v2", key: "4gnj0m" }],
  ["path", { d: "M7 2v2", key: "1i4yhu" }],
  ["rect", { x: "4", y: "4", width: "16", height: "16", rx: "2", key: "1vbyd7" }],
  ["rect", { x: "8", y: "8", width: "8", height: "8", rx: "1", key: "z9xiuo" }]
], yS = dt("cpu", iz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const az = [
  ["ellipse", { cx: "12", cy: "5", rx: "9", ry: "3", key: "msslwz" }],
  ["path", { d: "M3 5V19A9 3 0 0 0 21 19V5", key: "1wlel7" }],
  ["path", { d: "M3 12A9 3 0 0 0 21 12", key: "mv7ke4" }]
], M1 = dt("database", az);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const sz = [
  ["path", { d: "M12 15V3", key: "m9g1x1" }],
  ["path", { d: "M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4", key: "ih7n3h" }],
  ["path", { d: "m7 10 5 5 5-5", key: "brsn70" }]
], ig = dt("download", sz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const oz = [
  ["path", { d: "M15 3h6v6", key: "1q9fwt" }],
  ["path", { d: "M10 14 21 3", key: "gplh6r" }],
  ["path", { d: "M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6", key: "a6xqqp" }]
], lz = dt("external-link", oz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const uz = [
  [
    "path",
    {
      d: "M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",
      key: "1nclc0"
    }
  ],
  ["circle", { cx: "12", cy: "12", r: "3", key: "1v7zrd" }]
], V5 = dt("eye", uz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const cz = [
  [
    "path",
    {
      d: "M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",
      key: "1oefj6"
    }
  ],
  ["path", { d: "M14 2v5a1 1 0 0 0 1 1h5", key: "wfsgrz" }],
  ["path", { d: "M10 9H8", key: "b1mrlr" }],
  ["path", { d: "M16 13H8", key: "t4e002" }],
  ["path", { d: "M16 17H8", key: "z1uh3a" }]
], em = dt("file-text", cz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const fz = [
  [
    "path",
    {
      d: "M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",
      key: "sc7q7i"
    }
  ]
], dz = dt("funnel", fz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const hz = [
  ["line", { x1: "6", x2: "6", y1: "3", y2: "15", key: "17qcm7" }],
  ["circle", { cx: "18", cy: "6", r: "3", key: "1h7g24" }],
  ["circle", { cx: "6", cy: "18", r: "3", key: "fqmcym" }],
  ["path", { d: "M18 9a9 9 0 0 1-9 9", key: "n2h4wq" }]
], mz = dt("git-branch", hz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const pz = [
  [
    "path",
    {
      d: "M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",
      key: "tonef"
    }
  ],
  ["path", { d: "M9 18c-4.51 2-5-2-7-2", key: "9comsn" }]
], gz = dt("github", pz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const yz = [
  ["circle", { cx: "9", cy: "12", r: "1", key: "1vctgf" }],
  ["circle", { cx: "9", cy: "5", r: "1", key: "hp0tcf" }],
  ["circle", { cx: "9", cy: "19", r: "1", key: "fkjjf6" }],
  ["circle", { cx: "15", cy: "12", r: "1", key: "1tmaij" }],
  ["circle", { cx: "15", cy: "5", r: "1", key: "19l28e" }],
  ["circle", { cx: "15", cy: "19", r: "1", key: "f4zoj3" }]
], vz = dt("grip-vertical", yz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const xz = [
  ["line", { x1: "4", x2: "20", y1: "9", y2: "9", key: "4lhtct" }],
  ["line", { x1: "4", x2: "20", y1: "15", y2: "15", key: "vyu0kd" }],
  ["line", { x1: "10", x2: "8", y1: "3", y2: "21", key: "1ggp8o" }],
  ["line", { x1: "16", x2: "14", y1: "3", y2: "21", key: "weycgp" }]
], bz = dt("hash", xz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const wz = [
  ["path", { d: "M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8", key: "5wwlr5" }],
  [
    "path",
    {
      d: "M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",
      key: "r6nss1"
    }
  ]
], _z = dt("house", wz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Sz = [
  ["circle", { cx: "12", cy: "12", r: "10", key: "1mglay" }],
  ["path", { d: "M12 16v-4", key: "1dtifu" }],
  ["path", { d: "M12 8h.01", key: "e9boi3" }]
], Cz = dt("info", Sz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Ez = [
  ["path", { d: "m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4", key: "g0fldk" }],
  ["path", { d: "m21 2-9.6 9.6", key: "1j0ho8" }],
  ["circle", { cx: "7.5", cy: "15.5", r: "5.5", key: "yqb3hr" }]
], R1 = dt("key", Ez);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const kz = [
  [
    "path",
    {
      d: "M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",
      key: "zw3jo"
    }
  ],
  [
    "path",
    {
      d: "M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",
      key: "1wduqc"
    }
  ],
  [
    "path",
    {
      d: "M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",
      key: "kqbvx6"
    }
  ]
], vS = dt("layers", kz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Nz = [
  ["rect", { width: "7", height: "9", x: "3", y: "3", rx: "1", key: "10lvy0" }],
  ["rect", { width: "7", height: "5", x: "14", y: "3", rx: "1", key: "16une8" }],
  ["rect", { width: "7", height: "9", x: "14", y: "12", rx: "1", key: "1hutg5" }],
  ["rect", { width: "7", height: "5", x: "3", y: "16", rx: "1", key: "ldoo1y" }]
], jz = dt("layout-dashboard", Nz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Tz = [
  ["rect", { width: "7", height: "7", x: "3", y: "3", rx: "1", key: "1g98yp" }],
  ["rect", { width: "7", height: "7", x: "14", y: "3", rx: "1", key: "6d4xhi" }],
  ["rect", { width: "7", height: "7", x: "14", y: "14", rx: "1", key: "nxv5o0" }],
  ["rect", { width: "7", height: "7", x: "3", y: "14", rx: "1", key: "1bb6yr" }]
], Az = dt("layout-grid", Tz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Mz = [
  ["path", { d: "M8 5h13", key: "1pao27" }],
  ["path", { d: "M13 12h8", key: "h98zly" }],
  ["path", { d: "M13 19h8", key: "c3s6r1" }],
  ["path", { d: "M3 10a2 2 0 0 0 2 2h3", key: "1npucw" }],
  ["path", { d: "M3 5v12a2 2 0 0 0 2 2h3", key: "x1gjn2" }]
], Rz = dt("list-tree", Mz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Oz = [
  ["path", { d: "M3 5h.01", key: "18ugdj" }],
  ["path", { d: "M3 12h.01", key: "nlz23k" }],
  ["path", { d: "M3 19h.01", key: "noohij" }],
  ["path", { d: "M8 5h13", key: "1pao27" }],
  ["path", { d: "M8 12h13", key: "1za7za" }],
  ["path", { d: "M8 19h13", key: "m83p4d" }]
], zz = dt("list", Oz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Dz = [["path", { d: "M21 12a9 9 0 1 1-6.219-8.56", key: "13zald" }]], au = dt("loader-circle", Dz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Iz = [
  ["path", { d: "M4 5h16", key: "1tepv9" }],
  ["path", { d: "M4 12h16", key: "1lakjw" }],
  ["path", { d: "M4 19h16", key: "1djgab" }]
], Lz = dt("menu", Iz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Pz = [
  [
    "path",
    {
      d: "M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",
      key: "18887p"
    }
  ]
], qz = dt("message-square", Pz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Bz = [
  [
    "path",
    {
      d: "M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",
      key: "kfwtm"
    }
  ]
], K5 = dt("moon", Bz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Fz = [
  ["rect", { x: "16", y: "16", width: "6", height: "6", rx: "1", key: "4q2zg0" }],
  ["rect", { x: "2", y: "16", width: "6", height: "6", rx: "1", key: "8cvhb9" }],
  ["rect", { x: "9", y: "2", width: "6", height: "6", rx: "1", key: "1egb70" }],
  ["path", { d: "M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3", key: "1jsf9p" }],
  ["path", { d: "M12 12V8", key: "2874zd" }]
], i7 = dt("network", Fz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Uz = [
  [
    "path",
    {
      d: "M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",
      key: "e79jfc"
    }
  ],
  ["circle", { cx: "13.5", cy: "6.5", r: ".5", fill: "currentColor", key: "1okk4w" }],
  ["circle", { cx: "17.5", cy: "10.5", r: ".5", fill: "currentColor", key: "f64h9f" }],
  ["circle", { cx: "6.5", cy: "12.5", r: ".5", fill: "currentColor", key: "qy21gx" }],
  ["circle", { cx: "8.5", cy: "7.5", r: ".5", fill: "currentColor", key: "fotxhn" }]
], Y5 = dt("palette", Uz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const $z = [
  ["rect", { x: "14", y: "3", width: "5", height: "18", rx: "1", key: "kaeet6" }],
  ["rect", { x: "5", y: "3", width: "5", height: "18", rx: "1", key: "1wsw3u" }]
], a7 = dt("pause", $z);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Hz = [
  [
    "path",
    {
      d: "M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",
      key: "1a8usu"
    }
  ]
], Gz = dt("pen", Hz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Vz = [
  [
    "path",
    {
      d: "M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",
      key: "10ikf1"
    }
  ]
], dg = dt("play", Vz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Kz = [
  ["path", { d: "M5 12h14", key: "1ays0h" }],
  ["path", { d: "M12 5v14", key: "s699le" }]
], xS = dt("plus", Kz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Yz = [
  ["path", { d: "M12 2v10", key: "mnfbl" }],
  ["path", { d: "M18.4 6.6a9 9 0 1 1-12.77.04", key: "obofu9" }]
], O1 = dt("power", Yz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Wz = [
  ["path", { d: "M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8", key: "v9h5vc" }],
  ["path", { d: "M21 3v5h-5", key: "1q7to0" }],
  ["path", { d: "M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16", key: "3uifl3" }],
  ["path", { d: "M8 16H3v5", key: "1cv678" }]
], zr = dt("refresh-cw", Wz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Xz = [
  ["path", { d: "M17 3v10", key: "15fgeh" }],
  ["path", { d: "m12.67 5.5 8.66 5", key: "1gpheq" }],
  ["path", { d: "m12.67 10.5 8.66-5", key: "1dkfa6" }],
  [
    "path",
    { d: "M9 17a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h2a2 2 0 0 0 2-2v-2z", key: "swwfx4" }
  ]
], s7 = dt("regex", Xz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Qz = [
  ["path", { d: "M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8", key: "1357e3" }],
  ["path", { d: "M3 3v5h5", key: "1xhq8a" }]
], o7 = dt("rotate-ccw", Qz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Zz = [
  [
    "path",
    {
      d: "M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",
      key: "1c8476"
    }
  ],
  ["path", { d: "M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7", key: "1ydtos" }],
  ["path", { d: "M7 3v4a1 1 0 0 0 1 1h7", key: "t51u73" }]
], Qp = dt("save", Zz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Jz = [
  ["circle", { cx: "6", cy: "6", r: "3", key: "1lh9wr" }],
  ["path", { d: "M8.12 8.12 12 12", key: "1alkpv" }],
  ["path", { d: "M20 4 8.12 15.88", key: "xgtan2" }],
  ["circle", { cx: "6", cy: "18", r: "3", key: "fqmcym" }],
  ["path", { d: "M14.8 14.8 20 20", key: "ptml3r" }]
], eD = dt("scissors", Jz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const tD = [
  ["path", { d: "M15 12h-5", key: "r7krc0" }],
  ["path", { d: "M15 8h-5", key: "1khuty" }],
  ["path", { d: "M19 17V5a2 2 0 0 0-2-2H4", key: "zz82l3" }],
  [
    "path",
    {
      d: "M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",
      key: "1ph1d7"
    }
  ]
], nD = dt("scroll-text", tD);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const rD = [
  ["path", { d: "m21 21-4.34-4.34", key: "14j7rj" }],
  ["circle", { cx: "11", cy: "11", r: "8", key: "4ej97u" }]
], Es = dt("search", rD);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const iD = [
  [
    "path",
    {
      d: "M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",
      key: "1ffxy3"
    }
  ],
  ["path", { d: "m21.854 2.147-10.94 10.939", key: "12cjpa" }]
], aD = dt("send", iD);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const sD = [
  ["rect", { width: "20", height: "8", x: "2", y: "2", rx: "2", ry: "2", key: "ngkwjq" }],
  ["rect", { width: "20", height: "8", x: "2", y: "14", rx: "2", ry: "2", key: "iecqi9" }],
  ["line", { x1: "6", x2: "6.01", y1: "6", y2: "6", key: "16zg32" }],
  ["line", { x1: "6", x2: "6.01", y1: "18", y2: "18", key: "nzw8ys" }]
], oD = dt("server", sD);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const lD = [
  [
    "path",
    {
      d: "M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",
      key: "1i5ecw"
    }
  ],
  ["circle", { cx: "12", cy: "12", r: "3", key: "1v7zrd" }]
], s1 = dt("settings", lD);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const uD = [
  ["path", { d: "M10 8h4", key: "1sr2af" }],
  ["path", { d: "M12 21v-9", key: "17s77i" }],
  ["path", { d: "M12 8V3", key: "13r4qs" }],
  ["path", { d: "M17 16h4", key: "h1uq16" }],
  ["path", { d: "M19 12V3", key: "o1uvq1" }],
  ["path", { d: "M19 21v-5", key: "qua636" }],
  ["path", { d: "M3 14h4", key: "bcjad9" }],
  ["path", { d: "M5 10V3", key: "cb8scm" }],
  ["path", { d: "M5 21v-7", key: "1w1uti" }]
], W5 = dt("sliders-vertical", uD);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const cD = [
  [
    "path",
    {
      d: "M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",
      key: "1s2grr"
    }
  ],
  ["path", { d: "M20 2v4", key: "1rf3ol" }],
  ["path", { d: "M22 4h-4", key: "gwowj6" }],
  ["circle", { cx: "4", cy: "20", r: "2", key: "6kqj1y" }]
], l7 = dt("sparkles", cD);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const fD = [
  ["rect", { width: "18", height: "18", x: "3", y: "3", rx: "2", key: "afitv7" }]
], u7 = dt("square", fD);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const dD = [
  ["circle", { cx: "12", cy: "12", r: "4", key: "4exip2" }],
  ["path", { d: "M12 2v2", key: "tus03m" }],
  ["path", { d: "M12 20v2", key: "1lh1kg" }],
  ["path", { d: "m4.93 4.93 1.41 1.41", key: "149t6j" }],
  ["path", { d: "m17.66 17.66 1.41 1.41", key: "ptbguv" }],
  ["path", { d: "M2 12h2", key: "1t8f8n" }],
  ["path", { d: "M20 12h2", key: "1q8mjw" }],
  ["path", { d: "m6.34 17.66-1.41 1.41", key: "1m8zz5" }],
  ["path", { d: "m19.07 4.93-1.41 1.41", key: "1shlcs" }]
], hD = dt("sun", dD);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const mD = [
  ["circle", { cx: "12", cy: "12", r: "10", key: "1mglay" }],
  ["circle", { cx: "12", cy: "12", r: "6", key: "1vlfrh" }],
  ["circle", { cx: "12", cy: "12", r: "2", key: "1c9p78" }]
], bS = dt("target", mD);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const pD = [
  ["path", { d: "M12 19h8", key: "baeox8" }],
  ["path", { d: "m4 17 6-6-6-6", key: "1yngyt" }]
], z1 = dt("terminal", pD);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const gD = [
  ["path", { d: "M10 11v6", key: "nco0om" }],
  ["path", { d: "M14 11v6", key: "outv1u" }],
  ["path", { d: "M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6", key: "miytrc" }],
  ["path", { d: "M3 6h18", key: "d0wm0j" }],
  ["path", { d: "M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2", key: "e791ji" }]
], po = dt("trash-2", gD);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const yD = [
  [
    "path",
    {
      d: "m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",
      key: "wmoenq"
    }
  ],
  ["path", { d: "M12 9v4", key: "juzpu7" }],
  ["path", { d: "M12 17h.01", key: "p32p05" }]
], c7 = dt("triangle-alert", yD);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const vD = [
  ["path", { d: "M12 3v12", key: "1x0j5s" }],
  ["path", { d: "m17 8-5-5-5 5", key: "7q97r8" }],
  ["path", { d: "M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4", key: "ih7n3h" }]
], f7 = dt("upload", vD);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const xD = [
  [
    "path",
    {
      d: "m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",
      key: "ul74o6"
    }
  ],
  ["path", { d: "m14 7 3 3", key: "1r5n42" }],
  ["path", { d: "M5 6v4", key: "ilb8ba" }],
  ["path", { d: "M19 14v4", key: "blhpug" }],
  ["path", { d: "M10 2v2", key: "7u0qdc" }],
  ["path", { d: "M7 8H3", key: "zfb6yr" }],
  ["path", { d: "M21 16h-4", key: "1cnmox" }],
  ["path", { d: "M11 3H9", key: "1obp7u" }]
], d7 = dt("wand-sparkles", xD);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const bD = [
  ["path", { d: "M18 6 6 18", key: "1bl5f8" }],
  ["path", { d: "m6 6 12 12", key: "d8bk6v" }]
], tm = dt("x", bD);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const wD = [
  [
    "path",
    {
      d: "M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",
      key: "1xq2db"
    }
  ]
], od = dt("zap", wD);
var h7 = ZT();
const wS = /* @__PURE__ */ bc(h7);
class _D {
  constructor() {
    mt(this, "adapters", []);
  }
  registerAdapter(t) {
    this.adapters.push(t);
  }
  async search(t) {
    return t.trim() ? (await Promise.all(this.adapters.map((r) => r.search(t)))).flat().sort((r, a) => (a.score || 0) - (r.score || 0)) : [];
  }
}
const Oh = new _D(), SD = [
  // Sub-view Navigation (Deep Links)
  // These are NOT in the main sidebar, so we keep them here.
  {
    id: "nav-prompt",
    icon: s1,
    label: "",
    description: " Prompt ",
    action: (e) => e("presets:prompt"),
    keywords: ["prompt", "template", "", ""],
    type: "navigation"
  },
  {
    id: "nav-regex",
    icon: s1,
    label: "",
    description: " Regex ",
    action: (e) => e("presets:regex"),
    keywords: ["regex", "rule", "", ""],
    type: "navigation"
  },
  {
    id: "nav-worldbook",
    icon: _z,
    label: "",
    description: " World Info  Lorebook",
    action: (e) => e("presets:worldbook"),
    keywords: ["world", "book", "lore", ""],
    type: "navigation"
  }
], o1 = [
  { id: "dashboard", icon: jz, label: "", path: "/dashboard" },
  { id: "memory", icon: Rz, label: "", path: "/memory" },
  { id: "processing", icon: yS, label: "", path: "/processing" },
  { id: "presets", icon: R1, label: "API ", path: "/presets" },
  { id: "devlog", icon: z1, label: "", path: "/devlog" },
  { id: "settings", icon: s1, label: "", path: "/settings" }
], CD = {}, X5 = (e) => {
  let t;
  const n = /* @__PURE__ */ new Set(), r = (p, g) => {
    const x = typeof p == "function" ? p(t) : p;
    if (!Object.is(x, t)) {
      const b = t;
      t = g ?? (typeof x != "object" || x === null) ? x : Object.assign({}, t, x), n.forEach((C) => C(t, b));
    }
  }, a = () => t, d = { setState: r, getState: a, getInitialState: () => h, subscribe: (p) => (n.add(p), () => n.delete(p)), destroy: () => {
    (CD ? "production" : void 0) !== "production" && console.warn(
      "[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."
    ), n.clear();
  } }, h = t = e(r, a, d);
  return d;
}, m7 = (e) => e ? X5(e) : X5;
var gx = { exports: {} }, yx = {}, vx = { exports: {} }, xx = {};
/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var Q5;
function ED() {
  if (Q5) return xx;
  Q5 = 1;
  var e = jg();
  function t(g, x) {
    return g === x && (g !== 0 || 1 / g === 1 / x) || g !== g && x !== x;
  }
  var n = typeof Object.is == "function" ? Object.is : t, r = e.useState, a = e.useEffect, o = e.useLayoutEffect, l = e.useDebugValue;
  function c(g, x) {
    var b = x(), C = r({ inst: { value: b, getSnapshot: x } }), N = C[0].inst, T = C[1];
    return o(
      function() {
        N.value = b, N.getSnapshot = x, d(N) && T({ inst: N });
      },
      [g, b, x]
    ), a(
      function() {
        return d(N) && T({ inst: N }), g(function() {
          d(N) && T({ inst: N });
        });
      },
      [g]
    ), l(b), b;
  }
  function d(g) {
    var x = g.getSnapshot;
    g = g.value;
    try {
      var b = x();
      return !n(g, b);
    } catch {
      return !0;
    }
  }
  function h(g, x) {
    return x();
  }
  var p = typeof window > "u" || typeof window.document > "u" || typeof window.document.createElement > "u" ? h : c;
  return xx.useSyncExternalStore = e.useSyncExternalStore !== void 0 ? e.useSyncExternalStore : p, xx;
}
var Z5;
function kD() {
  return Z5 || (Z5 = 1, vx.exports = ED()), vx.exports;
}
/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var J5;
function ND() {
  if (J5) return yx;
  J5 = 1;
  var e = jg(), t = kD();
  function n(h, p) {
    return h === p && (h !== 0 || 1 / h === 1 / p) || h !== h && p !== p;
  }
  var r = typeof Object.is == "function" ? Object.is : n, a = t.useSyncExternalStore, o = e.useRef, l = e.useEffect, c = e.useMemo, d = e.useDebugValue;
  return yx.useSyncExternalStoreWithSelector = function(h, p, g, x, b) {
    var C = o(null);
    if (C.current === null) {
      var N = { hasValue: !1, value: null };
      C.current = N;
    } else N = C.current;
    C = c(
      function() {
        function j(D) {
          if (!R) {
            if (R = !0, A = D, D = x(D), b !== void 0 && N.hasValue) {
              var P = N.value;
              if (b(P, D))
                return z = P;
            }
            return z = D;
          }
          if (P = z, r(A, D)) return P;
          var re = x(D);
          return b !== void 0 && b(P, re) ? (A = D, P) : (A = D, z = re);
        }
        var R = !1, A, z, q = g === void 0 ? null : g;
        return [
          function() {
            return j(p());
          },
          q === null ? void 0 : function() {
            return j(q());
          }
        ];
      },
      [p, g, x, b]
    );
    var T = a(h, C[0], C[1]);
    return l(
      function() {
        N.hasValue = !0, N.value = T;
      },
      [T]
    ), d(T), T;
  }, yx;
}
var eC;
function jD() {
  return eC || (eC = 1, gx.exports = ND()), gx.exports;
}
var TD = jD();
const p7 = /* @__PURE__ */ bc(TD), g7 = {}, { useDebugValue: AD } = hS, { useSyncExternalStoreWithSelector: MD } = p7;
let tC = !1;
const RD = (e) => e;
function OD(e, t = RD, n) {
  (g7 ? "production" : void 0) !== "production" && n && !tC && (console.warn(
    "[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"
  ), tC = !0);
  const r = MD(
    e.subscribe,
    e.getState,
    e.getServerState || e.getInitialState,
    t,
    n
  );
  return AD(r), r;
}
const nC = (e) => {
  (g7 ? "production" : void 0) !== "production" && typeof e != "function" && console.warn(
    "[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`."
  );
  const t = typeof e == "function" ? m7(e) : e, n = (r, a) => OD(t, r, a);
  return Object.assign(n, t), n;
}, y7 = (e) => e ? nC(e) : nC, zD = {
  name: "Paper (Light)",
  colors: {
    background: "oklch(1.0000 0 0)",
    foreground: "oklch(0.1884 0.0128 248.5103)",
    card: "oklch(0.9784 0.0011 197.1387)",
    cardForeground: "oklch(0.1884 0.0128 248.5103)",
    popover: "oklch(1.0000 0 0)",
    popoverForeground: "oklch(0.1884 0.0128 248.5103)",
    primary: "oklch(0.6723 0.1606 244.9955)",
    primaryForeground: "oklch(1.0000 0 0)",
    secondary: "oklch(0.1884 0.0128 248.5103)",
    secondaryForeground: "oklch(1.0000 0 0)",
    muted: "oklch(0.9222 0.0013 286.3737)",
    mutedForeground: "oklch(0.1884 0.0128 248.5103)",
    accent: "oklch(0.9392 0.0166 250.8453)",
    accentForeground: "oklch(0.6723 0.1606 244.9955)",
    destructive: "oklch(0.6188 0.2376 25.7658)",
    destructiveForeground: "oklch(1.0000 0 0)",
    border: "oklch(0.1884 0.0128 248.5103 / 0.15)",
    // Darker (Foreground based) as requested
    input: "oklch(0.9809 0.0025 228.7836)",
    ring: "oklch(0.6818 0.1584 243.3540)",
    chart1: "oklch(0.6723 0.1606 244.9955)",
    chart2: "oklch(0.6907 0.1554 160.3454)",
    chart3: "oklch(0.8214 0.1600 82.5337)",
    chart4: "oklch(0.7064 0.1822 151.7125)",
    chart5: "oklch(0.5919 0.2186 10.5826)",
    sidebar: "oklch(0.9784 0.0011 197.1387)",
    sidebarForeground: "oklch(0.1884 0.0128 248.5103)",
    sidebarPrimary: "oklch(0.6723 0.1606 244.9955)",
    sidebarPrimaryForeground: "oklch(1.0000 0 0)",
    sidebarAccent: "oklch(0.9392 0.0166 250.8453)",
    sidebarAccentForeground: "oklch(0.6723 0.1606 244.9955)",
    sidebarBorder: "oklch(0.1884 0.0128 248.5103 / 0.1)",
    // Darker (Foreground based)
    sidebarRing: "oklch(0.6818 0.1584 243.3540)"
  },
  variables: {
    radius: "1.3rem"
  }
}, DD = {
  name: "Claude (Dark)",
  colors: {
    background: "oklch(0.2679 0.0036 106.6427)",
    foreground: "oklch(0.8074 0.0142 93.0137)",
    card: "oklch(0.2679 0.0036 106.6427)",
    cardForeground: "oklch(0.8074 0.0142 93.0137)",
    popover: "oklch(0.2357 0.0024 67.7077)",
    popoverForeground: "oklch(0.8074 0.0142 93.0137)",
    primary: "oklch(0.6724 0.1308 38.7559)",
    primaryForeground: "oklch(1.0000 0 0)",
    secondary: "oklch(0.2213 0.0038 106.7070)",
    secondaryForeground: "oklch(0.8074 0.0142 93.0137)",
    muted: "oklch(0.2357 0.0024 67.7077)",
    mutedForeground: "oklch(0.7713 0.0169 99.0657)",
    accent: "oklch(0.6724 0.1308 38.7559)",
    accentForeground: "oklch(1.0000 0 0)",
    destructive: "oklch(0.6368 0.2078 25.3313)",
    destructiveForeground: "oklch(1.0000 0 0)",
    border: "oklch(0.8074 0.0142 93.0137 / 0.15)",
    // Foreground / 0.15
    input: "oklch(0.4336 0.0113 100.2195)",
    ring: "oklch(0.6724 0.1308 38.7559)",
    chart1: "oklch(0.6724 0.1308 38.7559)",
    chart2: "oklch(0.6898 0.1581 290.4107)",
    chart3: "oklch(0.8816 0.0276 93.1280)",
    chart4: "oklch(0.3074 0.0516 289.3230)",
    chart5: "oklch(0.6368 0.2078 25.3313)",
    sidebar: "oklch(0.2357 0.0024 67.7077)",
    sidebarForeground: "oklch(0.7713 0.0169 99.0657)",
    sidebarPrimary: "oklch(0.6724 0.1308 38.7559)",
    sidebarPrimaryForeground: "oklch(1.0000 0 0)",
    sidebarAccent: "oklch(0.2213 0.0038 106.7070)",
    sidebarAccentForeground: "oklch(0.8074 0.0142 93.0137)",
    sidebarBorder: "oklch(0.7713 0.0169 99.0657 / 0.15)",
    // SidebarForeground / 0.15
    sidebarRing: "oklch(0.6724 0.1308 38.7559)"
  },
  variables: {
    radius: "0.4rem"
  }
}, ID = {
  name: "Twitter (Dark)",
  colors: {
    background: "oklch(0 0 0)",
    foreground: "oklch(0.9328 0.0025 228.7857)",
    card: "oklch(0 0 0)",
    // Matching background for seamless look, or slightly lighter
    cardForeground: "oklch(0.9328 0.0025 228.7857)",
    popover: "oklch(0 0 0)",
    popoverForeground: "oklch(0.9328 0.0025 228.7857)",
    primary: "oklch(0.6692 0.1607 245.0110)",
    primaryForeground: "oklch(1.0000 0 0)",
    secondary: "oklch(0.2097 0.0080 274.5332)",
    // Using card color from ref as secondary
    secondaryForeground: "oklch(0.8853 0 0)",
    muted: "oklch(0.2090 0 0)",
    mutedForeground: "oklch(0.5637 0.0078 247.9662)",
    accent: "oklch(0.1928 0.0331 242.5459)",
    accentForeground: "oklch(0.6692 0.1607 245.0110)",
    destructive: "oklch(0.6188 0.2376 25.7658)",
    destructiveForeground: "oklch(1.0000 0 0)",
    border: "oklch(0.9328 0.0025 228.7857 / 0.15)",
    // Foreground / 0.15
    input: "oklch(0.3020 0.0288 244.8244)",
    ring: "oklch(0.6818 0.1584 243.3540)",
    chart1: "oklch(0.6723 0.1606 244.9955)",
    chart2: "oklch(0.6907 0.1554 160.3454)",
    chart3: "oklch(0.8214 0.1600 82.5337)",
    chart4: "oklch(0.7064 0.1822 151.7125)",
    chart5: "oklch(0.5919 0.2186 10.5826)",
    sidebar: "oklch(0 0 0)",
    sidebarForeground: "oklch(0.9328 0.0025 228.7857)",
    sidebarPrimary: "oklch(0.6692 0.1607 245.0110)",
    sidebarPrimaryForeground: "oklch(1.0000 0 0)",
    sidebarAccent: "oklch(0.1928 0.0331 242.5459)",
    sidebarAccentForeground: "oklch(0.6692 0.1607 245.0110)",
    sidebarBorder: "oklch(0.9328 0.0025 228.7857 / 0.15)",
    // SidebarForeground / 0.15
    sidebarRing: "oklch(0.6818 0.1584 243.3540)"
  },
  variables: {
    radius: "1.3rem"
  }
}, LD = {
  name: "Discord (Dark)",
  colors: {
    background: "#313338",
    foreground: "#f2f3f5",
    card: "#2b2d31",
    cardForeground: "#f2f3f5",
    popover: "#313338",
    popoverForeground: "#f2f3f5",
    primary: "#5865f2",
    primaryForeground: "#ffffff",
    secondary: "#2b2d31",
    secondaryForeground: "#f2f3f5",
    muted: "#1e1f22",
    mutedForeground: "#949ba4",
    accent: "#3f4147",
    accentForeground: "#f2f3f5",
    destructive: "#fa777c",
    destructiveForeground: "#313338",
    border: "#f2f3f526",
    // Foreground #f2f3f5 with ~15% alpha
    input: "#1e1f22",
    ring: "#5865f2",
    chart1: "#5865f2",
    chart2: "#23a559",
    chart3: "#f0b232",
    chart4: "#00a8fc",
    chart5: "#eb459e",
    sidebar: "#1e1f22",
    sidebarForeground: "#949ba4",
    sidebarPrimary: "#5865f2",
    sidebarPrimaryForeground: "#ffffff",
    sidebarAccent: "#3f4147",
    sidebarAccentForeground: "#f2f3f5",
    sidebarBorder: "#949ba426",
    // SidebarForeground #949ba4 with ~15% alpha
    sidebarRing: "#5865f2"
  },
  variables: {
    radius: "0.25rem"
  }
}, PD = {
  name: "Catppuccin Mocha",
  colors: {
    background: "#1e1e2e",
    // foreground: '#cdd6f4', // Old Text
    foreground: "#cba6f7",
    // Modified: Mauve as requested
    card: "#313244",
    cardForeground: "#cba6f7",
    // Also match text
    popover: "#1e1e2e",
    popoverForeground: "#cba6f7",
    primary: "#89b4fa",
    primaryForeground: "#1e1e2e",
    secondary: "#45475a",
    secondaryForeground: "#cba6f7",
    muted: "#313244",
    mutedForeground: "#a6adc8",
    accent: "#45475a",
    accentForeground: "#cba6f7",
    destructive: "#f38ba8",
    destructiveForeground: "#1e1e2e",
    border: "#cba6f726",
    // Mauve with ~15% alpha
    input: "#313244",
    ring: "#89b4fa",
    chart1: "#89b4fa",
    chart2: "#a6e3a1",
    chart3: "#f9e2af",
    chart4: "#fab387",
    chart5: "#cba6f7",
    sidebar: "#181825",
    sidebarForeground: "#cba6f7",
    // Mauve
    sidebarPrimary: "#89b4fa",
    sidebarPrimaryForeground: "#1e1e2e",
    sidebarAccent: "#313244",
    sidebarAccentForeground: "#cba6f7",
    sidebarBorder: "#cba6f726",
    // Mauve with ~15% alpha
    sidebarRing: "#89b4fa"
  },
  variables: {
    radius: "0.5rem"
  }
}, qD = {
  name: "SillyTavern ()",
  colors: {
    background: "var(--SmartThemeBlurTintColor)",
    foreground: "var(--SmartThemeBodyColor)",
    card: "var(--SmartThemeBlurTintColor)",
    cardForeground: "var(--SmartThemeBodyColor)",
    popover: "var(--SmartThemeBlurTintColor)",
    popoverForeground: "var(--SmartThemeBodyColor)",
    primary: "var(--SmartThemeQuoteColor)",
    primaryForeground: "var(--SmartThemeBodyColor)",
    secondary: "var(--SmartThemeBorderColor)",
    secondaryForeground: "var(--SmartThemeBodyColor)",
    muted: "rgba(0,0,0,0.2)",
    mutedForeground: "rgba(255,255,255,0.5)",
    accent: "var(--SmartThemeQuoteColor)",
    accentForeground: "var(--SmartThemeBodyColor)",
    destructive: "var(--SmartThemeBorderColor)",
    destructiveForeground: "var(--SmartThemeBodyColor)",
    border: "var(--SmartThemeBorderColor)",
    input: "var(--SmartThemeBorderColor)",
    ring: "var(--SmartThemeQuoteColor)",
    chart1: "var(--SmartThemeQuoteColor)",
    chart2: "var(--SmartThemeQuoteColor)",
    chart3: "var(--SmartThemeQuoteColor)",
    chart4: "var(--SmartThemeQuoteColor)",
    chart5: "var(--SmartThemeQuoteColor)",
    sidebar: "var(--SmartThemeBlurTintColor)",
    sidebarForeground: "var(--SmartThemeBodyColor)",
    sidebarPrimary: "var(--SmartThemeQuoteColor)",
    sidebarPrimaryForeground: "var(--SmartThemeBodyColor)",
    sidebarAccent: "var(--SmartThemeBorderColor)",
    sidebarAccentForeground: "var(--SmartThemeBodyColor)",
    sidebarBorder: "var(--SmartThemeBorderColor)",
    sidebarRing: "var(--SmartThemeQuoteColor)"
  },
  variables: {
    radius: "0.4rem"
  }
}, BD = {
  name: "Glass (Frosted)",
  colors: {
    // 
    background: "rgba(255, 255, 255, var(--glass-opacity, 0.1))",
    foreground: "#0f172a",
    //  (Slate-900) 
    //  - 
    card: "rgba(255, 255, 255, var(--glass-opacity, 0.25))",
    cardForeground: "#0f172a",
    popover: "rgba(255, 255, 255, var(--glass-opacity, 0.4))",
    popoverForeground: "#0f172a",
    primary: "rgba(15, 23, 42, 0.8)",
    // 
    primaryForeground: "#ffffff",
    secondary: "rgba(255, 255, 255, 0.3)",
    secondaryForeground: "#0f172a",
    muted: "rgba(255, 255, 255, 0.3)",
    mutedForeground: "rgba(15, 23, 42, 0.6)",
    accent: "rgba(255, 255, 255, 0.4)",
    accentForeground: "#0f172a",
    destructive: "rgba(239, 68, 68, 0.8)",
    destructiveForeground: "#ffffff",
    border: "rgba(15, 23, 42, 0.15)",
    // Lighter base (will be resistant to fade)
    input: "rgba(255, 255, 255, 0.4)",
    ring: "rgba(15, 23, 42, 0.4)",
    chart1: "#0f172a",
    chart2: "rgba(15, 23, 42, 0.8)",
    chart3: "rgba(15, 23, 42, 0.6)",
    chart4: "rgba(15, 23, 42, 0.4)",
    chart5: "rgba(15, 23, 42, 0.2)",
    sidebar: "rgba(255, 255, 255, var(--glass-opacity, 0.15))",
    sidebarForeground: "#0f172a",
    sidebarPrimary: "rgba(15, 23, 42, 0.8)",
    sidebarPrimaryForeground: "#ffffff",
    sidebarAccent: "rgba(255, 255, 255, 0.3)",
    sidebarAccentForeground: "#0f172a",
    sidebarBorder: "rgba(15, 23, 42, 0.1)",
    // Lighter base
    sidebarRing: "rgba(15, 23, 42, 0.4)"
  },
  variables: {
    radius: "1rem"
  }
}, Vy = {
  sillytavern: qD,
  // SillyTavern 
  paperLight: zD,
  twitterDark: ID,
  claudeDark: DD,
  catppuccin: PD,
  discord: LD,
  glass: BD
}, di = [];
for (let e = 0; e < 256; ++e)
  di.push((e + 256).toString(16).slice(1));
function FD(e, t = 0) {
  return (di[e[t + 0]] + di[e[t + 1]] + di[e[t + 2]] + di[e[t + 3]] + "-" + di[e[t + 4]] + di[e[t + 5]] + "-" + di[e[t + 6]] + di[e[t + 7]] + "-" + di[e[t + 8]] + di[e[t + 9]] + "-" + di[e[t + 10]] + di[e[t + 11]] + di[e[t + 12]] + di[e[t + 13]] + di[e[t + 14]] + di[e[t + 15]]).toLowerCase();
}
let bx;
const UD = new Uint8Array(16);
function $D() {
  if (!bx) {
    if (typeof crypto > "u" || !crypto.getRandomValues)
      throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");
    bx = crypto.getRandomValues.bind(crypto);
  }
  return bx(UD);
}
const HD = typeof crypto < "u" && crypto.randomUUID && crypto.randomUUID.bind(crypto), rC = { randomUUID: HD };
function GD(e, t, n) {
  var a;
  e = e || {};
  const r = e.random ?? ((a = e.rng) == null ? void 0 : a.call(e)) ?? $D();
  if (r.length < 16)
    throw new Error("Random bytes length must be >= 16");
  return r[6] = r[6] & 15 | 64, r[8] = r[8] & 63 | 128, FD(r);
}
function zh(e, t, n) {
  return rC.randomUUID && !e ? rC.randomUUID() : GD(e);
}
var w3 = function(e, t) {
  return w3 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(n, r) {
    n.__proto__ = r;
  } || function(n, r) {
    for (var a in r) Object.prototype.hasOwnProperty.call(r, a) && (n[a] = r[a]);
  }, w3(e, t);
};
function Tg(e, t) {
  if (typeof t != "function" && t !== null)
    throw new TypeError("Class extends value " + String(t) + " is not a constructor or null");
  w3(e, t);
  function n() {
    this.constructor = e;
  }
  e.prototype = t === null ? Object.create(t) : (n.prototype = t.prototype, new n());
}
function _3(e) {
  var t = typeof Symbol == "function" && Symbol.iterator, n = t && e[t], r = 0;
  if (n) return n.call(e);
  if (e && typeof e.length == "number") return {
    next: function() {
      return e && r >= e.length && (e = void 0), { value: e && e[r++], done: !e };
    }
  };
  throw new TypeError(t ? "Object is not iterable." : "Symbol.iterator is not defined.");
}
function S3(e, t) {
  var n = typeof Symbol == "function" && e[Symbol.iterator];
  if (!n) return e;
  var r = n.call(e), a, o = [], l;
  try {
    for (; (t === void 0 || t-- > 0) && !(a = r.next()).done; ) o.push(a.value);
  } catch (c) {
    l = { error: c };
  } finally {
    try {
      a && !a.done && (n = r.return) && n.call(r);
    } finally {
      if (l) throw l.error;
    }
  }
  return o;
}
function C3(e, t, n) {
  if (n || arguments.length === 2) for (var r = 0, a = t.length, o; r < a; r++)
    (o || !(r in t)) && (o || (o = Array.prototype.slice.call(t, 0, r)), o[r] = t[r]);
  return e.concat(o || Array.prototype.slice.call(t));
}
function dl(e) {
  return typeof e == "function";
}
function v7(e) {
  var t = function(r) {
    Error.call(r), r.stack = new Error().stack;
  }, n = e(t);
  return n.prototype = Object.create(Error.prototype), n.prototype.constructor = n, n;
}
var wx = v7(function(e) {
  return function(n) {
    e(this), this.message = n ? n.length + ` errors occurred during unsubscription:
` + n.map(function(r, a) {
      return a + 1 + ") " + r.toString();
    }).join(`
  `) : "", this.name = "UnsubscriptionError", this.errors = n;
  };
});
function E3(e, t) {
  if (e) {
    var n = e.indexOf(t);
    0 <= n && e.splice(n, 1);
  }
}
var D1 = (function() {
  function e(t) {
    this.initialTeardown = t, this.closed = !1, this._parentage = null, this._finalizers = null;
  }
  return e.prototype.unsubscribe = function() {
    var t, n, r, a, o;
    if (!this.closed) {
      this.closed = !0;
      var l = this._parentage;
      if (l)
        if (this._parentage = null, Array.isArray(l))
          try {
            for (var c = _3(l), d = c.next(); !d.done; d = c.next()) {
              var h = d.value;
              h.remove(this);
            }
          } catch (N) {
            t = { error: N };
          } finally {
            try {
              d && !d.done && (n = c.return) && n.call(c);
            } finally {
              if (t) throw t.error;
            }
          }
        else
          l.remove(this);
      var p = this.initialTeardown;
      if (dl(p))
        try {
          p();
        } catch (N) {
          o = N instanceof wx ? N.errors : [N];
        }
      var g = this._finalizers;
      if (g) {
        this._finalizers = null;
        try {
          for (var x = _3(g), b = x.next(); !b.done; b = x.next()) {
            var C = b.value;
            try {
              iC(C);
            } catch (N) {
              o = o ?? [], N instanceof wx ? o = C3(C3([], S3(o)), S3(N.errors)) : o.push(N);
            }
          }
        } catch (N) {
          r = { error: N };
        } finally {
          try {
            b && !b.done && (a = x.return) && a.call(x);
          } finally {
            if (r) throw r.error;
          }
        }
      }
      if (o)
        throw new wx(o);
    }
  }, e.prototype.add = function(t) {
    var n;
    if (t && t !== this)
      if (this.closed)
        iC(t);
      else {
        if (t instanceof e) {
          if (t.closed || t._hasParent(this))
            return;
          t._addParent(this);
        }
        (this._finalizers = (n = this._finalizers) !== null && n !== void 0 ? n : []).push(t);
      }
  }, e.prototype._hasParent = function(t) {
    var n = this._parentage;
    return n === t || Array.isArray(n) && n.includes(t);
  }, e.prototype._addParent = function(t) {
    var n = this._parentage;
    this._parentage = Array.isArray(n) ? (n.push(t), n) : n ? [n, t] : t;
  }, e.prototype._removeParent = function(t) {
    var n = this._parentage;
    n === t ? this._parentage = null : Array.isArray(n) && E3(n, t);
  }, e.prototype.remove = function(t) {
    var n = this._finalizers;
    n && E3(n, t), t instanceof e && t._removeParent(this);
  }, e.EMPTY = (function() {
    var t = new e();
    return t.closed = !0, t;
  })(), e;
})(), x7 = D1.EMPTY;
function b7(e) {
  return e instanceof D1 || e && "closed" in e && dl(e.remove) && dl(e.add) && dl(e.unsubscribe);
}
function iC(e) {
  dl(e) ? e() : e.unsubscribe();
}
var VD = {
  Promise: void 0
}, KD = {
  setTimeout: function(e, t) {
    for (var n = [], r = 2; r < arguments.length; r++)
      n[r - 2] = arguments[r];
    return setTimeout.apply(void 0, C3([e, t], S3(n)));
  },
  clearTimeout: function(e) {
    return clearTimeout(e);
  },
  delegate: void 0
};
function YD(e) {
  KD.setTimeout(function() {
    throw e;
  });
}
function aC() {
}
function Ky(e) {
  e();
}
var _S = (function(e) {
  Tg(t, e);
  function t(n) {
    var r = e.call(this) || this;
    return r.isStopped = !1, n ? (r.destination = n, b7(n) && n.add(r)) : r.destination = QD, r;
  }
  return t.create = function(n, r, a) {
    return new k3(n, r, a);
  }, t.prototype.next = function(n) {
    this.isStopped || this._next(n);
  }, t.prototype.error = function(n) {
    this.isStopped || (this.isStopped = !0, this._error(n));
  }, t.prototype.complete = function() {
    this.isStopped || (this.isStopped = !0, this._complete());
  }, t.prototype.unsubscribe = function() {
    this.closed || (this.isStopped = !0, e.prototype.unsubscribe.call(this), this.destination = null);
  }, t.prototype._next = function(n) {
    this.destination.next(n);
  }, t.prototype._error = function(n) {
    try {
      this.destination.error(n);
    } finally {
      this.unsubscribe();
    }
  }, t.prototype._complete = function() {
    try {
      this.destination.complete();
    } finally {
      this.unsubscribe();
    }
  }, t;
})(D1), WD = (function() {
  function e(t) {
    this.partialObserver = t;
  }
  return e.prototype.next = function(t) {
    var n = this.partialObserver;
    if (n.next)
      try {
        n.next(t);
      } catch (r) {
        jy(r);
      }
  }, e.prototype.error = function(t) {
    var n = this.partialObserver;
    if (n.error)
      try {
        n.error(t);
      } catch (r) {
        jy(r);
      }
    else
      jy(t);
  }, e.prototype.complete = function() {
    var t = this.partialObserver;
    if (t.complete)
      try {
        t.complete();
      } catch (n) {
        jy(n);
      }
  }, e;
})(), k3 = (function(e) {
  Tg(t, e);
  function t(n, r, a) {
    var o = e.call(this) || this, l;
    return dl(n) || !n ? l = {
      next: n ?? void 0,
      error: r ?? void 0,
      complete: a ?? void 0
    } : l = n, o.destination = new WD(l), o;
  }
  return t;
})(_S);
function jy(e) {
  YD(e);
}
function XD(e) {
  throw e;
}
var QD = {
  closed: !0,
  next: aC,
  error: XD,
  complete: aC
}, ZD = (function() {
  return typeof Symbol == "function" && Symbol.observable || "@@observable";
})();
function JD(e) {
  return e;
}
function eI(e) {
  return e.length === 0 ? JD : e.length === 1 ? e[0] : function(n) {
    return e.reduce(function(r, a) {
      return a(r);
    }, n);
  };
}
var sC = (function() {
  function e(t) {
    t && (this._subscribe = t);
  }
  return e.prototype.lift = function(t) {
    var n = new e();
    return n.source = this, n.operator = t, n;
  }, e.prototype.subscribe = function(t, n, r) {
    var a = this, o = nI(t) ? t : new k3(t, n, r);
    return Ky(function() {
      var l = a, c = l.operator, d = l.source;
      o.add(c ? c.call(o, d) : d ? a._subscribe(o) : a._trySubscribe(o));
    }), o;
  }, e.prototype._trySubscribe = function(t) {
    try {
      return this._subscribe(t);
    } catch (n) {
      t.error(n);
    }
  }, e.prototype.forEach = function(t, n) {
    var r = this;
    return n = oC(n), new n(function(a, o) {
      var l = new k3({
        next: function(c) {
          try {
            t(c);
          } catch (d) {
            o(d), l.unsubscribe();
          }
        },
        error: o,
        complete: a
      });
      r.subscribe(l);
    });
  }, e.prototype._subscribe = function(t) {
    var n;
    return (n = this.source) === null || n === void 0 ? void 0 : n.subscribe(t);
  }, e.prototype[ZD] = function() {
    return this;
  }, e.prototype.pipe = function() {
    for (var t = [], n = 0; n < arguments.length; n++)
      t[n] = arguments[n];
    return eI(t)(this);
  }, e.prototype.toPromise = function(t) {
    var n = this;
    return t = oC(t), new t(function(r, a) {
      var o;
      n.subscribe(function(l) {
        return o = l;
      }, function(l) {
        return a(l);
      }, function() {
        return r(o);
      });
    });
  }, e.create = function(t) {
    return new e(t);
  }, e;
})();
function oC(e) {
  var t;
  return (t = e ?? VD.Promise) !== null && t !== void 0 ? t : Promise;
}
function tI(e) {
  return e && dl(e.next) && dl(e.error) && dl(e.complete);
}
function nI(e) {
  return e && e instanceof _S || tI(e) && b7(e);
}
function rI(e) {
  return dl(e == null ? void 0 : e.lift);
}
function iI(e) {
  return function(t) {
    if (rI(t))
      return t.lift(function(n) {
        try {
          return e(n, this);
        } catch (r) {
          this.error(r);
        }
      });
    throw new TypeError("Unable to lift unknown Observable type");
  };
}
function aI(e, t, n, r, a) {
  return new sI(e, t, n, r, a);
}
var sI = (function(e) {
  Tg(t, e);
  function t(n, r, a, o, l, c) {
    var d = e.call(this, n) || this;
    return d.onFinalize = l, d.shouldUnsubscribe = c, d._next = r ? function(h) {
      try {
        r(h);
      } catch (p) {
        n.error(p);
      }
    } : e.prototype._next, d._error = o ? function(h) {
      try {
        o(h);
      } catch (p) {
        n.error(p);
      } finally {
        this.unsubscribe();
      }
    } : e.prototype._error, d._complete = a ? function() {
      try {
        a();
      } catch (h) {
        n.error(h);
      } finally {
        this.unsubscribe();
      }
    } : e.prototype._complete, d;
  }
  return t.prototype.unsubscribe = function() {
    var n;
    if (!this.shouldUnsubscribe || this.shouldUnsubscribe()) {
      var r = this.closed;
      e.prototype.unsubscribe.call(this), !r && ((n = this.onFinalize) === null || n === void 0 || n.call(this));
    }
  }, t;
})(_S), oI = v7(function(e) {
  return function() {
    e(this), this.name = "ObjectUnsubscribedError", this.message = "object unsubscribed";
  };
}), SS = (function(e) {
  Tg(t, e);
  function t() {
    var n = e.call(this) || this;
    return n.closed = !1, n.currentObservers = null, n.observers = [], n.isStopped = !1, n.hasError = !1, n.thrownError = null, n;
  }
  return t.prototype.lift = function(n) {
    var r = new lC(this, this);
    return r.operator = n, r;
  }, t.prototype._throwIfClosed = function() {
    if (this.closed)
      throw new oI();
  }, t.prototype.next = function(n) {
    var r = this;
    Ky(function() {
      var a, o;
      if (r._throwIfClosed(), !r.isStopped) {
        r.currentObservers || (r.currentObservers = Array.from(r.observers));
        try {
          for (var l = _3(r.currentObservers), c = l.next(); !c.done; c = l.next()) {
            var d = c.value;
            d.next(n);
          }
        } catch (h) {
          a = { error: h };
        } finally {
          try {
            c && !c.done && (o = l.return) && o.call(l);
          } finally {
            if (a) throw a.error;
          }
        }
      }
    });
  }, t.prototype.error = function(n) {
    var r = this;
    Ky(function() {
      if (r._throwIfClosed(), !r.isStopped) {
        r.hasError = r.isStopped = !0, r.thrownError = n;
        for (var a = r.observers; a.length; )
          a.shift().error(n);
      }
    });
  }, t.prototype.complete = function() {
    var n = this;
    Ky(function() {
      if (n._throwIfClosed(), !n.isStopped) {
        n.isStopped = !0;
        for (var r = n.observers; r.length; )
          r.shift().complete();
      }
    });
  }, t.prototype.unsubscribe = function() {
    this.isStopped = this.closed = !0, this.observers = this.currentObservers = null;
  }, Object.defineProperty(t.prototype, "observed", {
    get: function() {
      var n;
      return ((n = this.observers) === null || n === void 0 ? void 0 : n.length) > 0;
    },
    enumerable: !1,
    configurable: !0
  }), t.prototype._trySubscribe = function(n) {
    return this._throwIfClosed(), e.prototype._trySubscribe.call(this, n);
  }, t.prototype._subscribe = function(n) {
    return this._throwIfClosed(), this._checkFinalizedStatuses(n), this._innerSubscribe(n);
  }, t.prototype._innerSubscribe = function(n) {
    var r = this, a = this, o = a.hasError, l = a.isStopped, c = a.observers;
    return o || l ? x7 : (this.currentObservers = null, c.push(n), new D1(function() {
      r.currentObservers = null, E3(c, n);
    }));
  }, t.prototype._checkFinalizedStatuses = function(n) {
    var r = this, a = r.hasError, o = r.thrownError, l = r.isStopped;
    a ? n.error(o) : l && n.complete();
  }, t.prototype.asObservable = function() {
    var n = new sC();
    return n.source = this, n;
  }, t.create = function(n, r) {
    return new lC(n, r);
  }, t;
})(sC), lC = (function(e) {
  Tg(t, e);
  function t(n, r) {
    var a = e.call(this) || this;
    return a.destination = n, a.source = r, a;
  }
  return t.prototype.next = function(n) {
    var r, a;
    (a = (r = this.destination) === null || r === void 0 ? void 0 : r.next) === null || a === void 0 || a.call(r, n);
  }, t.prototype.error = function(n) {
    var r, a;
    (a = (r = this.destination) === null || r === void 0 ? void 0 : r.error) === null || a === void 0 || a.call(r, n);
  }, t.prototype.complete = function() {
    var n, r;
    (r = (n = this.destination) === null || n === void 0 ? void 0 : n.complete) === null || r === void 0 || r.call(n);
  }, t.prototype._subscribe = function(n) {
    var r, a;
    return (a = (r = this.source) === null || r === void 0 ? void 0 : r.subscribe(n)) !== null && a !== void 0 ? a : x7;
  }, t;
})(SS);
function lI(e, t) {
  return iI(function(n, r) {
    var a = 0;
    n.subscribe(aI(r, function(o) {
      return e.call(t, o, a++) && r.next(o);
    }));
  });
}
const Ty = new SS(), uI = {
  /**
   * 
   */
  emit(e) {
    Ty.next({
      ...e,
      timestamp: Date.now()
    });
  },
  /**
   * 
   */
  subscribe(e) {
    const t = Ty.subscribe(e);
    return {
      unsubscribe: () => t.unsubscribe()
    };
  },
  /**
   * 
   */
  on(e, t) {
    const n = Ty.pipe(lI((r) => r.type === e)).subscribe((r) => t(r.payload));
    return {
      unsubscribe: () => n.unsubscribe()
    };
  },
  /**
   *  RxJS 
   */
  asObservable() {
    return Ty.asObservable();
  }
};
var Kn = /* @__PURE__ */ ((e) => (e[e.DEBUG = 0] = "DEBUG", e[e.INFO = 1] = "INFO", e[e.SUCCESS = 2] = "SUCCESS", e[e.WARN = 3] = "WARN", e[e.ERROR = 4] = "ERROR", e))(Kn || {});
const l1 = {
  0: { label: "DEBUG", icon: "", color: "#6c757d" },
  1: { label: "INFO", icon: "", color: "#17a2b8" },
  2: { label: "OK", icon: "", color: "#28a745" },
  3: { label: "WARN", icon: "", color: "#ffc107" },
  4: { label: "ERROR", icon: "", color: "#dc3545" }
}, w7 = {
  maxEntries: 5e3,
  minLevel: 0
  /* DEBUG */
}, _7 = new SS();
let Jl = [], ag = { ...w7 };
function cI(e) {
  return new Date(e).toTimeString().slice(0, 8);
}
function Dh(e, t, n, r) {
  if (e < ag.minLevel) return;
  const a = {
    id: zh(),
    timestamp: Date.now(),
    level: e,
    module: t,
    message: n,
    data: r
  };
  Jl.push(a), Jl.length > ag.maxEntries && (Jl = Jl.slice(-ag.maxEntries)), _7.next(a);
}
function fI() {
  uI.subscribe((e) => {
    const n = {
      INGESTION_START: Kn.INFO,
      INGESTION_COMPLETE: Kn.SUCCESS,
      ENTITY_CREATED: Kn.INFO,
      MEMORY_STORED: Kn.SUCCESS,
      RETRIEVAL_START: Kn.DEBUG,
      RETRIEVAL_COMPLETE: Kn.SUCCESS,
      CHAT_CHANGED: Kn.INFO,
      MESSAGE_RECEIVED: Kn.DEBUG
    }[e.type] ?? Kn.DEBUG;
    Dh(n, "EventBus", `${e.type}`, e.payload);
  });
}
const ye = {
  /**
   *  Logger
   */
  init(e) {
    e && (ag = { ...ag, ...e }), Jl = [], fI(), ye.info("Logger", "Logger ");
  },
  /**
   * DEBUG 
   */
  debug(e, t, n) {
    Dh(Kn.DEBUG, e, t, n);
  },
  /**
   * INFO 
   */
  info(e, t, n) {
    Dh(Kn.INFO, e, t, n);
  },
  /**
   * SUCCESS 
   */
  success(e, t, n) {
    Dh(Kn.SUCCESS, e, t, n);
  },
  /**
   * WARN 
   */
  warn(e, t, n) {
    Dh(Kn.WARN, e, t, n);
  },
  /**
   * ERROR 
   */
  error(e, t, n) {
    Dh(Kn.ERROR, e, t, n);
  },
  /**
   * 
   */
  getLogs() {
    return [...Jl];
  },
  /**
   * 
   */
  subscribe(e) {
    const t = _7.subscribe(e);
    return () => t.unsubscribe();
  },
  /**
   * 
   */
  clear() {
    Jl = [], ye.info("Logger", "");
  },
  /**
   *  Markdown 
   */
  exportToMarkdown() {
    const e = /* @__PURE__ */ new Date();
    e.toISOString().slice(0, 10), e.toTimeString().slice(0, 8).replace(/:/g, "");
    const t = {
      [Kn.DEBUG]: "DEBUG",
      [Kn.INFO]: "INFO",
      [Kn.SUCCESS]: "SUCCESS",
      [Kn.WARN]: "WARN",
      [Kn.ERROR]: "ERROR"
    };
    let n = `# Engram Debug Log

`;
    n += `- ****: ${e.toLocaleString("zh-CN")}
`, n += `- ****: 0.1.0
`, n += `- ****: ${Jl.length}

`, n += `---

`, n += `## 

`, n += "```\n";
    for (const r of Jl) {
      const a = cI(r.timestamp), o = t[r.level].padEnd(7), l = r.module.padEnd(16);
      if (n += `[${a}] [${l}] ${o} ${r.message}
`, r.data !== void 0) {
        const c = JSON.stringify(r.data, null, 2).split(`
`).map((d) => `    ${d}`).join(`
`);
        n += `${c}
`;
      }
    }
    return n += "```\n", n;
  },
  /**
   * 
   */
  getExportFilename() {
    const e = /* @__PURE__ */ new Date(), t = e.toISOString().slice(0, 10), n = e.toTimeString().slice(0, 8).replace(/:/g, "");
    return `engram_log_${t}_${n}.md`;
  }
}, uC = 100;
class dI {
  constructor() {
    mt(this, "entries", []);
    mt(this, "listeners", /* @__PURE__ */ new Set());
  }
  /**
   * 
   */
  logSend(t) {
    const n = `log_${Date.now()}_${Math.random().toString(36).slice(2, 8)}`, r = {
      id: n,
      timestamp: Date.now(),
      type: t.type,
      direction: "sent",
      systemPrompt: t.systemPrompt,
      userPrompt: t.userPrompt,
      tokensSent: t.tokensSent,
      model: t.model,
      character: t.character,
      floorRange: t.floorRange,
      status: "pending"
    };
    return this.entries.unshift(r), this.trimEntries(), this.notifyListeners(), n;
  }
  /**
   * 
   */
  logReceive(t, n) {
    const r = this.entries.find((l) => l.id === t);
    if (!r) return;
    const a = {
      id: `${t}_recv`,
      timestamp: Date.now(),
      type: r.type,
      direction: "received",
      response: n.response,
      tokensReceived: n.tokensReceived,
      status: n.status,
      error: n.error,
      duration: n.duration,
      model: r.model,
      character: r.character,
      floorRange: r.floorRange
    };
    r.status = n.status, r.duration = n.duration;
    const o = this.entries.findIndex((l) => l.id === t);
    o >= 0 ? this.entries.splice(o, 0, a) : this.entries.unshift(a), this.trimEntries(), this.notifyListeners();
  }
  /**
   * 
   */
  async logCall(t, n) {
    const r = this.logSend(t), a = Date.now();
    try {
      const o = await n();
      return this.logReceive(r, {
        response: typeof o == "string" ? o : JSON.stringify(o),
        status: "success",
        duration: Date.now() - a
      }), o;
    } catch (o) {
      throw this.logReceive(r, {
        status: "error",
        error: o instanceof Error ? o.message : String(o),
        duration: Date.now() - a
      }), o;
    }
  }
  /**
   * 
   */
  getAll() {
    return [...this.entries];
  }
  /**
   * +
   */
  getPaired() {
    const t = [], n = this.entries.filter((r) => r.direction === "sent");
    for (const r of n) {
      const a = this.entries.find(
        (o) => o.id === `${r.id}_recv` && o.direction === "received"
      );
      t.push({ sent: r, received: a });
    }
    return t;
  }
  /**
   * 
   */
  clear() {
    this.entries = [], this.notifyListeners();
  }
  /**
   * 
   */
  subscribe(t) {
    return this.listeners.add(t), () => this.listeners.delete(t);
  }
  /**
   * 
   */
  getCount() {
    return this.entries.filter((t) => t.direction === "sent").length;
  }
  /**
   * 
   */
  trimEntries() {
    this.entries.length > uC * 2 && (this.entries = this.entries.slice(0, uC * 2));
  }
  /**
   * 
   */
  notifyListeners() {
    for (const t of this.listeners)
      t();
  }
}
const ns = new dI(), CS = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  DEFAULT_LOGGER_CONFIG: w7,
  LogLevel: Kn,
  LogLevelConfig: l1,
  Logger: ye,
  ModelLogger: ns
}, Symbol.toStringTag, { value: "Module" })), hI = `<system_configuration>
  <role_definition>
    : 
    : """"""
    
    :
      : 
      : 
      : 
      : 
    
    :
      - 
      -  YAML 
      - 
      - 
  </role_definition>

  <formatting_protocol>
    :  JSON 
    :
      - summary: //
      - meta:  (role, location, event, logic, causality)
      - significance_score: 0.0-1.0 
  </formatting_protocol>

  <logic_protocol>
    :
      : ""
      : """"
    
    :
      : 
      : 
        : "102344"
        : "1""3"""
      : 
        :  HH:MM (14:30)
        :  
        :   

     (Token):
      : 
      : 
       ():
        1: {{user}}
        2: {{user}}
        3: {{user}}...
       ():
        1: [ | {{user}}, , ] {{user}} ( | 0.7)

     ():
      -: "/"
        : {{user}}
        : {{user}}
      : ""
        : {{user}}...
        : {{user}}
      : 
        : {{user}}{{user}}...
        : {{user}}
      : """"
        : {{user}}
        : {{user}}

     ():
      _ (Foundation):
        : 0.1 - 0.4
        : >60%
        : """" 0.3-0.4 ()
      _ (Propulsion):
        : 0.5 - 0.7
        :  <30%
        : 
      _ (Keystone):
        : 0.8 - 0.9
        :  <10%
        : 
        : 
      _ (Turning Point):
        : 1.0
        : "" 1%
        : 
  </logic_protocol>

  <output_template>
    <think>
      :
        : \${}
        : \${}
      
      :
        : \${}
        : \${}
      
      :
        : \${}
        : \${}
      
      :
        : \${}
        : \${}
    </think>

    \`\`\`json
    {
      "events": [
        {
          "summary": "//",
          "meta": {
            "time_anchor": " 102344 ",
            "role": [""],
            "location": "",
            "event": "",
            "logic": [""],
            "causality": "Start|Chain|End"
          },
          "significance_score": 0.7
        }
      ]
    }
    \`\`\`
  </output_template>
  
  <example_demonstration>
    :
      "ABBA
      () AB""A""
      () A""A"""

    AI:
      <think>
        :
          : //
          : 
        
        :
          1: A (//) -> 
          2: B (//) -> 
          3:  +  -> 
          4:  +  -> 
      </think>

      \`\`\`json
      {
        "events": [
          {
            "summary": "ABBA",
            "meta": {
              "time_anchor": "102344 ",
              "role": ["A", "B"],
              "location": "",
              "event": "",
              "logic": ["", "", ""],
              "causality": "Start"
            },
            "significance_score": 0.8
          },
          {
            "summary": "ABA",
            "meta": {
              "role": ["A", "B", ""],
              "location": "",
              "event": "",
              "logic": ["", "", ""],
              "causality": "Chain"
            },
            "significance_score": 0.8
          },
          {
            "summary": "A",
            "meta": {
              "role": ["A", ""],
              "location": "",
              "event": "",
              "logic": ["", "", ""],
              "causality": "Start"
            },
            "significance_score": 0.6
          }
        ]
      }
      \`\`\`
  </example_demonstration>
</system_configuration>
`, S7 = `<system_configuration>
  <role_definition>
    : 
    : "" Token 
    
    :
      : 
      : 
      : 
      : 
    
    :
      - 
      - 
      - 
      - 
  </role_definition>

  <compression_protocol>
    _: 
      : 
      :
        - P0 (): //
        - P1 (): /
        - P2 (): 
    
    _:
      : 
      :   
    
    _:
      : 
      :
        : "A " + "A "  "A " ()
        : "A "
  </compression_protocol>

  <merge_strategy>
    _:
      : 
      :
        :
          1. [3 | ] A  ( | 0.2)
          2. [5 | ] A  ( | 0.2)
          3. [7 | ] A  ( | 0.5)
        :
          1. [3-7 | ] A  ( | 0.5)
    
    _:
      : 
      : 
    
    _:
      : 
      :
        : "A " + "A " + "A "
        : "A "
      : ""
  </merge_strategy>

  <output_format>
    :  JSON  text_summary 
    :
      - summary: 
      - meta:  (role, location, event, logic, causality)
      - significance_score: 0.0-1.0  ()
    
    :  30-50%
  </output_format>

  <example_demonstration>
     ():
      \`\`\`
      (102344 ) AB
      Role: [A, B]
      Loc: 
      Event: 
      Logic: []
      Causality: Start
      Significance: 0.8

      (102344 ) BA
      Role: [A, B]
      Loc: 
      Event: 
      Logic: []
      Causality: Chain
      Significance: 0.6

      (1023-1026 ) AB
      Role: [A, ]
      Loc: 
      Event: 
      Logic: []
      Causality: Chain
      Significance: 0.4

      (1026 ) A
      Role: [A, B]
      Loc: B
      Event: 
      Logic: []
      Causality: End
      Significance: 0.8

      (410 ) A
      Role: [A]
      Loc: 
      Event: 
      Logic: []
      Causality: Start
      Significance: 0.3

      (410 14:30) A
      Role: [A, ]
      Loc: 
      Event: 
      Logic: [, ]
      Causality: Chain
      Significance: 0.7
      \`\`\`

     (JSON ):
      \`\`\`json
      {
        "events": [
          {
            "summary": "ABBA",
            "meta": {
              "time_anchor": "102344",
              "role": ["A", "B"],
              "location": "",
              "event": "",
              "logic": ["", "", ""],
              "causality": "Start"
            },
            "significance_score": 0.8
          },
          {
            "summary": "AB",
            "meta": {
              "time_anchor": "1023-1026",
              "role": ["A", "B", ""],
              "location": "",
              "event": "",
              "logic": ["", ""],
              "causality": "Chain"
            },
            "significance_score": 0.8
          },
          {
            "summary": "A",
            "meta": {
              "time_anchor": "410",
              "role": ["A", ""],
              "location": "",
              "event": "",
              "logic": ["", "", ""],
              "causality": "Start"
            },
            "significance_score": 0.7
          }
        ]
      }
      \`\`\`
  </example_demonstration>
</system_configuration>

`, mI = `# Query 

""""

---

## 

****
{{worldbookContext}}

****
{{chatHistory}}

---

## 


1. ****""""""
2. ****
3. ****

---

## 

\`\`\`xml
<think>
[]
</think>

<query>
1, 2, 3, ...
</query>

<output>
[]
</output>
\`\`\`

---

## 

****

****
\`\`\`xml
<think>

- "" Alice  Bob
- ""
</think>

<query>
Alice, Bob, , , , 
</query>

<output>
 Alice  Bob 
</output>
\`\`\`

---

## 

{{userInput}}
`, pI = `<system_configuration>
  <role_definition>
    :  / 
    : 

    :
      : 
      : 
      : """"

    :
      - 
      - 
      - 
      -  plot 
  </role_definition>

  <behavior_guidelines>
    :
      : 
      :
        1. 
        2. 
        3. 
      :
        : 
        : 
      :  think  output 

    :
      : 
      :
        - :  "500"   ""
        - :  "3"   ""
        - : 
        - :  ""   ""
      : AI
  </behavior_guidelines>

  <core_rules>
    A_:
      A1_:
        : 
        NPC: NPC
        : 

      A2_:
        : 10
        : NPC510
        : 

      A3_:
        : 20
        :
          : 
          : 
        : 

      A4_:
        :
          1: 
          2: 
          3: 

        :
          : 
          : 80
          : 100
          : 

    B_:
      B1_:
        : 
        : 
        : 

      B2_:
        : /
          : [] [: X] []  []  []
        : 
          : [] [] [] [] [: X]
        : 
          : [] [: X] []  []

      B3_:
        : 1-2
        : 

    C_:
      : 
      :
        : 
        : 
        : 
        :  {{user}} 
      :
        : 
        : 
  </core_rules>

  <writing_style>
    :
      : 
      : 
      : 
      : 
      : 
  </writing_style>

  <output_template>
    <think>
      :
        :
          : \${}
          : \${}
          : \${}
        :
          : \${}
          : \${}
        :
          : \${}
          : \${//}

      10:
        : \${}
        :
          1: \${}
          2: \${}
          ...
        :
          : \${}
        :
          : \${}
          : \${}

      :
        : \${}
        : \${} + \${} = \${}/100
        : \${} + \${} = \${}/100
        : \${(80)(100)}

      :
        :
          : \${/}
          : \${}
    </think>

    <query>
    \${ RAG }
    1, , , , ...
    </query>

    <output>
    <plot>
      <directive>
        <goal>\${}</goal>
        <plot_summary>\${}</plot_summary>
        <key_points>
          <point>\${+}</point>
          <point>\${}</point>
          <point>\${}</point>
          <point>\${}</point>
          <point>\${}</point>
        </key_points>
      </directive>

      :
        : \${}/100 \${}
        : \${}/100
        : \${}
        : \${}
        : \${}
        : \${}
        : \${NPC -  ()}

        :
          1. \${[] [] }
          2. \${[] [] }
    </plot>
    </output>
  </output_template>
</system_configuration>
`, gI = `# 



---

## 

****
{{context}}

****
{{chatHistory}}

---

## 


1. ****
2. ****
3. ****
4. ****

---

## 

\`\`\`xml
<think>
[]
</think>

<output>
[]
</output>
\`\`\`

---

## 

****

****
\`\`\`xml
<think>

- 
- 
- 
</think>

<output>

</output>
\`\`\`

---

## 

{{userInput}}
`, C7 = `<system_configuration>
  <role_definition>
    : 
    : 
    
    :
      : 
      : 
    
    :
      - 
      - 
      -  existingEntities
      - 
  </role_definition>

  <entity_types>
    char: / ()
    loc:  ()
    item:  ()
    concept: 
    unknown: 
  </entity_types>

  <extraction_rules>
    :
      - 
      -  ("""")
      -  ("""")
      -  ()
    
    :
      -  aliases
      - : ""  """"
    
    :
      -  existingEntities 
      -  name ()
      -  () profile.identity 
  </extraction_rules>

  <profile_structure>
    profile  JSON 
    
     ():
      - relations: EntityRelation[]  
        : target (), type ()
        : description ()
    
     ():
      - identity: string  
      - tags: string[]  
      
     (char) :
      - personality: string  
      - skills: string[]  /
      - affiliation: string  
      
     (loc) :
      - atmosphere: string  
      - features: string[]  
      
     (item) :
      - owner: string  
      - abilities: string[]  
  </profile_structure>

  <output_template>
    <think>
      :
         existingEntities 
        /
      
      :
        
        
      
      :
        
        
    </think>

    \`\`\`json
    {
      "entities": [
        {
          "name": "",
          "type": "char|loc|item|concept",
          "aliases": ["1", "2"],
          "profile": {
            "identity": "",
            "relations": [
              { "target": "", "type": "", "description": "" }
            ],
            "": ""
          }
        }
      ]
    }
    \`\`\`
  </output_template>

  <example_demonstration>
    :
      chatHistory: "ABAB"
      existingEntities: []

    :
      \`\`\`json
      {
        "entities": [
          {
            "name": "A",
            "type": "char",
            "aliases": ["A"],
            "profile": {
              "identity": "",
              "personality": "",
              "relations": [
                { "target": "B", "type": "", "description": "AB" }
              ]
            }
          },
          {
            "name": "B",
            "type": "char",
            "aliases": ["B"],
            "profile": {
              "identity": "A",
              "affiliation": "",
              "relations": [
                { "target": "A", "type": "", "description": "A" }
              ]
            }
          },
          {
            "name": "",
            "type": "loc",
            "aliases": [],
            "profile": {
              "atmosphere": "",
              "features": ["", ""]
            }
          }
        ]
      }
      \`\`\`
  </example_demonstration>
</system_configuration>
`, E7 = {
  enabled: !0,
  decayFactor: 0.15,
  maxStickRounds: 3
};
class yI {
  constructor() {
    /** : eventId -> StickyCacheEntry */
    mt(this, "cache", /* @__PURE__ */ new Map());
    /**  */
    mt(this, "currentRound", 0);
  }
  /**
   * 
   */
  nextRound() {
    this.currentRound++, ye.debug("StickyCache", ` ${this.currentRound} `);
  }
  /**
   * 
   */
  getCurrentRound() {
    return this.currentRound;
  }
  /**
   * 
   */
  markRecalled(t) {
    const n = this.cache.get(t);
    n && n.lastRound === this.currentRound - 1 ? this.cache.set(t, {
      lastRound: this.currentRound,
      consecutiveCount: n.consecutiveCount + 1
    }) : this.cache.set(t, {
      lastRound: this.currentRound,
      consecutiveCount: 1
    });
  }
  /**
   * 
   */
  markRecalledBatch(t) {
    t.forEach((n) => this.markRecalled(n));
  }
  /**
   * 
   *
   * @param eventId  ID
   * @param config 
   * @returns  [0, 1]0 = 1 = 
   */
  getStickyPenalty(t, n) {
    if (!n.enabled) return 0;
    const r = this.cache.get(t);
    return !r || this.currentRound - r.lastRound > n.maxStickRounds ? 0 : Math.min(1, r.consecutiveCount * n.decayFactor);
  }
  /**
   * 
   */
  isSticky(t, n) {
    return this.getStickyPenalty(t, n) > 0;
  }
  /**
   * 
   *
   * @param maxAge 
   */
  cleanup(t = 10) {
    let n = 0;
    for (const [r, a] of this.cache)
      this.currentRound - a.lastRound > t && (this.cache.delete(r), n++);
    n > 0 && ye.debug("StickyCache", ` ${n} `);
  }
  /**
   * 
   */
  clear() {
    this.cache.clear(), this.currentRound = 0, ye.debug("StickyCache", "");
  }
  /**
   * 
   */
  getStats() {
    return {
      size: this.cache.size,
      currentRound: this.currentRound
    };
  }
  /**
   * /
   */
  getEventInfo(t) {
    return this.cache.get(t);
  }
}
const Bp = new yI(), hg = [
  { value: "summary", label: "", description: " JSON " },
  { value: "trim", label: "/", description: "" },
  { value: "preprocessing", label: "", description: "Query //" },
  { value: "entity_extraction", label: "", description: "" }
], k7 = [
  {
    id: "custom_user_profile",
    name: "",
    content: "",
    // 
    enabled: !0,
    createdAt: Date.now()
  }
], ES = {
  enabled: !1,
  trigger: "floor",
  floorInterval: 50,
  keepRecentCount: 5
}, N7 = {
  enableNativeRegex: !0,
  enableEngramRegex: !0
}, Ag = {
  enabled: !0,
  useEmbedding: !0,
  useRerank: !1,
  usePreprocessing: !1,
  useBruteForce: !1,
  //  Embedding 
  embedding: {
    topK: 20,
    minScoreThreshold: 0.3
  },
  sticky: { ...E7, enabled: !0 }
}, j7 = {
  temperature: 0.7,
  topP: 0.95,
  maxTokens: 2048,
  frequencyPenalty: 0,
  presencePenalty: 0
}, T7 = {
  maxChatHistory: 10
}, A7 = {
  source: "transformers"
}, M7 = {
  enabled: !1,
  url: "",
  apiKey: "",
  model: "",
  topN: 5,
  hybridAlpha: 0.5
}, N3 = {
  enabled: !1,
  trigger: "with_trim",
  concurrency: 5,
  keepRecentCount: 3,
  standalone: {
    triggerType: "count",
    countLimit: 5,
    tokenLimit: 10240
  }
};
function kS(e = "") {
  const t = Date.now();
  return {
    id: `preset_${t}`,
    name: e,
    source: "tavern",
    parameters: { ...j7 },
    context: { ...T7 },
    isDefault: !0,
    createdAt: t,
    updatedAt: t
  };
}
function ll(e, t, n = {}) {
  const r = Date.now();
  return {
    id: n.id || `template_${r}_${Math.random().toString(36).slice(2, 8)}`,
    name: e,
    category: t,
    enabled: n.enabled ?? !1,
    isBuiltIn: n.isBuiltIn ?? !1,
    boundPresetId: n.boundPresetId ?? null,
    systemPrompt: n.systemPrompt ?? "",
    userPromptTemplate: n.userPromptTemplate ?? "",
    outputFormat: n.outputFormat ?? "plain",
    availableVariables: n.availableVariables ?? ["{{chatHistory}}", "{{context}}", "{{char}}", "{{user}}"],
    createdAt: r,
    updatedAt: r
  };
}
function I1() {
  return [
    ll("", "summary", {
      id: "builtin_summary",
      enabled: !0,
      isBuiltIn: !0,
      systemPrompt: hI,
      userPromptTemplate: `{{worldbookContext}}


{{chatHistory}}

---
 JSON `,
      outputFormat: "json"
    }),
    ll("", "trim", {
      id: "builtin_trim",
      enabled: !0,
      isBuiltIn: !0,
      systemPrompt: S7,
      userPromptTemplate: `{{worldbookContext}}




{{engramSummaries}}

`,
      outputFormat: "json"
    }),
    ll("Query ", "preprocessing", {
      id: "builtin_query_enhance",
      enabled: !0,
      isBuiltIn: !0,
      systemPrompt: mI,
      userPromptTemplate: `****:
{{worldbookContext}}

****:
{{chatHistory}}

****:
{{userInput}}

---
`,
      outputFormat: "plain",
      // 
      availableVariables: ["{{worldbookContext}}", "{{chatHistory}}", "{{userInput}}", "{{char}}", "{{user}}"]
    }),
    ll("", "preprocessing", {
      id: "builtin_plot_director",
      enabled: !1,
      // 
      isBuiltIn: !0,
      systemPrompt: pI,
      userPromptTemplate: `****:
{{worldbookContext}}

****:
{{chatHistory}}

****:
{{userInput}}

---
`,
      outputFormat: "plain",
      //  AI 
      availableVariables: ["{{worldbookContext}}", "{{context}}", "{{chatHistory}}", "{{userInput}}", "{{char}}", "{{user}}"]
    }),
    ll("", "preprocessing", {
      id: "builtin_description_enhance",
      enabled: !1,
      // 
      isBuiltIn: !0,
      systemPrompt: gI,
      userPromptTemplate: `****:
{{chatHistory}}

****:
{{userInput}}

---
`,
      outputFormat: "plain",
      // 
      availableVariables: ["{{context}}", "{{chatHistory}}", "{{userInput}}", "{{char}}", "{{user}}"]
    }),
    // V0.9: 
    ll("", "entity_extraction", {
      id: "builtin_entity_extraction",
      enabled: !1,
      // 
      isBuiltIn: !0,
      systemPrompt: C7,
      userPromptTemplate: `

{{engramGraph}}

---
 JSON `,
      outputFormat: "json",
      availableVariables: ["{{engramGraph}}", "{{worldbookContext}}", "{{char}}", "{{user}}"]
    })
  ];
}
function NS(e) {
  return I1().find((t) => t.id === e);
}
function L1(e) {
  return I1().find((t) => t.category === e) || null;
}
const R7 = {
  enabled: !0,
  includeGlobal: !0,
  disabledWorldbooks: [],
  enableEJS: !0
  // V0.8  EJS
}, O7 = {
  enabled: !1,
  trigger: "token",
  tokenLimit: 4096,
  countLimit: 5,
  keepRecentCount: 3,
  preserveOriginal: !1,
  previewEnabled: !0
};
function j3() {
  return {
    llmPresets: [kS()],
    selectedPresetId: null,
    vectorConfig: { ...A7 },
    rerankConfig: { ...M7 },
    promptTemplates: I1(),
    worldbookConfig: { ...R7 },
    regexConfig: { ...N7 },
    // V0.8
    recallConfig: { ...Ag },
    // V0.8.5
    customMacros: [...k7]
    // V0.9.2
  };
}
const vI = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  DEFAULT_CONTEXT_SETTINGS: T7,
  DEFAULT_CUSTOM_MACROS: k7,
  DEFAULT_EMBEDDING_CONFIG: N3,
  DEFAULT_ENTITY_CONFIG: ES,
  DEFAULT_RECALL_CONFIG: Ag,
  DEFAULT_REGEX_CONFIG: N7,
  DEFAULT_RERANK_CONFIG: M7,
  DEFAULT_SAMPLING_PARAMETERS: j7,
  DEFAULT_TRIM_CONFIG: O7,
  DEFAULT_VECTOR_CONFIG: A7,
  DEFAULT_WORLDBOOK_CONFIG: R7,
  PROMPT_CATEGORIES: hg,
  createDefaultLLMPreset: kS,
  createPromptTemplate: ll,
  getBuiltInPromptTemplates: I1,
  getBuiltInTemplateByCategory: L1,
  getBuiltInTemplateById: NS,
  getDefaultAPISettings: j3
}, Symbol.toStringTag, { value: "Module" })), Lf = Object.freeze({
  theme: "odysseia",
  presets: {},
  templates: {},
  promptTemplates: [],
  hasSeenWelcome: !1,
  lastReadVersion: "0.0.0",
  summarizerConfig: {},
  trimmerConfig: {},
  regexRules: [],
  apiSettings: null,
  preprocessingConfig: null,
  // V0.8: 
  linkedDeletion: {
    enabled: !0,
    deleteWorldbook: !0,
    deleteChatWorldbook: !1,
    // 
    deleteIndexedDB: !1,
    showConfirmation: !0
  },
  glassSettings: {
    enabled: !0,
    opacity: 0.3,
    blur: 10
  },
  syncConfig: {
    enabled: !1,
    // Beta
    autoSync: !0
    // 
  }
});
class nt {
  /**
   *  SillyTavern context
   */
  static getContext() {
    var t, n;
    return (n = (t = window.SillyTavern) == null ? void 0 : t.getContext) == null ? void 0 : n.call(t);
  }
  /**
   * 
   * 
   */
  static getSettings() {
    const t = this.getContext();
    return t != null && t.extensionSettings ? (t.extensionSettings[this.EXTENSION_NAME] || (t.extensionSettings[this.EXTENSION_NAME] = { ...Lf }, ye.debug("SettingsManager", "Initialized engram settings with defaults"), this.save()), t.extensionSettings[this.EXTENSION_NAME]) : (ye.warn("SettingsManager", "SillyTavern context.extensionSettings not available"), { ...Lf });
  }
  static getExtensionSettings() {
    return this.getSettings();
  }
  /**
   * 
   * 
   */
  static initSettings() {
    const t = this.getContext();
    if (!(t != null && t.extensionSettings)) {
      ye.warn("SettingsManager", "Cannot init settings: context not available");
      return;
    }
    let n = !1;
    t.extensionSettings[this.EXTENSION_NAME] || (t.extensionSettings[this.EXTENSION_NAME] = { ...Lf }, n = !0, ye.info("SettingsManager", "Created engram settings"));
    const r = t.extensionSettings[this.EXTENSION_NAME];
    for (const a of Object.keys(Lf))
      a in r || (r[a] = Lf[a], n = !0, ye.debug("SettingsManager", `Added missing field: ${a}`));
    n && this.save();
  }
  /**
   * Get a specific setting value
   */
  static get(t) {
    const r = this.getExtensionSettings()[t];
    return r !== void 0 ? r : Lf[t];
  }
  /**
   * Save a specific setting value
   *  context.extensionSettings 
   */
  static set(t, n) {
    const r = this.getContext();
    if (!(r != null && r.extensionSettings)) {
      ye.warn("SettingsManager", "Cannot set: context.extensionSettings not available");
      return;
    }
    r.extensionSettings[this.EXTENSION_NAME] || (r.extensionSettings[this.EXTENSION_NAME] = { ...Lf }), r.extensionSettings[this.EXTENSION_NAME][t] = n, ye.debug("SettingsManager", `Set ${String(t)} = ${JSON.stringify(n)}`), this.save();
  }
  /**
   * 
   */
  static save() {
    const t = this.getContext();
    t != null && t.saveSettingsDebounced ? (t.saveSettingsDebounced(), ye.debug("SettingsManager", "Saved via context.saveSettingsDebounced")) : ye.warn("SettingsManager", "saveSettingsDebounced not available");
  }
  /**
   * Load settings from SillyTavern global state
   * 
   */
  static loadSettings() {
    return this.getExtensionSettings();
  }
  /**
   * 
   * @param category 
   * @returns  null
   */
  static getEnabledPromptTemplate(t) {
    const n = this.get("apiSettings");
    return ((n == null ? void 0 : n.promptTemplates) || []).find((a) => a.category === t && a.enabled) || null;
  }
  /**
   *  ID 
   * @param id  ID
   * @returns  null
   */
  static getPromptTemplateById(t) {
    const n = this.get("apiSettings"), r = (n == null ? void 0 : n.promptTemplates) || [], a = r.find((l) => l.id === t);
    if (a) return a;
    const o = NS(t);
    return o || r.find((l) => l.category === t && l.enabled) || null;
  }
  /**
   * 
   * @returns summarizerConfig 
   */
  static getSummarizerSettings() {
    return this.get("summarizerConfig") || {};
  }
  /**
   * 
   * @param config 
   */
  static setSummarizerSettings(t) {
    const n = this.getSummarizerSettings();
    this.set("summarizerConfig", { ...n, ...t });
  }
  /**
   * 
   * @returns RegexRule[] 
   */
  static getRegexRules() {
    return this.get("regexRules") || [];
  }
  /**
   * 
   * @param rules 
   */
  static setRegexRules(t) {
    this.set("regexRules", t);
  }
}
mt(nt, "EXTENSION_NAME", "engram");
const jS = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  SettingsManager: nt
}, Symbol.toStringTag, { value: "Module" }));
class gc {
  /**
   * 
   */
  static init() {
    this.injectStyles();
    let n = nt.loadSettings().theme;
    n || (n = localStorage.getItem(this.STORAGE_KEY), n && nt.set("theme", n));
    const r = Vy[n] ? n : "claudeDark";
    this.setTheme(r), ye.info("ThemeManager", `: ${r}`);
  }
  /**
   * 
   */
  static setTheme(t) {
    Vy[t] || (ye.warn("ThemeManager", `: ${t},  claudeDark`), t = "claudeDark"), this.currentTheme = t, nt.set("theme", t), localStorage.setItem(this.STORAGE_KEY, t), this.applyThemeVariables(t);
  }
  /**
   * 
   */
  static getTheme() {
    return this.currentTheme;
  }
  /**
   *  (dist/style.css)
   */
  static injectStyles() {
    const t = "engram-styles";
    if (document.getElementById(t)) return;
    const n = document.createElement("link");
    n.id = t, n.rel = "stylesheet", n.type = "text/css", n.href = `scripts/extensions/Engram_project/dist/style.css?v=${Date.now()}`, document.head.appendChild(n);
  }
  /**
   *  CSS 
   */
  static applyThemeVariables(t) {
    var C, N;
    const n = Vy[t];
    if (!n) return;
    const r = document.documentElement, a = (T, j) => {
      r.style.setProperty(T, j);
    }, o = nt.getSettings(), c = ((C = o.glassSettings) == null ? void 0 : C.enabled) ?? !0 ? ((N = o.glassSettings) == null ? void 0 : N.opacity) ?? 1 : 1, h = !(t === "glass") && c < 1, p = Math.round((1 - c) * 100), g = [
      "background",
      "card",
      "popover",
      "sidebar",
      "secondary",
      "muted",
      "input",
      "border",
      "sidebarBorder"
    ];
    Object.entries(n.colors).forEach(([T, j]) => {
      let R = `--${T.replace(/([A-Z])/g, "-$1").toLowerCase()}`;
      R = R.replace(/(\d+)/, "-$1");
      let A = j;
      if (h && g.includes(T)) {
        const q = T.toLowerCase().includes("border") ? Math.round(p * 0.1) : p;
        A = `color-mix(in srgb, ${j}, transparent ${q}%)`;
      }
      a(R, A);
    }), Object.entries(n.variables).forEach(([T, j]) => {
      a(`--${T}`, j);
    }), t !== "paperLight" ? r.classList.add("dark") : r.classList.remove("dark");
    const b = nt.getSettings().glassSettings;
    b && b.enabled ? (a("--glass-opacity", b.opacity.toString()), a("--glass-blur", `${b.blur}px`), b.blur > 0 ? a("--glass-backdrop-filter", `blur(${b.blur}px)`) : a("--glass-backdrop-filter", "none")) : (a("--glass-opacity", "1"), a("--glass-blur", "0px"), a("--glass-backdrop-filter", "none"));
  }
}
mt(gc, "STORAGE_KEY", "engram-theme"), mt(gc, "currentTheme", "claudeDark");
const Yy = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  ThemeManager: gc
}, Symbol.toStringTag, { value: "Module" })), xI = y7((e) => ({
  theme: gc.getTheme(),
  isDarkMode: gc.getTheme() !== "paperLight",
  setTheme: (t) => {
    gc.setTheme(t), e({
      theme: t,
      isDarkMode: t !== "paperLight"
    });
  }
}));
class z7 {
  async search(t) {
    const n = t.toLowerCase().trim(), r = o1.map((l) => ({
      id: `nav-${l.id}`,
      type: "navigation",
      // Explicitly cast to 'navigation' | 'action' | 'setting' | 'log'
      title: l.label,
      description: `Navigate to ${l.label}`,
      // Auto-generated description
      icon: l.icon,
      action: (c) => c(l.path),
      score: 10
    })).filter(
      (l) => l.title.toLowerCase().includes(n) || l.id.includes(n)
    ), a = SD.filter(
      (l) => {
        var c;
        return l.label.toLowerCase().includes(n) || ((c = l.description) == null ? void 0 : c.toLowerCase().includes(n)) || l.keywords.some((d) => d.toLowerCase().includes(n));
      }
    ).map((l) => ({
      id: l.id,
      type: "command",
      title: l.label,
      description: l.description,
      icon: l.icon,
      action: l.action,
      score: 9
    })), o = this.getThemeCommands().filter(
      (l) => {
        var c;
        return l.title.toLowerCase().includes(n) || ((c = l.keywords) == null ? void 0 : c.some((d) => d.toLowerCase().includes(n)));
      }
    );
    return [...r, ...a, ...o];
  }
  getThemeCommands() {
    const t = xI.getState().setTheme;
    return [
      {
        id: "theme-paper-light",
        type: "command",
        title: ": Paper Light (Twitter)",
        description: "",
        icon: hD,
        action: () => t("paperLight"),
        keywords: ["theme", "light", "white", "twitter", "paper", ""],
        score: 5
      },
      {
        id: "theme-twitter-dark",
        type: "command",
        title: ": Twitter Dark",
        description: "",
        icon: K5,
        action: () => t("twitterDark"),
        keywords: ["theme", "dark", "black", "twitter", "blue", ""],
        score: 5
      },
      {
        id: "theme-claude-dark",
        type: "command",
        title: ": Claude Dark",
        description: "",
        icon: K5,
        action: () => t("claudeDark"),
        keywords: ["theme", "dark", "claude", "paper", ""],
        score: 5
      },
      {
        id: "theme-catppuccin",
        type: "command",
        title: ": Catppuccin Mocha",
        description: "",
        icon: Y5,
        action: () => t("catppuccin"),
        keywords: ["theme", "dark", "catppuccin", "mocha", ""],
        score: 5
      },
      {
        id: "theme-discord",
        type: "command",
        title: ": Discord Dark",
        description: " Discord ",
        icon: Y5,
        action: () => t("discord"),
        keywords: ["theme", "dark", "discord", "game", ""],
        score: 5
      }
    ];
  }
}
class bI {
  async search(t) {
    const n = t.toLowerCase().trim();
    return this.getAllSettings().filter(
      (r) => {
        var a;
        return r.title.toLowerCase().includes(n) || ((a = r.keywords) == null ? void 0 : a.some((o) => o.toLowerCase().includes(n)));
      }
    );
  }
  getAllSettings() {
    return [
      // API Settings
      {
        id: "setting-api-key",
        type: "setting",
        title: " API Key",
        description: " LLM ",
        icon: R1,
        action: (t) => t("/api"),
        // Default to API page
        keywords: ["api", "key", "token", "credential"],
        score: 8
      },
      {
        id: "setting-model",
        type: "setting",
        title: " (Model)",
        description: " LLM ",
        icon: yS,
        action: (t) => t("/api"),
        keywords: ["model", "llm", "change", "switch"],
        score: 8
      },
      // Parameters
      {
        id: "setting-temperature",
        type: "setting",
        title: " (Temperature)",
        description: "",
        icon: W5,
        action: (t) => t("/api"),
        keywords: ["temp", "temperature", "random", "creativity"],
        score: 7
      },
      {
        id: "setting-top-p",
        type: "setting",
        title: " Top P",
        description: "",
        icon: W5,
        action: (t) => t("/api"),
        keywords: ["top", "p", "nucleus", "sampling"],
        score: 7
      },
      // Vector/RAG
      {
        id: "setting-vector",
        type: "setting",
        title: " (Vectorization)",
        description: "",
        icon: M1,
        action: (t) => t("/processing"),
        // processing:vectorization ideally
        keywords: ["vector", "embedding", "db", "store"],
        score: 7
      },
      {
        id: "setting-recall",
        type: "setting",
        title: " (Recall)",
        description: " RAG ",
        icon: qz,
        action: (t) => t("/processing"),
        // processing:recall
        keywords: ["recall", "rag", "retrieval", "search"],
        score: 7
      }
    ];
  }
}
class wI {
  async search(t) {
    const n = t.toLowerCase().trim();
    return ["log", "debug", "error", "warn", "info", "dev"].some((a) => a.includes(n)) || n.includes("log") ? this.getLogActions() : [];
  }
  getLogActions() {
    return [
      {
        id: "log-view-all",
        type: "log",
        title: " (DevLog)",
        description: "",
        icon: z1,
        action: (t) => t("devlog"),
        score: 9
      },
      {
        id: "log-errors",
        type: "log",
        title: " (Errors)",
        description: "",
        icon: FO,
        action: (t) => t("devlog"),
        // In future: nav('/dev?filter=error')
        score: 8
      }
    ];
  }
}
function pl() {
  var e, t;
  try {
    return ((t = (e = window.SillyTavern) == null ? void 0 : e.getContext) == null ? void 0 : t.call(e)) || null;
  } catch (n) {
    return console.warn("[Engram] Failed to get ST context:", n), null;
  }
}
function D7() {
  const e = pl();
  return (e == null ? void 0 : e.chat) || [];
}
function I7() {
  return D7();
}
function hi() {
  const e = pl();
  return (e == null ? void 0 : e.chatId) || null;
}
function $h() {
  const e = pl();
  return e ? {
    name: e.name2,
    id: e.characterId
  } : null;
}
function P1() {
  try {
    return window.selected_model || void 0;
  } catch {
    return;
  }
}
function L7() {
  return pl() !== null;
}
const _I = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  getChatMessages: I7,
  getCurrentCharacter: $h,
  getCurrentChat: D7,
  getCurrentChatId: hi,
  getCurrentModel: P1,
  getSTContext: pl,
  isSTAvailable: L7
}, Symbol.toStringTag, { value: "Module" }));
var Wy = { exports: {} }, SI = Wy.exports, cC;
function CI() {
  return cC || (cC = 1, (function(e, t) {
    (function(n, r) {
      e.exports = r();
    })(SI, function() {
      var n = function(w, E) {
        return (n = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(M, I) {
          M.__proto__ = I;
        } || function(M, I) {
          for (var B in I) Object.prototype.hasOwnProperty.call(I, B) && (M[B] = I[B]);
        })(w, E);
      }, r = function() {
        return (r = Object.assign || function(w) {
          for (var E, M = 1, I = arguments.length; M < I; M++) for (var B in E = arguments[M]) Object.prototype.hasOwnProperty.call(E, B) && (w[B] = E[B]);
          return w;
        }).apply(this, arguments);
      };
      function a(w, E, M) {
        for (var I, B = 0, W = E.length; B < W; B++) !I && B in E || ((I = I || Array.prototype.slice.call(E, 0, B))[B] = E[B]);
        return w.concat(I || Array.prototype.slice.call(E));
      }
      var o = typeof globalThis < "u" ? globalThis : typeof self < "u" ? self : typeof window < "u" ? window : tu, l = Object.keys, c = Array.isArray;
      function d(w, E) {
        return typeof E != "object" || l(E).forEach(function(M) {
          w[M] = E[M];
        }), w;
      }
      typeof Promise > "u" || o.Promise || (o.Promise = Promise);
      var h = Object.getPrototypeOf, p = {}.hasOwnProperty;
      function g(w, E) {
        return p.call(w, E);
      }
      function x(w, E) {
        typeof E == "function" && (E = E(h(w))), (typeof Reflect > "u" ? l : Reflect.ownKeys)(E).forEach(function(M) {
          C(w, M, E[M]);
        });
      }
      var b = Object.defineProperty;
      function C(w, E, M, I) {
        b(w, E, d(M && g(M, "get") && typeof M.get == "function" ? { get: M.get, set: M.set, configurable: !0 } : { value: M, configurable: !0, writable: !0 }, I));
      }
      function N(w) {
        return { from: function(E) {
          return w.prototype = Object.create(E.prototype), C(w.prototype, "constructor", w), { extend: x.bind(null, w.prototype) };
        } };
      }
      var T = Object.getOwnPropertyDescriptor, j = [].slice;
      function R(w, E, M) {
        return j.call(w, E, M);
      }
      function A(w, E) {
        return E(w);
      }
      function z(w) {
        if (!w) throw new Error("Assertion Failed");
      }
      function q(w) {
        o.setImmediate ? setImmediate(w) : setTimeout(w, 0);
      }
      function D(w, E) {
        if (typeof E == "string" && g(w, E)) return w[E];
        if (!E) return w;
        if (typeof E != "string") {
          for (var M = [], I = 0, B = E.length; I < B; ++I) {
            var W = D(w, E[I]);
            M.push(W);
          }
          return M;
        }
        var oe = E.indexOf(".");
        if (oe !== -1) {
          var F = w[E.substr(0, oe)];
          return F == null ? void 0 : D(F, E.substr(oe + 1));
        }
      }
      function P(w, E, M) {
        if (w && E !== void 0 && !("isFrozen" in Object && Object.isFrozen(w))) if (typeof E != "string" && "length" in E) {
          z(typeof M != "string" && "length" in M);
          for (var I = 0, B = E.length; I < B; ++I) P(w, E[I], M[I]);
        } else {
          var W, oe, F = E.indexOf(".");
          F !== -1 ? (W = E.substr(0, F), (oe = E.substr(F + 1)) === "" ? M === void 0 ? c(w) && !isNaN(parseInt(W)) ? w.splice(W, 1) : delete w[W] : w[W] = M : P(F = !(F = w[W]) || !g(w, W) ? w[W] = {} : F, oe, M)) : M === void 0 ? c(w) && !isNaN(parseInt(E)) ? w.splice(E, 1) : delete w[E] : w[E] = M;
        }
      }
      function re(w) {
        var E, M = {};
        for (E in w) g(w, E) && (M[E] = w[E]);
        return M;
      }
      var ie = [].concat;
      function X(w) {
        return ie.apply([], w);
      }
      var Ue = "BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(X([8, 16, 32, 64].map(function(w) {
        return ["Int", "Uint", "Float"].map(function(E) {
          return E + w + "Array";
        });
      }))).filter(function(w) {
        return o[w];
      }), K = new Set(Ue.map(function(w) {
        return o[w];
      })), V = null;
      function de(w) {
        return V = /* @__PURE__ */ new WeakMap(), w = (function E(M) {
          if (!M || typeof M != "object") return M;
          var I = V.get(M);
          if (I) return I;
          if (c(M)) {
            I = [], V.set(M, I);
            for (var B = 0, W = M.length; B < W; ++B) I.push(E(M[B]));
          } else if (K.has(M.constructor)) I = M;
          else {
            var oe, F = h(M);
            for (oe in I = F === Object.prototype ? {} : Object.create(F), V.set(M, I), M) g(M, oe) && (I[oe] = E(M[oe]));
          }
          return I;
        })(w), V = null, w;
      }
      var H = {}.toString;
      function se(w) {
        return H.call(w).slice(8, -1);
      }
      var Z = typeof Symbol < "u" ? Symbol.iterator : "@@iterator", fe = typeof Z == "symbol" ? function(w) {
        var E;
        return w != null && (E = w[Z]) && E.apply(w);
      } : function() {
        return null;
      };
      function he(w, E) {
        return E = w.indexOf(E), 0 <= E && w.splice(E, 1), 0 <= E;
      }
      var ge = {};
      function Q(w) {
        var E, M, I, B;
        if (arguments.length === 1) {
          if (c(w)) return w.slice();
          if (this === ge && typeof w == "string") return [w];
          if (B = fe(w)) {
            for (M = []; !(I = B.next()).done; ) M.push(I.value);
            return M;
          }
          if (w == null) return [w];
          if (typeof (E = w.length) != "number") return [w];
          for (M = new Array(E); E--; ) M[E] = w[E];
          return M;
        }
        for (E = arguments.length, M = new Array(E); E--; ) M[E] = arguments[E];
        return M;
      }
      var U = typeof Symbol < "u" ? function(w) {
        return w[Symbol.toStringTag] === "AsyncFunction";
      } : function() {
        return !1;
      }, Wn = ["Unknown", "Constraint", "Data", "TransactionInactive", "ReadOnly", "Version", "NotFound", "InvalidState", "InvalidAccess", "Abort", "Timeout", "QuotaExceeded", "Syntax", "DataClone"], qr = ["Modify", "Bulk", "OpenFailed", "VersionChange", "Schema", "Upgrade", "InvalidTable", "MissingAPI", "NoSuchDatabase", "InvalidArgument", "SubTransaction", "Unsupported", "Internal", "DatabaseClosed", "PrematureCommit", "ForeignAwait"].concat(Wn), ue = { VersionChanged: "Database version changed by other database connection", DatabaseClosed: "Database has been closed", Abort: "Transaction aborted", TransactionInactive: "Transaction has already completed or failed", MissingAPI: "IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb" };
      function Y(w, E) {
        this.name = w, this.message = E;
      }
      function le(w, E) {
        return w + ". Errors: " + Object.keys(E).map(function(M) {
          return E[M].toString();
        }).filter(function(M, I, B) {
          return B.indexOf(M) === I;
        }).join(`
`);
      }
      function xe(w, E, M, I) {
        this.failures = E, this.failedKeys = I, this.successCount = M, this.message = le(w, E);
      }
      function Se(w, E) {
        this.name = "BulkError", this.failures = Object.keys(E).map(function(M) {
          return E[M];
        }), this.failuresByPos = E, this.message = le(w, this.failures);
      }
      N(Y).from(Error).extend({ toString: function() {
        return this.name + ": " + this.message;
      } }), N(xe).from(Y), N(Se).from(Y);
      var Oe = qr.reduce(function(w, E) {
        return w[E] = E + "Error", w;
      }, {}), qe = Y, Me = qr.reduce(function(w, E) {
        var M = E + "Error";
        function I(B, W) {
          this.name = M, B ? typeof B == "string" ? (this.message = "".concat(B).concat(W ? `
 ` + W : ""), this.inner = W || null) : typeof B == "object" && (this.message = "".concat(B.name, " ").concat(B.message), this.inner = B) : (this.message = ue[E] || M, this.inner = null);
        }
        return N(I).from(qe), w[E] = I, w;
      }, {});
      Me.Syntax = SyntaxError, Me.Type = TypeError, Me.Range = RangeError;
      var Pe = Wn.reduce(function(w, E) {
        return w[E + "Error"] = Me[E], w;
      }, {}), Re = qr.reduce(function(w, E) {
        return ["Syntax", "Type", "Range"].indexOf(E) === -1 && (w[E + "Error"] = Me[E]), w;
      }, {});
      function Be() {
      }
      function Je(w) {
        return w;
      }
      function ot(w, E) {
        return w == null || w === Je ? E : function(M) {
          return E(w(M));
        };
      }
      function We(w, E) {
        return function() {
          w.apply(this, arguments), E.apply(this, arguments);
        };
      }
      function bt(w, E) {
        return w === Be ? E : function() {
          var M = w.apply(this, arguments);
          M !== void 0 && (arguments[0] = M);
          var I = this.onsuccess, B = this.onerror;
          this.onsuccess = null, this.onerror = null;
          var W = E.apply(this, arguments);
          return I && (this.onsuccess = this.onsuccess ? We(I, this.onsuccess) : I), B && (this.onerror = this.onerror ? We(B, this.onerror) : B), W !== void 0 ? W : M;
        };
      }
      function vt(w, E) {
        return w === Be ? E : function() {
          w.apply(this, arguments);
          var M = this.onsuccess, I = this.onerror;
          this.onsuccess = this.onerror = null, E.apply(this, arguments), M && (this.onsuccess = this.onsuccess ? We(M, this.onsuccess) : M), I && (this.onerror = this.onerror ? We(I, this.onerror) : I);
        };
      }
      function Yn(w, E) {
        return w === Be ? E : function(M) {
          var I = w.apply(this, arguments);
          d(M, I);
          var B = this.onsuccess, W = this.onerror;
          return this.onsuccess = null, this.onerror = null, M = E.apply(this, arguments), B && (this.onsuccess = this.onsuccess ? We(B, this.onsuccess) : B), W && (this.onerror = this.onerror ? We(W, this.onerror) : W), I === void 0 ? M === void 0 ? void 0 : M : d(I, M);
        };
      }
      function Mn(w, E) {
        return w === Be ? E : function() {
          return E.apply(this, arguments) !== !1 && w.apply(this, arguments);
        };
      }
      function Fn(w, E) {
        return w === Be ? E : function() {
          var M = w.apply(this, arguments);
          if (M && typeof M.then == "function") {
            for (var I = this, B = arguments.length, W = new Array(B); B--; ) W[B] = arguments[B];
            return M.then(function() {
              return E.apply(I, W);
            });
          }
          return E.apply(this, arguments);
        };
      }
      Re.ModifyError = xe, Re.DexieError = Y, Re.BulkError = Se;
      var Ht = typeof location < "u" && /^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);
      function Rn(w) {
        Ht = w;
      }
      var rn = {}, Cn = 100, Ue = typeof Promise > "u" ? [] : (function() {
        var w = Promise.resolve();
        if (typeof crypto > "u" || !crypto.subtle) return [w, h(w), w];
        var E = crypto.subtle.digest("SHA-512", new Uint8Array([0]));
        return [E, h(E), w];
      })(), Wn = Ue[0], qr = Ue[1], Ue = Ue[2], qr = qr && qr.then, Ze = Wn && Wn.constructor, gt = !!Ue, Nt = function(w, E) {
        jr.push([w, E]), Un && (queueMicrotask(bl), Un = !1);
      }, Dt = !0, Un = !0, $n = [], an = [], Qt = Je, En = { id: "global", global: !0, ref: 0, unhandleds: [], onunhandled: Be, pgp: !1, env: {}, finalize: Be }, it = En, jr = [], lr = 0, xo = [];
      function ct(w) {
        if (typeof this != "object") throw new TypeError("Promises must be constructed via new");
        this._listeners = [], this._lib = !1;
        var E = this._PSD = it;
        if (typeof w != "function") {
          if (w !== rn) throw new TypeError("Not a function");
          return this._state = arguments[1], this._value = arguments[2], void (this._state === !1 && Di(this, this._value));
        }
        this._state = null, this._value = null, ++E.ref, (function M(I, B) {
          try {
            B(function(W) {
              if (I._state === null) {
                if (W === I) throw new TypeError("A promise cannot be resolved with itself.");
                var oe = I._lib && ra();
                W && typeof W.then == "function" ? M(I, function(F, ne) {
                  W instanceof ct ? W._then(F, ne) : W.then(F, ne);
                }) : (I._state = !0, I._value = W, js(I)), oe && pi();
              }
            }, Di.bind(null, I));
          } catch (W) {
            Di(I, W);
          }
        })(this, w);
      }
      var Oa = { get: function() {
        var w = it, E = As;
        function M(I, B) {
          var W = this, oe = !w.global && (w !== it || E !== As), F = oe && !Tr(), ne = new ct(function(te, me) {
            za(W, new as(bo(I, w, oe, F), bo(B, w, oe, F), te, me, w));
          });
          return this._consoleTask && (ne._consoleTask = this._consoleTask), ne;
        }
        return M.prototype = rn, M;
      }, set: function(w) {
        C(this, "then", w && w.prototype === rn ? Oa : { get: function() {
          return w;
        }, set: Oa.set });
      } };
      function as(w, E, M, I, B) {
        this.onFulfilled = typeof w == "function" ? w : null, this.onRejected = typeof E == "function" ? E : null, this.resolve = M, this.reject = I, this.psd = B;
      }
      function Di(w, E) {
        var M, I;
        an.push(E), w._state === null && (M = w._lib && ra(), E = Qt(E), w._state = !1, w._value = E, I = w, $n.some(function(B) {
          return B._value === I._value;
        }) || $n.push(I), js(w), M && pi());
      }
      function js(w) {
        var E = w._listeners;
        w._listeners = [];
        for (var M = 0, I = E.length; M < I; ++M) za(w, E[M]);
        var B = w._PSD;
        --B.ref || B.finalize(), lr === 0 && (++lr, Nt(function() {
          --lr == 0 && wl();
        }, []));
      }
      function za(w, E) {
        if (w._state !== null) {
          var M = w._state ? E.onFulfilled : E.onRejected;
          if (M === null) return (w._state ? E.resolve : E.reject)(w._value);
          ++E.psd.ref, ++lr, Nt(Sc, [M, w, E]);
        } else w._listeners.push(E);
      }
      function Sc(w, E, M) {
        try {
          var I, B = E._value;
          !E._state && an.length && (an = []), I = Ht && E._consoleTask ? E._consoleTask.run(function() {
            return w(B);
          }) : w(B), E._state || an.indexOf(B) !== -1 || (function(W) {
            for (var oe = $n.length; oe; ) if ($n[--oe]._value === W._value) return $n.splice(oe, 1);
          })(E), M.resolve(I);
        } catch (W) {
          M.reject(W);
        } finally {
          --lr == 0 && wl(), --M.psd.ref || M.psd.finalize();
        }
      }
      function bl() {
        ri(En, function() {
          ra() && pi();
        });
      }
      function ra() {
        var w = Dt;
        return Un = Dt = !1, w;
      }
      function pi() {
        var w, E, M;
        do
          for (; 0 < jr.length; ) for (w = jr, jr = [], M = w.length, E = 0; E < M; ++E) {
            var I = w[E];
            I[0].apply(null, I[1]);
          }
        while (0 < jr.length);
        Un = Dt = !0;
      }
      function wl() {
        var w = $n;
        $n = [], w.forEach(function(I) {
          I._PSD.onunhandled.call(null, I._value, I);
        });
        for (var E = xo.slice(0), M = E.length; M; ) E[--M]();
      }
      function Da(w) {
        return new ct(rn, !1, w);
      }
      function yn(w, E) {
        var M = it;
        return function() {
          var I = ra(), B = it;
          try {
            return sa(M, !0), w.apply(this, arguments);
          } catch (W) {
            E && E(W);
          } finally {
            sa(B, !1), I && pi();
          }
        };
      }
      x(ct.prototype, { then: Oa, _then: function(w, E) {
        za(this, new as(null, null, w, E, it));
      }, catch: function(w) {
        if (arguments.length === 1) return this.then(null, w);
        var E = w, M = arguments[1];
        return typeof E == "function" ? this.then(null, function(I) {
          return (I instanceof E ? M : Da)(I);
        }) : this.then(null, function(I) {
          return (I && I.name === E ? M : Da)(I);
        });
      }, finally: function(w) {
        return this.then(function(E) {
          return ct.resolve(w()).then(function() {
            return E;
          });
        }, function(E) {
          return ct.resolve(w()).then(function() {
            return Da(E);
          });
        });
      }, timeout: function(w, E) {
        var M = this;
        return w < 1 / 0 ? new ct(function(I, B) {
          var W = setTimeout(function() {
            return B(new Me.Timeout(E));
          }, w);
          M.then(I, B).finally(clearTimeout.bind(null, W));
        }) : this;
      } }), typeof Symbol < "u" && Symbol.toStringTag && C(ct.prototype, Symbol.toStringTag, "Dexie.Promise"), En.env = Sl(), x(ct, { all: function() {
        var w = Q.apply(null, arguments).map(aa);
        return new ct(function(E, M) {
          w.length === 0 && E([]);
          var I = w.length;
          w.forEach(function(B, W) {
            return ct.resolve(B).then(function(oe) {
              w[W] = oe, --I || E(w);
            }, M);
          });
        });
      }, resolve: function(w) {
        return w instanceof ct ? w : w && typeof w.then == "function" ? new ct(function(E, M) {
          w.then(E, M);
        }) : new ct(rn, !0, w);
      }, reject: Da, race: function() {
        var w = Q.apply(null, arguments).map(aa);
        return new ct(function(E, M) {
          w.map(function(I) {
            return ct.resolve(I).then(E, M);
          });
        });
      }, PSD: { get: function() {
        return it;
      }, set: function(w) {
        return it = w;
      } }, totalEchoes: { get: function() {
        return As;
      } }, newPSD: bn, usePSD: ri, scheduler: { get: function() {
        return Nt;
      }, set: function(w) {
        Nt = w;
      } }, rejectionMapper: { get: function() {
        return Qt;
      }, set: function(w) {
        Qt = w;
      } }, follow: function(w, E) {
        return new ct(function(M, I) {
          return bn(function(B, W) {
            var oe = it;
            oe.unhandleds = [], oe.onunhandled = W, oe.finalize = We(function() {
              var F, ne = this;
              F = function() {
                ne.unhandleds.length === 0 ? B() : W(ne.unhandleds[0]);
              }, xo.push(function te() {
                F(), xo.splice(xo.indexOf(te), 1);
              }), ++lr, Nt(function() {
                --lr == 0 && wl();
              }, []);
            }, oe.finalize), w();
          }, E, M, I);
        });
      } }), Ze && (Ze.allSettled && C(ct, "allSettled", function() {
        var w = Q.apply(null, arguments).map(aa);
        return new ct(function(E) {
          w.length === 0 && E([]);
          var M = w.length, I = new Array(M);
          w.forEach(function(B, W) {
            return ct.resolve(B).then(function(oe) {
              return I[W] = { status: "fulfilled", value: oe };
            }, function(oe) {
              return I[W] = { status: "rejected", reason: oe };
            }).then(function() {
              return --M || E(I);
            });
          });
        });
      }), Ze.any && typeof AggregateError < "u" && C(ct, "any", function() {
        var w = Q.apply(null, arguments).map(aa);
        return new ct(function(E, M) {
          w.length === 0 && M(new AggregateError([]));
          var I = w.length, B = new Array(I);
          w.forEach(function(W, oe) {
            return ct.resolve(W).then(function(F) {
              return E(F);
            }, function(F) {
              B[oe] = F, --I || M(new AggregateError(B));
            });
          });
        });
      }), Ze.withResolvers && (ct.withResolvers = Ze.withResolvers));
      var On = { awaits: 0, echoes: 0, id: 0 }, _l = 0, ss = [], Ts = 0, As = 0, ia = 0;
      function bn(w, E, M, I) {
        var B = it, W = Object.create(B);
        return W.parent = B, W.ref = 0, W.global = !1, W.id = ++ia, En.env, W.env = gt ? { Promise: ct, PromiseProp: { value: ct, configurable: !0, writable: !0 }, all: ct.all, race: ct.race, allSettled: ct.allSettled, any: ct.any, resolve: ct.resolve, reject: ct.reject } : {}, E && d(W, E), ++B.ref, W.finalize = function() {
          --this.parent.ref || this.parent.finalize();
        }, I = ri(W, w, M, I), W.ref === 0 && W.finalize(), I;
      }
      function Xn() {
        return On.id || (On.id = ++_l), ++On.awaits, On.echoes += Cn, On.id;
      }
      function Tr() {
        return !!On.awaits && (--On.awaits == 0 && (On.id = 0), On.echoes = On.awaits * Cn, !0);
      }
      function aa(w) {
        return On.echoes && w && w.constructor === Ze ? (Xn(), w.then(function(E) {
          return Tr(), E;
        }, function(E) {
          return Tr(), sn(E);
        })) : w;
      }
      function cu() {
        var w = ss[ss.length - 1];
        ss.pop(), sa(w, !1);
      }
      function sa(w, E) {
        var M, I = it;
        (E ? !On.echoes || Ts++ && w === it : !Ts || --Ts && w === it) || queueMicrotask(E ? (function(B) {
          ++As, On.echoes && --On.echoes != 0 || (On.echoes = On.awaits = On.id = 0), ss.push(it), sa(B, !0);
        }).bind(null, w) : cu), w !== it && (it = w, I === En && (En.env = Sl()), gt && (M = En.env.Promise, E = w.env, (I.global || w.global) && (Object.defineProperty(o, "Promise", E.PromiseProp), M.all = E.all, M.race = E.race, M.resolve = E.resolve, M.reject = E.reject, E.allSettled && (M.allSettled = E.allSettled), E.any && (M.any = E.any))));
      }
      function Sl() {
        var w = o.Promise;
        return gt ? { Promise: w, PromiseProp: Object.getOwnPropertyDescriptor(o, "Promise"), all: w.all, race: w.race, allSettled: w.allSettled, any: w.any, resolve: w.resolve, reject: w.reject } : {};
      }
      function ri(w, E, M, I, B) {
        var W = it;
        try {
          return sa(w, !0), E(M, I, B);
        } finally {
          sa(W, !1);
        }
      }
      function bo(w, E, M, I) {
        return typeof w != "function" ? w : function() {
          var B = it;
          M && Xn(), sa(E, !0);
          try {
            return w.apply(this, arguments);
          } finally {
            sa(B, !1), I && queueMicrotask(Tr);
          }
        };
      }
      function oa(w) {
        Promise === Ze && On.echoes === 0 ? Ts === 0 ? w() : enqueueNativeMicroTask(w) : setTimeout(w, 0);
      }
      ("" + qr).indexOf("[native code]") === -1 && (Xn = Tr = Be);
      var sn = ct.reject, Yr = "", ur = "Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.", Qn = "String expected.", Ia = [], Ms = "__dbnames", gi = "readonly", Ii = "readwrite";
      function la(w, E) {
        return w ? E ? function() {
          return w.apply(this, arguments) && E.apply(this, arguments);
        } : w : E;
      }
      var wo = { type: 3, lower: -1 / 0, lowerOpen: !1, upper: [[]], upperOpen: !1 };
      function Rs(w) {
        return typeof w != "string" || /\./.test(w) ? function(E) {
          return E;
        } : function(E) {
          return E[w] === void 0 && w in E && delete (E = de(E))[w], E;
        };
      }
      function fu() {
        throw Me.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.");
      }
      function It(w, E) {
        try {
          var M = os(w), I = os(E);
          if (M !== I) return M === "Array" ? 1 : I === "Array" ? -1 : M === "binary" ? 1 : I === "binary" ? -1 : M === "string" ? 1 : I === "string" ? -1 : M === "Date" ? 1 : I !== "Date" ? NaN : -1;
          switch (M) {
            case "number":
            case "Date":
            case "string":
              return E < w ? 1 : w < E ? -1 : 0;
            case "binary":
              return (function(B, W) {
                for (var oe = B.length, F = W.length, ne = oe < F ? oe : F, te = 0; te < ne; ++te) if (B[te] !== W[te]) return B[te] < W[te] ? -1 : 1;
                return oe === F ? 0 : oe < F ? -1 : 1;
              })(ii(w), ii(E));
            case "Array":
              return (function(B, W) {
                for (var oe = B.length, F = W.length, ne = oe < F ? oe : F, te = 0; te < ne; ++te) {
                  var me = It(B[te], W[te]);
                  if (me !== 0) return me;
                }
                return oe === F ? 0 : oe < F ? -1 : 1;
              })(w, E);
          }
        } catch {
        }
        return NaN;
      }
      function os(w) {
        var E = typeof w;
        return E != "object" ? E : ArrayBuffer.isView(w) ? "binary" : (w = se(w), w === "ArrayBuffer" ? "binary" : w);
      }
      function ii(w) {
        return w instanceof Uint8Array ? w : ArrayBuffer.isView(w) ? new Uint8Array(w.buffer, w.byteOffset, w.byteLength) : new Uint8Array(w);
      }
      function gr(w, E, M) {
        var I = w.schema.yProps;
        return I ? (E && 0 < M.numFailures && (E = E.filter(function(B, W) {
          return !M.failures[W];
        })), Promise.all(I.map(function(B) {
          return B = B.updatesTable, E ? w.db.table(B).where("k").anyOf(E).delete() : w.db.table(B).clear();
        })).then(function() {
          return M;
        })) : M;
      }
      var ua = (du.prototype.execute = function(w) {
        var E = this["@@propmod"];
        if (E.add !== void 0) {
          var M = E.add;
          if (c(M)) return a(a([], c(w) ? w : [], !0), M).sort();
          if (typeof M == "number") return (Number(w) || 0) + M;
          if (typeof M == "bigint") try {
            return BigInt(w) + M;
          } catch {
            return BigInt(0) + M;
          }
          throw new TypeError("Invalid term ".concat(M));
        }
        if (E.remove !== void 0) {
          var I = E.remove;
          if (c(I)) return c(w) ? w.filter(function(B) {
            return !I.includes(B);
          }).sort() : [];
          if (typeof I == "number") return Number(w) - I;
          if (typeof I == "bigint") try {
            return BigInt(w) - I;
          } catch {
            return BigInt(0) - I;
          }
          throw new TypeError("Invalid subtrahend ".concat(I));
        }
        return M = (M = E.replacePrefix) === null || M === void 0 ? void 0 : M[0], M && typeof w == "string" && w.startsWith(M) ? E.replacePrefix[1] + w.substring(M.length) : w;
      }, du);
      function du(w) {
        this["@@propmod"] = w;
      }
      function ca(w, E) {
        for (var M = l(E), I = M.length, B = !1, W = 0; W < I; ++W) {
          var oe = M[W], F = E[oe], ne = D(w, oe);
          F instanceof ua ? (P(w, oe, F.execute(ne)), B = !0) : ne !== F && (P(w, oe, F), B = !0);
        }
        return B;
      }
      var ls = (Zt.prototype._trans = function(w, E, M) {
        var I = this._tx || it.trans, B = this.name, W = Ht && typeof console < "u" && console.createTask && console.createTask("Dexie: ".concat(w === "readonly" ? "read" : "write", " ").concat(this.name));
        function oe(te, me, ce) {
          if (!ce.schema[B]) throw new Me.NotFound("Table " + B + " not part of transaction");
          return E(ce.idbtrans, ce);
        }
        var F = ra();
        try {
          var ne = I && I.db._novip === this.db._novip ? I === it.trans ? I._promise(w, oe, M) : bn(function() {
            return I._promise(w, oe, M);
          }, { trans: I, transless: it.transless || it }) : (function te(me, ce, _e, be) {
            if (me.idbdb && (me._state.openComplete || it.letThrough || me._vip)) {
              var we = me._createTransaction(ce, _e, me._dbSchema);
              try {
                we.create(), me._state.PR1398_maxLoop = 3;
              } catch (ke) {
                return ke.name === Oe.InvalidState && me.isOpen() && 0 < --me._state.PR1398_maxLoop ? (console.warn("Dexie: Need to reopen db"), me.close({ disableAutoOpen: !1 }), me.open().then(function() {
                  return te(me, ce, _e, be);
                })) : sn(ke);
              }
              return we._promise(ce, function(ke, Ne) {
                return bn(function() {
                  return it.trans = we, be(ke, Ne, we);
                });
              }).then(function(ke) {
                if (ce === "readwrite") try {
                  we.idbtrans.commit();
                } catch {
                }
                return ce === "readonly" ? ke : we._completion.then(function() {
                  return ke;
                });
              });
            }
            if (me._state.openComplete) return sn(new Me.DatabaseClosed(me._state.dbOpenError));
            if (!me._state.isBeingOpened) {
              if (!me._state.autoOpen) return sn(new Me.DatabaseClosed());
              me.open().catch(Be);
            }
            return me._state.dbReadyPromise.then(function() {
              return te(me, ce, _e, be);
            });
          })(this.db, w, [this.name], oe);
          return W && (ne._consoleTask = W, ne = ne.catch(function(te) {
            return console.trace(te), sn(te);
          })), ne;
        } finally {
          F && pi();
        }
      }, Zt.prototype.get = function(w, E) {
        var M = this;
        return w && w.constructor === Object ? this.where(w).first(E) : w == null ? sn(new Me.Type("Invalid argument to Table.get()")) : this._trans("readonly", function(I) {
          return M.core.get({ trans: I, key: w }).then(function(B) {
            return M.hook.reading.fire(B);
          });
        }).then(E);
      }, Zt.prototype.where = function(w) {
        if (typeof w == "string") return new this.db.WhereClause(this, w);
        if (c(w)) return new this.db.WhereClause(this, "[".concat(w.join("+"), "]"));
        var E = l(w);
        if (E.length === 1) return this.where(E[0]).equals(w[E[0]]);
        var M = this.schema.indexes.concat(this.schema.primKey).filter(function(F) {
          if (F.compound && E.every(function(te) {
            return 0 <= F.keyPath.indexOf(te);
          })) {
            for (var ne = 0; ne < E.length; ++ne) if (E.indexOf(F.keyPath[ne]) === -1) return !1;
            return !0;
          }
          return !1;
        }).sort(function(F, ne) {
          return F.keyPath.length - ne.keyPath.length;
        })[0];
        if (M && this.db._maxKey !== Yr) {
          var W = M.keyPath.slice(0, E.length);
          return this.where(W).equals(W.map(function(ne) {
            return w[ne];
          }));
        }
        !M && Ht && console.warn("The query ".concat(JSON.stringify(w), " on ").concat(this.name, " would benefit from a ") + "compound index [".concat(E.join("+"), "]"));
        var I = this.schema.idxByName;
        function B(F, ne) {
          return It(F, ne) === 0;
        }
        var oe = E.reduce(function(ce, ne) {
          var te = ce[0], me = ce[1], ce = I[ne], _e = w[ne];
          return [te || ce, te || !ce ? la(me, ce && ce.multi ? function(be) {
            return be = D(be, ne), c(be) && be.some(function(we) {
              return B(_e, we);
            });
          } : function(be) {
            return B(_e, D(be, ne));
          }) : me];
        }, [null, null]), W = oe[0], oe = oe[1];
        return W ? this.where(W.name).equals(w[W.keyPath]).filter(oe) : M ? this.filter(oe) : this.where(E).equals("");
      }, Zt.prototype.filter = function(w) {
        return this.toCollection().and(w);
      }, Zt.prototype.count = function(w) {
        return this.toCollection().count(w);
      }, Zt.prototype.offset = function(w) {
        return this.toCollection().offset(w);
      }, Zt.prototype.limit = function(w) {
        return this.toCollection().limit(w);
      }, Zt.prototype.each = function(w) {
        return this.toCollection().each(w);
      }, Zt.prototype.toArray = function(w) {
        return this.toCollection().toArray(w);
      }, Zt.prototype.toCollection = function() {
        return new this.db.Collection(new this.db.WhereClause(this));
      }, Zt.prototype.orderBy = function(w) {
        return new this.db.Collection(new this.db.WhereClause(this, c(w) ? "[".concat(w.join("+"), "]") : w));
      }, Zt.prototype.reverse = function() {
        return this.toCollection().reverse();
      }, Zt.prototype.mapToClass = function(w) {
        var E, M = this.db, I = this.name;
        function B() {
          return E !== null && E.apply(this, arguments) || this;
        }
        (this.schema.mappedClass = w).prototype instanceof fu && ((function(ne, te) {
          if (typeof te != "function" && te !== null) throw new TypeError("Class extends value " + String(te) + " is not a constructor or null");
          function me() {
            this.constructor = ne;
          }
          n(ne, te), ne.prototype = te === null ? Object.create(te) : (me.prototype = te.prototype, new me());
        })(B, E = w), Object.defineProperty(B.prototype, "db", { get: function() {
          return M;
        }, enumerable: !1, configurable: !0 }), B.prototype.table = function() {
          return I;
        }, w = B);
        for (var W = /* @__PURE__ */ new Set(), oe = w.prototype; oe; oe = h(oe)) Object.getOwnPropertyNames(oe).forEach(function(ne) {
          return W.add(ne);
        });
        function F(ne) {
          if (!ne) return ne;
          var te, me = Object.create(w.prototype);
          for (te in ne) if (!W.has(te)) try {
            me[te] = ne[te];
          } catch {
          }
          return me;
        }
        return this.schema.readHook && this.hook.reading.unsubscribe(this.schema.readHook), this.schema.readHook = F, this.hook("reading", F), w;
      }, Zt.prototype.defineClass = function() {
        return this.mapToClass(function(w) {
          d(this, w);
        });
      }, Zt.prototype.add = function(w, E) {
        var M = this, I = this.schema.primKey, B = I.auto, W = I.keyPath, oe = w;
        return W && B && (oe = Rs(W)(w)), this._trans("readwrite", function(F) {
          return M.core.mutate({ trans: F, type: "add", keys: E != null ? [E] : null, values: [oe] });
        }).then(function(F) {
          return F.numFailures ? ct.reject(F.failures[0]) : F.lastResult;
        }).then(function(F) {
          if (W) try {
            P(w, W, F);
          } catch {
          }
          return F;
        });
      }, Zt.prototype.upsert = function(w, E) {
        var M = this, I = this.schema.primKey.keyPath;
        return this._trans("readwrite", function(B) {
          return M.core.get({ trans: B, key: w }).then(function(W) {
            var oe = W ?? {};
            return ca(oe, E), I && P(oe, I, w), M.core.mutate({ trans: B, type: "put", values: [oe], keys: [w], upsert: !0, updates: { keys: [w], changeSpecs: [E] } }).then(function(F) {
              return F.numFailures ? ct.reject(F.failures[0]) : !!W;
            });
          });
        });
      }, Zt.prototype.update = function(w, E) {
        return typeof w != "object" || c(w) ? this.where(":id").equals(w).modify(E) : (w = D(w, this.schema.primKey.keyPath), w === void 0 ? sn(new Me.InvalidArgument("Given object does not contain its primary key")) : this.where(":id").equals(w).modify(E));
      }, Zt.prototype.put = function(w, E) {
        var M = this, I = this.schema.primKey, B = I.auto, W = I.keyPath, oe = w;
        return W && B && (oe = Rs(W)(w)), this._trans("readwrite", function(F) {
          return M.core.mutate({ trans: F, type: "put", values: [oe], keys: E != null ? [E] : null });
        }).then(function(F) {
          return F.numFailures ? ct.reject(F.failures[0]) : F.lastResult;
        }).then(function(F) {
          if (W) try {
            P(w, W, F);
          } catch {
          }
          return F;
        });
      }, Zt.prototype.delete = function(w) {
        var E = this;
        return this._trans("readwrite", function(M) {
          return E.core.mutate({ trans: M, type: "delete", keys: [w] }).then(function(I) {
            return gr(E, [w], I);
          }).then(function(I) {
            return I.numFailures ? ct.reject(I.failures[0]) : void 0;
          });
        });
      }, Zt.prototype.clear = function() {
        var w = this;
        return this._trans("readwrite", function(E) {
          return w.core.mutate({ trans: E, type: "deleteRange", range: wo }).then(function(M) {
            return gr(w, null, M);
          });
        }).then(function(E) {
          return E.numFailures ? ct.reject(E.failures[0]) : void 0;
        });
      }, Zt.prototype.bulkGet = function(w) {
        var E = this;
        return this._trans("readonly", function(M) {
          return E.core.getMany({ keys: w, trans: M }).then(function(I) {
            return I.map(function(B) {
              return E.hook.reading.fire(B);
            });
          });
        });
      }, Zt.prototype.bulkAdd = function(w, E, M) {
        var I = this, B = Array.isArray(E) ? E : void 0, W = (M = M || (B ? void 0 : E)) ? M.allKeys : void 0;
        return this._trans("readwrite", function(oe) {
          var te = I.schema.primKey, F = te.auto, te = te.keyPath;
          if (te && B) throw new Me.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");
          if (B && B.length !== w.length) throw new Me.InvalidArgument("Arguments objects and keys must have the same length");
          var ne = w.length, te = te && F ? w.map(Rs(te)) : w;
          return I.core.mutate({ trans: oe, type: "add", keys: B, values: te, wantResults: W }).then(function(we) {
            var ce = we.numFailures, _e = we.results, be = we.lastResult, we = we.failures;
            if (ce === 0) return W ? _e : be;
            throw new Se("".concat(I.name, ".bulkAdd(): ").concat(ce, " of ").concat(ne, " operations failed"), we);
          });
        });
      }, Zt.prototype.bulkPut = function(w, E, M) {
        var I = this, B = Array.isArray(E) ? E : void 0, W = (M = M || (B ? void 0 : E)) ? M.allKeys : void 0;
        return this._trans("readwrite", function(oe) {
          var te = I.schema.primKey, F = te.auto, te = te.keyPath;
          if (te && B) throw new Me.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");
          if (B && B.length !== w.length) throw new Me.InvalidArgument("Arguments objects and keys must have the same length");
          var ne = w.length, te = te && F ? w.map(Rs(te)) : w;
          return I.core.mutate({ trans: oe, type: "put", keys: B, values: te, wantResults: W }).then(function(we) {
            var ce = we.numFailures, _e = we.results, be = we.lastResult, we = we.failures;
            if (ce === 0) return W ? _e : be;
            throw new Se("".concat(I.name, ".bulkPut(): ").concat(ce, " of ").concat(ne, " operations failed"), we);
          });
        });
      }, Zt.prototype.bulkUpdate = function(w) {
        var E = this, M = this.core, I = w.map(function(oe) {
          return oe.key;
        }), B = w.map(function(oe) {
          return oe.changes;
        }), W = [];
        return this._trans("readwrite", function(oe) {
          return M.getMany({ trans: oe, keys: I, cache: "clone" }).then(function(F) {
            var ne = [], te = [];
            w.forEach(function(ce, _e) {
              var be = ce.key, we = ce.changes, ke = F[_e];
              if (ke) {
                for (var Ne = 0, Te = Object.keys(we); Ne < Te.length; Ne++) {
                  var Ie = Te[Ne], $e = we[Ie];
                  if (Ie === E.schema.primKey.keyPath) {
                    if (It($e, be) !== 0) throw new Me.Constraint("Cannot update primary key in bulkUpdate()");
                  } else P(ke, Ie, $e);
                }
                W.push(_e), ne.push(be), te.push(ke);
              }
            });
            var me = ne.length;
            return M.mutate({ trans: oe, type: "put", keys: ne, values: te, updates: { keys: I, changeSpecs: B } }).then(function(ce) {
              var _e = ce.numFailures, be = ce.failures;
              if (_e === 0) return me;
              for (var we = 0, ke = Object.keys(be); we < ke.length; we++) {
                var Ne, Te = ke[we], Ie = W[Number(Te)];
                Ie != null && (Ne = be[Te], delete be[Te], be[Ie] = Ne);
              }
              throw new Se("".concat(E.name, ".bulkUpdate(): ").concat(_e, " of ").concat(me, " operations failed"), be);
            });
          });
        });
      }, Zt.prototype.bulkDelete = function(w) {
        var E = this, M = w.length;
        return this._trans("readwrite", function(I) {
          return E.core.mutate({ trans: I, type: "delete", keys: w }).then(function(B) {
            return gr(E, w, B);
          });
        }).then(function(oe) {
          var B = oe.numFailures, W = oe.lastResult, oe = oe.failures;
          if (B === 0) return W;
          throw new Se("".concat(E.name, ".bulkDelete(): ").concat(B, " of ").concat(M, " operations failed"), oe);
        });
      }, Zt);
      function Zt() {
      }
      function Os(w) {
        function E(oe, F) {
          if (F) {
            for (var ne = arguments.length, te = new Array(ne - 1); --ne; ) te[ne - 1] = arguments[ne];
            return M[oe].subscribe.apply(null, te), w;
          }
          if (typeof oe == "string") return M[oe];
        }
        var M = {};
        E.addEventType = W;
        for (var I = 1, B = arguments.length; I < B; ++I) W(arguments[I]);
        return E;
        function W(oe, F, ne) {
          if (typeof oe != "object") {
            var te;
            F = F || Mn;
            var me = { subscribers: [], fire: ne = ne || Be, subscribe: function(ce) {
              me.subscribers.indexOf(ce) === -1 && (me.subscribers.push(ce), me.fire = F(me.fire, ce));
            }, unsubscribe: function(ce) {
              me.subscribers = me.subscribers.filter(function(_e) {
                return _e !== ce;
              }), me.fire = me.subscribers.reduce(F, ne);
            } };
            return M[oe] = E[oe] = me;
          }
          l(te = oe).forEach(function(ce) {
            var _e = te[ce];
            if (c(_e)) W(ce, te[ce][0], te[ce][1]);
            else {
              if (_e !== "asap") throw new Me.InvalidArgument("Invalid event config");
              var be = W(ce, Je, function() {
                for (var we = arguments.length, ke = new Array(we); we--; ) ke[we] = arguments[we];
                be.subscribers.forEach(function(Ne) {
                  q(function() {
                    Ne.apply(null, ke);
                  });
                });
              });
            }
          });
        }
      }
      function cr(w, E) {
        return N(E).from({ prototype: w }), E;
      }
      function ai(w, E) {
        return !(w.filter || w.algorithm || w.or) && (E ? w.justLimit : !w.replayFilter);
      }
      function us(w, E) {
        w.filter = la(w.filter, E);
      }
      function zs(w, E, M) {
        var I = w.replayFilter;
        w.replayFilter = I ? function() {
          return la(I(), E());
        } : E, w.justLimit = M && !I;
      }
      function si(w, E) {
        if (w.isPrimKey) return E.primaryKey;
        var M = E.getIndexByKeyPath(w.index);
        if (!M) throw new Me.Schema("KeyPath " + w.index + " on object store " + E.name + " is not indexed");
        return M;
      }
      function Cl(w, E, M) {
        var I = si(w, E.schema);
        return E.openCursor({ trans: M, values: !w.keysOnly, reverse: w.dir === "prev", unique: !!w.unique, query: { index: I, range: w.range } });
      }
      function Ds(w, E, M, I) {
        var B = w.replayFilter ? la(w.filter, w.replayFilter()) : w.filter;
        if (w.or) {
          var W = {}, oe = function(F, ne, te) {
            var me, ce;
            B && !B(ne, te, function(_e) {
              return ne.stop(_e);
            }, function(_e) {
              return ne.fail(_e);
            }) || ((ce = "" + (me = ne.primaryKey)) == "[object ArrayBuffer]" && (ce = "" + new Uint8Array(me)), g(W, ce) || (W[ce] = !0, E(F, ne, te)));
          };
          return Promise.all([w.or._iterate(oe, M), yi(Cl(w, I, M), w.algorithm, oe, !w.keysOnly && w.valueMapper)]);
        }
        return yi(Cl(w, I, M), la(w.algorithm, B), E, !w.keysOnly && w.valueMapper);
      }
      function yi(w, E, M, I) {
        var B = yn(I ? function(W, oe, F) {
          return M(I(W), oe, F);
        } : M);
        return w.then(function(W) {
          if (W) return W.start(function() {
            var oe = function() {
              return W.continue();
            };
            E && !E(W, function(F) {
              return oe = F;
            }, function(F) {
              W.stop(F), oe = Be;
            }, function(F) {
              W.fail(F), oe = Be;
            }) || B(W.value, W, function(F) {
              return oe = F;
            }), oe();
          });
        });
      }
      var hd = (Yt.prototype._read = function(w, E) {
        var M = this._ctx;
        return M.error ? M.table._trans(null, sn.bind(null, M.error)) : M.table._trans("readonly", w).then(E);
      }, Yt.prototype._write = function(w) {
        var E = this._ctx;
        return E.error ? E.table._trans(null, sn.bind(null, E.error)) : E.table._trans("readwrite", w, "locked");
      }, Yt.prototype._addAlgorithm = function(w) {
        var E = this._ctx;
        E.algorithm = la(E.algorithm, w);
      }, Yt.prototype._iterate = function(w, E) {
        return Ds(this._ctx, w, E, this._ctx.table.core);
      }, Yt.prototype.clone = function(w) {
        var E = Object.create(this.constructor.prototype), M = Object.create(this._ctx);
        return w && d(M, w), E._ctx = M, E;
      }, Yt.prototype.raw = function() {
        return this._ctx.valueMapper = null, this;
      }, Yt.prototype.each = function(w) {
        var E = this._ctx;
        return this._read(function(M) {
          return Ds(E, w, M, E.table.core);
        });
      }, Yt.prototype.count = function(w) {
        var E = this;
        return this._read(function(M) {
          var I = E._ctx, B = I.table.core;
          if (ai(I, !0)) return B.count({ trans: M, query: { index: si(I, B.schema), range: I.range } }).then(function(oe) {
            return Math.min(oe, I.limit);
          });
          var W = 0;
          return Ds(I, function() {
            return ++W, !1;
          }, M, B).then(function() {
            return W;
          });
        }).then(w);
      }, Yt.prototype.sortBy = function(w, E) {
        var M = w.split(".").reverse(), I = M[0], B = M.length - 1;
        function W(ne, te) {
          return te ? W(ne[M[te]], te - 1) : ne[I];
        }
        var oe = this._ctx.dir === "next" ? 1 : -1;
        function F(ne, te) {
          return It(W(ne, B), W(te, B)) * oe;
        }
        return this.toArray(function(ne) {
          return ne.sort(F);
        }).then(E);
      }, Yt.prototype.toArray = function(w) {
        var E = this;
        return this._read(function(M) {
          var I = E._ctx;
          if (I.dir === "next" && ai(I, !0) && 0 < I.limit) {
            var B = I.valueMapper, W = si(I, I.table.core.schema);
            return I.table.core.query({ trans: M, limit: I.limit, values: !0, query: { index: W, range: I.range } }).then(function(F) {
              return F = F.result, B ? F.map(B) : F;
            });
          }
          var oe = [];
          return Ds(I, function(F) {
            return oe.push(F);
          }, M, I.table.core).then(function() {
            return oe;
          });
        }, w);
      }, Yt.prototype.offset = function(w) {
        var E = this._ctx;
        return w <= 0 || (E.offset += w, ai(E) ? zs(E, function() {
          var M = w;
          return function(I, B) {
            return M === 0 || (M === 1 ? --M : B(function() {
              I.advance(M), M = 0;
            }), !1);
          };
        }) : zs(E, function() {
          var M = w;
          return function() {
            return --M < 0;
          };
        })), this;
      }, Yt.prototype.limit = function(w) {
        return this._ctx.limit = Math.min(this._ctx.limit, w), zs(this._ctx, function() {
          var E = w;
          return function(M, I, B) {
            return --E <= 0 && I(B), 0 <= E;
          };
        }, !0), this;
      }, Yt.prototype.until = function(w, E) {
        return us(this._ctx, function(M, I, B) {
          return !w(M.value) || (I(B), E);
        }), this;
      }, Yt.prototype.first = function(w) {
        return this.limit(1).toArray(function(E) {
          return E[0];
        }).then(w);
      }, Yt.prototype.last = function(w) {
        return this.reverse().first(w);
      }, Yt.prototype.filter = function(w) {
        var E;
        return us(this._ctx, function(M) {
          return w(M.value);
        }), (E = this._ctx).isMatch = la(E.isMatch, w), this;
      }, Yt.prototype.and = function(w) {
        return this.filter(w);
      }, Yt.prototype.or = function(w) {
        return new this.db.WhereClause(this._ctx.table, w, this);
      }, Yt.prototype.reverse = function() {
        return this._ctx.dir = this._ctx.dir === "prev" ? "next" : "prev", this._ondirectionchange && this._ondirectionchange(this._ctx.dir), this;
      }, Yt.prototype.desc = function() {
        return this.reverse();
      }, Yt.prototype.eachKey = function(w) {
        var E = this._ctx;
        return E.keysOnly = !E.isMatch, this.each(function(M, I) {
          w(I.key, I);
        });
      }, Yt.prototype.eachUniqueKey = function(w) {
        return this._ctx.unique = "unique", this.eachKey(w);
      }, Yt.prototype.eachPrimaryKey = function(w) {
        var E = this._ctx;
        return E.keysOnly = !E.isMatch, this.each(function(M, I) {
          w(I.primaryKey, I);
        });
      }, Yt.prototype.keys = function(w) {
        var E = this._ctx;
        E.keysOnly = !E.isMatch;
        var M = [];
        return this.each(function(I, B) {
          M.push(B.key);
        }).then(function() {
          return M;
        }).then(w);
      }, Yt.prototype.primaryKeys = function(w) {
        var E = this._ctx;
        if (E.dir === "next" && ai(E, !0) && 0 < E.limit) return this._read(function(I) {
          var B = si(E, E.table.core.schema);
          return E.table.core.query({ trans: I, values: !1, limit: E.limit, query: { index: B, range: E.range } });
        }).then(function(I) {
          return I.result;
        }).then(w);
        E.keysOnly = !E.isMatch;
        var M = [];
        return this.each(function(I, B) {
          M.push(B.primaryKey);
        }).then(function() {
          return M;
        }).then(w);
      }, Yt.prototype.uniqueKeys = function(w) {
        return this._ctx.unique = "unique", this.keys(w);
      }, Yt.prototype.firstKey = function(w) {
        return this.limit(1).keys(function(E) {
          return E[0];
        }).then(w);
      }, Yt.prototype.lastKey = function(w) {
        return this.reverse().firstKey(w);
      }, Yt.prototype.distinct = function() {
        var w = this._ctx, w = w.index && w.table.schema.idxByName[w.index];
        if (!w || !w.multi) return this;
        var E = {};
        return us(this._ctx, function(B) {
          var I = B.primaryKey.toString(), B = g(E, I);
          return E[I] = !0, !B;
        }), this;
      }, Yt.prototype.modify = function(w) {
        var E = this, M = this._ctx;
        return this._write(function(I) {
          var B = typeof w == "function" ? w : function(ke) {
            return ca(ke, w);
          }, W = M.table.core, te = W.schema.primaryKey, oe = te.outbound, F = te.extractKey, ne = 200, te = E.db._options.modifyChunkSize;
          te && (ne = typeof te == "object" ? te[W.name] || te["*"] || 200 : te);
          function me(ke, Ie) {
            var Te = Ie.failures, Ie = Ie.numFailures;
            _e += ke - Ie;
            for (var $e = 0, Ve = l(Te); $e < Ve.length; $e++) {
              var rt = Ve[$e];
              ce.push(Te[rt]);
            }
          }
          var ce = [], _e = 0, be = [], we = w === Cc;
          return E.clone().primaryKeys().then(function(ke) {
            function Ne(Ie) {
              var $e = Math.min(ne, ke.length - Ie), Ve = ke.slice(Ie, Ie + $e);
              return (we ? Promise.resolve([]) : W.getMany({ trans: I, keys: Ve, cache: "immutable" })).then(function(rt) {
                var lt = [], Ge = [], st = oe ? [] : null, ut = we ? Ve : [];
                if (!we) for (var tt = 0; tt < $e; ++tt) {
                  var ht = rt[tt], _t = { value: de(ht), primKey: ke[Ie + tt] };
                  B.call(_t, _t.value, _t) !== !1 && (_t.value == null ? ut.push(ke[Ie + tt]) : oe || It(F(ht), F(_t.value)) === 0 ? (Ge.push(_t.value), oe && st.push(ke[Ie + tt])) : (ut.push(ke[Ie + tt]), lt.push(_t.value)));
                }
                return Promise.resolve(0 < lt.length && W.mutate({ trans: I, type: "add", values: lt }).then(function(Rt) {
                  for (var Ot in Rt.failures) ut.splice(parseInt(Ot), 1);
                  me(lt.length, Rt);
                })).then(function() {
                  return (0 < Ge.length || Te && typeof w == "object") && W.mutate({ trans: I, type: "put", keys: st, values: Ge, criteria: Te, changeSpec: typeof w != "function" && w, isAdditionalChunk: 0 < Ie }).then(function(Rt) {
                    return me(Ge.length, Rt);
                  });
                }).then(function() {
                  return (0 < ut.length || Te && we) && W.mutate({ trans: I, type: "delete", keys: ut, criteria: Te, isAdditionalChunk: 0 < Ie }).then(function(Rt) {
                    return gr(M.table, ut, Rt);
                  }).then(function(Rt) {
                    return me(ut.length, Rt);
                  });
                }).then(function() {
                  return ke.length > Ie + $e && Ne(Ie + ne);
                });
              });
            }
            var Te = ai(M) && M.limit === 1 / 0 && (typeof w != "function" || we) && { index: M.index, range: M.range };
            return Ne(0).then(function() {
              if (0 < ce.length) throw new xe("Error modifying one or more objects", ce, _e, be);
              return ke.length;
            });
          });
        });
      }, Yt.prototype.delete = function() {
        var w = this._ctx, E = w.range;
        return !ai(w) || w.table.schema.yProps || !w.isPrimKey && E.type !== 3 ? this.modify(Cc) : this._write(function(M) {
          var I = w.table.core.schema.primaryKey, B = E;
          return w.table.core.count({ trans: M, query: { index: I, range: B } }).then(function(W) {
            return w.table.core.mutate({ trans: M, type: "deleteRange", range: B }).then(function(ne) {
              var F = ne.failures, ne = ne.numFailures;
              if (ne) throw new xe("Could not delete some values", Object.keys(F).map(function(te) {
                return F[te];
              }), W - ne);
              return W - ne;
            });
          });
        });
      }, Yt);
      function Yt() {
      }
      var Cc = function(w, E) {
        return E.value = null;
      };
      function hu(w, E) {
        return w < E ? -1 : w === E ? 0 : 1;
      }
      function md(w, E) {
        return E < w ? -1 : w === E ? 0 : 1;
      }
      function Wr(w, E, M) {
        return w = w instanceof cs ? new w.Collection(w) : w, w._ctx.error = new (M || TypeError)(E), w;
      }
      function fa(w) {
        return new w.Collection(w, function() {
          return mu("");
        }).limit(0);
      }
      function vi(w, E, M, I) {
        var B, W, oe, F, ne, te, me, ce = M.length;
        if (!M.every(function(we) {
          return typeof we == "string";
        })) return Wr(w, Qn);
        function _e(we) {
          B = we === "next" ? function(Ne) {
            return Ne.toUpperCase();
          } : function(Ne) {
            return Ne.toLowerCase();
          }, W = we === "next" ? function(Ne) {
            return Ne.toLowerCase();
          } : function(Ne) {
            return Ne.toUpperCase();
          }, oe = we === "next" ? hu : md;
          var ke = M.map(function(Ne) {
            return { lower: W(Ne), upper: B(Ne) };
          }).sort(function(Ne, Te) {
            return oe(Ne.lower, Te.lower);
          });
          F = ke.map(function(Ne) {
            return Ne.upper;
          }), ne = ke.map(function(Ne) {
            return Ne.lower;
          }), me = (te = we) === "next" ? "" : I;
        }
        _e("next"), w = new w.Collection(w, function() {
          return da(F[0], ne[ce - 1] + I);
        }), w._ondirectionchange = function(we) {
          _e(we);
        };
        var be = 0;
        return w._addAlgorithm(function(we, ke, Ne) {
          var Te = we.key;
          if (typeof Te != "string") return !1;
          var Ie = W(Te);
          if (E(Ie, ne, be)) return !0;
          for (var $e = null, Ve = be; Ve < ce; ++Ve) {
            var rt = (function(lt, Ge, st, ut, tt, ht) {
              for (var _t = Math.min(lt.length, ut.length), Rt = -1, Ot = 0; Ot < _t; ++Ot) {
                var Ln = Ge[Ot];
                if (Ln !== ut[Ot]) return tt(lt[Ot], st[Ot]) < 0 ? lt.substr(0, Ot) + st[Ot] + st.substr(Ot + 1) : tt(lt[Ot], ut[Ot]) < 0 ? lt.substr(0, Ot) + ut[Ot] + st.substr(Ot + 1) : 0 <= Rt ? lt.substr(0, Rt) + Ge[Rt] + st.substr(Rt + 1) : null;
                tt(lt[Ot], Ln) < 0 && (Rt = Ot);
              }
              return _t < ut.length && ht === "next" ? lt + st.substr(lt.length) : _t < lt.length && ht === "prev" ? lt.substr(0, st.length) : Rt < 0 ? null : lt.substr(0, Rt) + ut[Rt] + st.substr(Rt + 1);
            })(Te, Ie, F[Ve], ne[Ve], oe, te);
            rt === null && $e === null ? be = Ve + 1 : ($e === null || 0 < oe($e, rt)) && ($e = rt);
          }
          return ke($e !== null ? function() {
            we.continue($e + me);
          } : Ne), !1;
        }), w;
      }
      function da(w, E, M, I) {
        return { type: 2, lower: w, upper: E, lowerOpen: M, upperOpen: I };
      }
      function mu(w) {
        return { type: 1, lower: w, upper: w };
      }
      var cs = (Object.defineProperty(zn.prototype, "Collection", { get: function() {
        return this._ctx.table.db.Collection;
      }, enumerable: !1, configurable: !0 }), zn.prototype.between = function(w, E, M, I) {
        M = M !== !1, I = I === !0;
        try {
          return 0 < this._cmp(w, E) || this._cmp(w, E) === 0 && (M || I) && (!M || !I) ? fa(this) : new this.Collection(this, function() {
            return da(w, E, !M, !I);
          });
        } catch {
          return Wr(this, ur);
        }
      }, zn.prototype.equals = function(w) {
        return w == null ? Wr(this, ur) : new this.Collection(this, function() {
          return mu(w);
        });
      }, zn.prototype.above = function(w) {
        return w == null ? Wr(this, ur) : new this.Collection(this, function() {
          return da(w, void 0, !0);
        });
      }, zn.prototype.aboveOrEqual = function(w) {
        return w == null ? Wr(this, ur) : new this.Collection(this, function() {
          return da(w, void 0, !1);
        });
      }, zn.prototype.below = function(w) {
        return w == null ? Wr(this, ur) : new this.Collection(this, function() {
          return da(void 0, w, !1, !0);
        });
      }, zn.prototype.belowOrEqual = function(w) {
        return w == null ? Wr(this, ur) : new this.Collection(this, function() {
          return da(void 0, w);
        });
      }, zn.prototype.startsWith = function(w) {
        return typeof w != "string" ? Wr(this, Qn) : this.between(w, w + Yr, !0, !0);
      }, zn.prototype.startsWithIgnoreCase = function(w) {
        return w === "" ? this.startsWith(w) : vi(this, function(E, M) {
          return E.indexOf(M[0]) === 0;
        }, [w], Yr);
      }, zn.prototype.equalsIgnoreCase = function(w) {
        return vi(this, function(E, M) {
          return E === M[0];
        }, [w], "");
      }, zn.prototype.anyOfIgnoreCase = function() {
        var w = Q.apply(ge, arguments);
        return w.length === 0 ? fa(this) : vi(this, function(E, M) {
          return M.indexOf(E) !== -1;
        }, w, "");
      }, zn.prototype.startsWithAnyOfIgnoreCase = function() {
        var w = Q.apply(ge, arguments);
        return w.length === 0 ? fa(this) : vi(this, function(E, M) {
          return M.some(function(I) {
            return E.indexOf(I) === 0;
          });
        }, w, Yr);
      }, zn.prototype.anyOf = function() {
        var w = this, E = Q.apply(ge, arguments), M = this._cmp;
        try {
          E.sort(M);
        } catch {
          return Wr(this, ur);
        }
        if (E.length === 0) return fa(this);
        var I = new this.Collection(this, function() {
          return da(E[0], E[E.length - 1]);
        });
        I._ondirectionchange = function(W) {
          M = W === "next" ? w._ascending : w._descending, E.sort(M);
        };
        var B = 0;
        return I._addAlgorithm(function(W, oe, F) {
          for (var ne = W.key; 0 < M(ne, E[B]); ) if (++B === E.length) return oe(F), !1;
          return M(ne, E[B]) === 0 || (oe(function() {
            W.continue(E[B]);
          }), !1);
        }), I;
      }, zn.prototype.notEqual = function(w) {
        return this.inAnyRange([[-1 / 0, w], [w, this.db._maxKey]], { includeLowers: !1, includeUppers: !1 });
      }, zn.prototype.noneOf = function() {
        var w = Q.apply(ge, arguments);
        if (w.length === 0) return new this.Collection(this);
        try {
          w.sort(this._ascending);
        } catch {
          return Wr(this, ur);
        }
        var E = w.reduce(function(M, I) {
          return M ? M.concat([[M[M.length - 1][1], I]]) : [[-1 / 0, I]];
        }, null);
        return E.push([w[w.length - 1], this.db._maxKey]), this.inAnyRange(E, { includeLowers: !1, includeUppers: !1 });
      }, zn.prototype.inAnyRange = function(Te, E) {
        var M = this, I = this._cmp, B = this._ascending, W = this._descending, oe = this._min, F = this._max;
        if (Te.length === 0) return fa(this);
        if (!Te.every(function(Ie) {
          return Ie[0] !== void 0 && Ie[1] !== void 0 && B(Ie[0], Ie[1]) <= 0;
        })) return Wr(this, "First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower", Me.InvalidArgument);
        var ne = !E || E.includeLowers !== !1, te = E && E.includeUppers === !0, me, ce = B;
        function _e(Ie, $e) {
          return ce(Ie[0], $e[0]);
        }
        try {
          (me = Te.reduce(function(Ie, $e) {
            for (var Ve = 0, rt = Ie.length; Ve < rt; ++Ve) {
              var lt = Ie[Ve];
              if (I($e[0], lt[1]) < 0 && 0 < I($e[1], lt[0])) {
                lt[0] = oe(lt[0], $e[0]), lt[1] = F(lt[1], $e[1]);
                break;
              }
            }
            return Ve === rt && Ie.push($e), Ie;
          }, [])).sort(_e);
        } catch {
          return Wr(this, ur);
        }
        var be = 0, we = te ? function(Ie) {
          return 0 < B(Ie, me[be][1]);
        } : function(Ie) {
          return 0 <= B(Ie, me[be][1]);
        }, ke = ne ? function(Ie) {
          return 0 < W(Ie, me[be][0]);
        } : function(Ie) {
          return 0 <= W(Ie, me[be][0]);
        }, Ne = we, Te = new this.Collection(this, function() {
          return da(me[0][0], me[me.length - 1][1], !ne, !te);
        });
        return Te._ondirectionchange = function(Ie) {
          ce = Ie === "next" ? (Ne = we, B) : (Ne = ke, W), me.sort(_e);
        }, Te._addAlgorithm(function(Ie, $e, Ve) {
          for (var rt, lt = Ie.key; Ne(lt); ) if (++be === me.length) return $e(Ve), !1;
          return !we(rt = lt) && !ke(rt) || (M._cmp(lt, me[be][1]) === 0 || M._cmp(lt, me[be][0]) === 0 || $e(function() {
            ce === B ? Ie.continue(me[be][0]) : Ie.continue(me[be][1]);
          }), !1);
        }), Te;
      }, zn.prototype.startsWithAnyOf = function() {
        var w = Q.apply(ge, arguments);
        return w.every(function(E) {
          return typeof E == "string";
        }) ? w.length === 0 ? fa(this) : this.inAnyRange(w.map(function(E) {
          return [E, E + Yr];
        })) : Wr(this, "startsWithAnyOf() only works with strings");
      }, zn);
      function zn() {
      }
      function Li(w) {
        return yn(function(E) {
          return Is(E), w(E.target.error), !1;
        });
      }
      function Is(w) {
        w.stopPropagation && w.stopPropagation(), w.preventDefault && w.preventDefault();
      }
      var _o = "storagemutated", La = "x-storagemutated-1", Ar = Os(null, _o), Ec = (Xr.prototype._lock = function() {
        return z(!it.global), ++this._reculock, this._reculock !== 1 || it.global || (it.lockOwnerFor = this), this;
      }, Xr.prototype._unlock = function() {
        if (z(!it.global), --this._reculock == 0) for (it.global || (it.lockOwnerFor = null); 0 < this._blockedFuncs.length && !this._locked(); ) {
          var w = this._blockedFuncs.shift();
          try {
            ri(w[1], w[0]);
          } catch {
          }
        }
        return this;
      }, Xr.prototype._locked = function() {
        return this._reculock && it.lockOwnerFor !== this;
      }, Xr.prototype.create = function(w) {
        var E = this;
        if (!this.mode) return this;
        var M = this.db.idbdb, I = this.db._state.dbOpenError;
        if (z(!this.idbtrans), !w && !M) switch (I && I.name) {
          case "DatabaseClosedError":
            throw new Me.DatabaseClosed(I);
          case "MissingAPIError":
            throw new Me.MissingAPI(I.message, I);
          default:
            throw new Me.OpenFailed(I);
        }
        if (!this.active) throw new Me.TransactionInactive();
        return z(this._completion._state === null), (w = this.idbtrans = w || (this.db.core || M).transaction(this.storeNames, this.mode, { durability: this.chromeTransactionDurability })).onerror = yn(function(B) {
          Is(B), E._reject(w.error);
        }), w.onabort = yn(function(B) {
          Is(B), E.active && E._reject(new Me.Abort(w.error)), E.active = !1, E.on("abort").fire(B);
        }), w.oncomplete = yn(function() {
          E.active = !1, E._resolve(), "mutatedParts" in w && Ar.storagemutated.fire(w.mutatedParts);
        }), this;
      }, Xr.prototype._promise = function(w, E, M) {
        var I = this;
        if (w === "readwrite" && this.mode !== "readwrite") return sn(new Me.ReadOnly("Transaction is readonly"));
        if (!this.active) return sn(new Me.TransactionInactive());
        if (this._locked()) return new ct(function(W, oe) {
          I._blockedFuncs.push([function() {
            I._promise(w, E, M).then(W, oe);
          }, it]);
        });
        if (M) return bn(function() {
          var W = new ct(function(oe, F) {
            I._lock();
            var ne = E(oe, F, I);
            ne && ne.then && ne.then(oe, F);
          });
          return W.finally(function() {
            return I._unlock();
          }), W._lib = !0, W;
        });
        var B = new ct(function(W, oe) {
          var F = E(W, oe, I);
          F && F.then && F.then(W, oe);
        });
        return B._lib = !0, B;
      }, Xr.prototype._root = function() {
        return this.parent ? this.parent._root() : this;
      }, Xr.prototype.waitFor = function(w) {
        var E, M = this._root(), I = ct.resolve(w);
        M._waitingFor ? M._waitingFor = M._waitingFor.then(function() {
          return I;
        }) : (M._waitingFor = I, M._waitingQueue = [], E = M.idbtrans.objectStore(M.storeNames[0]), (function W() {
          for (++M._spinCount; M._waitingQueue.length; ) M._waitingQueue.shift()();
          M._waitingFor && (E.get(-1 / 0).onsuccess = W);
        })());
        var B = M._waitingFor;
        return new ct(function(W, oe) {
          I.then(function(F) {
            return M._waitingQueue.push(yn(W.bind(null, F)));
          }, function(F) {
            return M._waitingQueue.push(yn(oe.bind(null, F)));
          }).finally(function() {
            M._waitingFor === B && (M._waitingFor = null);
          });
        });
      }, Xr.prototype.abort = function() {
        this.active && (this.active = !1, this.idbtrans && this.idbtrans.abort(), this._reject(new Me.Abort()));
      }, Xr.prototype.table = function(w) {
        var E = this._memoizedTables || (this._memoizedTables = {});
        if (g(E, w)) return E[w];
        var M = this.schema[w];
        if (!M) throw new Me.NotFound("Table " + w + " not part of transaction");
        return M = new this.db.Table(w, M, this), M.core = this.db.core.table(w), E[w] = M;
      }, Xr);
      function Xr() {
      }
      function ha(w, E, M, I, B, W, oe, F) {
        return { name: w, keyPath: E, unique: M, multi: I, auto: B, compound: W, src: (M && !oe ? "&" : "") + (I ? "*" : "") + (B ? "++" : "") + pu(E), type: F };
      }
      function pu(w) {
        return typeof w == "string" ? w : w ? "[" + [].join.call(w, "+") + "]" : "";
      }
      function un(w, E, M) {
        return { name: w, primKey: E, indexes: M, mappedClass: null, idxByName: (I = function(B) {
          return [B.name, B];
        }, M.reduce(function(B, W, oe) {
          return oe = I(W, oe), oe && (B[oe[0]] = oe[1]), B;
        }, {})) };
        var I;
      }
      var on = function(w) {
        try {
          return w.only([[]]), on = function() {
            return [[]];
          }, [[]];
        } catch {
          return on = function() {
            return Yr;
          }, Yr;
        }
      };
      function So(w) {
        return w == null ? function() {
        } : typeof w == "string" ? (E = w).split(".").length === 1 ? function(M) {
          return M[E];
        } : function(M) {
          return D(M, E);
        } : function(M) {
          return D(M, w);
        };
        var E;
      }
      function El(w) {
        return [].slice.call(w);
      }
      var pd = 0;
      function yr(w) {
        return w == null ? ":id" : typeof w == "string" ? w : "[".concat(w.join("+"), "]");
      }
      function Ls(w, E, ne) {
        function I(Ne) {
          if (Ne.type === 3) return null;
          if (Ne.type === 4) throw new Error("Cannot convert never type to IDBKeyRange");
          var be = Ne.lower, we = Ne.upper, ke = Ne.lowerOpen, Ne = Ne.upperOpen;
          return be === void 0 ? we === void 0 ? null : E.upperBound(we, !!Ne) : we === void 0 ? E.lowerBound(be, !!ke) : E.bound(be, we, !!ke, !!Ne);
        }
        function B(_e) {
          var be, we = _e.name;
          return { name: we, schema: _e, mutate: function(ke) {
            var Ne = ke.trans, Te = ke.type, Ie = ke.keys, $e = ke.values, Ve = ke.range;
            return new Promise(function(rt, lt) {
              rt = yn(rt);
              var Ge = Ne.objectStore(we), st = Ge.keyPath == null, ut = Te === "put" || Te === "add";
              if (!ut && Te !== "delete" && Te !== "deleteRange") throw new Error("Invalid operation type: " + Te);
              var tt, ht = (Ie || $e || { length: 1 }).length;
              if (Ie && $e && Ie.length !== $e.length) throw new Error("Given keys array must have same length as given values array.");
              if (ht === 0) return rt({ numFailures: 0, failures: {}, results: [], lastResult: void 0 });
              function _t(dr) {
                ++Ln, Is(dr);
              }
              var Rt = [], Ot = [], Ln = 0;
              if (Te === "deleteRange") {
                if (Ve.type === 4) return rt({ numFailures: Ln, failures: Ot, results: [], lastResult: void 0 });
                Ve.type === 3 ? Rt.push(tt = Ge.clear()) : Rt.push(tt = Ge.delete(I(Ve)));
              } else {
                var st = ut ? st ? [$e, Ie] : [$e, null] : [Ie, null], Et = st[0], fr = st[1];
                if (ut) for (var Nn = 0; Nn < ht; ++Nn) Rt.push(tt = fr && fr[Nn] !== void 0 ? Ge[Te](Et[Nn], fr[Nn]) : Ge[Te](Et[Nn])), tt.onerror = _t;
                else for (Nn = 0; Nn < ht; ++Nn) Rt.push(tt = Ge[Te](Et[Nn])), tt.onerror = _t;
              }
              function Mo(dr) {
                dr = dr.target.result, Rt.forEach(function(Br, Eu) {
                  return Br.error != null && (Ot[Eu] = Br.error);
                }), rt({ numFailures: Ln, failures: Ot, results: Te === "delete" ? Ie : Rt.map(function(Br) {
                  return Br.result;
                }), lastResult: dr });
              }
              tt.onerror = function(dr) {
                _t(dr), Mo(dr);
              }, tt.onsuccess = Mo;
            });
          }, getMany: function(ke) {
            var Ne = ke.trans, Te = ke.keys;
            return new Promise(function(Ie, $e) {
              Ie = yn(Ie);
              for (var Ve, rt = Ne.objectStore(we), lt = Te.length, Ge = new Array(lt), st = 0, ut = 0, tt = function(Rt) {
                Rt = Rt.target, Ge[Rt._pos] = Rt.result, ++ut === st && Ie(Ge);
              }, ht = Li($e), _t = 0; _t < lt; ++_t) Te[_t] != null && ((Ve = rt.get(Te[_t]))._pos = _t, Ve.onsuccess = tt, Ve.onerror = ht, ++st);
              st === 0 && Ie(Ge);
            });
          }, get: function(ke) {
            var Ne = ke.trans, Te = ke.key;
            return new Promise(function(Ie, $e) {
              Ie = yn(Ie);
              var Ve = Ne.objectStore(we).get(Te);
              Ve.onsuccess = function(rt) {
                return Ie(rt.target.result);
              }, Ve.onerror = Li($e);
            });
          }, query: (be = te, function(ke) {
            return new Promise(function(Ne, Te) {
              Ne = yn(Ne);
              var Ie, $e, Ve, st = ke.trans, rt = ke.values, lt = ke.limit, tt = ke.query, Ge = lt === 1 / 0 ? void 0 : lt, ut = tt.index, tt = tt.range, st = st.objectStore(we), ut = ut.isPrimaryKey ? st : st.index(ut.name), tt = I(tt);
              if (lt === 0) return Ne({ result: [] });
              be ? ((Ge = rt ? ut.getAll(tt, Ge) : ut.getAllKeys(tt, Ge)).onsuccess = function(ht) {
                return Ne({ result: ht.target.result });
              }, Ge.onerror = Li(Te)) : (Ie = 0, $e = !rt && "openKeyCursor" in ut ? ut.openKeyCursor(tt) : ut.openCursor(tt), Ve = [], $e.onsuccess = function(ht) {
                var _t = $e.result;
                return _t ? (Ve.push(rt ? _t.value : _t.primaryKey), ++Ie === lt ? Ne({ result: Ve }) : void _t.continue()) : Ne({ result: Ve });
              }, $e.onerror = Li(Te));
            });
          }), openCursor: function(ke) {
            var Ne = ke.trans, Te = ke.values, Ie = ke.query, $e = ke.reverse, Ve = ke.unique;
            return new Promise(function(rt, lt) {
              rt = yn(rt);
              var ut = Ie.index, Ge = Ie.range, st = Ne.objectStore(we), st = ut.isPrimaryKey ? st : st.index(ut.name), ut = $e ? Ve ? "prevunique" : "prev" : Ve ? "nextunique" : "next", tt = !Te && "openKeyCursor" in st ? st.openKeyCursor(I(Ge), ut) : st.openCursor(I(Ge), ut);
              tt.onerror = Li(lt), tt.onsuccess = yn(function(ht) {
                var _t, Rt, Ot, Ln, Et = tt.result;
                Et ? (Et.___id = ++pd, Et.done = !1, _t = Et.continue.bind(Et), Rt = (Rt = Et.continuePrimaryKey) && Rt.bind(Et), Ot = Et.advance.bind(Et), Ln = function() {
                  throw new Error("Cursor not stopped");
                }, Et.trans = Ne, Et.stop = Et.continue = Et.continuePrimaryKey = Et.advance = function() {
                  throw new Error("Cursor not started");
                }, Et.fail = yn(lt), Et.next = function() {
                  var fr = this, Nn = 1;
                  return this.start(function() {
                    return Nn-- ? fr.continue() : fr.stop();
                  }).then(function() {
                    return fr;
                  });
                }, Et.start = function(fr) {
                  function Nn() {
                    if (tt.result) try {
                      fr();
                    } catch (dr) {
                      Et.fail(dr);
                    }
                    else Et.done = !0, Et.start = function() {
                      throw new Error("Cursor behind last entry");
                    }, Et.stop();
                  }
                  var Mo = new Promise(function(dr, Br) {
                    dr = yn(dr), tt.onerror = Li(Br), Et.fail = Br, Et.stop = function(Eu) {
                      Et.stop = Et.continue = Et.continuePrimaryKey = Et.advance = Ln, dr(Eu);
                    };
                  });
                  return tt.onsuccess = yn(function(dr) {
                    tt.onsuccess = Nn, Nn();
                  }), Et.continue = _t, Et.continuePrimaryKey = Rt, Et.advance = Ot, Nn(), Mo;
                }, rt(Et)) : rt(null);
              }, lt);
            });
          }, count: function(ke) {
            var Ne = ke.query, Te = ke.trans, Ie = Ne.index, $e = Ne.range;
            return new Promise(function(Ve, rt) {
              var lt = Te.objectStore(we), Ge = Ie.isPrimaryKey ? lt : lt.index(Ie.name), lt = I($e), Ge = lt ? Ge.count(lt) : Ge.count();
              Ge.onsuccess = yn(function(st) {
                return Ve(st.target.result);
              }), Ge.onerror = Li(rt);
            });
          } };
        }
        var W, oe, F, me = (oe = ne, F = El((W = w).objectStoreNames), { schema: { name: W.name, tables: F.map(function(_e) {
          return oe.objectStore(_e);
        }).map(function(_e) {
          var be = _e.keyPath, Ne = _e.autoIncrement, we = c(be), ke = {}, Ne = { name: _e.name, primaryKey: { name: null, isPrimaryKey: !0, outbound: be == null, compound: we, keyPath: be, autoIncrement: Ne, unique: !0, extractKey: So(be) }, indexes: El(_e.indexNames).map(function(Te) {
            return _e.index(Te);
          }).map(function(Ve) {
            var Ie = Ve.name, $e = Ve.unique, rt = Ve.multiEntry, Ve = Ve.keyPath, rt = { name: Ie, compound: c(Ve), keyPath: Ve, unique: $e, multiEntry: rt, extractKey: So(Ve) };
            return ke[yr(Ve)] = rt;
          }), getIndexByKeyPath: function(Te) {
            return ke[yr(Te)];
          } };
          return ke[":id"] = Ne.primaryKey, be != null && (ke[yr(be)] = Ne.primaryKey), Ne;
        }) }, hasGetAll: 0 < F.length && "getAll" in oe.objectStore(F[0]) && !(typeof navigator < "u" && /Safari/.test(navigator.userAgent) && !/(Chrome\/|Edge\/)/.test(navigator.userAgent) && [].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1] < 604) }), ne = me.schema, te = me.hasGetAll, me = ne.tables.map(B), ce = {};
        return me.forEach(function(_e) {
          return ce[_e.name] = _e;
        }), { stack: "dbcore", transaction: w.transaction.bind(w), table: function(_e) {
          if (!ce[_e]) throw new Error("Table '".concat(_e, "' not found"));
          return ce[_e];
        }, MIN_KEY: -1 / 0, MAX_KEY: on(E), schema: ne };
      }
      function gu(w, E, M, I) {
        var B = M.IDBKeyRange;
        return M.indexedDB, { dbcore: (I = Ls(E, B, I), w.dbcore.reduce(function(W, oe) {
          return oe = oe.create, r(r({}, W), oe(W));
        }, I)) };
      }
      function Pa(w, I) {
        var M = I.db, I = gu(w._middlewares, M, w._deps, I);
        w.core = I.dbcore, w.tables.forEach(function(B) {
          var W = B.name;
          w.core.schema.tables.some(function(oe) {
            return oe.name === W;
          }) && (B.core = w.core.table(W), w[W] instanceof w.Table && (w[W].core = B.core));
        });
      }
      function yu(w, E, M, I) {
        M.forEach(function(B) {
          var W = I[B];
          E.forEach(function(oe) {
            var F = (function ne(te, me) {
              return T(te, me) || (te = h(te)) && ne(te, me);
            })(oe, B);
            (!F || "value" in F && F.value === void 0) && (oe === w.Transaction.prototype || oe instanceof w.Transaction ? C(oe, B, { get: function() {
              return this.table(B);
            }, set: function(ne) {
              b(this, B, { value: ne, writable: !0, configurable: !0, enumerable: !0 });
            } }) : oe[B] = new w.Table(B, W));
          });
        });
      }
      function Zn(w, E) {
        E.forEach(function(M) {
          for (var I in M) M[I] instanceof w.Table && delete M[I];
        });
      }
      function kl(w, E) {
        return w._cfg.version - E._cfg.version;
      }
      function Pi(w, E, M, I) {
        var B = w._dbSchema;
        M.objectStoreNames.contains("$meta") && !B.$meta && (B.$meta = un("$meta", Nc("")[0], []), w._storeNames.push("$meta"));
        var W = w._createTransaction("readwrite", w._storeNames, B);
        W.create(M), W._completion.catch(I);
        var oe = W._reject.bind(W), F = it.transless || it;
        bn(function() {
          return it.trans = W, it.transless = F, E !== 0 ? (Pa(w, M), te = E, ((ne = W).storeNames.includes("$meta") ? ne.table("$meta").get("version").then(function(me) {
            return me ?? te;
          }) : ct.resolve(te)).then(function(me) {
            return _e = me, be = W, we = M, ke = [], me = (ce = w)._versions, Ne = ce._dbSchema = Ps(0, ce.idbdb, we), (me = me.filter(function(Te) {
              return Te._cfg.version >= _e;
            })).length !== 0 ? (me.forEach(function(Te) {
              ke.push(function() {
                var Ie = Ne, $e = Te._cfg.dbschema;
                Tl(ce, Ie, we), Tl(ce, $e, we), Ne = ce._dbSchema = $e;
                var Ve = Co(Ie, $e);
                Ve.add.forEach(function(ut) {
                  Qr(we, ut[0], ut[1].primKey, ut[1].indexes);
                }), Ve.change.forEach(function(ut) {
                  if (ut.recreate) throw new Me.Upgrade("Not yet support for changing primary key");
                  var tt = we.objectStore(ut.name);
                  ut.add.forEach(function(ht) {
                    return jl(tt, ht);
                  }), ut.change.forEach(function(ht) {
                    tt.deleteIndex(ht.name), jl(tt, ht);
                  }), ut.del.forEach(function(ht) {
                    return tt.deleteIndex(ht);
                  });
                });
                var rt = Te._cfg.contentUpgrade;
                if (rt && Te._cfg.version > _e) {
                  Pa(ce, we), be._memoizedTables = {};
                  var lt = re($e);
                  Ve.del.forEach(function(ut) {
                    lt[ut] = Ie[ut];
                  }), Zn(ce, [ce.Transaction.prototype]), yu(ce, [ce.Transaction.prototype], l(lt), lt), be.schema = lt;
                  var Ge, st = U(rt);
                  return st && Xn(), Ve = ct.follow(function() {
                    var ut;
                    (Ge = rt(be)) && st && (ut = Tr.bind(null, null), Ge.then(ut, ut));
                  }), Ge && typeof Ge.then == "function" ? ct.resolve(Ge) : Ve.then(function() {
                    return Ge;
                  });
                }
              }), ke.push(function(Ie) {
                var $e, Ve, rt = Te._cfg.dbschema;
                $e = rt, Ve = Ie, [].slice.call(Ve.db.objectStoreNames).forEach(function(lt) {
                  return $e[lt] == null && Ve.db.deleteObjectStore(lt);
                }), Zn(ce, [ce.Transaction.prototype]), yu(ce, [ce.Transaction.prototype], ce._storeNames, ce._dbSchema), be.schema = ce._dbSchema;
              }), ke.push(function(Ie) {
                ce.idbdb.objectStoreNames.contains("$meta") && (Math.ceil(ce.idbdb.version / 10) === Te._cfg.version ? (ce.idbdb.deleteObjectStore("$meta"), delete ce._dbSchema.$meta, ce._storeNames = ce._storeNames.filter(function($e) {
                  return $e !== "$meta";
                })) : Ie.objectStore("$meta").put(Te._cfg.version, "version"));
              });
            }), (function Te() {
              return ke.length ? ct.resolve(ke.shift()(be.idbtrans)).then(Te) : ct.resolve();
            })().then(function() {
              kc(Ne, we);
            })) : ct.resolve();
            var ce, _e, be, we, ke, Ne;
          }).catch(oe)) : (l(B).forEach(function(me) {
            Qr(M, me, B[me].primKey, B[me].indexes);
          }), Pa(w, M), void ct.follow(function() {
            return w.on.populate.fire(W);
          }).catch(oe));
          var ne, te;
        });
      }
      function Nl(w, E) {
        kc(w._dbSchema, E), E.db.version % 10 != 0 || E.objectStoreNames.contains("$meta") || E.db.createObjectStore("$meta").add(Math.ceil(E.db.version / 10 - 1), "version");
        var M = Ps(0, w.idbdb, E);
        Tl(w, w._dbSchema, E);
        for (var I = 0, B = Co(M, w._dbSchema).change; I < B.length; I++) {
          var W = (function(oe) {
            if (oe.change.length || oe.recreate) return console.warn("Unable to patch indexes of table ".concat(oe.name, " because it has changes on the type of index or primary key.")), { value: void 0 };
            var F = E.objectStore(oe.name);
            oe.add.forEach(function(ne) {
              Ht && console.debug("Dexie upgrade patch: Creating missing index ".concat(oe.name, ".").concat(ne.src)), jl(F, ne);
            });
          })(B[I]);
          if (typeof W == "object") return W.value;
        }
      }
      function Co(w, E) {
        var M, I = { del: [], add: [], change: [] };
        for (M in w) E[M] || I.del.push(M);
        for (M in E) {
          var B = w[M], W = E[M];
          if (B) {
            var oe = { name: M, def: W, recreate: !1, del: [], add: [], change: [] };
            if ("" + (B.primKey.keyPath || "") != "" + (W.primKey.keyPath || "") || B.primKey.auto !== W.primKey.auto) oe.recreate = !0, I.change.push(oe);
            else {
              var F = B.idxByName, ne = W.idxByName, te = void 0;
              for (te in F) ne[te] || oe.del.push(te);
              for (te in ne) {
                var me = F[te], ce = ne[te];
                me ? me.src !== ce.src && oe.change.push(ce) : oe.add.push(ce);
              }
              (0 < oe.del.length || 0 < oe.add.length || 0 < oe.change.length) && I.change.push(oe);
            }
          } else I.add.push([M, W]);
        }
        return I;
      }
      function Qr(w, E, M, I) {
        var B = w.db.createObjectStore(E, M.keyPath ? { keyPath: M.keyPath, autoIncrement: M.auto } : { autoIncrement: M.auto });
        return I.forEach(function(W) {
          return jl(B, W);
        }), B;
      }
      function kc(w, E) {
        l(w).forEach(function(M) {
          E.db.objectStoreNames.contains(M) || (Ht && console.debug("Dexie: Creating missing table", M), Qr(E, M, w[M].primKey, w[M].indexes));
        });
      }
      function jl(w, E) {
        w.createIndex(E.name, E.keyPath, { unique: E.unique, multiEntry: E.multi });
      }
      function Ps(w, E, M) {
        var I = {};
        return R(E.objectStoreNames, 0).forEach(function(B) {
          for (var W = M.objectStore(B), oe = ha(pu(te = W.keyPath), te || "", !0, !1, !!W.autoIncrement, te && typeof te != "string", !0), F = [], ne = 0; ne < W.indexNames.length; ++ne) {
            var me = W.index(W.indexNames[ne]), te = me.keyPath, me = ha(me.name, te, !!me.unique, !!me.multiEntry, !1, te && typeof te != "string", !1);
            F.push(me);
          }
          I[B] = un(B, oe, F);
        }), I;
      }
      function Tl(w, E, M) {
        for (var I = M.db.objectStoreNames, B = 0; B < I.length; ++B) {
          var W = I[B], oe = M.objectStore(W);
          w._hasGetAll = "getAll" in oe;
          for (var F = 0; F < oe.indexNames.length; ++F) {
            var ne = oe.indexNames[F], te = oe.index(ne).keyPath, me = typeof te == "string" ? te : "[" + R(te).join("+") + "]";
            !E[W] || (te = E[W].idxByName[me]) && (te.name = ne, delete E[W].idxByName[me], E[W].idxByName[ne] = te);
          }
        }
        typeof navigator < "u" && /Safari/.test(navigator.userAgent) && !/(Chrome\/|Edge\/)/.test(navigator.userAgent) && o.WorkerGlobalScope && o instanceof o.WorkerGlobalScope && [].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1] < 604 && (w._hasGetAll = !1);
      }
      function Nc(w) {
        return w.split(",").map(function(E, M) {
          var W = E.split(":"), I = (B = W[1]) === null || B === void 0 ? void 0 : B.trim(), B = (E = W[0].trim()).replace(/([&*]|\+\+)/g, ""), W = /^\[/.test(B) ? B.match(/^\[(.*)\]$/)[1].split("+") : B;
          return ha(B, W || null, /\&/.test(E), /\*/.test(E), /\+\+/.test(E), c(W), M === 0, I);
        });
      }
      var gd = (vr.prototype._createTableSchema = un, vr.prototype._parseIndexSyntax = Nc, vr.prototype._parseStoresSpec = function(w, E) {
        var M = this;
        l(w).forEach(function(I) {
          if (w[I] !== null) {
            var B = M._parseIndexSyntax(w[I]), W = B.shift();
            if (!W) throw new Me.Schema("Invalid schema for table " + I + ": " + w[I]);
            if (W.unique = !0, W.multi) throw new Me.Schema("Primary key cannot be multiEntry*");
            B.forEach(function(oe) {
              if (oe.auto) throw new Me.Schema("Only primary key can be marked as autoIncrement (++)");
              if (!oe.keyPath) throw new Me.Schema("Index must have a name and cannot be an empty string");
            }), B = M._createTableSchema(I, W, B), E[I] = B;
          }
        });
      }, vr.prototype.stores = function(M) {
        var E = this.db;
        this._cfg.storesSource = this._cfg.storesSource ? d(this._cfg.storesSource, M) : M;
        var M = E._versions, I = {}, B = {};
        return M.forEach(function(W) {
          d(I, W._cfg.storesSource), B = W._cfg.dbschema = {}, W._parseStoresSpec(I, B);
        }), E._dbSchema = B, Zn(E, [E._allTables, E, E.Transaction.prototype]), yu(E, [E._allTables, E, E.Transaction.prototype, this._cfg.tables], l(B), B), E._storeNames = l(B), this;
      }, vr.prototype.upgrade = function(w) {
        return this._cfg.contentUpgrade = Fn(this._cfg.contentUpgrade || Be, w), this;
      }, vr);
      function vr() {
      }
      function jc(w, E) {
        var M = w._dbNamesDB;
        return M || (M = w._dbNamesDB = new Pr(Ms, { addons: [], indexedDB: w, IDBKeyRange: E })).version(1).stores({ dbnames: "name" }), M.table("dbnames");
      }
      function Lr(w) {
        return w && typeof w.databases == "function";
      }
      function Tc(w) {
        return bn(function() {
          return it.letThrough = !0, w();
        });
      }
      function vu(w) {
        return !("from" in w);
      }
      var Dn = function(w, E) {
        if (!this) {
          var M = new Dn();
          return w && "d" in w && d(M, w), M;
        }
        d(this, arguments.length ? { d: 1, from: w, to: 1 < arguments.length ? E : w } : { d: 0 });
      };
      function fs(w, E, M) {
        var I = It(E, M);
        if (!isNaN(I)) {
          if (0 < I) throw RangeError();
          if (vu(w)) return d(w, { from: E, to: M, d: 1 });
          var B = w.l, I = w.r;
          if (It(M, w.from) < 0) return B ? fs(B, E, M) : w.l = { from: E, to: M, d: 1, l: null, r: null }, xu(w);
          if (0 < It(E, w.to)) return I ? fs(I, E, M) : w.r = { from: E, to: M, d: 1, l: null, r: null }, xu(w);
          It(E, w.from) < 0 && (w.from = E, w.l = null, w.d = I ? I.d + 1 : 1), 0 < It(M, w.to) && (w.to = M, w.r = null, w.d = w.l ? w.l.d + 1 : 1), M = !w.r, B && !w.l && qa(w, B), I && M && qa(w, I);
        }
      }
      function qa(w, E) {
        vu(E) || (function M(I, ne) {
          var W = ne.from, oe = ne.to, F = ne.l, ne = ne.r;
          fs(I, W, oe), F && M(I, F), ne && M(I, ne);
        })(w, E);
      }
      function kn(w, E) {
        var M = qi(E), I = M.next();
        if (I.done) return !1;
        for (var B = I.value, W = qi(w), oe = W.next(B.from), F = oe.value; !I.done && !oe.done; ) {
          if (It(F.from, B.to) <= 0 && 0 <= It(F.to, B.from)) return !0;
          It(B.from, F.from) < 0 ? B = (I = M.next(F.from)).value : F = (oe = W.next(B.from)).value;
        }
        return !1;
      }
      function qi(w) {
        var E = vu(w) ? null : { s: 0, n: w };
        return { next: function(M) {
          for (var I = 0 < arguments.length; E; ) switch (E.s) {
            case 0:
              if (E.s = 1, I) for (; E.n.l && It(M, E.n.from) < 0; ) E = { up: E, n: E.n.l, s: 1 };
              else for (; E.n.l; ) E = { up: E, n: E.n.l, s: 1 };
            case 1:
              if (E.s = 2, !I || It(M, E.n.to) <= 0) return { value: E.n, done: !1 };
            case 2:
              if (E.n.r) {
                E.s = 3, E = { up: E, n: E.n.r, s: 0 };
                continue;
              }
            case 3:
              E = E.up;
          }
          return { done: !0 };
        } };
      }
      function xu(w) {
        var E, M, I = (((E = w.r) === null || E === void 0 ? void 0 : E.d) || 0) - (((M = w.l) === null || M === void 0 ? void 0 : M.d) || 0), B = 1 < I ? "r" : I < -1 ? "l" : "";
        B && (E = B == "r" ? "l" : "r", M = r({}, w), I = w[B], w.from = I.from, w.to = I.to, w[B] = I[B], M[B] = I[E], (w[E] = M).d = Ac(M)), w.d = Ac(w);
      }
      function Ac(M) {
        var E = M.r, M = M.l;
        return (E ? M ? Math.max(E.d, M.d) : E.d : M ? M.d : 0) + 1;
      }
      function Eo(w, E) {
        return l(E).forEach(function(M) {
          w[M] ? qa(w[M], E[M]) : w[M] = (function I(B) {
            var W, oe, F = {};
            for (W in B) g(B, W) && (oe = B[W], F[W] = !oe || typeof oe != "object" || K.has(oe.constructor) ? oe : I(oe));
            return F;
          })(E[M]);
        }), w;
      }
      function Mc(w, E) {
        return w.all || E.all || Object.keys(w).some(function(M) {
          return E[M] && kn(E[M], w[M]);
        });
      }
      x(Dn.prototype, ((qr = { add: function(w) {
        return qa(this, w), this;
      }, addKey: function(w) {
        return fs(this, w, w), this;
      }, addKeys: function(w) {
        var E = this;
        return w.forEach(function(M) {
          return fs(E, M, M);
        }), this;
      }, hasKey: function(w) {
        var E = qi(this).next(w).value;
        return E && It(E.from, w) <= 0 && 0 <= It(E.to, w);
      } })[Z] = function() {
        return qi(this);
      }, qr));
      var qs = {}, Rc = {}, bu = !1;
      function Bs(w) {
        Eo(Rc, w), bu || (bu = !0, setTimeout(function() {
          bu = !1, ds(Rc, !(Rc = {}));
        }, 0));
      }
      function ds(w, E) {
        E === void 0 && (E = !1);
        var M = /* @__PURE__ */ new Set();
        if (w.all) for (var I = 0, B = Object.values(qs); I < B.length; I++) yd(oe = B[I], w, M, E);
        else for (var W in w) {
          var oe, F = /^idb\:\/\/(.*)\/(.*)\//.exec(W);
          F && (W = F[1], F = F[2], (oe = qs["idb://".concat(W, "/").concat(F)]) && yd(oe, w, M, E));
        }
        M.forEach(function(ne) {
          return ne();
        });
      }
      function yd(w, E, M, I) {
        for (var B = [], W = 0, oe = Object.entries(w.queries.query); W < oe.length; W++) {
          for (var F = oe[W], ne = F[0], te = [], me = 0, ce = F[1]; me < ce.length; me++) {
            var _e = ce[me];
            Mc(E, _e.obsSet) ? _e.subscribers.forEach(function(Ne) {
              return M.add(Ne);
            }) : I && te.push(_e);
          }
          I && B.push([ne, te]);
        }
        if (I) for (var be = 0, we = B; be < we.length; be++) {
          var ke = we[be], ne = ke[0], te = ke[1];
          w.queries.query[ne] = te;
        }
      }
      function vd(w) {
        var E = w._state, M = w._deps.indexedDB;
        if (E.isBeingOpened || w.idbdb) return E.dbReadyPromise.then(function() {
          return E.dbOpenError ? sn(E.dbOpenError) : w;
        });
        E.isBeingOpened = !0, E.dbOpenError = null, E.openComplete = !1;
        var I = E.openCanceller, B = Math.round(10 * w.verno), W = !1;
        function oe() {
          if (E.openCanceller !== I) throw new Me.DatabaseClosed("db.open() was cancelled");
        }
        function F() {
          return new ct(function(_e, be) {
            if (oe(), !M) throw new Me.MissingAPI();
            var we = w.name, ke = E.autoSchema || !B ? M.open(we) : M.open(we, B);
            if (!ke) throw new Me.MissingAPI();
            ke.onerror = Li(be), ke.onblocked = yn(w._fireOnBlocked), ke.onupgradeneeded = yn(function(Ne) {
              var Te;
              me = ke.transaction, E.autoSchema && !w._options.allowEmptyDB ? (ke.onerror = Is, me.abort(), ke.result.close(), (Te = M.deleteDatabase(we)).onsuccess = Te.onerror = yn(function() {
                be(new Me.NoSuchDatabase("Database ".concat(we, " doesnt exist")));
              })) : (me.onerror = Li(be), Ne = Ne.oldVersion > Math.pow(2, 62) ? 0 : Ne.oldVersion, ce = Ne < 1, w.idbdb = ke.result, W && Nl(w, me), Pi(w, Ne / 10, me, be));
            }, be), ke.onsuccess = yn(function() {
              me = null;
              var Ne, Te, Ie, $e, Ve, rt = w.idbdb = ke.result, lt = R(rt.objectStoreNames);
              if (0 < lt.length) try {
                var Ge = rt.transaction(($e = lt).length === 1 ? $e[0] : $e, "readonly");
                if (E.autoSchema) Te = rt, Ie = Ge, (Ne = w).verno = Te.version / 10, Ie = Ne._dbSchema = Ps(0, Te, Ie), Ne._storeNames = R(Te.objectStoreNames, 0), yu(Ne, [Ne._allTables], l(Ie), Ie);
                else if (Tl(w, w._dbSchema, Ge), ((Ve = Co(Ps(0, (Ve = w).idbdb, Ge), Ve._dbSchema)).add.length || Ve.change.some(function(st) {
                  return st.add.length || st.change.length;
                })) && !W) return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."), rt.close(), B = rt.version + 1, W = !0, _e(F());
                Pa(w, Ge);
              } catch {
              }
              Ia.push(w), rt.onversionchange = yn(function(st) {
                E.vcFired = !0, w.on("versionchange").fire(st);
              }), rt.onclose = yn(function() {
                w.close({ disableAutoOpen: !1 });
              }), ce && (Ve = w._deps, Ge = we, rt = Ve.indexedDB, Ve = Ve.IDBKeyRange, Lr(rt) || Ge === Ms || jc(rt, Ve).put({ name: Ge }).catch(Be)), _e();
            }, be);
          }).catch(function(_e) {
            switch (_e == null ? void 0 : _e.name) {
              case "UnknownError":
                if (0 < E.PR1398_maxLoop) return E.PR1398_maxLoop--, console.warn("Dexie: Workaround for Chrome UnknownError on open()"), F();
                break;
              case "VersionError":
                if (0 < B) return B = 0, F();
            }
            return ct.reject(_e);
          });
        }
        var ne, te = E.dbReadyResolve, me = null, ce = !1;
        return ct.race([I, (typeof navigator > "u" ? ct.resolve() : !navigator.userAgentData && /Safari\//.test(navigator.userAgent) && !/Chrom(e|ium)\//.test(navigator.userAgent) && indexedDB.databases ? new Promise(function(_e) {
          function be() {
            return indexedDB.databases().finally(_e);
          }
          ne = setInterval(be, 100), be();
        }).finally(function() {
          return clearInterval(ne);
        }) : Promise.resolve()).then(F)]).then(function() {
          return oe(), E.onReadyBeingFired = [], ct.resolve(Tc(function() {
            return w.on.ready.fire(w.vip);
          })).then(function _e() {
            if (0 < E.onReadyBeingFired.length) {
              var be = E.onReadyBeingFired.reduce(Fn, Be);
              return E.onReadyBeingFired = [], ct.resolve(Tc(function() {
                return be(w.vip);
              })).then(_e);
            }
          });
        }).finally(function() {
          E.openCanceller === I && (E.onReadyBeingFired = null, E.isBeingOpened = !1);
        }).catch(function(_e) {
          E.dbOpenError = _e;
          try {
            me && me.abort();
          } catch {
          }
          return I === E.openCanceller && w._close(), sn(_e);
        }).finally(function() {
          E.openComplete = !0, te();
        }).then(function() {
          var _e;
          return ce && (_e = {}, w.tables.forEach(function(be) {
            be.schema.indexes.forEach(function(we) {
              we.name && (_e["idb://".concat(w.name, "/").concat(be.name, "/").concat(we.name)] = new Dn(-1 / 0, [[[]]]));
            }), _e["idb://".concat(w.name, "/").concat(be.name, "/")] = _e["idb://".concat(w.name, "/").concat(be.name, "/:dels")] = new Dn(-1 / 0, [[[]]]);
          }), Ar(_o).fire(_e), ds(_e, !0)), w;
        });
      }
      function ko(w) {
        function E(W) {
          return w.next(W);
        }
        var M = B(E), I = B(function(W) {
          return w.throw(W);
        });
        function B(W) {
          return function(ne) {
            var F = W(ne), ne = F.value;
            return F.done ? ne : ne && typeof ne.then == "function" ? ne.then(M, I) : c(ne) ? Promise.all(ne).then(M, I) : M(ne);
          };
        }
        return B(E)();
      }
      function ma(w, E, M) {
        for (var I = c(w) ? w.slice() : [w], B = 0; B < M; ++B) I.push(E);
        return I;
      }
      var Oc = { stack: "dbcore", name: "VirtualIndexMiddleware", level: 1, create: function(w) {
        return r(r({}, w), { table: function(E) {
          var M = w.table(E), I = M.schema, B = {}, W = [];
          function oe(ce, _e, be) {
            var we = yr(ce), ke = B[we] = B[we] || [], Ne = ce == null ? 0 : typeof ce == "string" ? 1 : ce.length, Te = 0 < _e, Te = r(r({}, be), { name: Te ? "".concat(we, "(virtual-from:").concat(be.name, ")") : be.name, lowLevelIndex: be, isVirtual: Te, keyTail: _e, keyLength: Ne, extractKey: So(ce), unique: !Te && be.unique });
            return ke.push(Te), Te.isPrimaryKey || W.push(Te), 1 < Ne && oe(Ne === 2 ? ce[0] : ce.slice(0, Ne - 1), _e + 1, be), ke.sort(function(Ie, $e) {
              return Ie.keyTail - $e.keyTail;
            }), Te;
          }
          E = oe(I.primaryKey.keyPath, 0, I.primaryKey), B[":id"] = [E];
          for (var F = 0, ne = I.indexes; F < ne.length; F++) {
            var te = ne[F];
            oe(te.keyPath, 0, te);
          }
          function me(ce) {
            var _e, be = ce.query.index;
            return be.isVirtual ? r(r({}, ce), { query: { index: be.lowLevelIndex, range: (_e = ce.query.range, be = be.keyTail, { type: _e.type === 1 ? 2 : _e.type, lower: ma(_e.lower, _e.lowerOpen ? w.MAX_KEY : w.MIN_KEY, be), lowerOpen: !0, upper: ma(_e.upper, _e.upperOpen ? w.MIN_KEY : w.MAX_KEY, be), upperOpen: !0 }) } }) : ce;
          }
          return r(r({}, M), { schema: r(r({}, I), { primaryKey: E, indexes: W, getIndexByKeyPath: function(ce) {
            return (ce = B[yr(ce)]) && ce[0];
          } }), count: function(ce) {
            return M.count(me(ce));
          }, query: function(ce) {
            return M.query(me(ce));
          }, openCursor: function(ce) {
            var _e = ce.query.index, be = _e.keyTail, we = _e.isVirtual, ke = _e.keyLength;
            return we ? M.openCursor(me(ce)).then(function(Te) {
              return Te && Ne(Te);
            }) : M.openCursor(ce);
            function Ne(Te) {
              return Object.create(Te, { continue: { value: function(Ie) {
                Ie != null ? Te.continue(ma(Ie, ce.reverse ? w.MAX_KEY : w.MIN_KEY, be)) : ce.unique ? Te.continue(Te.key.slice(0, ke).concat(ce.reverse ? w.MIN_KEY : w.MAX_KEY, be)) : Te.continue();
              } }, continuePrimaryKey: { value: function(Ie, $e) {
                Te.continuePrimaryKey(ma(Ie, w.MAX_KEY, be), $e);
              } }, primaryKey: { get: function() {
                return Te.primaryKey;
              } }, key: { get: function() {
                var Ie = Te.key;
                return ke === 1 ? Ie[0] : Ie.slice(0, ke);
              } }, value: { get: function() {
                return Te.value;
              } } });
            }
          } });
        } });
      } };
      function Al(w, E, M, I) {
        return M = M || {}, I = I || "", l(w).forEach(function(B) {
          var W, oe, F;
          g(E, B) ? (W = w[B], oe = E[B], typeof W == "object" && typeof oe == "object" && W && oe ? (F = se(W)) !== se(oe) ? M[I + B] = E[B] : F === "Object" ? Al(W, oe, M, I + B + ".") : W !== oe && (M[I + B] = E[B]) : W !== oe && (M[I + B] = E[B])) : M[I + B] = void 0;
        }), l(E).forEach(function(B) {
          g(w, B) || (M[I + B] = E[B]);
        }), M;
      }
      function wu(w, E) {
        return E.type === "delete" ? E.keys : E.keys || E.values.map(w.extractKey);
      }
      var _u = { stack: "dbcore", name: "HooksMiddleware", level: 2, create: function(w) {
        return r(r({}, w), { table: function(E) {
          var M = w.table(E), I = M.schema.primaryKey;
          return r(r({}, M), { mutate: function(B) {
            var W = it.trans, oe = W.table(E).hook, F = oe.deleting, ne = oe.creating, te = oe.updating;
            switch (B.type) {
              case "add":
                if (ne.fire === Be) break;
                return W._promise("readwrite", function() {
                  return me(B);
                }, !0);
              case "put":
                if (ne.fire === Be && te.fire === Be) break;
                return W._promise("readwrite", function() {
                  return me(B);
                }, !0);
              case "delete":
                if (F.fire === Be) break;
                return W._promise("readwrite", function() {
                  return me(B);
                }, !0);
              case "deleteRange":
                if (F.fire === Be) break;
                return W._promise("readwrite", function() {
                  return (function ce(_e, be, we) {
                    return M.query({ trans: _e, values: !1, query: { index: I, range: be }, limit: we }).then(function(ke) {
                      var Ne = ke.result;
                      return me({ type: "delete", keys: Ne, trans: _e }).then(function(Te) {
                        return 0 < Te.numFailures ? Promise.reject(Te.failures[0]) : Ne.length < we ? { failures: [], numFailures: 0, lastResult: void 0 } : ce(_e, r(r({}, be), { lower: Ne[Ne.length - 1], lowerOpen: !0 }), we);
                      });
                    });
                  })(B.trans, B.range, 1e4);
                }, !0);
            }
            return M.mutate(B);
            function me(ce) {
              var _e, be, we, ke = it.trans, Ne = ce.keys || wu(I, ce);
              if (!Ne) throw new Error("Keys missing");
              return (ce = ce.type === "add" || ce.type === "put" ? r(r({}, ce), { keys: Ne }) : r({}, ce)).type !== "delete" && (ce.values = a([], ce.values)), ce.keys && (ce.keys = a([], ce.keys)), _e = M, we = Ne, ((be = ce).type === "add" ? Promise.resolve([]) : _e.getMany({ trans: be.trans, keys: we, cache: "immutable" })).then(function(Te) {
                var Ie = Ne.map(function($e, Ve) {
                  var rt, lt, Ge, st = Te[Ve], ut = { onerror: null, onsuccess: null };
                  return ce.type === "delete" ? F.fire.call(ut, $e, st, ke) : ce.type === "add" || st === void 0 ? (rt = ne.fire.call(ut, $e, ce.values[Ve], ke), $e == null && rt != null && (ce.keys[Ve] = $e = rt, I.outbound || P(ce.values[Ve], I.keyPath, $e))) : (rt = Al(st, ce.values[Ve]), (lt = te.fire.call(ut, rt, $e, st, ke)) && (Ge = ce.values[Ve], Object.keys(lt).forEach(function(tt) {
                    g(Ge, tt) ? Ge[tt] = lt[tt] : P(Ge, tt, lt[tt]);
                  }))), ut;
                });
                return M.mutate(ce).then(function($e) {
                  for (var Ve = $e.failures, rt = $e.results, lt = $e.numFailures, $e = $e.lastResult, Ge = 0; Ge < Ne.length; ++Ge) {
                    var st = (rt || Ne)[Ge], ut = Ie[Ge];
                    st == null ? ut.onerror && ut.onerror(Ve[Ge]) : ut.onsuccess && ut.onsuccess(ce.type === "put" && Te[Ge] ? ce.values[Ge] : st);
                  }
                  return { failures: Ve, results: rt, numFailures: lt, lastResult: $e };
                }).catch(function($e) {
                  return Ie.forEach(function(Ve) {
                    return Ve.onerror && Ve.onerror($e);
                  }), Promise.reject($e);
                });
              });
            }
          } });
        } });
      } };
      function Ml(w, E, M) {
        try {
          if (!E || E.keys.length < w.length) return null;
          for (var I = [], B = 0, W = 0; B < E.keys.length && W < w.length; ++B) It(E.keys[B], w[W]) === 0 && (I.push(M ? de(E.values[B]) : E.values[B]), ++W);
          return I.length === w.length ? I : null;
        } catch {
          return null;
        }
      }
      var xd = { stack: "dbcore", level: -1, create: function(w) {
        return { table: function(E) {
          var M = w.table(E);
          return r(r({}, M), { getMany: function(I) {
            if (!I.cache) return M.getMany(I);
            var B = Ml(I.keys, I.trans._cache, I.cache === "clone");
            return B ? ct.resolve(B) : M.getMany(I).then(function(W) {
              return I.trans._cache = { keys: I.keys, values: I.cache === "clone" ? de(W) : W }, W;
            });
          }, mutate: function(I) {
            return I.type !== "add" && (I.trans._cache = null), M.mutate(I);
          } });
        } };
      } };
      function hs(w, E) {
        return w.trans.mode === "readonly" && !!w.subscr && !w.trans.explicit && w.trans.db._options.cache !== "disabled" && !E.schema.primaryKey.outbound;
      }
      function Zr(w, E) {
        switch (w) {
          case "query":
            return E.values && !E.unique;
          case "get":
          case "getMany":
          case "count":
          case "openCursor":
            return !1;
        }
      }
      var zc = { stack: "dbcore", level: 0, name: "Observability", create: function(w) {
        var E = w.schema.name, M = new Dn(w.MIN_KEY, w.MAX_KEY);
        return r(r({}, w), { transaction: function(I, B, W) {
          if (it.subscr && B !== "readonly") throw new Me.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(it.querier));
          return w.transaction(I, B, W);
        }, table: function(I) {
          var B = w.table(I), W = B.schema, oe = W.primaryKey, ce = W.indexes, F = oe.extractKey, ne = oe.outbound, te = oe.autoIncrement && ce.filter(function(be) {
            return be.compound && be.keyPath.includes(oe.keyPath);
          }), me = r(r({}, B), { mutate: function(be) {
            function we(tt) {
              return tt = "idb://".concat(E, "/").concat(I, "/").concat(tt), $e[tt] || ($e[tt] = new Dn());
            }
            var ke, Ne, Te, Ie = be.trans, $e = be.mutatedParts || (be.mutatedParts = {}), Ve = we(""), rt = we(":dels"), lt = be.type, ut = be.type === "deleteRange" ? [be.range] : be.type === "delete" ? [be.keys] : be.values.length < 50 ? [wu(oe, be).filter(function(tt) {
              return tt;
            }), be.values] : [], Ge = ut[0], st = ut[1], ut = be.trans._cache;
            return c(Ge) ? (Ve.addKeys(Ge), (ut = lt === "delete" || Ge.length === st.length ? Ml(Ge, ut) : null) || rt.addKeys(Ge), (ut || st) && (ke = we, Ne = ut, Te = st, W.indexes.forEach(function(tt) {
              var ht = ke(tt.name || "");
              function _t(Ot) {
                return Ot != null ? tt.extractKey(Ot) : null;
              }
              function Rt(Ot) {
                return tt.multiEntry && c(Ot) ? Ot.forEach(function(Ln) {
                  return ht.addKey(Ln);
                }) : ht.addKey(Ot);
              }
              (Ne || Te).forEach(function(Ot, fr) {
                var Et = Ne && _t(Ne[fr]), fr = Te && _t(Te[fr]);
                It(Et, fr) !== 0 && (Et != null && Rt(Et), fr != null && Rt(fr));
              });
            }))) : Ge ? (st = { from: (st = Ge.lower) !== null && st !== void 0 ? st : w.MIN_KEY, to: (st = Ge.upper) !== null && st !== void 0 ? st : w.MAX_KEY }, rt.add(st), Ve.add(st)) : (Ve.add(M), rt.add(M), W.indexes.forEach(function(tt) {
              return we(tt.name).add(M);
            })), B.mutate(be).then(function(tt) {
              return !Ge || be.type !== "add" && be.type !== "put" || (Ve.addKeys(tt.results), te && te.forEach(function(ht) {
                for (var _t = be.values.map(function(Et) {
                  return ht.extractKey(Et);
                }), Rt = ht.keyPath.findIndex(function(Et) {
                  return Et === oe.keyPath;
                }), Ot = 0, Ln = tt.results.length; Ot < Ln; ++Ot) _t[Ot][Rt] = tt.results[Ot];
                we(ht.name).addKeys(_t);
              })), Ie.mutatedParts = Eo(Ie.mutatedParts || {}, $e), tt;
            });
          } }), ce = function(we) {
            var ke = we.query, we = ke.index, ke = ke.range;
            return [we, new Dn((we = ke.lower) !== null && we !== void 0 ? we : w.MIN_KEY, (ke = ke.upper) !== null && ke !== void 0 ? ke : w.MAX_KEY)];
          }, _e = { get: function(be) {
            return [oe, new Dn(be.key)];
          }, getMany: function(be) {
            return [oe, new Dn().addKeys(be.keys)];
          }, count: ce, query: ce, openCursor: ce };
          return l(_e).forEach(function(be) {
            me[be] = function(we) {
              var ke = it.subscr, Ne = !!ke, Te = hs(it, B) && Zr(be, we) ? we.obsSet = {} : ke;
              if (Ne) {
                var Ie = function(st) {
                  return st = "idb://".concat(E, "/").concat(I, "/").concat(st), Te[st] || (Te[st] = new Dn());
                }, $e = Ie(""), Ve = Ie(":dels"), ke = _e[be](we), Ne = ke[0], ke = ke[1];
                if ((be === "query" && Ne.isPrimaryKey && !we.values ? Ve : Ie(Ne.name || "")).add(ke), !Ne.isPrimaryKey) {
                  if (be !== "count") {
                    var rt = be === "query" && ne && we.values && B.query(r(r({}, we), { values: !1 }));
                    return B[be].apply(this, arguments).then(function(st) {
                      if (be === "query") {
                        if (ne && we.values) return rt.then(function(_t) {
                          return _t = _t.result, $e.addKeys(_t), st;
                        });
                        var ut = we.values ? st.result.map(F) : st.result;
                        (we.values ? $e : Ve).addKeys(ut);
                      } else if (be === "openCursor") {
                        var tt = st, ht = we.values;
                        return tt && Object.create(tt, { key: { get: function() {
                          return Ve.addKey(tt.primaryKey), tt.key;
                        } }, primaryKey: { get: function() {
                          var _t = tt.primaryKey;
                          return Ve.addKey(_t), _t;
                        } }, value: { get: function() {
                          return ht && $e.addKey(tt.primaryKey), tt.value;
                        } } });
                      }
                      return st;
                    });
                  }
                  Ve.add(M);
                }
              }
              return B[be].apply(this, arguments);
            };
          }), me;
        } });
      } };
      function No(w, E, M) {
        if (M.numFailures === 0) return E;
        if (E.type === "deleteRange") return null;
        var I = E.keys ? E.keys.length : "values" in E && E.values ? E.values.length : 1;
        return M.numFailures === I ? null : (E = r({}, E), c(E.keys) && (E.keys = E.keys.filter(function(B, W) {
          return !(W in M.failures);
        })), "values" in E && c(E.values) && (E.values = E.values.filter(function(B, W) {
          return !(W in M.failures);
        })), E);
      }
      function Rl(w, E) {
        return M = w, ((I = E).lower === void 0 || (I.lowerOpen ? 0 < It(M, I.lower) : 0 <= It(M, I.lower))) && (w = w, (E = E).upper === void 0 || (E.upperOpen ? It(w, E.upper) < 0 : It(w, E.upper) <= 0));
        var M, I;
      }
      function Su(w, E, _e, I, B, W) {
        if (!_e || _e.length === 0) return w;
        var oe = E.query.index, F = oe.multiEntry, ne = E.query.range, te = I.schema.primaryKey.extractKey, me = oe.extractKey, ce = (oe.lowLevelIndex || oe).extractKey, _e = _e.reduce(function(be, we) {
          var ke = be, Ne = [];
          if (we.type === "add" || we.type === "put") for (var Te = new Dn(), Ie = we.values.length - 1; 0 <= Ie; --Ie) {
            var $e, Ve = we.values[Ie], rt = te(Ve);
            Te.hasKey(rt) || ($e = me(Ve), (F && c($e) ? $e.some(function(tt) {
              return Rl(tt, ne);
            }) : Rl($e, ne)) && (Te.addKey(rt), Ne.push(Ve)));
          }
          switch (we.type) {
            case "add":
              var lt = new Dn().addKeys(E.values ? be.map(function(ht) {
                return te(ht);
              }) : be), ke = be.concat(E.values ? Ne.filter(function(ht) {
                return ht = te(ht), !lt.hasKey(ht) && (lt.addKey(ht), !0);
              }) : Ne.map(function(ht) {
                return te(ht);
              }).filter(function(ht) {
                return !lt.hasKey(ht) && (lt.addKey(ht), !0);
              }));
              break;
            case "put":
              var Ge = new Dn().addKeys(we.values.map(function(ht) {
                return te(ht);
              }));
              ke = be.filter(function(ht) {
                return !Ge.hasKey(E.values ? te(ht) : ht);
              }).concat(E.values ? Ne : Ne.map(function(ht) {
                return te(ht);
              }));
              break;
            case "delete":
              var st = new Dn().addKeys(we.keys);
              ke = be.filter(function(ht) {
                return !st.hasKey(E.values ? te(ht) : ht);
              });
              break;
            case "deleteRange":
              var ut = we.range;
              ke = be.filter(function(ht) {
                return !Rl(te(ht), ut);
              });
          }
          return ke;
        }, w);
        return _e === w ? w : (_e.sort(function(be, we) {
          return It(ce(be), ce(we)) || It(te(be), te(we));
        }), E.limit && E.limit < 1 / 0 && (_e.length > E.limit ? _e.length = E.limit : w.length === E.limit && _e.length < E.limit && (B.dirty = !0)), W ? Object.freeze(_e) : _e);
      }
      function jo(w, E) {
        return It(w.lower, E.lower) === 0 && It(w.upper, E.upper) === 0 && !!w.lowerOpen == !!E.lowerOpen && !!w.upperOpen == !!E.upperOpen;
      }
      function Ol(w, E) {
        return (function(M, I, B, W) {
          if (M === void 0) return I !== void 0 ? -1 : 0;
          if (I === void 0) return 1;
          if ((I = It(M, I)) === 0) {
            if (B && W) return 0;
            if (B) return 1;
            if (W) return -1;
          }
          return I;
        })(w.lower, E.lower, w.lowerOpen, E.lowerOpen) <= 0 && 0 <= (function(M, I, B, W) {
          if (M === void 0) return I !== void 0 ? 1 : 0;
          if (I === void 0) return -1;
          if ((I = It(M, I)) === 0) {
            if (B && W) return 0;
            if (B) return -1;
            if (W) return 1;
          }
          return I;
        })(w.upper, E.upper, w.upperOpen, E.upperOpen);
      }
      function um(w, E, M, I) {
        w.subscribers.add(M), I.addEventListener("abort", function() {
          var B, W;
          w.subscribers.delete(M), w.subscribers.size === 0 && (B = w, W = E, setTimeout(function() {
            B.subscribers.size === 0 && he(W, B);
          }, 3e3));
        });
      }
      var Cu = { stack: "dbcore", level: 0, name: "Cache", create: function(w) {
        var E = w.schema.name;
        return r(r({}, w), { transaction: function(M, I, B) {
          var W, oe, F = w.transaction(M, I, B);
          return I === "readwrite" && (oe = (W = new AbortController()).signal, B = function(ne) {
            return function() {
              if (W.abort(), I === "readwrite") {
                for (var te = /* @__PURE__ */ new Set(), me = 0, ce = M; me < ce.length; me++) {
                  var _e = ce[me], be = qs["idb://".concat(E, "/").concat(_e)];
                  if (be) {
                    var we = w.table(_e), ke = be.optimisticOps.filter(function(ht) {
                      return ht.trans === F;
                    });
                    if (F._explicit && ne && F.mutatedParts) for (var Ne = 0, Te = Object.values(be.queries.query); Ne < Te.length; Ne++) for (var Ie = 0, $e = (lt = Te[Ne]).slice(); Ie < $e.length; Ie++) Mc((Ge = $e[Ie]).obsSet, F.mutatedParts) && (he(lt, Ge), Ge.subscribers.forEach(function(ht) {
                      return te.add(ht);
                    }));
                    else if (0 < ke.length) {
                      be.optimisticOps = be.optimisticOps.filter(function(ht) {
                        return ht.trans !== F;
                      });
                      for (var Ve = 0, rt = Object.values(be.queries.query); Ve < rt.length; Ve++) for (var lt, Ge, st, ut = 0, tt = (lt = rt[Ve]).slice(); ut < tt.length; ut++) (Ge = tt[ut]).res != null && F.mutatedParts && (ne && !Ge.dirty ? (st = Object.isFrozen(Ge.res), st = Su(Ge.res, Ge.req, ke, we, Ge, st), Ge.dirty ? (he(lt, Ge), Ge.subscribers.forEach(function(ht) {
                        return te.add(ht);
                      })) : st !== Ge.res && (Ge.res = st, Ge.promise = ct.resolve({ result: st }))) : (Ge.dirty && he(lt, Ge), Ge.subscribers.forEach(function(ht) {
                        return te.add(ht);
                      })));
                    }
                  }
                }
                te.forEach(function(ht) {
                  return ht();
                });
              }
            };
          }, F.addEventListener("abort", B(!1), { signal: oe }), F.addEventListener("error", B(!1), { signal: oe }), F.addEventListener("complete", B(!0), { signal: oe })), F;
        }, table: function(M) {
          var I = w.table(M), B = I.schema.primaryKey;
          return r(r({}, I), { mutate: function(W) {
            var oe = it.trans;
            if (B.outbound || oe.db._options.cache === "disabled" || oe.explicit || oe.idbtrans.mode !== "readwrite") return I.mutate(W);
            var F = qs["idb://".concat(E, "/").concat(M)];
            return F ? (oe = I.mutate(W), W.type !== "add" && W.type !== "put" || !(50 <= W.values.length || wu(B, W).some(function(ne) {
              return ne == null;
            })) ? (F.optimisticOps.push(W), W.mutatedParts && Bs(W.mutatedParts), oe.then(function(ne) {
              0 < ne.numFailures && (he(F.optimisticOps, W), (ne = No(0, W, ne)) && F.optimisticOps.push(ne), W.mutatedParts && Bs(W.mutatedParts));
            }), oe.catch(function() {
              he(F.optimisticOps, W), W.mutatedParts && Bs(W.mutatedParts);
            })) : oe.then(function(ne) {
              var te = No(0, r(r({}, W), { values: W.values.map(function(me, ce) {
                var _e;
                return ne.failures[ce] ? me : (me = (_e = B.keyPath) !== null && _e !== void 0 && _e.includes(".") ? de(me) : r({}, me), P(me, B.keyPath, ne.results[ce]), me);
              }) }), ne);
              F.optimisticOps.push(te), queueMicrotask(function() {
                return W.mutatedParts && Bs(W.mutatedParts);
              });
            }), oe) : I.mutate(W);
          }, query: function(W) {
            if (!hs(it, I) || !Zr("query", W)) return I.query(W);
            var oe = ((te = it.trans) === null || te === void 0 ? void 0 : te.db._options.cache) === "immutable", ce = it, F = ce.requery, ne = ce.signal, te = (function(we, ke, Ne, Te) {
              var Ie = qs["idb://".concat(we, "/").concat(ke)];
              if (!Ie) return [];
              if (!(ke = Ie.queries[Ne])) return [null, !1, Ie, null];
              var $e = ke[(Te.query ? Te.query.index.name : null) || ""];
              if (!$e) return [null, !1, Ie, null];
              switch (Ne) {
                case "query":
                  var Ve = $e.find(function(rt) {
                    return rt.req.limit === Te.limit && rt.req.values === Te.values && jo(rt.req.query.range, Te.query.range);
                  });
                  return Ve ? [Ve, !0, Ie, $e] : [$e.find(function(rt) {
                    return ("limit" in rt.req ? rt.req.limit : 1 / 0) >= Te.limit && (!Te.values || rt.req.values) && Ol(rt.req.query.range, Te.query.range);
                  }), !1, Ie, $e];
                case "count":
                  return Ve = $e.find(function(rt) {
                    return jo(rt.req.query.range, Te.query.range);
                  }), [Ve, !!Ve, Ie, $e];
              }
            })(E, M, "query", W), me = te[0], ce = te[1], _e = te[2], be = te[3];
            return me && ce ? me.obsSet = W.obsSet : (ce = I.query(W).then(function(we) {
              var ke = we.result;
              if (me && (me.res = ke), oe) {
                for (var Ne = 0, Te = ke.length; Ne < Te; ++Ne) Object.freeze(ke[Ne]);
                Object.freeze(ke);
              } else we.result = de(ke);
              return we;
            }).catch(function(we) {
              return be && me && he(be, me), Promise.reject(we);
            }), me = { obsSet: W.obsSet, promise: ce, subscribers: /* @__PURE__ */ new Set(), type: "query", req: W, dirty: !1 }, be ? be.push(me) : (be = [me], (_e = _e || (qs["idb://".concat(E, "/").concat(M)] = { queries: { query: {}, count: {} }, objs: /* @__PURE__ */ new Map(), optimisticOps: [], unsignaledParts: {} })).queries.query[W.query.index.name || ""] = be)), um(me, be, F, ne), me.promise.then(function(we) {
              return { result: Su(we.result, W, _e == null ? void 0 : _e.optimisticOps, I, me, oe) };
            });
          } });
        } });
      } };
      function zl(w, E) {
        return new Proxy(w, { get: function(M, I, B) {
          return I === "db" ? E : Reflect.get(M, I, B);
        } });
      }
      var Pr = (In.prototype.version = function(w) {
        if (isNaN(w) || w < 0.1) throw new Me.Type("Given version is not a positive number");
        if (w = Math.round(10 * w) / 10, this.idbdb || this._state.isBeingOpened) throw new Me.Schema("Cannot add version when database is open");
        this.verno = Math.max(this.verno, w);
        var E = this._versions, M = E.filter(function(I) {
          return I._cfg.version === w;
        })[0];
        return M || (M = new this.Version(w), E.push(M), E.sort(kl), M.stores({}), this._state.autoSchema = !1, M);
      }, In.prototype._whenReady = function(w) {
        var E = this;
        return this.idbdb && (this._state.openComplete || it.letThrough || this._vip) ? w() : new ct(function(M, I) {
          if (E._state.openComplete) return I(new Me.DatabaseClosed(E._state.dbOpenError));
          if (!E._state.isBeingOpened) {
            if (!E._state.autoOpen) return void I(new Me.DatabaseClosed());
            E.open().catch(Be);
          }
          E._state.dbReadyPromise.then(M, I);
        }).then(w);
      }, In.prototype.use = function(w) {
        var E = w.stack, M = w.create, I = w.level, B = w.name;
        return B && this.unuse({ stack: E, name: B }), w = this._middlewares[E] || (this._middlewares[E] = []), w.push({ stack: E, create: M, level: I ?? 10, name: B }), w.sort(function(W, oe) {
          return W.level - oe.level;
        }), this;
      }, In.prototype.unuse = function(w) {
        var E = w.stack, M = w.name, I = w.create;
        return E && this._middlewares[E] && (this._middlewares[E] = this._middlewares[E].filter(function(B) {
          return I ? B.create !== I : !!M && B.name !== M;
        })), this;
      }, In.prototype.open = function() {
        var w = this;
        return ri(En, function() {
          return vd(w);
        });
      }, In.prototype._close = function() {
        this.on.close.fire(new CustomEvent("close"));
        var w = this._state, E = Ia.indexOf(this);
        if (0 <= E && Ia.splice(E, 1), this.idbdb) {
          try {
            this.idbdb.close();
          } catch {
          }
          this.idbdb = null;
        }
        w.isBeingOpened || (w.dbReadyPromise = new ct(function(M) {
          w.dbReadyResolve = M;
        }), w.openCanceller = new ct(function(M, I) {
          w.cancelOpen = I;
        }));
      }, In.prototype.close = function(M) {
        var E = (M === void 0 ? { disableAutoOpen: !0 } : M).disableAutoOpen, M = this._state;
        E ? (M.isBeingOpened && M.cancelOpen(new Me.DatabaseClosed()), this._close(), M.autoOpen = !1, M.dbOpenError = new Me.DatabaseClosed()) : (this._close(), M.autoOpen = this._options.autoOpen || M.isBeingOpened, M.openComplete = !1, M.dbOpenError = null);
      }, In.prototype.delete = function(w) {
        var E = this;
        w === void 0 && (w = { disableAutoOpen: !0 });
        var M = 0 < arguments.length && typeof arguments[0] != "object", I = this._state;
        return new ct(function(B, W) {
          function oe() {
            E.close(w);
            var F = E._deps.indexedDB.deleteDatabase(E.name);
            F.onsuccess = yn(function() {
              var ne, te, me;
              ne = E._deps, te = E.name, me = ne.indexedDB, ne = ne.IDBKeyRange, Lr(me) || te === Ms || jc(me, ne).delete(te).catch(Be), B();
            }), F.onerror = Li(W), F.onblocked = E._fireOnBlocked;
          }
          if (M) throw new Me.InvalidArgument("Invalid closeOptions argument to db.delete()");
          I.isBeingOpened ? I.dbReadyPromise.then(oe) : oe();
        });
      }, In.prototype.backendDB = function() {
        return this.idbdb;
      }, In.prototype.isOpen = function() {
        return this.idbdb !== null;
      }, In.prototype.hasBeenClosed = function() {
        var w = this._state.dbOpenError;
        return w && w.name === "DatabaseClosed";
      }, In.prototype.hasFailed = function() {
        return this._state.dbOpenError !== null;
      }, In.prototype.dynamicallyOpened = function() {
        return this._state.autoSchema;
      }, Object.defineProperty(In.prototype, "tables", { get: function() {
        var w = this;
        return l(this._allTables).map(function(E) {
          return w._allTables[E];
        });
      }, enumerable: !1, configurable: !0 }), In.prototype.transaction = function() {
        var w = (function(E, M, I) {
          var B = arguments.length;
          if (B < 2) throw new Me.InvalidArgument("Too few arguments");
          for (var W = new Array(B - 1); --B; ) W[B - 1] = arguments[B];
          return I = W.pop(), [E, X(W), I];
        }).apply(this, arguments);
        return this._transaction.apply(this, w);
      }, In.prototype._transaction = function(w, E, M) {
        var I = this, B = it.trans;
        B && B.db === this && w.indexOf("!") === -1 || (B = null);
        var W, oe, F = w.indexOf("?") !== -1;
        w = w.replace("!", "").replace("?", "");
        try {
          if (oe = E.map(function(te) {
            if (te = te instanceof I.Table ? te.name : te, typeof te != "string") throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");
            return te;
          }), w == "r" || w === gi) W = gi;
          else {
            if (w != "rw" && w != Ii) throw new Me.InvalidArgument("Invalid transaction mode: " + w);
            W = Ii;
          }
          if (B) {
            if (B.mode === gi && W === Ii) {
              if (!F) throw new Me.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");
              B = null;
            }
            B && oe.forEach(function(te) {
              if (B && B.storeNames.indexOf(te) === -1) {
                if (!F) throw new Me.SubTransaction("Table " + te + " not included in parent transaction.");
                B = null;
              }
            }), F && B && !B.active && (B = null);
          }
        } catch (te) {
          return B ? B._promise(null, function(me, ce) {
            ce(te);
          }) : sn(te);
        }
        var ne = (function te(me, ce, _e, be, we) {
          return ct.resolve().then(function() {
            var ke = it.transless || it, Ne = me._createTransaction(ce, _e, me._dbSchema, be);
            if (Ne.explicit = !0, ke = { trans: Ne, transless: ke }, be) Ne.idbtrans = be.idbtrans;
            else try {
              Ne.create(), Ne.idbtrans._explicit = !0, me._state.PR1398_maxLoop = 3;
            } catch ($e) {
              return $e.name === Oe.InvalidState && me.isOpen() && 0 < --me._state.PR1398_maxLoop ? (console.warn("Dexie: Need to reopen db"), me.close({ disableAutoOpen: !1 }), me.open().then(function() {
                return te(me, ce, _e, null, we);
              })) : sn($e);
            }
            var Te, Ie = U(we);
            return Ie && Xn(), ke = ct.follow(function() {
              var $e;
              (Te = we.call(Ne, Ne)) && (Ie ? ($e = Tr.bind(null, null), Te.then($e, $e)) : typeof Te.next == "function" && typeof Te.throw == "function" && (Te = ko(Te)));
            }, ke), (Te && typeof Te.then == "function" ? ct.resolve(Te).then(function($e) {
              return Ne.active ? $e : sn(new Me.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"));
            }) : ke.then(function() {
              return Te;
            })).then(function($e) {
              return be && Ne._resolve(), Ne._completion.then(function() {
                return $e;
              });
            }).catch(function($e) {
              return Ne._reject($e), sn($e);
            });
          });
        }).bind(null, this, W, oe, B, M);
        return B ? B._promise(W, ne, "lock") : it.trans ? ri(it.transless, function() {
          return I._whenReady(ne);
        }) : this._whenReady(ne);
      }, In.prototype.table = function(w) {
        if (!g(this._allTables, w)) throw new Me.InvalidTable("Table ".concat(w, " does not exist"));
        return this._allTables[w];
      }, In);
      function In(w, E) {
        var M = this;
        this._middlewares = {}, this.verno = 0;
        var I = In.dependencies;
        this._options = E = r({ addons: In.addons, autoOpen: !0, indexedDB: I.indexedDB, IDBKeyRange: I.IDBKeyRange, cache: "cloned" }, E), this._deps = { indexedDB: E.indexedDB, IDBKeyRange: E.IDBKeyRange }, I = E.addons, this._dbSchema = {}, this._versions = [], this._storeNames = [], this._allTables = {}, this.idbdb = null, this._novip = this;
        var B, W, oe, F, ne, te = { dbOpenError: null, isBeingOpened: !1, onReadyBeingFired: null, openComplete: !1, dbReadyResolve: Be, dbReadyPromise: null, cancelOpen: Be, openCanceller: null, autoSchema: !0, PR1398_maxLoop: 3, autoOpen: E.autoOpen };
        te.dbReadyPromise = new ct(function(ce) {
          te.dbReadyResolve = ce;
        }), te.openCanceller = new ct(function(ce, _e) {
          te.cancelOpen = _e;
        }), this._state = te, this.name = w, this.on = Os(this, "populate", "blocked", "versionchange", "close", { ready: [Fn, Be] }), this.once = function(ce, _e) {
          var be = function() {
            for (var we = [], ke = 0; ke < arguments.length; ke++) we[ke] = arguments[ke];
            M.on(ce).unsubscribe(be), _e.apply(M, we);
          };
          return M.on(ce, be);
        }, this.on.ready.subscribe = A(this.on.ready.subscribe, function(ce) {
          return function(_e, be) {
            In.vip(function() {
              var we, ke = M._state;
              ke.openComplete ? (ke.dbOpenError || ct.resolve().then(_e), be && ce(_e)) : ke.onReadyBeingFired ? (ke.onReadyBeingFired.push(_e), be && ce(_e)) : (ce(_e), we = M, be || ce(function Ne() {
                we.on.ready.unsubscribe(_e), we.on.ready.unsubscribe(Ne);
              }));
            });
          };
        }), this.Collection = (B = this, cr(hd.prototype, function(Te, Ne) {
          this.db = B;
          var be = wo, we = null;
          if (Ne) try {
            be = Ne();
          } catch (Ie) {
            we = Ie;
          }
          var ke = Te._ctx, Ne = ke.table, Te = Ne.hook.reading.fire;
          this._ctx = { table: Ne, index: ke.index, isPrimKey: !ke.index || Ne.schema.primKey.keyPath && ke.index === Ne.schema.primKey.name, range: be, keysOnly: !1, dir: "next", unique: "", algorithm: null, filter: null, replayFilter: null, justLimit: !0, isMatch: null, offset: 0, limit: 1 / 0, error: we, or: ke.or, valueMapper: Te !== Je ? Te : null };
        })), this.Table = (W = this, cr(ls.prototype, function(ce, _e, be) {
          this.db = W, this._tx = be, this.name = ce, this.schema = _e, this.hook = W._allTables[ce] ? W._allTables[ce].hook : Os(null, { creating: [bt, Be], reading: [ot, Je], updating: [Yn, Be], deleting: [vt, Be] });
        })), this.Transaction = (oe = this, cr(Ec.prototype, function(ce, _e, be, we, ke) {
          var Ne = this;
          ce !== "readonly" && _e.forEach(function(Te) {
            Te = (Te = be[Te]) === null || Te === void 0 ? void 0 : Te.yProps, Te && (_e = _e.concat(Te.map(function(Ie) {
              return Ie.updatesTable;
            })));
          }), this.db = oe, this.mode = ce, this.storeNames = _e, this.schema = be, this.chromeTransactionDurability = we, this.idbtrans = null, this.on = Os(this, "complete", "error", "abort"), this.parent = ke || null, this.active = !0, this._reculock = 0, this._blockedFuncs = [], this._resolve = null, this._reject = null, this._waitingFor = null, this._waitingQueue = null, this._spinCount = 0, this._completion = new ct(function(Te, Ie) {
            Ne._resolve = Te, Ne._reject = Ie;
          }), this._completion.then(function() {
            Ne.active = !1, Ne.on.complete.fire();
          }, function(Te) {
            var Ie = Ne.active;
            return Ne.active = !1, Ne.on.error.fire(Te), Ne.parent ? Ne.parent._reject(Te) : Ie && Ne.idbtrans && Ne.idbtrans.abort(), sn(Te);
          });
        })), this.Version = (F = this, cr(gd.prototype, function(ce) {
          this.db = F, this._cfg = { version: ce, storesSource: null, dbschema: {}, tables: {}, contentUpgrade: null };
        })), this.WhereClause = (ne = this, cr(cs.prototype, function(ce, _e, be) {
          if (this.db = ne, this._ctx = { table: ce, index: _e === ":id" ? null : _e, or: be }, this._cmp = this._ascending = It, this._descending = function(we, ke) {
            return It(ke, we);
          }, this._max = function(we, ke) {
            return 0 < It(we, ke) ? we : ke;
          }, this._min = function(we, ke) {
            return It(we, ke) < 0 ? we : ke;
          }, this._IDBKeyRange = ne._deps.IDBKeyRange, !this._IDBKeyRange) throw new Me.MissingAPI();
        })), this.on("versionchange", function(ce) {
          0 < ce.newVersion ? console.warn("Another connection wants to upgrade database '".concat(M.name, "'. Closing db now to resume the upgrade.")) : console.warn("Another connection wants to delete database '".concat(M.name, "'. Closing db now to resume the delete request.")), M.close({ disableAutoOpen: !1 });
        }), this.on("blocked", function(ce) {
          !ce.newVersion || ce.newVersion < ce.oldVersion ? console.warn("Dexie.delete('".concat(M.name, "') was blocked")) : console.warn("Upgrade '".concat(M.name, "' blocked by other connection holding version ").concat(ce.oldVersion / 10));
        }), this._maxKey = on(E.IDBKeyRange), this._createTransaction = function(ce, _e, be, we) {
          return new M.Transaction(ce, _e, be, M._options.chromeTransactionDurability, we);
        }, this._fireOnBlocked = function(ce) {
          M.on("blocked").fire(ce), Ia.filter(function(_e) {
            return _e.name === M.name && _e !== M && !_e._state.vcFired;
          }).map(function(_e) {
            return _e.on("versionchange").fire(ce);
          });
        }, this.use(xd), this.use(Cu), this.use(zc), this.use(Oc), this.use(_u);
        var me = new Proxy(this, { get: function(ce, _e, be) {
          if (_e === "_vip") return !0;
          if (_e === "table") return function(ke) {
            return zl(M.table(ke), me);
          };
          var we = Reflect.get(ce, _e, be);
          return we instanceof ls ? zl(we, me) : _e === "tables" ? we.map(function(ke) {
            return zl(ke, me);
          }) : _e === "_createTransaction" ? function() {
            return zl(we.apply(this, arguments), me);
          } : we;
        } });
        this.vip = me, I.forEach(function(ce) {
          return ce(M);
        });
      }
      var To, qr = typeof Symbol < "u" && "observable" in Symbol ? Symbol.observable : "@@observable", Dc = (Bi.prototype.subscribe = function(w, E, M) {
        return this._subscribe(w && typeof w != "function" ? w : { next: w, error: E, complete: M });
      }, Bi.prototype[qr] = function() {
        return this;
      }, Bi);
      function Bi(w) {
        this._subscribe = w;
      }
      try {
        To = { indexedDB: o.indexedDB || o.mozIndexedDB || o.webkitIndexedDB || o.msIndexedDB, IDBKeyRange: o.IDBKeyRange || o.webkitIDBKeyRange };
      } catch {
        To = { indexedDB: null, IDBKeyRange: null };
      }
      function Dl(w) {
        var E, M = !1, I = new Dc(function(B) {
          var W = U(w), oe, F = !1, ne = {}, te = {}, me = { get closed() {
            return F;
          }, unsubscribe: function() {
            F || (F = !0, oe && oe.abort(), ce && Ar.storagemutated.unsubscribe(be));
          } };
          B.start && B.start(me);
          var ce = !1, _e = function() {
            return oa(we);
          }, be = function(ke) {
            Eo(ne, ke), Mc(te, ne) && _e();
          }, we = function() {
            var ke, Ne, Te;
            !F && To.indexedDB && (ne = {}, ke = {}, oe && oe.abort(), oe = new AbortController(), Te = (function(Ie) {
              var $e = ra();
              try {
                W && Xn();
                var Ve = bn(w, Ie);
                return Ve = W ? Ve.finally(Tr) : Ve;
              } finally {
                $e && pi();
              }
            })(Ne = { subscr: ke, signal: oe.signal, requery: _e, querier: w, trans: null }), Promise.resolve(Te).then(function(Ie) {
              M = !0, E = Ie, F || Ne.signal.aborted || (ne = {}, (function($e) {
                for (var Ve in $e) if (g($e, Ve)) return;
                return 1;
              })(te = ke) || ce || (Ar(_o, be), ce = !0), oa(function() {
                return !F && B.next && B.next(Ie);
              }));
            }, function(Ie) {
              M = !1, ["DatabaseClosedError", "AbortError"].includes(Ie == null ? void 0 : Ie.name) || F || oa(function() {
                F || B.error && B.error(Ie);
              });
            }));
          };
          return setTimeout(_e, 0), me;
        });
        return I.hasValue = function() {
          return M;
        }, I.getValue = function() {
          return E;
        }, I;
      }
      var Fs = Pr;
      function Ic(w) {
        var E = oi;
        try {
          oi = !0, Ar.storagemutated.fire(w), ds(w, !0);
        } finally {
          oi = E;
        }
      }
      x(Fs, r(r({}, Re), { delete: function(w) {
        return new Fs(w, { addons: [] }).delete();
      }, exists: function(w) {
        return new Fs(w, { addons: [] }).open().then(function(E) {
          return E.close(), !0;
        }).catch("NoSuchDatabaseError", function() {
          return !1;
        });
      }, getDatabaseNames: function(w) {
        try {
          return E = Fs.dependencies, M = E.indexedDB, E = E.IDBKeyRange, (Lr(M) ? Promise.resolve(M.databases()).then(function(I) {
            return I.map(function(B) {
              return B.name;
            }).filter(function(B) {
              return B !== Ms;
            });
          }) : jc(M, E).toCollection().primaryKeys()).then(w);
        } catch {
          return sn(new Me.MissingAPI());
        }
        var E, M;
      }, defineClass: function() {
        return function(w) {
          d(this, w);
        };
      }, ignoreTransaction: function(w) {
        return it.trans ? ri(it.transless, w) : w();
      }, vip: Tc, async: function(w) {
        return function() {
          try {
            var E = ko(w.apply(this, arguments));
            return E && typeof E.then == "function" ? E : ct.resolve(E);
          } catch (M) {
            return sn(M);
          }
        };
      }, spawn: function(w, E, M) {
        try {
          var I = ko(w.apply(M, E || []));
          return I && typeof I.then == "function" ? I : ct.resolve(I);
        } catch (B) {
          return sn(B);
        }
      }, currentTransaction: { get: function() {
        return it.trans || null;
      } }, waitFor: function(w, E) {
        return E = ct.resolve(typeof w == "function" ? Fs.ignoreTransaction(w) : w).timeout(E || 6e4), it.trans ? it.trans.waitFor(E) : E;
      }, Promise: ct, debug: { get: function() {
        return Ht;
      }, set: function(w) {
        Rn(w);
      } }, derive: N, extend: d, props: x, override: A, Events: Os, on: Ar, liveQuery: Dl, extendObservabilitySet: Eo, getByKeyPath: D, setByKeyPath: P, delByKeyPath: function(w, E) {
        typeof E == "string" ? P(w, E, void 0) : "length" in E && [].map.call(E, function(M) {
          P(w, M, void 0);
        });
      }, shallowClone: re, deepClone: de, getObjectDiff: Al, cmp: It, asap: q, minKey: -1 / 0, addons: [], connections: Ia, errnames: Oe, dependencies: To, cache: qs, semVer: "4.2.1", version: "4.2.1".split(".").map(function(w) {
        return parseInt(w);
      }).reduce(function(w, E, M) {
        return w + E / Math.pow(10, 2 * M);
      }) })), Fs.maxKey = on(Fs.dependencies.IDBKeyRange), typeof dispatchEvent < "u" && typeof addEventListener < "u" && (Ar(_o, function(w) {
        oi || (w = new CustomEvent(La, { detail: w }), oi = !0, dispatchEvent(w), oi = !1);
      }), addEventListener(La, function(w) {
        w = w.detail, oi || Ic(w);
      }));
      var Ao, oi = !1, An = function() {
      };
      return typeof BroadcastChannel < "u" && ((An = function() {
        (Ao = new BroadcastChannel(La)).onmessage = function(w) {
          return w.data && Ic(w.data);
        };
      })(), typeof Ao.unref == "function" && Ao.unref(), Ar(_o, function(w) {
        oi || Ao.postMessage(w);
      })), typeof addEventListener < "u" && (addEventListener("pagehide", function(w) {
        if (!Pr.disableBfCache && w.persisted) {
          Ht && console.debug("Dexie: handling persisted pagehide"), Ao != null && Ao.close();
          for (var E = 0, M = Ia; E < M.length; E++) M[E].close({ disableAutoOpen: !1 });
        }
      }), addEventListener("pageshow", function(w) {
        !Pr.disableBfCache && w.persisted && (Ht && console.debug("Dexie: handling persisted pageshow"), An(), Ic({ all: new Dn(-1 / 0, [[]]) }));
      })), ct.rejectionMapper = function(w, E) {
        return !w || w instanceof Y || w instanceof TypeError || w instanceof SyntaxError || !w.name || !Pe[w.name] ? w : (E = new Pe[w.name](E || w.message, w), "stack" in w && C(E, "stack", { get: function() {
          return this.inner.stack;
        } }), E);
      }, Rn(Ht), r(Pr, Object.freeze({ __proto__: null, Dexie: Pr, liveQuery: Dl, Entity: fu, cmp: It, PropModification: ua, replacePrefix: function(w, E) {
        return new ua({ replacePrefix: [w, E] });
      }, add: function(w) {
        return new ua({ add: w });
      }, remove: function(w) {
        return new ua({ remove: w });
      }, default: Pr, RangeSet: Dn, mergeRanges: qa, rangesOverlap: kn }), { default: Pr }), Pr;
    });
  })(Wy)), Wy.exports;
}
var EI = CI();
const T3 = /* @__PURE__ */ bc(EI), fC = Symbol.for("Dexie"), mg = globalThis[fC] || (globalThis[fC] = T3);
if (T3.semVer !== mg.semVer)
  throw new Error(`Two different versions of Dexie loaded in the same app: ${T3.semVer} and ${mg.semVer}`);
const {
  liveQuery: Jte,
  mergeRanges: ene,
  rangesOverlap: tne,
  RangeSet: nne,
  cmp: rne,
  Entity: ine,
  PropModification: ane,
  replacePrefix: sne,
  add: one,
  remove: lne,
  DexieYProvider: une
} = mg;
var Zp = { exports: {} };
/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */
var kI = Zp.exports, dC;
function NI() {
  return dC || (dC = 1, (function(e, t) {
    (function() {
      var n, r = "4.17.21", a = 200, o = "Unsupported core-js use. Try https://npms.io/search?q=ponyfill.", l = "Expected a function", c = "Invalid `variable` option passed into `_.template`", d = "__lodash_hash_undefined__", h = 500, p = "__lodash_placeholder__", g = 1, x = 2, b = 4, C = 1, N = 2, T = 1, j = 2, R = 4, A = 8, z = 16, q = 32, D = 64, P = 128, re = 256, ie = 512, X = 30, K = "...", V = 800, de = 16, H = 1, se = 2, Z = 3, fe = 1 / 0, he = 9007199254740991, ge = 17976931348623157e292, Q = NaN, U = 4294967295, ue = U - 1, Y = U >>> 1, le = [
        ["ary", P],
        ["bind", T],
        ["bindKey", j],
        ["curry", A],
        ["curryRight", z],
        ["flip", ie],
        ["partial", q],
        ["partialRight", D],
        ["rearg", re]
      ], xe = "[object Arguments]", Se = "[object Array]", Oe = "[object AsyncFunction]", qe = "[object Boolean]", Me = "[object Date]", Pe = "[object DOMException]", Re = "[object Error]", Be = "[object Function]", Je = "[object GeneratorFunction]", ot = "[object Map]", We = "[object Number]", bt = "[object Null]", vt = "[object Object]", Yn = "[object Promise]", Mn = "[object Proxy]", Fn = "[object RegExp]", Ht = "[object Set]", Rn = "[object String]", rn = "[object Symbol]", Cn = "[object Undefined]", Wn = "[object WeakMap]", Ue = "[object WeakSet]", Ze = "[object ArrayBuffer]", gt = "[object DataView]", Nt = "[object Float32Array]", Dt = "[object Float64Array]", Un = "[object Int8Array]", $n = "[object Int16Array]", an = "[object Int32Array]", Qt = "[object Uint8Array]", En = "[object Uint8ClampedArray]", it = "[object Uint16Array]", jr = "[object Uint32Array]", lr = /\b__p \+= '';/g, xo = /\b(__p \+=) '' \+/g, ct = /(__e\(.*?\)|\b__t\)) \+\n'';/g, Oa = /&(?:amp|lt|gt|quot|#39);/g, as = /[&<>"']/g, Di = RegExp(Oa.source), js = RegExp(as.source), za = /<%-([\s\S]+?)%>/g, Sc = /<%([\s\S]+?)%>/g, bl = /<%=([\s\S]+?)%>/g, ra = /\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/, pi = /^\w*$/, wl = /[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g, Da = /[\\^$.*+?()[\]{}|]/g, yn = RegExp(Da.source), On = /^\s+/, _l = /\s/, ss = /\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/, Ts = /\{\n\/\* \[wrapped with (.+)\] \*/, As = /,? & /, ia = /[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g, bn = /[()=,{}\[\]\/\s]/, Xn = /\\(\\)?/g, Tr = /\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g, aa = /\w*$/, cu = /^[-+]0x[0-9a-f]+$/i, sa = /^0b[01]+$/i, Sl = /^\[object .+?Constructor\]$/, ri = /^0o[0-7]+$/i, bo = /^(?:0|[1-9]\d*)$/, oa = /[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g, sn = /($^)/, Yr = /['\n\r\u2028\u2029\\]/g, ur = "\\ud800-\\udfff", Qn = "\\u0300-\\u036f", Ia = "\\ufe20-\\ufe2f", Ms = "\\u20d0-\\u20ff", gi = Qn + Ia + Ms, Ii = "\\u2700-\\u27bf", la = "a-z\\xdf-\\xf6\\xf8-\\xff", wo = "\\xac\\xb1\\xd7\\xf7", Rs = "\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf", fu = "\\u2000-\\u206f", It = " \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000", os = "A-Z\\xc0-\\xd6\\xd8-\\xde", ii = "\\ufe0e\\ufe0f", gr = wo + Rs + fu + It, ua = "[']", du = "[" + ur + "]", ca = "[" + gr + "]", ls = "[" + gi + "]", Zt = "\\d+", Os = "[" + Ii + "]", cr = "[" + la + "]", ai = "[^" + ur + gr + Zt + Ii + la + os + "]", us = "\\ud83c[\\udffb-\\udfff]", zs = "(?:" + ls + "|" + us + ")", si = "[^" + ur + "]", Cl = "(?:\\ud83c[\\udde6-\\uddff]){2}", Ds = "[\\ud800-\\udbff][\\udc00-\\udfff]", yi = "[" + os + "]", hd = "\\u200d", Yt = "(?:" + cr + "|" + ai + ")", Cc = "(?:" + yi + "|" + ai + ")", hu = "(?:" + ua + "(?:d|ll|m|re|s|t|ve))?", md = "(?:" + ua + "(?:D|LL|M|RE|S|T|VE))?", Wr = zs + "?", fa = "[" + ii + "]?", vi = "(?:" + hd + "(?:" + [si, Cl, Ds].join("|") + ")" + fa + Wr + ")*", da = "\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])", mu = "\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])", cs = fa + Wr + vi, zn = "(?:" + [Os, Cl, Ds].join("|") + ")" + cs, Li = "(?:" + [si + ls + "?", ls, Cl, Ds, du].join("|") + ")", Is = RegExp(ua, "g"), _o = RegExp(ls, "g"), La = RegExp(us + "(?=" + us + ")|" + Li + cs, "g"), Ar = RegExp([
        yi + "?" + cr + "+" + hu + "(?=" + [ca, yi, "$"].join("|") + ")",
        Cc + "+" + md + "(?=" + [ca, yi + Yt, "$"].join("|") + ")",
        yi + "?" + Yt + "+" + hu,
        yi + "+" + md,
        mu,
        da,
        Zt,
        zn
      ].join("|"), "g"), Ec = RegExp("[" + hd + ur + gi + ii + "]"), Xr = /[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/, ha = [
        "Array",
        "Buffer",
        "DataView",
        "Date",
        "Error",
        "Float32Array",
        "Float64Array",
        "Function",
        "Int8Array",
        "Int16Array",
        "Int32Array",
        "Map",
        "Math",
        "Object",
        "Promise",
        "RegExp",
        "Set",
        "String",
        "Symbol",
        "TypeError",
        "Uint8Array",
        "Uint8ClampedArray",
        "Uint16Array",
        "Uint32Array",
        "WeakMap",
        "_",
        "clearTimeout",
        "isFinite",
        "parseInt",
        "setTimeout"
      ], pu = -1, un = {};
      un[Nt] = un[Dt] = un[Un] = un[$n] = un[an] = un[Qt] = un[En] = un[it] = un[jr] = !0, un[xe] = un[Se] = un[Ze] = un[qe] = un[gt] = un[Me] = un[Re] = un[Be] = un[ot] = un[We] = un[vt] = un[Fn] = un[Ht] = un[Rn] = un[Wn] = !1;
      var on = {};
      on[xe] = on[Se] = on[Ze] = on[gt] = on[qe] = on[Me] = on[Nt] = on[Dt] = on[Un] = on[$n] = on[an] = on[ot] = on[We] = on[vt] = on[Fn] = on[Ht] = on[Rn] = on[rn] = on[Qt] = on[En] = on[it] = on[jr] = !0, on[Re] = on[Be] = on[Wn] = !1;
      var So = {
        // Latin-1 Supplement block.
        : "A",
        : "A",
        : "A",
        : "A",
        : "A",
        : "A",
        : "a",
        : "a",
        : "a",
        : "a",
        : "a",
        : "a",
        : "C",
        : "c",
        : "D",
        : "d",
        : "E",
        : "E",
        : "E",
        : "E",
        : "e",
        : "e",
        : "e",
        : "e",
        : "I",
        : "I",
        : "I",
        : "I",
        : "i",
        : "i",
        : "i",
        : "i",
        : "N",
        : "n",
        : "O",
        : "O",
        : "O",
        : "O",
        : "O",
        : "O",
        : "o",
        : "o",
        : "o",
        : "o",
        : "o",
        : "o",
        : "U",
        : "U",
        : "U",
        : "U",
        : "u",
        : "u",
        : "u",
        : "u",
        : "Y",
        : "y",
        : "y",
        : "Ae",
        : "ae",
        : "Th",
        : "th",
        : "ss",
        // Latin Extended-A block.
        : "A",
        : "A",
        : "A",
        : "a",
        : "a",
        : "a",
        : "C",
        : "C",
        : "C",
        : "C",
        : "c",
        : "c",
        : "c",
        : "c",
        : "D",
        : "D",
        : "d",
        : "d",
        : "E",
        : "E",
        : "E",
        : "E",
        : "E",
        : "e",
        : "e",
        : "e",
        : "e",
        : "e",
        : "G",
        : "G",
        : "G",
        : "G",
        : "g",
        : "g",
        : "g",
        : "g",
        : "H",
        : "H",
        : "h",
        : "h",
        : "I",
        : "I",
        : "I",
        : "I",
        : "I",
        : "i",
        : "i",
        : "i",
        : "i",
        : "i",
        : "J",
        : "j",
        : "K",
        : "k",
        : "k",
        : "L",
        : "L",
        : "L",
        : "L",
        : "L",
        : "l",
        : "l",
        : "l",
        : "l",
        : "l",
        : "N",
        : "N",
        : "N",
        : "N",
        : "n",
        : "n",
        : "n",
        : "n",
        : "O",
        : "O",
        : "O",
        : "o",
        : "o",
        : "o",
        : "R",
        : "R",
        : "R",
        : "r",
        : "r",
        : "r",
        : "S",
        : "S",
        : "S",
        : "S",
        : "s",
        : "s",
        : "s",
        : "s",
        : "T",
        : "T",
        : "T",
        : "t",
        : "t",
        : "t",
        : "U",
        : "U",
        : "U",
        : "U",
        : "U",
        : "U",
        : "u",
        : "u",
        : "u",
        : "u",
        : "u",
        : "u",
        : "W",
        : "w",
        : "Y",
        : "y",
        : "Y",
        : "Z",
        : "Z",
        : "Z",
        : "z",
        : "z",
        : "z",
        : "IJ",
        : "ij",
        : "Oe",
        : "oe",
        : "'n",
        : "s"
      }, El = {
        "&": "&amp;",
        "<": "&lt;",
        ">": "&gt;",
        '"': "&quot;",
        "'": "&#39;"
      }, pd = {
        "&amp;": "&",
        "&lt;": "<",
        "&gt;": ">",
        "&quot;": '"',
        "&#39;": "'"
      }, yr = {
        "\\": "\\",
        "'": "'",
        "\n": "n",
        "\r": "r",
        "\u2028": "u2028",
        "\u2029": "u2029"
      }, Ls = parseFloat, gu = parseInt, Pa = typeof tu == "object" && tu && tu.Object === Object && tu, yu = typeof self == "object" && self && self.Object === Object && self, Zn = Pa || yu || Function("return this")(), kl = t && !t.nodeType && t, Pi = kl && !0 && e && !e.nodeType && e, Nl = Pi && Pi.exports === kl, Co = Nl && Pa.process, Qr = (function() {
        try {
          var F = Pi && Pi.require && Pi.require("util").types;
          return F || Co && Co.binding && Co.binding("util");
        } catch {
        }
      })(), kc = Qr && Qr.isArrayBuffer, jl = Qr && Qr.isDate, Ps = Qr && Qr.isMap, Tl = Qr && Qr.isRegExp, Nc = Qr && Qr.isSet, gd = Qr && Qr.isTypedArray;
      function vr(F, ne, te) {
        switch (te.length) {
          case 0:
            return F.call(ne);
          case 1:
            return F.call(ne, te[0]);
          case 2:
            return F.call(ne, te[0], te[1]);
          case 3:
            return F.call(ne, te[0], te[1], te[2]);
        }
        return F.apply(ne, te);
      }
      function jc(F, ne, te, me) {
        for (var ce = -1, _e = F == null ? 0 : F.length; ++ce < _e; ) {
          var be = F[ce];
          ne(me, be, te(be), F);
        }
        return me;
      }
      function Lr(F, ne) {
        for (var te = -1, me = F == null ? 0 : F.length; ++te < me && ne(F[te], te, F) !== !1; )
          ;
        return F;
      }
      function Tc(F, ne) {
        for (var te = F == null ? 0 : F.length; te-- && ne(F[te], te, F) !== !1; )
          ;
        return F;
      }
      function vu(F, ne) {
        for (var te = -1, me = F == null ? 0 : F.length; ++te < me; )
          if (!ne(F[te], te, F))
            return !1;
        return !0;
      }
      function Dn(F, ne) {
        for (var te = -1, me = F == null ? 0 : F.length, ce = 0, _e = []; ++te < me; ) {
          var be = F[te];
          ne(be, te, F) && (_e[ce++] = be);
        }
        return _e;
      }
      function fs(F, ne) {
        var te = F == null ? 0 : F.length;
        return !!te && ds(F, ne, 0) > -1;
      }
      function qa(F, ne, te) {
        for (var me = -1, ce = F == null ? 0 : F.length; ++me < ce; )
          if (te(ne, F[me]))
            return !0;
        return !1;
      }
      function kn(F, ne) {
        for (var te = -1, me = F == null ? 0 : F.length, ce = Array(me); ++te < me; )
          ce[te] = ne(F[te], te, F);
        return ce;
      }
      function qi(F, ne) {
        for (var te = -1, me = ne.length, ce = F.length; ++te < me; )
          F[ce + te] = ne[te];
        return F;
      }
      function xu(F, ne, te, me) {
        var ce = -1, _e = F == null ? 0 : F.length;
        for (me && _e && (te = F[++ce]); ++ce < _e; )
          te = ne(te, F[ce], ce, F);
        return te;
      }
      function Ac(F, ne, te, me) {
        var ce = F == null ? 0 : F.length;
        for (me && ce && (te = F[--ce]); ce--; )
          te = ne(te, F[ce], ce, F);
        return te;
      }
      function Eo(F, ne) {
        for (var te = -1, me = F == null ? 0 : F.length; ++te < me; )
          if (ne(F[te], te, F))
            return !0;
        return !1;
      }
      var Mc = ma("length");
      function qs(F) {
        return F.split("");
      }
      function Rc(F) {
        return F.match(ia) || [];
      }
      function bu(F, ne, te) {
        var me;
        return te(F, function(ce, _e, be) {
          if (ne(ce, _e, be))
            return me = _e, !1;
        }), me;
      }
      function Bs(F, ne, te, me) {
        for (var ce = F.length, _e = te + (me ? 1 : -1); me ? _e-- : ++_e < ce; )
          if (ne(F[_e], _e, F))
            return _e;
        return -1;
      }
      function ds(F, ne, te) {
        return ne === ne ? Ic(F, ne, te) : Bs(F, vd, te);
      }
      function yd(F, ne, te, me) {
        for (var ce = te - 1, _e = F.length; ++ce < _e; )
          if (me(F[ce], ne))
            return ce;
        return -1;
      }
      function vd(F) {
        return F !== F;
      }
      function ko(F, ne) {
        var te = F == null ? 0 : F.length;
        return te ? _u(F, ne) / te : Q;
      }
      function ma(F) {
        return function(ne) {
          return ne == null ? n : ne[F];
        };
      }
      function Oc(F) {
        return function(ne) {
          return F == null ? n : F[ne];
        };
      }
      function Al(F, ne, te, me, ce) {
        return ce(F, function(_e, be, we) {
          te = me ? (me = !1, _e) : ne(te, _e, be, we);
        }), te;
      }
      function wu(F, ne) {
        var te = F.length;
        for (F.sort(ne); te--; )
          F[te] = F[te].value;
        return F;
      }
      function _u(F, ne) {
        for (var te, me = -1, ce = F.length; ++me < ce; ) {
          var _e = ne(F[me]);
          _e !== n && (te = te === n ? _e : te + _e);
        }
        return te;
      }
      function Ml(F, ne) {
        for (var te = -1, me = Array(F); ++te < F; )
          me[te] = ne(te);
        return me;
      }
      function xd(F, ne) {
        return kn(ne, function(te) {
          return [te, F[te]];
        });
      }
      function hs(F) {
        return F && F.slice(0, w(F) + 1).replace(On, "");
      }
      function Zr(F) {
        return function(ne) {
          return F(ne);
        };
      }
      function zc(F, ne) {
        return kn(ne, function(te) {
          return F[te];
        });
      }
      function No(F, ne) {
        return F.has(ne);
      }
      function Rl(F, ne) {
        for (var te = -1, me = F.length; ++te < me && ds(ne, F[te], 0) > -1; )
          ;
        return te;
      }
      function Su(F, ne) {
        for (var te = F.length; te-- && ds(ne, F[te], 0) > -1; )
          ;
        return te;
      }
      function jo(F, ne) {
        for (var te = F.length, me = 0; te--; )
          F[te] === ne && ++me;
        return me;
      }
      var Ol = Oc(So), um = Oc(El);
      function Cu(F) {
        return "\\" + yr[F];
      }
      function zl(F, ne) {
        return F == null ? n : F[ne];
      }
      function Pr(F) {
        return Ec.test(F);
      }
      function In(F) {
        return Xr.test(F);
      }
      function To(F) {
        for (var ne, te = []; !(ne = F.next()).done; )
          te.push(ne.value);
        return te;
      }
      function qr(F) {
        var ne = -1, te = Array(F.size);
        return F.forEach(function(me, ce) {
          te[++ne] = [ce, me];
        }), te;
      }
      function Dc(F, ne) {
        return function(te) {
          return F(ne(te));
        };
      }
      function Bi(F, ne) {
        for (var te = -1, me = F.length, ce = 0, _e = []; ++te < me; ) {
          var be = F[te];
          (be === ne || be === p) && (F[te] = p, _e[ce++] = te);
        }
        return _e;
      }
      function Dl(F) {
        var ne = -1, te = Array(F.size);
        return F.forEach(function(me) {
          te[++ne] = me;
        }), te;
      }
      function Fs(F) {
        var ne = -1, te = Array(F.size);
        return F.forEach(function(me) {
          te[++ne] = [me, me];
        }), te;
      }
      function Ic(F, ne, te) {
        for (var me = te - 1, ce = F.length; ++me < ce; )
          if (F[me] === ne)
            return me;
        return -1;
      }
      function Ao(F, ne, te) {
        for (var me = te + 1; me--; )
          if (F[me] === ne)
            return me;
        return me;
      }
      function oi(F) {
        return Pr(F) ? M(F) : Mc(F);
      }
      function An(F) {
        return Pr(F) ? I(F) : qs(F);
      }
      function w(F) {
        for (var ne = F.length; ne-- && _l.test(F.charAt(ne)); )
          ;
        return ne;
      }
      var E = Oc(pd);
      function M(F) {
        for (var ne = La.lastIndex = 0; La.test(F); )
          ++ne;
        return ne;
      }
      function I(F) {
        return F.match(La) || [];
      }
      function B(F) {
        return F.match(Ar) || [];
      }
      var W = (function F(ne) {
        ne = ne == null ? Zn : oe.defaults(Zn.Object(), ne, oe.pick(Zn, ha));
        var te = ne.Array, me = ne.Date, ce = ne.Error, _e = ne.Function, be = ne.Math, we = ne.Object, ke = ne.RegExp, Ne = ne.String, Te = ne.TypeError, Ie = te.prototype, $e = _e.prototype, Ve = we.prototype, rt = ne["__core-js_shared__"], lt = $e.toString, Ge = Ve.hasOwnProperty, st = 0, ut = (function() {
          var f = /[^.]+$/.exec(rt && rt.keys && rt.keys.IE_PROTO || "");
          return f ? "Symbol(src)_1." + f : "";
        })(), tt = Ve.toString, ht = lt.call(we), _t = Zn._, Rt = ke(
          "^" + lt.call(Ge).replace(Da, "\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g, "$1.*?") + "$"
        ), Ot = Nl ? ne.Buffer : n, Ln = ne.Symbol, Et = ne.Uint8Array, fr = Ot ? Ot.allocUnsafe : n, Nn = Dc(we.getPrototypeOf, we), Mo = we.create, dr = Ve.propertyIsEnumerable, Br = Ie.splice, Eu = Ln ? Ln.isConcatSpreadable : n, Fr = Ln ? Ln.iterator : n, Us = Ln ? Ln.toStringTag : n, pa = (function() {
          try {
            var f = Ho(we, "defineProperty");
            return f({}, "", {}), f;
          } catch {
          }
        })(), Gg = ne.clearTimeout !== Zn.clearTimeout && ne.clearTimeout, bd = me && me.now !== Zn.Date.now && me.now, Il = ne.setTimeout !== Zn.setTimeout && ne.setTimeout, ku = be.ceil, Lc = be.floor, Pc = we.getOwnPropertySymbols, Vg = Ot ? Ot.isBuffer : n, Fi = ne.isFinite, Nu = Ie.join, ju = Dc(we.keys, we), tr = be.max, xr = be.min, ga = me.now, ya = ne.parseInt, $s = be.random, ms = Ie.reverse, va = Ho(ne, "DataView"), Ui = Ho(ne, "Map"), wd = Ho(ne, "Promise"), Ro = Ho(ne, "Set"), Ll = Ho(ne, "WeakMap"), Tu = Ho(we, "create"), br = Ll && new Ll(), pn = {}, Jt = ti(va), Oo = ti(Ui), xa = ti(wd), cm = ti(Ro), zo = ti(Ll), qc = Ln ? Ln.prototype : n, Au = qc ? qc.valueOf : n, Pl = qc ? qc.toString : n;
        function ee(f) {
          if (ir(f) && !zt(f) && !(f instanceof Lt)) {
            if (f instanceof xi)
              return f;
            if (Ge.call(f, "__wrapped__"))
              return Zd(f);
          }
          return new xi(f);
        }
        var Do = /* @__PURE__ */ (function() {
          function f() {
          }
          return function(v) {
            if (!Gn(v))
              return {};
            if (Mo)
              return Mo(v);
            f.prototype = v;
            var S = new f();
            return f.prototype = n, S;
          };
        })();
        function Io() {
        }
        function xi(f, v) {
          this.__wrapped__ = f, this.__actions__ = [], this.__chain__ = !!v, this.__index__ = 0, this.__values__ = n;
        }
        ee.templateSettings = {
          /**
           * Used to detect `data` property values to be HTML-escaped.
           *
           * @memberOf _.templateSettings
           * @type {RegExp}
           */
          escape: za,
          /**
           * Used to detect code to be evaluated.
           *
           * @memberOf _.templateSettings
           * @type {RegExp}
           */
          evaluate: Sc,
          /**
           * Used to detect `data` property values to inject.
           *
           * @memberOf _.templateSettings
           * @type {RegExp}
           */
          interpolate: bl,
          /**
           * Used to reference the data object in the template text.
           *
           * @memberOf _.templateSettings
           * @type {string}
           */
          variable: "",
          /**
           * Used to import variables into the compiled template.
           *
           * @memberOf _.templateSettings
           * @type {Object}
           */
          imports: {
            /**
             * A reference to the `lodash` function.
             *
             * @memberOf _.templateSettings.imports
             * @type {Function}
             */
            _: ee
          }
        }, ee.prototype = Io.prototype, ee.prototype.constructor = ee, xi.prototype = Do(Io.prototype), xi.prototype.constructor = xi;
        function Lt(f) {
          this.__wrapped__ = f, this.__actions__ = [], this.__dir__ = 1, this.__filtered__ = !1, this.__iteratees__ = [], this.__takeCount__ = U, this.__views__ = [];
        }
        function Hs() {
          var f = new Lt(this.__wrapped__);
          return f.__actions__ = ui(this.__actions__), f.__dir__ = this.__dir__, f.__filtered__ = this.__filtered__, f.__iteratees__ = ui(this.__iteratees__), f.__takeCount__ = this.__takeCount__, f.__views__ = ui(this.__views__), f;
        }
        function Lo() {
          if (this.__filtered__) {
            var f = new Lt(this);
            f.__dir__ = -1, f.__filtered__ = !0;
          } else
            f = this.clone(), f.__dir__ *= -1;
          return f;
        }
        function Gs() {
          var f = this.__wrapped__.value(), v = this.__dir__, S = zt(f), O = v < 0, $ = S ? f.length : 0, ae = Tv(0, $, this.__views__), pe = ae.start, Ce = ae.end, Ae = Ce - pe, Xe = O ? Ce : pe - 1, Qe = this.__iteratees__, et = Qe.length, ft = 0, wt = xr(Ae, this.__takeCount__);
          if (!S || !O && $ == Ae && wt == Ae)
            return Em(f, this.__actions__);
          var At = [];
          e:
            for (; Ae-- && ft < wt; ) {
              Xe += v;
              for (var $t = -1, Mt = f[Xe]; ++$t < et; ) {
                var en = Qe[$t], ln = en.iteratee, Qa = en.type, ea = ln(Mt);
                if (Qa == se)
                  Mt = ea;
                else if (!ea) {
                  if (Qa == H)
                    continue e;
                  break e;
                }
              }
              At[ft++] = Mt;
            }
          return At;
        }
        Lt.prototype = Do(Io.prototype), Lt.prototype.constructor = Lt;
        function Vs(f) {
          var v = -1, S = f == null ? 0 : f.length;
          for (this.clear(); ++v < S; ) {
            var O = f[v];
            this.set(O[0], O[1]);
          }
        }
        function fm() {
          this.__data__ = Tu ? Tu(null) : {}, this.size = 0;
        }
        function Mu(f) {
          var v = this.has(f) && delete this.__data__[f];
          return this.size -= v ? 1 : 0, v;
        }
        function _d(f) {
          var v = this.__data__;
          if (Tu) {
            var S = v[f];
            return S === d ? n : S;
          }
          return Ge.call(v, f) ? v[f] : n;
        }
        function ql(f) {
          var v = this.__data__;
          return Tu ? v[f] !== n : Ge.call(v, f);
        }
        function Ur(f, v) {
          var S = this.__data__;
          return this.size += this.has(f) ? 0 : 1, S[f] = Tu && v === n ? d : v, this;
        }
        Vs.prototype.clear = fm, Vs.prototype.delete = Mu, Vs.prototype.get = _d, Vs.prototype.has = ql, Vs.prototype.set = Ur;
        function ba(f) {
          var v = -1, S = f == null ? 0 : f.length;
          for (this.clear(); ++v < S; ) {
            var O = f[v];
            this.set(O[0], O[1]);
          }
        }
        function Kg() {
          this.__data__ = [], this.size = 0;
        }
        function wv(f) {
          var v = this.__data__, S = ps(v, f);
          if (S < 0)
            return !1;
          var O = v.length - 1;
          return S == O ? v.pop() : Br.call(v, S, 1), --this.size, !0;
        }
        function _v(f) {
          var v = this.__data__, S = ps(v, f);
          return S < 0 ? n : v[S][1];
        }
        function Sv(f) {
          return ps(this.__data__, f) > -1;
        }
        function wr(f, v) {
          var S = this.__data__, O = ps(S, f);
          return O < 0 ? (++this.size, S.push([f, v])) : S[O][1] = v, this;
        }
        ba.prototype.clear = Kg, ba.prototype.delete = wv, ba.prototype.get = _v, ba.prototype.has = Sv, ba.prototype.set = wr;
        function Ba(f) {
          var v = -1, S = f == null ? 0 : f.length;
          for (this.clear(); ++v < S; ) {
            var O = f[v];
            this.set(O[0], O[1]);
          }
        }
        function Bc() {
          this.size = 0, this.__data__ = {
            hash: new Vs(),
            map: new (Ui || ba)(),
            string: new Vs()
          };
        }
        function Fc(f) {
          var v = sf(this, f).delete(f);
          return this.size -= v ? 1 : 0, v;
        }
        function dm(f) {
          return sf(this, f).get(f);
        }
        function Ru(f) {
          return sf(this, f).has(f);
        }
        function Ou(f, v) {
          var S = sf(this, f), O = S.size;
          return S.set(f, v), this.size += S.size == O ? 0 : 1, this;
        }
        Ba.prototype.clear = Bc, Ba.prototype.delete = Fc, Ba.prototype.get = dm, Ba.prototype.has = Ru, Ba.prototype.set = Ou;
        function Bl(f) {
          var v = -1, S = f == null ? 0 : f.length;
          for (this.__data__ = new Ba(); ++v < S; )
            this.add(f[v]);
        }
        function Yg(f) {
          return this.__data__.set(f, d), this;
        }
        function Cv(f) {
          return this.__data__.has(f);
        }
        Bl.prototype.add = Bl.prototype.push = Yg, Bl.prototype.has = Cv;
        function wa(f) {
          var v = this.__data__ = new ba(f);
          this.size = v.size;
        }
        function Fl() {
          this.__data__ = new ba(), this.size = 0;
        }
        function hm(f) {
          var v = this.__data__, S = v.delete(f);
          return this.size = v.size, S;
        }
        function Sd(f) {
          return this.__data__.get(f);
        }
        function Wg(f) {
          return this.__data__.has(f);
        }
        function zu(f, v) {
          var S = this.__data__;
          if (S instanceof ba) {
            var O = S.__data__;
            if (!Ui || O.length < a - 1)
              return O.push([f, v]), this.size = ++S.size, this;
            S = this.__data__ = new Ba(O);
          }
          return S.set(f, v), this.size = S.size, this;
        }
        wa.prototype.clear = Fl, wa.prototype.delete = hm, wa.prototype.get = Sd, wa.prototype.has = Wg, wa.prototype.set = zu;
        function Cd(f, v) {
          var S = zt(f), O = !S && Wl(f), $ = !S && !O && Qo(f), ae = !S && !O && !$ && Zo(f), pe = S || O || $ || ae, Ce = pe ? Ml(f.length, Ne) : [], Ae = Ce.length;
          for (var Xe in f)
            (v || Ge.call(f, Xe)) && !(pe && // Safari 9 has enumerable `arguments.length` in strict mode.
            (Xe == "length" || // Node.js 0.10 has enumerable non-index properties on buffers.
            $ && (Xe == "offset" || Xe == "parent") || // PhantomJS 2 has enumerable non-index properties on typed arrays.
            ae && (Xe == "buffer" || Xe == "byteLength" || Xe == "byteOffset") || // Skip index properties.
            Ka(Xe, Ae))) && Ce.push(Xe);
          return Ce;
        }
        function Uc(f) {
          var v = f.length;
          return v ? f[Uu(0, v - 1)] : n;
        }
        function Ed(f, v) {
          return mf(ui(f), Ua(v, 0, f.length));
        }
        function Xg(f) {
          return mf(ui(f));
        }
        function kd(f, v, S) {
          (S !== n && !Qi(f[v], S) || S === n && !(v in f)) && $i(f, v, S);
        }
        function Fa(f, v, S) {
          var O = f[v];
          (!(Ge.call(f, v) && Qi(O, S)) || S === n && !(v in f)) && $i(f, v, S);
        }
        function ps(f, v) {
          for (var S = f.length; S--; )
            if (Qi(f[S][0], v))
              return S;
          return -1;
        }
        function Qg(f, v, S, O) {
          return gs(f, function($, ae, pe) {
            v(O, $, S($), pe);
          }), O;
        }
        function mm(f, v) {
          return f && Ea(v, Rr(v), f);
        }
        function Du(f, v) {
          return f && Ea(v, Ti(v), f);
        }
        function $i(f, v, S) {
          v == "__proto__" && pa ? pa(f, v, {
            configurable: !0,
            enumerable: !0,
            value: S,
            writable: !0
          }) : f[v] = S;
        }
        function Iu(f, v) {
          for (var S = -1, O = v.length, $ = te(O), ae = f == null; ++S < O; )
            $[S] = ae ? n : Jo(f, v[S]);
          return $;
        }
        function Ua(f, v, S) {
          return f === f && (S !== n && (f = f <= S ? f : S), v !== n && (f = f >= v ? f : v)), f;
        }
        function li(f, v, S, O, $, ae) {
          var pe, Ce = v & g, Ae = v & x, Xe = v & b;
          if (S && (pe = $ ? S(f, O, $, ae) : S(f)), pe !== n)
            return pe;
          if (!Gn(f))
            return f;
          var Qe = zt(f);
          if (Qe) {
            if (pe = m0(f), !Ce)
              return ui(f, pe);
          } else {
            var et = Hr(f), ft = et == Be || et == Je;
            if (Qo(f))
              return jm(f, Ce);
            if (et == vt || et == xe || ft && !$) {
              if (pe = Ae || ft ? {} : Um(f), !Ce)
                return Ae ? u0(f, Du(pe, f)) : l0(f, mm(pe, f));
            } else {
              if (!on[et])
                return $ ? f : {};
              pe = p0(f, et, Ce);
            }
          }
          ae || (ae = new wa());
          var wt = ae.get(f);
          if (wt)
            return wt;
          ae.set(f, pe), Af(f) ? f.forEach(function(Mt) {
            pe.add(li(Mt, v, S, Mt, f, ae));
          }) : Q0(f) && f.forEach(function(Mt, en) {
            pe.set(en, li(Mt, v, S, en, f, ae));
          });
          var At = Xe ? Ae ? Fm : Hd : Ae ? Ti : Rr, $t = Qe ? n : At(f);
          return Lr($t || f, function(Mt, en) {
            $t && (en = Mt, Mt = f[en]), Fa(pe, en, li(Mt, v, S, en, f, ae));
          }), pe;
        }
        function Zg(f) {
          var v = Rr(f);
          return function(S) {
            return Po(S, f, v);
          };
        }
        function Po(f, v, S) {
          var O = S.length;
          if (f == null)
            return !O;
          for (f = we(f); O--; ) {
            var $ = S[O], ae = v[$], pe = f[$];
            if (pe === n && !($ in f) || !ae(pe))
              return !1;
          }
          return !0;
        }
        function pm(f, v, S) {
          if (typeof f != "function")
            throw new Te(l);
          return hf(function() {
            f.apply(n, S);
          }, v);
        }
        function _a(f, v, S, O) {
          var $ = -1, ae = fs, pe = !0, Ce = f.length, Ae = [], Xe = v.length;
          if (!Ce)
            return Ae;
          S && (v = kn(v, Zr(S))), O ? (ae = qa, pe = !1) : v.length >= a && (ae = No, pe = !1, v = new Bl(v));
          e:
            for (; ++$ < Ce; ) {
              var Qe = f[$], et = S == null ? Qe : S(Qe);
              if (Qe = O || Qe !== 0 ? Qe : 0, pe && et === et) {
                for (var ft = Xe; ft--; )
                  if (v[ft] === et)
                    continue e;
                Ae.push(Qe);
              } else ae(v, et, O) || Ae.push(Qe);
            }
          return Ae;
        }
        var gs = Rm(Ha), Nd = Rm(Td, !0);
        function qo(f, v) {
          var S = !0;
          return gs(f, function(O, $, ae) {
            return S = !!v(O, $, ae), S;
          }), S;
        }
        function $a(f, v, S) {
          for (var O = -1, $ = f.length; ++O < $; ) {
            var ae = f[O], pe = v(ae);
            if (pe != null && (Ce === n ? pe === pe && !ji(pe) : S(pe, Ce)))
              var Ce = pe, Ae = ae;
          }
          return Ae;
        }
        function $c(f, v, S, O) {
          var $ = f.length;
          for (S = Tt(S), S < 0 && (S = -S > $ ? 0 : $ + S), O = O === n || O > $ ? $ : Tt(O), O < 0 && (O += $), O = S > O ? 0 : Np(O); S < O; )
            f[S++] = v;
          return f;
        }
        function jd(f, v) {
          var S = [];
          return gs(f, function(O, $, ae) {
            v(O, $, ae) && S.push(O);
          }), S;
        }
        function Cr(f, v, S, O, $) {
          var ae = -1, pe = f.length;
          for (S || (S = Hm), $ || ($ = []); ++ae < pe; ) {
            var Ce = f[ae];
            v > 0 && S(Ce) ? v > 1 ? Cr(Ce, v - 1, S, O, $) : qi($, Ce) : O || ($[$.length] = Ce);
          }
          return $;
        }
        var Ul = Om(), Lu = Om(!0);
        function Ha(f, v) {
          return f && Ul(f, v, Rr);
        }
        function Td(f, v) {
          return f && Lu(f, v, Rr);
        }
        function Ks(f, v) {
          return Dn(v, function(S) {
            return Zi(f[S]);
          });
        }
        function ys(f, v) {
          v = Ki(v, f);
          for (var S = 0, O = v.length; f != null && S < O; )
            f = f[_i(v[S++])];
          return S && S == O ? f : n;
        }
        function gm(f, v, S) {
          var O = v(f);
          return zt(f) ? O : qi(O, S(f));
        }
        function $r(f) {
          return f == null ? f === n ? Cn : bt : Us && Us in we(f) ? of(f) : Vm(f);
        }
        function Hc(f, v) {
          return f > v;
        }
        function Hi(f, v) {
          return f != null && Ge.call(f, v);
        }
        function Sa(f, v) {
          return f != null && v in we(f);
        }
        function Bo(f, v, S) {
          return f >= xr(v, S) && f < tr(v, S);
        }
        function Gc(f, v, S) {
          for (var O = S ? qa : fs, $ = f[0].length, ae = f.length, pe = ae, Ce = te(ae), Ae = 1 / 0, Xe = []; pe--; ) {
            var Qe = f[pe];
            pe && v && (Qe = kn(Qe, Zr(v))), Ae = xr(Qe.length, Ae), Ce[pe] = !S && (v || $ >= 120 && Qe.length >= 120) ? new Bl(pe && Qe) : n;
          }
          Qe = f[0];
          var et = -1, ft = Ce[0];
          e:
            for (; ++et < $ && Xe.length < Ae; ) {
              var wt = Qe[et], At = v ? v(wt) : wt;
              if (wt = S || wt !== 0 ? wt : 0, !(ft ? No(ft, At) : O(Xe, At, S))) {
                for (pe = ae; --pe; ) {
                  var $t = Ce[pe];
                  if (!($t ? No($t, At) : O(f[pe], At, S)))
                    continue e;
                }
                ft && ft.push(At), Xe.push(wt);
              }
            }
          return Xe;
        }
        function Jg(f, v, S, O) {
          return Ha(f, function($, ae, pe) {
            v(O, S($), ae, pe);
          }), O;
        }
        function Ca(f, v, S) {
          v = Ki(v, f), f = ff(f, v);
          var O = f == null ? f : f[_i(qn(v))];
          return O == null ? n : vr(O, f, S);
        }
        function bi(f) {
          return ir(f) && $r(f) == xe;
        }
        function hr(f) {
          return ir(f) && $r(f) == Ze;
        }
        function Ad(f) {
          return ir(f) && $r(f) == Me;
        }
        function Gi(f, v, S, O, $) {
          return f === v ? !0 : f == null || v == null || !ir(f) && !ir(v) ? f !== f && v !== v : Pt(f, v, S, O, Gi, $);
        }
        function Pt(f, v, S, O, $, ae) {
          var pe = zt(f), Ce = zt(v), Ae = pe ? Se : Hr(f), Xe = Ce ? Se : Hr(v);
          Ae = Ae == xe ? vt : Ae, Xe = Xe == xe ? vt : Xe;
          var Qe = Ae == vt, et = Xe == vt, ft = Ae == Xe;
          if (ft && Qo(f)) {
            if (!Qo(v))
              return !1;
            pe = !0, Qe = !1;
          }
          if (ft && !Qe)
            return ae || (ae = new wa()), pe || Zo(f) ? rf(f, v, S, O, $, ae) : h0(f, v, Ae, S, O, $, ae);
          if (!(S & C)) {
            var wt = Qe && Ge.call(f, "__wrapped__"), At = et && Ge.call(v, "__wrapped__");
            if (wt || At) {
              var $t = wt ? f.value() : f, Mt = At ? v.value() : v;
              return ae || (ae = new wa()), $($t, Mt, S, O, ae);
            }
          }
          return ft ? (ae || (ae = new wa()), Bm(f, v, S, O, $, ae)) : !1;
        }
        function wn(f) {
          return ir(f) && Hr(f) == ot;
        }
        function nr(f, v, S, O) {
          var $ = S.length, ae = $, pe = !O;
          if (f == null)
            return !ae;
          for (f = we(f); $--; ) {
            var Ce = S[$];
            if (pe && Ce[2] ? Ce[1] !== f[Ce[0]] : !(Ce[0] in f))
              return !1;
          }
          for (; ++$ < ae; ) {
            Ce = S[$];
            var Ae = Ce[0], Xe = f[Ae], Qe = Ce[1];
            if (pe && Ce[2]) {
              if (Xe === n && !(Ae in f))
                return !1;
            } else {
              var et = new wa();
              if (O)
                var ft = O(Xe, Qe, Ae, f, v, et);
              if (!(ft === n ? Gi(Qe, Xe, C | N, O, et) : ft))
                return !1;
            }
          }
          return !0;
        }
        function Vc(f) {
          if (!Gn(f) || g0(f))
            return !1;
          var v = Zi(f) ? Rt : Sl;
          return v.test(ti(f));
        }
        function Pu(f) {
          return ir(f) && $r(f) == Fn;
        }
        function $l(f) {
          return ir(f) && Hr(f) == Ht;
        }
        function Md(f) {
          return ir(f) && fh(f.length) && !!un[$r(f)];
        }
        function qu(f) {
          return typeof f == "function" ? f : f == null ? fi : typeof f == "object" ? zt(f) ? ym(f[0], f[1]) : Od(f) : J(f);
        }
        function Fo(f) {
          if (!Ku(f))
            return ju(f);
          var v = [];
          for (var S in we(f))
            Ge.call(f, S) && S != "constructor" && v.push(S);
          return v;
        }
        function Ev(f) {
          if (!Gn(f))
            return Ws(f);
          var v = Ku(f), S = [];
          for (var O in f)
            O == "constructor" && (v || !Ge.call(f, O)) || S.push(O);
          return S;
        }
        function Hn(f, v) {
          return f < v;
        }
        function Rd(f, v) {
          var S = -1, O = Ni(f) ? te(f.length) : [];
          return gs(f, function($, ae, pe) {
            O[++S] = v($, ae, pe);
          }), O;
        }
        function Od(f) {
          var v = Gd(f);
          return v.length == 1 && v[0][2] ? Xd(v[0][0], v[0][1]) : function(S) {
            return S === f || nr(S, f, v);
          };
        }
        function ym(f, v) {
          return uf(f) && xs(v) ? Xd(_i(f), v) : function(S) {
            var O = Jo(S, f);
            return O === n && O === v ? Tp(S, f) : Gi(v, O, C | N);
          };
        }
        function Kc(f, v, S, O, $) {
          f !== v && Ul(v, function(ae, pe) {
            if ($ || ($ = new wa()), Gn(ae))
              kv(f, v, pe, S, Kc, O, $);
            else {
              var Ce = O ? O(jn(f, pe), ae, pe + "", f, v, $) : n;
              Ce === n && (Ce = ae), kd(f, pe, Ce);
            }
          }, Ti);
        }
        function kv(f, v, S, O, $, ae, pe) {
          var Ce = jn(f, S), Ae = jn(v, S), Xe = pe.get(Ae);
          if (Xe) {
            kd(f, S, Xe);
            return;
          }
          var Qe = ae ? ae(Ce, Ae, S + "", f, v, pe) : n, et = Qe === n;
          if (et) {
            var ft = zt(Ae), wt = !ft && Qo(Ae), At = !ft && !wt && Zo(Ae);
            Qe = Ae, ft || wt || At ? zt(Ce) ? Qe = Ce : pr(Ce) ? Qe = ui(Ce) : wt ? (et = !1, Qe = jm(Ae, !0)) : At ? (et = !1, Qe = Tm(Ae, !0)) : Qe = [] : jf(Ae) || Wl(Ae) ? (Qe = Ce, Wl(Ce) ? Qe = dh(Ce) : (!Gn(Ce) || Zi(Ce)) && (Qe = Um(Ae))) : et = !1;
          }
          et && (pe.set(Ae, Qe), $(Qe, Ae, O, ae, pe), pe.delete(Ae)), kd(f, S, Qe);
        }
        function zd(f, v) {
          var S = f.length;
          if (S)
            return v += v < 0 ? S : 0, Ka(v, S) ? f[v] : n;
        }
        function Dd(f, v, S) {
          v.length ? v = kn(v, function(ae) {
            return zt(ae) ? function(pe) {
              return ys(pe, ae.length === 1 ? ae[0] : ae);
            } : ae;
          }) : v = [fi];
          var O = -1;
          v = kn(v, Zr(Ct()));
          var $ = Rd(f, function(ae, pe, Ce) {
            var Ae = kn(v, function(Xe) {
              return Xe(ae);
            });
            return { criteria: Ae, index: ++O, value: ae };
          });
          return wu($, function(ae, pe) {
            return o0(ae, pe, S);
          });
        }
        function vm(f, v) {
          return Jr(f, v, function(S, O) {
            return Tp(f, O);
          });
        }
        function Jr(f, v, S) {
          for (var O = -1, $ = v.length, ae = {}; ++O < $; ) {
            var pe = v[O], Ce = ys(f, pe);
            S(Ce, pe) && $u(ae, Ki(pe, f), Ce);
          }
          return ae;
        }
        function mr(f) {
          return function(v) {
            return ys(v, f);
          };
        }
        function Bu(f, v, S, O) {
          var $ = O ? yd : ds, ae = -1, pe = v.length, Ce = f;
          for (f === v && (v = ui(v)), S && (Ce = kn(f, Zr(S))); ++ae < pe; )
            for (var Ae = 0, Xe = v[ae], Qe = S ? S(Xe) : Xe; (Ae = $(Ce, Qe, Ae, O)) > -1; )
              Ce !== f && Br.call(Ce, Ae, 1), Br.call(f, Ae, 1);
          return f;
        }
        function Fu(f, v) {
          for (var S = f ? v.length : 0, O = S - 1; S--; ) {
            var $ = v[S];
            if (S == O || $ !== ae) {
              var ae = $;
              Ka($) ? Br.call(f, $, 1) : Yc(f, $);
            }
          }
          return f;
        }
        function Uu(f, v) {
          return f + Lc($s() * (v - f + 1));
        }
        function xm(f, v, S, O) {
          for (var $ = -1, ae = tr(ku((v - f) / (S || 1)), 0), pe = te(ae); ae--; )
            pe[O ? ae : ++$] = f, f += S;
          return pe;
        }
        function Ga(f, v) {
          var S = "";
          if (!f || v < 1 || v > he)
            return S;
          do
            v % 2 && (S += f), v = Lc(v / 2), v && (f += f);
          while (v);
          return S;
        }
        function qt(f, v) {
          return Qd(Km(f, v, fi), f + "");
        }
        function bm(f) {
          return Uc(oc(f));
        }
        function wm(f, v) {
          var S = oc(f);
          return mf(S, Ua(v, 0, S.length));
        }
        function $u(f, v, S, O) {
          if (!Gn(f))
            return f;
          v = Ki(v, f);
          for (var $ = -1, ae = v.length, pe = ae - 1, Ce = f; Ce != null && ++$ < ae; ) {
            var Ae = _i(v[$]), Xe = S;
            if (Ae === "__proto__" || Ae === "constructor" || Ae === "prototype")
              return f;
            if ($ != pe) {
              var Qe = Ce[Ae];
              Xe = O ? O(Qe, Ae, Ce) : n, Xe === n && (Xe = Gn(Qe) ? Qe : Ka(v[$ + 1]) ? [] : {});
            }
            Fa(Ce, Ae, Xe), Ce = Ce[Ae];
          }
          return f;
        }
        var _m = br ? function(f, v) {
          return br.set(f, v), f;
        } : fi, e0 = pa ? function(f, v) {
          return pa(f, "toString", {
            configurable: !0,
            enumerable: !1,
            value: uc(v),
            writable: !0
          });
        } : fi;
        function t0(f) {
          return mf(oc(f));
        }
        function Vi(f, v, S) {
          var O = -1, $ = f.length;
          v < 0 && (v = -v > $ ? 0 : $ + v), S = S > $ ? $ : S, S < 0 && (S += $), $ = v > S ? 0 : S - v >>> 0, v >>>= 0;
          for (var ae = te($); ++O < $; )
            ae[O] = f[O + v];
          return ae;
        }
        function n0(f, v) {
          var S;
          return gs(f, function(O, $, ae) {
            return S = v(O, $, ae), !S;
          }), !!S;
        }
        function Hu(f, v, S) {
          var O = 0, $ = f == null ? O : f.length;
          if (typeof v == "number" && v === v && $ <= Y) {
            for (; O < $; ) {
              var ae = O + $ >>> 1, pe = f[ae];
              pe !== null && !ji(pe) && (S ? pe <= v : pe < v) ? O = ae + 1 : $ = ae;
            }
            return $;
          }
          return Id(f, v, fi, S);
        }
        function Id(f, v, S, O) {
          var $ = 0, ae = f == null ? 0 : f.length;
          if (ae === 0)
            return 0;
          v = S(v);
          for (var pe = v !== v, Ce = v === null, Ae = ji(v), Xe = v === n; $ < ae; ) {
            var Qe = Lc(($ + ae) / 2), et = S(f[Qe]), ft = et !== n, wt = et === null, At = et === et, $t = ji(et);
            if (pe)
              var Mt = O || At;
            else Xe ? Mt = At && (O || ft) : Ce ? Mt = At && ft && (O || !wt) : Ae ? Mt = At && ft && !wt && (O || !$t) : wt || $t ? Mt = !1 : Mt = O ? et <= v : et < v;
            Mt ? $ = Qe + 1 : ae = Qe;
          }
          return xr(ae, ue);
        }
        function r0(f, v) {
          for (var S = -1, O = f.length, $ = 0, ae = []; ++S < O; ) {
            var pe = f[S], Ce = v ? v(pe) : pe;
            if (!S || !Qi(Ce, Ae)) {
              var Ae = Ce;
              ae[$++] = pe === 0 ? 0 : pe;
            }
          }
          return ae;
        }
        function Sm(f) {
          return typeof f == "number" ? f : ji(f) ? Q : +f;
        }
        function wi(f) {
          if (typeof f == "string")
            return f;
          if (zt(f))
            return kn(f, wi) + "";
          if (ji(f))
            return Pl ? Pl.call(f) : "";
          var v = f + "";
          return v == "0" && 1 / f == -fe ? "-0" : v;
        }
        function Ys(f, v, S) {
          var O = -1, $ = fs, ae = f.length, pe = !0, Ce = [], Ae = Ce;
          if (S)
            pe = !1, $ = qa;
          else if (ae >= a) {
            var Xe = v ? null : f0(f);
            if (Xe)
              return Dl(Xe);
            pe = !1, $ = No, Ae = new Bl();
          } else
            Ae = v ? [] : Ce;
          e:
            for (; ++O < ae; ) {
              var Qe = f[O], et = v ? v(Qe) : Qe;
              if (Qe = S || Qe !== 0 ? Qe : 0, pe && et === et) {
                for (var ft = Ae.length; ft--; )
                  if (Ae[ft] === et)
                    continue e;
                v && Ae.push(et), Ce.push(Qe);
              } else $(Ae, et, S) || (Ae !== Ce && Ae.push(et), Ce.push(Qe));
            }
          return Ce;
        }
        function Yc(f, v) {
          return v = Ki(v, f), f = ff(f, v), f == null || delete f[_i(qn(v))];
        }
        function Cm(f, v, S, O) {
          return $u(f, v, S(ys(f, v)), O);
        }
        function Wc(f, v, S, O) {
          for (var $ = f.length, ae = O ? $ : -1; (O ? ae-- : ++ae < $) && v(f[ae], ae, f); )
            ;
          return S ? Vi(f, O ? 0 : ae, O ? ae + 1 : $) : Vi(f, O ? ae + 1 : 0, O ? $ : ae);
        }
        function Em(f, v) {
          var S = f;
          return S instanceof Lt && (S = S.value()), xu(v, function(O, $) {
            return $.func.apply($.thisArg, qi([O], $.args));
          }, S);
        }
        function Ld(f, v, S) {
          var O = f.length;
          if (O < 2)
            return O ? Ys(f[0]) : [];
          for (var $ = -1, ae = te(O); ++$ < O; )
            for (var pe = f[$], Ce = -1; ++Ce < O; )
              Ce != $ && (ae[$] = _a(ae[$] || pe, f[Ce], v, S));
          return Ys(Cr(ae, 1), v, S);
        }
        function km(f, v, S) {
          for (var O = -1, $ = f.length, ae = v.length, pe = {}; ++O < $; ) {
            var Ce = O < ae ? v[O] : n;
            S(pe, f[O], Ce);
          }
          return pe;
        }
        function Nm(f) {
          return pr(f) ? f : [];
        }
        function Pd(f) {
          return typeof f == "function" ? f : fi;
        }
        function Ki(f, v) {
          return zt(f) ? f : uf(f, v) ? [f] : Ym(gn(f));
        }
        var i0 = qt;
        function Va(f, v, S) {
          var O = f.length;
          return S = S === n ? O : S, !v && S >= O ? f : Vi(f, v, S);
        }
        var Xc = Gg || function(f) {
          return Zn.clearTimeout(f);
        };
        function jm(f, v) {
          if (v)
            return f.slice();
          var S = f.length, O = fr ? fr(S) : new f.constructor(S);
          return f.copy(O), O;
        }
        function Qc(f) {
          var v = new f.constructor(f.byteLength);
          return new Et(v).set(new Et(f)), v;
        }
        function Nv(f, v) {
          var S = v ? Qc(f.buffer) : f.buffer;
          return new f.constructor(S, f.byteOffset, f.byteLength);
        }
        function a0(f) {
          var v = new f.constructor(f.source, aa.exec(f));
          return v.lastIndex = f.lastIndex, v;
        }
        function s0(f) {
          return Au ? we(Au.call(f)) : {};
        }
        function Tm(f, v) {
          var S = v ? Qc(f.buffer) : f.buffer;
          return new f.constructor(S, f.byteOffset, f.length);
        }
        function Am(f, v) {
          if (f !== v) {
            var S = f !== n, O = f === null, $ = f === f, ae = ji(f), pe = v !== n, Ce = v === null, Ae = v === v, Xe = ji(v);
            if (!Ce && !Xe && !ae && f > v || ae && pe && Ae && !Ce && !Xe || O && pe && Ae || !S && Ae || !$)
              return 1;
            if (!O && !ae && !Xe && f < v || Xe && S && $ && !O && !ae || Ce && S && $ || !pe && $ || !Ae)
              return -1;
          }
          return 0;
        }
        function o0(f, v, S) {
          for (var O = -1, $ = f.criteria, ae = v.criteria, pe = $.length, Ce = S.length; ++O < pe; ) {
            var Ae = Am($[O], ae[O]);
            if (Ae) {
              if (O >= Ce)
                return Ae;
              var Xe = S[O];
              return Ae * (Xe == "desc" ? -1 : 1);
            }
          }
          return f.index - v.index;
        }
        function qd(f, v, S, O) {
          for (var $ = -1, ae = f.length, pe = S.length, Ce = -1, Ae = v.length, Xe = tr(ae - pe, 0), Qe = te(Ae + Xe), et = !O; ++Ce < Ae; )
            Qe[Ce] = v[Ce];
          for (; ++$ < pe; )
            (et || $ < ae) && (Qe[S[$]] = f[$]);
          for (; Xe--; )
            Qe[Ce++] = f[$++];
          return Qe;
        }
        function Mm(f, v, S, O) {
          for (var $ = -1, ae = f.length, pe = -1, Ce = S.length, Ae = -1, Xe = v.length, Qe = tr(ae - Ce, 0), et = te(Qe + Xe), ft = !O; ++$ < Qe; )
            et[$] = f[$];
          for (var wt = $; ++Ae < Xe; )
            et[wt + Ae] = v[Ae];
          for (; ++pe < Ce; )
            (ft || $ < ae) && (et[wt + S[pe]] = f[$++]);
          return et;
        }
        function ui(f, v) {
          var S = -1, O = f.length;
          for (v || (v = te(O)); ++S < O; )
            v[S] = f[S];
          return v;
        }
        function Ea(f, v, S, O) {
          var $ = !S;
          S || (S = {});
          for (var ae = -1, pe = v.length; ++ae < pe; ) {
            var Ce = v[ae], Ae = O ? O(S[Ce], f[Ce], Ce, S, f) : n;
            Ae === n && (Ae = f[Ce]), $ ? $i(S, Ce, Ae) : Fa(S, Ce, Ae);
          }
          return S;
        }
        function l0(f, v) {
          return Ea(f, Vd(f), v);
        }
        function u0(f, v) {
          return Ea(f, lf(f), v);
        }
        function Bd(f, v) {
          return function(S, O) {
            var $ = zt(S) ? jc : Qg, ae = v ? v() : {};
            return $(S, f, Ct(O, 2), ae);
          };
        }
        function Uo(f) {
          return qt(function(v, S) {
            var O = -1, $ = S.length, ae = $ > 1 ? S[$ - 1] : n, pe = $ > 2 ? S[2] : n;
            for (ae = f.length > 3 && typeof ae == "function" ? ($--, ae) : n, pe && ei(S[0], S[1], pe) && (ae = $ < 3 ? n : ae, $ = 1), v = we(v); ++O < $; ) {
              var Ce = S[O];
              Ce && f(v, Ce, O, ae);
            }
            return v;
          });
        }
        function Rm(f, v) {
          return function(S, O) {
            if (S == null)
              return S;
            if (!Ni(S))
              return f(S, O);
            for (var $ = S.length, ae = v ? $ : -1, pe = we(S); (v ? ae-- : ++ae < $) && O(pe[ae], ae, pe) !== !1; )
              ;
            return S;
          };
        }
        function Om(f) {
          return function(v, S, O) {
            for (var $ = -1, ae = we(v), pe = O(v), Ce = pe.length; Ce--; ) {
              var Ae = pe[f ? Ce : ++$];
              if (S(ae[Ae], Ae, ae) === !1)
                break;
            }
            return v;
          };
        }
        function zm(f, v, S) {
          var O = v & T, $ = Zc(f);
          function ae() {
            var pe = this && this !== Zn && this instanceof ae ? $ : f;
            return pe.apply(O ? S : this, arguments);
          }
          return ae;
        }
        function Dm(f) {
          return function(v) {
            v = gn(v);
            var S = Pr(v) ? An(v) : n, O = S ? S[0] : v.charAt(0), $ = S ? Va(S, 1).join("") : v.slice(1);
            return O[f]() + $;
          };
        }
        function Hl(f) {
          return function(v) {
            return xu(Cy(lc(v).replace(Is, "")), f, "");
          };
        }
        function Zc(f) {
          return function() {
            var v = arguments;
            switch (v.length) {
              case 0:
                return new f();
              case 1:
                return new f(v[0]);
              case 2:
                return new f(v[0], v[1]);
              case 3:
                return new f(v[0], v[1], v[2]);
              case 4:
                return new f(v[0], v[1], v[2], v[3]);
              case 5:
                return new f(v[0], v[1], v[2], v[3], v[4]);
              case 6:
                return new f(v[0], v[1], v[2], v[3], v[4], v[5]);
              case 7:
                return new f(v[0], v[1], v[2], v[3], v[4], v[5], v[6]);
            }
            var S = Do(f.prototype), O = f.apply(S, v);
            return Gn(O) ? O : S;
          };
        }
        function jv(f, v, S) {
          var O = Zc(f);
          function $() {
            for (var ae = arguments.length, pe = te(ae), Ce = ae, Ae = rr($); Ce--; )
              pe[Ce] = arguments[Ce];
            var Xe = ae < 3 && pe[0] !== Ae && pe[ae - 1] !== Ae ? [] : Bi(pe, Ae);
            if (ae -= Xe.length, ae < S)
              return $d(
                f,
                v,
                Vu,
                $.placeholder,
                n,
                pe,
                Xe,
                n,
                n,
                S - ae
              );
            var Qe = this && this !== Zn && this instanceof $ ? O : f;
            return vr(Qe, this, pe);
          }
          return $;
        }
        function Im(f) {
          return function(v, S, O) {
            var $ = we(v);
            if (!Ni(v)) {
              var ae = Ct(S, 3);
              v = Rr(v), S = function(Ce) {
                return ae($[Ce], Ce, $);
              };
            }
            var pe = f(v, S, O);
            return pe > -1 ? $[ae ? v[pe] : pe] : n;
          };
        }
        function Gu(f) {
          return vs(function(v) {
            var S = v.length, O = S, $ = xi.prototype.thru;
            for (f && v.reverse(); O--; ) {
              var ae = v[O];
              if (typeof ae != "function")
                throw new Te(l);
              if ($ && !pe && Jn(ae) == "wrapper")
                var pe = new xi([], !0);
            }
            for (O = pe ? O : S; ++O < S; ) {
              ae = v[O];
              var Ce = Jn(ae), Ae = Ce == "wrapper" ? af(ae) : n;
              Ae && cf(Ae[0]) && Ae[1] == (P | A | q | re) && !Ae[4].length && Ae[9] == 1 ? pe = pe[Jn(Ae[0])].apply(pe, Ae[3]) : pe = ae.length == 1 && cf(ae) ? pe[Ce]() : pe.thru(ae);
            }
            return function() {
              var Xe = arguments, Qe = Xe[0];
              if (pe && Xe.length == 1 && zt(Qe))
                return pe.plant(Qe).value();
              for (var et = 0, ft = S ? v[et].apply(this, Xe) : Qe; ++et < S; )
                ft = v[et].call(this, ft);
              return ft;
            };
          });
        }
        function Vu(f, v, S, O, $, ae, pe, Ce, Ae, Xe) {
          var Qe = v & P, et = v & T, ft = v & j, wt = v & (A | z), At = v & ie, $t = ft ? n : Zc(f);
          function Mt() {
            for (var en = arguments.length, ln = te(en), Qa = en; Qa--; )
              ln[Qa] = arguments[Qa];
            if (wt)
              var ea = rr(Mt), Za = jo(ln, ea);
            if (O && (ln = qd(ln, O, $, wt)), ae && (ln = Mm(ln, ae, pe, wt)), en -= Za, wt && en < Xe) {
              var kr = Bi(ln, ea);
              return $d(
                f,
                v,
                Vu,
                Mt.placeholder,
                S,
                ln,
                kr,
                Ce,
                Ae,
                Xe - en
              );
            }
            var io = et ? S : this, Ql = ft ? io[f] : f;
            return en = ln.length, Ce ? ln = df(ln, Ce) : At && en > 1 && ln.reverse(), Qe && Ae < en && (ln.length = Ae), this && this !== Zn && this instanceof Mt && (Ql = $t || Zc(Ql)), Ql.apply(io, ln);
          }
          return Mt;
        }
        function Jc(f, v) {
          return function(S, O) {
            return Jg(S, f, v(O), {});
          };
        }
        function ef(f, v) {
          return function(S, O) {
            var $;
            if (S === n && O === n)
              return v;
            if (S !== n && ($ = S), O !== n) {
              if ($ === n)
                return O;
              typeof S == "string" || typeof O == "string" ? (S = wi(S), O = wi(O)) : (S = Sm(S), O = Sm(O)), $ = f(S, O);
            }
            return $;
          };
        }
        function Fd(f) {
          return vs(function(v) {
            return v = kn(v, Zr(Ct())), qt(function(S) {
              var O = this;
              return f(v, function($) {
                return vr($, O, S);
              });
            });
          });
        }
        function $o(f, v) {
          v = v === n ? " " : wi(v);
          var S = v.length;
          if (S < 2)
            return S ? Ga(v, f) : v;
          var O = Ga(v, ku(f / oi(v)));
          return Pr(v) ? Va(An(O), 0, f).join("") : O.slice(0, f);
        }
        function c0(f, v, S, O) {
          var $ = v & T, ae = Zc(f);
          function pe() {
            for (var Ce = -1, Ae = arguments.length, Xe = -1, Qe = O.length, et = te(Qe + Ae), ft = this && this !== Zn && this instanceof pe ? ae : f; ++Xe < Qe; )
              et[Xe] = O[Xe];
            for (; Ae--; )
              et[Xe++] = arguments[++Ce];
            return vr(ft, $ ? S : this, et);
          }
          return pe;
        }
        function Ud(f) {
          return function(v, S, O) {
            return O && typeof O != "number" && ei(v, S, O) && (S = O = n), v = no(v), S === n ? (S = v, v = 0) : S = no(S), O = O === n ? v < S ? 1 : -1 : no(O), xm(v, S, O, f);
          };
        }
        function tf(f) {
          return function(v, S) {
            return typeof v == "string" && typeof S == "string" || (v = Ji(v), S = Ji(S)), f(v, S);
          };
        }
        function $d(f, v, S, O, $, ae, pe, Ce, Ae, Xe) {
          var Qe = v & A, et = Qe ? pe : n, ft = Qe ? n : pe, wt = Qe ? ae : n, At = Qe ? n : ae;
          v |= Qe ? q : D, v &= ~(Qe ? D : q), v & R || (v &= -4);
          var $t = [
            f,
            v,
            $,
            wt,
            et,
            At,
            ft,
            Ce,
            Ae,
            Xe
          ], Mt = S.apply(n, $t);
          return cf(f) && v0(Mt, $t), Mt.placeholder = O, Yu(Mt, f, v);
        }
        function nf(f) {
          var v = be[f];
          return function(S, O) {
            if (S = Ji(S), O = O == null ? 0 : xr(Tt(O), 292), O && Fi(S)) {
              var $ = (gn(S) + "e").split("e"), ae = v($[0] + "e" + (+$[1] + O));
              return $ = (gn(ae) + "e").split("e"), +($[0] + "e" + (+$[1] - O));
            }
            return v(S);
          };
        }
        var f0 = Ro && 1 / Dl(new Ro([, -0]))[1] == fe ? function(f) {
          return new Ro(f);
        } : u;
        function Lm(f) {
          return function(v) {
            var S = Hr(v);
            return S == ot ? qr(v) : S == Ht ? Fs(v) : xd(v, f(v));
          };
        }
        function ci(f, v, S, O, $, ae, pe, Ce) {
          var Ae = v & j;
          if (!Ae && typeof f != "function")
            throw new Te(l);
          var Xe = O ? O.length : 0;
          if (Xe || (v &= -97, O = $ = n), pe = pe === n ? pe : tr(Tt(pe), 0), Ce = Ce === n ? Ce : Tt(Ce), Xe -= $ ? $.length : 0, v & D) {
            var Qe = O, et = $;
            O = $ = n;
          }
          var ft = Ae ? n : af(f), wt = [
            f,
            v,
            S,
            O,
            $,
            Qe,
            et,
            ae,
            pe,
            Ce
          ];
          if (ft && y0(wt, ft), f = wt[0], v = wt[1], S = wt[2], O = wt[3], $ = wt[4], Ce = wt[9] = wt[9] === n ? Ae ? 0 : f.length : tr(wt[9] - Xe, 0), !Ce && v & (A | z) && (v &= -25), !v || v == T)
            var At = zm(f, v, S);
          else v == A || v == z ? At = jv(f, v, Ce) : (v == q || v == (T | q)) && !$.length ? At = c0(f, v, S, O) : At = Vu.apply(n, wt);
          var $t = ft ? _m : v0;
          return Yu($t(At, wt), f, v);
        }
        function Pm(f, v, S, O) {
          return f === n || Qi(f, Ve[S]) && !Ge.call(O, S) ? v : f;
        }
        function qm(f, v, S, O, $, ae) {
          return Gn(f) && Gn(v) && (ae.set(v, f), Kc(f, v, n, qm, ae), ae.delete(v)), f;
        }
        function d0(f) {
          return jf(f) ? n : f;
        }
        function rf(f, v, S, O, $, ae) {
          var pe = S & C, Ce = f.length, Ae = v.length;
          if (Ce != Ae && !(pe && Ae > Ce))
            return !1;
          var Xe = ae.get(f), Qe = ae.get(v);
          if (Xe && Qe)
            return Xe == v && Qe == f;
          var et = -1, ft = !0, wt = S & N ? new Bl() : n;
          for (ae.set(f, v), ae.set(v, f); ++et < Ce; ) {
            var At = f[et], $t = v[et];
            if (O)
              var Mt = pe ? O($t, At, et, v, f, ae) : O(At, $t, et, f, v, ae);
            if (Mt !== n) {
              if (Mt)
                continue;
              ft = !1;
              break;
            }
            if (wt) {
              if (!Eo(v, function(en, ln) {
                if (!No(wt, ln) && (At === en || $(At, en, S, O, ae)))
                  return wt.push(ln);
              })) {
                ft = !1;
                break;
              }
            } else if (!(At === $t || $(At, $t, S, O, ae))) {
              ft = !1;
              break;
            }
          }
          return ae.delete(f), ae.delete(v), ft;
        }
        function h0(f, v, S, O, $, ae, pe) {
          switch (S) {
            case gt:
              if (f.byteLength != v.byteLength || f.byteOffset != v.byteOffset)
                return !1;
              f = f.buffer, v = v.buffer;
            case Ze:
              return !(f.byteLength != v.byteLength || !ae(new Et(f), new Et(v)));
            case qe:
            case Me:
            case We:
              return Qi(+f, +v);
            case Re:
              return f.name == v.name && f.message == v.message;
            case Fn:
            case Rn:
              return f == v + "";
            case ot:
              var Ce = qr;
            case Ht:
              var Ae = O & C;
              if (Ce || (Ce = Dl), f.size != v.size && !Ae)
                return !1;
              var Xe = pe.get(f);
              if (Xe)
                return Xe == v;
              O |= N, pe.set(f, v);
              var Qe = rf(Ce(f), Ce(v), O, $, ae, pe);
              return pe.delete(f), Qe;
            case rn:
              if (Au)
                return Au.call(f) == Au.call(v);
          }
          return !1;
        }
        function Bm(f, v, S, O, $, ae) {
          var pe = S & C, Ce = Hd(f), Ae = Ce.length, Xe = Hd(v), Qe = Xe.length;
          if (Ae != Qe && !pe)
            return !1;
          for (var et = Ae; et--; ) {
            var ft = Ce[et];
            if (!(pe ? ft in v : Ge.call(v, ft)))
              return !1;
          }
          var wt = ae.get(f), At = ae.get(v);
          if (wt && At)
            return wt == v && At == f;
          var $t = !0;
          ae.set(f, v), ae.set(v, f);
          for (var Mt = pe; ++et < Ae; ) {
            ft = Ce[et];
            var en = f[ft], ln = v[ft];
            if (O)
              var Qa = pe ? O(ln, en, ft, v, f, ae) : O(en, ln, ft, f, v, ae);
            if (!(Qa === n ? en === ln || $(en, ln, S, O, ae) : Qa)) {
              $t = !1;
              break;
            }
            Mt || (Mt = ft == "constructor");
          }
          if ($t && !Mt) {
            var ea = f.constructor, Za = v.constructor;
            ea != Za && "constructor" in f && "constructor" in v && !(typeof ea == "function" && ea instanceof ea && typeof Za == "function" && Za instanceof Za) && ($t = !1);
          }
          return ae.delete(f), ae.delete(v), $t;
        }
        function vs(f) {
          return Qd(Km(f, n, Pn), f + "");
        }
        function Hd(f) {
          return gm(f, Rr, Vd);
        }
        function Fm(f) {
          return gm(f, Ti, lf);
        }
        var af = br ? function(f) {
          return br.get(f);
        } : u;
        function Jn(f) {
          for (var v = f.name + "", S = pn[v], O = Ge.call(pn, v) ? S.length : 0; O--; ) {
            var $ = S[O], ae = $.func;
            if (ae == null || ae == f)
              return $.name;
          }
          return v;
        }
        function rr(f) {
          var v = Ge.call(ee, "placeholder") ? ee : f;
          return v.placeholder;
        }
        function Ct() {
          var f = ee.iteratee || If;
          return f = f === If ? qu : f, arguments.length ? f(arguments[0], arguments[1]) : f;
        }
        function sf(f, v) {
          var S = f.__data__;
          return Wd(v) ? S[typeof v == "string" ? "string" : "hash"] : S.map;
        }
        function Gd(f) {
          for (var v = Rr(f), S = v.length; S--; ) {
            var O = v[S], $ = f[O];
            v[S] = [O, $, xs($)];
          }
          return v;
        }
        function Ho(f, v) {
          var S = zl(f, v);
          return Vc(S) ? S : n;
        }
        function of(f) {
          var v = Ge.call(f, Us), S = f[Us];
          try {
            f[Us] = n;
            var O = !0;
          } catch {
          }
          var $ = tt.call(f);
          return O && (v ? f[Us] = S : delete f[Us]), $;
        }
        var Vd = Pc ? function(f) {
          return f == null ? [] : (f = we(f), Dn(Pc(f), function(v) {
            return dr.call(f, v);
          }));
        } : Ye, lf = Pc ? function(f) {
          for (var v = []; f; )
            qi(v, Vd(f)), f = Nn(f);
          return v;
        } : Ye, Hr = $r;
        (va && Hr(new va(new ArrayBuffer(1))) != gt || Ui && Hr(new Ui()) != ot || wd && Hr(wd.resolve()) != Yn || Ro && Hr(new Ro()) != Ht || Ll && Hr(new Ll()) != Wn) && (Hr = function(f) {
          var v = $r(f), S = v == vt ? f.constructor : n, O = S ? ti(S) : "";
          if (O)
            switch (O) {
              case Jt:
                return gt;
              case Oo:
                return ot;
              case xa:
                return Yn;
              case cm:
                return Ht;
              case zo:
                return Wn;
            }
          return v;
        });
        function Tv(f, v, S) {
          for (var O = -1, $ = S.length; ++O < $; ) {
            var ae = S[O], pe = ae.size;
            switch (ae.type) {
              case "drop":
                f += pe;
                break;
              case "dropRight":
                v -= pe;
                break;
              case "take":
                v = xr(v, f + pe);
                break;
              case "takeRight":
                f = tr(f, v - pe);
                break;
            }
          }
          return { start: f, end: v };
        }
        function Kd(f) {
          var v = f.match(Ts);
          return v ? v[1].split(As) : [];
        }
        function Yd(f, v, S) {
          v = Ki(v, f);
          for (var O = -1, $ = v.length, ae = !1; ++O < $; ) {
            var pe = _i(v[O]);
            if (!(ae = f != null && S(f, pe)))
              break;
            f = f[pe];
          }
          return ae || ++O != $ ? ae : ($ = f == null ? 0 : f.length, !!$ && fh($) && Ka(pe, $) && (zt(f) || Wl(f)));
        }
        function m0(f) {
          var v = f.length, S = new f.constructor(v);
          return v && typeof f[0] == "string" && Ge.call(f, "index") && (S.index = f.index, S.input = f.input), S;
        }
        function Um(f) {
          return typeof f.constructor == "function" && !Ku(f) ? Do(Nn(f)) : {};
        }
        function p0(f, v, S) {
          var O = f.constructor;
          switch (v) {
            case Ze:
              return Qc(f);
            case qe:
            case Me:
              return new O(+f);
            case gt:
              return Nv(f, S);
            case Nt:
            case Dt:
            case Un:
            case $n:
            case an:
            case Qt:
            case En:
            case it:
            case jr:
              return Tm(f, S);
            case ot:
              return new O();
            case We:
            case Rn:
              return new O(f);
            case Fn:
              return a0(f);
            case Ht:
              return new O();
            case rn:
              return s0(f);
          }
        }
        function $m(f, v) {
          var S = v.length;
          if (!S)
            return f;
          var O = S - 1;
          return v[O] = (S > 1 ? "& " : "") + v[O], v = v.join(S > 2 ? ", " : " "), f.replace(ss, `{
/* [wrapped with ` + v + `] */
`);
        }
        function Hm(f) {
          return zt(f) || Wl(f) || !!(Eu && f && f[Eu]);
        }
        function Ka(f, v) {
          var S = typeof f;
          return v = v ?? he, !!v && (S == "number" || S != "symbol" && bo.test(f)) && f > -1 && f % 1 == 0 && f < v;
        }
        function ei(f, v, S) {
          if (!Gn(S))
            return !1;
          var O = typeof v;
          return (O == "number" ? Ni(S) && Ka(v, S.length) : O == "string" && v in S) ? Qi(S[v], f) : !1;
        }
        function uf(f, v) {
          if (zt(f))
            return !1;
          var S = typeof f;
          return S == "number" || S == "symbol" || S == "boolean" || f == null || ji(f) ? !0 : pi.test(f) || !ra.test(f) || v != null && f in we(v);
        }
        function Wd(f) {
          var v = typeof f;
          return v == "string" || v == "number" || v == "symbol" || v == "boolean" ? f !== "__proto__" : f === null;
        }
        function cf(f) {
          var v = Jn(f), S = ee[v];
          if (typeof S != "function" || !(v in Lt.prototype))
            return !1;
          if (f === S)
            return !0;
          var O = af(S);
          return !!O && f === O[0];
        }
        function g0(f) {
          return !!ut && ut in f;
        }
        var Gm = rt ? Zi : Le;
        function Ku(f) {
          var v = f && f.constructor, S = typeof v == "function" && v.prototype || Ve;
          return f === S;
        }
        function xs(f) {
          return f === f && !Gn(f);
        }
        function Xd(f, v) {
          return function(S) {
            return S == null ? !1 : S[f] === v && (v !== n || f in we(S));
          };
        }
        function Av(f) {
          var v = Cf(f, function(O) {
            return S.size === h && S.clear(), O;
          }), S = v.cache;
          return v;
        }
        function y0(f, v) {
          var S = f[1], O = v[1], $ = S | O, ae = $ < (T | j | P), pe = O == P && S == A || O == P && S == re && f[7].length <= v[8] || O == (P | re) && v[7].length <= v[8] && S == A;
          if (!(ae || pe))
            return f;
          O & T && (f[2] = v[2], $ |= S & T ? 0 : R);
          var Ce = v[3];
          if (Ce) {
            var Ae = f[3];
            f[3] = Ae ? qd(Ae, Ce, v[4]) : Ce, f[4] = Ae ? Bi(f[3], p) : v[4];
          }
          return Ce = v[5], Ce && (Ae = f[5], f[5] = Ae ? Mm(Ae, Ce, v[6]) : Ce, f[6] = Ae ? Bi(f[5], p) : v[6]), Ce = v[7], Ce && (f[7] = Ce), O & P && (f[8] = f[8] == null ? v[8] : xr(f[8], v[8])), f[9] == null && (f[9] = v[9]), f[0] = v[0], f[1] = $, f;
        }
        function Ws(f) {
          var v = [];
          if (f != null)
            for (var S in we(f))
              v.push(S);
          return v;
        }
        function Vm(f) {
          return tt.call(f);
        }
        function Km(f, v, S) {
          return v = tr(v === n ? f.length - 1 : v, 0), function() {
            for (var O = arguments, $ = -1, ae = tr(O.length - v, 0), pe = te(ae); ++$ < ae; )
              pe[$] = O[v + $];
            $ = -1;
            for (var Ce = te(v + 1); ++$ < v; )
              Ce[$] = O[$];
            return Ce[v] = S(pe), vr(f, this, Ce);
          };
        }
        function ff(f, v) {
          return v.length < 2 ? f : ys(f, Vi(v, 0, -1));
        }
        function df(f, v) {
          for (var S = f.length, O = xr(v.length, S), $ = ui(f); O--; ) {
            var ae = v[O];
            f[O] = Ka(ae, S) ? $[ae] : n;
          }
          return f;
        }
        function jn(f, v) {
          if (!(v === "constructor" && typeof f[v] == "function") && v != "__proto__")
            return f[v];
        }
        var v0 = Xs(_m), hf = Il || function(f, v) {
          return Zn.setTimeout(f, v);
        }, Qd = Xs(e0);
        function Yu(f, v, S) {
          var O = v + "";
          return Qd(f, $m(O, x0(Kd(O), S)));
        }
        function Xs(f) {
          var v = 0, S = 0;
          return function() {
            var O = ga(), $ = de - (O - S);
            if (S = O, $ > 0) {
              if (++v >= V)
                return arguments[0];
            } else
              v = 0;
            return f.apply(n, arguments);
          };
        }
        function mf(f, v) {
          var S = -1, O = f.length, $ = O - 1;
          for (v = v === n ? O : v; ++S < v; ) {
            var ae = Uu(S, $), pe = f[ae];
            f[ae] = f[S], f[S] = pe;
          }
          return f.length = v, f;
        }
        var Ym = Av(function(f) {
          var v = [];
          return f.charCodeAt(0) === 46 && v.push(""), f.replace(wl, function(S, O, $, ae) {
            v.push($ ? ae.replace(Xn, "$1") : O || S);
          }), v;
        });
        function _i(f) {
          if (typeof f == "string" || ji(f))
            return f;
          var v = f + "";
          return v == "0" && 1 / f == -fe ? "-0" : v;
        }
        function ti(f) {
          if (f != null) {
            try {
              return lt.call(f);
            } catch {
            }
            try {
              return f + "";
            } catch {
            }
          }
          return "";
        }
        function x0(f, v) {
          return Lr(le, function(S) {
            var O = "_." + S[0];
            v & S[1] && !fs(f, O) && f.push(O);
          }), f.sort();
        }
        function Zd(f) {
          if (f instanceof Lt)
            return f.clone();
          var v = new xi(f.__wrapped__, f.__chain__);
          return v.__actions__ = ui(f.__actions__), v.__index__ = f.__index__, v.__values__ = f.__values__, v;
        }
        function b0(f, v, S) {
          (S ? ei(f, v, S) : v === n) ? v = 1 : v = tr(Tt(v), 0);
          var O = f == null ? 0 : f.length;
          if (!O || v < 1)
            return [];
          for (var $ = 0, ae = 0, pe = te(ku(O / v)); $ < O; )
            pe[ae++] = Vi(f, $, $ += v);
          return pe;
        }
        function Wm(f) {
          for (var v = -1, S = f == null ? 0 : f.length, O = 0, $ = []; ++v < S; ) {
            var ae = f[v];
            ae && ($[O++] = ae);
          }
          return $;
        }
        function Xm() {
          var f = arguments.length;
          if (!f)
            return [];
          for (var v = te(f - 1), S = arguments[0], O = f; O--; )
            v[O - 1] = arguments[O];
          return qi(zt(S) ? ui(S) : [S], Cr(v, 1));
        }
        var Jd = qt(function(f, v) {
          return pr(f) ? _a(f, Cr(v, 1, pr, !0)) : [];
        }), w0 = qt(function(f, v) {
          var S = qn(v);
          return pr(S) && (S = n), pr(f) ? _a(f, Cr(v, 1, pr, !0), Ct(S, 2)) : [];
        }), Qs = qt(function(f, v) {
          var S = qn(v);
          return pr(S) && (S = n), pr(f) ? _a(f, Cr(v, 1, pr, !0), n, S) : [];
        });
        function _r(f, v, S) {
          var O = f == null ? 0 : f.length;
          return O ? (v = S || v === n ? 1 : Tt(v), Vi(f, v < 0 ? 0 : v, O)) : [];
        }
        function Qm(f, v, S) {
          var O = f == null ? 0 : f.length;
          return O ? (v = S || v === n ? 1 : Tt(v), v = O - v, Vi(f, 0, v < 0 ? 0 : v)) : [];
        }
        function _0(f, v) {
          return f && f.length ? Wc(f, Ct(v, 3), !0, !0) : [];
        }
        function Mr(f, v) {
          return f && f.length ? Wc(f, Ct(v, 3), !0) : [];
        }
        function Mv(f, v, S, O) {
          var $ = f == null ? 0 : f.length;
          return $ ? (S && typeof S != "number" && ei(f, v, S) && (S = 0, O = $), $c(f, v, S, O)) : [];
        }
        function Zm(f, v, S) {
          var O = f == null ? 0 : f.length;
          if (!O)
            return -1;
          var $ = S == null ? 0 : Tt(S);
          return $ < 0 && ($ = tr(O + $, 0)), Bs(f, Ct(v, 3), $);
        }
        function Jm(f, v, S) {
          var O = f == null ? 0 : f.length;
          if (!O)
            return -1;
          var $ = O - 1;
          return S !== n && ($ = Tt(S), $ = S < 0 ? tr(O + $, 0) : xr($, O - 1)), Bs(f, Ct(v, 3), $, !0);
        }
        function Pn(f) {
          var v = f == null ? 0 : f.length;
          return v ? Cr(f, 1) : [];
        }
        function Si(f) {
          var v = f == null ? 0 : f.length;
          return v ? Cr(f, fe) : [];
        }
        function Zs(f, v) {
          var S = f == null ? 0 : f.length;
          return S ? (v = v === n ? 1 : Tt(v), Cr(f, v)) : [];
        }
        function S0(f) {
          for (var v = -1, S = f == null ? 0 : f.length, O = {}; ++v < S; ) {
            var $ = f[v];
            O[$[0]] = $[1];
          }
          return O;
        }
        function ep(f) {
          return f && f.length ? f[0] : n;
        }
        function C0(f, v, S) {
          var O = f == null ? 0 : f.length;
          if (!O)
            return -1;
          var $ = S == null ? 0 : Tt(S);
          return $ < 0 && ($ = tr(O + $, 0)), ds(f, v, $);
        }
        function Rv(f) {
          var v = f == null ? 0 : f.length;
          return v ? Vi(f, 0, -1) : [];
        }
        var eh = qt(function(f) {
          var v = kn(f, Nm);
          return v.length && v[0] === f[0] ? Gc(v) : [];
        }), Ci = qt(function(f) {
          var v = qn(f), S = kn(f, Nm);
          return v === qn(S) ? v = n : S.pop(), S.length && S[0] === f[0] ? Gc(S, Ct(v, 2)) : [];
        }), Ya = qt(function(f) {
          var v = qn(f), S = kn(f, Nm);
          return v = typeof v == "function" ? v : n, v && S.pop(), S.length && S[0] === f[0] ? Gc(S, n, v) : [];
        });
        function E0(f, v) {
          return f == null ? "" : Nu.call(f, v);
        }
        function qn(f) {
          var v = f == null ? 0 : f.length;
          return v ? f[v - 1] : n;
        }
        function k0(f, v, S) {
          var O = f == null ? 0 : f.length;
          if (!O)
            return -1;
          var $ = O;
          return S !== n && ($ = Tt(S), $ = $ < 0 ? tr(O + $, 0) : xr($, O - 1)), v === v ? Ao(f, v, $) : Bs(f, vd, $, !0);
        }
        function Js(f, v) {
          return f && f.length ? zd(f, Tt(v)) : n;
        }
        var Gl = qt(bs);
        function bs(f, v) {
          return f && f.length && v && v.length ? Bu(f, v) : f;
        }
        function tp(f, v, S) {
          return f && f.length && v && v.length ? Bu(f, v, Ct(S, 2)) : f;
        }
        function np(f, v, S) {
          return f && f.length && v && v.length ? Bu(f, v, n, S) : f;
        }
        var Wa = vs(function(f, v) {
          var S = f == null ? 0 : f.length, O = Iu(f, v);
          return Fu(f, kn(v, function($) {
            return Ka($, S) ? +$ : $;
          }).sort(Am)), O;
        });
        function N0(f, v) {
          var S = [];
          if (!(f && f.length))
            return S;
          var O = -1, $ = [], ae = f.length;
          for (v = Ct(v, 3); ++O < ae; ) {
            var pe = f[O];
            v(pe, O, f) && (S.push(pe), $.push(O));
          }
          return Fu(f, $), S;
        }
        function Go(f) {
          return f == null ? f : ms.call(f);
        }
        function pf(f, v, S) {
          var O = f == null ? 0 : f.length;
          return O ? (S && typeof S != "number" && ei(f, v, S) ? (v = 0, S = O) : (v = v == null ? 0 : Tt(v), S = S === n ? O : Tt(S)), Vi(f, v, S)) : [];
        }
        function gf(f, v) {
          return Hu(f, v);
        }
        function Wu(f, v, S) {
          return Id(f, v, Ct(S, 2));
        }
        function j0(f, v) {
          var S = f == null ? 0 : f.length;
          if (S) {
            var O = Hu(f, v);
            if (O < S && Qi(f[O], v))
              return O;
          }
          return -1;
        }
        function T0(f, v) {
          return Hu(f, v, !0);
        }
        function yf(f, v, S) {
          return Id(f, v, Ct(S, 2), !0);
        }
        function A0(f, v) {
          var S = f == null ? 0 : f.length;
          if (S) {
            var O = Hu(f, v, !0) - 1;
            if (Qi(f[O], v))
              return O;
          }
          return -1;
        }
        function th(f) {
          return f && f.length ? r0(f) : [];
        }
        function M0(f, v) {
          return f && f.length ? r0(f, Ct(v, 2)) : [];
        }
        function Ov(f) {
          var v = f == null ? 0 : f.length;
          return v ? Vi(f, 1, v) : [];
        }
        function zv(f, v, S) {
          return f && f.length ? (v = S || v === n ? 1 : Tt(v), Vi(f, 0, v < 0 ? 0 : v)) : [];
        }
        function hn(f, v, S) {
          var O = f == null ? 0 : f.length;
          return O ? (v = S || v === n ? 1 : Tt(v), v = O - v, Vi(f, v < 0 ? 0 : v, O)) : [];
        }
        function Tn(f, v) {
          return f && f.length ? Wc(f, Ct(v, 3), !1, !0) : [];
        }
        function Gt(f, v) {
          return f && f.length ? Wc(f, Ct(v, 3)) : [];
        }
        var Wt = qt(function(f) {
          return Ys(Cr(f, 1, pr, !0));
        }), vn = qt(function(f) {
          var v = qn(f);
          return pr(v) && (v = n), Ys(Cr(f, 1, pr, !0), Ct(v, 2));
        }), Yi = qt(function(f) {
          var v = qn(f);
          return v = typeof v == "function" ? v : n, Ys(Cr(f, 1, pr, !0), n, v);
        });
        function Vo(f) {
          return f && f.length ? Ys(f) : [];
        }
        function Xu(f, v) {
          return f && f.length ? Ys(f, Ct(v, 2)) : [];
        }
        function rp(f, v) {
          return v = typeof v == "function" ? v : n, f && f.length ? Ys(f, n, v) : [];
        }
        function Xa(f) {
          if (!(f && f.length))
            return [];
          var v = 0;
          return f = Dn(f, function(S) {
            if (pr(S))
              return v = tr(S.length, v), !0;
          }), Ml(v, function(S) {
            return kn(f, ma(S));
          });
        }
        function er(f, v) {
          if (!(f && f.length))
            return [];
          var S = Xa(f);
          return v == null ? S : kn(S, function(O) {
            return vr(v, n, O);
          });
        }
        var Ko = qt(function(f, v) {
          return pr(f) ? _a(f, v) : [];
        }), Vl = qt(function(f) {
          return Ld(Dn(f, pr));
        }), ip = qt(function(f) {
          var v = qn(f);
          return pr(v) && (v = n), Ld(Dn(f, pr), Ct(v, 2));
        }), Wi = qt(function(f) {
          var v = qn(f);
          return v = typeof v == "function" ? v : n, Ld(Dn(f, pr), n, v);
        }), Qu = qt(Xa);
        function vf(f, v) {
          return km(f || [], v || [], Fa);
        }
        function Ei(f, v) {
          return km(f || [], v || [], $u);
        }
        var ap = qt(function(f) {
          var v = f.length, S = v > 1 ? f[v - 1] : n;
          return S = typeof S == "function" ? (f.pop(), S) : n, er(f, S);
        });
        function xf(f) {
          var v = ee(f);
          return v.__chain__ = !0, v;
        }
        function R0(f, v) {
          return v(f), f;
        }
        function Kl(f, v) {
          return v(f);
        }
        var nh = vs(function(f) {
          var v = f.length, S = v ? f[0] : 0, O = this.__wrapped__, $ = function(ae) {
            return Iu(ae, f);
          };
          return v > 1 || this.__actions__.length || !(O instanceof Lt) || !Ka(S) ? this.thru($) : (O = O.slice(S, +S + (v ? 1 : 0)), O.__actions__.push({
            func: Kl,
            args: [$],
            thisArg: n
          }), new xi(O, this.__chain__).thru(function(ae) {
            return v && !ae.length && ae.push(n), ae;
          }));
        });
        function Yo() {
          return xf(this);
        }
        function Er() {
          return new xi(this.value(), this.__chain__);
        }
        function Wo() {
          this.__values__ === n && (this.__values__ = ny(this.value()));
          var f = this.__index__ >= this.__values__.length, v = f ? n : this.__values__[this.__index__++];
          return { done: f, value: v };
        }
        function Zu() {
          return this;
        }
        function eo(f) {
          for (var v, S = this; S instanceof Io; ) {
            var O = Zd(S);
            O.__index__ = 0, O.__values__ = n, v ? $.__wrapped__ = O : v = O;
            var $ = O;
            S = S.__wrapped__;
          }
          return $.__wrapped__ = f, v;
        }
        function sp() {
          var f = this.__wrapped__;
          if (f instanceof Lt) {
            var v = f;
            return this.__actions__.length && (v = new Lt(this)), v = v.reverse(), v.__actions__.push({
              func: Kl,
              args: [Go],
              thisArg: n
            }), new xi(v, this.__chain__);
          }
          return this.thru(Go);
        }
        function op() {
          return Em(this.__wrapped__, this.__actions__);
        }
        var O0 = Bd(function(f, v, S) {
          Ge.call(f, S) ? ++f[S] : $i(f, S, 1);
        });
        function bf(f, v, S) {
          var O = zt(f) ? vu : qo;
          return S && ei(f, v, S) && (v = n), O(f, Ct(v, 3));
        }
        function lp(f, v) {
          var S = zt(f) ? Dn : jd;
          return S(f, Ct(v, 3));
        }
        var Xi = Im(Zm), z0 = Im(Jm);
        function ki(f, v) {
          return Cr(wf(f, v), 1);
        }
        function D0(f, v) {
          return Cr(wf(f, v), fe);
        }
        function I0(f, v, S) {
          return S = S === n ? 1 : Tt(S), Cr(wf(f, v), S);
        }
        function L0(f, v) {
          var S = zt(f) ? Lr : gs;
          return S(f, Ct(v, 3));
        }
        function to(f, v) {
          var S = zt(f) ? Tc : Nd;
          return S(f, Ct(v, 3));
        }
        var rh = Bd(function(f, v, S) {
          Ge.call(f, S) ? f[S].push(v) : $i(f, S, [v]);
        });
        function up(f, v, S, O) {
          f = Ni(f) ? f : oc(f), S = S && !O ? Tt(S) : 0;
          var $ = f.length;
          return S < 0 && (S = tr($ + S, 0)), Mf(f) ? S <= $ && f.indexOf(v, S) > -1 : !!$ && ds(f, v, S) > -1;
        }
        var Ju = qt(function(f, v, S) {
          var O = -1, $ = typeof v == "function", ae = Ni(f) ? te(f.length) : [];
          return gs(f, function(pe) {
            ae[++O] = $ ? vr(v, pe, S) : Ca(pe, v, S);
          }), ae;
        }), P0 = Bd(function(f, v, S) {
          $i(f, S, v);
        });
        function wf(f, v) {
          var S = zt(f) ? kn : Rd;
          return S(f, Ct(v, 3));
        }
        function q0(f, v, S, O) {
          return f == null ? [] : (zt(v) || (v = v == null ? [] : [v]), S = O ? n : S, zt(S) || (S = S == null ? [] : [S]), Dd(f, v, S));
        }
        var B0 = Bd(function(f, v, S) {
          f[S ? 0 : 1].push(v);
        }, function() {
          return [[], []];
        });
        function ih(f, v, S) {
          var O = zt(f) ? xu : Al, $ = arguments.length < 3;
          return O(f, Ct(v, 4), S, $, gs);
        }
        function cp(f, v, S) {
          var O = zt(f) ? Ac : Al, $ = arguments.length < 3;
          return O(f, Ct(v, 4), S, $, Nd);
        }
        function Dv(f, v) {
          var S = zt(f) ? Dn : jd;
          return S(f, oh(Ct(v, 3)));
        }
        function Iv(f) {
          var v = zt(f) ? Uc : bm;
          return v(f);
        }
        function Lv(f, v, S) {
          (S ? ei(f, v, S) : v === n) ? v = 1 : v = Tt(v);
          var O = zt(f) ? Ed : wm;
          return O(f, v);
        }
        function F0(f) {
          var v = zt(f) ? Xg : t0;
          return v(f);
        }
        function U0(f) {
          if (f == null)
            return 0;
          if (Ni(f))
            return Mf(f) ? oi(f) : f.length;
          var v = Hr(f);
          return v == ot || v == Ht ? f.size : Fo(f).length;
        }
        function ec(f, v, S) {
          var O = zt(f) ? Eo : n0;
          return S && ei(f, v, S) && (v = n), O(f, Ct(v, 3));
        }
        var ah = qt(function(f, v) {
          if (f == null)
            return [];
          var S = v.length;
          return S > 1 && ei(f, v[0], v[1]) ? v = [] : S > 2 && ei(v[0], v[1], v[2]) && (v = [v[0]]), Dd(f, Cr(v, 1), []);
        }), _f = bd || function() {
          return Zn.Date.now();
        };
        function $0(f, v) {
          if (typeof v != "function")
            throw new Te(l);
          return f = Tt(f), function() {
            if (--f < 1)
              return v.apply(this, arguments);
          };
        }
        function fp(f, v, S) {
          return v = S ? n : v, v = f && v == null ? f.length : v, ci(f, P, n, n, n, n, v);
        }
        function dp(f, v) {
          var S;
          if (typeof v != "function")
            throw new Te(l);
          return f = Tt(f), function() {
            return --f > 0 && (S = v.apply(this, arguments)), f <= 1 && (v = n), S;
          };
        }
        var sh = qt(function(f, v, S) {
          var O = T;
          if (S.length) {
            var $ = Bi(S, rr(sh));
            O |= q;
          }
          return ci(f, O, v, S, $);
        }), hp = qt(function(f, v, S) {
          var O = T | j;
          if (S.length) {
            var $ = Bi(S, rr(hp));
            O |= q;
          }
          return ci(v, O, f, S, $);
        });
        function Sf(f, v, S) {
          v = S ? n : v;
          var O = ci(f, A, n, n, n, n, n, v);
          return O.placeholder = Sf.placeholder, O;
        }
        function mp(f, v, S) {
          v = S ? n : v;
          var O = ci(f, z, n, n, n, n, n, v);
          return O.placeholder = mp.placeholder, O;
        }
        function pp(f, v, S) {
          var O, $, ae, pe, Ce, Ae, Xe = 0, Qe = !1, et = !1, ft = !0;
          if (typeof f != "function")
            throw new Te(l);
          v = Ji(v) || 0, Gn(S) && (Qe = !!S.leading, et = "maxWait" in S, ae = et ? tr(Ji(S.maxWait) || 0, v) : ae, ft = "trailing" in S ? !!S.trailing : ft);
          function wt(kr) {
            var io = O, Ql = $;
            return O = $ = n, Xe = kr, pe = f.apply(Ql, io), pe;
          }
          function At(kr) {
            return Xe = kr, Ce = hf(en, v), Qe ? wt(kr) : pe;
          }
          function $t(kr) {
            var io = kr - Ae, Ql = kr - Xe, R5 = v - io;
            return et ? xr(R5, ae - Ql) : R5;
          }
          function Mt(kr) {
            var io = kr - Ae, Ql = kr - Xe;
            return Ae === n || io >= v || io < 0 || et && Ql >= ae;
          }
          function en() {
            var kr = _f();
            if (Mt(kr))
              return ln(kr);
            Ce = hf(en, $t(kr));
          }
          function ln(kr) {
            return Ce = n, ft && O ? wt(kr) : (O = $ = n, pe);
          }
          function Qa() {
            Ce !== n && Xc(Ce), Xe = 0, O = Ae = $ = Ce = n;
          }
          function ea() {
            return Ce === n ? pe : ln(_f());
          }
          function Za() {
            var kr = _f(), io = Mt(kr);
            if (O = arguments, $ = this, Ae = kr, io) {
              if (Ce === n)
                return At(Ae);
              if (et)
                return Xc(Ce), Ce = hf(en, v), wt(Ae);
            }
            return Ce === n && (Ce = hf(en, v)), pe;
          }
          return Za.cancel = Qa, Za.flush = ea, Za;
        }
        var xn = qt(function(f, v) {
          return pm(f, 1, v);
        }), gp = qt(function(f, v, S) {
          return pm(f, Ji(v) || 0, S);
        });
        function Pv(f) {
          return ci(f, ie);
        }
        function Cf(f, v) {
          if (typeof f != "function" || v != null && typeof v != "function")
            throw new Te(l);
          var S = function() {
            var O = arguments, $ = v ? v.apply(this, O) : O[0], ae = S.cache;
            if (ae.has($))
              return ae.get($);
            var pe = f.apply(this, O);
            return S.cache = ae.set($, pe) || ae, pe;
          };
          return S.cache = new (Cf.Cache || Ba)(), S;
        }
        Cf.Cache = Ba;
        function oh(f) {
          if (typeof f != "function")
            throw new Te(l);
          return function() {
            var v = arguments;
            switch (v.length) {
              case 0:
                return !f.call(this);
              case 1:
                return !f.call(this, v[0]);
              case 2:
                return !f.call(this, v[0], v[1]);
              case 3:
                return !f.call(this, v[0], v[1], v[2]);
            }
            return !f.apply(this, v);
          };
        }
        function qv(f) {
          return dp(2, f);
        }
        var Bv = i0(function(f, v) {
          v = v.length == 1 && zt(v[0]) ? kn(v[0], Zr(Ct())) : kn(Cr(v, 1), Zr(Ct()));
          var S = v.length;
          return qt(function(O) {
            for (var $ = -1, ae = xr(O.length, S); ++$ < ae; )
              O[$] = v[$].call(this, O[$]);
            return vr(f, this, O);
          });
        }), tc = qt(function(f, v) {
          var S = Bi(v, rr(tc));
          return ci(f, q, n, v, S);
        }), Yl = qt(function(f, v) {
          var S = Bi(v, rr(Yl));
          return ci(f, D, n, v, S);
        }), yp = vs(function(f, v) {
          return ci(f, re, n, n, n, v);
        });
        function lh(f, v) {
          if (typeof f != "function")
            throw new Te(l);
          return v = v === n ? v : Tt(v), qt(f, v);
        }
        function vp(f, v) {
          if (typeof f != "function")
            throw new Te(l);
          return v = v == null ? 0 : tr(Tt(v), 0), qt(function(S) {
            var O = S[v], $ = Va(S, 0, v);
            return O && qi($, O), vr(f, this, $);
          });
        }
        function Xo(f, v, S) {
          var O = !0, $ = !0;
          if (typeof f != "function")
            throw new Te(l);
          return Gn(S) && (O = "leading" in S ? !!S.leading : O, $ = "trailing" in S ? !!S.trailing : $), pp(f, v, {
            leading: O,
            maxWait: v,
            trailing: $
          });
        }
        function ws(f) {
          return fp(f, 1);
        }
        function Ef(f, v) {
          return tc(Pd(v), f);
        }
        function Fv() {
          if (!arguments.length)
            return [];
          var f = arguments[0];
          return zt(f) ? f : [f];
        }
        function H0(f) {
          return li(f, b);
        }
        function G0(f, v) {
          return v = typeof v == "function" ? v : n, li(f, b, v);
        }
        function V0(f) {
          return li(f, g | b);
        }
        function K0(f, v) {
          return v = typeof v == "function" ? v : n, li(f, g | b, v);
        }
        function Uv(f, v) {
          return v == null || Po(f, v, Rr(v));
        }
        function Qi(f, v) {
          return f === v || f !== f && v !== v;
        }
        var Y0 = tf(Hc), W0 = tf(function(f, v) {
          return f >= v;
        }), Wl = bi(/* @__PURE__ */ (function() {
          return arguments;
        })()) ? bi : function(f) {
          return ir(f) && Ge.call(f, "callee") && !dr.call(f, "callee");
        }, zt = te.isArray, xp = kc ? Zr(kc) : hr;
        function Ni(f) {
          return f != null && fh(f.length) && !Zi(f);
        }
        function pr(f) {
          return ir(f) && Ni(f);
        }
        function kf(f) {
          return f === !0 || f === !1 || ir(f) && $r(f) == qe;
        }
        var Qo = Vg || Le, X0 = jl ? Zr(jl) : Ad;
        function Vt(f) {
          return ir(f) && f.nodeType === 1 && !jf(f);
        }
        function bp(f) {
          if (f == null)
            return !0;
          if (Ni(f) && (zt(f) || typeof f == "string" || typeof f.splice == "function" || Qo(f) || Zo(f) || Wl(f)))
            return !f.length;
          var v = Hr(f);
          if (v == ot || v == Ht)
            return !f.size;
          if (Ku(f))
            return !Fo(f).length;
          for (var S in f)
            if (Ge.call(f, S))
              return !1;
          return !0;
        }
        function uh(f, v) {
          return Gi(f, v);
        }
        function wp(f, v, S) {
          S = typeof S == "function" ? S : n;
          var O = S ? S(f, v) : n;
          return O === n ? Gi(f, v, n, S) : !!O;
        }
        function ch(f) {
          if (!ir(f))
            return !1;
          var v = $r(f);
          return v == Re || v == Pe || typeof f.message == "string" && typeof f.name == "string" && !jf(f);
        }
        function _p(f) {
          return typeof f == "number" && Fi(f);
        }
        function Zi(f) {
          if (!Gn(f))
            return !1;
          var v = $r(f);
          return v == Be || v == Je || v == Oe || v == Mn;
        }
        function Nf(f) {
          return typeof f == "number" && f == Tt(f);
        }
        function fh(f) {
          return typeof f == "number" && f > -1 && f % 1 == 0 && f <= he;
        }
        function Gn(f) {
          var v = typeof f;
          return f != null && (v == "object" || v == "function");
        }
        function ir(f) {
          return f != null && typeof f == "object";
        }
        var Q0 = Ps ? Zr(Ps) : wn;
        function Z0(f, v) {
          return f === v || nr(f, v, Gd(v));
        }
        function J0(f, v, S) {
          return S = typeof S == "function" ? S : n, nr(f, v, Gd(v), S);
        }
        function _n(f) {
          return Cp(f) && f != +f;
        }
        function Sp(f) {
          if (Gm(f))
            throw new ce(o);
          return Vc(f);
        }
        function Gr(f) {
          return f === null;
        }
        function $v(f) {
          return f == null;
        }
        function Cp(f) {
          return typeof f == "number" || ir(f) && $r(f) == We;
        }
        function jf(f) {
          if (!ir(f) || $r(f) != vt)
            return !1;
          var v = Nn(f);
          if (v === null)
            return !0;
          var S = Ge.call(v, "constructor") && v.constructor;
          return typeof S == "function" && S instanceof S && lt.call(S) == ht;
        }
        var Tf = Tl ? Zr(Tl) : Pu;
        function Ep(f) {
          return Nf(f) && f >= -he && f <= he;
        }
        var Af = Nc ? Zr(Nc) : $l;
        function Mf(f) {
          return typeof f == "string" || !zt(f) && ir(f) && $r(f) == Rn;
        }
        function ji(f) {
          return typeof f == "symbol" || ir(f) && $r(f) == rn;
        }
        var Zo = gd ? Zr(gd) : Md;
        function kp(f) {
          return f === n;
        }
        function Hv(f) {
          return ir(f) && Hr(f) == Wn;
        }
        function ey(f) {
          return ir(f) && $r(f) == Ue;
        }
        var Gv = tf(Hn), ty = tf(function(f, v) {
          return f <= v;
        });
        function ny(f) {
          if (!f)
            return [];
          if (Ni(f))
            return Mf(f) ? An(f) : ui(f);
          if (Fr && f[Fr])
            return To(f[Fr]());
          var v = Hr(f), S = v == ot ? qr : v == Ht ? Dl : oc;
          return S(f);
        }
        function no(f) {
          if (!f)
            return f === 0 ? f : 0;
          if (f = Ji(f), f === fe || f === -fe) {
            var v = f < 0 ? -1 : 1;
            return v * ge;
          }
          return f === f ? f : 0;
        }
        function Tt(f) {
          var v = no(f), S = v % 1;
          return v === v ? S ? v - S : v : 0;
        }
        function Np(f) {
          return f ? Ua(Tt(f), 0, U) : 0;
        }
        function Ji(f) {
          if (typeof f == "number")
            return f;
          if (ji(f))
            return Q;
          if (Gn(f)) {
            var v = typeof f.valueOf == "function" ? f.valueOf() : f;
            f = Gn(v) ? v + "" : v;
          }
          if (typeof f != "string")
            return f === 0 ? f : +f;
          f = hs(f);
          var S = sa.test(f);
          return S || ri.test(f) ? gu(f.slice(2), S ? 2 : 8) : cu.test(f) ? Q : +f;
        }
        function dh(f) {
          return Ea(f, Ti(f));
        }
        function Vv(f) {
          return f ? Ua(Tt(f), -he, he) : f === 0 ? f : 0;
        }
        function gn(f) {
          return f == null ? "" : wi(f);
        }
        var ry = Uo(function(f, v) {
          if (Ku(v) || Ni(v)) {
            Ea(v, Rr(v), f);
            return;
          }
          for (var S in v)
            Ge.call(v, S) && Fa(f, S, v[S]);
        }), hh = Uo(function(f, v) {
          Ea(v, Ti(v), f);
        }), nc = Uo(function(f, v, S, O) {
          Ea(v, Ti(v), f, O);
        }), Kv = Uo(function(f, v, S, O) {
          Ea(v, Rr(v), f, O);
        }), ka = vs(Iu);
        function jp(f, v) {
          var S = Do(f);
          return v == null ? S : mm(S, v);
        }
        var iy = qt(function(f, v) {
          f = we(f);
          var S = -1, O = v.length, $ = O > 2 ? v[2] : n;
          for ($ && ei(v[0], v[1], $) && (O = 1); ++S < O; )
            for (var ae = v[S], pe = Ti(ae), Ce = -1, Ae = pe.length; ++Ce < Ae; ) {
              var Xe = pe[Ce], Qe = f[Xe];
              (Qe === n || Qi(Qe, Ve[Xe]) && !Ge.call(f, Xe)) && (f[Xe] = ae[Xe]);
            }
          return f;
        }), ay = qt(function(f) {
          return f.push(n, qm), vr(ic, n, f);
        });
        function sy(f, v) {
          return bu(f, Ct(v, 3), Ha);
        }
        function Rf(f, v) {
          return bu(f, Ct(v, 3), Td);
        }
        function Na(f, v) {
          return f == null ? f : Ul(f, Ct(v, 3), Ti);
        }
        function oy(f, v) {
          return f == null ? f : Lu(f, Ct(v, 3), Ti);
        }
        function mh(f, v) {
          return f && Ha(f, Ct(v, 3));
        }
        function ro(f, v) {
          return f && Td(f, Ct(v, 3));
        }
        function Yv(f) {
          return f == null ? [] : Ks(f, Rr(f));
        }
        function Wv(f) {
          return f == null ? [] : Ks(f, Ti(f));
        }
        function Jo(f, v, S) {
          var O = f == null ? n : ys(f, v);
          return O === n ? S : O;
        }
        function ly(f, v) {
          return f != null && Yd(f, v, Hi);
        }
        function Tp(f, v) {
          return f != null && Yd(f, v, Sa);
        }
        var Xv = Jc(function(f, v, S) {
          v != null && typeof v.toString != "function" && (v = tt.call(v)), f[v] = S;
        }, uc(fi)), Qv = Jc(function(f, v, S) {
          v != null && typeof v.toString != "function" && (v = tt.call(v)), Ge.call(f, v) ? f[v].push(S) : f[v] = [S];
        }, Ct), Zv = qt(Ca);
        function Rr(f) {
          return Ni(f) ? Cd(f) : Fo(f);
        }
        function Ti(f) {
          return Ni(f) ? Cd(f, !0) : Ev(f);
        }
        function Jv(f, v) {
          var S = {};
          return v = Ct(v, 3), Ha(f, function(O, $, ae) {
            $i(S, v(O, $, ae), O);
          }), S;
        }
        function uy(f, v) {
          var S = {};
          return v = Ct(v, 3), Ha(f, function(O, $, ae) {
            $i(S, $, v(O, $, ae));
          }), S;
        }
        var rc = Uo(function(f, v, S) {
          Kc(f, v, S);
        }), ic = Uo(function(f, v, S, O) {
          Kc(f, v, S, O);
        }), cy = vs(function(f, v) {
          var S = {};
          if (f == null)
            return S;
          var O = !1;
          v = kn(v, function(ae) {
            return ae = Ki(ae, f), O || (O = ae.length > 1), ae;
          }), Ea(f, Fm(f), S), O && (S = li(S, g | x | b, d0));
          for (var $ = v.length; $--; )
            Yc(S, v[$]);
          return S;
        });
        function ex(f, v) {
          return sc(f, oh(Ct(v)));
        }
        var ac = vs(function(f, v) {
          return f == null ? {} : vm(f, v);
        });
        function sc(f, v) {
          if (f == null)
            return {};
          var S = kn(Fm(f), function(O) {
            return [O];
          });
          return v = Ct(v), Jr(f, S, function(O, $) {
            return v(O, $[0]);
          });
        }
        function fy(f, v, S) {
          v = Ki(v, f);
          var O = -1, $ = v.length;
          for ($ || ($ = 1, f = n); ++O < $; ) {
            var ae = f == null ? n : f[_i(v[O])];
            ae === n && (O = $, ae = S), f = Zi(ae) ? ae.call(f) : ae;
          }
          return f;
        }
        function ph(f, v, S) {
          return f == null ? f : $u(f, v, S);
        }
        function Ap(f, v, S, O) {
          return O = typeof O == "function" ? O : n, f == null ? f : $u(f, v, S, O);
        }
        var gh = Lm(Rr), Of = Lm(Ti);
        function dy(f, v, S) {
          var O = zt(f), $ = O || Qo(f) || Zo(f);
          if (v = Ct(v, 4), S == null) {
            var ae = f && f.constructor;
            $ ? S = O ? new ae() : [] : Gn(f) ? S = Zi(ae) ? Do(Nn(f)) : {} : S = {};
          }
          return ($ ? Lr : Ha)(f, function(pe, Ce, Ae) {
            return v(S, pe, Ce, Ae);
          }), S;
        }
        function hy(f, v) {
          return f == null ? !0 : Yc(f, v);
        }
        function tx(f, v, S) {
          return f == null ? f : Cm(f, v, Pd(S));
        }
        function my(f, v, S, O) {
          return O = typeof O == "function" ? O : n, f == null ? f : Cm(f, v, Pd(S), O);
        }
        function oc(f) {
          return f == null ? [] : zc(f, Rr(f));
        }
        function Mp(f) {
          return f == null ? [] : zc(f, Ti(f));
        }
        function nx(f, v, S) {
          return S === n && (S = v, v = n), S !== n && (S = Ji(S), S = S === S ? S : 0), v !== n && (v = Ji(v), v = v === v ? v : 0), Ua(Ji(f), v, S);
        }
        function yh(f, v, S) {
          return v = no(v), S === n ? (S = v, v = 0) : S = no(S), f = Ji(f), Bo(f, v, S);
        }
        function vh(f, v, S) {
          if (S && typeof S != "boolean" && ei(f, v, S) && (v = S = n), S === n && (typeof v == "boolean" ? (S = v, v = n) : typeof f == "boolean" && (S = f, f = n)), f === n && v === n ? (f = 0, v = 1) : (f = no(f), v === n ? (v = f, f = 0) : v = no(v)), f > v) {
            var O = f;
            f = v, v = O;
          }
          if (S || f % 1 || v % 1) {
            var $ = $s();
            return xr(f + $ * (v - f + Ls("1e-" + (($ + "").length - 1))), v);
          }
          return Uu(f, v);
        }
        var xh = Hl(function(f, v, S) {
          return v = v.toLowerCase(), f + (S ? py(v) : v);
        });
        function py(f) {
          return Xl(gn(f).toLowerCase());
        }
        function lc(f) {
          return f = gn(f), f && f.replace(oa, Ol).replace(_o, "");
        }
        function rx(f, v, S) {
          f = gn(f), v = wi(v);
          var O = f.length;
          S = S === n ? O : Ua(Tt(S), 0, O);
          var $ = S;
          return S -= v.length, S >= 0 && f.slice(S, $) == v;
        }
        function gy(f) {
          return f = gn(f), f && js.test(f) ? f.replace(as, um) : f;
        }
        function yy(f) {
          return f = gn(f), f && yn.test(f) ? f.replace(Da, "\\$&") : f;
        }
        var vy = Hl(function(f, v, S) {
          return f + (S ? "-" : "") + v.toLowerCase();
        }), xy = Hl(function(f, v, S) {
          return f + (S ? " " : "") + v.toLowerCase();
        }), Rp = Dm("toLowerCase");
        function by(f, v, S) {
          f = gn(f), v = Tt(v);
          var O = v ? oi(f) : 0;
          if (!v || O >= v)
            return f;
          var $ = (v - O) / 2;
          return $o(Lc($), S) + f + $o(ku($), S);
        }
        function wy(f, v, S) {
          f = gn(f), v = Tt(v);
          var O = v ? oi(f) : 0;
          return v && O < v ? f + $o(v - O, S) : f;
        }
        function bh(f, v, S) {
          f = gn(f), v = Tt(v);
          var O = v ? oi(f) : 0;
          return v && O < v ? $o(v - O, S) + f : f;
        }
        function ix(f, v, S) {
          return S || v == null ? v = 0 : v && (v = +v), ya(gn(f).replace(On, ""), v || 0);
        }
        function ax(f, v, S) {
          return (S ? ei(f, v, S) : v === n) ? v = 1 : v = Tt(v), Ga(gn(f), v);
        }
        function Op() {
          var f = arguments, v = gn(f[0]);
          return f.length < 3 ? v : v.replace(f[1], f[2]);
        }
        var zp = Hl(function(f, v, S) {
          return f + (S ? "_" : "") + v.toLowerCase();
        });
        function wh(f, v, S) {
          return S && typeof S != "number" && ei(f, v, S) && (v = S = n), S = S === n ? U : S >>> 0, S ? (f = gn(f), f && (typeof v == "string" || v != null && !Tf(v)) && (v = wi(v), !v && Pr(f)) ? Va(An(f), 0, S) : f.split(v, S)) : [];
        }
        var Dp = Hl(function(f, v, S) {
          return f + (S ? " " : "") + Xl(v);
        });
        function _y(f, v, S) {
          return f = gn(f), S = S == null ? 0 : Ua(Tt(S), 0, f.length), v = wi(v), f.slice(S, S + v.length) == v;
        }
        function Ip(f, v, S) {
          var O = ee.templateSettings;
          S && ei(f, v, S) && (v = n), f = gn(f), v = nc({}, v, O, Pm);
          var $ = nc({}, v.imports, O.imports, Pm), ae = Rr($), pe = zc($, ae), Ce, Ae, Xe = 0, Qe = v.interpolate || sn, et = "__p += '", ft = ke(
            (v.escape || sn).source + "|" + Qe.source + "|" + (Qe === bl ? Tr : sn).source + "|" + (v.evaluate || sn).source + "|$",
            "g"
          ), wt = "//# sourceURL=" + (Ge.call(v, "sourceURL") ? (v.sourceURL + "").replace(/\s/g, " ") : "lodash.templateSources[" + ++pu + "]") + `
`;
          f.replace(ft, function(Mt, en, ln, Qa, ea, Za) {
            return ln || (ln = Qa), et += f.slice(Xe, Za).replace(Yr, Cu), en && (Ce = !0, et += `' +
__e(` + en + `) +
'`), ea && (Ae = !0, et += `';
` + ea + `;
__p += '`), ln && (et += `' +
((__t = (` + ln + `)) == null ? '' : __t) +
'`), Xe = Za + Mt.length, Mt;
          }), et += `';
`;
          var At = Ge.call(v, "variable") && v.variable;
          if (!At)
            et = `with (obj) {
` + et + `
}
`;
          else if (bn.test(At))
            throw new ce(c);
          et = (Ae ? et.replace(lr, "") : et).replace(xo, "$1").replace(ct, "$1;"), et = "function(" + (At || "obj") + `) {
` + (At ? "" : `obj || (obj = {});
`) + "var __t, __p = ''" + (Ce ? ", __e = _.escape" : "") + (Ae ? `, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
` : `;
`) + et + `return __p
}`;
          var $t = Lp(function() {
            return _e(ae, wt + "return " + et).apply(n, pe);
          });
          if ($t.source = et, ch($t))
            throw $t;
          return $t;
        }
        function el(f) {
          return gn(f).toLowerCase();
        }
        function tl(f) {
          return gn(f).toUpperCase();
        }
        function nl(f, v, S) {
          if (f = gn(f), f && (S || v === n))
            return hs(f);
          if (!f || !(v = wi(v)))
            return f;
          var O = An(f), $ = An(v), ae = Rl(O, $), pe = Su(O, $) + 1;
          return Va(O, ae, pe).join("");
        }
        function zf(f, v, S) {
          if (f = gn(f), f && (S || v === n))
            return f.slice(0, w(f) + 1);
          if (!f || !(v = wi(v)))
            return f;
          var O = An(f), $ = Su(O, An(v)) + 1;
          return Va(O, 0, $).join("");
        }
        function Df(f, v, S) {
          if (f = gn(f), f && (S || v === n))
            return f.replace(On, "");
          if (!f || !(v = wi(v)))
            return f;
          var O = An(f), $ = Rl(O, An(v));
          return Va(O, $).join("");
        }
        function rl(f, v) {
          var S = X, O = K;
          if (Gn(v)) {
            var $ = "separator" in v ? v.separator : $;
            S = "length" in v ? Tt(v.length) : S, O = "omission" in v ? wi(v.omission) : O;
          }
          f = gn(f);
          var ae = f.length;
          if (Pr(f)) {
            var pe = An(f);
            ae = pe.length;
          }
          if (S >= ae)
            return f;
          var Ce = S - oi(O);
          if (Ce < 1)
            return O;
          var Ae = pe ? Va(pe, 0, Ce).join("") : f.slice(0, Ce);
          if ($ === n)
            return Ae + O;
          if (pe && (Ce += Ae.length - Ce), Tf($)) {
            if (f.slice(Ce).search($)) {
              var Xe, Qe = Ae;
              for ($.global || ($ = ke($.source, gn(aa.exec($)) + "g")), $.lastIndex = 0; Xe = $.exec(Qe); )
                var et = Xe.index;
              Ae = Ae.slice(0, et === n ? Ce : et);
            }
          } else if (f.indexOf(wi($), Ce) != Ce) {
            var ft = Ae.lastIndexOf($);
            ft > -1 && (Ae = Ae.slice(0, ft));
          }
          return Ae + O;
        }
        function sx(f) {
          return f = gn(f), f && Di.test(f) ? f.replace(Oa, E) : f;
        }
        var Sy = Hl(function(f, v, S) {
          return f + (S ? " " : "") + v.toUpperCase();
        }), Xl = Dm("toUpperCase");
        function Cy(f, v, S) {
          return f = gn(f), v = S ? n : v, v === n ? In(f) ? B(f) : Rc(f) : f.match(v) || [];
        }
        var Lp = qt(function(f, v) {
          try {
            return vr(f, n, v);
          } catch (S) {
            return ch(S) ? S : new ce(S);
          }
        }), _h = vs(function(f, v) {
          return Lr(v, function(S) {
            S = _i(S), $i(f, S, sh(f[S], f));
          }), f;
        });
        function Ey(f) {
          var v = f == null ? 0 : f.length, S = Ct();
          return f = v ? kn(f, function(O) {
            if (typeof O[1] != "function")
              throw new Te(l);
            return [S(O[0]), O[1]];
          }) : [], qt(function(O) {
            for (var $ = -1; ++$ < v; ) {
              var ae = f[$];
              if (vr(ae[0], this, O))
                return vr(ae[1], this, O);
            }
          });
        }
        function ox(f) {
          return Zg(li(f, g));
        }
        function uc(f) {
          return function() {
            return f;
          };
        }
        function Sh(f, v) {
          return f == null || f !== f ? v : f;
        }
        var ky = Gu(), cc = Gu(!0);
        function fi(f) {
          return f;
        }
        function If(f) {
          return qu(typeof f == "function" ? f : li(f, g));
        }
        function Ch(f) {
          return Od(li(f, g));
        }
        function Ny(f, v) {
          return ym(f, li(v, g));
        }
        var lx = qt(function(f, v) {
          return function(S) {
            return Ca(S, f, v);
          };
        }), Eh = qt(function(f, v) {
          return function(S) {
            return Ca(f, S, v);
          };
        });
        function i(f, v, S) {
          var O = Rr(v), $ = Ks(v, O);
          S == null && !(Gn(v) && ($.length || !O.length)) && (S = v, v = f, f = this, $ = Ks(v, Rr(v)));
          var ae = !(Gn(S) && "chain" in S) || !!S.chain, pe = Zi(f);
          return Lr($, function(Ce) {
            var Ae = v[Ce];
            f[Ce] = Ae, pe && (f.prototype[Ce] = function() {
              var Xe = this.__chain__;
              if (ae || Xe) {
                var Qe = f(this.__wrapped__), et = Qe.__actions__ = ui(this.__actions__);
                return et.push({ func: Ae, args: arguments, thisArg: f }), Qe.__chain__ = Xe, Qe;
              }
              return Ae.apply(f, qi([this.value()], arguments));
            });
          }), f;
        }
        function s() {
          return Zn._ === this && (Zn._ = _t), this;
        }
        function u() {
        }
        function y(f) {
          return f = Tt(f), qt(function(v) {
            return zd(v, f);
          });
        }
        var _ = Fd(kn), k = Fd(vu), L = Fd(Eo);
        function J(f) {
          return uf(f) ? ma(_i(f)) : mr(f);
        }
        function ve(f) {
          return function(v) {
            return f == null ? n : ys(f, v);
          };
        }
        var De = Ud(), He = Ud(!0);
        function Ye() {
          return [];
        }
        function Le() {
          return !1;
        }
        function Fe() {
          return {};
        }
        function yt() {
          return "";
        }
        function kt() {
          return !0;
        }
        function Sn(f, v) {
          if (f = Tt(f), f < 1 || f > he)
            return [];
          var S = U, O = xr(f, U);
          v = Ct(v), f -= U;
          for (var $ = Ml(O, v); ++S < f; )
            v(S);
          return $;
        }
        function je(f) {
          return zt(f) ? kn(f, _i) : ji(f) ? [f] : ui(Ym(gn(f)));
        }
        function Ee(f) {
          var v = ++st;
          return gn(f) + v;
        }
        var ze = ef(function(f, v) {
          return f + v;
        }, 0), Ke = nf("ceil"), St = ef(function(f, v) {
          return f / v;
        }, 1), cn = nf("floor");
        function xt(f) {
          return f && f.length ? $a(f, fi, Hc) : n;
        }
        function Ft(f, v) {
          return f && f.length ? $a(f, Ct(v, 2), Hc) : n;
        }
        function Xt(f) {
          return ko(f, fi);
        }
        function fn(f, v) {
          return ko(f, Ct(v, 2));
        }
        function il(f) {
          return f && f.length ? $a(f, fi, Hn) : n;
        }
        function ux(f, v) {
          return f && f.length ? $a(f, Ct(v, 2), Hn) : n;
        }
        var rO = ef(function(f, v) {
          return f * v;
        }, 1), iO = nf("round"), aO = ef(function(f, v) {
          return f - v;
        }, 0);
        function sO(f) {
          return f && f.length ? _u(f, fi) : 0;
        }
        function oO(f, v) {
          return f && f.length ? _u(f, Ct(v, 2)) : 0;
        }
        return ee.after = $0, ee.ary = fp, ee.assign = ry, ee.assignIn = hh, ee.assignInWith = nc, ee.assignWith = Kv, ee.at = ka, ee.before = dp, ee.bind = sh, ee.bindAll = _h, ee.bindKey = hp, ee.castArray = Fv, ee.chain = xf, ee.chunk = b0, ee.compact = Wm, ee.concat = Xm, ee.cond = Ey, ee.conforms = ox, ee.constant = uc, ee.countBy = O0, ee.create = jp, ee.curry = Sf, ee.curryRight = mp, ee.debounce = pp, ee.defaults = iy, ee.defaultsDeep = ay, ee.defer = xn, ee.delay = gp, ee.difference = Jd, ee.differenceBy = w0, ee.differenceWith = Qs, ee.drop = _r, ee.dropRight = Qm, ee.dropRightWhile = _0, ee.dropWhile = Mr, ee.fill = Mv, ee.filter = lp, ee.flatMap = ki, ee.flatMapDeep = D0, ee.flatMapDepth = I0, ee.flatten = Pn, ee.flattenDeep = Si, ee.flattenDepth = Zs, ee.flip = Pv, ee.flow = ky, ee.flowRight = cc, ee.fromPairs = S0, ee.functions = Yv, ee.functionsIn = Wv, ee.groupBy = rh, ee.initial = Rv, ee.intersection = eh, ee.intersectionBy = Ci, ee.intersectionWith = Ya, ee.invert = Xv, ee.invertBy = Qv, ee.invokeMap = Ju, ee.iteratee = If, ee.keyBy = P0, ee.keys = Rr, ee.keysIn = Ti, ee.map = wf, ee.mapKeys = Jv, ee.mapValues = uy, ee.matches = Ch, ee.matchesProperty = Ny, ee.memoize = Cf, ee.merge = rc, ee.mergeWith = ic, ee.method = lx, ee.methodOf = Eh, ee.mixin = i, ee.negate = oh, ee.nthArg = y, ee.omit = cy, ee.omitBy = ex, ee.once = qv, ee.orderBy = q0, ee.over = _, ee.overArgs = Bv, ee.overEvery = k, ee.overSome = L, ee.partial = tc, ee.partialRight = Yl, ee.partition = B0, ee.pick = ac, ee.pickBy = sc, ee.property = J, ee.propertyOf = ve, ee.pull = Gl, ee.pullAll = bs, ee.pullAllBy = tp, ee.pullAllWith = np, ee.pullAt = Wa, ee.range = De, ee.rangeRight = He, ee.rearg = yp, ee.reject = Dv, ee.remove = N0, ee.rest = lh, ee.reverse = Go, ee.sampleSize = Lv, ee.set = ph, ee.setWith = Ap, ee.shuffle = F0, ee.slice = pf, ee.sortBy = ah, ee.sortedUniq = th, ee.sortedUniqBy = M0, ee.split = wh, ee.spread = vp, ee.tail = Ov, ee.take = zv, ee.takeRight = hn, ee.takeRightWhile = Tn, ee.takeWhile = Gt, ee.tap = R0, ee.throttle = Xo, ee.thru = Kl, ee.toArray = ny, ee.toPairs = gh, ee.toPairsIn = Of, ee.toPath = je, ee.toPlainObject = dh, ee.transform = dy, ee.unary = ws, ee.union = Wt, ee.unionBy = vn, ee.unionWith = Yi, ee.uniq = Vo, ee.uniqBy = Xu, ee.uniqWith = rp, ee.unset = hy, ee.unzip = Xa, ee.unzipWith = er, ee.update = tx, ee.updateWith = my, ee.values = oc, ee.valuesIn = Mp, ee.without = Ko, ee.words = Cy, ee.wrap = Ef, ee.xor = Vl, ee.xorBy = ip, ee.xorWith = Wi, ee.zip = Qu, ee.zipObject = vf, ee.zipObjectDeep = Ei, ee.zipWith = ap, ee.entries = gh, ee.entriesIn = Of, ee.extend = hh, ee.extendWith = nc, i(ee, ee), ee.add = ze, ee.attempt = Lp, ee.camelCase = xh, ee.capitalize = py, ee.ceil = Ke, ee.clamp = nx, ee.clone = H0, ee.cloneDeep = V0, ee.cloneDeepWith = K0, ee.cloneWith = G0, ee.conformsTo = Uv, ee.deburr = lc, ee.defaultTo = Sh, ee.divide = St, ee.endsWith = rx, ee.eq = Qi, ee.escape = gy, ee.escapeRegExp = yy, ee.every = bf, ee.find = Xi, ee.findIndex = Zm, ee.findKey = sy, ee.findLast = z0, ee.findLastIndex = Jm, ee.findLastKey = Rf, ee.floor = cn, ee.forEach = L0, ee.forEachRight = to, ee.forIn = Na, ee.forInRight = oy, ee.forOwn = mh, ee.forOwnRight = ro, ee.get = Jo, ee.gt = Y0, ee.gte = W0, ee.has = ly, ee.hasIn = Tp, ee.head = ep, ee.identity = fi, ee.includes = up, ee.indexOf = C0, ee.inRange = yh, ee.invoke = Zv, ee.isArguments = Wl, ee.isArray = zt, ee.isArrayBuffer = xp, ee.isArrayLike = Ni, ee.isArrayLikeObject = pr, ee.isBoolean = kf, ee.isBuffer = Qo, ee.isDate = X0, ee.isElement = Vt, ee.isEmpty = bp, ee.isEqual = uh, ee.isEqualWith = wp, ee.isError = ch, ee.isFinite = _p, ee.isFunction = Zi, ee.isInteger = Nf, ee.isLength = fh, ee.isMap = Q0, ee.isMatch = Z0, ee.isMatchWith = J0, ee.isNaN = _n, ee.isNative = Sp, ee.isNil = $v, ee.isNull = Gr, ee.isNumber = Cp, ee.isObject = Gn, ee.isObjectLike = ir, ee.isPlainObject = jf, ee.isRegExp = Tf, ee.isSafeInteger = Ep, ee.isSet = Af, ee.isString = Mf, ee.isSymbol = ji, ee.isTypedArray = Zo, ee.isUndefined = kp, ee.isWeakMap = Hv, ee.isWeakSet = ey, ee.join = E0, ee.kebabCase = vy, ee.last = qn, ee.lastIndexOf = k0, ee.lowerCase = xy, ee.lowerFirst = Rp, ee.lt = Gv, ee.lte = ty, ee.max = xt, ee.maxBy = Ft, ee.mean = Xt, ee.meanBy = fn, ee.min = il, ee.minBy = ux, ee.stubArray = Ye, ee.stubFalse = Le, ee.stubObject = Fe, ee.stubString = yt, ee.stubTrue = kt, ee.multiply = rO, ee.nth = Js, ee.noConflict = s, ee.noop = u, ee.now = _f, ee.pad = by, ee.padEnd = wy, ee.padStart = bh, ee.parseInt = ix, ee.random = vh, ee.reduce = ih, ee.reduceRight = cp, ee.repeat = ax, ee.replace = Op, ee.result = fy, ee.round = iO, ee.runInContext = F, ee.sample = Iv, ee.size = U0, ee.snakeCase = zp, ee.some = ec, ee.sortedIndex = gf, ee.sortedIndexBy = Wu, ee.sortedIndexOf = j0, ee.sortedLastIndex = T0, ee.sortedLastIndexBy = yf, ee.sortedLastIndexOf = A0, ee.startCase = Dp, ee.startsWith = _y, ee.subtract = aO, ee.sum = sO, ee.sumBy = oO, ee.template = Ip, ee.times = Sn, ee.toFinite = no, ee.toInteger = Tt, ee.toLength = Np, ee.toLower = el, ee.toNumber = Ji, ee.toSafeInteger = Vv, ee.toString = gn, ee.toUpper = tl, ee.trim = nl, ee.trimEnd = zf, ee.trimStart = Df, ee.truncate = rl, ee.unescape = sx, ee.uniqueId = Ee, ee.upperCase = Sy, ee.upperFirst = Xl, ee.each = L0, ee.eachRight = to, ee.first = ep, i(ee, (function() {
          var f = {};
          return Ha(ee, function(v, S) {
            Ge.call(ee.prototype, S) || (f[S] = v);
          }), f;
        })(), { chain: !1 }), ee.VERSION = r, Lr(["bind", "bindKey", "curry", "curryRight", "partial", "partialRight"], function(f) {
          ee[f].placeholder = ee;
        }), Lr(["drop", "take"], function(f, v) {
          Lt.prototype[f] = function(S) {
            S = S === n ? 1 : tr(Tt(S), 0);
            var O = this.__filtered__ && !v ? new Lt(this) : this.clone();
            return O.__filtered__ ? O.__takeCount__ = xr(S, O.__takeCount__) : O.__views__.push({
              size: xr(S, U),
              type: f + (O.__dir__ < 0 ? "Right" : "")
            }), O;
          }, Lt.prototype[f + "Right"] = function(S) {
            return this.reverse()[f](S).reverse();
          };
        }), Lr(["filter", "map", "takeWhile"], function(f, v) {
          var S = v + 1, O = S == H || S == Z;
          Lt.prototype[f] = function($) {
            var ae = this.clone();
            return ae.__iteratees__.push({
              iteratee: Ct($, 3),
              type: S
            }), ae.__filtered__ = ae.__filtered__ || O, ae;
          };
        }), Lr(["head", "last"], function(f, v) {
          var S = "take" + (v ? "Right" : "");
          Lt.prototype[f] = function() {
            return this[S](1).value()[0];
          };
        }), Lr(["initial", "tail"], function(f, v) {
          var S = "drop" + (v ? "" : "Right");
          Lt.prototype[f] = function() {
            return this.__filtered__ ? new Lt(this) : this[S](1);
          };
        }), Lt.prototype.compact = function() {
          return this.filter(fi);
        }, Lt.prototype.find = function(f) {
          return this.filter(f).head();
        }, Lt.prototype.findLast = function(f) {
          return this.reverse().find(f);
        }, Lt.prototype.invokeMap = qt(function(f, v) {
          return typeof f == "function" ? new Lt(this) : this.map(function(S) {
            return Ca(S, f, v);
          });
        }), Lt.prototype.reject = function(f) {
          return this.filter(oh(Ct(f)));
        }, Lt.prototype.slice = function(f, v) {
          f = Tt(f);
          var S = this;
          return S.__filtered__ && (f > 0 || v < 0) ? new Lt(S) : (f < 0 ? S = S.takeRight(-f) : f && (S = S.drop(f)), v !== n && (v = Tt(v), S = v < 0 ? S.dropRight(-v) : S.take(v - f)), S);
        }, Lt.prototype.takeRightWhile = function(f) {
          return this.reverse().takeWhile(f).reverse();
        }, Lt.prototype.toArray = function() {
          return this.take(U);
        }, Ha(Lt.prototype, function(f, v) {
          var S = /^(?:filter|find|map|reject)|While$/.test(v), O = /^(?:head|last)$/.test(v), $ = ee[O ? "take" + (v == "last" ? "Right" : "") : v], ae = O || /^find/.test(v);
          $ && (ee.prototype[v] = function() {
            var pe = this.__wrapped__, Ce = O ? [1] : arguments, Ae = pe instanceof Lt, Xe = Ce[0], Qe = Ae || zt(pe), et = function(en) {
              var ln = $.apply(ee, qi([en], Ce));
              return O && ft ? ln[0] : ln;
            };
            Qe && S && typeof Xe == "function" && Xe.length != 1 && (Ae = Qe = !1);
            var ft = this.__chain__, wt = !!this.__actions__.length, At = ae && !ft, $t = Ae && !wt;
            if (!ae && Qe) {
              pe = $t ? pe : new Lt(this);
              var Mt = f.apply(pe, Ce);
              return Mt.__actions__.push({ func: Kl, args: [et], thisArg: n }), new xi(Mt, ft);
            }
            return At && $t ? f.apply(this, Ce) : (Mt = this.thru(et), At ? O ? Mt.value()[0] : Mt.value() : Mt);
          });
        }), Lr(["pop", "push", "shift", "sort", "splice", "unshift"], function(f) {
          var v = Ie[f], S = /^(?:push|sort|unshift)$/.test(f) ? "tap" : "thru", O = /^(?:pop|shift)$/.test(f);
          ee.prototype[f] = function() {
            var $ = arguments;
            if (O && !this.__chain__) {
              var ae = this.value();
              return v.apply(zt(ae) ? ae : [], $);
            }
            return this[S](function(pe) {
              return v.apply(zt(pe) ? pe : [], $);
            });
          };
        }), Ha(Lt.prototype, function(f, v) {
          var S = ee[v];
          if (S) {
            var O = S.name + "";
            Ge.call(pn, O) || (pn[O] = []), pn[O].push({ name: v, func: S });
          }
        }), pn[Vu(n, j).name] = [{
          name: "wrapper",
          func: n
        }], Lt.prototype.clone = Hs, Lt.prototype.reverse = Lo, Lt.prototype.value = Gs, ee.prototype.at = nh, ee.prototype.chain = Yo, ee.prototype.commit = Er, ee.prototype.next = Wo, ee.prototype.plant = eo, ee.prototype.reverse = sp, ee.prototype.toJSON = ee.prototype.valueOf = ee.prototype.value = op, ee.prototype.first = ee.prototype.head, Fr && (ee.prototype[Fr] = Zu), ee;
      }), oe = W();
      Pi ? ((Pi.exports = oe)._ = oe, kl._ = oe) : Zn._ = oe;
    }).call(kI);
  })(Zp, Zp.exports)), Zp.exports;
}
var jI = NI();
const ao = "SyncService", TI = 3e3, _x = "webllm", $f = class $f {
  constructor() {
    mt(this, "debouncedUploads", /* @__PURE__ */ new Map());
    mt(this, "deviceId");
    this.deviceId = Math.random().toString(36).substring(2, 15), ye.info(ao, `Initialized with Device ID: ${this.deviceId}`);
  }
  static getInstance() {
    return $f.instance || ($f.instance = new $f()), $f.instance;
  }
  /**
   *  Collection ID
   * : engram_sync_{chatId}
   */
  getCollectionId(t) {
    return `engram_sync_${t}`;
  }
  /**
   * 
   */
  scheduleUpload(t) {
    const n = nt.getSettings().syncConfig;
    if (!(n != null && n.enabled) || !(n != null && n.autoSync))
      return;
    if (!this.debouncedUploads.has(t)) {
      const a = jI.debounce(() => {
        const o = nt.getSettings().syncConfig;
        !(o != null && o.enabled) || !(o != null && o.autoSync) || this.upload(t).catch((l) => {
          ye.error(ao, `Auto-upload failed for ${t}`, l);
        });
      }, TI);
      this.debouncedUploads.set(t, a);
    }
    const r = this.debouncedUploads.get(t);
    r && r();
  }
  /**
   *  Vector Store
   */
  async upload(t) {
    try {
      ye.info(ao, `Starting upload for ${t}...`);
      const n = await hl(t), r = await q7(n), a = Date.now(), o = {
        collectionId: this.getCollectionId(t),
        source: _x,
        items: [{
          hash: 0,
          // Hack:  Item
          index: 0,
          text: JSON.stringify({
            ...r,
            meta: { ...r.meta, syncTimestamp: a, deviceId: this.deviceId }
          })
        }]
      };
      await this.purge(t);
      const l = await fetch("/api/vectors/insert", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(o)
      });
      if (!l.ok)
        throw new Error(`Upload failed: ${l.statusText}`);
      return ye.info(ao, `Upload success for ${t} at ${new Date(a).toLocaleString()}`), !0;
    } catch (n) {
      return ye.error(ao, `Upload error for ${t}`, n), !1;
    }
  }
  /**
   * 
   */
  async purge(t) {
    try {
      await fetch("/api/vectors/purge", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          collectionId: this.getCollectionId(t)
        })
      });
    } catch {
    }
  }
  /**
   * 
   */
  async getRemoteStatus(t) {
    var n, r;
    try {
      const a = await fetch("/api/vectors/query", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          collectionId: this.getCollectionId(t),
          searchText: "dummy",
          // webllm  embedding
          source: _x,
          topK: 1
        })
      });
      if (!a.ok) return { exists: !1, timestamp: 0 };
      const l = await a.json();
      if (!l.metadata || l.metadata.length === 0)
        return { exists: !1, timestamp: 0 };
      const c = JSON.parse(l.metadata[0].text);
      return {
        exists: !0,
        timestamp: ((n = c.meta) == null ? void 0 : n.syncTimestamp) || 0,
        deviceId: (r = c.meta) == null ? void 0 : r.deviceId
      };
    } catch (a) {
      return ye.warn(ao, `Check status failed for ${t}`, a), { exists: !1, timestamp: 0 };
    }
  }
  /**
   * 
   */
  async download(t) {
    try {
      ye.info(ao, `Downloading for ${t}...`);
      const n = await fetch("/api/vectors/query", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          collectionId: this.getCollectionId(t),
          searchText: "dummy",
          source: _x,
          topK: 1
        })
      });
      if (!n.ok) throw new Error("Download request failed");
      const r = await n.json();
      if (!r.metadata || r.metadata.length === 0)
        return ye.warn(ao, `No remote data found for ${t}`), !1;
      const a = JSON.parse(r.metadata[0].text), o = await hl(t);
      return await B7(o, a), ye.info(ao, `Import success for ${t}`), !0;
    } catch (n) {
      return ye.error(ao, `Download failed for ${t}`, n), !1;
    }
  }
  /**
   * 
   * @returns 'downloaded' | 'uploaded' | 'synced' | 'error' | 'ignored'
   */
  async autoSync(t) {
    const n = await this.getRemoteStatus(t);
    if (!n.exists)
      return "ignored";
    const a = await (await hl(t)).meta.toArray(), o = a.length > 0 ? a[0] : null, l = (o == null ? void 0 : o.syncTimestamp) || 0;
    return n.deviceId === this.deviceId ? "synced" : n.timestamp > l ? (ye.info(ao, `Remote is newer (${n.timestamp} > ${l}), downloading...`), await this.download(t) ? "downloaded" : "error") : "synced";
  }
};
mt($f, "instance");
let u1 = $f;
const Bf = u1.getInstance(), AI = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  SyncService: u1,
  syncService: Bf
}, Symbol.toStringTag, { value: "Module" }));
class P7 extends mg {
  constructor(n) {
    super(`Engram_${n}`);
    mt(this, "events");
    mt(this, "entities");
    mt(this, "meta");
    mt(this, "chatId");
    this.chatId = n, this.version(2).stores({
      // Events: 
      events: "id, timestamp, significance_score, level",
      // Entities:  (V0.9.4:  aliases )
      entities: "id, type, name, *aliases",
      // Meta:  (lastSummarizedFloor )
      meta: "key"
    }), this.events.hook("creating", () => {
      Bf.scheduleUpload(this.chatId);
    }), this.events.hook("updating", () => {
      Bf.scheduleUpload(this.chatId);
    }), this.events.hook("deleting", () => {
      Bf.scheduleUpload(this.chatId);
    }), this.entities.hook("creating", () => {
      Bf.scheduleUpload(this.chatId);
    }), this.entities.hook("updating", () => {
      Bf.scheduleUpload(this.chatId);
    }), this.entities.hook("deleting", () => {
      Bf.scheduleUpload(this.chatId);
    });
  }
}
async function q7(e) {
  const t = await e.events.toArray(), n = await e.entities.toArray(), a = (await e.meta.toArray()).reduce((o, l) => ({ ...o, [l.key]: l.value }), {});
  return { events: t, entities: n, meta: a };
}
async function B7(e, t) {
  await e.transaction("rw", e.events, e.entities, e.meta, async () => {
    await e.events.clear(), await e.entities.clear(), await e.meta.clear(), await e.events.bulkAdd(t.events), await e.entities.bulkAdd(t.entities);
    const n = Object.entries(t.meta || {}).map(([r, a]) => ({ key: r, value: a }));
    await e.meta.bulkAdd(n);
  });
}
const Wf = /* @__PURE__ */ new Map();
function hl(e) {
  if (!e)
    throw new Error("[Engram DB] chatId is required");
  return Wf.has(e) || (console.debug(`[Engram DB] Creating database for chat: ${e}`), Wf.set(e, new P7(e))), Wf.get(e);
}
function F7(e) {
  const t = Wf.get(e);
  t && (t.close(), Wf.delete(e), console.debug(`[Engram DB] Closed database for chat: ${e}`));
}
function MI(e) {
  return Wf.has(e);
}
function yc(e) {
  return Wf.get(e) || null;
}
async function RI(e) {
  F7(e), await mg.delete(`Engram_${e}`), console.info(`[Engram DB] Deleted database for chat: ${e}`);
}
const OI = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  ChatDatabase: P7,
  closeDb: F7,
  deleteDatabase: RI,
  exportChatData: q7,
  getDbForChat: hl,
  hasDbForChat: MI,
  importChatData: B7,
  tryGetDbForChat: yc
}, Symbol.toStringTag, { value: "Module" }));
class zI {
  async search(t) {
    const n = t.toLowerCase().trim();
    if (!n || n.length < 2) return [];
    const r = hi();
    if (!r) return [];
    const a = yc(r);
    if (!a) return [];
    try {
      return (await a.events.filter((l) => l.summary.toLowerCase().includes(n)).reverse().limit(5).toArray()).map((l) => ({
        id: `memory-${l.id}`,
        type: "memory",
        title: l.summary.slice(0, 50) + (l.summary.length > 50 ? "..." : ""),
        description: new Date(l.timestamp).toLocaleString(),
        icon: em,
        action: (c) => c("/memory"),
        // TODO: Nav to specific item?
        score: 5
        // Lower score than exact commands
      }));
    } catch (o) {
      return console.error("Memory search failed", o), [];
    }
  }
}
class DI {
  async search(t) {
    const n = t.toLowerCase().trim();
    if (!n) return [];
    const r = [];
    return (nt.get("promptTemplates") || []).forEach((o) => {
      o.name.toLowerCase().includes(n) && r.push({
        id: `template-${o.id}`,
        type: "setting",
        // or 'template'
        title: `: ${o.name}`,
        description: `Prompt Template (${o.category})`,
        icon: em,
        action: (l) => l("presets:prompt"),
        // Ideally navigates to specific template
        score: 7
      });
    }), r;
  }
}
window.__ENGRAM_SEARCH_INIT__ || (Oh.registerAdapter(new z7()), Oh.registerAdapter(new bI()), Oh.registerAdapter(new wI()), Oh.registerAdapter(new zI()), Oh.registerAdapter(new DI()), window.__ENGRAM_SEARCH_INIT__ = !0);
const II = ({ onNavigate: e }) => {
  const [t, n] = G.useState(""), [r, a] = G.useState(!1), [o, l] = G.useState(0), [c, d] = G.useState([]), h = G.useRef(null);
  G.useEffect(() => {
    (async () => {
      if (!t.trim()) {
        const N = await new z7().search("");
        d(N);
        return;
      }
      const C = await Oh.search(t);
      d(C), l(0);
    })();
  }, [t, r]), G.useEffect(() => {
    const b = (C) => {
      (C.metaKey || C.ctrlKey) && C.key === "k" && (C.preventDefault(), a(!0));
    };
    return window.addEventListener("keydown", b), () => window.removeEventListener("keydown", b);
  }, []), G.useEffect(() => {
    r && setTimeout(() => {
      var b;
      return (b = h.current) == null ? void 0 : b.focus();
    }, 50);
  }, [r]);
  const p = (b) => {
    const C = c.length + (t ? 1 : 0);
    switch (b.key) {
      case "ArrowDown":
        b.preventDefault(), l((N) => (N + 1) % C);
        break;
      case "ArrowUp":
        b.preventDefault(), l((N) => (N - 1 + C) % C);
        break;
      case "Enter":
        b.preventDefault(), g();
        break;
      case "Escape":
        a(!1);
        break;
    }
  }, g = () => {
    c.length > 0 && o < c.length ? c[o].action(e) : t && (console.log("Searching memory for:", t), e("/memory")), a(!1), n("");
  }, x = /* @__PURE__ */ m.jsx(
    "div",
    {
      className: "fixed inset-0 flex items-start justify-center pt-[15vh] px-4 animate-in fade-in duration-200",
      style: {
        height: "100dvh",
        width: "100vw",
        backgroundColor: "rgba(0,0,0,0.4)",
        // Slightly more transparent to not feel too heavy
        backdropFilter: "var(--glass-backdrop-filter, blur(4px))",
        zIndex: 2147483647
        // Max safe integer to ensure it's on top of SillyTavern UI
      },
      onClick: (b) => {
        b.target === b.currentTarget && a(!1);
      },
      children: /* @__PURE__ */ m.jsxs(
        "div",
        {
          className: "w-full max-w-xl border border-border rounded-xl shadow-2xl overflow-hidden flex flex-col animate-in zoom-in-95 slide-in-from-top-4 duration-200",
          style: {
            backgroundColor: "var(--popover)",
            color: "var(--popover-foreground)",
            backdropFilter: "var(--glass-backdrop-filter)",
            maxHeight: "70vh"
          },
          children: [
            /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-3 px-4 py-3 border-b border-border/50", children: [
              /* @__PURE__ */ m.jsx(Es, { size: 20, className: "text-muted-foreground shrink-0" }),
              /* @__PURE__ */ m.jsx(
                "input",
                {
                  ref: h,
                  type: "text",
                  className: "flex-1 bg-transparent border-none outline-none text-lg text-foreground placeholder:text-muted-foreground/50",
                  placeholder: "...",
                  value: t,
                  onChange: (b) => n(b.target.value),
                  onKeyDown: p
                }
              ),
              /* @__PURE__ */ m.jsx("div", { className: "text-[10px] text-muted-foreground border border-border px-1.5 py-0.5 rounded bg-muted/50 hidden sm:block", children: "ESC" })
            ] }),
            /* @__PURE__ */ m.jsxs("div", { className: "overflow-y-auto p-2 scroll-smooth", children: [
              c.length > 0 && /* @__PURE__ */ m.jsx("div", { className: "space-y-1", children: c.map((b, C) => /* @__PURE__ */ m.jsxs(
                "div",
                {
                  className: `flex items-center gap-3 px-3 py-2.5 rounded-lg cursor-pointer transition-colors ${C === o ? "bg-primary/10 text-primary" : "text-foreground hover:bg-muted/50"}`,
                  onClick: () => {
                    b.action(e), a(!1), n("");
                  },
                  onMouseEnter: () => l(C),
                  children: [
                    /* @__PURE__ */ m.jsx("div", { className: `
                                        w-8 h-8 rounded-md flex items-center justify-center shrink-0
                                        ${C === o ? "bg-primary/20" : "bg-muted/50 text-muted-foreground"}
                                    `, children: b.icon ? /* @__PURE__ */ m.jsx(b.icon, { size: 16 }) : /* @__PURE__ */ m.jsx(H5, { size: 16 }) }),
                    /* @__PURE__ */ m.jsxs("div", { className: "flex-1 min-w-0", children: [
                      /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-2", children: [
                        /* @__PURE__ */ m.jsx("span", { className: "text-sm font-medium", children: b.title }),
                        b.type !== "command" && /* @__PURE__ */ m.jsx("span", { className: "text-[10px] px-1.5 py-0.5 rounded-full bg-muted text-muted-foreground uppercase", children: b.type })
                      ] }),
                      b.description && /* @__PURE__ */ m.jsx("div", { className: "text-xs text-muted-foreground/80 truncate", children: b.description })
                    ] }),
                    C === o && /* @__PURE__ */ m.jsx(G5, { size: 16, className: "text-muted-foreground/50" })
                  ]
                },
                b.id
              )) }),
              t && /* @__PURE__ */ m.jsxs(
                "div",
                {
                  className: `
                            mt-2 pt-2 border-t border-border/50
                            flex items-center gap-3 px-3 py-2.5 rounded-lg cursor-pointer transition-colors
                            ${o === c.length ? "bg-primary/10 text-primary" : "text-foreground hover:bg-muted/50"}
                        `,
                  onClick: () => g(),
                  onMouseEnter: () => l(c.length),
                  children: [
                    /* @__PURE__ */ m.jsx("div", { className: `w-8 h-8 rounded-md flex items-center justify-center shrink-0 ${o === c.length ? "bg-primary/20" : "bg-muted/50 text-muted-foreground"}`, children: /* @__PURE__ */ m.jsx(Es, { size: 16 }) }),
                    /* @__PURE__ */ m.jsxs("div", { className: "flex-1 min-w-0", children: [
                      /* @__PURE__ */ m.jsxs("div", { className: "text-sm font-medium", children: [
                        ': "',
                        /* @__PURE__ */ m.jsx("span", { className: "text-primary", children: t }),
                        '"'
                      ] }),
                      /* @__PURE__ */ m.jsx("div", { className: "text-xs text-muted-foreground/80", children: "..." })
                    ] }),
                    o === c.length && /* @__PURE__ */ m.jsx(G5, { size: 16, className: "text-muted-foreground/50" })
                  ]
                }
              ),
              c.length === 0 && !t && /* @__PURE__ */ m.jsxs("div", { className: "px-4 py-8 text-center text-muted-foreground text-sm", children: [
                /* @__PURE__ */ m.jsx(H5, { size: 32, className: "mx-auto mb-2 opacity-20" }),
                /* @__PURE__ */ m.jsx("p", { children: " (Cmd+K)" })
              ] })
            ] })
          ]
        }
      )
    }
  );
  return /* @__PURE__ */ m.jsxs(m.Fragment, { children: [
    /* @__PURE__ */ m.jsx(
      "button",
      {
        onClick: () => a(!0),
        className: "p-2 rounded-md hover:bg-accent hover:text-accent-foreground transition-colors text-muted-foreground",
        title: " (Cmd+K)",
        children: /* @__PURE__ */ m.jsx(Es, { size: 20 })
      }
    ),
    r && wS.createPortal(x, document.body)
  ] });
}, LI = ({ className: e = "", size: t = 24 }) => /* @__PURE__ */ m.jsx(
  "svg",
  {
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 400 592",
    width: t,
    height: t,
    className: e,
    "aria-label": "Engram Icon",
    children: /* @__PURE__ */ m.jsx(
      "path",
      {
        fill: "currentColor",
        d: `M103.875908,522.166260 
                C75.225380,521.276611 55.289425,503.229828 52.249313,475.852142 
                C49.879883,454.514191 63.027035,433.000366 83.930901,424.858398 
                C88.449257,423.098541 89.857674,420.860199 89.801926,416.150269 
                C89.555420,395.322357 89.621246,374.489380 89.762306,353.659515 
                C89.787170,349.987000 88.728760,348.057556 85.120293,346.642609 
                C64.672897,338.625031 52.338894,320.951630 52.085896,299.869415 
                C51.832878,278.785156 63.730618,260.903198 84.118019,252.449951 
                C88.288918,250.720566 89.867378,248.680847 89.807304,244.052597 
                C89.539139,223.391968 89.589142,202.724701 89.796356,182.062561 
                C89.836380,178.071609 88.518524,176.326385 84.841705,174.787247 
                C57.730556,163.438416 45.530682,135.966721 55.436111,109.194000 
                C62.627293,89.757439 81.922821,76.710289 103.282494,76.841476 
                C124.355003,76.970901 143.082275,89.740875 149.993118,109.121849 
                C151.315979,112.831749 153.184799,113.869263 156.863403,113.853104 
                C186.192612,113.724319 215.522736,113.698357 244.851929,113.811600 
                C248.773117,113.826736 250.677307,112.652130 252.052902,108.765602 
                C259.013885,89.098465 278.589447,76.365829 300.503601,76.811897 
                C322.171844,77.252960 341.040283,91.132324 347.255371,111.201912 
                C356.569763,141.279358 340.344788,170.373184 309.893127,176.623123 
                C283.359375,182.068970 260.376740,167.450562 251.980011,145.670181 
                C250.492157,141.810806 248.818085,140.240295 244.552948,140.266785 
                C215.390915,140.447968 186.227219,140.357330 157.064072,140.375076 
                C154.628784,140.376556 151.855545,139.805771 151.141357,143.359161 
                C150.400787,147.043839 146.628937,150.064713 151.136917,154.478546 
                C184.592346,187.235229 217.778336,220.267349 250.982285,253.280014 
                C253.021469,255.307434 254.527191,255.254166 257.033264,254.047714 
                C276.199188,244.820953 294.752930,247.045853 310.978485,259.993408 
                C328.011017,273.584869 333.936798,292.106659 327.764038,313.282837 
                C321.779785,333.812378 307.254517,345.637268 286.367889,349.037231 
                C276.405396,350.658997 266.352570,349.443024 257.275055,344.363342 
                C254.265045,342.678986 252.301132,343.049744 249.903275,345.441406 
                C230.205368,365.088531 210.395386,384.623230 190.631638,404.204376 
                C177.732651,416.984222 164.859726,429.790344 151.962982,442.572388 
                C148.257980,446.244415 148.113403,452.901764 151.629196,456.671387 
                C152.707138,457.827148 154.029282,457.681976 155.328629,457.681946 
                C185.658203,457.681458 215.987854,457.631042 246.317261,457.695557 
                C249.355972,457.702026 250.687012,456.399414 251.717636,453.698944 
                C259.314423,433.793579 278.324493,420.868317 299.341309,421.146240 
                C320.526215,421.426361 339.575745,434.206421 346.686249,452.909271 
                C354.337341,473.034058 348.794159,495.642761 332.699371,509.956390 
                C307.061371,532.757202 263.380280,521.715210 251.978027,489.436371 
                C250.838303,486.209961 249.371201,484.953583 245.964813,484.962799 
                C216.302094,485.043304 186.639008,484.985840 156.976028,484.969330 
                C154.436981,484.967896 152.081528,484.923981 150.916916,488.054077 
                C142.892441,509.621246 126.842339,520.325989 103.875908,522.166260 
                M141.430466,266.110352 
                C145.394760,270.906738 148.503693,276.196198 150.388428,282.139069 
                C151.211502,284.734314 152.692291,285.770782 155.494156,285.760895 
                C179.139755,285.677429 202.787949,285.547394 226.430206,285.843811 
                C232.373352,285.918304 231.388184,281.058533 233.335602,278.254700 
                C235.007233,275.847992 233.916855,274.189880 232.000244,272.304352 
                C199.956863,240.780380 167.866821,209.301468 136.133682,177.467056 
                C131.183243,172.500824 127.483856,170.729507 121.013550,174.621368 
                C117.660522,176.638214 116.183739,178.155136 116.217278,182.042480 
                C116.398239,203.022598 116.444160,224.006012 116.243645,244.985474 
                C116.204666,249.064667 117.676285,250.918961 121.328865,252.228989 
                C128.972488,254.970444 135.505173,259.524170 141.430466,266.110352 
                M116.349434,377.499908 
                C116.351860,390.663696 116.870338,403.855377 116.161102,416.980713 
                C115.742699,424.723846 121.926743,423.801880 125.649162,426.262665 
                C129.080231,428.530792 130.798965,425.706268 132.741440,423.784821 
                C165.551407,391.329803 198.234940,358.745361 231.274231,326.525696 
                C235.764252,322.147095 232.377243,319.155212 231.599960,315.493317 
                C230.884583,312.123138 228.193359,312.382568 225.670288,312.382812 
                C202.675171,312.384949 179.679749,312.445435 156.685303,312.323212 
                C153.331955,312.305389 151.624329,313.386505 150.456299,316.584381 
                C145.119888,331.194611 135.004120,341.287384 120.496223,346.769958 
                C117.238434,348.001068 116.190170,349.706024 116.267418,353.006317 
                C116.450615,360.833862 116.340004,368.668243 116.349434,377.499908z`
      }
    )
  }
), PI = ({
  onToggleSidebar: e,
  isMobile: t,
  // Deprecated prop, handled by CSS
  onClose: n,
  onNavigate: r
}) => /* @__PURE__ */ m.jsxs("header", { className: "h-10 flex items-center justify-between px-4 bg-transparent z-50 transition-all duration-300 w-full flex-shrink-0", children: [
  /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-3 w-16 md:w-64", children: [
    /* @__PURE__ */ m.jsx(
      "button",
      {
        className: "p-2 -ml-2 rounded-md hover:bg-sidebar-accent hover:text-sidebar-accent-foreground transition-colors md:hidden",
        onClick: e,
        title: "",
        children: /* @__PURE__ */ m.jsx(Lz, { size: 18 })
      }
    ),
    /* @__PURE__ */ m.jsxs("div", { className: "hidden md:flex items-center gap-2", children: [
      /* @__PURE__ */ m.jsx(LI, { size: 18, className: "text-primary" }),
      /* @__PURE__ */ m.jsx("span", { className: "font-semibold text-sidebar-foreground tracking-tight", children: "Engram" })
    ] })
  ] }),
  /* @__PURE__ */ m.jsx("div", { className: "flex-1" }),
  /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-1 md:gap-2", children: [
    /* @__PURE__ */ m.jsx(II, { onNavigate: r }),
    /* @__PURE__ */ m.jsx("div", { className: "h-4 w-[1px] bg-border mx-1" }),
    /* @__PURE__ */ m.jsx(
      "button",
      {
        className: "p-2 rounded-md hover:bg-destructive hover:text-destructive-foreground transition-colors text-muted-foreground",
        onClick: n,
        title: "",
        children: /* @__PURE__ */ m.jsx(tm, { size: 20 })
      }
    )
  ] })
] }), qI = ({ className: e = "", height: t = 24 }) => {
  const n = Math.round(t * 3.17);
  return /* @__PURE__ */ m.jsxs(
    "svg",
    {
      xmlns: "http://www.w3.org/2000/svg",
      viewBox: "235 175 555 175",
      width: n,
      height: t,
      className: e,
      "aria-label": "Engram",
      children: [
        /* @__PURE__ */ m.jsx("path", { fill: "currentColor", d: "M752.3,294.5c-0.2-11.8-0.3-23.1-0.4-34.4c0-2.7,0-5.3-0.2-8c-0.6-6.4-4.1-10.1-9.8-10.9 c-6.9-0.9-12.2,2-14.5,7.9c-1,2.5-1.2,5.2-1.2,7.9c0,11,-0.3,22,0,33c0.1,5.2-1.7,6.9-6.7,6.4c-3.3-0.3-6.7-0.3-10,0 c-4.9,0.5-5.9-1.9-5.8-6.2c0.2-11.8,0.2-23.7,0-35.5c-0.2-9.4-5.4-14.3-14.1-13.5c-6.4,0.6-11.1,5.7-11.3,13 c-0.3,11.7-0.2,23.3-0.3,35c0,7.1,0,7.1-7.3,7.1c-3.3,0-6.7-0.1-10,0c-3.3,0.1-4.9-1.1-4.9-4.6c0.1-21.5,0-43-0.1-64.5 c0-2.9,1.3-4.3,4.2-4.3c3.2,0,6.3-0.1,9.5,0.1c4,0,8.8-1,7.5,6.6c8.6-6.1,16.9-8.7,26.3-7c5.2,1,10.1,2.7,13.7,6.6 c2.8,2.9,4.6,2.4,7.4,0c6.8-5.8,15-7.9,23.8-6.9c16.3,1.8,25.1,11.7,25.8,29.5c0.5,13.3,0.1,26.6,0.2,40 c0,3.4-1.2,5.1-4.7,4.7C763.8,295.7,757.9,298,752.3,294.5z" }),
        /* @__PURE__ */ m.jsx("path", { fill: "currentColor", d: "M463.1,324.1c-10.8-0.7-20.9-2.4-30.2-7.5c-3.6-2-5-4-2.4-7.8c2.3-3.4,4.1-7.1,6.5-11.3 c6.1,3.6,11.8,6.8,18.5,7.7c5.3,0.7,10.6,1.1,15.8-0.5c8.3-2.6,12.2-9.1,10.9-18.6c-9.1,7.5-19.3,8.6-30.2,6.4 c-7.8-1.6-14.2-5.6-19.2-11.8c-10.5-12.8-10.6-32.5-0.5-45.5c11.2-14.3,28.6-16.4,50.9-6.1c-0.4-6.2,3.5-6.3,8.1-6.2 c13,0.2,13,0.1,13,13c0,16.3-0.5,32.7,0.1,49C505.4,309.3,491.3,322.1,467.6,324C466.2,324.1,464.9,324.1,463.1,324.1z M482.1,252.6 c-0.6-2.1-1.6-4-3-5.7c-4.6-6-13.5-8.4-21.2-5.5c-7.4,2.7-11.1,8.9-10.6,17.8c0.4,7.4,5.7,13.5,13.6,15.2 C474.1,277.2,485.2,266.4,482.1,252.6z" }),
        /* @__PURE__ */ m.jsx("path", { fill: "currentColor", d: "M258.1,201.6c20.3,0,40.1,0.1,60-0.1c4.5,0,6.3,1.3,6.1,5.9c-0.4,14.6,2.1,12.6-12.7,12.7 c-10.7,0.1-21.3,0.1-32-0.1c-3.8-0.1-5.2,1-5.3,5.1c0,13.4-0.2,13.4,13.4,13.4c8.7,0,17.3,0.1,26,0c3.4-0.1,4.7,1.2,4.7,4.7 c-0.2,16.4,1.9,13.7-13.1,13.9c-8.8,0.1-17.7,0.1-26.5,0c-3.2,0-4.6,1.1-4.4,4.4c0.2,3.8,0.2,7.7,0,11.5 c-0.2,3.5,1.1,4.7,4.6,4.7c13.7-0.1,27.3,0.2,41-0.1c5.1-0.1,6.6,1.5,6.5,6.5c-0.2,12.3,0,12.3-12.1,12.3 c-18.7-0.1-37.3-0.2-56,0c-4.9,0.1-6.7-1.2-6.7-6.4c0.2-27.5,0.2-55,0-82.5C251.6,203,253,200.9,258.1,201.6z" }),
        /* @__PURE__ */ m.jsx("path", { fill: "currentColor", d: "M599.5,239.6c-5.6,0.9-10.6,2.1-15,4.9c-2.5,1.6-4,0.9-5.1-1.6c-0.9-2-1.9-3.9-2.9-5.8 c-3.1-6.1-3-6.4,3-9.3c11.6-5.6,23.9-7.1,36.5-4.6c15.1,2.9,23.6,12.8,24.1,28.7c0.4,13.3,0.1,26.6,0.2,40 c0,3.5-1.5,4.8-4.8,4.6c-3,0-6,0-9,0.1c-4.2,0.2-8.1,0.2-6.6-6.6c-12.4,9.5-24.9,10.4-37.7,3.9c-8.5-4.3-11.9-12-11.3-21.2 c0.6-9.1,5.9-15,14.4-17.9c5.7-1.9,11.6-2.8,17.7-2.8c4.6,0,9.3,0.5,13.8-0.4c1.9-7.2-7.4-13.5-17.2-11.9 M617.7,271.9 c-0.1-2.5,1-5.8-3.3-5.8c-5,0-10-0.1-15,0.2c-4,0.3-6.9,2.4-7.1,6.9c-0.2,4.5,2.2,7.2,6.3,8.4C606.5,283.8,613.8,280.3,617.7,271.9z" }),
        /* @__PURE__ */ m.jsx("path", { fill: "currentColor", d: "M346.2,222.9c2.6,0,4.8,0.1,7,0c4.7-0.4,8.1,0.7,7,7.3c6-4,11.6-7.1,18.2-7.9c18.2-2.1,34.8,7.7,35,29.4 c0.1,13.2-0.1,26.3,0.1,39.5c0,3.9-1.2,5.5-5.2,5.2c-4,0-8,0-12,0.2c-3.5,0.2-4.7-1.3-4.7-4.7c0.1-10.3,0.1-20.7,0-31 c0-2.3-0.1-4.7-0.5-7c-1.3-8.4-5.4-12.3-12.9-12.6c-8.4-0.3-14.3,3.9-16,11.9c-2,9.6-0.7,19.3-0.9,28.9 c-0.2,14.4,0,14.4-14.4,14.4c-7.8,0-7.9,0-7.9-8c0-19.5,0-39,0-58.5C339,223.3,339.2,223.2,346.2,222.9z" }),
        /* @__PURE__ */ m.jsx("path", { fill: "currentColor", d: "M543.2,258.4c-0.1,11.1-0.3,21.8-0.2,32.4c0,4-1.2,5.9-5.4,5.6c-4.3-0.3-8.7-0.1-13-0.1 c-2.7,0-3.9-1.3-3.9-4c0-21.8,0-43.6,0-65.5c0-2.8,1.3-3.9,3.9-4c2.8,0,5.7,0,8.5-0.1c4.8-0.2,9.6-0.5,8.7,6.4 c2.1,0.8,2.8-0.7,3.9-1.3c2.3-1.2,4.5-2.8,7-3.8c11.8-4.7,14.3-3,14.3,9.3c0,0.8-0.1,1.7,0,2.5c0.6,4.6-1,6.4-6,6.5 C550,242.6,544.8,247.5,543.2,258.4z" })
      ]
    }
  );
}, BI = "0.9.6", U7 = {
  version: BI
}, hC = ({
  activeTab: e,
  onNavigate: t,
  isMobile: n,
  isOpen: r = !1,
  onClose: a,
  onShowUpdateNotice: o,
  hasUnreadUpdate: l
}) => {
  const c = (h) => {
    t(h), n && a && a();
  }, d = () => /* @__PURE__ */ m.jsxs("div", { className: "pt-4 border-t border-border/30 mt-2 space-y-2", children: [
    /* @__PURE__ */ m.jsxs(
      "button",
      {
        onClick: o,
        className: "w-full flex items-center gap-2 px-2 py-1.5 rounded-lg transition-all duration-200 text-muted-foreground hover:text-foreground hover:bg-muted/10 text-left",
        children: [
          /* @__PURE__ */ m.jsxs("div", { className: "relative", children: [
            /* @__PURE__ */ m.jsx(AO, { size: 16, strokeWidth: 1.5 }),
            l && /* @__PURE__ */ m.jsx("span", { className: "absolute -top-1 -right-1 w-2 h-2 bg-red-500 rounded-full animate-pulse" })
          ] }),
          /* @__PURE__ */ m.jsx("span", { className: "text-xs", children: "" }),
          l && /* @__PURE__ */ m.jsx("span", { className: "ml-auto text-[10px] px-1.5 py-0.5 bg-primary/20 text-primary rounded-full", children: "NEW" })
        ]
      }
    ),
    /* @__PURE__ */ m.jsxs(
      "a",
      {
        href: "https://github.com/shiyue137mh-netizen/Engram",
        target: "_blank",
        rel: "noopener noreferrer",
        className: "group w-full flex items-center gap-2 px-2 py-1.5 rounded-lg transition-all duration-200 text-muted-foreground hover:text-foreground hover:bg-muted/10",
        title: "",
        children: [
          /* @__PURE__ */ m.jsx(gz, { size: 16, strokeWidth: 1.5, className: "group-hover:text-primary transition-colors" }),
          /* @__PURE__ */ m.jsx("span", { className: "text-xs", children: "GitHub" }),
          /* @__PURE__ */ m.jsx("span", { className: "ml-auto text-[10px] text-primary opacity-0 group-hover:opacity-100 transition-opacity", children: "Star " })
        ]
      }
    ),
    /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-2 px-2 py-1 opacity-50", children: [
      /* @__PURE__ */ m.jsx(qI, { height: 12 }),
      /* @__PURE__ */ m.jsxs("span", { className: "text-[10px] text-muted-foreground font-mono", children: [
        "v",
        U7.version
      ] })
    ] })
  ] });
  return n && !r ? null : n ? /* @__PURE__ */ m.jsxs(
    "div",
    {
      className: "fixed inset-0 z-[60] flex justify-start",
      style: { height: "100dvh", width: "100vw" },
      children: [
        /* @__PURE__ */ m.jsx(
          "div",
          {
            className: "absolute inset-0 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",
            onClick: a
          }
        ),
        /* @__PURE__ */ m.jsxs(
          "div",
          {
            id: "mobile-menu-drawer",
            className: "relative w-64 max-w-[80vw] h-full bg-sidebar border-r border-border shadow-2xl flex flex-col p-6 animate-in slide-in-from-left duration-300",
            style: { height: "100dvh" },
            children: [
              /* @__PURE__ */ m.jsxs("div", { className: "flex justify-between items-center mb-8", children: [
                /* @__PURE__ */ m.jsx("span", { className: "text-lg font-semibold text-sidebar-foreground/80", children: "" }),
                /* @__PURE__ */ m.jsx(
                  "button",
                  {
                    onClick: a,
                    className: "p-2 -mr-2 rounded-md hover:bg-sidebar-accent text-muted-foreground hover:text-sidebar-accent-foreground transition-colors",
                    children: /* @__PURE__ */ m.jsx(tm, { size: 20 })
                  }
                )
              ] }),
              /* @__PURE__ */ m.jsx("nav", { className: "space-y-2 flex-1 overflow-y-auto", children: o1.map((h) => {
                const p = h.icon, g = e === h.id;
                return /* @__PURE__ */ m.jsxs(
                  "button",
                  {
                    onClick: () => c(h.id),
                    className: `
                                    w-full flex items-center gap-4 px-4 py-3 rounded-xl text-left transition-all duration-200
                                    ${g ? "bg-primary/10 text-primary font-medium" : "text-muted-foreground hover:bg-sidebar-accent hover:text-sidebar-foreground"}
                                `,
                    children: [
                      /* @__PURE__ */ m.jsx(p, { size: 22, className: g ? "text-primary" : "text-muted-foreground/70" }),
                      /* @__PURE__ */ m.jsx("span", { children: h.label })
                    ]
                  },
                  h.id
                );
              }) }),
              /* @__PURE__ */ m.jsx("div", { className: "mt-auto", children: /* @__PURE__ */ m.jsx(d, {}) })
            ]
          }
        )
      ]
    }
  ) : /* @__PURE__ */ m.jsxs("aside", { className: "[display:none] md:flex w-36 flex-shrink-0 bg-sidebar flex-col z-40 pt-4 px-2 border-r border-border/50 animate-in slide-in-from-left-4 fade-in duration-500 fill-mode-both", style: { animationDelay: "100ms", animationFillMode: "both" }, children: [
    /* @__PURE__ */ m.jsx("nav", { className: "flex-1 w-full flex flex-col gap-1 overflow-y-auto no-scrollbar", children: o1.map((h) => {
      const p = h.icon, g = e === h.id;
      return /* @__PURE__ */ m.jsxs(
        "button",
        {
          onClick: () => c(h.id),
          className: `
                                    w-full flex items-center gap-2 px-2 py-2 rounded-lg transition-all duration-200 text-left
                                    ${g ? "bg-primary/10 text-primary" : "text-muted-foreground hover:text-foreground hover:bg-muted/10"}
                                `,
          children: [
            /* @__PURE__ */ m.jsx(p, { size: 18, strokeWidth: g ? 2 : 1.5, className: "flex-shrink-0" }),
            /* @__PURE__ */ m.jsx("span", { className: `text-xs ${g ? "font-medium" : "font-normal"}`, children: h.label })
          ]
        },
        h.id
      );
    }) }),
    /* @__PURE__ */ m.jsx("div", { className: "pb-3", children: /* @__PURE__ */ m.jsx(d, {}) })
  ] });
}, Ay = {
  timeOut: 5e3,
  extendedTimeOut: 1e3,
  closeButton: !0,
  progressBar: !0
}, Hf = class Hf {
  constructor() {
  }
  static getInstance() {
    return Hf.instance || (Hf.instance = new Hf()), Hf.instance;
  }
  /**
   *  toastr 
   */
  getToastr() {
    return window.toastr || null;
  }
  /**
   * 
   */
  success(t, n = "Engram", r = {}) {
    const a = this.getToastr();
    a ? a.success(t, n, { ...Ay, ...r }) : console.log(`[Engram] SUCCESS: ${n} - ${t}`), ye.info("Notification", `Success: ${t}`);
  }
  /**
   * 
   */
  info(t, n = "Engram", r = {}) {
    const a = this.getToastr();
    a ? a.info(t, n, { ...Ay, ...r }) : console.log(`[Engram] INFO: ${n} - ${t}`), ye.info("Notification", `Info: ${t}`);
  }
  /**
   * 
   */
  warning(t, n = "Engram", r = {}) {
    const a = this.getToastr();
    a ? a.warning(t, n, { ...Ay, ...r }) : console.warn(`[Engram] WARNING: ${n} - ${t}`), ye.warn("Notification", `Warning: ${t}`);
  }
  /**
   * 
   */
  error(t, n = "Engram", r = {}) {
    const a = this.getToastr();
    a ? a.error(t, n, { ...Ay, timeOut: 8e3, ...r }) : console.error(`[Engram] ERROR: ${n} - ${t}`), ye.error("Notification", `Error: ${t}`);
  }
  /**
   * 
   * @param message 
   * @param title 
   * @param onCancel 
   * @returns toastr 
   */
  running(t, n = "Engram", r) {
    const a = this.getToastr();
    if (a) {
      const o = r ? `${t} <small style="opacity:0.7">()</small>` : t;
      return a.info(o, n, {
        timeOut: 2e4,
        //  20 
        extendedTimeOut: 0,
        // 
        closeButton: !1,
        // 
        progressBar: !0,
        // 
        tapToDismiss: !!r,
        // 
        onclick: r ? () => {
          ye.info("Notification", ""), r();
        } : void 0,
        escapeHtml: !1
        //  HTML
      });
    } else
      return console.log(`[Engram] RUNNING: ${n} - ${t}`), null;
  }
  /**
   *  toastr 
   */
  remove(t) {
    const n = this.getToastr();
    n && t && n.remove(t);
  }
  /**
   * 
   */
  clear() {
    const t = this.getToastr();
    t && t.clear();
  }
};
mt(Hf, "instance");
let A3 = Hf;
const Kt = A3.getInstance(), kh = {
  owner: "shiyue137mh-netizen",
  repo: "Engram",
  branch: "master"
}, My = U7.version;
let Fp = null, Up = null;
function Sx(e, t) {
  const n = e.split(".").map(Number), r = t.split(".").map(Number);
  for (let a = 0; a < Math.max(n.length, r.length); a++) {
    const o = n[a] || 0, l = r[a] || 0;
    if (o > l) return 1;
    if (o < l) return -1;
  }
  return 0;
}
class mc {
  /**
   * 
   */
  static getCurrentVersion() {
    return My;
  }
  /**
   *  GitHub 
   */
  static async getLatestVersion() {
    if (Fp)
      return Fp;
    try {
      const t = `https://raw.githubusercontent.com/${kh.owner}/${kh.repo}/${kh.branch}/manifest.json`, n = await fetch(t);
      return n.ok ? (Fp = (await n.json()).version || null, Fp) : null;
    } catch {
      return null;
    }
  }
  /**
   * 
   */
  static async hasUpdate() {
    const t = await this.getLatestVersion();
    return t ? Sx(t, My) > 0 : !1;
  }
  /**
   * 
   */
  static async getChangelog() {
    if (Up)
      return Up;
    try {
      const t = `https://raw.githubusercontent.com/${kh.owner}/${kh.repo}/${kh.branch}/CHANGELOG.md`, n = await fetch(t);
      return n.ok ? (Up = await n.text(), Up) : (console.warn("[Engram] UpdateService: ", n.status), Kt.warning(`: ${n.status}`, ""), null);
    } catch (t) {
      return console.error("[Engram] UpdateService: ", t), Kt.error("", ""), null;
    }
  }
  /**
   * 
   */
  static getReadVersion() {
    try {
      return nt.get("lastReadVersion") || "0.0.0";
    } catch {
      return "0.0.0";
    }
  }
  /**
   * 
   */
  static async markAsRead(t) {
    const n = t || await this.getLatestVersion() || My;
    try {
      nt.set("lastReadVersion", n), console.debug("[Engram] UpdateService: ", n);
    } catch (r) {
      console.error("[Engram] UpdateService: ", r);
    }
  }
  /**
   * 
   */
  static async hasUnreadUpdate() {
    const t = await this.getLatestVersion();
    if (!t || Sx(t, My) <= 0)
      return !1;
    const n = this.getReadVersion();
    return Sx(t, n) > 0;
  }
  /**
   * 
   */
  static clearCache() {
    Fp = null, Up = null;
  }
}
function FI(e, t) {
  const n = {};
  return (e[e.length - 1] === "" ? [...e, ""] : e).join(
    (n.padRight ? " " : "") + "," + (n.padLeft === !1 ? "" : " ")
  ).trim();
}
const UI = /^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u, $I = /^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u, HI = {};
function mC(e, t) {
  return (HI.jsx ? $I : UI).test(e);
}
const GI = /[ \t\n\f\r]/g;
function VI(e) {
  return typeof e == "object" ? e.type === "text" ? pC(e.value) : !1 : pC(e);
}
function pC(e) {
  return e.replace(GI, "") === "";
}
class Mg {
  /**
   * @param {SchemaType['property']} property
   *   Property.
   * @param {SchemaType['normal']} normal
   *   Normal.
   * @param {Space | undefined} [space]
   *   Space.
   * @returns
   *   Schema.
   */
  constructor(t, n, r) {
    this.normal = n, this.property = t, r && (this.space = r);
  }
}
Mg.prototype.normal = {};
Mg.prototype.property = {};
Mg.prototype.space = void 0;
function $7(e, t) {
  const n = {}, r = {};
  for (const a of e)
    Object.assign(n, a.property), Object.assign(r, a.normal);
  return new Mg(n, r, t);
}
function M3(e) {
  return e.toLowerCase();
}
class Ra {
  /**
   * @param {string} property
   *   Property.
   * @param {string} attribute
   *   Attribute.
   * @returns
   *   Info.
   */
  constructor(t, n) {
    this.attribute = n, this.property = t;
  }
}
Ra.prototype.attribute = "";
Ra.prototype.booleanish = !1;
Ra.prototype.boolean = !1;
Ra.prototype.commaOrSpaceSeparated = !1;
Ra.prototype.commaSeparated = !1;
Ra.prototype.defined = !1;
Ra.prototype.mustUseProperty = !1;
Ra.prototype.number = !1;
Ra.prototype.overloadedBoolean = !1;
Ra.prototype.property = "";
Ra.prototype.spaceSeparated = !1;
Ra.prototype.space = void 0;
let KI = 0;
const Ut = ld(), Or = ld(), R3 = ld(), at = ld(), Vn = ld(), Bh = ld(), es = ld();
function ld() {
  return 2 ** ++KI;
}
const O3 = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  boolean: Ut,
  booleanish: Or,
  commaOrSpaceSeparated: es,
  commaSeparated: Bh,
  number: at,
  overloadedBoolean: R3,
  spaceSeparated: Vn
}, Symbol.toStringTag, { value: "Module" })), Cx = (
  /** @type {ReadonlyArray<keyof typeof types>} */
  Object.keys(O3)
);
class TS extends Ra {
  /**
   * @constructor
   * @param {string} property
   *   Property.
   * @param {string} attribute
   *   Attribute.
   * @param {number | null | undefined} [mask]
   *   Mask.
   * @param {Space | undefined} [space]
   *   Space.
   * @returns
   *   Info.
   */
  constructor(t, n, r, a) {
    let o = -1;
    if (super(t, n), gC(this, "space", a), typeof r == "number")
      for (; ++o < Cx.length; ) {
        const l = Cx[o];
        gC(this, Cx[o], (r & O3[l]) === O3[l]);
      }
  }
}
TS.prototype.defined = !0;
function gC(e, t, n) {
  n && (e[t] = n);
}
function nm(e) {
  const t = {}, n = {};
  for (const [r, a] of Object.entries(e.properties)) {
    const o = new TS(
      r,
      e.transform(e.attributes || {}, r),
      a,
      e.space
    );
    e.mustUseProperty && e.mustUseProperty.includes(r) && (o.mustUseProperty = !0), t[r] = o, n[M3(r)] = r, n[M3(o.attribute)] = r;
  }
  return new Mg(t, n, e.space);
}
const H7 = nm({
  properties: {
    ariaActiveDescendant: null,
    ariaAtomic: Or,
    ariaAutoComplete: null,
    ariaBusy: Or,
    ariaChecked: Or,
    ariaColCount: at,
    ariaColIndex: at,
    ariaColSpan: at,
    ariaControls: Vn,
    ariaCurrent: null,
    ariaDescribedBy: Vn,
    ariaDetails: null,
    ariaDisabled: Or,
    ariaDropEffect: Vn,
    ariaErrorMessage: null,
    ariaExpanded: Or,
    ariaFlowTo: Vn,
    ariaGrabbed: Or,
    ariaHasPopup: null,
    ariaHidden: Or,
    ariaInvalid: null,
    ariaKeyShortcuts: null,
    ariaLabel: null,
    ariaLabelledBy: Vn,
    ariaLevel: at,
    ariaLive: null,
    ariaModal: Or,
    ariaMultiLine: Or,
    ariaMultiSelectable: Or,
    ariaOrientation: null,
    ariaOwns: Vn,
    ariaPlaceholder: null,
    ariaPosInSet: at,
    ariaPressed: Or,
    ariaReadOnly: Or,
    ariaRelevant: null,
    ariaRequired: Or,
    ariaRoleDescription: Vn,
    ariaRowCount: at,
    ariaRowIndex: at,
    ariaRowSpan: at,
    ariaSelected: Or,
    ariaSetSize: at,
    ariaSort: null,
    ariaValueMax: at,
    ariaValueMin: at,
    ariaValueNow: at,
    ariaValueText: null,
    role: null
  },
  transform(e, t) {
    return t === "role" ? t : "aria-" + t.slice(4).toLowerCase();
  }
});
function G7(e, t) {
  return t in e ? e[t] : t;
}
function V7(e, t) {
  return G7(e, t.toLowerCase());
}
const YI = nm({
  attributes: {
    acceptcharset: "accept-charset",
    classname: "class",
    htmlfor: "for",
    httpequiv: "http-equiv"
  },
  mustUseProperty: ["checked", "multiple", "muted", "selected"],
  properties: {
    // Standard Properties.
    abbr: null,
    accept: Bh,
    acceptCharset: Vn,
    accessKey: Vn,
    action: null,
    allow: null,
    allowFullScreen: Ut,
    allowPaymentRequest: Ut,
    allowUserMedia: Ut,
    alt: null,
    as: null,
    async: Ut,
    autoCapitalize: null,
    autoComplete: Vn,
    autoFocus: Ut,
    autoPlay: Ut,
    blocking: Vn,
    capture: null,
    charSet: null,
    checked: Ut,
    cite: null,
    className: Vn,
    cols: at,
    colSpan: null,
    content: null,
    contentEditable: Or,
    controls: Ut,
    controlsList: Vn,
    coords: at | Bh,
    crossOrigin: null,
    data: null,
    dateTime: null,
    decoding: null,
    default: Ut,
    defer: Ut,
    dir: null,
    dirName: null,
    disabled: Ut,
    download: R3,
    draggable: Or,
    encType: null,
    enterKeyHint: null,
    fetchPriority: null,
    form: null,
    formAction: null,
    formEncType: null,
    formMethod: null,
    formNoValidate: Ut,
    formTarget: null,
    headers: Vn,
    height: at,
    hidden: R3,
    high: at,
    href: null,
    hrefLang: null,
    htmlFor: Vn,
    httpEquiv: Vn,
    id: null,
    imageSizes: null,
    imageSrcSet: null,
    inert: Ut,
    inputMode: null,
    integrity: null,
    is: null,
    isMap: Ut,
    itemId: null,
    itemProp: Vn,
    itemRef: Vn,
    itemScope: Ut,
    itemType: Vn,
    kind: null,
    label: null,
    lang: null,
    language: null,
    list: null,
    loading: null,
    loop: Ut,
    low: at,
    manifest: null,
    max: null,
    maxLength: at,
    media: null,
    method: null,
    min: null,
    minLength: at,
    multiple: Ut,
    muted: Ut,
    name: null,
    nonce: null,
    noModule: Ut,
    noValidate: Ut,
    onAbort: null,
    onAfterPrint: null,
    onAuxClick: null,
    onBeforeMatch: null,
    onBeforePrint: null,
    onBeforeToggle: null,
    onBeforeUnload: null,
    onBlur: null,
    onCancel: null,
    onCanPlay: null,
    onCanPlayThrough: null,
    onChange: null,
    onClick: null,
    onClose: null,
    onContextLost: null,
    onContextMenu: null,
    onContextRestored: null,
    onCopy: null,
    onCueChange: null,
    onCut: null,
    onDblClick: null,
    onDrag: null,
    onDragEnd: null,
    onDragEnter: null,
    onDragExit: null,
    onDragLeave: null,
    onDragOver: null,
    onDragStart: null,
    onDrop: null,
    onDurationChange: null,
    onEmptied: null,
    onEnded: null,
    onError: null,
    onFocus: null,
    onFormData: null,
    onHashChange: null,
    onInput: null,
    onInvalid: null,
    onKeyDown: null,
    onKeyPress: null,
    onKeyUp: null,
    onLanguageChange: null,
    onLoad: null,
    onLoadedData: null,
    onLoadedMetadata: null,
    onLoadEnd: null,
    onLoadStart: null,
    onMessage: null,
    onMessageError: null,
    onMouseDown: null,
    onMouseEnter: null,
    onMouseLeave: null,
    onMouseMove: null,
    onMouseOut: null,
    onMouseOver: null,
    onMouseUp: null,
    onOffline: null,
    onOnline: null,
    onPageHide: null,
    onPageShow: null,
    onPaste: null,
    onPause: null,
    onPlay: null,
    onPlaying: null,
    onPopState: null,
    onProgress: null,
    onRateChange: null,
    onRejectionHandled: null,
    onReset: null,
    onResize: null,
    onScroll: null,
    onScrollEnd: null,
    onSecurityPolicyViolation: null,
    onSeeked: null,
    onSeeking: null,
    onSelect: null,
    onSlotChange: null,
    onStalled: null,
    onStorage: null,
    onSubmit: null,
    onSuspend: null,
    onTimeUpdate: null,
    onToggle: null,
    onUnhandledRejection: null,
    onUnload: null,
    onVolumeChange: null,
    onWaiting: null,
    onWheel: null,
    open: Ut,
    optimum: at,
    pattern: null,
    ping: Vn,
    placeholder: null,
    playsInline: Ut,
    popover: null,
    popoverTarget: null,
    popoverTargetAction: null,
    poster: null,
    preload: null,
    readOnly: Ut,
    referrerPolicy: null,
    rel: Vn,
    required: Ut,
    reversed: Ut,
    rows: at,
    rowSpan: at,
    sandbox: Vn,
    scope: null,
    scoped: Ut,
    seamless: Ut,
    selected: Ut,
    shadowRootClonable: Ut,
    shadowRootDelegatesFocus: Ut,
    shadowRootMode: null,
    shape: null,
    size: at,
    sizes: null,
    slot: null,
    span: at,
    spellCheck: Or,
    src: null,
    srcDoc: null,
    srcLang: null,
    srcSet: null,
    start: at,
    step: null,
    style: null,
    tabIndex: at,
    target: null,
    title: null,
    translate: null,
    type: null,
    typeMustMatch: Ut,
    useMap: null,
    value: Or,
    width: at,
    wrap: null,
    writingSuggestions: null,
    // Legacy.
    // See: https://html.spec.whatwg.org/#other-elements,-attributes-and-apis
    align: null,
    // Several. Use CSS `text-align` instead,
    aLink: null,
    // `<body>`. Use CSS `a:active {color}` instead
    archive: Vn,
    // `<object>`. List of URIs to archives
    axis: null,
    // `<td>` and `<th>`. Use `scope` on `<th>`
    background: null,
    // `<body>`. Use CSS `background-image` instead
    bgColor: null,
    // `<body>` and table elements. Use CSS `background-color` instead
    border: at,
    // `<table>`. Use CSS `border-width` instead,
    borderColor: null,
    // `<table>`. Use CSS `border-color` instead,
    bottomMargin: at,
    // `<body>`
    cellPadding: null,
    // `<table>`
    cellSpacing: null,
    // `<table>`
    char: null,
    // Several table elements. When `align=char`, sets the character to align on
    charOff: null,
    // Several table elements. When `char`, offsets the alignment
    classId: null,
    // `<object>`
    clear: null,
    // `<br>`. Use CSS `clear` instead
    code: null,
    // `<object>`
    codeBase: null,
    // `<object>`
    codeType: null,
    // `<object>`
    color: null,
    // `<font>` and `<hr>`. Use CSS instead
    compact: Ut,
    // Lists. Use CSS to reduce space between items instead
    declare: Ut,
    // `<object>`
    event: null,
    // `<script>`
    face: null,
    // `<font>`. Use CSS instead
    frame: null,
    // `<table>`
    frameBorder: null,
    // `<iframe>`. Use CSS `border` instead
    hSpace: at,
    // `<img>` and `<object>`
    leftMargin: at,
    // `<body>`
    link: null,
    // `<body>`. Use CSS `a:link {color: *}` instead
    longDesc: null,
    // `<frame>`, `<iframe>`, and `<img>`. Use an `<a>`
    lowSrc: null,
    // `<img>`. Use a `<picture>`
    marginHeight: at,
    // `<body>`
    marginWidth: at,
    // `<body>`
    noResize: Ut,
    // `<frame>`
    noHref: Ut,
    // `<area>`. Use no href instead of an explicit `nohref`
    noShade: Ut,
    // `<hr>`. Use background-color and height instead of borders
    noWrap: Ut,
    // `<td>` and `<th>`
    object: null,
    // `<applet>`
    profile: null,
    // `<head>`
    prompt: null,
    // `<isindex>`
    rev: null,
    // `<link>`
    rightMargin: at,
    // `<body>`
    rules: null,
    // `<table>`
    scheme: null,
    // `<meta>`
    scrolling: Or,
    // `<frame>`. Use overflow in the child context
    standby: null,
    // `<object>`
    summary: null,
    // `<table>`
    text: null,
    // `<body>`. Use CSS `color` instead
    topMargin: at,
    // `<body>`
    valueType: null,
    // `<param>`
    version: null,
    // `<html>`. Use a doctype.
    vAlign: null,
    // Several. Use CSS `vertical-align` instead
    vLink: null,
    // `<body>`. Use CSS `a:visited {color}` instead
    vSpace: at,
    // `<img>` and `<object>`
    // Non-standard Properties.
    allowTransparency: null,
    autoCorrect: null,
    autoSave: null,
    disablePictureInPicture: Ut,
    disableRemotePlayback: Ut,
    prefix: null,
    property: null,
    results: at,
    security: null,
    unselectable: null
  },
  space: "html",
  transform: V7
}), WI = nm({
  attributes: {
    accentHeight: "accent-height",
    alignmentBaseline: "alignment-baseline",
    arabicForm: "arabic-form",
    baselineShift: "baseline-shift",
    capHeight: "cap-height",
    className: "class",
    clipPath: "clip-path",
    clipRule: "clip-rule",
    colorInterpolation: "color-interpolation",
    colorInterpolationFilters: "color-interpolation-filters",
    colorProfile: "color-profile",
    colorRendering: "color-rendering",
    crossOrigin: "crossorigin",
    dataType: "datatype",
    dominantBaseline: "dominant-baseline",
    enableBackground: "enable-background",
    fillOpacity: "fill-opacity",
    fillRule: "fill-rule",
    floodColor: "flood-color",
    floodOpacity: "flood-opacity",
    fontFamily: "font-family",
    fontSize: "font-size",
    fontSizeAdjust: "font-size-adjust",
    fontStretch: "font-stretch",
    fontStyle: "font-style",
    fontVariant: "font-variant",
    fontWeight: "font-weight",
    glyphName: "glyph-name",
    glyphOrientationHorizontal: "glyph-orientation-horizontal",
    glyphOrientationVertical: "glyph-orientation-vertical",
    hrefLang: "hreflang",
    horizAdvX: "horiz-adv-x",
    horizOriginX: "horiz-origin-x",
    horizOriginY: "horiz-origin-y",
    imageRendering: "image-rendering",
    letterSpacing: "letter-spacing",
    lightingColor: "lighting-color",
    markerEnd: "marker-end",
    markerMid: "marker-mid",
    markerStart: "marker-start",
    navDown: "nav-down",
    navDownLeft: "nav-down-left",
    navDownRight: "nav-down-right",
    navLeft: "nav-left",
    navNext: "nav-next",
    navPrev: "nav-prev",
    navRight: "nav-right",
    navUp: "nav-up",
    navUpLeft: "nav-up-left",
    navUpRight: "nav-up-right",
    onAbort: "onabort",
    onActivate: "onactivate",
    onAfterPrint: "onafterprint",
    onBeforePrint: "onbeforeprint",
    onBegin: "onbegin",
    onCancel: "oncancel",
    onCanPlay: "oncanplay",
    onCanPlayThrough: "oncanplaythrough",
    onChange: "onchange",
    onClick: "onclick",
    onClose: "onclose",
    onCopy: "oncopy",
    onCueChange: "oncuechange",
    onCut: "oncut",
    onDblClick: "ondblclick",
    onDrag: "ondrag",
    onDragEnd: "ondragend",
    onDragEnter: "ondragenter",
    onDragExit: "ondragexit",
    onDragLeave: "ondragleave",
    onDragOver: "ondragover",
    onDragStart: "ondragstart",
    onDrop: "ondrop",
    onDurationChange: "ondurationchange",
    onEmptied: "onemptied",
    onEnd: "onend",
    onEnded: "onended",
    onError: "onerror",
    onFocus: "onfocus",
    onFocusIn: "onfocusin",
    onFocusOut: "onfocusout",
    onHashChange: "onhashchange",
    onInput: "oninput",
    onInvalid: "oninvalid",
    onKeyDown: "onkeydown",
    onKeyPress: "onkeypress",
    onKeyUp: "onkeyup",
    onLoad: "onload",
    onLoadedData: "onloadeddata",
    onLoadedMetadata: "onloadedmetadata",
    onLoadStart: "onloadstart",
    onMessage: "onmessage",
    onMouseDown: "onmousedown",
    onMouseEnter: "onmouseenter",
    onMouseLeave: "onmouseleave",
    onMouseMove: "onmousemove",
    onMouseOut: "onmouseout",
    onMouseOver: "onmouseover",
    onMouseUp: "onmouseup",
    onMouseWheel: "onmousewheel",
    onOffline: "onoffline",
    onOnline: "ononline",
    onPageHide: "onpagehide",
    onPageShow: "onpageshow",
    onPaste: "onpaste",
    onPause: "onpause",
    onPlay: "onplay",
    onPlaying: "onplaying",
    onPopState: "onpopstate",
    onProgress: "onprogress",
    onRateChange: "onratechange",
    onRepeat: "onrepeat",
    onReset: "onreset",
    onResize: "onresize",
    onScroll: "onscroll",
    onSeeked: "onseeked",
    onSeeking: "onseeking",
    onSelect: "onselect",
    onShow: "onshow",
    onStalled: "onstalled",
    onStorage: "onstorage",
    onSubmit: "onsubmit",
    onSuspend: "onsuspend",
    onTimeUpdate: "ontimeupdate",
    onToggle: "ontoggle",
    onUnload: "onunload",
    onVolumeChange: "onvolumechange",
    onWaiting: "onwaiting",
    onZoom: "onzoom",
    overlinePosition: "overline-position",
    overlineThickness: "overline-thickness",
    paintOrder: "paint-order",
    panose1: "panose-1",
    pointerEvents: "pointer-events",
    referrerPolicy: "referrerpolicy",
    renderingIntent: "rendering-intent",
    shapeRendering: "shape-rendering",
    stopColor: "stop-color",
    stopOpacity: "stop-opacity",
    strikethroughPosition: "strikethrough-position",
    strikethroughThickness: "strikethrough-thickness",
    strokeDashArray: "stroke-dasharray",
    strokeDashOffset: "stroke-dashoffset",
    strokeLineCap: "stroke-linecap",
    strokeLineJoin: "stroke-linejoin",
    strokeMiterLimit: "stroke-miterlimit",
    strokeOpacity: "stroke-opacity",
    strokeWidth: "stroke-width",
    tabIndex: "tabindex",
    textAnchor: "text-anchor",
    textDecoration: "text-decoration",
    textRendering: "text-rendering",
    transformOrigin: "transform-origin",
    typeOf: "typeof",
    underlinePosition: "underline-position",
    underlineThickness: "underline-thickness",
    unicodeBidi: "unicode-bidi",
    unicodeRange: "unicode-range",
    unitsPerEm: "units-per-em",
    vAlphabetic: "v-alphabetic",
    vHanging: "v-hanging",
    vIdeographic: "v-ideographic",
    vMathematical: "v-mathematical",
    vectorEffect: "vector-effect",
    vertAdvY: "vert-adv-y",
    vertOriginX: "vert-origin-x",
    vertOriginY: "vert-origin-y",
    wordSpacing: "word-spacing",
    writingMode: "writing-mode",
    xHeight: "x-height",
    // These were camelcased in Tiny. Now lowercased in SVG 2
    playbackOrder: "playbackorder",
    timelineBegin: "timelinebegin"
  },
  properties: {
    about: es,
    accentHeight: at,
    accumulate: null,
    additive: null,
    alignmentBaseline: null,
    alphabetic: at,
    amplitude: at,
    arabicForm: null,
    ascent: at,
    attributeName: null,
    attributeType: null,
    azimuth: at,
    bandwidth: null,
    baselineShift: null,
    baseFrequency: null,
    baseProfile: null,
    bbox: null,
    begin: null,
    bias: at,
    by: null,
    calcMode: null,
    capHeight: at,
    className: Vn,
    clip: null,
    clipPath: null,
    clipPathUnits: null,
    clipRule: null,
    color: null,
    colorInterpolation: null,
    colorInterpolationFilters: null,
    colorProfile: null,
    colorRendering: null,
    content: null,
    contentScriptType: null,
    contentStyleType: null,
    crossOrigin: null,
    cursor: null,
    cx: null,
    cy: null,
    d: null,
    dataType: null,
    defaultAction: null,
    descent: at,
    diffuseConstant: at,
    direction: null,
    display: null,
    dur: null,
    divisor: at,
    dominantBaseline: null,
    download: Ut,
    dx: null,
    dy: null,
    edgeMode: null,
    editable: null,
    elevation: at,
    enableBackground: null,
    end: null,
    event: null,
    exponent: at,
    externalResourcesRequired: null,
    fill: null,
    fillOpacity: at,
    fillRule: null,
    filter: null,
    filterRes: null,
    filterUnits: null,
    floodColor: null,
    floodOpacity: null,
    focusable: null,
    focusHighlight: null,
    fontFamily: null,
    fontSize: null,
    fontSizeAdjust: null,
    fontStretch: null,
    fontStyle: null,
    fontVariant: null,
    fontWeight: null,
    format: null,
    fr: null,
    from: null,
    fx: null,
    fy: null,
    g1: Bh,
    g2: Bh,
    glyphName: Bh,
    glyphOrientationHorizontal: null,
    glyphOrientationVertical: null,
    glyphRef: null,
    gradientTransform: null,
    gradientUnits: null,
    handler: null,
    hanging: at,
    hatchContentUnits: null,
    hatchUnits: null,
    height: null,
    href: null,
    hrefLang: null,
    horizAdvX: at,
    horizOriginX: at,
    horizOriginY: at,
    id: null,
    ideographic: at,
    imageRendering: null,
    initialVisibility: null,
    in: null,
    in2: null,
    intercept: at,
    k: at,
    k1: at,
    k2: at,
    k3: at,
    k4: at,
    kernelMatrix: es,
    kernelUnitLength: null,
    keyPoints: null,
    // SEMI_COLON_SEPARATED
    keySplines: null,
    // SEMI_COLON_SEPARATED
    keyTimes: null,
    // SEMI_COLON_SEPARATED
    kerning: null,
    lang: null,
    lengthAdjust: null,
    letterSpacing: null,
    lightingColor: null,
    limitingConeAngle: at,
    local: null,
    markerEnd: null,
    markerMid: null,
    markerStart: null,
    markerHeight: null,
    markerUnits: null,
    markerWidth: null,
    mask: null,
    maskContentUnits: null,
    maskUnits: null,
    mathematical: null,
    max: null,
    media: null,
    mediaCharacterEncoding: null,
    mediaContentEncodings: null,
    mediaSize: at,
    mediaTime: null,
    method: null,
    min: null,
    mode: null,
    name: null,
    navDown: null,
    navDownLeft: null,
    navDownRight: null,
    navLeft: null,
    navNext: null,
    navPrev: null,
    navRight: null,
    navUp: null,
    navUpLeft: null,
    navUpRight: null,
    numOctaves: null,
    observer: null,
    offset: null,
    onAbort: null,
    onActivate: null,
    onAfterPrint: null,
    onBeforePrint: null,
    onBegin: null,
    onCancel: null,
    onCanPlay: null,
    onCanPlayThrough: null,
    onChange: null,
    onClick: null,
    onClose: null,
    onCopy: null,
    onCueChange: null,
    onCut: null,
    onDblClick: null,
    onDrag: null,
    onDragEnd: null,
    onDragEnter: null,
    onDragExit: null,
    onDragLeave: null,
    onDragOver: null,
    onDragStart: null,
    onDrop: null,
    onDurationChange: null,
    onEmptied: null,
    onEnd: null,
    onEnded: null,
    onError: null,
    onFocus: null,
    onFocusIn: null,
    onFocusOut: null,
    onHashChange: null,
    onInput: null,
    onInvalid: null,
    onKeyDown: null,
    onKeyPress: null,
    onKeyUp: null,
    onLoad: null,
    onLoadedData: null,
    onLoadedMetadata: null,
    onLoadStart: null,
    onMessage: null,
    onMouseDown: null,
    onMouseEnter: null,
    onMouseLeave: null,
    onMouseMove: null,
    onMouseOut: null,
    onMouseOver: null,
    onMouseUp: null,
    onMouseWheel: null,
    onOffline: null,
    onOnline: null,
    onPageHide: null,
    onPageShow: null,
    onPaste: null,
    onPause: null,
    onPlay: null,
    onPlaying: null,
    onPopState: null,
    onProgress: null,
    onRateChange: null,
    onRepeat: null,
    onReset: null,
    onResize: null,
    onScroll: null,
    onSeeked: null,
    onSeeking: null,
    onSelect: null,
    onShow: null,
    onStalled: null,
    onStorage: null,
    onSubmit: null,
    onSuspend: null,
    onTimeUpdate: null,
    onToggle: null,
    onUnload: null,
    onVolumeChange: null,
    onWaiting: null,
    onZoom: null,
    opacity: null,
    operator: null,
    order: null,
    orient: null,
    orientation: null,
    origin: null,
    overflow: null,
    overlay: null,
    overlinePosition: at,
    overlineThickness: at,
    paintOrder: null,
    panose1: null,
    path: null,
    pathLength: at,
    patternContentUnits: null,
    patternTransform: null,
    patternUnits: null,
    phase: null,
    ping: Vn,
    pitch: null,
    playbackOrder: null,
    pointerEvents: null,
    points: null,
    pointsAtX: at,
    pointsAtY: at,
    pointsAtZ: at,
    preserveAlpha: null,
    preserveAspectRatio: null,
    primitiveUnits: null,
    propagate: null,
    property: es,
    r: null,
    radius: null,
    referrerPolicy: null,
    refX: null,
    refY: null,
    rel: es,
    rev: es,
    renderingIntent: null,
    repeatCount: null,
    repeatDur: null,
    requiredExtensions: es,
    requiredFeatures: es,
    requiredFonts: es,
    requiredFormats: es,
    resource: null,
    restart: null,
    result: null,
    rotate: null,
    rx: null,
    ry: null,
    scale: null,
    seed: null,
    shapeRendering: null,
    side: null,
    slope: null,
    snapshotTime: null,
    specularConstant: at,
    specularExponent: at,
    spreadMethod: null,
    spacing: null,
    startOffset: null,
    stdDeviation: null,
    stemh: null,
    stemv: null,
    stitchTiles: null,
    stopColor: null,
    stopOpacity: null,
    strikethroughPosition: at,
    strikethroughThickness: at,
    string: null,
    stroke: null,
    strokeDashArray: es,
    strokeDashOffset: null,
    strokeLineCap: null,
    strokeLineJoin: null,
    strokeMiterLimit: at,
    strokeOpacity: at,
    strokeWidth: null,
    style: null,
    surfaceScale: at,
    syncBehavior: null,
    syncBehaviorDefault: null,
    syncMaster: null,
    syncTolerance: null,
    syncToleranceDefault: null,
    systemLanguage: es,
    tabIndex: at,
    tableValues: null,
    target: null,
    targetX: at,
    targetY: at,
    textAnchor: null,
    textDecoration: null,
    textRendering: null,
    textLength: null,
    timelineBegin: null,
    title: null,
    transformBehavior: null,
    type: null,
    typeOf: es,
    to: null,
    transform: null,
    transformOrigin: null,
    u1: null,
    u2: null,
    underlinePosition: at,
    underlineThickness: at,
    unicode: null,
    unicodeBidi: null,
    unicodeRange: null,
    unitsPerEm: at,
    values: null,
    vAlphabetic: at,
    vMathematical: at,
    vectorEffect: null,
    vHanging: at,
    vIdeographic: at,
    version: null,
    vertAdvY: at,
    vertOriginX: at,
    vertOriginY: at,
    viewBox: null,
    viewTarget: null,
    visibility: null,
    width: null,
    widths: null,
    wordSpacing: null,
    writingMode: null,
    x: null,
    x1: null,
    x2: null,
    xChannelSelector: null,
    xHeight: at,
    y: null,
    y1: null,
    y2: null,
    yChannelSelector: null,
    z: null,
    zoomAndPan: null
  },
  space: "svg",
  transform: G7
}), K7 = nm({
  properties: {
    xLinkActuate: null,
    xLinkArcRole: null,
    xLinkHref: null,
    xLinkRole: null,
    xLinkShow: null,
    xLinkTitle: null,
    xLinkType: null
  },
  space: "xlink",
  transform(e, t) {
    return "xlink:" + t.slice(5).toLowerCase();
  }
}), Y7 = nm({
  attributes: { xmlnsxlink: "xmlns:xlink" },
  properties: { xmlnsXLink: null, xmlns: null },
  space: "xmlns",
  transform: V7
}), W7 = nm({
  properties: { xmlBase: null, xmlLang: null, xmlSpace: null },
  space: "xml",
  transform(e, t) {
    return "xml:" + t.slice(3).toLowerCase();
  }
}), XI = {
  classId: "classID",
  dataType: "datatype",
  itemId: "itemID",
  strokeDashArray: "strokeDasharray",
  strokeDashOffset: "strokeDashoffset",
  strokeLineCap: "strokeLinecap",
  strokeLineJoin: "strokeLinejoin",
  strokeMiterLimit: "strokeMiterlimit",
  typeOf: "typeof",
  xLinkActuate: "xlinkActuate",
  xLinkArcRole: "xlinkArcrole",
  xLinkHref: "xlinkHref",
  xLinkRole: "xlinkRole",
  xLinkShow: "xlinkShow",
  xLinkTitle: "xlinkTitle",
  xLinkType: "xlinkType",
  xmlnsXLink: "xmlnsXlink"
}, QI = /[A-Z]/g, yC = /-[a-z]/g, ZI = /^data[-\w.:]+$/i;
function JI(e, t) {
  const n = M3(t);
  let r = t, a = Ra;
  if (n in e.normal)
    return e.property[e.normal[n]];
  if (n.length > 4 && n.slice(0, 4) === "data" && ZI.test(t)) {
    if (t.charAt(4) === "-") {
      const o = t.slice(5).replace(yC, tL);
      r = "data" + o.charAt(0).toUpperCase() + o.slice(1);
    } else {
      const o = t.slice(4);
      if (!yC.test(o)) {
        let l = o.replace(QI, eL);
        l.charAt(0) !== "-" && (l = "-" + l), t = "data" + l;
      }
    }
    a = TS;
  }
  return new a(r, t);
}
function eL(e) {
  return "-" + e.toLowerCase();
}
function tL(e) {
  return e.charAt(1).toUpperCase();
}
const nL = $7([H7, YI, K7, Y7, W7], "html"), AS = $7([H7, WI, K7, Y7, W7], "svg");
function rL(e) {
  return e.join(" ").trim();
}
var Nh = {}, Ex, vC;
function iL() {
  if (vC) return Ex;
  vC = 1;
  var e = /\/\*[^*]*\*+([^/*][^*]*\*+)*\//g, t = /\n/g, n = /^\s*/, r = /^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/, a = /^:\s*/, o = /^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/, l = /^[;\s]*/, c = /^\s+|\s+$/g, d = `
`, h = "/", p = "*", g = "", x = "comment", b = "declaration";
  function C(T, j) {
    if (typeof T != "string")
      throw new TypeError("First argument must be a string");
    if (!T) return [];
    j = j || {};
    var R = 1, A = 1;
    function z(H) {
      var se = H.match(t);
      se && (R += se.length);
      var Z = H.lastIndexOf(d);
      A = ~Z ? H.length - Z : A + H.length;
    }
    function q() {
      var H = { line: R, column: A };
      return function(se) {
        return se.position = new D(H), ie(), se;
      };
    }
    function D(H) {
      this.start = H, this.end = { line: R, column: A }, this.source = j.source;
    }
    D.prototype.content = T;
    function P(H) {
      var se = new Error(
        j.source + ":" + R + ":" + A + ": " + H
      );
      if (se.reason = H, se.filename = j.source, se.line = R, se.column = A, se.source = T, !j.silent) throw se;
    }
    function re(H) {
      var se = H.exec(T);
      if (se) {
        var Z = se[0];
        return z(Z), T = T.slice(Z.length), se;
      }
    }
    function ie() {
      re(n);
    }
    function X(H) {
      var se;
      for (H = H || []; se = K(); )
        se !== !1 && H.push(se);
      return H;
    }
    function K() {
      var H = q();
      if (!(h != T.charAt(0) || p != T.charAt(1))) {
        for (var se = 2; g != T.charAt(se) && (p != T.charAt(se) || h != T.charAt(se + 1)); )
          ++se;
        if (se += 2, g === T.charAt(se - 1))
          return P("End of comment missing");
        var Z = T.slice(2, se - 2);
        return A += 2, z(Z), T = T.slice(se), A += 2, H({
          type: x,
          comment: Z
        });
      }
    }
    function V() {
      var H = q(), se = re(r);
      if (se) {
        if (K(), !re(a)) return P("property missing ':'");
        var Z = re(o), fe = H({
          type: b,
          property: N(se[0].replace(e, g)),
          value: Z ? N(Z[0].replace(e, g)) : g
        });
        return re(l), fe;
      }
    }
    function de() {
      var H = [];
      X(H);
      for (var se; se = V(); )
        se !== !1 && (H.push(se), X(H));
      return H;
    }
    return ie(), de();
  }
  function N(T) {
    return T ? T.replace(c, g) : g;
  }
  return Ex = C, Ex;
}
var xC;
function aL() {
  if (xC) return Nh;
  xC = 1;
  var e = Nh && Nh.__importDefault || function(r) {
    return r && r.__esModule ? r : { default: r };
  };
  Object.defineProperty(Nh, "__esModule", { value: !0 }), Nh.default = n;
  const t = e(iL());
  function n(r, a) {
    let o = null;
    if (!r || typeof r != "string")
      return o;
    const l = (0, t.default)(r), c = typeof a == "function";
    return l.forEach((d) => {
      if (d.type !== "declaration")
        return;
      const { property: h, value: p } = d;
      c ? a(h, p, d) : p && (o = o || {}, o[h] = p);
    }), o;
  }
  return Nh;
}
var $p = {}, bC;
function sL() {
  if (bC) return $p;
  bC = 1, Object.defineProperty($p, "__esModule", { value: !0 }), $p.camelCase = void 0;
  var e = /^--[a-zA-Z0-9_-]+$/, t = /-([a-z])/g, n = /^[^-]+$/, r = /^-(webkit|moz|ms|o|khtml)-/, a = /^-(ms)-/, o = function(h) {
    return !h || n.test(h) || e.test(h);
  }, l = function(h, p) {
    return p.toUpperCase();
  }, c = function(h, p) {
    return "".concat(p, "-");
  }, d = function(h, p) {
    return p === void 0 && (p = {}), o(h) ? h : (h = h.toLowerCase(), p.reactCompat ? h = h.replace(a, c) : h = h.replace(r, c), h.replace(t, l));
  };
  return $p.camelCase = d, $p;
}
var Hp, wC;
function oL() {
  if (wC) return Hp;
  wC = 1;
  var e = Hp && Hp.__importDefault || function(a) {
    return a && a.__esModule ? a : { default: a };
  }, t = e(aL()), n = sL();
  function r(a, o) {
    var l = {};
    return !a || typeof a != "string" || (0, t.default)(a, function(c, d) {
      c && d && (l[(0, n.camelCase)(c, o)] = d);
    }), l;
  }
  return r.default = r, Hp = r, Hp;
}
var lL = oL();
const uL = /* @__PURE__ */ bc(lL), X7 = Q7("end"), MS = Q7("start");
function Q7(e) {
  return t;
  function t(n) {
    const r = n && n.position && n.position[e] || {};
    if (typeof r.line == "number" && r.line > 0 && typeof r.column == "number" && r.column > 0)
      return {
        line: r.line,
        column: r.column,
        offset: typeof r.offset == "number" && r.offset > -1 ? r.offset : void 0
      };
  }
}
function cL(e) {
  const t = MS(e), n = X7(e);
  if (t && n)
    return { start: t, end: n };
}
function sg(e) {
  return !e || typeof e != "object" ? "" : "position" in e || "type" in e ? _C(e.position) : "start" in e || "end" in e ? _C(e) : "line" in e || "column" in e ? z3(e) : "";
}
function z3(e) {
  return SC(e && e.line) + ":" + SC(e && e.column);
}
function _C(e) {
  return z3(e && e.start) + "-" + z3(e && e.end);
}
function SC(e) {
  return e && typeof e == "number" ? e : 1;
}
class zi extends Error {
  /**
   * Create a message for `reason`.
   *
   * >  **Note**: also has obsolete signatures.
   *
   * @overload
   * @param {string} reason
   * @param {Options | null | undefined} [options]
   * @returns
   *
   * @overload
   * @param {string} reason
   * @param {Node | NodeLike | null | undefined} parent
   * @param {string | null | undefined} [origin]
   * @returns
   *
   * @overload
   * @param {string} reason
   * @param {Point | Position | null | undefined} place
   * @param {string | null | undefined} [origin]
   * @returns
   *
   * @overload
   * @param {string} reason
   * @param {string | null | undefined} [origin]
   * @returns
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {Node | NodeLike | null | undefined} parent
   * @param {string | null | undefined} [origin]
   * @returns
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {Point | Position | null | undefined} place
   * @param {string | null | undefined} [origin]
   * @returns
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {string | null | undefined} [origin]
   * @returns
   *
   * @param {Error | VFileMessage | string} causeOrReason
   *   Reason for message, should use markdown.
   * @param {Node | NodeLike | Options | Point | Position | string | null | undefined} [optionsOrParentOrPlace]
   *   Configuration (optional).
   * @param {string | null | undefined} [origin]
   *   Place in code where the message originates (example:
   *   `'my-package:my-rule'` or `'my-rule'`).
   * @returns
   *   Instance of `VFileMessage`.
   */
  // eslint-disable-next-line complexity
  constructor(t, n, r) {
    super(), typeof n == "string" && (r = n, n = void 0);
    let a = "", o = {}, l = !1;
    if (n && ("line" in n && "column" in n ? o = { place: n } : "start" in n && "end" in n ? o = { place: n } : "type" in n ? o = {
      ancestors: [n],
      place: n.position
    } : o = { ...n }), typeof t == "string" ? a = t : !o.cause && t && (l = !0, a = t.message, o.cause = t), !o.ruleId && !o.source && typeof r == "string") {
      const d = r.indexOf(":");
      d === -1 ? o.ruleId = r : (o.source = r.slice(0, d), o.ruleId = r.slice(d + 1));
    }
    if (!o.place && o.ancestors && o.ancestors) {
      const d = o.ancestors[o.ancestors.length - 1];
      d && (o.place = d.position);
    }
    const c = o.place && "start" in o.place ? o.place.start : o.place;
    this.ancestors = o.ancestors || void 0, this.cause = o.cause || void 0, this.column = c ? c.column : void 0, this.fatal = void 0, this.file = "", this.message = a, this.line = c ? c.line : void 0, this.name = sg(o.place) || "1:1", this.place = o.place || void 0, this.reason = this.message, this.ruleId = o.ruleId || void 0, this.source = o.source || void 0, this.stack = l && o.cause && typeof o.cause.stack == "string" ? o.cause.stack : "", this.actual = void 0, this.expected = void 0, this.note = void 0, this.url = void 0;
  }
}
zi.prototype.file = "";
zi.prototype.name = "";
zi.prototype.reason = "";
zi.prototype.message = "";
zi.prototype.stack = "";
zi.prototype.column = void 0;
zi.prototype.line = void 0;
zi.prototype.ancestors = void 0;
zi.prototype.cause = void 0;
zi.prototype.fatal = void 0;
zi.prototype.place = void 0;
zi.prototype.ruleId = void 0;
zi.prototype.source = void 0;
const RS = {}.hasOwnProperty, fL = /* @__PURE__ */ new Map(), dL = /[A-Z]/g, hL = /* @__PURE__ */ new Set(["table", "tbody", "thead", "tfoot", "tr"]), mL = /* @__PURE__ */ new Set(["td", "th"]), Z7 = "https://github.com/syntax-tree/hast-util-to-jsx-runtime";
function pL(e, t) {
  if (!t || t.Fragment === void 0)
    throw new TypeError("Expected `Fragment` in options");
  const n = t.filePath || void 0;
  let r;
  if (t.development) {
    if (typeof t.jsxDEV != "function")
      throw new TypeError(
        "Expected `jsxDEV` in options when `development: true`"
      );
    r = SL(n, t.jsxDEV);
  } else {
    if (typeof t.jsx != "function")
      throw new TypeError("Expected `jsx` in production options");
    if (typeof t.jsxs != "function")
      throw new TypeError("Expected `jsxs` in production options");
    r = _L(n, t.jsx, t.jsxs);
  }
  const a = {
    Fragment: t.Fragment,
    ancestors: [],
    components: t.components || {},
    create: r,
    elementAttributeNameCase: t.elementAttributeNameCase || "react",
    evaluater: t.createEvaluater ? t.createEvaluater() : void 0,
    filePath: n,
    ignoreInvalidStyle: t.ignoreInvalidStyle || !1,
    passKeys: t.passKeys !== !1,
    passNode: t.passNode || !1,
    schema: t.space === "svg" ? AS : nL,
    stylePropertyNameCase: t.stylePropertyNameCase || "dom",
    tableCellAlignToStyle: t.tableCellAlignToStyle !== !1
  }, o = J7(a, e, void 0);
  return o && typeof o != "string" ? o : a.create(
    e,
    a.Fragment,
    { children: o || void 0 },
    void 0
  );
}
function J7(e, t, n) {
  if (t.type === "element")
    return gL(e, t, n);
  if (t.type === "mdxFlowExpression" || t.type === "mdxTextExpression")
    return yL(e, t);
  if (t.type === "mdxJsxFlowElement" || t.type === "mdxJsxTextElement")
    return xL(e, t, n);
  if (t.type === "mdxjsEsm")
    return vL(e, t);
  if (t.type === "root")
    return bL(e, t, n);
  if (t.type === "text")
    return wL(e, t);
}
function gL(e, t, n) {
  const r = e.schema;
  let a = r;
  t.tagName.toLowerCase() === "svg" && r.space === "html" && (a = AS, e.schema = a), e.ancestors.push(t);
  const o = t9(e, t.tagName, !1), l = CL(e, t);
  let c = zS(e, t);
  return hL.has(t.tagName) && (c = c.filter(function(d) {
    return typeof d == "string" ? !VI(d) : !0;
  })), e9(e, l, o, t), OS(l, c), e.ancestors.pop(), e.schema = r, e.create(t, o, l, n);
}
function yL(e, t) {
  if (t.data && t.data.estree && e.evaluater) {
    const r = t.data.estree.body[0];
    return r.type, /** @type {Child | undefined} */
    e.evaluater.evaluateExpression(r.expression);
  }
  pg(e, t.position);
}
function vL(e, t) {
  if (t.data && t.data.estree && e.evaluater)
    return (
      /** @type {Child | undefined} */
      e.evaluater.evaluateProgram(t.data.estree)
    );
  pg(e, t.position);
}
function xL(e, t, n) {
  const r = e.schema;
  let a = r;
  t.name === "svg" && r.space === "html" && (a = AS, e.schema = a), e.ancestors.push(t);
  const o = t.name === null ? e.Fragment : t9(e, t.name, !0), l = EL(e, t), c = zS(e, t);
  return e9(e, l, o, t), OS(l, c), e.ancestors.pop(), e.schema = r, e.create(t, o, l, n);
}
function bL(e, t, n) {
  const r = {};
  return OS(r, zS(e, t)), e.create(t, e.Fragment, r, n);
}
function wL(e, t) {
  return t.value;
}
function e9(e, t, n, r) {
  typeof n != "string" && n !== e.Fragment && e.passNode && (t.node = r);
}
function OS(e, t) {
  if (t.length > 0) {
    const n = t.length > 1 ? t : t[0];
    n && (e.children = n);
  }
}
function _L(e, t, n) {
  return r;
  function r(a, o, l, c) {
    const h = Array.isArray(l.children) ? n : t;
    return c ? h(o, l, c) : h(o, l);
  }
}
function SL(e, t) {
  return n;
  function n(r, a, o, l) {
    const c = Array.isArray(o.children), d = MS(r);
    return t(
      a,
      o,
      l,
      c,
      {
        columnNumber: d ? d.column - 1 : void 0,
        fileName: e,
        lineNumber: d ? d.line : void 0
      },
      void 0
    );
  }
}
function CL(e, t) {
  const n = {};
  let r, a;
  for (a in t.properties)
    if (a !== "children" && RS.call(t.properties, a)) {
      const o = kL(e, a, t.properties[a]);
      if (o) {
        const [l, c] = o;
        e.tableCellAlignToStyle && l === "align" && typeof c == "string" && mL.has(t.tagName) ? r = c : n[l] = c;
      }
    }
  if (r) {
    const o = (
      /** @type {Style} */
      n.style || (n.style = {})
    );
    o[e.stylePropertyNameCase === "css" ? "text-align" : "textAlign"] = r;
  }
  return n;
}
function EL(e, t) {
  const n = {};
  for (const r of t.attributes)
    if (r.type === "mdxJsxExpressionAttribute")
      if (r.data && r.data.estree && e.evaluater) {
        const o = r.data.estree.body[0];
        o.type;
        const l = o.expression;
        l.type;
        const c = l.properties[0];
        c.type, Object.assign(
          n,
          e.evaluater.evaluateExpression(c.argument)
        );
      } else
        pg(e, t.position);
    else {
      const a = r.name;
      let o;
      if (r.value && typeof r.value == "object")
        if (r.value.data && r.value.data.estree && e.evaluater) {
          const c = r.value.data.estree.body[0];
          c.type, o = e.evaluater.evaluateExpression(c.expression);
        } else
          pg(e, t.position);
      else
        o = r.value === null ? !0 : r.value;
      n[a] = /** @type {Props[keyof Props]} */
      o;
    }
  return n;
}
function zS(e, t) {
  const n = [];
  let r = -1;
  const a = e.passKeys ? /* @__PURE__ */ new Map() : fL;
  for (; ++r < t.children.length; ) {
    const o = t.children[r];
    let l;
    if (e.passKeys) {
      const d = o.type === "element" ? o.tagName : o.type === "mdxJsxFlowElement" || o.type === "mdxJsxTextElement" ? o.name : void 0;
      if (d) {
        const h = a.get(d) || 0;
        l = d + "-" + h, a.set(d, h + 1);
      }
    }
    const c = J7(e, o, l);
    c !== void 0 && n.push(c);
  }
  return n;
}
function kL(e, t, n) {
  const r = JI(e.schema, t);
  if (!(n == null || typeof n == "number" && Number.isNaN(n))) {
    if (Array.isArray(n) && (n = r.commaSeparated ? FI(n) : rL(n)), r.property === "style") {
      let a = typeof n == "object" ? n : NL(e, String(n));
      return e.stylePropertyNameCase === "css" && (a = jL(a)), ["style", a];
    }
    return [
      e.elementAttributeNameCase === "react" && r.space ? XI[r.property] || r.property : r.attribute,
      n
    ];
  }
}
function NL(e, t) {
  try {
    return uL(t, { reactCompat: !0 });
  } catch (n) {
    if (e.ignoreInvalidStyle)
      return {};
    const r = (
      /** @type {Error} */
      n
    ), a = new zi("Cannot parse `style` attribute", {
      ancestors: e.ancestors,
      cause: r,
      ruleId: "style",
      source: "hast-util-to-jsx-runtime"
    });
    throw a.file = e.filePath || void 0, a.url = Z7 + "#cannot-parse-style-attribute", a;
  }
}
function t9(e, t, n) {
  let r;
  if (!n)
    r = { type: "Literal", value: t };
  else if (t.includes(".")) {
    const a = t.split(".");
    let o = -1, l;
    for (; ++o < a.length; ) {
      const c = mC(a[o]) ? { type: "Identifier", name: a[o] } : { type: "Literal", value: a[o] };
      l = l ? {
        type: "MemberExpression",
        object: l,
        property: c,
        computed: !!(o && c.type === "Literal"),
        optional: !1
      } : c;
    }
    r = l;
  } else
    r = mC(t) && !/^[a-z]/.test(t) ? { type: "Identifier", name: t } : { type: "Literal", value: t };
  if (r.type === "Literal") {
    const a = (
      /** @type {string | number} */
      r.value
    );
    return RS.call(e.components, a) ? e.components[a] : a;
  }
  if (e.evaluater)
    return e.evaluater.evaluateExpression(r);
  pg(e);
}
function pg(e, t) {
  const n = new zi(
    "Cannot handle MDX estrees without `createEvaluater`",
    {
      ancestors: e.ancestors,
      place: t,
      ruleId: "mdx-estree",
      source: "hast-util-to-jsx-runtime"
    }
  );
  throw n.file = e.filePath || void 0, n.url = Z7 + "#cannot-handle-mdx-estrees-without-createevaluater", n;
}
function jL(e) {
  const t = {};
  let n;
  for (n in e)
    RS.call(e, n) && (t[TL(n)] = e[n]);
  return t;
}
function TL(e) {
  let t = e.replace(dL, AL);
  return t.slice(0, 3) === "ms-" && (t = "-" + t), t;
}
function AL(e) {
  return "-" + e.toLowerCase();
}
const kx = {
  action: ["form"],
  cite: ["blockquote", "del", "ins", "q"],
  data: ["object"],
  formAction: ["button", "input"],
  href: ["a", "area", "base", "link"],
  icon: ["menuitem"],
  itemId: null,
  manifest: ["html"],
  ping: ["a", "area"],
  poster: ["video"],
  src: [
    "audio",
    "embed",
    "iframe",
    "img",
    "input",
    "script",
    "source",
    "track",
    "video"
  ]
}, ML = {};
function DS(e, t) {
  const n = ML, r = typeof n.includeImageAlt == "boolean" ? n.includeImageAlt : !0, a = typeof n.includeHtml == "boolean" ? n.includeHtml : !0;
  return n9(e, r, a);
}
function n9(e, t, n) {
  if (RL(e)) {
    if ("value" in e)
      return e.type === "html" && !n ? "" : e.value;
    if (t && "alt" in e && e.alt)
      return e.alt;
    if ("children" in e)
      return CC(e.children, t, n);
  }
  return Array.isArray(e) ? CC(e, t, n) : "";
}
function CC(e, t, n) {
  const r = [];
  let a = -1;
  for (; ++a < e.length; )
    r[a] = n9(e[a], t, n);
  return r.join("");
}
function RL(e) {
  return !!(e && typeof e == "object");
}
const EC = document.createElement("i");
function IS(e) {
  const t = "&" + e + ";";
  EC.innerHTML = t;
  const n = EC.textContent;
  return (
    // @ts-expect-error: TypeScript is wrong that `textContent` on elements can
    // yield `null`.
    n.charCodeAt(n.length - 1) === 59 && e !== "semi" || n === t ? !1 : n
  );
}
function rs(e, t, n, r) {
  const a = e.length;
  let o = 0, l;
  if (t < 0 ? t = -t > a ? 0 : a + t : t = t > a ? a : t, n = n > 0 ? n : 0, r.length < 1e4)
    l = Array.from(r), l.unshift(t, n), e.splice(...l);
  else
    for (n && e.splice(t, n); o < r.length; )
      l = r.slice(o, o + 1e4), l.unshift(t, 0), e.splice(...l), o += 1e4, t += 1e4;
}
function _s(e, t) {
  return e.length > 0 ? (rs(e, e.length, 0, t), e) : t;
}
const kC = {}.hasOwnProperty;
function r9(e) {
  const t = {};
  let n = -1;
  for (; ++n < e.length; )
    OL(t, e[n]);
  return t;
}
function OL(e, t) {
  let n;
  for (n in t) {
    const a = (kC.call(e, n) ? e[n] : void 0) || (e[n] = {}), o = t[n];
    let l;
    if (o)
      for (l in o) {
        kC.call(a, l) || (a[l] = []);
        const c = o[l];
        zL(
          // @ts-expect-error Looks like a list.
          a[l],
          Array.isArray(c) ? c : c ? [c] : []
        );
      }
  }
}
function zL(e, t) {
  let n = -1;
  const r = [];
  for (; ++n < t.length; )
    (t[n].add === "after" ? e : r).push(t[n]);
  rs(e, 0, 0, r);
}
function i9(e, t) {
  const n = Number.parseInt(e, t);
  return (
    // C0 except for HT, LF, FF, CR, space.
    n < 9 || n === 11 || n > 13 && n < 32 || // Control character (DEL) of C0, and C1 controls.
    n > 126 && n < 160 || // Lone high surrogates and low surrogates.
    n > 55295 && n < 57344 || // Noncharacters.
    n > 64975 && n < 65008 || /* eslint-disable no-bitwise */
    (n & 65535) === 65535 || (n & 65535) === 65534 || /* eslint-enable no-bitwise */
    // Out of range
    n > 1114111 ? "" : String.fromCodePoint(n)
  );
}
function mo(e) {
  return e.replace(/[\t\n\r ]+/g, " ").replace(/^ | $/g, "").toLowerCase().toUpperCase();
}
const ta = wc(/[A-Za-z]/), Ri = wc(/[\dA-Za-z]/), DL = wc(/[#-'*+\--9=?A-Z^-~]/);
function c1(e) {
  return (
    // Special whitespace codes (which have negative values), C0 and Control
    // character DEL
    e !== null && (e < 32 || e === 127)
  );
}
const D3 = wc(/\d/), IL = wc(/[\dA-Fa-f]/), LL = wc(/[!-/:-@[-`{-~]/);
function jt(e) {
  return e !== null && e < -2;
}
function Bn(e) {
  return e !== null && (e < 0 || e === 32);
}
function tn(e) {
  return e === -2 || e === -1 || e === 32;
}
const q1 = wc(new RegExp("\\p{P}|\\p{S}", "u")), td = wc(/\s/);
function wc(e) {
  return t;
  function t(n) {
    return n !== null && n > -1 && e.test(String.fromCharCode(n));
  }
}
function rm(e) {
  const t = [];
  let n = -1, r = 0, a = 0;
  for (; ++n < e.length; ) {
    const o = e.charCodeAt(n);
    let l = "";
    if (o === 37 && Ri(e.charCodeAt(n + 1)) && Ri(e.charCodeAt(n + 2)))
      a = 2;
    else if (o < 128)
      /[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(o)) || (l = String.fromCharCode(o));
    else if (o > 55295 && o < 57344) {
      const c = e.charCodeAt(n + 1);
      o < 56320 && c > 56319 && c < 57344 ? (l = String.fromCharCode(o, c), a = 1) : l = "";
    } else
      l = String.fromCharCode(o);
    l && (t.push(e.slice(r, n), encodeURIComponent(l)), r = n + a + 1, l = ""), a && (n += a, a = 0);
  }
  return t.join("") + e.slice(r);
}
function dn(e, t, n, r) {
  const a = r ? r - 1 : Number.POSITIVE_INFINITY;
  let o = 0;
  return l;
  function l(d) {
    return tn(d) ? (e.enter(n), c(d)) : t(d);
  }
  function c(d) {
    return tn(d) && o++ < a ? (e.consume(d), c) : (e.exit(n), t(d));
  }
}
const PL = {
  tokenize: qL
};
function qL(e) {
  const t = e.attempt(this.parser.constructs.contentInitial, r, a);
  let n;
  return t;
  function r(c) {
    if (c === null) {
      e.consume(c);
      return;
    }
    return e.enter("lineEnding"), e.consume(c), e.exit("lineEnding"), dn(e, t, "linePrefix");
  }
  function a(c) {
    return e.enter("paragraph"), o(c);
  }
  function o(c) {
    const d = e.enter("chunkText", {
      contentType: "text",
      previous: n
    });
    return n && (n.next = d), n = d, l(c);
  }
  function l(c) {
    if (c === null) {
      e.exit("chunkText"), e.exit("paragraph"), e.consume(c);
      return;
    }
    return jt(c) ? (e.consume(c), e.exit("chunkText"), o) : (e.consume(c), l);
  }
}
const BL = {
  tokenize: FL
}, NC = {
  tokenize: UL
};
function FL(e) {
  const t = this, n = [];
  let r = 0, a, o, l;
  return c;
  function c(A) {
    if (r < n.length) {
      const z = n[r];
      return t.containerState = z[1], e.attempt(z[0].continuation, d, h)(A);
    }
    return h(A);
  }
  function d(A) {
    if (r++, t.containerState._closeFlow) {
      t.containerState._closeFlow = void 0, a && R();
      const z = t.events.length;
      let q = z, D;
      for (; q--; )
        if (t.events[q][0] === "exit" && t.events[q][1].type === "chunkFlow") {
          D = t.events[q][1].end;
          break;
        }
      j(r);
      let P = z;
      for (; P < t.events.length; )
        t.events[P][1].end = {
          ...D
        }, P++;
      return rs(t.events, q + 1, 0, t.events.slice(z)), t.events.length = P, h(A);
    }
    return c(A);
  }
  function h(A) {
    if (r === n.length) {
      if (!a)
        return x(A);
      if (a.currentConstruct && a.currentConstruct.concrete)
        return C(A);
      t.interrupt = !!(a.currentConstruct && !a._gfmTableDynamicInterruptHack);
    }
    return t.containerState = {}, e.check(NC, p, g)(A);
  }
  function p(A) {
    return a && R(), j(r), x(A);
  }
  function g(A) {
    return t.parser.lazy[t.now().line] = r !== n.length, l = t.now().offset, C(A);
  }
  function x(A) {
    return t.containerState = {}, e.attempt(NC, b, C)(A);
  }
  function b(A) {
    return r++, n.push([t.currentConstruct, t.containerState]), x(A);
  }
  function C(A) {
    if (A === null) {
      a && R(), j(0), e.consume(A);
      return;
    }
    return a = a || t.parser.flow(t.now()), e.enter("chunkFlow", {
      _tokenizer: a,
      contentType: "flow",
      previous: o
    }), N(A);
  }
  function N(A) {
    if (A === null) {
      T(e.exit("chunkFlow"), !0), j(0), e.consume(A);
      return;
    }
    return jt(A) ? (e.consume(A), T(e.exit("chunkFlow")), r = 0, t.interrupt = void 0, c) : (e.consume(A), N);
  }
  function T(A, z) {
    const q = t.sliceStream(A);
    if (z && q.push(null), A.previous = o, o && (o.next = A), o = A, a.defineSkip(A.start), a.write(q), t.parser.lazy[A.start.line]) {
      let D = a.events.length;
      for (; D--; )
        if (
          // The token starts before the line ending
          a.events[D][1].start.offset < l && // and either is not ended yet
          (!a.events[D][1].end || // or ends after it.
          a.events[D][1].end.offset > l)
        )
          return;
      const P = t.events.length;
      let re = P, ie, X;
      for (; re--; )
        if (t.events[re][0] === "exit" && t.events[re][1].type === "chunkFlow") {
          if (ie) {
            X = t.events[re][1].end;
            break;
          }
          ie = !0;
        }
      for (j(r), D = P; D < t.events.length; )
        t.events[D][1].end = {
          ...X
        }, D++;
      rs(t.events, re + 1, 0, t.events.slice(P)), t.events.length = D;
    }
  }
  function j(A) {
    let z = n.length;
    for (; z-- > A; ) {
      const q = n[z];
      t.containerState = q[1], q[0].exit.call(t, e);
    }
    n.length = A;
  }
  function R() {
    a.write([null]), o = void 0, a = void 0, t.containerState._closeFlow = void 0;
  }
}
function UL(e, t, n) {
  return dn(e, e.attempt(this.parser.constructs.document, t, n), "linePrefix", this.parser.constructs.disable.null.includes("codeIndented") ? void 0 : 4);
}
function Hh(e) {
  if (e === null || Bn(e) || td(e))
    return 1;
  if (q1(e))
    return 2;
}
function B1(e, t, n) {
  const r = [];
  let a = -1;
  for (; ++a < e.length; ) {
    const o = e[a].resolveAll;
    o && !r.includes(o) && (t = o(t, n), r.push(o));
  }
  return t;
}
const I3 = {
  name: "attention",
  resolveAll: $L,
  tokenize: HL
};
function $L(e, t) {
  let n = -1, r, a, o, l, c, d, h, p;
  for (; ++n < e.length; )
    if (e[n][0] === "enter" && e[n][1].type === "attentionSequence" && e[n][1]._close) {
      for (r = n; r--; )
        if (e[r][0] === "exit" && e[r][1].type === "attentionSequence" && e[r][1]._open && // If the markers are the same:
        t.sliceSerialize(e[r][1]).charCodeAt(0) === t.sliceSerialize(e[n][1]).charCodeAt(0)) {
          if ((e[r][1]._close || e[n][1]._open) && (e[n][1].end.offset - e[n][1].start.offset) % 3 && !((e[r][1].end.offset - e[r][1].start.offset + e[n][1].end.offset - e[n][1].start.offset) % 3))
            continue;
          d = e[r][1].end.offset - e[r][1].start.offset > 1 && e[n][1].end.offset - e[n][1].start.offset > 1 ? 2 : 1;
          const g = {
            ...e[r][1].end
          }, x = {
            ...e[n][1].start
          };
          jC(g, -d), jC(x, d), l = {
            type: d > 1 ? "strongSequence" : "emphasisSequence",
            start: g,
            end: {
              ...e[r][1].end
            }
          }, c = {
            type: d > 1 ? "strongSequence" : "emphasisSequence",
            start: {
              ...e[n][1].start
            },
            end: x
          }, o = {
            type: d > 1 ? "strongText" : "emphasisText",
            start: {
              ...e[r][1].end
            },
            end: {
              ...e[n][1].start
            }
          }, a = {
            type: d > 1 ? "strong" : "emphasis",
            start: {
              ...l.start
            },
            end: {
              ...c.end
            }
          }, e[r][1].end = {
            ...l.start
          }, e[n][1].start = {
            ...c.end
          }, h = [], e[r][1].end.offset - e[r][1].start.offset && (h = _s(h, [["enter", e[r][1], t], ["exit", e[r][1], t]])), h = _s(h, [["enter", a, t], ["enter", l, t], ["exit", l, t], ["enter", o, t]]), h = _s(h, B1(t.parser.constructs.insideSpan.null, e.slice(r + 1, n), t)), h = _s(h, [["exit", o, t], ["enter", c, t], ["exit", c, t], ["exit", a, t]]), e[n][1].end.offset - e[n][1].start.offset ? (p = 2, h = _s(h, [["enter", e[n][1], t], ["exit", e[n][1], t]])) : p = 0, rs(e, r - 1, n - r + 3, h), n = r + h.length - p - 2;
          break;
        }
    }
  for (n = -1; ++n < e.length; )
    e[n][1].type === "attentionSequence" && (e[n][1].type = "data");
  return e;
}
function HL(e, t) {
  const n = this.parser.constructs.attentionMarkers.null, r = this.previous, a = Hh(r);
  let o;
  return l;
  function l(d) {
    return o = d, e.enter("attentionSequence"), c(d);
  }
  function c(d) {
    if (d === o)
      return e.consume(d), c;
    const h = e.exit("attentionSequence"), p = Hh(d), g = !p || p === 2 && a || n.includes(d), x = !a || a === 2 && p || n.includes(r);
    return h._open = !!(o === 42 ? g : g && (a || !x)), h._close = !!(o === 42 ? x : x && (p || !g)), t(d);
  }
}
function jC(e, t) {
  e.column += t, e.offset += t, e._bufferIndex += t;
}
const GL = {
  name: "autolink",
  tokenize: VL
};
function VL(e, t, n) {
  let r = 0;
  return a;
  function a(b) {
    return e.enter("autolink"), e.enter("autolinkMarker"), e.consume(b), e.exit("autolinkMarker"), e.enter("autolinkProtocol"), o;
  }
  function o(b) {
    return ta(b) ? (e.consume(b), l) : b === 64 ? n(b) : h(b);
  }
  function l(b) {
    return b === 43 || b === 45 || b === 46 || Ri(b) ? (r = 1, c(b)) : h(b);
  }
  function c(b) {
    return b === 58 ? (e.consume(b), r = 0, d) : (b === 43 || b === 45 || b === 46 || Ri(b)) && r++ < 32 ? (e.consume(b), c) : (r = 0, h(b));
  }
  function d(b) {
    return b === 62 ? (e.exit("autolinkProtocol"), e.enter("autolinkMarker"), e.consume(b), e.exit("autolinkMarker"), e.exit("autolink"), t) : b === null || b === 32 || b === 60 || c1(b) ? n(b) : (e.consume(b), d);
  }
  function h(b) {
    return b === 64 ? (e.consume(b), p) : DL(b) ? (e.consume(b), h) : n(b);
  }
  function p(b) {
    return Ri(b) ? g(b) : n(b);
  }
  function g(b) {
    return b === 46 ? (e.consume(b), r = 0, p) : b === 62 ? (e.exit("autolinkProtocol").type = "autolinkEmail", e.enter("autolinkMarker"), e.consume(b), e.exit("autolinkMarker"), e.exit("autolink"), t) : x(b);
  }
  function x(b) {
    if ((b === 45 || Ri(b)) && r++ < 63) {
      const C = b === 45 ? x : g;
      return e.consume(b), C;
    }
    return n(b);
  }
}
const Rg = {
  partial: !0,
  tokenize: KL
};
function KL(e, t, n) {
  return r;
  function r(o) {
    return tn(o) ? dn(e, a, "linePrefix")(o) : a(o);
  }
  function a(o) {
    return o === null || jt(o) ? t(o) : n(o);
  }
}
const a9 = {
  continuation: {
    tokenize: WL
  },
  exit: XL,
  name: "blockQuote",
  tokenize: YL
};
function YL(e, t, n) {
  const r = this;
  return a;
  function a(l) {
    if (l === 62) {
      const c = r.containerState;
      return c.open || (e.enter("blockQuote", {
        _container: !0
      }), c.open = !0), e.enter("blockQuotePrefix"), e.enter("blockQuoteMarker"), e.consume(l), e.exit("blockQuoteMarker"), o;
    }
    return n(l);
  }
  function o(l) {
    return tn(l) ? (e.enter("blockQuotePrefixWhitespace"), e.consume(l), e.exit("blockQuotePrefixWhitespace"), e.exit("blockQuotePrefix"), t) : (e.exit("blockQuotePrefix"), t(l));
  }
}
function WL(e, t, n) {
  const r = this;
  return a;
  function a(l) {
    return tn(l) ? dn(e, o, "linePrefix", r.parser.constructs.disable.null.includes("codeIndented") ? void 0 : 4)(l) : o(l);
  }
  function o(l) {
    return e.attempt(a9, t, n)(l);
  }
}
function XL(e) {
  e.exit("blockQuote");
}
const s9 = {
  name: "characterEscape",
  tokenize: QL
};
function QL(e, t, n) {
  return r;
  function r(o) {
    return e.enter("characterEscape"), e.enter("escapeMarker"), e.consume(o), e.exit("escapeMarker"), a;
  }
  function a(o) {
    return LL(o) ? (e.enter("characterEscapeValue"), e.consume(o), e.exit("characterEscapeValue"), e.exit("characterEscape"), t) : n(o);
  }
}
const o9 = {
  name: "characterReference",
  tokenize: ZL
};
function ZL(e, t, n) {
  const r = this;
  let a = 0, o, l;
  return c;
  function c(g) {
    return e.enter("characterReference"), e.enter("characterReferenceMarker"), e.consume(g), e.exit("characterReferenceMarker"), d;
  }
  function d(g) {
    return g === 35 ? (e.enter("characterReferenceMarkerNumeric"), e.consume(g), e.exit("characterReferenceMarkerNumeric"), h) : (e.enter("characterReferenceValue"), o = 31, l = Ri, p(g));
  }
  function h(g) {
    return g === 88 || g === 120 ? (e.enter("characterReferenceMarkerHexadecimal"), e.consume(g), e.exit("characterReferenceMarkerHexadecimal"), e.enter("characterReferenceValue"), o = 6, l = IL, p) : (e.enter("characterReferenceValue"), o = 7, l = D3, p(g));
  }
  function p(g) {
    if (g === 59 && a) {
      const x = e.exit("characterReferenceValue");
      return l === Ri && !IS(r.sliceSerialize(x)) ? n(g) : (e.enter("characterReferenceMarker"), e.consume(g), e.exit("characterReferenceMarker"), e.exit("characterReference"), t);
    }
    return l(g) && a++ < o ? (e.consume(g), p) : n(g);
  }
}
const TC = {
  partial: !0,
  tokenize: eP
}, AC = {
  concrete: !0,
  name: "codeFenced",
  tokenize: JL
};
function JL(e, t, n) {
  const r = this, a = {
    partial: !0,
    tokenize: q
  };
  let o = 0, l = 0, c;
  return d;
  function d(D) {
    return h(D);
  }
  function h(D) {
    const P = r.events[r.events.length - 1];
    return o = P && P[1].type === "linePrefix" ? P[2].sliceSerialize(P[1], !0).length : 0, c = D, e.enter("codeFenced"), e.enter("codeFencedFence"), e.enter("codeFencedFenceSequence"), p(D);
  }
  function p(D) {
    return D === c ? (l++, e.consume(D), p) : l < 3 ? n(D) : (e.exit("codeFencedFenceSequence"), tn(D) ? dn(e, g, "whitespace")(D) : g(D));
  }
  function g(D) {
    return D === null || jt(D) ? (e.exit("codeFencedFence"), r.interrupt ? t(D) : e.check(TC, N, z)(D)) : (e.enter("codeFencedFenceInfo"), e.enter("chunkString", {
      contentType: "string"
    }), x(D));
  }
  function x(D) {
    return D === null || jt(D) ? (e.exit("chunkString"), e.exit("codeFencedFenceInfo"), g(D)) : tn(D) ? (e.exit("chunkString"), e.exit("codeFencedFenceInfo"), dn(e, b, "whitespace")(D)) : D === 96 && D === c ? n(D) : (e.consume(D), x);
  }
  function b(D) {
    return D === null || jt(D) ? g(D) : (e.enter("codeFencedFenceMeta"), e.enter("chunkString", {
      contentType: "string"
    }), C(D));
  }
  function C(D) {
    return D === null || jt(D) ? (e.exit("chunkString"), e.exit("codeFencedFenceMeta"), g(D)) : D === 96 && D === c ? n(D) : (e.consume(D), C);
  }
  function N(D) {
    return e.attempt(a, z, T)(D);
  }
  function T(D) {
    return e.enter("lineEnding"), e.consume(D), e.exit("lineEnding"), j;
  }
  function j(D) {
    return o > 0 && tn(D) ? dn(e, R, "linePrefix", o + 1)(D) : R(D);
  }
  function R(D) {
    return D === null || jt(D) ? e.check(TC, N, z)(D) : (e.enter("codeFlowValue"), A(D));
  }
  function A(D) {
    return D === null || jt(D) ? (e.exit("codeFlowValue"), R(D)) : (e.consume(D), A);
  }
  function z(D) {
    return e.exit("codeFenced"), t(D);
  }
  function q(D, P, re) {
    let ie = 0;
    return X;
    function X(se) {
      return D.enter("lineEnding"), D.consume(se), D.exit("lineEnding"), K;
    }
    function K(se) {
      return D.enter("codeFencedFence"), tn(se) ? dn(D, V, "linePrefix", r.parser.constructs.disable.null.includes("codeIndented") ? void 0 : 4)(se) : V(se);
    }
    function V(se) {
      return se === c ? (D.enter("codeFencedFenceSequence"), de(se)) : re(se);
    }
    function de(se) {
      return se === c ? (ie++, D.consume(se), de) : ie >= l ? (D.exit("codeFencedFenceSequence"), tn(se) ? dn(D, H, "whitespace")(se) : H(se)) : re(se);
    }
    function H(se) {
      return se === null || jt(se) ? (D.exit("codeFencedFence"), P(se)) : re(se);
    }
  }
}
function eP(e, t, n) {
  const r = this;
  return a;
  function a(l) {
    return l === null ? n(l) : (e.enter("lineEnding"), e.consume(l), e.exit("lineEnding"), o);
  }
  function o(l) {
    return r.parser.lazy[r.now().line] ? n(l) : t(l);
  }
}
const Nx = {
  name: "codeIndented",
  tokenize: nP
}, tP = {
  partial: !0,
  tokenize: rP
};
function nP(e, t, n) {
  const r = this;
  return a;
  function a(h) {
    return e.enter("codeIndented"), dn(e, o, "linePrefix", 5)(h);
  }
  function o(h) {
    const p = r.events[r.events.length - 1];
    return p && p[1].type === "linePrefix" && p[2].sliceSerialize(p[1], !0).length >= 4 ? l(h) : n(h);
  }
  function l(h) {
    return h === null ? d(h) : jt(h) ? e.attempt(tP, l, d)(h) : (e.enter("codeFlowValue"), c(h));
  }
  function c(h) {
    return h === null || jt(h) ? (e.exit("codeFlowValue"), l(h)) : (e.consume(h), c);
  }
  function d(h) {
    return e.exit("codeIndented"), t(h);
  }
}
function rP(e, t, n) {
  const r = this;
  return a;
  function a(l) {
    return r.parser.lazy[r.now().line] ? n(l) : jt(l) ? (e.enter("lineEnding"), e.consume(l), e.exit("lineEnding"), a) : dn(e, o, "linePrefix", 5)(l);
  }
  function o(l) {
    const c = r.events[r.events.length - 1];
    return c && c[1].type === "linePrefix" && c[2].sliceSerialize(c[1], !0).length >= 4 ? t(l) : jt(l) ? a(l) : n(l);
  }
}
const iP = {
  name: "codeText",
  previous: sP,
  resolve: aP,
  tokenize: oP
};
function aP(e) {
  let t = e.length - 4, n = 3, r, a;
  if ((e[n][1].type === "lineEnding" || e[n][1].type === "space") && (e[t][1].type === "lineEnding" || e[t][1].type === "space")) {
    for (r = n; ++r < t; )
      if (e[r][1].type === "codeTextData") {
        e[n][1].type = "codeTextPadding", e[t][1].type = "codeTextPadding", n += 2, t -= 2;
        break;
      }
  }
  for (r = n - 1, t++; ++r <= t; )
    a === void 0 ? r !== t && e[r][1].type !== "lineEnding" && (a = r) : (r === t || e[r][1].type === "lineEnding") && (e[a][1].type = "codeTextData", r !== a + 2 && (e[a][1].end = e[r - 1][1].end, e.splice(a + 2, r - a - 2), t -= r - a - 2, r = a + 2), a = void 0);
  return e;
}
function sP(e) {
  return e !== 96 || this.events[this.events.length - 1][1].type === "characterEscape";
}
function oP(e, t, n) {
  let r = 0, a, o;
  return l;
  function l(g) {
    return e.enter("codeText"), e.enter("codeTextSequence"), c(g);
  }
  function c(g) {
    return g === 96 ? (e.consume(g), r++, c) : (e.exit("codeTextSequence"), d(g));
  }
  function d(g) {
    return g === null ? n(g) : g === 32 ? (e.enter("space"), e.consume(g), e.exit("space"), d) : g === 96 ? (o = e.enter("codeTextSequence"), a = 0, p(g)) : jt(g) ? (e.enter("lineEnding"), e.consume(g), e.exit("lineEnding"), d) : (e.enter("codeTextData"), h(g));
  }
  function h(g) {
    return g === null || g === 32 || g === 96 || jt(g) ? (e.exit("codeTextData"), d(g)) : (e.consume(g), h);
  }
  function p(g) {
    return g === 96 ? (e.consume(g), a++, p) : a === r ? (e.exit("codeTextSequence"), e.exit("codeText"), t(g)) : (o.type = "codeTextData", h(g));
  }
}
class lP {
  /**
   * @param {ReadonlyArray<T> | null | undefined} [initial]
   *   Initial items (optional).
   * @returns
   *   Splice buffer.
   */
  constructor(t) {
    this.left = t ? [...t] : [], this.right = [];
  }
  /**
   * Array access;
   * does not move the cursor.
   *
   * @param {number} index
   *   Index.
   * @return {T}
   *   Item.
   */
  get(t) {
    if (t < 0 || t >= this.left.length + this.right.length)
      throw new RangeError("Cannot access index `" + t + "` in a splice buffer of size `" + (this.left.length + this.right.length) + "`");
    return t < this.left.length ? this.left[t] : this.right[this.right.length - t + this.left.length - 1];
  }
  /**
   * The length of the splice buffer, one greater than the largest index in the
   * array.
   */
  get length() {
    return this.left.length + this.right.length;
  }
  /**
   * Remove and return `list[0]`;
   * moves the cursor to `0`.
   *
   * @returns {T | undefined}
   *   Item, optional.
   */
  shift() {
    return this.setCursor(0), this.right.pop();
  }
  /**
   * Slice the buffer to get an array;
   * does not move the cursor.
   *
   * @param {number} start
   *   Start.
   * @param {number | null | undefined} [end]
   *   End (optional).
   * @returns {Array<T>}
   *   Array of items.
   */
  slice(t, n) {
    const r = n ?? Number.POSITIVE_INFINITY;
    return r < this.left.length ? this.left.slice(t, r) : t > this.left.length ? this.right.slice(this.right.length - r + this.left.length, this.right.length - t + this.left.length).reverse() : this.left.slice(t).concat(this.right.slice(this.right.length - r + this.left.length).reverse());
  }
  /**
   * Mimics the behavior of Array.prototype.splice() except for the change of
   * interface necessary to avoid segfaults when patching in very large arrays.
   *
   * This operation moves cursor is moved to `start` and results in the cursor
   * placed after any inserted items.
   *
   * @param {number} start
   *   Start;
   *   zero-based index at which to start changing the array;
   *   negative numbers count backwards from the end of the array and values
   *   that are out-of bounds are clamped to the appropriate end of the array.
   * @param {number | null | undefined} [deleteCount=0]
   *   Delete count (default: `0`);
   *   maximum number of elements to delete, starting from start.
   * @param {Array<T> | null | undefined} [items=[]]
   *   Items to include in place of the deleted items (default: `[]`).
   * @return {Array<T>}
   *   Any removed items.
   */
  splice(t, n, r) {
    const a = n || 0;
    this.setCursor(Math.trunc(t));
    const o = this.right.splice(this.right.length - a, Number.POSITIVE_INFINITY);
    return r && Gp(this.left, r), o.reverse();
  }
  /**
   * Remove and return the highest-numbered item in the array, so
   * `list[list.length - 1]`;
   * Moves the cursor to `length`.
   *
   * @returns {T | undefined}
   *   Item, optional.
   */
  pop() {
    return this.setCursor(Number.POSITIVE_INFINITY), this.left.pop();
  }
  /**
   * Inserts a single item to the high-numbered side of the array;
   * moves the cursor to `length`.
   *
   * @param {T} item
   *   Item.
   * @returns {undefined}
   *   Nothing.
   */
  push(t) {
    this.setCursor(Number.POSITIVE_INFINITY), this.left.push(t);
  }
  /**
   * Inserts many items to the high-numbered side of the array.
   * Moves the cursor to `length`.
   *
   * @param {Array<T>} items
   *   Items.
   * @returns {undefined}
   *   Nothing.
   */
  pushMany(t) {
    this.setCursor(Number.POSITIVE_INFINITY), Gp(this.left, t);
  }
  /**
   * Inserts a single item to the low-numbered side of the array;
   * Moves the cursor to `0`.
   *
   * @param {T} item
   *   Item.
   * @returns {undefined}
   *   Nothing.
   */
  unshift(t) {
    this.setCursor(0), this.right.push(t);
  }
  /**
   * Inserts many items to the low-numbered side of the array;
   * moves the cursor to `0`.
   *
   * @param {Array<T>} items
   *   Items.
   * @returns {undefined}
   *   Nothing.
   */
  unshiftMany(t) {
    this.setCursor(0), Gp(this.right, t.reverse());
  }
  /**
   * Move the cursor to a specific position in the array. Requires
   * time proportional to the distance moved.
   *
   * If `n < 0`, the cursor will end up at the beginning.
   * If `n > length`, the cursor will end up at the end.
   *
   * @param {number} n
   *   Position.
   * @return {undefined}
   *   Nothing.
   */
  setCursor(t) {
    if (!(t === this.left.length || t > this.left.length && this.right.length === 0 || t < 0 && this.left.length === 0))
      if (t < this.left.length) {
        const n = this.left.splice(t, Number.POSITIVE_INFINITY);
        Gp(this.right, n.reverse());
      } else {
        const n = this.right.splice(this.left.length + this.right.length - t, Number.POSITIVE_INFINITY);
        Gp(this.left, n.reverse());
      }
  }
}
function Gp(e, t) {
  let n = 0;
  if (t.length < 1e4)
    e.push(...t);
  else
    for (; n < t.length; )
      e.push(...t.slice(n, n + 1e4)), n += 1e4;
}
function l9(e) {
  const t = {};
  let n = -1, r, a, o, l, c, d, h;
  const p = new lP(e);
  for (; ++n < p.length; ) {
    for (; n in t; )
      n = t[n];
    if (r = p.get(n), n && r[1].type === "chunkFlow" && p.get(n - 1)[1].type === "listItemPrefix" && (d = r[1]._tokenizer.events, o = 0, o < d.length && d[o][1].type === "lineEndingBlank" && (o += 2), o < d.length && d[o][1].type === "content"))
      for (; ++o < d.length && d[o][1].type !== "content"; )
        d[o][1].type === "chunkText" && (d[o][1]._isInFirstContentOfListItem = !0, o++);
    if (r[0] === "enter")
      r[1].contentType && (Object.assign(t, uP(p, n)), n = t[n], h = !0);
    else if (r[1]._container) {
      for (o = n, a = void 0; o--; )
        if (l = p.get(o), l[1].type === "lineEnding" || l[1].type === "lineEndingBlank")
          l[0] === "enter" && (a && (p.get(a)[1].type = "lineEndingBlank"), l[1].type = "lineEnding", a = o);
        else if (!(l[1].type === "linePrefix" || l[1].type === "listItemIndent")) break;
      a && (r[1].end = {
        ...p.get(a)[1].start
      }, c = p.slice(a, n), c.unshift(r), p.splice(a, n - a + 1, c));
    }
  }
  return rs(e, 0, Number.POSITIVE_INFINITY, p.slice(0)), !h;
}
function uP(e, t) {
  const n = e.get(t)[1], r = e.get(t)[2];
  let a = t - 1;
  const o = [];
  let l = n._tokenizer;
  l || (l = r.parser[n.contentType](n.start), n._contentTypeTextTrailing && (l._contentTypeTextTrailing = !0));
  const c = l.events, d = [], h = {};
  let p, g, x = -1, b = n, C = 0, N = 0;
  const T = [N];
  for (; b; ) {
    for (; e.get(++a)[1] !== b; )
      ;
    o.push(a), b._tokenizer || (p = r.sliceStream(b), b.next || p.push(null), g && l.defineSkip(b.start), b._isInFirstContentOfListItem && (l._gfmTasklistFirstContentOfListItem = !0), l.write(p), b._isInFirstContentOfListItem && (l._gfmTasklistFirstContentOfListItem = void 0)), g = b, b = b.next;
  }
  for (b = n; ++x < c.length; )
    // Find a void token that includes a break.
    c[x][0] === "exit" && c[x - 1][0] === "enter" && c[x][1].type === c[x - 1][1].type && c[x][1].start.line !== c[x][1].end.line && (N = x + 1, T.push(N), b._tokenizer = void 0, b.previous = void 0, b = b.next);
  for (l.events = [], b ? (b._tokenizer = void 0, b.previous = void 0) : T.pop(), x = T.length; x--; ) {
    const j = c.slice(T[x], T[x + 1]), R = o.pop();
    d.push([R, R + j.length - 1]), e.splice(R, 2, j);
  }
  for (d.reverse(), x = -1; ++x < d.length; )
    h[C + d[x][0]] = C + d[x][1], C += d[x][1] - d[x][0] - 1;
  return h;
}
const cP = {
  resolve: dP,
  tokenize: hP
}, fP = {
  partial: !0,
  tokenize: mP
};
function dP(e) {
  return l9(e), e;
}
function hP(e, t) {
  let n;
  return r;
  function r(c) {
    return e.enter("content"), n = e.enter("chunkContent", {
      contentType: "content"
    }), a(c);
  }
  function a(c) {
    return c === null ? o(c) : jt(c) ? e.check(fP, l, o)(c) : (e.consume(c), a);
  }
  function o(c) {
    return e.exit("chunkContent"), e.exit("content"), t(c);
  }
  function l(c) {
    return e.consume(c), e.exit("chunkContent"), n.next = e.enter("chunkContent", {
      contentType: "content",
      previous: n
    }), n = n.next, a;
  }
}
function mP(e, t, n) {
  const r = this;
  return a;
  function a(l) {
    return e.exit("chunkContent"), e.enter("lineEnding"), e.consume(l), e.exit("lineEnding"), dn(e, o, "linePrefix");
  }
  function o(l) {
    if (l === null || jt(l))
      return n(l);
    const c = r.events[r.events.length - 1];
    return !r.parser.constructs.disable.null.includes("codeIndented") && c && c[1].type === "linePrefix" && c[2].sliceSerialize(c[1], !0).length >= 4 ? t(l) : e.interrupt(r.parser.constructs.flow, n, t)(l);
  }
}
function u9(e, t, n, r, a, o, l, c, d) {
  const h = d || Number.POSITIVE_INFINITY;
  let p = 0;
  return g;
  function g(j) {
    return j === 60 ? (e.enter(r), e.enter(a), e.enter(o), e.consume(j), e.exit(o), x) : j === null || j === 32 || j === 41 || c1(j) ? n(j) : (e.enter(r), e.enter(l), e.enter(c), e.enter("chunkString", {
      contentType: "string"
    }), N(j));
  }
  function x(j) {
    return j === 62 ? (e.enter(o), e.consume(j), e.exit(o), e.exit(a), e.exit(r), t) : (e.enter(c), e.enter("chunkString", {
      contentType: "string"
    }), b(j));
  }
  function b(j) {
    return j === 62 ? (e.exit("chunkString"), e.exit(c), x(j)) : j === null || j === 60 || jt(j) ? n(j) : (e.consume(j), j === 92 ? C : b);
  }
  function C(j) {
    return j === 60 || j === 62 || j === 92 ? (e.consume(j), b) : b(j);
  }
  function N(j) {
    return !p && (j === null || j === 41 || Bn(j)) ? (e.exit("chunkString"), e.exit(c), e.exit(l), e.exit(r), t(j)) : p < h && j === 40 ? (e.consume(j), p++, N) : j === 41 ? (e.consume(j), p--, N) : j === null || j === 32 || j === 40 || c1(j) ? n(j) : (e.consume(j), j === 92 ? T : N);
  }
  function T(j) {
    return j === 40 || j === 41 || j === 92 ? (e.consume(j), N) : N(j);
  }
}
function c9(e, t, n, r, a, o) {
  const l = this;
  let c = 0, d;
  return h;
  function h(b) {
    return e.enter(r), e.enter(a), e.consume(b), e.exit(a), e.enter(o), p;
  }
  function p(b) {
    return c > 999 || b === null || b === 91 || b === 93 && !d || // To do: remove in the future once weve switched from
    // `micromark-extension-footnote` to `micromark-extension-gfm-footnote`,
    // which doesnt need this.
    // Hidden footnotes hook.
    /* c8 ignore next 3 */
    b === 94 && !c && "_hiddenFootnoteSupport" in l.parser.constructs ? n(b) : b === 93 ? (e.exit(o), e.enter(a), e.consume(b), e.exit(a), e.exit(r), t) : jt(b) ? (e.enter("lineEnding"), e.consume(b), e.exit("lineEnding"), p) : (e.enter("chunkString", {
      contentType: "string"
    }), g(b));
  }
  function g(b) {
    return b === null || b === 91 || b === 93 || jt(b) || c++ > 999 ? (e.exit("chunkString"), p(b)) : (e.consume(b), d || (d = !tn(b)), b === 92 ? x : g);
  }
  function x(b) {
    return b === 91 || b === 92 || b === 93 ? (e.consume(b), c++, g) : g(b);
  }
}
function f9(e, t, n, r, a, o) {
  let l;
  return c;
  function c(x) {
    return x === 34 || x === 39 || x === 40 ? (e.enter(r), e.enter(a), e.consume(x), e.exit(a), l = x === 40 ? 41 : x, d) : n(x);
  }
  function d(x) {
    return x === l ? (e.enter(a), e.consume(x), e.exit(a), e.exit(r), t) : (e.enter(o), h(x));
  }
  function h(x) {
    return x === l ? (e.exit(o), d(l)) : x === null ? n(x) : jt(x) ? (e.enter("lineEnding"), e.consume(x), e.exit("lineEnding"), dn(e, h, "linePrefix")) : (e.enter("chunkString", {
      contentType: "string"
    }), p(x));
  }
  function p(x) {
    return x === l || x === null || jt(x) ? (e.exit("chunkString"), h(x)) : (e.consume(x), x === 92 ? g : p);
  }
  function g(x) {
    return x === l || x === 92 ? (e.consume(x), p) : p(x);
  }
}
function og(e, t) {
  let n;
  return r;
  function r(a) {
    return jt(a) ? (e.enter("lineEnding"), e.consume(a), e.exit("lineEnding"), n = !0, r) : tn(a) ? dn(e, r, n ? "linePrefix" : "lineSuffix")(a) : t(a);
  }
}
const pP = {
  name: "definition",
  tokenize: yP
}, gP = {
  partial: !0,
  tokenize: vP
};
function yP(e, t, n) {
  const r = this;
  let a;
  return o;
  function o(b) {
    return e.enter("definition"), l(b);
  }
  function l(b) {
    return c9.call(
      r,
      e,
      c,
      // Note: we dont need to reset the way `markdown-rs` does.
      n,
      "definitionLabel",
      "definitionLabelMarker",
      "definitionLabelString"
    )(b);
  }
  function c(b) {
    return a = mo(r.sliceSerialize(r.events[r.events.length - 1][1]).slice(1, -1)), b === 58 ? (e.enter("definitionMarker"), e.consume(b), e.exit("definitionMarker"), d) : n(b);
  }
  function d(b) {
    return Bn(b) ? og(e, h)(b) : h(b);
  }
  function h(b) {
    return u9(
      e,
      p,
      // Note: we dont need to reset the way `markdown-rs` does.
      n,
      "definitionDestination",
      "definitionDestinationLiteral",
      "definitionDestinationLiteralMarker",
      "definitionDestinationRaw",
      "definitionDestinationString"
    )(b);
  }
  function p(b) {
    return e.attempt(gP, g, g)(b);
  }
  function g(b) {
    return tn(b) ? dn(e, x, "whitespace")(b) : x(b);
  }
  function x(b) {
    return b === null || jt(b) ? (e.exit("definition"), r.parser.defined.push(a), t(b)) : n(b);
  }
}
function vP(e, t, n) {
  return r;
  function r(c) {
    return Bn(c) ? og(e, a)(c) : n(c);
  }
  function a(c) {
    return f9(e, o, n, "definitionTitle", "definitionTitleMarker", "definitionTitleString")(c);
  }
  function o(c) {
    return tn(c) ? dn(e, l, "whitespace")(c) : l(c);
  }
  function l(c) {
    return c === null || jt(c) ? t(c) : n(c);
  }
}
const xP = {
  name: "hardBreakEscape",
  tokenize: bP
};
function bP(e, t, n) {
  return r;
  function r(o) {
    return e.enter("hardBreakEscape"), e.consume(o), a;
  }
  function a(o) {
    return jt(o) ? (e.exit("hardBreakEscape"), t(o)) : n(o);
  }
}
const wP = {
  name: "headingAtx",
  resolve: _P,
  tokenize: SP
};
function _P(e, t) {
  let n = e.length - 2, r = 3, a, o;
  return e[r][1].type === "whitespace" && (r += 2), n - 2 > r && e[n][1].type === "whitespace" && (n -= 2), e[n][1].type === "atxHeadingSequence" && (r === n - 1 || n - 4 > r && e[n - 2][1].type === "whitespace") && (n -= r + 1 === n ? 2 : 4), n > r && (a = {
    type: "atxHeadingText",
    start: e[r][1].start,
    end: e[n][1].end
  }, o = {
    type: "chunkText",
    start: e[r][1].start,
    end: e[n][1].end,
    contentType: "text"
  }, rs(e, r, n - r + 1, [["enter", a, t], ["enter", o, t], ["exit", o, t], ["exit", a, t]])), e;
}
function SP(e, t, n) {
  let r = 0;
  return a;
  function a(p) {
    return e.enter("atxHeading"), o(p);
  }
  function o(p) {
    return e.enter("atxHeadingSequence"), l(p);
  }
  function l(p) {
    return p === 35 && r++ < 6 ? (e.consume(p), l) : p === null || Bn(p) ? (e.exit("atxHeadingSequence"), c(p)) : n(p);
  }
  function c(p) {
    return p === 35 ? (e.enter("atxHeadingSequence"), d(p)) : p === null || jt(p) ? (e.exit("atxHeading"), t(p)) : tn(p) ? dn(e, c, "whitespace")(p) : (e.enter("atxHeadingText"), h(p));
  }
  function d(p) {
    return p === 35 ? (e.consume(p), d) : (e.exit("atxHeadingSequence"), c(p));
  }
  function h(p) {
    return p === null || p === 35 || Bn(p) ? (e.exit("atxHeadingText"), c(p)) : (e.consume(p), h);
  }
}
const CP = [
  "address",
  "article",
  "aside",
  "base",
  "basefont",
  "blockquote",
  "body",
  "caption",
  "center",
  "col",
  "colgroup",
  "dd",
  "details",
  "dialog",
  "dir",
  "div",
  "dl",
  "dt",
  "fieldset",
  "figcaption",
  "figure",
  "footer",
  "form",
  "frame",
  "frameset",
  "h1",
  "h2",
  "h3",
  "h4",
  "h5",
  "h6",
  "head",
  "header",
  "hr",
  "html",
  "iframe",
  "legend",
  "li",
  "link",
  "main",
  "menu",
  "menuitem",
  "nav",
  "noframes",
  "ol",
  "optgroup",
  "option",
  "p",
  "param",
  "search",
  "section",
  "summary",
  "table",
  "tbody",
  "td",
  "tfoot",
  "th",
  "thead",
  "title",
  "tr",
  "track",
  "ul"
], MC = ["pre", "script", "style", "textarea"], EP = {
  concrete: !0,
  name: "htmlFlow",
  resolveTo: jP,
  tokenize: TP
}, kP = {
  partial: !0,
  tokenize: MP
}, NP = {
  partial: !0,
  tokenize: AP
};
function jP(e) {
  let t = e.length;
  for (; t-- && !(e[t][0] === "enter" && e[t][1].type === "htmlFlow"); )
    ;
  return t > 1 && e[t - 2][1].type === "linePrefix" && (e[t][1].start = e[t - 2][1].start, e[t + 1][1].start = e[t - 2][1].start, e.splice(t - 2, 2)), e;
}
function TP(e, t, n) {
  const r = this;
  let a, o, l, c, d;
  return h;
  function h(Y) {
    return p(Y);
  }
  function p(Y) {
    return e.enter("htmlFlow"), e.enter("htmlFlowData"), e.consume(Y), g;
  }
  function g(Y) {
    return Y === 33 ? (e.consume(Y), x) : Y === 47 ? (e.consume(Y), o = !0, N) : Y === 63 ? (e.consume(Y), a = 3, r.interrupt ? t : Q) : ta(Y) ? (e.consume(Y), l = String.fromCharCode(Y), T) : n(Y);
  }
  function x(Y) {
    return Y === 45 ? (e.consume(Y), a = 2, b) : Y === 91 ? (e.consume(Y), a = 5, c = 0, C) : ta(Y) ? (e.consume(Y), a = 4, r.interrupt ? t : Q) : n(Y);
  }
  function b(Y) {
    return Y === 45 ? (e.consume(Y), r.interrupt ? t : Q) : n(Y);
  }
  function C(Y) {
    const le = "CDATA[";
    return Y === le.charCodeAt(c++) ? (e.consume(Y), c === le.length ? r.interrupt ? t : V : C) : n(Y);
  }
  function N(Y) {
    return ta(Y) ? (e.consume(Y), l = String.fromCharCode(Y), T) : n(Y);
  }
  function T(Y) {
    if (Y === null || Y === 47 || Y === 62 || Bn(Y)) {
      const le = Y === 47, xe = l.toLowerCase();
      return !le && !o && MC.includes(xe) ? (a = 1, r.interrupt ? t(Y) : V(Y)) : CP.includes(l.toLowerCase()) ? (a = 6, le ? (e.consume(Y), j) : r.interrupt ? t(Y) : V(Y)) : (a = 7, r.interrupt && !r.parser.lazy[r.now().line] ? n(Y) : o ? R(Y) : A(Y));
    }
    return Y === 45 || Ri(Y) ? (e.consume(Y), l += String.fromCharCode(Y), T) : n(Y);
  }
  function j(Y) {
    return Y === 62 ? (e.consume(Y), r.interrupt ? t : V) : n(Y);
  }
  function R(Y) {
    return tn(Y) ? (e.consume(Y), R) : X(Y);
  }
  function A(Y) {
    return Y === 47 ? (e.consume(Y), X) : Y === 58 || Y === 95 || ta(Y) ? (e.consume(Y), z) : tn(Y) ? (e.consume(Y), A) : X(Y);
  }
  function z(Y) {
    return Y === 45 || Y === 46 || Y === 58 || Y === 95 || Ri(Y) ? (e.consume(Y), z) : q(Y);
  }
  function q(Y) {
    return Y === 61 ? (e.consume(Y), D) : tn(Y) ? (e.consume(Y), q) : A(Y);
  }
  function D(Y) {
    return Y === null || Y === 60 || Y === 61 || Y === 62 || Y === 96 ? n(Y) : Y === 34 || Y === 39 ? (e.consume(Y), d = Y, P) : tn(Y) ? (e.consume(Y), D) : re(Y);
  }
  function P(Y) {
    return Y === d ? (e.consume(Y), d = null, ie) : Y === null || jt(Y) ? n(Y) : (e.consume(Y), P);
  }
  function re(Y) {
    return Y === null || Y === 34 || Y === 39 || Y === 47 || Y === 60 || Y === 61 || Y === 62 || Y === 96 || Bn(Y) ? q(Y) : (e.consume(Y), re);
  }
  function ie(Y) {
    return Y === 47 || Y === 62 || tn(Y) ? A(Y) : n(Y);
  }
  function X(Y) {
    return Y === 62 ? (e.consume(Y), K) : n(Y);
  }
  function K(Y) {
    return Y === null || jt(Y) ? V(Y) : tn(Y) ? (e.consume(Y), K) : n(Y);
  }
  function V(Y) {
    return Y === 45 && a === 2 ? (e.consume(Y), Z) : Y === 60 && a === 1 ? (e.consume(Y), fe) : Y === 62 && a === 4 ? (e.consume(Y), U) : Y === 63 && a === 3 ? (e.consume(Y), Q) : Y === 93 && a === 5 ? (e.consume(Y), ge) : jt(Y) && (a === 6 || a === 7) ? (e.exit("htmlFlowData"), e.check(kP, ue, de)(Y)) : Y === null || jt(Y) ? (e.exit("htmlFlowData"), de(Y)) : (e.consume(Y), V);
  }
  function de(Y) {
    return e.check(NP, H, ue)(Y);
  }
  function H(Y) {
    return e.enter("lineEnding"), e.consume(Y), e.exit("lineEnding"), se;
  }
  function se(Y) {
    return Y === null || jt(Y) ? de(Y) : (e.enter("htmlFlowData"), V(Y));
  }
  function Z(Y) {
    return Y === 45 ? (e.consume(Y), Q) : V(Y);
  }
  function fe(Y) {
    return Y === 47 ? (e.consume(Y), l = "", he) : V(Y);
  }
  function he(Y) {
    if (Y === 62) {
      const le = l.toLowerCase();
      return MC.includes(le) ? (e.consume(Y), U) : V(Y);
    }
    return ta(Y) && l.length < 8 ? (e.consume(Y), l += String.fromCharCode(Y), he) : V(Y);
  }
  function ge(Y) {
    return Y === 93 ? (e.consume(Y), Q) : V(Y);
  }
  function Q(Y) {
    return Y === 62 ? (e.consume(Y), U) : Y === 45 && a === 2 ? (e.consume(Y), Q) : V(Y);
  }
  function U(Y) {
    return Y === null || jt(Y) ? (e.exit("htmlFlowData"), ue(Y)) : (e.consume(Y), U);
  }
  function ue(Y) {
    return e.exit("htmlFlow"), t(Y);
  }
}
function AP(e, t, n) {
  const r = this;
  return a;
  function a(l) {
    return jt(l) ? (e.enter("lineEnding"), e.consume(l), e.exit("lineEnding"), o) : n(l);
  }
  function o(l) {
    return r.parser.lazy[r.now().line] ? n(l) : t(l);
  }
}
function MP(e, t, n) {
  return r;
  function r(a) {
    return e.enter("lineEnding"), e.consume(a), e.exit("lineEnding"), e.attempt(Rg, t, n);
  }
}
const RP = {
  name: "htmlText",
  tokenize: OP
};
function OP(e, t, n) {
  const r = this;
  let a, o, l;
  return c;
  function c(Q) {
    return e.enter("htmlText"), e.enter("htmlTextData"), e.consume(Q), d;
  }
  function d(Q) {
    return Q === 33 ? (e.consume(Q), h) : Q === 47 ? (e.consume(Q), q) : Q === 63 ? (e.consume(Q), A) : ta(Q) ? (e.consume(Q), re) : n(Q);
  }
  function h(Q) {
    return Q === 45 ? (e.consume(Q), p) : Q === 91 ? (e.consume(Q), o = 0, C) : ta(Q) ? (e.consume(Q), R) : n(Q);
  }
  function p(Q) {
    return Q === 45 ? (e.consume(Q), b) : n(Q);
  }
  function g(Q) {
    return Q === null ? n(Q) : Q === 45 ? (e.consume(Q), x) : jt(Q) ? (l = g, fe(Q)) : (e.consume(Q), g);
  }
  function x(Q) {
    return Q === 45 ? (e.consume(Q), b) : g(Q);
  }
  function b(Q) {
    return Q === 62 ? Z(Q) : Q === 45 ? x(Q) : g(Q);
  }
  function C(Q) {
    const U = "CDATA[";
    return Q === U.charCodeAt(o++) ? (e.consume(Q), o === U.length ? N : C) : n(Q);
  }
  function N(Q) {
    return Q === null ? n(Q) : Q === 93 ? (e.consume(Q), T) : jt(Q) ? (l = N, fe(Q)) : (e.consume(Q), N);
  }
  function T(Q) {
    return Q === 93 ? (e.consume(Q), j) : N(Q);
  }
  function j(Q) {
    return Q === 62 ? Z(Q) : Q === 93 ? (e.consume(Q), j) : N(Q);
  }
  function R(Q) {
    return Q === null || Q === 62 ? Z(Q) : jt(Q) ? (l = R, fe(Q)) : (e.consume(Q), R);
  }
  function A(Q) {
    return Q === null ? n(Q) : Q === 63 ? (e.consume(Q), z) : jt(Q) ? (l = A, fe(Q)) : (e.consume(Q), A);
  }
  function z(Q) {
    return Q === 62 ? Z(Q) : A(Q);
  }
  function q(Q) {
    return ta(Q) ? (e.consume(Q), D) : n(Q);
  }
  function D(Q) {
    return Q === 45 || Ri(Q) ? (e.consume(Q), D) : P(Q);
  }
  function P(Q) {
    return jt(Q) ? (l = P, fe(Q)) : tn(Q) ? (e.consume(Q), P) : Z(Q);
  }
  function re(Q) {
    return Q === 45 || Ri(Q) ? (e.consume(Q), re) : Q === 47 || Q === 62 || Bn(Q) ? ie(Q) : n(Q);
  }
  function ie(Q) {
    return Q === 47 ? (e.consume(Q), Z) : Q === 58 || Q === 95 || ta(Q) ? (e.consume(Q), X) : jt(Q) ? (l = ie, fe(Q)) : tn(Q) ? (e.consume(Q), ie) : Z(Q);
  }
  function X(Q) {
    return Q === 45 || Q === 46 || Q === 58 || Q === 95 || Ri(Q) ? (e.consume(Q), X) : K(Q);
  }
  function K(Q) {
    return Q === 61 ? (e.consume(Q), V) : jt(Q) ? (l = K, fe(Q)) : tn(Q) ? (e.consume(Q), K) : ie(Q);
  }
  function V(Q) {
    return Q === null || Q === 60 || Q === 61 || Q === 62 || Q === 96 ? n(Q) : Q === 34 || Q === 39 ? (e.consume(Q), a = Q, de) : jt(Q) ? (l = V, fe(Q)) : tn(Q) ? (e.consume(Q), V) : (e.consume(Q), H);
  }
  function de(Q) {
    return Q === a ? (e.consume(Q), a = void 0, se) : Q === null ? n(Q) : jt(Q) ? (l = de, fe(Q)) : (e.consume(Q), de);
  }
  function H(Q) {
    return Q === null || Q === 34 || Q === 39 || Q === 60 || Q === 61 || Q === 96 ? n(Q) : Q === 47 || Q === 62 || Bn(Q) ? ie(Q) : (e.consume(Q), H);
  }
  function se(Q) {
    return Q === 47 || Q === 62 || Bn(Q) ? ie(Q) : n(Q);
  }
  function Z(Q) {
    return Q === 62 ? (e.consume(Q), e.exit("htmlTextData"), e.exit("htmlText"), t) : n(Q);
  }
  function fe(Q) {
    return e.exit("htmlTextData"), e.enter("lineEnding"), e.consume(Q), e.exit("lineEnding"), he;
  }
  function he(Q) {
    return tn(Q) ? dn(e, ge, "linePrefix", r.parser.constructs.disable.null.includes("codeIndented") ? void 0 : 4)(Q) : ge(Q);
  }
  function ge(Q) {
    return e.enter("htmlTextData"), l(Q);
  }
}
const LS = {
  name: "labelEnd",
  resolveAll: LP,
  resolveTo: PP,
  tokenize: qP
}, zP = {
  tokenize: BP
}, DP = {
  tokenize: FP
}, IP = {
  tokenize: UP
};
function LP(e) {
  let t = -1;
  const n = [];
  for (; ++t < e.length; ) {
    const r = e[t][1];
    if (n.push(e[t]), r.type === "labelImage" || r.type === "labelLink" || r.type === "labelEnd") {
      const a = r.type === "labelImage" ? 4 : 2;
      r.type = "data", t += a;
    }
  }
  return e.length !== n.length && rs(e, 0, e.length, n), e;
}
function PP(e, t) {
  let n = e.length, r = 0, a, o, l, c;
  for (; n--; )
    if (a = e[n][1], o) {
      if (a.type === "link" || a.type === "labelLink" && a._inactive)
        break;
      e[n][0] === "enter" && a.type === "labelLink" && (a._inactive = !0);
    } else if (l) {
      if (e[n][0] === "enter" && (a.type === "labelImage" || a.type === "labelLink") && !a._balanced && (o = n, a.type !== "labelLink")) {
        r = 2;
        break;
      }
    } else a.type === "labelEnd" && (l = n);
  const d = {
    type: e[o][1].type === "labelLink" ? "link" : "image",
    start: {
      ...e[o][1].start
    },
    end: {
      ...e[e.length - 1][1].end
    }
  }, h = {
    type: "label",
    start: {
      ...e[o][1].start
    },
    end: {
      ...e[l][1].end
    }
  }, p = {
    type: "labelText",
    start: {
      ...e[o + r + 2][1].end
    },
    end: {
      ...e[l - 2][1].start
    }
  };
  return c = [["enter", d, t], ["enter", h, t]], c = _s(c, e.slice(o + 1, o + r + 3)), c = _s(c, [["enter", p, t]]), c = _s(c, B1(t.parser.constructs.insideSpan.null, e.slice(o + r + 4, l - 3), t)), c = _s(c, [["exit", p, t], e[l - 2], e[l - 1], ["exit", h, t]]), c = _s(c, e.slice(l + 1)), c = _s(c, [["exit", d, t]]), rs(e, o, e.length, c), e;
}
function qP(e, t, n) {
  const r = this;
  let a = r.events.length, o, l;
  for (; a--; )
    if ((r.events[a][1].type === "labelImage" || r.events[a][1].type === "labelLink") && !r.events[a][1]._balanced) {
      o = r.events[a][1];
      break;
    }
  return c;
  function c(x) {
    return o ? o._inactive ? g(x) : (l = r.parser.defined.includes(mo(r.sliceSerialize({
      start: o.end,
      end: r.now()
    }))), e.enter("labelEnd"), e.enter("labelMarker"), e.consume(x), e.exit("labelMarker"), e.exit("labelEnd"), d) : n(x);
  }
  function d(x) {
    return x === 40 ? e.attempt(zP, p, l ? p : g)(x) : x === 91 ? e.attempt(DP, p, l ? h : g)(x) : l ? p(x) : g(x);
  }
  function h(x) {
    return e.attempt(IP, p, g)(x);
  }
  function p(x) {
    return t(x);
  }
  function g(x) {
    return o._balanced = !0, n(x);
  }
}
function BP(e, t, n) {
  return r;
  function r(g) {
    return e.enter("resource"), e.enter("resourceMarker"), e.consume(g), e.exit("resourceMarker"), a;
  }
  function a(g) {
    return Bn(g) ? og(e, o)(g) : o(g);
  }
  function o(g) {
    return g === 41 ? p(g) : u9(e, l, c, "resourceDestination", "resourceDestinationLiteral", "resourceDestinationLiteralMarker", "resourceDestinationRaw", "resourceDestinationString", 32)(g);
  }
  function l(g) {
    return Bn(g) ? og(e, d)(g) : p(g);
  }
  function c(g) {
    return n(g);
  }
  function d(g) {
    return g === 34 || g === 39 || g === 40 ? f9(e, h, n, "resourceTitle", "resourceTitleMarker", "resourceTitleString")(g) : p(g);
  }
  function h(g) {
    return Bn(g) ? og(e, p)(g) : p(g);
  }
  function p(g) {
    return g === 41 ? (e.enter("resourceMarker"), e.consume(g), e.exit("resourceMarker"), e.exit("resource"), t) : n(g);
  }
}
function FP(e, t, n) {
  const r = this;
  return a;
  function a(c) {
    return c9.call(r, e, o, l, "reference", "referenceMarker", "referenceString")(c);
  }
  function o(c) {
    return r.parser.defined.includes(mo(r.sliceSerialize(r.events[r.events.length - 1][1]).slice(1, -1))) ? t(c) : n(c);
  }
  function l(c) {
    return n(c);
  }
}
function UP(e, t, n) {
  return r;
  function r(o) {
    return e.enter("reference"), e.enter("referenceMarker"), e.consume(o), e.exit("referenceMarker"), a;
  }
  function a(o) {
    return o === 93 ? (e.enter("referenceMarker"), e.consume(o), e.exit("referenceMarker"), e.exit("reference"), t) : n(o);
  }
}
const $P = {
  name: "labelStartImage",
  resolveAll: LS.resolveAll,
  tokenize: HP
};
function HP(e, t, n) {
  const r = this;
  return a;
  function a(c) {
    return e.enter("labelImage"), e.enter("labelImageMarker"), e.consume(c), e.exit("labelImageMarker"), o;
  }
  function o(c) {
    return c === 91 ? (e.enter("labelMarker"), e.consume(c), e.exit("labelMarker"), e.exit("labelImage"), l) : n(c);
  }
  function l(c) {
    return c === 94 && "_hiddenFootnoteSupport" in r.parser.constructs ? n(c) : t(c);
  }
}
const GP = {
  name: "labelStartLink",
  resolveAll: LS.resolveAll,
  tokenize: VP
};
function VP(e, t, n) {
  const r = this;
  return a;
  function a(l) {
    return e.enter("labelLink"), e.enter("labelMarker"), e.consume(l), e.exit("labelMarker"), e.exit("labelLink"), o;
  }
  function o(l) {
    return l === 94 && "_hiddenFootnoteSupport" in r.parser.constructs ? n(l) : t(l);
  }
}
const jx = {
  name: "lineEnding",
  tokenize: KP
};
function KP(e, t) {
  return n;
  function n(r) {
    return e.enter("lineEnding"), e.consume(r), e.exit("lineEnding"), dn(e, t, "linePrefix");
  }
}
const Xy = {
  name: "thematicBreak",
  tokenize: YP
};
function YP(e, t, n) {
  let r = 0, a;
  return o;
  function o(h) {
    return e.enter("thematicBreak"), l(h);
  }
  function l(h) {
    return a = h, c(h);
  }
  function c(h) {
    return h === a ? (e.enter("thematicBreakSequence"), d(h)) : r >= 3 && (h === null || jt(h)) ? (e.exit("thematicBreak"), t(h)) : n(h);
  }
  function d(h) {
    return h === a ? (e.consume(h), r++, d) : (e.exit("thematicBreakSequence"), tn(h) ? dn(e, c, "whitespace")(h) : c(h));
  }
}
const ja = {
  continuation: {
    tokenize: ZP
  },
  exit: eq,
  name: "list",
  tokenize: QP
}, WP = {
  partial: !0,
  tokenize: tq
}, XP = {
  partial: !0,
  tokenize: JP
};
function QP(e, t, n) {
  const r = this, a = r.events[r.events.length - 1];
  let o = a && a[1].type === "linePrefix" ? a[2].sliceSerialize(a[1], !0).length : 0, l = 0;
  return c;
  function c(b) {
    const C = r.containerState.type || (b === 42 || b === 43 || b === 45 ? "listUnordered" : "listOrdered");
    if (C === "listUnordered" ? !r.containerState.marker || b === r.containerState.marker : D3(b)) {
      if (r.containerState.type || (r.containerState.type = C, e.enter(C, {
        _container: !0
      })), C === "listUnordered")
        return e.enter("listItemPrefix"), b === 42 || b === 45 ? e.check(Xy, n, h)(b) : h(b);
      if (!r.interrupt || b === 49)
        return e.enter("listItemPrefix"), e.enter("listItemValue"), d(b);
    }
    return n(b);
  }
  function d(b) {
    return D3(b) && ++l < 10 ? (e.consume(b), d) : (!r.interrupt || l < 2) && (r.containerState.marker ? b === r.containerState.marker : b === 41 || b === 46) ? (e.exit("listItemValue"), h(b)) : n(b);
  }
  function h(b) {
    return e.enter("listItemMarker"), e.consume(b), e.exit("listItemMarker"), r.containerState.marker = r.containerState.marker || b, e.check(
      Rg,
      // Cant be empty when interrupting.
      r.interrupt ? n : p,
      e.attempt(WP, x, g)
    );
  }
  function p(b) {
    return r.containerState.initialBlankLine = !0, o++, x(b);
  }
  function g(b) {
    return tn(b) ? (e.enter("listItemPrefixWhitespace"), e.consume(b), e.exit("listItemPrefixWhitespace"), x) : n(b);
  }
  function x(b) {
    return r.containerState.size = o + r.sliceSerialize(e.exit("listItemPrefix"), !0).length, t(b);
  }
}
function ZP(e, t, n) {
  const r = this;
  return r.containerState._closeFlow = void 0, e.check(Rg, a, o);
  function a(c) {
    return r.containerState.furtherBlankLines = r.containerState.furtherBlankLines || r.containerState.initialBlankLine, dn(e, t, "listItemIndent", r.containerState.size + 1)(c);
  }
  function o(c) {
    return r.containerState.furtherBlankLines || !tn(c) ? (r.containerState.furtherBlankLines = void 0, r.containerState.initialBlankLine = void 0, l(c)) : (r.containerState.furtherBlankLines = void 0, r.containerState.initialBlankLine = void 0, e.attempt(XP, t, l)(c));
  }
  function l(c) {
    return r.containerState._closeFlow = !0, r.interrupt = void 0, dn(e, e.attempt(ja, t, n), "linePrefix", r.parser.constructs.disable.null.includes("codeIndented") ? void 0 : 4)(c);
  }
}
function JP(e, t, n) {
  const r = this;
  return dn(e, a, "listItemIndent", r.containerState.size + 1);
  function a(o) {
    const l = r.events[r.events.length - 1];
    return l && l[1].type === "listItemIndent" && l[2].sliceSerialize(l[1], !0).length === r.containerState.size ? t(o) : n(o);
  }
}
function eq(e) {
  e.exit(this.containerState.type);
}
function tq(e, t, n) {
  const r = this;
  return dn(e, a, "listItemPrefixWhitespace", r.parser.constructs.disable.null.includes("codeIndented") ? void 0 : 5);
  function a(o) {
    const l = r.events[r.events.length - 1];
    return !tn(o) && l && l[1].type === "listItemPrefixWhitespace" ? t(o) : n(o);
  }
}
const RC = {
  name: "setextUnderline",
  resolveTo: nq,
  tokenize: rq
};
function nq(e, t) {
  let n = e.length, r, a, o;
  for (; n--; )
    if (e[n][0] === "enter") {
      if (e[n][1].type === "content") {
        r = n;
        break;
      }
      e[n][1].type === "paragraph" && (a = n);
    } else
      e[n][1].type === "content" && e.splice(n, 1), !o && e[n][1].type === "definition" && (o = n);
  const l = {
    type: "setextHeading",
    start: {
      ...e[r][1].start
    },
    end: {
      ...e[e.length - 1][1].end
    }
  };
  return e[a][1].type = "setextHeadingText", o ? (e.splice(a, 0, ["enter", l, t]), e.splice(o + 1, 0, ["exit", e[r][1], t]), e[r][1].end = {
    ...e[o][1].end
  }) : e[r][1] = l, e.push(["exit", l, t]), e;
}
function rq(e, t, n) {
  const r = this;
  let a;
  return o;
  function o(h) {
    let p = r.events.length, g;
    for (; p--; )
      if (r.events[p][1].type !== "lineEnding" && r.events[p][1].type !== "linePrefix" && r.events[p][1].type !== "content") {
        g = r.events[p][1].type === "paragraph";
        break;
      }
    return !r.parser.lazy[r.now().line] && (r.interrupt || g) ? (e.enter("setextHeadingLine"), a = h, l(h)) : n(h);
  }
  function l(h) {
    return e.enter("setextHeadingLineSequence"), c(h);
  }
  function c(h) {
    return h === a ? (e.consume(h), c) : (e.exit("setextHeadingLineSequence"), tn(h) ? dn(e, d, "lineSuffix")(h) : d(h));
  }
  function d(h) {
    return h === null || jt(h) ? (e.exit("setextHeadingLine"), t(h)) : n(h);
  }
}
const iq = {
  tokenize: aq
};
function aq(e) {
  const t = this, n = e.attempt(
    // Try to parse a blank line.
    Rg,
    r,
    // Try to parse initial flow (essentially, only code).
    e.attempt(this.parser.constructs.flowInitial, a, dn(e, e.attempt(this.parser.constructs.flow, a, e.attempt(cP, a)), "linePrefix"))
  );
  return n;
  function r(o) {
    if (o === null) {
      e.consume(o);
      return;
    }
    return e.enter("lineEndingBlank"), e.consume(o), e.exit("lineEndingBlank"), t.currentConstruct = void 0, n;
  }
  function a(o) {
    if (o === null) {
      e.consume(o);
      return;
    }
    return e.enter("lineEnding"), e.consume(o), e.exit("lineEnding"), t.currentConstruct = void 0, n;
  }
}
const sq = {
  resolveAll: h9()
}, oq = d9("string"), lq = d9("text");
function d9(e) {
  return {
    resolveAll: h9(e === "text" ? uq : void 0),
    tokenize: t
  };
  function t(n) {
    const r = this, a = this.parser.constructs[e], o = n.attempt(a, l, c);
    return l;
    function l(p) {
      return h(p) ? o(p) : c(p);
    }
    function c(p) {
      if (p === null) {
        n.consume(p);
        return;
      }
      return n.enter("data"), n.consume(p), d;
    }
    function d(p) {
      return h(p) ? (n.exit("data"), o(p)) : (n.consume(p), d);
    }
    function h(p) {
      if (p === null)
        return !0;
      const g = a[p];
      let x = -1;
      if (g)
        for (; ++x < g.length; ) {
          const b = g[x];
          if (!b.previous || b.previous.call(r, r.previous))
            return !0;
        }
      return !1;
    }
  }
}
function h9(e) {
  return t;
  function t(n, r) {
    let a = -1, o;
    for (; ++a <= n.length; )
      o === void 0 ? n[a] && n[a][1].type === "data" && (o = a, a++) : (!n[a] || n[a][1].type !== "data") && (a !== o + 2 && (n[o][1].end = n[a - 1][1].end, n.splice(o + 2, a - o - 2), a = o + 2), o = void 0);
    return e ? e(n, r) : n;
  }
}
function uq(e, t) {
  let n = 0;
  for (; ++n <= e.length; )
    if ((n === e.length || e[n][1].type === "lineEnding") && e[n - 1][1].type === "data") {
      const r = e[n - 1][1], a = t.sliceStream(r);
      let o = a.length, l = -1, c = 0, d;
      for (; o--; ) {
        const h = a[o];
        if (typeof h == "string") {
          for (l = h.length; h.charCodeAt(l - 1) === 32; )
            c++, l--;
          if (l) break;
          l = -1;
        } else if (h === -2)
          d = !0, c++;
        else if (h !== -1) {
          o++;
          break;
        }
      }
      if (t._contentTypeTextTrailing && n === e.length && (c = 0), c) {
        const h = {
          type: n === e.length || d || c < 2 ? "lineSuffix" : "hardBreakTrailing",
          start: {
            _bufferIndex: o ? l : r.start._bufferIndex + l,
            _index: r.start._index + o,
            line: r.end.line,
            column: r.end.column - c,
            offset: r.end.offset - c
          },
          end: {
            ...r.end
          }
        };
        r.end = {
          ...h.start
        }, r.start.offset === r.end.offset ? Object.assign(r, h) : (e.splice(n, 0, ["enter", h, t], ["exit", h, t]), n += 2);
      }
      n++;
    }
  return e;
}
const cq = {
  42: ja,
  43: ja,
  45: ja,
  48: ja,
  49: ja,
  50: ja,
  51: ja,
  52: ja,
  53: ja,
  54: ja,
  55: ja,
  56: ja,
  57: ja,
  62: a9
}, fq = {
  91: pP
}, dq = {
  [-2]: Nx,
  [-1]: Nx,
  32: Nx
}, hq = {
  35: wP,
  42: Xy,
  45: [RC, Xy],
  60: EP,
  61: RC,
  95: Xy,
  96: AC,
  126: AC
}, mq = {
  38: o9,
  92: s9
}, pq = {
  [-5]: jx,
  [-4]: jx,
  [-3]: jx,
  33: $P,
  38: o9,
  42: I3,
  60: [GL, RP],
  91: GP,
  92: [xP, s9],
  93: LS,
  95: I3,
  96: iP
}, gq = {
  null: [I3, sq]
}, yq = {
  null: [42, 95]
}, vq = {
  null: []
}, xq = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  attentionMarkers: yq,
  contentInitial: fq,
  disable: vq,
  document: cq,
  flow: hq,
  flowInitial: dq,
  insideSpan: gq,
  string: mq,
  text: pq
}, Symbol.toStringTag, { value: "Module" }));
function bq(e, t, n) {
  let r = {
    _bufferIndex: -1,
    _index: 0,
    line: n && n.line || 1,
    column: n && n.column || 1,
    offset: n && n.offset || 0
  };
  const a = {}, o = [];
  let l = [], c = [];
  const d = {
    attempt: P(q),
    check: P(D),
    consume: R,
    enter: A,
    exit: z,
    interrupt: P(D, {
      interrupt: !0
    })
  }, h = {
    code: null,
    containerState: {},
    defineSkip: N,
    events: [],
    now: C,
    parser: e,
    previous: null,
    sliceSerialize: x,
    sliceStream: b,
    write: g
  };
  let p = t.tokenize.call(h, d);
  return t.resolveAll && o.push(t), h;
  function g(K) {
    return l = _s(l, K), T(), l[l.length - 1] !== null ? [] : (re(t, 0), h.events = B1(o, h.events, h), h.events);
  }
  function x(K, V) {
    return _q(b(K), V);
  }
  function b(K) {
    return wq(l, K);
  }
  function C() {
    const {
      _bufferIndex: K,
      _index: V,
      line: de,
      column: H,
      offset: se
    } = r;
    return {
      _bufferIndex: K,
      _index: V,
      line: de,
      column: H,
      offset: se
    };
  }
  function N(K) {
    a[K.line] = K.column, X();
  }
  function T() {
    let K;
    for (; r._index < l.length; ) {
      const V = l[r._index];
      if (typeof V == "string")
        for (K = r._index, r._bufferIndex < 0 && (r._bufferIndex = 0); r._index === K && r._bufferIndex < V.length; )
          j(V.charCodeAt(r._bufferIndex));
      else
        j(V);
    }
  }
  function j(K) {
    p = p(K);
  }
  function R(K) {
    jt(K) ? (r.line++, r.column = 1, r.offset += K === -3 ? 2 : 1, X()) : K !== -1 && (r.column++, r.offset++), r._bufferIndex < 0 ? r._index++ : (r._bufferIndex++, r._bufferIndex === // Points w/ non-negative `_bufferIndex` reference
    // strings.
    /** @type {string} */
    l[r._index].length && (r._bufferIndex = -1, r._index++)), h.previous = K;
  }
  function A(K, V) {
    const de = V || {};
    return de.type = K, de.start = C(), h.events.push(["enter", de, h]), c.push(de), de;
  }
  function z(K) {
    const V = c.pop();
    return V.end = C(), h.events.push(["exit", V, h]), V;
  }
  function q(K, V) {
    re(K, V.from);
  }
  function D(K, V) {
    V.restore();
  }
  function P(K, V) {
    return de;
    function de(H, se, Z) {
      let fe, he, ge, Q;
      return Array.isArray(H) ? (
        /* c8 ignore next 1 */
        ue(H)
      ) : "tokenize" in H ? (
        // Looks like a construct.
        ue([
          /** @type {Construct} */
          H
        ])
      ) : U(H);
      function U(Se) {
        return Oe;
        function Oe(qe) {
          const Me = qe !== null && Se[qe], Pe = qe !== null && Se.null, Re = [
            // To do: add more extension tests.
            /* c8 ignore next 2 */
            ...Array.isArray(Me) ? Me : Me ? [Me] : [],
            ...Array.isArray(Pe) ? Pe : Pe ? [Pe] : []
          ];
          return ue(Re)(qe);
        }
      }
      function ue(Se) {
        return fe = Se, he = 0, Se.length === 0 ? Z : Y(Se[he]);
      }
      function Y(Se) {
        return Oe;
        function Oe(qe) {
          return Q = ie(), ge = Se, Se.partial || (h.currentConstruct = Se), Se.name && h.parser.constructs.disable.null.includes(Se.name) ? xe() : Se.tokenize.call(
            // If we do have fields, create an object w/ `context` as its
            // prototype.
            // This allows a live binding, which is needed for `interrupt`.
            V ? Object.assign(Object.create(h), V) : h,
            d,
            le,
            xe
          )(qe);
        }
      }
      function le(Se) {
        return K(ge, Q), se;
      }
      function xe(Se) {
        return Q.restore(), ++he < fe.length ? Y(fe[he]) : Z;
      }
    }
  }
  function re(K, V) {
    K.resolveAll && !o.includes(K) && o.push(K), K.resolve && rs(h.events, V, h.events.length - V, K.resolve(h.events.slice(V), h)), K.resolveTo && (h.events = K.resolveTo(h.events, h));
  }
  function ie() {
    const K = C(), V = h.previous, de = h.currentConstruct, H = h.events.length, se = Array.from(c);
    return {
      from: H,
      restore: Z
    };
    function Z() {
      r = K, h.previous = V, h.currentConstruct = de, h.events.length = H, c = se, X();
    }
  }
  function X() {
    r.line in a && r.column < 2 && (r.column = a[r.line], r.offset += a[r.line] - 1);
  }
}
function wq(e, t) {
  const n = t.start._index, r = t.start._bufferIndex, a = t.end._index, o = t.end._bufferIndex;
  let l;
  if (n === a)
    l = [e[n].slice(r, o)];
  else {
    if (l = e.slice(n, a), r > -1) {
      const c = l[0];
      typeof c == "string" ? l[0] = c.slice(r) : l.shift();
    }
    o > 0 && l.push(e[a].slice(0, o));
  }
  return l;
}
function _q(e, t) {
  let n = -1;
  const r = [];
  let a;
  for (; ++n < e.length; ) {
    const o = e[n];
    let l;
    if (typeof o == "string")
      l = o;
    else switch (o) {
      case -5: {
        l = "\r";
        break;
      }
      case -4: {
        l = `
`;
        break;
      }
      case -3: {
        l = `\r
`;
        break;
      }
      case -2: {
        l = t ? " " : "	";
        break;
      }
      case -1: {
        if (!t && a) continue;
        l = " ";
        break;
      }
      default:
        l = String.fromCharCode(o);
    }
    a = o === -2, r.push(l);
  }
  return r.join("");
}
function Sq(e) {
  const r = {
    constructs: (
      /** @type {FullNormalizedExtension} */
      r9([xq, ...(e || {}).extensions || []])
    ),
    content: a(PL),
    defined: [],
    document: a(BL),
    flow: a(iq),
    lazy: {},
    string: a(oq),
    text: a(lq)
  };
  return r;
  function a(o) {
    return l;
    function l(c) {
      return bq(r, o, c);
    }
  }
}
function Cq(e) {
  for (; !l9(e); )
    ;
  return e;
}
const OC = /[\0\t\n\r]/g;
function Eq() {
  let e = 1, t = "", n = !0, r;
  return a;
  function a(o, l, c) {
    const d = [];
    let h, p, g, x, b;
    for (o = t + (typeof o == "string" ? o.toString() : new TextDecoder(l || void 0).decode(o)), g = 0, t = "", n && (o.charCodeAt(0) === 65279 && g++, n = void 0); g < o.length; ) {
      if (OC.lastIndex = g, h = OC.exec(o), x = h && h.index !== void 0 ? h.index : o.length, b = o.charCodeAt(x), !h) {
        t = o.slice(g);
        break;
      }
      if (b === 10 && g === x && r)
        d.push(-3), r = void 0;
      else
        switch (r && (d.push(-5), r = void 0), g < x && (d.push(o.slice(g, x)), e += x - g), b) {
          case 0: {
            d.push(65533), e++;
            break;
          }
          case 9: {
            for (p = Math.ceil(e / 4) * 4, d.push(-2); e++ < p; ) d.push(-1);
            break;
          }
          case 10: {
            d.push(-4), e = 1;
            break;
          }
          default:
            r = !0, e = 1;
        }
      g = x + 1;
    }
    return c && (r && d.push(-5), t && d.push(t), d.push(null)), d;
  }
}
const kq = /\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;
function Nq(e) {
  return e.replace(kq, jq);
}
function jq(e, t, n) {
  if (t)
    return t;
  if (n.charCodeAt(0) === 35) {
    const a = n.charCodeAt(1), o = a === 120 || a === 88;
    return i9(n.slice(o ? 2 : 1), o ? 16 : 10);
  }
  return IS(n) || e;
}
const m9 = {}.hasOwnProperty;
function Tq(e, t, n) {
  return typeof t != "string" && (n = t, t = void 0), Aq(n)(Cq(Sq(n).document().write(Eq()(e, t, !0))));
}
function Aq(e) {
  const t = {
    transforms: [],
    canContainEols: ["emphasis", "fragment", "heading", "paragraph", "strong"],
    enter: {
      autolink: o(Mn),
      autolinkProtocol: ie,
      autolinkEmail: ie,
      atxHeading: o(We),
      blockQuote: o(Pe),
      characterEscape: ie,
      characterReference: ie,
      codeFenced: o(Re),
      codeFencedFenceInfo: l,
      codeFencedFenceMeta: l,
      codeIndented: o(Re, l),
      codeText: o(Be, l),
      codeTextData: ie,
      data: ie,
      codeFlowValue: ie,
      definition: o(Je),
      definitionDestinationString: l,
      definitionLabelString: l,
      definitionTitleString: l,
      emphasis: o(ot),
      hardBreakEscape: o(bt),
      hardBreakTrailing: o(bt),
      htmlFlow: o(vt, l),
      htmlFlowData: ie,
      htmlText: o(vt, l),
      htmlTextData: ie,
      image: o(Yn),
      label: l,
      link: o(Mn),
      listItem: o(Ht),
      listItemValue: x,
      listOrdered: o(Fn, g),
      listUnordered: o(Fn),
      paragraph: o(Rn),
      reference: Y,
      referenceString: l,
      resourceDestinationString: l,
      resourceTitleString: l,
      setextHeading: o(We),
      strong: o(rn),
      thematicBreak: o(Wn)
    },
    exit: {
      atxHeading: d(),
      atxHeadingSequence: q,
      autolink: d(),
      autolinkEmail: Me,
      autolinkProtocol: qe,
      blockQuote: d(),
      characterEscapeValue: X,
      characterReferenceMarkerHexadecimal: xe,
      characterReferenceMarkerNumeric: xe,
      characterReferenceValue: Se,
      characterReference: Oe,
      codeFenced: d(T),
      codeFencedFence: N,
      codeFencedFenceInfo: b,
      codeFencedFenceMeta: C,
      codeFlowValue: X,
      codeIndented: d(j),
      codeText: d(se),
      codeTextData: X,
      data: X,
      definition: d(),
      definitionDestinationString: z,
      definitionLabelString: R,
      definitionTitleString: A,
      emphasis: d(),
      hardBreakEscape: d(V),
      hardBreakTrailing: d(V),
      htmlFlow: d(de),
      htmlFlowData: X,
      htmlText: d(H),
      htmlTextData: X,
      image: d(fe),
      label: ge,
      labelText: he,
      lineEnding: K,
      link: d(Z),
      listItem: d(),
      listOrdered: d(),
      listUnordered: d(),
      paragraph: d(),
      referenceString: le,
      resourceDestinationString: Q,
      resourceTitleString: U,
      resource: ue,
      setextHeading: d(re),
      setextHeadingLineSequence: P,
      setextHeadingText: D,
      strong: d(),
      thematicBreak: d()
    }
  };
  p9(t, (e || {}).mdastExtensions || []);
  const n = {};
  return r;
  function r(Ue) {
    let Ze = {
      type: "root",
      children: []
    };
    const gt = {
      stack: [Ze],
      tokenStack: [],
      config: t,
      enter: c,
      exit: h,
      buffer: l,
      resume: p,
      data: n
    }, Nt = [];
    let Dt = -1;
    for (; ++Dt < Ue.length; )
      if (Ue[Dt][1].type === "listOrdered" || Ue[Dt][1].type === "listUnordered")
        if (Ue[Dt][0] === "enter")
          Nt.push(Dt);
        else {
          const Un = Nt.pop();
          Dt = a(Ue, Un, Dt);
        }
    for (Dt = -1; ++Dt < Ue.length; ) {
      const Un = t[Ue[Dt][0]];
      m9.call(Un, Ue[Dt][1].type) && Un[Ue[Dt][1].type].call(Object.assign({
        sliceSerialize: Ue[Dt][2].sliceSerialize
      }, gt), Ue[Dt][1]);
    }
    if (gt.tokenStack.length > 0) {
      const Un = gt.tokenStack[gt.tokenStack.length - 1];
      (Un[1] || zC).call(gt, void 0, Un[0]);
    }
    for (Ze.position = {
      start: fc(Ue.length > 0 ? Ue[0][1].start : {
        line: 1,
        column: 1,
        offset: 0
      }),
      end: fc(Ue.length > 0 ? Ue[Ue.length - 2][1].end : {
        line: 1,
        column: 1,
        offset: 0
      })
    }, Dt = -1; ++Dt < t.transforms.length; )
      Ze = t.transforms[Dt](Ze) || Ze;
    return Ze;
  }
  function a(Ue, Ze, gt) {
    let Nt = Ze - 1, Dt = -1, Un = !1, $n, an, Qt, En;
    for (; ++Nt <= gt; ) {
      const it = Ue[Nt];
      switch (it[1].type) {
        case "listUnordered":
        case "listOrdered":
        case "blockQuote": {
          it[0] === "enter" ? Dt++ : Dt--, En = void 0;
          break;
        }
        case "lineEndingBlank": {
          it[0] === "enter" && ($n && !En && !Dt && !Qt && (Qt = Nt), En = void 0);
          break;
        }
        case "linePrefix":
        case "listItemValue":
        case "listItemMarker":
        case "listItemPrefix":
        case "listItemPrefixWhitespace":
          break;
        default:
          En = void 0;
      }
      if (!Dt && it[0] === "enter" && it[1].type === "listItemPrefix" || Dt === -1 && it[0] === "exit" && (it[1].type === "listUnordered" || it[1].type === "listOrdered")) {
        if ($n) {
          let jr = Nt;
          for (an = void 0; jr--; ) {
            const lr = Ue[jr];
            if (lr[1].type === "lineEnding" || lr[1].type === "lineEndingBlank") {
              if (lr[0] === "exit") continue;
              an && (Ue[an][1].type = "lineEndingBlank", Un = !0), lr[1].type = "lineEnding", an = jr;
            } else if (!(lr[1].type === "linePrefix" || lr[1].type === "blockQuotePrefix" || lr[1].type === "blockQuotePrefixWhitespace" || lr[1].type === "blockQuoteMarker" || lr[1].type === "listItemIndent")) break;
          }
          Qt && (!an || Qt < an) && ($n._spread = !0), $n.end = Object.assign({}, an ? Ue[an][1].start : it[1].end), Ue.splice(an || Nt, 0, ["exit", $n, it[2]]), Nt++, gt++;
        }
        if (it[1].type === "listItemPrefix") {
          const jr = {
            type: "listItem",
            _spread: !1,
            start: Object.assign({}, it[1].start),
            // @ts-expect-error: well add `end` in a second.
            end: void 0
          };
          $n = jr, Ue.splice(Nt, 0, ["enter", jr, it[2]]), Nt++, gt++, Qt = void 0, En = !0;
        }
      }
    }
    return Ue[Ze][1]._spread = Un, gt;
  }
  function o(Ue, Ze) {
    return gt;
    function gt(Nt) {
      c.call(this, Ue(Nt), Nt), Ze && Ze.call(this, Nt);
    }
  }
  function l() {
    this.stack.push({
      type: "fragment",
      children: []
    });
  }
  function c(Ue, Ze, gt) {
    this.stack[this.stack.length - 1].children.push(Ue), this.stack.push(Ue), this.tokenStack.push([Ze, gt || void 0]), Ue.position = {
      start: fc(Ze.start),
      // @ts-expect-error: `end` will be patched later.
      end: void 0
    };
  }
  function d(Ue) {
    return Ze;
    function Ze(gt) {
      Ue && Ue.call(this, gt), h.call(this, gt);
    }
  }
  function h(Ue, Ze) {
    const gt = this.stack.pop(), Nt = this.tokenStack.pop();
    if (Nt)
      Nt[0].type !== Ue.type && (Ze ? Ze.call(this, Ue, Nt[0]) : (Nt[1] || zC).call(this, Ue, Nt[0]));
    else throw new Error("Cannot close `" + Ue.type + "` (" + sg({
      start: Ue.start,
      end: Ue.end
    }) + "): its not open");
    gt.position.end = fc(Ue.end);
  }
  function p() {
    return DS(this.stack.pop());
  }
  function g() {
    this.data.expectingFirstListItemValue = !0;
  }
  function x(Ue) {
    if (this.data.expectingFirstListItemValue) {
      const Ze = this.stack[this.stack.length - 2];
      Ze.start = Number.parseInt(this.sliceSerialize(Ue), 10), this.data.expectingFirstListItemValue = void 0;
    }
  }
  function b() {
    const Ue = this.resume(), Ze = this.stack[this.stack.length - 1];
    Ze.lang = Ue;
  }
  function C() {
    const Ue = this.resume(), Ze = this.stack[this.stack.length - 1];
    Ze.meta = Ue;
  }
  function N() {
    this.data.flowCodeInside || (this.buffer(), this.data.flowCodeInside = !0);
  }
  function T() {
    const Ue = this.resume(), Ze = this.stack[this.stack.length - 1];
    Ze.value = Ue.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g, ""), this.data.flowCodeInside = void 0;
  }
  function j() {
    const Ue = this.resume(), Ze = this.stack[this.stack.length - 1];
    Ze.value = Ue.replace(/(\r?\n|\r)$/g, "");
  }
  function R(Ue) {
    const Ze = this.resume(), gt = this.stack[this.stack.length - 1];
    gt.label = Ze, gt.identifier = mo(this.sliceSerialize(Ue)).toLowerCase();
  }
  function A() {
    const Ue = this.resume(), Ze = this.stack[this.stack.length - 1];
    Ze.title = Ue;
  }
  function z() {
    const Ue = this.resume(), Ze = this.stack[this.stack.length - 1];
    Ze.url = Ue;
  }
  function q(Ue) {
    const Ze = this.stack[this.stack.length - 1];
    if (!Ze.depth) {
      const gt = this.sliceSerialize(Ue).length;
      Ze.depth = gt;
    }
  }
  function D() {
    this.data.setextHeadingSlurpLineEnding = !0;
  }
  function P(Ue) {
    const Ze = this.stack[this.stack.length - 1];
    Ze.depth = this.sliceSerialize(Ue).codePointAt(0) === 61 ? 1 : 2;
  }
  function re() {
    this.data.setextHeadingSlurpLineEnding = void 0;
  }
  function ie(Ue) {
    const gt = this.stack[this.stack.length - 1].children;
    let Nt = gt[gt.length - 1];
    (!Nt || Nt.type !== "text") && (Nt = Cn(), Nt.position = {
      start: fc(Ue.start),
      // @ts-expect-error: well add `end` later.
      end: void 0
    }, gt.push(Nt)), this.stack.push(Nt);
  }
  function X(Ue) {
    const Ze = this.stack.pop();
    Ze.value += this.sliceSerialize(Ue), Ze.position.end = fc(Ue.end);
  }
  function K(Ue) {
    const Ze = this.stack[this.stack.length - 1];
    if (this.data.atHardBreak) {
      const gt = Ze.children[Ze.children.length - 1];
      gt.position.end = fc(Ue.end), this.data.atHardBreak = void 0;
      return;
    }
    !this.data.setextHeadingSlurpLineEnding && t.canContainEols.includes(Ze.type) && (ie.call(this, Ue), X.call(this, Ue));
  }
  function V() {
    this.data.atHardBreak = !0;
  }
  function de() {
    const Ue = this.resume(), Ze = this.stack[this.stack.length - 1];
    Ze.value = Ue;
  }
  function H() {
    const Ue = this.resume(), Ze = this.stack[this.stack.length - 1];
    Ze.value = Ue;
  }
  function se() {
    const Ue = this.resume(), Ze = this.stack[this.stack.length - 1];
    Ze.value = Ue;
  }
  function Z() {
    const Ue = this.stack[this.stack.length - 1];
    if (this.data.inReference) {
      const Ze = this.data.referenceType || "shortcut";
      Ue.type += "Reference", Ue.referenceType = Ze, delete Ue.url, delete Ue.title;
    } else
      delete Ue.identifier, delete Ue.label;
    this.data.referenceType = void 0;
  }
  function fe() {
    const Ue = this.stack[this.stack.length - 1];
    if (this.data.inReference) {
      const Ze = this.data.referenceType || "shortcut";
      Ue.type += "Reference", Ue.referenceType = Ze, delete Ue.url, delete Ue.title;
    } else
      delete Ue.identifier, delete Ue.label;
    this.data.referenceType = void 0;
  }
  function he(Ue) {
    const Ze = this.sliceSerialize(Ue), gt = this.stack[this.stack.length - 2];
    gt.label = Nq(Ze), gt.identifier = mo(Ze).toLowerCase();
  }
  function ge() {
    const Ue = this.stack[this.stack.length - 1], Ze = this.resume(), gt = this.stack[this.stack.length - 1];
    if (this.data.inReference = !0, gt.type === "link") {
      const Nt = Ue.children;
      gt.children = Nt;
    } else
      gt.alt = Ze;
  }
  function Q() {
    const Ue = this.resume(), Ze = this.stack[this.stack.length - 1];
    Ze.url = Ue;
  }
  function U() {
    const Ue = this.resume(), Ze = this.stack[this.stack.length - 1];
    Ze.title = Ue;
  }
  function ue() {
    this.data.inReference = void 0;
  }
  function Y() {
    this.data.referenceType = "collapsed";
  }
  function le(Ue) {
    const Ze = this.resume(), gt = this.stack[this.stack.length - 1];
    gt.label = Ze, gt.identifier = mo(this.sliceSerialize(Ue)).toLowerCase(), this.data.referenceType = "full";
  }
  function xe(Ue) {
    this.data.characterReferenceType = Ue.type;
  }
  function Se(Ue) {
    const Ze = this.sliceSerialize(Ue), gt = this.data.characterReferenceType;
    let Nt;
    gt ? (Nt = i9(Ze, gt === "characterReferenceMarkerNumeric" ? 10 : 16), this.data.characterReferenceType = void 0) : Nt = IS(Ze);
    const Dt = this.stack[this.stack.length - 1];
    Dt.value += Nt;
  }
  function Oe(Ue) {
    const Ze = this.stack.pop();
    Ze.position.end = fc(Ue.end);
  }
  function qe(Ue) {
    X.call(this, Ue);
    const Ze = this.stack[this.stack.length - 1];
    Ze.url = this.sliceSerialize(Ue);
  }
  function Me(Ue) {
    X.call(this, Ue);
    const Ze = this.stack[this.stack.length - 1];
    Ze.url = "mailto:" + this.sliceSerialize(Ue);
  }
  function Pe() {
    return {
      type: "blockquote",
      children: []
    };
  }
  function Re() {
    return {
      type: "code",
      lang: null,
      meta: null,
      value: ""
    };
  }
  function Be() {
    return {
      type: "inlineCode",
      value: ""
    };
  }
  function Je() {
    return {
      type: "definition",
      identifier: "",
      label: null,
      title: null,
      url: ""
    };
  }
  function ot() {
    return {
      type: "emphasis",
      children: []
    };
  }
  function We() {
    return {
      type: "heading",
      // @ts-expect-error `depth` will be set later.
      depth: 0,
      children: []
    };
  }
  function bt() {
    return {
      type: "break"
    };
  }
  function vt() {
    return {
      type: "html",
      value: ""
    };
  }
  function Yn() {
    return {
      type: "image",
      title: null,
      url: "",
      alt: null
    };
  }
  function Mn() {
    return {
      type: "link",
      title: null,
      url: "",
      children: []
    };
  }
  function Fn(Ue) {
    return {
      type: "list",
      ordered: Ue.type === "listOrdered",
      start: null,
      spread: Ue._spread,
      children: []
    };
  }
  function Ht(Ue) {
    return {
      type: "listItem",
      spread: Ue._spread,
      checked: null,
      children: []
    };
  }
  function Rn() {
    return {
      type: "paragraph",
      children: []
    };
  }
  function rn() {
    return {
      type: "strong",
      children: []
    };
  }
  function Cn() {
    return {
      type: "text",
      value: ""
    };
  }
  function Wn() {
    return {
      type: "thematicBreak"
    };
  }
}
function fc(e) {
  return {
    line: e.line,
    column: e.column,
    offset: e.offset
  };
}
function p9(e, t) {
  let n = -1;
  for (; ++n < t.length; ) {
    const r = t[n];
    Array.isArray(r) ? p9(e, r) : Mq(e, r);
  }
}
function Mq(e, t) {
  let n;
  for (n in t)
    if (m9.call(t, n))
      switch (n) {
        case "canContainEols": {
          const r = t[n];
          r && e[n].push(...r);
          break;
        }
        case "transforms": {
          const r = t[n];
          r && e[n].push(...r);
          break;
        }
        case "enter":
        case "exit": {
          const r = t[n];
          r && Object.assign(e[n], r);
          break;
        }
      }
}
function zC(e, t) {
  throw e ? new Error("Cannot close `" + e.type + "` (" + sg({
    start: e.start,
    end: e.end
  }) + "): a different token (`" + t.type + "`, " + sg({
    start: t.start,
    end: t.end
  }) + ") is open") : new Error("Cannot close document, a token (`" + t.type + "`, " + sg({
    start: t.start,
    end: t.end
  }) + ") is still open");
}
function Rq(e) {
  const t = this;
  t.parser = n;
  function n(r) {
    return Tq(r, {
      ...t.data("settings"),
      ...e,
      // Note: these options are not in the readme.
      // The goal is for them to be set by plugins on `data` instead of being
      // passed by users.
      extensions: t.data("micromarkExtensions") || [],
      mdastExtensions: t.data("fromMarkdownExtensions") || []
    });
  }
}
function Oq(e, t) {
  const n = {
    type: "element",
    tagName: "blockquote",
    properties: {},
    children: e.wrap(e.all(t), !0)
  };
  return e.patch(t, n), e.applyData(t, n);
}
function zq(e, t) {
  const n = { type: "element", tagName: "br", properties: {}, children: [] };
  return e.patch(t, n), [e.applyData(t, n), { type: "text", value: `
` }];
}
function Dq(e, t) {
  const n = t.value ? t.value + `
` : "", r = {}, a = t.lang ? t.lang.split(/\s+/) : [];
  a.length > 0 && (r.className = ["language-" + a[0]]);
  let o = {
    type: "element",
    tagName: "code",
    properties: r,
    children: [{ type: "text", value: n }]
  };
  return t.meta && (o.data = { meta: t.meta }), e.patch(t, o), o = e.applyData(t, o), o = { type: "element", tagName: "pre", properties: {}, children: [o] }, e.patch(t, o), o;
}
function Iq(e, t) {
  const n = {
    type: "element",
    tagName: "del",
    properties: {},
    children: e.all(t)
  };
  return e.patch(t, n), e.applyData(t, n);
}
function Lq(e, t) {
  const n = {
    type: "element",
    tagName: "em",
    properties: {},
    children: e.all(t)
  };
  return e.patch(t, n), e.applyData(t, n);
}
function Pq(e, t) {
  const n = typeof e.options.clobberPrefix == "string" ? e.options.clobberPrefix : "user-content-", r = String(t.identifier).toUpperCase(), a = rm(r.toLowerCase()), o = e.footnoteOrder.indexOf(r);
  let l, c = e.footnoteCounts.get(r);
  c === void 0 ? (c = 0, e.footnoteOrder.push(r), l = e.footnoteOrder.length) : l = o + 1, c += 1, e.footnoteCounts.set(r, c);
  const d = {
    type: "element",
    tagName: "a",
    properties: {
      href: "#" + n + "fn-" + a,
      id: n + "fnref-" + a + (c > 1 ? "-" + c : ""),
      dataFootnoteRef: !0,
      ariaDescribedBy: ["footnote-label"]
    },
    children: [{ type: "text", value: String(l) }]
  };
  e.patch(t, d);
  const h = {
    type: "element",
    tagName: "sup",
    properties: {},
    children: [d]
  };
  return e.patch(t, h), e.applyData(t, h);
}
function qq(e, t) {
  const n = {
    type: "element",
    tagName: "h" + t.depth,
    properties: {},
    children: e.all(t)
  };
  return e.patch(t, n), e.applyData(t, n);
}
function Bq(e, t) {
  if (e.options.allowDangerousHtml) {
    const n = { type: "raw", value: t.value };
    return e.patch(t, n), e.applyData(t, n);
  }
}
function g9(e, t) {
  const n = t.referenceType;
  let r = "]";
  if (n === "collapsed" ? r += "[]" : n === "full" && (r += "[" + (t.label || t.identifier) + "]"), t.type === "imageReference")
    return [{ type: "text", value: "![" + t.alt + r }];
  const a = e.all(t), o = a[0];
  o && o.type === "text" ? o.value = "[" + o.value : a.unshift({ type: "text", value: "[" });
  const l = a[a.length - 1];
  return l && l.type === "text" ? l.value += r : a.push({ type: "text", value: r }), a;
}
function Fq(e, t) {
  const n = String(t.identifier).toUpperCase(), r = e.definitionById.get(n);
  if (!r)
    return g9(e, t);
  const a = { src: rm(r.url || ""), alt: t.alt };
  r.title !== null && r.title !== void 0 && (a.title = r.title);
  const o = { type: "element", tagName: "img", properties: a, children: [] };
  return e.patch(t, o), e.applyData(t, o);
}
function Uq(e, t) {
  const n = { src: rm(t.url) };
  t.alt !== null && t.alt !== void 0 && (n.alt = t.alt), t.title !== null && t.title !== void 0 && (n.title = t.title);
  const r = { type: "element", tagName: "img", properties: n, children: [] };
  return e.patch(t, r), e.applyData(t, r);
}
function $q(e, t) {
  const n = { type: "text", value: t.value.replace(/\r?\n|\r/g, " ") };
  e.patch(t, n);
  const r = {
    type: "element",
    tagName: "code",
    properties: {},
    children: [n]
  };
  return e.patch(t, r), e.applyData(t, r);
}
function Hq(e, t) {
  const n = String(t.identifier).toUpperCase(), r = e.definitionById.get(n);
  if (!r)
    return g9(e, t);
  const a = { href: rm(r.url || "") };
  r.title !== null && r.title !== void 0 && (a.title = r.title);
  const o = {
    type: "element",
    tagName: "a",
    properties: a,
    children: e.all(t)
  };
  return e.patch(t, o), e.applyData(t, o);
}
function Gq(e, t) {
  const n = { href: rm(t.url) };
  t.title !== null && t.title !== void 0 && (n.title = t.title);
  const r = {
    type: "element",
    tagName: "a",
    properties: n,
    children: e.all(t)
  };
  return e.patch(t, r), e.applyData(t, r);
}
function Vq(e, t, n) {
  const r = e.all(t), a = n ? Kq(n) : y9(t), o = {}, l = [];
  if (typeof t.checked == "boolean") {
    const p = r[0];
    let g;
    p && p.type === "element" && p.tagName === "p" ? g = p : (g = { type: "element", tagName: "p", properties: {}, children: [] }, r.unshift(g)), g.children.length > 0 && g.children.unshift({ type: "text", value: " " }), g.children.unshift({
      type: "element",
      tagName: "input",
      properties: { type: "checkbox", checked: t.checked, disabled: !0 },
      children: []
    }), o.className = ["task-list-item"];
  }
  let c = -1;
  for (; ++c < r.length; ) {
    const p = r[c];
    (a || c !== 0 || p.type !== "element" || p.tagName !== "p") && l.push({ type: "text", value: `
` }), p.type === "element" && p.tagName === "p" && !a ? l.push(...p.children) : l.push(p);
  }
  const d = r[r.length - 1];
  d && (a || d.type !== "element" || d.tagName !== "p") && l.push({ type: "text", value: `
` });
  const h = { type: "element", tagName: "li", properties: o, children: l };
  return e.patch(t, h), e.applyData(t, h);
}
function Kq(e) {
  let t = !1;
  if (e.type === "list") {
    t = e.spread || !1;
    const n = e.children;
    let r = -1;
    for (; !t && ++r < n.length; )
      t = y9(n[r]);
  }
  return t;
}
function y9(e) {
  const t = e.spread;
  return t ?? e.children.length > 1;
}
function Yq(e, t) {
  const n = {}, r = e.all(t);
  let a = -1;
  for (typeof t.start == "number" && t.start !== 1 && (n.start = t.start); ++a < r.length; ) {
    const l = r[a];
    if (l.type === "element" && l.tagName === "li" && l.properties && Array.isArray(l.properties.className) && l.properties.className.includes("task-list-item")) {
      n.className = ["contains-task-list"];
      break;
    }
  }
  const o = {
    type: "element",
    tagName: t.ordered ? "ol" : "ul",
    properties: n,
    children: e.wrap(r, !0)
  };
  return e.patch(t, o), e.applyData(t, o);
}
function Wq(e, t) {
  const n = {
    type: "element",
    tagName: "p",
    properties: {},
    children: e.all(t)
  };
  return e.patch(t, n), e.applyData(t, n);
}
function Xq(e, t) {
  const n = { type: "root", children: e.wrap(e.all(t)) };
  return e.patch(t, n), e.applyData(t, n);
}
function Qq(e, t) {
  const n = {
    type: "element",
    tagName: "strong",
    properties: {},
    children: e.all(t)
  };
  return e.patch(t, n), e.applyData(t, n);
}
function Zq(e, t) {
  const n = e.all(t), r = n.shift(), a = [];
  if (r) {
    const l = {
      type: "element",
      tagName: "thead",
      properties: {},
      children: e.wrap([r], !0)
    };
    e.patch(t.children[0], l), a.push(l);
  }
  if (n.length > 0) {
    const l = {
      type: "element",
      tagName: "tbody",
      properties: {},
      children: e.wrap(n, !0)
    }, c = MS(t.children[1]), d = X7(t.children[t.children.length - 1]);
    c && d && (l.position = { start: c, end: d }), a.push(l);
  }
  const o = {
    type: "element",
    tagName: "table",
    properties: {},
    children: e.wrap(a, !0)
  };
  return e.patch(t, o), e.applyData(t, o);
}
function Jq(e, t, n) {
  const r = n ? n.children : void 0, o = (r ? r.indexOf(t) : 1) === 0 ? "th" : "td", l = n && n.type === "table" ? n.align : void 0, c = l ? l.length : t.children.length;
  let d = -1;
  const h = [];
  for (; ++d < c; ) {
    const g = t.children[d], x = {}, b = l ? l[d] : void 0;
    b && (x.align = b);
    let C = { type: "element", tagName: o, properties: x, children: [] };
    g && (C.children = e.all(g), e.patch(g, C), C = e.applyData(g, C)), h.push(C);
  }
  const p = {
    type: "element",
    tagName: "tr",
    properties: {},
    children: e.wrap(h, !0)
  };
  return e.patch(t, p), e.applyData(t, p);
}
function eB(e, t) {
  const n = {
    type: "element",
    tagName: "td",
    // Assume body cell.
    properties: {},
    children: e.all(t)
  };
  return e.patch(t, n), e.applyData(t, n);
}
const DC = 9, IC = 32;
function tB(e) {
  const t = String(e), n = /\r?\n|\r/g;
  let r = n.exec(t), a = 0;
  const o = [];
  for (; r; )
    o.push(
      LC(t.slice(a, r.index), a > 0, !0),
      r[0]
    ), a = r.index + r[0].length, r = n.exec(t);
  return o.push(LC(t.slice(a), a > 0, !1)), o.join("");
}
function LC(e, t, n) {
  let r = 0, a = e.length;
  if (t) {
    let o = e.codePointAt(r);
    for (; o === DC || o === IC; )
      r++, o = e.codePointAt(r);
  }
  if (n) {
    let o = e.codePointAt(a - 1);
    for (; o === DC || o === IC; )
      a--, o = e.codePointAt(a - 1);
  }
  return a > r ? e.slice(r, a) : "";
}
function nB(e, t) {
  const n = { type: "text", value: tB(String(t.value)) };
  return e.patch(t, n), e.applyData(t, n);
}
function rB(e, t) {
  const n = {
    type: "element",
    tagName: "hr",
    properties: {},
    children: []
  };
  return e.patch(t, n), e.applyData(t, n);
}
const iB = {
  blockquote: Oq,
  break: zq,
  code: Dq,
  delete: Iq,
  emphasis: Lq,
  footnoteReference: Pq,
  heading: qq,
  html: Bq,
  imageReference: Fq,
  image: Uq,
  inlineCode: $q,
  linkReference: Hq,
  link: Gq,
  listItem: Vq,
  list: Yq,
  paragraph: Wq,
  // @ts-expect-error: root is different, but hard to type.
  root: Xq,
  strong: Qq,
  table: Zq,
  tableCell: eB,
  tableRow: Jq,
  text: nB,
  thematicBreak: rB,
  toml: Ry,
  yaml: Ry,
  definition: Ry,
  footnoteDefinition: Ry
};
function Ry() {
}
const v9 = -1, F1 = 0, lg = 1, f1 = 2, PS = 3, qS = 4, BS = 5, FS = 6, x9 = 7, b9 = 8, PC = typeof self == "object" ? self : globalThis, aB = (e, t) => {
  const n = (a, o) => (e.set(o, a), a), r = (a) => {
    if (e.has(a))
      return e.get(a);
    const [o, l] = t[a];
    switch (o) {
      case F1:
      case v9:
        return n(l, a);
      case lg: {
        const c = n([], a);
        for (const d of l)
          c.push(r(d));
        return c;
      }
      case f1: {
        const c = n({}, a);
        for (const [d, h] of l)
          c[r(d)] = r(h);
        return c;
      }
      case PS:
        return n(new Date(l), a);
      case qS: {
        const { source: c, flags: d } = l;
        return n(new RegExp(c, d), a);
      }
      case BS: {
        const c = n(/* @__PURE__ */ new Map(), a);
        for (const [d, h] of l)
          c.set(r(d), r(h));
        return c;
      }
      case FS: {
        const c = n(/* @__PURE__ */ new Set(), a);
        for (const d of l)
          c.add(r(d));
        return c;
      }
      case x9: {
        const { name: c, message: d } = l;
        return n(new PC[c](d), a);
      }
      case b9:
        return n(BigInt(l), a);
      case "BigInt":
        return n(Object(BigInt(l)), a);
      case "ArrayBuffer":
        return n(new Uint8Array(l).buffer, l);
      case "DataView": {
        const { buffer: c } = new Uint8Array(l);
        return n(new DataView(c), l);
      }
    }
    return n(new PC[o](l), a);
  };
  return r;
}, qC = (e) => aB(/* @__PURE__ */ new Map(), e)(0), jh = "", { toString: sB } = {}, { keys: oB } = Object, Vp = (e) => {
  const t = typeof e;
  if (t !== "object" || !e)
    return [F1, t];
  const n = sB.call(e).slice(8, -1);
  switch (n) {
    case "Array":
      return [lg, jh];
    case "Object":
      return [f1, jh];
    case "Date":
      return [PS, jh];
    case "RegExp":
      return [qS, jh];
    case "Map":
      return [BS, jh];
    case "Set":
      return [FS, jh];
    case "DataView":
      return [lg, n];
  }
  return n.includes("Array") ? [lg, n] : n.includes("Error") ? [x9, n] : [f1, n];
}, Oy = ([e, t]) => e === F1 && (t === "function" || t === "symbol"), lB = (e, t, n, r) => {
  const a = (l, c) => {
    const d = r.push(l) - 1;
    return n.set(c, d), d;
  }, o = (l) => {
    if (n.has(l))
      return n.get(l);
    let [c, d] = Vp(l);
    switch (c) {
      case F1: {
        let p = l;
        switch (d) {
          case "bigint":
            c = b9, p = l.toString();
            break;
          case "function":
          case "symbol":
            if (e)
              throw new TypeError("unable to serialize " + d);
            p = null;
            break;
          case "undefined":
            return a([v9], l);
        }
        return a([c, p], l);
      }
      case lg: {
        if (d) {
          let x = l;
          return d === "DataView" ? x = new Uint8Array(l.buffer) : d === "ArrayBuffer" && (x = new Uint8Array(l)), a([d, [...x]], l);
        }
        const p = [], g = a([c, p], l);
        for (const x of l)
          p.push(o(x));
        return g;
      }
      case f1: {
        if (d)
          switch (d) {
            case "BigInt":
              return a([d, l.toString()], l);
            case "Boolean":
            case "Number":
            case "String":
              return a([d, l.valueOf()], l);
          }
        if (t && "toJSON" in l)
          return o(l.toJSON());
        const p = [], g = a([c, p], l);
        for (const x of oB(l))
          (e || !Oy(Vp(l[x]))) && p.push([o(x), o(l[x])]);
        return g;
      }
      case PS:
        return a([c, l.toISOString()], l);
      case qS: {
        const { source: p, flags: g } = l;
        return a([c, { source: p, flags: g }], l);
      }
      case BS: {
        const p = [], g = a([c, p], l);
        for (const [x, b] of l)
          (e || !(Oy(Vp(x)) || Oy(Vp(b)))) && p.push([o(x), o(b)]);
        return g;
      }
      case FS: {
        const p = [], g = a([c, p], l);
        for (const x of l)
          (e || !Oy(Vp(x))) && p.push(o(x));
        return g;
      }
    }
    const { message: h } = l;
    return a([c, { name: d, message: h }], l);
  };
  return o;
}, BC = (e, { json: t, lossy: n } = {}) => {
  const r = [];
  return lB(!(t || n), !!t, /* @__PURE__ */ new Map(), r)(e), r;
}, d1 = typeof structuredClone == "function" ? (
  /* c8 ignore start */
  (e, t) => t && ("json" in t || "lossy" in t) ? qC(BC(e, t)) : structuredClone(e)
) : (e, t) => qC(BC(e, t));
function uB(e, t) {
  const n = [{ type: "text", value: "" }];
  return t > 1 && n.push({
    type: "element",
    tagName: "sup",
    properties: {},
    children: [{ type: "text", value: String(t) }]
  }), n;
}
function cB(e, t) {
  return "Back to reference " + (e + 1) + (t > 1 ? "-" + t : "");
}
function fB(e) {
  const t = typeof e.options.clobberPrefix == "string" ? e.options.clobberPrefix : "user-content-", n = e.options.footnoteBackContent || uB, r = e.options.footnoteBackLabel || cB, a = e.options.footnoteLabel || "Footnotes", o = e.options.footnoteLabelTagName || "h2", l = e.options.footnoteLabelProperties || {
    className: ["sr-only"]
  }, c = [];
  let d = -1;
  for (; ++d < e.footnoteOrder.length; ) {
    const h = e.footnoteById.get(
      e.footnoteOrder[d]
    );
    if (!h)
      continue;
    const p = e.all(h), g = String(h.identifier).toUpperCase(), x = rm(g.toLowerCase());
    let b = 0;
    const C = [], N = e.footnoteCounts.get(g);
    for (; N !== void 0 && ++b <= N; ) {
      C.length > 0 && C.push({ type: "text", value: " " });
      let R = typeof n == "string" ? n : n(d, b);
      typeof R == "string" && (R = { type: "text", value: R }), C.push({
        type: "element",
        tagName: "a",
        properties: {
          href: "#" + t + "fnref-" + x + (b > 1 ? "-" + b : ""),
          dataFootnoteBackref: "",
          ariaLabel: typeof r == "string" ? r : r(d, b),
          className: ["data-footnote-backref"]
        },
        children: Array.isArray(R) ? R : [R]
      });
    }
    const T = p[p.length - 1];
    if (T && T.type === "element" && T.tagName === "p") {
      const R = T.children[T.children.length - 1];
      R && R.type === "text" ? R.value += " " : T.children.push({ type: "text", value: " " }), T.children.push(...C);
    } else
      p.push(...C);
    const j = {
      type: "element",
      tagName: "li",
      properties: { id: t + "fn-" + x },
      children: e.wrap(p, !0)
    };
    e.patch(h, j), c.push(j);
  }
  if (c.length !== 0)
    return {
      type: "element",
      tagName: "section",
      properties: { dataFootnotes: !0, className: ["footnotes"] },
      children: [
        {
          type: "element",
          tagName: o,
          properties: {
            ...d1(l),
            id: "footnote-label"
          },
          children: [{ type: "text", value: a }]
        },
        { type: "text", value: `
` },
        {
          type: "element",
          tagName: "ol",
          properties: {},
          children: e.wrap(c, !0)
        },
        { type: "text", value: `
` }
      ]
    };
}
const U1 = (
  // Note: overloads in JSDoc cant yet use different `@template`s.
  /**
   * @type {(
   *   (<Condition extends string>(test: Condition) => (node: unknown, index?: number | null | undefined, parent?: Parent | null | undefined, context?: unknown) => node is Node & {type: Condition}) &
   *   (<Condition extends Props>(test: Condition) => (node: unknown, index?: number | null | undefined, parent?: Parent | null | undefined, context?: unknown) => node is Node & Condition) &
   *   (<Condition extends TestFunction>(test: Condition) => (node: unknown, index?: number | null | undefined, parent?: Parent | null | undefined, context?: unknown) => node is Node & Predicate<Condition, Node>) &
   *   ((test?: null | undefined) => (node?: unknown, index?: number | null | undefined, parent?: Parent | null | undefined, context?: unknown) => node is Node) &
   *   ((test?: Test) => Check)
   * )}
   */
  /**
   * @param {Test} [test]
   * @returns {Check}
   */
  (function(e) {
    if (e == null)
      return pB;
    if (typeof e == "function")
      return $1(e);
    if (typeof e == "object")
      return Array.isArray(e) ? dB(e) : (
        // Cast because `ReadonlyArray` goes into the above but `isArray`
        // narrows to `Array`.
        hB(
          /** @type {Props} */
          e
        )
      );
    if (typeof e == "string")
      return mB(e);
    throw new Error("Expected function, string, or object as test");
  })
);
function dB(e) {
  const t = [];
  let n = -1;
  for (; ++n < e.length; )
    t[n] = U1(e[n]);
  return $1(r);
  function r(...a) {
    let o = -1;
    for (; ++o < t.length; )
      if (t[o].apply(this, a)) return !0;
    return !1;
  }
}
function hB(e) {
  const t = (
    /** @type {Record<string, unknown>} */
    e
  );
  return $1(n);
  function n(r) {
    const a = (
      /** @type {Record<string, unknown>} */
      /** @type {unknown} */
      r
    );
    let o;
    for (o in e)
      if (a[o] !== t[o]) return !1;
    return !0;
  }
}
function mB(e) {
  return $1(t);
  function t(n) {
    return n && n.type === e;
  }
}
function $1(e) {
  return t;
  function t(n, r, a) {
    return !!(gB(n) && e.call(
      this,
      n,
      typeof r == "number" ? r : void 0,
      a || void 0
    ));
  }
}
function pB() {
  return !0;
}
function gB(e) {
  return e !== null && typeof e == "object" && "type" in e;
}
const w9 = [], yB = !0, L3 = !1, vB = "skip";
function _9(e, t, n, r) {
  let a;
  typeof t == "function" && typeof n != "function" ? (r = n, n = t) : a = t;
  const o = U1(a), l = r ? -1 : 1;
  c(e, void 0, [])();
  function c(d, h, p) {
    const g = (
      /** @type {Record<string, unknown>} */
      d && typeof d == "object" ? d : {}
    );
    if (typeof g.type == "string") {
      const b = (
        // `hast`
        typeof g.tagName == "string" ? g.tagName : (
          // `xast`
          typeof g.name == "string" ? g.name : void 0
        )
      );
      Object.defineProperty(x, "name", {
        value: "node (" + (d.type + (b ? "<" + b + ">" : "")) + ")"
      });
    }
    return x;
    function x() {
      let b = w9, C, N, T;
      if ((!t || o(d, h, p[p.length - 1] || void 0)) && (b = xB(n(d, p)), b[0] === L3))
        return b;
      if ("children" in d && d.children) {
        const j = (
          /** @type {UnistParent} */
          d
        );
        if (j.children && b[0] !== vB)
          for (N = (r ? j.children.length : -1) + l, T = p.concat(j); N > -1 && N < j.children.length; ) {
            const R = j.children[N];
            if (C = c(R, N, T)(), C[0] === L3)
              return C;
            N = typeof C[1] == "number" ? C[1] : N + l;
          }
      }
      return b;
    }
  }
}
function xB(e) {
  return Array.isArray(e) ? e : typeof e == "number" ? [yB, e] : e == null ? w9 : [e];
}
function US(e, t, n, r) {
  let a, o, l;
  typeof t == "function" && typeof n != "function" ? (o = void 0, l = t, a = n) : (o = t, l = n, a = r), _9(e, o, c, a);
  function c(d, h) {
    const p = h[h.length - 1], g = p ? p.children.indexOf(d) : void 0;
    return l(d, g, p);
  }
}
const P3 = {}.hasOwnProperty, bB = {};
function wB(e, t) {
  const n = t || bB, r = /* @__PURE__ */ new Map(), a = /* @__PURE__ */ new Map(), o = /* @__PURE__ */ new Map(), l = { ...iB, ...n.handlers }, c = {
    all: h,
    applyData: SB,
    definitionById: r,
    footnoteById: a,
    footnoteCounts: o,
    footnoteOrder: [],
    handlers: l,
    one: d,
    options: n,
    patch: _B,
    wrap: EB
  };
  return US(e, function(p) {
    if (p.type === "definition" || p.type === "footnoteDefinition") {
      const g = p.type === "definition" ? r : a, x = String(p.identifier).toUpperCase();
      g.has(x) || g.set(x, p);
    }
  }), c;
  function d(p, g) {
    const x = p.type, b = c.handlers[x];
    if (P3.call(c.handlers, x) && b)
      return b(c, p, g);
    if (c.options.passThrough && c.options.passThrough.includes(x)) {
      if ("children" in p) {
        const { children: N, ...T } = p, j = d1(T);
        return j.children = c.all(p), j;
      }
      return d1(p);
    }
    return (c.options.unknownHandler || CB)(c, p, g);
  }
  function h(p) {
    const g = [];
    if ("children" in p) {
      const x = p.children;
      let b = -1;
      for (; ++b < x.length; ) {
        const C = c.one(x[b], p);
        if (C) {
          if (b && x[b - 1].type === "break" && (!Array.isArray(C) && C.type === "text" && (C.value = FC(C.value)), !Array.isArray(C) && C.type === "element")) {
            const N = C.children[0];
            N && N.type === "text" && (N.value = FC(N.value));
          }
          Array.isArray(C) ? g.push(...C) : g.push(C);
        }
      }
    }
    return g;
  }
}
function _B(e, t) {
  e.position && (t.position = cL(e));
}
function SB(e, t) {
  let n = t;
  if (e && e.data) {
    const r = e.data.hName, a = e.data.hChildren, o = e.data.hProperties;
    if (typeof r == "string")
      if (n.type === "element")
        n.tagName = r;
      else {
        const l = "children" in n ? n.children : [n];
        n = { type: "element", tagName: r, properties: {}, children: l };
      }
    n.type === "element" && o && Object.assign(n.properties, d1(o)), "children" in n && n.children && a !== null && a !== void 0 && (n.children = a);
  }
  return n;
}
function CB(e, t) {
  const n = t.data || {}, r = "value" in t && !(P3.call(n, "hProperties") || P3.call(n, "hChildren")) ? { type: "text", value: t.value } : {
    type: "element",
    tagName: "div",
    properties: {},
    children: e.all(t)
  };
  return e.patch(t, r), e.applyData(t, r);
}
function EB(e, t) {
  const n = [];
  let r = -1;
  for (t && n.push({ type: "text", value: `
` }); ++r < e.length; )
    r && n.push({ type: "text", value: `
` }), n.push(e[r]);
  return t && e.length > 0 && n.push({ type: "text", value: `
` }), n;
}
function FC(e) {
  let t = 0, n = e.charCodeAt(t);
  for (; n === 9 || n === 32; )
    t++, n = e.charCodeAt(t);
  return e.slice(t);
}
function UC(e, t) {
  const n = wB(e, t), r = n.one(e, void 0), a = fB(n), o = Array.isArray(r) ? { type: "root", children: r } : r || { type: "root", children: [] };
  return a && o.children.push({ type: "text", value: `
` }, a), o;
}
function kB(e, t) {
  return e && "run" in e ? async function(n, r) {
    const a = (
      /** @type {HastRoot} */
      UC(n, { file: r, ...t })
    );
    await e.run(a, r);
  } : function(n, r) {
    return (
      /** @type {HastRoot} */
      UC(n, { file: r, ...e || t })
    );
  };
}
function $C(e) {
  if (e)
    throw e;
}
var Tx, HC;
function NB() {
  if (HC) return Tx;
  HC = 1;
  var e = Object.prototype.hasOwnProperty, t = Object.prototype.toString, n = Object.defineProperty, r = Object.getOwnPropertyDescriptor, a = function(h) {
    return typeof Array.isArray == "function" ? Array.isArray(h) : t.call(h) === "[object Array]";
  }, o = function(h) {
    if (!h || t.call(h) !== "[object Object]")
      return !1;
    var p = e.call(h, "constructor"), g = h.constructor && h.constructor.prototype && e.call(h.constructor.prototype, "isPrototypeOf");
    if (h.constructor && !p && !g)
      return !1;
    var x;
    for (x in h)
      ;
    return typeof x > "u" || e.call(h, x);
  }, l = function(h, p) {
    n && p.name === "__proto__" ? n(h, p.name, {
      enumerable: !0,
      configurable: !0,
      value: p.newValue,
      writable: !0
    }) : h[p.name] = p.newValue;
  }, c = function(h, p) {
    if (p === "__proto__")
      if (e.call(h, p)) {
        if (r)
          return r(h, p).value;
      } else return;
    return h[p];
  };
  return Tx = function d() {
    var h, p, g, x, b, C, N = arguments[0], T = 1, j = arguments.length, R = !1;
    for (typeof N == "boolean" && (R = N, N = arguments[1] || {}, T = 2), (N == null || typeof N != "object" && typeof N != "function") && (N = {}); T < j; ++T)
      if (h = arguments[T], h != null)
        for (p in h)
          g = c(N, p), x = c(h, p), N !== x && (R && x && (o(x) || (b = a(x))) ? (b ? (b = !1, C = g && a(g) ? g : []) : C = g && o(g) ? g : {}, l(N, { name: p, newValue: d(R, C, x) })) : typeof x < "u" && l(N, { name: p, newValue: x }));
    return N;
  }, Tx;
}
var jB = NB();
const Ax = /* @__PURE__ */ bc(jB);
function q3(e) {
  if (typeof e != "object" || e === null)
    return !1;
  const t = Object.getPrototypeOf(e);
  return (t === null || t === Object.prototype || Object.getPrototypeOf(t) === null) && !(Symbol.toStringTag in e) && !(Symbol.iterator in e);
}
function TB() {
  const e = [], t = { run: n, use: r };
  return t;
  function n(...a) {
    let o = -1;
    const l = a.pop();
    if (typeof l != "function")
      throw new TypeError("Expected function as last argument, not " + l);
    c(null, ...a);
    function c(d, ...h) {
      const p = e[++o];
      let g = -1;
      if (d) {
        l(d);
        return;
      }
      for (; ++g < a.length; )
        (h[g] === null || h[g] === void 0) && (h[g] = a[g]);
      a = h, p ? AB(p, c)(...h) : l(null, ...h);
    }
  }
  function r(a) {
    if (typeof a != "function")
      throw new TypeError(
        "Expected `middelware` to be a function, not " + a
      );
    return e.push(a), t;
  }
}
function AB(e, t) {
  let n;
  return r;
  function r(...l) {
    const c = e.length > l.length;
    let d;
    c && l.push(a);
    try {
      d = e.apply(this, l);
    } catch (h) {
      const p = (
        /** @type {Error} */
        h
      );
      if (c && n)
        throw p;
      return a(p);
    }
    c || (d && d.then && typeof d.then == "function" ? d.then(o, a) : d instanceof Error ? a(d) : o(d));
  }
  function a(l, ...c) {
    n || (n = !0, t(l, ...c));
  }
  function o(l) {
    a(null, l);
  }
}
const ol = { basename: MB, dirname: RB, extname: OB, join: zB, sep: "/" };
function MB(e, t) {
  if (t !== void 0 && typeof t != "string")
    throw new TypeError('"ext" argument must be a string');
  Og(e);
  let n = 0, r = -1, a = e.length, o;
  if (t === void 0 || t.length === 0 || t.length > e.length) {
    for (; a--; )
      if (e.codePointAt(a) === 47) {
        if (o) {
          n = a + 1;
          break;
        }
      } else r < 0 && (o = !0, r = a + 1);
    return r < 0 ? "" : e.slice(n, r);
  }
  if (t === e)
    return "";
  let l = -1, c = t.length - 1;
  for (; a--; )
    if (e.codePointAt(a) === 47) {
      if (o) {
        n = a + 1;
        break;
      }
    } else
      l < 0 && (o = !0, l = a + 1), c > -1 && (e.codePointAt(a) === t.codePointAt(c--) ? c < 0 && (r = a) : (c = -1, r = l));
  return n === r ? r = l : r < 0 && (r = e.length), e.slice(n, r);
}
function RB(e) {
  if (Og(e), e.length === 0)
    return ".";
  let t = -1, n = e.length, r;
  for (; --n; )
    if (e.codePointAt(n) === 47) {
      if (r) {
        t = n;
        break;
      }
    } else r || (r = !0);
  return t < 0 ? e.codePointAt(0) === 47 ? "/" : "." : t === 1 && e.codePointAt(0) === 47 ? "//" : e.slice(0, t);
}
function OB(e) {
  Og(e);
  let t = e.length, n = -1, r = 0, a = -1, o = 0, l;
  for (; t--; ) {
    const c = e.codePointAt(t);
    if (c === 47) {
      if (l) {
        r = t + 1;
        break;
      }
      continue;
    }
    n < 0 && (l = !0, n = t + 1), c === 46 ? a < 0 ? a = t : o !== 1 && (o = 1) : a > -1 && (o = -1);
  }
  return a < 0 || n < 0 || // We saw a non-dot character immediately before the dot.
  o === 0 || // The (right-most) trimmed path component is exactly `..`.
  o === 1 && a === n - 1 && a === r + 1 ? "" : e.slice(a, n);
}
function zB(...e) {
  let t = -1, n;
  for (; ++t < e.length; )
    Og(e[t]), e[t] && (n = n === void 0 ? e[t] : n + "/" + e[t]);
  return n === void 0 ? "." : DB(n);
}
function DB(e) {
  Og(e);
  const t = e.codePointAt(0) === 47;
  let n = IB(e, !t);
  return n.length === 0 && !t && (n = "."), n.length > 0 && e.codePointAt(e.length - 1) === 47 && (n += "/"), t ? "/" + n : n;
}
function IB(e, t) {
  let n = "", r = 0, a = -1, o = 0, l = -1, c, d;
  for (; ++l <= e.length; ) {
    if (l < e.length)
      c = e.codePointAt(l);
    else {
      if (c === 47)
        break;
      c = 47;
    }
    if (c === 47) {
      if (!(a === l - 1 || o === 1)) if (a !== l - 1 && o === 2) {
        if (n.length < 2 || r !== 2 || n.codePointAt(n.length - 1) !== 46 || n.codePointAt(n.length - 2) !== 46) {
          if (n.length > 2) {
            if (d = n.lastIndexOf("/"), d !== n.length - 1) {
              d < 0 ? (n = "", r = 0) : (n = n.slice(0, d), r = n.length - 1 - n.lastIndexOf("/")), a = l, o = 0;
              continue;
            }
          } else if (n.length > 0) {
            n = "", r = 0, a = l, o = 0;
            continue;
          }
        }
        t && (n = n.length > 0 ? n + "/.." : "..", r = 2);
      } else
        n.length > 0 ? n += "/" + e.slice(a + 1, l) : n = e.slice(a + 1, l), r = l - a - 1;
      a = l, o = 0;
    } else c === 46 && o > -1 ? o++ : o = -1;
  }
  return n;
}
function Og(e) {
  if (typeof e != "string")
    throw new TypeError(
      "Path must be a string. Received " + JSON.stringify(e)
    );
}
const LB = { cwd: PB };
function PB() {
  return "/";
}
function B3(e) {
  return !!(e !== null && typeof e == "object" && "href" in e && e.href && "protocol" in e && e.protocol && // @ts-expect-error: indexing is fine.
  e.auth === void 0);
}
function qB(e) {
  if (typeof e == "string")
    e = new URL(e);
  else if (!B3(e)) {
    const t = new TypeError(
      'The "path" argument must be of type string or an instance of URL. Received `' + e + "`"
    );
    throw t.code = "ERR_INVALID_ARG_TYPE", t;
  }
  if (e.protocol !== "file:") {
    const t = new TypeError("The URL must be of scheme file");
    throw t.code = "ERR_INVALID_URL_SCHEME", t;
  }
  return BB(e);
}
function BB(e) {
  if (e.hostname !== "") {
    const r = new TypeError(
      'File URL host must be "localhost" or empty on darwin'
    );
    throw r.code = "ERR_INVALID_FILE_URL_HOST", r;
  }
  const t = e.pathname;
  let n = -1;
  for (; ++n < t.length; )
    if (t.codePointAt(n) === 37 && t.codePointAt(n + 1) === 50) {
      const r = t.codePointAt(n + 2);
      if (r === 70 || r === 102) {
        const a = new TypeError(
          "File URL path must not include encoded / characters"
        );
        throw a.code = "ERR_INVALID_FILE_URL_PATH", a;
      }
    }
  return decodeURIComponent(t);
}
const Mx = (
  /** @type {const} */
  [
    "history",
    "path",
    "basename",
    "stem",
    "extname",
    "dirname"
  ]
);
class S9 {
  /**
   * Create a new virtual file.
   *
   * `options` is treated as:
   *
   * *   `string` or `Uint8Array`  `{value: options}`
   * *   `URL`  `{path: options}`
   * *   `VFile`  shallow copies its data over to the new file
   * *   `object`  all fields are shallow copied over to the new file
   *
   * Path related fields are set in the following order (least specific to
   * most specific): `history`, `path`, `basename`, `stem`, `extname`,
   * `dirname`.
   *
   * You cannot set `dirname` or `extname` without setting either `history`,
   * `path`, `basename`, or `stem` too.
   *
   * @param {Compatible | null | undefined} [value]
   *   File value.
   * @returns
   *   New instance.
   */
  constructor(t) {
    let n;
    t ? B3(t) ? n = { path: t } : typeof t == "string" || FB(t) ? n = { value: t } : n = t : n = {}, this.cwd = "cwd" in n ? "" : LB.cwd(), this.data = {}, this.history = [], this.messages = [], this.value, this.map, this.result, this.stored;
    let r = -1;
    for (; ++r < Mx.length; ) {
      const o = Mx[r];
      o in n && n[o] !== void 0 && n[o] !== null && (this[o] = o === "history" ? [...n[o]] : n[o]);
    }
    let a;
    for (a in n)
      Mx.includes(a) || (this[a] = n[a]);
  }
  /**
   * Get the basename (including extname) (example: `'index.min.js'`).
   *
   * @returns {string | undefined}
   *   Basename.
   */
  get basename() {
    return typeof this.path == "string" ? ol.basename(this.path) : void 0;
  }
  /**
   * Set basename (including extname) (`'index.min.js'`).
   *
   * Cannot contain path separators (`'/'` on unix, macOS, and browsers, `'\'`
   * on windows).
   * Cannot be nullified (use `file.path = file.dirname` instead).
   *
   * @param {string} basename
   *   Basename.
   * @returns {undefined}
   *   Nothing.
   */
  set basename(t) {
    Ox(t, "basename"), Rx(t, "basename"), this.path = ol.join(this.dirname || "", t);
  }
  /**
   * Get the parent path (example: `'~'`).
   *
   * @returns {string | undefined}
   *   Dirname.
   */
  get dirname() {
    return typeof this.path == "string" ? ol.dirname(this.path) : void 0;
  }
  /**
   * Set the parent path (example: `'~'`).
   *
   * Cannot be set if theres no `path` yet.
   *
   * @param {string | undefined} dirname
   *   Dirname.
   * @returns {undefined}
   *   Nothing.
   */
  set dirname(t) {
    GC(this.basename, "dirname"), this.path = ol.join(t || "", this.basename);
  }
  /**
   * Get the extname (including dot) (example: `'.js'`).
   *
   * @returns {string | undefined}
   *   Extname.
   */
  get extname() {
    return typeof this.path == "string" ? ol.extname(this.path) : void 0;
  }
  /**
   * Set the extname (including dot) (example: `'.js'`).
   *
   * Cannot contain path separators (`'/'` on unix, macOS, and browsers, `'\'`
   * on windows).
   * Cannot be set if theres no `path` yet.
   *
   * @param {string | undefined} extname
   *   Extname.
   * @returns {undefined}
   *   Nothing.
   */
  set extname(t) {
    if (Rx(t, "extname"), GC(this.dirname, "extname"), t) {
      if (t.codePointAt(0) !== 46)
        throw new Error("`extname` must start with `.`");
      if (t.includes(".", 1))
        throw new Error("`extname` cannot contain multiple dots");
    }
    this.path = ol.join(this.dirname, this.stem + (t || ""));
  }
  /**
   * Get the full path (example: `'~/index.min.js'`).
   *
   * @returns {string}
   *   Path.
   */
  get path() {
    return this.history[this.history.length - 1];
  }
  /**
   * Set the full path (example: `'~/index.min.js'`).
   *
   * Cannot be nullified.
   * You can set a file URL (a `URL` object with a `file:` protocol) which will
   * be turned into a path with `url.fileURLToPath`.
   *
   * @param {URL | string} path
   *   Path.
   * @returns {undefined}
   *   Nothing.
   */
  set path(t) {
    B3(t) && (t = qB(t)), Ox(t, "path"), this.path !== t && this.history.push(t);
  }
  /**
   * Get the stem (basename w/o extname) (example: `'index.min'`).
   *
   * @returns {string | undefined}
   *   Stem.
   */
  get stem() {
    return typeof this.path == "string" ? ol.basename(this.path, this.extname) : void 0;
  }
  /**
   * Set the stem (basename w/o extname) (example: `'index.min'`).
   *
   * Cannot contain path separators (`'/'` on unix, macOS, and browsers, `'\'`
   * on windows).
   * Cannot be nullified (use `file.path = file.dirname` instead).
   *
   * @param {string} stem
   *   Stem.
   * @returns {undefined}
   *   Nothing.
   */
  set stem(t) {
    Ox(t, "stem"), Rx(t, "stem"), this.path = ol.join(this.dirname || "", t + (this.extname || ""));
  }
  // Normal prototypal methods.
  /**
   * Create a fatal message for `reason` associated with the file.
   *
   * The `fatal` field of the message is set to `true` (error; file not usable)
   * and the `file` field is set to the current file path.
   * The message is added to the `messages` field on `file`.
   *
   * >  **Note**: also has obsolete signatures.
   *
   * @overload
   * @param {string} reason
   * @param {MessageOptions | null | undefined} [options]
   * @returns {never}
   *
   * @overload
   * @param {string} reason
   * @param {Node | NodeLike | null | undefined} parent
   * @param {string | null | undefined} [origin]
   * @returns {never}
   *
   * @overload
   * @param {string} reason
   * @param {Point | Position | null | undefined} place
   * @param {string | null | undefined} [origin]
   * @returns {never}
   *
   * @overload
   * @param {string} reason
   * @param {string | null | undefined} [origin]
   * @returns {never}
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {Node | NodeLike | null | undefined} parent
   * @param {string | null | undefined} [origin]
   * @returns {never}
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {Point | Position | null | undefined} place
   * @param {string | null | undefined} [origin]
   * @returns {never}
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {string | null | undefined} [origin]
   * @returns {never}
   *
   * @param {Error | VFileMessage | string} causeOrReason
   *   Reason for message, should use markdown.
   * @param {Node | NodeLike | MessageOptions | Point | Position | string | null | undefined} [optionsOrParentOrPlace]
   *   Configuration (optional).
   * @param {string | null | undefined} [origin]
   *   Place in code where the message originates (example:
   *   `'my-package:my-rule'` or `'my-rule'`).
   * @returns {never}
   *   Never.
   * @throws {VFileMessage}
   *   Message.
   */
  fail(t, n, r) {
    const a = this.message(t, n, r);
    throw a.fatal = !0, a;
  }
  /**
   * Create an info message for `reason` associated with the file.
   *
   * The `fatal` field of the message is set to `undefined` (info; change
   * likely not needed) and the `file` field is set to the current file path.
   * The message is added to the `messages` field on `file`.
   *
   * >  **Note**: also has obsolete signatures.
   *
   * @overload
   * @param {string} reason
   * @param {MessageOptions | null | undefined} [options]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {string} reason
   * @param {Node | NodeLike | null | undefined} parent
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {string} reason
   * @param {Point | Position | null | undefined} place
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {string} reason
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {Node | NodeLike | null | undefined} parent
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {Point | Position | null | undefined} place
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @param {Error | VFileMessage | string} causeOrReason
   *   Reason for message, should use markdown.
   * @param {Node | NodeLike | MessageOptions | Point | Position | string | null | undefined} [optionsOrParentOrPlace]
   *   Configuration (optional).
   * @param {string | null | undefined} [origin]
   *   Place in code where the message originates (example:
   *   `'my-package:my-rule'` or `'my-rule'`).
   * @returns {VFileMessage}
   *   Message.
   */
  info(t, n, r) {
    const a = this.message(t, n, r);
    return a.fatal = void 0, a;
  }
  /**
   * Create a message for `reason` associated with the file.
   *
   * The `fatal` field of the message is set to `false` (warning; change may be
   * needed) and the `file` field is set to the current file path.
   * The message is added to the `messages` field on `file`.
   *
   * >  **Note**: also has obsolete signatures.
   *
   * @overload
   * @param {string} reason
   * @param {MessageOptions | null | undefined} [options]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {string} reason
   * @param {Node | NodeLike | null | undefined} parent
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {string} reason
   * @param {Point | Position | null | undefined} place
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {string} reason
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {Node | NodeLike | null | undefined} parent
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {Point | Position | null | undefined} place
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @param {Error | VFileMessage | string} causeOrReason
   *   Reason for message, should use markdown.
   * @param {Node | NodeLike | MessageOptions | Point | Position | string | null | undefined} [optionsOrParentOrPlace]
   *   Configuration (optional).
   * @param {string | null | undefined} [origin]
   *   Place in code where the message originates (example:
   *   `'my-package:my-rule'` or `'my-rule'`).
   * @returns {VFileMessage}
   *   Message.
   */
  message(t, n, r) {
    const a = new zi(
      // @ts-expect-error: the overloads are fine.
      t,
      n,
      r
    );
    return this.path && (a.name = this.path + ":" + a.name, a.file = this.path), a.fatal = !1, this.messages.push(a), a;
  }
  /**
   * Serialize the file.
   *
   * > **Note**: which encodings are supported depends on the engine.
   * > For info on Node.js, see:
   * > <https://nodejs.org/api/util.html#whatwg-supported-encodings>.
   *
   * @param {string | null | undefined} [encoding='utf8']
   *   Character encoding to understand `value` as when its a `Uint8Array`
   *   (default: `'utf-8'`).
   * @returns {string}
   *   Serialized file.
   */
  toString(t) {
    return this.value === void 0 ? "" : typeof this.value == "string" ? this.value : new TextDecoder(t || void 0).decode(this.value);
  }
}
function Rx(e, t) {
  if (e && e.includes(ol.sep))
    throw new Error(
      "`" + t + "` cannot be a path: did not expect `" + ol.sep + "`"
    );
}
function Ox(e, t) {
  if (!e)
    throw new Error("`" + t + "` cannot be empty");
}
function GC(e, t) {
  if (!e)
    throw new Error("Setting `" + t + "` requires `path` to be set too");
}
function FB(e) {
  return !!(e && typeof e == "object" && "byteLength" in e && "byteOffset" in e);
}
const UB = (
  /**
   * @type {new <Parameters extends Array<unknown>, Result>(property: string | symbol) => (...parameters: Parameters) => Result}
   */
  /** @type {unknown} */
  /**
   * @this {Function}
   * @param {string | symbol} property
   * @returns {(...parameters: Array<unknown>) => unknown}
   */
  (function(e) {
    const r = (
      /** @type {Record<string | symbol, Function>} */
      // Prototypes do exist.
      // type-coverage:ignore-next-line
      this.constructor.prototype
    ), a = r[e], o = function() {
      return a.apply(o, arguments);
    };
    return Object.setPrototypeOf(o, r), o;
  })
), $B = {}.hasOwnProperty;
class $S extends UB {
  /**
   * Create a processor.
   */
  constructor() {
    super("copy"), this.Compiler = void 0, this.Parser = void 0, this.attachers = [], this.compiler = void 0, this.freezeIndex = -1, this.frozen = void 0, this.namespace = {}, this.parser = void 0, this.transformers = TB();
  }
  /**
   * Copy a processor.
   *
   * @deprecated
   *   This is a private internal method and should not be used.
   * @returns {Processor<ParseTree, HeadTree, TailTree, CompileTree, CompileResult>}
   *   New *unfrozen* processor ({@linkcode Processor}) that is
   *   configured to work the same as its ancestor.
   *   When the descendant processor is configured in the future it does not
   *   affect the ancestral processor.
   */
  copy() {
    const t = (
      /** @type {Processor<ParseTree, HeadTree, TailTree, CompileTree, CompileResult>} */
      new $S()
    );
    let n = -1;
    for (; ++n < this.attachers.length; ) {
      const r = this.attachers[n];
      t.use(...r);
    }
    return t.data(Ax(!0, {}, this.namespace)), t;
  }
  /**
   * Configure the processor with info available to all plugins.
   * Information is stored in an object.
   *
   * Typically, options can be given to a specific plugin, but sometimes it
   * makes sense to have information shared with several plugins.
   * For example, a list of HTML elements that are self-closing, which is
   * needed during all phases.
   *
   * > **Note**: setting information cannot occur on *frozen* processors.
   * > Call the processor first to create a new unfrozen processor.
   *
   * > **Note**: to register custom data in TypeScript, augment the
   * > {@linkcode Data} interface.
   *
   * @example
   *   This example show how to get and set info:
   *
   *   ```js
   *   import {unified} from 'unified'
   *
   *   const processor = unified().data('alpha', 'bravo')
   *
   *   processor.data('alpha') // => 'bravo'
   *
   *   processor.data() // => {alpha: 'bravo'}
   *
   *   processor.data({charlie: 'delta'})
   *
   *   processor.data() // => {charlie: 'delta'}
   *   ```
   *
   * @template {keyof Data} Key
   *
   * @overload
   * @returns {Data}
   *
   * @overload
   * @param {Data} dataset
   * @returns {Processor<ParseTree, HeadTree, TailTree, CompileTree, CompileResult>}
   *
   * @overload
   * @param {Key} key
   * @returns {Data[Key]}
   *
   * @overload
   * @param {Key} key
   * @param {Data[Key]} value
   * @returns {Processor<ParseTree, HeadTree, TailTree, CompileTree, CompileResult>}
   *
   * @param {Data | Key} [key]
   *   Key to get or set, or entire dataset to set, or nothing to get the
   *   entire dataset (optional).
   * @param {Data[Key]} [value]
   *   Value to set (optional).
   * @returns {unknown}
   *   The current processor when setting, the value at `key` when getting, or
   *   the entire dataset when getting without key.
   */
  data(t, n) {
    return typeof t == "string" ? arguments.length === 2 ? (Ix("data", this.frozen), this.namespace[t] = n, this) : $B.call(this.namespace, t) && this.namespace[t] || void 0 : t ? (Ix("data", this.frozen), this.namespace = t, this) : this.namespace;
  }
  /**
   * Freeze a processor.
   *
   * Frozen processors are meant to be extended and not to be configured
   * directly.
   *
   * When a processor is frozen it cannot be unfrozen.
   * New processors working the same way can be created by calling the
   * processor.
   *
   * Its possible to freeze processors explicitly by calling `.freeze()`.
   * Processors freeze automatically when `.parse()`, `.run()`, `.runSync()`,
   * `.stringify()`, `.process()`, or `.processSync()` are called.
   *
   * @returns {Processor<ParseTree, HeadTree, TailTree, CompileTree, CompileResult>}
   *   The current processor.
   */
  freeze() {
    if (this.frozen)
      return this;
    const t = (
      /** @type {Processor} */
      /** @type {unknown} */
      this
    );
    for (; ++this.freezeIndex < this.attachers.length; ) {
      const [n, ...r] = this.attachers[this.freezeIndex];
      if (r[0] === !1)
        continue;
      r[0] === !0 && (r[0] = void 0);
      const a = n.call(t, ...r);
      typeof a == "function" && this.transformers.use(a);
    }
    return this.frozen = !0, this.freezeIndex = Number.POSITIVE_INFINITY, this;
  }
  /**
   * Parse text to a syntax tree.
   *
   * > **Note**: `parse` freezes the processor if not already *frozen*.
   *
   * > **Note**: `parse` performs the parse phase, not the run phase or other
   * > phases.
   *
   * @param {Compatible | undefined} [file]
   *   file to parse (optional); typically `string` or `VFile`; any value
   *   accepted as `x` in `new VFile(x)`.
   * @returns {ParseTree extends undefined ? Node : ParseTree}
   *   Syntax tree representing `file`.
   */
  parse(t) {
    this.freeze();
    const n = zy(t), r = this.parser || this.Parser;
    return zx("parse", r), r(String(n), n);
  }
  /**
   * Process the given file as configured on the processor.
   *
   * > **Note**: `process` freezes the processor if not already *frozen*.
   *
   * > **Note**: `process` performs the parse, run, and stringify phases.
   *
   * @overload
   * @param {Compatible | undefined} file
   * @param {ProcessCallback<VFileWithOutput<CompileResult>>} done
   * @returns {undefined}
   *
   * @overload
   * @param {Compatible | undefined} [file]
   * @returns {Promise<VFileWithOutput<CompileResult>>}
   *
   * @param {Compatible | undefined} [file]
   *   File (optional); typically `string` or `VFile`]; any value accepted as
   *   `x` in `new VFile(x)`.
   * @param {ProcessCallback<VFileWithOutput<CompileResult>> | undefined} [done]
   *   Callback (optional).
   * @returns {Promise<VFile> | undefined}
   *   Nothing if `done` is given.
   *   Otherwise a promise, rejected with a fatal error or resolved with the
   *   processed file.
   *
   *   The parsed, transformed, and compiled value is available at
   *   `file.value` (see note).
   *
   *   > **Note**: unified typically compiles by serializing: most
   *   > compilers return `string` (or `Uint8Array`).
   *   > Some compilers, such as the one configured with
   *   > [`rehype-react`][rehype-react], return other values (in this case, a
   *   > React tree).
   *   > If youre using a compiler that doesnt serialize, expect different
   *   > result values.
   *   >
   *   > To register custom results in TypeScript, add them to
   *   > {@linkcode CompileResultMap}.
   *
   *   [rehype-react]: https://github.com/rehypejs/rehype-react
   */
  process(t, n) {
    const r = this;
    return this.freeze(), zx("process", this.parser || this.Parser), Dx("process", this.compiler || this.Compiler), n ? a(void 0, n) : new Promise(a);
    function a(o, l) {
      const c = zy(t), d = (
        /** @type {HeadTree extends undefined ? Node : HeadTree} */
        /** @type {unknown} */
        r.parse(c)
      );
      r.run(d, c, function(p, g, x) {
        if (p || !g || !x)
          return h(p);
        const b = (
          /** @type {CompileTree extends undefined ? Node : CompileTree} */
          /** @type {unknown} */
          g
        ), C = r.stringify(b, x);
        VB(C) ? x.value = C : x.result = C, h(
          p,
          /** @type {VFileWithOutput<CompileResult>} */
          x
        );
      });
      function h(p, g) {
        p || !g ? l(p) : o ? o(g) : n(void 0, g);
      }
    }
  }
  /**
   * Process the given file as configured on the processor.
   *
   * An error is thrown if asynchronous transforms are configured.
   *
   * > **Note**: `processSync` freezes the processor if not already *frozen*.
   *
   * > **Note**: `processSync` performs the parse, run, and stringify phases.
   *
   * @param {Compatible | undefined} [file]
   *   File (optional); typically `string` or `VFile`; any value accepted as
   *   `x` in `new VFile(x)`.
   * @returns {VFileWithOutput<CompileResult>}
   *   The processed file.
   *
   *   The parsed, transformed, and compiled value is available at
   *   `file.value` (see note).
   *
   *   > **Note**: unified typically compiles by serializing: most
   *   > compilers return `string` (or `Uint8Array`).
   *   > Some compilers, such as the one configured with
   *   > [`rehype-react`][rehype-react], return other values (in this case, a
   *   > React tree).
   *   > If youre using a compiler that doesnt serialize, expect different
   *   > result values.
   *   >
   *   > To register custom results in TypeScript, add them to
   *   > {@linkcode CompileResultMap}.
   *
   *   [rehype-react]: https://github.com/rehypejs/rehype-react
   */
  processSync(t) {
    let n = !1, r;
    return this.freeze(), zx("processSync", this.parser || this.Parser), Dx("processSync", this.compiler || this.Compiler), this.process(t, a), KC("processSync", "process", n), r;
    function a(o, l) {
      n = !0, $C(o), r = l;
    }
  }
  /**
   * Run *transformers* on a syntax tree.
   *
   * > **Note**: `run` freezes the processor if not already *frozen*.
   *
   * > **Note**: `run` performs the run phase, not other phases.
   *
   * @overload
   * @param {HeadTree extends undefined ? Node : HeadTree} tree
   * @param {RunCallback<TailTree extends undefined ? Node : TailTree>} done
   * @returns {undefined}
   *
   * @overload
   * @param {HeadTree extends undefined ? Node : HeadTree} tree
   * @param {Compatible | undefined} file
   * @param {RunCallback<TailTree extends undefined ? Node : TailTree>} done
   * @returns {undefined}
   *
   * @overload
   * @param {HeadTree extends undefined ? Node : HeadTree} tree
   * @param {Compatible | undefined} [file]
   * @returns {Promise<TailTree extends undefined ? Node : TailTree>}
   *
   * @param {HeadTree extends undefined ? Node : HeadTree} tree
   *   Tree to transform and inspect.
   * @param {(
   *   RunCallback<TailTree extends undefined ? Node : TailTree> |
   *   Compatible
   * )} [file]
   *   File associated with `node` (optional); any value accepted as `x` in
   *   `new VFile(x)`.
   * @param {RunCallback<TailTree extends undefined ? Node : TailTree>} [done]
   *   Callback (optional).
   * @returns {Promise<TailTree extends undefined ? Node : TailTree> | undefined}
   *   Nothing if `done` is given.
   *   Otherwise, a promise rejected with a fatal error or resolved with the
   *   transformed tree.
   */
  run(t, n, r) {
    VC(t), this.freeze();
    const a = this.transformers;
    return !r && typeof n == "function" && (r = n, n = void 0), r ? o(void 0, r) : new Promise(o);
    function o(l, c) {
      const d = zy(n);
      a.run(t, d, h);
      function h(p, g, x) {
        const b = (
          /** @type {TailTree extends undefined ? Node : TailTree} */
          g || t
        );
        p ? c(p) : l ? l(b) : r(void 0, b, x);
      }
    }
  }
  /**
   * Run *transformers* on a syntax tree.
   *
   * An error is thrown if asynchronous transforms are configured.
   *
   * > **Note**: `runSync` freezes the processor if not already *frozen*.
   *
   * > **Note**: `runSync` performs the run phase, not other phases.
   *
   * @param {HeadTree extends undefined ? Node : HeadTree} tree
   *   Tree to transform and inspect.
   * @param {Compatible | undefined} [file]
   *   File associated with `node` (optional); any value accepted as `x` in
   *   `new VFile(x)`.
   * @returns {TailTree extends undefined ? Node : TailTree}
   *   Transformed tree.
   */
  runSync(t, n) {
    let r = !1, a;
    return this.run(t, n, o), KC("runSync", "run", r), a;
    function o(l, c) {
      $C(l), a = c, r = !0;
    }
  }
  /**
   * Compile a syntax tree.
   *
   * > **Note**: `stringify` freezes the processor if not already *frozen*.
   *
   * > **Note**: `stringify` performs the stringify phase, not the run phase
   * > or other phases.
   *
   * @param {CompileTree extends undefined ? Node : CompileTree} tree
   *   Tree to compile.
   * @param {Compatible | undefined} [file]
   *   File associated with `node` (optional); any value accepted as `x` in
   *   `new VFile(x)`.
   * @returns {CompileResult extends undefined ? Value : CompileResult}
   *   Textual representation of the tree (see note).
   *
   *   > **Note**: unified typically compiles by serializing: most compilers
   *   > return `string` (or `Uint8Array`).
   *   > Some compilers, such as the one configured with
   *   > [`rehype-react`][rehype-react], return other values (in this case, a
   *   > React tree).
   *   > If youre using a compiler that doesnt serialize, expect different
   *   > result values.
   *   >
   *   > To register custom results in TypeScript, add them to
   *   > {@linkcode CompileResultMap}.
   *
   *   [rehype-react]: https://github.com/rehypejs/rehype-react
   */
  stringify(t, n) {
    this.freeze();
    const r = zy(n), a = this.compiler || this.Compiler;
    return Dx("stringify", a), VC(t), a(t, r);
  }
  /**
   * Configure the processor to use a plugin, a list of usable values, or a
   * preset.
   *
   * If the processor is already using a plugin, the previous plugin
   * configuration is changed based on the options that are passed in.
   * In other words, the plugin is not added a second time.
   *
   * > **Note**: `use` cannot be called on *frozen* processors.
   * > Call the processor first to create a new unfrozen processor.
   *
   * @example
   *   There are many ways to pass plugins to `.use()`.
   *   This example gives an overview:
   *
   *   ```js
   *   import {unified} from 'unified'
   *
   *   unified()
   *     // Plugin with options:
   *     .use(pluginA, {x: true, y: true})
   *     // Passing the same plugin again merges configuration (to `{x: true, y: false, z: true}`):
   *     .use(pluginA, {y: false, z: true})
   *     // Plugins:
   *     .use([pluginB, pluginC])
   *     // Two plugins, the second with options:
   *     .use([pluginD, [pluginE, {}]])
   *     // Preset with plugins and settings:
   *     .use({plugins: [pluginF, [pluginG, {}]], settings: {position: false}})
   *     // Settings only:
   *     .use({settings: {position: false}})
   *   ```
   *
   * @template {Array<unknown>} [Parameters=[]]
   * @template {Node | string | undefined} [Input=undefined]
   * @template [Output=Input]
   *
   * @overload
   * @param {Preset | null | undefined} [preset]
   * @returns {Processor<ParseTree, HeadTree, TailTree, CompileTree, CompileResult>}
   *
   * @overload
   * @param {PluggableList} list
   * @returns {Processor<ParseTree, HeadTree, TailTree, CompileTree, CompileResult>}
   *
   * @overload
   * @param {Plugin<Parameters, Input, Output>} plugin
   * @param {...(Parameters | [boolean])} parameters
   * @returns {UsePlugin<ParseTree, HeadTree, TailTree, CompileTree, CompileResult, Input, Output>}
   *
   * @param {PluggableList | Plugin | Preset | null | undefined} value
   *   Usable value.
   * @param {...unknown} parameters
   *   Parameters, when a plugin is given as a usable value.
   * @returns {Processor<ParseTree, HeadTree, TailTree, CompileTree, CompileResult>}
   *   Current processor.
   */
  use(t, ...n) {
    const r = this.attachers, a = this.namespace;
    if (Ix("use", this.frozen), t != null) if (typeof t == "function")
      d(t, n);
    else if (typeof t == "object")
      Array.isArray(t) ? c(t) : l(t);
    else
      throw new TypeError("Expected usable value, not `" + t + "`");
    return this;
    function o(h) {
      if (typeof h == "function")
        d(h, []);
      else if (typeof h == "object")
        if (Array.isArray(h)) {
          const [p, ...g] = (
            /** @type {PluginTuple<Array<unknown>>} */
            h
          );
          d(p, g);
        } else
          l(h);
      else
        throw new TypeError("Expected usable value, not `" + h + "`");
    }
    function l(h) {
      if (!("plugins" in h) && !("settings" in h))
        throw new Error(
          "Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither"
        );
      c(h.plugins), h.settings && (a.settings = Ax(!0, a.settings, h.settings));
    }
    function c(h) {
      let p = -1;
      if (h != null) if (Array.isArray(h))
        for (; ++p < h.length; ) {
          const g = h[p];
          o(g);
        }
      else
        throw new TypeError("Expected a list of plugins, not `" + h + "`");
    }
    function d(h, p) {
      let g = -1, x = -1;
      for (; ++g < r.length; )
        if (r[g][0] === h) {
          x = g;
          break;
        }
      if (x === -1)
        r.push([h, ...p]);
      else if (p.length > 0) {
        let [b, ...C] = p;
        const N = r[x][1];
        q3(N) && q3(b) && (b = Ax(!0, N, b)), r[x] = [h, b, ...C];
      }
    }
  }
}
const HB = new $S().freeze();
function zx(e, t) {
  if (typeof t != "function")
    throw new TypeError("Cannot `" + e + "` without `parser`");
}
function Dx(e, t) {
  if (typeof t != "function")
    throw new TypeError("Cannot `" + e + "` without `compiler`");
}
function Ix(e, t) {
  if (t)
    throw new Error(
      "Cannot call `" + e + "` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`."
    );
}
function VC(e) {
  if (!q3(e) || typeof e.type != "string")
    throw new TypeError("Expected node, got `" + e + "`");
}
function KC(e, t, n) {
  if (!n)
    throw new Error(
      "`" + e + "` finished async. Use `" + t + "` instead"
    );
}
function zy(e) {
  return GB(e) ? e : new S9(e);
}
function GB(e) {
  return !!(e && typeof e == "object" && "message" in e && "messages" in e);
}
function VB(e) {
  return typeof e == "string" || KB(e);
}
function KB(e) {
  return !!(e && typeof e == "object" && "byteLength" in e && "byteOffset" in e);
}
const YB = "https://github.com/remarkjs/react-markdown/blob/main/changelog.md", YC = [], WC = { allowDangerousHtml: !0 }, WB = /^(https?|ircs?|mailto|xmpp)$/i, XB = [
  { from: "astPlugins", id: "remove-buggy-html-in-markdown-parser" },
  { from: "allowDangerousHtml", id: "remove-buggy-html-in-markdown-parser" },
  {
    from: "allowNode",
    id: "replace-allownode-allowedtypes-and-disallowedtypes",
    to: "allowElement"
  },
  {
    from: "allowedTypes",
    id: "replace-allownode-allowedtypes-and-disallowedtypes",
    to: "allowedElements"
  },
  { from: "className", id: "remove-classname" },
  {
    from: "disallowedTypes",
    id: "replace-allownode-allowedtypes-and-disallowedtypes",
    to: "disallowedElements"
  },
  { from: "escapeHtml", id: "remove-buggy-html-in-markdown-parser" },
  { from: "includeElementIndex", id: "#remove-includeelementindex" },
  {
    from: "includeNodeIndex",
    id: "change-includenodeindex-to-includeelementindex"
  },
  { from: "linkTarget", id: "remove-linktarget" },
  { from: "plugins", id: "change-plugins-to-remarkplugins", to: "remarkPlugins" },
  { from: "rawSourcePos", id: "#remove-rawsourcepos" },
  { from: "renderers", id: "change-renderers-to-components", to: "components" },
  { from: "source", id: "change-source-to-children", to: "children" },
  { from: "sourcePos", id: "#remove-sourcepos" },
  { from: "transformImageUri", id: "#add-urltransform", to: "urlTransform" },
  { from: "transformLinkUri", id: "#add-urltransform", to: "urlTransform" }
];
function QB(e) {
  const t = ZB(e), n = JB(e);
  return eF(t.runSync(t.parse(n), n), e);
}
function ZB(e) {
  const t = e.rehypePlugins || YC, n = e.remarkPlugins || YC, r = e.remarkRehypeOptions ? { ...e.remarkRehypeOptions, ...WC } : WC;
  return HB().use(Rq).use(n).use(kB, r).use(t);
}
function JB(e) {
  const t = e.children || "", n = new S9();
  return typeof t == "string" && (n.value = t), n;
}
function eF(e, t) {
  const n = t.allowedElements, r = t.allowElement, a = t.components, o = t.disallowedElements, l = t.skipHtml, c = t.unwrapDisallowed, d = t.urlTransform || tF;
  for (const p of XB)
    Object.hasOwn(t, p.from) && ("" + p.from + (p.to ? "use `" + p.to + "` instead" : "remove it") + YB + p.id, void 0);
  return US(e, h), pL(e, {
    Fragment: m.Fragment,
    components: a,
    ignoreInvalidStyle: !0,
    jsx: m.jsx,
    jsxs: m.jsxs,
    passKeys: !0,
    passNode: !0
  });
  function h(p, g, x) {
    if (p.type === "raw" && x && typeof g == "number")
      return l ? x.children.splice(g, 1) : x.children[g] = { type: "text", value: p.value }, g;
    if (p.type === "element") {
      let b;
      for (b in kx)
        if (Object.hasOwn(kx, b) && Object.hasOwn(p.properties, b)) {
          const C = p.properties[b], N = kx[b];
          (N === null || N.includes(p.tagName)) && (p.properties[b] = d(String(C || ""), b, p));
        }
    }
    if (p.type === "element") {
      let b = n ? !n.includes(p.tagName) : o ? o.includes(p.tagName) : !1;
      if (!b && r && typeof g == "number" && (b = !r(p, g, x)), b && x && typeof g == "number")
        return c && p.children ? x.children.splice(g, 1, ...p.children) : x.children.splice(g, 1), g;
    }
  }
}
function tF(e) {
  const t = e.indexOf(":"), n = e.indexOf("?"), r = e.indexOf("#"), a = e.indexOf("/");
  return (
    // If there is no protocol, its relative.
    t === -1 || // If the first colon is after a `?`, `#`, or `/`, its not a protocol.
    a !== -1 && t > a || n !== -1 && t > n || r !== -1 && t > r || // It is a protocol, it should be allowed.
    WB.test(e.slice(0, t)) ? e : ""
  );
}
function XC(e, t) {
  const n = String(e);
  if (typeof t != "string")
    throw new TypeError("Expected character");
  let r = 0, a = n.indexOf(t);
  for (; a !== -1; )
    r++, a = n.indexOf(t, a + t.length);
  return r;
}
function nF(e) {
  if (typeof e != "string")
    throw new TypeError("Expected a string");
  return e.replace(/[|\\{}()[\]^$+*?.]/g, "\\$&").replace(/-/g, "\\x2d");
}
function rF(e, t, n) {
  const a = U1((n || {}).ignore || []), o = iF(t);
  let l = -1;
  for (; ++l < o.length; )
    _9(e, "text", c);
  function c(h, p) {
    let g = -1, x;
    for (; ++g < p.length; ) {
      const b = p[g], C = x ? x.children : void 0;
      if (a(
        b,
        C ? C.indexOf(b) : void 0,
        x
      ))
        return;
      x = b;
    }
    if (x)
      return d(h, p);
  }
  function d(h, p) {
    const g = p[p.length - 1], x = o[l][0], b = o[l][1];
    let C = 0;
    const T = g.children.indexOf(h);
    let j = !1, R = [];
    x.lastIndex = 0;
    let A = x.exec(h.value);
    for (; A; ) {
      const z = A.index, q = {
        index: A.index,
        input: A.input,
        stack: [...p, h]
      };
      let D = b(...A, q);
      if (typeof D == "string" && (D = D.length > 0 ? { type: "text", value: D } : void 0), D === !1 ? x.lastIndex = z + 1 : (C !== z && R.push({
        type: "text",
        value: h.value.slice(C, z)
      }), Array.isArray(D) ? R.push(...D) : D && R.push(D), C = z + A[0].length, j = !0), !x.global)
        break;
      A = x.exec(h.value);
    }
    return j ? (C < h.value.length && R.push({ type: "text", value: h.value.slice(C) }), g.children.splice(T, 1, ...R)) : R = [h], T + R.length;
  }
}
function iF(e) {
  const t = [];
  if (!Array.isArray(e))
    throw new TypeError("Expected find and replace tuple or list of tuples");
  const n = !e[0] || Array.isArray(e[0]) ? e : [e];
  let r = -1;
  for (; ++r < n.length; ) {
    const a = n[r];
    t.push([aF(a[0]), sF(a[1])]);
  }
  return t;
}
function aF(e) {
  return typeof e == "string" ? new RegExp(nF(e), "g") : e;
}
function sF(e) {
  return typeof e == "function" ? e : function() {
    return e;
  };
}
const Lx = "phrasing", Px = ["autolink", "link", "image", "label"];
function oF() {
  return {
    transforms: [mF],
    enter: {
      literalAutolink: uF,
      literalAutolinkEmail: qx,
      literalAutolinkHttp: qx,
      literalAutolinkWww: qx
    },
    exit: {
      literalAutolink: hF,
      literalAutolinkEmail: dF,
      literalAutolinkHttp: cF,
      literalAutolinkWww: fF
    }
  };
}
function lF() {
  return {
    unsafe: [
      {
        character: "@",
        before: "[+\\-.\\w]",
        after: "[\\-.\\w]",
        inConstruct: Lx,
        notInConstruct: Px
      },
      {
        character: ".",
        before: "[Ww]",
        after: "[\\-.\\w]",
        inConstruct: Lx,
        notInConstruct: Px
      },
      {
        character: ":",
        before: "[ps]",
        after: "\\/",
        inConstruct: Lx,
        notInConstruct: Px
      }
    ]
  };
}
function uF(e) {
  this.enter({ type: "link", title: null, url: "", children: [] }, e);
}
function qx(e) {
  this.config.enter.autolinkProtocol.call(this, e);
}
function cF(e) {
  this.config.exit.autolinkProtocol.call(this, e);
}
function fF(e) {
  this.config.exit.data.call(this, e);
  const t = this.stack[this.stack.length - 1];
  t.type, t.url = "http://" + this.sliceSerialize(e);
}
function dF(e) {
  this.config.exit.autolinkEmail.call(this, e);
}
function hF(e) {
  this.exit(e);
}
function mF(e) {
  rF(
    e,
    [
      [/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi, pF],
      [new RegExp("(?<=^|\\s|\\p{P}|\\p{S})([-.\\w+]+)@([-\\w]+(?:\\.[-\\w]+)+)", "gu"), gF]
    ],
    { ignore: ["link", "linkReference"] }
  );
}
function pF(e, t, n, r, a) {
  let o = "";
  if (!C9(a) || (/^w/i.test(t) && (n = t + n, t = "", o = "http://"), !yF(n)))
    return !1;
  const l = vF(n + r);
  if (!l[0]) return !1;
  const c = {
    type: "link",
    title: null,
    url: o + t + l[0],
    children: [{ type: "text", value: t + l[0] }]
  };
  return l[1] ? [c, { type: "text", value: l[1] }] : c;
}
function gF(e, t, n, r) {
  return (
    // Not an expected previous character.
    !C9(r, !0) || // Label ends in not allowed character.
    /[-\d_]$/.test(n) ? !1 : {
      type: "link",
      title: null,
      url: "mailto:" + t + "@" + n,
      children: [{ type: "text", value: t + "@" + n }]
    }
  );
}
function yF(e) {
  const t = e.split(".");
  return !(t.length < 2 || t[t.length - 1] && (/_/.test(t[t.length - 1]) || !/[a-zA-Z\d]/.test(t[t.length - 1])) || t[t.length - 2] && (/_/.test(t[t.length - 2]) || !/[a-zA-Z\d]/.test(t[t.length - 2])));
}
function vF(e) {
  const t = /[!"&'),.:;<>?\]}]+$/.exec(e);
  if (!t)
    return [e, void 0];
  e = e.slice(0, t.index);
  let n = t[0], r = n.indexOf(")");
  const a = XC(e, "(");
  let o = XC(e, ")");
  for (; r !== -1 && a > o; )
    e += n.slice(0, r + 1), n = n.slice(r + 1), r = n.indexOf(")"), o++;
  return [e, n];
}
function C9(e, t) {
  const n = e.input.charCodeAt(e.index - 1);
  return (e.index === 0 || td(n) || q1(n)) && // If its an email, the previous character should not be a slash.
  (!t || n !== 47);
}
E9.peek = NF;
function xF() {
  this.buffer();
}
function bF(e) {
  this.enter({ type: "footnoteReference", identifier: "", label: "" }, e);
}
function wF() {
  this.buffer();
}
function _F(e) {
  this.enter(
    { type: "footnoteDefinition", identifier: "", label: "", children: [] },
    e
  );
}
function SF(e) {
  const t = this.resume(), n = this.stack[this.stack.length - 1];
  n.type, n.identifier = mo(
    this.sliceSerialize(e)
  ).toLowerCase(), n.label = t;
}
function CF(e) {
  this.exit(e);
}
function EF(e) {
  const t = this.resume(), n = this.stack[this.stack.length - 1];
  n.type, n.identifier = mo(
    this.sliceSerialize(e)
  ).toLowerCase(), n.label = t;
}
function kF(e) {
  this.exit(e);
}
function NF() {
  return "[";
}
function E9(e, t, n, r) {
  const a = n.createTracker(r);
  let o = a.move("[^");
  const l = n.enter("footnoteReference"), c = n.enter("reference");
  return o += a.move(
    n.safe(n.associationId(e), { after: "]", before: o })
  ), c(), l(), o += a.move("]"), o;
}
function jF() {
  return {
    enter: {
      gfmFootnoteCallString: xF,
      gfmFootnoteCall: bF,
      gfmFootnoteDefinitionLabelString: wF,
      gfmFootnoteDefinition: _F
    },
    exit: {
      gfmFootnoteCallString: SF,
      gfmFootnoteCall: CF,
      gfmFootnoteDefinitionLabelString: EF,
      gfmFootnoteDefinition: kF
    }
  };
}
function TF(e) {
  let t = !1;
  return e && e.firstLineBlank && (t = !0), {
    handlers: { footnoteDefinition: n, footnoteReference: E9 },
    // This is on by default already.
    unsafe: [{ character: "[", inConstruct: ["label", "phrasing", "reference"] }]
  };
  function n(r, a, o, l) {
    const c = o.createTracker(l);
    let d = c.move("[^");
    const h = o.enter("footnoteDefinition"), p = o.enter("label");
    return d += c.move(
      o.safe(o.associationId(r), { before: d, after: "]" })
    ), p(), d += c.move("]:"), r.children && r.children.length > 0 && (c.shift(4), d += c.move(
      (t ? `
` : " ") + o.indentLines(
        o.containerFlow(r, c.current()),
        t ? k9 : AF
      )
    )), h(), d;
  }
}
function AF(e, t, n) {
  return t === 0 ? e : k9(e, t, n);
}
function k9(e, t, n) {
  return (n ? "" : "    ") + e;
}
const MF = [
  "autolink",
  "destinationLiteral",
  "destinationRaw",
  "reference",
  "titleQuote",
  "titleApostrophe"
];
N9.peek = IF;
function RF() {
  return {
    canContainEols: ["delete"],
    enter: { strikethrough: zF },
    exit: { strikethrough: DF }
  };
}
function OF() {
  return {
    unsafe: [
      {
        character: "~",
        inConstruct: "phrasing",
        notInConstruct: MF
      }
    ],
    handlers: { delete: N9 }
  };
}
function zF(e) {
  this.enter({ type: "delete", children: [] }, e);
}
function DF(e) {
  this.exit(e);
}
function N9(e, t, n, r) {
  const a = n.createTracker(r), o = n.enter("strikethrough");
  let l = a.move("~~");
  return l += n.containerPhrasing(e, {
    ...a.current(),
    before: l,
    after: "~"
  }), l += a.move("~~"), o(), l;
}
function IF() {
  return "~";
}
function LF(e) {
  return e.length;
}
function PF(e, t) {
  const n = t || {}, r = (n.align || []).concat(), a = n.stringLength || LF, o = [], l = [], c = [], d = [];
  let h = 0, p = -1;
  for (; ++p < e.length; ) {
    const N = [], T = [];
    let j = -1;
    for (e[p].length > h && (h = e[p].length); ++j < e[p].length; ) {
      const R = qF(e[p][j]);
      if (n.alignDelimiters !== !1) {
        const A = a(R);
        T[j] = A, (d[j] === void 0 || A > d[j]) && (d[j] = A);
      }
      N.push(R);
    }
    l[p] = N, c[p] = T;
  }
  let g = -1;
  if (typeof r == "object" && "length" in r)
    for (; ++g < h; )
      o[g] = QC(r[g]);
  else {
    const N = QC(r);
    for (; ++g < h; )
      o[g] = N;
  }
  g = -1;
  const x = [], b = [];
  for (; ++g < h; ) {
    const N = o[g];
    let T = "", j = "";
    N === 99 ? (T = ":", j = ":") : N === 108 ? T = ":" : N === 114 && (j = ":");
    let R = n.alignDelimiters === !1 ? 1 : Math.max(
      1,
      d[g] - T.length - j.length
    );
    const A = T + "-".repeat(R) + j;
    n.alignDelimiters !== !1 && (R = T.length + R + j.length, R > d[g] && (d[g] = R), b[g] = R), x[g] = A;
  }
  l.splice(1, 0, x), c.splice(1, 0, b), p = -1;
  const C = [];
  for (; ++p < l.length; ) {
    const N = l[p], T = c[p];
    g = -1;
    const j = [];
    for (; ++g < h; ) {
      const R = N[g] || "";
      let A = "", z = "";
      if (n.alignDelimiters !== !1) {
        const q = d[g] - (T[g] || 0), D = o[g];
        D === 114 ? A = " ".repeat(q) : D === 99 ? q % 2 ? (A = " ".repeat(q / 2 + 0.5), z = " ".repeat(q / 2 - 0.5)) : (A = " ".repeat(q / 2), z = A) : z = " ".repeat(q);
      }
      n.delimiterStart !== !1 && !g && j.push("|"), n.padding !== !1 && // Dont add the opening space if were not aligning and the cell is
      // empty: there will be a closing space.
      !(n.alignDelimiters === !1 && R === "") && (n.delimiterStart !== !1 || g) && j.push(" "), n.alignDelimiters !== !1 && j.push(A), j.push(R), n.alignDelimiters !== !1 && j.push(z), n.padding !== !1 && j.push(" "), (n.delimiterEnd !== !1 || g !== h - 1) && j.push("|");
    }
    C.push(
      n.delimiterEnd === !1 ? j.join("").replace(/ +$/, "") : j.join("")
    );
  }
  return C.join(`
`);
}
function qF(e) {
  return e == null ? "" : String(e);
}
function QC(e) {
  const t = typeof e == "string" ? e.codePointAt(0) : 0;
  return t === 67 || t === 99 ? 99 : t === 76 || t === 108 ? 108 : t === 82 || t === 114 ? 114 : 0;
}
function BF(e, t, n, r) {
  const a = n.enter("blockquote"), o = n.createTracker(r);
  o.move("> "), o.shift(2);
  const l = n.indentLines(
    n.containerFlow(e, o.current()),
    FF
  );
  return a(), l;
}
function FF(e, t, n) {
  return ">" + (n ? "" : " ") + e;
}
function UF(e, t) {
  return ZC(e, t.inConstruct, !0) && !ZC(e, t.notInConstruct, !1);
}
function ZC(e, t, n) {
  if (typeof t == "string" && (t = [t]), !t || t.length === 0)
    return n;
  let r = -1;
  for (; ++r < t.length; )
    if (e.includes(t[r]))
      return !0;
  return !1;
}
function JC(e, t, n, r) {
  let a = -1;
  for (; ++a < n.unsafe.length; )
    if (n.unsafe[a].character === `
` && UF(n.stack, n.unsafe[a]))
      return /[ \t]/.test(r.before) ? "" : " ";
  return `\\
`;
}
function $F(e, t) {
  const n = String(e);
  let r = n.indexOf(t), a = r, o = 0, l = 0;
  if (typeof t != "string")
    throw new TypeError("Expected substring");
  for (; r !== -1; )
    r === a ? ++o > l && (l = o) : o = 1, a = r + t.length, r = n.indexOf(t, a);
  return l;
}
function HF(e, t) {
  return !!(t.options.fences === !1 && e.value && // If theres no info
  !e.lang && // And theres a non-whitespace character
  /[^ \r\n]/.test(e.value) && // And the value doesnt start or end in a blank
  !/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value));
}
function GF(e) {
  const t = e.options.fence || "`";
  if (t !== "`" && t !== "~")
    throw new Error(
      "Cannot serialize code with `" + t + "` for `options.fence`, expected `` ` `` or `~`"
    );
  return t;
}
function VF(e, t, n, r) {
  const a = GF(n), o = e.value || "", l = a === "`" ? "GraveAccent" : "Tilde";
  if (HF(e, n)) {
    const g = n.enter("codeIndented"), x = n.indentLines(o, KF);
    return g(), x;
  }
  const c = n.createTracker(r), d = a.repeat(Math.max($F(o, a) + 1, 3)), h = n.enter("codeFenced");
  let p = c.move(d);
  if (e.lang) {
    const g = n.enter(`codeFencedLang${l}`);
    p += c.move(
      n.safe(e.lang, {
        before: p,
        after: " ",
        encode: ["`"],
        ...c.current()
      })
    ), g();
  }
  if (e.lang && e.meta) {
    const g = n.enter(`codeFencedMeta${l}`);
    p += c.move(" "), p += c.move(
      n.safe(e.meta, {
        before: p,
        after: `
`,
        encode: ["`"],
        ...c.current()
      })
    ), g();
  }
  return p += c.move(`
`), o && (p += c.move(o + `
`)), p += c.move(d), h(), p;
}
function KF(e, t, n) {
  return (n ? "" : "    ") + e;
}
function HS(e) {
  const t = e.options.quote || '"';
  if (t !== '"' && t !== "'")
    throw new Error(
      "Cannot serialize title with `" + t + "` for `options.quote`, expected `\"`, or `'`"
    );
  return t;
}
function YF(e, t, n, r) {
  const a = HS(n), o = a === '"' ? "Quote" : "Apostrophe", l = n.enter("definition");
  let c = n.enter("label");
  const d = n.createTracker(r);
  let h = d.move("[");
  return h += d.move(
    n.safe(n.associationId(e), {
      before: h,
      after: "]",
      ...d.current()
    })
  ), h += d.move("]: "), c(), // If theres no url, or
  !e.url || // If there are control characters or whitespace.
  /[\0- \u007F]/.test(e.url) ? (c = n.enter("destinationLiteral"), h += d.move("<"), h += d.move(
    n.safe(e.url, { before: h, after: ">", ...d.current() })
  ), h += d.move(">")) : (c = n.enter("destinationRaw"), h += d.move(
    n.safe(e.url, {
      before: h,
      after: e.title ? " " : `
`,
      ...d.current()
    })
  )), c(), e.title && (c = n.enter(`title${o}`), h += d.move(" " + a), h += d.move(
    n.safe(e.title, {
      before: h,
      after: a,
      ...d.current()
    })
  ), h += d.move(a), c()), l(), h;
}
function WF(e) {
  const t = e.options.emphasis || "*";
  if (t !== "*" && t !== "_")
    throw new Error(
      "Cannot serialize emphasis with `" + t + "` for `options.emphasis`, expected `*`, or `_`"
    );
  return t;
}
function gg(e) {
  return "&#x" + e.toString(16).toUpperCase() + ";";
}
function h1(e, t, n) {
  const r = Hh(e), a = Hh(t);
  return r === void 0 ? a === void 0 ? (
    // Letter inside:
    // we have to encode *both* letters for `_` as it is looser.
    // it already forms for `*` (and GFMs `~`).
    n === "_" ? { inside: !0, outside: !0 } : { inside: !1, outside: !1 }
  ) : a === 1 ? (
    // Whitespace inside: encode both (letter, whitespace).
    { inside: !0, outside: !0 }
  ) : (
    // Punctuation inside: encode outer (letter)
    { inside: !1, outside: !0 }
  ) : r === 1 ? a === void 0 ? (
    // Letter inside: already forms.
    { inside: !1, outside: !1 }
  ) : a === 1 ? (
    // Whitespace inside: encode both (whitespace).
    { inside: !0, outside: !0 }
  ) : (
    // Punctuation inside: already forms.
    { inside: !1, outside: !1 }
  ) : a === void 0 ? (
    // Letter inside: already forms.
    { inside: !1, outside: !1 }
  ) : a === 1 ? (
    // Whitespace inside: encode inner (whitespace).
    { inside: !0, outside: !1 }
  ) : (
    // Punctuation inside: already forms.
    { inside: !1, outside: !1 }
  );
}
j9.peek = XF;
function j9(e, t, n, r) {
  const a = WF(n), o = n.enter("emphasis"), l = n.createTracker(r), c = l.move(a);
  let d = l.move(
    n.containerPhrasing(e, {
      after: a,
      before: c,
      ...l.current()
    })
  );
  const h = d.charCodeAt(0), p = h1(
    r.before.charCodeAt(r.before.length - 1),
    h,
    a
  );
  p.inside && (d = gg(h) + d.slice(1));
  const g = d.charCodeAt(d.length - 1), x = h1(r.after.charCodeAt(0), g, a);
  x.inside && (d = d.slice(0, -1) + gg(g));
  const b = l.move(a);
  return o(), n.attentionEncodeSurroundingInfo = {
    after: x.outside,
    before: p.outside
  }, c + d + b;
}
function XF(e, t, n) {
  return n.options.emphasis || "*";
}
function QF(e, t) {
  let n = !1;
  return US(e, function(r) {
    if ("value" in r && /\r?\n|\r/.test(r.value) || r.type === "break")
      return n = !0, L3;
  }), !!((!e.depth || e.depth < 3) && DS(e) && (t.options.setext || n));
}
function ZF(e, t, n, r) {
  const a = Math.max(Math.min(6, e.depth || 1), 1), o = n.createTracker(r);
  if (QF(e, n)) {
    const p = n.enter("headingSetext"), g = n.enter("phrasing"), x = n.containerPhrasing(e, {
      ...o.current(),
      before: `
`,
      after: `
`
    });
    return g(), p(), x + `
` + (a === 1 ? "=" : "-").repeat(
      // The whole size
      x.length - // Minus the position of the character after the last EOL (or
      // 0 if there is none)
      (Math.max(x.lastIndexOf("\r"), x.lastIndexOf(`
`)) + 1)
    );
  }
  const l = "#".repeat(a), c = n.enter("headingAtx"), d = n.enter("phrasing");
  o.move(l + " ");
  let h = n.containerPhrasing(e, {
    before: "# ",
    after: `
`,
    ...o.current()
  });
  return /^[\t ]/.test(h) && (h = gg(h.charCodeAt(0)) + h.slice(1)), h = h ? l + " " + h : l, n.options.closeAtx && (h += " " + l), d(), c(), h;
}
T9.peek = JF;
function T9(e) {
  return e.value || "";
}
function JF() {
  return "<";
}
A9.peek = eU;
function A9(e, t, n, r) {
  const a = HS(n), o = a === '"' ? "Quote" : "Apostrophe", l = n.enter("image");
  let c = n.enter("label");
  const d = n.createTracker(r);
  let h = d.move("![");
  return h += d.move(
    n.safe(e.alt, { before: h, after: "]", ...d.current() })
  ), h += d.move("]("), c(), // If theres no url but there is a title
  !e.url && e.title || // If there are control characters or whitespace.
  /[\0- \u007F]/.test(e.url) ? (c = n.enter("destinationLiteral"), h += d.move("<"), h += d.move(
    n.safe(e.url, { before: h, after: ">", ...d.current() })
  ), h += d.move(">")) : (c = n.enter("destinationRaw"), h += d.move(
    n.safe(e.url, {
      before: h,
      after: e.title ? " " : ")",
      ...d.current()
    })
  )), c(), e.title && (c = n.enter(`title${o}`), h += d.move(" " + a), h += d.move(
    n.safe(e.title, {
      before: h,
      after: a,
      ...d.current()
    })
  ), h += d.move(a), c()), h += d.move(")"), l(), h;
}
function eU() {
  return "!";
}
M9.peek = tU;
function M9(e, t, n, r) {
  const a = e.referenceType, o = n.enter("imageReference");
  let l = n.enter("label");
  const c = n.createTracker(r);
  let d = c.move("![");
  const h = n.safe(e.alt, {
    before: d,
    after: "]",
    ...c.current()
  });
  d += c.move(h + "]["), l();
  const p = n.stack;
  n.stack = [], l = n.enter("reference");
  const g = n.safe(n.associationId(e), {
    before: d,
    after: "]",
    ...c.current()
  });
  return l(), n.stack = p, o(), a === "full" || !h || h !== g ? d += c.move(g + "]") : a === "shortcut" ? d = d.slice(0, -1) : d += c.move("]"), d;
}
function tU() {
  return "!";
}
R9.peek = nU;
function R9(e, t, n) {
  let r = e.value || "", a = "`", o = -1;
  for (; new RegExp("(^|[^`])" + a + "([^`]|$)").test(r); )
    a += "`";
  for (/[^ \r\n]/.test(r) && (/^[ \r\n]/.test(r) && /[ \r\n]$/.test(r) || /^`|`$/.test(r)) && (r = " " + r + " "); ++o < n.unsafe.length; ) {
    const l = n.unsafe[o], c = n.compilePattern(l);
    let d;
    if (l.atBreak)
      for (; d = c.exec(r); ) {
        let h = d.index;
        r.charCodeAt(h) === 10 && r.charCodeAt(h - 1) === 13 && h--, r = r.slice(0, h) + " " + r.slice(d.index + 1);
      }
  }
  return a + r + a;
}
function nU() {
  return "`";
}
function O9(e, t) {
  const n = DS(e);
  return !!(!t.options.resourceLink && // If theres a url
  e.url && // And theres a no title
  !e.title && // And the content of `node` is a single text node
  e.children && e.children.length === 1 && e.children[0].type === "text" && // And if the url is the same as the content
  (n === e.url || "mailto:" + n === e.url) && // And that starts w/ a protocol
  /^[a-z][a-z+.-]+:/i.test(e.url) && // And that doesnt contain ASCII control codes (character escapes and
  // references dont work), space, or angle brackets
  !/[\0- <>\u007F]/.test(e.url));
}
z9.peek = rU;
function z9(e, t, n, r) {
  const a = HS(n), o = a === '"' ? "Quote" : "Apostrophe", l = n.createTracker(r);
  let c, d;
  if (O9(e, n)) {
    const p = n.stack;
    n.stack = [], c = n.enter("autolink");
    let g = l.move("<");
    return g += l.move(
      n.containerPhrasing(e, {
        before: g,
        after: ">",
        ...l.current()
      })
    ), g += l.move(">"), c(), n.stack = p, g;
  }
  c = n.enter("link"), d = n.enter("label");
  let h = l.move("[");
  return h += l.move(
    n.containerPhrasing(e, {
      before: h,
      after: "](",
      ...l.current()
    })
  ), h += l.move("]("), d(), // If theres no url but there is a title
  !e.url && e.title || // If there are control characters or whitespace.
  /[\0- \u007F]/.test(e.url) ? (d = n.enter("destinationLiteral"), h += l.move("<"), h += l.move(
    n.safe(e.url, { before: h, after: ">", ...l.current() })
  ), h += l.move(">")) : (d = n.enter("destinationRaw"), h += l.move(
    n.safe(e.url, {
      before: h,
      after: e.title ? " " : ")",
      ...l.current()
    })
  )), d(), e.title && (d = n.enter(`title${o}`), h += l.move(" " + a), h += l.move(
    n.safe(e.title, {
      before: h,
      after: a,
      ...l.current()
    })
  ), h += l.move(a), d()), h += l.move(")"), c(), h;
}
function rU(e, t, n) {
  return O9(e, n) ? "<" : "[";
}
D9.peek = iU;
function D9(e, t, n, r) {
  const a = e.referenceType, o = n.enter("linkReference");
  let l = n.enter("label");
  const c = n.createTracker(r);
  let d = c.move("[");
  const h = n.containerPhrasing(e, {
    before: d,
    after: "]",
    ...c.current()
  });
  d += c.move(h + "]["), l();
  const p = n.stack;
  n.stack = [], l = n.enter("reference");
  const g = n.safe(n.associationId(e), {
    before: d,
    after: "]",
    ...c.current()
  });
  return l(), n.stack = p, o(), a === "full" || !h || h !== g ? d += c.move(g + "]") : a === "shortcut" ? d = d.slice(0, -1) : d += c.move("]"), d;
}
function iU() {
  return "[";
}
function GS(e) {
  const t = e.options.bullet || "*";
  if (t !== "*" && t !== "+" && t !== "-")
    throw new Error(
      "Cannot serialize items with `" + t + "` for `options.bullet`, expected `*`, `+`, or `-`"
    );
  return t;
}
function aU(e) {
  const t = GS(e), n = e.options.bulletOther;
  if (!n)
    return t === "*" ? "-" : "*";
  if (n !== "*" && n !== "+" && n !== "-")
    throw new Error(
      "Cannot serialize items with `" + n + "` for `options.bulletOther`, expected `*`, `+`, or `-`"
    );
  if (n === t)
    throw new Error(
      "Expected `bullet` (`" + t + "`) and `bulletOther` (`" + n + "`) to be different"
    );
  return n;
}
function sU(e) {
  const t = e.options.bulletOrdered || ".";
  if (t !== "." && t !== ")")
    throw new Error(
      "Cannot serialize items with `" + t + "` for `options.bulletOrdered`, expected `.` or `)`"
    );
  return t;
}
function I9(e) {
  const t = e.options.rule || "*";
  if (t !== "*" && t !== "-" && t !== "_")
    throw new Error(
      "Cannot serialize rules with `" + t + "` for `options.rule`, expected `*`, `-`, or `_`"
    );
  return t;
}
function oU(e, t, n, r) {
  const a = n.enter("list"), o = n.bulletCurrent;
  let l = e.ordered ? sU(n) : GS(n);
  const c = e.ordered ? l === "." ? ")" : "." : aU(n);
  let d = t && n.bulletLastUsed ? l === n.bulletLastUsed : !1;
  if (!e.ordered) {
    const p = e.children ? e.children[0] : void 0;
    if (
      // Bullet could be used as a thematic break marker:
      (l === "*" || l === "-") && // Empty first list item:
      p && (!p.children || !p.children[0]) && // Directly in two other list items:
      n.stack[n.stack.length - 1] === "list" && n.stack[n.stack.length - 2] === "listItem" && n.stack[n.stack.length - 3] === "list" && n.stack[n.stack.length - 4] === "listItem" && // That are each the first child.
      n.indexStack[n.indexStack.length - 1] === 0 && n.indexStack[n.indexStack.length - 2] === 0 && n.indexStack[n.indexStack.length - 3] === 0 && (d = !0), I9(n) === l && p
    ) {
      let g = -1;
      for (; ++g < e.children.length; ) {
        const x = e.children[g];
        if (x && x.type === "listItem" && x.children && x.children[0] && x.children[0].type === "thematicBreak") {
          d = !0;
          break;
        }
      }
    }
  }
  d && (l = c), n.bulletCurrent = l;
  const h = n.containerFlow(e, r);
  return n.bulletLastUsed = l, n.bulletCurrent = o, a(), h;
}
function lU(e) {
  const t = e.options.listItemIndent || "one";
  if (t !== "tab" && t !== "one" && t !== "mixed")
    throw new Error(
      "Cannot serialize items with `" + t + "` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`"
    );
  return t;
}
function uU(e, t, n, r) {
  const a = lU(n);
  let o = n.bulletCurrent || GS(n);
  t && t.type === "list" && t.ordered && (o = (typeof t.start == "number" && t.start > -1 ? t.start : 1) + (n.options.incrementListMarker === !1 ? 0 : t.children.indexOf(e)) + o);
  let l = o.length + 1;
  (a === "tab" || a === "mixed" && (t && t.type === "list" && t.spread || e.spread)) && (l = Math.ceil(l / 4) * 4);
  const c = n.createTracker(r);
  c.move(o + " ".repeat(l - o.length)), c.shift(l);
  const d = n.enter("listItem"), h = n.indentLines(
    n.containerFlow(e, c.current()),
    p
  );
  return d(), h;
  function p(g, x, b) {
    return x ? (b ? "" : " ".repeat(l)) + g : (b ? o : o + " ".repeat(l - o.length)) + g;
  }
}
function cU(e, t, n, r) {
  const a = n.enter("paragraph"), o = n.enter("phrasing"), l = n.containerPhrasing(e, r);
  return o(), a(), l;
}
const fU = (
  /** @type {(node?: unknown) => node is Exclude<PhrasingContent, Html>} */
  U1([
    "break",
    "delete",
    "emphasis",
    // To do: next major: removed since footnotes were added to GFM.
    "footnote",
    "footnoteReference",
    "image",
    "imageReference",
    "inlineCode",
    // Enabled by `mdast-util-math`:
    "inlineMath",
    "link",
    "linkReference",
    // Enabled by `mdast-util-mdx`:
    "mdxJsxTextElement",
    // Enabled by `mdast-util-mdx`:
    "mdxTextExpression",
    "strong",
    "text",
    // Enabled by `mdast-util-directive`:
    "textDirective"
  ])
);
function dU(e, t, n, r) {
  return (e.children.some(function(l) {
    return fU(l);
  }) ? n.containerPhrasing : n.containerFlow).call(n, e, r);
}
function hU(e) {
  const t = e.options.strong || "*";
  if (t !== "*" && t !== "_")
    throw new Error(
      "Cannot serialize strong with `" + t + "` for `options.strong`, expected `*`, or `_`"
    );
  return t;
}
L9.peek = mU;
function L9(e, t, n, r) {
  const a = hU(n), o = n.enter("strong"), l = n.createTracker(r), c = l.move(a + a);
  let d = l.move(
    n.containerPhrasing(e, {
      after: a,
      before: c,
      ...l.current()
    })
  );
  const h = d.charCodeAt(0), p = h1(
    r.before.charCodeAt(r.before.length - 1),
    h,
    a
  );
  p.inside && (d = gg(h) + d.slice(1));
  const g = d.charCodeAt(d.length - 1), x = h1(r.after.charCodeAt(0), g, a);
  x.inside && (d = d.slice(0, -1) + gg(g));
  const b = l.move(a + a);
  return o(), n.attentionEncodeSurroundingInfo = {
    after: x.outside,
    before: p.outside
  }, c + d + b;
}
function mU(e, t, n) {
  return n.options.strong || "*";
}
function pU(e, t, n, r) {
  return n.safe(e.value, r);
}
function gU(e) {
  const t = e.options.ruleRepetition || 3;
  if (t < 3)
    throw new Error(
      "Cannot serialize rules with repetition `" + t + "` for `options.ruleRepetition`, expected `3` or more"
    );
  return t;
}
function yU(e, t, n) {
  const r = (I9(n) + (n.options.ruleSpaces ? " " : "")).repeat(gU(n));
  return n.options.ruleSpaces ? r.slice(0, -1) : r;
}
const P9 = {
  blockquote: BF,
  break: JC,
  code: VF,
  definition: YF,
  emphasis: j9,
  hardBreak: JC,
  heading: ZF,
  html: T9,
  image: A9,
  imageReference: M9,
  inlineCode: R9,
  link: z9,
  linkReference: D9,
  list: oU,
  listItem: uU,
  paragraph: cU,
  root: dU,
  strong: L9,
  text: pU,
  thematicBreak: yU
};
function vU() {
  return {
    enter: {
      table: xU,
      tableData: eE,
      tableHeader: eE,
      tableRow: wU
    },
    exit: {
      codeText: _U,
      table: bU,
      tableData: Bx,
      tableHeader: Bx,
      tableRow: Bx
    }
  };
}
function xU(e) {
  const t = e._align;
  this.enter(
    {
      type: "table",
      align: t.map(function(n) {
        return n === "none" ? null : n;
      }),
      children: []
    },
    e
  ), this.data.inTable = !0;
}
function bU(e) {
  this.exit(e), this.data.inTable = void 0;
}
function wU(e) {
  this.enter({ type: "tableRow", children: [] }, e);
}
function Bx(e) {
  this.exit(e);
}
function eE(e) {
  this.enter({ type: "tableCell", children: [] }, e);
}
function _U(e) {
  let t = this.resume();
  this.data.inTable && (t = t.replace(/\\([\\|])/g, SU));
  const n = this.stack[this.stack.length - 1];
  n.type, n.value = t, this.exit(e);
}
function SU(e, t) {
  return t === "|" ? t : e;
}
function CU(e) {
  const t = e || {}, n = t.tableCellPadding, r = t.tablePipeAlign, a = t.stringLength, o = n ? " " : "|";
  return {
    unsafe: [
      { character: "\r", inConstruct: "tableCell" },
      { character: `
`, inConstruct: "tableCell" },
      // A pipe, when followed by a tab or space (padding), or a dash or colon
      // (unpadded delimiter row), could result in a table.
      { atBreak: !0, character: "|", after: "[	 :-]" },
      // A pipe in a cell must be encoded.
      { character: "|", inConstruct: "tableCell" },
      // A colon must be followed by a dash, in which case it could start a
      // delimiter row.
      { atBreak: !0, character: ":", after: "-" },
      // A delimiter row can also start with a dash, when followed by more
      // dashes, a colon, or a pipe.
      // This is a stricter version than the built in check for lists, thematic
      // breaks, and setex heading underlines though:
      // <https://github.com/syntax-tree/mdast-util-to-markdown/blob/51a2038/lib/unsafe.js#L57>
      { atBreak: !0, character: "-", after: "[:|-]" }
    ],
    handlers: {
      inlineCode: x,
      table: l,
      tableCell: d,
      tableRow: c
    }
  };
  function l(b, C, N, T) {
    return h(p(b, N, T), b.align);
  }
  function c(b, C, N, T) {
    const j = g(b, N, T), R = h([j]);
    return R.slice(0, R.indexOf(`
`));
  }
  function d(b, C, N, T) {
    const j = N.enter("tableCell"), R = N.enter("phrasing"), A = N.containerPhrasing(b, {
      ...T,
      before: o,
      after: o
    });
    return R(), j(), A;
  }
  function h(b, C) {
    return PF(b, {
      align: C,
      // @ts-expect-error: `markdown-table` types should support `null`.
      alignDelimiters: r,
      // @ts-expect-error: `markdown-table` types should support `null`.
      padding: n,
      // @ts-expect-error: `markdown-table` types should support `null`.
      stringLength: a
    });
  }
  function p(b, C, N) {
    const T = b.children;
    let j = -1;
    const R = [], A = C.enter("table");
    for (; ++j < T.length; )
      R[j] = g(T[j], C, N);
    return A(), R;
  }
  function g(b, C, N) {
    const T = b.children;
    let j = -1;
    const R = [], A = C.enter("tableRow");
    for (; ++j < T.length; )
      R[j] = d(T[j], b, C, N);
    return A(), R;
  }
  function x(b, C, N) {
    let T = P9.inlineCode(b, C, N);
    return N.stack.includes("tableCell") && (T = T.replace(/\|/g, "\\$&")), T;
  }
}
function EU() {
  return {
    exit: {
      taskListCheckValueChecked: tE,
      taskListCheckValueUnchecked: tE,
      paragraph: NU
    }
  };
}
function kU() {
  return {
    unsafe: [{ atBreak: !0, character: "-", after: "[:|-]" }],
    handlers: { listItem: jU }
  };
}
function tE(e) {
  const t = this.stack[this.stack.length - 2];
  t.type, t.checked = e.type === "taskListCheckValueChecked";
}
function NU(e) {
  const t = this.stack[this.stack.length - 2];
  if (t && t.type === "listItem" && typeof t.checked == "boolean") {
    const n = this.stack[this.stack.length - 1];
    n.type;
    const r = n.children[0];
    if (r && r.type === "text") {
      const a = t.children;
      let o = -1, l;
      for (; ++o < a.length; ) {
        const c = a[o];
        if (c.type === "paragraph") {
          l = c;
          break;
        }
      }
      l === n && (r.value = r.value.slice(1), r.value.length === 0 ? n.children.shift() : n.position && r.position && typeof r.position.start.offset == "number" && (r.position.start.column++, r.position.start.offset++, n.position.start = Object.assign({}, r.position.start)));
    }
  }
  this.exit(e);
}
function jU(e, t, n, r) {
  const a = e.children[0], o = typeof e.checked == "boolean" && a && a.type === "paragraph", l = "[" + (e.checked ? "x" : " ") + "] ", c = n.createTracker(r);
  o && c.move(l);
  let d = P9.listItem(e, t, n, {
    ...r,
    ...c.current()
  });
  return o && (d = d.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/, h)), d;
  function h(p) {
    return p + l;
  }
}
function TU() {
  return [
    oF(),
    jF(),
    RF(),
    vU(),
    EU()
  ];
}
function AU(e) {
  return {
    extensions: [
      lF(),
      TF(e),
      OF(),
      CU(e),
      kU()
    ]
  };
}
const MU = {
  tokenize: LU,
  partial: !0
}, q9 = {
  tokenize: PU,
  partial: !0
}, B9 = {
  tokenize: qU,
  partial: !0
}, F9 = {
  tokenize: BU,
  partial: !0
}, RU = {
  tokenize: FU,
  partial: !0
}, U9 = {
  name: "wwwAutolink",
  tokenize: DU,
  previous: H9
}, $9 = {
  name: "protocolAutolink",
  tokenize: IU,
  previous: G9
}, su = {
  name: "emailAutolink",
  tokenize: zU,
  previous: V9
}, yl = {};
function OU() {
  return {
    text: yl
  };
}
let Pf = 48;
for (; Pf < 123; )
  yl[Pf] = su, Pf++, Pf === 58 ? Pf = 65 : Pf === 91 && (Pf = 97);
yl[43] = su;
yl[45] = su;
yl[46] = su;
yl[95] = su;
yl[72] = [su, $9];
yl[104] = [su, $9];
yl[87] = [su, U9];
yl[119] = [su, U9];
function zU(e, t, n) {
  const r = this;
  let a, o;
  return l;
  function l(g) {
    return !F3(g) || !V9.call(r, r.previous) || VS(r.events) ? n(g) : (e.enter("literalAutolink"), e.enter("literalAutolinkEmail"), c(g));
  }
  function c(g) {
    return F3(g) ? (e.consume(g), c) : g === 64 ? (e.consume(g), d) : n(g);
  }
  function d(g) {
    return g === 46 ? e.check(RU, p, h)(g) : g === 45 || g === 95 || Ri(g) ? (o = !0, e.consume(g), d) : p(g);
  }
  function h(g) {
    return e.consume(g), a = !0, d;
  }
  function p(g) {
    return o && a && ta(r.previous) ? (e.exit("literalAutolinkEmail"), e.exit("literalAutolink"), t(g)) : n(g);
  }
}
function DU(e, t, n) {
  const r = this;
  return a;
  function a(l) {
    return l !== 87 && l !== 119 || !H9.call(r, r.previous) || VS(r.events) ? n(l) : (e.enter("literalAutolink"), e.enter("literalAutolinkWww"), e.check(MU, e.attempt(q9, e.attempt(B9, o), n), n)(l));
  }
  function o(l) {
    return e.exit("literalAutolinkWww"), e.exit("literalAutolink"), t(l);
  }
}
function IU(e, t, n) {
  const r = this;
  let a = "", o = !1;
  return l;
  function l(g) {
    return (g === 72 || g === 104) && G9.call(r, r.previous) && !VS(r.events) ? (e.enter("literalAutolink"), e.enter("literalAutolinkHttp"), a += String.fromCodePoint(g), e.consume(g), c) : n(g);
  }
  function c(g) {
    if (ta(g) && a.length < 5)
      return a += String.fromCodePoint(g), e.consume(g), c;
    if (g === 58) {
      const x = a.toLowerCase();
      if (x === "http" || x === "https")
        return e.consume(g), d;
    }
    return n(g);
  }
  function d(g) {
    return g === 47 ? (e.consume(g), o ? h : (o = !0, d)) : n(g);
  }
  function h(g) {
    return g === null || c1(g) || Bn(g) || td(g) || q1(g) ? n(g) : e.attempt(q9, e.attempt(B9, p), n)(g);
  }
  function p(g) {
    return e.exit("literalAutolinkHttp"), e.exit("literalAutolink"), t(g);
  }
}
function LU(e, t, n) {
  let r = 0;
  return a;
  function a(l) {
    return (l === 87 || l === 119) && r < 3 ? (r++, e.consume(l), a) : l === 46 && r === 3 ? (e.consume(l), o) : n(l);
  }
  function o(l) {
    return l === null ? n(l) : t(l);
  }
}
function PU(e, t, n) {
  let r, a, o;
  return l;
  function l(h) {
    return h === 46 || h === 95 ? e.check(F9, d, c)(h) : h === null || Bn(h) || td(h) || h !== 45 && q1(h) ? d(h) : (o = !0, e.consume(h), l);
  }
  function c(h) {
    return h === 95 ? r = !0 : (a = r, r = void 0), e.consume(h), l;
  }
  function d(h) {
    return a || r || !o ? n(h) : t(h);
  }
}
function qU(e, t) {
  let n = 0, r = 0;
  return a;
  function a(l) {
    return l === 40 ? (n++, e.consume(l), a) : l === 41 && r < n ? o(l) : l === 33 || l === 34 || l === 38 || l === 39 || l === 41 || l === 42 || l === 44 || l === 46 || l === 58 || l === 59 || l === 60 || l === 63 || l === 93 || l === 95 || l === 126 ? e.check(F9, t, o)(l) : l === null || Bn(l) || td(l) ? t(l) : (e.consume(l), a);
  }
  function o(l) {
    return l === 41 && r++, e.consume(l), a;
  }
}
function BU(e, t, n) {
  return r;
  function r(c) {
    return c === 33 || c === 34 || c === 39 || c === 41 || c === 42 || c === 44 || c === 46 || c === 58 || c === 59 || c === 63 || c === 95 || c === 126 ? (e.consume(c), r) : c === 38 ? (e.consume(c), o) : c === 93 ? (e.consume(c), a) : (
      // `<` is an end.
      c === 60 || // So is whitespace.
      c === null || Bn(c) || td(c) ? t(c) : n(c)
    );
  }
  function a(c) {
    return c === null || c === 40 || c === 91 || Bn(c) || td(c) ? t(c) : r(c);
  }
  function o(c) {
    return ta(c) ? l(c) : n(c);
  }
  function l(c) {
    return c === 59 ? (e.consume(c), r) : ta(c) ? (e.consume(c), l) : n(c);
  }
}
function FU(e, t, n) {
  return r;
  function r(o) {
    return e.consume(o), a;
  }
  function a(o) {
    return Ri(o) ? n(o) : t(o);
  }
}
function H9(e) {
  return e === null || e === 40 || e === 42 || e === 95 || e === 91 || e === 93 || e === 126 || Bn(e);
}
function G9(e) {
  return !ta(e);
}
function V9(e) {
  return !(e === 47 || F3(e));
}
function F3(e) {
  return e === 43 || e === 45 || e === 46 || e === 95 || Ri(e);
}
function VS(e) {
  let t = e.length, n = !1;
  for (; t--; ) {
    const r = e[t][1];
    if ((r.type === "labelLink" || r.type === "labelImage") && !r._balanced) {
      n = !0;
      break;
    }
    if (r._gfmAutolinkLiteralWalkedInto) {
      n = !1;
      break;
    }
  }
  return e.length > 0 && !n && (e[e.length - 1][1]._gfmAutolinkLiteralWalkedInto = !0), n;
}
const UU = {
  tokenize: XU,
  partial: !0
};
function $U() {
  return {
    document: {
      91: {
        name: "gfmFootnoteDefinition",
        tokenize: KU,
        continuation: {
          tokenize: YU
        },
        exit: WU
      }
    },
    text: {
      91: {
        name: "gfmFootnoteCall",
        tokenize: VU
      },
      93: {
        name: "gfmPotentialFootnoteCall",
        add: "after",
        tokenize: HU,
        resolveTo: GU
      }
    }
  };
}
function HU(e, t, n) {
  const r = this;
  let a = r.events.length;
  const o = r.parser.gfmFootnotes || (r.parser.gfmFootnotes = []);
  let l;
  for (; a--; ) {
    const d = r.events[a][1];
    if (d.type === "labelImage") {
      l = d;
      break;
    }
    if (d.type === "gfmFootnoteCall" || d.type === "labelLink" || d.type === "label" || d.type === "image" || d.type === "link")
      break;
  }
  return c;
  function c(d) {
    if (!l || !l._balanced)
      return n(d);
    const h = mo(r.sliceSerialize({
      start: l.end,
      end: r.now()
    }));
    return h.codePointAt(0) !== 94 || !o.includes(h.slice(1)) ? n(d) : (e.enter("gfmFootnoteCallLabelMarker"), e.consume(d), e.exit("gfmFootnoteCallLabelMarker"), t(d));
  }
}
function GU(e, t) {
  let n = e.length;
  for (; n--; )
    if (e[n][1].type === "labelImage" && e[n][0] === "enter") {
      e[n][1];
      break;
    }
  e[n + 1][1].type = "data", e[n + 3][1].type = "gfmFootnoteCallLabelMarker";
  const r = {
    type: "gfmFootnoteCall",
    start: Object.assign({}, e[n + 3][1].start),
    end: Object.assign({}, e[e.length - 1][1].end)
  }, a = {
    type: "gfmFootnoteCallMarker",
    start: Object.assign({}, e[n + 3][1].end),
    end: Object.assign({}, e[n + 3][1].end)
  };
  a.end.column++, a.end.offset++, a.end._bufferIndex++;
  const o = {
    type: "gfmFootnoteCallString",
    start: Object.assign({}, a.end),
    end: Object.assign({}, e[e.length - 1][1].start)
  }, l = {
    type: "chunkString",
    contentType: "string",
    start: Object.assign({}, o.start),
    end: Object.assign({}, o.end)
  }, c = [
    // Take the `labelImageMarker` (now `data`, the `!`)
    e[n + 1],
    e[n + 2],
    ["enter", r, t],
    // The `[`
    e[n + 3],
    e[n + 4],
    // The `^`.
    ["enter", a, t],
    ["exit", a, t],
    // Everything in between.
    ["enter", o, t],
    ["enter", l, t],
    ["exit", l, t],
    ["exit", o, t],
    // The ending (`]`, properly parsed and labelled).
    e[e.length - 2],
    e[e.length - 1],
    ["exit", r, t]
  ];
  return e.splice(n, e.length - n + 1, ...c), e;
}
function VU(e, t, n) {
  const r = this, a = r.parser.gfmFootnotes || (r.parser.gfmFootnotes = []);
  let o = 0, l;
  return c;
  function c(g) {
    return e.enter("gfmFootnoteCall"), e.enter("gfmFootnoteCallLabelMarker"), e.consume(g), e.exit("gfmFootnoteCallLabelMarker"), d;
  }
  function d(g) {
    return g !== 94 ? n(g) : (e.enter("gfmFootnoteCallMarker"), e.consume(g), e.exit("gfmFootnoteCallMarker"), e.enter("gfmFootnoteCallString"), e.enter("chunkString").contentType = "string", h);
  }
  function h(g) {
    if (
      // Too long.
      o > 999 || // Closing brace with nothing.
      g === 93 && !l || // Space or tab is not supported by GFM for some reason.
      // `\n` and `[` not being supported makes sense.
      g === null || g === 91 || Bn(g)
    )
      return n(g);
    if (g === 93) {
      e.exit("chunkString");
      const x = e.exit("gfmFootnoteCallString");
      return a.includes(mo(r.sliceSerialize(x))) ? (e.enter("gfmFootnoteCallLabelMarker"), e.consume(g), e.exit("gfmFootnoteCallLabelMarker"), e.exit("gfmFootnoteCall"), t) : n(g);
    }
    return Bn(g) || (l = !0), o++, e.consume(g), g === 92 ? p : h;
  }
  function p(g) {
    return g === 91 || g === 92 || g === 93 ? (e.consume(g), o++, h) : h(g);
  }
}
function KU(e, t, n) {
  const r = this, a = r.parser.gfmFootnotes || (r.parser.gfmFootnotes = []);
  let o, l = 0, c;
  return d;
  function d(C) {
    return e.enter("gfmFootnoteDefinition")._container = !0, e.enter("gfmFootnoteDefinitionLabel"), e.enter("gfmFootnoteDefinitionLabelMarker"), e.consume(C), e.exit("gfmFootnoteDefinitionLabelMarker"), h;
  }
  function h(C) {
    return C === 94 ? (e.enter("gfmFootnoteDefinitionMarker"), e.consume(C), e.exit("gfmFootnoteDefinitionMarker"), e.enter("gfmFootnoteDefinitionLabelString"), e.enter("chunkString").contentType = "string", p) : n(C);
  }
  function p(C) {
    if (
      // Too long.
      l > 999 || // Closing brace with nothing.
      C === 93 && !c || // Space or tab is not supported by GFM for some reason.
      // `\n` and `[` not being supported makes sense.
      C === null || C === 91 || Bn(C)
    )
      return n(C);
    if (C === 93) {
      e.exit("chunkString");
      const N = e.exit("gfmFootnoteDefinitionLabelString");
      return o = mo(r.sliceSerialize(N)), e.enter("gfmFootnoteDefinitionLabelMarker"), e.consume(C), e.exit("gfmFootnoteDefinitionLabelMarker"), e.exit("gfmFootnoteDefinitionLabel"), x;
    }
    return Bn(C) || (c = !0), l++, e.consume(C), C === 92 ? g : p;
  }
  function g(C) {
    return C === 91 || C === 92 || C === 93 ? (e.consume(C), l++, p) : p(C);
  }
  function x(C) {
    return C === 58 ? (e.enter("definitionMarker"), e.consume(C), e.exit("definitionMarker"), a.includes(o) || a.push(o), dn(e, b, "gfmFootnoteDefinitionWhitespace")) : n(C);
  }
  function b(C) {
    return t(C);
  }
}
function YU(e, t, n) {
  return e.check(Rg, t, e.attempt(UU, t, n));
}
function WU(e) {
  e.exit("gfmFootnoteDefinition");
}
function XU(e, t, n) {
  const r = this;
  return dn(e, a, "gfmFootnoteDefinitionIndent", 5);
  function a(o) {
    const l = r.events[r.events.length - 1];
    return l && l[1].type === "gfmFootnoteDefinitionIndent" && l[2].sliceSerialize(l[1], !0).length === 4 ? t(o) : n(o);
  }
}
function QU(e) {
  let n = (e || {}).singleTilde;
  const r = {
    name: "strikethrough",
    tokenize: o,
    resolveAll: a
  };
  return n == null && (n = !0), {
    text: {
      126: r
    },
    insideSpan: {
      null: [r]
    },
    attentionMarkers: {
      null: [126]
    }
  };
  function a(l, c) {
    let d = -1;
    for (; ++d < l.length; )
      if (l[d][0] === "enter" && l[d][1].type === "strikethroughSequenceTemporary" && l[d][1]._close) {
        let h = d;
        for (; h--; )
          if (l[h][0] === "exit" && l[h][1].type === "strikethroughSequenceTemporary" && l[h][1]._open && // If the sizes are the same:
          l[d][1].end.offset - l[d][1].start.offset === l[h][1].end.offset - l[h][1].start.offset) {
            l[d][1].type = "strikethroughSequence", l[h][1].type = "strikethroughSequence";
            const p = {
              type: "strikethrough",
              start: Object.assign({}, l[h][1].start),
              end: Object.assign({}, l[d][1].end)
            }, g = {
              type: "strikethroughText",
              start: Object.assign({}, l[h][1].end),
              end: Object.assign({}, l[d][1].start)
            }, x = [["enter", p, c], ["enter", l[h][1], c], ["exit", l[h][1], c], ["enter", g, c]], b = c.parser.constructs.insideSpan.null;
            b && rs(x, x.length, 0, B1(b, l.slice(h + 1, d), c)), rs(x, x.length, 0, [["exit", g, c], ["enter", l[d][1], c], ["exit", l[d][1], c], ["exit", p, c]]), rs(l, h - 1, d - h + 3, x), d = h + x.length - 2;
            break;
          }
      }
    for (d = -1; ++d < l.length; )
      l[d][1].type === "strikethroughSequenceTemporary" && (l[d][1].type = "data");
    return l;
  }
  function o(l, c, d) {
    const h = this.previous, p = this.events;
    let g = 0;
    return x;
    function x(C) {
      return h === 126 && p[p.length - 1][1].type !== "characterEscape" ? d(C) : (l.enter("strikethroughSequenceTemporary"), b(C));
    }
    function b(C) {
      const N = Hh(h);
      if (C === 126)
        return g > 1 ? d(C) : (l.consume(C), g++, b);
      if (g < 2 && !n) return d(C);
      const T = l.exit("strikethroughSequenceTemporary"), j = Hh(C);
      return T._open = !j || j === 2 && !!N, T._close = !N || N === 2 && !!j, c(C);
    }
  }
}
class ZU {
  /**
   * Create a new edit map.
   */
  constructor() {
    this.map = [];
  }
  /**
   * Create an edit: a remove and/or add at a certain place.
   *
   * @param {number} index
   * @param {number} remove
   * @param {Array<Event>} add
   * @returns {undefined}
   */
  add(t, n, r) {
    JU(this, t, n, r);
  }
  // To do: add this when moving to `micromark`.
  // /**
  //  * Create an edit: but insert `add` before existing additions.
  //  *
  //  * @param {number} index
  //  * @param {number} remove
  //  * @param {Array<Event>} add
  //  * @returns {undefined}
  //  */
  // addBefore(index, remove, add) {
  //   addImplementation(this, index, remove, add, true)
  // }
  /**
   * Done, change the events.
   *
   * @param {Array<Event>} events
   * @returns {undefined}
   */
  consume(t) {
    if (this.map.sort(function(o, l) {
      return o[0] - l[0];
    }), this.map.length === 0)
      return;
    let n = this.map.length;
    const r = [];
    for (; n > 0; )
      n -= 1, r.push(t.slice(this.map[n][0] + this.map[n][1]), this.map[n][2]), t.length = this.map[n][0];
    r.push(t.slice()), t.length = 0;
    let a = r.pop();
    for (; a; ) {
      for (const o of a)
        t.push(o);
      a = r.pop();
    }
    this.map.length = 0;
  }
}
function JU(e, t, n, r) {
  let a = 0;
  if (!(n === 0 && r.length === 0)) {
    for (; a < e.map.length; ) {
      if (e.map[a][0] === t) {
        e.map[a][1] += n, e.map[a][2].push(...r);
        return;
      }
      a += 1;
    }
    e.map.push([t, n, r]);
  }
}
function e$(e, t) {
  let n = !1;
  const r = [];
  for (; t < e.length; ) {
    const a = e[t];
    if (n) {
      if (a[0] === "enter")
        a[1].type === "tableContent" && r.push(e[t + 1][1].type === "tableDelimiterMarker" ? "left" : "none");
      else if (a[1].type === "tableContent") {
        if (e[t - 1][1].type === "tableDelimiterMarker") {
          const o = r.length - 1;
          r[o] = r[o] === "left" ? "center" : "right";
        }
      } else if (a[1].type === "tableDelimiterRow")
        break;
    } else a[0] === "enter" && a[1].type === "tableDelimiterRow" && (n = !0);
    t += 1;
  }
  return r;
}
function t$() {
  return {
    flow: {
      null: {
        name: "table",
        tokenize: n$,
        resolveAll: r$
      }
    }
  };
}
function n$(e, t, n) {
  const r = this;
  let a = 0, o = 0, l;
  return c;
  function c(X) {
    let K = r.events.length - 1;
    for (; K > -1; ) {
      const H = r.events[K][1].type;
      if (H === "lineEnding" || // Note: markdown-rs uses `whitespace` instead of `linePrefix`
      H === "linePrefix") K--;
      else break;
    }
    const V = K > -1 ? r.events[K][1].type : null, de = V === "tableHead" || V === "tableRow" ? D : d;
    return de === D && r.parser.lazy[r.now().line] ? n(X) : de(X);
  }
  function d(X) {
    return e.enter("tableHead"), e.enter("tableRow"), h(X);
  }
  function h(X) {
    return X === 124 || (l = !0, o += 1), p(X);
  }
  function p(X) {
    return X === null ? n(X) : jt(X) ? o > 1 ? (o = 0, r.interrupt = !0, e.exit("tableRow"), e.enter("lineEnding"), e.consume(X), e.exit("lineEnding"), b) : n(X) : tn(X) ? dn(e, p, "whitespace")(X) : (o += 1, l && (l = !1, a += 1), X === 124 ? (e.enter("tableCellDivider"), e.consume(X), e.exit("tableCellDivider"), l = !0, p) : (e.enter("data"), g(X)));
  }
  function g(X) {
    return X === null || X === 124 || Bn(X) ? (e.exit("data"), p(X)) : (e.consume(X), X === 92 ? x : g);
  }
  function x(X) {
    return X === 92 || X === 124 ? (e.consume(X), g) : g(X);
  }
  function b(X) {
    return r.interrupt = !1, r.parser.lazy[r.now().line] ? n(X) : (e.enter("tableDelimiterRow"), l = !1, tn(X) ? dn(e, C, "linePrefix", r.parser.constructs.disable.null.includes("codeIndented") ? void 0 : 4)(X) : C(X));
  }
  function C(X) {
    return X === 45 || X === 58 ? T(X) : X === 124 ? (l = !0, e.enter("tableCellDivider"), e.consume(X), e.exit("tableCellDivider"), N) : q(X);
  }
  function N(X) {
    return tn(X) ? dn(e, T, "whitespace")(X) : T(X);
  }
  function T(X) {
    return X === 58 ? (o += 1, l = !0, e.enter("tableDelimiterMarker"), e.consume(X), e.exit("tableDelimiterMarker"), j) : X === 45 ? (o += 1, j(X)) : X === null || jt(X) ? z(X) : q(X);
  }
  function j(X) {
    return X === 45 ? (e.enter("tableDelimiterFiller"), R(X)) : q(X);
  }
  function R(X) {
    return X === 45 ? (e.consume(X), R) : X === 58 ? (l = !0, e.exit("tableDelimiterFiller"), e.enter("tableDelimiterMarker"), e.consume(X), e.exit("tableDelimiterMarker"), A) : (e.exit("tableDelimiterFiller"), A(X));
  }
  function A(X) {
    return tn(X) ? dn(e, z, "whitespace")(X) : z(X);
  }
  function z(X) {
    return X === 124 ? C(X) : X === null || jt(X) ? !l || a !== o ? q(X) : (e.exit("tableDelimiterRow"), e.exit("tableHead"), t(X)) : q(X);
  }
  function q(X) {
    return n(X);
  }
  function D(X) {
    return e.enter("tableRow"), P(X);
  }
  function P(X) {
    return X === 124 ? (e.enter("tableCellDivider"), e.consume(X), e.exit("tableCellDivider"), P) : X === null || jt(X) ? (e.exit("tableRow"), t(X)) : tn(X) ? dn(e, P, "whitespace")(X) : (e.enter("data"), re(X));
  }
  function re(X) {
    return X === null || X === 124 || Bn(X) ? (e.exit("data"), P(X)) : (e.consume(X), X === 92 ? ie : re);
  }
  function ie(X) {
    return X === 92 || X === 124 ? (e.consume(X), re) : re(X);
  }
}
function r$(e, t) {
  let n = -1, r = !0, a = 0, o = [0, 0, 0, 0], l = [0, 0, 0, 0], c = !1, d = 0, h, p, g;
  const x = new ZU();
  for (; ++n < e.length; ) {
    const b = e[n], C = b[1];
    b[0] === "enter" ? C.type === "tableHead" ? (c = !1, d !== 0 && (nE(x, t, d, h, p), p = void 0, d = 0), h = {
      type: "table",
      start: Object.assign({}, C.start),
      // Note: correct end is set later.
      end: Object.assign({}, C.end)
    }, x.add(n, 0, [["enter", h, t]])) : C.type === "tableRow" || C.type === "tableDelimiterRow" ? (r = !0, g = void 0, o = [0, 0, 0, 0], l = [0, n + 1, 0, 0], c && (c = !1, p = {
      type: "tableBody",
      start: Object.assign({}, C.start),
      // Note: correct end is set later.
      end: Object.assign({}, C.end)
    }, x.add(n, 0, [["enter", p, t]])), a = C.type === "tableDelimiterRow" ? 2 : p ? 3 : 1) : a && (C.type === "data" || C.type === "tableDelimiterMarker" || C.type === "tableDelimiterFiller") ? (r = !1, l[2] === 0 && (o[1] !== 0 && (l[0] = l[1], g = Dy(x, t, o, a, void 0, g), o = [0, 0, 0, 0]), l[2] = n)) : C.type === "tableCellDivider" && (r ? r = !1 : (o[1] !== 0 && (l[0] = l[1], g = Dy(x, t, o, a, void 0, g)), o = l, l = [o[1], n, 0, 0])) : C.type === "tableHead" ? (c = !0, d = n) : C.type === "tableRow" || C.type === "tableDelimiterRow" ? (d = n, o[1] !== 0 ? (l[0] = l[1], g = Dy(x, t, o, a, n, g)) : l[1] !== 0 && (g = Dy(x, t, l, a, n, g)), a = 0) : a && (C.type === "data" || C.type === "tableDelimiterMarker" || C.type === "tableDelimiterFiller") && (l[3] = n);
  }
  for (d !== 0 && nE(x, t, d, h, p), x.consume(t.events), n = -1; ++n < t.events.length; ) {
    const b = t.events[n];
    b[0] === "enter" && b[1].type === "table" && (b[1]._align = e$(t.events, n));
  }
  return e;
}
function Dy(e, t, n, r, a, o) {
  const l = r === 1 ? "tableHeader" : r === 2 ? "tableDelimiter" : "tableData", c = "tableContent";
  n[0] !== 0 && (o.end = Object.assign({}, Ih(t.events, n[0])), e.add(n[0], 0, [["exit", o, t]]));
  const d = Ih(t.events, n[1]);
  if (o = {
    type: l,
    start: Object.assign({}, d),
    // Note: correct end is set later.
    end: Object.assign({}, d)
  }, e.add(n[1], 0, [["enter", o, t]]), n[2] !== 0) {
    const h = Ih(t.events, n[2]), p = Ih(t.events, n[3]), g = {
      type: c,
      start: Object.assign({}, h),
      end: Object.assign({}, p)
    };
    if (e.add(n[2], 0, [["enter", g, t]]), r !== 2) {
      const x = t.events[n[2]], b = t.events[n[3]];
      if (x[1].end = Object.assign({}, b[1].end), x[1].type = "chunkText", x[1].contentType = "text", n[3] > n[2] + 1) {
        const C = n[2] + 1, N = n[3] - n[2] - 1;
        e.add(C, N, []);
      }
    }
    e.add(n[3] + 1, 0, [["exit", g, t]]);
  }
  return a !== void 0 && (o.end = Object.assign({}, Ih(t.events, a)), e.add(a, 0, [["exit", o, t]]), o = void 0), o;
}
function nE(e, t, n, r, a) {
  const o = [], l = Ih(t.events, n);
  a && (a.end = Object.assign({}, l), o.push(["exit", a, t])), r.end = Object.assign({}, l), o.push(["exit", r, t]), e.add(n + 1, 0, o);
}
function Ih(e, t) {
  const n = e[t], r = n[0] === "enter" ? "start" : "end";
  return n[1][r];
}
const i$ = {
  name: "tasklistCheck",
  tokenize: s$
};
function a$() {
  return {
    text: {
      91: i$
    }
  };
}
function s$(e, t, n) {
  const r = this;
  return a;
  function a(d) {
    return (
      // Exit if theres stuff before.
      r.previous !== null || // Exit if not in the first content that is the first child of a list
      // item.
      !r._gfmTasklistFirstContentOfListItem ? n(d) : (e.enter("taskListCheck"), e.enter("taskListCheckMarker"), e.consume(d), e.exit("taskListCheckMarker"), o)
    );
  }
  function o(d) {
    return Bn(d) ? (e.enter("taskListCheckValueUnchecked"), e.consume(d), e.exit("taskListCheckValueUnchecked"), l) : d === 88 || d === 120 ? (e.enter("taskListCheckValueChecked"), e.consume(d), e.exit("taskListCheckValueChecked"), l) : n(d);
  }
  function l(d) {
    return d === 93 ? (e.enter("taskListCheckMarker"), e.consume(d), e.exit("taskListCheckMarker"), e.exit("taskListCheck"), c) : n(d);
  }
  function c(d) {
    return jt(d) ? t(d) : tn(d) ? e.check({
      tokenize: o$
    }, t, n)(d) : n(d);
  }
}
function o$(e, t, n) {
  return dn(e, r, "whitespace");
  function r(a) {
    return a === null ? n(a) : t(a);
  }
}
function l$(e) {
  return r9([
    OU(),
    $U(),
    QU(e),
    t$(),
    a$()
  ]);
}
const u$ = {};
function c$(e) {
  const t = (
    /** @type {Processor<Root>} */
    this
  ), n = e || u$, r = t.data(), a = r.micromarkExtensions || (r.micromarkExtensions = []), o = r.fromMarkdownExtensions || (r.fromMarkdownExtensions = []), l = r.toMarkdownExtensions || (r.toMarkdownExtensions = []);
  a.push(l$(n)), o.push(TU()), l.push(AU(n));
}
const f$ = "Engram_project";
function d$() {
  var e, t;
  try {
    if (typeof window.getRequestHeaders == "function")
      return window.getRequestHeaders();
    const n = (t = (e = window.SillyTavern) == null ? void 0 : e.getContext) == null ? void 0 : t.call(e);
    if (n != null && n.getRequestHeaders)
      return n.getRequestHeaders();
  } catch (n) {
    console.warn("[Engram] ", n);
  }
  return {
    "Content-Type": "application/json"
  };
}
async function h$() {
  try {
    const e = d$(), t = await fetch("/api/extensions/update", {
      method: "POST",
      headers: {
        ...e,
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        extensionName: f$,
        global: !1
        // Engram 
      })
    });
    if (!t.ok)
      return { success: !1, message: await t.text() || t.statusText };
    const n = await t.json();
    return n.isUpToDate ? { success: !0, message: "", isUpToDate: !0 } : {
      success: !0,
      message: `: ${n.shortCommitHash || "latest"}`,
      isUpToDate: !1
    };
  } catch (e) {
    return console.error("[Engram] :", e), { success: !1, message: String(e) };
  }
}
const m$ = ({ isOpen: e, onClose: t }) => {
  const [n, r] = G.useState(!0), [a, o] = G.useState(null), [l, c] = G.useState(null), [d, h] = G.useState(!1), [p, g] = G.useState(!1), [x, b] = G.useState(!1), [C, N] = G.useState(null), T = mc.getCurrentVersion();
  G.useEffect(() => {
    e && (j(), N(null));
  }, [e]);
  const j = async () => {
    r(!0);
    try {
      const [q, D, P] = await Promise.all([
        mc.getLatestVersion(),
        mc.getChangelog(),
        mc.hasUpdate()
      ]);
      o(q), c(D), h(P);
    } catch (q) {
      console.error("[Engram] ", q);
    } finally {
      r(!1);
    }
  }, R = async () => {
    g(!0);
    try {
      const q = a || T;
      console.debug("[Engram] Marking update as read:", q), await mc.markAsRead(q), t();
    } finally {
      g(!1);
    }
  }, A = async () => {
    b(!0), N(null);
    try {
      const q = await h$();
      q.success && !q.isUpToDate ? (N(" 2 ..."), a && await mc.markAsRead(a), setTimeout(() => {
        window.location.reload();
      }, 2e3)) : q.isUpToDate ? (N(""), h(!1)) : N(`: ${q.message}`);
    } catch (q) {
      N(`: ${String(q)}`);
    } finally {
      b(!1);
    }
  }, z = () => {
    mc.clearCache(), j();
  };
  return e ? /* @__PURE__ */ m.jsxs("div", { className: "fixed inset-0 z-[100] flex items-center justify-center p-4", children: [
    /* @__PURE__ */ m.jsx(
      "div",
      {
        className: "absolute inset-0 bg-black/60 backdrop-blur-sm",
        onClick: t
      }
    ),
    /* @__PURE__ */ m.jsxs("div", { className: "relative bg-card border border-border rounded-xl shadow-2xl w-full max-w-lg max-h-[80vh] flex flex-col overflow-hidden animate-in zoom-in-95 duration-200", children: [
      /* @__PURE__ */ m.jsxs("div", { className: "flex items-center justify-between px-5 py-4 border-b border-border/50", children: [
        /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-3", children: [
          /* @__PURE__ */ m.jsx("div", { className: "w-8 h-8 rounded-lg bg-primary/10 flex items-center justify-center", children: /* @__PURE__ */ m.jsx(ig, { size: 16, className: "text-primary" }) }),
          /* @__PURE__ */ m.jsxs("div", { children: [
            /* @__PURE__ */ m.jsx("h2", { className: "text-base font-semibold text-foreground", children: "" }),
            /* @__PURE__ */ m.jsxs("p", { className: "text-xs text-muted-foreground", children: [
              ": v",
              T
            ] })
          ] })
        ] }),
        /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-2", children: [
          /* @__PURE__ */ m.jsx(
            "button",
            {
              onClick: z,
              className: "p-2 rounded-lg hover:bg-muted/50 text-muted-foreground hover:text-foreground transition-colors",
              title: "",
              children: /* @__PURE__ */ m.jsx(zr, { size: 16, className: n ? "animate-spin" : "" })
            }
          ),
          /* @__PURE__ */ m.jsx(
            "button",
            {
              onClick: t,
              className: "p-2 rounded-lg hover:bg-muted/50 text-muted-foreground hover:text-foreground transition-colors",
              children: /* @__PURE__ */ m.jsx(tm, { size: 16 })
            }
          )
        ] })
      ] }),
      /* @__PURE__ */ m.jsx("div", { className: "flex-1 overflow-y-auto p-5", children: n ? /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col items-center justify-center py-12 text-muted-foreground", children: [
        /* @__PURE__ */ m.jsx(zr, { size: 24, className: "animate-spin mb-3" }),
        /* @__PURE__ */ m.jsx("p", { className: "text-sm", children: "..." })
      ] }) : /* @__PURE__ */ m.jsxs("div", { className: "space-y-4", children: [
        /* @__PURE__ */ m.jsx("div", { className: `
                                p-4 rounded-lg border
                                ${d ? "bg-primary/5 border-primary/20" : "bg-green-500/5 border-green-500/20"}
                            `, children: /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-3", children: [
          d ? /* @__PURE__ */ m.jsx(ig, { size: 20, className: "text-primary" }) : /* @__PURE__ */ m.jsx(pS, { size: 20, className: "text-green-500" }),
          /* @__PURE__ */ m.jsxs("div", { className: "flex-1", children: [
            /* @__PURE__ */ m.jsx("p", { className: "font-medium text-foreground", children: d ? `: v${a}` : "" }),
            /* @__PURE__ */ m.jsx("p", { className: "text-xs text-muted-foreground mt-0.5", children: d ? "" : "" })
          ] })
        ] }) }),
        C && /* @__PURE__ */ m.jsx("div", { className: `
                                    p-3 rounded-lg text-sm
                                    ${C.includes("") ? "bg-green-500/10 text-green-600 border border-green-500/20" : C.includes("") || C.includes("") ? "bg-red-500/10 text-red-600 border border-red-500/20" : "bg-muted/30 text-muted-foreground"}
                                `, children: C }),
        l && /* @__PURE__ */ m.jsxs("div", { className: "space-y-2", children: [
          /* @__PURE__ */ m.jsx("h3", { className: "text-xs font-medium text-muted-foreground uppercase tracking-wider", children: "" }),
          /* @__PURE__ */ m.jsx("div", { className: "bg-muted/20 rounded-lg p-4 max-h-64 overflow-y-auto engram-changelog-content text-sm", children: /* @__PURE__ */ m.jsx(QB, { remarkPlugins: [c$], children: l }) })
        ] }),
        !l && !n && /* @__PURE__ */ m.jsx("div", { className: "text-center py-8 text-muted-foreground", children: /* @__PURE__ */ m.jsx("p", { className: "text-sm", children: "" }) })
      ] }) }),
      /* @__PURE__ */ m.jsxs("div", { className: "px-5 py-4 border-t border-border/50 flex justify-end gap-3", children: [
        /* @__PURE__ */ m.jsx(
          "button",
          {
            onClick: t,
            className: "px-4 py-2 text-sm text-muted-foreground hover:text-foreground transition-colors",
            children: ""
          }
        ),
        d && /* @__PURE__ */ m.jsxs(m.Fragment, { children: [
          /* @__PURE__ */ m.jsx(
            "button",
            {
              onClick: R,
              disabled: p || x,
              className: "px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg transition-colors disabled:opacity-50",
              children: ""
            }
          ),
          /* @__PURE__ */ m.jsx(
            "button",
            {
              onClick: A,
              disabled: x || p,
              className: "px-4 py-2 text-sm bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50 flex items-center gap-2",
              children: x ? /* @__PURE__ */ m.jsxs(m.Fragment, { children: [
                /* @__PURE__ */ m.jsx(au, { size: 14, className: "animate-spin" }),
                "..."
              ] }) : /* @__PURE__ */ m.jsxs(m.Fragment, { children: [
                /* @__PURE__ */ m.jsx(ig, { size: 14 }),
                ""
              ] })
            }
          )
        ] })
      ] })
    ] })
  ] }) : null;
}, p$ = ({ children: e, activeTab: t, setActiveTab: n, onClose: r }) => {
  const [a, o] = G.useState(!1), [l, c] = G.useState(!1), [d, h] = G.useState(!1);
  G.useEffect(() => {
    (async () => {
      try {
        const b = await mc.hasUnreadUpdate();
        h(b);
      } catch (b) {
        console.debug("[Engram] ", b);
      }
    })();
  }, []);
  const p = () => {
    c(!0);
  }, g = () => {
    c(!1), h(!1);
  };
  return /* @__PURE__ */ m.jsxs("div", { className: "flex absolute inset-0 w-full h-full bg-background text-foreground overflow-hidden font-sans selection:bg-primary/30 selection:text-primary animate-in fade-in duration-300", id: "engram-layout-root", children: [
    /* @__PURE__ */ m.jsx(bO, {}),
    /* @__PURE__ */ m.jsx(
      m$,
      {
        isOpen: l,
        onClose: g
      }
    ),
    /* @__PURE__ */ m.jsx(
      hC,
      {
        activeTab: t,
        onNavigate: n,
        isMobile: !1,
        onShowUpdateNotice: p,
        hasUnreadUpdate: d
      }
    ),
    /* @__PURE__ */ m.jsx(
      hC,
      {
        activeTab: t,
        onNavigate: n,
        isMobile: !0,
        isOpen: a,
        onClose: () => o(!1),
        onShowUpdateNotice: p,
        hasUnreadUpdate: d
      }
    ),
    /* @__PURE__ */ m.jsxs("div", { className: "flex flex-1 flex-col overflow-hidden", children: [
      /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col flex-shrink-0 border-b border-border bg-sidebar/95 backdrop-blur z-50 transition-all duration-300", children: [
        /* @__PURE__ */ m.jsx(
          PI,
          {
            onToggleSidebar: () => o(!a),
            isMobile: !1,
            onClose: r,
            onNavigate: (x) => n(x.replace("/", ""))
          }
        ),
        /* @__PURE__ */ m.jsx("div", { id: "engram-header-extension", className: "z-40 flex-shrink-0 bg-transparent transition-all empty:hidden" })
      ] }),
      /* @__PURE__ */ m.jsx("main", { className: "flex-1 flex flex-col relative w-full overflow-hidden bg-background", children: /* @__PURE__ */ m.jsx("div", { className: "flex-1 overflow-y-auto overflow-x-hidden pt-0 px-4 pb-4 md:px-8 md:pb-8 lg:px-12 lg:pb-12 scroll-smooth animate-blur-in fill-mode-both", style: { animationDelay: "200ms", animationFillMode: "both" }, children: /* @__PURE__ */ m.jsx("div", { className: "max-w-6xl mx-auto min-h-full pb-20", children: e }) }) })
    ] }),
    "  "
  ] });
}, al = {
  primary: "#FFFFFF",
  grid: "#111111"
}, g$ = ({ onComplete: e }) => {
  const t = G.useRef(null), n = G.useRef(null), r = G.useRef(null), a = G.useRef(null), [o, l] = G.useState(!1);
  G.useEffect(() => {
    if (window.gsap) {
      l(!0);
      return;
    }
    const d = document.createElement("script");
    d.src = "https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js", d.async = !0, d.onload = () => l(!0), document.body.appendChild(d);
  }, []);
  const c = () => {
    var b;
    if (!o || !n.current) return;
    const d = window.gsap, h = n.current, p = h.getTotalLength();
    d.set(h, {
      strokeDasharray: p,
      strokeDashoffset: p,
      stroke: al.primary,
      fillOpacity: 0,
      opacity: 1,
      strokeWidth: 2
    });
    const g = (b = r.current) == null ? void 0 : b.querySelectorAll("path");
    g && d.set(g, { opacity: 0, y: 10 }), d.set(a.current, { scale: 1, opacity: 1 }), d.set(t.current, { opacity: 1 });
    const x = d.timeline({
      onComplete: () => {
        d.to(t.current, {
          opacity: 0,
          duration: 0.8,
          ease: "power2.out",
          onComplete: e
        });
      }
    });
    x.to(h, {
      strokeDashoffset: 0,
      duration: 2.5,
      ease: "power2.inOut"
    }), g && x.to(g, {
      opacity: 1,
      y: 0,
      duration: 1.2,
      stagger: 0.08,
      ease: "power3.out"
    }, "-=0.8"), x.to({}, { duration: 1 });
  };
  return G.useEffect(() => {
    if (o) {
      const d = setTimeout(c, 800);
      return () => clearTimeout(d);
    }
  }, [o]), /* @__PURE__ */ m.jsxs(
    "div",
    {
      ref: t,
      className: "fixed inset-0 z-[200] flex flex-col items-center justify-center bg-black overflow-hidden",
      style: { touchAction: "none" },
      children: [
        /* @__PURE__ */ m.jsx(
          "div",
          {
            className: "absolute inset-0 pointer-events-none",
            style: {
              backgroundImage: `
                        linear-gradient(to right, ${al.grid} 1px, transparent 1px),
                        linear-gradient(to bottom, ${al.grid} 1px, transparent 1px)
                    `,
              backgroundSize: "40px 40px",
              opacity: 0.3
            }
          }
        ),
        /* @__PURE__ */ m.jsx(
          "div",
          {
            className: "absolute inset-0 pointer-events-none",
            style: { background: "radial-gradient(circle at center, transparent 0%, black 100%)", opacity: 0.9 }
          }
        ),
        /* @__PURE__ */ m.jsxs("div", { className: "z-10 relative flex flex-col items-center justify-center w-full h-full p-4", children: [
          /* @__PURE__ */ m.jsx("div", { className: "w-full max-w-[600px] md:max-w-[800px] aspect-[4/3]", children: /* @__PURE__ */ m.jsx(
            "svg",
            {
              version: "1.1",
              xmlns: "http://www.w3.org/2000/svg",
              viewBox: "250 0 550 600",
              className: "w-full h-full overflow-visible",
              children: /* @__PURE__ */ m.jsxs("g", { ref: a, className: "origin-center", children: [
                /* @__PURE__ */ m.jsx(
                  "path",
                  {
                    ref: n,
                    fill: "none",
                    stroke: al.primary,
                    strokeWidth: "2",
                    strokeLinecap: "round",
                    strokeLinejoin: "round",
                    d: "M463.360840,364.455627 C437.246704,381.338409 406.466644,366.209045 404.026672,335.650848 C402.910156,321.667206 412.549713,306.544678 426.813293,300.633850 C430.474335,299.116699 431.826355,297.290924 431.760071,293.302460 C431.519287,278.808716 431.584564,264.307892 431.718292,249.811417 C431.748169,246.574463 430.886292,244.713684 427.681274,243.389038 C412.366425,237.059357 404.237366,225.144638 404.208862,208.867447 C404.179871,192.298615 412.621979,180.486938 428.224701,174.293686 C430.850494,173.251419 431.710938,171.751862 431.696136,169.060089 C431.613586,154.062912 431.568054,139.064117 431.723419,124.068092 C431.759430,120.590492 430.119568,119.052467 427.243103,117.790627 C413.349915,111.695946 405.841095,101.009903 404.195740,85.916542 C402.099884,66.690948 418.566650,47.364159 437.884277,46.682220 C456.888519,46.011345 468.064789,52.989845 476.252197,70.840332 C477.174438,72.851059 478.313995,73.541710 480.422974,73.516098 C499.569031,73.283493 518.722961,73.393646 537.862915,73.456795 C545.529785,73.482086 549.225952,71.767975 552.791809,64.663139 C559.898376,50.503635 576.618042,43.921410 592.447876,47.234680 C608.699890,50.636322 619.276489,62.116261 621.438904,78.701805 C623.839478,97.113228 612.679382,114.371338 595.357910,119.034004 C577.219604,123.916542 558.125427,115.204048 550.887390,98.365906 C549.251465,94.560234 547.316284,93.116508 543.150696,93.160004 C522.989380,93.370483 502.824707,93.284561 482.661285,93.261726 C479.716156,93.258385 477.395905,93.379341 475.956635,96.902077 C474.571899,100.291283 475.702576,102.070137 477.892181,104.225159 C501.524139,127.483910 525.127991,150.771423 548.653259,174.137985 C550.803162,176.273376 552.520325,176.380997 555.207153,175.171799 C569.642334,168.675354 583.205750,171.177368 594.759277,181.252563 C606.783813,191.738449 610.379395,205.504944 605.248840,220.725037 C600.321167,235.343246 589.568848,243.345337 574.305420,245.467117 C567.655396,246.391541 561.334045,245.373352 555.347839,242.591797 C552.373169,241.209595 550.274536,241.303284 547.832886,243.728531 C524.197693,267.205322 500.499634,290.619415 476.704651,313.934174 C474.165771,316.421844 475.106598,318.487793 476.015411,321.059723 C476.869354,323.476318 478.159149,324.356232 480.796143,324.332367 C501.456360,324.145294 522.118530,324.019531 542.778870,324.122131 C546.987793,324.143005 549.216675,322.931549 551.044983,318.871887 C558.230042,302.918091 576.073181,294.652069 593.497131,298.684143 C610.451355,302.607544 622.335205,317.668091 622.119812,334.958160 C621.900024,352.608002 609.316650,367.564362 591.822144,370.969543 C574.585754,374.324463 557.004028,364.861755 550.521484,348.456757 C549.268677,345.286346 547.631836,344.200745 544.294861,344.220337 C523.465576,344.342865 502.634888,344.322540 481.805359,344.218109 C478.697174,344.202545 476.993927,345.152252 475.888916,348.205902 C473.513214,354.771179 469.417969,360.183167 463.360840,364.455627 M472.733368,188.880936 C473.545441,190.333145 474.799072,191.702774 475.088898,193.252655 C476.058929,198.439468 479.434326,198.919983 483.888489,198.861130 C499.042145,198.660889 514.201233,198.707901 529.355957,198.872879 C532.819580,198.910583 534.700989,197.913788 536.177185,194.588806 C537.657104,191.255417 536.060120,189.735016 534.097900,187.805573 C510.706268,164.804840 487.354065,141.764008 463.949341,118.776604 C462.445251,117.299316 461.277863,114.441566 458.282349,116.423027 C455.343719,118.366882 451.028107,118.406143 451.180542,123.994591 C451.584534,138.807007 451.429443,153.638779 451.250458,168.459885 C451.208984,171.894135 452.474548,173.487930 455.559784,174.673798 C462.566864,177.367126 468.343140,181.758774 472.733368,188.880936 M457.308807,300.958954 C460.540070,302.823181 462.218414,300.310028 464.063263,298.488586 C487.164032,275.681519 510.248199,252.857559 533.326538,230.027756 C535.300171,228.075378 537.458679,226.516449 535.970032,222.843750 C534.495117,219.205124 532.067688,218.878906 528.898010,218.890778 C513.414001,218.948746 497.929138,219.002151 482.445862,218.887329 C478.998230,218.861771 477.090668,219.941055 475.670502,223.284790 C471.742218,232.533905 465.159332,239.474701 455.665497,243.103836 C452.239746,244.413376 451.216278,246.302231 451.253540,249.781387 C451.406891,264.098541 451.489380,278.421356 451.223358,292.735107 C451.142975,297.059998 452.224640,299.783386 457.308807,300.958954 z"
                  }
                ),
                /* @__PURE__ */ m.jsxs("g", { ref: r, children: [
                  /* @__PURE__ */ m.jsx("path", { fill: al.primary, d: "M732.215698,483.876190 C732.750061,488.775055 731.110779,490.523590 726.372742,490.479736 C713.642639,490.361908 713.645874,490.566711 713.641113,477.834442 C713.638428,470.668732 713.788818,463.497284 713.552246,456.338928 C713.318970,449.278015 710.633911,445.451111 705.788818,444.403778 C698.667542,442.864441 692.689270,447.076904 692.324463,454.647736 C691.851685,464.458313 691.862549,474.305084 692.048706,484.128967 C692.137085,488.792786 690.778625,490.578705 685.827454,490.500549 C672.843933,490.295532 672.845886,490.510315 672.820435,477.502625 C672.805786,470.003754 672.887146,462.502136 672.708618,455.006927 C672.557556,448.666412 669.519653,444.981689 664.341858,444.320343 C658.234436,443.540314 653.997803,446.541077 652.162415,452.864807 C651.503052,455.136719 651.331299,457.435608 651.335754,459.781158 C651.352234,468.446747 651.306274,477.112488 651.338745,485.777985 C651.348389,488.341766 651.062439,490.138977 647.717529,490.447815 C632.733521,491.831421 632.748596,491.913239 632.764404,477.031830 C632.778870,463.366852 632.738831,449.701782 632.731445,436.036774 C632.727478,428.732941 632.735718,428.732544 640.257812,428.707031 C641.591003,428.702484 642.924194,428.695312 644.257324,428.701721 C647.429321,428.717010 651.058289,427.916016 650.925598,433.229431 C655.308960,431.486603 658.595154,429.192383 662.595154,428.377930 C670.453491,426.777832 677.619019,428.117981 683.735718,433.181641 C686.512207,435.480164 688.239807,435.373474 690.953918,433.250153 C697.176208,428.382202 704.485840,426.832367 712.194946,428.080414 C725.100098,430.169739 731.944641,439.074829 732.175659,453.896454 C732.328857,463.726379 732.212036,473.560547 732.215698,483.876190 z" }),
                  /* @__PURE__ */ m.jsx("path", { fill: al.primary, d: "M487.575867,485.935303 C487.614716,484.616028 487.614716,483.640503 487.614716,481.796417 C479.116760,488.238525 470.153107,489.257660 460.718079,486.787720 C454.401794,485.134186 449.163879,481.675842 445.200134,476.457642 C436.960876,465.610748 437.295532,448.722229 445.889771,438.315796 C455.451538,426.737823 470.295227,425.042450 488.444458,433.733826 C487.913239,428.612457 491.194366,428.604004 494.772766,428.684540 C508.272736,428.988373 506.179840,426.849945 506.294434,440.421967 C506.411133,454.245575 506.366882,468.071228 506.299957,481.895538 C506.205750,501.359833 494.742065,512.847900 475.259460,513.370544 C465.272614,513.638489 455.717651,512.255005 446.682343,507.725311 C443.034790,505.896667 441.336151,503.847290 444.229065,500.105438 C444.329590,499.975464 444.390869,499.814941 444.469086,499.667908 C448.861603,491.411743 448.894196,491.340729 457.207886,495.157196 C463.352356,497.977905 469.817169,498.376801 476.285126,497.456818 C482.543640,496.566620 486.238434,492.476532 487.575867,485.935303 M469.264740,471.577881 C471.084900,471.642700 472.915710,471.865356 474.723328,471.743805 C481.074341,471.316620 486.258820,466.628052 487.489288,460.346558 C488.669373,454.322296 485.713593,448.118378 480.288971,445.234039 C472.426056,441.053253 462.868591,443.867035 459.399658,451.384033 C455.705688,459.388580 459.382996,467.492737 469.264740,471.577881 z" }),
                  /* @__PURE__ */ m.jsx("path", { fill: al.primary, d: "M350.790619,410.644409 C354.007477,410.561554 355.147522,411.945587 355.144592,414.620361 C355.128937,428.846375 356.152588,426.165161 344.558044,426.338898 C335.900940,426.468628 327.237854,426.493591 318.582581,426.315826 C314.804382,426.238220 313.157715,427.376373 313.262451,431.424896 C313.571655,443.375275 312.019470,441.570435 323.204529,441.691742 C330.530579,441.771271 337.860626,441.831665 345.183899,441.671692 C348.853607,441.591553 350.203705,443.056824 350.190338,446.675842 C350.143219,459.433014 350.725433,457.207275 340.024445,457.368561 C332.865692,457.476471 325.700195,457.536346 318.545349,457.339996 C314.731018,457.235291 313.250702,458.478516 313.234222,462.478668 C313.185364,474.308960 313.038177,474.321259 324.813477,474.130890 C334.298523,473.977539 343.772430,475.169159 353.264343,474.338776 C354.864075,474.198792 356.466827,474.576569 356.702301,476.439850 C357.203217,480.403656 357.364838,484.405273 356.646729,488.365631 C356.297211,490.293060 354.652405,490.369568 353.118927,490.370575 C334.801880,490.382568 316.484711,490.350647 298.167847,490.412506 C295.104187,490.422852 294.024323,488.921082 294.024200,486.130402 C294.023224,462.484924 294.047699,438.839325 293.967896,415.194092 C293.954620,411.261261 296.028046,410.593658 299.359711,410.610138 C316.344330,410.694275 333.329620,410.638672 350.790619,410.644409 z" }),
                  /* @__PURE__ */ m.jsx("path", { fill: al.primary, d: "M620.003906,453.402435 C620.062195,464.023071 619.882812,474.188721 620.189575,484.339661 C620.338318,489.262421 618.431458,490.973572 613.757507,490.452362 C611.783386,490.232208 609.754700,490.291412 607.767883,490.444916 C604.889648,490.667267 602.478821,490.168823 601.296570,486.513000 C594.831909,490.991821 587.888184,491.843719 580.600464,491.328247 C565.916626,490.289642 557.201233,476.053131 563.502625,463.374390 C565.502930,459.349640 568.872803,457.136932 572.794861,455.506927 C578.118103,453.294647 583.702881,452.709900 589.425354,452.731232 C592.879822,452.744110 596.387085,453.235260 599.791443,452.317169 C599.855774,446.843750 597.260681,443.903503 591.552673,443.177338 C585.446533,442.400513 579.495911,443.228607 574.179382,446.386688 C570.948853,448.305603 569.535645,447.214966 568.011658,444.340485 C563.043945,434.970917 563.058899,434.663818 573.199219,430.800537 C582.143921,427.392792 591.347961,426.734100 600.678101,428.904358 C613.358643,431.853943 619.173157,440.405762 620.003906,453.402435 M582.869263,466.083313 C579.496887,469.605530 579.013306,473.431427 581.947998,475.906952 C585.513611,478.914764 589.714966,478.291107 593.721985,477.031647 C597.412354,475.871704 599.990784,473.365112 600.658081,469.369629 C601.070496,466.900665 600.409729,465.044220 597.411255,465.098297 C592.800171,465.181488 588.157471,464.530182 582.869263,466.083313 z" }),
                  /* @__PURE__ */ m.jsx("path", { fill: al.primary, d: "M410.915314,457.280090 C410.311127,447.930115 406.925934,444.198608 399.452026,444.194855 C391.667114,444.190948 386.727997,448.953094 386.409271,457.536652 C386.075653,466.521088 386.068634,475.532593 386.350006,484.518738 C386.494904,489.147247 384.896912,490.532959 380.337830,490.481964 C367.440552,490.337616 367.627808,490.513641 367.533173,477.713593 C367.426025,463.226135 368.160004,448.728760 367.168365,434.251617 C366.898468,430.311462 368.239288,428.249725 372.529694,428.668640 C374.840057,428.894196 377.203857,428.868896 379.519684,428.673553 C383.194244,428.363556 385.817352,429.188293 385.487488,434.182526 C390.858826,430.844635 395.856995,428.304504 401.601257,427.794434 C418.292908,426.312286 429.386810,436.518799 429.975342,454.379517 C430.315308,464.696716 429.971527,475.035126 430.046204,485.363190 C430.071198,488.817627 428.985992,490.534210 425.145325,490.442291 C408.307220,490.039520 411.204895,492.848450 410.942963,476.734924 C410.840088,470.406036 410.927368,464.074036 410.915314,457.280090 z" }),
                  /* @__PURE__ */ m.jsx("path", { fill: al.primary, d: "M556.799500,444.921539 C554.214233,445.227783 552.026184,445.174683 549.913574,445.548401 C542.544189,446.852142 538.560974,452.210632 538.387756,461.266998 C538.231995,469.411011 538.239258,477.561676 538.377136,485.705963 C538.433838,489.055634 537.355591,490.537964 533.812988,490.447296 C516.656677,490.008148 519.942505,492.939087 519.712585,476.823181 C519.510925,462.693848 519.801025,448.557343 519.590698,434.428253 C519.527222,430.165985 520.732788,428.169983 525.216187,428.665833 C527.350830,428.901917 529.549255,428.854156 531.692566,428.654297 C535.487610,428.300446 537.940002,429.350586 537.432373,434.447845 C542.475464,431.817810 546.689819,428.862549 551.859985,428.147003 C557.409912,427.378845 558.504028,428.019318 558.285950,433.612213 C558.141113,437.327057 559.514648,441.236115 556.799500,444.921539 z" })
                ] })
              ] })
            }
          ) }),
          /* @__PURE__ */ m.jsx("p", { className: "mt-6 md:mt-8 text-white/30 text-xs md:text-sm tracking-widest uppercase", children: "Where memories leave their trace" })
        ] })
      ]
    }
  );
}, Kr = ({
  checked: e,
  onChange: t,
  disabled: n = !1,
  className: r = "",
  id: a
}) => {
  const o = (l) => {
    n || (l.stopPropagation(), t(!e));
  };
  return /* @__PURE__ */ m.jsx(
    "button",
    {
      type: "button",
      role: "switch",
      id: a,
      "aria-checked": e,
      onClick: o,
      disabled: n,
      className: `
                relative inline-flex h-3.5 w-9 shrink-0 cursor-pointer items-center rounded-full border transition-all duration-300 focus:outline-none
                ${e ? "bg-primary/20 border-primary/50 shadow-[0_0_10px_rgba(var(--primary),0.2)]" : "bg-black/20 border-border shadow-inner"}
                ${n ? "opacity-50 cursor-not-allowed" : ""}
                ${r}
            `,
      children: /* @__PURE__ */ m.jsx(
        "span",
        {
          className: `
                    pointer-events-none inline-block h-2.5 w-2.5 transform rounded-full shadow-sm ring-0 transition-all duration-300 cubic-bezier(0.34, 1.56, 0.64, 1)
                    ${e ? "bg-primary shadow-[0_0_8px_rgba(var(--primary),0.8)] border border-primary-foreground/20" : "bg-muted-foreground border border-transparent opacity-60"}
                `,
          style: { transform: e ? "translateX(24px)" : "translateX(2px)" }
        }
      )
    }
  );
}, y$ = {
  none: "",
  sm: "my-2",
  md: "my-4",
  lg: "my-6"
}, Nr = ({
  orientation: e = "horizontal",
  length: t = 100,
  className: n = "",
  responsive: r = !1,
  spacing: a = "none"
}) => {
  const o = y$[a];
  return r ? /* @__PURE__ */ m.jsxs(m.Fragment, { children: [
    /* @__PURE__ */ m.jsx(
      "div",
      {
        className: `hidden lg:block absolute left-0 top-1/2 -translate-y-1/2 border-l border-border ${n}`,
        style: { height: `${t}%` }
      }
    ),
    /* @__PURE__ */ m.jsx(
      "div",
      {
        className: `lg:hidden border-t border-border/30 mx-auto ${o} ${n}`,
        style: { width: `${t}%` }
      }
    )
  ] }) : e === "vertical" ? /* @__PURE__ */ m.jsx(
    "div",
    {
      className: `border-l border-border/30 mx-auto ${n}`,
      style: { height: `${t}%` }
    }
  ) : /* @__PURE__ */ m.jsx(
    "div",
    {
      className: `border-t border-border/30 ${o} ${n}`,
      style: { width: `${t}%` }
    }
  );
};
var Ff = /* @__PURE__ */ ((e) => (e.Character = "char", e.Location = "loc", e.Item = "item", e.Concept = "concept", e.Unknown = "unknown", e))(Ff || {});
const Kp = {
  last_summarized_floor: 0,
  token_usage_accumulated: 0,
  last_compressed_at: 0,
  active_summary_order: 9e3,
  last_extracted_floor: 0
}, Fx = "scope_state", rE = "character_name";
class K9 {
  constructor() {
    mt(this, "currentChatId", null);
    mt(this, "currentDb", null);
  }
  /**
   * 
   *  ST  chatId
   */
  getCurrentDb() {
    const t = hi();
    return t ? (t !== this.currentChatId && (this.currentChatId = t, this.currentDb = hl(t), console.debug(`[ChatManager] Switched to database: Engram_${t}`)), this.currentDb) : (console.warn("[ChatManager] No chat_id available"), null);
  }
  /**
   *  chatId
   */
  getCurrentChatId() {
    return hi();
  }
  /**
   * 
   */
  getCharacterName() {
    var t;
    return ((t = $h()) == null ? void 0 : t.name) || "Unknown";
  }
  /**
   * 
   */
  async getState() {
    const t = this.getCurrentDb();
    if (!t) return Kp;
    try {
      const n = await t.meta.get(Fx);
      return n != null && n.value ? { ...Kp, ...n.value } : Kp;
    } catch (n) {
      return console.error("[ChatManager] Failed to get state:", n), Kp;
    }
  }
  /**
   * 
   */
  async updateState(t) {
    const n = this.getCurrentDb();
    if (n)
      try {
        const a = { ...await this.getState(), ...t };
        await n.meta.put({ key: Fx, value: a });
      } catch (r) {
        console.error("[ChatManager] Failed to update state:", r);
      }
  }
  /**
   *  UI 
   */
  async saveCharacterName() {
    const t = this.getCurrentDb();
    if (!t) return;
    const n = this.getCharacterName();
    await t.meta.put({ key: rE, value: n });
  }
  /**
   * 
   */
  async getSavedCharacterName() {
    const t = this.getCurrentDb();
    if (!t) return "Unknown";
    const n = await t.meta.get(rE);
    return (n == null ? void 0 : n.value) || "Unknown";
  }
  /**
   * Debug/Dev only
   */
  async resetState() {
    const t = this.getCurrentDb();
    t && await t.meta.put({ key: Fx, value: Kp });
  }
}
const Xf = new K9(), v$ = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  ChatManager: K9,
  chatManager: Xf
}, Symbol.toStringTag, { value: "Module" })), uo = {
  // 
  MESSAGE_SENT: "message_sent",
  MESSAGE_RECEIVED: "message_received",
  MESSAGE_EDITED: "message_edited",
  MESSAGE_DELETED: "message_deleted",
  MESSAGE_UPDATED: "message_updated",
  MESSAGE_SWIPED: "message_swiped",
  USER_MESSAGE_RENDERED: "user_message_rendered",
  CHARACTER_MESSAGE_RENDERED: "character_message_rendered",
  // 
  CHAT_CHANGED: "chat_id_changed",
  CHAT_CREATED: "chat_created",
  CHAT_DELETED: "chat_deleted",
  // 
  GENERATION_STARTED: "generation_started",
  GENERATION_STOPPED: "generation_stopped",
  GENERATION_ENDED: "generation_ended",
  GENERATION_AFTER_COMMANDS: "GENERATION_AFTER_COMMANDS",
  STREAM_TOKEN_RECEIVED: "stream_token_received",
  // V0.7: RAG  -  prompt await  handler 
  GENERATE_BEFORE_COMBINE_PROMPTS: "generate_before_combine_prompts",
  GENERATE_AFTER_COMBINE_PROMPTS: "generate_after_combine_prompts",
  GENERATE_AFTER_DATA: "generate_after_data",
  // V0.8: Chat Completion  ()
  CHAT_COMPLETION_PROMPT_READY: "chat_completion_prompt_ready",
  CHAT_COMPLETION_SETTINGS_READY: "chat_completion_settings_ready",
  // 
  WORLDINFO_UPDATED: "worldinfo_updated",
  WORLDINFO_SETTINGS_UPDATED: "worldinfo_settings_updated",
  WORLDINFO_ENTRIES_LOADED: "worldinfo_entries_loaded",
  WORLD_INFO_ACTIVATED: "world_info_activated",
  // 
  APP_READY: "app_ready",
  SETTINGS_LOADED: "settings_loaded",
  SETTINGS_LOADED_AFTER: "settings_loaded_after",
  EXTENSION_SETTINGS_LOADED: "extension_settings_loaded",
  // 
  CHARACTER_EDITED: "character_edited",
  CHARACTER_DELETED: "characterDeleted",
  // 
  ENGRAM_REQUEST_REVISION: "engram:request_revision"
};
function Th() {
  try {
    const e = window.SillyTavern;
    if (e != null && e.getContext) {
      const t = e.getContext();
      return (t == null ? void 0 : t.eventSource) || null;
    }
    return null;
  } catch {
    return console.warn("[Engram] EventBus:  SillyTavern eventSource"), null;
  }
}
class Ss {
  /**
   * 
   * @param event 
   * @param callback 
   * @returns 
   */
  static on(t, n) {
    const r = Th();
    return r && r.on(t, n), this.listeners.has(t) || this.listeners.set(t, /* @__PURE__ */ new Set()), this.listeners.get(t).add(n), () => {
      this.off(t, n);
    };
  }
  /**
   * 
   * @param event 
   * @param callback 
   */
  static once(t, n) {
    const r = Th();
    if (r)
      r.once(t, n);
    else {
      const a = (...o) => {
        this.off(t, a), n(...o);
      };
      this.on(t, a);
    }
  }
  /**
   * 
   * @param event 
   * @param callback 
   */
  static off(t, n) {
    var a;
    const r = Th();
    r && r.removeListener(t, n), (a = this.listeners.get(t)) == null || a.delete(n);
  }
  /**
   * 
   * @param event 
   * @param args 
   */
  static async emit(t, ...n) {
    const r = Th();
    if (r)
      return r.emit(t, ...n);
  }
  /**
   * 
   * 
   */
  static clearAll() {
    const t = Th();
    for (const [n, r] of this.listeners)
      for (const a of r)
        t && t.removeListener(n, a);
    this.listeners.clear();
  }
  /**
   *  EventBus 
   */
  static isAvailable() {
    return Th() !== null;
  }
}
mt(Ss, "listeners", /* @__PURE__ */ new Map());
const x$ = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  EventBus: Ss,
  TavernEventType: uo
}, Symbol.toStringTag, { value: "Module" }));
function b$(e, t) {
  let n = "assistant";
  return e.is_user ? n = "user" : e.is_system && (n = "system"), {
    id: t,
    role: n,
    content: e.mes || "",
    name: e.name || "",
    isHidden: e.is_hidden ?? !1,
    raw: e
  };
}
class Y9 {
  /**
   * 
   * @param options 
   */
  static getAllMessages(t = {}) {
    const n = pl();
    if (!(n != null && n.chat))
      return [];
    let r = n.chat.map((a, o) => b$(a, o));
    if (t.includeHidden || (r = r.filter((a) => !a.isHidden)), t.role) {
      const a = Array.isArray(t.role) ? t.role : [t.role];
      r = r.filter((o) => a.includes(o.role));
    }
    return r;
  }
  /**
   *  N 
   * @param count 
   * @param options 
   */
  static getRecentMessages(t, n = {}) {
    return this.getAllMessages(n).slice(-t);
  }
  /**
   * 
   * @param start 
   * @param end 
   * @param options 
   */
  static getMessages(t, n, r = {}) {
    return this.getAllMessages(r).slice(t, n);
  }
  /**
   * 
   * @param options 
   */
  static getFloorCount(t = {}) {
    return this.getAllMessages(t).length;
  }
  /**
   * 
   * @param options 
   */
  static getLastMessage(t = {}) {
    const n = this.getAllMessages(t);
    return n.length > 0 ? n[n.length - 1] : null;
  }
  /**
   * 
   */
  static getCurrentCharacterName() {
    var n;
    const t = pl();
    return !(t != null && t.characters) || t.characterId < 0 ? null : ((n = t.characters[t.characterId]) == null ? void 0 : n.name) || null;
  }
  /**
   *  LLM
   * @param messages 
   * @param format 
   */
  static formatMessagesAsText(t, n = "simple") {
    return n === "simple" ? t.map((r) => `${r.name}: ${r.content}`).join(`

`) : t.map((r) => `[${r.role.toUpperCase()}] ${r.name}:
${r.content}`).join(`

---

`);
  }
  /**
   *  MessageService 
   */
  static isAvailable() {
    return L7();
  }
}
const w$ = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  MessageService: Y9
}, Symbol.toStringTag, { value: "Module" }));
async function iE(e) {
  try {
    const t = window.SillyTavern;
    if (t != null && t.getContext) {
      const n = t.getContext();
      if (n != null && n.getTokenCountAsync)
        return await n.getTokenCountAsync(e);
    }
    return Math.ceil(e.length / 4);
  } catch {
    return console.warn("[Engram] WorldInfoService:  Token "), Math.ceil(e.length / 4);
  }
}
function Ta() {
  try {
    return window.TavernHelper || null;
  } catch {
    return null;
  }
}
const ug = "engram";
class mn {
  /**
   *  Token 
   * @param text 
   */
  static async countTokens(t) {
    return iE(t);
  }
  /**
   *  Engram  Token 
   * 
   * @param worldbookName 
   */
  static async countSummaryTokens(t) {
    const r = (await this.getEntries(t)).filter(
      (l) => l.enabled && l.keys.includes(ug)
    );
    if (r.length === 0) return 0;
    const a = r.map((l) => l.content);
    return (await Promise.all(a.map((l) => this.countTokens(l)))).reduce((l, c) => l + c, 0);
  }
  /**
   *  Engram  {{engramSummaries}} 
   * 
   */
  static async getEngramSummariesContent() {
    const t = this.findExistingWorldbook();
    if (!t)
      return "";
    const r = (await this.getEntries(t)).filter((o) => o.keys.includes(ug));
    return r.length === 0 ? "" : (r.sort((o, l) => o.order - l.order), r.map((o) => {
      const l = o.content.replace(/\{\{\/\/.*?\}\}/gs, "").trim();
      return `${o.name}
${l}`;
    }).join(`

---

`));
  }
  /**
   *  Token 
   * @param texts 
   */
  static async countTokensBatch(t) {
    return Promise.all(t.map((n) => iE(n)));
  }
  /**
   *  Engram 
   * 
   */
  static findExistingWorldbook() {
    try {
      const t = Ta();
      if (!(t != null && t.getCharWorldbookNames))
        return null;
      const n = t.getCharWorldbookNames("current");
      return n && [...n.additional || [], n.primary].filter(Boolean).find((o) => o == null ? void 0 : o.startsWith("[Engram]")) || null;
    } catch {
      return null;
    }
  }
  /**
   *  Engram 
   * 
   * ****
   * 
   *  the_world 
   * 1. TavernHelper.createWorldbook() 
   * 2. TavernHelper.getCharWorldbookNames() 
   * 3. TavernHelper.rebindCharWorldbooks() 
   */
  static async getOrCreateWorldbook() {
    var t, n;
    try {
      const r = this.findExistingWorldbook();
      if (r)
        return console.debug("[Engram] WorldInfoService: ", r), r;
      const a = Ta();
      if (!a)
        return console.warn("[Engram] WorldInfoService: TavernHelper "), null;
      const o = (n = (t = window.SillyTavern) == null ? void 0 : t.getContext) == null ? void 0 : n.call(t);
      if (!(o != null && o.name2) || o.name2 === "SillyTavern System")
        return console.warn("[Engram] WorldInfoService: "), null;
      const l = o.name2, c = `[Engram] ${l}`;
      if (console.debug("[Engram] WorldInfoService: ", c), a.createWorldbook)
        await a.createWorldbook(c);
      else
        return console.error("[Engram] WorldInfoService: TavernHelper.createWorldbook "), null;
      if (a.getCharWorldbookNames && a.rebindCharWorldbooks) {
        const d = a.getCharWorldbookNames("current");
        d && (d.additional.push(c), await a.rebindCharWorldbooks("current", d), console.info("[Engram] WorldInfoService: ", {
          character: l,
          worldbook: c
        }));
      }
      return c;
    } catch (r) {
      return console.error("[Engram] WorldInfoService: /", r), null;
    }
  }
  /**
   * @deprecated  getOrCreateWorldbook() 
   */
  static async getChatWorldbook() {
    return this.getOrCreateWorldbook();
  }
  /**
   * 
   * @param worldbookName 
   */
  static async getEntries(t) {
    const n = Ta();
    if (!(n != null && n.getWorldbook))
      return console.warn("[Engram] WorldInfoService: TavernHelper "), [];
    try {
      return (await n.getWorldbook(t)).map((a) => {
        const o = a, l = o.strategy, c = o.position, d = o.recursion, h = [];
        if (l != null && l.keys && Array.isArray(l.keys))
          for (const p of l.keys)
            typeof p == "string" ? h.push(p) : p && typeof p == "object" && "source" in p && h.push(p.source);
        return {
          uid: o.uid || 0,
          name: o.name || "",
          content: o.content || "",
          enabled: o.enabled ?? !0,
          constant: (l == null ? void 0 : l.type) === "constant",
          keys: h,
          position: (c == null ? void 0 : c.type) || "before_character_definition",
          depth: (c == null ? void 0 : c.depth) || 0,
          order: (c == null ? void 0 : c.order) || 100,
          recursion: d ? {
            prevent_incoming: d.prevent_incoming,
            prevent_outgoing: d.prevent_outgoing
          } : void 0,
          comment: o.comment || "",
          extra: o.extra || void 0
        };
      });
    } catch (r) {
      return console.error("[Engram] WorldInfoService: ", r), [];
    }
  }
  /**
   * 
   */
  static async getWorldbookNames() {
    const t = Ta();
    try {
      return t != null && t.getWorldbookNames ? t.getWorldbookNames() : [];
    } catch (n) {
      return console.error("[Engram] WorldInfoService: ", n), [];
    }
  }
  /**
   * 
   * @param worldbookName 
   */
  static async deleteWorldbook(t) {
    const n = Ta();
    if (!(n != null && n.deleteWorldbook))
      return console.warn("[Engram] WorldInfoService: TavernHelper.deleteWorldbook "), !1;
    try {
      const r = await n.deleteWorldbook(t);
      return r && console.info("[Engram] WorldInfoService: ", t), r;
    } catch (r) {
      return console.error("[Engram] WorldInfoService: ", r), !1;
    }
  }
  /**
   * 
   *  TavernHelper API the_world 
   * @param worldbookName 
   * @param params 
   */
  static async createEntry(t, n) {
    try {
      const r = Ta();
      if (!(r != null && r.createWorldbookEntries))
        return console.error("[Engram] WorldInfoService: TavernHelper.createWorldbookEntries "), !1;
      const a = {
        name: n.name,
        content: n.content,
        comment: n.name,
        // 
        disable: !(n.enabled ?? !0),
        // TavernHelper  disable 
        strategy: {
          type: n.constant ? "constant" : "selective",
          keys: n.keys || []
        },
        position: {
          type: n.position || "before_character_definition",
          order: n.order ?? 100,
          depth: n.depth ?? 4
        },
        recursion: n.recursion,
        //  Engram 
        extra: {
          engram: !0
        }
      };
      return console.debug("[Engram] WorldInfoService: ", {
        worldbook: t,
        name: n.name,
        contentLength: n.content.length
      }), await r.createWorldbookEntries(t, [a]), console.info("[Engram] WorldInfoService: ", t), !0;
    } catch (r) {
      return console.error("[Engram] WorldInfoService: ", r), !1;
    }
  }
  /**
   * 
   * @param worldbookName 
   * @param uid  UID
   * @param updates 
   */
  /**
   * 
   *  updateWorldbookWith 
   * @param worldbookName 
   * @param uid  UID
   * @param updates 
   */
  static async updateEntry(t, n, r) {
    const a = Ta();
    if (!(a != null && a.updateWorldbookWith))
      return console.warn("[Engram] WorldInfoService: TavernHelper.updateWorldbookWith "), !1;
    try {
      return await a.updateWorldbookWith(t, (o) => {
        var c;
        const l = o.findIndex((d) => d.uid === n);
        if (l !== -1) {
          const d = o[l];
          let h = d.disable;
          "enabled" in r && (h = !r.enabled);
          let p = d.strategy || { type: "selective", keys: [] };
          if ("constant" in r || "keys" in r) {
            const b = r.constant !== void 0 ? r.constant : p.type === "constant", C = r.keys !== void 0 ? r.keys : p.keys || [];
            p = {
              ...p,
              type: b ? "constant" : "selective",
              keys: C
            };
          }
          let g = d.position || { type: "before_character_definition", order: 0, depth: 0 };
          (r.position || typeof r.order == "number" || typeof r.depth == "number") && (g = {
            ...g,
            type: (typeof r.position == "string" ? r.position : (c = r.position) == null ? void 0 : c.type) || g.type,
            order: r.order ?? g.order,
            depth: r.depth ?? g.depth
          });
          let x = d.recursion;
          r.recursion && (x = r.recursion), o[l] = {
            ...d,
            name: r.name ?? d.name,
            content: r.content ?? d.content,
            comment: r.name ?? d.comment,
            // 
            disable: h,
            strategy: p,
            position: g,
            recursion: x
          }, console.debug("[Engram] WorldInfoService:  (In-Place)", { uid: n, name: o[l].name });
        } else
          console.warn("[Engram] WorldInfoService: updateEntry ", n);
        return o;
      }), !0;
    } catch (o) {
      return console.error("[Engram] WorldInfoService: ", o), !1;
    }
  }
  /**
   * 
   * @param worldbookName 
   * @param uid  UID
   */
  static async deleteEntry(t, n) {
    const r = Ta();
    if (!(r != null && r.deleteWorldbookEntries))
      return console.warn("[Engram] WorldInfoService: TavernHelper.deleteWorldbookEntries "), !1;
    try {
      return await r.deleteWorldbookEntries(t, (a) => a.uid === n), console.debug("[Engram] WorldInfoService: ", { worldbook: t, uid: n }), !0;
    } catch (a) {
      return console.error("[Engram] WorldInfoService: ", a), !1;
    }
  }
  /**
   * 
   * @param worldbookName 
   * @param uids  UID 
   */
  static async deleteEntries(t, n) {
    const r = Ta();
    if (!(r != null && r.deleteWorldbookEntries))
      return console.warn("[Engram] WorldInfoService: TavernHelper.deleteWorldbookEntries "), !1;
    try {
      const a = new Set(n);
      return await r.deleteWorldbookEntries(t, (o) => a.has(o.uid)), console.debug("[Engram] WorldInfoService: ", { worldbook: t, count: n.length }), !0;
    } catch (a) {
      return console.error("[Engram] WorldInfoService: ", a), !1;
    }
  }
  /**
   *  Engram  order 
   * 
   * @param worldbookName 
   */
  static async getSummaryEntries(t) {
    const r = (await this.getEntries(t)).filter((a) => a.keys.includes(ug));
    return r.sort((a, o) => a.order - o.order), r;
  }
  /**
   * 
   * @param entryName  "_1-10"
   * @returns [startFloor, endFloor]  null
   */
  static parseFloorRangeFromName(t) {
    const n = t.match(/_(\d+)-(\d+)/);
    return n ? [parseInt(n[1], 10), parseInt(n[2], 10)] : null;
  }
  /**
   * 
   * 8999:  <summary>
   * 10000:  </summary>
   */
  static async ensureSeparatorEntries(t) {
    await this.findEntryByKey(t, "") || await this.createEntry(t, {
      name: "",
      content: "<summary>",
      keys: [""],
      constant: !0,
      order: 8999,
      enabled: !0,
      position: "before_character_definition"
    }), await this.findEntryByKey(t, "") || await this.createEntry(t, {
      name: "",
      content: "</summary>",
      keys: [""],
      constant: !0,
      order: 1e4,
      enabled: !0,
      position: "before_character_definition"
    });
  }
  /**
   * 
   *  9000
   */
  static async getNextSummaryOrder(t) {
    const r = (await this.getEntries(t)).map((o) => o.order).filter((o) => o >= 9e3 && o < 1e4);
    return r.length === 0 ? 9e3 : Math.max(...r) + 1;
  }
  /**
   *  Key 
   * @param worldbookName 
   * @param key 
   */
  static async findEntryByKey(t, n) {
    const r = await this.getEntries(t);
    let a = r.find((o) => o.keys.includes(n));
    return a || (a = r.find((o) => o.name === n || n === "__ENGRAM_STATE__" && o.name === "Engram System State")), a || null;
  }
  /**
   *  Token 
   * @param worldbookName 
   */
  static async getWorldbookTokenStats(t) {
    const n = await this.getEntries(t), r = await Promise.all(
      n.map(async (o) => ({
        name: o.name,
        tokens: await this.countTokens(o.content)
      }))
    );
    return {
      totalTokens: r.reduce((o, l) => o + l.tokens, 0),
      entryCount: n.length,
      entries: r
    };
  }
  /**
   *  WorldInfoService 
   */
  static isAvailable() {
    return Ta() !== null;
  }
  /**
   *  Token  API
   */
  static async isNativeTokenCountAvailable() {
    try {
      const t = window.SillyTavern;
      if (t != null && t.getContext) {
        const n = t.getContext();
        return typeof (n == null ? void 0 : n.getTokenCountAsync) == "function";
      }
      return !1;
    } catch {
      return !1;
    }
  }
  /**
   * 
   *  getWorldInfoPrompt 
   * + 
   * 
   * @param chatMessages 
   * @returns 
   */
  static async getActivatedWorldInfo(t) {
    var r, a, o;
    const { Logger: n } = await Promise.resolve().then(() => CS);
    try {
      const c = await new Function("path", "return import(path)")("/scripts/world-info.js"), d = c == null ? void 0 : c.getWorldInfoPrompt, h = c == null ? void 0 : c.getSortedEntries;
      if (typeof h == "function") {
        const P = await h(), re = [...new Set((P == null ? void 0 : P.map((X) => X.world)) || [])], ie = ((r = P == null ? void 0 : P.filter((X) => X.constant)) == null ? void 0 : r.length) || 0;
        n.info("WorldInfo", "getSortedEntries ", {
          totalEntries: (P == null ? void 0 : P.length) || 0,
          worlds: re,
          constantCount: ie,
          sampleEntry: P != null && P[0] ? {
            name: P[0].name,
            world: P[0].world,
            constant: P[0].constant
          } : null
        });
      }
      if (typeof d != "function")
        return n.warn("WorldInfo", "getWorldInfoPrompt "), this.getConstantWorldInfo();
      let p = t;
      if (!p || p.length === 0) {
        const P = (o = (a = window.SillyTavern) == null ? void 0 : a.getContext) == null ? void 0 : o.call(a);
        P != null && P.chat && Array.isArray(P.chat) && (p = P.chat.map((re) => re.mes || "").reverse());
      }
      if (!p || p.length === 0)
        return n.warn("WorldInfo", ""), this.getConstantWorldInfo();
      n.debug("WorldInfo", " getWorldInfoPrompt", {
        messageCount: p.length
      });
      const g = 1e6, x = c == null ? void 0 : c.checkWorldInfo;
      if (typeof x != "function")
        return n.error("WorldInfo", "checkWorldInfo "), this.getConstantWorldInfo();
      const b = await x(p, g, !0, {
        trigger: "normal"
      }), C = b == null ? void 0 : b.allActivatedEntries, N = C ? Array.from(C.values()) : [];
      n.info("WorldInfo", ` ${N.length} `);
      const T = await this.loadFilteringState(), { disabledGlobalBooks: j, disabledEntries: R, globalWorldbooks: A, config: z } = T, q = N.filter(
        (P) => this.shouldIncludeEntry(P, A, j, R, z)
      );
      return n.info("WorldInfo", "", {
        total: N.length,
        kept: q.length,
        filteredOut: N.length - q.length,
        keptWorlds: [...new Set(q.map((P) => P.world))]
      }), q.sort((P, re) => (P.order || 0) - (re.order || 0)), q.map((P) => P.content).filter(Boolean).join(`

`);
    } catch (l) {
      return n.error("WorldInfo", "", l), this.getConstantWorldInfo();
    }
  }
  /**
   * 
   * @private
   */
  static async loadFilteringState() {
    var p, g, x;
    const t = Ta(), n = ((p = t == null ? void 0 : t.getGlobalWorldbookNames) == null ? void 0 : p.call(t)) || [], { SettingsManager: r } = await Promise.resolve().then(() => jS), o = (g = r.getSettings().apiSettings) == null ? void 0 : g.worldbookConfig, l = (o == null ? void 0 : o.disabledWorldbooks) || [], { WorldBookStateService: c } = await Promise.resolve().then(() => rH), d = (x = t == null ? void 0 : t.getCharWorldbookNames) == null ? void 0 : x.call(t, "current");
    let h = {};
    return d != null && d.primary && (h = (await c.loadState(d.primary)).disabledEntries || {}), {
      globalWorldbooks: n,
      disabledGlobalBooks: l,
      disabledEntries: h,
      config: o
    };
  }
  /**
   * 
   * @private
   */
  static shouldIncludeEntry(t, n, r, a, o) {
    var l, c, d, h;
    if (((l = t.extra) == null ? void 0 : l.engram) === !0 || (c = t.world) != null && c.startsWith("[Engram]")) return !0;
    if (t.world && n.includes(t.world) && ((o == null ? void 0 : o.includeGlobal) === !1 || r.includes(t.world)))
      return !1;
    if (t.world && t.uid) {
      const p = a[t.world];
      if (p && p.includes(t.uid))
        return !1;
    }
    return !((d = t.world) != null && d.startsWith("") || (h = t.world) != null && h.startsWith("---"));
  }
  /**
   *  UI 
   * 
   */
  static async getWorldbookStructure() {
    var l;
    const t = Ta();
    if (!t) return {};
    const n = ((l = t.getGlobalWorldbookNames) == null ? void 0 : l.call(t)) || [];
    let r = [];
    if (t.getCharWorldbookNames) {
      const c = t.getCharWorldbookNames("current");
      c && (r = [...c.additional || [], c.primary].filter(Boolean));
    }
    const a = Array.from(/* @__PURE__ */ new Set([...n, ...r])).sort(), o = {};
    for (const c of a)
      try {
        const d = await this.getEntries(c);
        o[c] = d.map((h) => {
          var p;
          return {
            uid: h.uid,
            name: h.name,
            // 
            keys: h.keys,
            constant: h.constant,
            // 
            comment: h.comment || "",
            content: ((p = h.content) == null ? void 0 : p.substring(0, 50)) + "..."
            // 
          };
        });
      } catch (d) {
        console.warn(`[Engram] WorldInfoService:  ${c} `, d), o[c] = [];
      }
    return o;
  }
  /**
   * 
   *  getActivatedWorldInfo 
   */
  static async getConstantWorldInfo() {
    try {
      const n = await new Function("path", "return import(path)")("/scripts/world-info.js"), r = n == null ? void 0 : n.getSortedEntries;
      if (typeof r != "function")
        return "";
      const a = await r();
      if (!a || !Array.isArray(a))
        return "";
      const o = a.filter((l) => l.constant === !0 && l.disable !== !0 && l.content);
      return o.length === 0 ? "" : (console.debug(`[Engram] WorldInfoService:  ${o.length} `), o.map((l) => l.content).join(`

`));
    } catch {
      return "";
    }
  }
}
const W9 = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  SUMMARY_ENTRY_KEY: ug,
  WorldInfoService: mn,
  getTavernHelper: Ta
}, Symbol.toStringTag, { value: "Module" }));
async function _$() {
  const { EventBus: e } = await Promise.resolve().then(() => x$), { MessageService: t } = await Promise.resolve().then(() => w$), { WorldInfoService: n } = await Promise.resolve().then(() => W9);
  return {
    eventBus: e.isAvailable(),
    messageService: t.isAvailable(),
    worldInfoService: n.isAvailable(),
    nativeTokenCount: await n.isNativeTokenCountAvailable(),
    floorCount: t.isAvailable() ? t.getFloorCount() : null,
    characterName: t.isAvailable() ? t.getCurrentCharacterName() : null
  };
}
const X9 = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  EventBus: Ss,
  MessageService: Y9,
  TavernEventType: uo,
  WorldInfoService: mn,
  checkTavernIntegration: _$
}, Symbol.toStringTag, { value: "Module" }));
function aE() {
  return typeof crypto < "u" && typeof crypto.randomUUID == "function" ? crypto.randomUUID() : "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, (e) => {
    const t = Math.random() * 16 | 0;
    return (e === "x" ? t : t & 3 | 8).toString(16);
  });
}
function Ja() {
  const e = hi();
  return e ? hl(e) : null;
}
function sE() {
  const e = hi();
  return e ? yc(e) : null;
}
const Oi = y7((e, t) => ({
  currentChatId: null,
  lastSummarizedFloor: 0,
  isProcessing: !1,
  recentEvents: [],
  // V0.6 
  currentScope: null,
  resolveScope: async (n, r) => {
    e({ currentChatId: n, currentScope: { id: 1 } });
    const a = await Xf.getState();
    return e({ lastSummarizedFloor: a.last_summarized_floor }), { id: 1 };
  },
  initChat: async () => {
    const n = hi();
    if (!n)
      return console.warn("[MemoryStore] No chat_id available"), null;
    if (n !== t().currentChatId) {
      console.debug(`[MemoryStore] Switching to chat: ${n}`);
      const r = await Xf.getState();
      e({
        currentChatId: n,
        currentScope: { id: 1 },
        // 
        lastSummarizedFloor: r.last_summarized_floor,
        recentEvents: []
      });
    }
    return hl(n);
  },
  saveEvent: async (n) => {
    const r = Ja();
    if (!r)
      throw new Error("[MemoryStore] No current chat");
    const a = {
      ...n,
      id: aE(),
      timestamp: Date.now(),
      is_embedded: n.is_embedded ?? !1,
      // V0.7: 
      is_archived: n.is_archived ?? !1
      // V0.7: 
    };
    return await r.events.add(a), e((o) => ({
      recentEvents: [...o.recentEvents, a].slice(-10)
    })), a;
  },
  getEventSummaries: async (n) => {
    const r = sE();
    if (!r) return "";
    try {
      const a = await r.events.toArray();
      if (a.length === 0) return "";
      const o = n ? new Set(n) : null, l = a.filter(
        (d) => d.level >= 1 || // 
        !d.is_archived || // 
        (o == null ? void 0 : o.has(d.id))
        //  RAG 
      );
      return l.length === 0 ? "" : (l.sort((d, h) => {
        var C, N, T, j;
        const p = ((C = d.source_range) == null ? void 0 : C.start_index) ?? 0, g = ((N = h.source_range) == null ? void 0 : N.start_index) ?? 0;
        if (p !== g) return p - g;
        const x = ((T = d.source_range) == null ? void 0 : T.end_index) ?? 0, b = ((j = h.source_range) == null ? void 0 : j.end_index) ?? 0;
        return x !== b ? x - b : d.timestamp - h.timestamp;
      }), `<summary>
${l.map((d) => d.summary).join(`

`)}
</summary>`);
    } catch (a) {
      return console.error("[MemoryStore] Failed to get event summaries:", a), "";
    }
  },
  countEventTokens: async () => {
    const n = Ja();
    if (!n) return { totalTokens: 0, eventCount: 0, activeEventCount: 0 };
    try {
      const r = await n.events.toArray();
      if (r.length === 0) return { totalTokens: 0, eventCount: 0, activeEventCount: 0 };
      const a = r.filter((c) => !c.is_archived), o = a.map((c) => c.summary).join(`

`);
      return {
        totalTokens: await mn.countTokens(o),
        eventCount: r.length,
        activeEventCount: a.length
        // 
      };
    } catch (r) {
      return console.error("[MemoryStore] Failed to count event tokens:", r), { totalTokens: 0, eventCount: 0, activeEventCount: 0 };
    }
  },
  setLastSummarizedFloor: async (n) => {
    await Xf.updateState({ last_summarized_floor: n }), e({ lastSummarizedFloor: n });
  },
  setProcessing: (n) => e({ isProcessing: n }),
  reset: () => e({
    currentChatId: null,
    currentScope: null,
    lastSummarizedFloor: 0,
    isProcessing: !1,
    recentEvents: []
  }),
  // ==================== Trim  ====================
  /**
   * 
   */
  archiveEvents: async (n) => {
    if (n.length === 0) return;
    const r = Ja();
    if (r)
      try {
        await r.events.where("id").anyOf(n).modify({ is_archived: !0 }), console.log(`[MemoryStore] Archived ${n.length} events`);
      } catch (a) {
        console.error("[MemoryStore] Failed to archive events:", a);
      }
  },
  /**
   * 
   */
  markEventsAsEmbedded: async (n) => {
    if (n.length === 0) return;
    const r = Ja();
    if (r)
      try {
        await r.events.where("id").anyOf(n).modify({ is_embedded: !0 }), console.log(`[MemoryStore] Marked ${n.length} events as embedded`);
      } catch (a) {
        console.error("[MemoryStore] Failed to mark events as embedded:", a);
      }
  },
  getEventsToMerge: async (n = 3) => {
    const r = Ja();
    if (!r) return [];
    try {
      const a = await r.events.orderBy("timestamp").toArray();
      return a.length <= n ? [] : a.slice(0, a.length - n);
    } catch (a) {
      return console.error("[MemoryStore] Failed to get events to merge:", a), [];
    }
  },
  deleteEvents: async (n) => {
    if (n.length === 0) return;
    const r = Ja();
    if (r)
      try {
        await r.events.bulkDelete(n), console.log(`[MemoryStore] Deleted ${n.length} events`);
      } catch (a) {
        throw console.error("[MemoryStore] Failed to delete events:", a), a;
      }
  },
  /**
   * 
   */
  updateEvent: async (n, r) => {
    if (!n) return;
    const a = Ja();
    if (a)
      try {
        const { id: o, timestamp: l, ...c } = r;
        await a.events.update(n, c), console.log(`[MemoryStore] Updated event: ${n}`, c);
      } catch (o) {
        throw console.error("[MemoryStore] Failed to update event:", o), o;
      }
  },
  getAllEvents: async () => {
    const n = Ja();
    if (!n) return [];
    try {
      return await n.events.orderBy("timestamp").toArray();
    } catch (r) {
      return console.error("[MemoryStore] Failed to get all events:", r), [];
    }
  },
  // ==================== V0.9  ====================
  getAllEntities: async () => {
    const n = Ja();
    if (!n) return [];
    try {
      return await n.entities.toArray();
    } catch (r) {
      return console.error("[MemoryStore] Failed to get all entities:", r), [];
    }
  },
  saveEntity: async (n) => {
    const r = Ja();
    if (!r)
      throw new Error("[MemoryStore] No current chat");
    const a = {
      ...n,
      id: aE(),
      last_updated_at: Date.now(),
      aliases: n.aliases || [],
      profile: n.profile || {}
    };
    return await r.entities.add(a), console.log(`[MemoryStore] Saved entity: ${a.name}`), a;
  },
  updateEntity: async (n, r) => {
    if (!n) return;
    const a = Ja();
    if (a)
      try {
        const { id: o, ...l } = r;
        await a.entities.update(n, {
          ...l,
          last_updated_at: Date.now()
        }), console.log(`[MemoryStore] Updated entity: ${n}`);
      } catch (o) {
        throw console.error("[MemoryStore] Failed to update entity:", o), o;
      }
  },
  deleteEntity: async (n) => {
    if (!n) return;
    const r = Ja();
    if (r)
      try {
        await r.entities.delete(n), console.log(`[MemoryStore] Deleted entity: ${n}`);
      } catch (a) {
        throw console.error("[MemoryStore] Failed to delete entity:", a), a;
      }
  },
  findEntityByName: async (n) => {
    const r = Ja();
    if (!r) return null;
    try {
      const a = await r.entities.where("name").equals(n).first();
      return a || await r.entities.where("aliases").equals(n).first() || null;
    } catch (a) {
      return console.error("[MemoryStore] Failed to find entity by name:", a), null;
    }
  },
  /**
   * V0.9.2:  ()
   *  is_archived=true 
   */
  getArchivedEventSummaries: async () => {
    const n = sE();
    if (!n) return "";
    try {
      const a = (await n.events.toArray()).filter((l) => l.is_archived === !0);
      return a.length === 0 ? "" : (a.sort((l, c) => {
        var p, g;
        const d = ((p = l.source_range) == null ? void 0 : p.start_index) ?? 0, h = ((g = c.source_range) == null ? void 0 : g.start_index) ?? 0;
        return d !== h ? d - h : l.timestamp - c.timestamp;
      }), `<archived_summary>
${a.map((l) => l.summary).join(`

`)}
</archived_summary>`);
    } catch (r) {
      return console.error("[MemoryStore] Failed to get archived event summaries:", r), "";
    }
  }
})), Q9 = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  useMemoryStore: Oi
}, Symbol.toStringTag, { value: "Module" })), U3 = [
  { value: "input", label: "", description: " LLM " },
  { value: "output", label: "", description: " LLM /" },
  { value: "both", label: "", description: "" }
], Gh = [
  {
    id: "remove-think",
    name: "",
    pattern: "<think(?:\\s+[^>]*)?>[\\s\\S]*?<\\/think\\s*>",
    replacement: "",
    enabled: !0,
    flags: "gi",
    scope: "both",
    description: " LLM  <think>...</think> "
  },
  {
    id: "remove-headless-think",
    name: "",
    pattern: "[\\s\\S]*?<\\/think\\s*>",
    replacement: "",
    enabled: !0,
    flags: "gi",
    scope: "both",
    description: " </think> "
  },
  {
    id: "remove-update-variable",
    name: " UpdateVariable",
    pattern: "<UpdateVariable(?:\\s+[^>]*)?>[\\s\\S]*?<\\/UpdateVariable\\s*>",
    replacement: "",
    enabled: !0,
    flags: "gi",
    scope: "both",
    description: " MVU "
  },
  {
    id: "remove-status-placeholder",
    name: " StatusPlaceHolder",
    pattern: "<StatusPlaceHolderImpl(?:\\s+[^>]*)?\\s*\\/>",
    replacement: "",
    enabled: !0,
    flags: "gi",
    scope: "both",
    description: ""
  }
];
class H1 {
  constructor(t) {
    mt(this, "rules", []);
    this.rules = t || [...Gh];
  }
  /**
   * 
   * @param text 
   * @param scope 
   */
  process(t, n) {
    let r = t;
    for (const a of this.rules)
      if (a.enabled && !(n && a.scope !== n && a.scope !== "both"))
        try {
          const o = new RegExp(a.pattern, a.flags);
          r = r.replace(o, a.replacement);
        } catch (o) {
          console.warn(`[RegexProcessor]  "${a.name}" :`, o);
        }
    return r;
  }
  /**
   * 
   */
  processWithRule(t, n) {
    try {
      const r = new RegExp(n.pattern, n.flags);
      return t.replace(r, n.replacement);
    } catch (r) {
      return console.warn("[RegexProcessor] :", r), t;
    }
  }
  /**
   * 
   */
  validatePattern(t, n) {
    try {
      return new RegExp(t, n), { valid: !0 };
    } catch (r) {
      return {
        valid: !1,
        error: r instanceof Error ? r.message : ""
      };
    }
  }
  /**
   * 
   */
  getRules() {
    return [...this.rules];
  }
  /**
   * 
   */
  setRules(t) {
    this.rules = [...t];
  }
  /**
   * 
   */
  addRule(t) {
    this.rules.push(t);
  }
  /**
   * 
   */
  updateRule(t, n) {
    const r = this.rules.findIndex((a) => a.id === t);
    r >= 0 && (this.rules[r] = { ...this.rules[r], ...n });
  }
  /**
   * 
   */
  deleteRule(t) {
    this.rules = this.rules.filter((n) => n.id !== t);
  }
  /**
   * /
   */
  toggleRule(t) {
    const n = this.rules.find((r) => r.id === t);
    n && (n.enabled = !n.enabled);
  }
  /**
   * 
   */
  resetToDefaults() {
    this.rules = [...Gh];
  }
  /**
   * 
   */
  getEnabledCount() {
    return this.rules.filter((t) => t.enabled).length;
  }
  // ========== V0.8:  ==========
  /**
   * 
   * @param text 
   * @param tagName  ( 'output', 'query')
   * @returns  null
   */
  captureTag(t, n) {
    var r;
    try {
      const a = new RegExp(`<${n}(?:\\s+[^>]*)?>([\\s\\S]*?)<\\/${n}\\s*>`, "i"), o = t.match(a);
      return ((r = o == null ? void 0 : o[1]) == null ? void 0 : r.trim()) || null;
    } catch (a) {
      return console.warn(`[RegexProcessor] : ${n}`, a), null;
    }
  }
  /**
   * 
   * @param text 
   * @param tagName 
   */
  removeTag(t, n) {
    try {
      const r = new RegExp(`<${n}(?:\\s+[^>]*)?>[\\s\\S]*?<\\/${n}\\s*>`, "gi");
      return t.replace(r, "").trim();
    } catch (r) {
      return console.warn(`[RegexProcessor] : ${n}`, r), t;
    }
  }
  /**
   * 
   * @param text 
   * @param tagNames 
   * @returns 
   */
  captureTags(t, n) {
    const r = {};
    for (const a of n)
      r[a] = this.captureTag(t, a);
    return r;
  }
}
const Cs = new H1(), S$ = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  DEFAULT_REGEX_RULES: Gh,
  REGEX_SCOPE_OPTIONS: U3,
  RegexProcessor: H1,
  regexProcessor: Cs
}, Symbol.toStringTag, { value: "Module" })), Vr = class Vr {
  /**
   *  Engram 
   */
  static async init() {
    var t, n;
    if (!this.isInitialized)
      try {
        const r = (n = (t = window.SillyTavern) == null ? void 0 : t.getContext) == null ? void 0 : n.call(t);
        if (!(r != null && r.registerMacro)) {
          ye.warn("MacroService", "SillyTavern registerMacro API ");
          return;
        }
        r.registerMacro(
          "engramSummaries",
          () => Vr.cachedSummaries,
          "Engram:  ( IndexedDB)"
        ), r.registerMacro(
          "worldbookContext",
          () => Vr.cachedWorldbookContext,
          "Engram: "
        ), r.registerMacro(
          "userInput",
          () => Vr.cachedUserInput,
          "Engram: "
        ), r.registerMacro(
          "chatHistory",
          (o) => Vr.getChatHistory(o),
          "Engram:  (: , 20)"
        ), r.registerMacro(
          "context",
          () => Vr.cachedCharDescription,
          "Engram: "
        ), r.registerMacro(
          "engramGraph",
          () => Vr.cachedGraphData,
          "Engram:  JSON ()"
        ), r.registerMacro(
          "engramArchivedSummaries",
          () => Vr.cachedArchivedSummaries,
          "Engram:  ()"
        ), r.registerMacro(
          "userPersona",
          () => Vr.cachedUserPersona,
          "Engram:  ( Persona Description)"
        ), this.isInitialized = !0, ye.success("MacroService", "", {
          macros: ["{{engramSummaries}}", "{{worldbookContext}}", "{{userInput}}", "{{chatHistory}}", "{{context}}", "{{engramGraph}}", "{{engramArchivedSummaries}}", "{{userPersona}}"]
        }), await this.refreshCache();
        const a = r.eventSource;
        a && a.on("chat_id_changed", () => {
          this.refreshCache().catch((o) => ye.warn("MacroService", "", o));
        });
      } catch (r) {
        ye.error("MacroService", "", r);
      }
  }
  /**
   * 
   */
  static setUserInput(t) {
    this.cachedUserInput = t;
  }
  /**
   *  -  IndexedDB 
   * @param recalledIds RAG  ID 
   */
  static async refreshCache(t) {
    try {
      const n = Oi.getState();
      this.cachedSummaries = await n.getEventSummaries(t);
      try {
        const r = await mn.getActivatedWorldInfo(), a = await this.processEJSMacros([r]);
        this.cachedWorldbookContext = a[0] || "";
      } catch (r) {
        ye.debug("MacroService", "", r), this.cachedWorldbookContext = "";
      }
      this.refreshCharDescription(), await this.refreshArchivedSummaries(), this.refreshUserPersona(), this.refreshCustomMacros(), ye.debug("MacroService", "", {
        summariesLength: this.cachedSummaries.length,
        worldbookLength: this.cachedWorldbookContext.length,
        recalledCount: (t == null ? void 0 : t.length) ?? 0,
        customMacrosCount: this.cachedCustomMacros.size
      });
    } catch (n) {
      ye.warn("MacroService", "", n);
    }
  }
  /**
   * V0.9: 
   *  EventNode JSON embedding 
   */
  static async refreshGraphCache() {
    try {
      const t = Oi.getState(), n = await t.getAllEvents(), r = await t.getAllEntities(), a = n.map((l) => ({
        id: l.id,
        summary: l.summary,
        structured_kv: l.structured_kv,
        significance_score: l.significance_score,
        level: l.level,
        source_range: l.source_range
      })), o = r.map((l) => ({
        id: l.id,
        name: l.name,
        type: l.type,
        aliases: l.aliases || [],
        description: l.description
      }));
      this.cachedGraphData = JSON.stringify({
        events: a,
        existingEntities: o
      }, null, 2), ye.debug("MacroService", "", {
        eventCount: n.length,
        entityCount: r.length
      });
    } catch (t) {
      ye.warn("MacroService", "", t), this.cachedGraphData = JSON.stringify({ events: [], existingEntities: [] });
    }
  }
  /**
   * V0.8.5:  RAG 
   * 
   * @param nodes RAG 
   */
  static async refreshCacheWithNodes(t) {
    try {
      this.cachedSummaries = t.map((n) => n.summary).join(`

---

`);
      try {
        const n = await mn.getActivatedWorldInfo(), r = await this.processEJSMacros([n]);
        this.cachedWorldbookContext = r[0] || "";
      } catch (n) {
        ye.debug("MacroService", "", n), this.cachedWorldbookContext = "";
      }
      this.refreshCharDescription(), ye.debug("MacroService", "RAG ", {
        summariesLength: this.cachedSummaries.length,
        nodeCount: t.length
      });
    } catch (n) {
      ye.warn("MacroService", " RAG ", n);
    }
  }
  /**
   *  ST-Prompt-Template ()  EJS 
   * V0.8.6:  window.EjsTemplate API ( test/.js)
   */
  static async processEJSMacros(t) {
    if (t.length === 0) return t;
    if (!window.EjsTemplate || typeof window.EjsTemplate.evalTemplate != "function")
      return ye.debug("MacroService", "ST-Prompt-Template  EJS "), t;
    try {
      const n = await window.EjsTemplate.prepareContext();
      if (typeof window.Mvu < "u" && window.Mvu.getMvuData)
        try {
          const a = window.Mvu.getMvuData({ type: "message", message_id: "latest" });
          a && a.stat_data && (n.mvu = a.stat_data);
        } catch (a) {
          ye.warn("MacroService", " MVU ", a);
        }
      return await Promise.all(t.map(async (a) => {
        try {
          return await window.EjsTemplate.evalTemplate(a, n);
        } catch (o) {
          return ye.warn("MacroService", "EJS ", o), a;
        }
      }));
    } catch (n) {
      return ye.warn("MacroService", "EJS ", n), t;
    }
  }
  /**
   *  ()
   * @param depthStr  ( 20)
   */
  static getChatHistory(t) {
    var n, r;
    try {
      let a = 20;
      if (t) {
        const c = parseInt(t, 10);
        isNaN(c) || (c < 0 ? a = 1 / 0 : c > 0 ? a = c : a = this.getDynamicChatHistoryLimit());
      } else
        a = this.getDynamicChatHistoryLimit();
      ye.debug("MacroService", "getChatHistory called", { depthStr: t, limit: a });
      const o = (r = (n = window.SillyTavern) == null ? void 0 : n.getContext) == null ? void 0 : r.call(n), l = window.TavernHelper;
      if (o != null && o.chat && Array.isArray(o.chat)) {
        const c = o.chat.slice(-a);
        return ye.debug("MacroService", "Got recent messages", { count: c.length }), c.map((d, h) => {
          let p = d.mes || "";
          const g = p;
          if (l && typeof l.formatAsTavernRegexedString == "function")
            try {
              p = l.formatAsTavernRegexedString(p, "ai_output", { isPrompt: !0 });
            } catch (x) {
              ye.warn("MacroService", "", x);
            }
          return p = Cs.process(p, "both"), (h === 0 || h === c.length - 1) && ye.debug("MacroService", "Message processed", {
            index: h,
            original: g.substring(0, 50),
            processed: p.substring(0, 50)
          }), p;
        }).join(`
`);
      }
      return ye.warn("MacroService", "Context chat is empty or invalid"), "";
    } catch (a) {
      return ye.debug("MacroService", "", a), "";
    }
  }
  /**
   * 
   */
  static refreshCharDescription() {
    var t, n;
    try {
      const r = (n = (t = window.SillyTavern) == null ? void 0 : t.getContext) == null ? void 0 : n.call(t);
      if (r != null && r.characters && r.characterId >= 0) {
        const a = r.characters[r.characterId];
        this.cachedCharDescription = (a == null ? void 0 : a.description) || "";
      }
    } catch (r) {
      ye.debug("MacroService", "", r);
    }
  }
  /**
   * V0.9.2:  chatHistory 
   * : floorInterval - bufferSize
   *  {{chatHistory}} 
   */
  static getDynamicChatHistoryLimit() {
    try {
      const t = nt.get("summarizerConfig"), n = (t == null ? void 0 : t.floorInterval) ?? 20, r = (t == null ? void 0 : t.bufferSize) ?? 3, a = Math.max(1, n - r);
      return ye.debug("MacroService", " chatHistory limit", { floorInterval: n, bufferSize: r, limit: a }), a;
    } catch (t) {
      return ye.warn("MacroService", " limit  17", t), 17;
    }
  }
  /**
   * V0.9.2: 
   *  is_archived=true 
   */
  static async refreshArchivedSummaries() {
    try {
      const t = Oi.getState();
      this.cachedArchivedSummaries = await t.getArchivedEventSummaries(), ye.debug("MacroService", "", {
        length: this.cachedArchivedSummaries.length
      });
    } catch (t) {
      ye.warn("MacroService", "", t), this.cachedArchivedSummaries = "";
    }
  }
  /**
   * V0.9.2: 
   *  power_user.persona_description 
   */
  static refreshUserPersona() {
    try {
      const t = window.power_user;
      this.cachedUserPersona = (t == null ? void 0 : t.persona_description) || "", ye.debug("MacroService", "", {
        length: this.cachedUserPersona.length
      });
    } catch (t) {
      ye.debug("MacroService", "", t), this.cachedUserPersona = "";
    }
  }
  /**
   * V0.9.2: 
   *  apiSettings.customMacros 
   */
  static refreshCustomMacros() {
    var t, n;
    try {
      const r = (n = (t = window.SillyTavern) == null ? void 0 : t.getContext) == null ? void 0 : n.call(t);
      if (!(r != null && r.registerMacro)) {
        ye.debug("MacroService", " registerMacro ");
        return;
      }
      const a = nt.get("apiSettings"), o = (a == null ? void 0 : a.customMacros) || [];
      this.cachedCustomMacros.clear();
      for (const l of o) {
        if (!l.enabled || !l.name) continue;
        this.cachedCustomMacros.set(l.name, l.content);
        const c = l.name;
        r.registerMacro(
          c,
          () => this.cachedCustomMacros.get(c) ?? "",
          `Engram : {{${c}}}`
        );
      }
      ye.debug("MacroService", "", {
        count: this.cachedCustomMacros.size,
        names: Array.from(this.cachedCustomMacros.keys())
      });
    } catch (r) {
      ye.warn("MacroService", "", r);
    }
  }
};
mt(Vr, "isInitialized", !1), // ---  ---
mt(Vr, "cachedSummaries", ""), mt(Vr, "cachedWorldbookContext", ""), mt(Vr, "cachedUserInput", ""), mt(Vr, "cachedCharDescription", ""), // V0.9: 
mt(Vr, "cachedGraphData", ""), // V0.9.2: 
mt(Vr, "cachedArchivedSummaries", ""), mt(Vr, "cachedUserPersona", ""), // V0.9.2: 
mt(Vr, "cachedCustomMacros", /* @__PURE__ */ new Map());
let co = Vr;
const Z9 = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  MacroService: co
}, Symbol.toStringTag, { value: "Module" })), C$ = [
  // 
  { pattern: /\n{3,}/g, replacement: `

`, description: "" },
  // 
  { pattern: /^[ \t]+|[ \t]+$/gm, replacement: "", description: "" },
  //  Markdown 
  { pattern: /```\w*\n?/g, replacement: "", description: "Markdown" },
  // 
  { pattern: /[""]/g, replacement: '"', description: "" },
  { pattern: /['']/g, replacement: "'", description: "" }
];
class J9 {
  constructor(t) {
    mt(this, "rules");
    this.rules = t || C$;
  }
  /**
   *  LLM 
   * @param text 
   * @returns 
   */
  clean(t) {
    let n = t;
    for (const r of this.rules)
      n = n.replace(r.pattern, r.replacement);
    return n.trim();
  }
  /**
   * 
   * @param summary 
   * @param metadata 
   */
  formatAsWorldEntry(t, n) {
    let a = `  [${`${n.floorRange[0]}-${n.floorRange[1]}`}]
`;
    return a += t, a;
  }
  /**
   * 
   * @param text 
   */
  extractPlainText(t) {
    return t.replace(/```[\s\S]*?```/g, "").replace(/\[([^\]]+)\]\([^)]+\)/g, "$1").replace(/[*_~`#]/g, "").replace(/\n{2,}/g, `
`).trim();
  }
  /**
   * 
   * @param text 
   * @param maxLength 
   * @param suffix 
   */
  truncate(t, n, r = "...") {
    return t.length <= n ? t : t.slice(0, n - r.length) + r;
  }
  /**
   * 
   */
  addRule(t) {
    this.rules.push(t);
  }
  /**
   * 
   */
  getRules() {
    return [...this.rules];
  }
}
const eA = new J9();
function oE() {
  try {
    return window.TavernHelper || null;
  } catch {
    return null;
  }
}
function E$() {
  var e, t, n, r;
  try {
    const a = (t = (e = window.SillyTavern) == null ? void 0 : e.getContext) == null ? void 0 : t.call(e);
    return ((r = (n = a == null ? void 0 : a.extensionSettings) == null ? void 0 : n.connectionManager) == null ? void 0 : r.profiles) || [];
  } catch {
    return [];
  }
}
class tA {
  /**
   *  LLM 
   * @param request 
   */
  async generate(t) {
    var r, a, o, l;
    const n = oE();
    if (!(n != null && n.generateRaw) && !(n != null && n.generate))
      return {
        success: !1,
        content: "",
        error: "TavernHelper "
      };
    try {
      let c;
      const d = nt.getSettings();
      let h;
      t.presetId && (h = (a = (r = d.apiSettings) == null ? void 0 : r.llmPresets) == null ? void 0 : a.find((A) => A.id === t.presetId)), !h && ((o = d.apiSettings) != null && o.selectedPresetId) && (h = (l = d.apiSettings.llmPresets) == null ? void 0 : l.find((A) => A.id === d.apiSettings.selectedPresetId));
      let p;
      if (h && h.source !== "tavern") {
        if (p = {}, ye.info("LLMAdapter", `: ${h.name} (${h.source})`), h.parameters && (p = {
          ...p,
          //  ST API 
          temperature: h.parameters.temperature,
          max_tokens: h.parameters.maxTokens,
          // ST API  max_tokens
          top_p: h.parameters.topP,
          frequency_penalty: h.parameters.frequencyPenalty,
          presence_penalty: h.parameters.presencePenalty
          //  rep_pen  frequency_penalty 
          // rep_pen: preset.parameters.frequencyPenalty,
        }), h.source === "custom" && h.custom)
          p.apiurl = h.custom.apiUrl, p.key = h.custom.apiKey, p.model = h.custom.model, p.source = h.custom.apiSource || "openai";
        else if (h.source === "tavern_profile" && h.tavernProfileId) {
          const z = E$().find((q) => q.id === h.tavernProfileId);
          z ? (ye.info("LLMAdapter", ` Profile: ${z.name}`), p.model = z.model, p.source = z.api, z["api-url"] ? p.apiurl = z["api-url"] : z.request_url ? p.apiurl = z.request_url : z.openai_url && (p.apiurl = z.openai_url), z.key ? p.key = z.key : z.request_apikey ? p.key = z.request_apikey : z.openai_key && (p.key = z.openai_key)) : (ye.warn("LLMAdapter", ` ID  ${h.tavernProfileId} `), p = void 0);
        }
      }
      const g = t.systemPrompt ? `${t.systemPrompt}

${t.userPrompt}` : t.userPrompt, x = {
        prompt: g,
        // 
        body: {
          messages: [
            { role: "system", content: t.systemPrompt },
            { role: "user", content: t.userPrompt }
          ]
        },
        // 
        is_engram: !0
        //  ()
      }, { EventBus: b, TavernEventType: C } = await Promise.resolve().then(() => X9);
      await b.emit(C.GENERATION_AFTER_COMMANDS, "engram", {}, !1), await b.emit(C.GENERATE_AFTER_DATA, x);
      const N = typeof x.prompt == "string" ? x.prompt : g;
      let T = t.systemPrompt, j = t.userPrompt;
      N !== g && (T = "", j = N);
      const { regexProcessor: R } = await Promise.resolve().then(() => S$);
      if (j = R.process(j, "input"), n.generateRaw) {
        const A = [];
        T && A.push({ role: "system", content: T }), A.push({ role: "user", content: j }), c = await n.generateRaw({
          ordered_prompts: A,
          custom_api: p
          // V0.8.6 Fix
        });
      } else if (n.generate)
        c = await n.generate({
          user_input: j,
          system_prompt: T,
          should_stream: !1,
          max_chat_history: 0,
          custom_api: p
          // V0.8.6 Fix
        });
      else
        throw new Error(" API");
      return {
        success: !0,
        content: c || ""
      };
    } catch (c) {
      const d = c instanceof Error ? c.message : String(c);
      return console.error("[Engram] LLMAdapter :", c), {
        success: !1,
        content: "",
        error: d
      };
    }
  }
  /**
   *  LLM API 
   */
  isAvailable() {
    const t = oE();
    return !!(t != null && t.generate || t != null && t.generateRaw);
  }
  /**
   *  Token 
   * @param text 
   */
  estimateTokens(t) {
    return Math.ceil(t.length / 3);
  }
}
const nd = new tA(), Gf = class Gf {
  constructor() {
    mt(this, "unsubscribers", []);
    mt(this, "callbacks", /* @__PURE__ */ new Map());
  }
  /**
   * 
   */
  static getInstance() {
    return Gf.instance || (Gf.instance = new Gf()), Gf.instance;
  }
  /**
   * 
   * 
   */
  start() {
    if (this.unsubscribers.length > 0) {
      console.log("[EventWatcher] Already started.");
      return;
    }
    this.unsubscribers.push(
      Ss.on(uo.MESSAGE_RECEIVED, () => this.emit("messageReceived")),
      Ss.on(uo.CHAT_CHANGED, () => this.emit("chatChanged")),
      Ss.on(uo.GENERATION_STARTED, () => this.emit("generationStarted")),
      Ss.on(uo.GENERATION_ENDED, () => this.emit("generationEnded"))
    ), console.log("[EventWatcher] Started, listening to core events.");
  }
  /**
   * 
   */
  stop() {
    this.unsubscribers.forEach((t) => t()), this.unsubscribers = [], console.log("[EventWatcher] Stopped.");
  }
  /**
   * 
   * @param event 
   * @param callback 
   * @returns 
   */
  on(t, n) {
    const r = this.mapEventKey(t);
    return this.callbacks.has(r) || this.callbacks.set(r, /* @__PURE__ */ new Set()), this.callbacks.get(r).add(n), () => {
      var a;
      (a = this.callbacks.get(r)) == null || a.delete(n);
    };
  }
  /**
   * 
   */
  emit(t) {
    const n = this.callbacks.get(t);
    n && n.forEach((r) => {
      try {
        r();
      } catch (a) {
        console.error(`[EventWatcher] Callback error for ${t}:`, a);
      }
    });
  }
  /**
   * 
   */
  mapEventKey(t) {
    return {
      onMessageReceived: "messageReceived",
      onChatChanged: "chatChanged",
      onGenerationStarted: "generationStarted",
      onGenerationEnded: "generationEnded"
    }[t];
  }
};
mt(Gf, "instance", null);
let $3 = Gf;
const Ux = $3.getInstance();
class KS {
  /**
   * Clean and parse JSON from a string.
   * @param input Raw string from LLM
   * @returns Parsed object or null if failed
   */
  static parse(t) {
    const n = Cs.process(t, "output"), r = this.extractJsonBlock(n);
    if (!r)
      return console.warn("[RobustJsonParser] No JSON block found."), null;
    try {
      return JSON.parse(r);
    } catch {
      const o = this.simpleRepair(r);
      try {
        return JSON.parse(o);
      } catch (l) {
        return console.error("[RobustJsonParser] Parse failed:", l), console.debug("[RobustJsonParser] Failed string:", r), null;
      }
    }
  }
  /**
   * Extracts the likely JSON part from a string.
   * Prioritizes ```json ... ``` blocks, then looks for outer { ... }.
   */
  static extractJsonBlock(t) {
    const n = t.match(/```(?:json)?\s*([\s\S]*?)```/i);
    if (n && n[1])
      return n[1].trim();
    const r = t.indexOf("{"), a = t.lastIndexOf("}");
    return r !== -1 && a !== -1 && a > r ? t.substring(r, a + 1) : null;
  }
  /**
   * Simple JSON repair logic
   * Fixes common LLM JSON errors:
   * - Trailing commas
   * - Unquoted keys (simple cases)
   * - Single quotes
   */
  static simpleRepair(t) {
    let n = t;
    return n = n.replace(/,\s*([}\]])/g, "$1"), n;
  }
}
class k$ {
  /**
   *  Pipeline
   * V0.6:  JSON Extractor LLM
   */
  async run(t) {
    const n = Oi.getState(), r = Date.now();
    try {
      if (console.log("[Pipeline] Starting..."), n.setProcessing(!0), !await n.initChat())
        return { success: !1, error: "No chat context available" };
      console.log(`[Pipeline] Chat database initialized (${Date.now() - r}ms)`);
      const o = KS.parse(t.jsonContent);
      if (!o || !o.events || o.events.length === 0)
        return console.warn("[Pipeline] No events found in JSON"), { success: !1, error: "No events in JSON content" };
      console.log(`[Pipeline] Parsed ${o.events.length} events from JSON (${Date.now() - r}ms)`);
      const l = [];
      for (const d of o.events) {
        const h = d.meta, p = [];
        h.time_anchor && p.push(h.time_anchor), h.location && p.push(h.location), h.role && h.role.length > 0 && p.push(h.role.join(", "));
        const g = p.length > 0 ? `(${p.join(" | ")}) ` : "", x = h.event ? `${h.event}:
` : "", b = [];
        h.logic && h.logic.length > 0 && b.push(`[: ${h.logic.join(", ")}]`), h.causality && b.push(`[: ${h.causality}]`);
        const C = b.length > 0 ? `
${b.join(" ")}` : "", N = `${x}${g}${d.summary}${C}`, T = await n.saveEvent({
          summary: N,
          structured_kv: {
            time_anchor: h.time_anchor || "",
            role: h.role || [],
            location: h.location || "",
            event: h.event || "",
            logic: h.logic || [],
            causality: h.causality || ""
          },
          significance_score: d.significance_score,
          level: 0,
          is_embedded: !1,
          // V0.7: 
          is_archived: !1,
          // V0.7: 
          source_range: {
            start_index: t.sourceRange.start,
            end_index: t.sourceRange.end
          }
        });
        l.push(T);
      }
      console.log(`[Pipeline] Saved ${l.length} events to DB (${Date.now() - r}ms)`);
      const { MacroService: c } = await Promise.resolve().then(() => Z9);
      await c.refreshCache(), console.log(`[Pipeline] Macro cache refreshed (${Date.now() - r}ms)`), await n.setLastSummarizedFloor(t.sourceRange.end);
      try {
        const { standaloneEmbeddingTrigger: d } = await Promise.resolve().then(() => lA);
        await d.checkAndTrigger();
      } catch (d) {
        console.warn("[Pipeline] Standalone embedding trigger check failed:", d);
      }
      return console.log(`[Pipeline] Completed successfully in ${Date.now() - r}ms`), { success: !0, events: l };
    } catch (a) {
      return console.error("[Pipeline] Failed:", a), { success: !1, error: String(a) };
    } finally {
      n.setProcessing(!1);
    }
  }
}
const N$ = new k$();
async function lE() {
  const { Logger: e } = await Promise.resolve().then(() => CS);
  await e.init(), e.info("STBridge", "Engram ...");
  const { SettingsManager: t } = await Promise.resolve().then(() => jS);
  t.initSettings(), e.info("STBridge", "SettingsManager initialized");
  try {
    const { checkTavernIntegration: r } = await Promise.resolve().then(() => X9), a = await r();
    e.info("TavernAPI", "", a);
  } catch (r) {
    e.warn("TavernAPI", "", { error: String(r) });
  }
  try {
    const { summarizerService: r } = await Promise.resolve().then(() => sl);
    r.start();
    const a = r.getStatus();
    e.info("Summarizer", "", a);
  } catch (r) {
    e.warn("Summarizer", "", { error: String(r) });
  }
  j$();
  const { ThemeManager: n } = await Promise.resolve().then(() => Yy);
  n.init();
  try {
    const { injector: r } = await Promise.resolve().then(() => mH);
    r.init(), e.info("Injector", "Service initialized");
  } catch (r) {
    e.warn("Injector", "Failed to initialize Injector", { error: String(r) });
  }
  try {
    const { MacroService: r } = await Promise.resolve().then(() => Z9);
    await r.init();
  } catch (r) {
    e.warn("MacroService", "Failed to initialize MacroService", { error: String(r) });
  }
  try {
    const { initQuickPanelButton: r } = await Promise.resolve().then(() => eH);
    r(), e.info("QuickPanelButton", "QR ");
  } catch (r) {
    e.warn("QuickPanelButton", "Failed to initialize QuickPanelButton", { error: String(r) });
  }
  R$();
  try {
    const { CharacterDeleteService: r } = await Promise.resolve().then(() => pH);
    r.init(), e.info("STBridge", "CharacterDeleteService initialized");
  } catch (r) {
    e.warn("STBridge", "Failed to initialize CharacterDeleteService", { error: String(r) });
  }
  e.success("STBridge", "Engram  - Where memories leave their trace.");
}
const nA = '<svg viewBox="0 0 400 592" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M103.875908,522.166260 C75.225380,521.276611 55.289425,503.229828 52.249313,475.852142 C49.879883,454.514191 63.027035,433.000366 83.930901,424.858398 C88.449257,423.098541 89.857674,420.860199 89.801926,416.150269 C89.555420,395.322357 89.621246,374.489380 89.762306,353.659515 C89.787170,349.987000 88.728760,348.057556 85.120293,346.642609 C64.672897,338.625031 52.338894,320.951630 52.085896,299.869415 C51.832878,278.785156 63.730618,260.903198 84.118019,252.449951 C88.288918,250.720566 89.867378,248.680847 89.807304,244.052597 C89.539139,223.391968 89.589142,202.724701 89.796356,182.062561 C89.836380,178.071609 88.518524,176.326385 84.841705,174.787247 C57.730556,163.438416 45.530682,135.966721 55.436111,109.194000 C62.627293,89.757439 81.922821,76.710289 103.282494,76.841476 C124.355003,76.970901 143.082275,89.740875 149.993118,109.121849 C151.315979,112.831749 153.184799,113.869263 156.863403,113.853104 C186.192612,113.724319 215.522736,113.698357 244.851929,113.811600 C248.773117,113.826736 250.677307,112.652130 252.052902,108.765602 C259.013885,89.098465 278.589447,76.365829 300.503601,76.811897 C322.171844,77.252960 341.040283,91.132324 347.255371,111.201912 C356.569763,141.279358 340.344788,170.373184 309.893127,176.623123 C283.359375,182.068970 260.376740,167.450562 251.980011,145.670181 C250.492157,141.810806 248.818085,140.240295 244.552948,140.266785 C215.390915,140.447968 186.227219,140.357330 157.064072,140.375076 C154.628784,140.376556 151.855545,139.805771 151.141357,143.359161 C150.400787,147.043839 146.628937,150.064713 151.136917,154.478546 C184.592346,187.235229 217.778336,220.267349 250.982285,253.280014 C253.021469,255.307434 254.527191,255.254166 257.033264,254.047714 C276.199188,244.820953 294.752930,247.045853 310.978485,259.993408 C328.011017,273.584869 333.936798,292.106659 327.764038,313.282837 C321.779785,333.812378 307.254517,345.637268 286.367889,349.037231 C276.405396,350.658997 266.352570,349.443024 257.275055,344.363342 C254.265045,342.678986 252.301132,343.049744 249.903275,345.441406 C230.205368,365.088531 210.395386,384.623230 190.631638,404.204376 C177.732651,416.984222 164.859726,429.790344 151.962982,442.572388 C148.257980,446.244415 148.113403,452.901764 151.629196,456.671387 C152.707138,457.827148 154.029282,457.681976 155.328629,457.681946 C185.658203,457.681458 215.987854,457.631042 246.317261,457.695557 C249.355972,457.702026 250.687012,456.399414 251.717636,453.698944 C259.314423,433.793579 278.324493,420.868317 299.341309,421.146240 C320.526215,421.426361 339.575745,434.206421 346.686249,452.909271 C354.337341,473.034058 348.794159,495.642761 332.699371,509.956390 C307.061371,532.757202 263.380280,521.715210 251.978027,489.436371 C250.838303,486.209961 249.371201,484.953583 245.964813,484.962799 C216.302094,485.043304 186.639008,484.985840 156.976028,484.969330 C154.436981,484.967896 152.081528,484.923981 150.916916,488.054077 C142.892441,509.621246 126.842339,520.325989 103.875908,522.166260 M141.430466,266.110352 C145.394760,270.906738 148.503693,276.196198 150.388428,282.139069 C151.211502,284.734314 152.692291,285.770782 155.494156,285.760895 C179.139755,285.677429 202.787949,285.547394 226.430206,285.843811 C232.373352,285.918304 231.388184,281.058533 233.335602,278.254700 C235.007233,275.847992 233.916855,274.189880 232.000244,272.304352 C199.956863,240.780380 167.866821,209.301468 136.133682,177.467056 C131.183243,172.500824 127.483856,170.729507 121.013550,174.621368 C117.660522,176.638214 116.183739,178.155136 116.217278,182.042480 C116.398239,203.022598 116.444160,224.006012 116.243645,244.985474 C116.204666,249.064667 117.676285,250.918961 121.328865,252.228989 C128.972488,254.970444 135.505173,259.524170 141.430466,266.110352 M116.349434,377.499908 C116.351860,390.663696 116.870338,403.855377 116.161102,416.980713 C115.742699,424.723846 121.926743,423.801880 125.649162,426.262665 C129.080231,428.530792 130.798965,425.706268 132.741440,423.784821 C165.551407,391.329803 198.234940,358.745361 231.274231,326.525696 C235.764252,322.147095 232.377243,319.155212 231.599960,315.493317 C230.884583,312.123138 228.193359,312.382568 225.670288,312.382812 C202.675171,312.384949 179.679749,312.445435 156.685303,312.323212 C153.331955,312.305389 151.624329,313.386505 150.456299,316.584381 C145.119888,331.194611 135.004120,341.287384 120.496223,346.769958 C117.238434,348.001068 116.190170,349.706024 116.267418,353.006317 C116.450615,360.833862 116.340004,368.668243 116.349434,377.499908z"/></svg>';
function j$() {
  const e = document.querySelector("#top-settings-holder"), t = document.querySelector("#WI-SP-button");
  if (!e) {
    console.warn("[Engram] #top-settings-holder not found, fallback to floating orb"), T$();
    return;
  }
  const n = document.createElement("div");
  n.id = "engram-drawer", n.className = "drawer";
  const r = document.createElement("div");
  r.className = "drawer-toggle drawer-header";
  const a = document.createElement("div");
  a.id = "engram-drawer-icon", a.className = "drawer-icon fa-fw closedIcon", a.title = "Engram - ", a.setAttribute("data-i18n", "[title]Engram - Memory OS"), a.innerHTML = nA, a.addEventListener("click", p1), r.appendChild(a), n.appendChild(r), t ? (e.insertBefore(n, t), console.log("[Engram] Top bar button injected before WI-SP-button")) : (e.appendChild(n), console.log("[Engram] Top bar button injected at end (WI-SP-button not found)"));
}
function T$() {
  const e = document.createElement("div");
  e.className = "fixed bottom-5 right-5 w-12 h-12 rounded-full cursor-pointer z-[9999] flex items-center justify-center transition-transform duration-200 bg-gradient-to-br from-orange-500 to-pink-500 shadow-[0_0_20px_rgba(249,115,22,0.5)] hover:scale-110 hover:shadow-[0_0_30px_rgba(249,115,22,0.7)] text-white", e.title = "Engram - ", e.innerHTML = nA, e.addEventListener("click", p1), document.body.appendChild(e);
}
let m1 = null;
function A$(e) {
  m1 = e, m1 = e;
}
let H3 = null, uE = null;
function M$(e) {
  H3 = e;
}
function R$() {
  if (!H3) {
    console.warn("[Engram] Global renderer not ready");
    return;
  }
  const e = "engram-global-overlay";
  let t = document.getElementById(e);
  t || (t = document.createElement("div"), t.id = e, t.className = "pointer-events-none fixed inset-0 z-[11000]", document.body.appendChild(t)), uE || (uE = H3(t, () => {
  }), console.log("[Engram] Global overlay mounted"));
}
let $x = !1, Yp = null, Qy = null;
function p1() {
  $x && Yp ? (Qy && (Qy.unmount(), Qy = null), Yp.remove(), Yp = null, $x = !1) : (Yp = O$(), document.body.appendChild(Yp), $x = !0);
}
function O$() {
  var t;
  const e = document.createElement("div");
  return e.className = "fixed inset-0 w-full h-full z-[10000] flex flex-col bg-background text-foreground overflow-hidden", e.style.backgroundColor = "var(--background)", e.style.color = "var(--foreground)", e.style.height = "100dvh", e.style.width = "100vw", e.style.top = "0", e.style.left = "0", e.id = "engram-panel-root", m1 ? Qy = m1(e, p1) : (e.innerHTML = `
            <div class="flex items-center justify-between p-4 border-b border-slate-400/20">
                <h2 class="m-0 text-lg text-slate-200 flex items-center gap-2"> Engram</h2>
                <button class="bg-transparent border-none text-slate-400 text-2xl cursor-pointer p-1 hover:text-slate-200">&times;</button>
            </div>
            <div class="flex-1 overflow-auto p-5">
                <p style="color: #94a3b8;">React </p>
            </div>
        `, (t = e.querySelector("button")) == null || t.addEventListener("click", p1)), e;
}
async function z$(e, t) {
  try {
    const r = await new Function("path", "return import(path)")("/scripts/chats.js");
    r && typeof r.hideChatMessageRange == "function" ? (await r.hideChatMessageRange(e, t, !1), console.log(`[Engram] Hidden messages range: ${e}-${t}`)) : console.warn("[Engram] hideChatMessageRange not found in chats.js");
  } catch (n) {
    console.error("[Engram] Failed to hide messages:", n);
  }
}
async function D$(e, t = "text", n = "") {
  return window.callPopup ? window.callPopup(e, t, n) : (console.warn("[Engram] callPopup not available"), Promise.resolve(t === "confirm" ? !0 : null));
}
class I$ {
  /**
   * 
   * @returns Promise<string> 
   * @throws Error 
   */
  async requestRevision(t, n, r) {
    return new Promise((a, o) => {
      Ss.emit(uo.ENGRAM_REQUEST_REVISION, {
        title: t,
        description: n,
        content: r,
        onConfirm: (l) => a(l),
        onCancel: () => o(new Error("User cancelled revision"))
      });
    });
  }
}
const YS = new I$(), rA = {
  enabled: !0,
  triggerMode: "auto",
  floorInterval: 10,
  worldbookMode: "chat",
  previewEnabled: !0,
  promptTemplateId: null,
  // 
  llmPresetId: null,
  // 
  bufferSize: 3,
  //  3 
  autoHide: !1
  // 
}, Ah = "engram";
function cE() {
  var e, t;
  try {
    return ((t = (e = window.SillyTavern) == null ? void 0 : e.getContext) == null ? void 0 : t.call(e)) || null;
  } catch {
    return null;
  }
}
function fE() {
  var e, t;
  try {
    const n = (t = (e = window.SillyTavern) == null ? void 0 : e.getContext) == null ? void 0 : t.call(e);
    return n != null && n.chat_metadata ? n.chat_metadata : window.chat_metadata || null;
  } catch {
    return null;
  }
}
function L$() {
  var e;
  try {
    (e = window.saveChatDebounced) == null || e.call(window);
  } catch {
    console.warn("[Engram] saveChatDebounced ");
  }
}
class iA {
  constructor(t, n, r) {
    mt(this, "config");
    mt(this, "textProcessor");
    mt(this, "llmAdapter");
    mt(this, "currentChatId", null);
    mt(this, "isRunning", !1);
    mt(this, "isSummarizing", !1);
    mt(this, "cancelRequested", !1);
    // 
    mt(this, "unsubscribeMessage", null);
    mt(this, "unsubscribeChat", null);
    mt(this, "summaryHistory", []);
    // 
    mt(this, "_lastSummarizedFloor", 0);
    const a = nt.get("summarizerConfig");
    this.config = { ...rA, ...a, ...t }, this.textProcessor = n || eA, this.llmAdapter = r || nd;
  }
  // ====================  ====================
  // getInfoFromChatMetadata  saveToChatMetadata 
  //  WorldBookStateService
  /**
   * 
   */
  getFromChatMetadata(t) {
    const n = fE();
    if (n)
      return n.extensions || (n.extensions = {}), n.extensions[Ah] || (n.extensions[Ah] = {}), n.extensions[Ah][t];
  }
  /**
   * 
   */
  saveToChatMetadata(t, n) {
    const r = fE();
    r && (r.extensions || (r.extensions = {}), r.extensions[Ah] || (r.extensions[Ah] = {}), r.extensions[Ah][t] = n, this.log("debug", ` chat_metadata: ${t} = ${n}`), L$());
  }
  /**
   * 
   * V0.5:  memoryStore 
   * V0.8:  chatManager.getState() 
   */
  async getLastSummarizedFloor() {
    if (this._lastSummarizedFloor > 0) return this._lastSummarizedFloor;
    try {
      const { chatManager: t } = await Promise.resolve().then(() => v$), n = await t.getState();
      return this._lastSummarizedFloor = n.last_summarized_floor, this.log("debug", " DB  lastSummarizedFloor", { value: this._lastSummarizedFloor }), this._lastSummarizedFloor;
    } catch (t) {
      return this.log("warn", " lastSummarizedFloor  0", t), 0;
    }
  }
  /**
   * 
   * V0.5:  memoryStore (IndexedDB)
   */
  async setLastSummarizedFloor(t) {
    this._lastSummarizedFloor = t, await Oi.getState().setLastSummarizedFloor(t);
  }
  // ====================  ====================
  /**
   * 
   */
  getCurrentFloor() {
    const t = cE();
    return t != null && t.chat ? t.chat.length : 0;
  }
  /**
   *  ID
   */
  getCurrentChatId() {
    const t = cE();
    return (t == null ? void 0 : t.chatId) || null;
  }
  // ====================  ====================
  /**
   * 
   * V0.5:  EventWatcher 
   */
  start() {
    if (this.isRunning) {
      this.log("warn", "");
      return;
    }
    this.initializeForCurrentChat(), Ux.start(), this.config.triggerMode === "auto" && (this.unsubscribeMessage = Ux.on(
      "onMessageReceived",
      this.handleMessageReceived.bind(this)
    ), this.log("debug", " EventWatcher ")), this.unsubscribeChat = Ux.on(
      "onChatChanged",
      this.handleChatChanged.bind(this)
    ), this.log("debug", " EventWatcher "), this.isRunning = !0;
    const t = this.getStatus();
    this.log("info", "", t);
  }
  /**
   *  ( 0)
   */
  async resetProgress() {
    await this.setLastSummarizedFloor(0), this.log("info", "");
  }
  /**
   * 
   */
  stop() {
    this.unsubscribeMessage && (this.unsubscribeMessage(), this.unsubscribeMessage = null), this.unsubscribeChat && (this.unsubscribeChat(), this.unsubscribeChat = null), this.isRunning = !1, this.log("info", "");
  }
  /**
   * 
   */
  async initializeForCurrentChat() {
    const t = this.getCurrentChatId(), n = this.getCurrentFloor();
    this.currentChatId = t, this.summaryHistory = [], this._lastSummarizedFloor = 0;
    const r = await this.getLastSummarizedFloor();
    this.log("info", "", {
      chatId: t,
      currentFloor: n,
      lastSummarizedFloor: r,
      pendingFloors: n - r
    });
  }
  // ====================  ====================
  /**
   * 
   * V0.9.1:  Summary 
   */
  async handleMessageReceived() {
    const t = this.getCurrentFloor(), n = await this.getLastSummarizedFloor(), r = t - n;
    this.log("debug", "", {
      currentFloor: t,
      lastSummarized: n,
      pendingFloors: r,
      triggerAt: this.config.floorInterval
    }), await this.checkEntityExtraction(t), r >= this.config.floorInterval && (this.log("info", "", {
      pendingFloors: r,
      interval: this.config.floorInterval
    }), await this.triggerSummary());
  }
  /**
   * V0.9.1: 
   *  Summary 
   */
  async checkEntityExtraction(t) {
    try {
      const { entityBuilder: n } = await Promise.resolve().then(() => gH);
      if (n.shouldTriggerOnFloor(t)) {
        this.log("info", "", { floor: t });
        const r = await co.getChatHistory("50");
        n.extractFromChat(r, t, !1).catch((a) => {
          this.log("warn", "", { error: a });
        });
      }
    } catch (n) {
      this.log("warn", "", { error: n });
    }
  }
  /**
   * 
   */
  handleChatChanged() {
    const t = this.getCurrentChatId();
    this.log("info", "", {
      from: this.currentChatId,
      to: t
    }), this.initializeForCurrentChat();
  }
  // ====================  ====================
  /**
   * /
   */
  async triggerSummary(t = !1) {
    var o, l, c;
    if (this.isSummarizing)
      return this.log("warn", ""), null;
    if (!this.config.enabled && !t)
      return this.log("debug", ""), null;
    const n = this.getCurrentFloor(), r = await this.getLastSummarizedFloor();
    this.isSummarizing = !0, this.cancelRequested = !1, this.log("info", "", {
      floorRange: [r + 1, n],
      manual: t
    });
    const a = Kt.running("...", "Engram", () => {
      var d, h, p, g;
      this.cancelRequested = !0, this.log("info", "");
      try {
        (g = (p = (h = (d = window.SillyTavern) == null ? void 0 : d.getContext) == null ? void 0 : h.call(d)) == null ? void 0 : p.stopGeneration) == null || g.call(p), this.log("info", " stopGeneration");
      } catch (x) {
        this.log("warn", " stopGeneration ", x);
      }
      Kt.warning("...", "Engram");
    });
    try {
      const { WorldBookSlotService: d } = await Promise.resolve().then(() => yH);
      await d.init();
      const h = this._lastSummarizedFloor + 1, p = this.config.bufferSize || 0, g = n - p;
      if (h > g)
        return t && Kt.info(" ()", "Engram"), null;
      const x = this.config.floorInterval || 10, b = h + x - 1, C = Math.min(g, b);
      if (h > C)
        return null;
      const N = [h, C];
      this.log("info", "", { startFloor: h, endFloor: C, currentFloor: n, buffer: p });
      const j = I7().slice(h - 1, C);
      if (this.log("info", "", {
        range: N,
        msgCount: j.length,
        firstMsg: (((o = j[0]) == null ? void 0 : o.mes) || "").substring(0, 20)
      }), j.length === 0)
        return this.log("warn", "", { floorRange: N }), null;
      const R = {
        messages: j.map((U) => {
          const ue = U.mes || U.content || U.message || "";
          return ue || console.warn("[Engram] Message content is empty/undefined:", U), {
            role: U.is_user ? "user" : "assistant",
            content: ue,
            name: U.name
          };
        }),
        floorRange: N,
        templateId: this.config.promptTemplateId || void 0
      }, A = j.map((U) => U.mes || U.content || U.message || "").join(`

`), z = Cs.process(A, "input");
      this.log("debug", "", {
        originalLength: A.length,
        cleanedLength: z.length
      });
      let q = "";
      try {
        const U = await mn.getActivatedWorldInfo();
        U && (q = `
` + U + `

`, this.log("debug", "", { length: U.length }));
      } catch (U) {
        this.log("warn", "", { error: String(U) });
      }
      const D = nt.getEnabledPromptTemplate("summary"), P = L1("summary"), re = (D == null ? void 0 : D.systemPrompt) || (P == null ? void 0 : P.systemPrompt) || "", ie = (D == null ? void 0 : D.userPromptTemplate) || (P == null ? void 0 : P.userPromptTemplate) || "";
      let X = "";
      try {
        X = await mn.getEngramSummariesContent(), X && this.log("debug", " Engram ", { length: X.length });
      } catch (U) {
        this.log("warn", " Engram ", { error: String(U) });
      }
      const K = ie.replace("{{worldbookContext}}", q).replace("{{chatHistory}}", z).replace("{{context}}", q).replace("{{engramSummaries}}", X);
      this.log("debug", "", {
        source: D ? "APIPresets" : "fallback",
        templateName: (D == null ? void 0 : D.name) || "default"
      });
      const V = ns.logSend({
        type: "summarize",
        systemPrompt: re,
        userPrompt: K,
        floorRange: R.floorRange,
        model: P1(),
        character: (l = $h()) == null ? void 0 : l.name
      }), de = Date.now(), H = await this.llmAdapter.generate({
        systemPrompt: re,
        userPrompt: K
      });
      if (ns.logReceive(V, {
        response: H.content,
        status: H.success ? "success" : "error",
        error: H.error,
        duration: Date.now() - de
      }), !H.success)
        return this.log("error", "LLM ", { error: H.error }), Kt.error(`: ${H.error}`, "Engram "), null;
      if (this.cancelRequested)
        return this.log("info", ""), Kt.info("", "Engram"), null;
      const se = this.textProcessor.clean(H.content), Z = Cs.process(se, "output"), fe = await mn.countTokens(Z), he = {
        id: Date.now().toString(),
        content: Z,
        sourceFloors: R.floorRange,
        timestamp: Date.now(),
        tokenCount: fe,
        writtenToWorldbook: !1
      };
      if (this.config.previewEnabled) {
        this.log("info", "", { result: he });
        try {
          const U = await YS.requestRevision(
            "",
            `: ${R.floorRange[0]} - ${R.floorRange[1]}  | Token: ${fe}`,
            he.content
          );
          he.content = U, he.tokenCount = await mn.countTokens(U), this.log("info", "");
        } catch {
          return this.log("warn", ""), Kt.info("", ""), null;
        }
      }
      const ge = hi(), Q = $h();
      if (ge && Q)
        try {
          const U = await N$.run({
            jsonContent: he.content,
            //  JSON
            sourceRange: {
              start: R.floorRange[0],
              end: R.floorRange[1]
            }
          });
          U.success ? this.log("info", "Pipeline ", {
            eventsCount: ((c = U.events) == null ? void 0 : c.length) || 0
          }) : this.log("warn", "Pipeline ", { error: U.error });
        } catch (U) {
          this.log("error", "Pipeline ", { error: String(U) });
        }
      if (he.writtenToWorldbook = !0, await this.setLastSummarizedFloor(R.floorRange[1]), this.summaryHistory.push(he), Kt.success(` ${R.floorRange[0]}-${R.floorRange[1]} `, "Engram"), this.config.autoHide) {
        const U = R.floorRange[0] - 1, ue = R.floorRange[1] - 1;
        this.log("info", "", { startIndex: U, endIndex: ue }), z$(U, ue).catch((Y) => {
          this.log("error", "", Y);
        });
      }
      return he;
    } catch (d) {
      const h = d instanceof Error ? d.message : String(d);
      return this.log("error", "", { error: h }), Kt.error(`: ${h}`, "Engram "), null;
    } finally {
      Kt.remove(a), this.isSummarizing = !1;
    }
  }
  // ====================  ====================
  /**
   * 
   */
  getStatus() {
    const t = this.getCurrentFloor(), n = this._lastSummarizedFloor;
    return {
      running: this.isRunning,
      currentFloor: t,
      lastSummarizedFloor: n,
      pendingFloors: Math.max(0, t - n),
      historyCount: this.summaryHistory.length,
      isSummarizing: this.isSummarizing
    };
  }
  /**
   * 
   */
  refreshStatus() {
    return this.initializeForCurrentChat(), this.getStatus();
  }
  /**
   * 
   */
  getConfig() {
    return { ...this.config };
  }
  /**
   * 
   */
  updateConfig(t) {
    this.config = { ...this.config, ...t }, nt.set("summarizerConfig", this.config), this.log("debug", "", this.config);
  }
  /**
   * 
   */
  getHistory() {
    return [...this.summaryHistory];
  }
  /**
   * 
   */
  async resetBaseFloor() {
    const t = this.getCurrentFloor();
    await this.setLastSummarizedFloor(t), this.log("info", "", { currentFloor: t });
  }
  // ====================  ====================
  /**
   * 
   */
  async log(t, n, r) {
    try {
      const { Logger: a } = await Promise.resolve().then(() => CS);
      a[t]("Summarizer", n, r);
    } catch {
      console.log(`[Summarizer] ${t}: ${n}`, r);
    }
  }
}
const cl = new iA(), aA = {
  ...O7,
  keepRecentCount: 3,
  preserveOriginal: !1,
  previewEnabled: !0
};
class sA {
  constructor(t, n) {
    mt(this, "config");
    mt(this, "llmAdapter");
    mt(this, "isTrimming", !1);
    const r = nt.get("trimmerConfig") || {};
    this.config = { ...aA, ...r, ...t }, this.llmAdapter = n || nd;
  }
  // ====================  ====================
  /**
   * 
   */
  getConfig() {
    return { ...this.config };
  }
  /**
   * 
   */
  updateConfig(t) {
    this.config = { ...this.config, ...t };
    const n = nt.get("summarizerConfig") || {};
    nt.set("summarizerConfig", {
      ...n,
      trimmer: this.config
    }), this.log("debug", "", this.config);
  }
  // ====================  ====================
  /**
   * 
   */
  async getStatus() {
    const t = mn.findExistingWorldbook();
    if (!t)
      return {
        triggered: !1,
        triggerType: this.config.trigger,
        currentValue: 0,
        threshold: this.getThreshold(),
        pendingEntryCount: 0,
        isTrimming: this.isTrimming
      };
    const n = await mn.getSummaryEntries(t), r = Math.max(0, n.length - this.config.keepRecentCount), a = await this.getCurrentTriggerValue(t, n), o = this.getThreshold();
    return {
      triggered: this.config.enabled && a >= o,
      triggerType: this.config.trigger,
      currentValue: a,
      threshold: o,
      pendingEntryCount: r,
      isTrimming: this.isTrimming
    };
  }
  /**
   * 
   */
  getThreshold() {
    switch (this.config.trigger) {
      case "token":
        return this.config.tokenLimit;
      case "count":
        return this.config.countLimit;
      default:
        return 0;
    }
  }
  /**
   * 
   */
  async getCurrentTriggerValue(t, n) {
    switch (this.config.trigger) {
      case "token":
        return await mn.countSummaryTokens(t);
      case "count":
        return n.length;
      default:
        return 0;
    }
  }
  /**
   * 
   */
  async checkTrigger() {
    return (await this.getStatus()).triggered;
  }
  // ====================  ====================
  /**
   * 
   *  N 
   */
  async getEntriesToMerge() {
    const t = mn.findExistingWorldbook();
    if (!t) return [];
    const n = await mn.getSummaryEntries(t), r = this.config.keepRecentCount;
    return n.length <= r ? [] : n.slice(0, n.length - r);
  }
  /**
   * /
   */
  async triggerTrim(t = !1) {
    var a;
    if (this.isTrimming)
      return this.log("warn", ""), null;
    if (!this.config.enabled && !t)
      return this.log("debug", ""), null;
    const n = mn.findExistingWorldbook();
    if (!n)
      return this.log("warn", ""), Kt.warning(" Engram ", "Engram"), null;
    const r = await this.getEntriesToMerge();
    if (r.length < 2)
      return t && Kt.info(" ( 2 )", "Engram"), null;
    this.isTrimming = !0, this.log("info", "", {
      entryCount: r.length,
      manual: t
    });
    try {
      const o = r.map((P) => mn.parseFloorRangeFromName(P.name)).filter((P) => P !== null);
      if (o.length === 0)
        return this.log("error", ""), null;
      const l = Math.min(...o.map((P) => P[0])), c = Math.max(...o.map((P) => P[1])), d = [l, c], h = r.map((P) => {
        const re = mn.parseFloorRangeFromName(P.name), ie = re ? `${re[0]}-${re[1]}` : `${P.name}`, X = P.content.replace(/\{\{\/\/.*?\}\}/gs, "").trim();
        return `${ie}
${X}`;
      }).join(`

---

`), p = nt.getEnabledPromptTemplate("trim"), g = L1("trim"), x = (p == null ? void 0 : p.systemPrompt) || (g == null ? void 0 : g.systemPrompt) || "", C = ((p == null ? void 0 : p.userPromptTemplate) || (g == null ? void 0 : g.userPromptTemplate) || "").replace("{{engramSummaries}}", h).replace("{{context}}", h);
      this.log("debug", "", {
        source: p ? "APIPresets" : "fallback",
        templateName: (p == null ? void 0 : p.name) || "default",
        inputLength: h.length
      });
      const N = ns.logSend({
        type: "trim",
        systemPrompt: x,
        userPrompt: C,
        floorRange: d,
        model: P1(),
        character: (a = $h()) == null ? void 0 : a.name
      }), T = Date.now(), j = await this.llmAdapter.generate({
        systemPrompt: x,
        userPrompt: C
      });
      if (ns.logReceive(N, {
        response: j.content,
        status: j.success ? "success" : "error",
        error: j.error,
        duration: Date.now() - T
      }), !j.success)
        return this.log("error", "LLM ", { error: j.error }), Kt.error(`: ${j.error}`, "Engram "), null;
      const R = Cs.process(j.content, "output"), A = await mn.countTokens(R), z = Math.min(...r.map((P) => P.order)), q = {
        content: R,
        tokenCount: A,
        sourceEntryIds: r.map((P) => P.uid),
        newFloorRange: d,
        newOrder: z
      };
      if (this.config.previewEnabled) {
        this.log("info", "", { result: q });
        try {
          const P = await YS.requestRevision(
            "",
            ` ${r.length}  | : ${d[0]}-${d[1]}  | Token: ${A}`,
            q.content
          );
          q.content = P, q.tokenCount = await mn.countTokens(P), this.log("info", "");
        } catch {
          return this.log("warn", ""), Kt.info("", ""), null;
        }
      }
      return await this.writeCompactedEntry(n, q) ? (await this.removeOriginalEntries(n, q.sourceEntryIds), Kt.success(
        ` ${r.length}  1  (${d[0]}-${d[1]} )`,
        "Engram"
      ), q) : (this.log("error", ""), null);
    } catch (o) {
      const l = o instanceof Error ? o.message : String(o);
      return this.log("error", "", { error: l }), Kt.error(`: ${l}`, "Engram "), null;
    } finally {
      this.isTrimming = !1;
    }
  }
  /**
   * 
   */
  async writeCompactedEntry(t, n) {
    try {
      const r = `{{// ${JSON.stringify({
        floors: n.newFloorRange,
        tokens: n.tokenCount,
        timestamp: Date.now(),
        layer: 2,
        // 
        mergedFrom: n.sourceEntryIds.length
      })} }}`, a = `${n.content}

${r}`, o = await mn.createEntry(t, {
        name: `_${n.newFloorRange[0]}-${n.newFloorRange[1]}`,
        content: a,
        keys: [ug],
        // 
        enabled: !0,
        constant: !0,
        order: n.newOrder
      });
      return o && this.log("success", "", {
        worldbook: t,
        floorRange: n.newFloorRange,
        order: n.newOrder
      }), o;
    } catch (r) {
      return this.log("error", "", { error: String(r) }), !1;
    }
  }
  /**
   * /
   */
  async removeOriginalEntries(t, n) {
    if (this.config.preserveOriginal) {
      for (const r of n)
        await mn.updateEntry(t, r, { enabled: !1 });
      this.log("info", "", { count: n.length });
    } else
      await mn.deleteEntries(t, n) && this.log("info", "", { count: n.length });
  }
  // ====================  ====================
  /**
   * 
   */
  log(t, n, r) {
    ye[t]("Trimmer", n, r);
  }
}
new sA();
const sl = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  DEFAULT_REGEX_RULES: Gh,
  DEFAULT_SUMMARIZER_CONFIG: rA,
  DEFAULT_TRIMMER_CONFIG: aA,
  LLMAdapter: tA,
  RegexProcessor: H1,
  SummarizerService: iA,
  TextProcessor: J9,
  TrimmerService: sA,
  llmAdapter: nd,
  regexProcessor: Cs,
  summarizerService: cl,
  textProcessor: eA
}, Symbol.toStringTag, { value: "Module" })), yg = {
  enabled: !1,
  templateId: "query_enhance",
  autoTrigger: !0,
  preview: !0
  // 
};
function P$(e = 2e3) {
  const [t, n] = G.useState(!0), [r, a] = G.useState({
    isConnected: !1,
    characterName: "Unknown",
    currentFloor: 0,
    lastSummarizedFloor: 0,
    pendingFloors: 0,
    floorInterval: 10,
    isSummarizing: !1
  }), [o, l] = G.useState({
    eventCount: 0,
    entityCount: 0,
    entityByType: {},
    archivedCount: 0,
    activeCount: 0,
    estimatedTokens: 0
  }), [c, d] = G.useState({
    summarizer: !0,
    entity: !1,
    embedding: !1,
    recall: !0,
    preprocessing: !1
  }), h = Oi((b) => b.getAllEvents), p = Oi((b) => b.getAllEntities), g = G.useCallback(async () => {
    try {
      const b = pl(), C = cl.getStatus(), N = nt.get("summarizerConfig") || {};
      a({
        isConnected: !!b,
        characterName: (b == null ? void 0 : b.name2) || "Unknown",
        currentFloor: C.currentFloor,
        lastSummarizedFloor: C.lastSummarizedFloor,
        pendingFloors: C.pendingFloors,
        floorInterval: N.floorInterval || 10,
        isSummarizing: C.isSummarizing
      });
      const T = await h(), j = await p(), R = {};
      j.forEach((X) => {
        R[X.type] = (R[X.type] || 0) + 1;
      });
      const A = T.filter((X) => X.is_archived), z = T.reduce((X, K) => {
        var V;
        return X + Math.ceil((((V = K.summary) == null ? void 0 : V.length) || 0) / 4);
      }, 0);
      l({
        eventCount: T.length,
        entityCount: j.length,
        entityByType: R,
        archivedCount: A.length,
        activeCount: T.length - A.length,
        estimatedTokens: z
      });
      const q = nt.get("apiSettings"), D = q == null ? void 0 : q.entityExtractConfig, P = q == null ? void 0 : q.embeddingConfig, re = q == null ? void 0 : q.recallConfig, ie = nt.get("preprocessingConfig");
      d({
        summarizer: N.enabled !== !1,
        entity: (D == null ? void 0 : D.enabled) || !1,
        embedding: (P == null ? void 0 : P.enabled) || !1,
        recall: (re == null ? void 0 : re.enabled) !== !1,
        preprocessing: (ie == null ? void 0 : ie.enabled) || !1
      }), n(!1);
    } catch (b) {
      console.error("[useDashboardData] Error refreshing data:", b), n(!1);
    }
  }, [h, p]), x = G.useCallback((b) => {
    const C = nt.get("apiSettings") || {}, N = nt.get("summarizerConfig") || {};
    switch (b) {
      case "summarizer":
        const T = !c.summarizer;
        nt.set("summarizerConfig", {
          ...N,
          enabled: T
        }), cl.updateConfig({ enabled: T });
        break;
      case "entity":
        const j = (C == null ? void 0 : C.entityExtractConfig) || {};
        nt.set("apiSettings", {
          ...C,
          entityExtractConfig: {
            ...j,
            enabled: !c.entity
          }
        });
        break;
      case "embedding":
        const R = (C == null ? void 0 : C.embeddingConfig) || {};
        nt.set("apiSettings", {
          ...C,
          embeddingConfig: {
            ...R,
            enabled: !c.embedding
          }
        });
        break;
      case "recall":
        const A = (C == null ? void 0 : C.recallConfig) || {};
        nt.set("apiSettings", {
          ...C,
          recallConfig: {
            ...A,
            enabled: !c.recall
          }
        });
        break;
      case "preprocessing":
        const z = nt.get("preprocessingConfig") || yg, q = !c.preprocessing;
        nt.set("preprocessingConfig", {
          ...z,
          enabled: q
        }), Promise.resolve().then(() => vI).then(({ getDefaultAPISettings: D }) => {
          const re = nt.get("apiSettings") || D(), ie = re.recallConfig || {};
          nt.set("apiSettings", {
            ...re,
            recallConfig: {
              ...ie,
              usePreprocessing: q
            }
          });
        });
        break;
    }
    g();
  }, [c, g]);
  return G.useEffect(() => {
    g();
    const b = setInterval(g, e);
    return () => clearInterval(b);
  }, [g, e]), {
    system: r,
    memory: o,
    features: c,
    isLoading: t,
    toggleFeature: x,
    refresh: g
  };
}
const q$ = (e) => {
  switch (e) {
    case 0:
      return "text-muted-foreground";
    case 1:
      return "text-primary";
    case 2:
      return "text-green-400";
    case 3:
      return "text-yellow-400";
    case 4:
      return "text-red-400";
    default:
      return "text-primary";
  }
}, B$ = [
  { key: "summarizer", label: "", desc: "", icon: r7 },
  { key: "entity", label: "", desc: "/", icon: l7 },
  { key: "embedding", label: "", desc: "", icon: Es },
  { key: "recall", label: "RAG ", desc: "", icon: Es },
  { key: "preprocessing", label: "", desc: "Query /", icon: d7 }
], F$ = o1.filter((e) => e.id !== "dashboard"), dE = ({ onNavigate: e }) => {
  const [t, n] = G.useState([]), [r, a] = G.useState(0), { system: o, memory: l, features: c, toggleFeature: d } = P$(2e3);
  G.useEffect(() => (n(ye.getLogs().slice(0, 4)), ye.subscribe((C) => {
    n((N) => [C, ...N].slice(0, 4));
  })), []), G.useEffect(() => {
    const b = setInterval(() => a((C) => C + 1), 1e3);
    return () => clearInterval(b);
  }, []);
  const h = (b) => {
    const C = Math.floor(b / 3600), N = Math.floor(b % 3600 / 60), T = b % 60;
    return `${C.toString().padStart(2, "0")}:${N.toString().padStart(2, "0")}:${T.toString().padStart(2, "0")}`;
  }, p = (b) => e == null ? void 0 : e(b), g = o.floorInterval > 0 ? Math.min(100, o.pendingFloors / o.floorInterval * 100) : 0, x = l.eventCount > 0 ? Math.round(l.archivedCount / l.eventCount * 100) : 0;
  return /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col h-full", children: [
    /* @__PURE__ */ m.jsxs("div", { className: "mb-6", children: [
      /* @__PURE__ */ m.jsx("h1", { className: "text-2xl font-light text-foreground tracking-tight mb-2", children: "" }),
      /* @__PURE__ */ m.jsx("p", { className: "text-sm text-muted-foreground", children: "" })
    ] }),
    /* @__PURE__ */ m.jsx(Nr, { className: "mb-6" }),
    /* @__PURE__ */ m.jsx("div", { className: "flex-1 overflow-y-auto no-scrollbar", children: /* @__PURE__ */ m.jsxs("div", { className: "grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-12", children: [
      /* @__PURE__ */ m.jsxs("section", { className: "space-y-8", children: [
        /* @__PURE__ */ m.jsxs("div", { children: [
          /* @__PURE__ */ m.jsx("h2", { className: "text-xs font-medium text-muted-foreground uppercase tracking-wider mb-4", children: "" }),
          /* @__PURE__ */ m.jsxs("div", { className: "grid grid-cols-2 gap-6", children: [
            /* @__PURE__ */ m.jsxs("div", { children: [
              /* @__PURE__ */ m.jsx("span", { className: "text-xs text-muted-foreground block mb-1", children: "" }),
              /* @__PURE__ */ m.jsxs("div", { className: `flex items-center gap-2 text-lg font-medium ${o.isConnected ? "text-green-500" : "text-muted-foreground"}`, children: [
                o.isConnected ? /* @__PURE__ */ m.jsx(A1, { size: 18 }) : /* @__PURE__ */ m.jsx(xc, { size: 18 }),
                o.isConnected ? o.characterName : ""
              ] })
            ] }),
            /* @__PURE__ */ m.jsxs("div", { children: [
              /* @__PURE__ */ m.jsx("span", { className: "text-xs text-muted-foreground block mb-1", children: "" }),
              /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-2", children: [
                /* @__PURE__ */ m.jsx("span", { className: "text-3xl font-light text-amber-500 font-mono", children: o.pendingFloors }),
                /* @__PURE__ */ m.jsxs("span", { className: "text-muted-foreground", children: [
                  "/ ",
                  o.floorInterval
                ] }),
                o.isSummarizing && /* @__PURE__ */ m.jsx(au, { size: 14, className: "animate-spin text-primary ml-1" })
              ] }),
              /* @__PURE__ */ m.jsx("div", { className: "mt-2 h-1 bg-border rounded-full overflow-hidden", children: /* @__PURE__ */ m.jsx(
                "div",
                {
                  className: `h-full transition-all duration-300 ${g >= 80 ? "bg-amber-500" : "bg-primary"}`,
                  style: { width: `${g}%` }
                }
              ) })
            ] })
          ] })
        ] }),
        /* @__PURE__ */ m.jsx(Nr, { length: 100, spacing: "md" }),
        /* @__PURE__ */ m.jsxs("div", { children: [
          /* @__PURE__ */ m.jsx("h2", { className: "text-xs font-medium text-muted-foreground uppercase tracking-wider mb-4", children: "" }),
          /* @__PURE__ */ m.jsxs("div", { className: "grid grid-cols-2 gap-6", children: [
            /* @__PURE__ */ m.jsxs("div", { children: [
              /* @__PURE__ */ m.jsx("span", { className: "text-[10px] text-muted-foreground/70 uppercase tracking-wider block mb-1", children: "" }),
              /* @__PURE__ */ m.jsxs("div", { className: "flex items-baseline gap-2", children: [
                /* @__PURE__ */ m.jsx("span", { className: "text-xl font-mono text-foreground/80", children: l.eventCount }),
                /* @__PURE__ */ m.jsxs("span", { className: "text-xs text-muted-foreground", children: [
                  "~",
                  l.estimatedTokens.toLocaleString(),
                  " tok"
                ] })
              ] }),
              /* @__PURE__ */ m.jsxs("div", { className: "mt-2 flex items-center gap-2 text-[10px] text-muted-foreground", children: [
                /* @__PURE__ */ m.jsxs("span", { children: [
                  " ",
                  l.activeCount
                ] }),
                /* @__PURE__ */ m.jsx("div", { className: "flex-1 h-1 bg-border rounded-full overflow-hidden", children: /* @__PURE__ */ m.jsx("div", { className: "h-full bg-primary", style: { width: `${100 - x}%` } }) }),
                /* @__PURE__ */ m.jsxs("span", { children: [
                  " ",
                  l.archivedCount
                ] })
              ] })
            ] }),
            /* @__PURE__ */ m.jsxs("div", { children: [
              /* @__PURE__ */ m.jsx("span", { className: "text-[10px] text-muted-foreground/70 uppercase tracking-wider block mb-1", children: "" }),
              /* @__PURE__ */ m.jsx("div", { className: "text-xl font-mono text-foreground/80", children: l.entityCount }),
              l.entityCount > 0 && /* @__PURE__ */ m.jsx("div", { className: "flex gap-2 mt-2", children: Object.entries(l.entityByType).slice(0, 3).map(([b, C]) => /* @__PURE__ */ m.jsxs("span", { className: "text-[10px] text-muted-foreground", children: [
                b,
                ": ",
                C
              ] }, b)) })
            ] })
          ] })
        ] }),
        /* @__PURE__ */ m.jsx(Nr, { length: 30, spacing: "md" }),
        /* @__PURE__ */ m.jsxs("div", { children: [
          /* @__PURE__ */ m.jsx("span", { className: "text-[10px] text-muted-foreground/60 uppercase tracking-wider block mb-1", children: "" }),
          /* @__PURE__ */ m.jsx("div", { className: "text-sm font-mono text-primary/80", children: h(r) })
        ] }),
        /* @__PURE__ */ m.jsx(Nr, { length: 100 }),
        /* @__PURE__ */ m.jsxs("div", { children: [
          /* @__PURE__ */ m.jsx("h2", { className: "text-xs font-medium text-muted-foreground uppercase tracking-wider mb-4", children: "" }),
          /* @__PURE__ */ m.jsx("div", { className: "grid grid-cols-5 gap-3", children: F$.map(({ id: b, label: C, icon: N, path: T }) => /* @__PURE__ */ m.jsxs(
            "button",
            {
              onClick: () => p(T.replace("/", "")),
              className: "flex flex-col items-center gap-2 p-3 rounded-lg text-muted-foreground hover:text-foreground hover:bg-accent/50 transition-all group",
              children: [
                /* @__PURE__ */ m.jsx(N, { size: 20, className: "text-primary group-hover:scale-110 transition-transform" }),
                /* @__PURE__ */ m.jsx("span", { className: "text-xs", children: C })
              ]
            },
            b
          )) })
        ] })
      ] }),
      /* @__PURE__ */ m.jsxs("section", { className: "space-y-6 lg:pl-8 relative", children: [
        /* @__PURE__ */ m.jsx(Nr, { responsive: !0, length: 30 }),
        /* @__PURE__ */ m.jsxs("div", { children: [
          /* @__PURE__ */ m.jsx("h2", { className: "text-xs font-medium text-muted-foreground uppercase tracking-wider mb-4", children: "" }),
          /* @__PURE__ */ m.jsx("div", { className: "space-y-4", children: B$.map(({ key: b, label: C, desc: N, icon: T }) => {
            const j = c[b];
            return /* @__PURE__ */ m.jsxs("div", { className: "flex items-center justify-between", children: [
              /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-3 min-w-0 flex-1", children: [
                /* @__PURE__ */ m.jsx("div", { className: `p-1.5 rounded-lg ${j ? "bg-primary/10 text-primary" : "bg-muted text-muted-foreground"}`, children: /* @__PURE__ */ m.jsx(T, { size: 14 }) }),
                /* @__PURE__ */ m.jsxs("div", { className: "min-w-0 flex-1", children: [
                  /* @__PURE__ */ m.jsx("span", { className: `text-sm ${j ? "text-foreground" : "text-muted-foreground"}`, children: C }),
                  /* @__PURE__ */ m.jsx("p", { className: "text-[10px] text-muted-foreground truncate", children: N })
                ] })
              ] }),
              /* @__PURE__ */ m.jsx(Kr, { checked: j, onChange: () => d(b) })
            ] }, b);
          }) })
        ] }),
        /* @__PURE__ */ m.jsx(Nr, { length: 100, spacing: "md" }),
        /* @__PURE__ */ m.jsxs("div", { children: [
          /* @__PURE__ */ m.jsxs("div", { className: "flex items-center justify-between mb-4", children: [
            /* @__PURE__ */ m.jsx("h2", { className: "text-xs font-medium text-muted-foreground uppercase tracking-wider", children: "" }),
            /* @__PURE__ */ m.jsxs(
              "button",
              {
                onClick: () => p("devlog"),
                className: "text-[10px] text-primary hover:underline flex items-center gap-0.5",
                children: [
                  " ",
                  /* @__PURE__ */ m.jsx(Jh, { size: 12 })
                ]
              }
            )
          ] }),
          /* @__PURE__ */ m.jsx("div", { className: "font-mono text-[11px] space-y-1.5", children: t.length === 0 ? /* @__PURE__ */ m.jsx("div", { className: "text-muted-foreground text-center py-4 italic", children: "" }) : t.map((b) => /* @__PURE__ */ m.jsxs("div", { className: `flex gap-2 opacity-80 ${q$(b.level)}`, children: [
            /* @__PURE__ */ m.jsxs("span", { className: "text-muted-foreground shrink-0", children: [
              "[",
              new Date(b.timestamp).toLocaleTimeString([], { hour12: !1 }),
              "]"
            ] }),
            /* @__PURE__ */ m.jsx("span", { className: "text-foreground truncate", children: b.message })
          ] }, b.id)) })
        ] })
      ] })
    ] }) })
  ] });
}, U$ = G.lazy(() => Promise.resolve().then(() => OH).then((e) => ({ default: e.DevLog }))), $$ = G.lazy(() => Promise.resolve().then(() => iG).then((e) => ({ default: e.APIPresets }))), H$ = G.lazy(() => Promise.resolve().then(() => lG).then((e) => ({ default: e.Settings }))), G$ = G.lazy(() => Promise.resolve().then(() => Dte).then((e) => ({ default: e.MemoryStream }))), V$ = G.lazy(() => Promise.resolve().then(() => Qte).then((e) => ({ default: e.ProcessingView }))), K$ = () => /* @__PURE__ */ m.jsx("div", { className: "flex items-center justify-center h-full", children: /* @__PURE__ */ m.jsx("div", { className: "animate-spin h-8 w-8 border-2 border-primary border-t-transparent rounded-full" }) }), Y$ = ({ onClose: e }) => {
  const [t, n] = G.useState("dashboard"), [r, a] = G.useState(!1), [o, l] = G.useState(!1), c = (p) => {
    const g = p.replace(/^\//, "");
    console.debug("[Engram] Navigating to:", g), n(g);
  };
  G.useEffect(() => {
    const p = setTimeout(() => {
      const g = nt.get("hasSeenWelcome");
      console.debug("[Engram] hasSeenWelcome:", g), g || a(!0), l(!0);
    }, 1e3);
    return () => clearTimeout(p);
  }, []);
  const d = () => {
    nt.set("hasSeenWelcome", !0), console.debug("[Engram] hasSeenWelcome saved"), a(!1);
  };
  if (!o)
    return null;
  const h = () => {
    const [p, g] = t.split(":");
    switch (p) {
      case "dashboard":
        return /* @__PURE__ */ m.jsx(dE, { onNavigate: n });
      case "presets":
        return /* @__PURE__ */ m.jsx($$, { initialTab: g });
      case "devlog":
        return /* @__PURE__ */ m.jsx(U$, { initialTab: g });
      case "settings":
        return /* @__PURE__ */ m.jsx(H$, {});
      case "memory":
        return /* @__PURE__ */ m.jsx(G$, {});
      case "processing":
        return /* @__PURE__ */ m.jsx(V$, { onNavigate: n });
      default:
        return /* @__PURE__ */ m.jsx(dE, {});
    }
  };
  return (
    /*  */
    /* @__PURE__ */ m.jsxs(m.Fragment, { children: [
      r && /* @__PURE__ */ m.jsx(g$, { onComplete: d }),
      /* @__PURE__ */ m.jsx(p$, { activeTab: t, setActiveTab: c, onClose: e, children: /* @__PURE__ */ m.jsx(G.Suspense, { fallback: /* @__PURE__ */ m.jsx(K$, {}), children: h() }) })
    ] })
  );
}, W$ = () => {
  const [e, t] = G.useState(!1), [n, r] = G.useState(null), [a, o] = G.useState(""), [l, c] = G.useState(!1);
  G.useEffect(() => {
    const g = Ss.on(
      uo.ENGRAM_REQUEST_REVISION,
      (x) => {
        const b = x;
        r(b), o(b.content), t(!0);
      }
    );
    return () => {
      g();
    };
  }, []);
  const d = () => {
    n && (n.onConfirm(a), t(!1), r(null));
  }, h = () => {
    n && n.onCancel(), t(!1), r(null);
  }, p = async () => {
    if (n != null && n.onReroll) {
      c(!0);
      try {
        const g = await n.onReroll();
        o(g);
      } catch (g) {
        console.error("[RevisionModal] Reroll failed:", g);
      } finally {
        c(!1);
      }
    }
  };
  return e ? wS.createPortal(
    /* @__PURE__ */ m.jsxs(
      "div",
      {
        className: "fixed inset-0 z-[11000] flex items-center justify-center p-4",
        style: { height: "100dvh", width: "100vw" },
        children: [
          /* @__PURE__ */ m.jsx(
            "div",
            {
              className: "absolute inset-0 bg-background/80 backdrop-blur-sm animate-in fade-in duration-200",
              onClick: h
            }
          ),
          /* @__PURE__ */ m.jsxs("div", { className: "relative w-full max-w-2xl bg-popover border border-border rounded-lg shadow-2xl flex flex-col max-h-[85vh] animate-in zoom-in-95 slide-in-from-bottom-2 duration-200", children: [
            /* @__PURE__ */ m.jsxs("div", { className: "flex items-start justify-between p-5 border-b border-border", children: [
              /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col gap-1", children: [
                /* @__PURE__ */ m.jsx("h3", { className: "text-lg font-medium text-foreground tracking-tight", children: (n == null ? void 0 : n.title) || "" }),
                (n == null ? void 0 : n.description) && /* @__PURE__ */ m.jsx("p", { className: "text-sm text-muted-foreground", children: n.description })
              ] }),
              /* @__PURE__ */ m.jsx(
                "button",
                {
                  onClick: h,
                  className: "p-2 -m-2 text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors",
                  "aria-label": "",
                  children: /* @__PURE__ */ m.jsx(tm, { size: 18 })
                }
              )
            ] }),
            /* @__PURE__ */ m.jsxs("div", { className: "flex-1 p-5 overflow-hidden flex flex-col gap-4", children: [
              /* @__PURE__ */ m.jsxs("div", { className: "flex items-start gap-3 p-3 bg-primary/10 border border-primary/20 rounded-md", children: [
                /* @__PURE__ */ m.jsx(c7, { size: 16, className: "text-primary shrink-0 mt-0.5" }),
                /* @__PURE__ */ m.jsx("p", { className: "text-sm text-foreground/80 leading-relaxed", children: "" })
              ] }),
              /* @__PURE__ */ m.jsx(
                "textarea",
                {
                  value: a,
                  onChange: (g) => o(g.target.value),
                  className: "flex-1 w-full min-h-[200px] p-4 bg-muted border border-border rounded-md font-mono text-sm text-foreground leading-relaxed placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring resize-none",
                  spellCheck: !1,
                  placeholder: "..."
                }
              ),
              /* @__PURE__ */ m.jsxs("div", { className: "text-xs text-muted-foreground text-right font-mono", children: [
                a.length,
                " "
              ] })
            ] }),
            /* @__PURE__ */ m.jsxs("div", { className: "flex items-center justify-between px-5 py-4 border-t border-border bg-muted/30", children: [
              /* @__PURE__ */ m.jsx("div", { children: (n == null ? void 0 : n.onReroll) && /* @__PURE__ */ m.jsxs(
                "button",
                {
                  onClick: p,
                  disabled: l,
                  className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg transition-colors disabled:opacity-50",
                  children: [
                    l ? /* @__PURE__ */ m.jsx(au, { size: 16, className: "animate-spin" }) : /* @__PURE__ */ m.jsx(zr, { size: 16 }),
                    ""
                  ]
                }
              ) }),
              /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-3", children: [
                /* @__PURE__ */ m.jsx(
                  "button",
                  {
                    onClick: h,
                    disabled: l,
                    className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg transition-colors disabled:opacity-50",
                    children: ""
                  }
                ),
                /* @__PURE__ */ m.jsxs(
                  "button",
                  {
                    onClick: d,
                    disabled: l,
                    className: "inline-flex items-center gap-2 px-4 py-2 text-sm bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50 shadow-sm",
                    children: [
                      /* @__PURE__ */ m.jsx(T1, { size: 16 }),
                      ""
                    ]
                  }
                )
              ] })
            ] })
          ] })
        ]
      }
    ),
    document.body
  ) : null;
}, X$ = ({
  isOpen: e,
  onClose: t,
  title: n,
  children: r,
  initialPosition: a,
  width: o = 320,
  minWidth: l = 280,
  maxWidth: c = 600,
  minHeight: d = 150,
  resizable: h = !0
}) => {
  const p = G.useRef(null), [g, x] = G.useState(a || { x: 100, y: 100 }), [b, C] = G.useState({ width: o, height: "auto" }), [N, T] = G.useState(!1), [j, R] = G.useState(!1), A = G.useRef({ x: 0, y: 0 }), z = G.useRef({ width: 0, height: 0, x: 0, y: 0 });
  G.useEffect(() => {
    e && !a && x({
      x: Math.max(50, (window.innerWidth - o) / 2),
      y: Math.max(50, window.innerHeight - 450)
    });
  }, [e, a, o]);
  const q = G.useCallback((ie) => {
    if (!p.current) return;
    const X = p.current.getBoundingClientRect();
    A.current = {
      x: ie.clientX - X.left,
      y: ie.clientY - X.top
    }, T(!0);
  }, []), D = G.useCallback((ie) => {
    if (N) {
      const X = Math.max(0, Math.min(window.innerWidth - (typeof b.width == "number" ? b.width : 300), ie.clientX - A.current.x)), K = Math.max(0, Math.min(window.innerHeight - 100, ie.clientY - A.current.y));
      x({ x: X, y: K });
    } else if (j && p.current) {
      const X = ie.clientX - z.current.x, K = ie.clientY - z.current.y, V = Math.max(l, Math.min(c, z.current.width + X)), de = Math.max(d, z.current.height + K);
      C({ width: V, height: de });
    }
  }, [N, j, b.width, l, c, d]), P = G.useCallback(() => {
    T(!1), R(!1);
  }, []), re = G.useCallback((ie) => {
    if (ie.preventDefault(), ie.stopPropagation(), !p.current) return;
    const X = p.current.getBoundingClientRect();
    z.current = {
      width: X.width,
      height: X.height,
      x: ie.clientX,
      y: ie.clientY
    }, R(!0);
  }, []);
  return G.useEffect(() => {
    if (N || j)
      return window.addEventListener("mousemove", D), window.addEventListener("mouseup", P), () => {
        window.removeEventListener("mousemove", D), window.removeEventListener("mouseup", P);
      };
  }, [N, j, D, P]), e ? wS.createPortal(
    /* @__PURE__ */ m.jsxs(
      "div",
      {
        ref: p,
        className: "fixed z-[11000] flex flex-col rounded-lg shadow-2xl border border-border overflow-hidden",
        style: {
          left: g.x,
          top: g.y,
          width: b.width,
          height: b.height === "auto" ? "auto" : b.height,
          minHeight: d,
          backgroundColor: "var(--popover, #1a1a2e)",
          backdropFilter: "blur(20px)",
          WebkitBackdropFilter: "blur(20px)"
        },
        children: [
          /* @__PURE__ */ m.jsxs(
            "div",
            {
              className: "flex items-center justify-between px-3 py-2 border-b border-border select-none",
              onMouseDown: q,
              style: {
                cursor: N ? "grabbing" : "grab",
                backgroundColor: "var(--surface, rgba(255,255,255,0.05))"
              },
              children: [
                /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-2", children: [
                  /* @__PURE__ */ m.jsx(vz, { size: 14, className: "text-muted-foreground" }),
                  /* @__PURE__ */ m.jsx("span", { className: "text-sm font-medium text-foreground", children: n })
                ] }),
                /* @__PURE__ */ m.jsx(
                  "button",
                  {
                    onClick: t,
                    className: "p-1 text-muted-foreground hover:text-foreground rounded transition-colors",
                    style: { backgroundColor: "transparent" },
                    "aria-label": "",
                    onMouseDown: (ie) => ie.stopPropagation(),
                    children: /* @__PURE__ */ m.jsx(tm, { size: 14 })
                  }
                )
              ]
            }
          ),
          /* @__PURE__ */ m.jsx("div", { className: "flex-1 overflow-auto p-3", children: r }),
          h && /* @__PURE__ */ m.jsx(
            "div",
            {
              className: "absolute bottom-0 right-0 w-4 h-4 cursor-se-resize",
              onMouseDown: re,
              style: {
                background: "linear-gradient(135deg, transparent 50%, var(--border, #333) 50%)"
              }
            }
          )
        ]
      }
    ),
    document.body
  ) : null;
};
function hE(e) {
  var t, n;
  try {
    const r = (n = (t = window.SillyTavern) == null ? void 0 : t.getContext) == null ? void 0 : n.call(t);
    return r != null && r.substituteParams ? r.substituteParams(e) : (ye.warn("Preprocessor", "substituteParams "), e);
  } catch (r) {
    return ye.warn("Preprocessor", "substituteParams ", r), e;
  }
}
async function Q$() {
  var e, t;
  try {
    const n = (t = (e = window.SillyTavern) == null ? void 0 : e.getContext) == null ? void 0 : t.call(e);
    n != null && n.stopGeneration && (n.stopGeneration(), ye.info("Preprocessor", " stopGeneration"));
  } catch (n) {
    ye.warn("Preprocessor", " stopGeneration ", n);
  }
}
function mE() {
  try {
    const e = $h();
    return e == null ? void 0 : e.name;
  } catch {
  }
}
function pE() {
  try {
    return P1();
  } catch {
  }
}
const Vf = class Vf {
  constructor() {
    mt(this, "cancelRequested", !1);
  }
  // ... (rest of class)
  static getInstance() {
    return Vf.instance || (Vf.instance = new Vf()), Vf.instance;
  }
  /**
   * 
   */
  requestStopGeneration() {
    Q$();
  }
  /**
   * 
   * @param userInput 
   * @returns 
   */
  async process(t) {
    var o;
    const n = Date.now(), r = this.getConfig();
    if (ye.info("Preprocessor", "", {
      enabled: r.enabled,
      templateId: r.templateId,
      inputLength: t.length
    }), !r.enabled)
      return ye.debug("Preprocessor", ""), {
        success: !0,
        output: null,
        query: null,
        rawOutput: "",
        processingTime: 0
      };
    this.cancelRequested = !1;
    const a = Kt.running("...", "Engram", () => {
      this.cancelRequested = !0, ye.info("Preprocessor", ""), this.requestStopGeneration(), Kt.warning("...", "Engram");
    });
    try {
      const l = nt.getPromptTemplateById(r.templateId);
      if (ye.debug("Preprocessor", "", {
        templateId: r.templateId,
        found: !!l,
        templateName: l == null ? void 0 : l.name
      }), !l) {
        const C = ` ${r.templateId}  API `;
        return ye.warn("Preprocessor", C), {
          success: !1,
          output: null,
          query: null,
          rawOutput: "",
          processingTime: Date.now() - n,
          error: C
        };
      }
      if (this.cancelRequested)
        return {
          success: !1,
          output: null,
          query: null,
          rawOutput: "",
          processingTime: Date.now() - n,
          error: ""
        };
      let c = l.systemPrompt.replace(/\{\{input\}\}/gi, t), d = l.userPromptTemplate.replace(/\{\{input\}\}/gi, t);
      c = hE(c), d = hE(d), ye.debug("Preprocessor", "", {
        systemPromptLength: c.length,
        userPromptLength: d.length,
        userPromptPreview: d.substring(0, 100) + "..."
      });
      const h = ns.logSend({
        type: "query",
        systemPrompt: c,
        userPrompt: d,
        model: pE() || "Unknown",
        character: mE() || "System"
      }), p = await nd.generate({
        systemPrompt: c,
        userPrompt: d
      });
      if (ns.logReceive(h, {
        response: p.content,
        status: p.success ? "success" : "error",
        error: p.error,
        duration: Date.now() - n
      }), this.cancelRequested)
        return ye.info("Preprocessor", ""), {
          success: !1,
          output: null,
          query: null,
          rawOutput: "",
          processingTime: Date.now() - n,
          error: ""
        };
      if (!p.success || !p.content) {
        const C = p.error || "LLM ";
        return ye.error("Preprocessor", "LLM ", { error: C }), {
          success: !1,
          output: null,
          query: null,
          rawOutput: "",
          processingTime: Date.now() - n,
          error: C
        };
      }
      const g = Cs.process(p.content, "output"), x = Cs.captureTags(g, ["output", "query"]);
      if (r.preview && x.output) {
        ye.info("Preprocessor", "");
        try {
          const C = async () => {
            const T = ns.logSend({
              type: "query",
              systemPrompt: c,
              userPrompt: d,
              model: pE() || "Unknown",
              character: mE() || "System"
            }), j = await nd.generate({
              systemPrompt: c,
              userPrompt: d
            });
            if (ns.logReceive(T, {
              response: j.content,
              status: j.success ? "success" : "error",
              error: j.error,
              duration: 0
            }), !j.success || !j.content)
              throw new Error(j.error || "LLM ");
            const R = Cs.process(j.content, "output");
            return Cs.captureTags(R, ["output", "query"]).output || R;
          }, N = await new Promise((T) => {
            Ss.emit(uo.ENGRAM_REQUEST_REVISION, {
              title: "",
              content: x.output,
              description: "",
              onConfirm: (j) => T(j),
              onCancel: () => T(null),
              // V0.9.2:  Roll 
              onReroll: C
            });
          });
          if (N !== null)
            x.output = N, ye.info("Preprocessor", "");
          else
            return ye.info("Preprocessor", ""), {
              success: !1,
              output: null,
              query: null,
              rawOutput: "",
              processingTime: Date.now() - n,
              error: ""
            };
        } catch (C) {
          ye.warn("Preprocessor", "", C);
        }
      }
      const b = Date.now() - n;
      return ye.info("Preprocessor", "", {
        hasOutput: !!x.output,
        hasQuery: !!x.query,
        outputLength: ((o = x.output) == null ? void 0 : o.length) || 0,
        processingTime: b
      }), Kt.success("", "Engram"), {
        success: !0,
        output: x.output,
        query: x.query,
        rawOutput: g,
        processingTime: b
      };
    } catch (l) {
      const c = l instanceof Error ? l.message : "";
      return ye.error("Preprocessor", "", { error: c, stack: l.stack }), Kt.error(`: ${c}`, "Engram"), {
        success: !1,
        output: null,
        query: null,
        rawOutput: "",
        processingTime: Date.now() - n,
        error: c
      };
    } finally {
      Kt.remove(a);
    }
  }
  /**
   * 
   */
  getConfig() {
    return nt.get("preprocessingConfig") || yg;
  }
  /**
   * 
   */
  saveConfig(t) {
    ye.debug("Preprocessor", "", t), nt.set("preprocessingConfig", t);
  }
  /**
   * /
   */
  toggle() {
    const t = this.getConfig();
    return t.enabled = !t.enabled, this.saveConfig(t), ye.info("Preprocessor", `${t.enabled ? "" : ""}`), t.enabled;
  }
};
mt(Vf, "instance");
let G3 = Vf;
const Qf = G3.getInstance();
function Z$({ isOpen: e, onClose: t }) {
  var g, x, b, C;
  const [n, r] = G.useState(
    Qf.getConfig() || yg
  ), [a, o] = G.useState(
    ((g = nt.get("apiSettings")) == null ? void 0 : g.recallConfig) || {}
  ), [l, c] = G.useState(
    ((x = nt.get("apiSettings")) == null ? void 0 : x.promptTemplates) || []
  );
  n.enabled && (a == null || a.usePreprocessing);
  const d = G.useMemo(() => l.filter((N) => N.category === "preprocessing").map((N) => ({
    id: N.id,
    name: N.name,
    description: N.userPromptTemplate.slice(0, 30).replace(/\n/g, " ") + "...",
    icon: d7
  })), [l]);
  G.useEffect(() => {
    if (!e) return;
    const N = () => {
      const j = Qf.getConfig() || yg;
      r((A) => JSON.stringify(A) !== JSON.stringify(j) ? j : A);
      const R = nt.get("apiSettings");
      if (R) {
        const A = R.recallConfig || {};
        o((q) => JSON.stringify(q) !== JSON.stringify(A) ? A : q);
        const z = R.promptTemplates || [];
        z.length !== l.length && c(z);
      }
    };
    N();
    const T = setInterval(N, 1e3);
    return () => clearInterval(T);
  }, [e, l.length]);
  const h = G.useCallback(() => {
    const N = (a == null ? void 0 : a.usePreprocessing) ?? !1, T = !N;
    ye.debug("QuickPanel", "", { from: N, to: T });
    const j = nt.get("apiSettings");
    if (j && j.recallConfig) {
      const A = { ...j.recallConfig, usePreprocessing: T };
      nt.set("apiSettings", {
        ...j,
        recallConfig: A
      });
    }
    const R = { ...n, enabled: T };
    r(R), nt.set("preprocessingConfig", R);
  }, [n, a]), p = G.useCallback((N) => {
    ye.debug("QuickPanel", "", { templateId: N });
    const T = { ...n, templateId: N, enabled: !0 };
    r(T), nt.set("preprocessingConfig", T);
    const j = nt.get("apiSettings");
    if (j && j.recallConfig && !j.recallConfig.usePreprocessing) {
      const R = { ...j.recallConfig, usePreprocessing: !0 };
      nt.set("apiSettings", {
        ...j,
        recallConfig: R
      });
    }
  }, [n]);
  return !n.templateId || d.some((N) => N.id === n.templateId), /* @__PURE__ */ m.jsx(
    X$,
    {
      isOpen: e,
      onClose: t,
      title: "Engram ",
      width: 300,
      children: /* @__PURE__ */ m.jsxs("div", { className: "space-y-3", children: [
        /* @__PURE__ */ m.jsxs(
          "div",
          {
            className: "flex items-center justify-between p-2 rounded-md",
            style: {
              backgroundColor: "var(--surface, rgba(255,255,255,0.05))",
              border: "1px solid var(--border, rgba(255,255,255,0.1))"
            },
            children: [
              /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-2", children: [
                /* @__PURE__ */ m.jsx(Es, { size: 14, style: { color: "var(--primary, #ef7357)" } }),
                /* @__PURE__ */ m.jsx("span", { className: "text-sm font-medium", children: "" })
              ] }),
              /* @__PURE__ */ m.jsx(
                Kr,
                {
                  checked: (a == null ? void 0 : a.usePreprocessing) ?? n.enabled,
                  onChange: h
                }
              )
            ]
          }
        ),
        ((a == null ? void 0 : a.usePreprocessing) ?? n.enabled) && /* @__PURE__ */ m.jsxs(
          "div",
          {
            className: "flex items-center justify-between p-2 rounded-md",
            style: {
              backgroundColor: "var(--surface, rgba(255,255,255,0.05))",
              border: "1px solid var(--border, rgba(255,255,255,0.1))"
            },
            children: [
              /* @__PURE__ */ m.jsx("div", { className: "flex items-center gap-2 pl-2", children: /* @__PURE__ */ m.jsx("span", { className: "text-xs text-muted-foreground", children: "" }) }),
              /* @__PURE__ */ m.jsx(
                Kr,
                {
                  checked: n.preview,
                  onChange: () => {
                    const N = { ...n, preview: !n.preview };
                    r(N), Promise.resolve().then(() => jS).then(({ SettingsManager: T }) => {
                      T.set("preprocessingConfig", N);
                    });
                  }
                }
              )
            ]
          }
        ),
        ((a == null ? void 0 : a.usePreprocessing) ?? n.enabled) && /* @__PURE__ */ m.jsxs("div", { className: "space-y-2", children: [
          /* @__PURE__ */ m.jsx("div", { className: "text-xs px-1", style: { color: "var(--muted-foreground, #888)" }, children: "" }),
          d.length === 0 ? /* @__PURE__ */ m.jsxs(
            "div",
            {
              className: "flex items-start gap-2 p-2 rounded-md text-xs mt-2",
              style: {
                backgroundColor: "rgba(var(--primary-rgb, 239,115,87), 0.1)",
                border: "1px solid rgba(var(--primary-rgb, 239,115,87), 0.3)",
                color: "var(--muted-foreground, #888)"
              },
              children: [
                /* @__PURE__ */ m.jsx(xc, { size: 14, style: { color: "var(--primary, #ef7357)", flexShrink: 0, marginTop: 2 } }),
                /* @__PURE__ */ m.jsx("span", { children: " API    'preprocessing' " })
              ]
            }
          ) : /* @__PURE__ */ m.jsx("div", { className: "space-y-1", children: d.map((N) => {
            const T = N.icon, j = n.templateId === N.id;
            return /* @__PURE__ */ m.jsxs(
              "button",
              {
                onClick: () => p(N.id),
                className: "w-full flex items-center gap-3 p-2 rounded-md transition-all text-left",
                style: {
                  backgroundColor: j ? "rgba(var(--primary-rgb, 239,115,87), 0.15)" : "var(--surface, rgba(255,255,255,0.05))",
                  border: j ? "1px solid var(--primary, #ef7357)" : "1px solid var(--border, rgba(255,255,255,0.1))",
                  color: "var(--foreground, #fff)"
                },
                children: [
                  /* @__PURE__ */ m.jsx(
                    T,
                    {
                      size: 16,
                      style: {
                        color: j ? "var(--primary, #ef7357)" : "var(--muted-foreground, #888)"
                      }
                    }
                  ),
                  /* @__PURE__ */ m.jsxs("div", { className: "flex-1 min-w-0", children: [
                    /* @__PURE__ */ m.jsx("div", { className: "text-sm font-medium truncate", children: N.name }),
                    /* @__PURE__ */ m.jsx(
                      "div",
                      {
                        className: "text-xs truncate",
                        style: { color: "var(--muted-foreground, #888)" },
                        children: N.description
                      }
                    )
                  ] })
                ]
              },
              N.id
            );
          }) })
        ] }),
        /* @__PURE__ */ m.jsx(
          "div",
          {
            className: "text-xs text-center pt-2",
            style: {
              borderTop: "1px solid var(--border, rgba(255,255,255,0.1))",
              color: "var(--muted-foreground, #888)"
            },
            children: (a == null ? void 0 : a.usePreprocessing) ?? n.enabled ? (b = d.find((N) => N.id === n.templateId)) != null && b.name ? `  ${(C = d.find((N) => N.id === n.templateId)) == null ? void 0 : C.name}` : "  " : ""
          }
        )
      ] })
    }
  );
}
let V3 = !1, K3 = null;
function oA(e) {
  K3 = e;
}
function Y3() {
  if (V3)
    return ye.debug("QuickPanelButton", ""), !0;
  const e = document.querySelector("#send_form");
  if (!e)
    return ye.warn("QuickPanelButton", "#send_form "), !1;
  window.getComputedStyle(e).position === "static" && (e.style.position = "relative");
  const n = document.createElement("div");
  n.id = "engram-quick-panel-trigger", n.className = "fa-solid fa-brain", n.title = "Engram ", n.style.cssText = `
        position: absolute;
        top: 0.5em;
        left: 0.5em;
        width: 1.5em;
        height: 1.5em;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.9em;
        cursor: pointer;
        color: var(--SmartThemeBodyColor, #ccc);
        opacity: 0.6;
        transition: all 0.2s ease;
        z-index: 1000;
    `;
  const r = window.getComputedStyle(e).paddingLeft, a = parseFloat(r) < 30 ? "30px" : r;
  return e.style.paddingLeft = a, n.addEventListener("mouseenter", () => {
    n.style.opacity = "1", n.style.color = "var(--SmartThemeEmColor, #fff)";
  }), n.addEventListener("mouseleave", () => {
    n.style.opacity = "0.7", n.style.color = "var(--SmartThemeBodyColor, #ccc)";
  }), n.addEventListener("click", (o) => {
    o.preventDefault(), o.stopPropagation(), ye.debug("QuickPanelButton", ""), K3 ? K3() : ye.warn("QuickPanelButton", "");
  }), e.appendChild(n), V3 = !0, ye.info("QuickPanelButton", " ()"), !0;
}
function J$() {
  if (Y3())
    return;
  const e = new MutationObserver((t, n) => {
    Y3() && n.disconnect();
  });
  e.observe(document.body, {
    childList: !0,
    subtree: !0
  }), setTimeout(() => {
    e.disconnect(), V3 || ye.warn("QuickPanelButton", " #send_form ");
  }, 1e4);
}
const eH = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  initQuickPanelButton: J$,
  injectQuickPanelButton: Y3,
  setQuickPanelCallback: oA
}, Symbol.toStringTag, { value: "Module" }));
let tH = !1, g1 = null;
A$((e, t) => {
  const n = JT.createRoot(e);
  return n.render(hS.createElement(Y$, { onClose: t })), n;
});
function nH() {
  const [e, t] = G.useState(tH);
  return G.useEffect(() => (g1 = t, () => {
    g1 = null;
  }), []), /* @__PURE__ */ m.jsxs("div", { className: "pointer-events-auto", children: [
    /* @__PURE__ */ m.jsx(W$, {}),
    /* @__PURE__ */ m.jsx(
      Z$,
      {
        isOpen: e,
        onClose: () => t(!1)
      }
    )
  ] });
}
M$((e) => {
  const t = JT.createRoot(e);
  return t.render(/* @__PURE__ */ m.jsx(nH, {})), t;
});
oA(() => {
  g1 && g1(!0);
});
document.readyState === "loading" ? document.addEventListener("DOMContentLoaded", lE) : lE();
const Mh = "__ENGRAM_STATE__", Iy = {
  lastSummarizedFloor: 0,
  totalSummaries: 0,
  totalTokens: 0,
  updatedAt: Date.now()
};
class W3 {
  /**
   * 
   */
  static async loadState(t) {
    try {
      const n = await mn.findEntryByKey(t, Mh);
      if (!n)
        return { ...Iy };
      try {
        const r = JSON.parse(n.content);
        return { ...Iy, ...r };
      } catch (r) {
        return ye.warn("WorldBookStateService", "", r), { ...Iy };
      }
    } catch (n) {
      return ye.error("WorldBookStateService", "", n), { ...Iy };
    }
  }
  /**
   * 
   */
  static async saveState(t, n) {
    try {
      const a = {
        ...await this.loadState(t),
        ...n,
        updatedAt: Date.now()
      }, o = JSON.stringify(a, null, 2), c = (await mn.getEntries(t)).filter(
        (d) => d.name === "Engram System State" || d.keys.includes(Mh)
      );
      if (c.length > 0) {
        c.sort((g, x) => {
          const b = g.keys.includes(Mh) ? 1 : 0;
          return (x.keys.includes(Mh) ? 1 : 0) - b;
        });
        const [d, ...h] = c;
        if (h.length > 0) {
          ye.warn("WorldBookStateService", ` ${h.length} ...`);
          for (const g of h)
            await mn.deleteEntry(t, g.uid);
        }
        ye.debug("WorldBookStateService", "", { uid: d.uid, state: a });
        const p = {
          content: o,
          name: "Engram System State",
          enabled: !1,
          constant: !1,
          keys: [Mh],
          recursion: {
            prevent_incoming: !0,
            prevent_outgoing: !0
          },
          position: "before_character_definition",
          order: 0
        };
        return await mn.updateEntry(t, d.uid, p);
      } else {
        ye.debug("WorldBookStateService", "", { state: a });
        const d = {
          name: "Engram System State",
          content: o,
          keys: [Mh],
          enabled: !1,
          constant: !1,
          position: "before_character_definition",
          role: "system",
          order: 0,
          recursion: {
            prevent_incoming: !0,
            prevent_outgoing: !0
          }
        };
        return await mn.createEntry(t, d);
      }
    } catch (r) {
      return ye.error("WorldBookStateService", "", r), !1;
    }
  }
}
const rH = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  WorldBookStateService: W3
}, Symbol.toStringTag, { value: "Module" })), Hx = {
  openai: "https://api.openai.com/v1/embeddings",
  ollama: "http://localhost:11434/api/embeddings",
  vllm: "http://localhost:8000/v1/embeddings",
  cohere: "https://api.cohere.ai/v1/embed",
  jina: "https://api.jina.ai/v1/embeddings",
  voyage: "https://api.voyageai.com/v1/embeddings"
}, iH = 5;
class aH {
  constructor() {
    mt(this, "config", null);
    mt(this, "concurrency", iH);
    mt(this, "stopSignal", !1);
  }
  /**
   * 
   */
  setConfig(t) {
    this.config = t;
  }
  /**
   * 
   */
  setConcurrency(t) {
    this.concurrency = Math.max(1, Math.min(20, t));
  }
  /**
   * 
   */
  stop() {
    this.stopSignal = !0;
  }
  /**
   * 
   */
  reset() {
    this.stopSignal = !1;
  }
  // ====================  ====================
  /**
   * 
   */
  async embed(t) {
    if (!this.config)
      throw new Error("EmbeddingService: config not set");
    const n = await this.embedBatch([{ id: "single", text: t }]);
    if (n[0].error)
      throw new Error(n[0].error);
    return n[0].embedding;
  }
  /**
   *  ()
   */
  async embedBatch(t, n) {
    if (!this.config)
      throw new Error("EmbeddingService: config not set");
    this.stopSignal = !1;
    const r = new Array(t.length);
    let a = 0, o = 0;
    const l = async (c) => {
      if (c >= t.length || this.stopSignal) return;
      const d = t[c];
      try {
        const h = await this.callEmbeddingAPI(d.text);
        r[c] = { id: d.id, embedding: h };
      } catch (h) {
        o++, r[c] = { id: d.id, embedding: [], error: h.message }, ye.warn("EmbeddingService", `: ${d.id}`, { error: h.message });
      } finally {
        a++, n == null || n(a, t.length, o);
      }
    };
    for (let c = 0; c < t.length && !this.stopSignal; c += this.concurrency) {
      const d = Array.from(
        { length: Math.min(this.concurrency, t.length - c) },
        (h, p) => l(c + p)
      );
      await Promise.all(d);
    }
    return r;
  }
  /**
   *  API
   */
  async callEmbeddingAPI(t) {
    const n = this.config;
    switch (n.source) {
      case "openai":
      case "custom":
      case "vllm":
      case "jina":
      case "voyage":
        return this.callOpenAICompatible(t, n);
      case "ollama":
        return this.callOllama(t, n);
      case "cohere":
        return this.callCohere(t, n);
      case "transformers":
        return this.callTransformers(t, n);
      default:
        throw new Error(`Unsupported vector source: ${n.source}`);
    }
  }
  /**
   * OpenAI  API 
   */
  async callOpenAICompatible(t, n) {
    let r = n.apiUrl || Hx[n.source] || "";
    if ((n.source === "custom" || n.source === "openai") && r) {
      const l = r.replace(/\/+$/, "");
      !l.endsWith("embeddings") && !l.endsWith("embed") && (l.endsWith("/v1") ? r = `${l}/embeddings` : r = `${l}/v1/embeddings`, ye.debug("EmbeddingService", ` API URL: ${n.apiUrl} -> ${r}`));
    }
    if (!r)
      throw new Error("API endpoint not configured");
    const a = {
      "Content-Type": "application/json"
    };
    n.apiKey && (a.Authorization = `Bearer ${n.apiKey}`);
    const o = {
      model: n.model || "text-embedding-3-small",
      input: t
    };
    n.dimensions && (o.dimensions = n.dimensions);
    try {
      const l = await fetch(r, {
        method: "POST",
        headers: a,
        body: JSON.stringify(o)
      });
      if (!l.ok) {
        const d = await l.text();
        throw new Error(`API error ${l.status} at ${r}: ${d}`);
      }
      const c = await l.json();
      if (!c.data || c.data.length === 0)
        throw new Error("No embedding data returned");
      return c.data[0].embedding;
    } catch (l) {
      throw l.message.includes("at http") ? l : new Error(`Request to ${r} failed: ${l.message}`);
    }
  }
  /**
   * Ollama API 
   */
  async callOllama(t, n) {
    const r = n.apiUrl || Hx.ollama, a = r.includes("/api/embed") && !r.includes("/api/embeddings"), o = {
      model: n.model || "nomic-embed-text"
    };
    a ? o.input = t : o.prompt = t;
    const l = await fetch(r, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(o)
    });
    if (!l.ok) {
      const d = await l.text();
      throw new Error(`Ollama error ${l.status}: ${d}`);
    }
    const c = await l.json();
    if (c.embedding)
      return c.embedding;
    if (c.embeddings && c.embeddings.length > 0)
      return c.embeddings[0];
    throw new Error(`No embedding data returned in Ollama response. Keys: ${Object.keys(c).join(", ")}`);
  }
  /**
   * Cohere API 
   */
  async callCohere(t, n) {
    const r = Hx.cohere, a = await fetch(r, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        Authorization: `Bearer ${n.apiKey}`
      },
      body: JSON.stringify({
        model: n.model || "embed-multilingual-v3.0",
        texts: [t],
        input_type: "search_document"
      })
    });
    if (!a.ok) {
      const l = await a.text();
      throw new Error(`Cohere error ${a.status}: ${l}`);
    }
    const o = await a.json();
    if (!o.embeddings || o.embeddings.length === 0)
      throw new Error("No embedding data returned");
    return o.embeddings[0];
  }
  /**
   *  Transformers  ()
   */
  async callTransformers(t, n) {
    throw new Error("Transformers embedding not yet implemented");
  }
  // ==================== EventNode  ====================
  /**
   *  EventNode 
   * @param onProgress 
   * @returns 
   */
  async embedUnprocessedEvents(t) {
    const n = hi();
    if (!n)
      throw new Error("No current chat");
    const r = hl(n), a = await r.events.filter((h) => !h.is_embedded && !h.embedding).toArray();
    if (a.length === 0)
      return { success: 0, failed: 0 };
    ye.info("EmbeddingService", ` ${a.length} `);
    const o = a.map((h) => ({
      id: h.id,
      text: h.summary
    })), l = await this.embedBatch(o, t);
    let c = 0, d = 0;
    for (const h of l) {
      if (h.error || h.embedding.length === 0) {
        d++;
        continue;
      }
      await r.events.update(h.id, {
        embedding: h.embedding,
        is_embedded: !0
      }), c++;
    }
    return ye.info("EmbeddingService", `: ${c} , ${d} `), { success: c, failed: d };
  }
  /**
   * 
   */
  async embedEvents(t, n) {
    if (t.length === 0)
      return { success: 0, failed: 0 };
    const r = hi();
    if (!r) throw new Error("No current chat");
    const a = hl(r), o = t.map((h) => ({
      id: h.id,
      text: h.summary
    })), l = await this.embedBatch(o, n);
    let c = 0, d = 0;
    for (const h of l) {
      if (h.error || h.embedding.length === 0) {
        d++;
        continue;
      }
      await a.events.update(h.id, {
        embedding: h.embedding,
        is_embedded: !0
      }), c++;
    }
    return { success: c, failed: d };
  }
  /**
   *  EventNode 
   */
  async embedEvent(t) {
    const n = await this.embed(t.summary), r = hi();
    if (r) {
      const a = yc(r);
      a && await a.events.update(t.id, {
        embedding: n,
        is_embedded: !0
      });
    }
    return n;
  }
  /**
   *  ()
   */
  async reembedAllEvents(t) {
    const n = hi();
    if (!n)
      throw new Error("No current chat");
    const r = hl(n), a = await r.events.toArray();
    if (a.length === 0)
      return { success: 0, failed: 0 };
    ye.info("EmbeddingService", ` ${a.length} `);
    for (const o of a)
      await r.events.update(o.id, {
        embedding: void 0,
        is_embedded: !1
      });
    return this.embedUnprocessedEvents(t);
  }
  // ====================  ====================
  /**
   * 
   */
  cosineSimilarity(t, n) {
    if (!t || !n || t.length !== n.length) return 0;
    let r = 0, a = 0, o = 0;
    for (let c = 0; c < t.length; c++)
      r += t[c] * n[c], a += t[c] * t[c], o += n[c] * n[c];
    const l = Math.sqrt(a) * Math.sqrt(o);
    return l === 0 ? 0 : r / l;
  }
  /**
   * 
   */
  async getEmbeddingStats() {
    const t = hi();
    if (!t)
      return { total: 0, embedded: 0, pending: 0 };
    const n = yc(t);
    if (!n)
      return { total: 0, embedded: 0, pending: 0 };
    const r = await n.events.toArray(), a = r.filter((o) => o.is_embedded).length;
    return {
      total: r.length,
      embedded: a,
      pending: r.length - a
    };
  }
}
const Sr = new aH();
class sH {
  constructor() {
    mt(this, "isTriggering", !1);
  }
  /**
   * 
   */
  async getStatus() {
    const t = this.getConfig(), n = t.standalone || {
      triggerType: "count",
      countLimit: 5,
      tokenLimit: 10240
    }, o = (await Oi.getState().getAllEvents()).filter((g) => !g.is_embedded && !g.is_archived), l = o.length, c = n.triggerType;
    let d = 0, h = 0;
    if (c === "token") {
      if (o.length > 0) {
        const g = o.map((b) => b.summary).join(`

`), { WorldInfoService: x } = await Promise.resolve().then(() => W9);
        d = await x.countTokens(g);
      }
      h = n.tokenLimit;
    } else
      d = l, h = n.countLimit;
    return {
      triggered: t.enabled && t.trigger === "standalone" && d >= h,
      triggerType: c,
      currentValue: d,
      threshold: h,
      pendingCount: l
    };
  }
  /**
   * 
   *  Pipeline 
   */
  async checkAndTrigger() {
    if (this.isTriggering) {
      ye.debug("StandaloneEmbedding", "");
      return;
    }
    const t = this.getConfig();
    if (!t.enabled || t.trigger !== "standalone")
      return;
    const n = await this.getStatus();
    if (n.triggered) {
      this.isTriggering = !0, ye.info("StandaloneEmbedding", "", {
        type: n.triggerType,
        value: n.currentValue,
        threshold: n.threshold,
        pending: n.pendingCount
      });
      try {
        const r = nt.get("apiSettings");
        if (r != null && r.vectorConfig)
          Sr.setConfig(r.vectorConfig), Sr.setConcurrency(t.concurrency);
        else {
          ye.warn("StandaloneEmbedding", "");
          return;
        }
        const a = await Sr.embedUnprocessedEvents();
        ye.success("StandaloneEmbedding", "", a), Kt.success(` ${a.success} `, "Engram ");
      } catch (r) {
        const a = r instanceof Error ? r.message : String(r);
        ye.error("StandaloneEmbedding", "", { error: a }), Kt.error(`: ${a}`, "Engram ");
      } finally {
        this.isTriggering = !1;
      }
    }
  }
  /**
   * 
   */
  getConfig() {
    const t = nt.get("apiSettings");
    return (t == null ? void 0 : t.embeddingConfig) || {
      enabled: !1,
      trigger: "with_trim",
      concurrency: 5
    };
  }
}
const oH = new sH(), lA = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  standaloneEmbeddingTrigger: oH
}, Symbol.toStringTag, { value: "Module" })), Kf = class Kf {
  constructor() {
  }
  static getInstance() {
    return Kf.instance || (Kf.instance = new Kf()), Kf.instance;
  }
  /**
   *  Rerank 
   */
  getConfig() {
    const t = nt.get("apiSettings");
    return (t == null ? void 0 : t.rerankConfig) || null;
  }
  /**
   *  Rerank 
   */
  isEnabled() {
    const t = this.getConfig();
    return !!(t != null && t.enabled && t.url && t.model);
  }
  /**
   *  Rerank API 
   *
   * @param query 
   * @param documents 
   * @returns 
   */
  async rerank(t, n) {
    var a;
    const r = this.getConfig();
    if (!(r != null && r.enabled))
      return ye.debug("RerankService", "Rerank "), n.map((o, l) => ({ index: l, relevance_score: 0 }));
    if (!r.url || !r.model)
      return ye.warn("RerankService", "Rerank ", { url: r.url, model: r.model }), n.map((o, l) => ({ index: l, relevance_score: 0 }));
    if (n.length === 0)
      return [];
    try {
      const o = r.url.endsWith("/rerank") ? r.url : `${r.url.replace(/\/$/, "")}/rerank`;
      ye.debug("RerankService", " Rerank API", {
        endpoint: o,
        model: r.model,
        queryLength: t.length,
        documentCount: n.length
      });
      const l = await fetch(o, {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          ...r.apiKey && {
            Authorization: `Bearer ${r.apiKey}`
          }
        },
        body: JSON.stringify({
          model: r.model,
          query: t,
          documents: n,
          top_n: r.topN || 5
        })
      });
      if (!l.ok) {
        const h = await l.text();
        throw new Error(`Rerank API  (${l.status}): ${h}`);
      }
      const c = await l.json(), d = c.results || c.data || [];
      return ye.info("RerankService", "Rerank ", {
        resultCount: d.length,
        topScore: (a = d[0]) == null ? void 0 : a.relevance_score
      }), d.sort((h, p) => p.relevance_score - h.relevance_score);
    } catch (o) {
      const l = o instanceof Error ? o.message : "";
      return ye.error("RerankService", "Rerank ", { error: l }), n.map((c, d) => ({ index: d, relevance_score: 0 }));
    }
  }
  /**
   *  (alpha)
   * 0 = 1 =  Rerank 
   */
  getHybridAlpha() {
    const t = this.getConfig();
    return (t == null ? void 0 : t.hybridAlpha) ?? 0.5;
  }
};
mt(Kf, "instance");
let X3 = Kf;
const Gx = X3.getInstance();
function lH(e, t, n) {
  return e == null && t == null ? 0 : e == null ? t ?? 0 : t == null ? e : (1 - n) * e + n * t;
}
function Q3(e, t) {
  var r;
  const n = e.map((a) => ({
    ...a,
    hybridScore: lH(
      a.embeddingScore,
      a.rerankScore,
      t
    )
  }));
  return n.sort((a, o) => (o.hybridScore ?? 0) - (a.hybridScore ?? 0)), ye.debug("HybridScorer", "", {
    candidateCount: n.length,
    topScore: (r = n[0]) == null ? void 0 : r.hybridScore,
    alpha: t
  }), n;
}
function uH(e, t, n, r) {
  for (const o of t) {
    const l = n[o.index];
    if (l && e.has(l.id)) {
      const c = e.get(l.id);
      c.rerankScore = o.relevance_score;
    }
  }
  const a = Array.from(e.values());
  return Q3(a, r);
}
function cH(e, t, n) {
  if (!n.enabled)
    return e;
  const r = e.map((a) => {
    const o = t.getStickyPenalty(a.id, n), c = (a.hybridScore ?? a.embeddingScore ?? 0) * (1 - o);
    return {
      ...a,
      hybridScore: c,
      stickyPenalty: o,
      isSticky: o > 0
    };
  });
  return r.sort((a, o) => (o.hybridScore ?? 0) - (a.hybridScore ?? 0)), ye.debug("HybridScorer", "", {
    totalCandidates: e.length,
    stickyCount: r.filter((a) => a.isSticky).length,
    maxPenalty: Math.max(...r.map((a) => a.stickyPenalty ?? 0))
  }), r;
}
class fH {
  constructor() {
    mt(this, "logs", []);
    mt(this, "maxLogs", 50);
    mt(this, "subscribers", /* @__PURE__ */ new Set());
  }
  /**
   * 
   */
  log(t) {
    const n = {
      id: `recall-${Date.now()}-${Math.random().toString(36).slice(2, 8)}`,
      timestamp: Date.now(),
      ...t
    };
    this.logs.unshift(n), this.logs.length > this.maxLogs && (this.logs = this.logs.slice(0, this.maxLogs)), ye.debug("RecallLogService", "", {
      query: t.query.substring(0, 50),
      resultCount: t.results.length
    }), this.notifySubscribers();
  }
  /**
   * 
   */
  getLogs() {
    return [...this.logs];
  }
  /**
   * 
   */
  clear() {
    this.logs = [], this.notifySubscribers();
  }
  /**
   * 
   */
  subscribe(t) {
    return this.subscribers.add(t), () => this.subscribers.delete(t);
  }
  /**
   * 
   */
  notifySubscribers() {
    const t = this.getLogs();
    this.subscribers.forEach((n) => n(t));
  }
  /**
   *  JSON 
   */
  exportLogs() {
    const { VERSION: t } = require("@/constants"), n = {
      version: t,
      exportedAt: Date.now(),
      logs: this.getLogs()
    }, r = new Blob([JSON.stringify(n, null, 2)], { type: "application/json" }), a = URL.createObjectURL(r), o = document.createElement("a");
    o.href = a, o.download = `engram_debug_log_${(/* @__PURE__ */ new Date()).toISOString().replace(/[:.]/g, "-")}.json`, document.body.appendChild(o), o.click(), document.body.removeChild(o), URL.revokeObjectURL(a);
  }
}
const Zy = new fH();
class dH {
  /**
   * 
   */
  getRecallConfig() {
    const t = nt.get("apiSettings");
    return (t == null ? void 0 : t.recallConfig) || Ag;
  }
  /**
   * 
   * 
   */
  async hasVectorizedNodes() {
    const t = hi();
    if (!t) return !1;
    const n = yc(t);
    return n ? await n.events.filter((a) => !!a.embedding && a.embedding.length > 0).limit(1).count() > 0 : !1;
  }
  /**
   * 
   */
  getVectorConfig() {
    const t = nt.get("apiSettings");
    return t == null ? void 0 : t.vectorConfig;
  }
  /**
   *  Rerank 
   */
  getRerankConfig() {
    const t = nt.get("apiSettings");
    return (t == null ? void 0 : t.rerankConfig) || null;
  }
  /**
   * 
   *
   * @param userInput 
   * @param unifiedQueries  ()
   * @returns 
   */
  async search(t, n) {
    const r = this.getRecallConfig(), a = this.getVectorConfig();
    if (r.useEmbedding && a && Sr.setConfig(a), Bp.nextRound(), !r.enabled) {
      ye.debug("Retriever", "");
      const o = (a == null ? void 0 : a.topK) || 20;
      return this.rollingSearch(o);
    }
    if (r.useBruteForce) {
      ye.debug("Retriever", " ()");
      const o = (a == null ? void 0 : a.topK) || 20;
      return this.rollingSearch(o);
    }
    return r.useEmbedding ? this.hybridSearch(t, n, r) : this.rollingSearch(config.embedding.topK);
  }
  /**
   * Embedding + Rerank
   */
  async hybridSearch(t, n, r) {
    const a = Date.now(), o = Date.now(), l = await this.doEmbeddingSearch(
      t,
      n,
      r
    ), c = Date.now() - o;
    if (l.length === 0)
      return ye.debug("Retriever", "Embedding "), { entries: [], nodes: [] };
    let d = l, h = 0;
    if (r.useRerank && Gx.isEnabled()) {
      const N = Date.now(), T = (n == null ? void 0 : n[0]) || t, j = l.map((q) => q.summary), R = await Gx.rerank(T, j);
      h = Date.now() - N;
      const A = new Map(l.map((q) => [q.id, q])), z = Gx.getHybridAlpha();
      d = uH(
        A,
        R,
        l,
        z
      ), ye.info("Retriever", "", {
        embeddingCount: l.length,
        rerankCount: R.length,
        finalCount: d.length,
        embeddingTime: c,
        rerankTime: h
      });
    } else
      d = Q3(l, 0);
    const p = r.sticky || E7;
    p.enabled && (d = cH(d, Bp, p), ye.debug("Retriever", "", {
      candidatesWithPenalty: d.filter((N) => (N.stickyPenalty || 0) > 0).length
    }));
    const g = Date.now() - a;
    Zy.log({
      query: t,
      preprocessedQuery: n == null ? void 0 : n[0],
      mode: "hybrid",
      results: d.map((N) => {
        var T, j, R, A;
        return {
          eventId: N.id,
          summary: N.summary,
          category: ((j = (T = N.node) == null ? void 0 : T.structured_kv) == null ? void 0 : j.event) || "unknown",
          embeddingScore: N.embeddingScore || 0,
          rerankScore: N.rerankScore,
          hybridScore: N.hybridScore,
          isTopK: !0,
          isReranked: N.rerankScore != null,
          sourceFloor: (A = (R = N.node) == null ? void 0 : R.source_range) == null ? void 0 : A.start_index
        };
      }),
      stats: {
        totalCandidates: l.length,
        topKCount: l.length,
        rerankCount: d.length,
        latencyMs: g
      }
    });
    const x = d.map((N) => N.id);
    Bp.markRecalledBatch(x), Bp.cleanup(10);
    const b = d.filter((N) => N.node).map((N) => N.node), C = d.map((N) => N.summary);
    return ye.info("Retriever", "", {
      useEmbedding: r.useEmbedding,
      useRerank: r.useRerank,
      totalTime: g,
      resultCount: b.length,
      stickyRound: Bp.getCurrentRound()
    }), { entries: C, nodes: b };
  }
  /**
   *  Embedding  ()
   */
  async embeddingOnlySearch(t, n, r) {
    const a = await this.doEmbeddingSearch(t, n, r), o = Q3(a, 0), l = o.filter((d) => d.node).map((d) => d.node);
    return { entries: o.map((d) => d.summary), nodes: l };
  }
  /**
   *  Embedding 
   */
  async doEmbeddingSearch(t, n, r) {
    var g, x;
    const a = hi();
    if (!a)
      return [];
    const o = yc(a);
    if (!o)
      return [];
    const l = await o.events.filter((b) => !!b.embedding && b.embedding.length > 0).toArray();
    if (l.length === 0)
      return ye.debug("Retriever", ""), [];
    const c = n && n.length > 0 ? n : [t];
    ye.debug("Retriever", "", {
      queryCount: c.length,
      eventCount: l.length
    });
    const d = /* @__PURE__ */ new Map();
    for (const b of c)
      try {
        const C = await Sr.embed(b);
        for (const N of l) {
          if (!N.embedding) continue;
          const T = Sr.cosineSimilarity(
            C,
            N.embedding
          ), j = ((g = r.embedding) == null ? void 0 : g.minScoreThreshold) ?? 0.3;
          if (T < j) continue;
          const R = d.get(N.id);
          (!R || T > (R.embeddingScore || 0)) && d.set(N.id, {
            id: N.id,
            summary: N.summary,
            embeddingScore: T,
            node: N
          });
        }
      } catch (C) {
        ye.error("Retriever", `Query : ${b}`, {
          message: (C == null ? void 0 : C.message) || C,
          stack: C == null ? void 0 : C.stack
        });
      }
    const h = this.getVectorConfig(), p = Array.from(d.values()).sort((b, C) => (C.embeddingScore || 0) - (b.embeddingScore || 0)).slice(0, (h == null ? void 0 : h.topK) || 20);
    return ye.debug("Retriever", "Embedding ", {
      totalMatched: d.size,
      topK: p.length,
      topScore: (x = p[0]) == null ? void 0 : x.embeddingScore
    }), p;
  }
  /**
   *  ()
   * 
   */
  async rollingSearch(t) {
    const n = hi();
    if (!n)
      return { entries: [], nodes: [] };
    const r = yc(n);
    if (!r)
      return { entries: [], nodes: [] };
    const a = await r.events.filter((d) => d.level === 0).reverse().limit(t).toArray(), o = await r.events.filter((d) => d.level === 1).reverse().first(), l = [...a];
    return o && l.unshift(o), { entries: l.map((d) => d.summary), nodes: l };
  }
  /**
   * @deprecated  search() 
   */
  async vectorSearch(t, n) {
    return this.search(t);
  }
}
const gE = new dH();
class uA {
  constructor() {
    mt(this, "isInitialized", !1);
    mt(this, "isProcessing", !1);
  }
  // 
  /**
   * Initialize the Injector
   */
  init() {
    this.isInitialized || (ye.info("Injector", " V0.8 ..."), console.log("[Injector] Starting initialization..."), Ss.on(
      uo.GENERATION_AFTER_COMMANDS,
      async (t, n, r) => {
        console.log("[Injector]  GENERATION_AFTER_COMMANDS triggered", { type: t, dryRun: r }), ye.info("Injector", "  GENERATION_AFTER_COMMANDS ", { type: t, dryRun: r }), await this.handleGenerationAfterCommands(t, n, r);
      }
    ), Ss.on(uo.CHAT_CHANGED, () => {
      ye.debug("Injector", " CHAT_CHANGED "), this.isProcessing = !1, co.refreshCache().catch((t) => {
        ye.warn("Injector", "", t);
      });
    }), this.isInitialized = !0, ye.success("Injector", "V0.8 Injector "), console.log("[Injector]  V0.8 Initialized - Listening for GENERATION_AFTER_COMMANDS"));
  }
  /**
   *  GENERATION_AFTER_COMMANDS 
   *  async  await
   */
  async handleGenerationAfterCommands(t, n, r) {
    try {
      if (r) {
        ye.debug("Injector", "dryRun ");
        return;
      }
      if (t === "regenerate" || t === "swipe" || t === "quiet" || t === "impersonate") {
        ye.debug("Injector", ` ${t} `);
        return;
      }
      if (n._engram_processed) {
        ye.debug("Injector", "");
        return;
      }
      if (this.isProcessing) {
        ye.debug("Injector", "");
        return;
      }
      const a = hi();
      if (!a) {
        ye.warn("Injector", " ID");
        return;
      }
      const o = pl();
      if (!o || !o.chat || o.chat.length === 0) {
        ye.warn("Injector", "");
        return;
      }
      const l = o.chat, c = l.length - 1, d = l[c];
      let h = "", p = "chat";
      if (d && d.is_user)
        h = d.mes;
      else {
        const T = document.getElementById("send_textarea");
        if (T && T.value && T.value.trim().length > 0)
          h = T.value, p = "textarea", ye.info("Injector", " Textarea  (Strategy 2)", {
            preview: h.substring(0, 50)
          });
        else {
          ye.debug("Injector", "", {
            index: c,
            isUser: d == null ? void 0 : d.is_user
          });
          return;
        }
      }
      if (!h || h.trim().length === 0) {
        ye.debug("Injector", "");
        return;
      }
      ye.debug("Injector", "...");
      let g, x, b;
      try {
        if (g = nt.get("apiSettings"), ye.debug("Injector", " apiSettings"), x = (g == null ? void 0 : g.recallConfig) || Ag, ye.debug("Injector", " recallConfig", x), !Qf)
          throw new Error("Preprocessor service is undefined");
        b = Qf.getConfig(), ye.debug("Injector", " preprocessorConfig", b);
      } catch (T) {
        throw ye.error("Injector", "", T), T;
      }
      if (ye.info("Injector", "", {
        chatId: a,
        userInputLength: h.length,
        userInputPreview: h.substring(0, 50) + "...",
        recallEnabled: x.enabled,
        preprocessingEnabled: x.usePreprocessing && b.enabled,
        autoTrigger: b.autoTrigger,
        templateId: b.templateId
      }), x.usePreprocessing && b.enabled && !b.autoTrigger && (ye.debug("Injector", " autoTrigger "), !x.enabled))
        return;
      this.isProcessing = !0, n._engram_processed = !0, d && (d._engram_processed = !0), ye.info("Injector", " ...");
      let C = h, N = [];
      try {
        if (x.usePreprocessing && b.enabled && b.autoTrigger)
          try {
            co.setUserInput(h), await co.refreshCache();
            const T = await Qf.process(h);
            if (T.success && T.output) {
              ye.success("Injector", " ", {
                outputLength: T.output.length,
                hasQuery: !!T.query
              });
              const j = nt.getPromptTemplateById(b.templateId), R = (j == null ? void 0 : j.injectionMode) || "replace";
              R === "append" ? C = `${h}

${T.output}` : R === "prepend" ? C = `${T.output}

${h}` : C = T.output, T.query && N.push(T.query);
            } else
              ye.warn("Injector", "");
          } catch (T) {
            ye.warn("Injector", " ", T);
          }
        if (x.enabled)
          try {
            if (!await gE.hasVectorizedNodes())
              ye.info("Injector", " RAG ");
            else {
              ye.info("Injector", "  RAG ", {
                queryCount: N.length,
                firstQuery: N[0] || h.substring(0, 50)
              });
              const j = await gE.search(
                h,
                N.length > 0 ? N : void 0
              );
              j.nodes.length > 0 ? (ye.info("Injector", " RAG ", {
                nodeCount: j.nodes.length,
                entries: j.entries.length
              }), await co.refreshCacheWithNodes(j.nodes)) : ye.debug("Injector", "RAG ");
            }
          } catch (T) {
            ye.error("Injector", "RAG ", T);
          }
        if (C = Cs.process(C, "output"), C !== h) {
          if (p === "chat") {
            d.mes = C;
            try {
              const T = o.eventSource, j = o.event_types;
              T && (j != null && j.MESSAGE_UPDATED) && (T.emit(j.MESSAGE_UPDATED, c), ye.debug("Injector", " MESSAGE_UPDATED "));
            } catch (T) {
              ye.warn("Injector", " MESSAGE_UPDATED ", T);
            }
            try {
              const T = document.getElementById("send_textarea");
              T && T.value === h && (T.value = "", T.dispatchEvent(new Event("input", { bubbles: !0 })));
            } catch {
            }
          } else if (p === "textarea") {
            ye.info("Injector", " Textarea (Strategy 2)");
            try {
              const T = document.getElementById("send_textarea");
              T && (T.value = C, T.dispatchEvent(new Event("input", { bubbles: !0 }))), n && (n.prompt = C);
            } catch (T) {
              ye.warn("Injector", " Textarea ", T);
            }
          }
        }
      } finally {
        setTimeout(() => {
          this.isProcessing = !1;
        }, 1e3);
      }
    } catch (a) {
      this.isProcessing = !1, ye.error("Injector", "handleGenerationAfterCommands ", {
        message: (a == null ? void 0 : a.message) || a,
        stack: a == null ? void 0 : a.stack
      }), console.error("[Injector] Error:", a);
    }
  }
}
const hH = new uA(), mH = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  Injector: uA,
  injector: hH
}, Symbol.toStringTag, { value: "Module" }));
class cA {
  static init() {
    if (!this.isInitialized)
      try {
        const t = pl();
        if (!(t != null && t.eventSource) || !(t != null && t.event_types)) {
          ye.warn("CharacterDeleteService", "");
          return;
        }
        t.event_types.CHARACTER_DELETED && (t.eventSource.on(t.event_types.CHARACTER_DELETED, this.onCharacterDeleted.bind(this)), ye.info("CharacterDeleteService", " CHARACTER_DELETED ")), t.event_types.CHAT_DELETED && (t.eventSource.on(t.event_types.CHAT_DELETED, this.onChatDeleted.bind(this)), ye.info("CharacterDeleteService", " CHAT_DELETED ")), t.event_types.GROUP_CHAT_DELETED && (t.eventSource.on(t.event_types.GROUP_CHAT_DELETED, this.onChatDeleted.bind(this)), ye.info("CharacterDeleteService", " GROUP_CHAT_DELETED ")), this.isInitialized = !0;
      } catch (t) {
        ye.error("CharacterDeleteService", "", t);
      }
  }
  /**
   * 
   */
  static async onCharacterDeleted(t) {
    var o;
    const n = nt.getSettings().linkedDeletion;
    if (!(n != null && n.enabled) || !(n != null && n.deleteWorldbook)) return;
    ye.debug("CharacterDeleteService", "", t);
    const r = t.character, a = (r == null ? void 0 : r.name) || (r == null ? void 0 : r.avatar) || (r == null ? void 0 : r.ch_name) || ((o = r == null ? void 0 : r.data) == null ? void 0 : o.name);
    if (!a) {
      ye.warn("CharacterDeleteService", "");
      return;
    }
    await this.deleteEngramWorldbooks(a, "", n.showConfirmation);
  }
  /**
   * 
   * @param chatId  ID "CharName - 2024-1-1@12h30m" 
   */
  static async onChatDeleted(t) {
    const n = nt.getSettings().linkedDeletion;
    if (!(n != null && n.enabled)) return;
    ye.debug("CharacterDeleteService", "", t);
    try {
      const { deleteDatabase: a, hasDbForChat: o } = await Promise.resolve().then(() => OI);
      o(t) && (await a(t), ye.info("CharacterDeleteService", ` IndexedDB: Engram_${t}`), Kt.info(" Engram ", "Engram"));
    } catch (a) {
      ye.error("CharacterDeleteService", `: Engram_${t}`, a);
    }
    if (!n.deleteChatWorldbook) return;
    const r = this.extractCharacterNameFromChatId(t);
    if (!r) {
      ye.debug("CharacterDeleteService", ` chatId : ${t}`);
      return;
    }
    await this.deleteEngramWorldbooks(r, "", n.showConfirmation);
  }
  /**
   *  chatId 
   */
  static extractCharacterNameFromChatId(t) {
    if (!t) return null;
    let n = t.match(/^(.+?)\s*-\s*\d{4}/);
    return n || (n = t.match(/^(.+?)_\d{4}/), n) ? n[1].trim() : null;
  }
  /**
   *  Engram 
   */
  static async deleteEngramWorldbooks(t, n, r) {
    const a = /* @__PURE__ */ new Set();
    a.add(`[Engram] ${t}`), a.add(`Engram_${t}`);
    const o = await mn.getWorldbookNames(), l = new Set(o), c = Array.from(a).filter((p) => {
      if (!l.has(p)) return !1;
      const g = p.toLowerCase().includes("engram");
      return g || ye.info("CharacterDeleteService", ` Engram : ${p}`), g;
    });
    if (c.length === 0) {
      ye.debug("CharacterDeleteService", ` "${t}"  Engram `);
      return;
    }
    if (ye.info("CharacterDeleteService", `: ${c.join(", ")}`), r) {
      const p = `
                <div style="font-size: 0.9em;">
                    <h3> Engram </h3>
                    <p>${n} <b>${t}</b> </p>
                    <p> Engram </p>
                    <ul style="max-height: 100px; overflow-y: auto; background: var(--black50a); padding: 5px; border-radius: 4px; list-style: none; margin: 10px 0;">
                        ${c.map((x) => `<li style="padding: 2px 0;"> ${x}</li>`).join("")}
                    </ul>
                    <p></p>
                    <small style="opacity: 0.7;"></small>
                </div>
            `;
      if (!await D$(p, "confirm")) {
        ye.info("CharacterDeleteService", "");
        return;
      }
    }
    let d = 0;
    const h = [];
    Kt.info(" Engram ...", "Engram");
    for (const p of c)
      try {
        await mn.deleteWorldbook(p) ? (d++, ye.info("CharacterDeleteService", `: ${p}`)) : h.push(p);
      } catch (g) {
        ye.error("CharacterDeleteService", ` ${p} `, g), h.push(p);
      }
    d > 0 && Kt.success(` ${d} `, "Engram"), h.length > 0 && Kt.warning(`: ${h.join(", ")}`, "Engram");
  }
}
mt(cA, "isInitialized", !1);
const pH = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  CharacterDeleteService: cA
}, Symbol.toStringTag, { value: "Module" }));
class fA {
  constructor(t) {
    mt(this, "config");
    mt(this, "isExtracting", !1);
    this.config = { ...ES, ...t };
  }
  /**
   * 
   */
  updateConfig(t) {
    this.config = { ...this.config, ...t };
  }
  /**
   * 
   */
  getConfig() {
    return { ...this.config };
  }
  /**
   * 
   * V0.9.1:  SummarizerService 
   */
  shouldTriggerOnFloor(t) {
    return !this.config.enabled || this.config.trigger !== "floor" ? !1 : t > 0 && t % this.config.floorInterval === 0;
  }
  /**
   * 
   * V0.9.1:  chatHistory  engramGraph
   *
   * @param chatHistory 
   * @param floor 
   * @param manual 
   */
  async extractFromChat(t, n, r = !1) {
    var o;
    if (this.isExtracting)
      return ye.warn("EntityBuilder", ""), null;
    this.isExtracting = !0;
    const a = Date.now();
    ye.info("EntityBuilder", ` ( ${n})`);
    try {
      const c = await Oi.getState().getAllEntities(), d = c.map((j) => ({
        name: j.name,
        type: j.type,
        aliases: j.aliases || []
      })), p = (((o = nt.get("apiSettings")) == null ? void 0 : o.promptTemplates) || []).find((j) => j.category === "entity_extraction" && j.enabled), g = (p == null ? void 0 : p.systemPrompt) || C7, b = ((p == null ? void 0 : p.userPromptTemplate) || `

****:
{{chatHistory}}

****:
{{existingEntities}}

---
 JSON `).replace("{{chatHistory}}", t).replace("{{existingEntities}}", JSON.stringify(d, null, 2)).replace("{{worldbookContext}}", co.cachedWorldbookContext || ""), C = await nd.generate({
        systemPrompt: g,
        userPrompt: b
      });
      if (!C.success || !C.content)
        return ye.error("EntityBuilder", "LLM ", { error: C.error }), r && Kt.error("LLM ", "Engram"), { success: !1, newEntities: [], updatedEntities: [], error: C.error };
      const N = KS.parse(C.content);
      if (!N || !N.entities)
        return ye.error("EntityBuilder", "JSON "), r && Kt.error("", "Engram"), { success: !1, newEntities: [], updatedEntities: [], error: "JSON parse failed" };
      const T = await this.saveEntities(N, c);
      return await Xf.updateState({ last_extracted_floor: n }), ye.success("EntityBuilder", "", {
        floor: n,
        newCount: T.newEntities.length,
        updatedCount: T.updatedEntities.length,
        duration: Date.now() - a
      }), r && Kt.success(
        ` ${T.newEntities.length} `,
        "Engram"
      ), T;
    } catch (l) {
      const c = l instanceof Error ? l.message : String(l);
      return ye.error("EntityBuilder", "", { error: c }), r && Kt.error(`: ${c}`, "Engram "), { success: !1, newEntities: [], updatedEntities: [], error: c };
    } finally {
      this.isExtracting = !1;
    }
  }
  /**
   * 
   */
  async extractManual() {
    const t = await co.getChatHistory("50"), n = await Xf.getState();
    return this.extractFromChat(t, n.last_summarized_floor, !0);
  }
  /**
   * 
   * V0.9.4:  profile 
   */
  async saveEntities(t, n) {
    var l, c;
    const r = Oi.getState(), a = [], o = [];
    for (const d of t.entities) {
      const h = this.resolveEntity(d.name, d.aliases, n), p = this.profileToYaml(d.name, d.type, d.profile);
      if (h) {
        const g = {
          ...h.profile,
          ...d.profile
        };
        if (Array.isArray((l = d.profile) == null ? void 0 : l.relations)) {
          const C = ((c = h.profile) == null ? void 0 : c.relations) || [], N = d.profile.relations, T = new Map(C.map((j) => [j.target, j]));
          for (const j of N)
            T.set(j.target, j);
          g.relations = Array.from(T.values());
        }
        const x = {
          description: this.profileToYaml(h.name, h.type, g),
          profile: g
        }, b = /* @__PURE__ */ new Set([...h.aliases || [], ...d.aliases]);
        x.aliases = Array.from(b), await r.updateEntity(h.id, x), o.push({ ...h, ...x });
      } else {
        const g = {
          char: Ff.Character,
          loc: Ff.Location,
          item: Ff.Item,
          concept: Ff.Concept,
          unknown: Ff.Unknown
        }, x = await r.saveEntity({
          name: d.name,
          type: g[d.type] || Ff.Unknown,
          description: p,
          aliases: d.aliases || [],
          profile: d.profile || {}
        });
        a.push(x);
      }
    }
    return {
      success: !0,
      newEntities: a,
      updatedEntities: o
    };
  }
  /**
   *  profile  YAML  (For Model)
   * V0.9.4: 
   */
  profileToYaml(t, n, r) {
    const a = [`${t} (${n})`];
    for (const [o, l] of Object.entries(r))
      if (o === "relations" && Array.isArray(l)) {
        a.push(":");
        for (const c of l) {
          const d = c.description ? ` - ${c.description}` : "";
          a.push(`  - ${c.target}: ${c.type}${d}`);
        }
      } else typeof l == "string" ? a.push(`${o}: ${l}`) : Array.isArray(l) && a.push(`${o}: ${l.join(", ")}`);
    return a.join(`
`);
  }
  /**
   * 
   */
  resolveEntity(t, n, r) {
    const a = r.find((l) => l.name === t);
    if (a) return a;
    const o = r.find((l) => {
      var c;
      return (c = l.aliases) == null ? void 0 : c.includes(t);
    });
    if (o) return o;
    for (const l of n) {
      const c = r.find(
        (d) => {
          var h;
          return d.name === l || ((h = d.aliases) == null ? void 0 : h.includes(l));
        }
      );
      if (c) return c;
    }
    return null;
  }
  /**
   *  (UI )
   * V0.9.1: 
   */
  async getStatus() {
    const n = await Oi.getState().getAllEntities(), r = await Xf.getState();
    return {
      enabled: this.config.enabled,
      trigger: this.config.trigger,
      floorInterval: this.config.floorInterval,
      lastExtractedFloor: r.last_extracted_floor,
      entityCount: n.length,
      isExtracting: this.isExtracting
    };
  }
}
const eu = new fA(), gH = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  EntityBuilder: fA,
  entityBuilder: eu
}, Symbol.toStringTag, { value: "Module" })), yE = "engram_macro_slot", vE = "Engram Memory Context";
class dA {
  /**
   *  WorldBook 
   * 
   */
  static async init() {
    if (!this.isInitialized)
      try {
        const t = await mn.getOrCreateWorldbook();
        if (!t) {
          ye.warn("WorldBookSlotService", "");
          return;
        }
        const n = await mn.findEntryByKey(t, yE);
        if (n) {
          ye.debug("WorldBookSlotService", "", {
            uid: n.uid,
            name: n.name
          }), this.isInitialized = !0;
          return;
        }
        await mn.createEntry(t, {
          name: vE,
          content: "{{engramSummaries}}",
          keys: [yE],
          constant: !0,
          enabled: !0,
          position: "at_depth",
          role: "system",
          depth: 999,
          order: 9e3
          //  order
        }) ? (ye.success("WorldBookSlotService", "", {
          worldbook: t,
          name: vE
        }), this.isInitialized = !0) : ye.error("WorldBookSlotService", "");
      } catch (t) {
        ye.error("WorldBookSlotService", "", t);
      }
  }
  /**
   * 
   */
  static isReady() {
    return this.isInitialized;
  }
  /**
   * 
   */
  static reset() {
    this.isInitialized = !1;
  }
}
mt(dA, "isInitialized", !1);
const yH = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  WorldBookSlotService: dA
}, Symbol.toStringTag, { value: "Module" }));
function vH(e) {
  return new Date(e).toTimeString().slice(0, 8);
}
const xH = {
  [Kn.DEBUG]: { text: "text-zinc-500", bg: "bg-zinc-500/10" },
  [Kn.INFO]: { text: "text-blue-400", bg: "bg-blue-500/10" },
  [Kn.SUCCESS]: { text: "text-emerald-400", bg: "bg-emerald-500/10" },
  [Kn.WARN]: { text: "text-amber-400", bg: "bg-amber-500/10" },
  [Kn.ERROR]: { text: "text-red-400", bg: "bg-red-500/10" }
}, bH = ({ entry: e }) => {
  const [t, n] = G.useState(!1), r = e.data !== void 0, a = l1[e.level], o = xH[e.level];
  return /* @__PURE__ */ m.jsxs("div", { className: "group", children: [
    /* @__PURE__ */ m.jsxs(
      "div",
      {
        className: `
                    flex items-start gap-3 px-2 py-1 rounded-sm transition-colors
                    hover:bg-white/[0.02]
                    ${r ? "cursor-pointer" : ""}
                `,
        onClick: () => r && n(!t),
        children: [
          /* @__PURE__ */ m.jsx("span", { className: "flex items-center text-zinc-600 shrink-0 mt-0.5 w-3", children: r ? t ? /* @__PURE__ */ m.jsx(ed, { size: 12 }) : /* @__PURE__ */ m.jsx(Jh, { size: 12 }) : null }),
          /* @__PURE__ */ m.jsx("span", { className: "text-zinc-600 shrink-0 tabular-nums text-[11px]", children: vH(e.timestamp) }),
          /* @__PURE__ */ m.jsx("span", { className: `
                    shrink-0 text-[10px] font-medium px-1.5 py-0.5 rounded
                    ${o.text} ${o.bg}
                `, children: a.label }),
          /* @__PURE__ */ m.jsx("span", { className: "text-zinc-500 shrink-0 text-[11px]", children: e.module }),
          /* @__PURE__ */ m.jsx("span", { className: "text-zinc-300 text-[11px] break-words flex-1 leading-relaxed", children: e.message })
        ]
      }
    ),
    t && r && /* @__PURE__ */ m.jsx("div", { className: "ml-10 mr-2 mb-1 px-3 py-2 bg-zinc-900/50 border-l-2 border-zinc-700 rounded-r text-[10px]", children: /* @__PURE__ */ m.jsx("pre", { className: "m-0 text-zinc-400 whitespace-pre-wrap break-words font-mono", children: JSON.stringify(e.data, null, 2) }) })
  ] });
}, wH = {
  summarize: { label: "", color: "bg-blue-500/20 text-blue-400" },
  trim: { label: "", color: "bg-yellow-500/20 text-yellow-500" },
  vectorize: { label: "", color: "bg-purple-500/20 text-purple-400" },
  query: { label: "", color: "bg-green-500/20 text-green-400" },
  other: { label: "", color: "bg-gray-500/20 text-gray-400" }
}, _H = ({ status: e }) => {
  switch (e) {
    case "pending":
      return /* @__PURE__ */ m.jsx(au, { size: 14, className: "animate-spin text-yellow-400" });
    case "success":
      return /* @__PURE__ */ m.jsx(pS, { size: 14, className: "text-green-400" });
    case "error":
      return /* @__PURE__ */ m.jsx(xc, { size: 14, className: "text-red-400" });
  }
}, SH = (e) => new Date(e).toLocaleTimeString("zh-CN", {
  hour12: !1,
  hour: "2-digit",
  minute: "2-digit",
  second: "2-digit"
}), CH = (e) => e === void 0 ? "-" : e < 1e3 ? `${e}ms` : `${(e / 1e3).toFixed(1)}s`, EH = ({ sent: e, received: t }) => {
  const [n, r] = G.useState(!1), a = wH[e.type];
  return /* @__PURE__ */ m.jsxs("div", { className: "border border-border rounded-lg overflow-hidden bg-card", children: [
    /* @__PURE__ */ m.jsxs(
      "div",
      {
        className: "flex items-center gap-2 px-3 py-2 bg-muted-20 cursor-pointer hover:bg-muted-30",
        onClick: () => r(!n),
        children: [
          n ? /* @__PURE__ */ m.jsx(ed, { size: 14 }) : /* @__PURE__ */ m.jsx(Jh, { size: 14 }),
          /* @__PURE__ */ m.jsx("span", { className: `px-2 py-0.5 rounded text-xs font-medium ${a.color}`, children: a.label }),
          e.model && /* @__PURE__ */ m.jsx("span", { className: "px-1.5 py-0.5 rounded text-[10px] font-medium bg-indigo-500/10 text-indigo-400 border border-indigo-500/20 truncate max-w-[150px]", title: `: ${e.model}`, children: e.model }),
          e.character && /* @__PURE__ */ m.jsx("span", { className: "px-1.5 py-0.5 rounded text-[10px] font-medium bg-orange-500/10 text-orange-400 border border-orange-500/20 truncate max-w-[120px]", title: `: ${e.character}`, children: e.character }),
          /* @__PURE__ */ m.jsx("span", { className: "text-xs text-muted-foreground", children: SH(e.timestamp) }),
          /* @__PURE__ */ m.jsx(_H, { status: (t == null ? void 0 : t.status) || e.status }),
          e.floorRange && /* @__PURE__ */ m.jsxs("span", { className: "text-xs text-muted-foreground", children: [
            " #",
            e.floorRange[0],
            "-",
            e.floorRange[1]
          ] }),
          /* @__PURE__ */ m.jsxs("span", { className: "ml-auto text-xs text-muted-foreground flex items-center gap-1", children: [
            /* @__PURE__ */ m.jsx(a1, { size: 12 }),
            CH((t == null ? void 0 : t.duration) || e.duration)
          ] })
        ]
      }
    ),
    n && /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col md:flex-row", children: [
      /* @__PURE__ */ m.jsxs("div", { className: "flex-1 border-r border-border p-3", children: [
        /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-2 mb-2 text-sm font-medium text-blue-400", children: [
          /* @__PURE__ */ m.jsx(aD, { size: 14 }),
          "",
          e.tokensSent && /* @__PURE__ */ m.jsxs("span", { className: "text-xs text-muted-foreground ml-auto", children: [
            "~",
            e.tokensSent,
            " tokens"
          ] })
        ] }),
        e.systemPrompt && /* @__PURE__ */ m.jsxs("div", { className: "mb-3", children: [
          /* @__PURE__ */ m.jsx("div", { className: "text-xs text-muted-foreground mb-1", children: "System" }),
          /* @__PURE__ */ m.jsx("div", { className: "text-sm p-2 bg-muted-20 rounded max-h-[500px] overflow-y-auto whitespace-pre-wrap", children: e.systemPrompt })
        ] }),
        e.userPrompt && /* @__PURE__ */ m.jsxs("div", { children: [
          /* @__PURE__ */ m.jsx("div", { className: "text-xs text-muted-foreground mb-1", children: "User" }),
          /* @__PURE__ */ m.jsx("div", { className: "text-sm p-2 bg-muted-20 rounded max-h-[500px] overflow-y-auto whitespace-pre-wrap", children: e.userPrompt })
        ] })
      ] }),
      /* @__PURE__ */ m.jsxs("div", { className: "flex-1 p-3", children: [
        /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-2 mb-2 text-sm font-medium text-green-400", children: [
          /* @__PURE__ */ m.jsx(t7, { size: 14 }),
          "",
          (t == null ? void 0 : t.tokensReceived) && /* @__PURE__ */ m.jsxs("span", { className: "text-xs text-muted-foreground ml-auto", children: [
            "~",
            t.tokensReceived,
            " tokens"
          ] })
        ] }),
        (t == null ? void 0 : t.status) === "error" && t.error && /* @__PURE__ */ m.jsx("div", { className: "p-2 bg-red-500/10 border border-red-500/30 rounded text-sm text-red-400", children: t.error }),
        (t == null ? void 0 : t.response) && /* @__PURE__ */ m.jsx("div", { className: "text-sm p-2 bg-muted-20 rounded max-h-[500px] overflow-y-auto whitespace-pre-wrap", children: t.response }),
        !t && e.status === "pending" && /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-2 text-sm text-muted-foreground", children: [
          /* @__PURE__ */ m.jsx(au, { size: 14, className: "animate-spin" }),
          "..."
        ] })
      ] })
    ] })
  ] });
}, kH = () => {
  const [e, t] = G.useState(ns.getPaired());
  return G.useEffect(() => ns.subscribe(() => {
    t(ns.getPaired());
  }), []), /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col h-full", children: [
    /* @__PURE__ */ m.jsxs("div", { className: "flex items-center justify-between px-4 py-3 border-b border-border shrink-0", children: [
      /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-2", children: [
        /* @__PURE__ */ m.jsx(od, { size: 16, className: "text-primary" }),
        /* @__PURE__ */ m.jsx("span", { className: "font-medium text-foreground", children: "" }),
        /* @__PURE__ */ m.jsxs("span", { className: "text-xs text-muted-foreground", children: [
          "(",
          e.length,
          ")"
        ] })
      ] }),
      /* @__PURE__ */ m.jsx(
        "button",
        {
          className: "p-1.5 rounded-md hover:bg-destructive hover:text-destructive-foreground transition-colors text-muted-foreground",
          onClick: () => ns.clear(),
          title: "",
          children: /* @__PURE__ */ m.jsx(po, { size: 14 })
        }
      )
    ] }),
    /* @__PURE__ */ m.jsx("div", { className: "flex-1 overflow-y-auto p-4", children: e.length === 0 ? /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col items-center justify-center h-full text-muted-foreground gap-3", children: [
      /* @__PURE__ */ m.jsx(t7, { size: 48, className: "opacity-30" }),
      /* @__PURE__ */ m.jsx("p", { className: "text-sm", children: "" }),
      /* @__PURE__ */ m.jsx("p", { className: "text-xs", children: "" })
    ] }) : /* @__PURE__ */ m.jsx("div", { className: "flex flex-col gap-3", children: e.map(({ sent: n, received: r }) => /* @__PURE__ */ m.jsx(EH, { sent: n, received: r }, n.id)) }) })
  ] });
}, xE = 768, hA = (e) => new Date(e).toLocaleTimeString("zh-CN", {
  hour12: !1,
  hour: "2-digit",
  minute: "2-digit",
  second: "2-digit"
}), mA = (e) => e === void 0 ? "-" : e < 1e3 ? `${e}ms` : `${(e / 1e3).toFixed(1)}s`, NH = ({ entry: e, isSelected: t, onSelect: n }) => /* @__PURE__ */ m.jsxs(
  "div",
  {
    className: `
                px-3 py-2 cursor-pointer border-b border-border/30 transition-colors
                ${t ? "bg-primary/10 border-l-2 border-l-primary" : "hover:bg-muted/30"}
            `,
    onClick: n,
    children: [
      /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-2 mb-1", children: [
        /* @__PURE__ */ m.jsx("span", { className: `px-1.5 py-0.5 rounded text-[10px] font-medium ${e.mode === "hybrid" ? "bg-purple-500/20 text-purple-400" : "bg-blue-500/20 text-blue-400"}`, children: e.mode === "hybrid" ? "" : "Embed" }),
        /* @__PURE__ */ m.jsxs("span", { className: "text-[10px] text-muted-foreground", children: [
          e.stats.rerankCount,
          "/",
          e.stats.topKCount,
          " "
        ] }),
        /* @__PURE__ */ m.jsxs("span", { className: "text-[10px] text-muted-foreground ml-auto flex items-center gap-1", children: [
          /* @__PURE__ */ m.jsx(a1, { size: 10 }),
          hA(e.timestamp)
        ] })
      ] }),
      /* @__PURE__ */ m.jsx("p", { className: "text-sm text-foreground line-clamp-2", children: e.query }),
      /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-2 mt-1 text-[10px] text-muted-foreground", children: [
        /* @__PURE__ */ m.jsx(od, { size: 10 }),
        mA(e.stats.latencyMs)
      ] })
    ]
  }
), Vx = ({ label: e, score: t, color: n }) => {
  const r = Math.min(100, t * 100);
  return /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-2 text-xs", children: [
    /* @__PURE__ */ m.jsx("span", { className: "text-muted-foreground w-16 shrink-0", children: e }),
    /* @__PURE__ */ m.jsx("div", { className: "flex-1 h-1.5 bg-muted/30 rounded-full overflow-hidden", children: /* @__PURE__ */ m.jsx(
      "div",
      {
        className: `h-full ${n} rounded-full transition-all duration-300`,
        style: { width: `${r}%` }
      }
    ) }),
    /* @__PURE__ */ m.jsx("span", { className: "text-muted-foreground w-14 text-right font-mono shrink-0", children: t.toFixed(3) })
  ] });
}, jH = ({ item: e }) => {
  const [t, n] = G.useState(!1);
  return /* @__PURE__ */ m.jsxs(
    "div",
    {
      className: `
                border-b border-border/30 py-3 px-4 cursor-pointer
                hover:bg-muted/10 transition-colors
                ${e.isReranked ? "bg-purple-500/5" : e.isTopK ? "bg-blue-500/5" : ""}
            `,
      onClick: () => n(!t),
      children: [
        /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-2 mb-1.5", children: [
          e.isReranked && /* @__PURE__ */ m.jsx("span", { className: "px-1.5 py-0.5 text-[10px] bg-purple-500/20 text-purple-400 rounded", children: "Rerank" }),
          e.isTopK && !e.isReranked && /* @__PURE__ */ m.jsx("span", { className: "px-1.5 py-0.5 text-[10px] bg-blue-500/20 text-blue-400 rounded", children: "TopK" }),
          /* @__PURE__ */ m.jsx("span", { className: "text-[10px] text-muted-foreground truncate max-w-[150px]", children: e.category }),
          e.sourceFloor && /* @__PURE__ */ m.jsxs("span", { className: "text-[10px] text-muted-foreground", children: [
            " #",
            e.sourceFloor
          ] }),
          /* @__PURE__ */ m.jsx(Jh, { size: 12, className: `ml-auto text-muted-foreground transition-transform ${t ? "rotate-90" : ""}` })
        ] }),
        /* @__PURE__ */ m.jsx("p", { className: `text-sm text-foreground ${t ? "" : "line-clamp-2"}`, children: e.summary }),
        t && /* @__PURE__ */ m.jsxs("div", { className: "mt-3 space-y-1.5 pt-2 border-t border-border/20", children: [
          /* @__PURE__ */ m.jsx(Vx, { label: "Embedding", score: e.embeddingScore, color: "bg-blue-500" }),
          e.rerankScore != null && /* @__PURE__ */ m.jsx(Vx, { label: "Rerank", score: e.rerankScore, color: "bg-orange-500" }),
          e.hybridScore != null && /* @__PURE__ */ m.jsx(Vx, { label: "Hybrid", score: e.hybridScore, color: "bg-purple-500" })
        ] })
      ]
    }
  );
}, bE = ({ entry: e, isFullScreen: t, onClose: n }) => {
  const [r, a] = G.useState("all"), [o, l] = G.useState("hybrid"), [c, d] = G.useState(""), h = G.useMemo(() => {
    if (!e) return [];
    let p = [...e.results];
    if (c.trim()) {
      const g = c.toLowerCase();
      p = p.filter((x) => x.summary.toLowerCase().includes(g));
    }
    return r === "topK" ? p = p.filter((g) => g.isTopK) : r === "reranked" && (p = p.filter((g) => g.isReranked)), p.sort((g, x) => {
      const b = (C) => {
        switch (o) {
          case "embedding":
            return C.embeddingScore;
          case "rerank":
            return C.rerankScore ?? 0;
          case "hybrid":
            return C.hybridScore ?? (C.rerankScore != null ? (C.embeddingScore + C.rerankScore) / 2 : C.embeddingScore);
        }
      };
      return b(x) - b(g);
    }), p;
  }, [e, r, o, c]);
  return e ? /* @__PURE__ */ m.jsxs("div", { className: `flex flex-col h-full ${t ? "p-4" : ""}`, children: [
    t && n && /* @__PURE__ */ m.jsxs(
      "button",
      {
        onClick: n,
        className: "flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground mb-4",
        children: [
          /* @__PURE__ */ m.jsx(mS, { size: 16 }),
          ""
        ]
      }
    ),
    /* @__PURE__ */ m.jsxs("div", { className: "mb-4 pb-4 border-b border-border shrink-0", children: [
      /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-2 mb-2", children: [
        /* @__PURE__ */ m.jsx("span", { className: `px-2 py-0.5 rounded text-xs font-medium ${e.mode === "hybrid" ? "bg-purple-500/20 text-purple-400" : "bg-blue-500/20 text-blue-400"}`, children: e.mode === "hybrid" ? "" : "" }),
        /* @__PURE__ */ m.jsx("span", { className: "text-xs text-muted-foreground", children: hA(e.timestamp) })
      ] }),
      /* @__PURE__ */ m.jsx("p", { className: "text-sm text-foreground mb-2", children: e.query }),
      e.preprocessedQuery && e.preprocessedQuery !== e.query && /* @__PURE__ */ m.jsxs("p", { className: "text-xs text-muted-foreground", children: [
        " : ",
        e.preprocessedQuery
      ] }),
      /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-4 mt-3 text-xs text-muted-foreground", children: [
        /* @__PURE__ */ m.jsxs("span", { children: [
          ": ",
          e.stats.totalCandidates
        ] }),
        /* @__PURE__ */ m.jsxs("span", { children: [
          "TopK: ",
          e.stats.topKCount
        ] }),
        /* @__PURE__ */ m.jsxs("span", { children: [
          "Rerank: ",
          e.stats.rerankCount
        ] }),
        /* @__PURE__ */ m.jsxs("span", { className: "flex items-center gap-1", children: [
          /* @__PURE__ */ m.jsx(od, { size: 10 }),
          mA(e.stats.latencyMs)
        ] })
      ] })
    ] }),
    /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-3 flex-wrap mb-3 shrink-0", children: [
      /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-1 text-xs", children: [
        /* @__PURE__ */ m.jsx(dz, { size: 12, className: "text-muted-foreground" }),
        ["all", "topK", "reranked"].map((p) => /* @__PURE__ */ m.jsx(
          "button",
          {
            className: `px-2 py-1 rounded transition-colors ${r === p ? "bg-primary/20 text-primary" : "text-muted-foreground hover:text-foreground"}`,
            onClick: () => a(p),
            children: p === "all" ? "" : p === "topK" ? "TopK" : "Reranked"
          },
          p
        ))
      ] }),
      /* @__PURE__ */ m.jsx("div", { className: "w-px h-4 bg-border" }),
      /* @__PURE__ */ m.jsx("div", { className: "flex items-center gap-1 text-xs", children: ["embedding", "rerank", "hybrid"].map((p) => /* @__PURE__ */ m.jsx(
        "button",
        {
          className: `px-2 py-1 rounded transition-colors ${o === p ? "bg-primary/20 text-primary" : "text-muted-foreground hover:text-foreground"}`,
          onClick: () => l(p),
          children: p.charAt(0).toUpperCase() + p.slice(1)
        },
        p
      )) }),
      /* @__PURE__ */ m.jsx("div", { className: "w-px h-4 bg-border" }),
      /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-1.5 text-muted-foreground", children: [
        /* @__PURE__ */ m.jsx(Es, { size: 12 }),
        /* @__PURE__ */ m.jsx(
          "input",
          {
            type: "text",
            placeholder: "...",
            value: c,
            onChange: (p) => d(p.target.value),
            className: "bg-transparent border-none outline-none text-xs text-foreground placeholder:text-muted-foreground w-24"
          }
        )
      ] })
    ] }),
    /* @__PURE__ */ m.jsx("div", { className: "flex-1 overflow-y-auto -mx-4 md:mx-0", children: h.length === 0 ? /* @__PURE__ */ m.jsx("div", { className: "py-8 text-center text-muted-foreground text-sm", children: "" }) : h.map((p, g) => /* @__PURE__ */ m.jsx(jH, { item: p }, g)) }),
    /* @__PURE__ */ m.jsxs("div", { className: "text-[10px] text-muted-foreground py-2 border-t border-border mt-2 shrink-0", children: [
      " ",
      h.length,
      " / ",
      e.results.length,
      " "
    ] })
  ] }) : /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col items-center justify-center h-full text-muted-foreground gap-3", children: [
    /* @__PURE__ */ m.jsx(bS, { size: 32, className: "opacity-30" }),
    /* @__PURE__ */ m.jsx("p", { className: "text-sm font-light", children: "" })
  ] });
}, TH = () => {
  const [e, t] = G.useState(Zy.getLogs()), [n, r] = G.useState(null), [a, o] = G.useState(window.innerWidth < xE), [l, c] = G.useState(!1);
  G.useEffect(() => {
    const g = () => {
      o(window.innerWidth < xE);
    };
    return window.addEventListener("resize", g), () => window.removeEventListener("resize", g);
  }, []), G.useEffect(() => Zy.subscribe((x) => {
    t(x);
  }), []);
  const d = G.useMemo(() => e.find((g) => g.id === n) || null, [e, n]), h = (g) => {
    r(g), a && c(!0);
  }, p = () => {
    c(!1), a && r(null);
  };
  return a && l && d ? /* @__PURE__ */ m.jsx(
    bE,
    {
      entry: d,
      isFullScreen: !0,
      onClose: p
    }
  ) : /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col h-full", children: [
    /* @__PURE__ */ m.jsxs("div", { className: "flex items-center justify-between px-4 py-3 border-b border-border shrink-0", children: [
      /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-2", children: [
        /* @__PURE__ */ m.jsx(bS, { size: 16, className: "text-primary" }),
        /* @__PURE__ */ m.jsx("span", { className: "font-medium text-foreground", children: "" }),
        /* @__PURE__ */ m.jsxs("span", { className: "text-xs text-muted-foreground", children: [
          "(",
          e.length,
          ")"
        ] })
      ] }),
      /* @__PURE__ */ m.jsx(
        "button",
        {
          className: "p-1.5 rounded-md hover:bg-destructive hover:text-destructive-foreground transition-colors text-muted-foreground",
          onClick: () => Zy.clear(),
          title: "",
          children: /* @__PURE__ */ m.jsx(po, { size: 14 })
        }
      )
    ] }),
    /* @__PURE__ */ m.jsxs("div", { className: "flex-1 flex min-h-0", children: [
      /* @__PURE__ */ m.jsx("div", { className: `
                    ${a ? "w-full" : "w-[30%] min-w-[240px]"}
                    overflow-y-auto
                    ${a ? "" : "border-r border-border/50"}
                `, children: e.length === 0 ? /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col items-center justify-center h-full text-muted-foreground gap-3 p-4", children: [
        /* @__PURE__ */ m.jsx(M1, { size: 32, className: "opacity-30" }),
        /* @__PURE__ */ m.jsx("p", { className: "text-sm font-light", children: "" }),
        /* @__PURE__ */ m.jsx("p", { className: "text-xs opacity-70", children: " RAG " })
      ] }) : e.map((g) => /* @__PURE__ */ m.jsx(
        NH,
        {
          entry: g,
          isSelected: g.id === n,
          onSelect: () => h(g.id)
        },
        g.id
      )) }),
      !a && /* @__PURE__ */ m.jsx("div", { className: "flex-1 overflow-y-auto p-4", children: /* @__PURE__ */ m.jsx(bE, { entry: d }) })
    ] })
  ] });
}, pA = ({ tabs: e, activeTab: t, onChange: n, sticky: r = !0, top: a = 0, className: o = "", actions: l }) => /* @__PURE__ */ m.jsxs(
  "div",
  {
    className: `
            flex items-center justify-between gap-4 mb-6 border-b border-border
            ${r ? "glass-sticky sticky z-20 pt-4 pb-0 -mt-4 -mx-4 px-4 md:-mx-8 md:px-8 lg:-mx-12 lg:px-12" : "px-0"}
            ${o}
        `,
    style: r ? {
      top: a
    } : void 0,
    children: [
      /* @__PURE__ */ m.jsx("div", { className: "flex overflow-x-auto gap-2 pb-1 no-scrollbar", children: e.map((c) => /* @__PURE__ */ m.jsxs(
        "button",
        {
          onClick: () => n(c.id),
          className: `flex items-center gap-2 whitespace-nowrap px-4 py-1.5 text-sm transition-all relative ${t === c.id ? "text-foreground" : "text-muted-foreground hover:text-foreground"}`,
          children: [
            c.icon && /* @__PURE__ */ m.jsx("span", { className: "w-4 h-4", children: c.icon }),
            c.label,
            t === c.id && /* @__PURE__ */ m.jsx("div", { className: "absolute -bottom-[1px] left-0 right-0 h-[2px] bg-primary shadow-[0_0_8px_var(--primary)] z-10 transition-all duration-300" })
          ]
        },
        c.id
      )) }),
      l && /* @__PURE__ */ m.jsx("div", { className: "flex items-center gap-2 pb-1 shrink-0", children: l })
    ]
  }
), G1 = (e) => {
  const [t, n] = G.useState(!1);
  G.useEffect(() => (n(!0), () => n(!1)), []);
  const r = document.getElementById("engram-header-extension");
  if (!t || !r)
    return null;
  const a = {
    ...e,
    sticky: !1,
    className: `!mb-0 !border-0 !bg-transparent px-4 md:px-8 lg:px-12 ${e.className || ""}`
  };
  return h7.createPortal(
    /* @__PURE__ */ m.jsx(pA, { ...a }),
    r
  );
}, AH = [
  { id: "runtime", label: "", icon: /* @__PURE__ */ m.jsx(z1, { size: 14 }) },
  { id: "model", label: "", icon: /* @__PURE__ */ m.jsx(od, { size: 14 }) },
  { id: "recall", label: "", icon: /* @__PURE__ */ m.jsx(bS, { size: 14 }) }
], MH = [
  "ALL",
  "Logger",
  "EventBus",
  "Summarizer",
  "CORE/Pipeline",
  "CORE/RAG",
  "CORE/Memory",
  "UI/GraphView",
  "UI/MemoryStream"
], RH = ({ initialTab: e }) => {
  const [t, n] = G.useState(e || "runtime"), [r, a] = G.useState([]), [o, l] = G.useState([]), [c, d] = G.useState(""), [h, p] = G.useState(-1), [g, x] = G.useState("ALL"), [b, C] = G.useState(!0), [N, T] = G.useState(!1), [j, R] = G.useState(!1), A = G.useRef(null);
  G.useEffect(() => {
    a(ye.getLogs());
    const D = ye.subscribe((P) => {
      a((re) => [...re, P]);
    });
    return () => D();
  }, []), G.useEffect(() => {
    let D = r;
    if (h !== -1 && (D = D.filter((P) => P.level >= h)), g !== "ALL" && (D = D.filter((P) => P.module.startsWith(g))), c.trim()) {
      const P = c.toLowerCase();
      D = D.filter(
        (re) => re.message.toLowerCase().includes(P) || re.module.toLowerCase().includes(P)
      );
    }
    l(D);
  }, [r, h, g, c]), G.useEffect(() => {
    b && A.current && A.current.scrollIntoView({ behavior: "smooth", block: "nearest" });
  }, [o, b]);
  const z = G.useCallback(async () => {
    await ye.clear(), a([]);
  }, []), q = G.useCallback(() => {
    const D = ye.exportToMarkdown(), P = ye.getExportFilename(), re = new Blob([D], { type: "text/markdown" }), ie = URL.createObjectURL(re), X = document.createElement("a");
    X.href = ie, X.download = P, X.click(), URL.revokeObjectURL(ie), ye.success("DevLog", `: ${P}`);
  }, []);
  return /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col h-full", children: [
    /* @__PURE__ */ m.jsxs("div", { className: "mb-2", children: [
      /* @__PURE__ */ m.jsx("h1", { className: "text-2xl font-light text-foreground tracking-tight mb-2", children: "" }),
      /* @__PURE__ */ m.jsx("p", { className: "text-sm text-muted-foreground", children: "" })
    ] }),
    /* @__PURE__ */ m.jsx(
      G1,
      {
        tabs: AH,
        activeTab: t,
        onChange: (D) => n(D)
      }
    ),
    t === "runtime" && /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col flex-1 min-h-0", children: [
      /* @__PURE__ */ m.jsx("div", { className: "sticky top-0 z-10 bg-background/95 backdrop-blur-sm py-3 -mx-4 px-4 md:-mx-8 md:px-8 lg:-mx-12 lg:px-12 border-b border-border", children: /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-2 flex-wrap", children: [
        /* @__PURE__ */ m.jsxs("div", { className: "relative", children: [
          /* @__PURE__ */ m.jsxs(
            "button",
            {
              className: "inline-flex items-center gap-1.5 px-2.5 py-1.5 text-xs text-muted-foreground hover:text-foreground transition-colors",
              onClick: () => T(!N),
              children: [
                h === -1 ? "" : l1[h].label,
                /* @__PURE__ */ m.jsx(ed, { size: 12 })
              ]
            }
          ),
          N && /* @__PURE__ */ m.jsxs("div", { className: "absolute top-full left-0 mt-1 bg-popover border border-border rounded-md shadow-lg z-20 min-w-[100px] py-1 flex flex-col", children: [
            /* @__PURE__ */ m.jsx(
              "button",
              {
                className: "block w-full text-left px-3 py-1.5 text-xs hover:bg-accent transition-colors",
                onClick: () => {
                  p(-1), T(!1);
                },
                children: ""
              }
            ),
            Object.entries(l1).map(([D, P]) => /* @__PURE__ */ m.jsxs(
              "button",
              {
                className: "block w-full text-left px-3 py-1.5 text-xs hover:bg-accent transition-colors",
                onClick: () => {
                  p(Number(D)), T(!1);
                },
                children: [
                  P.icon,
                  " ",
                  P.label
                ]
              },
              D
            ))
          ] })
        ] }),
        /* @__PURE__ */ m.jsx("div", { className: "w-px h-4 bg-border" }),
        /* @__PURE__ */ m.jsxs("div", { className: "relative", children: [
          /* @__PURE__ */ m.jsxs(
            "button",
            {
              className: "inline-flex items-center gap-1.5 px-2.5 py-1.5 text-xs text-muted-foreground hover:text-foreground transition-colors",
              onClick: () => R(!j),
              children: [
                g,
                /* @__PURE__ */ m.jsx(ed, { size: 12 })
              ]
            }
          ),
          j && /* @__PURE__ */ m.jsx("div", { className: "absolute top-full left-0 mt-1 bg-popover border border-border rounded-md shadow-lg z-20 min-w-[120px] py-1 max-h-48 overflow-y-auto flex flex-col", children: MH.map((D) => /* @__PURE__ */ m.jsx(
            "button",
            {
              className: "block w-full text-left px-3 py-1.5 text-xs hover:bg-accent transition-colors",
              onClick: () => {
                x(D), R(!1);
              },
              children: D
            },
            D
          )) })
        ] }),
        /* @__PURE__ */ m.jsx("div", { className: "w-px h-4 bg-border" }),
        /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-1.5 text-muted-foreground", children: [
          /* @__PURE__ */ m.jsx(Es, { size: 12 }),
          /* @__PURE__ */ m.jsx(
            "input",
            {
              type: "text",
              placeholder: "...",
              value: c,
              onChange: (D) => d(D.target.value),
              className: "bg-transparent border-none outline-none text-xs text-foreground placeholder:text-muted-foreground w-24 md:w-40"
            }
          )
        ] }),
        /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-1 ml-auto", children: [
          /* @__PURE__ */ m.jsx(
            "button",
            {
              className: `p-1.5 rounded transition-colors ${b ? "text-primary" : "text-muted-foreground hover:text-foreground"}`,
              onClick: () => C(!b),
              title: "",
              children: /* @__PURE__ */ m.jsx(NO, { size: 14 })
            }
          ),
          /* @__PURE__ */ m.jsx(
            "button",
            {
              className: "p-1.5 rounded text-muted-foreground hover:text-foreground transition-colors",
              onClick: z,
              title: "",
              children: /* @__PURE__ */ m.jsx(po, { size: 14 })
            }
          ),
          /* @__PURE__ */ m.jsxs(
            "button",
            {
              className: "inline-flex items-center gap-1 px-2 py-1 text-xs text-muted-foreground hover:text-foreground transition-colors",
              onClick: q,
              children: [
                /* @__PURE__ */ m.jsx(ig, { size: 12 }),
                ""
              ]
            }
          )
        ] })
      ] }) }),
      /* @__PURE__ */ m.jsx("div", { className: "flex-1 overflow-y-auto font-mono text-xs leading-relaxed py-2", children: o.length === 0 ? /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col items-center justify-center h-full gap-3 text-muted-foreground", children: [
        /* @__PURE__ */ m.jsx(z1, { size: 32, strokeWidth: 1, className: "opacity-30" }),
        /* @__PURE__ */ m.jsx("p", { className: "text-sm font-light", children: "" })
      ] }) : /* @__PURE__ */ m.jsxs(m.Fragment, { children: [
        o.map((D) => /* @__PURE__ */ m.jsx(bH, { entry: D }, D.id)),
        /* @__PURE__ */ m.jsx("div", { ref: A })
      ] }) }),
      /* @__PURE__ */ m.jsxs("div", { className: "text-[10px] text-muted-foreground py-2 border-t border-border", children: [
        r.length,
        " ",
        o.length !== r.length && `  ${o.length} `
      ] })
    ] }),
    t === "model" && /* @__PURE__ */ m.jsx("div", { className: "flex-1 overflow-hidden", children: /* @__PURE__ */ m.jsx(kH, {}) }),
    t === "recall" && /* @__PURE__ */ m.jsx("div", { className: "flex-1 overflow-hidden", children: /* @__PURE__ */ m.jsx(TH, {}) })
  ] });
}, OH = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  DevLog: RH
}, Symbol.toStringTag, { value: "Module" })), zH = {
  default: "text-muted-foreground bg-muted/50",
  primary: "text-primary bg-primary/10",
  blue: "text-blue-500 bg-blue-500/10",
  purple: "text-purple-500 bg-purple-500/10",
  orange: "text-orange-500 bg-orange-500/10",
  emerald: "text-emerald-500 bg-emerald-500/10"
}, DH = ({
  icon: e,
  title: t,
  subtitle: n,
  meta: r,
  badges: a = [],
  selected: o = !1,
  disabled: l = !1,
  toggle: c,
  onClick: d,
  actions: h = [],
  className: p = "",
  compact: g = !1
}) => {
  const x = h.filter((C) => !C.hidden), b = !!c;
  return /* @__PURE__ */ m.jsxs(
    "div",
    {
      className: `
                group relative flex items-center gap-3 
                ${g ? "py-2 px-2" : "py-3 px-3"}
                rounded-lg cursor-pointer transition-all duration-150
                ${o ? "bg-accent/60" : "hover:bg-muted/40"}
                ${l ? "opacity-50 pointer-events-none" : ""}
                ${p}
            `,
      onClick: d,
      children: [
        (e || b) && /* @__PURE__ */ m.jsx("div", { className: "flex-shrink-0", children: b ? /* @__PURE__ */ m.jsx(
          "button",
          {
            className: `
                                w-7 h-7 flex items-center justify-center rounded-md transition-colors
                                ${c.checked ? "text-primary" : "text-muted-foreground hover:text-foreground"}
                            `,
            onClick: (C) => {
              C.stopPropagation(), c.onChange(!c.checked);
            },
            children: /* @__PURE__ */ m.jsx(O1, { size: 14 })
          }
        ) : /* @__PURE__ */ m.jsx("div", { className: `
                            w-7 h-7 flex items-center justify-center rounded-md transition-colors
                            ${o ? "text-primary" : "text-muted-foreground group-hover:text-foreground"}
                        `, children: e }) }),
        /* @__PURE__ */ m.jsxs("div", { className: "flex-1 min-w-0", children: [
          /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-2", children: [
            /* @__PURE__ */ m.jsx("span", { className: `
                        text-sm font-medium truncate transition-colors
                        ${o ? "text-foreground" : "text-muted-foreground group-hover:text-foreground"}
                        ${c && !c.checked ? "line-through opacity-60" : ""}
                    `, children: t }),
            a.map((C, N) => /* @__PURE__ */ m.jsx(
              "span",
              {
                className: `
                                text-[10px] px-1.5 py-0.5 rounded-sm font-medium flex-shrink-0
                                ${zH[C.color || "default"]}
                            `,
                children: C.text
              },
              N
            ))
          ] }),
          (n || r) && /* @__PURE__ */ m.jsxs("div", { className: "flex items-center justify-between mt-0.5 text-[11px] text-muted-foreground/70", children: [
            n && /* @__PURE__ */ m.jsx("span", { className: "truncate", children: n }),
            r && /* @__PURE__ */ m.jsx("span", { className: "flex-shrink-0 font-mono", children: r })
          ] })
        ] }),
        o && !x.length && /* @__PURE__ */ m.jsx(T1, { size: 14, className: "text-primary flex-shrink-0" }),
        x.length > 0 && /* @__PURE__ */ m.jsx("div", { className: `
                    flex items-center gap-0.5 flex-shrink-0
                    ${o ? "opacity-100" : "opacity-0 group-hover:opacity-100"}
                    transition-opacity
                `, children: x.map((C, N) => /* @__PURE__ */ m.jsx(
          "button",
          {
            className: `
                                p-1.5 rounded transition-colors
                                ${C.danger ? "text-muted-foreground hover:text-destructive hover:bg-destructive/10" : "text-muted-foreground hover:text-foreground hover:bg-muted"}
                            `,
            onClick: (T) => {
              T.stopPropagation(), C.onClick(T);
            },
            title: C.title,
            children: C.icon
          },
          N
        )) })
      ]
    }
  );
}, IH = ({
  preset: e,
  isSelected: t,
  onSelect: n,
  onEdit: r,
  onCopy: a,
  onDelete: o
}) => {
  var d;
  const l = e.source === "tavern" || e.source === "tavern_profile" ? oD : ez, c = e.source === "custom" ? ((d = e.custom) == null ? void 0 : d.model) || "" : "";
  return /* @__PURE__ */ m.jsx(
    DH,
    {
      icon: /* @__PURE__ */ m.jsx(l, { size: 14 }),
      title: e.name,
      subtitle: c,
      meta: `T:${e.parameters.temperature}`,
      badges: e.isDefault ? [{ text: "DEFAULT", color: "primary" }] : [],
      selected: t,
      onClick: n,
      actions: [
        { icon: /* @__PURE__ */ m.jsx(Gz, { size: 12 }), onClick: () => r(), title: "" },
        { icon: /* @__PURE__ */ m.jsx(gS, { size: 12 }), onClick: () => a(), title: "" },
        { icon: /* @__PURE__ */ m.jsx(po, { size: 12 }), onClick: () => o(), title: "", danger: !0, hidden: e.isDefault }
      ]
    }
  );
}, na = ({ title: e, description: t, children: n, className: r = "" }) => /* @__PURE__ */ m.jsxs("div", { className: `mb-8 ${r}`, children: [
  /* @__PURE__ */ m.jsxs("div", { className: "mb-4", children: [
    /* @__PURE__ */ m.jsx("h3", { className: "text-sm font-medium text-primary", children: e }),
    t && /* @__PURE__ */ m.jsx("p", { className: "text-xs text-muted-foreground mt-1 break-words", children: t })
  ] }),
  /* @__PURE__ */ m.jsx("div", { className: "space-y-4", children: n })
] }), mi = ({
  label: e,
  description: t,
  error: n,
  required: r,
  className: a = "",
  value: o,
  onChange: l,
  placeholder: c,
  type: d = "text",
  disabled: h,
  readOnly: p,
  multiline: g,
  rows: x = 3
}) => {
  const b = {
    background: "transparent",
    backgroundColor: "transparent",
    border: "none",
    borderBottom: "1px solid var(--border)",
    borderRadius: 0,
    boxShadow: "none",
    outline: "none",
    padding: "8px 0",
    fontSize: "14px",
    width: "100%",
    color: "var(--foreground, inherit)"
  };
  return /* @__PURE__ */ m.jsxs("div", { className: `flex flex-col gap-1 ${a}`, children: [
    /* @__PURE__ */ m.jsxs("label", { className: "text-xs text-muted-foreground flex items-center gap-1", children: [
      e,
      r && /* @__PURE__ */ m.jsx("span", { className: "text-destructive", children: "*" })
    ] }),
    g ? /* @__PURE__ */ m.jsx(
      "textarea",
      {
        value: o,
        onChange: (C) => l(C.target.value),
        placeholder: c,
        disabled: h,
        readOnly: p,
        rows: x,
        style: b,
        className: "font-mono resize-y min-h-[80px] placeholder:text-muted-foreground/40 disabled:opacity-50 focus:border-primary transition-colors"
      }
    ) : /* @__PURE__ */ m.jsx(
      "input",
      {
        type: d,
        value: o,
        onChange: (C) => l(C.target.value),
        placeholder: c,
        disabled: h,
        readOnly: p,
        style: b,
        className: "placeholder:text-muted-foreground/40 disabled:opacity-50 focus:border-primary transition-colors"
      }
    ),
    t && /* @__PURE__ */ m.jsx("p", { className: "text-[10px] text-muted-foreground/70 break-words", children: t }),
    n && /* @__PURE__ */ m.jsx("p", { className: "text-[10px] text-destructive", children: n })
  ] });
}, ni = ({
  label: e,
  description: t,
  error: n,
  required: r,
  className: a = "",
  value: o,
  onChange: l,
  min: c,
  max: d,
  step: h = 1,
  showSlider: p = !0,
  suffix: g
}) => {
  const x = {
    background: "transparent",
    backgroundColor: "transparent",
    border: "none",
    borderRadius: 0,
    boxShadow: "none",
    outline: "none",
    padding: "0",
    fontSize: "12px",
    width: "auto",
    minWidth: "40px",
    textAlign: "right",
    fontFamily: "monospace",
    color: "var(--foreground, inherit)"
  }, b = c !== void 0 && d !== void 0 ? Math.min(100, Math.max(0, (o - c) / (d - c) * 100)) : 0;
  return /* @__PURE__ */ m.jsxs("div", { className: `flex flex-col gap-2 ${a}`, children: [
    /* @__PURE__ */ m.jsxs("div", { className: "flex justify-between items-center", children: [
      /* @__PURE__ */ m.jsxs("label", { className: "text-xs text-muted-foreground flex items-center gap-1", children: [
        e,
        r && /* @__PURE__ */ m.jsx("span", { className: "text-destructive", children: "*" })
      ] }),
      /* @__PURE__ */ m.jsx(
        "input",
        {
          type: "number",
          min: c,
          max: d,
          step: h,
          value: o,
          onChange: (C) => l(Number(C.target.value)),
          style: x,
          className: "focus:text-primary transition-colors [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"
        }
      )
    ] }),
    /* @__PURE__ */ m.jsx("div", { className: "flex items-center gap-3 pt-1", children: p && c !== void 0 && d !== void 0 && /* @__PURE__ */ m.jsxs("div", { className: "flex-1 relative h-4 flex items-center group cursor-pointer", children: [
      /* @__PURE__ */ m.jsx(
        "div",
        {
          className: "absolute inset-x-0 h-[1px]",
          style: { backgroundColor: "var(--border)" }
        }
      ),
      /* @__PURE__ */ m.jsx(
        "div",
        {
          className: "absolute top-1/2 -translate-y-1/2 w-2.5 h-2.5 bg-muted-foreground/80 rounded-full shadow-sm pointer-events-none transition-transform duration-75 ease-out group-hover:scale-125 group-hover:bg-foreground",
          style: { left: `${b}%`, transform: "translate(-50%, -50%)" }
        }
      ),
      /* @__PURE__ */ m.jsx(
        "input",
        {
          type: "range",
          min: c,
          max: d,
          step: h,
          value: o,
          onChange: (C) => l(Number(C.target.value)),
          className: "absolute inset-x-0 w-full h-full opacity-0 cursor-pointer z-10 m-0",
          style: { appearance: "none", WebkitAppearance: "none" }
        }
      )
    ] }) }),
    t && /* @__PURE__ */ m.jsx("p", { className: "text-[10px] text-muted-foreground/70 break-words", children: t }),
    n && /* @__PURE__ */ m.jsx("p", { className: "text-[10px] text-destructive", children: n })
  ] });
}, nu = ({
  label: e,
  description: t,
  error: n,
  required: r,
  className: a = "",
  value: o,
  onChange: l,
  options: c,
  placeholder: d = "...",
  disabled: h
}) => {
  const p = {
    background: "transparent",
    backgroundColor: "transparent",
    border: "none",
    borderBottom: "1px solid var(--border)",
    borderRadius: 0,
    boxShadow: "none",
    outline: "none",
    padding: "8px 24px 8px 0",
    fontSize: "14px",
    width: "100%",
    cursor: "pointer",
    color: "var(--foreground, inherit)",
    appearance: "none",
    WebkitAppearance: "none"
  };
  return /* @__PURE__ */ m.jsxs("div", { className: `flex flex-col gap-1 ${a}`, children: [
    /* @__PURE__ */ m.jsxs("label", { className: "text-xs text-muted-foreground flex items-center gap-1", children: [
      e,
      r && /* @__PURE__ */ m.jsx("span", { className: "text-destructive", children: "*" })
    ] }),
    /* @__PURE__ */ m.jsxs("div", { className: "relative", children: [
      /* @__PURE__ */ m.jsxs(
        "select",
        {
          value: o,
          onChange: (g) => l(g.target.value),
          disabled: h,
          style: p,
          className: "disabled:opacity-50 disabled:cursor-not-allowed focus:border-primary transition-colors",
          children: [
            /* @__PURE__ */ m.jsx("option", { value: "", disabled: !0, className: "bg-popover text-muted-foreground", children: d }),
            c.map((g) => /* @__PURE__ */ m.jsx("option", { value: g.value, className: "bg-popover text-foreground", children: g.label }, g.value))
          ]
        }
      ),
      /* @__PURE__ */ m.jsx(ed, { size: 14, className: "absolute right-0 top-1/2 -translate-y-1/2 text-muted-foreground/50 pointer-events-none" })
    ] }),
    t && /* @__PURE__ */ m.jsx("p", { className: "text-[10px] text-muted-foreground/70 break-words", children: t }),
    n && /* @__PURE__ */ m.jsx("p", { className: "text-[10px] text-destructive", children: n })
  ] });
}, oo = ({
  label: e,
  description: t,
  error: n,
  className: r = "",
  checked: a,
  onChange: o,
  disabled: l,
  compact: c
}) => /* @__PURE__ */ m.jsxs("div", { className: `flex items-start justify-between gap-4 ${c ? "py-0" : "py-1"} ${r} ${l ? "opacity-50 pointer-events-none" : ""}`, children: [
  e && /* @__PURE__ */ m.jsxs("div", { className: "flex-1 min-w-0", children: [
    /* @__PURE__ */ m.jsx(
      "label",
      {
        className: "text-xs text-foreground cursor-pointer block truncate",
        onClick: () => !l && o(!a),
        children: e
      }
    ),
    t && /* @__PURE__ */ m.jsx("p", { className: "text-[10px] text-muted-foreground/70 mt-0.5 break-words", children: t }),
    n && /* @__PURE__ */ m.jsx("p", { className: "text-[10px] text-destructive mt-0.5", children: n })
  ] }),
  /* @__PURE__ */ m.jsx(
    Kr,
    {
      checked: a,
      onChange: o,
      disabled: l
    }
  )
] }), gA = ({
  label: e,
  description: t,
  error: n,
  required: r,
  className: a = "",
  value: o,
  onChange: l,
  options: c,
  placeholder: d = "...",
  disabled: h,
  emptyText: p = ""
}) => {
  var z;
  const [g, x] = G.useState(!1), [b, C] = G.useState(""), N = G.useRef(null), T = G.useRef(null), j = c.filter(
    (q) => q.label.toLowerCase().includes(b.toLowerCase()) || q.value.toLowerCase().includes(b.toLowerCase())
  ), R = ((z = c.find((q) => q.value === o)) == null ? void 0 : z.label) || o || d;
  G.useEffect(() => {
    const q = (D) => {
      N.current && !N.current.contains(D.target) && (x(!1), C(""));
    };
    return document.addEventListener("mousedown", q), () => document.removeEventListener("mousedown", q);
  }, []), G.useEffect(() => {
    g && T.current && T.current.focus();
  }, [g]);
  const A = (q) => {
    l(q), x(!1), C("");
  };
  return /* @__PURE__ */ m.jsxs("div", { className: `flex flex-col gap-1 ${a}`, ref: N, children: [
    /* @__PURE__ */ m.jsxs("label", { className: "text-xs text-muted-foreground flex items-center gap-1", children: [
      e,
      r && /* @__PURE__ */ m.jsx("span", { className: "text-destructive", children: "*" })
    ] }),
    /* @__PURE__ */ m.jsxs(
      "button",
      {
        type: "button",
        onClick: () => !h && x(!g),
        disabled: h,
        className: "relative w-full text-left py-2 pr-6 border-0 border-b border-border bg-transparent text-sm text-foreground cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed focus:border-primary transition-colors",
        children: [
          /* @__PURE__ */ m.jsx("span", { className: o ? "" : "text-muted-foreground", children: R }),
          /* @__PURE__ */ m.jsx(
            ed,
            {
              size: 14,
              className: `absolute right-0 top-1/2 -translate-y-1/2 text-muted-foreground/50 transition-transform ${g ? "rotate-180" : ""}`
            }
          )
        ]
      }
    ),
    g && /* @__PURE__ */ m.jsxs(
      "div",
      {
        className: "glass-panel absolute z-50 mt-1 w-full max-h-64 border border-border rounded-lg shadow-xl overflow-hidden flex flex-col animate-in fade-in slide-in-from-top-1 duration-150",
        style: { top: "100%", left: 0, right: 0 },
        children: [
          /* @__PURE__ */ m.jsxs("div", { className: "p-2 border-b border-border flex items-center gap-2", children: [
            /* @__PURE__ */ m.jsx(Es, { size: 14, className: "text-muted-foreground flex-shrink-0" }),
            /* @__PURE__ */ m.jsx(
              "input",
              {
                ref: T,
                type: "text",
                value: b,
                onChange: (q) => C(q.target.value),
                placeholder: "...",
                className: "flex-1 bg-transparent border-none outline-none text-sm text-foreground placeholder:text-muted-foreground/50"
              }
            ),
            b && /* @__PURE__ */ m.jsx(
              "button",
              {
                type: "button",
                onClick: () => C(""),
                className: "p-0.5 hover:bg-muted rounded",
                children: /* @__PURE__ */ m.jsx(tm, { size: 12, className: "text-muted-foreground" })
              }
            )
          ] }),
          /* @__PURE__ */ m.jsx("div", { className: "overflow-y-auto max-h-48", children: j.length > 0 ? j.map((q) => /* @__PURE__ */ m.jsx(
            "div",
            {
              onClick: () => A(q.value),
              className: `px-3 py-2 cursor-pointer text-sm truncate transition-colors ${q.value === o ? "bg-primary/15 text-primary" : "hover:bg-muted text-foreground"}`,
              title: q.label,
              children: q.label
            },
            q.value
          )) : /* @__PURE__ */ m.jsx("div", { className: "px-3 py-4 text-center text-sm text-muted-foreground", children: b ? "" : p }) }),
          c.length > 10 && /* @__PURE__ */ m.jsxs("div", { className: "px-3 py-1 border-t border-border text-xs text-muted-foreground/70", children: [
            j.length,
            " / ",
            c.length,
            " "
          ] })
        ]
      }
    ),
    t && /* @__PURE__ */ m.jsx("p", { className: "text-[10px] text-muted-foreground/70 break-words", children: t }),
    n && /* @__PURE__ */ m.jsx("p", { className: "text-[10px] text-destructive", children: n })
  ] });
};
class fl {
  // 10
  /**
   *  API 
   */
  static async fetchModels(t, n) {
    switch (t) {
      case "openai":
        return this.fetchOpenAIModels(n);
      case "ollama":
        return this.fetchOllamaModels(n);
      case "vllm":
        return this.fetchVLLMModels(n);
      case "cohere":
        return this.fetchCohereModels(n);
      case "jina":
      case "voyage":
        return this.getPresetModels(t);
      default:
        return ye.warn("ModelService", `Unknown API type: ${t}`), [];
    }
  }
  /**
   *  OpenAI  API 
   * : OpenAI, Azure,  OpenAI 
   */
  static async fetchOpenAIModels(t) {
    const { apiUrl: n, apiKey: r, timeout: a = this.DEFAULT_TIMEOUT } = t, o = n.replace(/\/+$/, ""), l = o.endsWith("/v1") ? `${o}/models` : `${o}/v1/models`;
    try {
      const c = new AbortController(), d = setTimeout(() => c.abort(), a), h = {
        "Content-Type": "application/json"
      };
      r && (h.Authorization = `Bearer ${r}`);
      const p = await fetch(l, {
        method: "GET",
        headers: h,
        signal: c.signal
      });
      if (clearTimeout(d), !p.ok)
        throw new Error(`HTTP ${p.status}: ${p.statusText}`);
      const g = await p.json(), x = (g.data || g || []).map((b) => ({
        id: b.id || b.model,
        name: b.name || b.id || b.model,
        owned_by: b.owned_by
      }));
      return ye.info("ModelService", `Fetched ${x.length} models from OpenAI API`), x.sort((b, C) => b.id.localeCompare(C.id));
    } catch (c) {
      throw c.name === "AbortError" ? ye.error("ModelService", "OpenAI API request timeout") : ye.error("ModelService", `OpenAI API error: ${c.message}`), c;
    }
  }
  /**
   *  Ollama 
   */
  static async fetchOllamaModels(t) {
    const { apiUrl: n, timeout: r = this.DEFAULT_TIMEOUT } = t, o = `${n.replace(/\/+$/, "")}/api/tags`;
    try {
      const l = new AbortController(), c = setTimeout(() => l.abort(), r), d = await fetch(o, {
        method: "GET",
        signal: l.signal
      });
      if (clearTimeout(c), !d.ok)
        throw new Error(`HTTP ${d.status}: ${d.statusText}`);
      const p = ((await d.json()).models || []).map((g) => ({
        id: g.name || g.model,
        name: g.name || g.model
      }));
      return ye.info("ModelService", `Fetched ${p.length} models from Ollama`), p;
    } catch (l) {
      throw ye.error("ModelService", `Ollama API error: ${l.message}`), l;
    }
  }
  /**
   *  vLLM 
   * vLLM  OpenAI  API
   */
  static async fetchVLLMModels(t) {
    return this.fetchOpenAIModels(t);
  }
  /**
   *  Cohere 
   */
  static async fetchCohereModels(t) {
    const { apiKey: n, timeout: r = this.DEFAULT_TIMEOUT } = t;
    if (!n)
      return ye.warn("ModelService", "Cohere API key required"), this.getPresetModels("cohere");
    try {
      const a = new AbortController(), o = setTimeout(() => a.abort(), r), l = await fetch("https://api.cohere.ai/v1/models", {
        method: "GET",
        headers: {
          Authorization: `Bearer ${n}`,
          "Content-Type": "application/json"
        },
        signal: a.signal
      });
      if (clearTimeout(o), !l.ok)
        throw new Error(`HTTP ${l.status}: ${l.statusText}`);
      const d = ((await l.json()).models || []).filter((h) => {
        var p;
        return (p = h.endpoints) == null ? void 0 : p.includes("embed");
      }).map((h) => ({
        id: h.name,
        name: h.name,
        contextLength: h.context_length
      }));
      return ye.info("ModelService", `Fetched ${d.length} embed models from Cohere`), d;
    } catch (a) {
      return ye.error("ModelService", `Cohere API error: ${a.message}`), this.getPresetModels("cohere");
    }
  }
  /**
   * 
   */
  static getPresetModels(t) {
    return {
      cohere: [
        { id: "embed-multilingual-v3.0", name: "Embed Multilingual v3.0" },
        { id: "embed-english-v3.0", name: "Embed English v3.0" },
        { id: "embed-multilingual-light-v3.0", name: "Embed Multilingual Light v3.0" },
        { id: "embed-english-light-v3.0", name: "Embed English Light v3.0" }
      ],
      jina: [
        { id: "jina-embeddings-v3", name: "Jina Embeddings v3" },
        { id: "jina-embeddings-v2-base-en", name: "Jina Embeddings v2 Base EN" },
        { id: "jina-embeddings-v2-base-zh", name: "Jina Embeddings v2 Base ZH" },
        { id: "jina-colbert-v2", name: "Jina ColBERT v2" }
      ],
      voyage: [
        { id: "voyage-3", name: "Voyage 3" },
        { id: "voyage-3-lite", name: "Voyage 3 Lite" },
        { id: "voyage-large-2", name: "Voyage Large 2" },
        { id: "voyage-code-2", name: "Voyage Code 2" },
        { id: "voyage-multilingual-2", name: "Voyage Multilingual 2" }
      ],
      openai: [
        { id: "text-embedding-3-large", name: "Text Embedding 3 Large" },
        { id: "text-embedding-3-small", name: "Text Embedding 3 Small" },
        { id: "text-embedding-ada-002", name: "Text Embedding Ada 002" }
      ]
    }[t] || [];
  }
  /**
   *  Rerank 
   */
  static getCommonRerankModels() {
    return [
      { id: "BAAI/bge-reranker-v2-m3", name: "BGE Reranker v2 m3" },
      { id: "BAAI/bge-reranker-large", name: "BGE Reranker Large" },
      { id: "BAAI/bge-reranker-base", name: "BGE Reranker Base" },
      { id: "cross-encoder/ms-marco-MiniLM-L-12-v2", name: "MS MARCO MiniLM L12" },
      { id: "Xenova/ms-marco-MiniLM-L-6-v2", name: "MS MARCO MiniLM L6 (ONNX)" },
      { id: "jinaai/jina-reranker-v2-base-multilingual", name: "Jina Reranker v2 Multilingual" }
    ];
  }
}
mt(fl, "DEFAULT_TIMEOUT", 1e4);
const LH = [
  { value: "openai", label: "OpenAI" },
  { value: "anthropic", label: "Anthropic" },
  { value: "ollama", label: "Ollama" },
  { value: "vllm", label: "vLLM" },
  { value: "azure", label: "Azure OpenAI" },
  { value: "custom", label: "" }
], PH = [
  { value: "tavern", label: "" },
  { value: "tavern_profile", label: "" },
  { value: "custom", label: " API " }
];
function qH() {
  var e, t, n, r;
  try {
    const a = (n = (t = (e = window.SillyTavern) == null ? void 0 : e.getContext) == null ? void 0 : t.call(e)) == null ? void 0 : n.extensionSettings;
    return ((r = a == null ? void 0 : a.connectionManager) == null ? void 0 : r.profiles) || [];
  } catch (a) {
    return console.warn("[Engram]  connection_profiles:", a), [];
  }
}
const wE = ({
  preset: e,
  onChange: t,
  isNew: n = !1
}) => {
  var q, D, P, re, ie, X;
  const [r, a] = G.useState([]), [o, l] = G.useState(!1), [c, d] = G.useState([]), [h, p] = G.useState(!1), [g, x] = G.useState(null), b = () => {
    l(!0);
    try {
      const K = qH();
      a(K);
    } finally {
      l(!1);
    }
  }, C = async () => {
    const { apiUrl: K, apiKey: V, apiSource: de } = e.custom || {};
    if (!K) {
      x(" API URL");
      return;
    }
    p(!0), x(null);
    try {
      let H = [];
      de === "ollama" ? H = await fl.fetchOllamaModels({ apiUrl: K }) : H = await fl.fetchOpenAIModels({ apiUrl: K, apiKey: V }), d(H), H.length === 0 && x("");
    } catch (H) {
      x(H.message || ""), d([]);
    } finally {
      p(!1);
    }
  };
  G.useEffect(() => {
    b();
  }, []);
  const N = (K) => {
    t({ ...e, ...K, updatedAt: Date.now() });
  }, T = (K, V) => {
    N({
      parameters: { ...e.parameters, [K]: V }
    });
  }, j = (K, V) => {
    var de, H, se, Z;
    N({
      custom: {
        apiUrl: ((de = e.custom) == null ? void 0 : de.apiUrl) || "",
        apiKey: ((H = e.custom) == null ? void 0 : H.apiKey) || "",
        model: ((se = e.custom) == null ? void 0 : se.model) || "",
        apiSource: ((Z = e.custom) == null ? void 0 : Z.apiSource) || "openai",
        [K]: V
      }
    });
  }, R = (K) => {
    const V = K;
    N({
      source: V,
      tavernProfileId: V === "tavern_profile" ? e.tavernProfileId : void 0
    }), V === "tavern_profile" && b();
  }, A = r.map((K) => ({
    value: K.id,
    label: `${K.name} (${K.api || "Unknown"} - ${K.model || "Unknown"})`
  })), z = r.find((K) => K.id === e.tavernProfileId);
  return /* @__PURE__ */ m.jsxs("div", { className: "", children: [
    /* @__PURE__ */ m.jsxs(na, { title: "", children: [
      /* @__PURE__ */ m.jsx(
        mi,
        {
          label: "",
          value: e.name,
          onChange: (K) => N({ name: K }),
          placeholder: "",
          required: !0
        }
      ),
      /* @__PURE__ */ m.jsx(
        nu,
        {
          label: "",
          value: e.source,
          onChange: R,
          options: PH,
          description: " API "
        }
      )
    ] }),
    e.source === "tavern_profile" && /* @__PURE__ */ m.jsxs(na, { title: "", description: "", children: [
      /* @__PURE__ */ m.jsxs("div", { className: "flex items-end gap-2", children: [
        /* @__PURE__ */ m.jsx(
          nu,
          {
            className: "flex-1 !mb-0",
            label: "",
            value: e.tavernProfileId || "",
            onChange: (K) => N({ tavernProfileId: K }),
            options: A,
            placeholder: o ? "..." : "",
            disabled: o || A.length === 0
          }
        ),
        /* @__PURE__ */ m.jsx(
          "button",
          {
            type: "button",
            className: "h-[42px] w-[42px] min-w-[42px] flex items-center justify-center border-none rounded-md bg-muted text-muted-foreground cursor-pointer transition-all hover:bg-accent hover:text-foreground",
            onClick: b,
            disabled: o,
            title: "",
            children: /* @__PURE__ */ m.jsx(zr, { size: 16, className: o ? "animate-spin" : "" })
          }
        )
      ] }),
      A.length === 0 && !o && /* @__PURE__ */ m.jsx("div", { className: "p-3 bg-muted/30 border border-dashed border-border rounded-lg text-muted-foreground text-sm text-center mt-3", children: "" }),
      z && /* @__PURE__ */ m.jsxs("div", { className: "mt-4 p-3 bg-card rounded-lg border border-border", children: [
        /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-2 py-1 text-sm border-b border-border last:border-0", children: [
          /* @__PURE__ */ m.jsx("span", { className: "text-muted-foreground min-w-[60px]", children: "API:" }),
          /* @__PURE__ */ m.jsx("span", { className: "text-foreground font-mono", children: z.api || "-" })
        ] }),
        /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-2 py-1 text-sm border-b border-border last:border-0", children: [
          /* @__PURE__ */ m.jsx("span", { className: "text-muted-foreground min-w-[60px]", children: ":" }),
          /* @__PURE__ */ m.jsx("span", { className: "text-foreground font-mono", children: z.model || "-" })
        ] }),
        /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-2 py-1 text-sm border-b border-border last:border-0", children: [
          /* @__PURE__ */ m.jsx("span", { className: "text-muted-foreground min-w-[60px]", children: ":" }),
          /* @__PURE__ */ m.jsx("span", { className: "text-foreground font-mono", children: z.preset || "-" })
        ] })
      ] })
    ] }),
    e.source === "custom" && /* @__PURE__ */ m.jsxs(na, { title: "API ", description: " API ", children: [
      /* @__PURE__ */ m.jsx(
        nu,
        {
          label: "API ",
          value: ((q = e.custom) == null ? void 0 : q.apiSource) || "openai",
          onChange: (K) => j("apiSource", K),
          options: LH
        }
      ),
      /* @__PURE__ */ m.jsx(
        mi,
        {
          label: "API URL",
          type: "url",
          value: ((D = e.custom) == null ? void 0 : D.apiUrl) || "",
          onChange: (K) => j("apiUrl", K),
          placeholder: "https://api.openai.com/v1",
          required: !0
        }
      ),
      /* @__PURE__ */ m.jsx(
        mi,
        {
          label: "API Key",
          type: "password",
          value: ((P = e.custom) == null ? void 0 : P.apiKey) || "",
          onChange: (K) => j("apiKey", K),
          placeholder: "sk-..."
        }
      ),
      /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col gap-2", children: [
        /* @__PURE__ */ m.jsxs("div", { className: "flex items-end gap-2", children: [
          c.length > 0 ? /* @__PURE__ */ m.jsx(
            nu,
            {
              className: "flex-1 !mb-0",
              label: "",
              value: ((re = e.custom) == null ? void 0 : re.model) || "",
              onChange: (K) => j("model", K),
              options: c.map((K) => ({ value: K.id, label: K.name || K.id })),
              placeholder: ""
            }
          ) : /* @__PURE__ */ m.jsx(
            mi,
            {
              className: "flex-1 !mb-0",
              label: "",
              value: ((ie = e.custom) == null ? void 0 : ie.model) || "",
              onChange: (K) => j("model", K),
              placeholder: "gpt-4o-mini",
              required: !0
            }
          ),
          /* @__PURE__ */ m.jsx(
            "button",
            {
              type: "button",
              className: "h-[42px] w-[42px] min-w-[42px] flex items-center justify-center border-none rounded-md bg-muted text-muted-foreground cursor-pointer transition-all hover:bg-accent hover:text-foreground disabled:opacity-50 disabled:cursor-not-allowed",
              onClick: C,
              disabled: h || !((X = e.custom) != null && X.apiUrl),
              title: "",
              children: h ? /* @__PURE__ */ m.jsx(au, { size: 16, className: "animate-spin" }) : /* @__PURE__ */ m.jsx(zr, { size: 16 })
            }
          )
        ] }),
        g && /* @__PURE__ */ m.jsx("p", { className: "text-xs text-destructive", children: g }),
        c.length > 0 && /* @__PURE__ */ m.jsxs("p", { className: "text-xs text-muted-foreground", children: [
          " ",
          c.length,
          " "
        ] })
      ] })
    ] }),
    /* @__PURE__ */ m.jsxs(na, { title: "", description: "", children: [
      /* @__PURE__ */ m.jsx(
        ni,
        {
          label: " (Temperature)",
          value: e.parameters.temperature,
          onChange: (K) => T("temperature", K),
          min: 0,
          max: 2,
          step: 0.1,
          description: ""
        }
      ),
      /* @__PURE__ */ m.jsx(
        ni,
        {
          label: "Top-P",
          value: e.parameters.topP,
          onChange: (K) => T("topP", K),
          min: 0,
          max: 1,
          step: 0.05,
          description: " token "
        }
      ),
      /* @__PURE__ */ m.jsx(
        ni,
        {
          label: " Tokens",
          value: e.parameters.maxTokens,
          onChange: (K) => T("maxTokens", K),
          min: 64,
          max: 16384,
          step: 64,
          showSlider: !1
        }
      ),
      /* @__PURE__ */ m.jsx(
        ni,
        {
          label: "",
          value: e.parameters.frequencyPenalty,
          onChange: (K) => T("frequencyPenalty", K),
          min: -2,
          max: 2,
          step: 0.1,
          description: " token "
        }
      ),
      /* @__PURE__ */ m.jsx(
        ni,
        {
          label: "",
          value: e.parameters.presencePenalty,
          onChange: (K) => T("presencePenalty", K),
          min: -2,
          max: 2,
          step: 0.1,
          description: ""
        }
      )
    ] })
  ] });
}, BH = [
  { value: "custom", label: " (OpenAI )" },
  { value: "transformers", label: "Transformers ()" },
  { value: "openai", label: "OpenAI Embeddings" },
  { value: "ollama", label: "Ollama" },
  { value: "vllm", label: "vLLM" },
  { value: "cohere", label: "Cohere" },
  { value: "jina", label: "Jina AI" },
  { value: "voyage", label: "Voyage AI" }
], _E = {
  custom: "text-embedding-3-small",
  transformers: "Xenova/all-MiniLM-L6-v2",
  openai: "text-embedding-3-small",
  ollama: "nomic-embed-text",
  vllm: "BAAI/bge-m3",
  cohere: "embed-multilingual-v3.0",
  jina: "jina-embeddings-v3",
  voyage: "voyage-large-2"
}, SE = ["custom", "ollama", "vllm"], CE = ["custom", "openai", "cohere", "jina", "voyage"], FH = ({
  config: e,
  onChange: t
}) => {
  var b;
  const n = (C) => {
    t({ ...e, ...C });
  }, r = (C) => {
    n({
      source: C,
      model: _E[C],
      apiUrl: SE.includes(C) ? e.apiUrl : void 0,
      apiKey: CE.includes(C) ? e.apiKey : void 0
    });
  }, a = SE.includes(e.source), o = CE.includes(e.source), [l, c] = G.useState([]), [d, h] = G.useState(!1), [p, g] = G.useState(null), x = async () => {
    h(!0), g(null);
    try {
      let C = [];
      const N = { apiUrl: e.apiUrl || "", apiKey: e.apiKey };
      switch (e.source) {
        case "custom":
          if (!e.apiUrl) {
            g(" API URL");
            return;
          }
          C = await fl.fetchOpenAIModels(N);
          break;
        case "ollama":
          if (!e.apiUrl) {
            g(" API URL");
            return;
          }
          C = await fl.fetchOllamaModels(N);
          break;
        case "vllm":
          if (!e.apiUrl) {
            g(" API URL");
            return;
          }
          C = await fl.fetchVLLMModels(N);
          break;
        case "openai":
        case "cohere":
        case "jina":
        case "voyage":
          C = fl.getPresetModels(e.source);
          break;
        default:
          C = [];
      }
      c(C), C.length === 0 && g("");
    } catch (C) {
      g(C.message || ""), c([]);
    } finally {
      h(!1);
    }
  };
  return /* @__PURE__ */ m.jsxs("div", { className: "", children: [
    /* @__PURE__ */ m.jsxs(na, { title: "", description: "", children: [
      /* @__PURE__ */ m.jsx(
        nu,
        {
          label: "",
          value: e.source,
          onChange: (C) => r(C),
          options: BH,
          description: ""
        }
      ),
      a && /* @__PURE__ */ m.jsx(
        mi,
        {
          label: e.source === "ollama" ? "API Endpoint ()" : " API URL",
          type: "url",
          value: e.apiUrl || "",
          onChange: (C) => n({ apiUrl: C }),
          placeholder: e.source === "ollama" ? "http://localhost:11434/api/embeddings" : "https://api.openai.com/v1/embeddings",
          description: e.source === "ollama" ? ": http://localhost:11434/api/embeddings" : " /v1/embeddings"
        }
      ),
      o && /* @__PURE__ */ m.jsx(
        mi,
        {
          label: "API Key",
          type: "password",
          value: e.apiKey || "",
          onChange: (C) => n({ apiKey: C }),
          placeholder: " API "
        }
      ),
      /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col gap-2", children: [
        /* @__PURE__ */ m.jsxs("div", { className: "flex items-end gap-2", children: [
          l.length > 0 ? /* @__PURE__ */ m.jsx("div", { className: "flex-1 relative", children: /* @__PURE__ */ m.jsx(
            gA,
            {
              className: "!mb-0",
              label: "",
              value: e.model || "",
              onChange: (C) => n({ model: C }),
              options: l.map((C) => ({ value: C.id, label: C.name || C.id })),
              placeholder: "",
              emptyText: ""
            }
          ) }) : /* @__PURE__ */ m.jsx(
            mi,
            {
              className: "flex-1 !mb-0",
              label: "",
              value: e.model || "",
              onChange: (C) => n({ model: C }),
              placeholder: _E[e.source],
              description: ""
            }
          ),
          (a || o) && /* @__PURE__ */ m.jsx(
            "button",
            {
              type: "button",
              className: "h-[42px] w-[42px] min-w-[42px] flex items-center justify-center border-none rounded-md bg-muted text-muted-foreground cursor-pointer transition-all hover:bg-accent hover:text-foreground disabled:opacity-50 disabled:cursor-not-allowed",
              onClick: x,
              disabled: d,
              title: "",
              children: d ? /* @__PURE__ */ m.jsx(au, { size: 16, className: "animate-spin" }) : /* @__PURE__ */ m.jsx(zr, { size: 16 })
            }
          )
        ] }),
        p && /* @__PURE__ */ m.jsx("p", { className: "text-xs text-destructive", children: p }),
        l.length > 0 && /* @__PURE__ */ m.jsxs("p", { className: "text-xs text-muted-foreground", children: [
          " ",
          l.length,
          " "
        ] })
      ] })
    ] }),
    /* @__PURE__ */ m.jsx(na, { title: "", collapsible: !0, defaultCollapsed: !0, children: /* @__PURE__ */ m.jsx(
      mi,
      {
        label: "",
        value: ((b = e.dimensions) == null ? void 0 : b.toString()) || "",
        onChange: (C) => {
          const N = parseInt(C, 10);
          n({ dimensions: isNaN(N) ? void 0 : N });
        },
        placeholder: "",
        description: ""
      }
    ) })
  ] });
}, UH = ({
  config: e,
  onChange: t
}) => {
  const n = (p) => {
    t({ ...e, ...p });
  }, [r, a] = G.useState([]), [o, l] = G.useState(!1), [c, d] = G.useState(null), h = async () => {
    if (!e.url) {
      d(" API URL");
      return;
    }
    l(!0), d(null);
    try {
      const p = await fl.fetchOpenAIModels({
        apiUrl: e.url,
        apiKey: e.apiKey
      });
      p.length > 0 ? a(p) : a(fl.getCommonRerankModels());
    } catch {
      a(fl.getCommonRerankModels());
    } finally {
      l(!1);
    }
  };
  return /* @__PURE__ */ m.jsxs("div", { className: "", children: [
    /* @__PURE__ */ m.jsx(na, { title: "Rerank ", description: "", children: /* @__PURE__ */ m.jsx(
      oo,
      {
        label: " Rerank",
        checked: e.enabled,
        onChange: (p) => n({ enabled: p }),
        description: " Rerank "
      }
    ) }),
    e.enabled && /* @__PURE__ */ m.jsxs(m.Fragment, { children: [
      /* @__PURE__ */ m.jsxs(na, { title: "API ", children: [
        /* @__PURE__ */ m.jsx(
          mi,
          {
            label: "API URL",
            type: "url",
            value: e.url,
            onChange: (p) => n({ url: p }),
            placeholder: "http://localhost:8000/rerank",
            description: "Rerank  API ",
            required: !0
          }
        ),
        /* @__PURE__ */ m.jsx(
          mi,
          {
            label: "API Key",
            type: "password",
            value: e.apiKey,
            onChange: (p) => n({ apiKey: p }),
            placeholder: " API "
          }
        ),
        /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col gap-2", children: [
          /* @__PURE__ */ m.jsxs("div", { className: "flex items-end gap-2", children: [
            r.length > 0 ? /* @__PURE__ */ m.jsx("div", { className: "flex-1 relative", children: /* @__PURE__ */ m.jsx(
              gA,
              {
                className: "!mb-0",
                label: "",
                value: e.model,
                onChange: (p) => n({ model: p }),
                options: r.map((p) => ({ value: p.id, label: p.name || p.id })),
                placeholder: "",
                emptyText: ""
              }
            ) }) : /* @__PURE__ */ m.jsx(
              mi,
              {
                className: "flex-1 !mb-0",
                label: "",
                value: e.model,
                onChange: (p) => n({ model: p }),
                placeholder: "BAAI/bge-reranker-v2-m3",
                description: " Rerank ",
                required: !0
              }
            ),
            /* @__PURE__ */ m.jsx(
              "button",
              {
                type: "button",
                className: "h-[42px] w-[42px] min-w-[42px] flex items-center justify-center border-none rounded-md bg-muted text-muted-foreground cursor-pointer transition-all hover:bg-accent hover:text-foreground disabled:opacity-50 disabled:cursor-not-allowed",
                onClick: h,
                disabled: o,
                title: "",
                children: o ? /* @__PURE__ */ m.jsx(au, { size: 16, className: "animate-spin" }) : /* @__PURE__ */ m.jsx(zr, { size: 16 })
              }
            )
          ] }),
          c && /* @__PURE__ */ m.jsx("p", { className: "text-xs text-destructive", children: c }),
          r.length > 0 && /* @__PURE__ */ m.jsxs("p", { className: "text-xs text-muted-foreground", children: [
            " ",
            r.length,
            " "
          ] })
        ] })
      ] }),
      /* @__PURE__ */ m.jsxs(na, { title: "", children: [
        /* @__PURE__ */ m.jsx(
          ni,
          {
            label: "Top-N",
            value: e.topN,
            onChange: (p) => n({ topN: p }),
            min: 1,
            max: 50,
            step: 1,
            description: ""
          }
        ),
        /* @__PURE__ */ m.jsx(
          ni,
          {
            label: " (Hybrid Alpha)",
            value: e.hybridAlpha,
            onChange: (p) => n({ hybridAlpha: p }),
            min: 0,
            max: 1,
            step: 0.1,
            description: "0 = 1 =  Rerank "
          }
        )
      ] })
    ] })
  ] });
};
function $H(e) {
  switch (e) {
    case "summary":
      return "text-blue-500 bg-blue-500/10 border border-blue-500/20";
    case "trim":
      return "text-orange-500 bg-orange-500/10 border border-orange-500/20";
    case "preprocessing":
      return "text-emerald-500 bg-emerald-500/10 border border-emerald-500/20";
    default:
      return "text-muted-foreground bg-muted border border-border";
  }
}
function HH(e) {
  var t;
  return ((t = hg.find((n) => n.value === e)) == null ? void 0 : t.label) || e;
}
const GH = ({
  template: e,
  isSelected: t = !1,
  onSelect: n,
  onCopy: r,
  onDelete: a,
  onToggleEnabled: o,
  onImport: l,
  onResetToDefault: c
}) => {
  const d = G.useRef(null), h = (b) => {
    b.stopPropagation();
    const C = {
      version: "1.0",
      exportedAt: Date.now(),
      template: {
        name: e.name,
        category: e.category,
        boundPresetId: e.boundPresetId,
        systemPrompt: e.systemPrompt,
        userPromptTemplate: e.userPromptTemplate,
        outputFormat: e.outputFormat,
        availableVariables: e.availableVariables
      }
    }, N = new Blob([JSON.stringify(C, null, 2)], { type: "application/json" }), T = URL.createObjectURL(N), j = document.createElement("a");
    j.href = T, j.download = `engram_template_${e.name.replace(/\s+/g, "_")}.json`, j.click(), URL.revokeObjectURL(T);
  }, p = (b) => {
    var C;
    b.stopPropagation(), (C = d.current) == null || C.click();
  }, g = (b) => {
    var T;
    const C = (T = b.target.files) == null ? void 0 : T[0];
    if (!C || !l) return;
    const N = new FileReader();
    N.onload = (j) => {
      var R;
      try {
        const A = JSON.parse((R = j.target) == null ? void 0 : R.result);
        if (A.version && A.template) {
          const z = ll(
            A.template.name,
            A.template.category,
            {
              enabled: e.enabled,
              // 
              isBuiltIn: e.isBuiltIn,
              // 
              boundPresetId: A.template.boundPresetId,
              systemPrompt: A.template.systemPrompt,
              userPromptTemplate: A.template.userPromptTemplate,
              outputFormat: A.template.outputFormat,
              availableVariables: A.template.availableVariables
            }
          );
          z.id = e.id, l(z);
        }
      } catch (A) {
        console.error(":", A);
      }
    }, N.readAsText(C), d.current && (d.current.value = "");
  }, x = e.category === "preprocessing";
  return /* @__PURE__ */ m.jsxs(
    "div",
    {
      className: `
                group relative p-3 rounded-lg border cursor-pointer transition-all duration-200
                ${t ? "bg-accent/50 border-input" : "bg-transparent border-transparent hover:bg-muted/50 hover:border-border"}
                ${!e.enabled && !x && "opacity-50"}
            `,
      onClick: n,
      children: [
        /* @__PURE__ */ m.jsxs("div", { className: "flex items-start gap-3", children: [
          x ? (
            // ""
            /* @__PURE__ */ m.jsx(
              "div",
              {
                className: "w-8 h-8 flex items-center justify-center rounded-lg bg-emerald-500/10 text-emerald-500 flex-shrink-0",
                title: " ()",
                children: /* @__PURE__ */ m.jsx(T1, { size: 16 })
              }
            )
          ) : /* @__PURE__ */ m.jsx(
            "button",
            {
              className: `
                            w-8 h-8 flex items-center justify-center rounded-lg transition-colors flex-shrink-0
                            ${e.enabled ? "bg-primary/10 text-primary" : "bg-muted text-muted-foreground hover:bg-muted/80"}
                        `,
              onClick: (b) => {
                b.stopPropagation(), o == null || o(!e.enabled);
              },
              title: e.enabled ? "" : "",
              children: /* @__PURE__ */ m.jsx(O1, { size: 16 })
            }
          ),
          /* @__PURE__ */ m.jsxs("div", { className: "flex-1 min-w-0", children: [
            /* @__PURE__ */ m.jsxs("div", { className: "flex items-center justify-between gap-2", children: [
              /* @__PURE__ */ m.jsx("h4", { className: `text-sm font-medium truncate ${t ? "text-foreground" : "text-muted-foreground group-hover:text-foreground"} ${!e.enabled && "line-through"}`, children: e.name }),
              /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-1.5 flex-shrink-0", children: [
                /* @__PURE__ */ m.jsx("span", { className: `text-[10px] px-1.5 py-0.5 rounded-sm font-medium ${$H(e.category)}`, children: HH(e.category) }),
                e.isBuiltIn && /* @__PURE__ */ m.jsx("span", { className: "text-[10px] px-1.5 py-0.5 rounded-sm bg-muted text-muted-foreground", children: "BUILTIN" })
              ] })
            ] }),
            /* @__PURE__ */ m.jsxs("div", { className: "mt-1 flex items-center justify-between text-[10px] text-muted-foreground/70 font-mono", children: [
              /* @__PURE__ */ m.jsx("span", { className: "truncate max-w-[120px]", children: e.boundPresetId ? `BOUND: ${e.boundPresetId}` : "DEFAULT PRESET" }),
              /* @__PURE__ */ m.jsx("span", { children: e.outputFormat.toUpperCase() })
            ] })
          ] })
        ] }),
        /* @__PURE__ */ m.jsxs("div", { className: `mt-2 flex justify-end gap-1 ${t || "opacity-0 group-hover:opacity-100"} transition-opacity`, children: [
          /* @__PURE__ */ m.jsx("button", { className: "p-1.5 hover:bg-muted rounded text-muted-foreground hover:text-foreground transition-colors", onClick: p, title: "Import", children: /* @__PURE__ */ m.jsx(f7, { size: 12 }) }),
          /* @__PURE__ */ m.jsx("button", { className: "p-1.5 hover:bg-muted rounded text-muted-foreground hover:text-foreground transition-colors", onClick: h, title: "Export", children: /* @__PURE__ */ m.jsx(ig, { size: 12 }) }),
          /* @__PURE__ */ m.jsx("button", { className: "p-1.5 hover:bg-muted rounded text-muted-foreground hover:text-foreground transition-colors", onClick: (b) => {
            b.stopPropagation(), r == null || r();
          }, title: "Copy", children: /* @__PURE__ */ m.jsx(gS, { size: 12 }) }),
          e.isBuiltIn && /* @__PURE__ */ m.jsx(
            "button",
            {
              className: "p-1.5 hover:bg-amber-500/10 rounded text-muted-foreground hover:text-amber-500 transition-colors",
              onClick: (b) => {
                b.stopPropagation();
                let C = NS(e.id);
                C || (C = L1(e.category)), C && c && c({
                  ...C,
                  id: e.id,
                  enabled: e.enabled
                });
              },
              title: "",
              children: /* @__PURE__ */ m.jsx(o7, { size: 12 })
            }
          ),
          !e.isBuiltIn && /* @__PURE__ */ m.jsx("button", { className: "p-1.5 hover:bg-destructive/10 rounded text-muted-foreground hover:text-destructive transition-colors", onClick: (b) => {
            b.stopPropagation(), a == null || a();
          }, title: "Delete", children: /* @__PURE__ */ m.jsx(po, { size: 12 }) })
        ] }),
        /* @__PURE__ */ m.jsx(
          "input",
          {
            ref: d,
            type: "file",
            accept: ".json",
            onChange: g,
            className: "hidden"
          }
        )
      ]
    }
  );
}, VH = ({
  templates: e,
  selectedId: t,
  onSelect: n,
  onAdd: r,
  onUpdate: a,
  onDelete: o
}) => {
  const l = () => {
    const g = ll(
      ` ${e.length + 1}`,
      "summary"
    );
    r(g), n(g);
  }, c = (g) => {
    const x = ll(
      `${g.name} ()`,
      g.category,
      {
        enabled: !1,
        // 
        boundPresetId: g.boundPresetId,
        systemPrompt: g.systemPrompt,
        userPromptTemplate: g.userPromptTemplate,
        outputFormat: g.outputFormat,
        availableVariables: [...g.availableVariables]
      }
    );
    r(x);
  }, d = (g, x) => {
    x && e.filter((b) => b.category === g.category && b.id !== g.id && b.enabled).forEach((b) => a({ ...b, enabled: !1 })), a({ ...g, enabled: x });
  }, h = (g) => {
    a(g);
  }, p = hg.map((g) => ({
    ...g,
    templates: e.filter((x) => x.category === g.value)
  })).filter((g) => g.templates.length > 0);
  return /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col gap-4 h-full", children: [
    /* @__PURE__ */ m.jsxs("div", { className: "flex items-center justify-between gap-2", children: [
      /* @__PURE__ */ m.jsx("h3", { className: "text-xs font-bold text-muted-foreground uppercase tracking-wider", children: "" }),
      /* @__PURE__ */ m.jsx(
        "button",
        {
          className: "text-muted-foreground hover:text-foreground transition-colors",
          onClick: l,
          children: /* @__PURE__ */ m.jsx(xS, { size: 16 })
        }
      )
    ] }),
    /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col gap-6 overflow-y-auto flex-1 no-scrollbar", children: [
      p.map((g) => /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col gap-2", children: [
        /* @__PURE__ */ m.jsxs("div", { className: "text-[10px] items-center gap-2 text-muted-foreground font-medium px-1 uppercase tracking-wider flex", children: [
          g.label,
          /* @__PURE__ */ m.jsx("div", { className: "h-px bg-border flex-1" })
        ] }),
        /* @__PURE__ */ m.jsx("div", { className: "flex flex-col gap-1", children: g.templates.map((x) => /* @__PURE__ */ m.jsx(
          GH,
          {
            template: x,
            isSelected: t === x.id,
            onSelect: () => n(x),
            onCopy: () => c(x),
            onDelete: () => o(x),
            onToggleEnabled: (b) => d(x, b),
            onImport: h,
            onResetToDefault: (b) => a(b)
          },
          x.id
        )) })
      ] }, g.value)),
      e.length === 0 && /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col items-center justify-center py-12 text-muted-foreground gap-2 border border-dashed border-border rounded-lg", children: [
        /* @__PURE__ */ m.jsx(em, { size: 24, className: "opacity-50" }),
        /* @__PURE__ */ m.jsx("p", { className: "text-xs", children: "" })
      ] })
    ] })
  ] });
}, KH = [
  // Context
  { name: "{{userInput}}", desc: "", category: "Context ()" },
  { name: "{{chatHistory}}", desc: ": {{chatHistory:20}}", category: "Context ()" },
  { name: "{{context}}", desc: " (Description/Persona...)", category: "Context ()" },
  { name: "{{worldbookContext}}", desc: "", category: "Context ()" },
  { name: "{{userPersona}}", desc: " (Persona Description)", category: "Context ()" },
  { name: "{{char}}", desc: "", category: "Context ()" },
  { name: "{{user}}", desc: "", category: "Context ()" },
  // Text Generation
  { name: "{{engramSummaries}}", desc: " (, /)", category: "Text Generation ()" },
  { name: "{{engramArchivedSummaries}}", desc: " ()", category: "Text Generation ()" },
  // Data Layer
  { name: "{{engramGraph}}", desc: " JSON (/)", category: "Data Layer ()" }
], YH = ({ macro: e }) => {
  const [t, n] = G.useState(!1), r = () => {
    navigator.clipboard.writeText(e.name), n(!0), setTimeout(() => n(!1), 2e3);
  };
  return /* @__PURE__ */ m.jsxs("div", { className: "flex items-center justify-between gap-2 p-1.5 rounded hover:bg-muted/50 group transition-colors", children: [
    /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col gap-0.5", children: [
      /* @__PURE__ */ m.jsx("code", { className: "text-[11px] text-primary font-mono font-medium", children: e.name }),
      /* @__PURE__ */ m.jsx("span", { className: "text-[10px] text-muted-foreground", children: e.desc })
    ] }),
    /* @__PURE__ */ m.jsx(
      "button",
      {
        onClick: r,
        className: "opacity-0 group-hover:opacity-100 transition-opacity p-1 hover:bg-muted rounded text-muted-foreground hover:text-foreground",
        title: "",
        children: t ? /* @__PURE__ */ m.jsx(T1, { size: 12, className: "text-green-500" }) : /* @__PURE__ */ m.jsx(gS, { size: 12 })
      }
    )
  ] });
}, EE = ({
  template: e,
  llmPresets: t,
  defaultPresetId: n,
  onChange: r
}) => {
  var c, d;
  const a = [
    { value: "", label: "" + (n ? ` (${((c = t.find((h) => h.id === n)) == null ? void 0 : c.name) || n})` : "") },
    ...t.map((h) => ({ value: h.id, label: h.name }))
  ], o = (h) => {
    r({ ...e, ...h, updatedAt: Date.now() });
  }, l = KH.reduce((h, p) => (h[p.category] || (h[p.category] = []), h[p.category].push(p), h), {});
  return /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col gap-4", children: [
    /* @__PURE__ */ m.jsxs(na, { title: "", children: [
      /* @__PURE__ */ m.jsx(
        mi,
        {
          label: "",
          value: e.name,
          onChange: (h) => o({ name: h }),
          placeholder: "",
          required: !0,
          disabled: e.isBuiltIn
        }
      ),
      /* @__PURE__ */ m.jsx(
        nu,
        {
          label: "",
          value: e.category,
          onChange: (h) => o({ category: h }),
          options: hg.map((h) => ({ value: h.value, label: h.label })),
          description: (d = hg.find((h) => h.value === e.category)) == null ? void 0 : d.description
        }
      ),
      /* @__PURE__ */ m.jsx(
        nu,
        {
          label: "",
          value: e.boundPresetId || "",
          onChange: (h) => o({ boundPresetId: h || null }),
          options: a,
          description: " LLM "
        }
      ),
      e.category === "preprocessing" && /* @__PURE__ */ m.jsx(
        nu,
        {
          label: "",
          value: e.injectionMode || "replace",
          onChange: (h) => o({ injectionMode: h }),
          options: [
            { value: "replace", label: " (Overwrite)" },
            { value: "append", label: " (Append)" },
            { value: "prepend", label: " (Prepend)" }
          ],
          description: ""
        }
      )
    ] }),
    /* @__PURE__ */ m.jsxs(na, { title: "", children: [
      /* @__PURE__ */ m.jsx(
        mi,
        {
          label: "",
          value: e.systemPrompt,
          onChange: (h) => o({ systemPrompt: h }),
          placeholder: "...",
          multiline: !0,
          rows: 4
        }
      ),
      /* @__PURE__ */ m.jsx(
        mi,
        {
          label: "",
          value: e.userPromptTemplate,
          onChange: (h) => o({ userPromptTemplate: h }),
          placeholder: "...",
          multiline: !0,
          rows: 6
        }
      )
    ] }),
    /* @__PURE__ */ m.jsxs("div", { className: "px-3 py-3 bg-muted/20 rounded-md border border-border/50 space-y-3", children: [
      /* @__PURE__ */ m.jsxs("div", { className: "text-[11px] font-semibold text-muted-foreground uppercase tracking-wider flex items-center gap-2", children: [
        /* @__PURE__ */ m.jsx("span", { children: "" }),
        /* @__PURE__ */ m.jsx("div", { className: "h-px bg-border flex-1" })
      ] }),
      /* @__PURE__ */ m.jsx("div", { className: "flex flex-col gap-4", children: Object.entries(l).map(([h, p]) => /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col gap-1", children: [
        /* @__PURE__ */ m.jsx("div", { className: "text-[10px] text-primary/70 font-medium px-1 mb-0.5", children: h }),
        /* @__PURE__ */ m.jsx("div", { className: "grid grid-cols-1 gap-px bg-border/20 rounded overflow-hidden", children: p.map((g) => /* @__PURE__ */ m.jsx("div", { className: "bg-background/50", children: /* @__PURE__ */ m.jsx(YH, { macro: g }) }, g.name)) })
      ] }, h)) })
    ] })
  ] });
}, WH = ({
  rules: e,
  selectedId: t,
  onSelect: n,
  onToggle: r,
  onDelete: a,
  onAdd: o,
  onReset: l,
  enableNativeRegex: c,
  onToggleNativeRegex: d
}) => /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col gap-4", children: [
  /* @__PURE__ */ m.jsxs("div", { className: "flex items-center justify-between", children: [
    /* @__PURE__ */ m.jsx("h3", { className: "text-xs font-bold text-muted-foreground uppercase tracking-wider", children: "" }),
    /* @__PURE__ */ m.jsxs("div", { className: "flex gap-2", children: [
      /* @__PURE__ */ m.jsx(
        "button",
        {
          className: "text-[10px] text-muted-foreground hover:text-destructive transition-colors",
          onClick: l,
          children: ""
        }
      ),
      /* @__PURE__ */ m.jsx(
        "button",
        {
          className: "text-muted-foreground hover:text-foreground transition-colors",
          onClick: o,
          children: /* @__PURE__ */ m.jsx(s7, { size: 16 })
        }
      )
    ] })
  ] }),
  /* @__PURE__ */ m.jsx("div", { className: "bg-muted/10 border border-border/50 rounded-lg p-3 mb-2", children: /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4", children: [
    /* @__PURE__ */ m.jsxs("div", { className: "flex-1 min-w-0", children: [
      /* @__PURE__ */ m.jsx("h4", { className: "text-sm font-medium", children: " Regex " }),
      /* @__PURE__ */ m.jsx("p", { className: "text-xs text-muted-foreground mt-0.5 break-words", children: " SillyTavern  Regex " })
    ] }),
    /* @__PURE__ */ m.jsx(
      Kr,
      {
        checked: c ?? !0,
        onChange: (h) => d == null ? void 0 : d(h)
      }
    )
  ] }) }),
  /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col gap-1", children: [
    e.map((h) => /* @__PURE__ */ m.jsxs(
      "div",
      {
        className: `
                            group p-3 rounded-lg transition-all duration-200 cursor-pointer border flex items-center gap-3
                            ${t === h.id ? "bg-accent/50 border-input" : "bg-transparent border-transparent hover:bg-muted/50 hover:border-border"}
                            ${!h.enabled && "opacity-50"}
                        `,
        onClick: () => n(h.id),
        children: [
          /* @__PURE__ */ m.jsx(
            "button",
            {
              className: `
                                w-8 h-8 flex items-center justify-center rounded-lg transition-colors
                                ${h.enabled ? t === h.id ? "bg-primary/20 text-primary" : "bg-muted text-primary" : "bg-muted text-muted-foreground"}
                            `,
              onClick: (p) => {
                p.stopPropagation(), r(h.id);
              },
              title: h.enabled ? "" : "",
              children: /* @__PURE__ */ m.jsx(O1, { size: 14 })
            }
          ),
          /* @__PURE__ */ m.jsxs("div", { className: "flex-1 min-w-0", children: [
            /* @__PURE__ */ m.jsx("div", { className: "flex items-center justify-between", children: /* @__PURE__ */ m.jsx("h4", { className: `text-sm font-medium truncate ${t === h.id ? "text-foreground" : "text-muted-foreground group-hover:text-foreground"} ${!h.enabled && "opacity-50 line-through"}`, children: h.name }) }),
            /* @__PURE__ */ m.jsx("div", { className: "mt-0.5 flex items-center gap-2", children: /* @__PURE__ */ m.jsxs("code", { className: "text-[10px] bg-muted px-1 rounded text-muted-foreground font-mono truncate max-w-[120px]", children: [
              "/",
              h.pattern,
              "/",
              h.flags
            ] }) })
          ] }),
          /* @__PURE__ */ m.jsx("div", { className: `flex items-center ${t === h.id ? "opacity-100" : "opacity-0 group-hover:opacity-100"} transition-opacity`, children: /* @__PURE__ */ m.jsx(
            "button",
            {
              className: "p-1.5 hover:bg-destructive/10 rounded text-muted-foreground hover:text-destructive transition-colors",
              onClick: (p) => {
                p.stopPropagation(), a(h.id);
              },
              children: /* @__PURE__ */ m.jsx(po, { size: 12 })
            }
          ) })
        ]
      },
      h.id
    )),
    e.length === 0 && /* @__PURE__ */ m.jsx("div", { className: "text-center p-8 border border-dashed border-border rounded-lg", children: /* @__PURE__ */ m.jsx("p", { className: "text-xs text-muted-foreground", children: "" }) })
  ] })
] }), XH = [
  { value: "g", label: "", description: "" },
  { value: "i", label: "", description: "" },
  { value: "m", label: "", description: "^$ " },
  { value: "s", label: "", description: ". " }
], kE = ({ rule: e, onChange: t }) => {
  var p;
  const [n, r] = G.useState(""), [a, o] = G.useState(""), [l, c] = G.useState({ valid: !0 }), d = new H1();
  G.useEffect(() => {
    const g = d.validatePattern(e.pattern, e.flags);
    c(g);
  }, [e.pattern, e.flags]), G.useEffect(() => {
    if (n && l.valid) {
      const g = d.processWithRule(n, e);
      o(g);
    } else
      o("");
  }, [n, e, l.valid]);
  const h = (g) => {
    const x = e.flags.split(""), b = x.indexOf(g);
    b >= 0 ? x.splice(b, 1) : x.push(g), t({ flags: x.join("") });
  };
  return /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col gap-4", children: [
    /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col gap-3", children: [
      /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col gap-1.5", children: [
        /* @__PURE__ */ m.jsx("label", { className: "text-sm font-medium text-foreground", children: "" }),
        /* @__PURE__ */ m.jsx(
          "input",
          {
            type: "text",
            className: "w-full px-3 py-2 rounded-md border border-input bg-background text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring",
            value: e.name,
            onChange: (g) => t({ name: g.target.value }),
            placeholder: ""
          }
        )
      ] }),
      /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col gap-1.5", children: [
        /* @__PURE__ */ m.jsx("label", { className: "text-sm font-medium text-foreground", children: "" }),
        /* @__PURE__ */ m.jsx(
          "input",
          {
            type: "text",
            className: "w-full px-3 py-2 rounded-md border border-input bg-background text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring",
            value: e.description || "",
            onChange: (g) => t({ description: g.target.value }),
            placeholder: ""
          }
        )
      ] }),
      /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col gap-1.5", children: [
        /* @__PURE__ */ m.jsx("label", { className: "text-sm font-medium text-foreground", children: "" }),
        /* @__PURE__ */ m.jsx("div", { className: "flex gap-2", children: U3.map((g) => /* @__PURE__ */ m.jsx(
          "button",
          {
            className: `flex-1 px-3 py-2 text-sm rounded-md border transition-colors ${e.scope === g.value ? "bg-primary-20 border-primary text-primary" : "bg-background border-border text-muted-foreground hover:bg-muted"}`,
            onClick: () => t({ scope: g.value }),
            title: g.description,
            children: g.label
          },
          g.value
        )) }),
        /* @__PURE__ */ m.jsx("p", { className: "text-xs text-muted-foreground", children: (p = U3.find((g) => g.value === e.scope)) == null ? void 0 : p.description })
      ] })
    ] }),
    /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col gap-3 p-4 bg-card border border-border rounded-lg", children: [
      /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col gap-1.5", children: [
        /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-2", children: [
          /* @__PURE__ */ m.jsx("label", { className: "text-sm font-medium text-foreground", children: "" }),
          l.valid ? /* @__PURE__ */ m.jsx(pS, { size: 14, className: "text-green-500" }) : /* @__PURE__ */ m.jsx(xc, { size: 14, className: "text-red-500" })
        ] }),
        /* @__PURE__ */ m.jsx(
          "input",
          {
            type: "text",
            className: `w-full px-3 py-2 rounded-md border bg-background text-foreground font-mono text-sm placeholder:text-muted-foreground focus:outline-none focus:ring-2 ${l.valid ? "border-input focus:ring-ring" : "border-red-500 focus:ring-red-500"}`,
            value: e.pattern,
            onChange: (g) => t({ pattern: g.target.value }),
            placeholder: "<think>[\\s\\S]*?</think>"
          }
        ),
        !l.valid && l.error && /* @__PURE__ */ m.jsx("p", { className: "text-xs text-red-500", children: l.error })
      ] }),
      /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col gap-1.5", children: [
        /* @__PURE__ */ m.jsx("label", { className: "text-sm font-medium text-foreground", children: "" }),
        /* @__PURE__ */ m.jsx(
          "input",
          {
            type: "text",
            className: "w-full px-3 py-2 rounded-md border border-input bg-background text-foreground font-mono text-sm placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring",
            value: e.replacement,
            onChange: (g) => t({ replacement: g.target.value }),
            placeholder: ""
          }
        )
      ] }),
      /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col gap-1.5", children: [
        /* @__PURE__ */ m.jsx("label", { className: "text-sm font-medium text-foreground", children: "" }),
        /* @__PURE__ */ m.jsx("div", { className: "flex flex-wrap gap-2", children: XH.map((g) => /* @__PURE__ */ m.jsxs(
          "button",
          {
            className: `px-2 py-1 text-xs rounded-md border transition-colors ${e.flags.includes(g.value) ? "bg-primary-20 border-primary text-primary" : "bg-background border-border text-muted-foreground hover:bg-muted"}`,
            onClick: () => h(g.value),
            title: g.description,
            children: [
              g.label,
              " (",
              g.value,
              ")"
            ]
          },
          g.value
        )) })
      ] })
    ] }),
    /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col gap-3 p-4 bg-muted-20 border border-border rounded-lg", children: [
      /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-2 text-sm font-medium text-foreground", children: [
        /* @__PURE__ */ m.jsx(dg, { size: 14 }),
        ""
      ] }),
      /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col gap-1.5", children: [
        /* @__PURE__ */ m.jsx("label", { className: "text-xs text-muted-foreground", children: "" }),
        /* @__PURE__ */ m.jsx(
          "textarea",
          {
            className: "w-full min-h-[80px] px-3 py-2 rounded-md border border-input bg-background text-foreground text-sm resize-y focus:outline-none focus:ring-2 focus:ring-ring",
            value: n,
            onChange: (g) => r(g.target.value),
            placeholder: `
<think></think>
`
          }
        )
      ] }),
      n && l.valid && /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col gap-1.5", children: [
        /* @__PURE__ */ m.jsx("label", { className: "text-xs text-muted-foreground", children: "" }),
        /* @__PURE__ */ m.jsx("div", { className: "min-h-[60px] px-3 py-2 rounded-md border border-border bg-background text-sm whitespace-pre-wrap", children: a || /* @__PURE__ */ m.jsx("span", { className: "text-muted-foreground italic", children: "" }) })
      ] })
    ] }),
    /* @__PURE__ */ m.jsxs("div", { className: "flex items-start gap-2 p-3 bg-blue-500/10 border border-blue-500/30 rounded-lg text-sm text-blue-400", children: [
      /* @__PURE__ */ m.jsx(Cz, { size: 16, className: "shrink-0 mt-0.5" }),
      /* @__PURE__ */ m.jsxs("div", { children: [
        /* @__PURE__ */ m.jsx("strong", { children: "" }),
        " LLM ",
        /* @__PURE__ */ m.jsx("strong", { children: "" }),
        " LLM  ",
        /* @__PURE__ */ m.jsx("code", { className: "bg-blue-500/20 px-1 rounded", children: "<think>" }),
        ""
      ] })
    ] })
  ] });
}, QH = ({
  config: e,
  onChange: t,
  worldbookStructure: n = {},
  disabledEntries: r = {},
  onToggleWorldbook: a,
  onToggleEntry: o,
  onRefresh: l
}) => {
  const [c, d] = G.useState(/* @__PURE__ */ new Set()), [h, p] = G.useState(""), g = (j) => {
    t({
      ...e,
      [j]: !e[j]
    });
  }, x = (j) => {
    const R = new Set(c);
    R.has(j) ? R.delete(j) : R.add(j), d(R);
  }, b = (j) => {
    var R;
    return ((R = e.disabledWorldbooks) == null ? void 0 : R.includes(j)) || !1;
  }, C = (j, R) => {
    var A;
    return ((A = r[j]) == null ? void 0 : A.includes(R)) || !1;
  }, T = Object.keys(n).sort().filter(
    (j) => j.toLowerCase().includes(h.toLowerCase()) || n[j].some(
      (R) => {
        var A, z;
        return ((A = R.names) == null ? void 0 : A.join(" ").toLowerCase().includes(h.toLowerCase())) || ((z = R.comment) == null ? void 0 : z.toLowerCase().includes(h.toLowerCase()));
      }
    )
  );
  return /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col gap-6", children: [
    /* @__PURE__ */ m.jsxs(na, { title: "", description: "", children: [
      /* @__PURE__ */ m.jsx(
        oo,
        {
          label: "",
          description: "",
          checked: e.enabled,
          onChange: () => g("enabled")
        }
      ),
      /* @__PURE__ */ m.jsx(
        oo,
        {
          label: "",
          description: " / ",
          checked: e.includeGlobal,
          onChange: () => g("includeGlobal"),
          disabled: !e.enabled
        }
      ),
      /* @__PURE__ */ m.jsx(
        oo,
        {
          label: " EJS  (ST-Prompt-Template)",
          description: "[]  WorldInfo  EJS  ST-Prompt-Template",
          checked: e.enableEJS ?? !0,
          onChange: () => g("enableEJS"),
          disabled: !e.enabled
        }
      )
    ] }),
    e.enabled && /* @__PURE__ */ m.jsxs(na, { title: "", description: "", children: [
      /* @__PURE__ */ m.jsxs("div", { className: "flex items-center justify-between mb-4 gap-4", children: [
        /* @__PURE__ */ m.jsxs("div", { className: "relative flex-1", children: [
          /* @__PURE__ */ m.jsx(Es, { className: "absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground w-4 h-4" }),
          /* @__PURE__ */ m.jsx(
            "input",
            {
              type: "text",
              placeholder: "...",
              className: "w-full h-9 pl-9 pr-3 rounded-md border border-input bg-transparent text-sm shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring",
              value: h,
              onChange: (j) => p(j.target.value)
            }
          )
        ] }),
        /* @__PURE__ */ m.jsx(
          "button",
          {
            onClick: l,
            className: "inline-flex items-center justify-center rounded-md w-9 h-9 hover:bg-accent hover:text-accent-foreground transition-colors",
            title: "",
            children: /* @__PURE__ */ m.jsx(zr, { size: 16 })
          }
        )
      ] }),
      /* @__PURE__ */ m.jsx("div", { className: "flex flex-col gap-2", children: T.length === 0 ? /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col items-center justify-center py-8 text-muted-foreground gap-2 border border-dashed rounded-lg", children: [
        /* @__PURE__ */ m.jsx(xc, { size: 24, className: "opacity-50" }),
        /* @__PURE__ */ m.jsx("span", { className: "text-sm", children: "" })
      ] }) : T.map((j) => {
        const R = b(j), A = n[j] || [], z = c.has(j), q = A.filter((D) => !C(j, D.uid)).length;
        return /* @__PURE__ */ m.jsxs("div", { className: `transition-all border-b border-border last:border-0 ${R ? "bg-muted/10 opacity-60 grayscale" : ""}`, children: [
          /* @__PURE__ */ m.jsxs("div", { className: "flex items-center justify-between p-3", children: [
            /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-3 flex-1 overflow-hidden", children: [
              /* @__PURE__ */ m.jsx(
                "button",
                {
                  onClick: () => x(j),
                  className: "p-1 hover:bg-accent rounded-sm transition-colors",
                  children: z ? /* @__PURE__ */ m.jsx(ed, { size: 16 }) : /* @__PURE__ */ m.jsx(Jh, { size: 16 })
                }
              ),
              /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-2 min-w-0", children: [
                /* @__PURE__ */ m.jsx(zO, { size: 16, className: R ? "text-muted-foreground" : "text-primary" }),
                /* @__PURE__ */ m.jsx("span", { className: `font-medium truncate ${R ? "text-muted-foreground line-through" : ""}`, children: j }),
                /* @__PURE__ */ m.jsxs("span", { className: "text-xs text-muted-foreground px-2 py-0.5 bg-muted rounded-full whitespace-nowrap", children: [
                  q,
                  " / ",
                  A.length,
                  " "
                ] })
              ] })
            ] }),
            /* @__PURE__ */ m.jsx("div", { className: "flex items-center gap-4", children: /* @__PURE__ */ m.jsx(
              oo,
              {
                label: "",
                checked: !R,
                onChange: (D) => a == null ? void 0 : a(j, !D),
                compact: !0
              }
            ) })
          ] }),
          z && !R && /* @__PURE__ */ m.jsx("div", { className: "pl-4 pr-1 py-1 flex flex-col gap-0 animate-in slide-in-from-top-1 duration-200", children: A.length === 0 ? /* @__PURE__ */ m.jsx("div", { className: "text-xs text-muted-foreground text-center py-4", children: "" }) : A.map((D) => {
            const P = C(j, D.uid);
            return /* @__PURE__ */ m.jsxs("div", { className: `flex items-start justify-between py-2 -mx-2 px-2 rounded hover:bg-accent/40 transition-colors group ${P ? "bg-muted/10 opacity-60 grayscale" : ""}`, children: [
              /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col gap-1 min-w-0 flex-1 pr-4", children: [
                /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-2 flex-wrap min-w-0", children: [
                  /* @__PURE__ */ m.jsx(
                    "div",
                    {
                      className: `w-1.5 h-1.5 rounded-full flex-shrink-0 ${D.constant ? "bg-primary" : "bg-emerald-500"}`,
                      title: D.constant ? " (Constant)" : " (Selective)"
                    }
                  ),
                  /* @__PURE__ */ m.jsx("span", { className: `text-sm font-medium truncate max-w-full ${P ? "text-muted-foreground line-through" : "text-foreground"}`, children: D.name || ` #${D.uid}` }),
                  (D.keys || []).length > 0 && /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-1 ml-auto md:ml-2 overflow-hidden max-w-full", children: [
                    D.keys.slice(0, 3).map((re, ie) => /* @__PURE__ */ m.jsx("span", { className: "text-[10px] px-1 py-0.5 rounded border border-border bg-muted/20 text-muted-foreground whitespace-nowrap overflow-hidden text-ellipsis max-w-[80px]", children: re }, ie)),
                    D.keys.length > 3 && /* @__PURE__ */ m.jsxs("span", { className: "text-[10px] text-muted-foreground", children: [
                      "+",
                      D.keys.length - 3
                    ] })
                  ] })
                ] }),
                (D.comment || D.content) && /* @__PURE__ */ m.jsx("p", { className: "text-xs text-muted-foreground/80 pl-3.5 break-words line-clamp-2", children: D.comment || D.content })
              ] }),
              /* @__PURE__ */ m.jsx("div", { className: "flex-shrink-0", children: /* @__PURE__ */ m.jsx(
                oo,
                {
                  label: "",
                  checked: !P,
                  onChange: (re) => o == null ? void 0 : o(j, D.uid, !re),
                  compact: !0
                }
              ) })
            ] }, D.uid);
          }) })
        ] }, j);
      }) })
    ] })
  ] });
}, ZH = ({
  macros: e,
  selectedId: t,
  onSelect: n,
  onAdd: r,
  onToggle: a,
  onDelete: o
}) => /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col gap-4 h-full", children: [
  /* @__PURE__ */ m.jsxs("div", { className: "flex items-center justify-between gap-2", children: [
    /* @__PURE__ */ m.jsx("h3", { className: "text-xs font-bold text-muted-foreground uppercase tracking-wider", children: "" }),
    /* @__PURE__ */ m.jsx(
      "button",
      {
        className: "text-muted-foreground hover:text-foreground transition-colors",
        onClick: r,
        title: "",
        children: /* @__PURE__ */ m.jsx(xS, { size: 16 })
      }
    )
  ] }),
  /* @__PURE__ */ m.jsxs("div", { className: "text-xs text-muted-foreground bg-muted/30 rounded px-2 py-1.5 border border-border/50 leading-relaxed", children: [
    " ",
    /* @__PURE__ */ m.jsx("code", { className: "bg-muted px-1 rounded", children: "{{}}" }),
    " "
  ] }),
  /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col gap-1 overflow-y-auto flex-1 no-scrollbar", children: [
    e.map((l) => /* @__PURE__ */ m.jsxs(
      "div",
      {
        className: `
                            group p-3 rounded-lg transition-all duration-200 cursor-pointer border flex items-center gap-3
                            ${t === l.id ? "bg-accent/50 border-input" : "bg-transparent border-transparent hover:bg-muted/50 hover:border-border"}
                            ${!l.enabled && "opacity-50"}
                        `,
        onClick: () => n(l),
        children: [
          /* @__PURE__ */ m.jsx(
            "button",
            {
              className: `
                                w-8 h-8 flex items-center justify-center rounded-lg transition-colors flex-shrink-0
                                ${l.enabled ? t === l.id ? "bg-primary/20 text-primary" : "bg-muted text-primary" : "bg-muted text-muted-foreground"}
                            `,
              onClick: (c) => {
                c.stopPropagation(), a(l.id);
              },
              title: l.enabled ? "" : "",
              children: /* @__PURE__ */ m.jsx(O1, { size: 14 })
            }
          ),
          /* @__PURE__ */ m.jsxs("div", { className: "flex-1 min-w-0", children: [
            /* @__PURE__ */ m.jsx("div", { className: "flex items-center gap-2", children: /* @__PURE__ */ m.jsx("code", { className: `text-sm font-medium truncate ${t === l.id ? "text-primary" : "text-foreground"}`, children: `{{${l.name}}}` }) }),
            /* @__PURE__ */ m.jsx("p", { className: "mt-0.5 text-[10px] text-muted-foreground truncate", children: l.content ? l.content.slice(0, 50) + (l.content.length > 50 ? "..." : "") : "()" })
          ] }),
          /* @__PURE__ */ m.jsx(
            "button",
            {
              className: `p-1.5 hover:bg-destructive/10 rounded text-muted-foreground hover:text-destructive transition-colors ${t === l.id ? "opacity-100" : "opacity-0 group-hover:opacity-100"}`,
              onClick: (c) => {
                c.stopPropagation(), o(l.id);
              },
              title: "",
              children: /* @__PURE__ */ m.jsx(po, { size: 12 })
            }
          )
        ]
      },
      l.id
    )),
    e.length === 0 && /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col items-center justify-center py-12 text-muted-foreground gap-2 border border-dashed border-border rounded-lg", children: [
      /* @__PURE__ */ m.jsx(n7, { size: 24, className: "opacity-50" }),
      /* @__PURE__ */ m.jsx("p", { className: "text-xs", children: "" }),
      /* @__PURE__ */ m.jsx(
        "button",
        {
          className: "text-xs text-primary hover:underline",
          onClick: r,
          children: ""
        }
      )
    ] })
  ] })
] }), JH = ({
  macro: e,
  onChange: t
}) => /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col gap-4", children: [
  /* @__PURE__ */ m.jsx(na, { title: "", children: /* @__PURE__ */ m.jsx(
    mi,
    {
      label: "",
      value: e.name,
      onChange: (n) => t({ name: n }),
      placeholder: "",
      required: !0,
      description: " {{}} "
    }
  ) }),
  /* @__PURE__ */ m.jsx(na, { title: "", children: /* @__PURE__ */ m.jsx(
    mi,
    {
      label: "",
      value: e.content,
      onChange: (n) => t({ content: n }),
      placeholder: "",
      multiline: !0,
      rows: 8
    }
  ) }),
  /* @__PURE__ */ m.jsxs("div", { className: "px-3 py-2 bg-muted/30 rounded border border-border", children: [
    /* @__PURE__ */ m.jsx("div", { className: "text-[10px] text-muted-foreground mb-2 font-medium uppercase tracking-wider", children: "" }),
    /* @__PURE__ */ m.jsxs("div", { className: "text-xs text-muted-foreground leading-relaxed", children: [
      /* @__PURE__ */ m.jsxs("p", { children: [
        " ",
        /* @__PURE__ */ m.jsx("code", { className: "px-1 py-0.5 bg-muted rounded text-primary font-mono", children: `{{${e.name || ""}}}` }),
        " "
      ] }),
      /* @__PURE__ */ m.jsx("p", { className: "mt-1", children: " SillyTavern " })
    ] })
  ] })
] }), WS = ({ title: e, subtitle: t, actions: n, className: r = "" }) => /* @__PURE__ */ m.jsxs("div", { className: `mb-8 px-4 md:px-0 flex justify-between items-start animate-in fade-in slide-in-from-bottom-2 duration-500 ${r}`, children: [
  /* @__PURE__ */ m.jsxs("div", { children: [
    /* @__PURE__ */ m.jsx("h1", { className: "text-3xl font-light tracking-tight text-foreground", children: e }),
    t && /* @__PURE__ */ m.jsx("p", { className: "mt-2 text-muted-foreground text-sm font-light", children: t })
  ] }),
  n && /* @__PURE__ */ m.jsx("div", { className: "flex gap-2", children: n })
] }), Kx = ({
  title: e,
  onClose: t,
  children: n,
  actions: r
}) => /* @__PURE__ */ m.jsxs(
  "div",
  {
    className: "fixed inset-0 bg-background z-50 flex flex-col animate-in slide-in-from-right-4 duration-200",
    style: { height: "100dvh", width: "100vw" },
    children: [
      /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-3 px-4 py-3 border-b border-border shrink-0", children: [
        /* @__PURE__ */ m.jsx(
          "button",
          {
            onClick: t,
            className: "p-1 hover:bg-accent rounded",
            children: /* @__PURE__ */ m.jsx(mS, { size: 20 })
          }
        ),
        /* @__PURE__ */ m.jsx("h2", { className: "text-lg font-light flex-1", children: e }),
        r
      ] }),
      /* @__PURE__ */ m.jsx("div", { className: "flex-1 overflow-y-auto p-4 no-scrollbar", children: n })
    ]
  }
);
function eG(e, t) {
  const n = [];
  for (const a of e.filter((o) => o.isBuiltIn)) {
    let o = t.find((l) => l.id === a.id);
    o || (o = t.find(
      (l) => l.isBuiltIn && l.category === a.category && l.name === a.name
    )), o ? n.push({
      ...o,
      id: a.id
    }) : n.push(a);
  }
  const r = t.filter((a) => !a.isBuiltIn);
  return n.push(...r), n;
}
function tG() {
  const [e, t] = G.useState(j3), [n, r] = G.useState(null), [a, o] = G.useState(null), [l, c] = G.useState(!1), [d, h] = G.useState([...Gh]), [p, g] = G.useState(null), [x, b] = G.useState({}), [C, N] = G.useState({}), [T, j] = G.useState(null), R = G.useCallback(async () => {
    var Je;
    const Pe = await mn.getWorldbookStructure();
    b(Pe);
    const Re = Ta(), Be = (Je = Re == null ? void 0 : Re.getCharWorldbookNames) == null ? void 0 : Je.call(Re, "current");
    if (Be != null && Be.primary) {
      j(Be.primary);
      const ot = await W3.loadState(Be.primary);
      ot.disabledEntries && N(ot.disabledEntries);
    }
  }, []);
  G.useEffect(() => {
    R();
  }, [R]), G.useEffect(() => {
    var Be;
    const Pe = nt.get("apiSettings");
    if (Pe) {
      const Je = j3(), ot = {
        ...Je,
        ...Pe,
        // 
        llmPresets: ((Be = Pe.llmPresets) == null ? void 0 : Be.length) > 0 ? Pe.llmPresets : Je.llmPresets,
        // 
        promptTemplates: eG(
          Je.promptTemplates,
          Pe.promptTemplates || []
        )
      };
      t(ot);
    }
    const Re = nt.getRegexRules();
    Re && Re.length > 0 && h(Re);
  }, []);
  const A = G.useCallback((Pe) => {
    t((Re) => ({ ...Re, selectedPresetId: Pe.id })), r(Pe);
  }, []), z = G.useCallback(() => {
    const Pe = kS(` ${e.llmPresets.length + 1}`);
    Pe.isDefault = !1, t((Re) => ({
      ...Re,
      llmPresets: [...Re.llmPresets, Pe],
      selectedPresetId: Pe.id
    })), r(Pe), c(!0);
  }, [e.llmPresets.length]), q = G.useCallback((Pe) => {
    t((Re) => ({
      ...Re,
      llmPresets: Re.llmPresets.map((Be) => Be.id === Pe.id ? Pe : Be)
    })), r(Pe), c(!0);
  }, []), D = G.useCallback((Pe) => {
    const Re = {
      ...Pe,
      id: `preset_${Date.now()}`,
      name: `${Pe.name} ()`,
      isDefault: !1,
      createdAt: Date.now(),
      updatedAt: Date.now()
    };
    t((Be) => ({ ...Be, llmPresets: [...Be.llmPresets, Re] })), c(!0);
  }, []), P = G.useCallback((Pe) => {
    Pe.isDefault || (t((Re) => ({
      ...Re,
      llmPresets: Re.llmPresets.filter((Be) => Be.id !== Pe.id),
      selectedPresetId: Re.selectedPresetId === Pe.id ? null : Re.selectedPresetId
    })), r((Re) => (Re == null ? void 0 : Re.id) === Pe.id ? null : Re), c(!0));
  }, []), re = G.useCallback((Pe) => {
    o(Pe);
  }, []), ie = G.useCallback((Pe) => {
    t((Re) => ({
      ...Re,
      promptTemplates: [...Re.promptTemplates, Pe]
    })), c(!0);
  }, []), X = G.useCallback((Pe) => {
    t((Re) => ({
      ...Re,
      promptTemplates: Re.promptTemplates.map((Be) => Be.id === Pe.id ? Pe : Be)
    })), o(Pe), c(!0);
  }, []), K = G.useCallback((Pe) => {
    Pe.isBuiltIn || (t((Re) => ({
      ...Re,
      promptTemplates: Re.promptTemplates.filter((Be) => Be.id !== Pe.id)
    })), o((Re) => (Re == null ? void 0 : Re.id) === Pe.id ? null : Re), c(!0));
  }, []), V = G.useCallback((Pe) => {
    t((Re) => ({ ...Re, vectorConfig: Pe })), c(!0);
  }, []), de = G.useCallback((Pe) => {
    t((Re) => ({ ...Re, rerankConfig: Pe })), c(!0);
  }, []), H = G.useCallback((Pe) => {
    t((Re) => ({ ...Re, worldbookConfig: Pe })), c(!0);
  }, []), se = G.useCallback((Pe) => {
    t((Re) => ({ ...Re, regexConfig: Pe })), c(!0);
  }, []), Z = G.useCallback((Pe, Re) => {
    t((Be) => {
      const Je = Be.worldbookConfig.disabledWorldbooks || [];
      let ot;
      return Re ? ot = [.../* @__PURE__ */ new Set([...Je, Pe])] : ot = Je.filter((We) => We !== Pe), {
        ...Be,
        worldbookConfig: {
          ...Be.worldbookConfig,
          disabledWorldbooks: ot
        }
      };
    }), c(!0);
  }, []), fe = G.useCallback((Pe, Re, Be) => {
    N((Je) => {
      const ot = Je[Pe] || [];
      let We;
      return Be ? We = [.../* @__PURE__ */ new Set([...ot, Re])] : We = ot.filter((bt) => bt !== Re), {
        ...Je,
        [Pe]: We
      };
    }), c(!0);
  }, []), he = G.useCallback((Pe) => {
    const Re = d.find((Be) => Be.id === Pe);
    g(Re || null);
  }, [d]), ge = G.useCallback(() => {
    const Pe = {
      id: `rule_${Date.now()}`,
      name: "",
      pattern: "",
      replacement: "",
      enabled: !0,
      flags: "gi",
      scope: "both",
      description: ""
    };
    h((Re) => [...Re, Pe]), g(Pe), c(!0);
  }, []), Q = G.useCallback((Pe) => {
    if (!p) return;
    const Re = { ...p, ...Pe };
    g(Re), h((Be) => Be.map((Je) => Je.id === Re.id ? Re : Je)), c(!0);
  }, [p]), U = G.useCallback((Pe) => {
    h((Re) => Re.map(
      (Be) => Be.id === Pe ? { ...Be, enabled: !Be.enabled } : Be
    )), c(!0);
  }, []), ue = G.useCallback((Pe) => {
    h((Re) => Re.filter((Be) => Be.id !== Pe)), g((Re) => (Re == null ? void 0 : Re.id) === Pe ? null : Re), c(!0);
  }, []), Y = G.useCallback(() => {
    h([...Gh]), g(null), c(!0);
  }, []), le = G.useCallback(async () => {
    nt.set("apiSettings", e), nt.setRegexRules(d), T && await W3.saveState(T, {
      disabledEntries: C
    }), console.log("[Engram] :", e, d, C), c(!1);
  }, [e, d, T, C]), xe = G.useCallback((Pe) => {
    t((Re) => ({
      ...Re,
      recallConfig: Pe
    })), c(!0);
  }, []), Se = G.useCallback(() => {
    const Pe = {
      id: `custom_${Date.now()}`,
      name: "",
      content: "",
      enabled: !0,
      createdAt: Date.now()
    };
    t((Re) => ({
      ...Re,
      customMacros: [...Re.customMacros || [], Pe]
    })), c(!0);
  }, []), Oe = G.useCallback((Pe, Re) => {
    t((Be) => ({
      ...Be,
      customMacros: (Be.customMacros || []).map(
        (Je) => Je.id === Pe ? { ...Je, ...Re } : Je
      )
    })), c(!0);
  }, []), qe = G.useCallback((Pe) => {
    t((Re) => ({
      ...Re,
      customMacros: (Re.customMacros || []).filter((Be) => Be.id !== Pe)
    })), c(!0);
  }, []), Me = G.useCallback((Pe) => {
    t((Re) => ({
      ...Re,
      customMacros: (Re.customMacros || []).map(
        (Be) => Be.id === Pe ? { ...Be, enabled: !Be.enabled } : Be
      )
    })), c(!0);
  }, []);
  return {
    settings: e,
    editingPreset: n,
    editingTemplate: a,
    hasChanges: l,
    regexRules: d,
    editingRule: p,
    selectPreset: A,
    addPreset: z,
    updatePreset: q,
    copyPreset: D,
    deletePreset: P,
    selectTemplate: re,
    addTemplate: ie,
    updateTemplate: X,
    deleteTemplate: K,
    updateVectorConfig: V,
    updateRerankConfig: de,
    updateWorldbookConfig: H,
    updateRegexConfig: se,
    toggleWorldbook: Z,
    toggleEntry: fe,
    refreshWorldbooks: R,
    worldbookStructure: x,
    disabledEntries: C,
    currentCharWorldbook: T,
    updateRecallConfig: xe,
    selectRule: he,
    addRule: ge,
    updateRule: Q,
    toggleRule: U,
    deleteRule: ue,
    resetRules: Y,
    // V0.9.2: 
    addCustomMacro: Se,
    updateCustomMacro: Oe,
    deleteCustomMacro: qe,
    toggleCustomMacro: Me,
    save: le
  };
}
const NE = 768, nG = [
  { id: "llm", label: "LLM ", icon: R1 },
  { id: "vector", label: "", icon: yS },
  { id: "rerank", label: "Rerank", icon: vS }
], rG = ({ initialTab: e }) => {
  var ot;
  const [t, n] = G.useState(e || "model"), [r, a] = G.useState("llm"), [o, l] = G.useState("templates"), [c, d] = G.useState(null), [h, p] = G.useState(window.innerWidth < NE), [g, x] = G.useState(!1);
  G.useEffect(() => {
    const We = () => {
      const bt = window.innerWidth < NE;
      p(bt), bt || x(!1);
    };
    return window.addEventListener("resize", We), () => window.removeEventListener("resize", We);
  }, []);
  const {
    settings: b,
    editingPreset: C,
    editingTemplate: N,
    hasChanges: T,
    regexRules: j,
    editingRule: R,
    selectPreset: A,
    addPreset: z,
    updatePreset: q,
    copyPreset: D,
    deletePreset: P,
    selectTemplate: re,
    addTemplate: ie,
    updateTemplate: X,
    deleteTemplate: K,
    updateVectorConfig: V,
    updateRerankConfig: de,
    updateWorldbookConfig: H,
    updateRegexConfig: se,
    // New!
    selectRule: Z,
    addRule: fe,
    updateRule: he,
    toggleRule: ge,
    deleteRule: Q,
    resetRules: U,
    save: ue,
    toggleWorldbook: Y,
    toggleEntry: le,
    refreshWorldbooks: xe,
    worldbookStructure: Se,
    disabledEntries: Oe,
    // V0.9.2: 
    addCustomMacro: qe,
    updateCustomMacro: Me,
    deleteCustomMacro: Pe,
    toggleCustomMacro: Re
  } = tG(), Be = (We) => {
    We(), h && x(!0);
  }, Je = () => {
    x(!1);
  };
  return h && g && r === "llm" && C ? /* @__PURE__ */ m.jsx(
    Kx,
    {
      title: " LLM ",
      onClose: Je,
      actions: T && /* @__PURE__ */ m.jsx(
        "button",
        {
          className: "p-2 text-primary",
          onClick: ue,
          children: /* @__PURE__ */ m.jsx(Qp, { size: 18 })
        }
      ),
      children: /* @__PURE__ */ m.jsx(wE, { preset: C, onChange: q })
    }
  ) : h && g && t === "prompt" && N ? /* @__PURE__ */ m.jsx(
    Kx,
    {
      title: "",
      onClose: Je,
      actions: T && /* @__PURE__ */ m.jsx(
        "button",
        {
          className: "p-2 text-primary",
          onClick: ue,
          children: /* @__PURE__ */ m.jsx(Qp, { size: 18 })
        }
      ),
      children: /* @__PURE__ */ m.jsx(
        EE,
        {
          template: N,
          llmPresets: b.llmPresets,
          defaultPresetId: b.selectedPresetId,
          onChange: X
        }
      )
    }
  ) : h && g && t === "regex" && R ? /* @__PURE__ */ m.jsx(
    Kx,
    {
      title: "",
      onClose: Je,
      actions: T && /* @__PURE__ */ m.jsx(
        "button",
        {
          className: "p-2 text-primary",
          onClick: ue,
          children: /* @__PURE__ */ m.jsx(Qp, { size: 18 })
        }
      ),
      children: /* @__PURE__ */ m.jsx(kE, { rule: R, onChange: he })
    }
  ) : /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col h-full animate-in fade-in", children: [
    /* @__PURE__ */ m.jsx(
      WS,
      {
        title: "API ",
        subtitle: "",
        className: "mb-2"
      }
    ),
    /* @__PURE__ */ m.jsx(
      G1,
      {
        tabs: [
          { id: "model", label: "" },
          { id: "prompt", label: "" },
          { id: "regex", label: "" },
          { id: "worldbook", label: "" }
        ],
        activeTab: t,
        onChange: (We) => n(We),
        actions: T && /* @__PURE__ */ m.jsxs(
          "button",
          {
            className: "inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-primary hover:text-primary-foreground hover:bg-primary border border-primary/50 rounded transition-colors",
            onClick: ue,
            children: [
              /* @__PURE__ */ m.jsx(Qp, { size: 12 }),
              ""
            ]
          }
        )
      }
    ),
    /* @__PURE__ */ m.jsxs("div", { className: "flex-1 overflow-y-auto no-scrollbar", children: [
      t === "model" && /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col gap-2", children: [
        /* @__PURE__ */ m.jsx(
          pA,
          {
            tabs: nG.map((We) => ({ ...We, icon: /* @__PURE__ */ m.jsx(We.icon, { size: 14 }) })),
            activeTab: r,
            onChange: (We) => a(We),
            sticky: !1,
            top: 0,
            className: "-mx-4 px-4 !mb-4"
          }
        ),
        r === "llm" && /* @__PURE__ */ m.jsxs("div", { className: `flex gap-6 ${h ? "flex-col" : ""}`, children: [
          /* @__PURE__ */ m.jsxs("div", { className: `
                                    flex flex-col gap-4
                                    ${h ? "w-full" : "w-[30%] min-w-[240px] border-r border-border/50 pr-4"}
                                `, children: [
            /* @__PURE__ */ m.jsxs("div", { className: "flex items-center justify-between", children: [
              /* @__PURE__ */ m.jsx("h3", { className: "text-xs font-bold text-muted-foreground uppercase tracking-wider", children: "" }),
              /* @__PURE__ */ m.jsx("button", { className: "text-muted-foreground hover:text-foreground transition-colors", onClick: z, children: /* @__PURE__ */ m.jsx(xS, { size: 16 }) })
            ] }),
            /* @__PURE__ */ m.jsx("div", { className: "flex flex-col gap-1", children: b.llmPresets.map((We) => /* @__PURE__ */ m.jsx(
              IH,
              {
                preset: We,
                isSelected: b.selectedPresetId === We.id,
                onSelect: () => Be(() => A(We)),
                onEdit: () => Be(() => A(We)),
                onCopy: () => D(We),
                onDelete: () => P(We)
              },
              We.id
            )) })
          ] }),
          !h && /* @__PURE__ */ m.jsx("div", { className: "flex-1", children: C ? /* @__PURE__ */ m.jsx("div", { className: "animate-in fade-in slide-in-from-right-2 duration-300", children: /* @__PURE__ */ m.jsx(wE, { preset: C, onChange: q }) }) : /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col items-center justify-center p-12 text-muted-foreground gap-4", children: [
            /* @__PURE__ */ m.jsx(R1, { size: 32, className: "opacity-20" }),
            /* @__PURE__ */ m.jsx("p", { className: "text-sm font-light", children: "" })
          ] }) })
        ] }),
        r === "vector" && /* @__PURE__ */ m.jsx(FH, { config: b.vectorConfig, onChange: V }),
        r === "rerank" && /* @__PURE__ */ m.jsx(UH, { config: b.rerankConfig, onChange: de })
      ] }),
      t === "prompt" && /* @__PURE__ */ m.jsxs("div", { className: `flex gap-6 h-full ${h ? "flex-col" : ""}`, children: [
        /* @__PURE__ */ m.jsxs("div", { className: `
                            ${h ? "w-full" : "w-[30%] min-w-[280px] border-r border-border/50 pr-4"}
                        `, children: [
          /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-2 mb-4", children: [
            /* @__PURE__ */ m.jsx(
              "button",
              {
                onClick: () => l("templates"),
                className: `text-xs font-bold uppercase tracking-wider transition-colors ${o === "templates" ? "text-primary" : "text-muted-foreground hover:text-foreground"}`,
                children: ""
              }
            ),
            /* @__PURE__ */ m.jsx("span", { className: "text-muted-foreground/30", children: "|" }),
            /* @__PURE__ */ m.jsx(
              "button",
              {
                onClick: () => l("macros"),
                className: `text-xs font-bold uppercase tracking-wider transition-colors ${o === "macros" ? "text-primary" : "text-muted-foreground hover:text-foreground"}`,
                children: ""
              }
            )
          ] }),
          o === "templates" ? /* @__PURE__ */ m.jsx(
            VH,
            {
              templates: b.promptTemplates,
              selectedId: (N == null ? void 0 : N.id) || null,
              onSelect: (We) => Be(() => re(We)),
              onAdd: ie,
              onUpdate: X,
              onDelete: K
            }
          ) : /* @__PURE__ */ m.jsx(
            ZH,
            {
              macros: b.customMacros || [],
              selectedId: c,
              onSelect: (We) => Be(() => d(We.id)),
              onAdd: qe,
              onToggle: Re,
              onDelete: Pe
            }
          )
        ] }),
        !h && o === "templates" && /* @__PURE__ */ m.jsx("div", { className: "flex-1 overflow-y-auto no-scrollbar", children: N ? /* @__PURE__ */ m.jsx(
          EE,
          {
            template: N,
            llmPresets: b.llmPresets,
            defaultPresetId: b.selectedPresetId,
            onChange: X
          }
        ) : /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col items-center justify-center p-12 text-muted-foreground gap-4", children: [
          /* @__PURE__ */ m.jsx(em, { size: 32, className: "opacity-20" }),
          /* @__PURE__ */ m.jsx("p", { className: "text-sm font-light", children: "" })
        ] }) }),
        !h && o === "macros" && /* @__PURE__ */ m.jsx("div", { className: "flex-1 overflow-y-auto no-scrollbar", children: (() => {
          const We = (b.customMacros || []).find((bt) => bt.id === c);
          return We ? /* @__PURE__ */ m.jsx(
            JH,
            {
              macro: We,
              onChange: (bt) => Me(We.id, bt)
            }
          ) : /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col items-center justify-center p-12 text-muted-foreground gap-4", children: [
            /* @__PURE__ */ m.jsx(n7, { size: 32, className: "opacity-20" }),
            /* @__PURE__ */ m.jsx("p", { className: "text-sm font-light", children: "" })
          ] });
        })() })
      ] }),
      t === "regex" && /* @__PURE__ */ m.jsxs("div", { className: `flex gap-6 h-full ${h ? "flex-col" : ""}`, children: [
        /* @__PURE__ */ m.jsx("div", { className: `
                            ${h ? "w-full" : "w-[30%] min-w-[280px] border-r border-border/50 pr-4"}
                        `, children: /* @__PURE__ */ m.jsx(
          WH,
          {
            rules: j,
            selectedId: (R == null ? void 0 : R.id) || null,
            onSelect: (We) => Be(() => Z(We)),
            onToggle: ge,
            onDelete: Q,
            onAdd: fe,
            onReset: U,
            enableNativeRegex: ((ot = b.regexConfig) == null ? void 0 : ot.enableNativeRegex) ?? !0,
            onToggleNativeRegex: (We) => se({
              ...b.regexConfig,
              enableNativeRegex: We
            })
          }
        ) }),
        !h && /* @__PURE__ */ m.jsx("div", { className: "flex-1 overflow-y-auto no-scrollbar", children: R ? /* @__PURE__ */ m.jsx(kE, { rule: R, onChange: he }) : /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col items-center justify-center p-12 text-muted-foreground gap-4", children: [
          /* @__PURE__ */ m.jsx(s7, { size: 32, className: "opacity-20" }),
          /* @__PURE__ */ m.jsx("p", { className: "text-sm font-light", children: "" })
        ] }) })
      ] }),
      t === "worldbook" && /* @__PURE__ */ m.jsx("div", { className: "max-w-2xl py-4", children: /* @__PURE__ */ m.jsx(
        QH,
        {
          config: b.worldbookConfig,
          onChange: H,
          worldbookStructure: Se,
          disabledEntries: Oe,
          onToggleWorldbook: Y,
          onToggleEntry: le,
          onRefresh: xe
        }
      ) })
    ] })
  ] });
}, iG = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  APIPresets: rG
}, Symbol.toStringTag, { value: "Module" })), aG = () => {
  const [e, t] = G.useState("claudeDark");
  G.useEffect(() => {
    t(gc.getTheme());
  }, []);
  const n = (a) => {
    gc.setTheme(a), nt.set("theme", a), t(a);
  }, r = Object.entries(Vy).map(([a, o]) => {
    let l = o.colors.background, c = o.colors.primary;
    return {
      id: a,
      name: o.name,
      background: l,
      sidebar: o.colors.sidebar,
      // Add sidebar color
      primary: c
    };
  });
  return /* @__PURE__ */ m.jsxs("div", { className: "space-y-4", children: [
    /* @__PURE__ */ m.jsx("h3", { className: "text-lg font-medium", children: "" }),
    /* @__PURE__ */ m.jsx("div", { className: "grid grid-cols-2 sm:grid-cols-4 gap-4", children: r.map((a) => /* @__PURE__ */ m.jsxs(
      "button",
      {
        onClick: () => n(a.id),
        className: `
                            relative group flex flex-col items-center gap-2 p-3 rounded-xl border-2 transition-all
                            ${e === a.id ? "border-primary bg-accent/10" : "border-transparent hover:bg-accent/5"}
                        `,
        children: [
          /* @__PURE__ */ m.jsxs("div", { className: "flex items-center justify-center -space-x-3 mb-2", children: [
            /* @__PURE__ */ m.jsx(
              "div",
              {
                className: "w-8 h-8 rounded-full border border-border shadow-sm z-10",
                style: { background: a.background },
                title: "Background"
              }
            ),
            /* @__PURE__ */ m.jsx(
              "div",
              {
                className: "w-8 h-8 rounded-full border border-border shadow-sm z-20",
                style: { background: a.sidebar },
                title: "Sidebar"
              }
            ),
            /* @__PURE__ */ m.jsx(
              "div",
              {
                className: "w-8 h-8 rounded-full border border-border shadow-sm z-30 ring-2 ring-background",
                style: { background: a.primary },
                title: "Primary"
              }
            )
          ] }),
          /* @__PURE__ */ m.jsx("span", { className: `text-sm font-medium ${e === a.id ? "text-primary" : "text-muted-foreground"}`, children: a.name }),
          e === a.id && /* @__PURE__ */ m.jsx("div", { className: "absolute top-2 right-2 w-2 h-2 rounded-full bg-primary" })
        ]
      },
      a.id
    )) })
  ] });
}, sG = () => {
  var c, d, h, p, g, x;
  const [e, t] = G.useState(((c = nt.getSettings().summarizerConfig) == null ? void 0 : c.previewEnabled) ?? !0), [n, r] = G.useState(((d = nt.getSettings().preprocessingConfig) == null ? void 0 : d.preview) ?? yg.preview), [, a] = G.useState({});
  G.useEffect(() => {
    nt.loadSettings();
  }, []);
  const [o, l] = G.useState(nt.getSettings().linkedDeletion);
  return /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col h-full animate-in fade-in", children: [
    /* @__PURE__ */ m.jsx(WS, { title: "", subtitle: "" }),
    /* @__PURE__ */ m.jsxs("div", { className: "p-6 space-y-8", children: [
      /* @__PURE__ */ m.jsxs("section", { children: [
        /* @__PURE__ */ m.jsx("h3", { className: "text-sm font-medium text-muted-foreground uppercase tracking-wider mb-4", children: "" }),
        /* @__PURE__ */ m.jsx(aG, {})
      ] }),
      /* @__PURE__ */ m.jsxs("section", { children: [
        /* @__PURE__ */ m.jsx("h3", { className: "text-sm font-medium text-muted-foreground uppercase tracking-wider mb-4", children: " (Glass Effect)" }),
        /* @__PURE__ */ m.jsxs("div", { className: "bg-muted/30 border border-border rounded-lg p-4 space-y-6", children: [
          /* @__PURE__ */ m.jsxs("div", { className: "flex items-center justify-between gap-3", children: [
            /* @__PURE__ */ m.jsx("div", { className: "flex items-center gap-3 min-w-0 flex-1", children: /* @__PURE__ */ m.jsxs("div", { className: "min-w-0 flex-1", children: [
              /* @__PURE__ */ m.jsx("h4", { className: "font-medium text-foreground truncate", children: "" }),
              /* @__PURE__ */ m.jsx("p", { className: "text-sm text-muted-foreground line-clamp-2", children: "" })
            ] }) }),
            /* @__PURE__ */ m.jsx(
              Kr,
              {
                checked: ((h = nt.getSettings().glassSettings) == null ? void 0 : h.enabled) ?? !0,
                onChange: (b) => {
                  const N = {
                    ...nt.getSettings().glassSettings,
                    enabled: b
                  };
                  nt.set("glassSettings", N), Promise.resolve().then(() => Yy).then(({ ThemeManager: T }) => {
                    T.setTheme(T.getTheme());
                  }), a({});
                }
              }
            )
          ] }),
          (((p = nt.getSettings().glassSettings) == null ? void 0 : p.enabled) ?? !0) && /* @__PURE__ */ m.jsxs(m.Fragment, { children: [
            /* @__PURE__ */ m.jsx(
              ni,
              {
                label: " (Opacity)",
                description: "",
                value: ((g = nt.getSettings().glassSettings) == null ? void 0 : g.opacity) ?? 0.8,
                onChange: (b) => {
                  const N = {
                    ...nt.getSettings().glassSettings,
                    opacity: b
                  };
                  nt.set("glassSettings", N), Promise.resolve().then(() => Yy).then(({ ThemeManager: T }) => {
                    T.setTheme(T.getTheme());
                  }), a({});
                },
                min: 0,
                max: 1,
                step: 0.05,
                showSlider: !0
              }
            ),
            /* @__PURE__ */ m.jsx(
              ni,
              {
                label: " (Blur)",
                description: " (px)",
                value: ((x = nt.getSettings().glassSettings) == null ? void 0 : x.blur) ?? 10,
                onChange: (b) => {
                  const N = {
                    ...nt.getSettings().glassSettings,
                    blur: b
                  };
                  nt.set("glassSettings", N), Promise.resolve().then(() => Yy).then(({ ThemeManager: T }) => {
                    T.setTheme(T.getTheme());
                  }), a({});
                },
                min: 0,
                max: 50,
                step: 1,
                showSlider: !0
              }
            )
          ] })
        ] })
      ] }),
      /* @__PURE__ */ m.jsxs("section", { children: [
        /* @__PURE__ */ m.jsx("h3", { className: "text-sm font-medium text-muted-foreground uppercase tracking-wider mb-4", children: "" }),
        /* @__PURE__ */ m.jsx("div", { className: "bg-muted/30 border border-border rounded-lg p-4", children: /* @__PURE__ */ m.jsxs("div", { className: "flex items-center justify-between gap-3", children: [
          /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-3 min-w-0 flex-1", children: [
            /* @__PURE__ */ m.jsx("div", { className: "p-2 rounded-lg bg-primary/10 text-primary flex-shrink-0", children: /* @__PURE__ */ m.jsx(V5, { size: 20 }) }),
            /* @__PURE__ */ m.jsxs("div", { className: "min-w-0 flex-1", children: [
              /* @__PURE__ */ m.jsx("h4", { className: "font-medium text-foreground truncate", children: "" }),
              /* @__PURE__ */ m.jsx("p", { className: "text-sm text-muted-foreground line-clamp-2", children: "" })
            ] })
          ] }),
          /* @__PURE__ */ m.jsx(
            Kr,
            {
              checked: e,
              onChange: (b) => {
                t(b), cl.updateConfig({ previewEnabled: b });
              }
            }
          )
        ] }) })
      ] }),
      /* @__PURE__ */ m.jsxs("section", { children: [
        /* @__PURE__ */ m.jsx("h3", { className: "text-sm font-medium text-muted-foreground uppercase tracking-wider mb-4", children: "" }),
        /* @__PURE__ */ m.jsx("div", { className: "bg-muted/30 border border-border rounded-lg p-4", children: /* @__PURE__ */ m.jsxs("div", { className: "flex items-center justify-between gap-3", children: [
          /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-3 min-w-0 flex-1", children: [
            /* @__PURE__ */ m.jsx("div", { className: "p-2 rounded-lg bg-primary/10 text-primary flex-shrink-0", children: /* @__PURE__ */ m.jsx(V5, { size: 20 }) }),
            /* @__PURE__ */ m.jsxs("div", { className: "min-w-0 flex-1", children: [
              /* @__PURE__ */ m.jsx("h4", { className: "font-medium text-foreground truncate", children: "" }),
              /* @__PURE__ */ m.jsx("p", { className: "text-sm text-muted-foreground line-clamp-2", children: "" })
            ] })
          ] }),
          /* @__PURE__ */ m.jsx(
            Kr,
            {
              checked: n,
              onChange: (b) => {
                r(b);
                const C = Qf.getConfig();
                Qf.saveConfig({ ...C, preview: b });
              }
            }
          )
        ] }) })
      ] }),
      /* @__PURE__ */ m.jsxs("section", { children: [
        /* @__PURE__ */ m.jsx("h3", { className: "text-sm font-medium text-muted-foreground uppercase tracking-wider mb-4", children: "" }),
        /* @__PURE__ */ m.jsxs("div", { className: "bg-muted/30 border border-border rounded-lg p-4 space-y-4", children: [
          /* @__PURE__ */ m.jsxs("div", { className: "flex items-center justify-between gap-3", children: [
            /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-3 min-w-0 flex-1", children: [
              /* @__PURE__ */ m.jsx("div", { className: "p-2 rounded-lg bg-red-500/10 text-red-500 flex-shrink-0", children: /* @__PURE__ */ m.jsx(po, { size: 20 }) }),
              /* @__PURE__ */ m.jsxs("div", { className: "min-w-0 flex-1", children: [
                /* @__PURE__ */ m.jsx("h4", { className: "font-medium text-foreground truncate", children: "" }),
                /* @__PURE__ */ m.jsx("p", { className: "text-sm text-muted-foreground line-clamp-2", children: "/" })
              ] })
            ] }),
            /* @__PURE__ */ m.jsx(
              Kr,
              {
                checked: o.enabled,
                onChange: (b) => {
                  const C = { ...o, enabled: b };
                  l(C), nt.set("linkedDeletion", C);
                }
              }
            )
          ] }),
          o.enabled && /* @__PURE__ */ m.jsxs("div", { className: "pl-14 space-y-3 border-t border-border pt-3", children: [
            /* @__PURE__ */ m.jsxs("div", { className: "flex items-center justify-between", children: [
              /* @__PURE__ */ m.jsx("span", { className: "text-sm text-muted-foreground", children: "" }),
              /* @__PURE__ */ m.jsx(
                Kr,
                {
                  checked: o.showConfirmation,
                  onChange: (b) => {
                    const C = { ...o, showConfirmation: b };
                    l(C), nt.set("linkedDeletion", C);
                  },
                  className: "scale-90"
                }
              )
            ] }),
            /* @__PURE__ */ m.jsxs("div", { className: "flex items-center justify-between gap-3", children: [
              /* @__PURE__ */ m.jsxs("div", { className: "min-w-0 flex-1", children: [
                /* @__PURE__ */ m.jsx("span", { className: "text-sm text-muted-foreground block truncate", children: " Worldbook" }),
                /* @__PURE__ */ m.jsx("p", { className: "text-xs text-muted-foreground/60 line-clamp-2", children: ":  Worldbook " })
              ] }),
              /* @__PURE__ */ m.jsx(
                Kr,
                {
                  checked: o.deleteChatWorldbook ?? !1,
                  onChange: (b) => {
                    const C = { ...o, deleteChatWorldbook: b };
                    l(C), nt.set("linkedDeletion", C);
                  },
                  className: "scale-90"
                }
              )
            ] })
          ] })
        ] }),
        /* @__PURE__ */ m.jsx(oG, {})
      ] }),
      /* @__PURE__ */ m.jsx("div", { className: "mt-8 pt-8 border-t border-border", children: /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col items-center justify-center text-muted-foreground gap-2 py-8 opacity-50", children: [
        /* @__PURE__ */ m.jsx(s1, { size: 32 }),
        /* @__PURE__ */ m.jsx("p", { className: "text-sm", children: "..." })
      ] }) })
    ] })
  ] });
}, oG = () => {
  const [e, t] = G.useState(nt.getSettings().syncConfig || { enabled: !1, autoSync: !0 }), [n, r] = G.useState("idle"), [a, o] = G.useState(0), l = (d) => (h) => {
    const p = { ...e, [d]: h };
    t(p), nt.set("syncConfig", p);
  }, c = async () => {
    try {
      r("check");
      const { getSTContext: d } = await Promise.resolve().then(() => _I);
      if (!d().chatId) {
        alert(""), r("idle");
        return;
      }
      const h = d().chatId;
      r("syncing");
      const { syncService: p } = await Promise.resolve().then(() => AI);
      await p.upload(h) ? (r("success"), o(Date.now()), setTimeout(() => r("idle"), 3e3)) : r("error");
    } catch (d) {
      console.error(d), r("error");
    }
  };
  return /* @__PURE__ */ m.jsxs("div", { className: "bg-muted/30 border border-border rounded-lg p-4 mt-4", children: [
    /* @__PURE__ */ m.jsxs("div", { className: "flex items-center justify-between gap-3 mb-4", children: [
      /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-3 min-w-0 flex-1", children: [
        /* @__PURE__ */ m.jsx("div", { className: "p-2 rounded-lg bg-blue-500/10 text-blue-500 flex-shrink-0", children: /* @__PURE__ */ m.jsxs("svg", { width: "20", height: "20", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", children: [
          /* @__PURE__ */ m.jsx("path", { d: "M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8" }),
          /* @__PURE__ */ m.jsx("path", { d: "M3 3v5h5" }),
          /* @__PURE__ */ m.jsx("path", { d: "M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16" }),
          /* @__PURE__ */ m.jsx("path", { d: "M16 16h5v5" })
        ] }) }),
        /* @__PURE__ */ m.jsxs("div", { className: "min-w-0 flex-1", children: [
          /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-2", children: [
            /* @__PURE__ */ m.jsx("h4", { className: "font-medium text-foreground truncate", children: " (Beta)" }),
            n === "syncing" && /* @__PURE__ */ m.jsx("span", { className: "text-xs text-blue-500 animate-pulse", children: "..." }),
            n === "success" && /* @__PURE__ */ m.jsx("span", { className: "text-xs text-green-500", children: "" }),
            n === "error" && /* @__PURE__ */ m.jsx("span", { className: "text-xs text-red-500", children: "" })
          ] }),
          /* @__PURE__ */ m.jsx("p", { className: "text-sm text-muted-foreground line-clamp-2", children: " WebLLM " })
        ] })
      ] }),
      /* @__PURE__ */ m.jsx(
        Kr,
        {
          checked: e.enabled,
          onChange: l("enabled")
        }
      )
    ] }),
    e.enabled && /* @__PURE__ */ m.jsxs("div", { className: "pl-14 space-y-3 border-t border-border pt-3", children: [
      /* @__PURE__ */ m.jsxs("div", { className: "flex items-center justify-between", children: [
        /* @__PURE__ */ m.jsxs("div", { className: "min-w-0 flex-1", children: [
          /* @__PURE__ */ m.jsx("span", { className: "text-sm text-muted-foreground", children: "" }),
          /* @__PURE__ */ m.jsx("p", { className: "text-xs text-muted-foreground/60", children: "3" })
        ] }),
        /* @__PURE__ */ m.jsx(
          Kr,
          {
            checked: e.autoSync,
            onChange: l("autoSync"),
            className: "scale-90"
          }
        )
      ] }),
      /* @__PURE__ */ m.jsxs("div", { className: "flex items-center justify-between", children: [
        /* @__PURE__ */ m.jsxs("div", { className: "min-w-0 flex-1", children: [
          /* @__PURE__ */ m.jsx("span", { className: "text-sm text-muted-foreground", children: "" }),
          /* @__PURE__ */ m.jsx("p", { className: "text-xs text-muted-foreground/60", children: a > 0 ? new Date(a).toLocaleString() : "" })
        ] }),
        /* @__PURE__ */ m.jsx(
          "button",
          {
            onClick: c,
            disabled: n === "syncing",
            className: "px-3 py-1.5 text-xs font-medium rounded-md bg-background border border-border hover:bg-muted transition-colors disabled:opacity-50",
            children: ""
          }
        )
      ] }),
      /* @__PURE__ */ m.jsxs("div", { className: "mt-2 text-xs text-muted-foreground/60 p-2 bg-background/50 rounded", children: [
        /* @__PURE__ */ m.jsx("p", { children: " Beta " }),
        /* @__PURE__ */ m.jsxs("ul", { className: "list-disc pl-4 mt-1 space-y-1", children: [
          /* @__PURE__ */ m.jsx("li", { children: ": `data/default-user/vectors/webllm`" }),
          /* @__PURE__ */ m.jsx("li", { children: '""' }),
          /* @__PURE__ */ m.jsx("li", { children: "" })
        ] })
      ] })
    ] })
  ] });
}, lG = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  Settings: sG
}, Symbol.toStringTag, { value: "Module" }));
function uG({ score: e }) {
  const t = Math.round(e * 5);
  return /* @__PURE__ */ m.jsx("div", { className: "flex gap-0.5", children: [0, 1, 2, 3, 4].map((n) => /* @__PURE__ */ m.jsx(
    "span",
    {
      className: `w-1.5 h-1.5 rounded-full ${n < t ? "bg-primary" : "bg-muted"}`
    },
    n
  )) });
}
function cG({ isEmbedded: e }) {
  return e ? /* @__PURE__ */ m.jsxs(
    "span",
    {
      className: "inline-flex items-center gap-0.5 px-1.5 py-0.5 bg-primary/10 text-primary rounded text-[10px] font-medium",
      title: "",
      children: [
        /* @__PURE__ */ m.jsx(od, { size: 10 }),
        /* @__PURE__ */ m.jsx("span", { children: "" })
      ]
    }
  ) : null;
}
function fG({ event: e }) {
  const t = e.structured_kv, n = [];
  return t.time_anchor && n.push(t.time_anchor), t.location && n.push(t.location), t.role && t.role.length > 0 && n.push(t.role.join(", ")), n.length === 0 ? null : /* @__PURE__ */ m.jsxs("p", { className: "text-xs text-muted-foreground truncate", children: [
    "(",
    n.join(" | "),
    ")"
  ] });
}
const dG = ({
  event: e,
  isSelected: t = !1,
  isCompact: n = !1,
  onSelect: r,
  onCheck: a,
  checked: o = !1,
  hasChanges: l = !1
}) => {
  var g;
  const c = e.structured_kv, d = e.summary.split(`
`), h = c.event || ((g = d[0]) == null ? void 0 : g.replace(/:\s*$/, "")) || "", p = d.length > 1 ? d.slice(1).join(" ").trim() : e.summary;
  return n ? /* @__PURE__ */ m.jsxs(
    "div",
    {
      className: `
                    flex items-center gap-3 p-3 cursor-pointer
                    border-b border-border
                    transition-colors duration-150
                    ${t ? "border-l-2 border-l-primary bg-transparent" : "hover:bg-accent/30"}
                `,
      onClick: r,
      children: [
        /* @__PURE__ */ m.jsx(
          "input",
          {
            type: "checkbox",
            checked: o,
            onChange: (x) => {
              x.stopPropagation(), a == null || a(x.target.checked);
            },
            className: "w-4 h-4 rounded border-border accent-primary"
          }
        ),
        /* @__PURE__ */ m.jsxs("div", { className: "flex-1 min-w-0", children: [
          /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-2", children: [
            /* @__PURE__ */ m.jsx("span", { className: "text-xs font-medium text-primary", children: h }),
            e.is_embedded && /* @__PURE__ */ m.jsx(od, { size: 10, className: "text-primary" }),
            /* @__PURE__ */ m.jsx("span", { className: "text-xs text-muted-foreground", children: e.significance_score.toFixed(1) })
          ] }),
          /* @__PURE__ */ m.jsxs("p", { className: "text-sm text-foreground truncate mt-1", children: [
            p.substring(0, 50),
            "..."
          ] })
        ] }),
        /* @__PURE__ */ m.jsx(Jh, { size: 16, className: "text-muted-foreground" })
      ]
    }
  ) : /* @__PURE__ */ m.jsxs(
    "div",
    {
      className: `
                p-4 cursor-pointer rounded-lg
                transition-all duration-150
                ${t ? "border border-primary bg-transparent" : "border border-transparent hover:border-border/50"}
            `,
      onClick: r,
      children: [
        /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-3 mb-2", children: [
          /* @__PURE__ */ m.jsx(
            "input",
            {
              type: "checkbox",
              checked: o,
              onChange: (x) => {
                x.stopPropagation(), a == null || a(x.target.checked);
              },
              className: "w-4 h-4 rounded border-border accent-primary"
            }
          ),
          /* @__PURE__ */ m.jsx("span", { className: "text-xs font-medium text-primary", children: h }),
          /* @__PURE__ */ m.jsx(cG, { isEmbedded: e.is_embedded }),
          l && /* @__PURE__ */ m.jsx("span", { className: "w-2 h-2 rounded-full bg-yellow-500", title: "" }),
          /* @__PURE__ */ m.jsx("div", { className: "flex-1" }),
          /* @__PURE__ */ m.jsx(uG, { score: e.significance_score })
        ] }),
        /* @__PURE__ */ m.jsx(fG, { event: e }),
        /* @__PURE__ */ m.jsx("p", { className: "text-sm text-foreground mt-1 line-clamp-2", children: p }),
        /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-2 mt-2 text-xs text-muted-foreground", children: [
          /* @__PURE__ */ m.jsxs("span", { children: [
            "Level ",
            e.level
          ] }),
          e.source_range && /* @__PURE__ */ m.jsxs(m.Fragment, { children: [
            /* @__PURE__ */ m.jsx("span", { children: "" }),
            /* @__PURE__ */ m.jsxs("span", { children: [
              ": ",
              e.source_range.start_index,
              "-",
              e.source_range.end_index,
              ""
            ] })
          ] })
        ] })
      ]
    }
  );
}, Lh = {
  background: "transparent",
  backgroundColor: "transparent",
  border: "none",
  borderBottom: "1px solid var(--border)",
  borderRadius: 0,
  boxShadow: "none",
  outline: "none",
  padding: "8px 0",
  fontSize: "14px",
  width: "100%",
  color: "var(--foreground, inherit)"
};
({
  ...Lh
});
function jE(e) {
  const t = [];
  return e.time_anchor && e.location ? t.push(`${e.time_anchor}${e.location}`) : e.time_anchor ? t.push(`${e.time_anchor}`) : e.location && t.push(`${e.location}`), e.role && e.role.length > 0 && t.push(e.role.join("")), e.event && t.push(e.event), e.logic && e.logic.length > 0 && t.push(`(${e.logic.join("/")})`), t.join(" ");
}
const Z3 = G.forwardRef(({
  event: e,
  isFullScreen: t = !1,
  onSave: n,
  onDelete: r,
  onClose: a
}, o) => {
  const [l, c] = G.useState(""), [d, h] = G.useState(""), [p, g] = G.useState(""), [x, b] = G.useState(""), [C, N] = G.useState(""), [T, j] = G.useState(""), [R, A] = G.useState(0.5), [z, q] = G.useState(!1), [D, P] = G.useState(null);
  G.useEffect(() => {
    var H, se;
    e && e.id !== D && (c(e.summary), h(e.structured_kv.event || ""), g(e.structured_kv.time_anchor || ""), b(e.structured_kv.location || ""), N(((H = e.structured_kv.role) == null ? void 0 : H.join(", ")) || ""), j(((se = e.structured_kv.logic) == null ? void 0 : se.join(", ")) || ""), A(e.significance_score), q(!1), P(e.id));
  }, [e, D]);
  const re = G.useCallback(() => {
    var Z;
    const H = {
      event: d,
      time_anchor: p,
      location: x,
      role: C.split(",").map((fe) => fe.trim()).filter(Boolean),
      logic: T.split(",").map((fe) => fe.trim()).filter(Boolean),
      causality: ((Z = e == null ? void 0 : e.structured_kv) == null ? void 0 : Z.causality) || ""
    };
    return {
      summary: jE(H) || l,
      structured_kv: {
        ...(e == null ? void 0 : e.structured_kv) || {},
        ...H
      },
      significance_score: R
    };
  }, [e, d, p, x, C, T, R, l]), ie = G.useCallback(() => {
    e && (q(!0), setTimeout(() => {
      const H = re();
      n == null || n(e.id, H);
    }, 0));
  }, [e, re, n]);
  G.useImperativeHandle(o, () => ({
    save: ie,
    isDirty: () => z
  }), [ie, z]);
  const X = () => {
    confirm("") && (r == null || r(e.id));
  }, K = (H, se) => {
    H(se), setTimeout(ie, 10);
  }, V = (H) => {
    A(H), setTimeout(ie, 10);
  };
  if (!e)
    return /* @__PURE__ */ m.jsx("div", { className: "flex flex-col items-center justify-center h-full text-muted-foreground gap-2 p-8", children: /* @__PURE__ */ m.jsx("p", { className: "text-sm font-light", children: "" }) });
  const de = /* @__PURE__ */ m.jsxs(m.Fragment, { children: [
    /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col gap-1", children: [
      /* @__PURE__ */ m.jsx("label", { className: "text-xs text-muted-foreground", children: "" }),
      /* @__PURE__ */ m.jsx(
        "input",
        {
          type: "text",
          value: d,
          onChange: (H) => K(h, H.target.value),
          style: Lh,
          className: "placeholder:text-muted-foreground/40 focus:border-primary transition-colors",
          placeholder: ""
        }
      )
    ] }),
    /* @__PURE__ */ m.jsx(
      mi,
      {
        label: " ()",
        value: jE({
          event: d,
          time_anchor: p,
          location: x,
          role: C.split(",").map((H) => H.trim()).filter(Boolean),
          logic: T.split(",").map((H) => H.trim()).filter(Boolean)
        }),
        onChange: () => {
        },
        multiline: !0,
        rows: 4,
        readOnly: !0,
        placeholder: "...",
        className: "font-mono text-sm"
      }
    ),
    /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col gap-1", children: [
      /* @__PURE__ */ m.jsx("label", { className: "text-xs text-muted-foreground", children: "" }),
      /* @__PURE__ */ m.jsx(
        "input",
        {
          type: "text",
          value: p,
          onChange: (H) => K(g, H.target.value),
          style: Lh,
          className: "placeholder:text-muted-foreground/40 focus:border-primary transition-colors",
          placeholder: "102344"
        }
      )
    ] }),
    /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col gap-1", children: [
      /* @__PURE__ */ m.jsx("label", { className: "text-xs text-muted-foreground", children: "" }),
      /* @__PURE__ */ m.jsx(
        "input",
        {
          type: "text",
          value: x,
          onChange: (H) => K(b, H.target.value),
          style: Lh,
          className: "placeholder:text-muted-foreground/40 focus:border-primary transition-colors",
          placeholder: ""
        }
      )
    ] }),
    /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col gap-1", children: [
      /* @__PURE__ */ m.jsx("label", { className: "text-xs text-muted-foreground", children: "" }),
      /* @__PURE__ */ m.jsx(
        "input",
        {
          type: "text",
          value: C,
          onChange: (H) => K(N, H.target.value),
          style: Lh,
          className: "placeholder:text-muted-foreground/40 focus:border-primary transition-colors",
          placeholder: "{{user}}, "
        }
      )
    ] }),
    /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col gap-1", children: [
      /* @__PURE__ */ m.jsx("label", { className: "text-xs text-muted-foreground", children: "" }),
      /* @__PURE__ */ m.jsx(
        "input",
        {
          type: "text",
          value: T,
          onChange: (H) => K(j, H.target.value),
          style: Lh,
          className: "placeholder:text-muted-foreground/40 focus:border-primary transition-colors",
          placeholder: ", "
        }
      )
    ] }),
    /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col gap-2", children: [
      /* @__PURE__ */ m.jsxs("div", { className: "flex justify-between items-center", children: [
        /* @__PURE__ */ m.jsx("label", { className: "text-xs text-muted-foreground", children: "" }),
        /* @__PURE__ */ m.jsx("span", { className: "text-xs font-mono text-foreground", children: R.toFixed(2) })
      ] }),
      /* @__PURE__ */ m.jsxs("div", { className: "relative h-4 flex items-center group cursor-pointer", children: [
        /* @__PURE__ */ m.jsx(
          "div",
          {
            className: "absolute inset-x-0 h-[1px]",
            style: { backgroundColor: "var(--border)" }
          }
        ),
        /* @__PURE__ */ m.jsx(
          "div",
          {
            className: "absolute top-1/2 -translate-y-1/2 w-2.5 h-2.5 bg-muted-foreground/80 rounded-full shadow-sm pointer-events-none transition-transform duration-75 ease-out group-hover:scale-125 group-hover:bg-foreground",
            style: { left: `${R * 100}%`, transform: "translate(-50%, -50%)" }
          }
        ),
        /* @__PURE__ */ m.jsx(
          "input",
          {
            type: "range",
            min: "0",
            max: "1",
            step: "0.05",
            value: R,
            onChange: (H) => V(parseFloat(H.target.value)),
            className: "absolute inset-x-0 w-full h-full opacity-0 cursor-pointer z-10 m-0",
            style: { appearance: "none", WebkitAppearance: "none" }
          }
        )
      ] })
    ] }),
    /* @__PURE__ */ m.jsx(Nr, { spacing: "md" }),
    /* @__PURE__ */ m.jsxs("div", { className: "space-y-1 text-xs text-muted-foreground", children: [
      /* @__PURE__ */ m.jsxs("p", { children: [
        "ID: ",
        /* @__PURE__ */ m.jsxs("span", { className: "font-mono", children: [
          e.id.substring(0, 8),
          "..."
        ] })
      ] }),
      /* @__PURE__ */ m.jsxs("p", { children: [
        "Level: ",
        e.level
      ] }),
      e.source_range && /* @__PURE__ */ m.jsxs("p", { children: [
        ": ",
        e.source_range.start_index,
        "-",
        e.source_range.end_index,
        ""
      ] }),
      /* @__PURE__ */ m.jsxs("p", { children: [
        ": ",
        new Date(e.timestamp).toLocaleString()
      ] }),
      /* @__PURE__ */ m.jsxs("p", { children: [
        ":",
        e.is_archived && /* @__PURE__ */ m.jsx("span", { className: "ml-1 text-yellow-500", children: "" }),
        e.is_embedded && /* @__PURE__ */ m.jsx("span", { className: "ml-1 text-green-500", children: "" }),
        !e.is_archived && !e.is_embedded && /* @__PURE__ */ m.jsx("span", { className: "ml-1", children: "" })
      ] })
    ] })
  ] });
  return t ? /* @__PURE__ */ m.jsxs("div", { className: "fixed inset-0 bg-background z-50 flex flex-col", style: { height: "100dvh" }, children: [
    /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-3 px-4 py-3 border-b border-border shrink-0", children: [
      /* @__PURE__ */ m.jsx(
        "button",
        {
          onClick: a,
          className: "p-1 hover:bg-accent rounded",
          children: /* @__PURE__ */ m.jsx(mS, { size: 20 })
        }
      ),
      /* @__PURE__ */ m.jsx("h2", { className: "text-lg font-light flex-1", children: "" }),
      /* @__PURE__ */ m.jsx(
        "button",
        {
          onClick: X,
          className: "p-2 text-destructive hover:bg-destructive/10 rounded",
          children: /* @__PURE__ */ m.jsx(po, { size: 18 })
        }
      )
    ] }),
    /* @__PURE__ */ m.jsx("div", { className: "flex-1 overflow-y-auto p-4 space-y-4", children: de }),
    /* @__PURE__ */ m.jsx("div", { className: "p-4 border-t border-border shrink-0", children: /* @__PURE__ */ m.jsx(
      "button",
      {
        onClick: a,
        className: "w-full py-2 text-sm border border-border rounded-md hover:bg-accent",
        children: ""
      }
    ) })
  ] }) : /* @__PURE__ */ m.jsxs("div", { className: "h-full flex flex-col", children: [
    /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-2 pb-4 border-b border-border shrink-0", children: [
      /* @__PURE__ */ m.jsx("h3", { className: "text-sm font-medium text-primary flex-1", children: "" }),
      /* @__PURE__ */ m.jsx(
        "button",
        {
          onClick: X,
          className: "p-1.5 text-destructive hover:bg-destructive/10 rounded",
          title: "",
          children: /* @__PURE__ */ m.jsx(po, { size: 16 })
        }
      )
    ] }),
    /* @__PURE__ */ m.jsx("div", { className: "flex-1 overflow-y-auto py-4 space-y-4 no-scrollbar", children: de })
  ] });
});
Z3.displayName = "EventEditor";
function Dr(e) {
  if (typeof e == "string" || typeof e == "number") return "" + e;
  let t = "";
  if (Array.isArray(e))
    for (let n = 0, r; n < e.length; n++)
      (r = Dr(e[n])) !== "" && (t += (t && " ") + r);
  else
    for (let n in e)
      e[n] && (t += (t && " ") + n);
  return t;
}
var hG = { value: () => {
} };
function V1() {
  for (var e = 0, t = arguments.length, n = {}, r; e < t; ++e) {
    if (!(r = arguments[e] + "") || r in n || /[\s.]/.test(r)) throw new Error("illegal type: " + r);
    n[r] = [];
  }
  return new Jy(n);
}
function Jy(e) {
  this._ = e;
}
function mG(e, t) {
  return e.trim().split(/^|\s+/).map(function(n) {
    var r = "", a = n.indexOf(".");
    if (a >= 0 && (r = n.slice(a + 1), n = n.slice(0, a)), n && !t.hasOwnProperty(n)) throw new Error("unknown type: " + n);
    return { type: n, name: r };
  });
}
Jy.prototype = V1.prototype = {
  constructor: Jy,
  on: function(e, t) {
    var n = this._, r = mG(e + "", n), a, o = -1, l = r.length;
    if (arguments.length < 2) {
      for (; ++o < l; ) if ((a = (e = r[o]).type) && (a = pG(n[a], e.name))) return a;
      return;
    }
    if (t != null && typeof t != "function") throw new Error("invalid callback: " + t);
    for (; ++o < l; )
      if (a = (e = r[o]).type) n[a] = TE(n[a], e.name, t);
      else if (t == null) for (a in n) n[a] = TE(n[a], e.name, null);
    return this;
  },
  copy: function() {
    var e = {}, t = this._;
    for (var n in t) e[n] = t[n].slice();
    return new Jy(e);
  },
  call: function(e, t) {
    if ((a = arguments.length - 2) > 0) for (var n = new Array(a), r = 0, a, o; r < a; ++r) n[r] = arguments[r + 2];
    if (!this._.hasOwnProperty(e)) throw new Error("unknown type: " + e);
    for (o = this._[e], r = 0, a = o.length; r < a; ++r) o[r].value.apply(t, n);
  },
  apply: function(e, t, n) {
    if (!this._.hasOwnProperty(e)) throw new Error("unknown type: " + e);
    for (var r = this._[e], a = 0, o = r.length; a < o; ++a) r[a].value.apply(t, n);
  }
};
function pG(e, t) {
  for (var n = 0, r = e.length, a; n < r; ++n)
    if ((a = e[n]).name === t)
      return a.value;
}
function TE(e, t, n) {
  for (var r = 0, a = e.length; r < a; ++r)
    if (e[r].name === t) {
      e[r] = hG, e = e.slice(0, r).concat(e.slice(r + 1));
      break;
    }
  return n != null && e.push({ name: t, value: n }), e;
}
var J3 = "http://www.w3.org/1999/xhtml";
const AE = {
  svg: "http://www.w3.org/2000/svg",
  xhtml: J3,
  xlink: "http://www.w3.org/1999/xlink",
  xml: "http://www.w3.org/XML/1998/namespace",
  xmlns: "http://www.w3.org/2000/xmlns/"
};
function K1(e) {
  var t = e += "", n = t.indexOf(":");
  return n >= 0 && (t = e.slice(0, n)) !== "xmlns" && (e = e.slice(n + 1)), AE.hasOwnProperty(t) ? { space: AE[t], local: e } : e;
}
function gG(e) {
  return function() {
    var t = this.ownerDocument, n = this.namespaceURI;
    return n === J3 && t.documentElement.namespaceURI === J3 ? t.createElement(e) : t.createElementNS(n, e);
  };
}
function yG(e) {
  return function() {
    return this.ownerDocument.createElementNS(e.space, e.local);
  };
}
function yA(e) {
  var t = K1(e);
  return (t.local ? yG : gG)(t);
}
function vG() {
}
function XS(e) {
  return e == null ? vG : function() {
    return this.querySelector(e);
  };
}
function xG(e) {
  typeof e != "function" && (e = XS(e));
  for (var t = this._groups, n = t.length, r = new Array(n), a = 0; a < n; ++a)
    for (var o = t[a], l = o.length, c = r[a] = new Array(l), d, h, p = 0; p < l; ++p)
      (d = o[p]) && (h = e.call(d, d.__data__, p, o)) && ("__data__" in d && (h.__data__ = d.__data__), c[p] = h);
  return new is(r, this._parents);
}
function bG(e) {
  return e == null ? [] : Array.isArray(e) ? e : Array.from(e);
}
function wG() {
  return [];
}
function vA(e) {
  return e == null ? wG : function() {
    return this.querySelectorAll(e);
  };
}
function _G(e) {
  return function() {
    return bG(e.apply(this, arguments));
  };
}
function SG(e) {
  typeof e == "function" ? e = _G(e) : e = vA(e);
  for (var t = this._groups, n = t.length, r = [], a = [], o = 0; o < n; ++o)
    for (var l = t[o], c = l.length, d, h = 0; h < c; ++h)
      (d = l[h]) && (r.push(e.call(d, d.__data__, h, l)), a.push(d));
  return new is(r, a);
}
function xA(e) {
  return function() {
    return this.matches(e);
  };
}
function bA(e) {
  return function(t) {
    return t.matches(e);
  };
}
var CG = Array.prototype.find;
function EG(e) {
  return function() {
    return CG.call(this.children, e);
  };
}
function kG() {
  return this.firstElementChild;
}
function NG(e) {
  return this.select(e == null ? kG : EG(typeof e == "function" ? e : bA(e)));
}
var jG = Array.prototype.filter;
function TG() {
  return Array.from(this.children);
}
function AG(e) {
  return function() {
    return jG.call(this.children, e);
  };
}
function MG(e) {
  return this.selectAll(e == null ? TG : AG(typeof e == "function" ? e : bA(e)));
}
function RG(e) {
  typeof e != "function" && (e = xA(e));
  for (var t = this._groups, n = t.length, r = new Array(n), a = 0; a < n; ++a)
    for (var o = t[a], l = o.length, c = r[a] = [], d, h = 0; h < l; ++h)
      (d = o[h]) && e.call(d, d.__data__, h, o) && c.push(d);
  return new is(r, this._parents);
}
function wA(e) {
  return new Array(e.length);
}
function OG() {
  return new is(this._enter || this._groups.map(wA), this._parents);
}
function y1(e, t) {
  this.ownerDocument = e.ownerDocument, this.namespaceURI = e.namespaceURI, this._next = null, this._parent = e, this.__data__ = t;
}
y1.prototype = {
  constructor: y1,
  appendChild: function(e) {
    return this._parent.insertBefore(e, this._next);
  },
  insertBefore: function(e, t) {
    return this._parent.insertBefore(e, t);
  },
  querySelector: function(e) {
    return this._parent.querySelector(e);
  },
  querySelectorAll: function(e) {
    return this._parent.querySelectorAll(e);
  }
};
function zG(e) {
  return function() {
    return e;
  };
}
function DG(e, t, n, r, a, o) {
  for (var l = 0, c, d = t.length, h = o.length; l < h; ++l)
    (c = t[l]) ? (c.__data__ = o[l], r[l] = c) : n[l] = new y1(e, o[l]);
  for (; l < d; ++l)
    (c = t[l]) && (a[l] = c);
}
function IG(e, t, n, r, a, o, l) {
  var c, d, h = /* @__PURE__ */ new Map(), p = t.length, g = o.length, x = new Array(p), b;
  for (c = 0; c < p; ++c)
    (d = t[c]) && (x[c] = b = l.call(d, d.__data__, c, t) + "", h.has(b) ? a[c] = d : h.set(b, d));
  for (c = 0; c < g; ++c)
    b = l.call(e, o[c], c, o) + "", (d = h.get(b)) ? (r[c] = d, d.__data__ = o[c], h.delete(b)) : n[c] = new y1(e, o[c]);
  for (c = 0; c < p; ++c)
    (d = t[c]) && h.get(x[c]) === d && (a[c] = d);
}
function LG(e) {
  return e.__data__;
}
function PG(e, t) {
  if (!arguments.length) return Array.from(this, LG);
  var n = t ? IG : DG, r = this._parents, a = this._groups;
  typeof e != "function" && (e = zG(e));
  for (var o = a.length, l = new Array(o), c = new Array(o), d = new Array(o), h = 0; h < o; ++h) {
    var p = r[h], g = a[h], x = g.length, b = qG(e.call(p, p && p.__data__, h, r)), C = b.length, N = c[h] = new Array(C), T = l[h] = new Array(C), j = d[h] = new Array(x);
    n(p, g, N, T, j, b, t);
    for (var R = 0, A = 0, z, q; R < C; ++R)
      if (z = N[R]) {
        for (R >= A && (A = R + 1); !(q = T[A]) && ++A < C; ) ;
        z._next = q || null;
      }
  }
  return l = new is(l, r), l._enter = c, l._exit = d, l;
}
function qG(e) {
  return typeof e == "object" && "length" in e ? e : Array.from(e);
}
function BG() {
  return new is(this._exit || this._groups.map(wA), this._parents);
}
function FG(e, t, n) {
  var r = this.enter(), a = this, o = this.exit();
  return typeof e == "function" ? (r = e(r), r && (r = r.selection())) : r = r.append(e + ""), t != null && (a = t(a), a && (a = a.selection())), n == null ? o.remove() : n(o), r && a ? r.merge(a).order() : a;
}
function UG(e) {
  for (var t = e.selection ? e.selection() : e, n = this._groups, r = t._groups, a = n.length, o = r.length, l = Math.min(a, o), c = new Array(a), d = 0; d < l; ++d)
    for (var h = n[d], p = r[d], g = h.length, x = c[d] = new Array(g), b, C = 0; C < g; ++C)
      (b = h[C] || p[C]) && (x[C] = b);
  for (; d < a; ++d)
    c[d] = n[d];
  return new is(c, this._parents);
}
function $G() {
  for (var e = this._groups, t = -1, n = e.length; ++t < n; )
    for (var r = e[t], a = r.length - 1, o = r[a], l; --a >= 0; )
      (l = r[a]) && (o && l.compareDocumentPosition(o) ^ 4 && o.parentNode.insertBefore(l, o), o = l);
  return this;
}
function HG(e) {
  e || (e = GG);
  function t(g, x) {
    return g && x ? e(g.__data__, x.__data__) : !g - !x;
  }
  for (var n = this._groups, r = n.length, a = new Array(r), o = 0; o < r; ++o) {
    for (var l = n[o], c = l.length, d = a[o] = new Array(c), h, p = 0; p < c; ++p)
      (h = l[p]) && (d[p] = h);
    d.sort(t);
  }
  return new is(a, this._parents).order();
}
function GG(e, t) {
  return e < t ? -1 : e > t ? 1 : e >= t ? 0 : NaN;
}
function VG() {
  var e = arguments[0];
  return arguments[0] = this, e.apply(null, arguments), this;
}
function KG() {
  return Array.from(this);
}
function YG() {
  for (var e = this._groups, t = 0, n = e.length; t < n; ++t)
    for (var r = e[t], a = 0, o = r.length; a < o; ++a) {
      var l = r[a];
      if (l) return l;
    }
  return null;
}
function WG() {
  let e = 0;
  for (const t of this) ++e;
  return e;
}
function XG() {
  return !this.node();
}
function QG(e) {
  for (var t = this._groups, n = 0, r = t.length; n < r; ++n)
    for (var a = t[n], o = 0, l = a.length, c; o < l; ++o)
      (c = a[o]) && e.call(c, c.__data__, o, a);
  return this;
}
function ZG(e) {
  return function() {
    this.removeAttribute(e);
  };
}
function JG(e) {
  return function() {
    this.removeAttributeNS(e.space, e.local);
  };
}
function eV(e, t) {
  return function() {
    this.setAttribute(e, t);
  };
}
function tV(e, t) {
  return function() {
    this.setAttributeNS(e.space, e.local, t);
  };
}
function nV(e, t) {
  return function() {
    var n = t.apply(this, arguments);
    n == null ? this.removeAttribute(e) : this.setAttribute(e, n);
  };
}
function rV(e, t) {
  return function() {
    var n = t.apply(this, arguments);
    n == null ? this.removeAttributeNS(e.space, e.local) : this.setAttributeNS(e.space, e.local, n);
  };
}
function iV(e, t) {
  var n = K1(e);
  if (arguments.length < 2) {
    var r = this.node();
    return n.local ? r.getAttributeNS(n.space, n.local) : r.getAttribute(n);
  }
  return this.each((t == null ? n.local ? JG : ZG : typeof t == "function" ? n.local ? rV : nV : n.local ? tV : eV)(n, t));
}
function _A(e) {
  return e.ownerDocument && e.ownerDocument.defaultView || e.document && e || e.defaultView;
}
function aV(e) {
  return function() {
    this.style.removeProperty(e);
  };
}
function sV(e, t, n) {
  return function() {
    this.style.setProperty(e, t, n);
  };
}
function oV(e, t, n) {
  return function() {
    var r = t.apply(this, arguments);
    r == null ? this.style.removeProperty(e) : this.style.setProperty(e, r, n);
  };
}
function lV(e, t, n) {
  return arguments.length > 1 ? this.each((t == null ? aV : typeof t == "function" ? oV : sV)(e, t, n ?? "")) : Vh(this.node(), e);
}
function Vh(e, t) {
  return e.style.getPropertyValue(t) || _A(e).getComputedStyle(e, null).getPropertyValue(t);
}
function uV(e) {
  return function() {
    delete this[e];
  };
}
function cV(e, t) {
  return function() {
    this[e] = t;
  };
}
function fV(e, t) {
  return function() {
    var n = t.apply(this, arguments);
    n == null ? delete this[e] : this[e] = n;
  };
}
function dV(e, t) {
  return arguments.length > 1 ? this.each((t == null ? uV : typeof t == "function" ? fV : cV)(e, t)) : this.node()[e];
}
function SA(e) {
  return e.trim().split(/^|\s+/);
}
function QS(e) {
  return e.classList || new CA(e);
}
function CA(e) {
  this._node = e, this._names = SA(e.getAttribute("class") || "");
}
CA.prototype = {
  add: function(e) {
    var t = this._names.indexOf(e);
    t < 0 && (this._names.push(e), this._node.setAttribute("class", this._names.join(" ")));
  },
  remove: function(e) {
    var t = this._names.indexOf(e);
    t >= 0 && (this._names.splice(t, 1), this._node.setAttribute("class", this._names.join(" ")));
  },
  contains: function(e) {
    return this._names.indexOf(e) >= 0;
  }
};
function EA(e, t) {
  for (var n = QS(e), r = -1, a = t.length; ++r < a; ) n.add(t[r]);
}
function kA(e, t) {
  for (var n = QS(e), r = -1, a = t.length; ++r < a; ) n.remove(t[r]);
}
function hV(e) {
  return function() {
    EA(this, e);
  };
}
function mV(e) {
  return function() {
    kA(this, e);
  };
}
function pV(e, t) {
  return function() {
    (t.apply(this, arguments) ? EA : kA)(this, e);
  };
}
function gV(e, t) {
  var n = SA(e + "");
  if (arguments.length < 2) {
    for (var r = QS(this.node()), a = -1, o = n.length; ++a < o; ) if (!r.contains(n[a])) return !1;
    return !0;
  }
  return this.each((typeof t == "function" ? pV : t ? hV : mV)(n, t));
}
function yV() {
  this.textContent = "";
}
function vV(e) {
  return function() {
    this.textContent = e;
  };
}
function xV(e) {
  return function() {
    var t = e.apply(this, arguments);
    this.textContent = t ?? "";
  };
}
function bV(e) {
  return arguments.length ? this.each(e == null ? yV : (typeof e == "function" ? xV : vV)(e)) : this.node().textContent;
}
function wV() {
  this.innerHTML = "";
}
function _V(e) {
  return function() {
    this.innerHTML = e;
  };
}
function SV(e) {
  return function() {
    var t = e.apply(this, arguments);
    this.innerHTML = t ?? "";
  };
}
function CV(e) {
  return arguments.length ? this.each(e == null ? wV : (typeof e == "function" ? SV : _V)(e)) : this.node().innerHTML;
}
function EV() {
  this.nextSibling && this.parentNode.appendChild(this);
}
function kV() {
  return this.each(EV);
}
function NV() {
  this.previousSibling && this.parentNode.insertBefore(this, this.parentNode.firstChild);
}
function jV() {
  return this.each(NV);
}
function TV(e) {
  var t = typeof e == "function" ? e : yA(e);
  return this.select(function() {
    return this.appendChild(t.apply(this, arguments));
  });
}
function AV() {
  return null;
}
function MV(e, t) {
  var n = typeof e == "function" ? e : yA(e), r = t == null ? AV : typeof t == "function" ? t : XS(t);
  return this.select(function() {
    return this.insertBefore(n.apply(this, arguments), r.apply(this, arguments) || null);
  });
}
function RV() {
  var e = this.parentNode;
  e && e.removeChild(this);
}
function OV() {
  return this.each(RV);
}
function zV() {
  var e = this.cloneNode(!1), t = this.parentNode;
  return t ? t.insertBefore(e, this.nextSibling) : e;
}
function DV() {
  var e = this.cloneNode(!0), t = this.parentNode;
  return t ? t.insertBefore(e, this.nextSibling) : e;
}
function IV(e) {
  return this.select(e ? DV : zV);
}
function LV(e) {
  return arguments.length ? this.property("__data__", e) : this.node().__data__;
}
function PV(e) {
  return function(t) {
    e.call(this, t, this.__data__);
  };
}
function qV(e) {
  return e.trim().split(/^|\s+/).map(function(t) {
    var n = "", r = t.indexOf(".");
    return r >= 0 && (n = t.slice(r + 1), t = t.slice(0, r)), { type: t, name: n };
  });
}
function BV(e) {
  return function() {
    var t = this.__on;
    if (t) {
      for (var n = 0, r = -1, a = t.length, o; n < a; ++n)
        o = t[n], (!e.type || o.type === e.type) && o.name === e.name ? this.removeEventListener(o.type, o.listener, o.options) : t[++r] = o;
      ++r ? t.length = r : delete this.__on;
    }
  };
}
function FV(e, t, n) {
  return function() {
    var r = this.__on, a, o = PV(t);
    if (r) {
      for (var l = 0, c = r.length; l < c; ++l)
        if ((a = r[l]).type === e.type && a.name === e.name) {
          this.removeEventListener(a.type, a.listener, a.options), this.addEventListener(a.type, a.listener = o, a.options = n), a.value = t;
          return;
        }
    }
    this.addEventListener(e.type, o, n), a = { type: e.type, name: e.name, value: t, listener: o, options: n }, r ? r.push(a) : this.__on = [a];
  };
}
function UV(e, t, n) {
  var r = qV(e + ""), a, o = r.length, l;
  if (arguments.length < 2) {
    var c = this.node().__on;
    if (c) {
      for (var d = 0, h = c.length, p; d < h; ++d)
        for (a = 0, p = c[d]; a < o; ++a)
          if ((l = r[a]).type === p.type && l.name === p.name)
            return p.value;
    }
    return;
  }
  for (c = t ? FV : BV, a = 0; a < o; ++a) this.each(c(r[a], t, n));
  return this;
}
function NA(e, t, n) {
  var r = _A(e), a = r.CustomEvent;
  typeof a == "function" ? a = new a(t, n) : (a = r.document.createEvent("Event"), n ? (a.initEvent(t, n.bubbles, n.cancelable), a.detail = n.detail) : a.initEvent(t, !1, !1)), e.dispatchEvent(a);
}
function $V(e, t) {
  return function() {
    return NA(this, e, t);
  };
}
function HV(e, t) {
  return function() {
    return NA(this, e, t.apply(this, arguments));
  };
}
function GV(e, t) {
  return this.each((typeof t == "function" ? HV : $V)(e, t));
}
function* VV() {
  for (var e = this._groups, t = 0, n = e.length; t < n; ++t)
    for (var r = e[t], a = 0, o = r.length, l; a < o; ++a)
      (l = r[a]) && (yield l);
}
var jA = [null];
function is(e, t) {
  this._groups = e, this._parents = t;
}
function zg() {
  return new is([[document.documentElement]], jA);
}
function KV() {
  return this;
}
is.prototype = zg.prototype = {
  constructor: is,
  select: xG,
  selectAll: SG,
  selectChild: NG,
  selectChildren: MG,
  filter: RG,
  data: PG,
  enter: OG,
  exit: BG,
  join: FG,
  merge: UG,
  selection: KV,
  order: $G,
  sort: HG,
  call: VG,
  nodes: KG,
  node: YG,
  size: WG,
  empty: XG,
  each: QG,
  attr: iV,
  style: lV,
  property: dV,
  classed: gV,
  text: bV,
  html: CV,
  raise: kV,
  lower: jV,
  append: TV,
  insert: MV,
  remove: OV,
  clone: IV,
  datum: LV,
  on: UV,
  dispatch: GV,
  [Symbol.iterator]: VV
};
function ts(e) {
  return typeof e == "string" ? new is([[document.querySelector(e)]], [document.documentElement]) : new is([[e]], jA);
}
function YV(e) {
  let t;
  for (; t = e.sourceEvent; ) e = t;
  return e;
}
function so(e, t) {
  if (e = YV(e), t === void 0 && (t = e.currentTarget), t) {
    var n = t.ownerSVGElement || t;
    if (n.createSVGPoint) {
      var r = n.createSVGPoint();
      return r.x = e.clientX, r.y = e.clientY, r = r.matrixTransform(t.getScreenCTM().inverse()), [r.x, r.y];
    }
    if (t.getBoundingClientRect) {
      var a = t.getBoundingClientRect();
      return [e.clientX - a.left - t.clientLeft, e.clientY - a.top - t.clientTop];
    }
  }
  return [e.pageX, e.pageY];
}
const WV = { passive: !1 }, vg = { capture: !0, passive: !1 };
function Yx(e) {
  e.stopImmediatePropagation();
}
function Fh(e) {
  e.preventDefault(), e.stopImmediatePropagation();
}
function TA(e) {
  var t = e.document.documentElement, n = ts(e).on("dragstart.drag", Fh, vg);
  "onselectstart" in t ? n.on("selectstart.drag", Fh, vg) : (t.__noselect = t.style.MozUserSelect, t.style.MozUserSelect = "none");
}
function AA(e, t) {
  var n = e.document.documentElement, r = ts(e).on("dragstart.drag", null);
  t && (r.on("click.drag", Fh, vg), setTimeout(function() {
    r.on("click.drag", null);
  }, 0)), "onselectstart" in n ? r.on("selectstart.drag", null) : (n.style.MozUserSelect = n.__noselect, delete n.__noselect);
}
const Ly = (e) => () => e;
function eS(e, {
  sourceEvent: t,
  subject: n,
  target: r,
  identifier: a,
  active: o,
  x: l,
  y: c,
  dx: d,
  dy: h,
  dispatch: p
}) {
  Object.defineProperties(this, {
    type: { value: e, enumerable: !0, configurable: !0 },
    sourceEvent: { value: t, enumerable: !0, configurable: !0 },
    subject: { value: n, enumerable: !0, configurable: !0 },
    target: { value: r, enumerable: !0, configurable: !0 },
    identifier: { value: a, enumerable: !0, configurable: !0 },
    active: { value: o, enumerable: !0, configurable: !0 },
    x: { value: l, enumerable: !0, configurable: !0 },
    y: { value: c, enumerable: !0, configurable: !0 },
    dx: { value: d, enumerable: !0, configurable: !0 },
    dy: { value: h, enumerable: !0, configurable: !0 },
    _: { value: p }
  });
}
eS.prototype.on = function() {
  var e = this._.on.apply(this._, arguments);
  return e === this._ ? this : e;
};
function XV(e) {
  return !e.ctrlKey && !e.button;
}
function QV() {
  return this.parentNode;
}
function ZV(e, t) {
  return t ?? { x: e.x, y: e.y };
}
function JV() {
  return navigator.maxTouchPoints || "ontouchstart" in this;
}
function MA() {
  var e = XV, t = QV, n = ZV, r = JV, a = {}, o = V1("start", "drag", "end"), l = 0, c, d, h, p, g = 0;
  function x(z) {
    z.on("mousedown.drag", b).filter(r).on("touchstart.drag", T).on("touchmove.drag", j, WV).on("touchend.drag touchcancel.drag", R).style("touch-action", "none").style("-webkit-tap-highlight-color", "rgba(0,0,0,0)");
  }
  function b(z, q) {
    if (!(p || !e.call(this, z, q))) {
      var D = A(this, t.call(this, z, q), z, q, "mouse");
      D && (ts(z.view).on("mousemove.drag", C, vg).on("mouseup.drag", N, vg), TA(z.view), Yx(z), h = !1, c = z.clientX, d = z.clientY, D("start", z));
    }
  }
  function C(z) {
    if (Fh(z), !h) {
      var q = z.clientX - c, D = z.clientY - d;
      h = q * q + D * D > g;
    }
    a.mouse("drag", z);
  }
  function N(z) {
    ts(z.view).on("mousemove.drag mouseup.drag", null), AA(z.view, h), Fh(z), a.mouse("end", z);
  }
  function T(z, q) {
    if (e.call(this, z, q)) {
      var D = z.changedTouches, P = t.call(this, z, q), re = D.length, ie, X;
      for (ie = 0; ie < re; ++ie)
        (X = A(this, P, z, q, D[ie].identifier, D[ie])) && (Yx(z), X("start", z, D[ie]));
    }
  }
  function j(z) {
    var q = z.changedTouches, D = q.length, P, re;
    for (P = 0; P < D; ++P)
      (re = a[q[P].identifier]) && (Fh(z), re("drag", z, q[P]));
  }
  function R(z) {
    var q = z.changedTouches, D = q.length, P, re;
    for (p && clearTimeout(p), p = setTimeout(function() {
      p = null;
    }, 500), P = 0; P < D; ++P)
      (re = a[q[P].identifier]) && (Yx(z), re("end", z, q[P]));
  }
  function A(z, q, D, P, re, ie) {
    var X = o.copy(), K = so(ie || D, q), V, de, H;
    if ((H = n.call(z, new eS("beforestart", {
      sourceEvent: D,
      target: x,
      identifier: re,
      active: l,
      x: K[0],
      y: K[1],
      dx: 0,
      dy: 0,
      dispatch: X
    }), P)) != null)
      return V = H.x - K[0] || 0, de = H.y - K[1] || 0, function se(Z, fe, he) {
        var ge = K, Q;
        switch (Z) {
          case "start":
            a[re] = se, Q = l++;
            break;
          case "end":
            delete a[re], --l;
          // falls through
          case "drag":
            K = so(he || fe, q), Q = l;
            break;
        }
        X.call(
          Z,
          z,
          new eS(Z, {
            sourceEvent: fe,
            subject: H,
            target: x,
            identifier: re,
            active: Q,
            x: K[0] + V,
            y: K[1] + de,
            dx: K[0] - ge[0],
            dy: K[1] - ge[1],
            dispatch: X
          }),
          P
        );
      };
  }
  return x.filter = function(z) {
    return arguments.length ? (e = typeof z == "function" ? z : Ly(!!z), x) : e;
  }, x.container = function(z) {
    return arguments.length ? (t = typeof z == "function" ? z : Ly(z), x) : t;
  }, x.subject = function(z) {
    return arguments.length ? (n = typeof z == "function" ? z : Ly(z), x) : n;
  }, x.touchable = function(z) {
    return arguments.length ? (r = typeof z == "function" ? z : Ly(!!z), x) : r;
  }, x.on = function() {
    var z = o.on.apply(o, arguments);
    return z === o ? x : z;
  }, x.clickDistance = function(z) {
    return arguments.length ? (g = (z = +z) * z, x) : Math.sqrt(g);
  }, x;
}
function ZS(e, t, n) {
  e.prototype = t.prototype = n, n.constructor = e;
}
function RA(e, t) {
  var n = Object.create(e.prototype);
  for (var r in t) n[r] = t[r];
  return n;
}
function Dg() {
}
var xg = 0.7, v1 = 1 / xg, Uh = "\\s*([+-]?\\d+)\\s*", bg = "\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*", ml = "\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*", eK = /^#([0-9a-f]{3,8})$/, tK = new RegExp(`^rgb\\(${Uh},${Uh},${Uh}\\)$`), nK = new RegExp(`^rgb\\(${ml},${ml},${ml}\\)$`), rK = new RegExp(`^rgba\\(${Uh},${Uh},${Uh},${bg}\\)$`), iK = new RegExp(`^rgba\\(${ml},${ml},${ml},${bg}\\)$`), aK = new RegExp(`^hsl\\(${bg},${ml},${ml}\\)$`), sK = new RegExp(`^hsla\\(${bg},${ml},${ml},${bg}\\)$`), ME = {
  aliceblue: 15792383,
  antiquewhite: 16444375,
  aqua: 65535,
  aquamarine: 8388564,
  azure: 15794175,
  beige: 16119260,
  bisque: 16770244,
  black: 0,
  blanchedalmond: 16772045,
  blue: 255,
  blueviolet: 9055202,
  brown: 10824234,
  burlywood: 14596231,
  cadetblue: 6266528,
  chartreuse: 8388352,
  chocolate: 13789470,
  coral: 16744272,
  cornflowerblue: 6591981,
  cornsilk: 16775388,
  crimson: 14423100,
  cyan: 65535,
  darkblue: 139,
  darkcyan: 35723,
  darkgoldenrod: 12092939,
  darkgray: 11119017,
  darkgreen: 25600,
  darkgrey: 11119017,
  darkkhaki: 12433259,
  darkmagenta: 9109643,
  darkolivegreen: 5597999,
  darkorange: 16747520,
  darkorchid: 10040012,
  darkred: 9109504,
  darksalmon: 15308410,
  darkseagreen: 9419919,
  darkslateblue: 4734347,
  darkslategray: 3100495,
  darkslategrey: 3100495,
  darkturquoise: 52945,
  darkviolet: 9699539,
  deeppink: 16716947,
  deepskyblue: 49151,
  dimgray: 6908265,
  dimgrey: 6908265,
  dodgerblue: 2003199,
  firebrick: 11674146,
  floralwhite: 16775920,
  forestgreen: 2263842,
  fuchsia: 16711935,
  gainsboro: 14474460,
  ghostwhite: 16316671,
  gold: 16766720,
  goldenrod: 14329120,
  gray: 8421504,
  green: 32768,
  greenyellow: 11403055,
  grey: 8421504,
  honeydew: 15794160,
  hotpink: 16738740,
  indianred: 13458524,
  indigo: 4915330,
  ivory: 16777200,
  khaki: 15787660,
  lavender: 15132410,
  lavenderblush: 16773365,
  lawngreen: 8190976,
  lemonchiffon: 16775885,
  lightblue: 11393254,
  lightcoral: 15761536,
  lightcyan: 14745599,
  lightgoldenrodyellow: 16448210,
  lightgray: 13882323,
  lightgreen: 9498256,
  lightgrey: 13882323,
  lightpink: 16758465,
  lightsalmon: 16752762,
  lightseagreen: 2142890,
  lightskyblue: 8900346,
  lightslategray: 7833753,
  lightslategrey: 7833753,
  lightsteelblue: 11584734,
  lightyellow: 16777184,
  lime: 65280,
  limegreen: 3329330,
  linen: 16445670,
  magenta: 16711935,
  maroon: 8388608,
  mediumaquamarine: 6737322,
  mediumblue: 205,
  mediumorchid: 12211667,
  mediumpurple: 9662683,
  mediumseagreen: 3978097,
  mediumslateblue: 8087790,
  mediumspringgreen: 64154,
  mediumturquoise: 4772300,
  mediumvioletred: 13047173,
  midnightblue: 1644912,
  mintcream: 16121850,
  mistyrose: 16770273,
  moccasin: 16770229,
  navajowhite: 16768685,
  navy: 128,
  oldlace: 16643558,
  olive: 8421376,
  olivedrab: 7048739,
  orange: 16753920,
  orangered: 16729344,
  orchid: 14315734,
  palegoldenrod: 15657130,
  palegreen: 10025880,
  paleturquoise: 11529966,
  palevioletred: 14381203,
  papayawhip: 16773077,
  peachpuff: 16767673,
  peru: 13468991,
  pink: 16761035,
  plum: 14524637,
  powderblue: 11591910,
  purple: 8388736,
  rebeccapurple: 6697881,
  red: 16711680,
  rosybrown: 12357519,
  royalblue: 4286945,
  saddlebrown: 9127187,
  salmon: 16416882,
  sandybrown: 16032864,
  seagreen: 3050327,
  seashell: 16774638,
  sienna: 10506797,
  silver: 12632256,
  skyblue: 8900331,
  slateblue: 6970061,
  slategray: 7372944,
  slategrey: 7372944,
  snow: 16775930,
  springgreen: 65407,
  steelblue: 4620980,
  tan: 13808780,
  teal: 32896,
  thistle: 14204888,
  tomato: 16737095,
  turquoise: 4251856,
  violet: 15631086,
  wheat: 16113331,
  white: 16777215,
  whitesmoke: 16119285,
  yellow: 16776960,
  yellowgreen: 10145074
};
ZS(Dg, rd, {
  copy(e) {
    return Object.assign(new this.constructor(), this, e);
  },
  displayable() {
    return this.rgb().displayable();
  },
  hex: RE,
  // Deprecated! Use color.formatHex.
  formatHex: RE,
  formatHex8: oK,
  formatHsl: lK,
  formatRgb: OE,
  toString: OE
});
function RE() {
  return this.rgb().formatHex();
}
function oK() {
  return this.rgb().formatHex8();
}
function lK() {
  return OA(this).formatHsl();
}
function OE() {
  return this.rgb().formatRgb();
}
function rd(e) {
  var t, n;
  return e = (e + "").trim().toLowerCase(), (t = eK.exec(e)) ? (n = t[1].length, t = parseInt(t[1], 16), n === 6 ? zE(t) : n === 3 ? new Aa(t >> 8 & 15 | t >> 4 & 240, t >> 4 & 15 | t & 240, (t & 15) << 4 | t & 15, 1) : n === 8 ? Py(t >> 24 & 255, t >> 16 & 255, t >> 8 & 255, (t & 255) / 255) : n === 4 ? Py(t >> 12 & 15 | t >> 8 & 240, t >> 8 & 15 | t >> 4 & 240, t >> 4 & 15 | t & 240, ((t & 15) << 4 | t & 15) / 255) : null) : (t = tK.exec(e)) ? new Aa(t[1], t[2], t[3], 1) : (t = nK.exec(e)) ? new Aa(t[1] * 255 / 100, t[2] * 255 / 100, t[3] * 255 / 100, 1) : (t = rK.exec(e)) ? Py(t[1], t[2], t[3], t[4]) : (t = iK.exec(e)) ? Py(t[1] * 255 / 100, t[2] * 255 / 100, t[3] * 255 / 100, t[4]) : (t = aK.exec(e)) ? LE(t[1], t[2] / 100, t[3] / 100, 1) : (t = sK.exec(e)) ? LE(t[1], t[2] / 100, t[3] / 100, t[4]) : ME.hasOwnProperty(e) ? zE(ME[e]) : e === "transparent" ? new Aa(NaN, NaN, NaN, 0) : null;
}
function zE(e) {
  return new Aa(e >> 16 & 255, e >> 8 & 255, e & 255, 1);
}
function Py(e, t, n, r) {
  return r <= 0 && (e = t = n = NaN), new Aa(e, t, n, r);
}
function uK(e) {
  return e instanceof Dg || (e = rd(e)), e ? (e = e.rgb(), new Aa(e.r, e.g, e.b, e.opacity)) : new Aa();
}
function tS(e, t, n, r) {
  return arguments.length === 1 ? uK(e) : new Aa(e, t, n, r ?? 1);
}
function Aa(e, t, n, r) {
  this.r = +e, this.g = +t, this.b = +n, this.opacity = +r;
}
ZS(Aa, tS, RA(Dg, {
  brighter(e) {
    return e = e == null ? v1 : Math.pow(v1, e), new Aa(this.r * e, this.g * e, this.b * e, this.opacity);
  },
  darker(e) {
    return e = e == null ? xg : Math.pow(xg, e), new Aa(this.r * e, this.g * e, this.b * e, this.opacity);
  },
  rgb() {
    return this;
  },
  clamp() {
    return new Aa(Zf(this.r), Zf(this.g), Zf(this.b), x1(this.opacity));
  },
  displayable() {
    return -0.5 <= this.r && this.r < 255.5 && -0.5 <= this.g && this.g < 255.5 && -0.5 <= this.b && this.b < 255.5 && 0 <= this.opacity && this.opacity <= 1;
  },
  hex: DE,
  // Deprecated! Use color.formatHex.
  formatHex: DE,
  formatHex8: cK,
  formatRgb: IE,
  toString: IE
}));
function DE() {
  return `#${Yf(this.r)}${Yf(this.g)}${Yf(this.b)}`;
}
function cK() {
  return `#${Yf(this.r)}${Yf(this.g)}${Yf(this.b)}${Yf((isNaN(this.opacity) ? 1 : this.opacity) * 255)}`;
}
function IE() {
  const e = x1(this.opacity);
  return `${e === 1 ? "rgb(" : "rgba("}${Zf(this.r)}, ${Zf(this.g)}, ${Zf(this.b)}${e === 1 ? ")" : `, ${e})`}`;
}
function x1(e) {
  return isNaN(e) ? 1 : Math.max(0, Math.min(1, e));
}
function Zf(e) {
  return Math.max(0, Math.min(255, Math.round(e) || 0));
}
function Yf(e) {
  return e = Zf(e), (e < 16 ? "0" : "") + e.toString(16);
}
function LE(e, t, n, r) {
  return r <= 0 ? e = t = n = NaN : n <= 0 || n >= 1 ? e = t = NaN : t <= 0 && (e = NaN), new lo(e, t, n, r);
}
function OA(e) {
  if (e instanceof lo) return new lo(e.h, e.s, e.l, e.opacity);
  if (e instanceof Dg || (e = rd(e)), !e) return new lo();
  if (e instanceof lo) return e;
  e = e.rgb();
  var t = e.r / 255, n = e.g / 255, r = e.b / 255, a = Math.min(t, n, r), o = Math.max(t, n, r), l = NaN, c = o - a, d = (o + a) / 2;
  return c ? (t === o ? l = (n - r) / c + (n < r) * 6 : n === o ? l = (r - t) / c + 2 : l = (t - n) / c + 4, c /= d < 0.5 ? o + a : 2 - o - a, l *= 60) : c = d > 0 && d < 1 ? 0 : l, new lo(l, c, d, e.opacity);
}
function fK(e, t, n, r) {
  return arguments.length === 1 ? OA(e) : new lo(e, t, n, r ?? 1);
}
function lo(e, t, n, r) {
  this.h = +e, this.s = +t, this.l = +n, this.opacity = +r;
}
ZS(lo, fK, RA(Dg, {
  brighter(e) {
    return e = e == null ? v1 : Math.pow(v1, e), new lo(this.h, this.s, this.l * e, this.opacity);
  },
  darker(e) {
    return e = e == null ? xg : Math.pow(xg, e), new lo(this.h, this.s, this.l * e, this.opacity);
  },
  rgb() {
    var e = this.h % 360 + (this.h < 0) * 360, t = isNaN(e) || isNaN(this.s) ? 0 : this.s, n = this.l, r = n + (n < 0.5 ? n : 1 - n) * t, a = 2 * n - r;
    return new Aa(
      Wx(e >= 240 ? e - 240 : e + 120, a, r),
      Wx(e, a, r),
      Wx(e < 120 ? e + 240 : e - 120, a, r),
      this.opacity
    );
  },
  clamp() {
    return new lo(PE(this.h), qy(this.s), qy(this.l), x1(this.opacity));
  },
  displayable() {
    return (0 <= this.s && this.s <= 1 || isNaN(this.s)) && 0 <= this.l && this.l <= 1 && 0 <= this.opacity && this.opacity <= 1;
  },
  formatHsl() {
    const e = x1(this.opacity);
    return `${e === 1 ? "hsl(" : "hsla("}${PE(this.h)}, ${qy(this.s) * 100}%, ${qy(this.l) * 100}%${e === 1 ? ")" : `, ${e})`}`;
  }
}));
function PE(e) {
  return e = (e || 0) % 360, e < 0 ? e + 360 : e;
}
function qy(e) {
  return Math.max(0, Math.min(1, e || 0));
}
function Wx(e, t, n) {
  return (e < 60 ? t + (n - t) * e / 60 : e < 180 ? n : e < 240 ? t + (n - t) * (240 - e) / 60 : t) * 255;
}
const JS = (e) => () => e;
function dK(e, t) {
  return function(n) {
    return e + n * t;
  };
}
function hK(e, t, n) {
  return e = Math.pow(e, n), t = Math.pow(t, n) - e, n = 1 / n, function(r) {
    return Math.pow(e + r * t, n);
  };
}
function mK(e) {
  return (e = +e) == 1 ? zA : function(t, n) {
    return n - t ? hK(t, n, e) : JS(isNaN(t) ? n : t);
  };
}
function zA(e, t) {
  var n = t - e;
  return n ? dK(e, n) : JS(isNaN(e) ? t : e);
}
const b1 = (function e(t) {
  var n = mK(t);
  function r(a, o) {
    var l = n((a = tS(a)).r, (o = tS(o)).r), c = n(a.g, o.g), d = n(a.b, o.b), h = zA(a.opacity, o.opacity);
    return function(p) {
      return a.r = l(p), a.g = c(p), a.b = d(p), a.opacity = h(p), a + "";
    };
  }
  return r.gamma = e, r;
})(1);
function pK(e, t) {
  t || (t = []);
  var n = e ? Math.min(t.length, e.length) : 0, r = t.slice(), a;
  return function(o) {
    for (a = 0; a < n; ++a) r[a] = e[a] * (1 - o) + t[a] * o;
    return r;
  };
}
function gK(e) {
  return ArrayBuffer.isView(e) && !(e instanceof DataView);
}
function yK(e, t) {
  var n = t ? t.length : 0, r = e ? Math.min(n, e.length) : 0, a = new Array(r), o = new Array(n), l;
  for (l = 0; l < r; ++l) a[l] = cg(e[l], t[l]);
  for (; l < n; ++l) o[l] = t[l];
  return function(c) {
    for (l = 0; l < r; ++l) o[l] = a[l](c);
    return o;
  };
}
function vK(e, t) {
  var n = /* @__PURE__ */ new Date();
  return e = +e, t = +t, function(r) {
    return n.setTime(e * (1 - r) + t * r), n;
  };
}
function ul(e, t) {
  return e = +e, t = +t, function(n) {
    return e * (1 - n) + t * n;
  };
}
function xK(e, t) {
  var n = {}, r = {}, a;
  (e === null || typeof e != "object") && (e = {}), (t === null || typeof t != "object") && (t = {});
  for (a in t)
    a in e ? n[a] = cg(e[a], t[a]) : r[a] = t[a];
  return function(o) {
    for (a in n) r[a] = n[a](o);
    return r;
  };
}
var nS = /[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g, Xx = new RegExp(nS.source, "g");
function bK(e) {
  return function() {
    return e;
  };
}
function wK(e) {
  return function(t) {
    return e(t) + "";
  };
}
function DA(e, t) {
  var n = nS.lastIndex = Xx.lastIndex = 0, r, a, o, l = -1, c = [], d = [];
  for (e = e + "", t = t + ""; (r = nS.exec(e)) && (a = Xx.exec(t)); )
    (o = a.index) > n && (o = t.slice(n, o), c[l] ? c[l] += o : c[++l] = o), (r = r[0]) === (a = a[0]) ? c[l] ? c[l] += a : c[++l] = a : (c[++l] = null, d.push({ i: l, x: ul(r, a) })), n = Xx.lastIndex;
  return n < t.length && (o = t.slice(n), c[l] ? c[l] += o : c[++l] = o), c.length < 2 ? d[0] ? wK(d[0].x) : bK(t) : (t = d.length, function(h) {
    for (var p = 0, g; p < t; ++p) c[(g = d[p]).i] = g.x(h);
    return c.join("");
  });
}
function cg(e, t) {
  var n = typeof t, r;
  return t == null || n === "boolean" ? JS(t) : (n === "number" ? ul : n === "string" ? (r = rd(t)) ? (t = r, b1) : DA : t instanceof rd ? b1 : t instanceof Date ? vK : gK(t) ? pK : Array.isArray(t) ? yK : typeof t.valueOf != "function" && typeof t.toString != "function" || isNaN(t) ? xK : ul)(e, t);
}
var qE = 180 / Math.PI, rS = {
  translateX: 0,
  translateY: 0,
  rotate: 0,
  skewX: 0,
  scaleX: 1,
  scaleY: 1
};
function IA(e, t, n, r, a, o) {
  var l, c, d;
  return (l = Math.sqrt(e * e + t * t)) && (e /= l, t /= l), (d = e * n + t * r) && (n -= e * d, r -= t * d), (c = Math.sqrt(n * n + r * r)) && (n /= c, r /= c, d /= c), e * r < t * n && (e = -e, t = -t, d = -d, l = -l), {
    translateX: a,
    translateY: o,
    rotate: Math.atan2(t, e) * qE,
    skewX: Math.atan(d) * qE,
    scaleX: l,
    scaleY: c
  };
}
var By;
function _K(e) {
  const t = new (typeof DOMMatrix == "function" ? DOMMatrix : WebKitCSSMatrix)(e + "");
  return t.isIdentity ? rS : IA(t.a, t.b, t.c, t.d, t.e, t.f);
}
function SK(e) {
  return e == null || (By || (By = document.createElementNS("http://www.w3.org/2000/svg", "g")), By.setAttribute("transform", e), !(e = By.transform.baseVal.consolidate())) ? rS : (e = e.matrix, IA(e.a, e.b, e.c, e.d, e.e, e.f));
}
function LA(e, t, n, r) {
  function a(h) {
    return h.length ? h.pop() + " " : "";
  }
  function o(h, p, g, x, b, C) {
    if (h !== g || p !== x) {
      var N = b.push("translate(", null, t, null, n);
      C.push({ i: N - 4, x: ul(h, g) }, { i: N - 2, x: ul(p, x) });
    } else (g || x) && b.push("translate(" + g + t + x + n);
  }
  function l(h, p, g, x) {
    h !== p ? (h - p > 180 ? p += 360 : p - h > 180 && (h += 360), x.push({ i: g.push(a(g) + "rotate(", null, r) - 2, x: ul(h, p) })) : p && g.push(a(g) + "rotate(" + p + r);
  }
  function c(h, p, g, x) {
    h !== p ? x.push({ i: g.push(a(g) + "skewX(", null, r) - 2, x: ul(h, p) }) : p && g.push(a(g) + "skewX(" + p + r);
  }
  function d(h, p, g, x, b, C) {
    if (h !== g || p !== x) {
      var N = b.push(a(b) + "scale(", null, ",", null, ")");
      C.push({ i: N - 4, x: ul(h, g) }, { i: N - 2, x: ul(p, x) });
    } else (g !== 1 || x !== 1) && b.push(a(b) + "scale(" + g + "," + x + ")");
  }
  return function(h, p) {
    var g = [], x = [];
    return h = e(h), p = e(p), o(h.translateX, h.translateY, p.translateX, p.translateY, g, x), l(h.rotate, p.rotate, g, x), c(h.skewX, p.skewX, g, x), d(h.scaleX, h.scaleY, p.scaleX, p.scaleY, g, x), h = p = null, function(b) {
      for (var C = -1, N = x.length, T; ++C < N; ) g[(T = x[C]).i] = T.x(b);
      return g.join("");
    };
  };
}
var CK = LA(_K, "px, ", "px)", "deg)"), EK = LA(SK, ", ", ")", ")"), kK = 1e-12;
function BE(e) {
  return ((e = Math.exp(e)) + 1 / e) / 2;
}
function NK(e) {
  return ((e = Math.exp(e)) - 1 / e) / 2;
}
function jK(e) {
  return ((e = Math.exp(2 * e)) - 1) / (e + 1);
}
const e1 = (function e(t, n, r) {
  function a(o, l) {
    var c = o[0], d = o[1], h = o[2], p = l[0], g = l[1], x = l[2], b = p - c, C = g - d, N = b * b + C * C, T, j;
    if (N < kK)
      j = Math.log(x / h) / t, T = function(P) {
        return [
          c + P * b,
          d + P * C,
          h * Math.exp(t * P * j)
        ];
      };
    else {
      var R = Math.sqrt(N), A = (x * x - h * h + r * N) / (2 * h * n * R), z = (x * x - h * h - r * N) / (2 * x * n * R), q = Math.log(Math.sqrt(A * A + 1) - A), D = Math.log(Math.sqrt(z * z + 1) - z);
      j = (D - q) / t, T = function(P) {
        var re = P * j, ie = BE(q), X = h / (n * R) * (ie * jK(t * re + q) - NK(q));
        return [
          c + X * b,
          d + X * C,
          h * ie / BE(t * re + q)
        ];
      };
    }
    return T.duration = j * 1e3 * t / Math.SQRT2, T;
  }
  return a.rho = function(o) {
    var l = Math.max(1e-3, +o), c = l * l, d = c * c;
    return e(l, c, d);
  }, a;
})(Math.SQRT2, 2, 4);
var Kh = 0, Jp = 0, Wp = 0, PA = 1e3, w1, eg, _1 = 0, id = 0, Y1 = 0, wg = typeof performance == "object" && performance.now ? performance : Date, qA = typeof window == "object" && window.requestAnimationFrame ? window.requestAnimationFrame.bind(window) : function(e) {
  setTimeout(e, 17);
};
function e5() {
  return id || (qA(TK), id = wg.now() + Y1);
}
function TK() {
  id = 0;
}
function S1() {
  this._call = this._time = this._next = null;
}
S1.prototype = BA.prototype = {
  constructor: S1,
  restart: function(e, t, n) {
    if (typeof e != "function") throw new TypeError("callback is not a function");
    n = (n == null ? e5() : +n) + (t == null ? 0 : +t), !this._next && eg !== this && (eg ? eg._next = this : w1 = this, eg = this), this._call = e, this._time = n, iS();
  },
  stop: function() {
    this._call && (this._call = null, this._time = 1 / 0, iS());
  }
};
function BA(e, t, n) {
  var r = new S1();
  return r.restart(e, t, n), r;
}
function AK() {
  e5(), ++Kh;
  for (var e = w1, t; e; )
    (t = id - e._time) >= 0 && e._call.call(void 0, t), e = e._next;
  --Kh;
}
function FE() {
  id = (_1 = wg.now()) + Y1, Kh = Jp = 0;
  try {
    AK();
  } finally {
    Kh = 0, RK(), id = 0;
  }
}
function MK() {
  var e = wg.now(), t = e - _1;
  t > PA && (Y1 -= t, _1 = e);
}
function RK() {
  for (var e, t = w1, n, r = 1 / 0; t; )
    t._call ? (r > t._time && (r = t._time), e = t, t = t._next) : (n = t._next, t._next = null, t = e ? e._next = n : w1 = n);
  eg = e, iS(r);
}
function iS(e) {
  if (!Kh) {
    Jp && (Jp = clearTimeout(Jp));
    var t = e - id;
    t > 24 ? (e < 1 / 0 && (Jp = setTimeout(FE, e - wg.now() - Y1)), Wp && (Wp = clearInterval(Wp))) : (Wp || (_1 = wg.now(), Wp = setInterval(MK, PA)), Kh = 1, qA(FE));
  }
}
function UE(e, t, n) {
  var r = new S1();
  return t = t == null ? 0 : +t, r.restart((a) => {
    r.stop(), e(a + t);
  }, t, n), r;
}
var OK = V1("start", "end", "cancel", "interrupt"), zK = [], FA = 0, $E = 1, aS = 2, t1 = 3, HE = 4, sS = 5, n1 = 6;
function W1(e, t, n, r, a, o) {
  var l = e.__transition;
  if (!l) e.__transition = {};
  else if (n in l) return;
  DK(e, n, {
    name: t,
    index: r,
    // For context during callback.
    group: a,
    // For context during callback.
    on: OK,
    tween: zK,
    time: o.time,
    delay: o.delay,
    duration: o.duration,
    ease: o.ease,
    timer: null,
    state: FA
  });
}
function t5(e, t) {
  var n = yo(e, t);
  if (n.state > FA) throw new Error("too late; already scheduled");
  return n;
}
function vl(e, t) {
  var n = yo(e, t);
  if (n.state > t1) throw new Error("too late; already running");
  return n;
}
function yo(e, t) {
  var n = e.__transition;
  if (!n || !(n = n[t])) throw new Error("transition not found");
  return n;
}
function DK(e, t, n) {
  var r = e.__transition, a;
  r[t] = n, n.timer = BA(o, 0, n.time);
  function o(h) {
    n.state = $E, n.timer.restart(l, n.delay, n.time), n.delay <= h && l(h - n.delay);
  }
  function l(h) {
    var p, g, x, b;
    if (n.state !== $E) return d();
    for (p in r)
      if (b = r[p], b.name === n.name) {
        if (b.state === t1) return UE(l);
        b.state === HE ? (b.state = n1, b.timer.stop(), b.on.call("interrupt", e, e.__data__, b.index, b.group), delete r[p]) : +p < t && (b.state = n1, b.timer.stop(), b.on.call("cancel", e, e.__data__, b.index, b.group), delete r[p]);
      }
    if (UE(function() {
      n.state === t1 && (n.state = HE, n.timer.restart(c, n.delay, n.time), c(h));
    }), n.state = aS, n.on.call("start", e, e.__data__, n.index, n.group), n.state === aS) {
      for (n.state = t1, a = new Array(x = n.tween.length), p = 0, g = -1; p < x; ++p)
        (b = n.tween[p].value.call(e, e.__data__, n.index, n.group)) && (a[++g] = b);
      a.length = g + 1;
    }
  }
  function c(h) {
    for (var p = h < n.duration ? n.ease.call(null, h / n.duration) : (n.timer.restart(d), n.state = sS, 1), g = -1, x = a.length; ++g < x; )
      a[g].call(e, p);
    n.state === sS && (n.on.call("end", e, e.__data__, n.index, n.group), d());
  }
  function d() {
    n.state = n1, n.timer.stop(), delete r[t];
    for (var h in r) return;
    delete e.__transition;
  }
}
function r1(e, t) {
  var n = e.__transition, r, a, o = !0, l;
  if (n) {
    t = t == null ? null : t + "";
    for (l in n) {
      if ((r = n[l]).name !== t) {
        o = !1;
        continue;
      }
      a = r.state > aS && r.state < sS, r.state = n1, r.timer.stop(), r.on.call(a ? "interrupt" : "cancel", e, e.__data__, r.index, r.group), delete n[l];
    }
    o && delete e.__transition;
  }
}
function IK(e) {
  return this.each(function() {
    r1(this, e);
  });
}
function LK(e, t) {
  var n, r;
  return function() {
    var a = vl(this, e), o = a.tween;
    if (o !== n) {
      r = n = o;
      for (var l = 0, c = r.length; l < c; ++l)
        if (r[l].name === t) {
          r = r.slice(), r.splice(l, 1);
          break;
        }
    }
    a.tween = r;
  };
}
function PK(e, t, n) {
  var r, a;
  if (typeof n != "function") throw new Error();
  return function() {
    var o = vl(this, e), l = o.tween;
    if (l !== r) {
      a = (r = l).slice();
      for (var c = { name: t, value: n }, d = 0, h = a.length; d < h; ++d)
        if (a[d].name === t) {
          a[d] = c;
          break;
        }
      d === h && a.push(c);
    }
    o.tween = a;
  };
}
function qK(e, t) {
  var n = this._id;
  if (e += "", arguments.length < 2) {
    for (var r = yo(this.node(), n).tween, a = 0, o = r.length, l; a < o; ++a)
      if ((l = r[a]).name === e)
        return l.value;
    return null;
  }
  return this.each((t == null ? LK : PK)(n, e, t));
}
function n5(e, t, n) {
  var r = e._id;
  return e.each(function() {
    var a = vl(this, r);
    (a.value || (a.value = {}))[t] = n.apply(this, arguments);
  }), function(a) {
    return yo(a, r).value[t];
  };
}
function UA(e, t) {
  var n;
  return (typeof t == "number" ? ul : t instanceof rd ? b1 : (n = rd(t)) ? (t = n, b1) : DA)(e, t);
}
function BK(e) {
  return function() {
    this.removeAttribute(e);
  };
}
function FK(e) {
  return function() {
    this.removeAttributeNS(e.space, e.local);
  };
}
function UK(e, t, n) {
  var r, a = n + "", o;
  return function() {
    var l = this.getAttribute(e);
    return l === a ? null : l === r ? o : o = t(r = l, n);
  };
}
function $K(e, t, n) {
  var r, a = n + "", o;
  return function() {
    var l = this.getAttributeNS(e.space, e.local);
    return l === a ? null : l === r ? o : o = t(r = l, n);
  };
}
function HK(e, t, n) {
  var r, a, o;
  return function() {
    var l, c = n(this), d;
    return c == null ? void this.removeAttribute(e) : (l = this.getAttribute(e), d = c + "", l === d ? null : l === r && d === a ? o : (a = d, o = t(r = l, c)));
  };
}
function GK(e, t, n) {
  var r, a, o;
  return function() {
    var l, c = n(this), d;
    return c == null ? void this.removeAttributeNS(e.space, e.local) : (l = this.getAttributeNS(e.space, e.local), d = c + "", l === d ? null : l === r && d === a ? o : (a = d, o = t(r = l, c)));
  };
}
function VK(e, t) {
  var n = K1(e), r = n === "transform" ? EK : UA;
  return this.attrTween(e, typeof t == "function" ? (n.local ? GK : HK)(n, r, n5(this, "attr." + e, t)) : t == null ? (n.local ? FK : BK)(n) : (n.local ? $K : UK)(n, r, t));
}
function KK(e, t) {
  return function(n) {
    this.setAttribute(e, t.call(this, n));
  };
}
function YK(e, t) {
  return function(n) {
    this.setAttributeNS(e.space, e.local, t.call(this, n));
  };
}
function WK(e, t) {
  var n, r;
  function a() {
    var o = t.apply(this, arguments);
    return o !== r && (n = (r = o) && YK(e, o)), n;
  }
  return a._value = t, a;
}
function XK(e, t) {
  var n, r;
  function a() {
    var o = t.apply(this, arguments);
    return o !== r && (n = (r = o) && KK(e, o)), n;
  }
  return a._value = t, a;
}
function QK(e, t) {
  var n = "attr." + e;
  if (arguments.length < 2) return (n = this.tween(n)) && n._value;
  if (t == null) return this.tween(n, null);
  if (typeof t != "function") throw new Error();
  var r = K1(e);
  return this.tween(n, (r.local ? WK : XK)(r, t));
}
function ZK(e, t) {
  return function() {
    t5(this, e).delay = +t.apply(this, arguments);
  };
}
function JK(e, t) {
  return t = +t, function() {
    t5(this, e).delay = t;
  };
}
function eY(e) {
  var t = this._id;
  return arguments.length ? this.each((typeof e == "function" ? ZK : JK)(t, e)) : yo(this.node(), t).delay;
}
function tY(e, t) {
  return function() {
    vl(this, e).duration = +t.apply(this, arguments);
  };
}
function nY(e, t) {
  return t = +t, function() {
    vl(this, e).duration = t;
  };
}
function rY(e) {
  var t = this._id;
  return arguments.length ? this.each((typeof e == "function" ? tY : nY)(t, e)) : yo(this.node(), t).duration;
}
function iY(e, t) {
  if (typeof t != "function") throw new Error();
  return function() {
    vl(this, e).ease = t;
  };
}
function aY(e) {
  var t = this._id;
  return arguments.length ? this.each(iY(t, e)) : yo(this.node(), t).ease;
}
function sY(e, t) {
  return function() {
    var n = t.apply(this, arguments);
    if (typeof n != "function") throw new Error();
    vl(this, e).ease = n;
  };
}
function oY(e) {
  if (typeof e != "function") throw new Error();
  return this.each(sY(this._id, e));
}
function lY(e) {
  typeof e != "function" && (e = xA(e));
  for (var t = this._groups, n = t.length, r = new Array(n), a = 0; a < n; ++a)
    for (var o = t[a], l = o.length, c = r[a] = [], d, h = 0; h < l; ++h)
      (d = o[h]) && e.call(d, d.__data__, h, o) && c.push(d);
  return new iu(r, this._parents, this._name, this._id);
}
function uY(e) {
  if (e._id !== this._id) throw new Error();
  for (var t = this._groups, n = e._groups, r = t.length, a = n.length, o = Math.min(r, a), l = new Array(r), c = 0; c < o; ++c)
    for (var d = t[c], h = n[c], p = d.length, g = l[c] = new Array(p), x, b = 0; b < p; ++b)
      (x = d[b] || h[b]) && (g[b] = x);
  for (; c < r; ++c)
    l[c] = t[c];
  return new iu(l, this._parents, this._name, this._id);
}
function cY(e) {
  return (e + "").trim().split(/^|\s+/).every(function(t) {
    var n = t.indexOf(".");
    return n >= 0 && (t = t.slice(0, n)), !t || t === "start";
  });
}
function fY(e, t, n) {
  var r, a, o = cY(t) ? t5 : vl;
  return function() {
    var l = o(this, e), c = l.on;
    c !== r && (a = (r = c).copy()).on(t, n), l.on = a;
  };
}
function dY(e, t) {
  var n = this._id;
  return arguments.length < 2 ? yo(this.node(), n).on.on(e) : this.each(fY(n, e, t));
}
function hY(e) {
  return function() {
    var t = this.parentNode;
    for (var n in this.__transition) if (+n !== e) return;
    t && t.removeChild(this);
  };
}
function mY() {
  return this.on("end.remove", hY(this._id));
}
function pY(e) {
  var t = this._name, n = this._id;
  typeof e != "function" && (e = XS(e));
  for (var r = this._groups, a = r.length, o = new Array(a), l = 0; l < a; ++l)
    for (var c = r[l], d = c.length, h = o[l] = new Array(d), p, g, x = 0; x < d; ++x)
      (p = c[x]) && (g = e.call(p, p.__data__, x, c)) && ("__data__" in p && (g.__data__ = p.__data__), h[x] = g, W1(h[x], t, n, x, h, yo(p, n)));
  return new iu(o, this._parents, t, n);
}
function gY(e) {
  var t = this._name, n = this._id;
  typeof e != "function" && (e = vA(e));
  for (var r = this._groups, a = r.length, o = [], l = [], c = 0; c < a; ++c)
    for (var d = r[c], h = d.length, p, g = 0; g < h; ++g)
      if (p = d[g]) {
        for (var x = e.call(p, p.__data__, g, d), b, C = yo(p, n), N = 0, T = x.length; N < T; ++N)
          (b = x[N]) && W1(b, t, n, N, x, C);
        o.push(x), l.push(p);
      }
  return new iu(o, l, t, n);
}
var yY = zg.prototype.constructor;
function vY() {
  return new yY(this._groups, this._parents);
}
function xY(e, t) {
  var n, r, a;
  return function() {
    var o = Vh(this, e), l = (this.style.removeProperty(e), Vh(this, e));
    return o === l ? null : o === n && l === r ? a : a = t(n = o, r = l);
  };
}
function $A(e) {
  return function() {
    this.style.removeProperty(e);
  };
}
function bY(e, t, n) {
  var r, a = n + "", o;
  return function() {
    var l = Vh(this, e);
    return l === a ? null : l === r ? o : o = t(r = l, n);
  };
}
function wY(e, t, n) {
  var r, a, o;
  return function() {
    var l = Vh(this, e), c = n(this), d = c + "";
    return c == null && (d = c = (this.style.removeProperty(e), Vh(this, e))), l === d ? null : l === r && d === a ? o : (a = d, o = t(r = l, c));
  };
}
function _Y(e, t) {
  var n, r, a, o = "style." + t, l = "end." + o, c;
  return function() {
    var d = vl(this, e), h = d.on, p = d.value[o] == null ? c || (c = $A(t)) : void 0;
    (h !== n || a !== p) && (r = (n = h).copy()).on(l, a = p), d.on = r;
  };
}
function SY(e, t, n) {
  var r = (e += "") == "transform" ? CK : UA;
  return t == null ? this.styleTween(e, xY(e, r)).on("end.style." + e, $A(e)) : typeof t == "function" ? this.styleTween(e, wY(e, r, n5(this, "style." + e, t))).each(_Y(this._id, e)) : this.styleTween(e, bY(e, r, t), n).on("end.style." + e, null);
}
function CY(e, t, n) {
  return function(r) {
    this.style.setProperty(e, t.call(this, r), n);
  };
}
function EY(e, t, n) {
  var r, a;
  function o() {
    var l = t.apply(this, arguments);
    return l !== a && (r = (a = l) && CY(e, l, n)), r;
  }
  return o._value = t, o;
}
function kY(e, t, n) {
  var r = "style." + (e += "");
  if (arguments.length < 2) return (r = this.tween(r)) && r._value;
  if (t == null) return this.tween(r, null);
  if (typeof t != "function") throw new Error();
  return this.tween(r, EY(e, t, n ?? ""));
}
function NY(e) {
  return function() {
    this.textContent = e;
  };
}
function jY(e) {
  return function() {
    var t = e(this);
    this.textContent = t ?? "";
  };
}
function TY(e) {
  return this.tween("text", typeof e == "function" ? jY(n5(this, "text", e)) : NY(e == null ? "" : e + ""));
}
function AY(e) {
  return function(t) {
    this.textContent = e.call(this, t);
  };
}
function MY(e) {
  var t, n;
  function r() {
    var a = e.apply(this, arguments);
    return a !== n && (t = (n = a) && AY(a)), t;
  }
  return r._value = e, r;
}
function RY(e) {
  var t = "text";
  if (arguments.length < 1) return (t = this.tween(t)) && t._value;
  if (e == null) return this.tween(t, null);
  if (typeof e != "function") throw new Error();
  return this.tween(t, MY(e));
}
function OY() {
  for (var e = this._name, t = this._id, n = HA(), r = this._groups, a = r.length, o = 0; o < a; ++o)
    for (var l = r[o], c = l.length, d, h = 0; h < c; ++h)
      if (d = l[h]) {
        var p = yo(d, t);
        W1(d, e, n, h, l, {
          time: p.time + p.delay + p.duration,
          delay: 0,
          duration: p.duration,
          ease: p.ease
        });
      }
  return new iu(r, this._parents, e, n);
}
function zY() {
  var e, t, n = this, r = n._id, a = n.size();
  return new Promise(function(o, l) {
    var c = { value: l }, d = { value: function() {
      --a === 0 && o();
    } };
    n.each(function() {
      var h = vl(this, r), p = h.on;
      p !== e && (t = (e = p).copy(), t._.cancel.push(c), t._.interrupt.push(c), t._.end.push(d)), h.on = t;
    }), a === 0 && o();
  });
}
var DY = 0;
function iu(e, t, n, r) {
  this._groups = e, this._parents = t, this._name = n, this._id = r;
}
function HA() {
  return ++DY;
}
var Zl = zg.prototype;
iu.prototype = {
  constructor: iu,
  select: pY,
  selectAll: gY,
  selectChild: Zl.selectChild,
  selectChildren: Zl.selectChildren,
  filter: lY,
  merge: uY,
  selection: vY,
  transition: OY,
  call: Zl.call,
  nodes: Zl.nodes,
  node: Zl.node,
  size: Zl.size,
  empty: Zl.empty,
  each: Zl.each,
  on: dY,
  attr: VK,
  attrTween: QK,
  style: SY,
  styleTween: kY,
  text: TY,
  textTween: RY,
  remove: mY,
  tween: qK,
  delay: eY,
  duration: rY,
  ease: aY,
  easeVarying: oY,
  end: zY,
  [Symbol.iterator]: Zl[Symbol.iterator]
};
function IY(e) {
  return ((e *= 2) <= 1 ? e * e * e : (e -= 2) * e * e + 2) / 2;
}
var LY = {
  time: null,
  // Set on use.
  delay: 0,
  duration: 250,
  ease: IY
};
function PY(e, t) {
  for (var n; !(n = e.__transition) || !(n = n[t]); )
    if (!(e = e.parentNode))
      throw new Error(`transition ${t} not found`);
  return n;
}
function qY(e) {
  var t, n;
  e instanceof iu ? (t = e._id, e = e._name) : (t = HA(), (n = LY).time = e5(), e = e == null ? null : e + "");
  for (var r = this._groups, a = r.length, o = 0; o < a; ++o)
    for (var l = r[o], c = l.length, d, h = 0; h < c; ++h)
      (d = l[h]) && W1(d, e, t, h, l, n || PY(d, t));
  return new iu(r, this._parents, e, t);
}
zg.prototype.interrupt = IK;
zg.prototype.transition = qY;
const Fy = (e) => () => e;
function BY(e, {
  sourceEvent: t,
  target: n,
  transform: r,
  dispatch: a
}) {
  Object.defineProperties(this, {
    type: { value: e, enumerable: !0, configurable: !0 },
    sourceEvent: { value: t, enumerable: !0, configurable: !0 },
    target: { value: n, enumerable: !0, configurable: !0 },
    transform: { value: r, enumerable: !0, configurable: !0 },
    _: { value: a }
  });
}
function ru(e, t, n) {
  this.k = e, this.x = t, this.y = n;
}
ru.prototype = {
  constructor: ru,
  scale: function(e) {
    return e === 1 ? this : new ru(this.k * e, this.x, this.y);
  },
  translate: function(e, t) {
    return e === 0 & t === 0 ? this : new ru(this.k, this.x + this.k * e, this.y + this.k * t);
  },
  apply: function(e) {
    return [e[0] * this.k + this.x, e[1] * this.k + this.y];
  },
  applyX: function(e) {
    return e * this.k + this.x;
  },
  applyY: function(e) {
    return e * this.k + this.y;
  },
  invert: function(e) {
    return [(e[0] - this.x) / this.k, (e[1] - this.y) / this.k];
  },
  invertX: function(e) {
    return (e - this.x) / this.k;
  },
  invertY: function(e) {
    return (e - this.y) / this.k;
  },
  rescaleX: function(e) {
    return e.copy().domain(e.range().map(this.invertX, this).map(e.invert, e));
  },
  rescaleY: function(e) {
    return e.copy().domain(e.range().map(this.invertY, this).map(e.invert, e));
  },
  toString: function() {
    return "translate(" + this.x + "," + this.y + ") scale(" + this.k + ")";
  }
};
var X1 = new ru(1, 0, 0);
GA.prototype = ru.prototype;
function GA(e) {
  for (; !e.__zoom; ) if (!(e = e.parentNode)) return X1;
  return e.__zoom;
}
function Qx(e) {
  e.stopImmediatePropagation();
}
function Xp(e) {
  e.preventDefault(), e.stopImmediatePropagation();
}
function FY(e) {
  return (!e.ctrlKey || e.type === "wheel") && !e.button;
}
function UY() {
  var e = this;
  return e instanceof SVGElement ? (e = e.ownerSVGElement || e, e.hasAttribute("viewBox") ? (e = e.viewBox.baseVal, [[e.x, e.y], [e.x + e.width, e.y + e.height]]) : [[0, 0], [e.width.baseVal.value, e.height.baseVal.value]]) : [[0, 0], [e.clientWidth, e.clientHeight]];
}
function GE() {
  return this.__zoom || X1;
}
function $Y(e) {
  return -e.deltaY * (e.deltaMode === 1 ? 0.05 : e.deltaMode ? 1 : 2e-3) * (e.ctrlKey ? 10 : 1);
}
function HY() {
  return navigator.maxTouchPoints || "ontouchstart" in this;
}
function GY(e, t, n) {
  var r = e.invertX(t[0][0]) - n[0][0], a = e.invertX(t[1][0]) - n[1][0], o = e.invertY(t[0][1]) - n[0][1], l = e.invertY(t[1][1]) - n[1][1];
  return e.translate(
    a > r ? (r + a) / 2 : Math.min(0, r) || Math.max(0, a),
    l > o ? (o + l) / 2 : Math.min(0, o) || Math.max(0, l)
  );
}
function VA() {
  var e = FY, t = UY, n = GY, r = $Y, a = HY, o = [0, 1 / 0], l = [[-1 / 0, -1 / 0], [1 / 0, 1 / 0]], c = 250, d = e1, h = V1("start", "zoom", "end"), p, g, x, b = 500, C = 150, N = 0, T = 10;
  function j(H) {
    H.property("__zoom", GE).on("wheel.zoom", re, { passive: !1 }).on("mousedown.zoom", ie).on("dblclick.zoom", X).filter(a).on("touchstart.zoom", K).on("touchmove.zoom", V).on("touchend.zoom touchcancel.zoom", de).style("-webkit-tap-highlight-color", "rgba(0,0,0,0)");
  }
  j.transform = function(H, se, Z, fe) {
    var he = H.selection ? H.selection() : H;
    he.property("__zoom", GE), H !== he ? q(H, se, Z, fe) : he.interrupt().each(function() {
      D(this, arguments).event(fe).start().zoom(null, typeof se == "function" ? se.apply(this, arguments) : se).end();
    });
  }, j.scaleBy = function(H, se, Z, fe) {
    j.scaleTo(H, function() {
      var he = this.__zoom.k, ge = typeof se == "function" ? se.apply(this, arguments) : se;
      return he * ge;
    }, Z, fe);
  }, j.scaleTo = function(H, se, Z, fe) {
    j.transform(H, function() {
      var he = t.apply(this, arguments), ge = this.__zoom, Q = Z == null ? z(he) : typeof Z == "function" ? Z.apply(this, arguments) : Z, U = ge.invert(Q), ue = typeof se == "function" ? se.apply(this, arguments) : se;
      return n(A(R(ge, ue), Q, U), he, l);
    }, Z, fe);
  }, j.translateBy = function(H, se, Z, fe) {
    j.transform(H, function() {
      return n(this.__zoom.translate(
        typeof se == "function" ? se.apply(this, arguments) : se,
        typeof Z == "function" ? Z.apply(this, arguments) : Z
      ), t.apply(this, arguments), l);
    }, null, fe);
  }, j.translateTo = function(H, se, Z, fe, he) {
    j.transform(H, function() {
      var ge = t.apply(this, arguments), Q = this.__zoom, U = fe == null ? z(ge) : typeof fe == "function" ? fe.apply(this, arguments) : fe;
      return n(X1.translate(U[0], U[1]).scale(Q.k).translate(
        typeof se == "function" ? -se.apply(this, arguments) : -se,
        typeof Z == "function" ? -Z.apply(this, arguments) : -Z
      ), ge, l);
    }, fe, he);
  };
  function R(H, se) {
    return se = Math.max(o[0], Math.min(o[1], se)), se === H.k ? H : new ru(se, H.x, H.y);
  }
  function A(H, se, Z) {
    var fe = se[0] - Z[0] * H.k, he = se[1] - Z[1] * H.k;
    return fe === H.x && he === H.y ? H : new ru(H.k, fe, he);
  }
  function z(H) {
    return [(+H[0][0] + +H[1][0]) / 2, (+H[0][1] + +H[1][1]) / 2];
  }
  function q(H, se, Z, fe) {
    H.on("start.zoom", function() {
      D(this, arguments).event(fe).start();
    }).on("interrupt.zoom end.zoom", function() {
      D(this, arguments).event(fe).end();
    }).tween("zoom", function() {
      var he = this, ge = arguments, Q = D(he, ge).event(fe), U = t.apply(he, ge), ue = Z == null ? z(U) : typeof Z == "function" ? Z.apply(he, ge) : Z, Y = Math.max(U[1][0] - U[0][0], U[1][1] - U[0][1]), le = he.__zoom, xe = typeof se == "function" ? se.apply(he, ge) : se, Se = d(le.invert(ue).concat(Y / le.k), xe.invert(ue).concat(Y / xe.k));
      return function(Oe) {
        if (Oe === 1) Oe = xe;
        else {
          var qe = Se(Oe), Me = Y / qe[2];
          Oe = new ru(Me, ue[0] - qe[0] * Me, ue[1] - qe[1] * Me);
        }
        Q.zoom(null, Oe);
      };
    });
  }
  function D(H, se, Z) {
    return !Z && H.__zooming || new P(H, se);
  }
  function P(H, se) {
    this.that = H, this.args = se, this.active = 0, this.sourceEvent = null, this.extent = t.apply(H, se), this.taps = 0;
  }
  P.prototype = {
    event: function(H) {
      return H && (this.sourceEvent = H), this;
    },
    start: function() {
      return ++this.active === 1 && (this.that.__zooming = this, this.emit("start")), this;
    },
    zoom: function(H, se) {
      return this.mouse && H !== "mouse" && (this.mouse[1] = se.invert(this.mouse[0])), this.touch0 && H !== "touch" && (this.touch0[1] = se.invert(this.touch0[0])), this.touch1 && H !== "touch" && (this.touch1[1] = se.invert(this.touch1[0])), this.that.__zoom = se, this.emit("zoom"), this;
    },
    end: function() {
      return --this.active === 0 && (delete this.that.__zooming, this.emit("end")), this;
    },
    emit: function(H) {
      var se = ts(this.that).datum();
      h.call(
        H,
        this.that,
        new BY(H, {
          sourceEvent: this.sourceEvent,
          target: j,
          transform: this.that.__zoom,
          dispatch: h
        }),
        se
      );
    }
  };
  function re(H, ...se) {
    if (!e.apply(this, arguments)) return;
    var Z = D(this, se).event(H), fe = this.__zoom, he = Math.max(o[0], Math.min(o[1], fe.k * Math.pow(2, r.apply(this, arguments)))), ge = so(H);
    if (Z.wheel)
      (Z.mouse[0][0] !== ge[0] || Z.mouse[0][1] !== ge[1]) && (Z.mouse[1] = fe.invert(Z.mouse[0] = ge)), clearTimeout(Z.wheel);
    else {
      if (fe.k === he) return;
      Z.mouse = [ge, fe.invert(ge)], r1(this), Z.start();
    }
    Xp(H), Z.wheel = setTimeout(Q, C), Z.zoom("mouse", n(A(R(fe, he), Z.mouse[0], Z.mouse[1]), Z.extent, l));
    function Q() {
      Z.wheel = null, Z.end();
    }
  }
  function ie(H, ...se) {
    if (x || !e.apply(this, arguments)) return;
    var Z = H.currentTarget, fe = D(this, se, !0).event(H), he = ts(H.view).on("mousemove.zoom", ue, !0).on("mouseup.zoom", Y, !0), ge = so(H, Z), Q = H.clientX, U = H.clientY;
    TA(H.view), Qx(H), fe.mouse = [ge, this.__zoom.invert(ge)], r1(this), fe.start();
    function ue(le) {
      if (Xp(le), !fe.moved) {
        var xe = le.clientX - Q, Se = le.clientY - U;
        fe.moved = xe * xe + Se * Se > N;
      }
      fe.event(le).zoom("mouse", n(A(fe.that.__zoom, fe.mouse[0] = so(le, Z), fe.mouse[1]), fe.extent, l));
    }
    function Y(le) {
      he.on("mousemove.zoom mouseup.zoom", null), AA(le.view, fe.moved), Xp(le), fe.event(le).end();
    }
  }
  function X(H, ...se) {
    if (e.apply(this, arguments)) {
      var Z = this.__zoom, fe = so(H.changedTouches ? H.changedTouches[0] : H, this), he = Z.invert(fe), ge = Z.k * (H.shiftKey ? 0.5 : 2), Q = n(A(R(Z, ge), fe, he), t.apply(this, se), l);
      Xp(H), c > 0 ? ts(this).transition().duration(c).call(q, Q, fe, H) : ts(this).call(j.transform, Q, fe, H);
    }
  }
  function K(H, ...se) {
    if (e.apply(this, arguments)) {
      var Z = H.touches, fe = Z.length, he = D(this, se, H.changedTouches.length === fe).event(H), ge, Q, U, ue;
      for (Qx(H), Q = 0; Q < fe; ++Q)
        U = Z[Q], ue = so(U, this), ue = [ue, this.__zoom.invert(ue), U.identifier], he.touch0 ? !he.touch1 && he.touch0[2] !== ue[2] && (he.touch1 = ue, he.taps = 0) : (he.touch0 = ue, ge = !0, he.taps = 1 + !!p);
      p && (p = clearTimeout(p)), ge && (he.taps < 2 && (g = ue[0], p = setTimeout(function() {
        p = null;
      }, b)), r1(this), he.start());
    }
  }
  function V(H, ...se) {
    if (this.__zooming) {
      var Z = D(this, se).event(H), fe = H.changedTouches, he = fe.length, ge, Q, U, ue;
      for (Xp(H), ge = 0; ge < he; ++ge)
        Q = fe[ge], U = so(Q, this), Z.touch0 && Z.touch0[2] === Q.identifier ? Z.touch0[0] = U : Z.touch1 && Z.touch1[2] === Q.identifier && (Z.touch1[0] = U);
      if (Q = Z.that.__zoom, Z.touch1) {
        var Y = Z.touch0[0], le = Z.touch0[1], xe = Z.touch1[0], Se = Z.touch1[1], Oe = (Oe = xe[0] - Y[0]) * Oe + (Oe = xe[1] - Y[1]) * Oe, qe = (qe = Se[0] - le[0]) * qe + (qe = Se[1] - le[1]) * qe;
        Q = R(Q, Math.sqrt(Oe / qe)), U = [(Y[0] + xe[0]) / 2, (Y[1] + xe[1]) / 2], ue = [(le[0] + Se[0]) / 2, (le[1] + Se[1]) / 2];
      } else if (Z.touch0) U = Z.touch0[0], ue = Z.touch0[1];
      else return;
      Z.zoom("touch", n(A(Q, U, ue), Z.extent, l));
    }
  }
  function de(H, ...se) {
    if (this.__zooming) {
      var Z = D(this, se).event(H), fe = H.changedTouches, he = fe.length, ge, Q;
      for (Qx(H), x && clearTimeout(x), x = setTimeout(function() {
        x = null;
      }, b), ge = 0; ge < he; ++ge)
        Q = fe[ge], Z.touch0 && Z.touch0[2] === Q.identifier ? delete Z.touch0 : Z.touch1 && Z.touch1[2] === Q.identifier && delete Z.touch1;
      if (Z.touch1 && !Z.touch0 && (Z.touch0 = Z.touch1, delete Z.touch1), Z.touch0) Z.touch0[1] = this.__zoom.invert(Z.touch0[0]);
      else if (Z.end(), Z.taps === 2 && (Q = so(Q, this), Math.hypot(g[0] - Q[0], g[1] - Q[1]) < T)) {
        var U = ts(this).on("dblclick.zoom");
        U && U.apply(this, arguments);
      }
    }
  }
  return j.wheelDelta = function(H) {
    return arguments.length ? (r = typeof H == "function" ? H : Fy(+H), j) : r;
  }, j.filter = function(H) {
    return arguments.length ? (e = typeof H == "function" ? H : Fy(!!H), j) : e;
  }, j.touchable = function(H) {
    return arguments.length ? (a = typeof H == "function" ? H : Fy(!!H), j) : a;
  }, j.extent = function(H) {
    return arguments.length ? (t = typeof H == "function" ? H : Fy([[+H[0][0], +H[0][1]], [+H[1][0], +H[1][1]]]), j) : t;
  }, j.scaleExtent = function(H) {
    return arguments.length ? (o[0] = +H[0], o[1] = +H[1], j) : [o[0], o[1]];
  }, j.translateExtent = function(H) {
    return arguments.length ? (l[0][0] = +H[0][0], l[1][0] = +H[1][0], l[0][1] = +H[0][1], l[1][1] = +H[1][1], j) : [[l[0][0], l[0][1]], [l[1][0], l[1][1]]];
  }, j.constrain = function(H) {
    return arguments.length ? (n = H, j) : n;
  }, j.duration = function(H) {
    return arguments.length ? (c = +H, j) : c;
  }, j.interpolate = function(H) {
    return arguments.length ? (d = H, j) : d;
  }, j.on = function() {
    var H = h.on.apply(h, arguments);
    return H === h ? j : H;
  }, j.clickDistance = function(H) {
    return arguments.length ? (N = (H = +H) * H, j) : Math.sqrt(N);
  }, j.tapDistance = function(H) {
    return arguments.length ? (T = +H, j) : T;
  }, j;
}
const gl = {
  error001: () => "[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",
  error002: () => "It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",
  error003: (e) => `Node type "${e}" not found. Using fallback type "default".`,
  error004: () => "The React Flow parent container needs a width and a height to render the graph.",
  error005: () => "Only child nodes can use a parent extent.",
  error006: () => "Can't create edge. An edge needs a source and a target.",
  error007: (e) => `The old edge with id=${e} does not exist.`,
  error009: (e) => `Marker type "${e}" doesn't exist.`,
  error008: (e, { id: t, sourceHandle: n, targetHandle: r }) => `Couldn't create edge for ${e} handle id: "${e === "source" ? n : r}", edge id: ${t}.`,
  error010: () => "Handle: No node id found. Make sure to only use a Handle inside a custom Node.",
  error011: (e) => `Edge type "${e}" not found. Using fallback type "default".`,
  error012: (e) => `Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,
  error013: (e = "react") => `It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,
  error014: () => "useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",
  error015: () => "It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."
}, _g = [
  [Number.NEGATIVE_INFINITY, Number.NEGATIVE_INFINITY],
  [Number.POSITIVE_INFINITY, Number.POSITIVE_INFINITY]
], KA = ["Enter", " ", "Escape"], YA = {
  "node.a11yDescription.default": "Press enter or space to select a node. Press delete to remove it and escape to cancel.",
  "node.a11yDescription.keyboardDisabled": "Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.",
  "node.a11yDescription.ariaLiveMessage": ({ direction: e, x: t, y: n }) => `Moved selected node ${e}. New position, x: ${t}, y: ${n}`,
  "edge.a11yDescription.default": "Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.",
  // Control elements
  "controls.ariaLabel": "Control Panel",
  "controls.zoomIn.ariaLabel": "Zoom In",
  "controls.zoomOut.ariaLabel": "Zoom Out",
  "controls.fitView.ariaLabel": "Fit View",
  "controls.interactive.ariaLabel": "Toggle Interactivity",
  // Mini map
  "minimap.ariaLabel": "Mini Map",
  // Handle
  "handle.ariaLabel": "Handle"
};
var Yh;
(function(e) {
  e.Strict = "strict", e.Loose = "loose";
})(Yh || (Yh = {}));
var Jf;
(function(e) {
  e.Free = "free", e.Vertical = "vertical", e.Horizontal = "horizontal";
})(Jf || (Jf = {}));
var Sg;
(function(e) {
  e.Partial = "partial", e.Full = "full";
})(Sg || (Sg = {}));
const WA = {
  inProgress: !1,
  isValid: null,
  from: null,
  fromHandle: null,
  fromPosition: null,
  fromNode: null,
  to: null,
  toHandle: null,
  toPosition: null,
  toNode: null,
  pointer: null
};
var pc;
(function(e) {
  e.Bezier = "default", e.Straight = "straight", e.Step = "step", e.SmoothStep = "smoothstep", e.SimpleBezier = "simplebezier";
})(pc || (pc = {}));
var Cg;
(function(e) {
  e.Arrow = "arrow", e.ArrowClosed = "arrowclosed";
})(Cg || (Cg = {}));
var pt;
(function(e) {
  e.Left = "left", e.Top = "top", e.Right = "right", e.Bottom = "bottom";
})(pt || (pt = {}));
const VE = {
  [pt.Left]: pt.Right,
  [pt.Right]: pt.Left,
  [pt.Top]: pt.Bottom,
  [pt.Bottom]: pt.Top
};
function XA(e) {
  return e === null ? null : e ? "valid" : "invalid";
}
const QA = (e) => "id" in e && "source" in e && "target" in e, VY = (e) => "id" in e && "position" in e && !("source" in e) && !("target" in e), r5 = (e) => "id" in e && "internals" in e && !("source" in e) && !("target" in e), Ig = (e, t = [0, 0]) => {
  const { width: n, height: r } = ou(e), a = e.origin ?? t, o = n * a[0], l = r * a[1];
  return {
    x: e.position.x - o,
    y: e.position.y - l
  };
}, KY = (e, t = { nodeOrigin: [0, 0] }) => {
  if (e.length === 0)
    return { x: 0, y: 0, width: 0, height: 0 };
  const n = e.reduce((r, a) => {
    const o = typeof a == "string";
    let l = !t.nodeLookup && !o ? a : void 0;
    t.nodeLookup && (l = o ? t.nodeLookup.get(a) : r5(a) ? a : t.nodeLookup.get(a.id));
    const c = l ? C1(l, t.nodeOrigin) : { x: 0, y: 0, x2: 0, y2: 0 };
    return Q1(r, c);
  }, { x: 1 / 0, y: 1 / 0, x2: -1 / 0, y2: -1 / 0 });
  return Z1(n);
}, Lg = (e, t = {}) => {
  let n = { x: 1 / 0, y: 1 / 0, x2: -1 / 0, y2: -1 / 0 }, r = !1;
  return e.forEach((a) => {
    (t.filter === void 0 || t.filter(a)) && (n = Q1(n, C1(a)), r = !0);
  }), r ? Z1(n) : { x: 0, y: 0, width: 0, height: 0 };
}, i5 = (e, t, [n, r, a] = [0, 0, 1], o = !1, l = !1) => {
  const c = {
    ...qg(t, [n, r, a]),
    width: t.width / a,
    height: t.height / a
  }, d = [];
  for (const h of e.values()) {
    const { measured: p, selectable: g = !0, hidden: x = !1 } = h;
    if (l && !g || x)
      continue;
    const b = p.width ?? h.width ?? h.initialWidth ?? null, C = p.height ?? h.height ?? h.initialHeight ?? null, N = Eg(c, Xh(h)), T = (b ?? 0) * (C ?? 0), j = o && N > 0;
    (!h.internals.handleBounds || j || N >= T || h.dragging) && d.push(h);
  }
  return d;
}, YY = (e, t) => {
  const n = /* @__PURE__ */ new Set();
  return e.forEach((r) => {
    n.add(r.id);
  }), t.filter((r) => n.has(r.source) || n.has(r.target));
};
function WY(e, t) {
  const n = /* @__PURE__ */ new Map(), r = t != null && t.nodes ? new Set(t.nodes.map((a) => a.id)) : null;
  return e.forEach((a) => {
    a.measured.width && a.measured.height && ((t == null ? void 0 : t.includeHiddenNodes) || !a.hidden) && (!r || r.has(a.id)) && n.set(a.id, a);
  }), n;
}
async function XY({ nodes: e, width: t, height: n, panZoom: r, minZoom: a, maxZoom: o }, l) {
  if (e.size === 0)
    return Promise.resolve(!0);
  const c = WY(e, l), d = Lg(c), h = a5(d, t, n, (l == null ? void 0 : l.minZoom) ?? a, (l == null ? void 0 : l.maxZoom) ?? o, (l == null ? void 0 : l.padding) ?? 0.1);
  return await r.setViewport(h, {
    duration: l == null ? void 0 : l.duration,
    ease: l == null ? void 0 : l.ease,
    interpolate: l == null ? void 0 : l.interpolate
  }), Promise.resolve(!0);
}
function ZA({ nodeId: e, nextPosition: t, nodeLookup: n, nodeOrigin: r = [0, 0], nodeExtent: a, onError: o }) {
  const l = n.get(e), c = l.parentId ? n.get(l.parentId) : void 0, { x: d, y: h } = c ? c.internals.positionAbsolute : { x: 0, y: 0 }, p = l.origin ?? r;
  let g = l.extent || a;
  if (l.extent === "parent" && !l.expandParent)
    if (!c)
      o == null || o("005", gl.error005());
    else {
      const b = c.measured.width, C = c.measured.height;
      b && C && (g = [
        [d, h],
        [d + b, h + C]
      ]);
    }
  else c && Qh(l.extent) && (g = [
    [l.extent[0][0] + d, l.extent[0][1] + h],
    [l.extent[1][0] + d, l.extent[1][1] + h]
  ]);
  const x = Qh(g) ? ad(t, g, l.measured) : t;
  return (l.measured.width === void 0 || l.measured.height === void 0) && (o == null || o("015", gl.error015())), {
    position: {
      x: x.x - d + (l.measured.width ?? 0) * p[0],
      y: x.y - h + (l.measured.height ?? 0) * p[1]
    },
    positionAbsolute: x
  };
}
async function QY({ nodesToRemove: e = [], edgesToRemove: t = [], nodes: n, edges: r, onBeforeDelete: a }) {
  const o = new Set(e.map((x) => x.id)), l = [];
  for (const x of n) {
    if (x.deletable === !1)
      continue;
    const b = o.has(x.id), C = !b && x.parentId && l.find((N) => N.id === x.parentId);
    (b || C) && l.push(x);
  }
  const c = new Set(t.map((x) => x.id)), d = r.filter((x) => x.deletable !== !1), p = YY(l, d);
  for (const x of d)
    c.has(x.id) && !p.find((C) => C.id === x.id) && p.push(x);
  if (!a)
    return {
      edges: p,
      nodes: l
    };
  const g = await a({
    nodes: l,
    edges: p
  });
  return typeof g == "boolean" ? g ? { edges: p, nodes: l } : { edges: [], nodes: [] } : g;
}
const Wh = (e, t = 0, n = 1) => Math.min(Math.max(e, t), n), ad = (e = { x: 0, y: 0 }, t, n) => ({
  x: Wh(e.x, t[0][0], t[1][0] - ((n == null ? void 0 : n.width) ?? 0)),
  y: Wh(e.y, t[0][1], t[1][1] - ((n == null ? void 0 : n.height) ?? 0))
});
function JA(e, t, n) {
  const { width: r, height: a } = ou(n), { x: o, y: l } = n.internals.positionAbsolute;
  return ad(e, [
    [o, l],
    [o + r, l + a]
  ], t);
}
const KE = (e, t, n) => e < t ? Wh(Math.abs(e - t), 1, t) / t : e > n ? -Wh(Math.abs(e - n), 1, t) / t : 0, eM = (e, t, n = 15, r = 40) => {
  const a = KE(e.x, r, t.width - r) * n, o = KE(e.y, r, t.height - r) * n;
  return [a, o];
}, Q1 = (e, t) => ({
  x: Math.min(e.x, t.x),
  y: Math.min(e.y, t.y),
  x2: Math.max(e.x2, t.x2),
  y2: Math.max(e.y2, t.y2)
}), oS = ({ x: e, y: t, width: n, height: r }) => ({
  x: e,
  y: t,
  x2: e + n,
  y2: t + r
}), Z1 = ({ x: e, y: t, x2: n, y2: r }) => ({
  x: e,
  y: t,
  width: n - e,
  height: r - t
}), Xh = (e, t = [0, 0]) => {
  var a, o;
  const { x: n, y: r } = r5(e) ? e.internals.positionAbsolute : Ig(e, t);
  return {
    x: n,
    y: r,
    width: ((a = e.measured) == null ? void 0 : a.width) ?? e.width ?? e.initialWidth ?? 0,
    height: ((o = e.measured) == null ? void 0 : o.height) ?? e.height ?? e.initialHeight ?? 0
  };
}, C1 = (e, t = [0, 0]) => {
  var a, o;
  const { x: n, y: r } = r5(e) ? e.internals.positionAbsolute : Ig(e, t);
  return {
    x: n,
    y: r,
    x2: n + (((a = e.measured) == null ? void 0 : a.width) ?? e.width ?? e.initialWidth ?? 0),
    y2: r + (((o = e.measured) == null ? void 0 : o.height) ?? e.height ?? e.initialHeight ?? 0)
  };
}, tM = (e, t) => Z1(Q1(oS(e), oS(t))), Eg = (e, t) => {
  const n = Math.max(0, Math.min(e.x + e.width, t.x + t.width) - Math.max(e.x, t.x)), r = Math.max(0, Math.min(e.y + e.height, t.y + t.height) - Math.max(e.y, t.y));
  return Math.ceil(n * r);
}, YE = (e) => fo(e.width) && fo(e.height) && fo(e.x) && fo(e.y), fo = (e) => !isNaN(e) && isFinite(e), ZY = (e, t) => {
}, Pg = (e, t = [1, 1]) => ({
  x: t[0] * Math.round(e.x / t[0]),
  y: t[1] * Math.round(e.y / t[1])
}), qg = ({ x: e, y: t }, [n, r, a], o = !1, l = [1, 1]) => {
  const c = {
    x: (e - n) / a,
    y: (t - r) / a
  };
  return o ? Pg(c, l) : c;
}, E1 = ({ x: e, y: t }, [n, r, a]) => ({
  x: e * a + n,
  y: t * a + r
});
function Rh(e, t) {
  if (typeof e == "number")
    return Math.floor((t - t / (1 + e)) * 0.5);
  if (typeof e == "string" && e.endsWith("px")) {
    const n = parseFloat(e);
    if (!Number.isNaN(n))
      return Math.floor(n);
  }
  if (typeof e == "string" && e.endsWith("%")) {
    const n = parseFloat(e);
    if (!Number.isNaN(n))
      return Math.floor(t * n * 0.01);
  }
  return console.error(`[React Flow] The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`), 0;
}
function JY(e, t, n) {
  if (typeof e == "string" || typeof e == "number") {
    const r = Rh(e, n), a = Rh(e, t);
    return {
      top: r,
      right: a,
      bottom: r,
      left: a,
      x: a * 2,
      y: r * 2
    };
  }
  if (typeof e == "object") {
    const r = Rh(e.top ?? e.y ?? 0, n), a = Rh(e.bottom ?? e.y ?? 0, n), o = Rh(e.left ?? e.x ?? 0, t), l = Rh(e.right ?? e.x ?? 0, t);
    return { top: r, right: l, bottom: a, left: o, x: o + l, y: r + a };
  }
  return { top: 0, right: 0, bottom: 0, left: 0, x: 0, y: 0 };
}
function eW(e, t, n, r, a, o) {
  const { x: l, y: c } = E1(e, [t, n, r]), { x: d, y: h } = E1({ x: e.x + e.width, y: e.y + e.height }, [t, n, r]), p = a - d, g = o - h;
  return {
    left: Math.floor(l),
    top: Math.floor(c),
    right: Math.floor(p),
    bottom: Math.floor(g)
  };
}
const a5 = (e, t, n, r, a, o) => {
  const l = JY(o, t, n), c = (t - l.x) / e.width, d = (n - l.y) / e.height, h = Math.min(c, d), p = Wh(h, r, a), g = e.x + e.width / 2, x = e.y + e.height / 2, b = t / 2 - g * p, C = n / 2 - x * p, N = eW(e, b, C, p, t, n), T = {
    left: Math.min(N.left - l.left, 0),
    top: Math.min(N.top - l.top, 0),
    right: Math.min(N.right - l.right, 0),
    bottom: Math.min(N.bottom - l.bottom, 0)
  };
  return {
    x: b - T.left + T.right,
    y: C - T.top + T.bottom,
    zoom: p
  };
}, kg = () => {
  var e;
  return typeof navigator < "u" && ((e = navigator == null ? void 0 : navigator.userAgent) == null ? void 0 : e.indexOf("Mac")) >= 0;
};
function Qh(e) {
  return e != null && e !== "parent";
}
function ou(e) {
  var t, n;
  return {
    width: ((t = e.measured) == null ? void 0 : t.width) ?? e.width ?? e.initialWidth ?? 0,
    height: ((n = e.measured) == null ? void 0 : n.height) ?? e.height ?? e.initialHeight ?? 0
  };
}
function nM(e) {
  var t, n;
  return (((t = e.measured) == null ? void 0 : t.width) ?? e.width ?? e.initialWidth) !== void 0 && (((n = e.measured) == null ? void 0 : n.height) ?? e.height ?? e.initialHeight) !== void 0;
}
function rM(e, t = { width: 0, height: 0 }, n, r, a) {
  const o = { ...e }, l = r.get(n);
  if (l) {
    const c = l.origin || a;
    o.x += l.internals.positionAbsolute.x - (t.width ?? 0) * c[0], o.y += l.internals.positionAbsolute.y - (t.height ?? 0) * c[1];
  }
  return o;
}
function WE(e, t) {
  if (e.size !== t.size)
    return !1;
  for (const n of e)
    if (!t.has(n))
      return !1;
  return !0;
}
function tW() {
  let e, t;
  return { promise: new Promise((r, a) => {
    e = r, t = a;
  }), resolve: e, reject: t };
}
function nW(e) {
  return { ...YA, ...e || {} };
}
function fg(e, { snapGrid: t = [0, 0], snapToGrid: n = !1, transform: r, containerBounds: a }) {
  const { x: o, y: l } = ho(e), c = qg({ x: o - ((a == null ? void 0 : a.left) ?? 0), y: l - ((a == null ? void 0 : a.top) ?? 0) }, r), { x: d, y: h } = n ? Pg(c, t) : c;
  return {
    xSnapped: d,
    ySnapped: h,
    ...c
  };
}
const s5 = (e) => ({
  width: e.offsetWidth,
  height: e.offsetHeight
}), iM = (e) => {
  var t;
  return ((t = e == null ? void 0 : e.getRootNode) == null ? void 0 : t.call(e)) || (window == null ? void 0 : window.document);
}, rW = ["INPUT", "SELECT", "TEXTAREA"];
function aM(e) {
  var r, a;
  const t = ((a = (r = e.composedPath) == null ? void 0 : r.call(e)) == null ? void 0 : a[0]) || e.target;
  return (t == null ? void 0 : t.nodeType) !== 1 ? !1 : rW.includes(t.nodeName) || t.hasAttribute("contenteditable") || !!t.closest(".nokey");
}
const sM = (e) => "clientX" in e, ho = (e, t) => {
  var o, l;
  const n = sM(e), r = n ? e.clientX : (o = e.touches) == null ? void 0 : o[0].clientX, a = n ? e.clientY : (l = e.touches) == null ? void 0 : l[0].clientY;
  return {
    x: r - ((t == null ? void 0 : t.left) ?? 0),
    y: a - ((t == null ? void 0 : t.top) ?? 0)
  };
}, XE = (e, t, n, r, a) => {
  const o = t.querySelectorAll(`.${e}`);
  return !o || !o.length ? null : Array.from(o).map((l) => {
    const c = l.getBoundingClientRect();
    return {
      id: l.getAttribute("data-handleid"),
      type: e,
      nodeId: a,
      position: l.getAttribute("data-handlepos"),
      x: (c.left - n.left) / r,
      y: (c.top - n.top) / r,
      ...s5(l)
    };
  });
};
function oM({ sourceX: e, sourceY: t, targetX: n, targetY: r, sourceControlX: a, sourceControlY: o, targetControlX: l, targetControlY: c }) {
  const d = e * 0.125 + a * 0.375 + l * 0.375 + n * 0.125, h = t * 0.125 + o * 0.375 + c * 0.375 + r * 0.125, p = Math.abs(d - e), g = Math.abs(h - t);
  return [d, h, p, g];
}
function Uy(e, t) {
  return e >= 0 ? 0.5 * e : t * 25 * Math.sqrt(-e);
}
function QE({ pos: e, x1: t, y1: n, x2: r, y2: a, c: o }) {
  switch (e) {
    case pt.Left:
      return [t - Uy(t - r, o), n];
    case pt.Right:
      return [t + Uy(r - t, o), n];
    case pt.Top:
      return [t, n - Uy(n - a, o)];
    case pt.Bottom:
      return [t, n + Uy(a - n, o)];
  }
}
function lM({ sourceX: e, sourceY: t, sourcePosition: n = pt.Bottom, targetX: r, targetY: a, targetPosition: o = pt.Top, curvature: l = 0.25 }) {
  const [c, d] = QE({
    pos: n,
    x1: e,
    y1: t,
    x2: r,
    y2: a,
    c: l
  }), [h, p] = QE({
    pos: o,
    x1: r,
    y1: a,
    x2: e,
    y2: t,
    c: l
  }), [g, x, b, C] = oM({
    sourceX: e,
    sourceY: t,
    targetX: r,
    targetY: a,
    sourceControlX: c,
    sourceControlY: d,
    targetControlX: h,
    targetControlY: p
  });
  return [
    `M${e},${t} C${c},${d} ${h},${p} ${r},${a}`,
    g,
    x,
    b,
    C
  ];
}
function uM({ sourceX: e, sourceY: t, targetX: n, targetY: r }) {
  const a = Math.abs(n - e) / 2, o = n < e ? n + a : n - a, l = Math.abs(r - t) / 2, c = r < t ? r + l : r - l;
  return [o, c, a, l];
}
function iW({ sourceNode: e, targetNode: t, selected: n = !1, zIndex: r = 0, elevateOnSelect: a = !1, zIndexMode: o = "basic" }) {
  if (o === "manual")
    return r;
  const l = a && n ? r + 1e3 : r, c = Math.max(e.parentId || a && e.selected ? e.internals.z : 0, t.parentId || a && t.selected ? t.internals.z : 0);
  return l + c;
}
function aW({ sourceNode: e, targetNode: t, width: n, height: r, transform: a }) {
  const o = Q1(C1(e), C1(t));
  o.x === o.x2 && (o.x2 += 1), o.y === o.y2 && (o.y2 += 1);
  const l = {
    x: -a[0] / a[2],
    y: -a[1] / a[2],
    width: n / a[2],
    height: r / a[2]
  };
  return Eg(l, Z1(o)) > 0;
}
const sW = ({ source: e, sourceHandle: t, target: n, targetHandle: r }) => `xy-edge__${e}${t || ""}-${n}${r || ""}`, oW = (e, t) => t.some((n) => n.source === e.source && n.target === e.target && (n.sourceHandle === e.sourceHandle || !n.sourceHandle && !e.sourceHandle) && (n.targetHandle === e.targetHandle || !n.targetHandle && !e.targetHandle)), lW = (e, t, n = {}) => {
  if (!e.source || !e.target)
    return t;
  const r = n.getEdgeId || sW;
  let a;
  return QA(e) ? a = { ...e } : a = {
    ...e,
    id: r(e)
  }, oW(a, t) ? t : (a.sourceHandle === null && delete a.sourceHandle, a.targetHandle === null && delete a.targetHandle, t.concat(a));
};
function cM({ sourceX: e, sourceY: t, targetX: n, targetY: r }) {
  const [a, o, l, c] = uM({
    sourceX: e,
    sourceY: t,
    targetX: n,
    targetY: r
  });
  return [`M ${e},${t}L ${n},${r}`, a, o, l, c];
}
const ZE = {
  [pt.Left]: { x: -1, y: 0 },
  [pt.Right]: { x: 1, y: 0 },
  [pt.Top]: { x: 0, y: -1 },
  [pt.Bottom]: { x: 0, y: 1 }
}, uW = ({ source: e, sourcePosition: t = pt.Bottom, target: n }) => t === pt.Left || t === pt.Right ? e.x < n.x ? { x: 1, y: 0 } : { x: -1, y: 0 } : e.y < n.y ? { x: 0, y: 1 } : { x: 0, y: -1 }, JE = (e, t) => Math.sqrt(Math.pow(t.x - e.x, 2) + Math.pow(t.y - e.y, 2));
function cW({ source: e, sourcePosition: t = pt.Bottom, target: n, targetPosition: r = pt.Top, center: a, offset: o, stepPosition: l }) {
  const c = ZE[t], d = ZE[r], h = { x: e.x + c.x * o, y: e.y + c.y * o }, p = { x: n.x + d.x * o, y: n.y + d.y * o }, g = uW({
    source: h,
    sourcePosition: t,
    target: p
  }), x = g.x !== 0 ? "x" : "y", b = g[x];
  let C = [], N, T;
  const j = { x: 0, y: 0 }, R = { x: 0, y: 0 }, [, , A, z] = uM({
    sourceX: e.x,
    sourceY: e.y,
    targetX: n.x,
    targetY: n.y
  });
  if (c[x] * d[x] === -1) {
    x === "x" ? (N = a.x ?? h.x + (p.x - h.x) * l, T = a.y ?? (h.y + p.y) / 2) : (N = a.x ?? (h.x + p.x) / 2, T = a.y ?? h.y + (p.y - h.y) * l);
    const D = [
      { x: N, y: h.y },
      { x: N, y: p.y }
    ], P = [
      { x: h.x, y: T },
      { x: p.x, y: T }
    ];
    c[x] === b ? C = x === "x" ? D : P : C = x === "x" ? P : D;
  } else {
    const D = [{ x: h.x, y: p.y }], P = [{ x: p.x, y: h.y }];
    if (x === "x" ? C = c.x === b ? P : D : C = c.y === b ? D : P, t === r) {
      const V = Math.abs(e[x] - n[x]);
      if (V <= o) {
        const de = Math.min(o - 1, o - V);
        c[x] === b ? j[x] = (h[x] > e[x] ? -1 : 1) * de : R[x] = (p[x] > n[x] ? -1 : 1) * de;
      }
    }
    if (t !== r) {
      const V = x === "x" ? "y" : "x", de = c[x] === d[V], H = h[V] > p[V], se = h[V] < p[V];
      (c[x] === 1 && (!de && H || de && se) || c[x] !== 1 && (!de && se || de && H)) && (C = x === "x" ? D : P);
    }
    const re = { x: h.x + j.x, y: h.y + j.y }, ie = { x: p.x + R.x, y: p.y + R.y }, X = Math.max(Math.abs(re.x - C[0].x), Math.abs(ie.x - C[0].x)), K = Math.max(Math.abs(re.y - C[0].y), Math.abs(ie.y - C[0].y));
    X >= K ? (N = (re.x + ie.x) / 2, T = C[0].y) : (N = C[0].x, T = (re.y + ie.y) / 2);
  }
  return [[
    e,
    { x: h.x + j.x, y: h.y + j.y },
    ...C,
    { x: p.x + R.x, y: p.y + R.y },
    n
  ], N, T, A, z];
}
function fW(e, t, n, r) {
  const a = Math.min(JE(e, t) / 2, JE(t, n) / 2, r), { x: o, y: l } = t;
  if (e.x === o && o === n.x || e.y === l && l === n.y)
    return `L${o} ${l}`;
  if (e.y === l) {
    const h = e.x < n.x ? -1 : 1, p = e.y < n.y ? 1 : -1;
    return `L ${o + a * h},${l}Q ${o},${l} ${o},${l + a * p}`;
  }
  const c = e.x < n.x ? 1 : -1, d = e.y < n.y ? -1 : 1;
  return `L ${o},${l + a * d}Q ${o},${l} ${o + a * c},${l}`;
}
function lS({ sourceX: e, sourceY: t, sourcePosition: n = pt.Bottom, targetX: r, targetY: a, targetPosition: o = pt.Top, borderRadius: l = 5, centerX: c, centerY: d, offset: h = 20, stepPosition: p = 0.5 }) {
  const [g, x, b, C, N] = cW({
    source: { x: e, y: t },
    sourcePosition: n,
    target: { x: r, y: a },
    targetPosition: o,
    center: { x: c, y: d },
    offset: h,
    stepPosition: p
  });
  return [g.reduce((j, R, A) => {
    let z = "";
    return A > 0 && A < g.length - 1 ? z = fW(g[A - 1], R, g[A + 1], l) : z = `${A === 0 ? "M" : "L"}${R.x} ${R.y}`, j += z, j;
  }, ""), x, b, C, N];
}
function e6(e) {
  var t;
  return e && !!(e.internals.handleBounds || (t = e.handles) != null && t.length) && !!(e.measured.width || e.width || e.initialWidth);
}
function dW(e) {
  var g;
  const { sourceNode: t, targetNode: n } = e;
  if (!e6(t) || !e6(n))
    return null;
  const r = t.internals.handleBounds || t6(t.handles), a = n.internals.handleBounds || t6(n.handles), o = n6((r == null ? void 0 : r.source) ?? [], e.sourceHandle), l = n6(
    // when connection type is loose we can define all handles as sources and connect source -> source
    e.connectionMode === Yh.Strict ? (a == null ? void 0 : a.target) ?? [] : ((a == null ? void 0 : a.target) ?? []).concat((a == null ? void 0 : a.source) ?? []),
    e.targetHandle
  );
  if (!o || !l)
    return (g = e.onError) == null || g.call(e, "008", gl.error008(o ? "target" : "source", {
      id: e.id,
      sourceHandle: e.sourceHandle,
      targetHandle: e.targetHandle
    })), null;
  const c = (o == null ? void 0 : o.position) || pt.Bottom, d = (l == null ? void 0 : l.position) || pt.Top, h = sd(t, o, c), p = sd(n, l, d);
  return {
    sourceX: h.x,
    sourceY: h.y,
    targetX: p.x,
    targetY: p.y,
    sourcePosition: c,
    targetPosition: d
  };
}
function t6(e) {
  if (!e)
    return null;
  const t = [], n = [];
  for (const r of e)
    r.width = r.width ?? 1, r.height = r.height ?? 1, r.type === "source" ? t.push(r) : r.type === "target" && n.push(r);
  return {
    source: t,
    target: n
  };
}
function sd(e, t, n = pt.Left, r = !1) {
  const a = ((t == null ? void 0 : t.x) ?? 0) + e.internals.positionAbsolute.x, o = ((t == null ? void 0 : t.y) ?? 0) + e.internals.positionAbsolute.y, { width: l, height: c } = t ?? ou(e);
  if (r)
    return { x: a + l / 2, y: o + c / 2 };
  switch ((t == null ? void 0 : t.position) ?? n) {
    case pt.Top:
      return { x: a + l / 2, y: o };
    case pt.Right:
      return { x: a + l, y: o + c / 2 };
    case pt.Bottom:
      return { x: a + l / 2, y: o + c };
    case pt.Left:
      return { x: a, y: o + c / 2 };
  }
}
function n6(e, t) {
  return e && (t ? e.find((n) => n.id === t) : e[0]) || null;
}
function uS(e, t) {
  return e ? typeof e == "string" ? e : `${t ? `${t}__` : ""}${Object.keys(e).sort().map((r) => `${r}=${e[r]}`).join("&")}` : "";
}
function hW(e, { id: t, defaultColor: n, defaultMarkerStart: r, defaultMarkerEnd: a }) {
  const o = /* @__PURE__ */ new Set();
  return e.reduce((l, c) => ([c.markerStart || r, c.markerEnd || a].forEach((d) => {
    if (d && typeof d == "object") {
      const h = uS(d, t);
      o.has(h) || (l.push({ id: h, color: d.color || n, ...d }), o.add(h));
    }
  }), l), []).sort((l, c) => l.id.localeCompare(c.id));
}
const fM = 1e3, mW = 10, o5 = {
  nodeOrigin: [0, 0],
  nodeExtent: _g,
  elevateNodesOnSelect: !0,
  zIndexMode: "basic",
  defaults: {}
}, pW = {
  ...o5,
  checkEquality: !0
};
function l5(e, t) {
  const n = { ...e };
  for (const r in t)
    t[r] !== void 0 && (n[r] = t[r]);
  return n;
}
function gW(e, t, n) {
  const r = l5(o5, n);
  for (const a of e.values())
    if (a.parentId)
      c5(a, e, t, r);
    else {
      const o = Ig(a, r.nodeOrigin), l = Qh(a.extent) ? a.extent : r.nodeExtent, c = ad(o, l, ou(a));
      a.internals.positionAbsolute = c;
    }
}
function yW(e, t) {
  if (!e.handles)
    return e.measured ? t == null ? void 0 : t.internals.handleBounds : void 0;
  const n = [], r = [];
  for (const a of e.handles) {
    const o = {
      id: a.id,
      width: a.width ?? 1,
      height: a.height ?? 1,
      nodeId: e.id,
      x: a.x,
      y: a.y,
      position: a.position,
      type: a.type
    };
    a.type === "source" ? n.push(o) : a.type === "target" && r.push(o);
  }
  return {
    source: n,
    target: r
  };
}
function u5(e) {
  return e === "manual";
}
function cS(e, t, n, r = {}) {
  var h, p;
  const a = l5(pW, r), o = { i: 0 }, l = new Map(t), c = a != null && a.elevateNodesOnSelect && !u5(a.zIndexMode) ? fM : 0;
  let d = e.length > 0;
  t.clear(), n.clear();
  for (const g of e) {
    let x = l.get(g.id);
    if (a.checkEquality && g === (x == null ? void 0 : x.internals.userNode))
      t.set(g.id, x);
    else {
      const b = Ig(g, a.nodeOrigin), C = Qh(g.extent) ? g.extent : a.nodeExtent, N = ad(b, C, ou(g));
      x = {
        ...a.defaults,
        ...g,
        measured: {
          width: (h = g.measured) == null ? void 0 : h.width,
          height: (p = g.measured) == null ? void 0 : p.height
        },
        internals: {
          positionAbsolute: N,
          // if user re-initializes the node or removes `measured` for whatever reason, we reset the handleBounds so that the node gets re-measured
          handleBounds: yW(g, x),
          z: dM(g, c, a.zIndexMode),
          userNode: g
        }
      }, t.set(g.id, x);
    }
    (x.measured === void 0 || x.measured.width === void 0 || x.measured.height === void 0) && !x.hidden && (d = !1), g.parentId && c5(x, t, n, r, o);
  }
  return d;
}
function vW(e, t) {
  if (!e.parentId)
    return;
  const n = t.get(e.parentId);
  n ? n.set(e.id, e) : t.set(e.parentId, /* @__PURE__ */ new Map([[e.id, e]]));
}
function c5(e, t, n, r, a) {
  const { elevateNodesOnSelect: o, nodeOrigin: l, nodeExtent: c, zIndexMode: d } = l5(o5, r), h = e.parentId, p = t.get(h);
  if (!p) {
    console.warn(`Parent node ${h} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);
    return;
  }
  vW(e, n), a && !p.parentId && p.internals.rootParentIndex === void 0 && d === "auto" && (p.internals.rootParentIndex = ++a.i, p.internals.z = p.internals.z + a.i * mW), a && p.internals.rootParentIndex !== void 0 && (a.i = p.internals.rootParentIndex);
  const g = o && !u5(d) ? fM : 0, { x, y: b, z: C } = xW(e, p, l, c, g, d), { positionAbsolute: N } = e.internals, T = x !== N.x || b !== N.y;
  (T || C !== e.internals.z) && t.set(e.id, {
    ...e,
    internals: {
      ...e.internals,
      positionAbsolute: T ? { x, y: b } : N,
      z: C
    }
  });
}
function dM(e, t, n) {
  const r = fo(e.zIndex) ? e.zIndex : 0;
  return u5(n) ? r : r + (e.selected ? t : 0);
}
function xW(e, t, n, r, a, o) {
  const { x: l, y: c } = t.internals.positionAbsolute, d = ou(e), h = Ig(e, n), p = Qh(e.extent) ? ad(h, e.extent, d) : h;
  let g = ad({ x: l + p.x, y: c + p.y }, r, d);
  e.extent === "parent" && (g = JA(g, d, t));
  const x = dM(e, a, o), b = t.internals.z ?? 0;
  return {
    x: g.x,
    y: g.y,
    z: b >= x ? b + 1 : x
  };
}
function f5(e, t, n, r = [0, 0]) {
  var l;
  const a = [], o = /* @__PURE__ */ new Map();
  for (const c of e) {
    const d = t.get(c.parentId);
    if (!d)
      continue;
    const h = ((l = o.get(c.parentId)) == null ? void 0 : l.expandedRect) ?? Xh(d), p = tM(h, c.rect);
    o.set(c.parentId, { expandedRect: p, parent: d });
  }
  return o.size > 0 && o.forEach(({ expandedRect: c, parent: d }, h) => {
    var A;
    const p = d.internals.positionAbsolute, g = ou(d), x = d.origin ?? r, b = c.x < p.x ? Math.round(Math.abs(p.x - c.x)) : 0, C = c.y < p.y ? Math.round(Math.abs(p.y - c.y)) : 0, N = Math.max(g.width, Math.round(c.width)), T = Math.max(g.height, Math.round(c.height)), j = (N - g.width) * x[0], R = (T - g.height) * x[1];
    (b > 0 || C > 0 || j || R) && (a.push({
      id: h,
      type: "position",
      position: {
        x: d.position.x - b + j,
        y: d.position.y - C + R
      }
    }), (A = n.get(h)) == null || A.forEach((z) => {
      e.some((q) => q.id === z.id) || a.push({
        id: z.id,
        type: "position",
        position: {
          x: z.position.x + b,
          y: z.position.y + C
        }
      });
    })), (g.width < c.width || g.height < c.height || b || C) && a.push({
      id: h,
      type: "dimensions",
      setAttributes: !0,
      dimensions: {
        width: N + (b ? x[0] * b - j : 0),
        height: T + (C ? x[1] * C - R : 0)
      }
    });
  }), a;
}
function bW(e, t, n, r, a, o, l) {
  const c = r == null ? void 0 : r.querySelector(".xyflow__viewport");
  let d = !1;
  if (!c)
    return { changes: [], updatedInternals: d };
  const h = [], p = window.getComputedStyle(c), { m22: g } = new window.DOMMatrixReadOnly(p.transform), x = [];
  for (const b of e.values()) {
    const C = t.get(b.id);
    if (!C)
      continue;
    if (C.hidden) {
      t.set(C.id, {
        ...C,
        internals: {
          ...C.internals,
          handleBounds: void 0
        }
      }), d = !0;
      continue;
    }
    const N = s5(b.nodeElement), T = C.measured.width !== N.width || C.measured.height !== N.height;
    if (!!(N.width && N.height && (T || !C.internals.handleBounds || b.force))) {
      const R = b.nodeElement.getBoundingClientRect(), A = Qh(C.extent) ? C.extent : o;
      let { positionAbsolute: z } = C.internals;
      C.parentId && C.extent === "parent" ? z = JA(z, N, t.get(C.parentId)) : A && (z = ad(z, A, N));
      const q = {
        ...C,
        measured: N,
        internals: {
          ...C.internals,
          positionAbsolute: z,
          handleBounds: {
            source: XE("source", b.nodeElement, R, g, C.id),
            target: XE("target", b.nodeElement, R, g, C.id)
          }
        }
      };
      t.set(C.id, q), C.parentId && c5(q, t, n, { nodeOrigin: a, zIndexMode: l }), d = !0, T && (h.push({
        id: C.id,
        type: "dimensions",
        dimensions: N
      }), C.expandParent && C.parentId && x.push({
        id: C.id,
        parentId: C.parentId,
        rect: Xh(q, a)
      }));
    }
  }
  if (x.length > 0) {
    const b = f5(x, t, n, a);
    h.push(...b);
  }
  return { changes: h, updatedInternals: d };
}
async function wW({ delta: e, panZoom: t, transform: n, translateExtent: r, width: a, height: o }) {
  if (!t || !e.x && !e.y)
    return Promise.resolve(!1);
  const l = await t.setViewportConstrained({
    x: n[0] + e.x,
    y: n[1] + e.y,
    zoom: n[2]
  }, [
    [0, 0],
    [a, o]
  ], r), c = !!l && (l.x !== n[0] || l.y !== n[1] || l.k !== n[2]);
  return Promise.resolve(c);
}
function r6(e, t, n, r, a, o) {
  let l = a;
  const c = r.get(l) || /* @__PURE__ */ new Map();
  r.set(l, c.set(n, t)), l = `${a}-${e}`;
  const d = r.get(l) || /* @__PURE__ */ new Map();
  if (r.set(l, d.set(n, t)), o) {
    l = `${a}-${e}-${o}`;
    const h = r.get(l) || /* @__PURE__ */ new Map();
    r.set(l, h.set(n, t));
  }
}
function hM(e, t, n) {
  e.clear(), t.clear();
  for (const r of n) {
    const { source: a, target: o, sourceHandle: l = null, targetHandle: c = null } = r, d = { edgeId: r.id, source: a, target: o, sourceHandle: l, targetHandle: c }, h = `${a}-${l}--${o}-${c}`, p = `${o}-${c}--${a}-${l}`;
    r6("source", d, p, e, a, l), r6("target", d, h, e, o, c), t.set(r.id, r);
  }
}
function mM(e, t) {
  if (!e.parentId)
    return !1;
  const n = t.get(e.parentId);
  return n ? n.selected ? !0 : mM(n, t) : !1;
}
function i6(e, t, n) {
  var a;
  let r = e;
  do {
    if ((a = r == null ? void 0 : r.matches) != null && a.call(r, t))
      return !0;
    if (r === n)
      return !1;
    r = r == null ? void 0 : r.parentElement;
  } while (r);
  return !1;
}
function _W(e, t, n, r) {
  const a = /* @__PURE__ */ new Map();
  for (const [o, l] of e)
    if ((l.selected || l.id === r) && (!l.parentId || !mM(l, e)) && (l.draggable || t && typeof l.draggable > "u")) {
      const c = e.get(o);
      c && a.set(o, {
        id: o,
        position: c.position || { x: 0, y: 0 },
        distance: {
          x: n.x - c.internals.positionAbsolute.x,
          y: n.y - c.internals.positionAbsolute.y
        },
        extent: c.extent,
        parentId: c.parentId,
        origin: c.origin,
        expandParent: c.expandParent,
        internals: {
          positionAbsolute: c.internals.positionAbsolute || { x: 0, y: 0 }
        },
        measured: {
          width: c.measured.width ?? 0,
          height: c.measured.height ?? 0
        }
      });
    }
  return a;
}
function Zx({ nodeId: e, dragItems: t, nodeLookup: n, dragging: r = !0 }) {
  var l, c, d;
  const a = [];
  for (const [h, p] of t) {
    const g = (l = n.get(h)) == null ? void 0 : l.internals.userNode;
    g && a.push({
      ...g,
      position: p.position,
      dragging: r
    });
  }
  if (!e)
    return [a[0], a];
  const o = (c = n.get(e)) == null ? void 0 : c.internals.userNode;
  return [
    o ? {
      ...o,
      position: ((d = t.get(e)) == null ? void 0 : d.position) || o.position,
      dragging: r
    } : a[0],
    a
  ];
}
function SW({ dragItems: e, snapGrid: t, x: n, y: r }) {
  const a = e.values().next().value;
  if (!a)
    return null;
  const o = {
    x: n - a.distance.x,
    y: r - a.distance.y
  }, l = Pg(o, t);
  return {
    x: l.x - o.x,
    y: l.y - o.y
  };
}
function CW({ onNodeMouseDown: e, getStoreItems: t, onDragStart: n, onDrag: r, onDragStop: a }) {
  let o = { x: null, y: null }, l = 0, c = /* @__PURE__ */ new Map(), d = !1, h = { x: 0, y: 0 }, p = null, g = !1, x = null, b = !1, C = !1, N = null;
  function T({ noDragClassName: R, handleSelector: A, domNode: z, isSelectable: q, nodeId: D, nodeClickDistance: P = 0 }) {
    x = ts(z);
    function re({ x: V, y: de }) {
      const { nodeLookup: H, nodeExtent: se, snapGrid: Z, snapToGrid: fe, nodeOrigin: he, onNodeDrag: ge, onSelectionDrag: Q, onError: U, updateNodePositions: ue } = t();
      o = { x: V, y: de };
      let Y = !1;
      const le = c.size > 1, xe = le && se ? oS(Lg(c)) : null, Se = le && fe ? SW({
        dragItems: c,
        snapGrid: Z,
        x: V,
        y: de
      }) : null;
      for (const [Oe, qe] of c) {
        if (!H.has(Oe))
          continue;
        let Me = { x: V - qe.distance.x, y: de - qe.distance.y };
        fe && (Me = Se ? {
          x: Math.round(Me.x + Se.x),
          y: Math.round(Me.y + Se.y)
        } : Pg(Me, Z));
        let Pe = null;
        if (le && se && !qe.extent && xe) {
          const { positionAbsolute: Je } = qe.internals, ot = Je.x - xe.x + se[0][0], We = Je.x + qe.measured.width - xe.x2 + se[1][0], bt = Je.y - xe.y + se[0][1], vt = Je.y + qe.measured.height - xe.y2 + se[1][1];
          Pe = [
            [ot, bt],
            [We, vt]
          ];
        }
        const { position: Re, positionAbsolute: Be } = ZA({
          nodeId: Oe,
          nextPosition: Me,
          nodeLookup: H,
          nodeExtent: Pe || se,
          nodeOrigin: he,
          onError: U
        });
        Y = Y || qe.position.x !== Re.x || qe.position.y !== Re.y, qe.position = Re, qe.internals.positionAbsolute = Be;
      }
      if (C = C || Y, !!Y && (ue(c, !0), N && (r || ge || !D && Q))) {
        const [Oe, qe] = Zx({
          nodeId: D,
          dragItems: c,
          nodeLookup: H
        });
        r == null || r(N, c, Oe, qe), ge == null || ge(N, Oe, qe), D || Q == null || Q(N, qe);
      }
    }
    async function ie() {
      if (!p)
        return;
      const { transform: V, panBy: de, autoPanSpeed: H, autoPanOnNodeDrag: se } = t();
      if (!se) {
        d = !1, cancelAnimationFrame(l);
        return;
      }
      const [Z, fe] = eM(h, p, H);
      (Z !== 0 || fe !== 0) && (o.x = (o.x ?? 0) - Z / V[2], o.y = (o.y ?? 0) - fe / V[2], await de({ x: Z, y: fe }) && re(o)), l = requestAnimationFrame(ie);
    }
    function X(V) {
      var le;
      const { nodeLookup: de, multiSelectionActive: H, nodesDraggable: se, transform: Z, snapGrid: fe, snapToGrid: he, selectNodesOnDrag: ge, onNodeDragStart: Q, onSelectionDragStart: U, unselectNodesAndEdges: ue } = t();
      g = !0, (!ge || !q) && !H && D && ((le = de.get(D)) != null && le.selected || ue()), q && ge && D && (e == null || e(D));
      const Y = fg(V.sourceEvent, { transform: Z, snapGrid: fe, snapToGrid: he, containerBounds: p });
      if (o = Y, c = _W(de, se, Y, D), c.size > 0 && (n || Q || !D && U)) {
        const [xe, Se] = Zx({
          nodeId: D,
          dragItems: c,
          nodeLookup: de
        });
        n == null || n(V.sourceEvent, c, xe, Se), Q == null || Q(V.sourceEvent, xe, Se), D || U == null || U(V.sourceEvent, Se);
      }
    }
    const K = MA().clickDistance(P).on("start", (V) => {
      const { domNode: de, nodeDragThreshold: H, transform: se, snapGrid: Z, snapToGrid: fe } = t();
      p = (de == null ? void 0 : de.getBoundingClientRect()) || null, b = !1, C = !1, N = V.sourceEvent, H === 0 && X(V), o = fg(V.sourceEvent, { transform: se, snapGrid: Z, snapToGrid: fe, containerBounds: p }), h = ho(V.sourceEvent, p);
    }).on("drag", (V) => {
      const { autoPanOnNodeDrag: de, transform: H, snapGrid: se, snapToGrid: Z, nodeDragThreshold: fe, nodeLookup: he } = t(), ge = fg(V.sourceEvent, { transform: H, snapGrid: se, snapToGrid: Z, containerBounds: p });
      if (N = V.sourceEvent, (V.sourceEvent.type === "touchmove" && V.sourceEvent.touches.length > 1 || // if user deletes a node while dragging, we need to abort the drag to prevent errors
      D && !he.has(D)) && (b = !0), !b) {
        if (!d && de && g && (d = !0, ie()), !g) {
          const Q = ho(V.sourceEvent, p), U = Q.x - h.x, ue = Q.y - h.y;
          Math.sqrt(U * U + ue * ue) > fe && X(V);
        }
        (o.x !== ge.xSnapped || o.y !== ge.ySnapped) && c && g && (h = ho(V.sourceEvent, p), re(ge));
      }
    }).on("end", (V) => {
      if (!(!g || b) && (d = !1, g = !1, cancelAnimationFrame(l), c.size > 0)) {
        const { nodeLookup: de, updateNodePositions: H, onNodeDragStop: se, onSelectionDragStop: Z } = t();
        if (C && (H(c, !1), C = !1), a || se || !D && Z) {
          const [fe, he] = Zx({
            nodeId: D,
            dragItems: c,
            nodeLookup: de,
            dragging: !1
          });
          a == null || a(V.sourceEvent, c, fe, he), se == null || se(V.sourceEvent, fe, he), D || Z == null || Z(V.sourceEvent, he);
        }
      }
    }).filter((V) => {
      const de = V.target;
      return !V.button && (!R || !i6(de, `.${R}`, z)) && (!A || i6(de, A, z));
    });
    x.call(K);
  }
  function j() {
    x == null || x.on(".drag", null);
  }
  return {
    update: T,
    destroy: j
  };
}
function EW(e, t, n) {
  const r = [], a = {
    x: e.x - n,
    y: e.y - n,
    width: n * 2,
    height: n * 2
  };
  for (const o of t.values())
    Eg(a, Xh(o)) > 0 && r.push(o);
  return r;
}
const kW = 250;
function NW(e, t, n, r) {
  var c, d;
  let a = [], o = 1 / 0;
  const l = EW(e, n, t + kW);
  for (const h of l) {
    const p = [...((c = h.internals.handleBounds) == null ? void 0 : c.source) ?? [], ...((d = h.internals.handleBounds) == null ? void 0 : d.target) ?? []];
    for (const g of p) {
      if (r.nodeId === g.nodeId && r.type === g.type && r.id === g.id)
        continue;
      const { x, y: b } = sd(h, g, g.position, !0), C = Math.sqrt(Math.pow(x - e.x, 2) + Math.pow(b - e.y, 2));
      C > t || (C < o ? (a = [{ ...g, x, y: b }], o = C) : C === o && a.push({ ...g, x, y: b }));
    }
  }
  if (!a.length)
    return null;
  if (a.length > 1) {
    const h = r.type === "source" ? "target" : "source";
    return a.find((p) => p.type === h) ?? a[0];
  }
  return a[0];
}
function pM(e, t, n, r, a, o = !1) {
  var h, p, g;
  const l = r.get(e);
  if (!l)
    return null;
  const c = a === "strict" ? (h = l.internals.handleBounds) == null ? void 0 : h[t] : [...((p = l.internals.handleBounds) == null ? void 0 : p.source) ?? [], ...((g = l.internals.handleBounds) == null ? void 0 : g.target) ?? []], d = (n ? c == null ? void 0 : c.find((x) => x.id === n) : c == null ? void 0 : c[0]) ?? null;
  return d && o ? { ...d, ...sd(l, d, d.position, !0) } : d;
}
function gM(e, t) {
  return e || (t != null && t.classList.contains("target") ? "target" : t != null && t.classList.contains("source") ? "source" : null);
}
function jW(e, t) {
  let n = null;
  return t ? n = !0 : e && !t && (n = !1), n;
}
const yM = () => !0;
function TW(e, { connectionMode: t, connectionRadius: n, handleId: r, nodeId: a, edgeUpdaterType: o, isTarget: l, domNode: c, nodeLookup: d, lib: h, autoPanOnConnect: p, flowId: g, panBy: x, cancelConnection: b, onConnectStart: C, onConnect: N, onConnectEnd: T, isValidConnection: j = yM, onReconnectEnd: R, updateConnection: A, getTransform: z, getFromHandle: q, autoPanSpeed: D, dragThreshold: P = 1, handleDomNode: re }) {
  const ie = iM(e.target);
  let X = 0, K;
  const { x: V, y: de } = ho(e), H = gM(o, re), se = c == null ? void 0 : c.getBoundingClientRect();
  let Z = !1;
  if (!se || !H)
    return;
  const fe = pM(a, H, r, d, t);
  if (!fe)
    return;
  let he = ho(e, se), ge = !1, Q = null, U = !1, ue = null;
  function Y() {
    if (!p || !se)
      return;
    const [Re, Be] = eM(he, se, D);
    x({ x: Re, y: Be }), X = requestAnimationFrame(Y);
  }
  const le = {
    ...fe,
    nodeId: a,
    type: H,
    position: fe.position
  }, xe = d.get(a);
  let Oe = {
    inProgress: !0,
    isValid: null,
    from: sd(xe, le, pt.Left, !0),
    fromHandle: le,
    fromPosition: le.position,
    fromNode: xe,
    to: he,
    toHandle: null,
    toPosition: VE[le.position],
    toNode: null,
    pointer: he
  };
  function qe() {
    Z = !0, A(Oe), C == null || C(e, { nodeId: a, handleId: r, handleType: H });
  }
  P === 0 && qe();
  function Me(Re) {
    if (!Z) {
      const { x: vt, y: Yn } = ho(Re), Mn = vt - V, Fn = Yn - de;
      if (!(Mn * Mn + Fn * Fn > P * P))
        return;
      qe();
    }
    if (!q() || !le) {
      Pe(Re);
      return;
    }
    const Be = z();
    he = ho(Re, se), K = NW(qg(he, Be, !1, [1, 1]), n, d, le), ge || (Y(), ge = !0);
    const Je = vM(Re, {
      handle: K,
      connectionMode: t,
      fromNodeId: a,
      fromHandleId: r,
      fromType: l ? "target" : "source",
      isValidConnection: j,
      doc: ie,
      lib: h,
      flowId: g,
      nodeLookup: d
    });
    ue = Je.handleDomNode, Q = Je.connection, U = jW(!!K, Je.isValid);
    const ot = d.get(a), We = ot ? sd(ot, le, pt.Left, !0) : Oe.from, bt = {
      ...Oe,
      from: We,
      isValid: U,
      to: Je.toHandle && U ? E1({ x: Je.toHandle.x, y: Je.toHandle.y }, Be) : he,
      toHandle: Je.toHandle,
      toPosition: U && Je.toHandle ? Je.toHandle.position : VE[le.position],
      toNode: Je.toHandle ? d.get(Je.toHandle.nodeId) : null,
      pointer: he
    };
    A(bt), Oe = bt;
  }
  function Pe(Re) {
    if (!("touches" in Re && Re.touches.length > 0)) {
      if (Z) {
        (K || ue) && Q && U && (N == null || N(Q));
        const { inProgress: Be, ...Je } = Oe, ot = {
          ...Je,
          toPosition: Oe.toHandle ? Oe.toPosition : null
        };
        T == null || T(Re, ot), o && (R == null || R(Re, ot));
      }
      b(), cancelAnimationFrame(X), ge = !1, U = !1, Q = null, ue = null, ie.removeEventListener("mousemove", Me), ie.removeEventListener("mouseup", Pe), ie.removeEventListener("touchmove", Me), ie.removeEventListener("touchend", Pe);
    }
  }
  ie.addEventListener("mousemove", Me), ie.addEventListener("mouseup", Pe), ie.addEventListener("touchmove", Me), ie.addEventListener("touchend", Pe);
}
function vM(e, { handle: t, connectionMode: n, fromNodeId: r, fromHandleId: a, fromType: o, doc: l, lib: c, flowId: d, isValidConnection: h = yM, nodeLookup: p }) {
  const g = o === "target", x = t ? l.querySelector(`.${c}-flow__handle[data-id="${d}-${t == null ? void 0 : t.nodeId}-${t == null ? void 0 : t.id}-${t == null ? void 0 : t.type}"]`) : null, { x: b, y: C } = ho(e), N = l.elementFromPoint(b, C), T = N != null && N.classList.contains(`${c}-flow__handle`) ? N : x, j = {
    handleDomNode: T,
    isValid: !1,
    connection: null,
    toHandle: null
  };
  if (T) {
    const R = gM(void 0, T), A = T.getAttribute("data-nodeid"), z = T.getAttribute("data-handleid"), q = T.classList.contains("connectable"), D = T.classList.contains("connectableend");
    if (!A || !R)
      return j;
    const P = {
      source: g ? A : r,
      sourceHandle: g ? z : a,
      target: g ? r : A,
      targetHandle: g ? a : z
    };
    j.connection = P;
    const ie = q && D && (n === Yh.Strict ? g && R === "source" || !g && R === "target" : A !== r || z !== a);
    j.isValid = ie && h(P), j.toHandle = pM(A, R, z, p, n, !0);
  }
  return j;
}
const fS = {
  onPointerDown: TW,
  isValid: vM
};
function AW({ domNode: e, panZoom: t, getTransform: n, getViewScale: r }) {
  const a = ts(e);
  function o({ translateExtent: c, width: d, height: h, zoomStep: p = 1, pannable: g = !0, zoomable: x = !0, inversePan: b = !1 }) {
    const C = (A) => {
      if (A.sourceEvent.type !== "wheel" || !t)
        return;
      const z = n(), q = A.sourceEvent.ctrlKey && kg() ? 10 : 1, D = -A.sourceEvent.deltaY * (A.sourceEvent.deltaMode === 1 ? 0.05 : A.sourceEvent.deltaMode ? 1 : 2e-3) * p, P = z[2] * Math.pow(2, D * q);
      t.scaleTo(P);
    };
    let N = [0, 0];
    const T = (A) => {
      (A.sourceEvent.type === "mousedown" || A.sourceEvent.type === "touchstart") && (N = [
        A.sourceEvent.clientX ?? A.sourceEvent.touches[0].clientX,
        A.sourceEvent.clientY ?? A.sourceEvent.touches[0].clientY
      ]);
    }, j = (A) => {
      const z = n();
      if (A.sourceEvent.type !== "mousemove" && A.sourceEvent.type !== "touchmove" || !t)
        return;
      const q = [
        A.sourceEvent.clientX ?? A.sourceEvent.touches[0].clientX,
        A.sourceEvent.clientY ?? A.sourceEvent.touches[0].clientY
      ], D = [q[0] - N[0], q[1] - N[1]];
      N = q;
      const P = r() * Math.max(z[2], Math.log(z[2])) * (b ? -1 : 1), re = {
        x: z[0] - D[0] * P,
        y: z[1] - D[1] * P
      }, ie = [
        [0, 0],
        [d, h]
      ];
      t.setViewportConstrained({
        x: re.x,
        y: re.y,
        zoom: z[2]
      }, ie, c);
    }, R = VA().on("start", T).on("zoom", g ? j : null).on("zoom.wheel", x ? C : null);
    a.call(R, {});
  }
  function l() {
    a.on("zoom", null);
  }
  return {
    update: o,
    destroy: l,
    pointer: so
  };
}
const J1 = (e) => ({
  x: e.x,
  y: e.y,
  zoom: e.k
}), Jx = ({ x: e, y: t, zoom: n }) => X1.translate(e, t).scale(n), Ph = (e, t) => e.target.closest(`.${t}`), xM = (e, t) => t === 2 && Array.isArray(e) && e.includes(2), MW = (e) => ((e *= 2) <= 1 ? e * e * e : (e -= 2) * e * e + 2) / 2, eb = (e, t = 0, n = MW, r = () => {
}) => {
  const a = typeof t == "number" && t > 0;
  return a || r(), a ? e.transition().duration(t).ease(n).on("end", r) : e;
}, bM = (e) => {
  const t = e.ctrlKey && kg() ? 10 : 1;
  return -e.deltaY * (e.deltaMode === 1 ? 0.05 : e.deltaMode ? 1 : 2e-3) * t;
};
function RW({ zoomPanValues: e, noWheelClassName: t, d3Selection: n, d3Zoom: r, panOnScrollMode: a, panOnScrollSpeed: o, zoomOnPinch: l, onPanZoomStart: c, onPanZoom: d, onPanZoomEnd: h }) {
  return (p) => {
    if (Ph(p, t))
      return p.ctrlKey && p.preventDefault(), !1;
    p.preventDefault(), p.stopImmediatePropagation();
    const g = n.property("__zoom").k || 1;
    if (p.ctrlKey && l) {
      const T = so(p), j = bM(p), R = g * Math.pow(2, j);
      r.scaleTo(n, R, T, p);
      return;
    }
    const x = p.deltaMode === 1 ? 20 : 1;
    let b = a === Jf.Vertical ? 0 : p.deltaX * x, C = a === Jf.Horizontal ? 0 : p.deltaY * x;
    !kg() && p.shiftKey && a !== Jf.Vertical && (b = p.deltaY * x, C = 0), r.translateBy(
      n,
      -(b / g) * o,
      -(C / g) * o,
      // @ts-ignore
      { internal: !0 }
    );
    const N = J1(n.property("__zoom"));
    clearTimeout(e.panScrollTimeout), e.isPanScrolling ? (d == null || d(p, N), e.panScrollTimeout = setTimeout(() => {
      h == null || h(p, N), e.isPanScrolling = !1;
    }, 150)) : (e.isPanScrolling = !0, c == null || c(p, N));
  };
}
function OW({ noWheelClassName: e, preventScrolling: t, d3ZoomHandler: n }) {
  return function(r, a) {
    const o = r.type === "wheel", l = !t && o && !r.ctrlKey, c = Ph(r, e);
    if (r.ctrlKey && o && c && r.preventDefault(), l || c)
      return null;
    r.preventDefault(), n.call(this, r, a);
  };
}
function zW({ zoomPanValues: e, onDraggingChange: t, onPanZoomStart: n }) {
  return (r) => {
    var o, l, c;
    if ((o = r.sourceEvent) != null && o.internal)
      return;
    const a = J1(r.transform);
    e.mouseButton = ((l = r.sourceEvent) == null ? void 0 : l.button) || 0, e.isZoomingOrPanning = !0, e.prevViewport = a, ((c = r.sourceEvent) == null ? void 0 : c.type) === "mousedown" && t(!0), n && (n == null || n(r.sourceEvent, a));
  };
}
function DW({ zoomPanValues: e, panOnDrag: t, onPaneContextMenu: n, onTransformChange: r, onPanZoom: a }) {
  return (o) => {
    var l, c;
    e.usedRightMouseButton = !!(n && xM(t, e.mouseButton ?? 0)), (l = o.sourceEvent) != null && l.sync || r([o.transform.x, o.transform.y, o.transform.k]), a && !((c = o.sourceEvent) != null && c.internal) && (a == null || a(o.sourceEvent, J1(o.transform)));
  };
}
function IW({ zoomPanValues: e, panOnDrag: t, panOnScroll: n, onDraggingChange: r, onPanZoomEnd: a, onPaneContextMenu: o }) {
  return (l) => {
    var c;
    if (!((c = l.sourceEvent) != null && c.internal) && (e.isZoomingOrPanning = !1, o && xM(t, e.mouseButton ?? 0) && !e.usedRightMouseButton && l.sourceEvent && o(l.sourceEvent), e.usedRightMouseButton = !1, r(!1), a)) {
      const d = J1(l.transform);
      e.prevViewport = d, clearTimeout(e.timerId), e.timerId = setTimeout(
        () => {
          a == null || a(l.sourceEvent, d);
        },
        // we need a setTimeout for panOnScroll to supress multiple end events fired during scroll
        n ? 150 : 0
      );
    }
  };
}
function LW({ zoomActivationKeyPressed: e, zoomOnScroll: t, zoomOnPinch: n, panOnDrag: r, panOnScroll: a, zoomOnDoubleClick: o, userSelectionActive: l, noWheelClassName: c, noPanClassName: d, lib: h, connectionInProgress: p }) {
  return (g) => {
    var T;
    const x = e || t, b = n && g.ctrlKey, C = g.type === "wheel";
    if (g.button === 1 && g.type === "mousedown" && (Ph(g, `${h}-flow__node`) || Ph(g, `${h}-flow__edge`)))
      return !0;
    if (!r && !x && !a && !o && !n || l || p && !C || Ph(g, c) && C || Ph(g, d) && (!C || a && C && !e) || !n && g.ctrlKey && C)
      return !1;
    if (!n && g.type === "touchstart" && ((T = g.touches) == null ? void 0 : T.length) > 1)
      return g.preventDefault(), !1;
    if (!x && !a && !b && C || !r && (g.type === "mousedown" || g.type === "touchstart") || Array.isArray(r) && !r.includes(g.button) && g.type === "mousedown")
      return !1;
    const N = Array.isArray(r) && r.includes(g.button) || !g.button || g.button <= 1;
    return (!g.ctrlKey || C) && N;
  };
}
function PW({ domNode: e, minZoom: t, maxZoom: n, translateExtent: r, viewport: a, onPanZoom: o, onPanZoomStart: l, onPanZoomEnd: c, onDraggingChange: d }) {
  const h = {
    isZoomingOrPanning: !1,
    usedRightMouseButton: !1,
    prevViewport: {},
    mouseButton: 0,
    timerId: void 0,
    panScrollTimeout: void 0,
    isPanScrolling: !1
  }, p = e.getBoundingClientRect(), g = VA().scaleExtent([t, n]).translateExtent(r), x = ts(e).call(g);
  R({
    x: a.x,
    y: a.y,
    zoom: Wh(a.zoom, t, n)
  }, [
    [0, 0],
    [p.width, p.height]
  ], r);
  const b = x.on("wheel.zoom"), C = x.on("dblclick.zoom");
  g.wheelDelta(bM);
  function N(K, V) {
    return x ? new Promise((de) => {
      g == null || g.interpolate((V == null ? void 0 : V.interpolate) === "linear" ? cg : e1).transform(eb(x, V == null ? void 0 : V.duration, V == null ? void 0 : V.ease, () => de(!0)), K);
    }) : Promise.resolve(!1);
  }
  function T({ noWheelClassName: K, noPanClassName: V, onPaneContextMenu: de, userSelectionActive: H, panOnScroll: se, panOnDrag: Z, panOnScrollMode: fe, panOnScrollSpeed: he, preventScrolling: ge, zoomOnPinch: Q, zoomOnScroll: U, zoomOnDoubleClick: ue, zoomActivationKeyPressed: Y, lib: le, onTransformChange: xe, connectionInProgress: Se, paneClickDistance: Oe, selectionOnDrag: qe }) {
    H && !h.isZoomingOrPanning && j();
    const Me = se && !Y && !H;
    g.clickDistance(qe ? 1 / 0 : !fo(Oe) || Oe < 0 ? 0 : Oe);
    const Pe = Me ? RW({
      zoomPanValues: h,
      noWheelClassName: K,
      d3Selection: x,
      d3Zoom: g,
      panOnScrollMode: fe,
      panOnScrollSpeed: he,
      zoomOnPinch: Q,
      onPanZoomStart: l,
      onPanZoom: o,
      onPanZoomEnd: c
    }) : OW({
      noWheelClassName: K,
      preventScrolling: ge,
      d3ZoomHandler: b
    });
    if (x.on("wheel.zoom", Pe, { passive: !1 }), !H) {
      const Be = zW({
        zoomPanValues: h,
        onDraggingChange: d,
        onPanZoomStart: l
      });
      g.on("start", Be);
      const Je = DW({
        zoomPanValues: h,
        panOnDrag: Z,
        onPaneContextMenu: !!de,
        onPanZoom: o,
        onTransformChange: xe
      });
      g.on("zoom", Je);
      const ot = IW({
        zoomPanValues: h,
        panOnDrag: Z,
        panOnScroll: se,
        onPaneContextMenu: de,
        onPanZoomEnd: c,
        onDraggingChange: d
      });
      g.on("end", ot);
    }
    const Re = LW({
      zoomActivationKeyPressed: Y,
      panOnDrag: Z,
      zoomOnScroll: U,
      panOnScroll: se,
      zoomOnDoubleClick: ue,
      zoomOnPinch: Q,
      userSelectionActive: H,
      noPanClassName: V,
      noWheelClassName: K,
      lib: le,
      connectionInProgress: Se
    });
    g.filter(Re), ue ? x.on("dblclick.zoom", C) : x.on("dblclick.zoom", null);
  }
  function j() {
    g.on("zoom", null);
  }
  async function R(K, V, de) {
    const H = Jx(K), se = g == null ? void 0 : g.constrain()(H, V, de);
    return se && await N(se), new Promise((Z) => Z(se));
  }
  async function A(K, V) {
    const de = Jx(K);
    return await N(de, V), new Promise((H) => H(de));
  }
  function z(K) {
    if (x) {
      const V = Jx(K), de = x.property("__zoom");
      (de.k !== K.zoom || de.x !== K.x || de.y !== K.y) && (g == null || g.transform(x, V, null, { sync: !0 }));
    }
  }
  function q() {
    const K = x ? GA(x.node()) : { x: 0, y: 0, k: 1 };
    return { x: K.x, y: K.y, zoom: K.k };
  }
  function D(K, V) {
    return x ? new Promise((de) => {
      g == null || g.interpolate((V == null ? void 0 : V.interpolate) === "linear" ? cg : e1).scaleTo(eb(x, V == null ? void 0 : V.duration, V == null ? void 0 : V.ease, () => de(!0)), K);
    }) : Promise.resolve(!1);
  }
  function P(K, V) {
    return x ? new Promise((de) => {
      g == null || g.interpolate((V == null ? void 0 : V.interpolate) === "linear" ? cg : e1).scaleBy(eb(x, V == null ? void 0 : V.duration, V == null ? void 0 : V.ease, () => de(!0)), K);
    }) : Promise.resolve(!1);
  }
  function re(K) {
    g == null || g.scaleExtent(K);
  }
  function ie(K) {
    g == null || g.translateExtent(K);
  }
  function X(K) {
    const V = !fo(K) || K < 0 ? 0 : K;
    g == null || g.clickDistance(V);
  }
  return {
    update: T,
    destroy: j,
    setViewport: A,
    setViewportConstrained: R,
    getViewport: q,
    scaleTo: D,
    scaleBy: P,
    setScaleExtent: re,
    setTranslateExtent: ie,
    syncViewport: z,
    setClickDistance: X
  };
}
var Zh;
(function(e) {
  e.Line = "line", e.Handle = "handle";
})(Zh || (Zh = {}));
function qW({ width: e, prevWidth: t, height: n, prevHeight: r, affectsX: a, affectsY: o }) {
  const l = e - t, c = n - r, d = [l > 0 ? 1 : l < 0 ? -1 : 0, c > 0 ? 1 : c < 0 ? -1 : 0];
  return l && a && (d[0] = d[0] * -1), c && o && (d[1] = d[1] * -1), d;
}
function a6(e) {
  const t = e.includes("right") || e.includes("left"), n = e.includes("bottom") || e.includes("top"), r = e.includes("left"), a = e.includes("top");
  return {
    isHorizontal: t,
    isVertical: n,
    affectsX: r,
    affectsY: a
  };
}
function dc(e, t) {
  return Math.max(0, t - e);
}
function hc(e, t) {
  return Math.max(0, e - t);
}
function $y(e, t, n) {
  return Math.max(0, t - e, e - n);
}
function s6(e, t) {
  return e ? !t : t;
}
function BW(e, t, n, r, a, o, l, c) {
  let { affectsX: d, affectsY: h } = t;
  const { isHorizontal: p, isVertical: g } = t, x = p && g, { xSnapped: b, ySnapped: C } = n, { minWidth: N, maxWidth: T, minHeight: j, maxHeight: R } = r, { x: A, y: z, width: q, height: D, aspectRatio: P } = e;
  let re = Math.floor(p ? b - e.pointerX : 0), ie = Math.floor(g ? C - e.pointerY : 0);
  const X = q + (d ? -re : re), K = D + (h ? -ie : ie), V = -o[0] * q, de = -o[1] * D;
  let H = $y(X, N, T), se = $y(K, j, R);
  if (l) {
    let he = 0, ge = 0;
    d && re < 0 ? he = dc(A + re + V, l[0][0]) : !d && re > 0 && (he = hc(A + X + V, l[1][0])), h && ie < 0 ? ge = dc(z + ie + de, l[0][1]) : !h && ie > 0 && (ge = hc(z + K + de, l[1][1])), H = Math.max(H, he), se = Math.max(se, ge);
  }
  if (c) {
    let he = 0, ge = 0;
    d && re > 0 ? he = hc(A + re, c[0][0]) : !d && re < 0 && (he = dc(A + X, c[1][0])), h && ie > 0 ? ge = hc(z + ie, c[0][1]) : !h && ie < 0 && (ge = dc(z + K, c[1][1])), H = Math.max(H, he), se = Math.max(se, ge);
  }
  if (a) {
    if (p) {
      const he = $y(X / P, j, R) * P;
      if (H = Math.max(H, he), l) {
        let ge = 0;
        !d && !h || d && !h && x ? ge = hc(z + de + X / P, l[1][1]) * P : ge = dc(z + de + (d ? re : -re) / P, l[0][1]) * P, H = Math.max(H, ge);
      }
      if (c) {
        let ge = 0;
        !d && !h || d && !h && x ? ge = dc(z + X / P, c[1][1]) * P : ge = hc(z + (d ? re : -re) / P, c[0][1]) * P, H = Math.max(H, ge);
      }
    }
    if (g) {
      const he = $y(K * P, N, T) / P;
      if (se = Math.max(se, he), l) {
        let ge = 0;
        !d && !h || h && !d && x ? ge = hc(A + K * P + V, l[1][0]) / P : ge = dc(A + (h ? ie : -ie) * P + V, l[0][0]) / P, se = Math.max(se, ge);
      }
      if (c) {
        let ge = 0;
        !d && !h || h && !d && x ? ge = dc(A + K * P, c[1][0]) / P : ge = hc(A + (h ? ie : -ie) * P, c[0][0]) / P, se = Math.max(se, ge);
      }
    }
  }
  ie = ie + (ie < 0 ? se : -se), re = re + (re < 0 ? H : -H), a && (x ? X > K * P ? ie = (s6(d, h) ? -re : re) / P : re = (s6(d, h) ? -ie : ie) * P : p ? (ie = re / P, h = d) : (re = ie * P, d = h));
  const Z = d ? A + re : A, fe = h ? z + ie : z;
  return {
    width: q + (d ? -re : re),
    height: D + (h ? -ie : ie),
    x: o[0] * re * (d ? -1 : 1) + Z,
    y: o[1] * ie * (h ? -1 : 1) + fe
  };
}
const wM = { width: 0, height: 0, x: 0, y: 0 }, FW = {
  ...wM,
  pointerX: 0,
  pointerY: 0,
  aspectRatio: 1
};
function UW(e) {
  return [
    [0, 0],
    [e.measured.width, e.measured.height]
  ];
}
function $W(e, t, n) {
  const r = t.position.x + e.position.x, a = t.position.y + e.position.y, o = e.measured.width ?? 0, l = e.measured.height ?? 0, c = n[0] * o, d = n[1] * l;
  return [
    [r - c, a - d],
    [r + o - c, a + l - d]
  ];
}
function HW({ domNode: e, nodeId: t, getStoreItems: n, onChange: r, onEnd: a }) {
  const o = ts(e);
  let l = {
    controlDirection: a6("bottom-right"),
    boundaries: {
      minWidth: 0,
      minHeight: 0,
      maxWidth: Number.MAX_VALUE,
      maxHeight: Number.MAX_VALUE
    },
    resizeDirection: void 0,
    keepAspectRatio: !1
  };
  function c({ controlPosition: h, boundaries: p, keepAspectRatio: g, resizeDirection: x, onResizeStart: b, onResize: C, onResizeEnd: N, shouldResize: T }) {
    let j = { ...wM }, R = { ...FW };
    l = {
      boundaries: p,
      resizeDirection: x,
      keepAspectRatio: g,
      controlDirection: a6(h)
    };
    let A, z = null, q = [], D, P, re, ie = !1;
    const X = MA().on("start", (K) => {
      const { nodeLookup: V, transform: de, snapGrid: H, snapToGrid: se, nodeOrigin: Z, paneDomNode: fe } = n();
      if (A = V.get(t), !A)
        return;
      z = (fe == null ? void 0 : fe.getBoundingClientRect()) ?? null;
      const { xSnapped: he, ySnapped: ge } = fg(K.sourceEvent, {
        transform: de,
        snapGrid: H,
        snapToGrid: se,
        containerBounds: z
      });
      j = {
        width: A.measured.width ?? 0,
        height: A.measured.height ?? 0,
        x: A.position.x ?? 0,
        y: A.position.y ?? 0
      }, R = {
        ...j,
        pointerX: he,
        pointerY: ge,
        aspectRatio: j.width / j.height
      }, D = void 0, A.parentId && (A.extent === "parent" || A.expandParent) && (D = V.get(A.parentId), P = D && A.extent === "parent" ? UW(D) : void 0), q = [], re = void 0;
      for (const [Q, U] of V)
        if (U.parentId === t && (q.push({
          id: Q,
          position: { ...U.position },
          extent: U.extent
        }), U.extent === "parent" || U.expandParent)) {
          const ue = $W(U, A, U.origin ?? Z);
          re ? re = [
            [Math.min(ue[0][0], re[0][0]), Math.min(ue[0][1], re[0][1])],
            [Math.max(ue[1][0], re[1][0]), Math.max(ue[1][1], re[1][1])]
          ] : re = ue;
        }
      b == null || b(K, { ...j });
    }).on("drag", (K) => {
      const { transform: V, snapGrid: de, snapToGrid: H, nodeOrigin: se } = n(), Z = fg(K.sourceEvent, {
        transform: V,
        snapGrid: de,
        snapToGrid: H,
        containerBounds: z
      }), fe = [];
      if (!A)
        return;
      const { x: he, y: ge, width: Q, height: U } = j, ue = {}, Y = A.origin ?? se, { width: le, height: xe, x: Se, y: Oe } = BW(R, l.controlDirection, Z, l.boundaries, l.keepAspectRatio, Y, P, re), qe = le !== Q, Me = xe !== U, Pe = Se !== he && qe, Re = Oe !== ge && Me;
      if (!Pe && !Re && !qe && !Me)
        return;
      if ((Pe || Re || Y[0] === 1 || Y[1] === 1) && (ue.x = Pe ? Se : j.x, ue.y = Re ? Oe : j.y, j.x = ue.x, j.y = ue.y, q.length > 0)) {
        const We = Se - he, bt = Oe - ge;
        for (const vt of q)
          vt.position = {
            x: vt.position.x - We + Y[0] * (le - Q),
            y: vt.position.y - bt + Y[1] * (xe - U)
          }, fe.push(vt);
      }
      if ((qe || Me) && (ue.width = qe && (!l.resizeDirection || l.resizeDirection === "horizontal") ? le : j.width, ue.height = Me && (!l.resizeDirection || l.resizeDirection === "vertical") ? xe : j.height, j.width = ue.width, j.height = ue.height), D && A.expandParent) {
        const We = Y[0] * (ue.width ?? 0);
        ue.x && ue.x < We && (j.x = We, R.x = R.x - (ue.x - We));
        const bt = Y[1] * (ue.height ?? 0);
        ue.y && ue.y < bt && (j.y = bt, R.y = R.y - (ue.y - bt));
      }
      const Be = qW({
        width: j.width,
        prevWidth: Q,
        height: j.height,
        prevHeight: U,
        affectsX: l.controlDirection.affectsX,
        affectsY: l.controlDirection.affectsY
      }), Je = { ...j, direction: Be };
      (T == null ? void 0 : T(K, Je)) !== !1 && (ie = !0, C == null || C(K, Je), r(ue, fe));
    }).on("end", (K) => {
      ie && (N == null || N(K, { ...j }), a == null || a({ ...j }), ie = !1);
    });
    o.call(X);
  }
  function d() {
    o.on(".drag", null);
  }
  return {
    update: c,
    destroy: d
  };
}
const { useDebugValue: GW } = hS, { useSyncExternalStoreWithSelector: VW } = p7, KW = (e) => e;
function _M(e, t = KW, n) {
  const r = VW(
    e.subscribe,
    e.getState,
    e.getServerState || e.getInitialState,
    t,
    n
  );
  return GW(r), r;
}
const o6 = (e, t) => {
  const n = m7(e), r = (a, o = t) => _M(n, a, o);
  return Object.assign(r, n), r;
}, YW = (e, t) => e ? o6(e, t) : o6;
function ar(e, t) {
  if (Object.is(e, t))
    return !0;
  if (typeof e != "object" || e === null || typeof t != "object" || t === null)
    return !1;
  if (e instanceof Map && t instanceof Map) {
    if (e.size !== t.size) return !1;
    for (const [r, a] of e)
      if (!Object.is(a, t.get(r)))
        return !1;
    return !0;
  }
  if (e instanceof Set && t instanceof Set) {
    if (e.size !== t.size) return !1;
    for (const r of e)
      if (!t.has(r))
        return !1;
    return !0;
  }
  const n = Object.keys(e);
  if (n.length !== Object.keys(t).length)
    return !1;
  for (const r of n)
    if (!Object.prototype.hasOwnProperty.call(t, r) || !Object.is(e[r], t[r]))
      return !1;
  return !0;
}
const ev = G.createContext(null), WW = ev.Provider, SM = gl.error001();
function nn(e, t) {
  const n = G.useContext(ev);
  if (n === null)
    throw new Error(SM);
  return _M(n, e, t);
}
function sr() {
  const e = G.useContext(ev);
  if (e === null)
    throw new Error(SM);
  return G.useMemo(() => ({
    getState: e.getState,
    setState: e.setState,
    subscribe: e.subscribe
  }), [e]);
}
const l6 = { display: "none" }, XW = {
  position: "absolute",
  width: 1,
  height: 1,
  margin: -1,
  border: 0,
  padding: 0,
  overflow: "hidden",
  clip: "rect(0px, 0px, 0px, 0px)",
  clipPath: "inset(100%)"
}, CM = "react-flow__node-desc", EM = "react-flow__edge-desc", QW = "react-flow__aria-live", ZW = (e) => e.ariaLiveMessage, JW = (e) => e.ariaLabelConfig;
function eX({ rfId: e }) {
  const t = nn(ZW);
  return m.jsx("div", { id: `${QW}-${e}`, "aria-live": "assertive", "aria-atomic": "true", style: XW, children: t });
}
function tX({ rfId: e, disableKeyboardA11y: t }) {
  const n = nn(JW);
  return m.jsxs(m.Fragment, { children: [m.jsx("div", { id: `${CM}-${e}`, style: l6, children: t ? n["node.a11yDescription.default"] : n["node.a11yDescription.keyboardDisabled"] }), m.jsx("div", { id: `${EM}-${e}`, style: l6, children: n["edge.a11yDescription.default"] }), !t && m.jsx(eX, { rfId: e })] });
}
const tv = G.forwardRef(({ position: e = "top-left", children: t, className: n, style: r, ...a }, o) => {
  const l = `${e}`.split("-");
  return m.jsx("div", { className: Dr(["react-flow__panel", n, ...l]), style: r, ref: o, ...a, children: t });
});
tv.displayName = "Panel";
function nX({ proOptions: e, position: t = "bottom-right" }) {
  return e != null && e.hideAttribution ? null : m.jsx(tv, { position: t, className: "react-flow__attribution", "data-message": "Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev", children: m.jsx("a", { href: "https://reactflow.dev", target: "_blank", rel: "noopener noreferrer", "aria-label": "React Flow attribution", children: "React Flow" }) });
}
const rX = (e) => {
  const t = [], n = [];
  for (const [, r] of e.nodeLookup)
    r.selected && t.push(r.internals.userNode);
  for (const [, r] of e.edgeLookup)
    r.selected && n.push(r);
  return { selectedNodes: t, selectedEdges: n };
}, Hy = (e) => e.id;
function iX(e, t) {
  return ar(e.selectedNodes.map(Hy), t.selectedNodes.map(Hy)) && ar(e.selectedEdges.map(Hy), t.selectedEdges.map(Hy));
}
function aX({ onSelectionChange: e }) {
  const t = sr(), { selectedNodes: n, selectedEdges: r } = nn(rX, iX);
  return G.useEffect(() => {
    const a = { nodes: n, edges: r };
    e == null || e(a), t.getState().onSelectionChangeHandlers.forEach((o) => o(a));
  }, [n, r, e]), null;
}
const sX = (e) => !!e.onSelectionChangeHandlers;
function oX({ onSelectionChange: e }) {
  const t = nn(sX);
  return e || t ? m.jsx(aX, { onSelectionChange: e }) : null;
}
const kM = [0, 0], lX = { x: 0, y: 0, zoom: 1 }, uX = [
  "nodes",
  "edges",
  "defaultNodes",
  "defaultEdges",
  "onConnect",
  "onConnectStart",
  "onConnectEnd",
  "onClickConnectStart",
  "onClickConnectEnd",
  "nodesDraggable",
  "autoPanOnNodeFocus",
  "nodesConnectable",
  "nodesFocusable",
  "edgesFocusable",
  "edgesReconnectable",
  "elevateNodesOnSelect",
  "elevateEdgesOnSelect",
  "minZoom",
  "maxZoom",
  "nodeExtent",
  "onNodesChange",
  "onEdgesChange",
  "elementsSelectable",
  "connectionMode",
  "snapGrid",
  "snapToGrid",
  "translateExtent",
  "connectOnClick",
  "defaultEdgeOptions",
  "fitView",
  "fitViewOptions",
  "onNodesDelete",
  "onEdgesDelete",
  "onDelete",
  "onNodeDrag",
  "onNodeDragStart",
  "onNodeDragStop",
  "onSelectionDrag",
  "onSelectionDragStart",
  "onSelectionDragStop",
  "onMoveStart",
  "onMove",
  "onMoveEnd",
  "noPanClassName",
  "nodeOrigin",
  "autoPanOnConnect",
  "autoPanOnNodeDrag",
  "onError",
  "connectionRadius",
  "isValidConnection",
  "selectNodesOnDrag",
  "nodeDragThreshold",
  "connectionDragThreshold",
  "onBeforeDelete",
  "debug",
  "autoPanSpeed",
  "ariaLabelConfig",
  "zIndexMode"
], u6 = [...uX, "rfId"], cX = (e) => ({
  setNodes: e.setNodes,
  setEdges: e.setEdges,
  setMinZoom: e.setMinZoom,
  setMaxZoom: e.setMaxZoom,
  setTranslateExtent: e.setTranslateExtent,
  setNodeExtent: e.setNodeExtent,
  reset: e.reset,
  setDefaultNodesAndEdges: e.setDefaultNodesAndEdges
}), c6 = {
  /*
   * these are values that are also passed directly to other components
   * than the StoreUpdater. We can reduce the number of setStore calls
   * by setting the same values here as prev fields.
   */
  translateExtent: _g,
  nodeOrigin: kM,
  minZoom: 0.5,
  maxZoom: 2,
  elementsSelectable: !0,
  noPanClassName: "nopan",
  rfId: "1"
};
function fX(e) {
  const { setNodes: t, setEdges: n, setMinZoom: r, setMaxZoom: a, setTranslateExtent: o, setNodeExtent: l, reset: c, setDefaultNodesAndEdges: d } = nn(cX, ar), h = sr();
  G.useEffect(() => (d(e.defaultNodes, e.defaultEdges), () => {
    p.current = c6, c();
  }), []);
  const p = G.useRef(c6);
  return G.useEffect(
    () => {
      for (const g of u6) {
        const x = e[g], b = p.current[g];
        x !== b && (typeof e[g] > "u" || (g === "nodes" ? t(x) : g === "edges" ? n(x) : g === "minZoom" ? r(x) : g === "maxZoom" ? a(x) : g === "translateExtent" ? o(x) : g === "nodeExtent" ? l(x) : g === "ariaLabelConfig" ? h.setState({ ariaLabelConfig: nW(x) }) : g === "fitView" ? h.setState({ fitViewQueued: x }) : g === "fitViewOptions" ? h.setState({ fitViewOptions: x }) : h.setState({ [g]: x })));
      }
      p.current = e;
    },
    // Only re-run the effect if one of the fields we track changes
    u6.map((g) => e[g])
  ), null;
}
function f6() {
  return typeof window > "u" || !window.matchMedia ? null : window.matchMedia("(prefers-color-scheme: dark)");
}
function dX(e) {
  var r;
  const [t, n] = G.useState(e === "system" ? null : e);
  return G.useEffect(() => {
    if (e !== "system") {
      n(e);
      return;
    }
    const a = f6(), o = () => n(a != null && a.matches ? "dark" : "light");
    return o(), a == null || a.addEventListener("change", o), () => {
      a == null || a.removeEventListener("change", o);
    };
  }, [e]), t !== null ? t : (r = f6()) != null && r.matches ? "dark" : "light";
}
const d6 = typeof document < "u" ? document : null;
function Ng(e = null, t = { target: d6, actInsideInputWithModifier: !0 }) {
  const [n, r] = G.useState(!1), a = G.useRef(!1), o = G.useRef(/* @__PURE__ */ new Set([])), [l, c] = G.useMemo(() => {
    if (e !== null) {
      const h = (Array.isArray(e) ? e : [e]).filter((g) => typeof g == "string").map((g) => g.replace("+", `
`).replace(`

`, `
+`).split(`
`)), p = h.reduce((g, x) => g.concat(...x), []);
      return [h, p];
    }
    return [[], []];
  }, [e]);
  return G.useEffect(() => {
    const d = (t == null ? void 0 : t.target) ?? d6, h = (t == null ? void 0 : t.actInsideInputWithModifier) ?? !0;
    if (e !== null) {
      const p = (b) => {
        var T, j;
        if (a.current = b.ctrlKey || b.metaKey || b.shiftKey || b.altKey, (!a.current || a.current && !h) && aM(b))
          return !1;
        const N = m6(b.code, c);
        if (o.current.add(b[N]), h6(l, o.current, !1)) {
          const R = ((j = (T = b.composedPath) == null ? void 0 : T.call(b)) == null ? void 0 : j[0]) || b.target, A = (R == null ? void 0 : R.nodeName) === "BUTTON" || (R == null ? void 0 : R.nodeName) === "A";
          t.preventDefault !== !1 && (a.current || !A) && b.preventDefault(), r(!0);
        }
      }, g = (b) => {
        const C = m6(b.code, c);
        h6(l, o.current, !0) ? (r(!1), o.current.clear()) : o.current.delete(b[C]), b.key === "Meta" && o.current.clear(), a.current = !1;
      }, x = () => {
        o.current.clear(), r(!1);
      };
      return d == null || d.addEventListener("keydown", p), d == null || d.addEventListener("keyup", g), window.addEventListener("blur", x), window.addEventListener("contextmenu", x), () => {
        d == null || d.removeEventListener("keydown", p), d == null || d.removeEventListener("keyup", g), window.removeEventListener("blur", x), window.removeEventListener("contextmenu", x);
      };
    }
  }, [e, r]), n;
}
function h6(e, t, n) {
  return e.filter((r) => n || r.length === t.size).some((r) => r.every((a) => t.has(a)));
}
function m6(e, t) {
  return t.includes(e) ? "code" : "key";
}
const hX = () => {
  const e = sr();
  return G.useMemo(() => ({
    zoomIn: (t) => {
      const { panZoom: n } = e.getState();
      return n ? n.scaleBy(1.2, { duration: t == null ? void 0 : t.duration }) : Promise.resolve(!1);
    },
    zoomOut: (t) => {
      const { panZoom: n } = e.getState();
      return n ? n.scaleBy(1 / 1.2, { duration: t == null ? void 0 : t.duration }) : Promise.resolve(!1);
    },
    zoomTo: (t, n) => {
      const { panZoom: r } = e.getState();
      return r ? r.scaleTo(t, { duration: n == null ? void 0 : n.duration }) : Promise.resolve(!1);
    },
    getZoom: () => e.getState().transform[2],
    setViewport: async (t, n) => {
      const { transform: [r, a, o], panZoom: l } = e.getState();
      return l ? (await l.setViewport({
        x: t.x ?? r,
        y: t.y ?? a,
        zoom: t.zoom ?? o
      }, n), Promise.resolve(!0)) : Promise.resolve(!1);
    },
    getViewport: () => {
      const [t, n, r] = e.getState().transform;
      return { x: t, y: n, zoom: r };
    },
    setCenter: async (t, n, r) => e.getState().setCenter(t, n, r),
    fitBounds: async (t, n) => {
      const { width: r, height: a, minZoom: o, maxZoom: l, panZoom: c } = e.getState(), d = a5(t, r, a, o, l, (n == null ? void 0 : n.padding) ?? 0.1);
      return c ? (await c.setViewport(d, {
        duration: n == null ? void 0 : n.duration,
        ease: n == null ? void 0 : n.ease,
        interpolate: n == null ? void 0 : n.interpolate
      }), Promise.resolve(!0)) : Promise.resolve(!1);
    },
    screenToFlowPosition: (t, n = {}) => {
      const { transform: r, snapGrid: a, snapToGrid: o, domNode: l } = e.getState();
      if (!l)
        return t;
      const { x: c, y: d } = l.getBoundingClientRect(), h = {
        x: t.x - c,
        y: t.y - d
      }, p = n.snapGrid ?? a, g = n.snapToGrid ?? o;
      return qg(h, r, g, p);
    },
    flowToScreenPosition: (t) => {
      const { transform: n, domNode: r } = e.getState();
      if (!r)
        return t;
      const { x: a, y: o } = r.getBoundingClientRect(), l = E1(t, n);
      return {
        x: l.x + a,
        y: l.y + o
      };
    }
  }), []);
};
function NM(e, t) {
  const n = [], r = /* @__PURE__ */ new Map(), a = [];
  for (const o of e)
    if (o.type === "add") {
      a.push(o);
      continue;
    } else if (o.type === "remove" || o.type === "replace")
      r.set(o.id, [o]);
    else {
      const l = r.get(o.id);
      l ? l.push(o) : r.set(o.id, [o]);
    }
  for (const o of t) {
    const l = r.get(o.id);
    if (!l) {
      n.push(o);
      continue;
    }
    if (l[0].type === "remove")
      continue;
    if (l[0].type === "replace") {
      n.push({ ...l[0].item });
      continue;
    }
    const c = { ...o };
    for (const d of l)
      mX(d, c);
    n.push(c);
  }
  return a.length && a.forEach((o) => {
    o.index !== void 0 ? n.splice(o.index, 0, { ...o.item }) : n.push({ ...o.item });
  }), n;
}
function mX(e, t) {
  switch (e.type) {
    case "select": {
      t.selected = e.selected;
      break;
    }
    case "position": {
      typeof e.position < "u" && (t.position = e.position), typeof e.dragging < "u" && (t.dragging = e.dragging);
      break;
    }
    case "dimensions": {
      typeof e.dimensions < "u" && (t.measured = {
        ...e.dimensions
      }, e.setAttributes && ((e.setAttributes === !0 || e.setAttributes === "width") && (t.width = e.dimensions.width), (e.setAttributes === !0 || e.setAttributes === "height") && (t.height = e.dimensions.height))), typeof e.resizing == "boolean" && (t.resizing = e.resizing);
      break;
    }
  }
}
function jM(e, t) {
  return NM(e, t);
}
function TM(e, t) {
  return NM(e, t);
}
function Uf(e, t) {
  return {
    id: e,
    type: "select",
    selected: t
  };
}
function qh(e, t = /* @__PURE__ */ new Set(), n = !1) {
  const r = [];
  for (const [a, o] of e) {
    const l = t.has(a);
    !(o.selected === void 0 && !l) && o.selected !== l && (n && (o.selected = l), r.push(Uf(o.id, l)));
  }
  return r;
}
function p6({ items: e = [], lookup: t }) {
  var a;
  const n = [], r = new Map(e.map((o) => [o.id, o]));
  for (const [o, l] of e.entries()) {
    const c = t.get(l.id), d = ((a = c == null ? void 0 : c.internals) == null ? void 0 : a.userNode) ?? c;
    d !== void 0 && d !== l && n.push({ id: l.id, item: l, type: "replace" }), d === void 0 && n.push({ item: l, type: "add", index: o });
  }
  for (const [o] of t)
    r.get(o) === void 0 && n.push({ id: o, type: "remove" });
  return n;
}
function g6(e) {
  return {
    id: e.id,
    type: "remove"
  };
}
const y6 = (e) => VY(e), pX = (e) => QA(e);
function AM(e) {
  return G.forwardRef(e);
}
const gX = typeof window < "u" ? G.useLayoutEffect : G.useEffect;
function v6(e) {
  const [t, n] = G.useState(BigInt(0)), [r] = G.useState(() => yX(() => n((a) => a + BigInt(1))));
  return gX(() => {
    const a = r.get();
    a.length && (e(a), r.reset());
  }, [t]), r;
}
function yX(e) {
  let t = [];
  return {
    get: () => t,
    reset: () => {
      t = [];
    },
    push: (n) => {
      t.push(n), e();
    }
  };
}
const MM = G.createContext(null);
function vX({ children: e }) {
  const t = sr(), n = G.useCallback((c) => {
    const { nodes: d = [], setNodes: h, hasDefaultNodes: p, onNodesChange: g, nodeLookup: x, fitViewQueued: b, onNodesChangeMiddlewareMap: C } = t.getState();
    let N = d;
    for (const j of c)
      N = typeof j == "function" ? j(N) : j;
    let T = p6({
      items: N,
      lookup: x
    });
    for (const j of C.values())
      T = j(T);
    p && h(N), T.length > 0 ? g == null || g(T) : b && window.requestAnimationFrame(() => {
      const { fitViewQueued: j, nodes: R, setNodes: A } = t.getState();
      j && A(R);
    });
  }, []), r = v6(n), a = G.useCallback((c) => {
    const { edges: d = [], setEdges: h, hasDefaultEdges: p, onEdgesChange: g, edgeLookup: x } = t.getState();
    let b = d;
    for (const C of c)
      b = typeof C == "function" ? C(b) : C;
    p ? h(b) : g && g(p6({
      items: b,
      lookup: x
    }));
  }, []), o = v6(a), l = G.useMemo(() => ({ nodeQueue: r, edgeQueue: o }), []);
  return m.jsx(MM.Provider, { value: l, children: e });
}
function xX() {
  const e = G.useContext(MM);
  if (!e)
    throw new Error("useBatchContext must be used within a BatchProvider");
  return e;
}
const bX = (e) => !!e.panZoom;
function d5() {
  const e = hX(), t = sr(), n = xX(), r = nn(bX), a = G.useMemo(() => {
    const o = (g) => t.getState().nodeLookup.get(g), l = (g) => {
      n.nodeQueue.push(g);
    }, c = (g) => {
      n.edgeQueue.push(g);
    }, d = (g) => {
      var j, R;
      const { nodeLookup: x, nodeOrigin: b } = t.getState(), C = y6(g) ? g : x.get(g.id), N = C.parentId ? rM(C.position, C.measured, C.parentId, x, b) : C.position, T = {
        ...C,
        position: N,
        width: ((j = C.measured) == null ? void 0 : j.width) ?? C.width,
        height: ((R = C.measured) == null ? void 0 : R.height) ?? C.height
      };
      return Xh(T);
    }, h = (g, x, b = { replace: !1 }) => {
      l((C) => C.map((N) => {
        if (N.id === g) {
          const T = typeof x == "function" ? x(N) : x;
          return b.replace && y6(T) ? T : { ...N, ...T };
        }
        return N;
      }));
    }, p = (g, x, b = { replace: !1 }) => {
      c((C) => C.map((N) => {
        if (N.id === g) {
          const T = typeof x == "function" ? x(N) : x;
          return b.replace && pX(T) ? T : { ...N, ...T };
        }
        return N;
      }));
    };
    return {
      getNodes: () => t.getState().nodes.map((g) => ({ ...g })),
      getNode: (g) => {
        var x;
        return (x = o(g)) == null ? void 0 : x.internals.userNode;
      },
      getInternalNode: o,
      getEdges: () => {
        const { edges: g = [] } = t.getState();
        return g.map((x) => ({ ...x }));
      },
      getEdge: (g) => t.getState().edgeLookup.get(g),
      setNodes: l,
      setEdges: c,
      addNodes: (g) => {
        const x = Array.isArray(g) ? g : [g];
        n.nodeQueue.push((b) => [...b, ...x]);
      },
      addEdges: (g) => {
        const x = Array.isArray(g) ? g : [g];
        n.edgeQueue.push((b) => [...b, ...x]);
      },
      toObject: () => {
        const { nodes: g = [], edges: x = [], transform: b } = t.getState(), [C, N, T] = b;
        return {
          nodes: g.map((j) => ({ ...j })),
          edges: x.map((j) => ({ ...j })),
          viewport: {
            x: C,
            y: N,
            zoom: T
          }
        };
      },
      deleteElements: async ({ nodes: g = [], edges: x = [] }) => {
        const { nodes: b, edges: C, onNodesDelete: N, onEdgesDelete: T, triggerNodeChanges: j, triggerEdgeChanges: R, onDelete: A, onBeforeDelete: z } = t.getState(), { nodes: q, edges: D } = await QY({
          nodesToRemove: g,
          edgesToRemove: x,
          nodes: b,
          edges: C,
          onBeforeDelete: z
        }), P = D.length > 0, re = q.length > 0;
        if (P) {
          const ie = D.map(g6);
          T == null || T(D), R(ie);
        }
        if (re) {
          const ie = q.map(g6);
          N == null || N(q), j(ie);
        }
        return (re || P) && (A == null || A({ nodes: q, edges: D })), { deletedNodes: q, deletedEdges: D };
      },
      /**
       * Partial is defined as "the 2 nodes/areas are intersecting partially".
       * If a is contained in b or b is contained in a, they are both
       * considered fully intersecting.
       */
      getIntersectingNodes: (g, x = !0, b) => {
        const C = YE(g), N = C ? g : d(g), T = b !== void 0;
        return N ? (b || t.getState().nodes).filter((j) => {
          const R = t.getState().nodeLookup.get(j.id);
          if (R && !C && (j.id === g.id || !R.internals.positionAbsolute))
            return !1;
          const A = Xh(T ? j : R), z = Eg(A, N);
          return x && z > 0 || z >= A.width * A.height || z >= N.width * N.height;
        }) : [];
      },
      isNodeIntersecting: (g, x, b = !0) => {
        const N = YE(g) ? g : d(g);
        if (!N)
          return !1;
        const T = Eg(N, x);
        return b && T > 0 || T >= x.width * x.height || T >= N.width * N.height;
      },
      updateNode: h,
      updateNodeData: (g, x, b = { replace: !1 }) => {
        h(g, (C) => {
          const N = typeof x == "function" ? x(C) : x;
          return b.replace ? { ...C, data: N } : { ...C, data: { ...C.data, ...N } };
        }, b);
      },
      updateEdge: p,
      updateEdgeData: (g, x, b = { replace: !1 }) => {
        p(g, (C) => {
          const N = typeof x == "function" ? x(C) : x;
          return b.replace ? { ...C, data: N } : { ...C, data: { ...C.data, ...N } };
        }, b);
      },
      getNodesBounds: (g) => {
        const { nodeLookup: x, nodeOrigin: b } = t.getState();
        return KY(g, { nodeLookup: x, nodeOrigin: b });
      },
      getHandleConnections: ({ type: g, id: x, nodeId: b }) => {
        var C;
        return Array.from(((C = t.getState().connectionLookup.get(`${b}-${g}${x ? `-${x}` : ""}`)) == null ? void 0 : C.values()) ?? []);
      },
      getNodeConnections: ({ type: g, handleId: x, nodeId: b }) => {
        var C;
        return Array.from(((C = t.getState().connectionLookup.get(`${b}${g ? x ? `-${g}-${x}` : `-${g}` : ""}`)) == null ? void 0 : C.values()) ?? []);
      },
      fitView: async (g) => {
        const x = t.getState().fitViewResolver ?? tW();
        return t.setState({ fitViewQueued: !0, fitViewOptions: g, fitViewResolver: x }), n.nodeQueue.push((b) => [...b]), x.promise;
      }
    };
  }, []);
  return G.useMemo(() => ({
    ...a,
    ...e,
    viewportInitialized: r
  }), [r]);
}
const x6 = (e) => e.selected, wX = typeof window < "u" ? window : void 0;
function _X({ deleteKeyCode: e, multiSelectionKeyCode: t }) {
  const n = sr(), { deleteElements: r } = d5(), a = Ng(e, { actInsideInputWithModifier: !1 }), o = Ng(t, { target: wX });
  G.useEffect(() => {
    if (a) {
      const { edges: l, nodes: c } = n.getState();
      r({ nodes: c.filter(x6), edges: l.filter(x6) }), n.setState({ nodesSelectionActive: !1 });
    }
  }, [a]), G.useEffect(() => {
    n.setState({ multiSelectionActive: o });
  }, [o]);
}
function SX(e) {
  const t = sr();
  G.useEffect(() => {
    const n = () => {
      var a, o, l, c;
      if (!e.current || !(((o = (a = e.current).checkVisibility) == null ? void 0 : o.call(a)) ?? !0))
        return !1;
      const r = s5(e.current);
      (r.height === 0 || r.width === 0) && ((c = (l = t.getState()).onError) == null || c.call(l, "004", gl.error004())), t.setState({ width: r.width || 500, height: r.height || 500 });
    };
    if (e.current) {
      n(), window.addEventListener("resize", n);
      const r = new ResizeObserver(() => n());
      return r.observe(e.current), () => {
        window.removeEventListener("resize", n), r && e.current && r.unobserve(e.current);
      };
    }
  }, []);
}
const nv = {
  position: "absolute",
  width: "100%",
  height: "100%",
  top: 0,
  left: 0
}, CX = (e) => ({
  userSelectionActive: e.userSelectionActive,
  lib: e.lib,
  connectionInProgress: e.connection.inProgress
});
function EX({ onPaneContextMenu: e, zoomOnScroll: t = !0, zoomOnPinch: n = !0, panOnScroll: r = !1, panOnScrollSpeed: a = 0.5, panOnScrollMode: o = Jf.Free, zoomOnDoubleClick: l = !0, panOnDrag: c = !0, defaultViewport: d, translateExtent: h, minZoom: p, maxZoom: g, zoomActivationKeyCode: x, preventScrolling: b = !0, children: C, noWheelClassName: N, noPanClassName: T, onViewportChange: j, isControlledViewport: R, paneClickDistance: A, selectionOnDrag: z }) {
  const q = sr(), D = G.useRef(null), { userSelectionActive: P, lib: re, connectionInProgress: ie } = nn(CX, ar), X = Ng(x), K = G.useRef();
  SX(D);
  const V = G.useCallback((de) => {
    j == null || j({ x: de[0], y: de[1], zoom: de[2] }), R || q.setState({ transform: de });
  }, [j, R]);
  return G.useEffect(() => {
    if (D.current) {
      K.current = PW({
        domNode: D.current,
        minZoom: p,
        maxZoom: g,
        translateExtent: h,
        viewport: d,
        onDraggingChange: (Z) => q.setState({ paneDragging: Z }),
        onPanZoomStart: (Z, fe) => {
          const { onViewportChangeStart: he, onMoveStart: ge } = q.getState();
          ge == null || ge(Z, fe), he == null || he(fe);
        },
        onPanZoom: (Z, fe) => {
          const { onViewportChange: he, onMove: ge } = q.getState();
          ge == null || ge(Z, fe), he == null || he(fe);
        },
        onPanZoomEnd: (Z, fe) => {
          const { onViewportChangeEnd: he, onMoveEnd: ge } = q.getState();
          ge == null || ge(Z, fe), he == null || he(fe);
        }
      });
      const { x: de, y: H, zoom: se } = K.current.getViewport();
      return q.setState({
        panZoom: K.current,
        transform: [de, H, se],
        domNode: D.current.closest(".react-flow")
      }), () => {
        var Z;
        (Z = K.current) == null || Z.destroy();
      };
    }
  }, []), G.useEffect(() => {
    var de;
    (de = K.current) == null || de.update({
      onPaneContextMenu: e,
      zoomOnScroll: t,
      zoomOnPinch: n,
      panOnScroll: r,
      panOnScrollSpeed: a,
      panOnScrollMode: o,
      zoomOnDoubleClick: l,
      panOnDrag: c,
      zoomActivationKeyPressed: X,
      preventScrolling: b,
      noPanClassName: T,
      userSelectionActive: P,
      noWheelClassName: N,
      lib: re,
      onTransformChange: V,
      connectionInProgress: ie,
      selectionOnDrag: z,
      paneClickDistance: A
    });
  }, [
    e,
    t,
    n,
    r,
    a,
    o,
    l,
    c,
    X,
    b,
    T,
    P,
    N,
    re,
    V,
    ie,
    z,
    A
  ]), m.jsx("div", { className: "react-flow__renderer", ref: D, style: nv, children: C });
}
const kX = (e) => ({
  userSelectionActive: e.userSelectionActive,
  userSelectionRect: e.userSelectionRect
});
function NX() {
  const { userSelectionActive: e, userSelectionRect: t } = nn(kX, ar);
  return e && t ? m.jsx("div", { className: "react-flow__selection react-flow__container", style: {
    width: t.width,
    height: t.height,
    transform: `translate(${t.x}px, ${t.y}px)`
  } }) : null;
}
const tb = (e, t) => (n) => {
  n.target === t.current && (e == null || e(n));
}, jX = (e) => ({
  userSelectionActive: e.userSelectionActive,
  elementsSelectable: e.elementsSelectable,
  connectionInProgress: e.connection.inProgress,
  dragging: e.paneDragging
});
function TX({ isSelecting: e, selectionKeyPressed: t, selectionMode: n = Sg.Full, panOnDrag: r, paneClickDistance: a, selectionOnDrag: o, onSelectionStart: l, onSelectionEnd: c, onPaneClick: d, onPaneContextMenu: h, onPaneScroll: p, onPaneMouseEnter: g, onPaneMouseMove: x, onPaneMouseLeave: b, children: C }) {
  const N = sr(), { userSelectionActive: T, elementsSelectable: j, dragging: R, connectionInProgress: A } = nn(jX, ar), z = j && (e || T), q = G.useRef(null), D = G.useRef(), P = G.useRef(/* @__PURE__ */ new Set()), re = G.useRef(/* @__PURE__ */ new Set()), ie = G.useRef(!1), X = (he) => {
    if (ie.current || A) {
      ie.current = !1;
      return;
    }
    d == null || d(he), N.getState().resetSelectedElements(), N.setState({ nodesSelectionActive: !1 });
  }, K = (he) => {
    if (Array.isArray(r) && (r != null && r.includes(2))) {
      he.preventDefault();
      return;
    }
    h == null || h(he);
  }, V = p ? (he) => p(he) : void 0, de = (he) => {
    ie.current && (he.stopPropagation(), ie.current = !1);
  }, H = (he) => {
    var xe, Se;
    const { domNode: ge } = N.getState();
    if (D.current = ge == null ? void 0 : ge.getBoundingClientRect(), !D.current)
      return;
    const Q = he.target === q.current;
    if (!Q && !!he.target.closest(".nokey") || !e || !(o && Q || t) || he.button !== 0 || !he.isPrimary)
      return;
    (Se = (xe = he.target) == null ? void 0 : xe.setPointerCapture) == null || Se.call(xe, he.pointerId), ie.current = !1;
    const { x: Y, y: le } = ho(he.nativeEvent, D.current);
    N.setState({
      userSelectionRect: {
        width: 0,
        height: 0,
        startX: Y,
        startY: le,
        x: Y,
        y: le
      }
    }), Q || (he.stopPropagation(), he.preventDefault());
  }, se = (he) => {
    const { userSelectionRect: ge, transform: Q, nodeLookup: U, edgeLookup: ue, connectionLookup: Y, triggerNodeChanges: le, triggerEdgeChanges: xe, defaultEdgeOptions: Se, resetSelectedElements: Oe } = N.getState();
    if (!D.current || !ge)
      return;
    const { x: qe, y: Me } = ho(he.nativeEvent, D.current), { startX: Pe, startY: Re } = ge;
    if (!ie.current) {
      const bt = t ? 0 : a;
      if (Math.hypot(qe - Pe, Me - Re) <= bt)
        return;
      Oe(), l == null || l(he);
    }
    ie.current = !0;
    const Be = {
      startX: Pe,
      startY: Re,
      x: qe < Pe ? qe : Pe,
      y: Me < Re ? Me : Re,
      width: Math.abs(qe - Pe),
      height: Math.abs(Me - Re)
    }, Je = P.current, ot = re.current;
    P.current = new Set(i5(U, Be, Q, n === Sg.Partial, !0).map((bt) => bt.id)), re.current = /* @__PURE__ */ new Set();
    const We = (Se == null ? void 0 : Se.selectable) ?? !0;
    for (const bt of P.current) {
      const vt = Y.get(bt);
      if (vt)
        for (const { edgeId: Yn } of vt.values()) {
          const Mn = ue.get(Yn);
          Mn && (Mn.selectable ?? We) && re.current.add(Yn);
        }
    }
    if (!WE(Je, P.current)) {
      const bt = qh(U, P.current, !0);
      le(bt);
    }
    if (!WE(ot, re.current)) {
      const bt = qh(ue, re.current);
      xe(bt);
    }
    N.setState({
      userSelectionRect: Be,
      userSelectionActive: !0,
      nodesSelectionActive: !1
    });
  }, Z = (he) => {
    var ge, Q;
    he.button === 0 && ((Q = (ge = he.target) == null ? void 0 : ge.releasePointerCapture) == null || Q.call(ge, he.pointerId), !T && he.target === q.current && N.getState().userSelectionRect && (X == null || X(he)), N.setState({
      userSelectionActive: !1,
      userSelectionRect: null
    }), ie.current && (c == null || c(he), N.setState({
      nodesSelectionActive: P.current.size > 0
    })));
  }, fe = r === !0 || Array.isArray(r) && r.includes(0);
  return m.jsxs("div", { className: Dr(["react-flow__pane", { draggable: fe, dragging: R, selection: e }]), onClick: z ? void 0 : tb(X, q), onContextMenu: tb(K, q), onWheel: tb(V, q), onPointerEnter: z ? void 0 : g, onPointerMove: z ? se : x, onPointerUp: z ? Z : void 0, onPointerDownCapture: z ? H : void 0, onClickCapture: z ? de : void 0, onPointerLeave: b, ref: q, style: nv, children: [C, m.jsx(NX, {})] });
}
function dS({ id: e, store: t, unselect: n = !1, nodeRef: r }) {
  const { addSelectedNodes: a, unselectNodesAndEdges: o, multiSelectionActive: l, nodeLookup: c, onError: d } = t.getState(), h = c.get(e);
  if (!h) {
    d == null || d("012", gl.error012(e));
    return;
  }
  t.setState({ nodesSelectionActive: !1 }), h.selected ? (n || h.selected && l) && (o({ nodes: [h], edges: [] }), requestAnimationFrame(() => {
    var p;
    return (p = r == null ? void 0 : r.current) == null ? void 0 : p.blur();
  })) : a([e]);
}
function RM({ nodeRef: e, disabled: t = !1, noDragClassName: n, handleSelector: r, nodeId: a, isSelectable: o, nodeClickDistance: l }) {
  const c = sr(), [d, h] = G.useState(!1), p = G.useRef();
  return G.useEffect(() => {
    p.current = CW({
      getStoreItems: () => c.getState(),
      onNodeMouseDown: (g) => {
        dS({
          id: g,
          store: c,
          nodeRef: e
        });
      },
      onDragStart: () => {
        h(!0);
      },
      onDragStop: () => {
        h(!1);
      }
    });
  }, []), G.useEffect(() => {
    var g, x;
    if (t)
      (g = p.current) == null || g.destroy();
    else if (e.current)
      return (x = p.current) == null || x.update({
        noDragClassName: n,
        handleSelector: r,
        domNode: e.current,
        isSelectable: o,
        nodeId: a,
        nodeClickDistance: l
      }), () => {
        var b;
        (b = p.current) == null || b.destroy();
      };
  }, [n, r, t, o, e, a]), d;
}
const AX = (e) => (t) => t.selected && (t.draggable || e && typeof t.draggable > "u");
function OM() {
  const e = sr();
  return G.useCallback((n) => {
    const { nodeExtent: r, snapToGrid: a, snapGrid: o, nodesDraggable: l, onError: c, updateNodePositions: d, nodeLookup: h, nodeOrigin: p } = e.getState(), g = /* @__PURE__ */ new Map(), x = AX(l), b = a ? o[0] : 5, C = a ? o[1] : 5, N = n.direction.x * b * n.factor, T = n.direction.y * C * n.factor;
    for (const [, j] of h) {
      if (!x(j))
        continue;
      let R = {
        x: j.internals.positionAbsolute.x + N,
        y: j.internals.positionAbsolute.y + T
      };
      a && (R = Pg(R, o));
      const { position: A, positionAbsolute: z } = ZA({
        nodeId: j.id,
        nextPosition: R,
        nodeLookup: h,
        nodeExtent: r,
        nodeOrigin: p,
        onError: c
      });
      j.position = A, j.internals.positionAbsolute = z, g.set(j.id, j);
    }
    d(g);
  }, []);
}
const h5 = G.createContext(null), MX = h5.Provider;
h5.Consumer;
const zM = () => G.useContext(h5), RX = (e) => ({
  connectOnClick: e.connectOnClick,
  noPanClassName: e.noPanClassName,
  rfId: e.rfId
}), OX = (e, t, n) => (r) => {
  const { connectionClickStartHandle: a, connectionMode: o, connection: l } = r, { fromHandle: c, toHandle: d, isValid: h } = l, p = (d == null ? void 0 : d.nodeId) === e && (d == null ? void 0 : d.id) === t && (d == null ? void 0 : d.type) === n;
  return {
    connectingFrom: (c == null ? void 0 : c.nodeId) === e && (c == null ? void 0 : c.id) === t && (c == null ? void 0 : c.type) === n,
    connectingTo: p,
    clickConnecting: (a == null ? void 0 : a.nodeId) === e && (a == null ? void 0 : a.id) === t && (a == null ? void 0 : a.type) === n,
    isPossibleEndHandle: o === Yh.Strict ? (c == null ? void 0 : c.type) !== n : e !== (c == null ? void 0 : c.nodeId) || t !== (c == null ? void 0 : c.id),
    connectionInProcess: !!c,
    clickConnectionInProcess: !!a,
    valid: p && h
  };
};
function zX({ type: e = "source", position: t = pt.Top, isValidConnection: n, isConnectable: r = !0, isConnectableStart: a = !0, isConnectableEnd: o = !0, id: l, onConnect: c, children: d, className: h, onMouseDown: p, onTouchStart: g, ...x }, b) {
  var se, Z;
  const C = l || null, N = e === "target", T = sr(), j = zM(), { connectOnClick: R, noPanClassName: A, rfId: z } = nn(RX, ar), { connectingFrom: q, connectingTo: D, clickConnecting: P, isPossibleEndHandle: re, connectionInProcess: ie, clickConnectionInProcess: X, valid: K } = nn(OX(j, C, e), ar);
  j || (Z = (se = T.getState()).onError) == null || Z.call(se, "010", gl.error010());
  const V = (fe) => {
    const { defaultEdgeOptions: he, onConnect: ge, hasDefaultEdges: Q } = T.getState(), U = {
      ...he,
      ...fe
    };
    if (Q) {
      const { edges: ue, setEdges: Y } = T.getState();
      Y(lW(U, ue));
    }
    ge == null || ge(U), c == null || c(U);
  }, de = (fe) => {
    if (!j)
      return;
    const he = sM(fe.nativeEvent);
    if (a && (he && fe.button === 0 || !he)) {
      const ge = T.getState();
      fS.onPointerDown(fe.nativeEvent, {
        handleDomNode: fe.currentTarget,
        autoPanOnConnect: ge.autoPanOnConnect,
        connectionMode: ge.connectionMode,
        connectionRadius: ge.connectionRadius,
        domNode: ge.domNode,
        nodeLookup: ge.nodeLookup,
        lib: ge.lib,
        isTarget: N,
        handleId: C,
        nodeId: j,
        flowId: ge.rfId,
        panBy: ge.panBy,
        cancelConnection: ge.cancelConnection,
        onConnectStart: ge.onConnectStart,
        onConnectEnd: ge.onConnectEnd,
        updateConnection: ge.updateConnection,
        onConnect: V,
        isValidConnection: n || ge.isValidConnection,
        getTransform: () => T.getState().transform,
        getFromHandle: () => T.getState().connection.fromHandle,
        autoPanSpeed: ge.autoPanSpeed,
        dragThreshold: ge.connectionDragThreshold
      });
    }
    he ? p == null || p(fe) : g == null || g(fe);
  }, H = (fe) => {
    const { onClickConnectStart: he, onClickConnectEnd: ge, connectionClickStartHandle: Q, connectionMode: U, isValidConnection: ue, lib: Y, rfId: le, nodeLookup: xe, connection: Se } = T.getState();
    if (!j || !Q && !a)
      return;
    if (!Q) {
      he == null || he(fe.nativeEvent, { nodeId: j, handleId: C, handleType: e }), T.setState({ connectionClickStartHandle: { nodeId: j, type: e, id: C } });
      return;
    }
    const Oe = iM(fe.target), qe = n || ue, { connection: Me, isValid: Pe } = fS.isValid(fe.nativeEvent, {
      handle: {
        nodeId: j,
        id: C,
        type: e
      },
      connectionMode: U,
      fromNodeId: Q.nodeId,
      fromHandleId: Q.id || null,
      fromType: Q.type,
      isValidConnection: qe,
      flowId: le,
      doc: Oe,
      lib: Y,
      nodeLookup: xe
    });
    Pe && Me && V(Me);
    const Re = structuredClone(Se);
    delete Re.inProgress, Re.toPosition = Re.toHandle ? Re.toHandle.position : null, ge == null || ge(fe, Re), T.setState({ connectionClickStartHandle: null });
  };
  return m.jsx("div", { "data-handleid": C, "data-nodeid": j, "data-handlepos": t, "data-id": `${z}-${j}-${C}-${e}`, className: Dr([
    "react-flow__handle",
    `react-flow__handle-${t}`,
    "nodrag",
    A,
    h,
    {
      source: !N,
      target: N,
      connectable: r,
      connectablestart: a,
      connectableend: o,
      clickconnecting: P,
      connectingfrom: q,
      connectingto: D,
      valid: K,
      /*
       * shows where you can start a connection from
       * and where you can end it while connecting
       */
      connectionindicator: r && (!ie || re) && (ie || X ? o : a)
    }
  ]), onMouseDown: de, onTouchStart: de, onClick: R ? H : void 0, ref: b, ...x, children: d });
}
const Mi = G.memo(AM(zX));
function DX({ data: e, isConnectable: t, sourcePosition: n = pt.Bottom }) {
  return m.jsxs(m.Fragment, { children: [e == null ? void 0 : e.label, m.jsx(Mi, { type: "source", position: n, isConnectable: t })] });
}
function IX({ data: e, isConnectable: t, targetPosition: n = pt.Top, sourcePosition: r = pt.Bottom }) {
  return m.jsxs(m.Fragment, { children: [m.jsx(Mi, { type: "target", position: n, isConnectable: t }), e == null ? void 0 : e.label, m.jsx(Mi, { type: "source", position: r, isConnectable: t })] });
}
function LX() {
  return null;
}
function PX({ data: e, isConnectable: t, targetPosition: n = pt.Top }) {
  return m.jsxs(m.Fragment, { children: [m.jsx(Mi, { type: "target", position: n, isConnectable: t }), e == null ? void 0 : e.label] });
}
const k1 = {
  ArrowUp: { x: 0, y: -1 },
  ArrowDown: { x: 0, y: 1 },
  ArrowLeft: { x: -1, y: 0 },
  ArrowRight: { x: 1, y: 0 }
}, b6 = {
  input: DX,
  default: IX,
  output: PX,
  group: LX
};
function qX(e) {
  var t, n, r, a;
  return e.internals.handleBounds === void 0 ? {
    width: e.width ?? e.initialWidth ?? ((t = e.style) == null ? void 0 : t.width),
    height: e.height ?? e.initialHeight ?? ((n = e.style) == null ? void 0 : n.height)
  } : {
    width: e.width ?? ((r = e.style) == null ? void 0 : r.width),
    height: e.height ?? ((a = e.style) == null ? void 0 : a.height)
  };
}
const BX = (e) => {
  const { width: t, height: n, x: r, y: a } = Lg(e.nodeLookup, {
    filter: (o) => !!o.selected
  });
  return {
    width: fo(t) ? t : null,
    height: fo(n) ? n : null,
    userSelectionActive: e.userSelectionActive,
    transformString: `translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${r}px,${a}px)`
  };
};
function FX({ onSelectionContextMenu: e, noPanClassName: t, disableKeyboardA11y: n }) {
  const r = sr(), { width: a, height: o, transformString: l, userSelectionActive: c } = nn(BX, ar), d = OM(), h = G.useRef(null);
  if (G.useEffect(() => {
    var x;
    n || (x = h.current) == null || x.focus({
      preventScroll: !0
    });
  }, [n]), RM({
    nodeRef: h
  }), c || !a || !o)
    return null;
  const p = e ? (x) => {
    const b = r.getState().nodes.filter((C) => C.selected);
    e(x, b);
  } : void 0, g = (x) => {
    Object.prototype.hasOwnProperty.call(k1, x.key) && (x.preventDefault(), d({
      direction: k1[x.key],
      factor: x.shiftKey ? 4 : 1
    }));
  };
  return m.jsx("div", { className: Dr(["react-flow__nodesselection", "react-flow__container", t]), style: {
    transform: l
  }, children: m.jsx("div", { ref: h, className: "react-flow__nodesselection-rect", onContextMenu: p, tabIndex: n ? void 0 : -1, onKeyDown: n ? void 0 : g, style: {
    width: a,
    height: o
  } }) });
}
const w6 = typeof window < "u" ? window : void 0, UX = (e) => ({ nodesSelectionActive: e.nodesSelectionActive, userSelectionActive: e.userSelectionActive });
function DM({ children: e, onPaneClick: t, onPaneMouseEnter: n, onPaneMouseMove: r, onPaneMouseLeave: a, onPaneContextMenu: o, onPaneScroll: l, paneClickDistance: c, deleteKeyCode: d, selectionKeyCode: h, selectionOnDrag: p, selectionMode: g, onSelectionStart: x, onSelectionEnd: b, multiSelectionKeyCode: C, panActivationKeyCode: N, zoomActivationKeyCode: T, elementsSelectable: j, zoomOnScroll: R, zoomOnPinch: A, panOnScroll: z, panOnScrollSpeed: q, panOnScrollMode: D, zoomOnDoubleClick: P, panOnDrag: re, defaultViewport: ie, translateExtent: X, minZoom: K, maxZoom: V, preventScrolling: de, onSelectionContextMenu: H, noWheelClassName: se, noPanClassName: Z, disableKeyboardA11y: fe, onViewportChange: he, isControlledViewport: ge }) {
  const { nodesSelectionActive: Q, userSelectionActive: U } = nn(UX, ar), ue = Ng(h, { target: w6 }), Y = Ng(N, { target: w6 }), le = Y || re, xe = Y || z, Se = p && le !== !0, Oe = ue || U || Se;
  return _X({ deleteKeyCode: d, multiSelectionKeyCode: C }), m.jsx(EX, { onPaneContextMenu: o, elementsSelectable: j, zoomOnScroll: R, zoomOnPinch: A, panOnScroll: xe, panOnScrollSpeed: q, panOnScrollMode: D, zoomOnDoubleClick: P, panOnDrag: !ue && le, defaultViewport: ie, translateExtent: X, minZoom: K, maxZoom: V, zoomActivationKeyCode: T, preventScrolling: de, noWheelClassName: se, noPanClassName: Z, onViewportChange: he, isControlledViewport: ge, paneClickDistance: c, selectionOnDrag: Se, children: m.jsxs(TX, { onSelectionStart: x, onSelectionEnd: b, onPaneClick: t, onPaneMouseEnter: n, onPaneMouseMove: r, onPaneMouseLeave: a, onPaneContextMenu: o, onPaneScroll: l, panOnDrag: le, isSelecting: !!Oe, selectionMode: g, selectionKeyPressed: ue, paneClickDistance: c, selectionOnDrag: Se, children: [e, Q && m.jsx(FX, { onSelectionContextMenu: H, noPanClassName: Z, disableKeyboardA11y: fe })] }) });
}
DM.displayName = "FlowRenderer";
const $X = G.memo(DM), HX = (e) => (t) => e ? i5(t.nodeLookup, { x: 0, y: 0, width: t.width, height: t.height }, t.transform, !0).map((n) => n.id) : Array.from(t.nodeLookup.keys());
function GX(e) {
  return nn(G.useCallback(HX(e), [e]), ar);
}
const VX = (e) => e.updateNodeInternals;
function KX() {
  const e = nn(VX), [t] = G.useState(() => typeof ResizeObserver > "u" ? null : new ResizeObserver((n) => {
    const r = /* @__PURE__ */ new Map();
    n.forEach((a) => {
      const o = a.target.getAttribute("data-id");
      r.set(o, {
        id: o,
        nodeElement: a.target,
        force: !0
      });
    }), e(r);
  }));
  return G.useEffect(() => () => {
    t == null || t.disconnect();
  }, [t]), t;
}
function YX({ node: e, nodeType: t, hasDimensions: n, resizeObserver: r }) {
  const a = sr(), o = G.useRef(null), l = G.useRef(null), c = G.useRef(e.sourcePosition), d = G.useRef(e.targetPosition), h = G.useRef(t), p = n && !!e.internals.handleBounds;
  return G.useEffect(() => {
    o.current && !e.hidden && (!p || l.current !== o.current) && (l.current && (r == null || r.unobserve(l.current)), r == null || r.observe(o.current), l.current = o.current);
  }, [p, e.hidden]), G.useEffect(() => () => {
    l.current && (r == null || r.unobserve(l.current), l.current = null);
  }, []), G.useEffect(() => {
    if (o.current) {
      const g = h.current !== t, x = c.current !== e.sourcePosition, b = d.current !== e.targetPosition;
      (g || x || b) && (h.current = t, c.current = e.sourcePosition, d.current = e.targetPosition, a.getState().updateNodeInternals(/* @__PURE__ */ new Map([[e.id, { id: e.id, nodeElement: o.current, force: !0 }]])));
    }
  }, [e.id, t, e.sourcePosition, e.targetPosition]), o;
}
function WX({ id: e, onClick: t, onMouseEnter: n, onMouseMove: r, onMouseLeave: a, onContextMenu: o, onDoubleClick: l, nodesDraggable: c, elementsSelectable: d, nodesConnectable: h, nodesFocusable: p, resizeObserver: g, noDragClassName: x, noPanClassName: b, disableKeyboardA11y: C, rfId: N, nodeTypes: T, nodeClickDistance: j, onError: R }) {
  const { node: A, internals: z, isParent: q } = nn((qe) => {
    const Me = qe.nodeLookup.get(e), Pe = qe.parentLookup.has(e);
    return {
      node: Me,
      internals: Me.internals,
      isParent: Pe
    };
  }, ar);
  let D = A.type || "default", P = (T == null ? void 0 : T[D]) || b6[D];
  P === void 0 && (R == null || R("003", gl.error003(D)), D = "default", P = (T == null ? void 0 : T.default) || b6.default);
  const re = !!(A.draggable || c && typeof A.draggable > "u"), ie = !!(A.selectable || d && typeof A.selectable > "u"), X = !!(A.connectable || h && typeof A.connectable > "u"), K = !!(A.focusable || p && typeof A.focusable > "u"), V = sr(), de = nM(A), H = YX({ node: A, nodeType: D, hasDimensions: de, resizeObserver: g }), se = RM({
    nodeRef: H,
    disabled: A.hidden || !re,
    noDragClassName: x,
    handleSelector: A.dragHandle,
    nodeId: e,
    isSelectable: ie,
    nodeClickDistance: j
  }), Z = OM();
  if (A.hidden)
    return null;
  const fe = ou(A), he = qX(A), ge = ie || re || t || n || r || a, Q = n ? (qe) => n(qe, { ...z.userNode }) : void 0, U = r ? (qe) => r(qe, { ...z.userNode }) : void 0, ue = a ? (qe) => a(qe, { ...z.userNode }) : void 0, Y = o ? (qe) => o(qe, { ...z.userNode }) : void 0, le = l ? (qe) => l(qe, { ...z.userNode }) : void 0, xe = (qe) => {
    const { selectNodesOnDrag: Me, nodeDragThreshold: Pe } = V.getState();
    ie && (!Me || !re || Pe > 0) && dS({
      id: e,
      store: V,
      nodeRef: H
    }), t && t(qe, { ...z.userNode });
  }, Se = (qe) => {
    if (!(aM(qe.nativeEvent) || C)) {
      if (KA.includes(qe.key) && ie) {
        const Me = qe.key === "Escape";
        dS({
          id: e,
          store: V,
          unselect: Me,
          nodeRef: H
        });
      } else if (re && A.selected && Object.prototype.hasOwnProperty.call(k1, qe.key)) {
        qe.preventDefault();
        const { ariaLabelConfig: Me } = V.getState();
        V.setState({
          ariaLiveMessage: Me["node.a11yDescription.ariaLiveMessage"]({
            direction: qe.key.replace("Arrow", "").toLowerCase(),
            x: ~~z.positionAbsolute.x,
            y: ~~z.positionAbsolute.y
          })
        }), Z({
          direction: k1[qe.key],
          factor: qe.shiftKey ? 4 : 1
        });
      }
    }
  }, Oe = () => {
    var ot;
    if (C || !((ot = H.current) != null && ot.matches(":focus-visible")))
      return;
    const { transform: qe, width: Me, height: Pe, autoPanOnNodeFocus: Re, setCenter: Be } = V.getState();
    if (!Re)
      return;
    i5(/* @__PURE__ */ new Map([[e, A]]), { x: 0, y: 0, width: Me, height: Pe }, qe, !0).length > 0 || Be(A.position.x + fe.width / 2, A.position.y + fe.height / 2, {
      zoom: qe[2]
    });
  };
  return m.jsx("div", { className: Dr([
    "react-flow__node",
    `react-flow__node-${D}`,
    {
      // this is overwritable by passing `nopan` as a class name
      [b]: re
    },
    A.className,
    {
      selected: A.selected,
      selectable: ie,
      parent: q,
      draggable: re,
      dragging: se
    }
  ]), ref: H, style: {
    zIndex: z.z,
    transform: `translate(${z.positionAbsolute.x}px,${z.positionAbsolute.y}px)`,
    pointerEvents: ge ? "all" : "none",
    visibility: de ? "visible" : "hidden",
    ...A.style,
    ...he
  }, "data-id": e, "data-testid": `rf__node-${e}`, onMouseEnter: Q, onMouseMove: U, onMouseLeave: ue, onContextMenu: Y, onClick: xe, onDoubleClick: le, onKeyDown: K ? Se : void 0, tabIndex: K ? 0 : void 0, onFocus: K ? Oe : void 0, role: A.ariaRole ?? (K ? "group" : void 0), "aria-roledescription": "node", "aria-describedby": C ? void 0 : `${CM}-${N}`, "aria-label": A.ariaLabel, ...A.domAttributes, children: m.jsx(MX, { value: e, children: m.jsx(P, { id: e, data: A.data, type: D, positionAbsoluteX: z.positionAbsolute.x, positionAbsoluteY: z.positionAbsolute.y, selected: A.selected ?? !1, selectable: ie, draggable: re, deletable: A.deletable ?? !0, isConnectable: X, sourcePosition: A.sourcePosition, targetPosition: A.targetPosition, dragging: se, dragHandle: A.dragHandle, zIndex: z.z, parentId: A.parentId, ...fe }) }) });
}
var XX = G.memo(WX);
const QX = (e) => ({
  nodesDraggable: e.nodesDraggable,
  nodesConnectable: e.nodesConnectable,
  nodesFocusable: e.nodesFocusable,
  elementsSelectable: e.elementsSelectable,
  onError: e.onError
});
function IM(e) {
  const { nodesDraggable: t, nodesConnectable: n, nodesFocusable: r, elementsSelectable: a, onError: o } = nn(QX, ar), l = GX(e.onlyRenderVisibleElements), c = KX();
  return m.jsx("div", { className: "react-flow__nodes", style: nv, children: l.map((d) => (
    /*
     * The split of responsibilities between NodeRenderer and
     * NodeComponentWrapper may appear weird. However, its designed to
     * minimize the cost of updates when individual nodes change.
     *
     * For example, when youre dragging a single node, that node gets
     * updated multiple times per second. If `NodeRenderer` were to update
     * every time, it would have to re-run the `nodes.map()` loop every
     * time. This gets pricey with hundreds of nodes, especially if every
     * loop cycle does more than just rendering a JSX element!
     *
     * As a result of this choice, we took the following implementation
     * decisions:
     * - NodeRenderer subscribes *only* to node IDs  and therefore
     *   rerender *only* when visible nodes are added or removed.
     * - NodeRenderer performs all operations the result of which can be
     *   shared between nodes (such as creating the `ResizeObserver`
     *   instance, or subscribing to `selector`). This means extra prop
     *   drilling into `NodeComponentWrapper`, but it means we need to run
     *   these operations only once  instead of once per node.
     * - Any operations that youd normally write inside `nodes.map` are
     *   moved into `NodeComponentWrapper`. This ensures they are
     *   memorized  so if `NodeRenderer` *has* to rerender, it only
     *   needs to regenerate the list of nodes, nothing else.
     */
    m.jsx(XX, { id: d, nodeTypes: e.nodeTypes, nodeExtent: e.nodeExtent, onClick: e.onNodeClick, onMouseEnter: e.onNodeMouseEnter, onMouseMove: e.onNodeMouseMove, onMouseLeave: e.onNodeMouseLeave, onContextMenu: e.onNodeContextMenu, onDoubleClick: e.onNodeDoubleClick, noDragClassName: e.noDragClassName, noPanClassName: e.noPanClassName, rfId: e.rfId, disableKeyboardA11y: e.disableKeyboardA11y, resizeObserver: c, nodesDraggable: t, nodesConnectable: n, nodesFocusable: r, elementsSelectable: a, nodeClickDistance: e.nodeClickDistance, onError: o }, d)
  )) });
}
IM.displayName = "NodeRenderer";
const ZX = G.memo(IM);
function JX(e) {
  return nn(G.useCallback((n) => {
    if (!e)
      return n.edges.map((a) => a.id);
    const r = [];
    if (n.width && n.height)
      for (const a of n.edges) {
        const o = n.nodeLookup.get(a.source), l = n.nodeLookup.get(a.target);
        o && l && aW({
          sourceNode: o,
          targetNode: l,
          width: n.width,
          height: n.height,
          transform: n.transform
        }) && r.push(a.id);
      }
    return r;
  }, [e]), ar);
}
const eQ = ({ color: e = "none", strokeWidth: t = 1 }) => {
  const n = {
    strokeWidth: t,
    ...e && { stroke: e }
  };
  return m.jsx("polyline", { className: "arrow", style: n, strokeLinecap: "round", fill: "none", strokeLinejoin: "round", points: "-5,-4 0,0 -5,4" });
}, tQ = ({ color: e = "none", strokeWidth: t = 1 }) => {
  const n = {
    strokeWidth: t,
    ...e && { stroke: e, fill: e }
  };
  return m.jsx("polyline", { className: "arrowclosed", style: n, strokeLinecap: "round", strokeLinejoin: "round", points: "-5,-4 0,0 -5,4 -5,-4" });
}, _6 = {
  [Cg.Arrow]: eQ,
  [Cg.ArrowClosed]: tQ
};
function nQ(e) {
  const t = sr();
  return G.useMemo(() => {
    var a, o;
    return Object.prototype.hasOwnProperty.call(_6, e) ? _6[e] : ((o = (a = t.getState()).onError) == null || o.call(a, "009", gl.error009(e)), null);
  }, [e]);
}
const rQ = ({ id: e, type: t, color: n, width: r = 12.5, height: a = 12.5, markerUnits: o = "strokeWidth", strokeWidth: l, orient: c = "auto-start-reverse" }) => {
  const d = nQ(t);
  return d ? m.jsx("marker", { className: "react-flow__arrowhead", id: e, markerWidth: `${r}`, markerHeight: `${a}`, viewBox: "-10 -10 20 20", markerUnits: o, orient: c, refX: "0", refY: "0", children: m.jsx(d, { color: n, strokeWidth: l }) }) : null;
}, LM = ({ defaultColor: e, rfId: t }) => {
  const n = nn((o) => o.edges), r = nn((o) => o.defaultEdgeOptions), a = G.useMemo(() => hW(n, {
    id: t,
    defaultColor: e,
    defaultMarkerStart: r == null ? void 0 : r.markerStart,
    defaultMarkerEnd: r == null ? void 0 : r.markerEnd
  }), [n, r, t, e]);
  return a.length ? m.jsx("svg", { className: "react-flow__marker", "aria-hidden": "true", children: m.jsx("defs", { children: a.map((o) => m.jsx(rQ, { id: o.id, type: o.type, color: o.color, width: o.width, height: o.height, markerUnits: o.markerUnits, strokeWidth: o.strokeWidth, orient: o.orient }, o.id)) }) }) : null;
};
LM.displayName = "MarkerDefinitions";
var iQ = G.memo(LM);
function PM({ x: e, y: t, label: n, labelStyle: r, labelShowBg: a = !0, labelBgStyle: o, labelBgPadding: l = [2, 4], labelBgBorderRadius: c = 2, children: d, className: h, ...p }) {
  const [g, x] = G.useState({ x: 1, y: 0, width: 0, height: 0 }), b = Dr(["react-flow__edge-textwrapper", h]), C = G.useRef(null);
  return G.useEffect(() => {
    if (C.current) {
      const N = C.current.getBBox();
      x({
        x: N.x,
        y: N.y,
        width: N.width,
        height: N.height
      });
    }
  }, [n]), n ? m.jsxs("g", { transform: `translate(${e - g.width / 2} ${t - g.height / 2})`, className: b, visibility: g.width ? "visible" : "hidden", ...p, children: [a && m.jsx("rect", { width: g.width + 2 * l[0], x: -l[0], y: -l[1], height: g.height + 2 * l[1], className: "react-flow__edge-textbg", style: o, rx: c, ry: c }), m.jsx("text", { className: "react-flow__edge-text", y: g.height / 2, dy: "0.3em", ref: C, style: r, children: n }), d] }) : null;
}
PM.displayName = "EdgeText";
const aQ = G.memo(PM);
function rv({ path: e, labelX: t, labelY: n, label: r, labelStyle: a, labelShowBg: o, labelBgStyle: l, labelBgPadding: c, labelBgBorderRadius: d, interactionWidth: h = 20, ...p }) {
  return m.jsxs(m.Fragment, { children: [m.jsx("path", { ...p, d: e, fill: "none", className: Dr(["react-flow__edge-path", p.className]) }), h ? m.jsx("path", { d: e, fill: "none", strokeOpacity: 0, strokeWidth: h, className: "react-flow__edge-interaction" }) : null, r && fo(t) && fo(n) ? m.jsx(aQ, { x: t, y: n, label: r, labelStyle: a, labelShowBg: o, labelBgStyle: l, labelBgPadding: c, labelBgBorderRadius: d }) : null] });
}
function S6({ pos: e, x1: t, y1: n, x2: r, y2: a }) {
  return e === pt.Left || e === pt.Right ? [0.5 * (t + r), n] : [t, 0.5 * (n + a)];
}
function qM({ sourceX: e, sourceY: t, sourcePosition: n = pt.Bottom, targetX: r, targetY: a, targetPosition: o = pt.Top }) {
  const [l, c] = S6({
    pos: n,
    x1: e,
    y1: t,
    x2: r,
    y2: a
  }), [d, h] = S6({
    pos: o,
    x1: r,
    y1: a,
    x2: e,
    y2: t
  }), [p, g, x, b] = oM({
    sourceX: e,
    sourceY: t,
    targetX: r,
    targetY: a,
    sourceControlX: l,
    sourceControlY: c,
    targetControlX: d,
    targetControlY: h
  });
  return [
    `M${e},${t} C${l},${c} ${d},${h} ${r},${a}`,
    p,
    g,
    x,
    b
  ];
}
function BM(e) {
  return G.memo(({ id: t, sourceX: n, sourceY: r, targetX: a, targetY: o, sourcePosition: l, targetPosition: c, label: d, labelStyle: h, labelShowBg: p, labelBgStyle: g, labelBgPadding: x, labelBgBorderRadius: b, style: C, markerEnd: N, markerStart: T, interactionWidth: j }) => {
    const [R, A, z] = qM({
      sourceX: n,
      sourceY: r,
      sourcePosition: l,
      targetX: a,
      targetY: o,
      targetPosition: c
    }), q = e.isInternal ? void 0 : t;
    return m.jsx(rv, { id: q, path: R, labelX: A, labelY: z, label: d, labelStyle: h, labelShowBg: p, labelBgStyle: g, labelBgPadding: x, labelBgBorderRadius: b, style: C, markerEnd: N, markerStart: T, interactionWidth: j });
  });
}
const sQ = BM({ isInternal: !1 }), FM = BM({ isInternal: !0 });
sQ.displayName = "SimpleBezierEdge";
FM.displayName = "SimpleBezierEdgeInternal";
function UM(e) {
  return G.memo(({ id: t, sourceX: n, sourceY: r, targetX: a, targetY: o, label: l, labelStyle: c, labelShowBg: d, labelBgStyle: h, labelBgPadding: p, labelBgBorderRadius: g, style: x, sourcePosition: b = pt.Bottom, targetPosition: C = pt.Top, markerEnd: N, markerStart: T, pathOptions: j, interactionWidth: R }) => {
    const [A, z, q] = lS({
      sourceX: n,
      sourceY: r,
      sourcePosition: b,
      targetX: a,
      targetY: o,
      targetPosition: C,
      borderRadius: j == null ? void 0 : j.borderRadius,
      offset: j == null ? void 0 : j.offset,
      stepPosition: j == null ? void 0 : j.stepPosition
    }), D = e.isInternal ? void 0 : t;
    return m.jsx(rv, { id: D, path: A, labelX: z, labelY: q, label: l, labelStyle: c, labelShowBg: d, labelBgStyle: h, labelBgPadding: p, labelBgBorderRadius: g, style: x, markerEnd: N, markerStart: T, interactionWidth: R });
  });
}
const $M = UM({ isInternal: !1 }), HM = UM({ isInternal: !0 });
$M.displayName = "SmoothStepEdge";
HM.displayName = "SmoothStepEdgeInternal";
function GM(e) {
  return G.memo(({ id: t, ...n }) => {
    var a;
    const r = e.isInternal ? void 0 : t;
    return m.jsx($M, { ...n, id: r, pathOptions: G.useMemo(() => {
      var o;
      return { borderRadius: 0, offset: (o = n.pathOptions) == null ? void 0 : o.offset };
    }, [(a = n.pathOptions) == null ? void 0 : a.offset]) });
  });
}
const oQ = GM({ isInternal: !1 }), VM = GM({ isInternal: !0 });
oQ.displayName = "StepEdge";
VM.displayName = "StepEdgeInternal";
function KM(e) {
  return G.memo(({ id: t, sourceX: n, sourceY: r, targetX: a, targetY: o, label: l, labelStyle: c, labelShowBg: d, labelBgStyle: h, labelBgPadding: p, labelBgBorderRadius: g, style: x, markerEnd: b, markerStart: C, interactionWidth: N }) => {
    const [T, j, R] = cM({ sourceX: n, sourceY: r, targetX: a, targetY: o }), A = e.isInternal ? void 0 : t;
    return m.jsx(rv, { id: A, path: T, labelX: j, labelY: R, label: l, labelStyle: c, labelShowBg: d, labelBgStyle: h, labelBgPadding: p, labelBgBorderRadius: g, style: x, markerEnd: b, markerStart: C, interactionWidth: N });
  });
}
const lQ = KM({ isInternal: !1 }), YM = KM({ isInternal: !0 });
lQ.displayName = "StraightEdge";
YM.displayName = "StraightEdgeInternal";
function WM(e) {
  return G.memo(({ id: t, sourceX: n, sourceY: r, targetX: a, targetY: o, sourcePosition: l = pt.Bottom, targetPosition: c = pt.Top, label: d, labelStyle: h, labelShowBg: p, labelBgStyle: g, labelBgPadding: x, labelBgBorderRadius: b, style: C, markerEnd: N, markerStart: T, pathOptions: j, interactionWidth: R }) => {
    const [A, z, q] = lM({
      sourceX: n,
      sourceY: r,
      sourcePosition: l,
      targetX: a,
      targetY: o,
      targetPosition: c,
      curvature: j == null ? void 0 : j.curvature
    }), D = e.isInternal ? void 0 : t;
    return m.jsx(rv, { id: D, path: A, labelX: z, labelY: q, label: d, labelStyle: h, labelShowBg: p, labelBgStyle: g, labelBgPadding: x, labelBgBorderRadius: b, style: C, markerEnd: N, markerStart: T, interactionWidth: R });
  });
}
const uQ = WM({ isInternal: !1 }), XM = WM({ isInternal: !0 });
uQ.displayName = "BezierEdge";
XM.displayName = "BezierEdgeInternal";
const C6 = {
  default: XM,
  straight: YM,
  step: VM,
  smoothstep: HM,
  simplebezier: FM
}, E6 = {
  sourceX: null,
  sourceY: null,
  targetX: null,
  targetY: null,
  sourcePosition: null,
  targetPosition: null
}, cQ = (e, t, n) => n === pt.Left ? e - t : n === pt.Right ? e + t : e, fQ = (e, t, n) => n === pt.Top ? e - t : n === pt.Bottom ? e + t : e, k6 = "react-flow__edgeupdater";
function N6({ position: e, centerX: t, centerY: n, radius: r = 10, onMouseDown: a, onMouseEnter: o, onMouseOut: l, type: c }) {
  return m.jsx("circle", { onMouseDown: a, onMouseEnter: o, onMouseOut: l, className: Dr([k6, `${k6}-${c}`]), cx: cQ(t, r, e), cy: fQ(n, r, e), r, stroke: "transparent", fill: "transparent" });
}
function dQ({ isReconnectable: e, reconnectRadius: t, edge: n, sourceX: r, sourceY: a, targetX: o, targetY: l, sourcePosition: c, targetPosition: d, onReconnect: h, onReconnectStart: p, onReconnectEnd: g, setReconnecting: x, setUpdateHover: b }) {
  const C = sr(), N = (z, q) => {
    if (z.button !== 0)
      return;
    const { autoPanOnConnect: D, domNode: P, isValidConnection: re, connectionMode: ie, connectionRadius: X, lib: K, onConnectStart: V, onConnectEnd: de, cancelConnection: H, nodeLookup: se, rfId: Z, panBy: fe, updateConnection: he } = C.getState(), ge = q.type === "target", Q = (Y, le) => {
      x(!1), g == null || g(Y, n, q.type, le);
    }, U = (Y) => h == null ? void 0 : h(n, Y), ue = (Y, le) => {
      x(!0), p == null || p(z, n, q.type), V == null || V(Y, le);
    };
    fS.onPointerDown(z.nativeEvent, {
      autoPanOnConnect: D,
      connectionMode: ie,
      connectionRadius: X,
      domNode: P,
      handleId: q.id,
      nodeId: q.nodeId,
      nodeLookup: se,
      isTarget: ge,
      edgeUpdaterType: q.type,
      lib: K,
      flowId: Z,
      cancelConnection: H,
      panBy: fe,
      isValidConnection: re,
      onConnect: U,
      onConnectStart: ue,
      onConnectEnd: de,
      onReconnectEnd: Q,
      updateConnection: he,
      getTransform: () => C.getState().transform,
      getFromHandle: () => C.getState().connection.fromHandle,
      dragThreshold: C.getState().connectionDragThreshold,
      handleDomNode: z.currentTarget
    });
  }, T = (z) => N(z, { nodeId: n.target, id: n.targetHandle ?? null, type: "target" }), j = (z) => N(z, { nodeId: n.source, id: n.sourceHandle ?? null, type: "source" }), R = () => b(!0), A = () => b(!1);
  return m.jsxs(m.Fragment, { children: [(e === !0 || e === "source") && m.jsx(N6, { position: c, centerX: r, centerY: a, radius: t, onMouseDown: T, onMouseEnter: R, onMouseOut: A, type: "source" }), (e === !0 || e === "target") && m.jsx(N6, { position: d, centerX: o, centerY: l, radius: t, onMouseDown: j, onMouseEnter: R, onMouseOut: A, type: "target" })] });
}
function hQ({ id: e, edgesFocusable: t, edgesReconnectable: n, elementsSelectable: r, onClick: a, onDoubleClick: o, onContextMenu: l, onMouseEnter: c, onMouseMove: d, onMouseLeave: h, reconnectRadius: p, onReconnect: g, onReconnectStart: x, onReconnectEnd: b, rfId: C, edgeTypes: N, noPanClassName: T, onError: j, disableKeyboardA11y: R }) {
  let A = nn((Be) => Be.edgeLookup.get(e));
  const z = nn((Be) => Be.defaultEdgeOptions);
  A = z ? { ...z, ...A } : A;
  let q = A.type || "default", D = (N == null ? void 0 : N[q]) || C6[q];
  D === void 0 && (j == null || j("011", gl.error011(q)), q = "default", D = (N == null ? void 0 : N.default) || C6.default);
  const P = !!(A.focusable || t && typeof A.focusable > "u"), re = typeof g < "u" && (A.reconnectable || n && typeof A.reconnectable > "u"), ie = !!(A.selectable || r && typeof A.selectable > "u"), X = G.useRef(null), [K, V] = G.useState(!1), [de, H] = G.useState(!1), se = sr(), { zIndex: Z, sourceX: fe, sourceY: he, targetX: ge, targetY: Q, sourcePosition: U, targetPosition: ue } = nn(G.useCallback((Be) => {
    const Je = Be.nodeLookup.get(A.source), ot = Be.nodeLookup.get(A.target);
    if (!Je || !ot)
      return {
        zIndex: A.zIndex,
        ...E6
      };
    const We = dW({
      id: e,
      sourceNode: Je,
      targetNode: ot,
      sourceHandle: A.sourceHandle || null,
      targetHandle: A.targetHandle || null,
      connectionMode: Be.connectionMode,
      onError: j
    });
    return {
      zIndex: iW({
        selected: A.selected,
        zIndex: A.zIndex,
        sourceNode: Je,
        targetNode: ot,
        elevateOnSelect: Be.elevateEdgesOnSelect,
        zIndexMode: Be.zIndexMode
      }),
      ...We || E6
    };
  }, [A.source, A.target, A.sourceHandle, A.targetHandle, A.selected, A.zIndex]), ar), Y = G.useMemo(() => A.markerStart ? `url('#${uS(A.markerStart, C)}')` : void 0, [A.markerStart, C]), le = G.useMemo(() => A.markerEnd ? `url('#${uS(A.markerEnd, C)}')` : void 0, [A.markerEnd, C]);
  if (A.hidden || fe === null || he === null || ge === null || Q === null)
    return null;
  const xe = (Be) => {
    var bt;
    const { addSelectedEdges: Je, unselectNodesAndEdges: ot, multiSelectionActive: We } = se.getState();
    ie && (se.setState({ nodesSelectionActive: !1 }), A.selected && We ? (ot({ nodes: [], edges: [A] }), (bt = X.current) == null || bt.blur()) : Je([e])), a && a(Be, A);
  }, Se = o ? (Be) => {
    o(Be, { ...A });
  } : void 0, Oe = l ? (Be) => {
    l(Be, { ...A });
  } : void 0, qe = c ? (Be) => {
    c(Be, { ...A });
  } : void 0, Me = d ? (Be) => {
    d(Be, { ...A });
  } : void 0, Pe = h ? (Be) => {
    h(Be, { ...A });
  } : void 0, Re = (Be) => {
    var Je;
    if (!R && KA.includes(Be.key) && ie) {
      const { unselectNodesAndEdges: ot, addSelectedEdges: We } = se.getState();
      Be.key === "Escape" ? ((Je = X.current) == null || Je.blur(), ot({ edges: [A] })) : We([e]);
    }
  };
  return m.jsx("svg", { style: { zIndex: Z }, children: m.jsxs("g", { className: Dr([
    "react-flow__edge",
    `react-flow__edge-${q}`,
    A.className,
    T,
    {
      selected: A.selected,
      animated: A.animated,
      inactive: !ie && !a,
      updating: K,
      selectable: ie
    }
  ]), onClick: xe, onDoubleClick: Se, onContextMenu: Oe, onMouseEnter: qe, onMouseMove: Me, onMouseLeave: Pe, onKeyDown: P ? Re : void 0, tabIndex: P ? 0 : void 0, role: A.ariaRole ?? (P ? "group" : "img"), "aria-roledescription": "edge", "data-id": e, "data-testid": `rf__edge-${e}`, "aria-label": A.ariaLabel === null ? void 0 : A.ariaLabel || `Edge from ${A.source} to ${A.target}`, "aria-describedby": P ? `${EM}-${C}` : void 0, ref: X, ...A.domAttributes, children: [!de && m.jsx(D, { id: e, source: A.source, target: A.target, type: A.type, selected: A.selected, animated: A.animated, selectable: ie, deletable: A.deletable ?? !0, label: A.label, labelStyle: A.labelStyle, labelShowBg: A.labelShowBg, labelBgStyle: A.labelBgStyle, labelBgPadding: A.labelBgPadding, labelBgBorderRadius: A.labelBgBorderRadius, sourceX: fe, sourceY: he, targetX: ge, targetY: Q, sourcePosition: U, targetPosition: ue, data: A.data, style: A.style, sourceHandleId: A.sourceHandle, targetHandleId: A.targetHandle, markerStart: Y, markerEnd: le, pathOptions: "pathOptions" in A ? A.pathOptions : void 0, interactionWidth: A.interactionWidth }), re && m.jsx(dQ, { edge: A, isReconnectable: re, reconnectRadius: p, onReconnect: g, onReconnectStart: x, onReconnectEnd: b, sourceX: fe, sourceY: he, targetX: ge, targetY: Q, sourcePosition: U, targetPosition: ue, setUpdateHover: V, setReconnecting: H })] }) });
}
var mQ = G.memo(hQ);
const pQ = (e) => ({
  edgesFocusable: e.edgesFocusable,
  edgesReconnectable: e.edgesReconnectable,
  elementsSelectable: e.elementsSelectable,
  connectionMode: e.connectionMode,
  onError: e.onError
});
function QM({ defaultMarkerColor: e, onlyRenderVisibleElements: t, rfId: n, edgeTypes: r, noPanClassName: a, onReconnect: o, onEdgeContextMenu: l, onEdgeMouseEnter: c, onEdgeMouseMove: d, onEdgeMouseLeave: h, onEdgeClick: p, reconnectRadius: g, onEdgeDoubleClick: x, onReconnectStart: b, onReconnectEnd: C, disableKeyboardA11y: N }) {
  const { edgesFocusable: T, edgesReconnectable: j, elementsSelectable: R, onError: A } = nn(pQ, ar), z = JX(t);
  return m.jsxs("div", { className: "react-flow__edges", children: [m.jsx(iQ, { defaultColor: e, rfId: n }), z.map((q) => m.jsx(mQ, { id: q, edgesFocusable: T, edgesReconnectable: j, elementsSelectable: R, noPanClassName: a, onReconnect: o, onContextMenu: l, onMouseEnter: c, onMouseMove: d, onMouseLeave: h, onClick: p, reconnectRadius: g, onDoubleClick: x, onReconnectStart: b, onReconnectEnd: C, rfId: n, onError: A, edgeTypes: r, disableKeyboardA11y: N }, q))] });
}
QM.displayName = "EdgeRenderer";
const gQ = G.memo(QM), yQ = (e) => `translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;
function vQ({ children: e }) {
  const t = nn(yQ);
  return m.jsx("div", { className: "react-flow__viewport xyflow__viewport react-flow__container", style: { transform: t }, children: e });
}
function xQ(e) {
  const t = d5(), n = G.useRef(!1);
  G.useEffect(() => {
    !n.current && t.viewportInitialized && e && (setTimeout(() => e(t), 1), n.current = !0);
  }, [e, t.viewportInitialized]);
}
const bQ = (e) => {
  var t;
  return (t = e.panZoom) == null ? void 0 : t.syncViewport;
};
function wQ(e) {
  const t = nn(bQ), n = sr();
  return G.useEffect(() => {
    e && (t == null || t(e), n.setState({ transform: [e.x, e.y, e.zoom] }));
  }, [e, t]), null;
}
function _Q(e) {
  return e.connection.inProgress ? { ...e.connection, to: qg(e.connection.to, e.transform) } : { ...e.connection };
}
function SQ(e) {
  return _Q;
}
function CQ(e) {
  const t = SQ();
  return nn(t, ar);
}
const EQ = (e) => ({
  nodesConnectable: e.nodesConnectable,
  isValid: e.connection.isValid,
  inProgress: e.connection.inProgress,
  width: e.width,
  height: e.height
});
function kQ({ containerStyle: e, style: t, type: n, component: r }) {
  const { nodesConnectable: a, width: o, height: l, isValid: c, inProgress: d } = nn(EQ, ar);
  return !(o && a && d) ? null : m.jsx("svg", { style: e, width: o, height: l, className: "react-flow__connectionline react-flow__container", children: m.jsx("g", { className: Dr(["react-flow__connection", XA(c)]), children: m.jsx(ZM, { style: t, type: n, CustomComponent: r, isValid: c }) }) });
}
const ZM = ({ style: e, type: t = pc.Bezier, CustomComponent: n, isValid: r }) => {
  const { inProgress: a, from: o, fromNode: l, fromHandle: c, fromPosition: d, to: h, toNode: p, toHandle: g, toPosition: x, pointer: b } = CQ();
  if (!a)
    return;
  if (n)
    return m.jsx(n, { connectionLineType: t, connectionLineStyle: e, fromNode: l, fromHandle: c, fromX: o.x, fromY: o.y, toX: h.x, toY: h.y, fromPosition: d, toPosition: x, connectionStatus: XA(r), toNode: p, toHandle: g, pointer: b });
  let C = "";
  const N = {
    sourceX: o.x,
    sourceY: o.y,
    sourcePosition: d,
    targetX: h.x,
    targetY: h.y,
    targetPosition: x
  };
  switch (t) {
    case pc.Bezier:
      [C] = lM(N);
      break;
    case pc.SimpleBezier:
      [C] = qM(N);
      break;
    case pc.Step:
      [C] = lS({
        ...N,
        borderRadius: 0
      });
      break;
    case pc.SmoothStep:
      [C] = lS(N);
      break;
    default:
      [C] = cM(N);
  }
  return m.jsx("path", { d: C, fill: "none", className: "react-flow__connection-path", style: e });
};
ZM.displayName = "ConnectionLine";
const NQ = {};
function j6(e = NQ) {
  G.useRef(e), sr(), G.useEffect(() => {
  }, [e]);
}
function jQ() {
  sr(), G.useRef(!1), G.useEffect(() => {
  }, []);
}
function JM({ nodeTypes: e, edgeTypes: t, onInit: n, onNodeClick: r, onEdgeClick: a, onNodeDoubleClick: o, onEdgeDoubleClick: l, onNodeMouseEnter: c, onNodeMouseMove: d, onNodeMouseLeave: h, onNodeContextMenu: p, onSelectionContextMenu: g, onSelectionStart: x, onSelectionEnd: b, connectionLineType: C, connectionLineStyle: N, connectionLineComponent: T, connectionLineContainerStyle: j, selectionKeyCode: R, selectionOnDrag: A, selectionMode: z, multiSelectionKeyCode: q, panActivationKeyCode: D, zoomActivationKeyCode: P, deleteKeyCode: re, onlyRenderVisibleElements: ie, elementsSelectable: X, defaultViewport: K, translateExtent: V, minZoom: de, maxZoom: H, preventScrolling: se, defaultMarkerColor: Z, zoomOnScroll: fe, zoomOnPinch: he, panOnScroll: ge, panOnScrollSpeed: Q, panOnScrollMode: U, zoomOnDoubleClick: ue, panOnDrag: Y, onPaneClick: le, onPaneMouseEnter: xe, onPaneMouseMove: Se, onPaneMouseLeave: Oe, onPaneScroll: qe, onPaneContextMenu: Me, paneClickDistance: Pe, nodeClickDistance: Re, onEdgeContextMenu: Be, onEdgeMouseEnter: Je, onEdgeMouseMove: ot, onEdgeMouseLeave: We, reconnectRadius: bt, onReconnect: vt, onReconnectStart: Yn, onReconnectEnd: Mn, noDragClassName: Fn, noWheelClassName: Ht, noPanClassName: Rn, disableKeyboardA11y: rn, nodeExtent: Cn, rfId: Wn, viewport: Ue, onViewportChange: Ze }) {
  return j6(e), j6(t), jQ(), xQ(n), wQ(Ue), m.jsx($X, { onPaneClick: le, onPaneMouseEnter: xe, onPaneMouseMove: Se, onPaneMouseLeave: Oe, onPaneContextMenu: Me, onPaneScroll: qe, paneClickDistance: Pe, deleteKeyCode: re, selectionKeyCode: R, selectionOnDrag: A, selectionMode: z, onSelectionStart: x, onSelectionEnd: b, multiSelectionKeyCode: q, panActivationKeyCode: D, zoomActivationKeyCode: P, elementsSelectable: X, zoomOnScroll: fe, zoomOnPinch: he, zoomOnDoubleClick: ue, panOnScroll: ge, panOnScrollSpeed: Q, panOnScrollMode: U, panOnDrag: Y, defaultViewport: K, translateExtent: V, minZoom: de, maxZoom: H, onSelectionContextMenu: g, preventScrolling: se, noDragClassName: Fn, noWheelClassName: Ht, noPanClassName: Rn, disableKeyboardA11y: rn, onViewportChange: Ze, isControlledViewport: !!Ue, children: m.jsxs(vQ, { children: [m.jsx(gQ, { edgeTypes: t, onEdgeClick: a, onEdgeDoubleClick: l, onReconnect: vt, onReconnectStart: Yn, onReconnectEnd: Mn, onlyRenderVisibleElements: ie, onEdgeContextMenu: Be, onEdgeMouseEnter: Je, onEdgeMouseMove: ot, onEdgeMouseLeave: We, reconnectRadius: bt, defaultMarkerColor: Z, noPanClassName: Rn, disableKeyboardA11y: rn, rfId: Wn }), m.jsx(kQ, { style: N, type: C, component: T, containerStyle: j }), m.jsx("div", { className: "react-flow__edgelabel-renderer" }), m.jsx(ZX, { nodeTypes: e, onNodeClick: r, onNodeDoubleClick: o, onNodeMouseEnter: c, onNodeMouseMove: d, onNodeMouseLeave: h, onNodeContextMenu: p, nodeClickDistance: Re, onlyRenderVisibleElements: ie, noPanClassName: Rn, noDragClassName: Fn, disableKeyboardA11y: rn, nodeExtent: Cn, rfId: Wn }), m.jsx("div", { className: "react-flow__viewport-portal" })] }) });
}
JM.displayName = "GraphView";
const TQ = G.memo(JM), T6 = ({ nodes: e, edges: t, defaultNodes: n, defaultEdges: r, width: a, height: o, fitView: l, fitViewOptions: c, minZoom: d = 0.5, maxZoom: h = 2, nodeOrigin: p, nodeExtent: g, zIndexMode: x = "basic" } = {}) => {
  const b = /* @__PURE__ */ new Map(), C = /* @__PURE__ */ new Map(), N = /* @__PURE__ */ new Map(), T = /* @__PURE__ */ new Map(), j = r ?? t ?? [], R = n ?? e ?? [], A = p ?? [0, 0], z = g ?? _g;
  hM(N, T, j);
  const q = cS(R, b, C, {
    nodeOrigin: A,
    nodeExtent: z,
    zIndexMode: x
  });
  let D = [0, 0, 1];
  if (l && a && o) {
    const P = Lg(b, {
      filter: (K) => !!((K.width || K.initialWidth) && (K.height || K.initialHeight))
    }), { x: re, y: ie, zoom: X } = a5(P, a, o, d, h, (c == null ? void 0 : c.padding) ?? 0.1);
    D = [re, ie, X];
  }
  return {
    rfId: "1",
    width: a ?? 0,
    height: o ?? 0,
    transform: D,
    nodes: R,
    nodesInitialized: q,
    nodeLookup: b,
    parentLookup: C,
    edges: j,
    edgeLookup: T,
    connectionLookup: N,
    onNodesChange: null,
    onEdgesChange: null,
    hasDefaultNodes: n !== void 0,
    hasDefaultEdges: r !== void 0,
    panZoom: null,
    minZoom: d,
    maxZoom: h,
    translateExtent: _g,
    nodeExtent: z,
    nodesSelectionActive: !1,
    userSelectionActive: !1,
    userSelectionRect: null,
    connectionMode: Yh.Strict,
    domNode: null,
    paneDragging: !1,
    noPanClassName: "nopan",
    nodeOrigin: A,
    nodeDragThreshold: 1,
    connectionDragThreshold: 1,
    snapGrid: [15, 15],
    snapToGrid: !1,
    nodesDraggable: !0,
    nodesConnectable: !0,
    nodesFocusable: !0,
    edgesFocusable: !0,
    edgesReconnectable: !0,
    elementsSelectable: !0,
    elevateNodesOnSelect: !0,
    elevateEdgesOnSelect: !0,
    selectNodesOnDrag: !0,
    multiSelectionActive: !1,
    fitViewQueued: l ?? !1,
    fitViewOptions: c,
    fitViewResolver: null,
    connection: { ...WA },
    connectionClickStartHandle: null,
    connectOnClick: !0,
    ariaLiveMessage: "",
    autoPanOnConnect: !0,
    autoPanOnNodeDrag: !0,
    autoPanOnNodeFocus: !0,
    autoPanSpeed: 15,
    connectionRadius: 20,
    onError: ZY,
    isValidConnection: void 0,
    onSelectionChangeHandlers: [],
    lib: "react",
    debug: !1,
    ariaLabelConfig: YA,
    zIndexMode: x,
    onNodesChangeMiddlewareMap: /* @__PURE__ */ new Map(),
    onEdgesChangeMiddlewareMap: /* @__PURE__ */ new Map()
  };
}, AQ = ({ nodes: e, edges: t, defaultNodes: n, defaultEdges: r, width: a, height: o, fitView: l, fitViewOptions: c, minZoom: d, maxZoom: h, nodeOrigin: p, nodeExtent: g, zIndexMode: x }) => YW((b, C) => {
  async function N() {
    const { nodeLookup: T, panZoom: j, fitViewOptions: R, fitViewResolver: A, width: z, height: q, minZoom: D, maxZoom: P } = C();
    j && (await XY({
      nodes: T,
      width: z,
      height: q,
      panZoom: j,
      minZoom: D,
      maxZoom: P
    }, R), A == null || A.resolve(!0), b({ fitViewResolver: null }));
  }
  return {
    ...T6({
      nodes: e,
      edges: t,
      width: a,
      height: o,
      fitView: l,
      fitViewOptions: c,
      minZoom: d,
      maxZoom: h,
      nodeOrigin: p,
      nodeExtent: g,
      defaultNodes: n,
      defaultEdges: r,
      zIndexMode: x
    }),
    setNodes: (T) => {
      const { nodeLookup: j, parentLookup: R, nodeOrigin: A, elevateNodesOnSelect: z, fitViewQueued: q, zIndexMode: D } = C(), P = cS(T, j, R, {
        nodeOrigin: A,
        nodeExtent: g,
        elevateNodesOnSelect: z,
        checkEquality: !0,
        zIndexMode: D
      });
      q && P ? (N(), b({ nodes: T, nodesInitialized: P, fitViewQueued: !1, fitViewOptions: void 0 })) : b({ nodes: T, nodesInitialized: P });
    },
    setEdges: (T) => {
      const { connectionLookup: j, edgeLookup: R } = C();
      hM(j, R, T), b({ edges: T });
    },
    setDefaultNodesAndEdges: (T, j) => {
      if (T) {
        const { setNodes: R } = C();
        R(T), b({ hasDefaultNodes: !0 });
      }
      if (j) {
        const { setEdges: R } = C();
        R(j), b({ hasDefaultEdges: !0 });
      }
    },
    /*
     * Every node gets registerd at a ResizeObserver. Whenever a node
     * changes its dimensions, this function is called to measure the
     * new dimensions and update the nodes.
     */
    updateNodeInternals: (T) => {
      const { triggerNodeChanges: j, nodeLookup: R, parentLookup: A, domNode: z, nodeOrigin: q, nodeExtent: D, debug: P, fitViewQueued: re, zIndexMode: ie } = C(), { changes: X, updatedInternals: K } = bW(T, R, A, z, q, D, ie);
      K && (gW(R, A, { nodeOrigin: q, nodeExtent: D, zIndexMode: ie }), re ? (N(), b({ fitViewQueued: !1, fitViewOptions: void 0 })) : b({}), (X == null ? void 0 : X.length) > 0 && (P && console.log("React Flow: trigger node changes", X), j == null || j(X)));
    },
    updateNodePositions: (T, j = !1) => {
      const R = [];
      let A = [];
      const { nodeLookup: z, triggerNodeChanges: q, connection: D, updateConnection: P, onNodesChangeMiddlewareMap: re } = C();
      for (const [ie, X] of T) {
        const K = z.get(ie), V = !!(K != null && K.expandParent && (K != null && K.parentId) && (X != null && X.position)), de = {
          id: ie,
          type: "position",
          position: V ? {
            x: Math.max(0, X.position.x),
            y: Math.max(0, X.position.y)
          } : X.position,
          dragging: j
        };
        if (K && D.inProgress && D.fromNode.id === K.id) {
          const H = sd(K, D.fromHandle, pt.Left, !0);
          P({ ...D, from: H });
        }
        V && K.parentId && R.push({
          id: ie,
          parentId: K.parentId,
          rect: {
            ...X.internals.positionAbsolute,
            width: X.measured.width ?? 0,
            height: X.measured.height ?? 0
          }
        }), A.push(de);
      }
      if (R.length > 0) {
        const { parentLookup: ie, nodeOrigin: X } = C(), K = f5(R, z, ie, X);
        A.push(...K);
      }
      for (const ie of re.values())
        A = ie(A);
      q(A);
    },
    triggerNodeChanges: (T) => {
      const { onNodesChange: j, setNodes: R, nodes: A, hasDefaultNodes: z, debug: q } = C();
      if (T != null && T.length) {
        if (z) {
          const D = jM(T, A);
          R(D);
        }
        q && console.log("React Flow: trigger node changes", T), j == null || j(T);
      }
    },
    triggerEdgeChanges: (T) => {
      const { onEdgesChange: j, setEdges: R, edges: A, hasDefaultEdges: z, debug: q } = C();
      if (T != null && T.length) {
        if (z) {
          const D = TM(T, A);
          R(D);
        }
        q && console.log("React Flow: trigger edge changes", T), j == null || j(T);
      }
    },
    addSelectedNodes: (T) => {
      const { multiSelectionActive: j, edgeLookup: R, nodeLookup: A, triggerNodeChanges: z, triggerEdgeChanges: q } = C();
      if (j) {
        const D = T.map((P) => Uf(P, !0));
        z(D);
        return;
      }
      z(qh(A, /* @__PURE__ */ new Set([...T]), !0)), q(qh(R));
    },
    addSelectedEdges: (T) => {
      const { multiSelectionActive: j, edgeLookup: R, nodeLookup: A, triggerNodeChanges: z, triggerEdgeChanges: q } = C();
      if (j) {
        const D = T.map((P) => Uf(P, !0));
        q(D);
        return;
      }
      q(qh(R, /* @__PURE__ */ new Set([...T]))), z(qh(A, /* @__PURE__ */ new Set(), !0));
    },
    unselectNodesAndEdges: ({ nodes: T, edges: j } = {}) => {
      const { edges: R, nodes: A, nodeLookup: z, triggerNodeChanges: q, triggerEdgeChanges: D } = C(), P = T || A, re = j || R, ie = P.map((K) => {
        const V = z.get(K.id);
        return V && (V.selected = !1), Uf(K.id, !1);
      }), X = re.map((K) => Uf(K.id, !1));
      q(ie), D(X);
    },
    setMinZoom: (T) => {
      const { panZoom: j, maxZoom: R } = C();
      j == null || j.setScaleExtent([T, R]), b({ minZoom: T });
    },
    setMaxZoom: (T) => {
      const { panZoom: j, minZoom: R } = C();
      j == null || j.setScaleExtent([R, T]), b({ maxZoom: T });
    },
    setTranslateExtent: (T) => {
      var j;
      (j = C().panZoom) == null || j.setTranslateExtent(T), b({ translateExtent: T });
    },
    resetSelectedElements: () => {
      const { edges: T, nodes: j, triggerNodeChanges: R, triggerEdgeChanges: A, elementsSelectable: z } = C();
      if (!z)
        return;
      const q = j.reduce((P, re) => re.selected ? [...P, Uf(re.id, !1)] : P, []), D = T.reduce((P, re) => re.selected ? [...P, Uf(re.id, !1)] : P, []);
      R(q), A(D);
    },
    setNodeExtent: (T) => {
      const { nodes: j, nodeLookup: R, parentLookup: A, nodeOrigin: z, elevateNodesOnSelect: q, nodeExtent: D, zIndexMode: P } = C();
      T[0][0] === D[0][0] && T[0][1] === D[0][1] && T[1][0] === D[1][0] && T[1][1] === D[1][1] || (cS(j, R, A, {
        nodeOrigin: z,
        nodeExtent: T,
        elevateNodesOnSelect: q,
        checkEquality: !1,
        zIndexMode: P
      }), b({ nodeExtent: T }));
    },
    panBy: (T) => {
      const { transform: j, width: R, height: A, panZoom: z, translateExtent: q } = C();
      return wW({ delta: T, panZoom: z, transform: j, translateExtent: q, width: R, height: A });
    },
    setCenter: async (T, j, R) => {
      const { width: A, height: z, maxZoom: q, panZoom: D } = C();
      if (!D)
        return Promise.resolve(!1);
      const P = typeof (R == null ? void 0 : R.zoom) < "u" ? R.zoom : q;
      return await D.setViewport({
        x: A / 2 - T * P,
        y: z / 2 - j * P,
        zoom: P
      }, { duration: R == null ? void 0 : R.duration, ease: R == null ? void 0 : R.ease, interpolate: R == null ? void 0 : R.interpolate }), Promise.resolve(!0);
    },
    cancelConnection: () => {
      b({
        connection: { ...WA }
      });
    },
    updateConnection: (T) => {
      b({ connection: T });
    },
    reset: () => b({ ...T6() })
  };
}, Object.is);
function MQ({ initialNodes: e, initialEdges: t, defaultNodes: n, defaultEdges: r, initialWidth: a, initialHeight: o, initialMinZoom: l, initialMaxZoom: c, initialFitViewOptions: d, fitView: h, nodeOrigin: p, nodeExtent: g, zIndexMode: x, children: b }) {
  const [C] = G.useState(() => AQ({
    nodes: e,
    edges: t,
    defaultNodes: n,
    defaultEdges: r,
    width: a,
    height: o,
    fitView: h,
    minZoom: l,
    maxZoom: c,
    fitViewOptions: d,
    nodeOrigin: p,
    nodeExtent: g,
    zIndexMode: x
  }));
  return m.jsx(WW, { value: C, children: m.jsx(vX, { children: b }) });
}
function RQ({ children: e, nodes: t, edges: n, defaultNodes: r, defaultEdges: a, width: o, height: l, fitView: c, fitViewOptions: d, minZoom: h, maxZoom: p, nodeOrigin: g, nodeExtent: x, zIndexMode: b }) {
  return G.useContext(ev) ? m.jsx(m.Fragment, { children: e }) : m.jsx(MQ, { initialNodes: t, initialEdges: n, defaultNodes: r, defaultEdges: a, initialWidth: o, initialHeight: l, fitView: c, initialFitViewOptions: d, initialMinZoom: h, initialMaxZoom: p, nodeOrigin: g, nodeExtent: x, zIndexMode: b, children: e });
}
const OQ = {
  width: "100%",
  height: "100%",
  overflow: "hidden",
  position: "relative",
  zIndex: 0
};
function zQ({ nodes: e, edges: t, defaultNodes: n, defaultEdges: r, className: a, nodeTypes: o, edgeTypes: l, onNodeClick: c, onEdgeClick: d, onInit: h, onMove: p, onMoveStart: g, onMoveEnd: x, onConnect: b, onConnectStart: C, onConnectEnd: N, onClickConnectStart: T, onClickConnectEnd: j, onNodeMouseEnter: R, onNodeMouseMove: A, onNodeMouseLeave: z, onNodeContextMenu: q, onNodeDoubleClick: D, onNodeDragStart: P, onNodeDrag: re, onNodeDragStop: ie, onNodesDelete: X, onEdgesDelete: K, onDelete: V, onSelectionChange: de, onSelectionDragStart: H, onSelectionDrag: se, onSelectionDragStop: Z, onSelectionContextMenu: fe, onSelectionStart: he, onSelectionEnd: ge, onBeforeDelete: Q, connectionMode: U, connectionLineType: ue = pc.Bezier, connectionLineStyle: Y, connectionLineComponent: le, connectionLineContainerStyle: xe, deleteKeyCode: Se = "Backspace", selectionKeyCode: Oe = "Shift", selectionOnDrag: qe = !1, selectionMode: Me = Sg.Full, panActivationKeyCode: Pe = "Space", multiSelectionKeyCode: Re = kg() ? "Meta" : "Control", zoomActivationKeyCode: Be = kg() ? "Meta" : "Control", snapToGrid: Je, snapGrid: ot, onlyRenderVisibleElements: We = !1, selectNodesOnDrag: bt, nodesDraggable: vt, autoPanOnNodeFocus: Yn, nodesConnectable: Mn, nodesFocusable: Fn, nodeOrigin: Ht = kM, edgesFocusable: Rn, edgesReconnectable: rn, elementsSelectable: Cn = !0, defaultViewport: Wn = lX, minZoom: Ue = 0.5, maxZoom: Ze = 2, translateExtent: gt = _g, preventScrolling: Nt = !0, nodeExtent: Dt, defaultMarkerColor: Un = "#b1b1b7", zoomOnScroll: $n = !0, zoomOnPinch: an = !0, panOnScroll: Qt = !1, panOnScrollSpeed: En = 0.5, panOnScrollMode: it = Jf.Free, zoomOnDoubleClick: jr = !0, panOnDrag: lr = !0, onPaneClick: xo, onPaneMouseEnter: ct, onPaneMouseMove: Oa, onPaneMouseLeave: as, onPaneScroll: Di, onPaneContextMenu: js, paneClickDistance: za = 1, nodeClickDistance: Sc = 0, children: bl, onReconnect: ra, onReconnectStart: pi, onReconnectEnd: wl, onEdgeContextMenu: Da, onEdgeDoubleClick: yn, onEdgeMouseEnter: On, onEdgeMouseMove: _l, onEdgeMouseLeave: ss, reconnectRadius: Ts = 10, onNodesChange: As, onEdgesChange: ia, noDragClassName: bn = "nodrag", noWheelClassName: Xn = "nowheel", noPanClassName: Tr = "nopan", fitView: aa, fitViewOptions: cu, connectOnClick: sa, attributionPosition: Sl, proOptions: ri, defaultEdgeOptions: bo, elevateNodesOnSelect: oa = !0, elevateEdgesOnSelect: sn = !1, disableKeyboardA11y: Yr = !1, autoPanOnConnect: ur, autoPanOnNodeDrag: Qn, autoPanSpeed: Ia, connectionRadius: Ms, isValidConnection: gi, onError: Ii, style: la, id: wo, nodeDragThreshold: Rs, connectionDragThreshold: fu, viewport: It, onViewportChange: os, width: ii, height: gr, colorMode: ua = "light", debug: du, onScroll: ca, ariaLabelConfig: ls, zIndexMode: Zt = "basic", ...Os }, cr) {
  const ai = wo || "1", us = dX(ua), zs = G.useCallback((si) => {
    si.currentTarget.scrollTo({ top: 0, left: 0, behavior: "instant" }), ca == null || ca(si);
  }, [ca]);
  return m.jsx("div", { "data-testid": "rf__wrapper", ...Os, onScroll: zs, style: { ...la, ...OQ }, ref: cr, className: Dr(["react-flow", a, us]), id: wo, role: "application", children: m.jsxs(RQ, { nodes: e, edges: t, width: ii, height: gr, fitView: aa, fitViewOptions: cu, minZoom: Ue, maxZoom: Ze, nodeOrigin: Ht, nodeExtent: Dt, zIndexMode: Zt, children: [m.jsx(TQ, { onInit: h, onNodeClick: c, onEdgeClick: d, onNodeMouseEnter: R, onNodeMouseMove: A, onNodeMouseLeave: z, onNodeContextMenu: q, onNodeDoubleClick: D, nodeTypes: o, edgeTypes: l, connectionLineType: ue, connectionLineStyle: Y, connectionLineComponent: le, connectionLineContainerStyle: xe, selectionKeyCode: Oe, selectionOnDrag: qe, selectionMode: Me, deleteKeyCode: Se, multiSelectionKeyCode: Re, panActivationKeyCode: Pe, zoomActivationKeyCode: Be, onlyRenderVisibleElements: We, defaultViewport: Wn, translateExtent: gt, minZoom: Ue, maxZoom: Ze, preventScrolling: Nt, zoomOnScroll: $n, zoomOnPinch: an, zoomOnDoubleClick: jr, panOnScroll: Qt, panOnScrollSpeed: En, panOnScrollMode: it, panOnDrag: lr, onPaneClick: xo, onPaneMouseEnter: ct, onPaneMouseMove: Oa, onPaneMouseLeave: as, onPaneScroll: Di, onPaneContextMenu: js, paneClickDistance: za, nodeClickDistance: Sc, onSelectionContextMenu: fe, onSelectionStart: he, onSelectionEnd: ge, onReconnect: ra, onReconnectStart: pi, onReconnectEnd: wl, onEdgeContextMenu: Da, onEdgeDoubleClick: yn, onEdgeMouseEnter: On, onEdgeMouseMove: _l, onEdgeMouseLeave: ss, reconnectRadius: Ts, defaultMarkerColor: Un, noDragClassName: bn, noWheelClassName: Xn, noPanClassName: Tr, rfId: ai, disableKeyboardA11y: Yr, nodeExtent: Dt, viewport: It, onViewportChange: os }), m.jsx(fX, { nodes: e, edges: t, defaultNodes: n, defaultEdges: r, onConnect: b, onConnectStart: C, onConnectEnd: N, onClickConnectStart: T, onClickConnectEnd: j, nodesDraggable: vt, autoPanOnNodeFocus: Yn, nodesConnectable: Mn, nodesFocusable: Fn, edgesFocusable: Rn, edgesReconnectable: rn, elementsSelectable: Cn, elevateNodesOnSelect: oa, elevateEdgesOnSelect: sn, minZoom: Ue, maxZoom: Ze, nodeExtent: Dt, onNodesChange: As, onEdgesChange: ia, snapToGrid: Je, snapGrid: ot, connectionMode: U, translateExtent: gt, connectOnClick: sa, defaultEdgeOptions: bo, fitView: aa, fitViewOptions: cu, onNodesDelete: X, onEdgesDelete: K, onDelete: V, onNodeDragStart: P, onNodeDrag: re, onNodeDragStop: ie, onSelectionDrag: se, onSelectionDragStart: H, onSelectionDragStop: Z, onMove: p, onMoveStart: g, onMoveEnd: x, noPanClassName: Tr, nodeOrigin: Ht, rfId: ai, autoPanOnConnect: ur, autoPanOnNodeDrag: Qn, autoPanSpeed: Ia, onError: Ii, connectionRadius: Ms, isValidConnection: gi, selectNodesOnDrag: bt, nodeDragThreshold: Rs, connectionDragThreshold: fu, onBeforeDelete: Q, debug: du, ariaLabelConfig: ls, zIndexMode: Zt }), m.jsx(oX, { onSelectionChange: de }), bl, m.jsx(nX, { proOptions: ri, position: Sl }), m.jsx(tX, { rfId: ai, disableKeyboardA11y: Yr })] }) });
}
var DQ = AM(zQ);
function IQ(e) {
  const [t, n] = G.useState(e), r = G.useCallback((a) => n((o) => jM(a, o)), []);
  return [t, n, r];
}
function LQ(e) {
  const [t, n] = G.useState(e), r = G.useCallback((a) => n((o) => TM(a, o)), []);
  return [t, n, r];
}
function PQ({ dimensions: e, lineWidth: t, variant: n, className: r }) {
  return m.jsx("path", { strokeWidth: t, d: `M${e[0] / 2} 0 V${e[1]} M0 ${e[1] / 2} H${e[0]}`, className: Dr(["react-flow__background-pattern", n, r]) });
}
function qQ({ radius: e, className: t }) {
  return m.jsx("circle", { cx: e, cy: e, r: e, className: Dr(["react-flow__background-pattern", "dots", t]) });
}
var vc;
(function(e) {
  e.Lines = "lines", e.Dots = "dots", e.Cross = "cross";
})(vc || (vc = {}));
const BQ = {
  [vc.Dots]: 1,
  [vc.Lines]: 1,
  [vc.Cross]: 6
}, FQ = (e) => ({ transform: e.transform, patternId: `pattern-${e.rfId}` });
function eR({
  id: e,
  variant: t = vc.Dots,
  // only used for dots and cross
  gap: n = 20,
  // only used for lines and cross
  size: r,
  lineWidth: a = 1,
  offset: o = 0,
  color: l,
  bgColor: c,
  style: d,
  className: h,
  patternClassName: p
}) {
  const g = G.useRef(null), { transform: x, patternId: b } = nn(FQ, ar), C = r || BQ[t], N = t === vc.Dots, T = t === vc.Cross, j = Array.isArray(n) ? n : [n, n], R = [j[0] * x[2] || 1, j[1] * x[2] || 1], A = C * x[2], z = Array.isArray(o) ? o : [o, o], q = T ? [A, A] : R, D = [
    z[0] * x[2] || 1 + q[0] / 2,
    z[1] * x[2] || 1 + q[1] / 2
  ], P = `${b}${e || ""}`;
  return m.jsxs("svg", { className: Dr(["react-flow__background", h]), style: {
    ...d,
    ...nv,
    "--xy-background-color-props": c,
    "--xy-background-pattern-color-props": l
  }, ref: g, "data-testid": "rf__background", children: [m.jsx("pattern", { id: P, x: x[0] % R[0], y: x[1] % R[1], width: R[0], height: R[1], patternUnits: "userSpaceOnUse", patternTransform: `translate(-${D[0]},-${D[1]})`, children: N ? m.jsx(qQ, { radius: A / 2, className: p }) : m.jsx(PQ, { dimensions: q, lineWidth: a, variant: t, className: p }) }), m.jsx("rect", { x: "0", y: "0", width: "100%", height: "100%", fill: `url(#${P})` })] });
}
eR.displayName = "Background";
const UQ = G.memo(eR);
function $Q() {
  return m.jsx("svg", { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 32 32", children: m.jsx("path", { d: "M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z" }) });
}
function HQ() {
  return m.jsx("svg", { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 32 5", children: m.jsx("path", { d: "M0 0h32v4.2H0z" }) });
}
function GQ() {
  return m.jsx("svg", { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 32 30", children: m.jsx("path", { d: "M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z" }) });
}
function VQ() {
  return m.jsx("svg", { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 25 32", children: m.jsx("path", { d: "M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z" }) });
}
function KQ() {
  return m.jsx("svg", { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 25 32", children: m.jsx("path", { d: "M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z" }) });
}
function Gy({ children: e, className: t, ...n }) {
  return m.jsx("button", { type: "button", className: Dr(["react-flow__controls-button", t]), ...n, children: e });
}
const YQ = (e) => ({
  isInteractive: e.nodesDraggable || e.nodesConnectable || e.elementsSelectable,
  minZoomReached: e.transform[2] <= e.minZoom,
  maxZoomReached: e.transform[2] >= e.maxZoom,
  ariaLabelConfig: e.ariaLabelConfig
});
function tR({ style: e, showZoom: t = !0, showFitView: n = !0, showInteractive: r = !0, fitViewOptions: a, onZoomIn: o, onZoomOut: l, onFitView: c, onInteractiveChange: d, className: h, children: p, position: g = "bottom-left", orientation: x = "vertical", "aria-label": b }) {
  const C = sr(), { isInteractive: N, minZoomReached: T, maxZoomReached: j, ariaLabelConfig: R } = nn(YQ, ar), { zoomIn: A, zoomOut: z, fitView: q } = d5(), D = () => {
    A(), o == null || o();
  }, P = () => {
    z(), l == null || l();
  }, re = () => {
    q(a), c == null || c();
  }, ie = () => {
    C.setState({
      nodesDraggable: !N,
      nodesConnectable: !N,
      elementsSelectable: !N
    }), d == null || d(!N);
  }, X = x === "horizontal" ? "horizontal" : "vertical";
  return m.jsxs(tv, { className: Dr(["react-flow__controls", X, h]), position: g, style: e, "data-testid": "rf__controls", "aria-label": b ?? R["controls.ariaLabel"], children: [t && m.jsxs(m.Fragment, { children: [m.jsx(Gy, { onClick: D, className: "react-flow__controls-zoomin", title: R["controls.zoomIn.ariaLabel"], "aria-label": R["controls.zoomIn.ariaLabel"], disabled: j, children: m.jsx($Q, {}) }), m.jsx(Gy, { onClick: P, className: "react-flow__controls-zoomout", title: R["controls.zoomOut.ariaLabel"], "aria-label": R["controls.zoomOut.ariaLabel"], disabled: T, children: m.jsx(HQ, {}) })] }), n && m.jsx(Gy, { className: "react-flow__controls-fitview", onClick: re, title: R["controls.fitView.ariaLabel"], "aria-label": R["controls.fitView.ariaLabel"], children: m.jsx(GQ, {}) }), r && m.jsx(Gy, { className: "react-flow__controls-interactive", onClick: ie, title: R["controls.interactive.ariaLabel"], "aria-label": R["controls.interactive.ariaLabel"], children: N ? m.jsx(KQ, {}) : m.jsx(VQ, {}) }), p] });
}
tR.displayName = "Controls";
const WQ = G.memo(tR);
function XQ({ id: e, x: t, y: n, width: r, height: a, style: o, color: l, strokeColor: c, strokeWidth: d, className: h, borderRadius: p, shapeRendering: g, selected: x, onClick: b }) {
  const { background: C, backgroundColor: N } = o || {}, T = l || C || N;
  return m.jsx("rect", { className: Dr(["react-flow__minimap-node", { selected: x }, h]), x: t, y: n, rx: p, ry: p, width: r, height: a, style: {
    fill: T,
    stroke: c,
    strokeWidth: d
  }, shapeRendering: g, onClick: b ? (j) => b(j, e) : void 0 });
}
const QQ = G.memo(XQ), ZQ = (e) => e.nodes.map((t) => t.id), nb = (e) => e instanceof Function ? e : () => e;
function JQ({
  nodeStrokeColor: e,
  nodeColor: t,
  nodeClassName: n = "",
  nodeBorderRadius: r = 5,
  nodeStrokeWidth: a,
  /*
   * We need to rename the prop to be `CapitalCase` so that JSX will render it as
   * a component properly.
   */
  nodeComponent: o = QQ,
  onClick: l
}) {
  const c = nn(ZQ, ar), d = nb(t), h = nb(e), p = nb(n), g = typeof window > "u" || window.chrome ? "crispEdges" : "geometricPrecision";
  return m.jsx(m.Fragment, { children: c.map((x) => (
    /*
     * The split of responsibilities between MiniMapNodes and
     * NodeComponentWrapper may appear weird. However, its designed to
     * minimize the cost of updates when individual nodes change.
     *
     * For more details, see a similar commit in `NodeRenderer/index.tsx`.
     */
    m.jsx(tZ, { id: x, nodeColorFunc: d, nodeStrokeColorFunc: h, nodeClassNameFunc: p, nodeBorderRadius: r, nodeStrokeWidth: a, NodeComponent: o, onClick: l, shapeRendering: g }, x)
  )) });
}
function eZ({ id: e, nodeColorFunc: t, nodeStrokeColorFunc: n, nodeClassNameFunc: r, nodeBorderRadius: a, nodeStrokeWidth: o, shapeRendering: l, NodeComponent: c, onClick: d }) {
  const { node: h, x: p, y: g, width: x, height: b } = nn((C) => {
    const { internals: N } = C.nodeLookup.get(e), T = N.userNode, { x: j, y: R } = N.positionAbsolute, { width: A, height: z } = ou(T);
    return {
      node: T,
      x: j,
      y: R,
      width: A,
      height: z
    };
  }, ar);
  return !h || h.hidden || !nM(h) ? null : m.jsx(c, { x: p, y: g, width: x, height: b, style: h.style, selected: !!h.selected, className: r(h), color: t(h), borderRadius: a, strokeColor: n(h), strokeWidth: o, shapeRendering: l, onClick: d, id: h.id });
}
const tZ = G.memo(eZ);
var nZ = G.memo(JQ);
const rZ = 200, iZ = 150, aZ = (e) => !e.hidden, sZ = (e) => {
  const t = {
    x: -e.transform[0] / e.transform[2],
    y: -e.transform[1] / e.transform[2],
    width: e.width / e.transform[2],
    height: e.height / e.transform[2]
  };
  return {
    viewBB: t,
    boundingRect: e.nodeLookup.size > 0 ? tM(Lg(e.nodeLookup, { filter: aZ }), t) : t,
    rfId: e.rfId,
    panZoom: e.panZoom,
    translateExtent: e.translateExtent,
    flowWidth: e.width,
    flowHeight: e.height,
    ariaLabelConfig: e.ariaLabelConfig
  };
}, oZ = "react-flow__minimap-desc";
function nR({
  style: e,
  className: t,
  nodeStrokeColor: n,
  nodeColor: r,
  nodeClassName: a = "",
  nodeBorderRadius: o = 5,
  nodeStrokeWidth: l,
  /*
   * We need to rename the prop to be `CapitalCase` so that JSX will render it as
   * a component properly.
   */
  nodeComponent: c,
  bgColor: d,
  maskColor: h,
  maskStrokeColor: p,
  maskStrokeWidth: g,
  position: x = "bottom-right",
  onClick: b,
  onNodeClick: C,
  pannable: N = !1,
  zoomable: T = !1,
  ariaLabel: j,
  inversePan: R,
  zoomStep: A = 1,
  offsetScale: z = 5
}) {
  const q = sr(), D = G.useRef(null), { boundingRect: P, viewBB: re, rfId: ie, panZoom: X, translateExtent: K, flowWidth: V, flowHeight: de, ariaLabelConfig: H } = nn(sZ, ar), se = (e == null ? void 0 : e.width) ?? rZ, Z = (e == null ? void 0 : e.height) ?? iZ, fe = P.width / se, he = P.height / Z, ge = Math.max(fe, he), Q = ge * se, U = ge * Z, ue = z * ge, Y = P.x - (Q - P.width) / 2 - ue, le = P.y - (U - P.height) / 2 - ue, xe = Q + ue * 2, Se = U + ue * 2, Oe = `${oZ}-${ie}`, qe = G.useRef(0), Me = G.useRef();
  qe.current = ge, G.useEffect(() => {
    if (D.current && X)
      return Me.current = AW({
        domNode: D.current,
        panZoom: X,
        getTransform: () => q.getState().transform,
        getViewScale: () => qe.current
      }), () => {
        var Je;
        (Je = Me.current) == null || Je.destroy();
      };
  }, [X]), G.useEffect(() => {
    var Je;
    (Je = Me.current) == null || Je.update({
      translateExtent: K,
      width: V,
      height: de,
      inversePan: R,
      pannable: N,
      zoomStep: A,
      zoomable: T
    });
  }, [N, T, R, A, K, V, de]);
  const Pe = b ? (Je) => {
    var bt;
    const [ot, We] = ((bt = Me.current) == null ? void 0 : bt.pointer(Je)) || [0, 0];
    b(Je, { x: ot, y: We });
  } : void 0, Re = C ? G.useCallback((Je, ot) => {
    const We = q.getState().nodeLookup.get(ot).internals.userNode;
    C(Je, We);
  }, []) : void 0, Be = j ?? H["minimap.ariaLabel"];
  return m.jsx(tv, { position: x, style: {
    ...e,
    "--xy-minimap-background-color-props": typeof d == "string" ? d : void 0,
    "--xy-minimap-mask-background-color-props": typeof h == "string" ? h : void 0,
    "--xy-minimap-mask-stroke-color-props": typeof p == "string" ? p : void 0,
    "--xy-minimap-mask-stroke-width-props": typeof g == "number" ? g * ge : void 0,
    "--xy-minimap-node-background-color-props": typeof r == "string" ? r : void 0,
    "--xy-minimap-node-stroke-color-props": typeof n == "string" ? n : void 0,
    "--xy-minimap-node-stroke-width-props": typeof l == "number" ? l : void 0
  }, className: Dr(["react-flow__minimap", t]), "data-testid": "rf__minimap", children: m.jsxs("svg", { width: se, height: Z, viewBox: `${Y} ${le} ${xe} ${Se}`, className: "react-flow__minimap-svg", role: "img", "aria-labelledby": Oe, ref: D, onClick: Pe, children: [Be && m.jsx("title", { id: Oe, children: Be }), m.jsx(nZ, { onClick: Re, nodeColor: r, nodeStrokeColor: n, nodeBorderRadius: o, nodeClassName: a, nodeStrokeWidth: l, nodeComponent: c }), m.jsx("path", { className: "react-flow__minimap-mask", d: `M${Y - ue},${le - ue}h${xe + ue * 2}v${Se + ue * 2}h${-xe - ue * 2}z
        M${re.x},${re.y}h${re.width}v${re.height}h${-re.width}z`, fillRule: "evenodd", pointerEvents: "none" })] }) });
}
nR.displayName = "MiniMap";
const lZ = G.memo(nR), uZ = (e) => (t) => e ? `${Math.max(1 / t.transform[2], 1)}` : void 0, cZ = {
  [Zh.Line]: "right",
  [Zh.Handle]: "bottom-right"
};
function fZ({ nodeId: e, position: t, variant: n = Zh.Handle, className: r, style: a = void 0, children: o, color: l, minWidth: c = 10, minHeight: d = 10, maxWidth: h = Number.MAX_VALUE, maxHeight: p = Number.MAX_VALUE, keepAspectRatio: g = !1, resizeDirection: x, autoScale: b = !0, shouldResize: C, onResizeStart: N, onResize: T, onResizeEnd: j }) {
  const R = zM(), A = typeof e == "string" ? e : R, z = sr(), q = G.useRef(null), D = n === Zh.Handle, P = nn(G.useCallback(uZ(D && b), [D, b]), ar), re = G.useRef(null), ie = t ?? cZ[n];
  G.useEffect(() => {
    if (!(!q.current || !A))
      return re.current || (re.current = HW({
        domNode: q.current,
        nodeId: A,
        getStoreItems: () => {
          const { nodeLookup: K, transform: V, snapGrid: de, snapToGrid: H, nodeOrigin: se, domNode: Z } = z.getState();
          return {
            nodeLookup: K,
            transform: V,
            snapGrid: de,
            snapToGrid: H,
            nodeOrigin: se,
            paneDomNode: Z
          };
        },
        onChange: (K, V) => {
          const { triggerNodeChanges: de, nodeLookup: H, parentLookup: se, nodeOrigin: Z } = z.getState(), fe = [], he = { x: K.x, y: K.y }, ge = H.get(A);
          if (ge && ge.expandParent && ge.parentId) {
            const Q = ge.origin ?? Z, U = K.width ?? ge.measured.width ?? 0, ue = K.height ?? ge.measured.height ?? 0, Y = {
              id: ge.id,
              parentId: ge.parentId,
              rect: {
                width: U,
                height: ue,
                ...rM({
                  x: K.x ?? ge.position.x,
                  y: K.y ?? ge.position.y
                }, { width: U, height: ue }, ge.parentId, H, Q)
              }
            }, le = f5([Y], H, se, Z);
            fe.push(...le), he.x = K.x ? Math.max(Q[0] * U, K.x) : void 0, he.y = K.y ? Math.max(Q[1] * ue, K.y) : void 0;
          }
          if (he.x !== void 0 && he.y !== void 0) {
            const Q = {
              id: A,
              type: "position",
              position: { ...he }
            };
            fe.push(Q);
          }
          if (K.width !== void 0 && K.height !== void 0) {
            const U = {
              id: A,
              type: "dimensions",
              resizing: !0,
              setAttributes: x ? x === "horizontal" ? "width" : "height" : !0,
              dimensions: {
                width: K.width,
                height: K.height
              }
            };
            fe.push(U);
          }
          for (const Q of V) {
            const U = {
              ...Q,
              type: "position"
            };
            fe.push(U);
          }
          de(fe);
        },
        onEnd: ({ width: K, height: V }) => {
          const de = {
            id: A,
            type: "dimensions",
            resizing: !1,
            dimensions: {
              width: K,
              height: V
            }
          };
          z.getState().triggerNodeChanges([de]);
        }
      })), re.current.update({
        controlPosition: ie,
        boundaries: {
          minWidth: c,
          minHeight: d,
          maxWidth: h,
          maxHeight: p
        },
        keepAspectRatio: g,
        resizeDirection: x,
        onResizeStart: N,
        onResize: T,
        onResizeEnd: j,
        shouldResize: C
      }), () => {
        var K;
        (K = re.current) == null || K.destroy();
      };
  }, [
    ie,
    c,
    d,
    h,
    p,
    g,
    N,
    T,
    j,
    C
  ]);
  const X = ie.split("-");
  return m.jsx("div", { className: Dr(["react-flow__resize-control", "nodrag", ...X, n, r]), ref: q, style: {
    ...a,
    scale: P,
    ...l && { [D ? "backgroundColor" : "borderColor"]: l }
  }, children: o });
}
G.memo(fZ);
function m5(e) {
  throw new Error('Could not dynamically require "' + e + '". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.');
}
var rb, A6;
function dZ() {
  if (A6) return rb;
  A6 = 1;
  function e() {
    this.__data__ = [], this.size = 0;
  }
  return rb = e, rb;
}
var ib, M6;
function im() {
  if (M6) return ib;
  M6 = 1;
  function e(t, n) {
    return t === n || t !== t && n !== n;
  }
  return ib = e, ib;
}
var ab, R6;
function iv() {
  if (R6) return ab;
  R6 = 1;
  var e = im();
  function t(n, r) {
    for (var a = n.length; a--; )
      if (e(n[a][0], r))
        return a;
    return -1;
  }
  return ab = t, ab;
}
var sb, O6;
function hZ() {
  if (O6) return sb;
  O6 = 1;
  var e = iv(), t = Array.prototype, n = t.splice;
  function r(a) {
    var o = this.__data__, l = e(o, a);
    if (l < 0)
      return !1;
    var c = o.length - 1;
    return l == c ? o.pop() : n.call(o, l, 1), --this.size, !0;
  }
  return sb = r, sb;
}
var ob, z6;
function mZ() {
  if (z6) return ob;
  z6 = 1;
  var e = iv();
  function t(n) {
    var r = this.__data__, a = e(r, n);
    return a < 0 ? void 0 : r[a][1];
  }
  return ob = t, ob;
}
var lb, D6;
function pZ() {
  if (D6) return lb;
  D6 = 1;
  var e = iv();
  function t(n) {
    return e(this.__data__, n) > -1;
  }
  return lb = t, lb;
}
var ub, I6;
function gZ() {
  if (I6) return ub;
  I6 = 1;
  var e = iv();
  function t(n, r) {
    var a = this.__data__, o = e(a, n);
    return o < 0 ? (++this.size, a.push([n, r])) : a[o][1] = r, this;
  }
  return ub = t, ub;
}
var cb, L6;
function av() {
  if (L6) return cb;
  L6 = 1;
  var e = dZ(), t = hZ(), n = mZ(), r = pZ(), a = gZ();
  function o(l) {
    var c = -1, d = l == null ? 0 : l.length;
    for (this.clear(); ++c < d; ) {
      var h = l[c];
      this.set(h[0], h[1]);
    }
  }
  return o.prototype.clear = e, o.prototype.delete = t, o.prototype.get = n, o.prototype.has = r, o.prototype.set = a, cb = o, cb;
}
var fb, P6;
function yZ() {
  if (P6) return fb;
  P6 = 1;
  var e = av();
  function t() {
    this.__data__ = new e(), this.size = 0;
  }
  return fb = t, fb;
}
var db, q6;
function vZ() {
  if (q6) return db;
  q6 = 1;
  function e(t) {
    var n = this.__data__, r = n.delete(t);
    return this.size = n.size, r;
  }
  return db = e, db;
}
var hb, B6;
function xZ() {
  if (B6) return hb;
  B6 = 1;
  function e(t) {
    return this.__data__.get(t);
  }
  return hb = e, hb;
}
var mb, F6;
function bZ() {
  if (F6) return mb;
  F6 = 1;
  function e(t) {
    return this.__data__.has(t);
  }
  return mb = e, mb;
}
var pb, U6;
function rR() {
  if (U6) return pb;
  U6 = 1;
  var e = typeof tu == "object" && tu && tu.Object === Object && tu;
  return pb = e, pb;
}
var gb, $6;
function vo() {
  if ($6) return gb;
  $6 = 1;
  var e = rR(), t = typeof self == "object" && self && self.Object === Object && self, n = e || t || Function("return this")();
  return gb = n, gb;
}
var yb, H6;
function am() {
  if (H6) return yb;
  H6 = 1;
  var e = vo(), t = e.Symbol;
  return yb = t, yb;
}
var vb, G6;
function wZ() {
  if (G6) return vb;
  G6 = 1;
  var e = am(), t = Object.prototype, n = t.hasOwnProperty, r = t.toString, a = e ? e.toStringTag : void 0;
  function o(l) {
    var c = n.call(l, a), d = l[a];
    try {
      l[a] = void 0;
      var h = !0;
    } catch {
    }
    var p = r.call(l);
    return h && (c ? l[a] = d : delete l[a]), p;
  }
  return vb = o, vb;
}
var xb, V6;
function _Z() {
  if (V6) return xb;
  V6 = 1;
  var e = Object.prototype, t = e.toString;
  function n(r) {
    return t.call(r);
  }
  return xb = n, xb;
}
var bb, K6;
function ud() {
  if (K6) return bb;
  K6 = 1;
  var e = am(), t = wZ(), n = _Z(), r = "[object Null]", a = "[object Undefined]", o = e ? e.toStringTag : void 0;
  function l(c) {
    return c == null ? c === void 0 ? a : r : o && o in Object(c) ? t(c) : n(c);
  }
  return bb = l, bb;
}
var wb, Y6;
function ks() {
  if (Y6) return wb;
  Y6 = 1;
  function e(t) {
    var n = typeof t;
    return t != null && (n == "object" || n == "function");
  }
  return wb = e, wb;
}
var _b, W6;
function Bg() {
  if (W6) return _b;
  W6 = 1;
  var e = ud(), t = ks(), n = "[object AsyncFunction]", r = "[object Function]", a = "[object GeneratorFunction]", o = "[object Proxy]";
  function l(c) {
    if (!t(c))
      return !1;
    var d = e(c);
    return d == r || d == a || d == n || d == o;
  }
  return _b = l, _b;
}
var Sb, X6;
function SZ() {
  if (X6) return Sb;
  X6 = 1;
  var e = vo(), t = e["__core-js_shared__"];
  return Sb = t, Sb;
}
var Cb, Q6;
function CZ() {
  if (Q6) return Cb;
  Q6 = 1;
  var e = SZ(), t = (function() {
    var r = /[^.]+$/.exec(e && e.keys && e.keys.IE_PROTO || "");
    return r ? "Symbol(src)_1." + r : "";
  })();
  function n(r) {
    return !!t && t in r;
  }
  return Cb = n, Cb;
}
var Eb, Z6;
function iR() {
  if (Z6) return Eb;
  Z6 = 1;
  var e = Function.prototype, t = e.toString;
  function n(r) {
    if (r != null) {
      try {
        return t.call(r);
      } catch {
      }
      try {
        return r + "";
      } catch {
      }
    }
    return "";
  }
  return Eb = n, Eb;
}
var kb, J6;
function EZ() {
  if (J6) return kb;
  J6 = 1;
  var e = Bg(), t = CZ(), n = ks(), r = iR(), a = /[\\^$.*+?()[\]{}|]/g, o = /^\[object .+?Constructor\]$/, l = Function.prototype, c = Object.prototype, d = l.toString, h = c.hasOwnProperty, p = RegExp(
    "^" + d.call(h).replace(a, "\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g, "$1.*?") + "$"
  );
  function g(x) {
    if (!n(x) || t(x))
      return !1;
    var b = e(x) ? p : o;
    return b.test(r(x));
  }
  return kb = g, kb;
}
var Nb, ek;
function kZ() {
  if (ek) return Nb;
  ek = 1;
  function e(t, n) {
    return t == null ? void 0 : t[n];
  }
  return Nb = e, Nb;
}
var jb, tk;
function cd() {
  if (tk) return jb;
  tk = 1;
  var e = EZ(), t = kZ();
  function n(r, a) {
    var o = t(r, a);
    return e(o) ? o : void 0;
  }
  return jb = n, jb;
}
var Tb, nk;
function p5() {
  if (nk) return Tb;
  nk = 1;
  var e = cd(), t = vo(), n = e(t, "Map");
  return Tb = n, Tb;
}
var Ab, rk;
function sv() {
  if (rk) return Ab;
  rk = 1;
  var e = cd(), t = e(Object, "create");
  return Ab = t, Ab;
}
var Mb, ik;
function NZ() {
  if (ik) return Mb;
  ik = 1;
  var e = sv();
  function t() {
    this.__data__ = e ? e(null) : {}, this.size = 0;
  }
  return Mb = t, Mb;
}
var Rb, ak;
function jZ() {
  if (ak) return Rb;
  ak = 1;
  function e(t) {
    var n = this.has(t) && delete this.__data__[t];
    return this.size -= n ? 1 : 0, n;
  }
  return Rb = e, Rb;
}
var Ob, sk;
function TZ() {
  if (sk) return Ob;
  sk = 1;
  var e = sv(), t = "__lodash_hash_undefined__", n = Object.prototype, r = n.hasOwnProperty;
  function a(o) {
    var l = this.__data__;
    if (e) {
      var c = l[o];
      return c === t ? void 0 : c;
    }
    return r.call(l, o) ? l[o] : void 0;
  }
  return Ob = a, Ob;
}
var zb, ok;
function AZ() {
  if (ok) return zb;
  ok = 1;
  var e = sv(), t = Object.prototype, n = t.hasOwnProperty;
  function r(a) {
    var o = this.__data__;
    return e ? o[a] !== void 0 : n.call(o, a);
  }
  return zb = r, zb;
}
var Db, lk;
function MZ() {
  if (lk) return Db;
  lk = 1;
  var e = sv(), t = "__lodash_hash_undefined__";
  function n(r, a) {
    var o = this.__data__;
    return this.size += this.has(r) ? 0 : 1, o[r] = e && a === void 0 ? t : a, this;
  }
  return Db = n, Db;
}
var Ib, uk;
function RZ() {
  if (uk) return Ib;
  uk = 1;
  var e = NZ(), t = jZ(), n = TZ(), r = AZ(), a = MZ();
  function o(l) {
    var c = -1, d = l == null ? 0 : l.length;
    for (this.clear(); ++c < d; ) {
      var h = l[c];
      this.set(h[0], h[1]);
    }
  }
  return o.prototype.clear = e, o.prototype.delete = t, o.prototype.get = n, o.prototype.has = r, o.prototype.set = a, Ib = o, Ib;
}
var Lb, ck;
function OZ() {
  if (ck) return Lb;
  ck = 1;
  var e = RZ(), t = av(), n = p5();
  function r() {
    this.size = 0, this.__data__ = {
      hash: new e(),
      map: new (n || t)(),
      string: new e()
    };
  }
  return Lb = r, Lb;
}
var Pb, fk;
function zZ() {
  if (fk) return Pb;
  fk = 1;
  function e(t) {
    var n = typeof t;
    return n == "string" || n == "number" || n == "symbol" || n == "boolean" ? t !== "__proto__" : t === null;
  }
  return Pb = e, Pb;
}
var qb, dk;
function ov() {
  if (dk) return qb;
  dk = 1;
  var e = zZ();
  function t(n, r) {
    var a = n.__data__;
    return e(r) ? a[typeof r == "string" ? "string" : "hash"] : a.map;
  }
  return qb = t, qb;
}
var Bb, hk;
function DZ() {
  if (hk) return Bb;
  hk = 1;
  var e = ov();
  function t(n) {
    var r = e(this, n).delete(n);
    return this.size -= r ? 1 : 0, r;
  }
  return Bb = t, Bb;
}
var Fb, mk;
function IZ() {
  if (mk) return Fb;
  mk = 1;
  var e = ov();
  function t(n) {
    return e(this, n).get(n);
  }
  return Fb = t, Fb;
}
var Ub, pk;
function LZ() {
  if (pk) return Ub;
  pk = 1;
  var e = ov();
  function t(n) {
    return e(this, n).has(n);
  }
  return Ub = t, Ub;
}
var $b, gk;
function PZ() {
  if (gk) return $b;
  gk = 1;
  var e = ov();
  function t(n, r) {
    var a = e(this, n), o = a.size;
    return a.set(n, r), this.size += a.size == o ? 0 : 1, this;
  }
  return $b = t, $b;
}
var Hb, yk;
function g5() {
  if (yk) return Hb;
  yk = 1;
  var e = OZ(), t = DZ(), n = IZ(), r = LZ(), a = PZ();
  function o(l) {
    var c = -1, d = l == null ? 0 : l.length;
    for (this.clear(); ++c < d; ) {
      var h = l[c];
      this.set(h[0], h[1]);
    }
  }
  return o.prototype.clear = e, o.prototype.delete = t, o.prototype.get = n, o.prototype.has = r, o.prototype.set = a, Hb = o, Hb;
}
var Gb, vk;
function qZ() {
  if (vk) return Gb;
  vk = 1;
  var e = av(), t = p5(), n = g5(), r = 200;
  function a(o, l) {
    var c = this.__data__;
    if (c instanceof e) {
      var d = c.__data__;
      if (!t || d.length < r - 1)
        return d.push([o, l]), this.size = ++c.size, this;
      c = this.__data__ = new n(d);
    }
    return c.set(o, l), this.size = c.size, this;
  }
  return Gb = a, Gb;
}
var Vb, xk;
function lv() {
  if (xk) return Vb;
  xk = 1;
  var e = av(), t = yZ(), n = vZ(), r = xZ(), a = bZ(), o = qZ();
  function l(c) {
    var d = this.__data__ = new e(c);
    this.size = d.size;
  }
  return l.prototype.clear = t, l.prototype.delete = n, l.prototype.get = r, l.prototype.has = a, l.prototype.set = o, Vb = l, Vb;
}
var Kb, bk;
function y5() {
  if (bk) return Kb;
  bk = 1;
  function e(t, n) {
    for (var r = -1, a = t == null ? 0 : t.length; ++r < a && n(t[r], r, t) !== !1; )
      ;
    return t;
  }
  return Kb = e, Kb;
}
var Yb, wk;
function aR() {
  if (wk) return Yb;
  wk = 1;
  var e = cd(), t = (function() {
    try {
      var n = e(Object, "defineProperty");
      return n({}, "", {}), n;
    } catch {
    }
  })();
  return Yb = t, Yb;
}
var Wb, _k;
function uv() {
  if (_k) return Wb;
  _k = 1;
  var e = aR();
  function t(n, r, a) {
    r == "__proto__" && e ? e(n, r, {
      configurable: !0,
      enumerable: !0,
      value: a,
      writable: !0
    }) : n[r] = a;
  }
  return Wb = t, Wb;
}
var Xb, Sk;
function cv() {
  if (Sk) return Xb;
  Sk = 1;
  var e = uv(), t = im(), n = Object.prototype, r = n.hasOwnProperty;
  function a(o, l, c) {
    var d = o[l];
    (!(r.call(o, l) && t(d, c)) || c === void 0 && !(l in o)) && e(o, l, c);
  }
  return Xb = a, Xb;
}
var Qb, Ck;
function Fg() {
  if (Ck) return Qb;
  Ck = 1;
  var e = cv(), t = uv();
  function n(r, a, o, l) {
    var c = !o;
    o || (o = {});
    for (var d = -1, h = a.length; ++d < h; ) {
      var p = a[d], g = l ? l(o[p], r[p], p, o, r) : void 0;
      g === void 0 && (g = r[p]), c ? t(o, p, g) : e(o, p, g);
    }
    return o;
  }
  return Qb = n, Qb;
}
var Zb, Ek;
function BZ() {
  if (Ek) return Zb;
  Ek = 1;
  function e(t, n) {
    for (var r = -1, a = Array(t); ++r < t; )
      a[r] = n(r);
    return a;
  }
  return Zb = e, Zb;
}
var Jb, kk;
function xl() {
  if (kk) return Jb;
  kk = 1;
  function e(t) {
    return t != null && typeof t == "object";
  }
  return Jb = e, Jb;
}
var e2, Nk;
function FZ() {
  if (Nk) return e2;
  Nk = 1;
  var e = ud(), t = xl(), n = "[object Arguments]";
  function r(a) {
    return t(a) && e(a) == n;
  }
  return e2 = r, e2;
}
var t2, jk;
function Ug() {
  if (jk) return t2;
  jk = 1;
  var e = FZ(), t = xl(), n = Object.prototype, r = n.hasOwnProperty, a = n.propertyIsEnumerable, o = e(/* @__PURE__ */ (function() {
    return arguments;
  })()) ? e : function(l) {
    return t(l) && r.call(l, "callee") && !a.call(l, "callee");
  };
  return t2 = o, t2;
}
var n2, Tk;
function Ir() {
  if (Tk) return n2;
  Tk = 1;
  var e = Array.isArray;
  return n2 = e, n2;
}
var tg = { exports: {} }, r2, Ak;
function UZ() {
  if (Ak) return r2;
  Ak = 1;
  function e() {
    return !1;
  }
  return r2 = e, r2;
}
tg.exports;
var Mk;
function sm() {
  return Mk || (Mk = 1, (function(e, t) {
    var n = vo(), r = UZ(), a = t && !t.nodeType && t, o = a && !0 && e && !e.nodeType && e, l = o && o.exports === a, c = l ? n.Buffer : void 0, d = c ? c.isBuffer : void 0, h = d || r;
    e.exports = h;
  })(tg, tg.exports)), tg.exports;
}
var i2, Rk;
function fv() {
  if (Rk) return i2;
  Rk = 1;
  var e = 9007199254740991, t = /^(?:0|[1-9]\d*)$/;
  function n(r, a) {
    var o = typeof r;
    return a = a ?? e, !!a && (o == "number" || o != "symbol" && t.test(r)) && r > -1 && r % 1 == 0 && r < a;
  }
  return i2 = n, i2;
}
var a2, Ok;
function v5() {
  if (Ok) return a2;
  Ok = 1;
  var e = 9007199254740991;
  function t(n) {
    return typeof n == "number" && n > -1 && n % 1 == 0 && n <= e;
  }
  return a2 = t, a2;
}
var s2, zk;
function $Z() {
  if (zk) return s2;
  zk = 1;
  var e = ud(), t = v5(), n = xl(), r = "[object Arguments]", a = "[object Array]", o = "[object Boolean]", l = "[object Date]", c = "[object Error]", d = "[object Function]", h = "[object Map]", p = "[object Number]", g = "[object Object]", x = "[object RegExp]", b = "[object Set]", C = "[object String]", N = "[object WeakMap]", T = "[object ArrayBuffer]", j = "[object DataView]", R = "[object Float32Array]", A = "[object Float64Array]", z = "[object Int8Array]", q = "[object Int16Array]", D = "[object Int32Array]", P = "[object Uint8Array]", re = "[object Uint8ClampedArray]", ie = "[object Uint16Array]", X = "[object Uint32Array]", K = {};
  K[R] = K[A] = K[z] = K[q] = K[D] = K[P] = K[re] = K[ie] = K[X] = !0, K[r] = K[a] = K[T] = K[o] = K[j] = K[l] = K[c] = K[d] = K[h] = K[p] = K[g] = K[x] = K[b] = K[C] = K[N] = !1;
  function V(de) {
    return n(de) && t(de.length) && !!K[e(de)];
  }
  return s2 = V, s2;
}
var o2, Dk;
function dv() {
  if (Dk) return o2;
  Dk = 1;
  function e(t) {
    return function(n) {
      return t(n);
    };
  }
  return o2 = e, o2;
}
var ng = { exports: {} };
ng.exports;
var Ik;
function x5() {
  return Ik || (Ik = 1, (function(e, t) {
    var n = rR(), r = t && !t.nodeType && t, a = r && !0 && e && !e.nodeType && e, o = a && a.exports === r, l = o && n.process, c = (function() {
      try {
        var d = a && a.require && a.require("util").types;
        return d || l && l.binding && l.binding("util");
      } catch {
      }
    })();
    e.exports = c;
  })(ng, ng.exports)), ng.exports;
}
var l2, Lk;
function $g() {
  if (Lk) return l2;
  Lk = 1;
  var e = $Z(), t = dv(), n = x5(), r = n && n.isTypedArray, a = r ? t(r) : e;
  return l2 = a, l2;
}
var u2, Pk;
function sR() {
  if (Pk) return u2;
  Pk = 1;
  var e = BZ(), t = Ug(), n = Ir(), r = sm(), a = fv(), o = $g(), l = Object.prototype, c = l.hasOwnProperty;
  function d(h, p) {
    var g = n(h), x = !g && t(h), b = !g && !x && r(h), C = !g && !x && !b && o(h), N = g || x || b || C, T = N ? e(h.length, String) : [], j = T.length;
    for (var R in h)
      (p || c.call(h, R)) && !(N && // Safari 9 has enumerable `arguments.length` in strict mode.
      (R == "length" || // Node.js 0.10 has enumerable non-index properties on buffers.
      b && (R == "offset" || R == "parent") || // PhantomJS 2 has enumerable non-index properties on typed arrays.
      C && (R == "buffer" || R == "byteLength" || R == "byteOffset") || // Skip index properties.
      a(R, j))) && T.push(R);
    return T;
  }
  return u2 = d, u2;
}
var c2, qk;
function hv() {
  if (qk) return c2;
  qk = 1;
  var e = Object.prototype;
  function t(n) {
    var r = n && n.constructor, a = typeof r == "function" && r.prototype || e;
    return n === a;
  }
  return c2 = t, c2;
}
var f2, Bk;
function oR() {
  if (Bk) return f2;
  Bk = 1;
  function e(t, n) {
    return function(r) {
      return t(n(r));
    };
  }
  return f2 = e, f2;
}
var d2, Fk;
function HZ() {
  if (Fk) return d2;
  Fk = 1;
  var e = oR(), t = e(Object.keys, Object);
  return d2 = t, d2;
}
var h2, Uk;
function b5() {
  if (Uk) return h2;
  Uk = 1;
  var e = hv(), t = HZ(), n = Object.prototype, r = n.hasOwnProperty;
  function a(o) {
    if (!e(o))
      return t(o);
    var l = [];
    for (var c in Object(o))
      r.call(o, c) && c != "constructor" && l.push(c);
    return l;
  }
  return h2 = a, h2;
}
var m2, $k;
function lu() {
  if ($k) return m2;
  $k = 1;
  var e = Bg(), t = v5();
  function n(r) {
    return r != null && t(r.length) && !e(r);
  }
  return m2 = n, m2;
}
var p2, Hk;
function _c() {
  if (Hk) return p2;
  Hk = 1;
  var e = sR(), t = b5(), n = lu();
  function r(a) {
    return n(a) ? e(a) : t(a);
  }
  return p2 = r, p2;
}
var g2, Gk;
function GZ() {
  if (Gk) return g2;
  Gk = 1;
  var e = Fg(), t = _c();
  function n(r, a) {
    return r && e(a, t(a), r);
  }
  return g2 = n, g2;
}
var y2, Vk;
function VZ() {
  if (Vk) return y2;
  Vk = 1;
  function e(t) {
    var n = [];
    if (t != null)
      for (var r in Object(t))
        n.push(r);
    return n;
  }
  return y2 = e, y2;
}
var v2, Kk;
function KZ() {
  if (Kk) return v2;
  Kk = 1;
  var e = ks(), t = hv(), n = VZ(), r = Object.prototype, a = r.hasOwnProperty;
  function o(l) {
    if (!e(l))
      return n(l);
    var c = t(l), d = [];
    for (var h in l)
      h == "constructor" && (c || !a.call(l, h)) || d.push(h);
    return d;
  }
  return v2 = o, v2;
}
var x2, Yk;
function fd() {
  if (Yk) return x2;
  Yk = 1;
  var e = sR(), t = KZ(), n = lu();
  function r(a) {
    return n(a) ? e(a, !0) : t(a);
  }
  return x2 = r, x2;
}
var b2, Wk;
function YZ() {
  if (Wk) return b2;
  Wk = 1;
  var e = Fg(), t = fd();
  function n(r, a) {
    return r && e(a, t(a), r);
  }
  return b2 = n, b2;
}
var rg = { exports: {} };
rg.exports;
var Xk;
function lR() {
  return Xk || (Xk = 1, (function(e, t) {
    var n = vo(), r = t && !t.nodeType && t, a = r && !0 && e && !e.nodeType && e, o = a && a.exports === r, l = o ? n.Buffer : void 0, c = l ? l.allocUnsafe : void 0;
    function d(h, p) {
      if (p)
        return h.slice();
      var g = h.length, x = c ? c(g) : new h.constructor(g);
      return h.copy(x), x;
    }
    e.exports = d;
  })(rg, rg.exports)), rg.exports;
}
var w2, Qk;
function uR() {
  if (Qk) return w2;
  Qk = 1;
  function e(t, n) {
    var r = -1, a = t.length;
    for (n || (n = Array(a)); ++r < a; )
      n[r] = t[r];
    return n;
  }
  return w2 = e, w2;
}
var _2, Zk;
function cR() {
  if (Zk) return _2;
  Zk = 1;
  function e(t, n) {
    for (var r = -1, a = t == null ? 0 : t.length, o = 0, l = []; ++r < a; ) {
      var c = t[r];
      n(c, r, t) && (l[o++] = c);
    }
    return l;
  }
  return _2 = e, _2;
}
var S2, Jk;
function fR() {
  if (Jk) return S2;
  Jk = 1;
  function e() {
    return [];
  }
  return S2 = e, S2;
}
var C2, e8;
function w5() {
  if (e8) return C2;
  e8 = 1;
  var e = cR(), t = fR(), n = Object.prototype, r = n.propertyIsEnumerable, a = Object.getOwnPropertySymbols, o = a ? function(l) {
    return l == null ? [] : (l = Object(l), e(a(l), function(c) {
      return r.call(l, c);
    }));
  } : t;
  return C2 = o, C2;
}
var E2, t8;
function WZ() {
  if (t8) return E2;
  t8 = 1;
  var e = Fg(), t = w5();
  function n(r, a) {
    return e(r, t(r), a);
  }
  return E2 = n, E2;
}
var k2, n8;
function _5() {
  if (n8) return k2;
  n8 = 1;
  function e(t, n) {
    for (var r = -1, a = n.length, o = t.length; ++r < a; )
      t[o + r] = n[r];
    return t;
  }
  return k2 = e, k2;
}
var N2, r8;
function mv() {
  if (r8) return N2;
  r8 = 1;
  var e = oR(), t = e(Object.getPrototypeOf, Object);
  return N2 = t, N2;
}
var j2, i8;
function dR() {
  if (i8) return j2;
  i8 = 1;
  var e = _5(), t = mv(), n = w5(), r = fR(), a = Object.getOwnPropertySymbols, o = a ? function(l) {
    for (var c = []; l; )
      e(c, n(l)), l = t(l);
    return c;
  } : r;
  return j2 = o, j2;
}
var T2, a8;
function XZ() {
  if (a8) return T2;
  a8 = 1;
  var e = Fg(), t = dR();
  function n(r, a) {
    return e(r, t(r), a);
  }
  return T2 = n, T2;
}
var A2, s8;
function hR() {
  if (s8) return A2;
  s8 = 1;
  var e = _5(), t = Ir();
  function n(r, a, o) {
    var l = a(r);
    return t(r) ? l : e(l, o(r));
  }
  return A2 = n, A2;
}
var M2, o8;
function mR() {
  if (o8) return M2;
  o8 = 1;
  var e = hR(), t = w5(), n = _c();
  function r(a) {
    return e(a, n, t);
  }
  return M2 = r, M2;
}
var R2, l8;
function QZ() {
  if (l8) return R2;
  l8 = 1;
  var e = hR(), t = dR(), n = fd();
  function r(a) {
    return e(a, n, t);
  }
  return R2 = r, R2;
}
var O2, u8;
function ZZ() {
  if (u8) return O2;
  u8 = 1;
  var e = cd(), t = vo(), n = e(t, "DataView");
  return O2 = n, O2;
}
var z2, c8;
function JZ() {
  if (c8) return z2;
  c8 = 1;
  var e = cd(), t = vo(), n = e(t, "Promise");
  return z2 = n, z2;
}
var D2, f8;
function pR() {
  if (f8) return D2;
  f8 = 1;
  var e = cd(), t = vo(), n = e(t, "Set");
  return D2 = n, D2;
}
var I2, d8;
function eJ() {
  if (d8) return I2;
  d8 = 1;
  var e = cd(), t = vo(), n = e(t, "WeakMap");
  return I2 = n, I2;
}
var L2, h8;
function om() {
  if (h8) return L2;
  h8 = 1;
  var e = ZZ(), t = p5(), n = JZ(), r = pR(), a = eJ(), o = ud(), l = iR(), c = "[object Map]", d = "[object Object]", h = "[object Promise]", p = "[object Set]", g = "[object WeakMap]", x = "[object DataView]", b = l(e), C = l(t), N = l(n), T = l(r), j = l(a), R = o;
  return (e && R(new e(new ArrayBuffer(1))) != x || t && R(new t()) != c || n && R(n.resolve()) != h || r && R(new r()) != p || a && R(new a()) != g) && (R = function(A) {
    var z = o(A), q = z == d ? A.constructor : void 0, D = q ? l(q) : "";
    if (D)
      switch (D) {
        case b:
          return x;
        case C:
          return c;
        case N:
          return h;
        case T:
          return p;
        case j:
          return g;
      }
    return z;
  }), L2 = R, L2;
}
var P2, m8;
function tJ() {
  if (m8) return P2;
  m8 = 1;
  var e = Object.prototype, t = e.hasOwnProperty;
  function n(r) {
    var a = r.length, o = new r.constructor(a);
    return a && typeof r[0] == "string" && t.call(r, "index") && (o.index = r.index, o.input = r.input), o;
  }
  return P2 = n, P2;
}
var q2, p8;
function gR() {
  if (p8) return q2;
  p8 = 1;
  var e = vo(), t = e.Uint8Array;
  return q2 = t, q2;
}
var B2, g8;
function S5() {
  if (g8) return B2;
  g8 = 1;
  var e = gR();
  function t(n) {
    var r = new n.constructor(n.byteLength);
    return new e(r).set(new e(n)), r;
  }
  return B2 = t, B2;
}
var F2, y8;
function nJ() {
  if (y8) return F2;
  y8 = 1;
  var e = S5();
  function t(n, r) {
    var a = r ? e(n.buffer) : n.buffer;
    return new n.constructor(a, n.byteOffset, n.byteLength);
  }
  return F2 = t, F2;
}
var U2, v8;
function rJ() {
  if (v8) return U2;
  v8 = 1;
  var e = /\w*$/;
  function t(n) {
    var r = new n.constructor(n.source, e.exec(n));
    return r.lastIndex = n.lastIndex, r;
  }
  return U2 = t, U2;
}
var $2, x8;
function iJ() {
  if (x8) return $2;
  x8 = 1;
  var e = am(), t = e ? e.prototype : void 0, n = t ? t.valueOf : void 0;
  function r(a) {
    return n ? Object(n.call(a)) : {};
  }
  return $2 = r, $2;
}
var H2, b8;
function yR() {
  if (b8) return H2;
  b8 = 1;
  var e = S5();
  function t(n, r) {
    var a = r ? e(n.buffer) : n.buffer;
    return new n.constructor(a, n.byteOffset, n.length);
  }
  return H2 = t, H2;
}
var G2, w8;
function aJ() {
  if (w8) return G2;
  w8 = 1;
  var e = S5(), t = nJ(), n = rJ(), r = iJ(), a = yR(), o = "[object Boolean]", l = "[object Date]", c = "[object Map]", d = "[object Number]", h = "[object RegExp]", p = "[object Set]", g = "[object String]", x = "[object Symbol]", b = "[object ArrayBuffer]", C = "[object DataView]", N = "[object Float32Array]", T = "[object Float64Array]", j = "[object Int8Array]", R = "[object Int16Array]", A = "[object Int32Array]", z = "[object Uint8Array]", q = "[object Uint8ClampedArray]", D = "[object Uint16Array]", P = "[object Uint32Array]";
  function re(ie, X, K) {
    var V = ie.constructor;
    switch (X) {
      case b:
        return e(ie);
      case o:
      case l:
        return new V(+ie);
      case C:
        return t(ie, K);
      case N:
      case T:
      case j:
      case R:
      case A:
      case z:
      case q:
      case D:
      case P:
        return a(ie, K);
      case c:
        return new V();
      case d:
      case g:
        return new V(ie);
      case h:
        return n(ie);
      case p:
        return new V();
      case x:
        return r(ie);
    }
  }
  return G2 = re, G2;
}
var V2, _8;
function vR() {
  if (_8) return V2;
  _8 = 1;
  var e = ks(), t = Object.create, n = /* @__PURE__ */ (function() {
    function r() {
    }
    return function(a) {
      if (!e(a))
        return {};
      if (t)
        return t(a);
      r.prototype = a;
      var o = new r();
      return r.prototype = void 0, o;
    };
  })();
  return V2 = n, V2;
}
var K2, S8;
function xR() {
  if (S8) return K2;
  S8 = 1;
  var e = vR(), t = mv(), n = hv();
  function r(a) {
    return typeof a.constructor == "function" && !n(a) ? e(t(a)) : {};
  }
  return K2 = r, K2;
}
var Y2, C8;
function sJ() {
  if (C8) return Y2;
  C8 = 1;
  var e = om(), t = xl(), n = "[object Map]";
  function r(a) {
    return t(a) && e(a) == n;
  }
  return Y2 = r, Y2;
}
var W2, E8;
function oJ() {
  if (E8) return W2;
  E8 = 1;
  var e = sJ(), t = dv(), n = x5(), r = n && n.isMap, a = r ? t(r) : e;
  return W2 = a, W2;
}
var X2, k8;
function lJ() {
  if (k8) return X2;
  k8 = 1;
  var e = om(), t = xl(), n = "[object Set]";
  function r(a) {
    return t(a) && e(a) == n;
  }
  return X2 = r, X2;
}
var Q2, N8;
function uJ() {
  if (N8) return Q2;
  N8 = 1;
  var e = lJ(), t = dv(), n = x5(), r = n && n.isSet, a = r ? t(r) : e;
  return Q2 = a, Q2;
}
var Z2, j8;
function bR() {
  if (j8) return Z2;
  j8 = 1;
  var e = lv(), t = y5(), n = cv(), r = GZ(), a = YZ(), o = lR(), l = uR(), c = WZ(), d = XZ(), h = mR(), p = QZ(), g = om(), x = tJ(), b = aJ(), C = xR(), N = Ir(), T = sm(), j = oJ(), R = ks(), A = uJ(), z = _c(), q = fd(), D = 1, P = 2, re = 4, ie = "[object Arguments]", X = "[object Array]", K = "[object Boolean]", V = "[object Date]", de = "[object Error]", H = "[object Function]", se = "[object GeneratorFunction]", Z = "[object Map]", fe = "[object Number]", he = "[object Object]", ge = "[object RegExp]", Q = "[object Set]", U = "[object String]", ue = "[object Symbol]", Y = "[object WeakMap]", le = "[object ArrayBuffer]", xe = "[object DataView]", Se = "[object Float32Array]", Oe = "[object Float64Array]", qe = "[object Int8Array]", Me = "[object Int16Array]", Pe = "[object Int32Array]", Re = "[object Uint8Array]", Be = "[object Uint8ClampedArray]", Je = "[object Uint16Array]", ot = "[object Uint32Array]", We = {};
  We[ie] = We[X] = We[le] = We[xe] = We[K] = We[V] = We[Se] = We[Oe] = We[qe] = We[Me] = We[Pe] = We[Z] = We[fe] = We[he] = We[ge] = We[Q] = We[U] = We[ue] = We[Re] = We[Be] = We[Je] = We[ot] = !0, We[de] = We[H] = We[Y] = !1;
  function bt(vt, Yn, Mn, Fn, Ht, Rn) {
    var rn, Cn = Yn & D, Wn = Yn & P, Ue = Yn & re;
    if (Mn && (rn = Ht ? Mn(vt, Fn, Ht, Rn) : Mn(vt)), rn !== void 0)
      return rn;
    if (!R(vt))
      return vt;
    var Ze = N(vt);
    if (Ze) {
      if (rn = x(vt), !Cn)
        return l(vt, rn);
    } else {
      var gt = g(vt), Nt = gt == H || gt == se;
      if (T(vt))
        return o(vt, Cn);
      if (gt == he || gt == ie || Nt && !Ht) {
        if (rn = Wn || Nt ? {} : C(vt), !Cn)
          return Wn ? d(vt, a(rn, vt)) : c(vt, r(rn, vt));
      } else {
        if (!We[gt])
          return Ht ? vt : {};
        rn = b(vt, gt, Cn);
      }
    }
    Rn || (Rn = new e());
    var Dt = Rn.get(vt);
    if (Dt)
      return Dt;
    Rn.set(vt, rn), A(vt) ? vt.forEach(function(an) {
      rn.add(bt(an, Yn, Mn, an, vt, Rn));
    }) : j(vt) && vt.forEach(function(an, Qt) {
      rn.set(Qt, bt(an, Yn, Mn, Qt, vt, Rn));
    });
    var Un = Ue ? Wn ? p : h : Wn ? q : z, $n = Ze ? void 0 : Un(vt);
    return t($n || vt, function(an, Qt) {
      $n && (Qt = an, an = vt[Qt]), n(rn, Qt, bt(an, Yn, Mn, Qt, vt, Rn));
    }), rn;
  }
  return Z2 = bt, Z2;
}
var J2, T8;
function cJ() {
  if (T8) return J2;
  T8 = 1;
  var e = bR(), t = 4;
  function n(r) {
    return e(r, t);
  }
  return J2 = n, J2;
}
var ew, A8;
function C5() {
  if (A8) return ew;
  A8 = 1;
  function e(t) {
    return function() {
      return t;
    };
  }
  return ew = e, ew;
}
var tw, M8;
function fJ() {
  if (M8) return tw;
  M8 = 1;
  function e(t) {
    return function(n, r, a) {
      for (var o = -1, l = Object(n), c = a(n), d = c.length; d--; ) {
        var h = c[t ? d : ++o];
        if (r(l[h], h, l) === !1)
          break;
      }
      return n;
    };
  }
  return tw = e, tw;
}
var nw, R8;
function E5() {
  if (R8) return nw;
  R8 = 1;
  var e = fJ(), t = e();
  return nw = t, nw;
}
var rw, O8;
function k5() {
  if (O8) return rw;
  O8 = 1;
  var e = E5(), t = _c();
  function n(r, a) {
    return r && e(r, a, t);
  }
  return rw = n, rw;
}
var iw, z8;
function dJ() {
  if (z8) return iw;
  z8 = 1;
  var e = lu();
  function t(n, r) {
    return function(a, o) {
      if (a == null)
        return a;
      if (!e(a))
        return n(a, o);
      for (var l = a.length, c = r ? l : -1, d = Object(a); (r ? c-- : ++c < l) && o(d[c], c, d) !== !1; )
        ;
      return a;
    };
  }
  return iw = t, iw;
}
var aw, D8;
function pv() {
  if (D8) return aw;
  D8 = 1;
  var e = k5(), t = dJ(), n = t(e);
  return aw = n, aw;
}
var sw, I8;
function dd() {
  if (I8) return sw;
  I8 = 1;
  function e(t) {
    return t;
  }
  return sw = e, sw;
}
var ow, L8;
function wR() {
  if (L8) return ow;
  L8 = 1;
  var e = dd();
  function t(n) {
    return typeof n == "function" ? n : e;
  }
  return ow = t, ow;
}
var lw, P8;
function _R() {
  if (P8) return lw;
  P8 = 1;
  var e = y5(), t = pv(), n = wR(), r = Ir();
  function a(o, l) {
    var c = r(o) ? e : t;
    return c(o, n(l));
  }
  return lw = a, lw;
}
var uw, q8;
function SR() {
  return q8 || (q8 = 1, uw = _R()), uw;
}
var cw, B8;
function hJ() {
  if (B8) return cw;
  B8 = 1;
  var e = pv();
  function t(n, r) {
    var a = [];
    return e(n, function(o, l, c) {
      r(o, l, c) && a.push(o);
    }), a;
  }
  return cw = t, cw;
}
var fw, F8;
function mJ() {
  if (F8) return fw;
  F8 = 1;
  var e = "__lodash_hash_undefined__";
  function t(n) {
    return this.__data__.set(n, e), this;
  }
  return fw = t, fw;
}
var dw, U8;
function pJ() {
  if (U8) return dw;
  U8 = 1;
  function e(t) {
    return this.__data__.has(t);
  }
  return dw = e, dw;
}
var hw, $8;
function CR() {
  if ($8) return hw;
  $8 = 1;
  var e = g5(), t = mJ(), n = pJ();
  function r(a) {
    var o = -1, l = a == null ? 0 : a.length;
    for (this.__data__ = new e(); ++o < l; )
      this.add(a[o]);
  }
  return r.prototype.add = r.prototype.push = t, r.prototype.has = n, hw = r, hw;
}
var mw, H8;
function gJ() {
  if (H8) return mw;
  H8 = 1;
  function e(t, n) {
    for (var r = -1, a = t == null ? 0 : t.length; ++r < a; )
      if (n(t[r], r, t))
        return !0;
    return !1;
  }
  return mw = e, mw;
}
var pw, G8;
function ER() {
  if (G8) return pw;
  G8 = 1;
  function e(t, n) {
    return t.has(n);
  }
  return pw = e, pw;
}
var gw, V8;
function kR() {
  if (V8) return gw;
  V8 = 1;
  var e = CR(), t = gJ(), n = ER(), r = 1, a = 2;
  function o(l, c, d, h, p, g) {
    var x = d & r, b = l.length, C = c.length;
    if (b != C && !(x && C > b))
      return !1;
    var N = g.get(l), T = g.get(c);
    if (N && T)
      return N == c && T == l;
    var j = -1, R = !0, A = d & a ? new e() : void 0;
    for (g.set(l, c), g.set(c, l); ++j < b; ) {
      var z = l[j], q = c[j];
      if (h)
        var D = x ? h(q, z, j, c, l, g) : h(z, q, j, l, c, g);
      if (D !== void 0) {
        if (D)
          continue;
        R = !1;
        break;
      }
      if (A) {
        if (!t(c, function(P, re) {
          if (!n(A, re) && (z === P || p(z, P, d, h, g)))
            return A.push(re);
        })) {
          R = !1;
          break;
        }
      } else if (!(z === q || p(z, q, d, h, g))) {
        R = !1;
        break;
      }
    }
    return g.delete(l), g.delete(c), R;
  }
  return gw = o, gw;
}
var yw, K8;
function yJ() {
  if (K8) return yw;
  K8 = 1;
  function e(t) {
    var n = -1, r = Array(t.size);
    return t.forEach(function(a, o) {
      r[++n] = [o, a];
    }), r;
  }
  return yw = e, yw;
}
var vw, Y8;
function N5() {
  if (Y8) return vw;
  Y8 = 1;
  function e(t) {
    var n = -1, r = Array(t.size);
    return t.forEach(function(a) {
      r[++n] = a;
    }), r;
  }
  return vw = e, vw;
}
var xw, W8;
function vJ() {
  if (W8) return xw;
  W8 = 1;
  var e = am(), t = gR(), n = im(), r = kR(), a = yJ(), o = N5(), l = 1, c = 2, d = "[object Boolean]", h = "[object Date]", p = "[object Error]", g = "[object Map]", x = "[object Number]", b = "[object RegExp]", C = "[object Set]", N = "[object String]", T = "[object Symbol]", j = "[object ArrayBuffer]", R = "[object DataView]", A = e ? e.prototype : void 0, z = A ? A.valueOf : void 0;
  function q(D, P, re, ie, X, K, V) {
    switch (re) {
      case R:
        if (D.byteLength != P.byteLength || D.byteOffset != P.byteOffset)
          return !1;
        D = D.buffer, P = P.buffer;
      case j:
        return !(D.byteLength != P.byteLength || !K(new t(D), new t(P)));
      case d:
      case h:
      case x:
        return n(+D, +P);
      case p:
        return D.name == P.name && D.message == P.message;
      case b:
      case N:
        return D == P + "";
      case g:
        var de = a;
      case C:
        var H = ie & l;
        if (de || (de = o), D.size != P.size && !H)
          return !1;
        var se = V.get(D);
        if (se)
          return se == P;
        ie |= c, V.set(D, P);
        var Z = r(de(D), de(P), ie, X, K, V);
        return V.delete(D), Z;
      case T:
        if (z)
          return z.call(D) == z.call(P);
    }
    return !1;
  }
  return xw = q, xw;
}
var bw, X8;
function xJ() {
  if (X8) return bw;
  X8 = 1;
  var e = mR(), t = 1, n = Object.prototype, r = n.hasOwnProperty;
  function a(o, l, c, d, h, p) {
    var g = c & t, x = e(o), b = x.length, C = e(l), N = C.length;
    if (b != N && !g)
      return !1;
    for (var T = b; T--; ) {
      var j = x[T];
      if (!(g ? j in l : r.call(l, j)))
        return !1;
    }
    var R = p.get(o), A = p.get(l);
    if (R && A)
      return R == l && A == o;
    var z = !0;
    p.set(o, l), p.set(l, o);
    for (var q = g; ++T < b; ) {
      j = x[T];
      var D = o[j], P = l[j];
      if (d)
        var re = g ? d(P, D, j, l, o, p) : d(D, P, j, o, l, p);
      if (!(re === void 0 ? D === P || h(D, P, c, d, p) : re)) {
        z = !1;
        break;
      }
      q || (q = j == "constructor");
    }
    if (z && !q) {
      var ie = o.constructor, X = l.constructor;
      ie != X && "constructor" in o && "constructor" in l && !(typeof ie == "function" && ie instanceof ie && typeof X == "function" && X instanceof X) && (z = !1);
    }
    return p.delete(o), p.delete(l), z;
  }
  return bw = a, bw;
}
var ww, Q8;
function bJ() {
  if (Q8) return ww;
  Q8 = 1;
  var e = lv(), t = kR(), n = vJ(), r = xJ(), a = om(), o = Ir(), l = sm(), c = $g(), d = 1, h = "[object Arguments]", p = "[object Array]", g = "[object Object]", x = Object.prototype, b = x.hasOwnProperty;
  function C(N, T, j, R, A, z) {
    var q = o(N), D = o(T), P = q ? p : a(N), re = D ? p : a(T);
    P = P == h ? g : P, re = re == h ? g : re;
    var ie = P == g, X = re == g, K = P == re;
    if (K && l(N)) {
      if (!l(T))
        return !1;
      q = !0, ie = !1;
    }
    if (K && !ie)
      return z || (z = new e()), q || c(N) ? t(N, T, j, R, A, z) : n(N, T, P, j, R, A, z);
    if (!(j & d)) {
      var V = ie && b.call(N, "__wrapped__"), de = X && b.call(T, "__wrapped__");
      if (V || de) {
        var H = V ? N.value() : N, se = de ? T.value() : T;
        return z || (z = new e()), A(H, se, j, R, z);
      }
    }
    return K ? (z || (z = new e()), r(N, T, j, R, A, z)) : !1;
  }
  return ww = C, ww;
}
var _w, Z8;
function NR() {
  if (Z8) return _w;
  Z8 = 1;
  var e = bJ(), t = xl();
  function n(r, a, o, l, c) {
    return r === a ? !0 : r == null || a == null || !t(r) && !t(a) ? r !== r && a !== a : e(r, a, o, l, n, c);
  }
  return _w = n, _w;
}
var Sw, J8;
function wJ() {
  if (J8) return Sw;
  J8 = 1;
  var e = lv(), t = NR(), n = 1, r = 2;
  function a(o, l, c, d) {
    var h = c.length, p = h, g = !d;
    if (o == null)
      return !p;
    for (o = Object(o); h--; ) {
      var x = c[h];
      if (g && x[2] ? x[1] !== o[x[0]] : !(x[0] in o))
        return !1;
    }
    for (; ++h < p; ) {
      x = c[h];
      var b = x[0], C = o[b], N = x[1];
      if (g && x[2]) {
        if (C === void 0 && !(b in o))
          return !1;
      } else {
        var T = new e();
        if (d)
          var j = d(C, N, b, o, l, T);
        if (!(j === void 0 ? t(N, C, n | r, d, T) : j))
          return !1;
      }
    }
    return !0;
  }
  return Sw = a, Sw;
}
var Cw, eN;
function jR() {
  if (eN) return Cw;
  eN = 1;
  var e = ks();
  function t(n) {
    return n === n && !e(n);
  }
  return Cw = t, Cw;
}
var Ew, tN;
function _J() {
  if (tN) return Ew;
  tN = 1;
  var e = jR(), t = _c();
  function n(r) {
    for (var a = t(r), o = a.length; o--; ) {
      var l = a[o], c = r[l];
      a[o] = [l, c, e(c)];
    }
    return a;
  }
  return Ew = n, Ew;
}
var kw, nN;
function TR() {
  if (nN) return kw;
  nN = 1;
  function e(t, n) {
    return function(r) {
      return r == null ? !1 : r[t] === n && (n !== void 0 || t in Object(r));
    };
  }
  return kw = e, kw;
}
var Nw, rN;
function SJ() {
  if (rN) return Nw;
  rN = 1;
  var e = wJ(), t = _J(), n = TR();
  function r(a) {
    var o = t(a);
    return o.length == 1 && o[0][2] ? n(o[0][0], o[0][1]) : function(l) {
      return l === a || e(l, a, o);
    };
  }
  return Nw = r, Nw;
}
var jw, iN;
function lm() {
  if (iN) return jw;
  iN = 1;
  var e = ud(), t = xl(), n = "[object Symbol]";
  function r(a) {
    return typeof a == "symbol" || t(a) && e(a) == n;
  }
  return jw = r, jw;
}
var Tw, aN;
function j5() {
  if (aN) return Tw;
  aN = 1;
  var e = Ir(), t = lm(), n = /\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/, r = /^\w*$/;
  function a(o, l) {
    if (e(o))
      return !1;
    var c = typeof o;
    return c == "number" || c == "symbol" || c == "boolean" || o == null || t(o) ? !0 : r.test(o) || !n.test(o) || l != null && o in Object(l);
  }
  return Tw = a, Tw;
}
var Aw, sN;
function CJ() {
  if (sN) return Aw;
  sN = 1;
  var e = g5(), t = "Expected a function";
  function n(r, a) {
    if (typeof r != "function" || a != null && typeof a != "function")
      throw new TypeError(t);
    var o = function() {
      var l = arguments, c = a ? a.apply(this, l) : l[0], d = o.cache;
      if (d.has(c))
        return d.get(c);
      var h = r.apply(this, l);
      return o.cache = d.set(c, h) || d, h;
    };
    return o.cache = new (n.Cache || e)(), o;
  }
  return n.Cache = e, Aw = n, Aw;
}
var Mw, oN;
function EJ() {
  if (oN) return Mw;
  oN = 1;
  var e = CJ(), t = 500;
  function n(r) {
    var a = e(r, function(l) {
      return o.size === t && o.clear(), l;
    }), o = a.cache;
    return a;
  }
  return Mw = n, Mw;
}
var Rw, lN;
function kJ() {
  if (lN) return Rw;
  lN = 1;
  var e = EJ(), t = /[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g, n = /\\(\\)?/g, r = e(function(a) {
    var o = [];
    return a.charCodeAt(0) === 46 && o.push(""), a.replace(t, function(l, c, d, h) {
      o.push(d ? h.replace(n, "$1") : c || l);
    }), o;
  });
  return Rw = r, Rw;
}
var Ow, uN;
function gv() {
  if (uN) return Ow;
  uN = 1;
  function e(t, n) {
    for (var r = -1, a = t == null ? 0 : t.length, o = Array(a); ++r < a; )
      o[r] = n(t[r], r, t);
    return o;
  }
  return Ow = e, Ow;
}
var zw, cN;
function NJ() {
  if (cN) return zw;
  cN = 1;
  var e = am(), t = gv(), n = Ir(), r = lm(), a = e ? e.prototype : void 0, o = a ? a.toString : void 0;
  function l(c) {
    if (typeof c == "string")
      return c;
    if (n(c))
      return t(c, l) + "";
    if (r(c))
      return o ? o.call(c) : "";
    var d = c + "";
    return d == "0" && 1 / c == -1 / 0 ? "-0" : d;
  }
  return zw = l, zw;
}
var Dw, fN;
function AR() {
  if (fN) return Dw;
  fN = 1;
  var e = NJ();
  function t(n) {
    return n == null ? "" : e(n);
  }
  return Dw = t, Dw;
}
var Iw, dN;
function yv() {
  if (dN) return Iw;
  dN = 1;
  var e = Ir(), t = j5(), n = kJ(), r = AR();
  function a(o, l) {
    return e(o) ? o : t(o, l) ? [o] : n(r(o));
  }
  return Iw = a, Iw;
}
var Lw, hN;
function Hg() {
  if (hN) return Lw;
  hN = 1;
  var e = lm();
  function t(n) {
    if (typeof n == "string" || e(n))
      return n;
    var r = n + "";
    return r == "0" && 1 / n == -1 / 0 ? "-0" : r;
  }
  return Lw = t, Lw;
}
var Pw, mN;
function vv() {
  if (mN) return Pw;
  mN = 1;
  var e = yv(), t = Hg();
  function n(r, a) {
    a = e(a, r);
    for (var o = 0, l = a.length; r != null && o < l; )
      r = r[t(a[o++])];
    return o && o == l ? r : void 0;
  }
  return Pw = n, Pw;
}
var qw, pN;
function jJ() {
  if (pN) return qw;
  pN = 1;
  var e = vv();
  function t(n, r, a) {
    var o = n == null ? void 0 : e(n, r);
    return o === void 0 ? a : o;
  }
  return qw = t, qw;
}
var Bw, gN;
function TJ() {
  if (gN) return Bw;
  gN = 1;
  function e(t, n) {
    return t != null && n in Object(t);
  }
  return Bw = e, Bw;
}
var Fw, yN;
function MR() {
  if (yN) return Fw;
  yN = 1;
  var e = yv(), t = Ug(), n = Ir(), r = fv(), a = v5(), o = Hg();
  function l(c, d, h) {
    d = e(d, c);
    for (var p = -1, g = d.length, x = !1; ++p < g; ) {
      var b = o(d[p]);
      if (!(x = c != null && h(c, b)))
        break;
      c = c[b];
    }
    return x || ++p != g ? x : (g = c == null ? 0 : c.length, !!g && a(g) && r(b, g) && (n(c) || t(c)));
  }
  return Fw = l, Fw;
}
var Uw, vN;
function RR() {
  if (vN) return Uw;
  vN = 1;
  var e = TJ(), t = MR();
  function n(r, a) {
    return r != null && t(r, a, e);
  }
  return Uw = n, Uw;
}
var $w, xN;
function AJ() {
  if (xN) return $w;
  xN = 1;
  var e = NR(), t = jJ(), n = RR(), r = j5(), a = jR(), o = TR(), l = Hg(), c = 1, d = 2;
  function h(p, g) {
    return r(p) && a(g) ? o(l(p), g) : function(x) {
      var b = t(x, p);
      return b === void 0 && b === g ? n(x, p) : e(g, b, c | d);
    };
  }
  return $w = h, $w;
}
var Hw, bN;
function OR() {
  if (bN) return Hw;
  bN = 1;
  function e(t) {
    return function(n) {
      return n == null ? void 0 : n[t];
    };
  }
  return Hw = e, Hw;
}
var Gw, wN;
function MJ() {
  if (wN) return Gw;
  wN = 1;
  var e = vv();
  function t(n) {
    return function(r) {
      return e(r, n);
    };
  }
  return Gw = t, Gw;
}
var Vw, _N;
function RJ() {
  if (_N) return Vw;
  _N = 1;
  var e = OR(), t = MJ(), n = j5(), r = Hg();
  function a(o) {
    return n(o) ? e(r(o)) : t(o);
  }
  return Vw = a, Vw;
}
var Kw, SN;
function uu() {
  if (SN) return Kw;
  SN = 1;
  var e = SJ(), t = AJ(), n = dd(), r = Ir(), a = RJ();
  function o(l) {
    return typeof l == "function" ? l : l == null ? n : typeof l == "object" ? r(l) ? t(l[0], l[1]) : e(l) : a(l);
  }
  return Kw = o, Kw;
}
var Yw, CN;
function zR() {
  if (CN) return Yw;
  CN = 1;
  var e = cR(), t = hJ(), n = uu(), r = Ir();
  function a(o, l) {
    var c = r(o) ? e : t;
    return c(o, n(l, 3));
  }
  return Yw = a, Yw;
}
var Ww, EN;
function OJ() {
  if (EN) return Ww;
  EN = 1;
  var e = Object.prototype, t = e.hasOwnProperty;
  function n(r, a) {
    return r != null && t.call(r, a);
  }
  return Ww = n, Ww;
}
var Xw, kN;
function DR() {
  if (kN) return Xw;
  kN = 1;
  var e = OJ(), t = MR();
  function n(r, a) {
    return r != null && t(r, a, e);
  }
  return Xw = n, Xw;
}
var Qw, NN;
function zJ() {
  if (NN) return Qw;
  NN = 1;
  var e = b5(), t = om(), n = Ug(), r = Ir(), a = lu(), o = sm(), l = hv(), c = $g(), d = "[object Map]", h = "[object Set]", p = Object.prototype, g = p.hasOwnProperty;
  function x(b) {
    if (b == null)
      return !0;
    if (a(b) && (r(b) || typeof b == "string" || typeof b.splice == "function" || o(b) || c(b) || n(b)))
      return !b.length;
    var C = t(b);
    if (C == d || C == h)
      return !b.size;
    if (l(b))
      return !e(b).length;
    for (var N in b)
      if (g.call(b, N))
        return !1;
    return !0;
  }
  return Qw = x, Qw;
}
var Zw, jN;
function IR() {
  if (jN) return Zw;
  jN = 1;
  function e(t) {
    return t === void 0;
  }
  return Zw = e, Zw;
}
var Jw, TN;
function LR() {
  if (TN) return Jw;
  TN = 1;
  var e = pv(), t = lu();
  function n(r, a) {
    var o = -1, l = t(r) ? Array(r.length) : [];
    return e(r, function(c, d, h) {
      l[++o] = a(c, d, h);
    }), l;
  }
  return Jw = n, Jw;
}
var e_, AN;
function PR() {
  if (AN) return e_;
  AN = 1;
  var e = gv(), t = uu(), n = LR(), r = Ir();
  function a(o, l) {
    var c = r(o) ? e : n;
    return c(o, t(l, 3));
  }
  return e_ = a, e_;
}
var t_, MN;
function DJ() {
  if (MN) return t_;
  MN = 1;
  function e(t, n, r, a) {
    var o = -1, l = t == null ? 0 : t.length;
    for (a && l && (r = t[++o]); ++o < l; )
      r = n(r, t[o], o, t);
    return r;
  }
  return t_ = e, t_;
}
var n_, RN;
function IJ() {
  if (RN) return n_;
  RN = 1;
  function e(t, n, r, a, o) {
    return o(t, function(l, c, d) {
      r = a ? (a = !1, l) : n(r, l, c, d);
    }), r;
  }
  return n_ = e, n_;
}
var r_, ON;
function qR() {
  if (ON) return r_;
  ON = 1;
  var e = DJ(), t = pv(), n = uu(), r = IJ(), a = Ir();
  function o(l, c, d) {
    var h = a(l) ? e : r, p = arguments.length < 3;
    return h(l, n(c, 4), d, p, t);
  }
  return r_ = o, r_;
}
var i_, zN;
function LJ() {
  if (zN) return i_;
  zN = 1;
  var e = ud(), t = Ir(), n = xl(), r = "[object String]";
  function a(o) {
    return typeof o == "string" || !t(o) && n(o) && e(o) == r;
  }
  return i_ = a, i_;
}
var a_, DN;
function PJ() {
  if (DN) return a_;
  DN = 1;
  var e = OR(), t = e("length");
  return a_ = t, a_;
}
var s_, IN;
function qJ() {
  if (IN) return s_;
  IN = 1;
  var e = "\\ud800-\\udfff", t = "\\u0300-\\u036f", n = "\\ufe20-\\ufe2f", r = "\\u20d0-\\u20ff", a = t + n + r, o = "\\ufe0e\\ufe0f", l = "\\u200d", c = RegExp("[" + l + e + a + o + "]");
  function d(h) {
    return c.test(h);
  }
  return s_ = d, s_;
}
var o_, LN;
function BJ() {
  if (LN) return o_;
  LN = 1;
  var e = "\\ud800-\\udfff", t = "\\u0300-\\u036f", n = "\\ufe20-\\ufe2f", r = "\\u20d0-\\u20ff", a = t + n + r, o = "\\ufe0e\\ufe0f", l = "[" + e + "]", c = "[" + a + "]", d = "\\ud83c[\\udffb-\\udfff]", h = "(?:" + c + "|" + d + ")", p = "[^" + e + "]", g = "(?:\\ud83c[\\udde6-\\uddff]){2}", x = "[\\ud800-\\udbff][\\udc00-\\udfff]", b = "\\u200d", C = h + "?", N = "[" + o + "]?", T = "(?:" + b + "(?:" + [p, g, x].join("|") + ")" + N + C + ")*", j = N + C + T, R = "(?:" + [p + c + "?", c, g, x, l].join("|") + ")", A = RegExp(d + "(?=" + d + ")|" + R + j, "g");
  function z(q) {
    for (var D = A.lastIndex = 0; A.test(q); )
      ++D;
    return D;
  }
  return o_ = z, o_;
}
var l_, PN;
function FJ() {
  if (PN) return l_;
  PN = 1;
  var e = PJ(), t = qJ(), n = BJ();
  function r(a) {
    return t(a) ? n(a) : e(a);
  }
  return l_ = r, l_;
}
var u_, qN;
function UJ() {
  if (qN) return u_;
  qN = 1;
  var e = b5(), t = om(), n = lu(), r = LJ(), a = FJ(), o = "[object Map]", l = "[object Set]";
  function c(d) {
    if (d == null)
      return 0;
    if (n(d))
      return r(d) ? a(d) : d.length;
    var h = t(d);
    return h == o || h == l ? d.size : e(d).length;
  }
  return u_ = c, u_;
}
var c_, BN;
function $J() {
  if (BN) return c_;
  BN = 1;
  var e = y5(), t = vR(), n = k5(), r = uu(), a = mv(), o = Ir(), l = sm(), c = Bg(), d = ks(), h = $g();
  function p(g, x, b) {
    var C = o(g), N = C || l(g) || h(g);
    if (x = r(x, 4), b == null) {
      var T = g && g.constructor;
      N ? b = C ? new T() : [] : d(g) ? b = c(T) ? t(a(g)) : {} : b = {};
    }
    return (N ? e : n)(g, function(j, R, A) {
      return x(b, j, R, A);
    }), b;
  }
  return c_ = p, c_;
}
var f_, FN;
function HJ() {
  if (FN) return f_;
  FN = 1;
  var e = am(), t = Ug(), n = Ir(), r = e ? e.isConcatSpreadable : void 0;
  function a(o) {
    return n(o) || t(o) || !!(r && o && o[r]);
  }
  return f_ = a, f_;
}
var d_, UN;
function T5() {
  if (UN) return d_;
  UN = 1;
  var e = _5(), t = HJ();
  function n(r, a, o, l, c) {
    var d = -1, h = r.length;
    for (o || (o = t), c || (c = []); ++d < h; ) {
      var p = r[d];
      a > 0 && o(p) ? a > 1 ? n(p, a - 1, o, l, c) : e(c, p) : l || (c[c.length] = p);
    }
    return c;
  }
  return d_ = n, d_;
}
var h_, $N;
function GJ() {
  if ($N) return h_;
  $N = 1;
  function e(t, n, r) {
    switch (r.length) {
      case 0:
        return t.call(n);
      case 1:
        return t.call(n, r[0]);
      case 2:
        return t.call(n, r[0], r[1]);
      case 3:
        return t.call(n, r[0], r[1], r[2]);
    }
    return t.apply(n, r);
  }
  return h_ = e, h_;
}
var m_, HN;
function BR() {
  if (HN) return m_;
  HN = 1;
  var e = GJ(), t = Math.max;
  function n(r, a, o) {
    return a = t(a === void 0 ? r.length - 1 : a, 0), function() {
      for (var l = arguments, c = -1, d = t(l.length - a, 0), h = Array(d); ++c < d; )
        h[c] = l[a + c];
      c = -1;
      for (var p = Array(a + 1); ++c < a; )
        p[c] = l[c];
      return p[a] = o(h), e(r, this, p);
    };
  }
  return m_ = n, m_;
}
var p_, GN;
function VJ() {
  if (GN) return p_;
  GN = 1;
  var e = C5(), t = aR(), n = dd(), r = t ? function(a, o) {
    return t(a, "toString", {
      configurable: !0,
      enumerable: !1,
      value: e(o),
      writable: !0
    });
  } : n;
  return p_ = r, p_;
}
var g_, VN;
function KJ() {
  if (VN) return g_;
  VN = 1;
  var e = 800, t = 16, n = Date.now;
  function r(a) {
    var o = 0, l = 0;
    return function() {
      var c = n(), d = t - (c - l);
      if (l = c, d > 0) {
        if (++o >= e)
          return arguments[0];
      } else
        o = 0;
      return a.apply(void 0, arguments);
    };
  }
  return g_ = r, g_;
}
var y_, KN;
function FR() {
  if (KN) return y_;
  KN = 1;
  var e = VJ(), t = KJ(), n = t(e);
  return y_ = n, y_;
}
var v_, YN;
function xv() {
  if (YN) return v_;
  YN = 1;
  var e = dd(), t = BR(), n = FR();
  function r(a, o) {
    return n(t(a, o, e), a + "");
  }
  return v_ = r, v_;
}
var x_, WN;
function UR() {
  if (WN) return x_;
  WN = 1;
  function e(t, n, r, a) {
    for (var o = t.length, l = r + (a ? 1 : -1); a ? l-- : ++l < o; )
      if (n(t[l], l, t))
        return l;
    return -1;
  }
  return x_ = e, x_;
}
var b_, XN;
function YJ() {
  if (XN) return b_;
  XN = 1;
  function e(t) {
    return t !== t;
  }
  return b_ = e, b_;
}
var w_, QN;
function WJ() {
  if (QN) return w_;
  QN = 1;
  function e(t, n, r) {
    for (var a = r - 1, o = t.length; ++a < o; )
      if (t[a] === n)
        return a;
    return -1;
  }
  return w_ = e, w_;
}
var __, ZN;
function XJ() {
  if (ZN) return __;
  ZN = 1;
  var e = UR(), t = YJ(), n = WJ();
  function r(a, o, l) {
    return o === o ? n(a, o, l) : e(a, t, l);
  }
  return __ = r, __;
}
var S_, JN;
function QJ() {
  if (JN) return S_;
  JN = 1;
  var e = XJ();
  function t(n, r) {
    var a = n == null ? 0 : n.length;
    return !!a && e(n, r, 0) > -1;
  }
  return S_ = t, S_;
}
var C_, ej;
function ZJ() {
  if (ej) return C_;
  ej = 1;
  function e(t, n, r) {
    for (var a = -1, o = t == null ? 0 : t.length; ++a < o; )
      if (r(n, t[a]))
        return !0;
    return !1;
  }
  return C_ = e, C_;
}
var E_, tj;
function JJ() {
  if (tj) return E_;
  tj = 1;
  function e() {
  }
  return E_ = e, E_;
}
var k_, nj;
function eee() {
  if (nj) return k_;
  nj = 1;
  var e = pR(), t = JJ(), n = N5(), r = 1 / 0, a = e && 1 / n(new e([, -0]))[1] == r ? function(o) {
    return new e(o);
  } : t;
  return k_ = a, k_;
}
var N_, rj;
function tee() {
  if (rj) return N_;
  rj = 1;
  var e = CR(), t = QJ(), n = ZJ(), r = ER(), a = eee(), o = N5(), l = 200;
  function c(d, h, p) {
    var g = -1, x = t, b = d.length, C = !0, N = [], T = N;
    if (p)
      C = !1, x = n;
    else if (b >= l) {
      var j = h ? null : a(d);
      if (j)
        return o(j);
      C = !1, x = r, T = new e();
    } else
      T = h ? [] : N;
    e:
      for (; ++g < b; ) {
        var R = d[g], A = h ? h(R) : R;
        if (R = p || R !== 0 ? R : 0, C && A === A) {
          for (var z = T.length; z--; )
            if (T[z] === A)
              continue e;
          h && T.push(A), N.push(R);
        } else x(T, A, p) || (T !== N && T.push(A), N.push(R));
      }
    return N;
  }
  return N_ = c, N_;
}
var j_, ij;
function $R() {
  if (ij) return j_;
  ij = 1;
  var e = lu(), t = xl();
  function n(r) {
    return t(r) && e(r);
  }
  return j_ = n, j_;
}
var T_, aj;
function nee() {
  if (aj) return T_;
  aj = 1;
  var e = T5(), t = xv(), n = tee(), r = $R(), a = t(function(o) {
    return n(e(o, 1, r, !0));
  });
  return T_ = a, T_;
}
var A_, sj;
function ree() {
  if (sj) return A_;
  sj = 1;
  var e = gv();
  function t(n, r) {
    return e(r, function(a) {
      return n[a];
    });
  }
  return A_ = t, A_;
}
var M_, oj;
function HR() {
  if (oj) return M_;
  oj = 1;
  var e = ree(), t = _c();
  function n(r) {
    return r == null ? [] : e(r, t(r));
  }
  return M_ = n, M_;
}
var R_, lj;
function Ns() {
  if (lj) return R_;
  lj = 1;
  var e;
  if (typeof m5 == "function")
    try {
      e = {
        clone: cJ(),
        constant: C5(),
        each: SR(),
        filter: zR(),
        has: DR(),
        isArray: Ir(),
        isEmpty: zJ(),
        isFunction: Bg(),
        isUndefined: IR(),
        keys: _c(),
        map: PR(),
        reduce: qR(),
        size: UJ(),
        transform: $J(),
        union: nee(),
        values: HR()
      };
    } catch {
    }
  return e || (e = window._), R_ = e, R_;
}
var O_, uj;
function A5() {
  if (uj) return O_;
  uj = 1;
  var e = Ns();
  O_ = a;
  var t = "\0", n = "\0", r = "";
  function a(p) {
    this._isDirected = e.has(p, "directed") ? p.directed : !0, this._isMultigraph = e.has(p, "multigraph") ? p.multigraph : !1, this._isCompound = e.has(p, "compound") ? p.compound : !1, this._label = void 0, this._defaultNodeLabelFn = e.constant(void 0), this._defaultEdgeLabelFn = e.constant(void 0), this._nodes = {}, this._isCompound && (this._parent = {}, this._children = {}, this._children[n] = {}), this._in = {}, this._preds = {}, this._out = {}, this._sucs = {}, this._edgeObjs = {}, this._edgeLabels = {};
  }
  a.prototype._nodeCount = 0, a.prototype._edgeCount = 0, a.prototype.isDirected = function() {
    return this._isDirected;
  }, a.prototype.isMultigraph = function() {
    return this._isMultigraph;
  }, a.prototype.isCompound = function() {
    return this._isCompound;
  }, a.prototype.setGraph = function(p) {
    return this._label = p, this;
  }, a.prototype.graph = function() {
    return this._label;
  }, a.prototype.setDefaultNodeLabel = function(p) {
    return e.isFunction(p) || (p = e.constant(p)), this._defaultNodeLabelFn = p, this;
  }, a.prototype.nodeCount = function() {
    return this._nodeCount;
  }, a.prototype.nodes = function() {
    return e.keys(this._nodes);
  }, a.prototype.sources = function() {
    var p = this;
    return e.filter(this.nodes(), function(g) {
      return e.isEmpty(p._in[g]);
    });
  }, a.prototype.sinks = function() {
    var p = this;
    return e.filter(this.nodes(), function(g) {
      return e.isEmpty(p._out[g]);
    });
  }, a.prototype.setNodes = function(p, g) {
    var x = arguments, b = this;
    return e.each(p, function(C) {
      x.length > 1 ? b.setNode(C, g) : b.setNode(C);
    }), this;
  }, a.prototype.setNode = function(p, g) {
    return e.has(this._nodes, p) ? (arguments.length > 1 && (this._nodes[p] = g), this) : (this._nodes[p] = arguments.length > 1 ? g : this._defaultNodeLabelFn(p), this._isCompound && (this._parent[p] = n, this._children[p] = {}, this._children[n][p] = !0), this._in[p] = {}, this._preds[p] = {}, this._out[p] = {}, this._sucs[p] = {}, ++this._nodeCount, this);
  }, a.prototype.node = function(p) {
    return this._nodes[p];
  }, a.prototype.hasNode = function(p) {
    return e.has(this._nodes, p);
  }, a.prototype.removeNode = function(p) {
    var g = this;
    if (e.has(this._nodes, p)) {
      var x = function(b) {
        g.removeEdge(g._edgeObjs[b]);
      };
      delete this._nodes[p], this._isCompound && (this._removeFromParentsChildList(p), delete this._parent[p], e.each(this.children(p), function(b) {
        g.setParent(b);
      }), delete this._children[p]), e.each(e.keys(this._in[p]), x), delete this._in[p], delete this._preds[p], e.each(e.keys(this._out[p]), x), delete this._out[p], delete this._sucs[p], --this._nodeCount;
    }
    return this;
  }, a.prototype.setParent = function(p, g) {
    if (!this._isCompound)
      throw new Error("Cannot set parent in a non-compound graph");
    if (e.isUndefined(g))
      g = n;
    else {
      g += "";
      for (var x = g; !e.isUndefined(x); x = this.parent(x))
        if (x === p)
          throw new Error("Setting " + g + " as parent of " + p + " would create a cycle");
      this.setNode(g);
    }
    return this.setNode(p), this._removeFromParentsChildList(p), this._parent[p] = g, this._children[g][p] = !0, this;
  }, a.prototype._removeFromParentsChildList = function(p) {
    delete this._children[this._parent[p]][p];
  }, a.prototype.parent = function(p) {
    if (this._isCompound) {
      var g = this._parent[p];
      if (g !== n)
        return g;
    }
  }, a.prototype.children = function(p) {
    if (e.isUndefined(p) && (p = n), this._isCompound) {
      var g = this._children[p];
      if (g)
        return e.keys(g);
    } else {
      if (p === n)
        return this.nodes();
      if (this.hasNode(p))
        return [];
    }
  }, a.prototype.predecessors = function(p) {
    var g = this._preds[p];
    if (g)
      return e.keys(g);
  }, a.prototype.successors = function(p) {
    var g = this._sucs[p];
    if (g)
      return e.keys(g);
  }, a.prototype.neighbors = function(p) {
    var g = this.predecessors(p);
    if (g)
      return e.union(g, this.successors(p));
  }, a.prototype.isLeaf = function(p) {
    var g;
    return this.isDirected() ? g = this.successors(p) : g = this.neighbors(p), g.length === 0;
  }, a.prototype.filterNodes = function(p) {
    var g = new this.constructor({
      directed: this._isDirected,
      multigraph: this._isMultigraph,
      compound: this._isCompound
    });
    g.setGraph(this.graph());
    var x = this;
    e.each(this._nodes, function(N, T) {
      p(T) && g.setNode(T, N);
    }), e.each(this._edgeObjs, function(N) {
      g.hasNode(N.v) && g.hasNode(N.w) && g.setEdge(N, x.edge(N));
    });
    var b = {};
    function C(N) {
      var T = x.parent(N);
      return T === void 0 || g.hasNode(T) ? (b[N] = T, T) : T in b ? b[T] : C(T);
    }
    return this._isCompound && e.each(g.nodes(), function(N) {
      g.setParent(N, C(N));
    }), g;
  }, a.prototype.setDefaultEdgeLabel = function(p) {
    return e.isFunction(p) || (p = e.constant(p)), this._defaultEdgeLabelFn = p, this;
  }, a.prototype.edgeCount = function() {
    return this._edgeCount;
  }, a.prototype.edges = function() {
    return e.values(this._edgeObjs);
  }, a.prototype.setPath = function(p, g) {
    var x = this, b = arguments;
    return e.reduce(p, function(C, N) {
      return b.length > 1 ? x.setEdge(C, N, g) : x.setEdge(C, N), N;
    }), this;
  }, a.prototype.setEdge = function() {
    var p, g, x, b, C = !1, N = arguments[0];
    typeof N == "object" && N !== null && "v" in N ? (p = N.v, g = N.w, x = N.name, arguments.length === 2 && (b = arguments[1], C = !0)) : (p = N, g = arguments[1], x = arguments[3], arguments.length > 2 && (b = arguments[2], C = !0)), p = "" + p, g = "" + g, e.isUndefined(x) || (x = "" + x);
    var T = c(this._isDirected, p, g, x);
    if (e.has(this._edgeLabels, T))
      return C && (this._edgeLabels[T] = b), this;
    if (!e.isUndefined(x) && !this._isMultigraph)
      throw new Error("Cannot set a named edge when isMultigraph = false");
    this.setNode(p), this.setNode(g), this._edgeLabels[T] = C ? b : this._defaultEdgeLabelFn(p, g, x);
    var j = d(this._isDirected, p, g, x);
    return p = j.v, g = j.w, Object.freeze(j), this._edgeObjs[T] = j, o(this._preds[g], p), o(this._sucs[p], g), this._in[g][T] = j, this._out[p][T] = j, this._edgeCount++, this;
  }, a.prototype.edge = function(p, g, x) {
    var b = arguments.length === 1 ? h(this._isDirected, arguments[0]) : c(this._isDirected, p, g, x);
    return this._edgeLabels[b];
  }, a.prototype.hasEdge = function(p, g, x) {
    var b = arguments.length === 1 ? h(this._isDirected, arguments[0]) : c(this._isDirected, p, g, x);
    return e.has(this._edgeLabels, b);
  }, a.prototype.removeEdge = function(p, g, x) {
    var b = arguments.length === 1 ? h(this._isDirected, arguments[0]) : c(this._isDirected, p, g, x), C = this._edgeObjs[b];
    return C && (p = C.v, g = C.w, delete this._edgeLabels[b], delete this._edgeObjs[b], l(this._preds[g], p), l(this._sucs[p], g), delete this._in[g][b], delete this._out[p][b], this._edgeCount--), this;
  }, a.prototype.inEdges = function(p, g) {
    var x = this._in[p];
    if (x) {
      var b = e.values(x);
      return g ? e.filter(b, function(C) {
        return C.v === g;
      }) : b;
    }
  }, a.prototype.outEdges = function(p, g) {
    var x = this._out[p];
    if (x) {
      var b = e.values(x);
      return g ? e.filter(b, function(C) {
        return C.w === g;
      }) : b;
    }
  }, a.prototype.nodeEdges = function(p, g) {
    var x = this.inEdges(p, g);
    if (x)
      return x.concat(this.outEdges(p, g));
  };
  function o(p, g) {
    p[g] ? p[g]++ : p[g] = 1;
  }
  function l(p, g) {
    --p[g] || delete p[g];
  }
  function c(p, g, x, b) {
    var C = "" + g, N = "" + x;
    if (!p && C > N) {
      var T = C;
      C = N, N = T;
    }
    return C + r + N + r + (e.isUndefined(b) ? t : b);
  }
  function d(p, g, x, b) {
    var C = "" + g, N = "" + x;
    if (!p && C > N) {
      var T = C;
      C = N, N = T;
    }
    var j = { v: C, w: N };
    return b && (j.name = b), j;
  }
  function h(p, g) {
    return c(p, g.v, g.w, g.name);
  }
  return O_;
}
var z_, cj;
function iee() {
  return cj || (cj = 1, z_ = "2.1.8"), z_;
}
var D_, fj;
function aee() {
  return fj || (fj = 1, D_ = {
    Graph: A5(),
    version: iee()
  }), D_;
}
var I_, dj;
function see() {
  if (dj) return I_;
  dj = 1;
  var e = Ns(), t = A5();
  I_ = {
    write: n,
    read: o
  };
  function n(l) {
    var c = {
      options: {
        directed: l.isDirected(),
        multigraph: l.isMultigraph(),
        compound: l.isCompound()
      },
      nodes: r(l),
      edges: a(l)
    };
    return e.isUndefined(l.graph()) || (c.value = e.clone(l.graph())), c;
  }
  function r(l) {
    return e.map(l.nodes(), function(c) {
      var d = l.node(c), h = l.parent(c), p = { v: c };
      return e.isUndefined(d) || (p.value = d), e.isUndefined(h) || (p.parent = h), p;
    });
  }
  function a(l) {
    return e.map(l.edges(), function(c) {
      var d = l.edge(c), h = { v: c.v, w: c.w };
      return e.isUndefined(c.name) || (h.name = c.name), e.isUndefined(d) || (h.value = d), h;
    });
  }
  function o(l) {
    var c = new t(l.options).setGraph(l.value);
    return e.each(l.nodes, function(d) {
      c.setNode(d.v, d.value), d.parent && c.setParent(d.v, d.parent);
    }), e.each(l.edges, function(d) {
      c.setEdge({ v: d.v, w: d.w, name: d.name }, d.value);
    }), c;
  }
  return I_;
}
var L_, hj;
function oee() {
  if (hj) return L_;
  hj = 1;
  var e = Ns();
  L_ = t;
  function t(n) {
    var r = {}, a = [], o;
    function l(c) {
      e.has(r, c) || (r[c] = !0, o.push(c), e.each(n.successors(c), l), e.each(n.predecessors(c), l));
    }
    return e.each(n.nodes(), function(c) {
      o = [], l(c), o.length && a.push(o);
    }), a;
  }
  return L_;
}
var P_, mj;
function GR() {
  if (mj) return P_;
  mj = 1;
  var e = Ns();
  P_ = t;
  function t() {
    this._arr = [], this._keyIndices = {};
  }
  return t.prototype.size = function() {
    return this._arr.length;
  }, t.prototype.keys = function() {
    return this._arr.map(function(n) {
      return n.key;
    });
  }, t.prototype.has = function(n) {
    return e.has(this._keyIndices, n);
  }, t.prototype.priority = function(n) {
    var r = this._keyIndices[n];
    if (r !== void 0)
      return this._arr[r].priority;
  }, t.prototype.min = function() {
    if (this.size() === 0)
      throw new Error("Queue underflow");
    return this._arr[0].key;
  }, t.prototype.add = function(n, r) {
    var a = this._keyIndices;
    if (n = String(n), !e.has(a, n)) {
      var o = this._arr, l = o.length;
      return a[n] = l, o.push({ key: n, priority: r }), this._decrease(l), !0;
    }
    return !1;
  }, t.prototype.removeMin = function() {
    this._swap(0, this._arr.length - 1);
    var n = this._arr.pop();
    return delete this._keyIndices[n.key], this._heapify(0), n.key;
  }, t.prototype.decrease = function(n, r) {
    var a = this._keyIndices[n];
    if (r > this._arr[a].priority)
      throw new Error("New priority is greater than current priority. Key: " + n + " Old: " + this._arr[a].priority + " New: " + r);
    this._arr[a].priority = r, this._decrease(a);
  }, t.prototype._heapify = function(n) {
    var r = this._arr, a = 2 * n, o = a + 1, l = n;
    a < r.length && (l = r[a].priority < r[l].priority ? a : l, o < r.length && (l = r[o].priority < r[l].priority ? o : l), l !== n && (this._swap(n, l), this._heapify(l)));
  }, t.prototype._decrease = function(n) {
    for (var r = this._arr, a = r[n].priority, o; n !== 0 && (o = n >> 1, !(r[o].priority < a)); )
      this._swap(n, o), n = o;
  }, t.prototype._swap = function(n, r) {
    var a = this._arr, o = this._keyIndices, l = a[n], c = a[r];
    a[n] = c, a[r] = l, o[c.key] = n, o[l.key] = r;
  }, P_;
}
var q_, pj;
function VR() {
  if (pj) return q_;
  pj = 1;
  var e = Ns(), t = GR();
  q_ = r;
  var n = e.constant(1);
  function r(o, l, c, d) {
    return a(
      o,
      String(l),
      c || n,
      d || function(h) {
        return o.outEdges(h);
      }
    );
  }
  function a(o, l, c, d) {
    var h = {}, p = new t(), g, x, b = function(C) {
      var N = C.v !== g ? C.v : C.w, T = h[N], j = c(C), R = x.distance + j;
      if (j < 0)
        throw new Error("dijkstra does not allow negative edge weights. Bad edge: " + C + " Weight: " + j);
      R < T.distance && (T.distance = R, T.predecessor = g, p.decrease(N, R));
    };
    for (o.nodes().forEach(function(C) {
      var N = C === l ? 0 : Number.POSITIVE_INFINITY;
      h[C] = { distance: N }, p.add(C, N);
    }); p.size() > 0 && (g = p.removeMin(), x = h[g], x.distance !== Number.POSITIVE_INFINITY); )
      d(g).forEach(b);
    return h;
  }
  return q_;
}
var B_, gj;
function lee() {
  if (gj) return B_;
  gj = 1;
  var e = VR(), t = Ns();
  B_ = n;
  function n(r, a, o) {
    return t.transform(r.nodes(), function(l, c) {
      l[c] = e(r, c, a, o);
    }, {});
  }
  return B_;
}
var F_, yj;
function KR() {
  if (yj) return F_;
  yj = 1;
  var e = Ns();
  F_ = t;
  function t(n) {
    var r = 0, a = [], o = {}, l = [];
    function c(d) {
      var h = o[d] = {
        onStack: !0,
        lowlink: r,
        index: r++
      };
      if (a.push(d), n.successors(d).forEach(function(x) {
        e.has(o, x) ? o[x].onStack && (h.lowlink = Math.min(h.lowlink, o[x].index)) : (c(x), h.lowlink = Math.min(h.lowlink, o[x].lowlink));
      }), h.lowlink === h.index) {
        var p = [], g;
        do
          g = a.pop(), o[g].onStack = !1, p.push(g);
        while (d !== g);
        l.push(p);
      }
    }
    return n.nodes().forEach(function(d) {
      e.has(o, d) || c(d);
    }), l;
  }
  return F_;
}
var U_, vj;
function uee() {
  if (vj) return U_;
  vj = 1;
  var e = Ns(), t = KR();
  U_ = n;
  function n(r) {
    return e.filter(t(r), function(a) {
      return a.length > 1 || a.length === 1 && r.hasEdge(a[0], a[0]);
    });
  }
  return U_;
}
var $_, xj;
function cee() {
  if (xj) return $_;
  xj = 1;
  var e = Ns();
  $_ = n;
  var t = e.constant(1);
  function n(a, o, l) {
    return r(
      a,
      o || t,
      l || function(c) {
        return a.outEdges(c);
      }
    );
  }
  function r(a, o, l) {
    var c = {}, d = a.nodes();
    return d.forEach(function(h) {
      c[h] = {}, c[h][h] = { distance: 0 }, d.forEach(function(p) {
        h !== p && (c[h][p] = { distance: Number.POSITIVE_INFINITY });
      }), l(h).forEach(function(p) {
        var g = p.v === h ? p.w : p.v, x = o(p);
        c[h][g] = { distance: x, predecessor: h };
      });
    }), d.forEach(function(h) {
      var p = c[h];
      d.forEach(function(g) {
        var x = c[g];
        d.forEach(function(b) {
          var C = x[h], N = p[b], T = x[b], j = C.distance + N.distance;
          j < T.distance && (T.distance = j, T.predecessor = N.predecessor);
        });
      });
    }), c;
  }
  return $_;
}
var H_, bj;
function YR() {
  if (bj) return H_;
  bj = 1;
  var e = Ns();
  H_ = t, t.CycleException = n;
  function t(r) {
    var a = {}, o = {}, l = [];
    function c(d) {
      if (e.has(o, d))
        throw new n();
      e.has(a, d) || (o[d] = !0, a[d] = !0, e.each(r.predecessors(d), c), delete o[d], l.push(d));
    }
    if (e.each(r.sinks(), c), e.size(a) !== r.nodeCount())
      throw new n();
    return l;
  }
  function n() {
  }
  return n.prototype = new Error(), H_;
}
var G_, wj;
function fee() {
  if (wj) return G_;
  wj = 1;
  var e = YR();
  G_ = t;
  function t(n) {
    try {
      e(n);
    } catch (r) {
      if (r instanceof e.CycleException)
        return !1;
      throw r;
    }
    return !0;
  }
  return G_;
}
var V_, _j;
function WR() {
  if (_j) return V_;
  _j = 1;
  var e = Ns();
  V_ = t;
  function t(r, a, o) {
    e.isArray(a) || (a = [a]);
    var l = (r.isDirected() ? r.successors : r.neighbors).bind(r), c = [], d = {};
    return e.each(a, function(h) {
      if (!r.hasNode(h))
        throw new Error("Graph does not have node: " + h);
      n(r, h, o === "post", d, l, c);
    }), c;
  }
  function n(r, a, o, l, c, d) {
    e.has(l, a) || (l[a] = !0, o || d.push(a), e.each(c(a), function(h) {
      n(r, h, o, l, c, d);
    }), o && d.push(a));
  }
  return V_;
}
var K_, Sj;
function dee() {
  if (Sj) return K_;
  Sj = 1;
  var e = WR();
  K_ = t;
  function t(n, r) {
    return e(n, r, "post");
  }
  return K_;
}
var Y_, Cj;
function hee() {
  if (Cj) return Y_;
  Cj = 1;
  var e = WR();
  Y_ = t;
  function t(n, r) {
    return e(n, r, "pre");
  }
  return Y_;
}
var W_, Ej;
function mee() {
  if (Ej) return W_;
  Ej = 1;
  var e = Ns(), t = A5(), n = GR();
  W_ = r;
  function r(a, o) {
    var l = new t(), c = {}, d = new n(), h;
    function p(x) {
      var b = x.v === h ? x.w : x.v, C = d.priority(b);
      if (C !== void 0) {
        var N = o(x);
        N < C && (c[b] = h, d.decrease(b, N));
      }
    }
    if (a.nodeCount() === 0)
      return l;
    e.each(a.nodes(), function(x) {
      d.add(x, Number.POSITIVE_INFINITY), l.setNode(x);
    }), d.decrease(a.nodes()[0], 0);
    for (var g = !1; d.size() > 0; ) {
      if (h = d.removeMin(), e.has(c, h))
        l.setEdge(h, c[h]);
      else {
        if (g)
          throw new Error("Input graph is not connected: " + a);
        g = !0;
      }
      a.nodeEdges(h).forEach(p);
    }
    return l;
  }
  return W_;
}
var X_, kj;
function pee() {
  return kj || (kj = 1, X_ = {
    components: oee(),
    dijkstra: VR(),
    dijkstraAll: lee(),
    findCycles: uee(),
    floydWarshall: cee(),
    isAcyclic: fee(),
    postorder: dee(),
    preorder: hee(),
    prim: mee(),
    tarjan: KR(),
    topsort: YR()
  }), X_;
}
var Q_, Nj;
function gee() {
  if (Nj) return Q_;
  Nj = 1;
  var e = aee();
  return Q_ = {
    Graph: e.Graph,
    json: see(),
    alg: pee(),
    version: e.version
  }, Q_;
}
var Z_, jj;
function go() {
  if (jj) return Z_;
  jj = 1;
  var e;
  if (typeof m5 == "function")
    try {
      e = gee();
    } catch {
    }
  return e || (e = window.graphlib), Z_ = e, Z_;
}
var J_, Tj;
function yee() {
  if (Tj) return J_;
  Tj = 1;
  var e = bR(), t = 1, n = 4;
  function r(a) {
    return e(a, t | n);
  }
  return J_ = r, J_;
}
var e4, Aj;
function bv() {
  if (Aj) return e4;
  Aj = 1;
  var e = im(), t = lu(), n = fv(), r = ks();
  function a(o, l, c) {
    if (!r(c))
      return !1;
    var d = typeof l;
    return (d == "number" ? t(c) && n(l, c.length) : d == "string" && l in c) ? e(c[l], o) : !1;
  }
  return e4 = a, e4;
}
var t4, Mj;
function vee() {
  if (Mj) return t4;
  Mj = 1;
  var e = xv(), t = im(), n = bv(), r = fd(), a = Object.prototype, o = a.hasOwnProperty, l = e(function(c, d) {
    c = Object(c);
    var h = -1, p = d.length, g = p > 2 ? d[2] : void 0;
    for (g && n(d[0], d[1], g) && (p = 1); ++h < p; )
      for (var x = d[h], b = r(x), C = -1, N = b.length; ++C < N; ) {
        var T = b[C], j = c[T];
        (j === void 0 || t(j, a[T]) && !o.call(c, T)) && (c[T] = x[T]);
      }
    return c;
  });
  return t4 = l, t4;
}
var n4, Rj;
function xee() {
  if (Rj) return n4;
  Rj = 1;
  var e = uu(), t = lu(), n = _c();
  function r(a) {
    return function(o, l, c) {
      var d = Object(o);
      if (!t(o)) {
        var h = e(l, 3);
        o = n(o), l = function(g) {
          return h(d[g], g, d);
        };
      }
      var p = a(o, l, c);
      return p > -1 ? d[h ? o[p] : p] : void 0;
    };
  }
  return n4 = r, n4;
}
var r4, Oj;
function bee() {
  if (Oj) return r4;
  Oj = 1;
  var e = /\s/;
  function t(n) {
    for (var r = n.length; r-- && e.test(n.charAt(r)); )
      ;
    return r;
  }
  return r4 = t, r4;
}
var i4, zj;
function wee() {
  if (zj) return i4;
  zj = 1;
  var e = bee(), t = /^\s+/;
  function n(r) {
    return r && r.slice(0, e(r) + 1).replace(t, "");
  }
  return i4 = n, i4;
}
var a4, Dj;
function _ee() {
  if (Dj) return a4;
  Dj = 1;
  var e = wee(), t = ks(), n = lm(), r = NaN, a = /^[-+]0x[0-9a-f]+$/i, o = /^0b[01]+$/i, l = /^0o[0-7]+$/i, c = parseInt;
  function d(h) {
    if (typeof h == "number")
      return h;
    if (n(h))
      return r;
    if (t(h)) {
      var p = typeof h.valueOf == "function" ? h.valueOf() : h;
      h = t(p) ? p + "" : p;
    }
    if (typeof h != "string")
      return h === 0 ? h : +h;
    h = e(h);
    var g = o.test(h);
    return g || l.test(h) ? c(h.slice(2), g ? 2 : 8) : a.test(h) ? r : +h;
  }
  return a4 = d, a4;
}
var s4, Ij;
function XR() {
  if (Ij) return s4;
  Ij = 1;
  var e = _ee(), t = 1 / 0, n = 17976931348623157e292;
  function r(a) {
    if (!a)
      return a === 0 ? a : 0;
    if (a = e(a), a === t || a === -t) {
      var o = a < 0 ? -1 : 1;
      return o * n;
    }
    return a === a ? a : 0;
  }
  return s4 = r, s4;
}
var o4, Lj;
function See() {
  if (Lj) return o4;
  Lj = 1;
  var e = XR();
  function t(n) {
    var r = e(n), a = r % 1;
    return r === r ? a ? r - a : r : 0;
  }
  return o4 = t, o4;
}
var l4, Pj;
function Cee() {
  if (Pj) return l4;
  Pj = 1;
  var e = UR(), t = uu(), n = See(), r = Math.max;
  function a(o, l, c) {
    var d = o == null ? 0 : o.length;
    if (!d)
      return -1;
    var h = c == null ? 0 : n(c);
    return h < 0 && (h = r(d + h, 0)), e(o, t(l, 3), h);
  }
  return l4 = a, l4;
}
var u4, qj;
function Eee() {
  if (qj) return u4;
  qj = 1;
  var e = xee(), t = Cee(), n = e(t);
  return u4 = n, u4;
}
var c4, Bj;
function QR() {
  if (Bj) return c4;
  Bj = 1;
  var e = T5();
  function t(n) {
    var r = n == null ? 0 : n.length;
    return r ? e(n, 1) : [];
  }
  return c4 = t, c4;
}
var f4, Fj;
function kee() {
  if (Fj) return f4;
  Fj = 1;
  var e = E5(), t = wR(), n = fd();
  function r(a, o) {
    return a == null ? a : e(a, t(o), n);
  }
  return f4 = r, f4;
}
var d4, Uj;
function Nee() {
  if (Uj) return d4;
  Uj = 1;
  function e(t) {
    var n = t == null ? 0 : t.length;
    return n ? t[n - 1] : void 0;
  }
  return d4 = e, d4;
}
var h4, $j;
function jee() {
  if ($j) return h4;
  $j = 1;
  var e = uv(), t = k5(), n = uu();
  function r(a, o) {
    var l = {};
    return o = n(o, 3), t(a, function(c, d, h) {
      e(l, d, o(c, d, h));
    }), l;
  }
  return h4 = r, h4;
}
var m4, Hj;
function M5() {
  if (Hj) return m4;
  Hj = 1;
  var e = lm();
  function t(n, r, a) {
    for (var o = -1, l = n.length; ++o < l; ) {
      var c = n[o], d = r(c);
      if (d != null && (h === void 0 ? d === d && !e(d) : a(d, h)))
        var h = d, p = c;
    }
    return p;
  }
  return m4 = t, m4;
}
var p4, Gj;
function Tee() {
  if (Gj) return p4;
  Gj = 1;
  function e(t, n) {
    return t > n;
  }
  return p4 = e, p4;
}
var g4, Vj;
function Aee() {
  if (Vj) return g4;
  Vj = 1;
  var e = M5(), t = Tee(), n = dd();
  function r(a) {
    return a && a.length ? e(a, n, t) : void 0;
  }
  return g4 = r, g4;
}
var y4, Kj;
function ZR() {
  if (Kj) return y4;
  Kj = 1;
  var e = uv(), t = im();
  function n(r, a, o) {
    (o !== void 0 && !t(r[a], o) || o === void 0 && !(a in r)) && e(r, a, o);
  }
  return y4 = n, y4;
}
var v4, Yj;
function Mee() {
  if (Yj) return v4;
  Yj = 1;
  var e = ud(), t = mv(), n = xl(), r = "[object Object]", a = Function.prototype, o = Object.prototype, l = a.toString, c = o.hasOwnProperty, d = l.call(Object);
  function h(p) {
    if (!n(p) || e(p) != r)
      return !1;
    var g = t(p);
    if (g === null)
      return !0;
    var x = c.call(g, "constructor") && g.constructor;
    return typeof x == "function" && x instanceof x && l.call(x) == d;
  }
  return v4 = h, v4;
}
var x4, Wj;
function JR() {
  if (Wj) return x4;
  Wj = 1;
  function e(t, n) {
    if (!(n === "constructor" && typeof t[n] == "function") && n != "__proto__")
      return t[n];
  }
  return x4 = e, x4;
}
var b4, Xj;
function Ree() {
  if (Xj) return b4;
  Xj = 1;
  var e = Fg(), t = fd();
  function n(r) {
    return e(r, t(r));
  }
  return b4 = n, b4;
}
var w4, Qj;
function Oee() {
  if (Qj) return w4;
  Qj = 1;
  var e = ZR(), t = lR(), n = yR(), r = uR(), a = xR(), o = Ug(), l = Ir(), c = $R(), d = sm(), h = Bg(), p = ks(), g = Mee(), x = $g(), b = JR(), C = Ree();
  function N(T, j, R, A, z, q, D) {
    var P = b(T, R), re = b(j, R), ie = D.get(re);
    if (ie) {
      e(T, R, ie);
      return;
    }
    var X = q ? q(P, re, R + "", T, j, D) : void 0, K = X === void 0;
    if (K) {
      var V = l(re), de = !V && d(re), H = !V && !de && x(re);
      X = re, V || de || H ? l(P) ? X = P : c(P) ? X = r(P) : de ? (K = !1, X = t(re, !0)) : H ? (K = !1, X = n(re, !0)) : X = [] : g(re) || o(re) ? (X = P, o(P) ? X = C(P) : (!p(P) || h(P)) && (X = a(re))) : K = !1;
    }
    K && (D.set(re, X), z(X, re, A, q, D), D.delete(re)), e(T, R, X);
  }
  return w4 = N, w4;
}
var _4, Zj;
function zee() {
  if (Zj) return _4;
  Zj = 1;
  var e = lv(), t = ZR(), n = E5(), r = Oee(), a = ks(), o = fd(), l = JR();
  function c(d, h, p, g, x) {
    d !== h && n(h, function(b, C) {
      if (x || (x = new e()), a(b))
        r(d, h, C, p, c, g, x);
      else {
        var N = g ? g(l(d, C), b, C + "", d, h, x) : void 0;
        N === void 0 && (N = b), t(d, C, N);
      }
    }, o);
  }
  return _4 = c, _4;
}
var S4, Jj;
function Dee() {
  if (Jj) return S4;
  Jj = 1;
  var e = xv(), t = bv();
  function n(r) {
    return e(function(a, o) {
      var l = -1, c = o.length, d = c > 1 ? o[c - 1] : void 0, h = c > 2 ? o[2] : void 0;
      for (d = r.length > 3 && typeof d == "function" ? (c--, d) : void 0, h && t(o[0], o[1], h) && (d = c < 3 ? void 0 : d, c = 1), a = Object(a); ++l < c; ) {
        var p = o[l];
        p && r(a, p, l, d);
      }
      return a;
    });
  }
  return S4 = n, S4;
}
var C4, eT;
function Iee() {
  if (eT) return C4;
  eT = 1;
  var e = zee(), t = Dee(), n = t(function(r, a, o) {
    e(r, a, o);
  });
  return C4 = n, C4;
}
var E4, tT;
function eO() {
  if (tT) return E4;
  tT = 1;
  function e(t, n) {
    return t < n;
  }
  return E4 = e, E4;
}
var k4, nT;
function Lee() {
  if (nT) return k4;
  nT = 1;
  var e = M5(), t = eO(), n = dd();
  function r(a) {
    return a && a.length ? e(a, n, t) : void 0;
  }
  return k4 = r, k4;
}
var N4, rT;
function Pee() {
  if (rT) return N4;
  rT = 1;
  var e = M5(), t = uu(), n = eO();
  function r(a, o) {
    return a && a.length ? e(a, t(o, 2), n) : void 0;
  }
  return N4 = r, N4;
}
var j4, iT;
function qee() {
  if (iT) return j4;
  iT = 1;
  var e = vo(), t = function() {
    return e.Date.now();
  };
  return j4 = t, j4;
}
var T4, aT;
function Bee() {
  if (aT) return T4;
  aT = 1;
  var e = cv(), t = yv(), n = fv(), r = ks(), a = Hg();
  function o(l, c, d, h) {
    if (!r(l))
      return l;
    c = t(c, l);
    for (var p = -1, g = c.length, x = g - 1, b = l; b != null && ++p < g; ) {
      var C = a(c[p]), N = d;
      if (C === "__proto__" || C === "constructor" || C === "prototype")
        return l;
      if (p != x) {
        var T = b[C];
        N = h ? h(T, C, b) : void 0, N === void 0 && (N = r(T) ? T : n(c[p + 1]) ? [] : {});
      }
      e(b, C, N), b = b[C];
    }
    return l;
  }
  return T4 = o, T4;
}
var A4, sT;
function Fee() {
  if (sT) return A4;
  sT = 1;
  var e = vv(), t = Bee(), n = yv();
  function r(a, o, l) {
    for (var c = -1, d = o.length, h = {}; ++c < d; ) {
      var p = o[c], g = e(a, p);
      l(g, p) && t(h, n(p, a), g);
    }
    return h;
  }
  return A4 = r, A4;
}
var M4, oT;
function Uee() {
  if (oT) return M4;
  oT = 1;
  var e = Fee(), t = RR();
  function n(r, a) {
    return e(r, a, function(o, l) {
      return t(r, l);
    });
  }
  return M4 = n, M4;
}
var R4, lT;
function $ee() {
  if (lT) return R4;
  lT = 1;
  var e = QR(), t = BR(), n = FR();
  function r(a) {
    return n(t(a, void 0, e), a + "");
  }
  return R4 = r, R4;
}
var O4, uT;
function Hee() {
  if (uT) return O4;
  uT = 1;
  var e = Uee(), t = $ee(), n = t(function(r, a) {
    return r == null ? {} : e(r, a);
  });
  return O4 = n, O4;
}
var z4, cT;
function Gee() {
  if (cT) return z4;
  cT = 1;
  var e = Math.ceil, t = Math.max;
  function n(r, a, o, l) {
    for (var c = -1, d = t(e((a - r) / (o || 1)), 0), h = Array(d); d--; )
      h[l ? d : ++c] = r, r += o;
    return h;
  }
  return z4 = n, z4;
}
var D4, fT;
function Vee() {
  if (fT) return D4;
  fT = 1;
  var e = Gee(), t = bv(), n = XR();
  function r(a) {
    return function(o, l, c) {
      return c && typeof c != "number" && t(o, l, c) && (l = c = void 0), o = n(o), l === void 0 ? (l = o, o = 0) : l = n(l), c = c === void 0 ? o < l ? 1 : -1 : n(c), e(o, l, c, a);
    };
  }
  return D4 = r, D4;
}
var I4, dT;
function Kee() {
  if (dT) return I4;
  dT = 1;
  var e = Vee(), t = e();
  return I4 = t, I4;
}
var L4, hT;
function Yee() {
  if (hT) return L4;
  hT = 1;
  function e(t, n) {
    var r = t.length;
    for (t.sort(n); r--; )
      t[r] = t[r].value;
    return t;
  }
  return L4 = e, L4;
}
var P4, mT;
function Wee() {
  if (mT) return P4;
  mT = 1;
  var e = lm();
  function t(n, r) {
    if (n !== r) {
      var a = n !== void 0, o = n === null, l = n === n, c = e(n), d = r !== void 0, h = r === null, p = r === r, g = e(r);
      if (!h && !g && !c && n > r || c && d && p && !h && !g || o && d && p || !a && p || !l)
        return 1;
      if (!o && !c && !g && n < r || g && a && l && !o && !c || h && a && l || !d && l || !p)
        return -1;
    }
    return 0;
  }
  return P4 = t, P4;
}
var q4, pT;
function Xee() {
  if (pT) return q4;
  pT = 1;
  var e = Wee();
  function t(n, r, a) {
    for (var o = -1, l = n.criteria, c = r.criteria, d = l.length, h = a.length; ++o < d; ) {
      var p = e(l[o], c[o]);
      if (p) {
        if (o >= h)
          return p;
        var g = a[o];
        return p * (g == "desc" ? -1 : 1);
      }
    }
    return n.index - r.index;
  }
  return q4 = t, q4;
}
var B4, gT;
function Qee() {
  if (gT) return B4;
  gT = 1;
  var e = gv(), t = vv(), n = uu(), r = LR(), a = Yee(), o = dv(), l = Xee(), c = dd(), d = Ir();
  function h(p, g, x) {
    g.length ? g = e(g, function(N) {
      return d(N) ? function(T) {
        return t(T, N.length === 1 ? N[0] : N);
      } : N;
    }) : g = [c];
    var b = -1;
    g = e(g, o(n));
    var C = r(p, function(N, T, j) {
      var R = e(g, function(A) {
        return A(N);
      });
      return { criteria: R, index: ++b, value: N };
    });
    return a(C, function(N, T) {
      return l(N, T, x);
    });
  }
  return B4 = h, B4;
}
var F4, yT;
function Zee() {
  if (yT) return F4;
  yT = 1;
  var e = T5(), t = Qee(), n = xv(), r = bv(), a = n(function(o, l) {
    if (o == null)
      return [];
    var c = l.length;
    return c > 1 && r(o, l[0], l[1]) ? l = [] : c > 2 && r(l[0], l[1], l[2]) && (l = [l[0]]), t(o, e(l, 1), []);
  });
  return F4 = a, F4;
}
var U4, vT;
function Jee() {
  if (vT) return U4;
  vT = 1;
  var e = AR(), t = 0;
  function n(r) {
    var a = ++t;
    return e(r) + a;
  }
  return U4 = n, U4;
}
var $4, xT;
function ete() {
  if (xT) return $4;
  xT = 1;
  function e(t, n, r) {
    for (var a = -1, o = t.length, l = n.length, c = {}; ++a < o; ) {
      var d = a < l ? n[a] : void 0;
      r(c, t[a], d);
    }
    return c;
  }
  return $4 = e, $4;
}
var H4, bT;
function tte() {
  if (bT) return H4;
  bT = 1;
  var e = cv(), t = ete();
  function n(r, a) {
    return t(r || [], a || [], e);
  }
  return H4 = n, H4;
}
var G4, wT;
function or() {
  if (wT) return G4;
  wT = 1;
  var e;
  if (typeof m5 == "function")
    try {
      e = {
        cloneDeep: yee(),
        constant: C5(),
        defaults: vee(),
        each: SR(),
        filter: zR(),
        find: Eee(),
        flatten: QR(),
        forEach: _R(),
        forIn: kee(),
        has: DR(),
        isUndefined: IR(),
        last: Nee(),
        map: PR(),
        mapValues: jee(),
        max: Aee(),
        merge: Iee(),
        min: Lee(),
        minBy: Pee(),
        now: qee(),
        pick: Hee(),
        range: Kee(),
        reduce: qR(),
        sortBy: Zee(),
        uniqueId: Jee(),
        values: HR(),
        zipObject: tte()
      };
    } catch {
    }
  return e || (e = window._), G4 = e, G4;
}
var V4, _T;
function nte() {
  if (_T) return V4;
  _T = 1, V4 = e;
  function e() {
    var r = {};
    r._next = r._prev = r, this._sentinel = r;
  }
  e.prototype.dequeue = function() {
    var r = this._sentinel, a = r._prev;
    if (a !== r)
      return t(a), a;
  }, e.prototype.enqueue = function(r) {
    var a = this._sentinel;
    r._prev && r._next && t(r), r._next = a._next, a._next._prev = r, a._next = r, r._prev = a;
  }, e.prototype.toString = function() {
    for (var r = [], a = this._sentinel, o = a._prev; o !== a; )
      r.push(JSON.stringify(o, n)), o = o._prev;
    return "[" + r.join(", ") + "]";
  };
  function t(r) {
    r._prev._next = r._next, r._next._prev = r._prev, delete r._next, delete r._prev;
  }
  function n(r, a) {
    if (r !== "_next" && r !== "_prev")
      return a;
  }
  return V4;
}
var K4, ST;
function rte() {
  if (ST) return K4;
  ST = 1;
  var e = or(), t = go().Graph, n = nte();
  K4 = a;
  var r = e.constant(1);
  function a(h, p) {
    if (h.nodeCount() <= 1)
      return [];
    var g = c(h, p || r), x = o(g.graph, g.buckets, g.zeroIdx);
    return e.flatten(e.map(x, function(b) {
      return h.outEdges(b.v, b.w);
    }), !0);
  }
  function o(h, p, g) {
    for (var x = [], b = p[p.length - 1], C = p[0], N; h.nodeCount(); ) {
      for (; N = C.dequeue(); )
        l(h, p, g, N);
      for (; N = b.dequeue(); )
        l(h, p, g, N);
      if (h.nodeCount()) {
        for (var T = p.length - 2; T > 0; --T)
          if (N = p[T].dequeue(), N) {
            x = x.concat(l(h, p, g, N, !0));
            break;
          }
      }
    }
    return x;
  }
  function l(h, p, g, x, b) {
    var C = b ? [] : void 0;
    return e.forEach(h.inEdges(x.v), function(N) {
      var T = h.edge(N), j = h.node(N.v);
      b && C.push({ v: N.v, w: N.w }), j.out -= T, d(p, g, j);
    }), e.forEach(h.outEdges(x.v), function(N) {
      var T = h.edge(N), j = N.w, R = h.node(j);
      R.in -= T, d(p, g, R);
    }), h.removeNode(x.v), C;
  }
  function c(h, p) {
    var g = new t(), x = 0, b = 0;
    e.forEach(h.nodes(), function(T) {
      g.setNode(T, { v: T, in: 0, out: 0 });
    }), e.forEach(h.edges(), function(T) {
      var j = g.edge(T.v, T.w) || 0, R = p(T), A = j + R;
      g.setEdge(T.v, T.w, A), b = Math.max(b, g.node(T.v).out += R), x = Math.max(x, g.node(T.w).in += R);
    });
    var C = e.range(b + x + 3).map(function() {
      return new n();
    }), N = x + 1;
    return e.forEach(g.nodes(), function(T) {
      d(C, N, g.node(T));
    }), { graph: g, buckets: C, zeroIdx: N };
  }
  function d(h, p, g) {
    g.out ? g.in ? h[g.out - g.in + p].enqueue(g) : h[h.length - 1].enqueue(g) : h[0].enqueue(g);
  }
  return K4;
}
var Y4, CT;
function ite() {
  if (CT) return Y4;
  CT = 1;
  var e = or(), t = rte();
  Y4 = {
    run: n,
    undo: a
  };
  function n(o) {
    var l = o.graph().acyclicer === "greedy" ? t(o, c(o)) : r(o);
    e.forEach(l, function(d) {
      var h = o.edge(d);
      o.removeEdge(d), h.forwardName = d.name, h.reversed = !0, o.setEdge(d.w, d.v, h, e.uniqueId("rev"));
    });
    function c(d) {
      return function(h) {
        return d.edge(h).weight;
      };
    }
  }
  function r(o) {
    var l = [], c = {}, d = {};
    function h(p) {
      e.has(d, p) || (d[p] = !0, c[p] = !0, e.forEach(o.outEdges(p), function(g) {
        e.has(c, g.w) ? l.push(g) : h(g.w);
      }), delete c[p]);
    }
    return e.forEach(o.nodes(), h), l;
  }
  function a(o) {
    e.forEach(o.edges(), function(l) {
      var c = o.edge(l);
      if (c.reversed) {
        o.removeEdge(l);
        var d = c.forwardName;
        delete c.reversed, delete c.forwardName, o.setEdge(l.w, l.v, c, d);
      }
    });
  }
  return Y4;
}
var W4, ET;
function Ma() {
  if (ET) return W4;
  ET = 1;
  var e = or(), t = go().Graph;
  W4 = {
    addDummyNode: n,
    simplify: r,
    asNonCompoundGraph: a,
    successorWeights: o,
    predecessorWeights: l,
    intersectRect: c,
    buildLayerMatrix: d,
    normalizeRanks: h,
    removeEmptyRanks: p,
    addBorderNode: g,
    maxRank: x,
    partition: b,
    time: C,
    notime: N
  };
  function n(T, j, R, A) {
    var z;
    do
      z = e.uniqueId(A);
    while (T.hasNode(z));
    return R.dummy = j, T.setNode(z, R), z;
  }
  function r(T) {
    var j = new t().setGraph(T.graph());
    return e.forEach(T.nodes(), function(R) {
      j.setNode(R, T.node(R));
    }), e.forEach(T.edges(), function(R) {
      var A = j.edge(R.v, R.w) || { weight: 0, minlen: 1 }, z = T.edge(R);
      j.setEdge(R.v, R.w, {
        weight: A.weight + z.weight,
        minlen: Math.max(A.minlen, z.minlen)
      });
    }), j;
  }
  function a(T) {
    var j = new t({ multigraph: T.isMultigraph() }).setGraph(T.graph());
    return e.forEach(T.nodes(), function(R) {
      T.children(R).length || j.setNode(R, T.node(R));
    }), e.forEach(T.edges(), function(R) {
      j.setEdge(R, T.edge(R));
    }), j;
  }
  function o(T) {
    var j = e.map(T.nodes(), function(R) {
      var A = {};
      return e.forEach(T.outEdges(R), function(z) {
        A[z.w] = (A[z.w] || 0) + T.edge(z).weight;
      }), A;
    });
    return e.zipObject(T.nodes(), j);
  }
  function l(T) {
    var j = e.map(T.nodes(), function(R) {
      var A = {};
      return e.forEach(T.inEdges(R), function(z) {
        A[z.v] = (A[z.v] || 0) + T.edge(z).weight;
      }), A;
    });
    return e.zipObject(T.nodes(), j);
  }
  function c(T, j) {
    var R = T.x, A = T.y, z = j.x - R, q = j.y - A, D = T.width / 2, P = T.height / 2;
    if (!z && !q)
      throw new Error("Not possible to find intersection inside of the rectangle");
    var re, ie;
    return Math.abs(q) * D > Math.abs(z) * P ? (q < 0 && (P = -P), re = P * z / q, ie = P) : (z < 0 && (D = -D), re = D, ie = D * q / z), { x: R + re, y: A + ie };
  }
  function d(T) {
    var j = e.map(e.range(x(T) + 1), function() {
      return [];
    });
    return e.forEach(T.nodes(), function(R) {
      var A = T.node(R), z = A.rank;
      e.isUndefined(z) || (j[z][A.order] = R);
    }), j;
  }
  function h(T) {
    var j = e.min(e.map(T.nodes(), function(R) {
      return T.node(R).rank;
    }));
    e.forEach(T.nodes(), function(R) {
      var A = T.node(R);
      e.has(A, "rank") && (A.rank -= j);
    });
  }
  function p(T) {
    var j = e.min(e.map(T.nodes(), function(q) {
      return T.node(q).rank;
    })), R = [];
    e.forEach(T.nodes(), function(q) {
      var D = T.node(q).rank - j;
      R[D] || (R[D] = []), R[D].push(q);
    });
    var A = 0, z = T.graph().nodeRankFactor;
    e.forEach(R, function(q, D) {
      e.isUndefined(q) && D % z !== 0 ? --A : A && e.forEach(q, function(P) {
        T.node(P).rank += A;
      });
    });
  }
  function g(T, j, R, A) {
    var z = {
      width: 0,
      height: 0
    };
    return arguments.length >= 4 && (z.rank = R, z.order = A), n(T, "border", z, j);
  }
  function x(T) {
    return e.max(e.map(T.nodes(), function(j) {
      var R = T.node(j).rank;
      if (!e.isUndefined(R))
        return R;
    }));
  }
  function b(T, j) {
    var R = { lhs: [], rhs: [] };
    return e.forEach(T, function(A) {
      j(A) ? R.lhs.push(A) : R.rhs.push(A);
    }), R;
  }
  function C(T, j) {
    var R = e.now();
    try {
      return j();
    } finally {
      console.log(T + " time: " + (e.now() - R) + "ms");
    }
  }
  function N(T, j) {
    return j();
  }
  return W4;
}
var X4, kT;
function ate() {
  if (kT) return X4;
  kT = 1;
  var e = or(), t = Ma();
  X4 = {
    run: n,
    undo: a
  };
  function n(o) {
    o.graph().dummyChains = [], e.forEach(o.edges(), function(l) {
      r(o, l);
    });
  }
  function r(o, l) {
    var c = l.v, d = o.node(c).rank, h = l.w, p = o.node(h).rank, g = l.name, x = o.edge(l), b = x.labelRank;
    if (p !== d + 1) {
      o.removeEdge(l);
      var C, N, T;
      for (T = 0, ++d; d < p; ++T, ++d)
        x.points = [], N = {
          width: 0,
          height: 0,
          edgeLabel: x,
          edgeObj: l,
          rank: d
        }, C = t.addDummyNode(o, "edge", N, "_d"), d === b && (N.width = x.width, N.height = x.height, N.dummy = "edge-label", N.labelpos = x.labelpos), o.setEdge(c, C, { weight: x.weight }, g), T === 0 && o.graph().dummyChains.push(C), c = C;
      o.setEdge(c, h, { weight: x.weight }, g);
    }
  }
  function a(o) {
    e.forEach(o.graph().dummyChains, function(l) {
      var c = o.node(l), d = c.edgeLabel, h;
      for (o.setEdge(c.edgeObj, d); c.dummy; )
        h = o.successors(l)[0], o.removeNode(l), d.points.push({ x: c.x, y: c.y }), c.dummy === "edge-label" && (d.x = c.x, d.y = c.y, d.width = c.width, d.height = c.height), l = h, c = o.node(l);
    });
  }
  return X4;
}
var Q4, NT;
function N1() {
  if (NT) return Q4;
  NT = 1;
  var e = or();
  Q4 = {
    longestPath: t,
    slack: n
  };
  function t(r) {
    var a = {};
    function o(l) {
      var c = r.node(l);
      if (e.has(a, l))
        return c.rank;
      a[l] = !0;
      var d = e.min(e.map(r.outEdges(l), function(h) {
        return o(h.w) - r.edge(h).minlen;
      }));
      return (d === Number.POSITIVE_INFINITY || // return value of _.map([]) for Lodash 3
      d === void 0 || // return value of _.map([]) for Lodash 4
      d === null) && (d = 0), c.rank = d;
    }
    e.forEach(r.sources(), o);
  }
  function n(r, a) {
    return r.node(a.w).rank - r.node(a.v).rank - r.edge(a).minlen;
  }
  return Q4;
}
var Z4, jT;
function tO() {
  if (jT) return Z4;
  jT = 1;
  var e = or(), t = go().Graph, n = N1().slack;
  Z4 = r;
  function r(c) {
    var d = new t({ directed: !1 }), h = c.nodes()[0], p = c.nodeCount();
    d.setNode(h, {});
    for (var g, x; a(d, c) < p; )
      g = o(d, c), x = d.hasNode(g.v) ? n(c, g) : -n(c, g), l(d, c, x);
    return d;
  }
  function a(c, d) {
    function h(p) {
      e.forEach(d.nodeEdges(p), function(g) {
        var x = g.v, b = p === x ? g.w : x;
        !c.hasNode(b) && !n(d, g) && (c.setNode(b, {}), c.setEdge(p, b, {}), h(b));
      });
    }
    return e.forEach(c.nodes(), h), c.nodeCount();
  }
  function o(c, d) {
    return e.minBy(d.edges(), function(h) {
      if (c.hasNode(h.v) !== c.hasNode(h.w))
        return n(d, h);
    });
  }
  function l(c, d, h) {
    e.forEach(c.nodes(), function(p) {
      d.node(p).rank += h;
    });
  }
  return Z4;
}
var J4, TT;
function ste() {
  if (TT) return J4;
  TT = 1;
  var e = or(), t = tO(), n = N1().slack, r = N1().longestPath, a = go().alg.preorder, o = go().alg.postorder, l = Ma().simplify;
  J4 = c, c.initLowLimValues = g, c.initCutValues = d, c.calcCutValue = p, c.leaveEdge = b, c.enterEdge = C, c.exchangeEdges = N;
  function c(A) {
    A = l(A), r(A);
    var z = t(A);
    g(z), d(z, A);
    for (var q, D; q = b(z); )
      D = C(z, A, q), N(z, A, q, D);
  }
  function d(A, z) {
    var q = o(A, A.nodes());
    q = q.slice(0, q.length - 1), e.forEach(q, function(D) {
      h(A, z, D);
    });
  }
  function h(A, z, q) {
    var D = A.node(q), P = D.parent;
    A.edge(q, P).cutvalue = p(A, z, q);
  }
  function p(A, z, q) {
    var D = A.node(q), P = D.parent, re = !0, ie = z.edge(q, P), X = 0;
    return ie || (re = !1, ie = z.edge(P, q)), X = ie.weight, e.forEach(z.nodeEdges(q), function(K) {
      var V = K.v === q, de = V ? K.w : K.v;
      if (de !== P) {
        var H = V === re, se = z.edge(K).weight;
        if (X += H ? se : -se, j(A, q, de)) {
          var Z = A.edge(q, de).cutvalue;
          X += H ? -Z : Z;
        }
      }
    }), X;
  }
  function g(A, z) {
    arguments.length < 2 && (z = A.nodes()[0]), x(A, {}, 1, z);
  }
  function x(A, z, q, D, P) {
    var re = q, ie = A.node(D);
    return z[D] = !0, e.forEach(A.neighbors(D), function(X) {
      e.has(z, X) || (q = x(A, z, q, X, D));
    }), ie.low = re, ie.lim = q++, P ? ie.parent = P : delete ie.parent, q;
  }
  function b(A) {
    return e.find(A.edges(), function(z) {
      return A.edge(z).cutvalue < 0;
    });
  }
  function C(A, z, q) {
    var D = q.v, P = q.w;
    z.hasEdge(D, P) || (D = q.w, P = q.v);
    var re = A.node(D), ie = A.node(P), X = re, K = !1;
    re.lim > ie.lim && (X = ie, K = !0);
    var V = e.filter(z.edges(), function(de) {
      return K === R(A, A.node(de.v), X) && K !== R(A, A.node(de.w), X);
    });
    return e.minBy(V, function(de) {
      return n(z, de);
    });
  }
  function N(A, z, q, D) {
    var P = q.v, re = q.w;
    A.removeEdge(P, re), A.setEdge(D.v, D.w, {}), g(A), d(A, z), T(A, z);
  }
  function T(A, z) {
    var q = e.find(A.nodes(), function(P) {
      return !z.node(P).parent;
    }), D = a(A, q);
    D = D.slice(1), e.forEach(D, function(P) {
      var re = A.node(P).parent, ie = z.edge(P, re), X = !1;
      ie || (ie = z.edge(re, P), X = !0), z.node(P).rank = z.node(re).rank + (X ? ie.minlen : -ie.minlen);
    });
  }
  function j(A, z, q) {
    return A.hasEdge(z, q);
  }
  function R(A, z, q) {
    return q.low <= z.lim && z.lim <= q.lim;
  }
  return J4;
}
var e3, AT;
function ote() {
  if (AT) return e3;
  AT = 1;
  var e = N1(), t = e.longestPath, n = tO(), r = ste();
  e3 = a;
  function a(d) {
    switch (d.graph().ranker) {
      case "network-simplex":
        c(d);
        break;
      case "tight-tree":
        l(d);
        break;
      case "longest-path":
        o(d);
        break;
      default:
        c(d);
    }
  }
  var o = t;
  function l(d) {
    t(d), n(d);
  }
  function c(d) {
    r(d);
  }
  return e3;
}
var t3, MT;
function lte() {
  if (MT) return t3;
  MT = 1;
  var e = or();
  t3 = t;
  function t(a) {
    var o = r(a);
    e.forEach(a.graph().dummyChains, function(l) {
      for (var c = a.node(l), d = c.edgeObj, h = n(a, o, d.v, d.w), p = h.path, g = h.lca, x = 0, b = p[x], C = !0; l !== d.w; ) {
        if (c = a.node(l), C) {
          for (; (b = p[x]) !== g && a.node(b).maxRank < c.rank; )
            x++;
          b === g && (C = !1);
        }
        if (!C) {
          for (; x < p.length - 1 && a.node(b = p[x + 1]).minRank <= c.rank; )
            x++;
          b = p[x];
        }
        a.setParent(l, b), l = a.successors(l)[0];
      }
    });
  }
  function n(a, o, l, c) {
    var d = [], h = [], p = Math.min(o[l].low, o[c].low), g = Math.max(o[l].lim, o[c].lim), x, b;
    x = l;
    do
      x = a.parent(x), d.push(x);
    while (x && (o[x].low > p || g > o[x].lim));
    for (b = x, x = c; (x = a.parent(x)) !== b; )
      h.push(x);
    return { path: d.concat(h.reverse()), lca: b };
  }
  function r(a) {
    var o = {}, l = 0;
    function c(d) {
      var h = l;
      e.forEach(a.children(d), c), o[d] = { low: h, lim: l++ };
    }
    return e.forEach(a.children(), c), o;
  }
  return t3;
}
var n3, RT;
function ute() {
  if (RT) return n3;
  RT = 1;
  var e = or(), t = Ma();
  n3 = {
    run: n,
    cleanup: l
  };
  function n(c) {
    var d = t.addDummyNode(c, "root", {}, "_root"), h = a(c), p = e.max(e.values(h)) - 1, g = 2 * p + 1;
    c.graph().nestingRoot = d, e.forEach(c.edges(), function(b) {
      c.edge(b).minlen *= g;
    });
    var x = o(c) + 1;
    e.forEach(c.children(), function(b) {
      r(c, d, g, x, p, h, b);
    }), c.graph().nodeRankFactor = g;
  }
  function r(c, d, h, p, g, x, b) {
    var C = c.children(b);
    if (!C.length) {
      b !== d && c.setEdge(d, b, { weight: 0, minlen: h });
      return;
    }
    var N = t.addBorderNode(c, "_bt"), T = t.addBorderNode(c, "_bb"), j = c.node(b);
    c.setParent(N, b), j.borderTop = N, c.setParent(T, b), j.borderBottom = T, e.forEach(C, function(R) {
      r(c, d, h, p, g, x, R);
      var A = c.node(R), z = A.borderTop ? A.borderTop : R, q = A.borderBottom ? A.borderBottom : R, D = A.borderTop ? p : 2 * p, P = z !== q ? 1 : g - x[b] + 1;
      c.setEdge(N, z, {
        weight: D,
        minlen: P,
        nestingEdge: !0
      }), c.setEdge(q, T, {
        weight: D,
        minlen: P,
        nestingEdge: !0
      });
    }), c.parent(b) || c.setEdge(d, N, { weight: 0, minlen: g + x[b] });
  }
  function a(c) {
    var d = {};
    function h(p, g) {
      var x = c.children(p);
      x && x.length && e.forEach(x, function(b) {
        h(b, g + 1);
      }), d[p] = g;
    }
    return e.forEach(c.children(), function(p) {
      h(p, 1);
    }), d;
  }
  function o(c) {
    return e.reduce(c.edges(), function(d, h) {
      return d + c.edge(h).weight;
    }, 0);
  }
  function l(c) {
    var d = c.graph();
    c.removeNode(d.nestingRoot), delete d.nestingRoot, e.forEach(c.edges(), function(h) {
      var p = c.edge(h);
      p.nestingEdge && c.removeEdge(h);
    });
  }
  return n3;
}
var r3, OT;
function cte() {
  if (OT) return r3;
  OT = 1;
  var e = or(), t = Ma();
  r3 = n;
  function n(a) {
    function o(l) {
      var c = a.children(l), d = a.node(l);
      if (c.length && e.forEach(c, o), e.has(d, "minRank")) {
        d.borderLeft = [], d.borderRight = [];
        for (var h = d.minRank, p = d.maxRank + 1; h < p; ++h)
          r(a, "borderLeft", "_bl", l, d, h), r(a, "borderRight", "_br", l, d, h);
      }
    }
    e.forEach(a.children(), o);
  }
  function r(a, o, l, c, d, h) {
    var p = { width: 0, height: 0, rank: h, borderType: o }, g = d[o][h - 1], x = t.addDummyNode(a, "border", p, l);
    d[o][h] = x, a.setParent(x, c), g && a.setEdge(g, x, { weight: 1 });
  }
  return r3;
}
var i3, zT;
function fte() {
  if (zT) return i3;
  zT = 1;
  var e = or();
  i3 = {
    adjust: t,
    undo: n
  };
  function t(h) {
    var p = h.graph().rankdir.toLowerCase();
    (p === "lr" || p === "rl") && r(h);
  }
  function n(h) {
    var p = h.graph().rankdir.toLowerCase();
    (p === "bt" || p === "rl") && o(h), (p === "lr" || p === "rl") && (c(h), r(h));
  }
  function r(h) {
    e.forEach(h.nodes(), function(p) {
      a(h.node(p));
    }), e.forEach(h.edges(), function(p) {
      a(h.edge(p));
    });
  }
  function a(h) {
    var p = h.width;
    h.width = h.height, h.height = p;
  }
  function o(h) {
    e.forEach(h.nodes(), function(p) {
      l(h.node(p));
    }), e.forEach(h.edges(), function(p) {
      var g = h.edge(p);
      e.forEach(g.points, l), e.has(g, "y") && l(g);
    });
  }
  function l(h) {
    h.y = -h.y;
  }
  function c(h) {
    e.forEach(h.nodes(), function(p) {
      d(h.node(p));
    }), e.forEach(h.edges(), function(p) {
      var g = h.edge(p);
      e.forEach(g.points, d), e.has(g, "x") && d(g);
    });
  }
  function d(h) {
    var p = h.x;
    h.x = h.y, h.y = p;
  }
  return i3;
}
var a3, DT;
function dte() {
  if (DT) return a3;
  DT = 1;
  var e = or();
  a3 = t;
  function t(n) {
    var r = {}, a = e.filter(n.nodes(), function(h) {
      return !n.children(h).length;
    }), o = e.max(e.map(a, function(h) {
      return n.node(h).rank;
    })), l = e.map(e.range(o + 1), function() {
      return [];
    });
    function c(h) {
      if (!e.has(r, h)) {
        r[h] = !0;
        var p = n.node(h);
        l[p.rank].push(h), e.forEach(n.successors(h), c);
      }
    }
    var d = e.sortBy(a, function(h) {
      return n.node(h).rank;
    });
    return e.forEach(d, c), l;
  }
  return a3;
}
var s3, IT;
function hte() {
  if (IT) return s3;
  IT = 1;
  var e = or();
  s3 = t;
  function t(r, a) {
    for (var o = 0, l = 1; l < a.length; ++l)
      o += n(r, a[l - 1], a[l]);
    return o;
  }
  function n(r, a, o) {
    for (var l = e.zipObject(
      o,
      e.map(o, function(x, b) {
        return b;
      })
    ), c = e.flatten(e.map(a, function(x) {
      return e.sortBy(e.map(r.outEdges(x), function(b) {
        return { pos: l[b.w], weight: r.edge(b).weight };
      }), "pos");
    }), !0), d = 1; d < o.length; ) d <<= 1;
    var h = 2 * d - 1;
    d -= 1;
    var p = e.map(new Array(h), function() {
      return 0;
    }), g = 0;
    return e.forEach(c.forEach(function(x) {
      var b = x.pos + d;
      p[b] += x.weight;
      for (var C = 0; b > 0; )
        b % 2 && (C += p[b + 1]), b = b - 1 >> 1, p[b] += x.weight;
      g += x.weight * C;
    })), g;
  }
  return s3;
}
var o3, LT;
function mte() {
  if (LT) return o3;
  LT = 1;
  var e = or();
  o3 = t;
  function t(n, r) {
    return e.map(r, function(a) {
      var o = n.inEdges(a);
      if (o.length) {
        var l = e.reduce(o, function(c, d) {
          var h = n.edge(d), p = n.node(d.v);
          return {
            sum: c.sum + h.weight * p.order,
            weight: c.weight + h.weight
          };
        }, { sum: 0, weight: 0 });
        return {
          v: a,
          barycenter: l.sum / l.weight,
          weight: l.weight
        };
      } else
        return { v: a };
    });
  }
  return o3;
}
var l3, PT;
function pte() {
  if (PT) return l3;
  PT = 1;
  var e = or();
  l3 = t;
  function t(a, o) {
    var l = {};
    e.forEach(a, function(d, h) {
      var p = l[d.v] = {
        indegree: 0,
        in: [],
        out: [],
        vs: [d.v],
        i: h
      };
      e.isUndefined(d.barycenter) || (p.barycenter = d.barycenter, p.weight = d.weight);
    }), e.forEach(o.edges(), function(d) {
      var h = l[d.v], p = l[d.w];
      !e.isUndefined(h) && !e.isUndefined(p) && (p.indegree++, h.out.push(l[d.w]));
    });
    var c = e.filter(l, function(d) {
      return !d.indegree;
    });
    return n(c);
  }
  function n(a) {
    var o = [];
    function l(h) {
      return function(p) {
        p.merged || (e.isUndefined(p.barycenter) || e.isUndefined(h.barycenter) || p.barycenter >= h.barycenter) && r(h, p);
      };
    }
    function c(h) {
      return function(p) {
        p.in.push(h), --p.indegree === 0 && a.push(p);
      };
    }
    for (; a.length; ) {
      var d = a.pop();
      o.push(d), e.forEach(d.in.reverse(), l(d)), e.forEach(d.out, c(d));
    }
    return e.map(
      e.filter(o, function(h) {
        return !h.merged;
      }),
      function(h) {
        return e.pick(h, ["vs", "i", "barycenter", "weight"]);
      }
    );
  }
  function r(a, o) {
    var l = 0, c = 0;
    a.weight && (l += a.barycenter * a.weight, c += a.weight), o.weight && (l += o.barycenter * o.weight, c += o.weight), a.vs = o.vs.concat(a.vs), a.barycenter = l / c, a.weight = c, a.i = Math.min(o.i, a.i), o.merged = !0;
  }
  return l3;
}
var u3, qT;
function gte() {
  if (qT) return u3;
  qT = 1;
  var e = or(), t = Ma();
  u3 = n;
  function n(o, l) {
    var c = t.partition(o, function(N) {
      return e.has(N, "barycenter");
    }), d = c.lhs, h = e.sortBy(c.rhs, function(N) {
      return -N.i;
    }), p = [], g = 0, x = 0, b = 0;
    d.sort(a(!!l)), b = r(p, h, b), e.forEach(d, function(N) {
      b += N.vs.length, p.push(N.vs), g += N.barycenter * N.weight, x += N.weight, b = r(p, h, b);
    });
    var C = { vs: e.flatten(p, !0) };
    return x && (C.barycenter = g / x, C.weight = x), C;
  }
  function r(o, l, c) {
    for (var d; l.length && (d = e.last(l)).i <= c; )
      l.pop(), o.push(d.vs), c++;
    return c;
  }
  function a(o) {
    return function(l, c) {
      return l.barycenter < c.barycenter ? -1 : l.barycenter > c.barycenter ? 1 : o ? c.i - l.i : l.i - c.i;
    };
  }
  return u3;
}
var c3, BT;
function yte() {
  if (BT) return c3;
  BT = 1;
  var e = or(), t = mte(), n = pte(), r = gte();
  c3 = a;
  function a(c, d, h, p) {
    var g = c.children(d), x = c.node(d), b = x ? x.borderLeft : void 0, C = x ? x.borderRight : void 0, N = {};
    b && (g = e.filter(g, function(q) {
      return q !== b && q !== C;
    }));
    var T = t(c, g);
    e.forEach(T, function(q) {
      if (c.children(q.v).length) {
        var D = a(c, q.v, h, p);
        N[q.v] = D, e.has(D, "barycenter") && l(q, D);
      }
    });
    var j = n(T, h);
    o(j, N);
    var R = r(j, p);
    if (b && (R.vs = e.flatten([b, R.vs, C], !0), c.predecessors(b).length)) {
      var A = c.node(c.predecessors(b)[0]), z = c.node(c.predecessors(C)[0]);
      e.has(R, "barycenter") || (R.barycenter = 0, R.weight = 0), R.barycenter = (R.barycenter * R.weight + A.order + z.order) / (R.weight + 2), R.weight += 2;
    }
    return R;
  }
  function o(c, d) {
    e.forEach(c, function(h) {
      h.vs = e.flatten(h.vs.map(function(p) {
        return d[p] ? d[p].vs : p;
      }), !0);
    });
  }
  function l(c, d) {
    e.isUndefined(c.barycenter) ? (c.barycenter = d.barycenter, c.weight = d.weight) : (c.barycenter = (c.barycenter * c.weight + d.barycenter * d.weight) / (c.weight + d.weight), c.weight += d.weight);
  }
  return c3;
}
var f3, FT;
function vte() {
  if (FT) return f3;
  FT = 1;
  var e = or(), t = go().Graph;
  f3 = n;
  function n(a, o, l) {
    var c = r(a), d = new t({ compound: !0 }).setGraph({ root: c }).setDefaultNodeLabel(function(h) {
      return a.node(h);
    });
    return e.forEach(a.nodes(), function(h) {
      var p = a.node(h), g = a.parent(h);
      (p.rank === o || p.minRank <= o && o <= p.maxRank) && (d.setNode(h), d.setParent(h, g || c), e.forEach(a[l](h), function(x) {
        var b = x.v === h ? x.w : x.v, C = d.edge(b, h), N = e.isUndefined(C) ? 0 : C.weight;
        d.setEdge(b, h, { weight: a.edge(x).weight + N });
      }), e.has(p, "minRank") && d.setNode(h, {
        borderLeft: p.borderLeft[o],
        borderRight: p.borderRight[o]
      }));
    }), d;
  }
  function r(a) {
    for (var o; a.hasNode(o = e.uniqueId("_root")); ) ;
    return o;
  }
  return f3;
}
var d3, UT;
function xte() {
  if (UT) return d3;
  UT = 1;
  var e = or();
  d3 = t;
  function t(n, r, a) {
    var o = {}, l;
    e.forEach(a, function(c) {
      for (var d = n.parent(c), h, p; d; ) {
        if (h = n.parent(d), h ? (p = o[h], o[h] = d) : (p = l, l = d), p && p !== d) {
          r.setEdge(p, d);
          return;
        }
        d = h;
      }
    });
  }
  return d3;
}
var h3, $T;
function bte() {
  if ($T) return h3;
  $T = 1;
  var e = or(), t = dte(), n = hte(), r = yte(), a = vte(), o = xte(), l = go().Graph, c = Ma();
  h3 = d;
  function d(x) {
    var b = c.maxRank(x), C = h(x, e.range(1, b + 1), "inEdges"), N = h(x, e.range(b - 1, -1, -1), "outEdges"), T = t(x);
    g(x, T);
    for (var j = Number.POSITIVE_INFINITY, R, A = 0, z = 0; z < 4; ++A, ++z) {
      p(A % 2 ? C : N, A % 4 >= 2), T = c.buildLayerMatrix(x);
      var q = n(x, T);
      q < j && (z = 0, R = e.cloneDeep(T), j = q);
    }
    g(x, R);
  }
  function h(x, b, C) {
    return e.map(b, function(N) {
      return a(x, N, C);
    });
  }
  function p(x, b) {
    var C = new l();
    e.forEach(x, function(N) {
      var T = N.graph().root, j = r(N, T, C, b);
      e.forEach(j.vs, function(R, A) {
        N.node(R).order = A;
      }), o(N, C, j.vs);
    });
  }
  function g(x, b) {
    e.forEach(b, function(C) {
      e.forEach(C, function(N, T) {
        x.node(N).order = T;
      });
    });
  }
  return h3;
}
var m3, HT;
function wte() {
  if (HT) return m3;
  HT = 1;
  var e = or(), t = go().Graph, n = Ma();
  m3 = {
    positionX: C,
    findType1Conflicts: r,
    findType2Conflicts: a,
    addConflict: l,
    hasConflict: c,
    verticalAlignment: d,
    horizontalCompaction: h,
    alignCoordinates: x,
    findSmallestWidthAlignment: g,
    balance: b
  };
  function r(j, R) {
    var A = {};
    function z(q, D) {
      var P = 0, re = 0, ie = q.length, X = e.last(D);
      return e.forEach(D, function(K, V) {
        var de = o(j, K), H = de ? j.node(de).order : ie;
        (de || K === X) && (e.forEach(D.slice(re, V + 1), function(se) {
          e.forEach(j.predecessors(se), function(Z) {
            var fe = j.node(Z), he = fe.order;
            (he < P || H < he) && !(fe.dummy && j.node(se).dummy) && l(A, Z, se);
          });
        }), re = V + 1, P = H);
      }), D;
    }
    return e.reduce(R, z), A;
  }
  function a(j, R) {
    var A = {};
    function z(D, P, re, ie, X) {
      var K;
      e.forEach(e.range(P, re), function(V) {
        K = D[V], j.node(K).dummy && e.forEach(j.predecessors(K), function(de) {
          var H = j.node(de);
          H.dummy && (H.order < ie || H.order > X) && l(A, de, K);
        });
      });
    }
    function q(D, P) {
      var re = -1, ie, X = 0;
      return e.forEach(P, function(K, V) {
        if (j.node(K).dummy === "border") {
          var de = j.predecessors(K);
          de.length && (ie = j.node(de[0]).order, z(P, X, V, re, ie), X = V, re = ie);
        }
        z(P, X, P.length, ie, D.length);
      }), P;
    }
    return e.reduce(R, q), A;
  }
  function o(j, R) {
    if (j.node(R).dummy)
      return e.find(j.predecessors(R), function(A) {
        return j.node(A).dummy;
      });
  }
  function l(j, R, A) {
    if (R > A) {
      var z = R;
      R = A, A = z;
    }
    var q = j[R];
    q || (j[R] = q = {}), q[A] = !0;
  }
  function c(j, R, A) {
    if (R > A) {
      var z = R;
      R = A, A = z;
    }
    return e.has(j[R], A);
  }
  function d(j, R, A, z) {
    var q = {}, D = {}, P = {};
    return e.forEach(R, function(re) {
      e.forEach(re, function(ie, X) {
        q[ie] = ie, D[ie] = ie, P[ie] = X;
      });
    }), e.forEach(R, function(re) {
      var ie = -1;
      e.forEach(re, function(X) {
        var K = z(X);
        if (K.length) {
          K = e.sortBy(K, function(Z) {
            return P[Z];
          });
          for (var V = (K.length - 1) / 2, de = Math.floor(V), H = Math.ceil(V); de <= H; ++de) {
            var se = K[de];
            D[X] === X && ie < P[se] && !c(A, X, se) && (D[se] = X, D[X] = q[X] = q[se], ie = P[se]);
          }
        }
      });
    }), { root: q, align: D };
  }
  function h(j, R, A, z, q) {
    var D = {}, P = p(j, R, A, q), re = q ? "borderLeft" : "borderRight";
    function ie(V, de) {
      for (var H = P.nodes(), se = H.pop(), Z = {}; se; )
        Z[se] ? V(se) : (Z[se] = !0, H.push(se), H = H.concat(de(se))), se = H.pop();
    }
    function X(V) {
      D[V] = P.inEdges(V).reduce(function(de, H) {
        return Math.max(de, D[H.v] + P.edge(H));
      }, 0);
    }
    function K(V) {
      var de = P.outEdges(V).reduce(function(se, Z) {
        return Math.min(se, D[Z.w] - P.edge(Z));
      }, Number.POSITIVE_INFINITY), H = j.node(V);
      de !== Number.POSITIVE_INFINITY && H.borderType !== re && (D[V] = Math.max(D[V], de));
    }
    return ie(X, P.predecessors.bind(P)), ie(K, P.successors.bind(P)), e.forEach(z, function(V) {
      D[V] = D[A[V]];
    }), D;
  }
  function p(j, R, A, z) {
    var q = new t(), D = j.graph(), P = N(D.nodesep, D.edgesep, z);
    return e.forEach(R, function(re) {
      var ie;
      e.forEach(re, function(X) {
        var K = A[X];
        if (q.setNode(K), ie) {
          var V = A[ie], de = q.edge(V, K);
          q.setEdge(V, K, Math.max(P(j, X, ie), de || 0));
        }
        ie = X;
      });
    }), q;
  }
  function g(j, R) {
    return e.minBy(e.values(R), function(A) {
      var z = Number.NEGATIVE_INFINITY, q = Number.POSITIVE_INFINITY;
      return e.forIn(A, function(D, P) {
        var re = T(j, P) / 2;
        z = Math.max(D + re, z), q = Math.min(D - re, q);
      }), z - q;
    });
  }
  function x(j, R) {
    var A = e.values(R), z = e.min(A), q = e.max(A);
    e.forEach(["u", "d"], function(D) {
      e.forEach(["l", "r"], function(P) {
        var re = D + P, ie = j[re], X;
        if (ie !== R) {
          var K = e.values(ie);
          X = P === "l" ? z - e.min(K) : q - e.max(K), X && (j[re] = e.mapValues(ie, function(V) {
            return V + X;
          }));
        }
      });
    });
  }
  function b(j, R) {
    return e.mapValues(j.ul, function(A, z) {
      if (R)
        return j[R.toLowerCase()][z];
      var q = e.sortBy(e.map(j, z));
      return (q[1] + q[2]) / 2;
    });
  }
  function C(j) {
    var R = n.buildLayerMatrix(j), A = e.merge(
      r(j, R),
      a(j, R)
    ), z = {}, q;
    e.forEach(["u", "d"], function(P) {
      q = P === "u" ? R : e.values(R).reverse(), e.forEach(["l", "r"], function(re) {
        re === "r" && (q = e.map(q, function(V) {
          return e.values(V).reverse();
        }));
        var ie = (P === "u" ? j.predecessors : j.successors).bind(j), X = d(j, q, A, ie), K = h(
          j,
          q,
          X.root,
          X.align,
          re === "r"
        );
        re === "r" && (K = e.mapValues(K, function(V) {
          return -V;
        })), z[P + re] = K;
      });
    });
    var D = g(j, z);
    return x(z, D), b(z, j.graph().align);
  }
  function N(j, R, A) {
    return function(z, q, D) {
      var P = z.node(q), re = z.node(D), ie = 0, X;
      if (ie += P.width / 2, e.has(P, "labelpos"))
        switch (P.labelpos.toLowerCase()) {
          case "l":
            X = -P.width / 2;
            break;
          case "r":
            X = P.width / 2;
            break;
        }
      if (X && (ie += A ? X : -X), X = 0, ie += (P.dummy ? R : j) / 2, ie += (re.dummy ? R : j) / 2, ie += re.width / 2, e.has(re, "labelpos"))
        switch (re.labelpos.toLowerCase()) {
          case "l":
            X = re.width / 2;
            break;
          case "r":
            X = -re.width / 2;
            break;
        }
      return X && (ie += A ? X : -X), X = 0, ie;
    };
  }
  function T(j, R) {
    return j.node(R).width;
  }
  return m3;
}
var p3, GT;
function _te() {
  if (GT) return p3;
  GT = 1;
  var e = or(), t = Ma(), n = wte().positionX;
  p3 = r;
  function r(o) {
    o = t.asNonCompoundGraph(o), a(o), e.forEach(n(o), function(l, c) {
      o.node(c).x = l;
    });
  }
  function a(o) {
    var l = t.buildLayerMatrix(o), c = o.graph().ranksep, d = 0;
    e.forEach(l, function(h) {
      var p = e.max(e.map(h, function(g) {
        return o.node(g).height;
      }));
      e.forEach(h, function(g) {
        o.node(g).y = d + p / 2;
      }), d += p + c;
    });
  }
  return p3;
}
var g3, VT;
function Ste() {
  if (VT) return g3;
  VT = 1;
  var e = or(), t = ite(), n = ate(), r = ote(), a = Ma().normalizeRanks, o = lte(), l = Ma().removeEmptyRanks, c = ute(), d = cte(), h = fte(), p = bte(), g = _te(), x = Ma(), b = go().Graph;
  g3 = C;
  function C(le, xe) {
    var Se = xe && xe.debugTiming ? x.time : x.notime;
    Se("layout", function() {
      var Oe = Se("  buildLayoutGraph", function() {
        return ie(le);
      });
      Se("  runLayout", function() {
        N(Oe, Se);
      }), Se("  updateInputGraph", function() {
        T(le, Oe);
      });
    });
  }
  function N(le, xe) {
    xe("    makeSpaceForEdgeLabels", function() {
      X(le);
    }), xe("    removeSelfEdges", function() {
      ge(le);
    }), xe("    acyclic", function() {
      t.run(le);
    }), xe("    nestingGraph.run", function() {
      c.run(le);
    }), xe("    rank", function() {
      r(x.asNonCompoundGraph(le));
    }), xe("    injectEdgeLabelProxies", function() {
      K(le);
    }), xe("    removeEmptyRanks", function() {
      l(le);
    }), xe("    nestingGraph.cleanup", function() {
      c.cleanup(le);
    }), xe("    normalizeRanks", function() {
      a(le);
    }), xe("    assignRankMinMax", function() {
      V(le);
    }), xe("    removeEdgeLabelProxies", function() {
      de(le);
    }), xe("    normalize.run", function() {
      n.run(le);
    }), xe("    parentDummyChains", function() {
      o(le);
    }), xe("    addBorderSegments", function() {
      d(le);
    }), xe("    order", function() {
      p(le);
    }), xe("    insertSelfEdges", function() {
      Q(le);
    }), xe("    adjustCoordinateSystem", function() {
      h.adjust(le);
    }), xe("    position", function() {
      g(le);
    }), xe("    positionSelfEdges", function() {
      U(le);
    }), xe("    removeBorderNodes", function() {
      he(le);
    }), xe("    normalize.undo", function() {
      n.undo(le);
    }), xe("    fixupEdgeLabelCoords", function() {
      Z(le);
    }), xe("    undoCoordinateSystem", function() {
      h.undo(le);
    }), xe("    translateGraph", function() {
      H(le);
    }), xe("    assignNodeIntersects", function() {
      se(le);
    }), xe("    reversePoints", function() {
      fe(le);
    }), xe("    acyclic.undo", function() {
      t.undo(le);
    });
  }
  function T(le, xe) {
    e.forEach(le.nodes(), function(Se) {
      var Oe = le.node(Se), qe = xe.node(Se);
      Oe && (Oe.x = qe.x, Oe.y = qe.y, xe.children(Se).length && (Oe.width = qe.width, Oe.height = qe.height));
    }), e.forEach(le.edges(), function(Se) {
      var Oe = le.edge(Se), qe = xe.edge(Se);
      Oe.points = qe.points, e.has(qe, "x") && (Oe.x = qe.x, Oe.y = qe.y);
    }), le.graph().width = xe.graph().width, le.graph().height = xe.graph().height;
  }
  var j = ["nodesep", "edgesep", "ranksep", "marginx", "marginy"], R = { ranksep: 50, edgesep: 20, nodesep: 50, rankdir: "tb" }, A = ["acyclicer", "ranker", "rankdir", "align"], z = ["width", "height"], q = { width: 0, height: 0 }, D = ["minlen", "weight", "width", "height", "labeloffset"], P = {
    minlen: 1,
    weight: 1,
    width: 0,
    height: 0,
    labeloffset: 10,
    labelpos: "r"
  }, re = ["labelpos"];
  function ie(le) {
    var xe = new b({ multigraph: !0, compound: !0 }), Se = Y(le.graph());
    return xe.setGraph(e.merge(
      {},
      R,
      ue(Se, j),
      e.pick(Se, A)
    )), e.forEach(le.nodes(), function(Oe) {
      var qe = Y(le.node(Oe));
      xe.setNode(Oe, e.defaults(ue(qe, z), q)), xe.setParent(Oe, le.parent(Oe));
    }), e.forEach(le.edges(), function(Oe) {
      var qe = Y(le.edge(Oe));
      xe.setEdge(Oe, e.merge(
        {},
        P,
        ue(qe, D),
        e.pick(qe, re)
      ));
    }), xe;
  }
  function X(le) {
    var xe = le.graph();
    xe.ranksep /= 2, e.forEach(le.edges(), function(Se) {
      var Oe = le.edge(Se);
      Oe.minlen *= 2, Oe.labelpos.toLowerCase() !== "c" && (xe.rankdir === "TB" || xe.rankdir === "BT" ? Oe.width += Oe.labeloffset : Oe.height += Oe.labeloffset);
    });
  }
  function K(le) {
    e.forEach(le.edges(), function(xe) {
      var Se = le.edge(xe);
      if (Se.width && Se.height) {
        var Oe = le.node(xe.v), qe = le.node(xe.w), Me = { rank: (qe.rank - Oe.rank) / 2 + Oe.rank, e: xe };
        x.addDummyNode(le, "edge-proxy", Me, "_ep");
      }
    });
  }
  function V(le) {
    var xe = 0;
    e.forEach(le.nodes(), function(Se) {
      var Oe = le.node(Se);
      Oe.borderTop && (Oe.minRank = le.node(Oe.borderTop).rank, Oe.maxRank = le.node(Oe.borderBottom).rank, xe = e.max(xe, Oe.maxRank));
    }), le.graph().maxRank = xe;
  }
  function de(le) {
    e.forEach(le.nodes(), function(xe) {
      var Se = le.node(xe);
      Se.dummy === "edge-proxy" && (le.edge(Se.e).labelRank = Se.rank, le.removeNode(xe));
    });
  }
  function H(le) {
    var xe = Number.POSITIVE_INFINITY, Se = 0, Oe = Number.POSITIVE_INFINITY, qe = 0, Me = le.graph(), Pe = Me.marginx || 0, Re = Me.marginy || 0;
    function Be(Je) {
      var ot = Je.x, We = Je.y, bt = Je.width, vt = Je.height;
      xe = Math.min(xe, ot - bt / 2), Se = Math.max(Se, ot + bt / 2), Oe = Math.min(Oe, We - vt / 2), qe = Math.max(qe, We + vt / 2);
    }
    e.forEach(le.nodes(), function(Je) {
      Be(le.node(Je));
    }), e.forEach(le.edges(), function(Je) {
      var ot = le.edge(Je);
      e.has(ot, "x") && Be(ot);
    }), xe -= Pe, Oe -= Re, e.forEach(le.nodes(), function(Je) {
      var ot = le.node(Je);
      ot.x -= xe, ot.y -= Oe;
    }), e.forEach(le.edges(), function(Je) {
      var ot = le.edge(Je);
      e.forEach(ot.points, function(We) {
        We.x -= xe, We.y -= Oe;
      }), e.has(ot, "x") && (ot.x -= xe), e.has(ot, "y") && (ot.y -= Oe);
    }), Me.width = Se - xe + Pe, Me.height = qe - Oe + Re;
  }
  function se(le) {
    e.forEach(le.edges(), function(xe) {
      var Se = le.edge(xe), Oe = le.node(xe.v), qe = le.node(xe.w), Me, Pe;
      Se.points ? (Me = Se.points[0], Pe = Se.points[Se.points.length - 1]) : (Se.points = [], Me = qe, Pe = Oe), Se.points.unshift(x.intersectRect(Oe, Me)), Se.points.push(x.intersectRect(qe, Pe));
    });
  }
  function Z(le) {
    e.forEach(le.edges(), function(xe) {
      var Se = le.edge(xe);
      if (e.has(Se, "x"))
        switch ((Se.labelpos === "l" || Se.labelpos === "r") && (Se.width -= Se.labeloffset), Se.labelpos) {
          case "l":
            Se.x -= Se.width / 2 + Se.labeloffset;
            break;
          case "r":
            Se.x += Se.width / 2 + Se.labeloffset;
            break;
        }
    });
  }
  function fe(le) {
    e.forEach(le.edges(), function(xe) {
      var Se = le.edge(xe);
      Se.reversed && Se.points.reverse();
    });
  }
  function he(le) {
    e.forEach(le.nodes(), function(xe) {
      if (le.children(xe).length) {
        var Se = le.node(xe), Oe = le.node(Se.borderTop), qe = le.node(Se.borderBottom), Me = le.node(e.last(Se.borderLeft)), Pe = le.node(e.last(Se.borderRight));
        Se.width = Math.abs(Pe.x - Me.x), Se.height = Math.abs(qe.y - Oe.y), Se.x = Me.x + Se.width / 2, Se.y = Oe.y + Se.height / 2;
      }
    }), e.forEach(le.nodes(), function(xe) {
      le.node(xe).dummy === "border" && le.removeNode(xe);
    });
  }
  function ge(le) {
    e.forEach(le.edges(), function(xe) {
      if (xe.v === xe.w) {
        var Se = le.node(xe.v);
        Se.selfEdges || (Se.selfEdges = []), Se.selfEdges.push({ e: xe, label: le.edge(xe) }), le.removeEdge(xe);
      }
    });
  }
  function Q(le) {
    var xe = x.buildLayerMatrix(le);
    e.forEach(xe, function(Se) {
      var Oe = 0;
      e.forEach(Se, function(qe, Me) {
        var Pe = le.node(qe);
        Pe.order = Me + Oe, e.forEach(Pe.selfEdges, function(Re) {
          x.addDummyNode(le, "selfedge", {
            width: Re.label.width,
            height: Re.label.height,
            rank: Pe.rank,
            order: Me + ++Oe,
            e: Re.e,
            label: Re.label
          }, "_se");
        }), delete Pe.selfEdges;
      });
    });
  }
  function U(le) {
    e.forEach(le.nodes(), function(xe) {
      var Se = le.node(xe);
      if (Se.dummy === "selfedge") {
        var Oe = le.node(Se.e.v), qe = Oe.x + Oe.width / 2, Me = Oe.y, Pe = Se.x - qe, Re = Oe.height / 2;
        le.setEdge(Se.e, Se.label), le.removeNode(xe), Se.label.points = [
          { x: qe + 2 * Pe / 3, y: Me - Re },
          { x: qe + 5 * Pe / 6, y: Me - Re },
          { x: qe + Pe, y: Me },
          { x: qe + 5 * Pe / 6, y: Me + Re },
          { x: qe + 2 * Pe / 3, y: Me + Re }
        ], Se.label.x = Se.x, Se.label.y = Se.y;
      }
    });
  }
  function ue(le, xe) {
    return e.mapValues(e.pick(le, xe), Number);
  }
  function Y(le) {
    var xe = {};
    return e.forEach(le, function(Se, Oe) {
      xe[Oe.toLowerCase()] = Se;
    }), xe;
  }
  return g3;
}
var y3, KT;
function Cte() {
  if (KT) return y3;
  KT = 1;
  var e = or(), t = Ma(), n = go().Graph;
  y3 = {
    debugOrdering: r
  };
  function r(a) {
    var o = t.buildLayerMatrix(a), l = new n({ compound: !0, multigraph: !0 }).setGraph({});
    return e.forEach(a.nodes(), function(c) {
      l.setNode(c, { label: c }), l.setParent(c, "layer" + a.node(c).rank);
    }), e.forEach(a.edges(), function(c) {
      l.setEdge(c.v, c.w, {}, c.name);
    }), e.forEach(o, function(c, d) {
      var h = "layer" + d;
      l.setNode(h, { rank: "same" }), e.reduce(c, function(p, g) {
        return l.setEdge(p, g, { style: "invis" }), g;
      });
    }), l;
  }
  return y3;
}
var v3, YT;
function Ete() {
  return YT || (YT = 1, v3 = "0.8.5"), v3;
}
var x3, WT;
function kte() {
  return WT || (WT = 1, x3 = {
    graphlib: go(),
    layout: Ste(),
    debug: Cte(),
    util: {
      time: Ma().time,
      notime: Ma().notime
    },
    version: Ete()
  }), x3;
}
var Nte = kte();
const XT = /* @__PURE__ */ bc(Nte);
function jte(e, t, n = "TB") {
  const r = new XT.graphlib.Graph();
  r.setDefaultEdgeLabel(() => ({}));
  const a = n === "LR";
  return r.setGraph({
    rankdir: n,
    nodesep: 50,
    // 
    ranksep: 80,
    // 
    marginx: 20,
    marginy: 20
  }), e.forEach((l) => {
    const c = l.type === "event" ? 250 : 150, d = l.type === "event" ? 100 : 60;
    r.setNode(l.id, { width: c, height: d });
  }), t.forEach((l) => {
    r.setEdge(l.source, l.target);
  }), XT.layout(r), { nodes: e.map((l) => {
    const c = r.node(l.id);
    if (!c) return l;
    const d = l.type === "event" ? 250 : 150, h = l.type === "event" ? 100 : 60;
    return {
      ...l,
      targetPosition: a ? pt.Left : pt.Top,
      sourcePosition: a ? pt.Right : pt.Bottom,
      position: {
        x: c.x - d / 2,
        y: c.y - h / 2
      }
    };
  }), edges: t };
}
const Tte = ({ data: e }) => {
  var n;
  const t = nn((r) => r.transform[2]);
  return t < 0.15 ? /* @__PURE__ */ m.jsxs("div", { style: { width: 32, height: 32, borderRadius: "50%", backgroundColor: "#e07850", border: "2px solid #e07850", display: "flex", alignItems: "center", justifyContent: "center" }, children: [
    /* @__PURE__ */ m.jsx(Mi, { type: "target", position: pt.Top, style: { backgroundColor: "#e07850" } }),
    /* @__PURE__ */ m.jsx(Mi, { type: "source", position: pt.Bottom, style: { backgroundColor: "#e07850" } })
  ] }) : t > 1 ? /* @__PURE__ */ m.jsxs("div", { className: "w-[280px] p-3 rounded-lg border border-border bg-card shadow-md", children: [
    /* @__PURE__ */ m.jsx(Mi, { type: "target", position: pt.Top, className: "!bg-primary" }),
    /* @__PURE__ */ m.jsx("div", { className: "text-xs text-muted-foreground mb-1", children: e.time_anchor || "" }),
    /* @__PURE__ */ m.jsx("div", { className: "text-sm font-medium text-foreground mb-2 line-clamp-3", children: e.summary }),
    /* @__PURE__ */ m.jsx("div", { className: "flex flex-wrap gap-1", children: (n = e.roles) == null ? void 0 : n.map((r, a) => /* @__PURE__ */ m.jsx("span", { className: "px-1.5 py-0.5 text-xs bg-primary/10 text-primary rounded", children: r }, a)) }),
    /* @__PURE__ */ m.jsx(Mi, { type: "source", position: pt.Bottom, className: "!bg-primary" })
  ] }) : /* @__PURE__ */ m.jsxs("div", { style: { width: 220, padding: 8, borderRadius: 8, border: "1px solid #444", backgroundColor: "#2a2a2a", boxShadow: "0 1px 3px rgba(0,0,0,0.3)" }, children: [
    /* @__PURE__ */ m.jsx(Mi, { type: "target", position: pt.Top, style: { backgroundColor: "#e07850" } }),
    /* @__PURE__ */ m.jsx("div", { style: { fontSize: 11, color: "#888", marginBottom: 4, overflow: "hidden", textOverflow: "ellipsis", whiteSpace: "nowrap" }, children: e.time_anchor || "" }),
    /* @__PURE__ */ m.jsx("div", { style: { fontSize: 13, color: "#eee", display: "-webkit-box", WebkitLineClamp: 2, WebkitBoxOrient: "vertical", overflow: "hidden" }, children: e.label }),
    /* @__PURE__ */ m.jsx(Mi, { type: "source", position: pt.Bottom, style: { backgroundColor: "#e07850" } })
  ] });
}, Ate = ({ data: e }) => {
  const t = nn((n) => n.transform[2]);
  return t < 0.15 ? /* @__PURE__ */ m.jsxs("div", { style: { width: 24, height: 24, borderRadius: "50%", backgroundColor: "#555", border: "1px solid #666", display: "flex", alignItems: "center", justifyContent: "center" }, children: [
    /* @__PURE__ */ m.jsx(Mi, { type: "target", position: pt.Top, style: { backgroundColor: "#888" } }),
    /* @__PURE__ */ m.jsx(Mi, { type: "source", position: pt.Bottom, style: { backgroundColor: "#888" } })
  ] }) : t > 1 ? /* @__PURE__ */ m.jsxs("div", { className: "w-[160px] p-2 rounded-lg border border-border bg-muted/50", children: [
    /* @__PURE__ */ m.jsx(Mi, { type: "target", position: pt.Top, className: "!bg-muted-foreground" }),
    /* @__PURE__ */ m.jsx("div", { className: "text-xs text-muted-foreground uppercase", children: e.type }),
    /* @__PURE__ */ m.jsx("div", { className: "text-sm font-medium text-foreground", children: e.label }),
    /* @__PURE__ */ m.jsx("div", { className: "text-xs text-muted-foreground mt-1 line-clamp-2", children: e.description }),
    /* @__PURE__ */ m.jsx(Mi, { type: "source", position: pt.Bottom, className: "!bg-muted-foreground" })
  ] }) : /* @__PURE__ */ m.jsxs("div", { style: { width: 120, padding: 6, borderRadius: 6, border: "1px solid #555", backgroundColor: "#333" }, children: [
    /* @__PURE__ */ m.jsx(Mi, { type: "target", position: pt.Top, style: { backgroundColor: "#888" } }),
    /* @__PURE__ */ m.jsx("div", { style: { fontSize: 12, color: "#ddd", overflow: "hidden", textOverflow: "ellipsis", whiteSpace: "nowrap" }, children: e.label }),
    /* @__PURE__ */ m.jsx(Mi, { type: "source", position: pt.Bottom, style: { backgroundColor: "#888" } })
  ] });
}, Mte = {
  event: Tte,
  entity: Ate
}, Rte = ({ events: e, entities: t }) => {
  const [n, r, a] = IQ([]), [o, l, c] = LQ([]), [d, h] = G.useState(!1), p = G.useRef(null), g = G.useCallback(() => {
    const b = [], C = [];
    return e.forEach((N, T) => {
      var j, R;
      b.push({
        id: N.id,
        type: "event",
        position: { x: 0, y: T * 120 },
        data: {
          label: N.summary.substring(0, 50) + (N.summary.length > 50 ? "..." : ""),
          summary: N.summary,
          time_anchor: (j = N.structured_kv) == null ? void 0 : j.time_anchor,
          roles: (R = N.structured_kv) == null ? void 0 : R.role,
          significance: N.significance_score
        }
      }), T > 0 && C.push({
        id: `e-${e[T - 1].id}-${N.id}`,
        source: e[T - 1].id,
        target: N.id,
        type: "smoothstep",
        animated: !1,
        style: { stroke: "var(--primary)", strokeWidth: 2 },
        markerEnd: { type: Cg.ArrowClosed, color: "var(--primary)" }
      });
    }), t.forEach((N, T) => {
      b.push({
        id: N.id,
        type: "entity",
        position: { x: 300 + T % 3 * 100, y: Math.floor(T / 3) * 80 },
        data: {
          label: N.name,
          type: N.type,
          description: N.description,
          profile: N.profile
        }
      });
    }), t.forEach((N) => {
      var j;
      const T = (j = N.profile) == null ? void 0 : j.relations;
      T && Array.isArray(T) && T.forEach((R) => {
        const A = t.find((z) => z.name === R.target);
        A && C.push({
          id: `rel-${N.id}-${A.id}`,
          source: N.id,
          target: A.id,
          type: "smoothstep",
          animated: !1,
          label: R.type,
          style: { stroke: "#888", strokeWidth: 1 },
          labelStyle: { fontSize: 10, fill: "#aaa" }
        });
      });
    }), e.forEach((N) => {
      var R;
      const T = ((R = N.structured_kv) == null ? void 0 : R.role) || [];
      t.filter(
        (A) => {
          var z;
          return T.includes(A.name) || ((z = A.aliases) == null ? void 0 : z.some((q) => T.includes(q)));
        }
      ).forEach((A) => {
        C.push({
          id: `co-${A.id}-${N.id}`,
          source: A.id,
          target: N.id,
          type: "smoothstep",
          animated: !1,
          style: { stroke: "var(--muted-foreground)", strokeWidth: 1, strokeDasharray: "4 2" }
        });
      });
    }), { nodes: b, edges: C };
  }, [e, t]), x = G.useCallback(() => {
    h(!0);
    const { nodes: b, edges: C } = g(), { nodes: N, edges: T } = jte(b, C, "TB");
    r(N), l(T), h(!1), setTimeout(() => {
      var j;
      (j = p.current) == null || j.fitView({ padding: 0.2 });
    }, 50);
  }, [g, r, l]);
  return G.useEffect(() => {
    (e.length > 0 || t.length > 0) && x();
  }, [e.length, t.length]), e.length === 0 && t.length === 0 ? /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col items-center justify-center h-full text-muted-foreground gap-4", children: [
    /* @__PURE__ */ m.jsx(Az, { size: 48, className: "opacity-20" }),
    /* @__PURE__ */ m.jsx("p", { className: "text-sm", children: "" }),
    /* @__PURE__ */ m.jsx("p", { className: "text-xs", children: "" })
  ] }) : /* @__PURE__ */ m.jsxs("div", { style: { position: "relative", width: "100%", height: "400px" }, children: [
    /* @__PURE__ */ m.jsx("div", { className: "absolute top-2 left-2 z-10 flex gap-2", children: /* @__PURE__ */ m.jsxs(
      "button",
      {
        onClick: x,
        disabled: d,
        className: "flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-md bg-card border border-border text-foreground hover:bg-accent transition-colors disabled:opacity-50",
        children: [
          /* @__PURE__ */ m.jsx(zr, { size: 12, className: d ? "animate-spin" : "" }),
          ""
        ]
      }
    ) }),
    /* @__PURE__ */ m.jsxs(
      DQ,
      {
        nodes: n,
        edges: o,
        onNodesChange: a,
        onEdgesChange: c,
        onInit: (b) => {
          p.current = b;
        },
        nodeTypes: Mte,
        fitView: !0,
        minZoom: 0.1,
        maxZoom: 2,
        colorMode: "dark",
        defaultEdgeOptions: {
          type: "smoothstep"
        },
        proOptions: { hideAttribution: !0 },
        children: [
          /* @__PURE__ */ m.jsx(UQ, { color: "#333", gap: 20 }),
          /* @__PURE__ */ m.jsx(WQ, { className: "!bg-card !border-border" }),
          /* @__PURE__ */ m.jsx(
            lZ,
            {
              nodeColor: (b) => b.type === "event" ? "#e07850" : "#888",
              className: "!bg-card !border-border"
            }
          )
        ]
      }
    )
  ] });
}, QT = 768, Ote = [
  { id: "list", label: "", icon: /* @__PURE__ */ m.jsx(zz, { size: 14 }) },
  { id: "graph", label: "", icon: /* @__PURE__ */ m.jsx(mz, { size: 14 }) }
], zte = () => {
  const [e, t] = G.useState([]), [n, r] = G.useState(null), [a, o] = G.useState(/* @__PURE__ */ new Set()), [l, c] = G.useState(""), [d, h] = G.useState(!0), [p, g] = G.useState(window.innerWidth < QT), [x, b] = G.useState(!1), [C, N] = G.useState("list"), [T, j] = G.useState([]), [R, A] = G.useState(/* @__PURE__ */ new Map()), z = R.size > 0, [q, D] = G.useState(!1), P = Oi.getState(), re = G.useRef(null);
  G.useEffect(() => {
    const U = () => {
      g(window.innerWidth < QT);
    };
    return window.addEventListener("resize", U), () => window.removeEventListener("resize", U);
  }, []);
  const ie = async () => {
    h(!0);
    try {
      const U = await P.getAllEvents();
      t(U.sort((ue, Y) => Y.timestamp - ue.timestamp));
    } catch (U) {
      console.error("[MemoryStream] Failed to load events:", U);
    } finally {
      h(!1);
    }
  };
  G.useEffect(() => {
    ie(), X();
  }, []);
  const X = async () => {
    try {
      const U = await P.getAllEntities();
      j(U);
    } catch (U) {
      console.error("[MemoryStream] Failed to load entities:", U);
    }
  }, K = G.useMemo(() => {
    if (!l.trim()) return e;
    const U = l.toLowerCase();
    return e.filter(
      (ue) => {
        var Y, le;
        return ue.summary.toLowerCase().includes(U) || ((Y = ue.structured_kv.event) == null ? void 0 : Y.toLowerCase().includes(U)) || ((le = ue.structured_kv.role) == null ? void 0 : le.some((xe) => xe.toLowerCase().includes(U)));
      }
    );
  }, [e, l]), V = G.useMemo(() => {
    const U = e.find((Y) => Y.id === n);
    if (!U) return null;
    const ue = R.get(U.id);
    return ue ? { ...U, ...ue } : U;
  }, [e, n, R]), de = (U) => {
    r(U), p && b(!0);
  }, H = (U, ue) => {
    const Y = new Set(a);
    ue ? Y.add(U) : Y.delete(U), o(Y);
  }, se = G.useCallback((U, ue) => {
    A((Y) => {
      const le = new Map(Y), xe = le.get(U) || {};
      return le.set(U, { ...xe, ...ue }), le;
    }), t((Y) => Y.map(
      (le) => le.id === U ? { ...le, ...ue } : le
    ));
  }, []), Z = async () => {
    if (R.size !== 0)
      try {
        const U = Array.from(R.entries()).map(
          ([ue, Y]) => P.updateEvent(ue, Y)
        );
        await Promise.all(U), console.log(`[MemoryStream] Batch saved ${R.size} events`), A(/* @__PURE__ */ new Map());
      } catch (U) {
        console.error("[MemoryStream] Batch save failed:", U);
      }
  }, fe = async () => {
    const U = nt.get("apiSettings"), ue = U == null ? void 0 : U.vectorConfig;
    if (!ue) {
      alert(" API ");
      return;
    }
    if (confirm("")) {
      D(!0);
      try {
        Sr.setConfig(ue);
        const Y = U == null ? void 0 : U.embeddingConfig;
        Y != null && Y.concurrency && Sr.setConcurrency(Y.concurrency), await Sr.reembedAllEvents((le, xe, Se) => {
          console.log(`[MemoryStream] Reembedding: ${le}/${xe}, errors: ${Se}`);
        }), await ie(), alert("");
      } catch (Y) {
        console.error("[MemoryStream] Reembed failed:", Y), alert(": " + (Y.message || ""));
      } finally {
        D(!1);
      }
    }
  }, he = async (U) => {
    await P.deleteEvents([U]), t((ue) => ue.filter((Y) => Y.id !== U)), r(null), b(!1), A((ue) => {
      const Y = new Map(ue);
      return Y.delete(U), Y;
    });
  }, ge = async () => {
    a.size !== 0 && confirm(` ${a.size} `) && (await P.deleteEvents(Array.from(a)), t((U) => U.filter((ue) => !a.has(ue.id))), o(/* @__PURE__ */ new Set()), A((U) => {
      const ue = new Map(U);
      return a.forEach((Y) => ue.delete(Y)), ue;
    }));
  }, Q = () => {
    b(!1), p && r(null);
  };
  return p && x && V ? /* @__PURE__ */ m.jsx(
    Z3,
    {
      ref: re,
      event: V,
      isFullScreen: !0,
      onSave: se,
      onDelete: he,
      onClose: Q
    }
  ) : /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col h-full animate-in fade-in overflow-hidden", children: [
    /* @__PURE__ */ m.jsx(WS, { title: "", subtitle: "" }),
    /* @__PURE__ */ m.jsx(Nr, { className: "mb-6" }),
    /* @__PURE__ */ m.jsx(
      G1,
      {
        tabs: Ote,
        activeTab: C,
        onChange: (U) => N(U),
        actions: /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-2", children: [
          z && /* @__PURE__ */ m.jsxs(
            "button",
            {
              className: "inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-primary hover:text-primary-foreground hover:bg-primary border border-primary/50 rounded transition-colors",
              onClick: Z,
              children: [
                /* @__PURE__ */ m.jsx(Qp, { size: 12 }),
                " (",
                R.size,
                ")"
              ]
            }
          ),
          /* @__PURE__ */ m.jsxs(
            "button",
            {
              onClick: fe,
              disabled: q,
              className: "inline-flex items-center gap-1.5 px-2 py-1.5 text-xs text-muted-foreground hover:text-foreground hover:bg-accent rounded transition-colors disabled:opacity-50",
              title: "",
              children: [
                /* @__PURE__ */ m.jsx(l7, { size: 12, className: q ? "animate-pulse" : "" }),
                q ? "..." : ""
              ]
            }
          ),
          /* @__PURE__ */ m.jsx(
            "button",
            {
              onClick: ie,
              className: "p-1.5 hover:bg-accent rounded-md text-muted-foreground hover:text-foreground transition-colors",
              title: "",
              children: /* @__PURE__ */ m.jsx(zr, { size: 14, className: d ? "animate-spin" : "" })
            }
          ),
          a.size > 0 && /* @__PURE__ */ m.jsxs(
            "button",
            {
              onClick: ge,
              className: "flex items-center gap-1 px-2 py-1 text-xs text-destructive hover:bg-destructive/10 rounded-md",
              children: [
                /* @__PURE__ */ m.jsx(po, { size: 12 }),
                " (",
                a.size,
                ")"
              ]
            }
          )
        ] })
      }
    ),
    C === "list" && /* @__PURE__ */ m.jsxs(
      "div",
      {
        className: "flex flex-col overflow-hidden",
        style: {
          //  - header(~50px) - tabs(~80px) - title(~60px) - (~80px)
          height: "calc(100vh - 100px)",
          minHeight: "300px"
        },
        children: [
          /* @__PURE__ */ m.jsxs("div", { className: "relative mb-4 shrink-0", children: [
            /* @__PURE__ */ m.jsx(Es, { size: 14, className: "absolute left-0 top-1/2 -translate-y-1/2 text-muted-foreground" }),
            /* @__PURE__ */ m.jsx(
              "input",
              {
                type: "text",
                value: l,
                onChange: (U) => c(U.target.value),
                placeholder: "...",
                style: {
                  background: "transparent",
                  border: "none",
                  borderBottom: "1px solid var(--border)",
                  borderRadius: 0,
                  outline: "none",
                  padding: "8px 0 8px 24px",
                  fontSize: "14px",
                  width: "100%",
                  color: "var(--foreground)"
                },
                className: "placeholder:text-muted-foreground/40 focus:border-primary transition-colors"
              }
            )
          ] }),
          /* @__PURE__ */ m.jsxs("div", { className: "flex-1 flex gap-6 min-h-0", children: [
            /* @__PURE__ */ m.jsx("div", { className: `
                            ${p ? "w-full" : "w-[30%] min-w-[240px]"}
                            overflow-y-auto no-scrollbar
                            ${p ? "" : "border-r border-border/50 pr-4"}
                        `, children: d ? /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col items-center justify-center h-48 text-muted-foreground gap-2", children: [
              /* @__PURE__ */ m.jsx(zr, { size: 24, className: "animate-spin" }),
              /* @__PURE__ */ m.jsx("p", { className: "text-sm font-light", children: "..." })
            ] }) : K.length === 0 ? /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col items-center justify-center h-48 text-muted-foreground gap-4", children: [
              /* @__PURE__ */ m.jsx(r7, { size: 48, className: "opacity-20" }),
              /* @__PURE__ */ m.jsx("p", { className: "text-sm font-light", children: l ? "" : "" })
            ] }) : /* @__PURE__ */ m.jsx("div", { className: p ? "" : "space-y-1 pb-4", children: K.map((U) => /* @__PURE__ */ m.jsx(
              dG,
              {
                event: U,
                isSelected: U.id === n,
                isCompact: p,
                checked: a.has(U.id),
                hasChanges: R.has(U.id),
                onSelect: () => de(U.id),
                onCheck: (ue) => H(U.id, ue)
              },
              U.id
            )) }) }),
            !p && /* @__PURE__ */ m.jsx("div", { className: "flex-1 overflow-y-auto no-scrollbar", children: /* @__PURE__ */ m.jsx(
              Z3,
              {
                ref: re,
                event: V,
                isFullScreen: !1,
                onSave: se,
                onDelete: he,
                onClose: () => r(null)
              }
            ) })
          ] })
        ]
      }
    ),
    C === "graph" && /* @__PURE__ */ m.jsx(
      "div",
      {
        className: "flex-1 min-h-0",
        style: {
          // 
          height: "calc(100vh - 270px)",
          minHeight: "400px"
        },
        children: /* @__PURE__ */ m.jsx(Rte, { events: e, entities: T })
      }
    )
  ] });
}, Dte = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  MemoryStream: zte
}, Symbol.toStringTag, { value: "Module" })), Ite = ({ links: e, onNavigate: t, className: n = "" }) => e.length === 0 ? null : /* @__PURE__ */ m.jsx("div", { className: `flex items-center gap-4 ${n}`, children: e.map((r) => {
  const a = r.icon || lz;
  return /* @__PURE__ */ m.jsxs(
    "button",
    {
      className: "inline-flex items-center gap-1.5 text-xs text-muted-foreground hover:text-foreground transition-colors",
      onClick: () => t(r.linkTo),
      title: r.label,
      children: [
        /* @__PURE__ */ m.jsx(a, { size: 12 }),
        /* @__PURE__ */ m.jsx("span", { children: r.label })
      ]
    },
    r.id
  );
}) }), j1 = {
  keepRecentCount: 3,
  previewEnabled: !0
};
class nO {
  constructor(t) {
    mt(this, "config");
    mt(this, "isTrimming", !1);
    this.config = { ...j1, ...t };
  }
  /**
   * 
   */
  updateConfig(t) {
    this.config = { ...this.config, ...t };
  }
  /**
   * 
   */
  async canTrim() {
    const n = await Oi.getState().getAllEvents(), r = Math.max(0, n.length - this.config.keepRecentCount);
    return {
      canTrim: r >= 2,
      //  2 
      eventCount: n.length,
      pendingCount: r
    };
  }
  /**
   * 
   *  1 
   */
  async trim(t = !1) {
    if (this.isTrimming)
      return ye.warn("EventTrimmer", ""), null;
    const n = Oi.getState(), r = await n.getEventsToMerge(this.config.keepRecentCount);
    if (r.length < 2)
      return t && Kt.info(" ( 2 )", "Engram"), null;
    this.isTrimming = !0, ye.info("EventTrimmer", "", { eventCount: r.length });
    try {
      const a = this.formatEventsForTrim(r), o = await nd.generate({
        systemPrompt: S7,
        userPrompt: `

${a}`
      });
      if (!o.success || !o.content)
        return ye.error("EventTrimmer", "LLM ", { error: o.error }), Kt.error("LLM ", "Engram"), null;
      const l = KS.parse(o.content);
      if (!l || !l.events || l.events.length === 0)
        return ye.error("EventTrimmer", "JSON "), Kt.error("", "Engram"), null;
      let c = l.events.map((b) => b.summary).join(`

`);
      if (this.config.previewEnabled)
        try {
          c = await YS.requestRevision(
            "",
            ` ${r.length} `,
            c
          );
        } catch {
          return ye.warn("EventTrimmer", ""), Kt.info("", ""), null;
        }
      const d = l.events[0], h = await n.saveEvent({
        summary: c,
        structured_kv: {
          time_anchor: d.meta.time_anchor || "",
          role: this.mergeArrays(r.map((b) => b.structured_kv.role)),
          location: d.meta.location || "",
          event: "",
          logic: this.mergeArrays(r.map((b) => b.structured_kv.logic)),
          causality: "Chain"
        },
        significance_score: Math.max(...r.map((b) => b.significance_score)),
        level: 1,
        // 
        is_embedded: !1,
        //  ( Trim )
        is_archived: !1,
        // 
        source_range: {
          start_index: Math.min(...r.map((b) => {
            var C;
            return ((C = b.source_range) == null ? void 0 : C.start_index) ?? 0;
          })),
          end_index: Math.max(...r.map((b) => {
            var C;
            return ((C = b.source_range) == null ? void 0 : C.end_index) ?? 0;
          }))
        }
      }), p = r.map((b) => b.id), g = nt.get("apiSettings"), x = g == null ? void 0 : g.embeddingConfig;
      if (x != null && x.enabled && x.trigger === "with_trim") {
        ye.info("EventTrimmer", "", { count: r.length });
        try {
          await Sr.embedEvents(r), await n.markEventsAsEmbedded(p);
        } catch (b) {
          ye.error("EventTrimmer", "", { error: b }), Kt.warning("", "Engram");
        }
      }
      return await n.archiveEvents(p), await co.refreshCache(), ye.success("EventTrimmer", "", {
        merged: r.length,
        newEventId: h.id
      }), Kt.success(
        ` ${r.length}  1 `,
        "Engram"
      ), {
        newEvent: h,
        deletedCount: 0,
        // V0.7: 
        sourceEventIds: p
      };
    } catch (a) {
      const o = a instanceof Error ? a.message : String(a);
      return ye.error("EventTrimmer", "", { error: o }), Kt.error(`: ${o}`, "Engram "), null;
    } finally {
      this.isTrimming = !1;
    }
  }
  /**
   *  ()
   */
  formatEventsForTrim(t) {
    return t.map((n) => {
      const r = n.structured_kv;
      return `${n.summary}
Role: [${r.role.join(", ")}]
Loc: ${r.location}
Event: ${r.event}
Logic: [${r.logic.join(", ")}]
Causality: ${r.causality}
Significance: ${n.significance_score}`;
    }).join(`

---

`);
  }
  /**
   * 
   */
  mergeArrays(t) {
    const n = /* @__PURE__ */ new Set();
    for (const r of t)
      for (const a of r)
        n.add(a);
    return Array.from(n);
  }
  /**
   * 
   */
  getConfig() {
    return { ...this.config };
  }
  /**
   *  (UI )
   */
  async getStatus() {
    var N;
    const { useMemoryStore: t } = await Promise.resolve().then(() => Q9), n = t.getState(), { totalTokens: r, eventCount: a } = await n.countEventTokens();
    let o = !1, l = 0, c = 0;
    const h = ((N = nt.getSummarizerSettings()) == null ? void 0 : N.trimConfig) || this.config, p = h.trigger || "token", g = h.tokenLimit || 10240, x = h.countLimit || 5;
    p === "token" ? (l = r, c = g) : (l = a, c = x), o = l >= c;
    const b = h.keepRecentCount || 3, C = Math.max(0, a - b);
    return {
      triggered: o,
      triggerType: p,
      currentValue: l,
      threshold: c,
      pendingEntryCount: C,
      isTrimming: this.isTrimming
    };
  }
}
const i1 = new nO(), b3 = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  DEFAULT_TRIM_CONFIG: j1,
  EventTrimmer: nO,
  eventTrimmer: i1
}, Symbol.toStringTag, { value: "Module" })), Lte = [
  { id: "token", label: "Token ", icon: $O },
  { id: "count", label: "", icon: bz }
], Pte = () => {
  const [e, t] = G.useState(null), [n, r] = G.useState(!1), [a, o] = G.useState(!1), [l, c] = G.useState({
    autoEnabled: !0,
    floorInterval: 10,
    bufferSize: 3,
    autoHide: !1
  }), [d, h] = G.useState({ ...j1, keepRecentCount: 3 }), [p, g] = G.useState(null), [x, b] = G.useState(0), [C, N] = G.useState(0);
  G.useEffect(() => {
    T();
  }, []);
  const T = async () => {
    var V;
    try {
      const { summarizerService: de } = await Promise.resolve().then(() => sl);
      await de.initializeForCurrentChat();
      const H = de.getStatus();
      t(H);
      const se = de.getConfig();
      c({
        autoEnabled: se.enabled,
        floorInterval: se.floorInterval,
        bufferSize: se.bufferSize || 3,
        autoHide: se.autoHide || !1
      });
      const Z = (V = nt.getSummarizerSettings()) == null ? void 0 : V.trimConfig;
      Z && h({ ...j1, ...Z });
      const { eventTrimmer: fe } = await Promise.resolve().then(() => b3), he = await fe.getStatus();
      g(he);
      const { useMemoryStore: ge } = await Promise.resolve().then(() => Q9), Q = ge.getState(), { totalTokens: U, activeEventCount: ue } = await Q.countEventTokens();
      b(U), N(ue);
    } catch (de) {
      console.error(" Summarizer :", de);
    }
  }, j = async () => {
    try {
      const { summarizerService: V } = await Promise.resolve().then(() => sl);
      V.start(), await T();
    } catch (V) {
      console.error(":", V);
    }
  }, R = async () => {
    try {
      const { summarizerService: V } = await Promise.resolve().then(() => sl);
      V.stop(), await T();
    } catch (V) {
      console.error(":", V);
    }
  }, A = async () => {
    r(!0);
    try {
      const { summarizerService: V } = await Promise.resolve().then(() => sl);
      await V.triggerSummary(!0), await T();
    } catch (V) {
      console.error(":", V);
    } finally {
      r(!1);
    }
  }, z = async () => {
    if (confirm("")) {
      r(!0);
      try {
        const { summarizerService: V } = await Promise.resolve().then(() => sl);
        await V.setLastSummarizedFloor(0), await T();
      } catch (V) {
        console.error(":", V);
      } finally {
        r(!1);
      }
    }
  }, q = (V) => {
    const de = { ...d, trigger: V };
    h(de), P(de);
  }, D = (V, de) => {
    const H = { ...d, [V]: de };
    h(H), P(H);
  }, P = (V) => {
    nt.setSummarizerSettings({ trimConfig: V });
  }, re = async () => {
    const V = { ...d, enabled: !d.enabled };
    h(V), P(V);
    const { eventTrimmer: de } = await Promise.resolve().then(() => b3);
    de.updateConfig({ enabled: V.enabled });
  }, ie = async () => {
    o(!0);
    try {
      const { eventTrimmer: V } = await Promise.resolve().then(() => b3);
      await V.trim(!0), await T();
    } catch (V) {
      console.error(":", V);
    } finally {
      o(!1);
    }
  }, K = (() => {
    switch (d.trigger) {
      case "token":
        return { value: d.tokenLimit ?? 10240, min: 1024, max: 1e5, step: 1024, label: "Token " };
      case "count":
        return { value: d.countLimit ?? 5, min: 2, max: 20, step: 1, label: "" };
      default:
        return { value: 10240, min: 1024, max: 1e5, step: 1024, label: "Token " };
    }
  })();
  return /* @__PURE__ */ m.jsxs("div", { className: "grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-12", children: [
    /* @__PURE__ */ m.jsxs("section", { className: "space-y-8", children: [
      /* @__PURE__ */ m.jsxs("div", { children: [
        /* @__PURE__ */ m.jsxs("div", { className: "flex items-center justify-between mb-6", children: [
          /* @__PURE__ */ m.jsx("h2", { className: "text-xs font-medium text-muted-foreground uppercase tracking-wider", children: "" }),
          /* @__PURE__ */ m.jsx(
            "button",
            {
              className: "p-1 rounded text-muted-foreground hover:text-foreground transition-colors",
              onClick: T,
              title: "",
              children: /* @__PURE__ */ m.jsx(zr, { size: 14 })
            }
          )
        ] }),
        e ? /* @__PURE__ */ m.jsxs("div", { className: "space-y-6", children: [
          /* @__PURE__ */ m.jsxs("div", { className: "grid grid-cols-2 gap-6", children: [
            /* @__PURE__ */ m.jsxs("div", { children: [
              /* @__PURE__ */ m.jsx("span", { className: "text-xs text-muted-foreground block mb-1", children: "" }),
              /* @__PURE__ */ m.jsxs("div", { className: `flex items-center gap-2 text-lg font-medium ${e.running ? "text-green-500" : "text-muted-foreground"}`, children: [
                e.running ? /* @__PURE__ */ m.jsx(A1, { size: 18 }) : /* @__PURE__ */ m.jsx(xc, { size: 18 }),
                e.running ? "" : ""
              ] })
            ] }),
            /* @__PURE__ */ m.jsxs("div", { children: [
              /* @__PURE__ */ m.jsx("span", { className: "text-xs text-muted-foreground block mb-1", children: "" }),
              /* @__PURE__ */ m.jsx("div", { className: "text-3xl font-light text-amber-500 font-mono", children: e.pendingFloors })
            ] })
          ] }),
          /* @__PURE__ */ m.jsx(Nr, { length: 100, spacing: "md" }),
          /* @__PURE__ */ m.jsxs("div", { className: "grid grid-cols-2 gap-6", children: [
            /* @__PURE__ */ m.jsxs("div", { children: [
              /* @__PURE__ */ m.jsx("span", { className: "text-[10px] text-muted-foreground/70 uppercase tracking-wider block mb-1", children: "" }),
              /* @__PURE__ */ m.jsx("div", { className: "text-xl font-mono text-foreground/80", children: e.currentFloor })
            ] }),
            /* @__PURE__ */ m.jsxs("div", { children: [
              /* @__PURE__ */ m.jsx("span", { className: "text-[10px] text-muted-foreground/70 uppercase tracking-wider block mb-1", children: " ()" }),
              /* @__PURE__ */ m.jsx("div", { className: "text-xl font-mono text-foreground/80", children: C })
            ] })
          ] }),
          /* @__PURE__ */ m.jsx(Nr, { length: 30, spacing: "md" }),
          /* @__PURE__ */ m.jsxs("div", { children: [
            /* @__PURE__ */ m.jsx("span", { className: "text-[10px] text-muted-foreground/60 uppercase tracking-wider block mb-1", children: " Token (Engram)" }),
            /* @__PURE__ */ m.jsx("div", { className: "text-sm font-mono text-primary/80", children: x.toLocaleString() })
          ] })
        ] }) : /* @__PURE__ */ m.jsx("p", { className: "text-sm text-muted-foreground", children: "..." })
      ] }),
      /* @__PURE__ */ m.jsxs("div", { className: "flex gap-3", children: [
        e != null && e.running ? /* @__PURE__ */ m.jsxs(
          "button",
          {
            className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg transition-colors",
            onClick: R,
            children: [
              /* @__PURE__ */ m.jsx(a7, { size: 14 }),
              ""
            ]
          }
        ) : /* @__PURE__ */ m.jsxs(
          "button",
          {
            className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg transition-colors hover:bg-accent",
            onClick: j,
            children: [
              /* @__PURE__ */ m.jsx(dg, { size: 14 }),
              ""
            ]
          }
        ),
        /* @__PURE__ */ m.jsxs(
          "button",
          {
            className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg transition-colors disabled:opacity-50",
            onClick: A,
            disabled: n || (e == null ? void 0 : e.isSummarizing),
            children: [
              /* @__PURE__ */ m.jsx(zr, { size: 14, className: n ? "animate-spin" : "" }),
              n ? "..." : ""
            ]
          }
        )
      ] }),
      /* @__PURE__ */ m.jsxs("div", { className: "pt-6 space-y-6", children: [
        /* @__PURE__ */ m.jsx(Nr, { length: 100 }),
        /* @__PURE__ */ m.jsxs("div", { className: "grid grid-cols-2 gap-4", children: [
          /* @__PURE__ */ m.jsxs("div", { className: "flex items-center justify-between", children: [
            /* @__PURE__ */ m.jsx("span", { className: "text-sm text-foreground", children: "" }),
            /* @__PURE__ */ m.jsx(
              oo,
              {
                label: "",
                checked: l.autoEnabled,
                onChange: async (V) => {
                  c((H) => ({ ...H, autoEnabled: V }));
                  const { summarizerService: de } = await Promise.resolve().then(() => sl);
                  de.updateConfig({ enabled: V });
                }
              }
            )
          ] }),
          /* @__PURE__ */ m.jsxs("div", { className: "flex items-center justify-between", children: [
            /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col", children: [
              /* @__PURE__ */ m.jsx("span", { className: "text-sm text-foreground", children: "" }),
              /* @__PURE__ */ m.jsx("span", { className: "text-[10px] text-muted-foreground", children: "" })
            ] }),
            /* @__PURE__ */ m.jsx(
              oo,
              {
                label: "",
                checked: l.autoHide,
                onChange: (V) => {
                  c((de) => ({ ...de, autoHide: V })), Promise.resolve().then(() => sl).then(({ summarizerService: de }) => {
                    de.updateConfig({ autoHide: V });
                  });
                }
              }
            )
          ] })
        ] }),
        l.autoEnabled && /* @__PURE__ */ m.jsx(m.Fragment, { children: /* @__PURE__ */ m.jsxs("div", { className: "grid grid-cols-2 gap-6", children: [
          /* @__PURE__ */ m.jsxs("div", { className: "space-y-3", children: [
            /* @__PURE__ */ m.jsxs("div", { className: "text-xs text-muted-foreground", children: [
              " ",
              /* @__PURE__ */ m.jsx("span", { className: "text-base font-medium text-foreground mx-0.5", children: l.floorInterval }),
              " "
            ] }),
            /* @__PURE__ */ m.jsxs("div", { className: "relative h-4 flex items-center group cursor-pointer", children: [
              /* @__PURE__ */ m.jsx("div", { className: "absolute inset-x-0 h-[1px]", style: { backgroundColor: "var(--border)" } }),
              /* @__PURE__ */ m.jsx(
                "div",
                {
                  className: "absolute top-1/2 -translate-y-1/2 w-2.5 h-2.5 bg-muted-foreground/80 rounded-full shadow-sm pointer-events-none transition-transform duration-75 ease-out group-hover:scale-125 group-hover:bg-foreground",
                  style: { left: `${(l.floorInterval - 5) / 95 * 100}%`, transform: "translate(-50%, -50%)" }
                }
              ),
              /* @__PURE__ */ m.jsx(
                "input",
                {
                  type: "range",
                  min: 5,
                  max: 100,
                  step: 5,
                  value: l.floorInterval,
                  onChange: async (V) => {
                    const de = Number(V.target.value);
                    c((se) => ({ ...se, floorInterval: de }));
                    const { summarizerService: H } = await Promise.resolve().then(() => sl);
                    H.updateConfig({ floorInterval: de });
                  },
                  className: "absolute inset-x-0 w-full h-full opacity-0 cursor-pointer z-10 m-0",
                  style: { appearance: "none", WebkitAppearance: "none" }
                }
              )
            ] })
          ] }),
          /* @__PURE__ */ m.jsxs("div", { className: "space-y-3", children: [
            /* @__PURE__ */ m.jsxs("div", { className: "text-xs text-muted-foreground", children: [
              " ",
              /* @__PURE__ */ m.jsx("span", { className: "text-base font-medium text-foreground mx-0.5", children: l.bufferSize }),
              " "
            ] }),
            /* @__PURE__ */ m.jsxs("div", { className: "relative h-4 flex items-center group cursor-pointer", children: [
              /* @__PURE__ */ m.jsx("div", { className: "absolute inset-x-0 h-[1px]", style: { backgroundColor: "var(--border)" } }),
              /* @__PURE__ */ m.jsx(
                "div",
                {
                  className: "absolute top-1/2 -translate-y-1/2 w-2.5 h-2.5 bg-muted-foreground/80 rounded-full shadow-sm pointer-events-none transition-transform duration-75 ease-out group-hover:scale-125 group-hover:bg-foreground",
                  style: { left: `${l.bufferSize / 20 * 100}%`, transform: "translate(-50%, -50%)" }
                }
              ),
              /* @__PURE__ */ m.jsx(
                "input",
                {
                  type: "range",
                  min: 0,
                  max: 20,
                  step: 1,
                  value: l.bufferSize,
                  onChange: (V) => {
                    const de = Number(V.target.value);
                    c((H) => ({ ...H, bufferSize: de })), Promise.resolve().then(() => sl).then(({ summarizerService: H }) => {
                      H.updateConfig({ bufferSize: de });
                    });
                  },
                  className: "absolute inset-x-0 w-full h-full opacity-0 cursor-pointer z-10 m-0",
                  style: { appearance: "none", WebkitAppearance: "none" }
                }
              )
            ] })
          ] })
        ] }) })
      ] }),
      /* @__PURE__ */ m.jsx("div", { className: "flex justify-end", children: /* @__PURE__ */ m.jsxs(
        "button",
        {
          className: "inline-flex items-center gap-2 px-3 py-1.5 text-xs text-red-500 hover:text-red-400 border border-red-500/30 hover:border-red-500/50 hover:bg-red-500/10 rounded transition-colors",
          onClick: z,
          disabled: n,
          title: " ()",
          children: [
            /* @__PURE__ */ m.jsx(zr, { size: 12, className: n ? "animate-spin" : "" }),
            ""
          ]
        }
      ) })
    ] }),
    /* @__PURE__ */ m.jsxs("section", { className: "space-y-6 lg:pl-8 relative", children: [
      /* @__PURE__ */ m.jsx(Nr, { responsive: !0, length: 30 }),
      /* @__PURE__ */ m.jsxs("div", { className: "flex items-center justify-between", children: [
        /* @__PURE__ */ m.jsxs("div", { children: [
          /* @__PURE__ */ m.jsx("h2", { className: "text-sm font-medium text-foreground", children: "" }),
          /* @__PURE__ */ m.jsx("p", { className: "text-xs text-muted-foreground mt-0.5", children: "" })
        ] }),
        /* @__PURE__ */ m.jsx(
          oo,
          {
            label: "",
            checked: d.enabled ?? !1,
            onChange: re
          }
        )
      ] }),
      /* @__PURE__ */ m.jsxs("div", { className: `space-y-6 transition-opacity ${d.enabled ? "opacity-100" : "opacity-40 pointer-events-none"}`, children: [
        /* @__PURE__ */ m.jsxs("div", { className: "space-y-3", children: [
          /* @__PURE__ */ m.jsx("span", { className: "text-xs text-muted-foreground", children: "" }),
          /* @__PURE__ */ m.jsx("div", { className: "flex gap-6", children: Lte.map((V) => /* @__PURE__ */ m.jsxs(
            "label",
            {
              className: "flex items-center gap-2 cursor-pointer group",
              onClick: () => q(V.id),
              children: [
                /* @__PURE__ */ m.jsx(
                  "span",
                  {
                    className: `w-4 h-4 rounded-full border-2 flex items-center justify-center transition-colors
                                        ${d.trigger === V.id ? "border-primary bg-primary" : "border-border group-hover:border-muted-foreground"}`,
                    children: d.trigger === V.id && /* @__PURE__ */ m.jsx("span", { className: "w-1.5 h-1.5 rounded-full bg-primary-foreground" })
                  }
                ),
                /* @__PURE__ */ m.jsx("span", { className: `text-sm transition-colors ${d.trigger === V.id ? "text-foreground" : "text-muted-foreground"}`, children: V.label })
              ]
            },
            V.id
          )) })
        ] }),
        /* @__PURE__ */ m.jsxs("div", { className: "space-y-3", children: [
          /* @__PURE__ */ m.jsx("div", { className: "text-xs text-muted-foreground", children: K.label === "Token " ? /* @__PURE__ */ m.jsxs(m.Fragment, { children: [
            " Token  ",
            /* @__PURE__ */ m.jsx("span", { className: "text-base font-medium text-foreground mx-0.5", children: K.value }),
            " "
          ] }) : /* @__PURE__ */ m.jsxs(m.Fragment, { children: [
            " ",
            /* @__PURE__ */ m.jsx("span", { className: "text-base font-medium text-foreground mx-0.5", children: K.value }),
            " "
          ] }) }),
          /* @__PURE__ */ m.jsxs("div", { className: "relative h-4 flex items-center group cursor-pointer", children: [
            /* @__PURE__ */ m.jsx("div", { className: "absolute inset-x-0 h-[1px]", style: { backgroundColor: "var(--border)" } }),
            /* @__PURE__ */ m.jsx(
              "div",
              {
                className: "absolute top-1/2 -translate-y-1/2 w-2.5 h-2.5 bg-muted-foreground/80 rounded-full shadow-sm pointer-events-none transition-transform duration-75 ease-out group-hover:scale-125 group-hover:bg-foreground",
                style: { left: `${(K.value - K.min) / (K.max - K.min) * 100}%`, transform: "translate(-50%, -50%)" }
              }
            ),
            /* @__PURE__ */ m.jsx(
              "input",
              {
                type: "range",
                min: K.min,
                max: K.max,
                step: K.step,
                value: K.value,
                onChange: (V) => {
                  const de = Number(V.target.value), H = d.trigger === "token" ? "tokenLimit" : "countLimit";
                  D(H, de);
                },
                className: "absolute inset-x-0 w-full h-full opacity-0 cursor-pointer z-10 m-0",
                style: { appearance: "none", WebkitAppearance: "none" }
              }
            )
          ] })
        ] }),
        /* @__PURE__ */ m.jsxs("div", { className: "space-y-3", children: [
          /* @__PURE__ */ m.jsxs("div", { className: "text-xs text-muted-foreground", children: [
            " ",
            /* @__PURE__ */ m.jsx("span", { className: "text-base font-medium text-foreground mx-0.5", children: d.keepRecentCount ?? 3 }),
            " "
          ] }),
          /* @__PURE__ */ m.jsxs("div", { className: "relative h-4 flex items-center group cursor-pointer", children: [
            /* @__PURE__ */ m.jsx("div", { className: "absolute inset-x-0 h-[1px]", style: { backgroundColor: "var(--border)" } }),
            /* @__PURE__ */ m.jsx(
              "div",
              {
                className: "absolute top-1/2 -translate-y-1/2 w-2.5 h-2.5 bg-muted-foreground/80 rounded-full shadow-sm pointer-events-none transition-transform duration-75 ease-out group-hover:scale-125 group-hover:bg-foreground",
                style: { left: `${(d.keepRecentCount ?? 3) / 10 * 100}%`, transform: "translate(-50%, -50%)" }
              }
            ),
            /* @__PURE__ */ m.jsx(
              "input",
              {
                type: "range",
                min: 0,
                max: 10,
                step: 1,
                value: d.keepRecentCount ?? 3,
                onChange: (V) => D("keepRecentCount", Number(V.target.value)),
                className: "absolute inset-x-0 w-full h-full opacity-0 cursor-pointer z-10 m-0",
                style: { appearance: "none", WebkitAppearance: "none" }
              }
            )
          ] })
        ] }),
        p && /* @__PURE__ */ m.jsxs("div", { className: "text-xs text-muted-foreground space-y-1", children: [
          /* @__PURE__ */ m.jsxs("div", { className: "flex justify-between", children: [
            /* @__PURE__ */ m.jsx("span", { children: ":" }),
            /* @__PURE__ */ m.jsx("span", { className: "font-mono", children: p.pendingEntryCount })
          ] }),
          /* @__PURE__ */ m.jsxs("div", { className: "flex justify-between", children: [
            /* @__PURE__ */ m.jsxs("span", { children: [
              "",
              d.trigger === "token" ? "Token" : "",
              ":"
            ] }),
            /* @__PURE__ */ m.jsxs("span", { className: `font-mono ${p.triggered ? "text-amber-500" : ""}`, children: [
              p.currentValue,
              " / ",
              K.value
            ] })
          ] })
        ] }),
        /* @__PURE__ */ m.jsxs(
          "button",
          {
            type: "button",
            className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg hover:bg-accent transition-colors disabled:opacity-50",
            onClick: ie,
            disabled: a || ((p == null ? void 0 : p.pendingEntryCount) ?? 0) < 2,
            children: [
              /* @__PURE__ */ m.jsx(eD, { size: 14, className: a ? "animate-pulse" : "" }),
              a ? "..." : ""
            ]
          }
        ),
        /* @__PURE__ */ m.jsx("p", { className: "text-xs text-muted-foreground/70 leading-relaxed", children: " Token " })
      ] })
    ] })
  ] });
}, qte = () => {
  const [e, t] = G.useState({ total: 0, embedded: 0, pending: 0 }), [n, r] = G.useState(null), [a, o] = G.useState(!1), [l, c] = G.useState(!0), [d, h] = G.useState(null), [p, g] = G.useState(null), [x, b] = G.useState({ ...N3 }), [C, N] = G.useState(null), [T, j] = G.useState(null);
  G.useEffect(() => {
    R();
  }, []);
  const R = async () => {
    c(!0), h(null);
    try {
      const V = nt.get("apiSettings");
      V != null && V.vectorConfig && (N(V.vectorConfig), Sr.setConfig(V.vectorConfig)), V != null && V.embeddingConfig && b({ ...N3, ...V.embeddingConfig });
      const de = await Sr.getEmbeddingStats();
      t(de);
    } catch (V) {
      h(V.message || "");
    } finally {
      c(!1);
    }
  }, A = G.useCallback(async () => {
    const V = await Sr.getEmbeddingStats();
    t(V);
  }, []), z = async () => {
    if (!C) {
      h("");
      return;
    }
    o(!0), r({ current: 0, total: e.pending, errors: 0 }), h(null), g(null);
    try {
      Sr.setConfig(C), Sr.setConcurrency(x.concurrency);
      const V = await Sr.embedUnprocessedEvents((de, H, se) => {
        r({ current: de, total: H, errors: se });
      });
      g(V), await A();
    } catch (V) {
      h(V.message || "");
    } finally {
      o(!1), r(null);
    }
  }, q = () => {
    Sr.stop();
  }, D = async () => {
    if (!C) {
      h("");
      return;
    }
    if (confirm("")) {
      o(!0), r({ current: 0, total: e.total, errors: 0 }), h(null), g(null);
      try {
        Sr.setConfig(C), Sr.setConcurrency(x.concurrency);
        const V = await Sr.reembedAllEvents((de, H, se) => {
          r({ current: de, total: H, errors: se });
        });
        g(V), await A();
      } catch (V) {
        h(V.message || "");
      } finally {
        o(!1), r(null);
      }
    }
  }, P = (V) => {
    const de = { ...x, ...V };
    b(de);
    const H = nt.get("apiSettings");
    H && nt.set("apiSettings", {
      ...H,
      embeddingConfig: de
    });
  }, re = (V) => {
    const de = { ...x.standalone, ...V };
    P({ standalone: de });
  }, ie = G.useCallback(async () => {
    if (x.trigger !== "standalone") {
      j(null);
      return;
    }
    try {
      const { standaloneEmbeddingTrigger: V } = await Promise.resolve().then(() => lA), de = await V.getStatus();
      j(de);
    } catch (V) {
      console.error("[VectorizationPanel] Failed to load trigger status:", V);
    }
  }, [x.trigger]);
  G.useEffect(() => {
    ie();
  }, [ie]);
  const X = n && n.total > 0 ? Math.round(n.current / n.total * 100) : 0, K = C && (C.source === "transformers" || C.model);
  return l ? /* @__PURE__ */ m.jsxs("div", { className: "flex items-center justify-center h-48 text-muted-foreground gap-2", children: [
    /* @__PURE__ */ m.jsx(au, { size: 20, className: "animate-spin" }),
    /* @__PURE__ */ m.jsx("span", { className: "text-sm font-light", children: "..." })
  ] }) : /* @__PURE__ */ m.jsxs("div", { className: "py-4", children: [
    /* @__PURE__ */ m.jsxs("div", { className: "grid grid-cols-3 gap-4 mb-6", children: [
      /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col gap-1", children: [
        /* @__PURE__ */ m.jsx("span", { className: "text-xs text-muted-foreground uppercase tracking-wider", children: "" }),
        /* @__PURE__ */ m.jsx("span", { className: "text-2xl font-light", children: e.total })
      ] }),
      /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col gap-1", children: [
        /* @__PURE__ */ m.jsx("span", { className: "text-xs text-muted-foreground uppercase tracking-wider", children: "" }),
        /* @__PURE__ */ m.jsx("span", { className: "text-2xl font-light text-primary", children: e.embedded })
      ] }),
      /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col gap-1", children: [
        /* @__PURE__ */ m.jsx("span", { className: "text-xs text-muted-foreground uppercase tracking-wider", children: "" }),
        /* @__PURE__ */ m.jsx("span", { className: "text-2xl font-light text-warning", children: e.pending })
      ] })
    ] }),
    n && /* @__PURE__ */ m.jsxs("div", { className: "mb-6 p-4 bg-muted/30 rounded-lg", children: [
      /* @__PURE__ */ m.jsxs("div", { className: "flex items-center justify-between mb-2", children: [
        /* @__PURE__ */ m.jsxs("span", { className: "text-sm text-muted-foreground", children: [
          " ",
          n.current,
          "/",
          n.total
        ] }),
        /* @__PURE__ */ m.jsxs("span", { className: "text-sm font-medium", children: [
          X,
          "%"
        ] })
      ] }),
      /* @__PURE__ */ m.jsx("div", { className: "h-2 bg-muted rounded-full overflow-hidden", children: /* @__PURE__ */ m.jsx("div", { className: "h-full bg-primary transition-all duration-300", style: { width: `${X}%` } }) }),
      n.errors > 0 && /* @__PURE__ */ m.jsxs("p", { className: "text-xs text-destructive mt-2", children: [
        n.errors,
        " "
      ] })
    ] }),
    p && /* @__PURE__ */ m.jsxs(
      "div",
      {
        className: `mb-6 p-3 rounded-lg flex items-center gap-2 ${p.failed > 0 ? "bg-warning/10 text-warning" : "bg-primary/10 text-primary"}`,
        children: [
          p.failed > 0 ? /* @__PURE__ */ m.jsx(xc, { size: 16 }) : /* @__PURE__ */ m.jsx(A1, { size: 16 }),
          /* @__PURE__ */ m.jsxs("span", { className: "text-sm", children: [
            "",
            p.success,
            " ",
            p.failed > 0 && `${p.failed} `
          ] })
        ]
      }
    ),
    d && /* @__PURE__ */ m.jsxs("div", { className: "mb-6 p-3 bg-destructive/10 text-destructive rounded-lg flex items-center gap-2", children: [
      /* @__PURE__ */ m.jsx(xc, { size: 16 }),
      /* @__PURE__ */ m.jsx("span", { className: "text-sm", children: d })
    ] }),
    !K && /* @__PURE__ */ m.jsx("div", { className: "mb-6 p-3 bg-muted/50 rounded-lg", children: /* @__PURE__ */ m.jsxs("p", { className: "text-sm text-muted-foreground", children: [
      "",
      /* @__PURE__ */ m.jsx("span", { className: "text-primary mx-1", children: "API     " }),
      ""
    ] }) }),
    /* @__PURE__ */ m.jsx("div", { className: "flex flex-wrap gap-3 mb-6", children: a ? /* @__PURE__ */ m.jsxs(
      "button",
      {
        onClick: q,
        className: "inline-flex items-center gap-2 px-4 py-2 bg-destructive text-destructive-foreground rounded-md hover:bg-destructive/90 transition-colors",
        children: [
          /* @__PURE__ */ m.jsx(u7, { size: 16 }),
          ""
        ]
      }
    ) : /* @__PURE__ */ m.jsxs(m.Fragment, { children: [
      /* @__PURE__ */ m.jsxs(
        "button",
        {
          onClick: z,
          disabled: e.pending === 0 || !K,
          className: "inline-flex items-center gap-2 px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",
          children: [
            /* @__PURE__ */ m.jsx(dg, { size: 16 }),
            " (",
            e.pending,
            ")"
          ]
        }
      ),
      /* @__PURE__ */ m.jsxs(
        "button",
        {
          onClick: D,
          disabled: e.total === 0 || !K,
          className: "inline-flex items-center gap-2 px-4 py-2 border border-border text-foreground rounded-md hover:bg-muted transition-colors disabled:opacity-50 disabled:cursor-not-allowed",
          children: [
            /* @__PURE__ */ m.jsx(zr, { size: 16 }),
            ""
          ]
        }
      ),
      /* @__PURE__ */ m.jsx(
        "button",
        {
          onClick: A,
          className: "inline-flex items-center gap-2 px-3 py-2 text-muted-foreground hover:text-foreground transition-colors",
          children: /* @__PURE__ */ m.jsx(zr, { size: 16 })
        }
      )
    ] }) }),
    /* @__PURE__ */ m.jsx(Nr, { className: "my-6" }),
    /* @__PURE__ */ m.jsxs("div", { className: "space-y-4", children: [
      /* @__PURE__ */ m.jsx("h3", { className: "text-sm font-medium text-muted-foreground uppercase tracking-wider", children: "" }),
      /* @__PURE__ */ m.jsx(
        oo,
        {
          label: "",
          checked: x.enabled,
          onChange: (V) => P({ enabled: V }),
          description: ""
        }
      ),
      /* @__PURE__ */ m.jsx(
        nu,
        {
          label: "",
          value: x.trigger,
          onChange: (V) => P({ trigger: V }),
          options: [
            { value: "with_trim", label: " Trim " },
            { value: "standalone", label: "" },
            { value: "manual", label: "" }
          ],
          description: "with_trim: Trim  | standalone:  | manual: "
        }
      ),
      x.trigger === "standalone" && x.standalone && /* @__PURE__ */ m.jsxs(m.Fragment, { children: [
        /* @__PURE__ */ m.jsx(Nr, { className: "my-4" }),
        /* @__PURE__ */ m.jsxs("div", { className: "space-y-4", children: [
          /* @__PURE__ */ m.jsx("h4", { className: "text-xs font-medium text-muted-foreground uppercase tracking-wider", children: "" }),
          /* @__PURE__ */ m.jsxs("div", { className: "space-y-2", children: [
            /* @__PURE__ */ m.jsx("label", { className: "text-sm text-muted-foreground", children: "" }),
            /* @__PURE__ */ m.jsxs("div", { className: "flex gap-6", children: [
              /* @__PURE__ */ m.jsxs(
                "label",
                {
                  className: "flex items-center gap-2 cursor-pointer group",
                  onClick: () => re({ triggerType: "count" }),
                  children: [
                    /* @__PURE__ */ m.jsx(
                      "span",
                      {
                        className: `w-4 h-4 rounded-full border-2 flex items-center justify-center transition-colors ${x.standalone.triggerType === "count" ? "border-primary bg-primary" : "border-border group-hover:border-muted-foreground"}`,
                        children: x.standalone.triggerType === "count" && /* @__PURE__ */ m.jsx("span", { className: "w-1.5 h-1.5 rounded-full bg-primary-foreground" })
                      }
                    ),
                    /* @__PURE__ */ m.jsx(
                      "span",
                      {
                        className: `text-sm transition-colors ${x.standalone.triggerType === "count" ? "text-foreground" : "text-muted-foreground"}`,
                        children: ""
                      }
                    )
                  ]
                }
              ),
              /* @__PURE__ */ m.jsxs(
                "label",
                {
                  className: "flex items-center gap-2 cursor-pointer group",
                  onClick: () => re({ triggerType: "token" }),
                  children: [
                    /* @__PURE__ */ m.jsx(
                      "span",
                      {
                        className: `w-4 h-4 rounded-full border-2 flex items-center justify-center transition-colors ${x.standalone.triggerType === "token" ? "border-primary bg-primary" : "border-border group-hover:border-muted-foreground"}`,
                        children: x.standalone.triggerType === "token" && /* @__PURE__ */ m.jsx("span", { className: "w-1.5 h-1.5 rounded-full bg-primary-foreground" })
                      }
                    ),
                    /* @__PURE__ */ m.jsx(
                      "span",
                      {
                        className: `text-sm transition-colors ${x.standalone.triggerType === "token" ? "text-foreground" : "text-muted-foreground"}`,
                        children: "Token "
                      }
                    )
                  ]
                }
              )
            ] })
          ] }),
          /* @__PURE__ */ m.jsx(
            ni,
            {
              label: x.standalone.triggerType === "count" ? "" : "Token ",
              value: x.standalone.triggerType === "count" ? x.standalone.countLimit : x.standalone.tokenLimit,
              onChange: (V) => {
                const de = x.standalone.triggerType === "count" ? "countLimit" : "tokenLimit";
                re({ [de]: V });
              },
              min: x.standalone.triggerType === "count" ? 2 : 1024,
              max: x.standalone.triggerType === "count" ? 50 : 1e5,
              description: x.standalone.triggerType === "count" ? "" : " Token "
            }
          ),
          T && /* @__PURE__ */ m.jsxs("div", { className: "p-3 bg-muted/30 rounded-lg space-y-2", children: [
            /* @__PURE__ */ m.jsx("p", { className: "text-xs font-medium text-muted-foreground uppercase tracking-wider", children: "" }),
            /* @__PURE__ */ m.jsxs("div", { className: "text-xs text-muted-foreground space-y-1", children: [
              /* @__PURE__ */ m.jsxs("div", { className: "flex justify-between", children: [
                /* @__PURE__ */ m.jsx("span", { children: ":" }),
                /* @__PURE__ */ m.jsx("span", { className: "font-mono", children: T.pendingCount })
              ] }),
              /* @__PURE__ */ m.jsxs("div", { className: "flex justify-between", children: [
                /* @__PURE__ */ m.jsxs("span", { children: [
                  "",
                  T.triggerType === "token" ? " Token" : "",
                  ":"
                ] }),
                /* @__PURE__ */ m.jsxs("span", { className: `font-mono ${T.triggered ? "text-amber-500 font-medium" : ""}`, children: [
                  T.currentValue,
                  " / ",
                  T.threshold
                ] })
              ] }),
              T.triggered && /* @__PURE__ */ m.jsx("p", { className: "text-amber-500 text-xs mt-2", children: " " })
            ] })
          ] })
        ] }),
        /* @__PURE__ */ m.jsx(Nr, { className: "my-4" })
      ] }),
      /* @__PURE__ */ m.jsx(
        ni,
        {
          label: "",
          value: x.concurrency,
          onChange: (V) => P({ concurrency: Math.max(1, Math.min(20, V)) }),
          min: 1,
          max: 20,
          description: " (1-20)"
        }
      ),
      C && /* @__PURE__ */ m.jsxs("div", { className: "p-3 bg-muted/30 rounded-lg", children: [
        /* @__PURE__ */ m.jsx("p", { className: "text-xs text-muted-foreground mb-1", children: "" }),
        /* @__PURE__ */ m.jsxs("p", { className: "text-sm", children: [
          /* @__PURE__ */ m.jsx("span", { className: "text-primary", children: C.source }),
          C.model && /* @__PURE__ */ m.jsxs("span", { className: "text-muted-foreground ml-2", children: [
            "/ ",
            C.model
          ] })
        ] })
      ] })
    ] })
  ] });
}, Bte = ({ config: e, onChange: t }) => {
  var r, a, o, l;
  const n = (c) => {
    const d = { ...e, ...c };
    t(d);
  };
  return /* @__PURE__ */ m.jsxs("div", { className: "space-y-6 animate-in fade-in slide-in-from-right-4 duration-500", children: [
    /* @__PURE__ */ m.jsx("div", { className: "bg-secondary/20 p-4 rounded-lg border border-border/50", children: /* @__PURE__ */ m.jsxs("div", { className: "flex items-center justify-between", children: [
      /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-3", children: [
        /* @__PURE__ */ m.jsx("div", { className: `p-2 rounded-md ${e.enabled ? "bg-primary/20 text-primary" : "bg-muted text-muted-foreground"}`, children: /* @__PURE__ */ m.jsx(i7, { size: 20 }) }),
        /* @__PURE__ */ m.jsxs("div", { children: [
          /* @__PURE__ */ m.jsx("div", { className: "font-medium", children: " RAG " }),
          /* @__PURE__ */ m.jsx("div", { className: "text-xs text-muted-foreground", children: "" })
        ] })
      ] }),
      /* @__PURE__ */ m.jsx(
        Kr,
        {
          checked: e.enabled,
          onChange: (c) => n({ enabled: c })
        }
      )
    ] }) }),
    /* @__PURE__ */ m.jsxs("div", { className: "space-y-4", children: [
      /* @__PURE__ */ m.jsx("h3", { className: "text-sm font-medium text-muted-foreground uppercase tracking-wider px-1", children: "" }),
      /* @__PURE__ */ m.jsxs("div", { className: "grid grid-cols-1 md:grid-cols-2 gap-4", children: [
        /* @__PURE__ */ m.jsxs("div", { className: `p-4 rounded-lg border transition-all ${e.useBruteForce ? "bg-primary/5 border-primary/30" : "bg-card border-border/50 hover:border-border"}`, children: [
          /* @__PURE__ */ m.jsxs("div", { className: "flex items-start justify-between mb-2", children: [
            /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-2 text-sm font-medium", children: [
              /* @__PURE__ */ m.jsx(od, { size: 16, className: e.useBruteForce ? "text-primary" : "text-muted-foreground" }),
              " (Brute Force)"
            ] }),
            /* @__PURE__ */ m.jsx(
              Kr,
              {
                checked: e.useBruteForce,
                onChange: (c) => n({ useBruteForce: c })
              }
            )
          ] }),
          /* @__PURE__ */ m.jsx("p", { className: "text-xs text-muted-foreground leading-relaxed", children: "" })
        ] }),
        /* @__PURE__ */ m.jsxs("div", { className: `p-4 rounded-lg border transition-all ${e.useEmbedding ? "bg-primary/5 border-primary/30" : "bg-card border-border/50 hover:border-border"}`, children: [
          /* @__PURE__ */ m.jsxs("div", { className: "flex items-start justify-between mb-2", children: [
            /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-2 text-sm font-medium", children: [
              /* @__PURE__ */ m.jsx(M1, { size: 16, className: e.useEmbedding ? "text-primary" : "text-muted-foreground" }),
              " (Embedding)"
            ] }),
            /* @__PURE__ */ m.jsx(
              Kr,
              {
                checked: e.useEmbedding,
                onChange: (c) => n({ useEmbedding: c })
              }
            )
          ] }),
          /* @__PURE__ */ m.jsx("p", { className: "text-xs text-muted-foreground leading-relaxed", children: "RAG " })
        ] }),
        /* @__PURE__ */ m.jsxs("div", { className: `p-4 rounded-lg border transition-all ${e.usePreprocessing ? "bg-primary/5 border-primary/30" : "bg-card border-border/50 hover:border-border"}`, children: [
          /* @__PURE__ */ m.jsxs("div", { className: "flex items-start justify-between mb-2", children: [
            /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-2 text-sm font-medium", children: [
              /* @__PURE__ */ m.jsx(PO, { size: 16, className: e.usePreprocessing ? "text-primary" : "text-muted-foreground" }),
              "LLM "
            ] }),
            /* @__PURE__ */ m.jsx(
              Kr,
              {
                checked: e.usePreprocessing,
                onChange: (c) => n({ usePreprocessing: c })
              }
            )
          ] }),
          /* @__PURE__ */ m.jsx("p", { className: "text-xs text-muted-foreground leading-relaxed", children: " LLM " })
        ] }),
        /* @__PURE__ */ m.jsxs("div", { className: `p-4 rounded-lg border transition-all ${e.useRerank ? "bg-primary/5 border-primary/30" : "bg-card border-border/50 hover:border-border"}`, children: [
          /* @__PURE__ */ m.jsxs("div", { className: "flex items-start justify-between mb-2", children: [
            /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-2 text-sm font-medium", children: [
              /* @__PURE__ */ m.jsx(vS, { size: 16, className: e.useRerank ? "text-primary" : "text-muted-foreground" }),
              "Rerank "
            ] }),
            /* @__PURE__ */ m.jsx(
              Kr,
              {
                checked: e.useRerank,
                disabled: !e.useEmbedding,
                onChange: (c) => n({ useRerank: c })
              }
            )
          ] }),
          /* @__PURE__ */ m.jsxs("p", { className: "text-xs text-muted-foreground leading-relaxed", children: [
            " Rerank ",
            !e.useEmbedding && /* @__PURE__ */ m.jsxs("span", { className: "text-yellow-500 block mt-1 text-[10px] flex items-center gap-1", children: [
              /* @__PURE__ */ m.jsx(c7, { size: 10 }),
              " "
            ] })
          ] })
        ] })
      ] })
    ] }),
    /* @__PURE__ */ m.jsxs("div", { className: "grid grid-cols-1 md:grid-cols-2 gap-6 pt-4 border-t border-border/30", children: [
      /* @__PURE__ */ m.jsx(
        ni,
        {
          label: " (Top-K)",
          description: "",
          min: 1,
          max: 100,
          value: ((r = e.embedding) == null ? void 0 : r.topK) ?? 20,
          onChange: (c) => {
            var d;
            return n({
              embedding: {
                topK: c,
                minScoreThreshold: ((d = e.embedding) == null ? void 0 : d.minScoreThreshold) ?? 0.3
              }
            });
          }
        }
      ),
      /* @__PURE__ */ m.jsx(
        ni,
        {
          label: "",
          description: " (0.0 - 1.0)",
          min: 0,
          max: 1,
          step: 0.05,
          value: ((a = e.embedding) == null ? void 0 : a.minScoreThreshold) ?? 0.3,
          onChange: (c) => {
            var d;
            return n({
              embedding: {
                topK: ((d = e.embedding) == null ? void 0 : d.topK) ?? 20,
                minScoreThreshold: c
              }
            });
          }
        }
      )
    ] }),
    /* @__PURE__ */ m.jsxs("div", { className: "space-y-4 pt-4 border-t border-border/30", children: [
      /* @__PURE__ */ m.jsxs("div", { className: "flex items-center justify-between", children: [
        /* @__PURE__ */ m.jsx("h3", { className: "text-sm font-medium text-muted-foreground uppercase tracking-wider", children: " (Sticky)" }),
        /* @__PURE__ */ m.jsx(
          Kr,
          {
            checked: ((o = e.sticky) == null ? void 0 : o.enabled) ?? !0,
            onChange: (c) => n({
              sticky: {
                ...e.sticky || { decayFactor: 0.15, maxStickRounds: 3 },
                enabled: c
              }
            })
          }
        )
      ] }),
      ((l = e.sticky) == null ? void 0 : l.enabled) && /* @__PURE__ */ m.jsx("div", { className: "grid grid-cols-1 md:grid-cols-2 gap-6", children: /* @__PURE__ */ m.jsx(
        ni,
        {
          label: "",
          description: " (0-1)",
          min: 0,
          max: 1,
          step: 0.05,
          value: e.sticky.decayFactor,
          onChange: (c) => n({
            sticky: { ...e.sticky, decayFactor: c }
          })
        }
      ) })
    ] })
  ] });
}, Fte = () => {
  const [e, t] = G.useState(Ag);
  G.useEffect(() => {
    const r = nt.get("apiSettings");
    r != null && r.recallConfig && t(r.recallConfig);
  }, []);
  const n = (r) => {
    t(r);
    const a = nt.get("apiSettings");
    a && (nt.set("apiSettings", {
      ...a,
      recallConfig: r
    }), ye.debug("RecallPanel", "", r));
  };
  return /* @__PURE__ */ m.jsx("div", { className: "p-1", children: /* @__PURE__ */ m.jsx(Bte, { config: e, onChange: n }) });
}, Ute = () => {
  const [e, t] = G.useState({ ...ES, enabled: !1 }), [n, r] = G.useState(null), [a, o] = G.useState(!1), l = async () => {
    try {
      const p = await eu.getStatus();
      r(p), t(eu.getConfig());
    } catch (p) {
      console.error("[EntityConfigPanel] Failed to load status:", p);
    }
  };
  G.useEffect(() => {
    l();
  }, []);
  const c = () => {
    const p = { ...e, enabled: !e.enabled };
    eu.updateConfig(p), t(p);
  }, d = (p) => {
    const g = { ...e, floorInterval: Math.max(10, p) };
    eu.updateConfig(g), t(g);
  }, h = async () => {
    o(!0);
    try {
      await eu.extractManual(), await l();
    } catch (p) {
      console.error("[EntityConfigPanel] Manual extraction failed:", p);
    } finally {
      o(!1);
    }
  };
  return /* @__PURE__ */ m.jsxs("div", { className: "grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-12", children: [
    /* @__PURE__ */ m.jsxs("section", { className: "space-y-8", children: [
      /* @__PURE__ */ m.jsxs("div", { children: [
        /* @__PURE__ */ m.jsxs("div", { className: "flex items-center justify-between mb-6", children: [
          /* @__PURE__ */ m.jsx("h2", { className: "text-xs font-medium text-muted-foreground uppercase tracking-wider", children: "" }),
          /* @__PURE__ */ m.jsx(
            "button",
            {
              className: "p-1 rounded text-muted-foreground hover:text-foreground transition-colors",
              onClick: l,
              title: "",
              children: /* @__PURE__ */ m.jsx(zr, { size: 14 })
            }
          )
        ] }),
        n ? /* @__PURE__ */ m.jsxs("div", { className: "space-y-6", children: [
          /* @__PURE__ */ m.jsxs("div", { className: "grid grid-cols-2 gap-6", children: [
            /* @__PURE__ */ m.jsxs("div", { children: [
              /* @__PURE__ */ m.jsx("span", { className: "text-xs text-muted-foreground block mb-1", children: "" }),
              /* @__PURE__ */ m.jsx("div", { className: `text-lg font-medium ${e.enabled ? "text-green-500" : "text-muted-foreground"}`, children: e.enabled ? "" : "" })
            ] }),
            /* @__PURE__ */ m.jsxs("div", { children: [
              /* @__PURE__ */ m.jsx("span", { className: "text-xs text-muted-foreground block mb-1", children: "" }),
              /* @__PURE__ */ m.jsx("div", { className: "text-3xl font-light text-primary font-mono", children: n.entityCount })
            ] })
          ] }),
          /* @__PURE__ */ m.jsx(Nr, { length: 100, spacing: "md" }),
          /* @__PURE__ */ m.jsxs("div", { className: "grid grid-cols-2 gap-6", children: [
            /* @__PURE__ */ m.jsxs("div", { children: [
              /* @__PURE__ */ m.jsx("span", { className: "text-[10px] text-muted-foreground/70 uppercase tracking-wider block mb-1", children: "" }),
              /* @__PURE__ */ m.jsx("div", { className: "text-xl font-mono text-foreground/80", children: n.floorInterval })
            ] }),
            /* @__PURE__ */ m.jsxs("div", { children: [
              /* @__PURE__ */ m.jsx("span", { className: "text-[10px] text-muted-foreground/70 uppercase tracking-wider block mb-1", children: "" }),
              /* @__PURE__ */ m.jsx("div", { className: "text-xl font-mono text-foreground/80", children: n.lastExtractedFloor })
            ] })
          ] })
        ] }) : /* @__PURE__ */ m.jsx("p", { className: "text-sm text-muted-foreground", children: "..." })
      ] }),
      /* @__PURE__ */ m.jsx("div", { className: "flex gap-3", children: /* @__PURE__ */ m.jsxs(
        "button",
        {
          onClick: h,
          disabled: a || (n == null ? void 0 : n.isExtracting) || !e.enabled,
          className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",
          children: [
            /* @__PURE__ */ m.jsx(zr, { size: 14, className: a ? "animate-spin" : "" }),
            a ? "..." : ""
          ]
        }
      ) })
    ] }),
    /* @__PURE__ */ m.jsxs("section", { className: "space-y-6 lg:pl-8 relative", children: [
      /* @__PURE__ */ m.jsx(Nr, { responsive: !0, length: 30 }),
      /* @__PURE__ */ m.jsxs("div", { className: "flex items-center justify-between", children: [
        /* @__PURE__ */ m.jsxs("div", { children: [
          /* @__PURE__ */ m.jsx("h2", { className: "text-sm font-medium text-foreground", children: "" }),
          /* @__PURE__ */ m.jsx("p", { className: "text-xs text-muted-foreground mt-0.5", children: "" })
        ] }),
        /* @__PURE__ */ m.jsx(
          oo,
          {
            label: "",
            checked: e.enabled,
            onChange: c
          }
        )
      ] }),
      /* @__PURE__ */ m.jsxs("div", { className: `space-y-6 transition-opacity ${e.enabled ? "opacity-100" : "opacity-40 pointer-events-none"}`, children: [
        /* @__PURE__ */ m.jsxs("div", { className: "space-y-3", children: [
          /* @__PURE__ */ m.jsxs("div", { className: "text-xs text-muted-foreground", children: [
            " ",
            /* @__PURE__ */ m.jsx("span", { className: "text-base font-medium text-foreground mx-0.5", children: e.floorInterval }),
            " "
          ] }),
          /* @__PURE__ */ m.jsxs("div", { className: "relative h-4 flex items-center group cursor-pointer", children: [
            /* @__PURE__ */ m.jsx("div", { className: "absolute inset-x-0 h-[1px]", style: { backgroundColor: "var(--border)" } }),
            /* @__PURE__ */ m.jsx(
              "div",
              {
                className: "absolute top-1/2 -translate-y-1/2 w-2.5 h-2.5 bg-muted-foreground/80 rounded-full shadow-sm pointer-events-none transition-transform duration-75 ease-out group-hover:scale-125 group-hover:bg-foreground",
                style: { left: `${(e.floorInterval - 10) / 90 * 100}%`, transform: "translate(-50%, -50%)" }
              }
            ),
            /* @__PURE__ */ m.jsx(
              "input",
              {
                type: "range",
                min: 10,
                max: 100,
                step: 5,
                value: e.floorInterval,
                onChange: (p) => d(parseInt(p.target.value)),
                className: "absolute inset-x-0 w-full h-full opacity-0 cursor-pointer z-10 m-0",
                style: { appearance: "none", WebkitAppearance: "none" }
              }
            )
          ] })
        ] }),
        /* @__PURE__ */ m.jsx("p", { className: "text-xs text-muted-foreground/70 leading-relaxed", children: "" })
      ] })
    ] })
  ] });
}, $te = {
  mode: "detailed",
  chunkSize: 2e3,
  overlapSize: 200
};
class Hte {
  constructor() {
    mt(this, "queue", {
      tasks: [],
      isRunning: !1,
      isPaused: !1,
      currentTaskIndex: 0,
      overallProgress: { current: 0, total: 0 }
    });
    mt(this, "onProgress");
    mt(this, "stopSignal", !1);
  }
  /**  */
  async analyzeHistory(t = 0, n) {
    const a = cl.getStatus().currentFloor, o = n ?? a, l = cl.getConfig(), c = eu.getConfig(), d = i1.getConfig(), h = o - t, p = l.floorInterval || 10, g = c.floorInterval || 50, x = Math.ceil(h / p), b = c.enabled ? Math.ceil(h / g) : 0, C = d.countLimit || 5, N = d.enabled ? Math.floor(x / C) : 0, T = x * 2, j = x * 2e3 + b * 2e3 + N * 2e3 + T * 200;
    return {
      currentFloor: a,
      startFloor: t,
      endFloor: o,
      summaryTasks: x,
      entityTasks: b,
      trimTasks: N,
      embedTasks: T,
      estimatedTokens: j
    };
  }
  /**  */
  buildQueue(t) {
    const n = [], { startFloor: r, endFloor: a, summaryTasks: o, entityTasks: l, trimTasks: c, embedTasks: d } = t, h = cl.getConfig().floorInterval || 10, p = eu.getConfig().floorInterval || 50;
    for (let g = 0; g < o; g++) {
      const x = r + g * h, b = Math.min(x + h, a);
      n.push({
        id: zh(),
        type: "summary",
        status: "pending",
        progress: { current: 0, total: 1 },
        floorRange: { start: x, end: b }
      });
    }
    for (let g = 0; g < l; g++) {
      const x = r + g * p, b = Math.min(x + p, a);
      n.push({
        id: zh(),
        type: "entity",
        status: "pending",
        progress: { current: 0, total: 1 },
        floorRange: { start: x, end: b }
      });
    }
    for (let g = 0; g < c; g++)
      n.push({
        id: zh(),
        type: "trim",
        status: "pending",
        progress: { current: 0, total: 1 }
      });
    return n.push({
      id: zh(),
      type: "embed",
      status: "pending",
      progress: { current: 0, total: d }
    }), n;
  }
  /**  */
  async start(t = 0, n, r) {
    if (this.queue.isRunning) {
      ye.warn("BatchProcessor", "Already running");
      return;
    }
    this.onProgress = r, this.stopSignal = !1;
    const a = await this.analyzeHistory(t, n);
    this.queue.tasks = this.buildQueue(a), this.queue.isRunning = !0, this.queue.isPaused = !1, this.queue.currentTaskIndex = 0, this.queue.overallProgress = { current: 0, total: this.queue.tasks.length }, ye.info("BatchProcessor", `Starting: ${this.queue.tasks.length} tasks`), this.notifyProgress(), await this.runQueue();
  }
  /**  */
  async runQueue() {
    for (; this.queue.currentTaskIndex < this.queue.tasks.length; ) {
      if (this.stopSignal) {
        ye.info("BatchProcessor", "Stopped by user");
        break;
      }
      if (this.queue.isPaused) {
        await new Promise((n) => setTimeout(n, 500));
        continue;
      }
      const t = this.queue.tasks[this.queue.currentTaskIndex];
      t.status = "running", this.notifyProgress();
      try {
        await this.executeTask(t), t.status = "done", t.progress.current = t.progress.total;
      } catch (n) {
        t.status = "error", t.error = String(n), ye.error("BatchProcessor", `Task ${t.type} failed: ${String(n)}`);
      }
      this.queue.currentTaskIndex++, this.queue.overallProgress.current = this.queue.currentTaskIndex, this.notifyProgress();
    }
    this.queue.isRunning = !1, ye.info("BatchProcessor", "Completed"), this.notifyProgress();
  }
  /**  */
  async executeTask(t) {
    switch (t.type) {
      case "summary":
        await this.executeSummaryTask(t);
        break;
      case "entity":
        await this.executeEntityTask(t);
        break;
      case "trim":
        await this.executeTrimTask(t);
        break;
      case "embed":
        await this.executeEmbedTask(t);
        break;
    }
  }
  async executeSummaryTask(t) {
    if (!t.floorRange) return;
    await cl.setLastSummarizedFloor(t.floorRange.start), await cl.triggerSummary(!0) || (t.status = "skipped");
  }
  async executeEntityTask(t) {
    if (!t.floorRange) return;
    await eu.extractManual() || (t.status = "skipped");
  }
  async executeTrimTask(t) {
    const { canTrim: n } = await i1.canTrim();
    n ? await i1.trim(!0) : t.status = "skipped";
  }
  async executeEmbedTask(t) {
    const n = await Sr.embedUnprocessedEvents((r, a) => {
      t.progress.current = r, t.progress.total = a, this.notifyProgress();
    });
    t.progress.current = n.success;
  }
  pause() {
    this.queue.isPaused = !0, ye.info("BatchProcessor", "Paused"), this.notifyProgress();
  }
  resume() {
    this.queue.isPaused = !1, ye.info("BatchProcessor", "Resumed"), this.notifyProgress();
  }
  stop() {
    this.stopSignal = !0, this.queue.isPaused = !1, ye.info("BatchProcessor", "Stopping...");
  }
  reset() {
    this.stopSignal = !0, this.queue = {
      tasks: [],
      isRunning: !1,
      isPaused: !1,
      currentTaskIndex: 0,
      overallProgress: { current: 0, total: 0 }
    }, this.notifyProgress();
  }
  getQueue() {
    return { ...this.queue };
  }
  notifyProgress() {
    this.onProgress && this.onProgress({ ...this.queue });
  }
  // ====================  txt  ====================
  chunkText(t, n, r) {
    const a = [];
    let o = 0;
    for (; o < t.length; ) {
      const l = Math.min(o + n, t.length);
      if (a.push(t.slice(o, l)), o = l - r, o >= t.length - r) break;
    }
    return a;
  }
  async importText(t, n = $te, r) {
    const a = this.chunkText(t, n.chunkSize, n.overlapSize), o = Oi.getState();
    await o.initChat();
    let l = 0, c = 0;
    this.queue = {
      tasks: [{
        id: zh(),
        type: "embed",
        status: "running",
        progress: { current: 0, total: a.length }
      }],
      isRunning: !0,
      isPaused: !1,
      currentTaskIndex: 0,
      overallProgress: { current: 0, total: a.length }
    }, this.onProgress = r, this.stopSignal = !1, this.notifyProgress();
    for (let d = 0; d < a.length && !this.stopSignal; d++) {
      const h = a[d];
      try {
        let p = h;
        n.mode === "detailed" && (p = h);
        const g = await o.saveEvent({
          summary: p,
          structured_kv: {
            time_anchor: "",
            role: [],
            location: "",
            event: ` #${d + 1}`,
            logic: [],
            causality: ""
          },
          significance_score: 5,
          level: 0,
          is_embedded: !1,
          is_archived: !1,
          source_range: { start_index: d, end_index: d }
        });
        await Sr.embedEvent(g), l++;
      } catch (p) {
        ye.error("BatchProcessor", `Import chunk ${d} failed: ${String(p)}`), c++;
      }
      this.queue.tasks[0].progress.current = d + 1, this.queue.overallProgress.current = d + 1, this.notifyProgress();
    }
    return this.queue.isRunning = !1, this.queue.tasks[0].status = "done", this.notifyProgress(), ye.info("BatchProcessor", `Import completed: ${l} success, ${c} failed`), { success: l, failed: c };
  }
}
const qf = new Hte(), Gte = ({ status: e }) => {
  switch (e) {
    case "done":
      return /* @__PURE__ */ m.jsx(A1, { size: 14, className: "text-green-500" });
    case "error":
      return /* @__PURE__ */ m.jsx(QO, { size: 14, className: "text-red-500" });
    case "running":
      return /* @__PURE__ */ m.jsx(zr, { size: 14, className: "text-primary animate-spin" });
    case "skipped":
      return /* @__PURE__ */ m.jsx(a1, { size: 14, className: "text-muted-foreground" });
    default:
      return /* @__PURE__ */ m.jsx(a1, { size: 14, className: "text-muted-foreground/50" });
  }
}, Vte = {
  summary: "",
  entity: "",
  trim: "",
  embed: ""
}, Kte = () => {
  const e = G.useRef(null), [t, n] = G.useState(null), [r, a] = G.useState(null), [o, l] = G.useState(!1), [c, d] = G.useState(0), [h, p] = G.useState(cl.getStatus().currentFloor), [g, x] = G.useState("detailed"), [b, C] = G.useState(2e3), [N, T] = G.useState(200), [j, R] = G.useState(""), [A, z] = G.useState(null), q = G.useCallback(async () => {
    l(!0);
    try {
      const H = await qf.analyzeHistory(c, h);
      n(H), p(H.endFloor);
    } catch (H) {
      console.error("[BatchPanel] Analyze failed:", H);
    } finally {
      l(!1);
    }
  }, [c, h]), D = G.useCallback(async () => {
    t && await qf.start(t.startFloor, t.endFloor, (H) => a({ ...H }));
  }, [t]), P = G.useCallback(() => {
    r != null && r.isPaused ? qf.resume() : qf.pause();
  }, [r]), re = G.useCallback(() => qf.stop(), []), ie = G.useCallback(() => {
    qf.reset(), a(null), n(null);
  }, []), X = G.useCallback(async () => {
    if (!j.trim()) return;
    const H = await qf.importText(
      j,
      { mode: g, chunkSize: b, overlapSize: N },
      (se) => {
        se.tasks[0] && z(se.tasks[0].progress);
      }
    );
    z(null), alert(`${H.success} ${H.failed} `);
  }, [j, g, b, N]), K = G.useCallback((H) => {
    var fe;
    const se = (fe = H.target.files) == null ? void 0 : fe[0];
    if (!se) return;
    const Z = new FileReader();
    Z.onload = (he) => {
      var ge;
      return R(((ge = he.target) == null ? void 0 : ge.result) || "");
    }, Z.readAsText(se);
  }, []), V = G.useCallback(() => {
    var H;
    (H = e.current) == null || H.click();
  }, []), de = r != null && r.overallProgress ? Math.round(r.overallProgress.current / r.overallProgress.total * 100) : 0;
  return /* @__PURE__ */ m.jsxs("div", { className: "grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-12", children: [
    /* @__PURE__ */ m.jsxs("section", { className: "space-y-6", children: [
      /* @__PURE__ */ m.jsxs("div", { children: [
        /* @__PURE__ */ m.jsx("h2", { className: "text-sm font-medium text-foreground mb-1", children: "" }),
        /* @__PURE__ */ m.jsx("p", { className: "text-xs text-muted-foreground", children: "" })
      ] }),
      /* @__PURE__ */ m.jsxs("div", { className: "grid grid-cols-2 gap-6", children: [
        /* @__PURE__ */ m.jsx(
          ni,
          {
            label: "",
            value: c,
            onChange: d,
            min: 0,
            max: h,
            step: 1,
            showSlider: !1
          }
        ),
        /* @__PURE__ */ m.jsx(
          ni,
          {
            label: "",
            value: h,
            onChange: p,
            min: c,
            step: 1,
            showSlider: !1
          }
        )
      ] }),
      /* @__PURE__ */ m.jsxs(
        "button",
        {
          className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg transition-colors disabled:opacity-50",
          onClick: q,
          disabled: o || (r == null ? void 0 : r.isRunning),
          children: [
            /* @__PURE__ */ m.jsx(zr, { size: 14, className: o ? "animate-spin" : "" }),
            o ? "..." : ""
          ]
        }
      ),
      t && /* @__PURE__ */ m.jsxs(m.Fragment, { children: [
        /* @__PURE__ */ m.jsx(Nr, { length: 100, spacing: "md" }),
        /* @__PURE__ */ m.jsxs("div", { className: "space-y-4", children: [
          /* @__PURE__ */ m.jsx("h3", { className: "text-xs font-medium text-muted-foreground uppercase tracking-wider", children: "" }),
          /* @__PURE__ */ m.jsxs("div", { className: "space-y-2 text-sm", children: [
            /* @__PURE__ */ m.jsxs("div", { className: "flex justify-between", children: [
              /* @__PURE__ */ m.jsx("span", { className: "text-muted-foreground", children: " " }),
              /* @__PURE__ */ m.jsxs("span", { className: "font-mono text-foreground", children: [
                t.summaryTasks,
                " "
              ] })
            ] }),
            /* @__PURE__ */ m.jsxs("div", { className: "flex justify-between", children: [
              /* @__PURE__ */ m.jsx("span", { className: "text-muted-foreground", children: " " }),
              /* @__PURE__ */ m.jsxs("span", { className: "font-mono text-foreground", children: [
                t.entityTasks,
                " "
              ] })
            ] }),
            /* @__PURE__ */ m.jsxs("div", { className: "flex justify-between", children: [
              /* @__PURE__ */ m.jsx("span", { className: "text-muted-foreground", children: " " }),
              /* @__PURE__ */ m.jsxs("span", { className: "font-mono text-foreground", children: [
                "~",
                t.trimTasks,
                " "
              ] })
            ] }),
            /* @__PURE__ */ m.jsxs("div", { className: "flex justify-between", children: [
              /* @__PURE__ */ m.jsx("span", { className: "text-muted-foreground", children: " " }),
              /* @__PURE__ */ m.jsxs("span", { className: "font-mono text-foreground", children: [
                "~",
                t.embedTasks,
                " "
              ] })
            ] }),
            /* @__PURE__ */ m.jsx(Nr, { length: 30, spacing: "sm" }),
            /* @__PURE__ */ m.jsxs("div", { className: "flex justify-between", children: [
              /* @__PURE__ */ m.jsx("span", { className: "text-muted-foreground", children: " Token" }),
              /* @__PURE__ */ m.jsxs("span", { className: "font-mono text-primary", children: [
                "~",
                (t.estimatedTokens / 1e3).toFixed(0),
                "k"
              ] })
            ] })
          ] })
        ] }),
        /* @__PURE__ */ m.jsxs("div", { className: "flex gap-3 flex-wrap", children: [
          r != null && r.isRunning ? /* @__PURE__ */ m.jsxs(m.Fragment, { children: [
            /* @__PURE__ */ m.jsxs(
              "button",
              {
                className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg transition-colors",
                onClick: P,
                children: [
                  r.isPaused ? /* @__PURE__ */ m.jsx(dg, { size: 14 }) : /* @__PURE__ */ m.jsx(a7, { size: 14 }),
                  r.isPaused ? "" : ""
                ]
              }
            ),
            /* @__PURE__ */ m.jsxs(
              "button",
              {
                className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-red-400 hover:text-red-300 border border-red-500/30 rounded-lg transition-colors",
                onClick: re,
                children: [
                  /* @__PURE__ */ m.jsx(u7, { size: 14 }),
                  ""
                ]
              }
            )
          ] }) : /* @__PURE__ */ m.jsxs(
            "button",
            {
              className: "inline-flex items-center gap-2 px-4 py-2 text-sm bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors",
              onClick: D,
              children: [
                /* @__PURE__ */ m.jsx(dg, { size: 14 }),
                ""
              ]
            }
          ),
          r && !r.isRunning && /* @__PURE__ */ m.jsxs(
            "button",
            {
              className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg transition-colors",
              onClick: ie,
              children: [
                /* @__PURE__ */ m.jsx(o7, { size: 14 }),
                ""
              ]
            }
          )
        ] }),
        r && /* @__PURE__ */ m.jsxs("div", { className: "space-y-3", children: [
          /* @__PURE__ */ m.jsx("div", { className: "h-1.5 bg-muted rounded-full overflow-hidden", children: /* @__PURE__ */ m.jsx(
            "div",
            {
              className: "h-full bg-primary transition-all duration-300",
              style: { width: `${de}%` }
            }
          ) }),
          /* @__PURE__ */ m.jsxs("div", { className: "text-xs text-muted-foreground text-center", children: [
            de,
            "% - ",
            r.currentTaskIndex,
            "/",
            r.overallProgress.total,
            " "
          ] }),
          /* @__PURE__ */ m.jsxs("div", { className: "space-y-1 max-h-40 overflow-y-auto", children: [
            r.tasks.slice(0, 10).map((H) => /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-2 text-xs", children: [
              /* @__PURE__ */ m.jsx(Gte, { status: H.status }),
              /* @__PURE__ */ m.jsx("span", { className: H.status === "running" ? "text-foreground" : "text-muted-foreground", children: Vte[H.type] || H.type }),
              H.floorRange && /* @__PURE__ */ m.jsxs("span", { className: "text-muted-foreground/50 font-mono", children: [
                "#",
                H.floorRange.start,
                "-",
                H.floorRange.end
              ] })
            ] }, H.id)),
            r.tasks.length > 10 && /* @__PURE__ */ m.jsxs("div", { className: "text-xs text-muted-foreground/50", children: [
              "... ",
              r.tasks.length - 10,
              " "
            ] })
          ] })
        ] })
      ] })
    ] }),
    /* @__PURE__ */ m.jsxs("section", { className: "space-y-6 lg:pl-8 relative", children: [
      /* @__PURE__ */ m.jsx(Nr, { responsive: !0, length: 30 }),
      /* @__PURE__ */ m.jsxs("div", { children: [
        /* @__PURE__ */ m.jsx("h2", { className: "text-sm font-medium text-foreground mb-1", children: "" }),
        /* @__PURE__ */ m.jsx("p", { className: "text-xs text-muted-foreground", children: "" })
      ] }),
      /* @__PURE__ */ m.jsxs("div", { className: "flex items-center gap-3", children: [
        /* @__PURE__ */ m.jsx(
          "input",
          {
            ref: e,
            type: "file",
            accept: ".txt,.md",
            onChange: K,
            className: "hidden"
          }
        ),
        /* @__PURE__ */ m.jsxs(
          "button",
          {
            className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg transition-colors",
            onClick: V,
            children: [
              /* @__PURE__ */ m.jsx(f7, { size: 14 }),
              ""
            ]
          }
        ),
        j && /* @__PURE__ */ m.jsxs("span", { className: "text-xs text-muted-foreground", children: [
          " ",
          (j.length / 1024).toFixed(1),
          " KB"
        ] })
      ] }),
      /* @__PURE__ */ m.jsxs("div", { className: "space-y-3", children: [
        /* @__PURE__ */ m.jsx("span", { className: "text-xs text-muted-foreground", children: "" }),
        /* @__PURE__ */ m.jsxs("div", { className: "space-y-2", children: [
          /* @__PURE__ */ m.jsxs("label", { className: "flex items-start gap-3 cursor-pointer group", onClick: () => x("fast"), children: [
            /* @__PURE__ */ m.jsx("span", { className: `mt-0.5 w-4 h-4 rounded-full border-2 flex items-center justify-center transition-colors ${g === "fast" ? "border-primary bg-primary" : "border-border group-hover:border-muted-foreground"}`, children: g === "fast" && /* @__PURE__ */ m.jsx("span", { className: "w-1.5 h-1.5 rounded-full bg-primary-foreground" }) }),
            /* @__PURE__ */ m.jsxs("div", { children: [
              /* @__PURE__ */ m.jsx("span", { className: `text-sm ${g === "fast" ? "text-foreground" : "text-muted-foreground"}`, children: "" }),
              /* @__PURE__ */ m.jsx("p", { className: "text-[10px] text-muted-foreground", children: "   LLM" })
            ] })
          ] }),
          /* @__PURE__ */ m.jsxs("label", { className: "flex items-start gap-3 cursor-pointer group", onClick: () => x("detailed"), children: [
            /* @__PURE__ */ m.jsx("span", { className: `mt-0.5 w-4 h-4 rounded-full border-2 flex items-center justify-center transition-colors ${g === "detailed" ? "border-primary bg-primary" : "border-border group-hover:border-muted-foreground"}`, children: g === "detailed" && /* @__PURE__ */ m.jsx("span", { className: "w-1.5 h-1.5 rounded-full bg-primary-foreground" }) }),
            /* @__PURE__ */ m.jsxs("div", { children: [
              /* @__PURE__ */ m.jsx("span", { className: `text-sm ${g === "detailed" ? "text-foreground" : "text-muted-foreground"}`, children: "" }),
              /* @__PURE__ */ m.jsx("p", { className: "text-[10px] text-muted-foreground", children: "  LLM   " })
            ] })
          ] })
        ] })
      ] }),
      /* @__PURE__ */ m.jsxs("div", { className: "grid grid-cols-2 gap-6", children: [
        /* @__PURE__ */ m.jsx(
          ni,
          {
            label: "",
            value: b,
            onChange: C,
            min: 100,
            max: 1e4,
            step: 100,
            showSlider: !1
          }
        ),
        /* @__PURE__ */ m.jsx(
          ni,
          {
            label: "",
            value: N,
            onChange: T,
            min: 0,
            max: b / 2,
            step: 50,
            showSlider: !1
          }
        )
      ] }),
      j && /* @__PURE__ */ m.jsxs("div", { children: [
        /* @__PURE__ */ m.jsx("span", { className: "text-xs text-muted-foreground block mb-2", children: "" }),
        /* @__PURE__ */ m.jsxs("div", { className: "bg-muted/20 border border-border rounded-lg p-3 max-h-32 overflow-y-auto text-xs text-muted-foreground font-mono", children: [
          j.slice(0, 500),
          "..."
        ] }),
        /* @__PURE__ */ m.jsxs("div", { className: "text-[10px] text-muted-foreground mt-1", children: [
          " ",
          Math.ceil((j.length - N) / (b - N)),
          " "
        ] })
      ] }),
      /* @__PURE__ */ m.jsxs(
        "button",
        {
          className: "inline-flex items-center gap-2 px-4 py-2 text-sm bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50",
          onClick: X,
          disabled: !j || A !== null,
          children: [
            /* @__PURE__ */ m.jsx(em, { size: 14 }),
            A ? ` ${A.current}/${A.total}` : ""
          ]
        }
      ),
      A && /* @__PURE__ */ m.jsx("div", { className: "h-1.5 bg-muted rounded-full overflow-hidden", children: /* @__PURE__ */ m.jsx(
        "div",
        {
          className: "h-full bg-primary transition-all duration-300",
          style: { width: `${A.current / A.total * 100}%` }
        }
      ) })
    ] })
  ] });
}, Yte = [
  { id: "summary", label: "", icon: /* @__PURE__ */ m.jsx(em, { size: 16 }) },
  { id: "entity", label: "", icon: /* @__PURE__ */ m.jsx(i7, { size: 16 }) },
  { id: "vectorization", label: "", icon: /* @__PURE__ */ m.jsx(M1, { size: 16 }) },
  { id: "recall", label: "", icon: /* @__PURE__ */ m.jsx(Es, { size: 16 }) },
  { id: "batch", label: "", icon: /* @__PURE__ */ m.jsx(vS, { size: 16 }) }
], Wte = [
  { id: "devlog", label: "", icon: nD, linkTo: "devlog:model" },
  { id: "presets", label: "", icon: RO, linkTo: "presets:prompt" }
], Xte = ({ onNavigate: e }) => {
  const [t, n] = G.useState("summary");
  return /* @__PURE__ */ m.jsxs("div", { className: "flex flex-col h-full", children: [
    /* @__PURE__ */ m.jsxs("div", { className: "mb-6", children: [
      /* @__PURE__ */ m.jsx("h1", { className: "text-2xl font-light text-foreground tracking-tight mb-2", children: "" }),
      /* @__PURE__ */ m.jsx("p", { className: "text-sm text-muted-foreground", children: " RAG " })
    ] }),
    /* @__PURE__ */ m.jsx(Nr, { className: "mb-6" }),
    /* @__PURE__ */ m.jsx(
      G1,
      {
        tabs: Yte,
        activeTab: t,
        onChange: (r) => n(r),
        actions: /* @__PURE__ */ m.jsx(
          Ite,
          {
            links: Wte,
            onNavigate: (r) => e == null ? void 0 : e(r)
          }
        )
      }
    ),
    /* @__PURE__ */ m.jsxs("div", { className: "flex-1 overflow-y-auto no-scrollbar", children: [
      t === "summary" && /* @__PURE__ */ m.jsx(Pte, {}),
      t === "vectorization" && /* @__PURE__ */ m.jsx(qte, {}),
      t === "recall" && /* @__PURE__ */ m.jsx(Fte, {}),
      t === "entity" && /* @__PURE__ */ m.jsx(Ute, {}),
      t === "batch" && /* @__PURE__ */ m.jsx(Kte, {})
    ] })
  ] });
}, Qte = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  ProcessingView: Xte
}, Symbol.toStringTag, { value: "Module" }));
//# sourceMappingURL=index.js.map
