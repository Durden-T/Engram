var cR = Object.defineProperty;
var dR = (e, t, n) => t in e ? cR(e, t, { enumerable: !0, configurable: !0, writable: !0, value: n }) : e[t] = n;
var nt = (e, t, n) => dR(e, typeof t != "symbol" ? t + "" : t, n);
var jc = typeof globalThis < "u" ? globalThis : typeof window < "u" ? window : typeof global < "u" ? global : typeof self < "u" ? self : {};
function $s(e) {
  return e && e.__esModule && Object.prototype.hasOwnProperty.call(e, "default") ? e.default : e;
}
var mg = { exports: {} }, pc = {};
/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var z5;
function fR() {
  if (z5) return pc;
  z5 = 1;
  var e = Symbol.for("react.transitional.element"), t = Symbol.for("react.fragment");
  function n(r, a, o) {
    var l = null;
    if (o !== void 0 && (l = "" + o), a.key !== void 0 && (l = "" + a.key), "key" in a) {
      o = {};
      for (var u in a)
        u !== "key" && (o[u] = a[u]);
    } else o = a;
    return a = o.ref, {
      $$typeof: e,
      type: r,
      key: l,
      ref: a !== void 0 ? a : null,
      props: o
    };
  }
  return pc.Fragment = t, pc.jsx = n, pc.jsxs = n, pc;
}
var O5;
function hR() {
  return O5 || (O5 = 1, mg.exports = fR()), mg.exports;
}
var h = hR(), pg = { exports: {} }, mt = {};
/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var D5;
function mR() {
  if (D5) return mt;
  D5 = 1;
  var e = Symbol.for("react.transitional.element"), t = Symbol.for("react.portal"), n = Symbol.for("react.fragment"), r = Symbol.for("react.strict_mode"), a = Symbol.for("react.profiler"), o = Symbol.for("react.consumer"), l = Symbol.for("react.context"), u = Symbol.for("react.forward_ref"), f = Symbol.for("react.suspense"), d = Symbol.for("react.memo"), m = Symbol.for("react.lazy"), p = Symbol.for("react.activity"), x = Symbol.iterator;
  function y(L) {
    return L === null || typeof L != "object" ? null : (L = x && L[x] || L["@@iterator"], typeof L == "function" ? L : null);
  }
  var w = {
    isMounted: function() {
      return !1;
    },
    enqueueForceUpdate: function() {
    },
    enqueueReplaceState: function() {
    },
    enqueueSetState: function() {
    }
  }, E = Object.assign, k = {};
  function C(L, J, F) {
    this.props = L, this.context = J, this.refs = k, this.updater = F || w;
  }
  C.prototype.isReactComponent = {}, C.prototype.setState = function(L, J) {
    if (typeof L != "object" && typeof L != "function" && L != null)
      throw Error(
        "takes an object of state variables to update or a function which returns an object of state variables."
      );
    this.updater.enqueueSetState(this, L, J, "setState");
  }, C.prototype.forceUpdate = function(L) {
    this.updater.enqueueForceUpdate(this, L, "forceUpdate");
  };
  function T() {
  }
  T.prototype = C.prototype;
  function N(L, J, F) {
    this.props = L, this.context = J, this.refs = k, this.updater = F || w;
  }
  var A = N.prototype = new T();
  A.constructor = N, E(A, C.prototype), A.isPureReactComponent = !0;
  var D = Array.isArray;
  function M() {
  }
  var O = { H: null, A: null, T: null, S: null }, Y = Object.prototype.hasOwnProperty;
  function X(L, J, F) {
    var Z = F.ref;
    return {
      $$typeof: e,
      type: L,
      key: J,
      ref: Z !== void 0 ? Z : null,
      props: F
    };
  }
  function U(L, J) {
    return X(L.type, J, L.props);
  }
  function B(L) {
    return typeof L == "object" && L !== null && L.$$typeof === e;
  }
  function G(L) {
    var J = { "=": "=0", ":": "=2" };
    return "$" + L.replace(/[=:]/g, function(F) {
      return J[F];
    });
  }
  var re = /\/+/g;
  function q(L, J) {
    return typeof L == "object" && L !== null && L.key != null ? G("" + L.key) : J.toString(36);
  }
  function W(L) {
    switch (L.status) {
      case "fulfilled":
        return L.value;
      case "rejected":
        throw L.reason;
      default:
        switch (typeof L.status == "string" ? L.then(M, M) : (L.status = "pending", L.then(
          function(J) {
            L.status === "pending" && (L.status = "fulfilled", L.value = J);
          },
          function(J) {
            L.status === "pending" && (L.status = "rejected", L.reason = J);
          }
        )), L.status) {
          case "fulfilled":
            return L.value;
          case "rejected":
            throw L.reason;
        }
    }
    throw L;
  }
  function V(L, J, F, Z, oe) {
    var fe = typeof L;
    (fe === "undefined" || fe === "boolean") && (L = null);
    var Se = !1;
    if (L === null) Se = !0;
    else
      switch (fe) {
        case "bigint":
        case "string":
        case "number":
          Se = !0;
          break;
        case "object":
          switch (L.$$typeof) {
            case e:
            case t:
              Se = !0;
              break;
            case m:
              return Se = L._init, V(
                Se(L._payload),
                J,
                F,
                Z,
                oe
              );
          }
      }
    if (Se)
      return oe = oe(L), Se = Z === "" ? "." + q(L, 0) : Z, D(oe) ? (F = "", Se != null && (F = Se.replace(re, "$&/") + "/"), V(oe, J, F, "", function(ke) {
        return ke;
      })) : oe != null && (B(oe) && (oe = U(
        oe,
        F + (oe.key == null || L && L.key === oe.key ? "" : ("" + oe.key).replace(
          re,
          "$&/"
        ) + "/") + Se
      )), J.push(oe)), 1;
    Se = 0;
    var Te = Z === "" ? "." : Z + ":";
    if (D(L))
      for (var we = 0; we < L.length; we++)
        Z = L[we], fe = Te + q(Z, we), Se += V(
          Z,
          J,
          F,
          fe,
          oe
        );
    else if (we = y(L), typeof we == "function")
      for (L = we.call(L), we = 0; !(Z = L.next()).done; )
        Z = Z.value, fe = Te + q(Z, we++), Se += V(
          Z,
          J,
          F,
          fe,
          oe
        );
    else if (fe === "object") {
      if (typeof L.then == "function")
        return V(
          W(L),
          J,
          F,
          Z,
          oe
        );
      throw J = String(L), Error(
        "Objects are not valid as a React child (found: " + (J === "[object Object]" ? "object with keys {" + Object.keys(L).join(", ") + "}" : J) + "). If you meant to render a collection of children, use an array instead."
      );
    }
    return Se;
  }
  function ee(L, J, F) {
    if (L == null) return L;
    var Z = [], oe = 0;
    return V(L, Z, "", "", function(fe) {
      return J.call(F, fe, oe++);
    }), Z;
  }
  function te(L) {
    if (L._status === -1) {
      var J = L._result;
      J = J(), J.then(
        function(F) {
          (L._status === 0 || L._status === -1) && (L._status = 1, L._result = F);
        },
        function(F) {
          (L._status === 0 || L._status === -1) && (L._status = 2, L._result = F);
        }
      ), L._status === -1 && (L._status = 0, L._result = J);
    }
    if (L._status === 1) return L._result.default;
    throw L._result;
  }
  var ie = typeof reportError == "function" ? reportError : function(L) {
    if (typeof window == "object" && typeof window.ErrorEvent == "function") {
      var J = new window.ErrorEvent("error", {
        bubbles: !0,
        cancelable: !0,
        message: typeof L == "object" && L !== null && typeof L.message == "string" ? String(L.message) : String(L),
        error: L
      });
      if (!window.dispatchEvent(J)) return;
    } else if (typeof process == "object" && typeof process.emit == "function") {
      process.emit("uncaughtException", L);
      return;
    }
    console.error(L);
  }, H = {
    map: ee,
    forEach: function(L, J, F) {
      ee(
        L,
        function() {
          J.apply(this, arguments);
        },
        F
      );
    },
    count: function(L) {
      var J = 0;
      return ee(L, function() {
        J++;
      }), J;
    },
    toArray: function(L) {
      return ee(L, function(J) {
        return J;
      }) || [];
    },
    only: function(L) {
      if (!B(L))
        throw Error(
          "React.Children.only expected to receive a single React element child."
        );
      return L;
    }
  };
  return mt.Activity = p, mt.Children = H, mt.Component = C, mt.Fragment = n, mt.Profiler = a, mt.PureComponent = N, mt.StrictMode = r, mt.Suspense = f, mt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE = O, mt.__COMPILER_RUNTIME = {
    __proto__: null,
    c: function(L) {
      return O.H.useMemoCache(L);
    }
  }, mt.cache = function(L) {
    return function() {
      return L.apply(null, arguments);
    };
  }, mt.cacheSignal = function() {
    return null;
  }, mt.cloneElement = function(L, J, F) {
    if (L == null)
      throw Error(
        "The argument must be a React element, but you passed " + L + "."
      );
    var Z = E({}, L.props), oe = L.key;
    if (J != null)
      for (fe in J.key !== void 0 && (oe = "" + J.key), J)
        !Y.call(J, fe) || fe === "key" || fe === "__self" || fe === "__source" || fe === "ref" && J.ref === void 0 || (Z[fe] = J[fe]);
    var fe = arguments.length - 2;
    if (fe === 1) Z.children = F;
    else if (1 < fe) {
      for (var Se = Array(fe), Te = 0; Te < fe; Te++)
        Se[Te] = arguments[Te + 2];
      Z.children = Se;
    }
    return X(L.type, oe, Z);
  }, mt.createContext = function(L) {
    return L = {
      $$typeof: l,
      _currentValue: L,
      _currentValue2: L,
      _threadCount: 0,
      Provider: null,
      Consumer: null
    }, L.Provider = L, L.Consumer = {
      $$typeof: o,
      _context: L
    }, L;
  }, mt.createElement = function(L, J, F) {
    var Z, oe = {}, fe = null;
    if (J != null)
      for (Z in J.key !== void 0 && (fe = "" + J.key), J)
        Y.call(J, Z) && Z !== "key" && Z !== "__self" && Z !== "__source" && (oe[Z] = J[Z]);
    var Se = arguments.length - 2;
    if (Se === 1) oe.children = F;
    else if (1 < Se) {
      for (var Te = Array(Se), we = 0; we < Se; we++)
        Te[we] = arguments[we + 2];
      oe.children = Te;
    }
    if (L && L.defaultProps)
      for (Z in Se = L.defaultProps, Se)
        oe[Z] === void 0 && (oe[Z] = Se[Z]);
    return X(L, fe, oe);
  }, mt.createRef = function() {
    return { current: null };
  }, mt.forwardRef = function(L) {
    return { $$typeof: u, render: L };
  }, mt.isValidElement = B, mt.lazy = function(L) {
    return {
      $$typeof: m,
      _payload: { _status: -1, _result: L },
      _init: te
    };
  }, mt.memo = function(L, J) {
    return {
      $$typeof: d,
      type: L,
      compare: J === void 0 ? null : J
    };
  }, mt.startTransition = function(L) {
    var J = O.T, F = {};
    O.T = F;
    try {
      var Z = L(), oe = O.S;
      oe !== null && oe(F, Z), typeof Z == "object" && Z !== null && typeof Z.then == "function" && Z.then(M, ie);
    } catch (fe) {
      ie(fe);
    } finally {
      J !== null && F.types !== null && (J.types = F.types), O.T = J;
    }
  }, mt.unstable_useCacheRefresh = function() {
    return O.H.useCacheRefresh();
  }, mt.use = function(L) {
    return O.H.use(L);
  }, mt.useActionState = function(L, J, F) {
    return O.H.useActionState(L, J, F);
  }, mt.useCallback = function(L, J) {
    return O.H.useCallback(L, J);
  }, mt.useContext = function(L) {
    return O.H.useContext(L);
  }, mt.useDebugValue = function() {
  }, mt.useDeferredValue = function(L, J) {
    return O.H.useDeferredValue(L, J);
  }, mt.useEffect = function(L, J) {
    return O.H.useEffect(L, J);
  }, mt.useEffectEvent = function(L) {
    return O.H.useEffectEvent(L);
  }, mt.useId = function() {
    return O.H.useId();
  }, mt.useImperativeHandle = function(L, J, F) {
    return O.H.useImperativeHandle(L, J, F);
  }, mt.useInsertionEffect = function(L, J) {
    return O.H.useInsertionEffect(L, J);
  }, mt.useLayoutEffect = function(L, J) {
    return O.H.useLayoutEffect(L, J);
  }, mt.useMemo = function(L, J) {
    return O.H.useMemo(L, J);
  }, mt.useOptimistic = function(L, J) {
    return O.H.useOptimistic(L, J);
  }, mt.useReducer = function(L, J, F) {
    return O.H.useReducer(L, J, F);
  }, mt.useRef = function(L) {
    return O.H.useRef(L);
  }, mt.useState = function(L) {
    return O.H.useState(L);
  }, mt.useSyncExternalStore = function(L, J, F) {
    return O.H.useSyncExternalStore(
      L,
      J,
      F
    );
  }, mt.useTransition = function() {
    return O.H.useTransition();
  }, mt.version = "19.2.3", mt;
}
var I5;
function id() {
  return I5 || (I5 = 1, pg.exports = mR()), pg.exports;
}
var P = id();
const m2 = /* @__PURE__ */ $s(P);
var gg = { exports: {} }, gc = {}, yg = { exports: {} }, xg = {};
/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var L5;
function pR() {
  return L5 || (L5 = 1, (function(e) {
    function t(V, ee) {
      var te = V.length;
      V.push(ee);
      e: for (; 0 < te; ) {
        var ie = te - 1 >>> 1, H = V[ie];
        if (0 < a(H, ee))
          V[ie] = ee, V[te] = H, te = ie;
        else break e;
      }
    }
    function n(V) {
      return V.length === 0 ? null : V[0];
    }
    function r(V) {
      if (V.length === 0) return null;
      var ee = V[0], te = V.pop();
      if (te !== ee) {
        V[0] = te;
        e: for (var ie = 0, H = V.length, L = H >>> 1; ie < L; ) {
          var J = 2 * (ie + 1) - 1, F = V[J], Z = J + 1, oe = V[Z];
          if (0 > a(F, te))
            Z < H && 0 > a(oe, F) ? (V[ie] = oe, V[Z] = te, ie = Z) : (V[ie] = F, V[J] = te, ie = J);
          else if (Z < H && 0 > a(oe, te))
            V[ie] = oe, V[Z] = te, ie = Z;
          else break e;
        }
      }
      return ee;
    }
    function a(V, ee) {
      var te = V.sortIndex - ee.sortIndex;
      return te !== 0 ? te : V.id - ee.id;
    }
    if (e.unstable_now = void 0, typeof performance == "object" && typeof performance.now == "function") {
      var o = performance;
      e.unstable_now = function() {
        return o.now();
      };
    } else {
      var l = Date, u = l.now();
      e.unstable_now = function() {
        return l.now() - u;
      };
    }
    var f = [], d = [], m = 1, p = null, x = 3, y = !1, w = !1, E = !1, k = !1, C = typeof setTimeout == "function" ? setTimeout : null, T = typeof clearTimeout == "function" ? clearTimeout : null, N = typeof setImmediate < "u" ? setImmediate : null;
    function A(V) {
      for (var ee = n(d); ee !== null; ) {
        if (ee.callback === null) r(d);
        else if (ee.startTime <= V)
          r(d), ee.sortIndex = ee.expirationTime, t(f, ee);
        else break;
        ee = n(d);
      }
    }
    function D(V) {
      if (E = !1, A(V), !w)
        if (n(f) !== null)
          w = !0, M || (M = !0, G());
        else {
          var ee = n(d);
          ee !== null && W(D, ee.startTime - V);
        }
    }
    var M = !1, O = -1, Y = 5, X = -1;
    function U() {
      return k ? !0 : !(e.unstable_now() - X < Y);
    }
    function B() {
      if (k = !1, M) {
        var V = e.unstable_now();
        X = V;
        var ee = !0;
        try {
          e: {
            w = !1, E && (E = !1, T(O), O = -1), y = !0;
            var te = x;
            try {
              t: {
                for (A(V), p = n(f); p !== null && !(p.expirationTime > V && U()); ) {
                  var ie = p.callback;
                  if (typeof ie == "function") {
                    p.callback = null, x = p.priorityLevel;
                    var H = ie(
                      p.expirationTime <= V
                    );
                    if (V = e.unstable_now(), typeof H == "function") {
                      p.callback = H, A(V), ee = !0;
                      break t;
                    }
                    p === n(f) && r(f), A(V);
                  } else r(f);
                  p = n(f);
                }
                if (p !== null) ee = !0;
                else {
                  var L = n(d);
                  L !== null && W(
                    D,
                    L.startTime - V
                  ), ee = !1;
                }
              }
              break e;
            } finally {
              p = null, x = te, y = !1;
            }
            ee = void 0;
          }
        } finally {
          ee ? G() : M = !1;
        }
      }
    }
    var G;
    if (typeof N == "function")
      G = function() {
        N(B);
      };
    else if (typeof MessageChannel < "u") {
      var re = new MessageChannel(), q = re.port2;
      re.port1.onmessage = B, G = function() {
        q.postMessage(null);
      };
    } else
      G = function() {
        C(B, 0);
      };
    function W(V, ee) {
      O = C(function() {
        V(e.unstable_now());
      }, ee);
    }
    e.unstable_IdlePriority = 5, e.unstable_ImmediatePriority = 1, e.unstable_LowPriority = 4, e.unstable_NormalPriority = 3, e.unstable_Profiling = null, e.unstable_UserBlockingPriority = 2, e.unstable_cancelCallback = function(V) {
      V.callback = null;
    }, e.unstable_forceFrameRate = function(V) {
      0 > V || 125 < V ? console.error(
        "forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"
      ) : Y = 0 < V ? Math.floor(1e3 / V) : 5;
    }, e.unstable_getCurrentPriorityLevel = function() {
      return x;
    }, e.unstable_next = function(V) {
      switch (x) {
        case 1:
        case 2:
        case 3:
          var ee = 3;
          break;
        default:
          ee = x;
      }
      var te = x;
      x = ee;
      try {
        return V();
      } finally {
        x = te;
      }
    }, e.unstable_requestPaint = function() {
      k = !0;
    }, e.unstable_runWithPriority = function(V, ee) {
      switch (V) {
        case 1:
        case 2:
        case 3:
        case 4:
        case 5:
          break;
        default:
          V = 3;
      }
      var te = x;
      x = V;
      try {
        return ee();
      } finally {
        x = te;
      }
    }, e.unstable_scheduleCallback = function(V, ee, te) {
      var ie = e.unstable_now();
      switch (typeof te == "object" && te !== null ? (te = te.delay, te = typeof te == "number" && 0 < te ? ie + te : ie) : te = ie, V) {
        case 1:
          var H = -1;
          break;
        case 2:
          H = 250;
          break;
        case 5:
          H = 1073741823;
          break;
        case 4:
          H = 1e4;
          break;
        default:
          H = 5e3;
      }
      return H = te + H, V = {
        id: m++,
        callback: ee,
        priorityLevel: V,
        startTime: te,
        expirationTime: H,
        sortIndex: -1
      }, te > ie ? (V.sortIndex = te, t(d, V), n(f) === null && V === n(d) && (E ? (T(O), O = -1) : E = !0, W(D, te - ie))) : (V.sortIndex = H, t(f, V), w || y || (w = !0, M || (M = !0, G()))), V;
    }, e.unstable_shouldYield = U, e.unstable_wrapCallback = function(V) {
      var ee = x;
      return function() {
        var te = x;
        x = ee;
        try {
          return V.apply(this, arguments);
        } finally {
          x = te;
        }
      };
    };
  })(xg)), xg;
}
var q5;
function gR() {
  return q5 || (q5 = 1, yg.exports = pR()), yg.exports;
}
var vg = { exports: {} }, ar = {};
/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var P5;
function yR() {
  if (P5) return ar;
  P5 = 1;
  var e = id();
  function t(f) {
    var d = "https://react.dev/errors/" + f;
    if (1 < arguments.length) {
      d += "?args[]=" + encodeURIComponent(arguments[1]);
      for (var m = 2; m < arguments.length; m++)
        d += "&args[]=" + encodeURIComponent(arguments[m]);
    }
    return "Minified React error #" + f + "; visit " + d + " for the full message or use the non-minified dev environment for full errors and additional helpful warnings.";
  }
  function n() {
  }
  var r = {
    d: {
      f: n,
      r: function() {
        throw Error(t(522));
      },
      D: n,
      C: n,
      L: n,
      m: n,
      X: n,
      S: n,
      M: n
    },
    p: 0,
    findDOMNode: null
  }, a = Symbol.for("react.portal");
  function o(f, d, m) {
    var p = 3 < arguments.length && arguments[3] !== void 0 ? arguments[3] : null;
    return {
      $$typeof: a,
      key: p == null ? null : "" + p,
      children: f,
      containerInfo: d,
      implementation: m
    };
  }
  var l = e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;
  function u(f, d) {
    if (f === "font") return "";
    if (typeof d == "string")
      return d === "use-credentials" ? d : "";
  }
  return ar.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE = r, ar.createPortal = function(f, d) {
    var m = 2 < arguments.length && arguments[2] !== void 0 ? arguments[2] : null;
    if (!d || d.nodeType !== 1 && d.nodeType !== 9 && d.nodeType !== 11)
      throw Error(t(299));
    return o(f, d, null, m);
  }, ar.flushSync = function(f) {
    var d = l.T, m = r.p;
    try {
      if (l.T = null, r.p = 2, f) return f();
    } finally {
      l.T = d, r.p = m, r.d.f();
    }
  }, ar.preconnect = function(f, d) {
    typeof f == "string" && (d ? (d = d.crossOrigin, d = typeof d == "string" ? d === "use-credentials" ? d : "" : void 0) : d = null, r.d.C(f, d));
  }, ar.prefetchDNS = function(f) {
    typeof f == "string" && r.d.D(f);
  }, ar.preinit = function(f, d) {
    if (typeof f == "string" && d && typeof d.as == "string") {
      var m = d.as, p = u(m, d.crossOrigin), x = typeof d.integrity == "string" ? d.integrity : void 0, y = typeof d.fetchPriority == "string" ? d.fetchPriority : void 0;
      m === "style" ? r.d.S(
        f,
        typeof d.precedence == "string" ? d.precedence : void 0,
        {
          crossOrigin: p,
          integrity: x,
          fetchPriority: y
        }
      ) : m === "script" && r.d.X(f, {
        crossOrigin: p,
        integrity: x,
        fetchPriority: y,
        nonce: typeof d.nonce == "string" ? d.nonce : void 0
      });
    }
  }, ar.preinitModule = function(f, d) {
    if (typeof f == "string")
      if (typeof d == "object" && d !== null) {
        if (d.as == null || d.as === "script") {
          var m = u(
            d.as,
            d.crossOrigin
          );
          r.d.M(f, {
            crossOrigin: m,
            integrity: typeof d.integrity == "string" ? d.integrity : void 0,
            nonce: typeof d.nonce == "string" ? d.nonce : void 0
          });
        }
      } else d == null && r.d.M(f);
  }, ar.preload = function(f, d) {
    if (typeof f == "string" && typeof d == "object" && d !== null && typeof d.as == "string") {
      var m = d.as, p = u(m, d.crossOrigin);
      r.d.L(f, m, {
        crossOrigin: p,
        integrity: typeof d.integrity == "string" ? d.integrity : void 0,
        nonce: typeof d.nonce == "string" ? d.nonce : void 0,
        type: typeof d.type == "string" ? d.type : void 0,
        fetchPriority: typeof d.fetchPriority == "string" ? d.fetchPriority : void 0,
        referrerPolicy: typeof d.referrerPolicy == "string" ? d.referrerPolicy : void 0,
        imageSrcSet: typeof d.imageSrcSet == "string" ? d.imageSrcSet : void 0,
        imageSizes: typeof d.imageSizes == "string" ? d.imageSizes : void 0,
        media: typeof d.media == "string" ? d.media : void 0
      });
    }
  }, ar.preloadModule = function(f, d) {
    if (typeof f == "string")
      if (d) {
        var m = u(d.as, d.crossOrigin);
        r.d.m(f, {
          as: typeof d.as == "string" && d.as !== "script" ? d.as : void 0,
          crossOrigin: m,
          integrity: typeof d.integrity == "string" ? d.integrity : void 0
        });
      } else r.d.m(f);
  }, ar.requestFormReset = function(f) {
    r.d.r(f);
  }, ar.unstable_batchedUpdates = function(f, d) {
    return f(d);
  }, ar.useFormState = function(f, d, m) {
    return l.H.useFormState(f, d, m);
  }, ar.useFormStatus = function() {
    return l.H.useHostTransitionStatus();
  }, ar.version = "19.2.3", ar;
}
var B5;
function JN() {
  if (B5) return vg.exports;
  B5 = 1;
  function e() {
    if (!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ > "u" || typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE != "function"))
      try {
        __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e);
      } catch (t) {
        console.error(t);
      }
  }
  return e(), vg.exports = yR(), vg.exports;
}
/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var F5;
function xR() {
  if (F5) return gc;
  F5 = 1;
  var e = gR(), t = id(), n = JN();
  function r(i) {
    var s = "https://react.dev/errors/" + i;
    if (1 < arguments.length) {
      s += "?args[]=" + encodeURIComponent(arguments[1]);
      for (var c = 2; c < arguments.length; c++)
        s += "&args[]=" + encodeURIComponent(arguments[c]);
    }
    return "Minified React error #" + i + "; visit " + s + " for the full message or use the non-minified dev environment for full errors and additional helpful warnings.";
  }
  function a(i) {
    return !(!i || i.nodeType !== 1 && i.nodeType !== 9 && i.nodeType !== 11);
  }
  function o(i) {
    var s = i, c = i;
    if (i.alternate) for (; s.return; ) s = s.return;
    else {
      i = s;
      do
        s = i, (s.flags & 4098) !== 0 && (c = s.return), i = s.return;
      while (i);
    }
    return s.tag === 3 ? c : null;
  }
  function l(i) {
    if (i.tag === 13) {
      var s = i.memoizedState;
      if (s === null && (i = i.alternate, i !== null && (s = i.memoizedState)), s !== null) return s.dehydrated;
    }
    return null;
  }
  function u(i) {
    if (i.tag === 31) {
      var s = i.memoizedState;
      if (s === null && (i = i.alternate, i !== null && (s = i.memoizedState)), s !== null) return s.dehydrated;
    }
    return null;
  }
  function f(i) {
    if (o(i) !== i)
      throw Error(r(188));
  }
  function d(i) {
    var s = i.alternate;
    if (!s) {
      if (s = o(i), s === null) throw Error(r(188));
      return s !== i ? null : i;
    }
    for (var c = i, g = s; ; ) {
      var b = c.return;
      if (b === null) break;
      var S = b.alternate;
      if (S === null) {
        if (g = b.return, g !== null) {
          c = g;
          continue;
        }
        break;
      }
      if (b.child === S.child) {
        for (S = b.child; S; ) {
          if (S === c) return f(b), i;
          if (S === g) return f(b), s;
          S = S.sibling;
        }
        throw Error(r(188));
      }
      if (c.return !== g.return) c = b, g = S;
      else {
        for (var z = !1, K = b.child; K; ) {
          if (K === c) {
            z = !0, c = b, g = S;
            break;
          }
          if (K === g) {
            z = !0, g = b, c = S;
            break;
          }
          K = K.sibling;
        }
        if (!z) {
          for (K = S.child; K; ) {
            if (K === c) {
              z = !0, c = S, g = b;
              break;
            }
            if (K === g) {
              z = !0, g = S, c = b;
              break;
            }
            K = K.sibling;
          }
          if (!z) throw Error(r(189));
        }
      }
      if (c.alternate !== g) throw Error(r(190));
    }
    if (c.tag !== 3) throw Error(r(188));
    return c.stateNode.current === c ? i : s;
  }
  function m(i) {
    var s = i.tag;
    if (s === 5 || s === 26 || s === 27 || s === 6) return i;
    for (i = i.child; i !== null; ) {
      if (s = m(i), s !== null) return s;
      i = i.sibling;
    }
    return null;
  }
  var p = Object.assign, x = Symbol.for("react.element"), y = Symbol.for("react.transitional.element"), w = Symbol.for("react.portal"), E = Symbol.for("react.fragment"), k = Symbol.for("react.strict_mode"), C = Symbol.for("react.profiler"), T = Symbol.for("react.consumer"), N = Symbol.for("react.context"), A = Symbol.for("react.forward_ref"), D = Symbol.for("react.suspense"), M = Symbol.for("react.suspense_list"), O = Symbol.for("react.memo"), Y = Symbol.for("react.lazy"), X = Symbol.for("react.activity"), U = Symbol.for("react.memo_cache_sentinel"), B = Symbol.iterator;
  function G(i) {
    return i === null || typeof i != "object" ? null : (i = B && i[B] || i["@@iterator"], typeof i == "function" ? i : null);
  }
  var re = Symbol.for("react.client.reference");
  function q(i) {
    if (i == null) return null;
    if (typeof i == "function")
      return i.$$typeof === re ? null : i.displayName || i.name || null;
    if (typeof i == "string") return i;
    switch (i) {
      case E:
        return "Fragment";
      case C:
        return "Profiler";
      case k:
        return "StrictMode";
      case D:
        return "Suspense";
      case M:
        return "SuspenseList";
      case X:
        return "Activity";
    }
    if (typeof i == "object")
      switch (i.$$typeof) {
        case w:
          return "Portal";
        case N:
          return i.displayName || "Context";
        case T:
          return (i._context.displayName || "Context") + ".Consumer";
        case A:
          var s = i.render;
          return i = i.displayName, i || (i = s.displayName || s.name || "", i = i !== "" ? "ForwardRef(" + i + ")" : "ForwardRef"), i;
        case O:
          return s = i.displayName || null, s !== null ? s : q(i.type) || "Memo";
        case Y:
          s = i._payload, i = i._init;
          try {
            return q(i(s));
          } catch {
          }
      }
    return null;
  }
  var W = Array.isArray, V = t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE, ee = n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE, te = {
    pending: !1,
    data: null,
    method: null,
    action: null
  }, ie = [], H = -1;
  function L(i) {
    return { current: i };
  }
  function J(i) {
    0 > H || (i.current = ie[H], ie[H] = null, H--);
  }
  function F(i, s) {
    H++, ie[H] = i.current, i.current = s;
  }
  var Z = L(null), oe = L(null), fe = L(null), Se = L(null);
  function Te(i, s) {
    switch (F(fe, s), F(oe, i), F(Z, null), s.nodeType) {
      case 9:
      case 11:
        i = (i = s.documentElement) && (i = i.namespaceURI) ? n5(i) : 0;
        break;
      default:
        if (i = s.tagName, s = s.namespaceURI)
          s = n5(s), i = r5(s, i);
        else
          switch (i) {
            case "svg":
              i = 1;
              break;
            case "math":
              i = 2;
              break;
            default:
              i = 0;
          }
    }
    J(Z), F(Z, i);
  }
  function we() {
    J(Z), J(oe), J(fe);
  }
  function ke(i) {
    i.memoizedState !== null && F(Se, i);
    var s = Z.current, c = r5(s, i.type);
    s !== c && (F(oe, i), F(Z, c));
  }
  function _e(i) {
    oe.current === i && (J(Z), J(oe)), Se.current === i && (J(Se), dc._currentValue = te);
  }
  var Ae, Pe;
  function Qe(i) {
    if (Ae === void 0)
      try {
        throw Error();
      } catch (c) {
        var s = c.stack.trim().match(/\n( *(at )?)/);
        Ae = s && s[1] || "", Pe = -1 < c.stack.indexOf(`
    at`) ? " (<anonymous>)" : -1 < c.stack.indexOf("@") ? "@unknown:0:0" : "";
      }
    return `
` + Ae + i + Pe;
  }
  var qe = !1;
  function at(i, s) {
    if (!i || qe) return "";
    qe = !0;
    var c = Error.prepareStackTrace;
    Error.prepareStackTrace = void 0;
    try {
      var g = {
        DetermineComponentFrameRoot: function() {
          try {
            if (s) {
              var Le = function() {
                throw Error();
              };
              if (Object.defineProperty(Le.prototype, "props", {
                set: function() {
                  throw Error();
                }
              }), typeof Reflect == "object" && Reflect.construct) {
                try {
                  Reflect.construct(Le, []);
                } catch (Me) {
                  var je = Me;
                }
                Reflect.construct(i, [], Le);
              } else {
                try {
                  Le.call();
                } catch (Me) {
                  je = Me;
                }
                i.call(Le.prototype);
              }
            } else {
              try {
                throw Error();
              } catch (Me) {
                je = Me;
              }
              (Le = i()) && typeof Le.catch == "function" && Le.catch(function() {
              });
            }
          } catch (Me) {
            if (Me && je && typeof Me.stack == "string")
              return [Me.stack, je.stack];
          }
          return [null, null];
        }
      };
      g.DetermineComponentFrameRoot.displayName = "DetermineComponentFrameRoot";
      var b = Object.getOwnPropertyDescriptor(
        g.DetermineComponentFrameRoot,
        "name"
      );
      b && b.configurable && Object.defineProperty(
        g.DetermineComponentFrameRoot,
        "name",
        { value: "DetermineComponentFrameRoot" }
      );
      var S = g.DetermineComponentFrameRoot(), z = S[0], K = S[1];
      if (z && K) {
        var ae = z.split(`
`), Ee = K.split(`
`);
        for (b = g = 0; g < ae.length && !ae[g].includes("DetermineComponentFrameRoot"); )
          g++;
        for (; b < Ee.length && !Ee[b].includes(
          "DetermineComponentFrameRoot"
        ); )
          b++;
        if (g === ae.length || b === Ee.length)
          for (g = ae.length - 1, b = Ee.length - 1; 1 <= g && 0 <= b && ae[g] !== Ee[b]; )
            b--;
        for (; 1 <= g && 0 <= b; g--, b--)
          if (ae[g] !== Ee[b]) {
            if (g !== 1 || b !== 1)
              do
                if (g--, b--, 0 > b || ae[g] !== Ee[b]) {
                  var Oe = `
` + ae[g].replace(" at new ", " at ");
                  return i.displayName && Oe.includes("<anonymous>") && (Oe = Oe.replace("<anonymous>", i.displayName)), Oe;
                }
              while (1 <= g && 0 <= b);
            break;
          }
      }
    } finally {
      qe = !1, Error.prepareStackTrace = c;
    }
    return (c = i ? i.displayName || i.name : "") ? Qe(c) : "";
  }
  function st(i, s) {
    switch (i.tag) {
      case 26:
      case 27:
      case 5:
        return Qe(i.type);
      case 16:
        return Qe("Lazy");
      case 13:
        return i.child !== s && s !== null ? Qe("Suspense Fallback") : Qe("Suspense");
      case 19:
        return Qe("SuspenseList");
      case 0:
      case 15:
        return at(i.type, !1);
      case 11:
        return at(i.type.render, !1);
      case 1:
        return at(i.type, !0);
      case 31:
        return Qe("Activity");
      default:
        return "";
    }
  }
  function mn(i) {
    try {
      var s = "", c = null;
      do
        s += st(i, c), c = i, i = i.return;
      while (i);
      return s;
    } catch (g) {
      return `
Error generating stack: ` + g.message + `
` + g.stack;
    }
  }
  var Jt = Object.prototype.hasOwnProperty, Sn = e.unstable_scheduleCallback, Kt = e.unstable_cancelCallback, vn = e.unstable_shouldYield, qt = e.unstable_requestPaint, Yt = e.unstable_now, In = e.unstable_getCurrentPriorityLevel, Re = e.unstable_ImmediatePriority, Be = e.unstable_UserBlockingPriority, rt = e.unstable_NormalPriority, dt = e.unstable_LowPriority, xt = e.unstable_IdlePriority, pn = e.log, gn = e.unstable_setDisableYieldValue, It = null, Rt = null;
  function en(i) {
    if (typeof pn == "function" && gn(i), Rt && typeof Rt.setStrictMode == "function")
      try {
        Rt.setStrictMode(It, i);
      } catch {
      }
  }
  var Ge = Math.clz32 ? Math.clz32 : Za, tr = Math.log, bn = Math.LN2;
  function Za(i) {
    return i >>>= 0, i === 0 ? 32 : 31 - (tr(i) / bn | 0) | 0;
  }
  var Ye = 256, Ii = 262144, aa = 4194304;
  function Or(i) {
    var s = i & 42;
    if (s !== 0) return s;
    switch (i & -i) {
      case 1:
        return 1;
      case 2:
        return 2;
      case 4:
        return 4;
      case 8:
        return 8;
      case 16:
        return 16;
      case 32:
        return 32;
      case 64:
        return 64;
      case 128:
        return 128;
      case 256:
      case 512:
      case 1024:
      case 2048:
      case 4096:
      case 8192:
      case 16384:
      case 32768:
      case 65536:
      case 131072:
        return i & 261888;
      case 262144:
      case 524288:
      case 1048576:
      case 2097152:
        return i & 3932160;
      case 4194304:
      case 8388608:
      case 16777216:
      case 33554432:
        return i & 62914560;
      case 67108864:
        return 67108864;
      case 134217728:
        return 134217728;
      case 268435456:
        return 268435456;
      case 536870912:
        return 536870912;
      case 1073741824:
        return 0;
      default:
        return i;
    }
  }
  function sa(i, s, c) {
    var g = i.pendingLanes;
    if (g === 0) return 0;
    var b = 0, S = i.suspendedLanes, z = i.pingedLanes;
    i = i.warmLanes;
    var K = g & 134217727;
    return K !== 0 ? (g = K & ~S, g !== 0 ? b = Or(g) : (z &= K, z !== 0 ? b = Or(z) : c || (c = K & ~i, c !== 0 && (b = Or(c))))) : (K = g & ~S, K !== 0 ? b = Or(K) : z !== 0 ? b = Or(z) : c || (c = g & ~i, c !== 0 && (b = Or(c)))), b === 0 ? 0 : s !== 0 && s !== b && (s & S) === 0 && (S = b & -b, c = s & -s, S >= c || S === 32 && (c & 4194048) !== 0) ? s : b;
  }
  function gi(i, s) {
    return (i.pendingLanes & ~(i.suspendedLanes & ~i.pingedLanes) & s) === 0;
  }
  function xu(i, s) {
    switch (i) {
      case 1:
      case 2:
      case 4:
      case 8:
      case 64:
        return s + 250;
      case 16:
      case 32:
      case 128:
      case 256:
      case 512:
      case 1024:
      case 2048:
      case 4096:
      case 8192:
      case 16384:
      case 32768:
      case 65536:
      case 131072:
      case 262144:
      case 524288:
      case 1048576:
      case 2097152:
        return s + 5e3;
      case 4194304:
      case 8388608:
      case 16777216:
      case 33554432:
        return -1;
      case 67108864:
      case 134217728:
      case 268435456:
      case 536870912:
      case 1073741824:
        return -1;
      default:
        return -1;
    }
  }
  function Go() {
    var i = aa;
    return aa <<= 1, (aa & 62914560) === 0 && (aa = 4194304), i;
  }
  function Xr(i) {
    for (var s = [], c = 0; 31 > c; c++) s.push(i);
    return s;
  }
  function xr(i, s) {
    i.pendingLanes |= s, s !== 268435456 && (i.suspendedLanes = 0, i.pingedLanes = 0, i.warmLanes = 0);
  }
  function Gs(i, s, c, g, b, S) {
    var z = i.pendingLanes;
    i.pendingLanes = c, i.suspendedLanes = 0, i.pingedLanes = 0, i.warmLanes = 0, i.expiredLanes &= c, i.entangledLanes &= c, i.errorRecoveryDisabledLanes &= c, i.shellSuspendCounter = 0;
    var K = i.entanglements, ae = i.expirationTimes, Ee = i.hiddenUpdates;
    for (c = z & ~c; 0 < c; ) {
      var Oe = 31 - Ge(c), Le = 1 << Oe;
      K[Oe] = 0, ae[Oe] = -1;
      var je = Ee[Oe];
      if (je !== null)
        for (Ee[Oe] = null, Oe = 0; Oe < je.length; Oe++) {
          var Me = je[Oe];
          Me !== null && (Me.lane &= -536870913);
        }
      c &= ~Le;
    }
    g !== 0 && oa(i, g, 0), S !== 0 && b === 0 && i.tag !== 0 && (i.suspendedLanes |= S & ~(z & ~s));
  }
  function oa(i, s, c) {
    i.pendingLanes |= s, i.suspendedLanes &= ~s;
    var g = 31 - Ge(s);
    i.entangledLanes |= s, i.entanglements[g] = i.entanglements[g] | 1073741824 | c & 261930;
  }
  function Bt(i, s) {
    var c = i.entangledLanes |= s;
    for (i = i.entanglements; c; ) {
      var g = 31 - Ge(c), b = 1 << g;
      b & s | i[g] & s && (i[g] |= s), c &= ~b;
    }
  }
  function dn(i, s) {
    var c = s & -s;
    return c = (c & 42) !== 0 ? 1 : Vs(c), (c & (i.suspendedLanes | s)) !== 0 ? 0 : c;
  }
  function Vs(i) {
    switch (i) {
      case 2:
        i = 1;
        break;
      case 8:
        i = 4;
        break;
      case 32:
        i = 16;
        break;
      case 256:
      case 512:
      case 1024:
      case 2048:
      case 4096:
      case 8192:
      case 16384:
      case 32768:
      case 65536:
      case 131072:
      case 262144:
      case 524288:
      case 1048576:
      case 2097152:
      case 4194304:
      case 8388608:
      case 16777216:
      case 33554432:
        i = 128;
        break;
      case 268435456:
        i = 134217728;
        break;
      default:
        i = 0;
    }
    return i;
  }
  function Li(i) {
    return i &= -i, 2 < i ? 8 < i ? (i & 134217727) !== 0 ? 32 : 268435456 : 8 : 2;
  }
  function la() {
    var i = ee.p;
    return i !== 0 ? i : (i = window.event, i === void 0 ? 32 : k5(i.type));
  }
  function ua(i, s) {
    var c = ee.p;
    try {
      return ee.p = i, s();
    } finally {
      ee.p = c;
    }
  }
  var Wr = Math.random().toString(36).slice(2), Ut = "__reactFiber$" + Wr, fn = "__reactProps$" + Wr, $n = "__reactContainer$" + Wr, yi = "__reactEvents$" + Wr, Vo = "__reactListeners$" + Wr, Qr = "__reactHandles$" + Wr, Ks = "__reactResources$" + Wr, dr = "__reactMarker$" + Wr;
  function Ja(i) {
    delete i[Ut], delete i[fn], delete i[yi], delete i[Vo], delete i[Qr];
  }
  function Zr(i) {
    var s = i[Ut];
    if (s) return s;
    for (var c = i.parentNode; c; ) {
      if (s = c[$n] || c[Ut]) {
        if (c = s.alternate, s.child !== null || c !== null && c.child !== null)
          for (i = c5(i); i !== null; ) {
            if (c = i[Ut]) return c;
            i = c5(i);
          }
        return s;
      }
      i = c, c = i.parentNode;
    }
    return null;
  }
  function Pt(i) {
    if (i = i[Ut] || i[$n]) {
      var s = i.tag;
      if (s === 5 || s === 6 || s === 13 || s === 31 || s === 26 || s === 27 || s === 3)
        return i;
    }
    return null;
  }
  function nr(i) {
    var s = i.tag;
    if (s === 5 || s === 26 || s === 27 || s === 6) return i.stateNode;
    throw Error(r(33));
  }
  function Un(i) {
    var s = i[Ks];
    return s || (s = i[Ks] = { hoistableStyles: /* @__PURE__ */ new Map(), hoistableScripts: /* @__PURE__ */ new Map() }), s;
  }
  function hn(i) {
    i[dr] = !0;
  }
  var xi = /* @__PURE__ */ new Set(), ca = {};
  function Dr(i, s) {
    Jr(i, s), Jr(i + "Capture", s);
  }
  function Jr(i, s) {
    for (ca[i] = s, i = 0; i < s.length; i++)
      xi.add(s[i]);
  }
  var vi = RegExp(
    "^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"
  ), es = {}, da = {};
  function Ko(i) {
    return Jt.call(da, i) ? !0 : Jt.call(es, i) ? !1 : vi.test(i) ? da[i] = !0 : (es[i] = !0, !1);
  }
  function pt(i, s, c) {
    if (Ko(s))
      if (c === null) i.removeAttribute(s);
      else {
        switch (typeof c) {
          case "undefined":
          case "function":
          case "symbol":
            i.removeAttribute(s);
            return;
          case "boolean":
            var g = s.toLowerCase().slice(0, 5);
            if (g !== "data-" && g !== "aria-") {
              i.removeAttribute(s);
              return;
            }
        }
        i.setAttribute(s, "" + c);
      }
  }
  function fa(i, s, c) {
    if (c === null) i.removeAttribute(s);
    else {
      switch (typeof c) {
        case "undefined":
        case "function":
        case "symbol":
        case "boolean":
          i.removeAttribute(s);
          return;
      }
      i.setAttribute(s, "" + c);
    }
  }
  function vr(i, s, c, g) {
    if (g === null) i.removeAttribute(c);
    else {
      switch (typeof g) {
        case "undefined":
        case "function":
        case "symbol":
        case "boolean":
          i.removeAttribute(c);
          return;
      }
      i.setAttributeNS(s, c, "" + g);
    }
  }
  function Ln(i) {
    switch (typeof i) {
      case "bigint":
      case "boolean":
      case "number":
      case "string":
      case "undefined":
        return i;
      case "object":
        return i;
      default:
        return "";
    }
  }
  function qi(i) {
    var s = i.type;
    return (i = i.nodeName) && i.toLowerCase() === "input" && (s === "checkbox" || s === "radio");
  }
  function Yo(i, s, c) {
    var g = Object.getOwnPropertyDescriptor(
      i.constructor.prototype,
      s
    );
    if (!i.hasOwnProperty(s) && typeof g < "u" && typeof g.get == "function" && typeof g.set == "function") {
      var b = g.get, S = g.set;
      return Object.defineProperty(i, s, {
        configurable: !0,
        get: function() {
          return b.call(this);
        },
        set: function(z) {
          c = "" + z, S.call(this, z);
        }
      }), Object.defineProperty(i, s, {
        enumerable: g.enumerable
      }), {
        getValue: function() {
          return c;
        },
        setValue: function(z) {
          c = "" + z;
        },
        stopTracking: function() {
          i._valueTracker = null, delete i[s];
        }
      };
    }
  }
  function bi(i) {
    if (!i._valueTracker) {
      var s = qi(i) ? "checked" : "value";
      i._valueTracker = Yo(
        i,
        s,
        "" + i[s]
      );
    }
  }
  function Ys(i) {
    if (!i) return !1;
    var s = i._valueTracker;
    if (!s) return !0;
    var c = s.getValue(), g = "";
    return i && (g = qi(i) ? i.checked ? "true" : "false" : i.value), i = g, i !== c ? (s.setValue(i), !0) : !1;
  }
  function At(i) {
    if (i = i || (typeof document < "u" ? document : void 0), typeof i > "u") return null;
    try {
      return i.activeElement || i.body;
    } catch {
      return i.body;
    }
  }
  var ha = /[\n"\\]/g;
  function Cn(i) {
    return i.replace(
      ha,
      function(s) {
        return "\\" + s.charCodeAt(0).toString(16) + " ";
      }
    );
  }
  function br(i, s, c, g, b, S, z, K) {
    i.name = "", z != null && typeof z != "function" && typeof z != "symbol" && typeof z != "boolean" ? i.type = z : i.removeAttribute("type"), s != null ? z === "number" ? (s === 0 && i.value === "" || i.value != s) && (i.value = "" + Ln(s)) : i.value !== "" + Ln(s) && (i.value = "" + Ln(s)) : z !== "submit" && z !== "reset" || i.removeAttribute("value"), s != null ? ma(i, z, Ln(s)) : c != null ? ma(i, z, Ln(c)) : g != null && i.removeAttribute("value"), b == null && S != null && (i.defaultChecked = !!S), b != null && (i.checked = b && typeof b != "function" && typeof b != "symbol"), K != null && typeof K != "function" && typeof K != "symbol" && typeof K != "boolean" ? i.name = "" + Ln(K) : i.removeAttribute("name");
  }
  function ts(i, s, c, g, b, S, z, K) {
    if (S != null && typeof S != "function" && typeof S != "symbol" && typeof S != "boolean" && (i.type = S), s != null || c != null) {
      if (!(S !== "submit" && S !== "reset" || s != null)) {
        bi(i);
        return;
      }
      c = c != null ? "" + Ln(c) : "", s = s != null ? "" + Ln(s) : c, K || s === i.value || (i.value = s), i.defaultValue = s;
    }
    g = g ?? b, g = typeof g != "function" && typeof g != "symbol" && !!g, i.checked = K ? i.checked : !!g, i.defaultChecked = !!g, z != null && typeof z != "function" && typeof z != "symbol" && typeof z != "boolean" && (i.name = z), bi(i);
  }
  function ma(i, s, c) {
    s === "number" && At(i.ownerDocument) === i || i.defaultValue === "" + c || (i.defaultValue = "" + c);
  }
  function wr(i, s, c, g) {
    if (i = i.options, s) {
      s = {};
      for (var b = 0; b < c.length; b++)
        s["$" + c[b]] = !0;
      for (c = 0; c < i.length; c++)
        b = s.hasOwnProperty("$" + i[c].value), i[c].selected !== b && (i[c].selected = b), b && g && (i[c].defaultSelected = !0);
    } else {
      for (c = "" + Ln(c), s = null, b = 0; b < i.length; b++) {
        if (i[b].value === c) {
          i[b].selected = !0, g && (i[b].defaultSelected = !0);
          return;
        }
        s !== null || i[b].disabled || (s = i[b]);
      }
      s !== null && (s.selected = !0);
    }
  }
  function vu(i, s, c) {
    if (s != null && (s = "" + Ln(s), s !== i.value && (i.value = s), c == null)) {
      i.defaultValue !== s && (i.defaultValue = s);
      return;
    }
    i.defaultValue = c != null ? "" + Ln(c) : "";
  }
  function Xs(i, s, c, g) {
    if (s == null) {
      if (g != null) {
        if (c != null) throw Error(r(92));
        if (W(g)) {
          if (1 < g.length) throw Error(r(93));
          g = g[0];
        }
        c = g;
      }
      c == null && (c = ""), s = c;
    }
    c = Ln(s), i.defaultValue = c, g = i.textContent, g === c && g !== "" && g !== null && (i.value = g), bi(i);
  }
  function pa(i, s) {
    if (s) {
      var c = i.firstChild;
      if (c && c === i.lastChild && c.nodeType === 3) {
        c.nodeValue = s;
        return;
      }
    }
    i.textContent = s;
  }
  var Sm = new Set(
    "animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(
      " "
    )
  );
  function jt(i, s, c) {
    var g = s.indexOf("--") === 0;
    c == null || typeof c == "boolean" || c === "" ? g ? i.setProperty(s, "") : s === "float" ? i.cssFloat = "" : i[s] = "" : g ? i.setProperty(s, c) : typeof c != "number" || c === 0 || Sm.has(s) ? s === "float" ? i.cssFloat = c : i[s] = ("" + c).trim() : i[s] = c + "px";
  }
  function bu(i, s, c) {
    if (s != null && typeof s != "object")
      throw Error(r(62));
    if (i = i.style, c != null) {
      for (var g in c)
        !c.hasOwnProperty(g) || s != null && s.hasOwnProperty(g) || (g.indexOf("--") === 0 ? i.setProperty(g, "") : g === "float" ? i.cssFloat = "" : i[g] = "");
      for (var b in s)
        g = s[b], s.hasOwnProperty(b) && c[b] !== g && jt(i, b, g);
    } else
      for (var S in s)
        s.hasOwnProperty(S) && jt(i, S, s[S]);
  }
  function wu(i) {
    if (i.indexOf("-") === -1) return !1;
    switch (i) {
      case "annotation-xml":
      case "color-profile":
      case "font-face":
      case "font-face-src":
      case "font-face-uri":
      case "font-face-format":
      case "font-face-name":
      case "missing-glyph":
        return !1;
      default:
        return !0;
    }
  }
  var Cm = /* @__PURE__ */ new Map([
    ["acceptCharset", "accept-charset"],
    ["htmlFor", "for"],
    ["httpEquiv", "http-equiv"],
    ["crossOrigin", "crossorigin"],
    ["accentHeight", "accent-height"],
    ["alignmentBaseline", "alignment-baseline"],
    ["arabicForm", "arabic-form"],
    ["baselineShift", "baseline-shift"],
    ["capHeight", "cap-height"],
    ["clipPath", "clip-path"],
    ["clipRule", "clip-rule"],
    ["colorInterpolation", "color-interpolation"],
    ["colorInterpolationFilters", "color-interpolation-filters"],
    ["colorProfile", "color-profile"],
    ["colorRendering", "color-rendering"],
    ["dominantBaseline", "dominant-baseline"],
    ["enableBackground", "enable-background"],
    ["fillOpacity", "fill-opacity"],
    ["fillRule", "fill-rule"],
    ["floodColor", "flood-color"],
    ["floodOpacity", "flood-opacity"],
    ["fontFamily", "font-family"],
    ["fontSize", "font-size"],
    ["fontSizeAdjust", "font-size-adjust"],
    ["fontStretch", "font-stretch"],
    ["fontStyle", "font-style"],
    ["fontVariant", "font-variant"],
    ["fontWeight", "font-weight"],
    ["glyphName", "glyph-name"],
    ["glyphOrientationHorizontal", "glyph-orientation-horizontal"],
    ["glyphOrientationVertical", "glyph-orientation-vertical"],
    ["horizAdvX", "horiz-adv-x"],
    ["horizOriginX", "horiz-origin-x"],
    ["imageRendering", "image-rendering"],
    ["letterSpacing", "letter-spacing"],
    ["lightingColor", "lighting-color"],
    ["markerEnd", "marker-end"],
    ["markerMid", "marker-mid"],
    ["markerStart", "marker-start"],
    ["overlinePosition", "overline-position"],
    ["overlineThickness", "overline-thickness"],
    ["paintOrder", "paint-order"],
    ["panose-1", "panose-1"],
    ["pointerEvents", "pointer-events"],
    ["renderingIntent", "rendering-intent"],
    ["shapeRendering", "shape-rendering"],
    ["stopColor", "stop-color"],
    ["stopOpacity", "stop-opacity"],
    ["strikethroughPosition", "strikethrough-position"],
    ["strikethroughThickness", "strikethrough-thickness"],
    ["strokeDasharray", "stroke-dasharray"],
    ["strokeDashoffset", "stroke-dashoffset"],
    ["strokeLinecap", "stroke-linecap"],
    ["strokeLinejoin", "stroke-linejoin"],
    ["strokeMiterlimit", "stroke-miterlimit"],
    ["strokeOpacity", "stroke-opacity"],
    ["strokeWidth", "stroke-width"],
    ["textAnchor", "text-anchor"],
    ["textDecoration", "text-decoration"],
    ["textRendering", "text-rendering"],
    ["transformOrigin", "transform-origin"],
    ["underlinePosition", "underline-position"],
    ["underlineThickness", "underline-thickness"],
    ["unicodeBidi", "unicode-bidi"],
    ["unicodeRange", "unicode-range"],
    ["unitsPerEm", "units-per-em"],
    ["vAlphabetic", "v-alphabetic"],
    ["vHanging", "v-hanging"],
    ["vIdeographic", "v-ideographic"],
    ["vMathematical", "v-mathematical"],
    ["vectorEffect", "vector-effect"],
    ["vertAdvY", "vert-adv-y"],
    ["vertOriginX", "vert-origin-x"],
    ["vertOriginY", "vert-origin-y"],
    ["wordSpacing", "word-spacing"],
    ["writingMode", "writing-mode"],
    ["xmlnsXlink", "xmlns:xlink"],
    ["xHeight", "x-height"]
  ]), fr = /^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;
  function wi(i) {
    return fr.test("" + i) ? "javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')" : i;
  }
  function _r() {
  }
  var ei = null;
  function Xo(i) {
    return i = i.target || i.srcElement || window, i.correspondingUseElement && (i = i.correspondingUseElement), i.nodeType === 3 ? i.parentNode : i;
  }
  var ga = null, tn = null;
  function Ir(i) {
    var s = Pt(i);
    if (s && (i = s.stateNode)) {
      var c = i[fn] || null;
      e: switch (i = s.stateNode, s.type) {
        case "input":
          if (br(
            i,
            c.value,
            c.defaultValue,
            c.defaultValue,
            c.checked,
            c.defaultChecked,
            c.type,
            c.name
          ), s = c.name, c.type === "radio" && s != null) {
            for (c = i; c.parentNode; ) c = c.parentNode;
            for (c = c.querySelectorAll(
              'input[name="' + Cn(
                "" + s
              ) + '"][type="radio"]'
            ), s = 0; s < c.length; s++) {
              var g = c[s];
              if (g !== i && g.form === i.form) {
                var b = g[fn] || null;
                if (!b) throw Error(r(90));
                br(
                  g,
                  b.value,
                  b.defaultValue,
                  b.defaultValue,
                  b.checked,
                  b.defaultChecked,
                  b.type,
                  b.name
                );
              }
            }
            for (s = 0; s < c.length; s++)
              g = c[s], g.form === i.form && Ys(g);
          }
          break e;
        case "textarea":
          vu(i, c.value, c.defaultValue);
          break e;
        case "select":
          s = c.value, s != null && wr(i, !!c.multiple, s, !1);
      }
    }
  }
  var ya = !1;
  function ns(i, s, c) {
    if (ya) return i(s, c);
    ya = !0;
    try {
      var g = i(s);
      return g;
    } finally {
      if (ya = !1, (ga !== null || tn !== null) && (uf(), ga && (s = ga, i = tn, tn = ga = null, Ir(s), i)))
        for (s = 0; s < i.length; s++) Ir(i[s]);
    }
  }
  function xa(i, s) {
    var c = i.stateNode;
    if (c === null) return null;
    var g = c[fn] || null;
    if (g === null) return null;
    c = g[s];
    e: switch (s) {
      case "onClick":
      case "onClickCapture":
      case "onDoubleClick":
      case "onDoubleClickCapture":
      case "onMouseDown":
      case "onMouseDownCapture":
      case "onMouseMove":
      case "onMouseMoveCapture":
      case "onMouseUp":
      case "onMouseUpCapture":
      case "onMouseEnter":
        (g = !g.disabled) || (i = i.type, g = !(i === "button" || i === "input" || i === "select" || i === "textarea")), i = !g;
        break e;
      default:
        i = !1;
    }
    if (i) return null;
    if (c && typeof c != "function")
      throw Error(
        r(231, s, typeof c)
      );
    return c;
  }
  var Hn = !(typeof window > "u" || typeof window.document > "u" || typeof window.document.createElement > "u"), _u = !1;
  if (Hn)
    try {
      var rr = {};
      Object.defineProperty(rr, "passive", {
        get: function() {
          _u = !0;
        }
      }), window.addEventListener("test", rr, rr), window.removeEventListener("test", rr, rr);
    } catch {
      _u = !1;
    }
  var ti = null, Wo = null, rs = null;
  function is() {
    if (rs) return rs;
    var i, s = Wo, c = s.length, g, b = "value" in ti ? ti.value : ti.textContent, S = b.length;
    for (i = 0; i < c && s[i] === b[i]; i++) ;
    var z = c - i;
    for (g = 1; g <= z && s[c - g] === b[S - g]; g++) ;
    return rs = b.slice(i, 1 < g ? 1 - g : void 0);
  }
  function as(i) {
    var s = i.keyCode;
    return "charCode" in i ? (i = i.charCode, i === 0 && s === 13 && (i = 13)) : i = s, i === 10 && (i = 13), 32 <= i || i === 13 ? i : 0;
  }
  function Ws() {
    return !0;
  }
  function bd() {
    return !1;
  }
  function En(i) {
    function s(c, g, b, S, z) {
      this._reactName = c, this._targetInst = b, this.type = g, this.nativeEvent = S, this.target = z, this.currentTarget = null;
      for (var K in i)
        i.hasOwnProperty(K) && (c = i[K], this[K] = c ? c(S) : S[K]);
      return this.isDefaultPrevented = (S.defaultPrevented != null ? S.defaultPrevented : S.returnValue === !1) ? Ws : bd, this.isPropagationStopped = bd, this;
    }
    return p(s.prototype, {
      preventDefault: function() {
        this.defaultPrevented = !0;
        var c = this.nativeEvent;
        c && (c.preventDefault ? c.preventDefault() : typeof c.returnValue != "unknown" && (c.returnValue = !1), this.isDefaultPrevented = Ws);
      },
      stopPropagation: function() {
        var c = this.nativeEvent;
        c && (c.stopPropagation ? c.stopPropagation() : typeof c.cancelBubble != "unknown" && (c.cancelBubble = !0), this.isPropagationStopped = Ws);
      },
      persist: function() {
      },
      isPersistent: Ws
    }), s;
  }
  var va = {
    eventPhase: 0,
    bubbles: 0,
    cancelable: 0,
    timeStamp: function(i) {
      return i.timeStamp || Date.now();
    },
    defaultPrevented: 0,
    isTrusted: 0
  }, Qo = En(va), Pi = p({}, va, { view: 0, detail: 0 }), Zo = En(Pi), Qs, Su, Zs, Jo = p({}, Pi, {
    screenX: 0,
    screenY: 0,
    clientX: 0,
    clientY: 0,
    pageX: 0,
    pageY: 0,
    ctrlKey: 0,
    shiftKey: 0,
    altKey: 0,
    metaKey: 0,
    getModifierState: ba,
    button: 0,
    buttons: 0,
    relatedTarget: function(i) {
      return i.relatedTarget === void 0 ? i.fromElement === i.srcElement ? i.toElement : i.fromElement : i.relatedTarget;
    },
    movementX: function(i) {
      return "movementX" in i ? i.movementX : (i !== Zs && (Zs && i.type === "mousemove" ? (Qs = i.screenX - Zs.screenX, Su = i.screenY - Zs.screenY) : Su = Qs = 0, Zs = i), Qs);
    },
    movementY: function(i) {
      return "movementY" in i ? i.movementY : Su;
    }
  }), el = En(Jo), Cu = p({}, Jo, { dataTransfer: 0 }), wd = En(Cu), tl = p({}, Pi, { relatedTarget: 0 }), ss = En(tl), nl = p({}, va, {
    animationName: 0,
    elapsedTime: 0,
    pseudoElement: 0
  }), _d = En(nl), Em = p({}, va, {
    clipboardData: function(i) {
      return "clipboardData" in i ? i.clipboardData : window.clipboardData;
    }
  }), os = En(Em), Eu = p({}, va, { data: 0 }), rl = En(Eu), ku = {
    Esc: "Escape",
    Spacebar: " ",
    Left: "ArrowLeft",
    Up: "ArrowUp",
    Right: "ArrowRight",
    Down: "ArrowDown",
    Del: "Delete",
    Win: "OS",
    Menu: "ContextMenu",
    Apps: "ContextMenu",
    Scroll: "ScrollLock",
    MozPrintableKey: "Unidentified"
  }, Nu = {
    8: "Backspace",
    9: "Tab",
    12: "Clear",
    13: "Enter",
    16: "Shift",
    17: "Control",
    18: "Alt",
    19: "Pause",
    20: "CapsLock",
    27: "Escape",
    32: " ",
    33: "PageUp",
    34: "PageDown",
    35: "End",
    36: "Home",
    37: "ArrowLeft",
    38: "ArrowUp",
    39: "ArrowRight",
    40: "ArrowDown",
    45: "Insert",
    46: "Delete",
    112: "F1",
    113: "F2",
    114: "F3",
    115: "F4",
    116: "F5",
    117: "F6",
    118: "F7",
    119: "F8",
    120: "F9",
    121: "F10",
    122: "F11",
    123: "F12",
    144: "NumLock",
    145: "ScrollLock",
    224: "Meta"
  }, Gn = {
    Alt: "altKey",
    Control: "ctrlKey",
    Meta: "metaKey",
    Shift: "shiftKey"
  };
  function Js(i) {
    var s = this.nativeEvent;
    return s.getModifierState ? s.getModifierState(i) : (i = Gn[i]) ? !!s[i] : !1;
  }
  function ba() {
    return Js;
  }
  var Sd = p({}, Pi, {
    key: function(i) {
      if (i.key) {
        var s = ku[i.key] || i.key;
        if (s !== "Unidentified") return s;
      }
      return i.type === "keypress" ? (i = as(i), i === 13 ? "Enter" : String.fromCharCode(i)) : i.type === "keydown" || i.type === "keyup" ? Nu[i.keyCode] || "Unidentified" : "";
    },
    code: 0,
    location: 0,
    ctrlKey: 0,
    shiftKey: 0,
    altKey: 0,
    metaKey: 0,
    repeat: 0,
    locale: 0,
    getModifierState: ba,
    charCode: function(i) {
      return i.type === "keypress" ? as(i) : 0;
    },
    keyCode: function(i) {
      return i.type === "keydown" || i.type === "keyup" ? i.keyCode : 0;
    },
    which: function(i) {
      return i.type === "keypress" ? as(i) : i.type === "keydown" || i.type === "keyup" ? i.keyCode : 0;
    }
  }), il = En(Sd), Cd = p({}, Jo, {
    pointerId: 0,
    width: 0,
    height: 0,
    pressure: 0,
    tangentialPressure: 0,
    tiltX: 0,
    tiltY: 0,
    twist: 0,
    pointerType: 0,
    isPrimary: 0
  }), ju = En(Cd), al = p({}, Pi, {
    touches: 0,
    targetTouches: 0,
    changedTouches: 0,
    altKey: 0,
    metaKey: 0,
    ctrlKey: 0,
    shiftKey: 0,
    getModifierState: ba
  }), Tu = En(al), wa = p({}, va, {
    propertyName: 0,
    elapsedTime: 0,
    pseudoElement: 0
  }), Au = En(wa), Mu = p({}, Jo, {
    deltaX: function(i) {
      return "deltaX" in i ? i.deltaX : "wheelDeltaX" in i ? -i.wheelDeltaX : 0;
    },
    deltaY: function(i) {
      return "deltaY" in i ? i.deltaY : "wheelDeltaY" in i ? -i.wheelDeltaY : "wheelDelta" in i ? -i.wheelDelta : 0;
    },
    deltaZ: 0,
    deltaMode: 0
  }), sl = En(Mu), Ru = p({}, va, {
    newState: 0,
    oldState: 0
  }), Ed = En(Ru), km = [9, 13, 27, 32], eo = Hn && "CompositionEvent" in window, Bi = null;
  Hn && "documentMode" in document && (Bi = document.documentMode);
  var Nm = Hn && "TextEvent" in window && !Bi, ol = Hn && (!eo || Bi && 8 < Bi && 11 >= Bi), ll = " ", kd = !1;
  function zu(i, s) {
    switch (i) {
      case "keyup":
        return km.indexOf(s.keyCode) !== -1;
      case "keydown":
        return s.keyCode !== 229;
      case "keypress":
      case "mousedown":
      case "focusout":
        return !0;
      default:
        return !1;
    }
  }
  function Nd(i) {
    return i = i.detail, typeof i == "object" && "data" in i ? i.data : null;
  }
  var _a = !1;
  function jd(i, s) {
    switch (i) {
      case "compositionend":
        return Nd(s);
      case "keypress":
        return s.which !== 32 ? null : (kd = !0, ll);
      case "textInput":
        return i = s.data, i === ll && kd ? null : i;
      default:
        return null;
    }
  }
  function jm(i, s) {
    if (_a)
      return i === "compositionend" || !eo && zu(i, s) ? (i = is(), rs = Wo = ti = null, _a = !1, i) : null;
    switch (i) {
      case "paste":
        return null;
      case "keypress":
        if (!(s.ctrlKey || s.altKey || s.metaKey) || s.ctrlKey && s.altKey) {
          if (s.char && 1 < s.char.length)
            return s.char;
          if (s.which) return String.fromCharCode(s.which);
        }
        return null;
      case "compositionend":
        return ol && s.locale !== "ko" ? null : s.data;
      default:
        return null;
    }
  }
  var Td = {
    color: !0,
    date: !0,
    datetime: !0,
    "datetime-local": !0,
    email: !0,
    month: !0,
    number: !0,
    password: !0,
    range: !0,
    search: !0,
    tel: !0,
    text: !0,
    time: !0,
    url: !0,
    week: !0
  };
  function ul(i) {
    var s = i && i.nodeName && i.nodeName.toLowerCase();
    return s === "input" ? !!Td[i.type] : s === "textarea";
  }
  function Ou(i, s, c, g) {
    ga ? tn ? tn.push(g) : tn = [g] : ga = g, s = gf(s, "onChange"), 0 < s.length && (c = new Qo(
      "onChange",
      "change",
      null,
      c,
      g
    ), i.push({ event: c, listeners: s }));
  }
  var ls = null, to = null;
  function Tm(i) {
    W3(i, 0);
  }
  function cl(i) {
    var s = nr(i);
    if (Ys(s)) return i;
  }
  function no(i, s) {
    if (i === "change") return s;
  }
  var ni = !1;
  if (Hn) {
    var nn;
    if (Hn) {
      var us = "oninput" in document;
      if (!us) {
        var hr = document.createElement("div");
        hr.setAttribute("oninput", "return;"), us = typeof hr.oninput == "function";
      }
      nn = us;
    } else nn = !1;
    ni = nn && (!document.documentMode || 9 < document.documentMode);
  }
  function Ad() {
    ls && (ls.detachEvent("onpropertychange", dl), to = ls = null);
  }
  function dl(i) {
    if (i.propertyName === "value" && cl(to)) {
      var s = [];
      Ou(
        s,
        to,
        i,
        Xo(i)
      ), ns(Tm, s);
    }
  }
  function Md(i, s, c) {
    i === "focusin" ? (Ad(), ls = s, to = c, ls.attachEvent("onpropertychange", dl)) : i === "focusout" && Ad();
  }
  function Sa(i) {
    if (i === "selectionchange" || i === "keyup" || i === "keydown")
      return cl(to);
  }
  function Du(i, s) {
    if (i === "click") return cl(s);
  }
  function cs(i, s) {
    if (i === "input" || i === "change")
      return cl(s);
  }
  function Fi(i, s) {
    return i === s && (i !== 0 || 1 / i === 1 / s) || i !== i && s !== s;
  }
  var ir = typeof Object.is == "function" ? Object.is : Fi;
  function v(i, s) {
    if (ir(i, s)) return !0;
    if (typeof i != "object" || i === null || typeof s != "object" || s === null)
      return !1;
    var c = Object.keys(i), g = Object.keys(s);
    if (c.length !== g.length) return !1;
    for (g = 0; g < c.length; g++) {
      var b = c[g];
      if (!Jt.call(s, b) || !ir(i[b], s[b]))
        return !1;
    }
    return !0;
  }
  function _(i) {
    for (; i && i.firstChild; ) i = i.firstChild;
    return i;
  }
  function j(i, s) {
    var c = _(i);
    i = 0;
    for (var g; c; ) {
      if (c.nodeType === 3) {
        if (g = i + c.textContent.length, i <= s && g >= s)
          return { node: c, offset: s - i };
        i = g;
      }
      e: {
        for (; c; ) {
          if (c.nextSibling) {
            c = c.nextSibling;
            break e;
          }
          c = c.parentNode;
        }
        c = void 0;
      }
      c = _(c);
    }
  }
  function R(i, s) {
    return i && s ? i === s ? !0 : i && i.nodeType === 3 ? !1 : s && s.nodeType === 3 ? R(i, s.parentNode) : "contains" in i ? i.contains(s) : i.compareDocumentPosition ? !!(i.compareDocumentPosition(s) & 16) : !1 : !1;
  }
  function I(i) {
    i = i != null && i.ownerDocument != null && i.ownerDocument.defaultView != null ? i.ownerDocument.defaultView : window;
    for (var s = At(i.document); s instanceof i.HTMLIFrameElement; ) {
      try {
        var c = typeof s.contentWindow.location.href == "string";
      } catch {
        c = !1;
      }
      if (c) i = s.contentWindow;
      else break;
      s = At(i.document);
    }
    return s;
  }
  function $(i) {
    var s = i && i.nodeName && i.nodeName.toLowerCase();
    return s && (s === "input" && (i.type === "text" || i.type === "search" || i.type === "tel" || i.type === "url" || i.type === "password") || s === "textarea" || i.contentEditable === "true");
  }
  var Q = Hn && "documentMode" in document && 11 >= document.documentMode, ne = null, ue = null, ce = null, ge = !1;
  function se(i, s, c) {
    var g = c.window === c ? c.document : c.nodeType === 9 ? c : c.ownerDocument;
    ge || ne == null || ne !== At(g) || (g = ne, "selectionStart" in g && $(g) ? g = { start: g.selectionStart, end: g.selectionEnd } : (g = (g.ownerDocument && g.ownerDocument.defaultView || window).getSelection(), g = {
      anchorNode: g.anchorNode,
      anchorOffset: g.anchorOffset,
      focusNode: g.focusNode,
      focusOffset: g.focusOffset
    }), ce && v(ce, g) || (ce = g, g = gf(ue, "onSelect"), 0 < g.length && (s = new Qo(
      "onSelect",
      "select",
      null,
      s,
      c
    ), i.push({ event: s, listeners: g }), s.target = ne)));
  }
  function xe(i, s) {
    var c = {};
    return c[i.toLowerCase()] = s.toLowerCase(), c["Webkit" + i] = "webkit" + s, c["Moz" + i] = "moz" + s, c;
  }
  var de = {
    animationend: xe("Animation", "AnimationEnd"),
    animationiteration: xe("Animation", "AnimationIteration"),
    animationstart: xe("Animation", "AnimationStart"),
    transitionrun: xe("Transition", "TransitionRun"),
    transitionstart: xe("Transition", "TransitionStart"),
    transitioncancel: xe("Transition", "TransitionCancel"),
    transitionend: xe("Transition", "TransitionEnd")
  }, me = {}, pe = {};
  Hn && (pe = document.createElement("div").style, "AnimationEvent" in window || (delete de.animationend.animation, delete de.animationiteration.animation, delete de.animationstart.animation), "TransitionEvent" in window || delete de.transitionend.transition);
  function ye(i) {
    if (me[i]) return me[i];
    if (!de[i]) return i;
    var s = de[i], c;
    for (c in s)
      if (s.hasOwnProperty(c) && c in pe)
        return me[i] = s[c];
    return i;
  }
  var be = ye("animationend"), Ne = ye("animationiteration"), ze = ye("animationstart"), Ie = ye("transitionrun"), He = ye("transitionstart"), Xe = ye("transitioncancel"), Fe = ye("transitionend"), Ve = /* @__PURE__ */ new Map(), Ke = "abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(
    " "
  );
  Ke.push("scrollEnd");
  function $e(i, s) {
    Ve.set(i, s), Dr(s, [i]);
  }
  var Je = typeof reportError == "function" ? reportError : function(i) {
    if (typeof window == "object" && typeof window.ErrorEvent == "function") {
      var s = new window.ErrorEvent("error", {
        bubbles: !0,
        cancelable: !0,
        message: typeof i == "object" && i !== null && typeof i.message == "string" ? String(i.message) : String(i),
        error: i
      });
      if (!window.dispatchEvent(s)) return;
    } else if (typeof process == "object" && typeof process.emit == "function") {
      process.emit("uncaughtException", i);
      return;
    }
    console.error(i);
  }, ot = [], ht = 0, gt = 0;
  function Vn() {
    for (var i = ht, s = gt = ht = 0; s < i; ) {
      var c = ot[s];
      ot[s++] = null;
      var g = ot[s];
      ot[s++] = null;
      var b = ot[s];
      ot[s++] = null;
      var S = ot[s];
      if (ot[s++] = null, g !== null && b !== null) {
        var z = g.pending;
        z === null ? b.next = b : (b.next = z.next, z.next = b), g.pending = b;
      }
      S !== 0 && ro(c, b, S);
    }
  }
  function ft(i, s, c, g) {
    ot[ht++] = i, ot[ht++] = s, ot[ht++] = c, ot[ht++] = g, gt |= g, i.lanes |= g, i = i.alternate, i !== null && (i.lanes |= g);
  }
  function kn(i, s, c, g) {
    return ft(i, s, c, g), Nn(i);
  }
  function sn(i, s) {
    return ft(i, null, null, s), Nn(i);
  }
  function ro(i, s, c) {
    i.lanes |= c;
    var g = i.alternate;
    g !== null && (g.lanes |= c);
    for (var b = !1, S = i.return; S !== null; )
      S.childLanes |= c, g = S.alternate, g !== null && (g.childLanes |= c), S.tag === 22 && (i = S.stateNode, i === null || i._visibility & 1 || (b = !0)), i = S, S = S.return;
    return i.tag === 3 ? (S = i.stateNode, b && s !== null && (b = 31 - Ge(c), i = S.hiddenUpdates, g = i[b], g === null ? i[b] = [s] : g.push(s), s.lane = c | 536870912), S) : null;
  }
  function Nn(i) {
    if (50 < ic)
      throw ic = 0, qp = null, Error(r(185));
    for (var s = i.return; s !== null; )
      i = s, s = i.return;
    return i.tag === 3 ? i.stateNode : null;
  }
  var Sr = {};
  function Iu(i, s, c, g) {
    this.tag = i, this.key = c, this.sibling = this.child = this.return = this.stateNode = this.type = this.elementType = null, this.index = 0, this.refCleanup = this.ref = null, this.pendingProps = s, this.dependencies = this.memoizedState = this.updateQueue = this.memoizedProps = null, this.mode = g, this.subtreeFlags = this.flags = 0, this.deletions = null, this.childLanes = this.lanes = 0, this.alternate = null;
  }
  function Lr(i, s, c, g) {
    return new Iu(i, s, c, g);
  }
  function Am(i) {
    return i = i.prototype, !(!i || !i.isReactComponent);
  }
  function Ca(i, s) {
    var c = i.alternate;
    return c === null ? (c = Lr(
      i.tag,
      s,
      i.key,
      i.mode
    ), c.elementType = i.elementType, c.type = i.type, c.stateNode = i.stateNode, c.alternate = i, i.alternate = c) : (c.pendingProps = s, c.type = i.type, c.flags = 0, c.subtreeFlags = 0, c.deletions = null), c.flags = i.flags & 65011712, c.childLanes = i.childLanes, c.lanes = i.lanes, c.child = i.child, c.memoizedProps = i.memoizedProps, c.memoizedState = i.memoizedState, c.updateQueue = i.updateQueue, s = i.dependencies, c.dependencies = s === null ? null : { lanes: s.lanes, firstContext: s.firstContext }, c.sibling = i.sibling, c.index = i.index, c.ref = i.ref, c.refCleanup = i.refCleanup, c;
  }
  function Rw(i, s) {
    i.flags &= 65011714;
    var c = i.alternate;
    return c === null ? (i.childLanes = 0, i.lanes = s, i.child = null, i.subtreeFlags = 0, i.memoizedProps = null, i.memoizedState = null, i.updateQueue = null, i.dependencies = null, i.stateNode = null) : (i.childLanes = c.childLanes, i.lanes = c.lanes, i.child = c.child, i.subtreeFlags = 0, i.deletions = null, i.memoizedProps = c.memoizedProps, i.memoizedState = c.memoizedState, i.updateQueue = c.updateQueue, i.type = c.type, s = c.dependencies, i.dependencies = s === null ? null : {
      lanes: s.lanes,
      firstContext: s.firstContext
    }), i;
  }
  function Rd(i, s, c, g, b, S) {
    var z = 0;
    if (g = i, typeof i == "function") Am(i) && (z = 1);
    else if (typeof i == "string")
      z = ZM(
        i,
        c,
        Z.current
      ) ? 26 : i === "html" || i === "head" || i === "body" ? 27 : 5;
    else
      e: switch (i) {
        case X:
          return i = Lr(31, c, s, b), i.elementType = X, i.lanes = S, i;
        case E:
          return io(c.children, b, S, s);
        case k:
          z = 8, b |= 24;
          break;
        case C:
          return i = Lr(12, c, s, b | 2), i.elementType = C, i.lanes = S, i;
        case D:
          return i = Lr(13, c, s, b), i.elementType = D, i.lanes = S, i;
        case M:
          return i = Lr(19, c, s, b), i.elementType = M, i.lanes = S, i;
        default:
          if (typeof i == "object" && i !== null)
            switch (i.$$typeof) {
              case N:
                z = 10;
                break e;
              case T:
                z = 9;
                break e;
              case A:
                z = 11;
                break e;
              case O:
                z = 14;
                break e;
              case Y:
                z = 16, g = null;
                break e;
            }
          z = 29, c = Error(
            r(130, i === null ? "null" : typeof i, "")
          ), g = null;
      }
    return s = Lr(z, c, s, b), s.elementType = i, s.type = g, s.lanes = S, s;
  }
  function io(i, s, c, g) {
    return i = Lr(7, i, g, s), i.lanes = c, i;
  }
  function Mm(i, s, c) {
    return i = Lr(6, i, null, s), i.lanes = c, i;
  }
  function zw(i) {
    var s = Lr(18, null, null, 0);
    return s.stateNode = i, s;
  }
  function Rm(i, s, c) {
    return s = Lr(
      4,
      i.children !== null ? i.children : [],
      i.key,
      s
    ), s.lanes = c, s.stateNode = {
      containerInfo: i.containerInfo,
      pendingChildren: null,
      implementation: i.implementation
    }, s;
  }
  var Ow = /* @__PURE__ */ new WeakMap();
  function ri(i, s) {
    if (typeof i == "object" && i !== null) {
      var c = Ow.get(i);
      return c !== void 0 ? c : (s = {
        value: i,
        source: s,
        stack: mn(s)
      }, Ow.set(i, s), s);
    }
    return {
      value: i,
      source: s,
      stack: mn(s)
    };
  }
  var fl = [], hl = 0, zd = null, Lu = 0, ii = [], ai = 0, ds = null, $i = 1, Ui = "";
  function Ea(i, s) {
    fl[hl++] = Lu, fl[hl++] = zd, zd = i, Lu = s;
  }
  function Dw(i, s, c) {
    ii[ai++] = $i, ii[ai++] = Ui, ii[ai++] = ds, ds = i;
    var g = $i;
    i = Ui;
    var b = 32 - Ge(g) - 1;
    g &= ~(1 << b), c += 1;
    var S = 32 - Ge(s) + b;
    if (30 < S) {
      var z = b - b % 5;
      S = (g & (1 << z) - 1).toString(32), g >>= z, b -= z, $i = 1 << 32 - Ge(s) + b | c << b | g, Ui = S + i;
    } else
      $i = 1 << S | c << b | g, Ui = i;
  }
  function zm(i) {
    i.return !== null && (Ea(i, 1), Dw(i, 1, 0));
  }
  function Om(i) {
    for (; i === zd; )
      zd = fl[--hl], fl[hl] = null, Lu = fl[--hl], fl[hl] = null;
    for (; i === ds; )
      ds = ii[--ai], ii[ai] = null, Ui = ii[--ai], ii[ai] = null, $i = ii[--ai], ii[ai] = null;
  }
  function Iw(i, s) {
    ii[ai++] = $i, ii[ai++] = Ui, ii[ai++] = ds, $i = s.id, Ui = s.overflow, ds = i;
  }
  var Yn = null, rn = null, Tt = !1, fs = null, si = !1, Dm = Error(r(519));
  function hs(i) {
    var s = Error(
      r(
        418,
        1 < arguments.length && arguments[1] !== void 0 && arguments[1] ? "text" : "HTML",
        ""
      )
    );
    throw qu(ri(s, i)), Dm;
  }
  function Lw(i) {
    var s = i.stateNode, c = i.type, g = i.memoizedProps;
    switch (s[Ut] = i, s[fn] = g, c) {
      case "dialog":
        _t("cancel", s), _t("close", s);
        break;
      case "iframe":
      case "object":
      case "embed":
        _t("load", s);
        break;
      case "video":
      case "audio":
        for (c = 0; c < sc.length; c++)
          _t(sc[c], s);
        break;
      case "source":
        _t("error", s);
        break;
      case "img":
      case "image":
      case "link":
        _t("error", s), _t("load", s);
        break;
      case "details":
        _t("toggle", s);
        break;
      case "input":
        _t("invalid", s), ts(
          s,
          g.value,
          g.defaultValue,
          g.checked,
          g.defaultChecked,
          g.type,
          g.name,
          !0
        );
        break;
      case "select":
        _t("invalid", s);
        break;
      case "textarea":
        _t("invalid", s), Xs(s, g.value, g.defaultValue, g.children);
    }
    c = g.children, typeof c != "string" && typeof c != "number" && typeof c != "bigint" || s.textContent === "" + c || g.suppressHydrationWarning === !0 || e5(s.textContent, c) ? (g.popover != null && (_t("beforetoggle", s), _t("toggle", s)), g.onScroll != null && _t("scroll", s), g.onScrollEnd != null && _t("scrollend", s), g.onClick != null && (s.onclick = _r), s = !0) : s = !1, s || hs(i, !0);
  }
  function qw(i) {
    for (Yn = i.return; Yn; )
      switch (Yn.tag) {
        case 5:
        case 31:
        case 13:
          si = !1;
          return;
        case 27:
        case 3:
          si = !0;
          return;
        default:
          Yn = Yn.return;
      }
  }
  function ml(i) {
    if (i !== Yn) return !1;
    if (!Tt) return qw(i), Tt = !0, !1;
    var s = i.tag, c;
    if ((c = s !== 3 && s !== 27) && ((c = s === 5) && (c = i.type, c = !(c !== "form" && c !== "button") || Jp(i.type, i.memoizedProps)), c = !c), c && rn && hs(i), qw(i), s === 13) {
      if (i = i.memoizedState, i = i !== null ? i.dehydrated : null, !i) throw Error(r(317));
      rn = u5(i);
    } else if (s === 31) {
      if (i = i.memoizedState, i = i !== null ? i.dehydrated : null, !i) throw Error(r(317));
      rn = u5(i);
    } else
      s === 27 ? (s = rn, Ns(i.type) ? (i = ig, ig = null, rn = i) : rn = s) : rn = Yn ? li(i.stateNode.nextSibling) : null;
    return !0;
  }
  function ao() {
    rn = Yn = null, Tt = !1;
  }
  function Im() {
    var i = fs;
    return i !== null && (Nr === null ? Nr = i : Nr.push.apply(
      Nr,
      i
    ), fs = null), i;
  }
  function qu(i) {
    fs === null ? fs = [i] : fs.push(i);
  }
  var Lm = L(null), so = null, ka = null;
  function ms(i, s, c) {
    F(Lm, s._currentValue), s._currentValue = c;
  }
  function Na(i) {
    i._currentValue = Lm.current, J(Lm);
  }
  function qm(i, s, c) {
    for (; i !== null; ) {
      var g = i.alternate;
      if ((i.childLanes & s) !== s ? (i.childLanes |= s, g !== null && (g.childLanes |= s)) : g !== null && (g.childLanes & s) !== s && (g.childLanes |= s), i === c) break;
      i = i.return;
    }
  }
  function Pm(i, s, c, g) {
    var b = i.child;
    for (b !== null && (b.return = i); b !== null; ) {
      var S = b.dependencies;
      if (S !== null) {
        var z = b.child;
        S = S.firstContext;
        e: for (; S !== null; ) {
          var K = S;
          S = b;
          for (var ae = 0; ae < s.length; ae++)
            if (K.context === s[ae]) {
              S.lanes |= c, K = S.alternate, K !== null && (K.lanes |= c), qm(
                S.return,
                c,
                i
              ), g || (z = null);
              break e;
            }
          S = K.next;
        }
      } else if (b.tag === 18) {
        if (z = b.return, z === null) throw Error(r(341));
        z.lanes |= c, S = z.alternate, S !== null && (S.lanes |= c), qm(z, c, i), z = null;
      } else z = b.child;
      if (z !== null) z.return = b;
      else
        for (z = b; z !== null; ) {
          if (z === i) {
            z = null;
            break;
          }
          if (b = z.sibling, b !== null) {
            b.return = z.return, z = b;
            break;
          }
          z = z.return;
        }
      b = z;
    }
  }
  function pl(i, s, c, g) {
    i = null;
    for (var b = s, S = !1; b !== null; ) {
      if (!S) {
        if ((b.flags & 524288) !== 0) S = !0;
        else if ((b.flags & 262144) !== 0) break;
      }
      if (b.tag === 10) {
        var z = b.alternate;
        if (z === null) throw Error(r(387));
        if (z = z.memoizedProps, z !== null) {
          var K = b.type;
          ir(b.pendingProps.value, z.value) || (i !== null ? i.push(K) : i = [K]);
        }
      } else if (b === Se.current) {
        if (z = b.alternate, z === null) throw Error(r(387));
        z.memoizedState.memoizedState !== b.memoizedState.memoizedState && (i !== null ? i.push(dc) : i = [dc]);
      }
      b = b.return;
    }
    i !== null && Pm(
      s,
      i,
      c,
      g
    ), s.flags |= 262144;
  }
  function Od(i) {
    for (i = i.firstContext; i !== null; ) {
      if (!ir(
        i.context._currentValue,
        i.memoizedValue
      ))
        return !0;
      i = i.next;
    }
    return !1;
  }
  function oo(i) {
    so = i, ka = null, i = i.dependencies, i !== null && (i.firstContext = null);
  }
  function Xn(i) {
    return Pw(so, i);
  }
  function Dd(i, s) {
    return so === null && oo(i), Pw(i, s);
  }
  function Pw(i, s) {
    var c = s._currentValue;
    if (s = { context: s, memoizedValue: c, next: null }, ka === null) {
      if (i === null) throw Error(r(308));
      ka = s, i.dependencies = { lanes: 0, firstContext: s }, i.flags |= 524288;
    } else ka = ka.next = s;
    return c;
  }
  var YA = typeof AbortController < "u" ? AbortController : function() {
    var i = [], s = this.signal = {
      aborted: !1,
      addEventListener: function(c, g) {
        i.push(g);
      }
    };
    this.abort = function() {
      s.aborted = !0, i.forEach(function(c) {
        return c();
      });
    };
  }, XA = e.unstable_scheduleCallback, WA = e.unstable_NormalPriority, jn = {
    $$typeof: N,
    Consumer: null,
    Provider: null,
    _currentValue: null,
    _currentValue2: null,
    _threadCount: 0
  };
  function Bm() {
    return {
      controller: new YA(),
      data: /* @__PURE__ */ new Map(),
      refCount: 0
    };
  }
  function Pu(i) {
    i.refCount--, i.refCount === 0 && XA(WA, function() {
      i.controller.abort();
    });
  }
  var Bu = null, Fm = 0, gl = 0, yl = null;
  function QA(i, s) {
    if (Bu === null) {
      var c = Bu = [];
      Fm = 0, gl = Hp(), yl = {
        status: "pending",
        value: void 0,
        then: function(g) {
          c.push(g);
        }
      };
    }
    return Fm++, s.then(Bw, Bw), s;
  }
  function Bw() {
    if (--Fm === 0 && Bu !== null) {
      yl !== null && (yl.status = "fulfilled");
      var i = Bu;
      Bu = null, gl = 0, yl = null;
      for (var s = 0; s < i.length; s++) (0, i[s])();
    }
  }
  function ZA(i, s) {
    var c = [], g = {
      status: "pending",
      value: null,
      reason: null,
      then: function(b) {
        c.push(b);
      }
    };
    return i.then(
      function() {
        g.status = "fulfilled", g.value = s;
        for (var b = 0; b < c.length; b++) (0, c[b])(s);
      },
      function(b) {
        for (g.status = "rejected", g.reason = b, b = 0; b < c.length; b++)
          (0, c[b])(void 0);
      }
    ), g;
  }
  var Fw = V.S;
  V.S = function(i, s) {
    C3 = Yt(), typeof s == "object" && s !== null && typeof s.then == "function" && QA(i, s), Fw !== null && Fw(i, s);
  };
  var lo = L(null);
  function $m() {
    var i = lo.current;
    return i !== null ? i : Xt.pooledCache;
  }
  function Id(i, s) {
    s === null ? F(lo, lo.current) : F(lo, s.pool);
  }
  function $w() {
    var i = $m();
    return i === null ? null : { parent: jn._currentValue, pool: i };
  }
  var xl = Error(r(460)), Um = Error(r(474)), Ld = Error(r(542)), qd = { then: function() {
  } };
  function Uw(i) {
    return i = i.status, i === "fulfilled" || i === "rejected";
  }
  function Hw(i, s, c) {
    switch (c = i[c], c === void 0 ? i.push(s) : c !== s && (s.then(_r, _r), s = c), s.status) {
      case "fulfilled":
        return s.value;
      case "rejected":
        throw i = s.reason, Vw(i), i;
      default:
        if (typeof s.status == "string") s.then(_r, _r);
        else {
          if (i = Xt, i !== null && 100 < i.shellSuspendCounter)
            throw Error(r(482));
          i = s, i.status = "pending", i.then(
            function(g) {
              if (s.status === "pending") {
                var b = s;
                b.status = "fulfilled", b.value = g;
              }
            },
            function(g) {
              if (s.status === "pending") {
                var b = s;
                b.status = "rejected", b.reason = g;
              }
            }
          );
        }
        switch (s.status) {
          case "fulfilled":
            return s.value;
          case "rejected":
            throw i = s.reason, Vw(i), i;
        }
        throw co = s, xl;
    }
  }
  function uo(i) {
    try {
      var s = i._init;
      return s(i._payload);
    } catch (c) {
      throw c !== null && typeof c == "object" && typeof c.then == "function" ? (co = c, xl) : c;
    }
  }
  var co = null;
  function Gw() {
    if (co === null) throw Error(r(459));
    var i = co;
    return co = null, i;
  }
  function Vw(i) {
    if (i === xl || i === Ld)
      throw Error(r(483));
  }
  var vl = null, Fu = 0;
  function Pd(i) {
    var s = Fu;
    return Fu += 1, vl === null && (vl = []), Hw(vl, i, s);
  }
  function $u(i, s) {
    s = s.props.ref, i.ref = s !== void 0 ? s : null;
  }
  function Bd(i, s) {
    throw s.$$typeof === x ? Error(r(525)) : (i = Object.prototype.toString.call(s), Error(
      r(
        31,
        i === "[object Object]" ? "object with keys {" + Object.keys(s).join(", ") + "}" : i
      )
    ));
  }
  function Kw(i) {
    function s(ve, he) {
      if (i) {
        var Ce = ve.deletions;
        Ce === null ? (ve.deletions = [he], ve.flags |= 16) : Ce.push(he);
      }
    }
    function c(ve, he) {
      if (!i) return null;
      for (; he !== null; )
        s(ve, he), he = he.sibling;
      return null;
    }
    function g(ve) {
      for (var he = /* @__PURE__ */ new Map(); ve !== null; )
        ve.key !== null ? he.set(ve.key, ve) : he.set(ve.index, ve), ve = ve.sibling;
      return he;
    }
    function b(ve, he) {
      return ve = Ca(ve, he), ve.index = 0, ve.sibling = null, ve;
    }
    function S(ve, he, Ce) {
      return ve.index = Ce, i ? (Ce = ve.alternate, Ce !== null ? (Ce = Ce.index, Ce < he ? (ve.flags |= 67108866, he) : Ce) : (ve.flags |= 67108866, he)) : (ve.flags |= 1048576, he);
    }
    function z(ve) {
      return i && ve.alternate === null && (ve.flags |= 67108866), ve;
    }
    function K(ve, he, Ce, De) {
      return he === null || he.tag !== 6 ? (he = Mm(Ce, ve.mode, De), he.return = ve, he) : (he = b(he, Ce), he.return = ve, he);
    }
    function ae(ve, he, Ce, De) {
      var lt = Ce.type;
      return lt === E ? Oe(
        ve,
        he,
        Ce.props.children,
        De,
        Ce.key
      ) : he !== null && (he.elementType === lt || typeof lt == "object" && lt !== null && lt.$$typeof === Y && uo(lt) === he.type) ? (he = b(he, Ce.props), $u(he, Ce), he.return = ve, he) : (he = Rd(
        Ce.type,
        Ce.key,
        Ce.props,
        null,
        ve.mode,
        De
      ), $u(he, Ce), he.return = ve, he);
    }
    function Ee(ve, he, Ce, De) {
      return he === null || he.tag !== 4 || he.stateNode.containerInfo !== Ce.containerInfo || he.stateNode.implementation !== Ce.implementation ? (he = Rm(Ce, ve.mode, De), he.return = ve, he) : (he = b(he, Ce.children || []), he.return = ve, he);
    }
    function Oe(ve, he, Ce, De, lt) {
      return he === null || he.tag !== 7 ? (he = io(
        Ce,
        ve.mode,
        De,
        lt
      ), he.return = ve, he) : (he = b(he, Ce), he.return = ve, he);
    }
    function Le(ve, he, Ce) {
      if (typeof he == "string" && he !== "" || typeof he == "number" || typeof he == "bigint")
        return he = Mm(
          "" + he,
          ve.mode,
          Ce
        ), he.return = ve, he;
      if (typeof he == "object" && he !== null) {
        switch (he.$$typeof) {
          case y:
            return Ce = Rd(
              he.type,
              he.key,
              he.props,
              null,
              ve.mode,
              Ce
            ), $u(Ce, he), Ce.return = ve, Ce;
          case w:
            return he = Rm(
              he,
              ve.mode,
              Ce
            ), he.return = ve, he;
          case Y:
            return he = uo(he), Le(ve, he, Ce);
        }
        if (W(he) || G(he))
          return he = io(
            he,
            ve.mode,
            Ce,
            null
          ), he.return = ve, he;
        if (typeof he.then == "function")
          return Le(ve, Pd(he), Ce);
        if (he.$$typeof === N)
          return Le(
            ve,
            Dd(ve, he),
            Ce
          );
        Bd(ve, he);
      }
      return null;
    }
    function je(ve, he, Ce, De) {
      var lt = he !== null ? he.key : null;
      if (typeof Ce == "string" && Ce !== "" || typeof Ce == "number" || typeof Ce == "bigint")
        return lt !== null ? null : K(ve, he, "" + Ce, De);
      if (typeof Ce == "object" && Ce !== null) {
        switch (Ce.$$typeof) {
          case y:
            return Ce.key === lt ? ae(ve, he, Ce, De) : null;
          case w:
            return Ce.key === lt ? Ee(ve, he, Ce, De) : null;
          case Y:
            return Ce = uo(Ce), je(ve, he, Ce, De);
        }
        if (W(Ce) || G(Ce))
          return lt !== null ? null : Oe(ve, he, Ce, De, null);
        if (typeof Ce.then == "function")
          return je(
            ve,
            he,
            Pd(Ce),
            De
          );
        if (Ce.$$typeof === N)
          return je(
            ve,
            he,
            Dd(ve, Ce),
            De
          );
        Bd(ve, Ce);
      }
      return null;
    }
    function Me(ve, he, Ce, De, lt) {
      if (typeof De == "string" && De !== "" || typeof De == "number" || typeof De == "bigint")
        return ve = ve.get(Ce) || null, K(he, ve, "" + De, lt);
      if (typeof De == "object" && De !== null) {
        switch (De.$$typeof) {
          case y:
            return ve = ve.get(
              De.key === null ? Ce : De.key
            ) || null, ae(he, ve, De, lt);
          case w:
            return ve = ve.get(
              De.key === null ? Ce : De.key
            ) || null, Ee(he, ve, De, lt);
          case Y:
            return De = uo(De), Me(
              ve,
              he,
              Ce,
              De,
              lt
            );
        }
        if (W(De) || G(De))
          return ve = ve.get(Ce) || null, Oe(he, ve, De, lt, null);
        if (typeof De.then == "function")
          return Me(
            ve,
            he,
            Ce,
            Pd(De),
            lt
          );
        if (De.$$typeof === N)
          return Me(
            ve,
            he,
            Ce,
            Dd(he, De),
            lt
          );
        Bd(he, De);
      }
      return null;
    }
    function tt(ve, he, Ce, De) {
      for (var lt = null, Ot = null, it = he, vt = he = 0, kt = null; it !== null && vt < Ce.length; vt++) {
        it.index > vt ? (kt = it, it = null) : kt = it.sibling;
        var Dt = je(
          ve,
          it,
          Ce[vt],
          De
        );
        if (Dt === null) {
          it === null && (it = kt);
          break;
        }
        i && it && Dt.alternate === null && s(ve, it), he = S(Dt, he, vt), Ot === null ? lt = Dt : Ot.sibling = Dt, Ot = Dt, it = kt;
      }
      if (vt === Ce.length)
        return c(ve, it), Tt && Ea(ve, vt), lt;
      if (it === null) {
        for (; vt < Ce.length; vt++)
          it = Le(ve, Ce[vt], De), it !== null && (he = S(
            it,
            he,
            vt
          ), Ot === null ? lt = it : Ot.sibling = it, Ot = it);
        return Tt && Ea(ve, vt), lt;
      }
      for (it = g(it); vt < Ce.length; vt++)
        kt = Me(
          it,
          ve,
          vt,
          Ce[vt],
          De
        ), kt !== null && (i && kt.alternate !== null && it.delete(
          kt.key === null ? vt : kt.key
        ), he = S(
          kt,
          he,
          vt
        ), Ot === null ? lt = kt : Ot.sibling = kt, Ot = kt);
      return i && it.forEach(function(Rs) {
        return s(ve, Rs);
      }), Tt && Ea(ve, vt), lt;
    }
    function ct(ve, he, Ce, De) {
      if (Ce == null) throw Error(r(151));
      for (var lt = null, Ot = null, it = he, vt = he = 0, kt = null, Dt = Ce.next(); it !== null && !Dt.done; vt++, Dt = Ce.next()) {
        it.index > vt ? (kt = it, it = null) : kt = it.sibling;
        var Rs = je(ve, it, Dt.value, De);
        if (Rs === null) {
          it === null && (it = kt);
          break;
        }
        i && it && Rs.alternate === null && s(ve, it), he = S(Rs, he, vt), Ot === null ? lt = Rs : Ot.sibling = Rs, Ot = Rs, it = kt;
      }
      if (Dt.done)
        return c(ve, it), Tt && Ea(ve, vt), lt;
      if (it === null) {
        for (; !Dt.done; vt++, Dt = Ce.next())
          Dt = Le(ve, Dt.value, De), Dt !== null && (he = S(Dt, he, vt), Ot === null ? lt = Dt : Ot.sibling = Dt, Ot = Dt);
        return Tt && Ea(ve, vt), lt;
      }
      for (it = g(it); !Dt.done; vt++, Dt = Ce.next())
        Dt = Me(it, ve, vt, Dt.value, De), Dt !== null && (i && Dt.alternate !== null && it.delete(Dt.key === null ? vt : Dt.key), he = S(Dt, he, vt), Ot === null ? lt = Dt : Ot.sibling = Dt, Ot = Dt);
      return i && it.forEach(function(uR) {
        return s(ve, uR);
      }), Tt && Ea(ve, vt), lt;
    }
    function Vt(ve, he, Ce, De) {
      if (typeof Ce == "object" && Ce !== null && Ce.type === E && Ce.key === null && (Ce = Ce.props.children), typeof Ce == "object" && Ce !== null) {
        switch (Ce.$$typeof) {
          case y:
            e: {
              for (var lt = Ce.key; he !== null; ) {
                if (he.key === lt) {
                  if (lt = Ce.type, lt === E) {
                    if (he.tag === 7) {
                      c(
                        ve,
                        he.sibling
                      ), De = b(
                        he,
                        Ce.props.children
                      ), De.return = ve, ve = De;
                      break e;
                    }
                  } else if (he.elementType === lt || typeof lt == "object" && lt !== null && lt.$$typeof === Y && uo(lt) === he.type) {
                    c(
                      ve,
                      he.sibling
                    ), De = b(he, Ce.props), $u(De, Ce), De.return = ve, ve = De;
                    break e;
                  }
                  c(ve, he);
                  break;
                } else s(ve, he);
                he = he.sibling;
              }
              Ce.type === E ? (De = io(
                Ce.props.children,
                ve.mode,
                De,
                Ce.key
              ), De.return = ve, ve = De) : (De = Rd(
                Ce.type,
                Ce.key,
                Ce.props,
                null,
                ve.mode,
                De
              ), $u(De, Ce), De.return = ve, ve = De);
            }
            return z(ve);
          case w:
            e: {
              for (lt = Ce.key; he !== null; ) {
                if (he.key === lt)
                  if (he.tag === 4 && he.stateNode.containerInfo === Ce.containerInfo && he.stateNode.implementation === Ce.implementation) {
                    c(
                      ve,
                      he.sibling
                    ), De = b(he, Ce.children || []), De.return = ve, ve = De;
                    break e;
                  } else {
                    c(ve, he);
                    break;
                  }
                else s(ve, he);
                he = he.sibling;
              }
              De = Rm(Ce, ve.mode, De), De.return = ve, ve = De;
            }
            return z(ve);
          case Y:
            return Ce = uo(Ce), Vt(
              ve,
              he,
              Ce,
              De
            );
        }
        if (W(Ce))
          return tt(
            ve,
            he,
            Ce,
            De
          );
        if (G(Ce)) {
          if (lt = G(Ce), typeof lt != "function") throw Error(r(150));
          return Ce = lt.call(Ce), ct(
            ve,
            he,
            Ce,
            De
          );
        }
        if (typeof Ce.then == "function")
          return Vt(
            ve,
            he,
            Pd(Ce),
            De
          );
        if (Ce.$$typeof === N)
          return Vt(
            ve,
            he,
            Dd(ve, Ce),
            De
          );
        Bd(ve, Ce);
      }
      return typeof Ce == "string" && Ce !== "" || typeof Ce == "number" || typeof Ce == "bigint" ? (Ce = "" + Ce, he !== null && he.tag === 6 ? (c(ve, he.sibling), De = b(he, Ce), De.return = ve, ve = De) : (c(ve, he), De = Mm(Ce, ve.mode, De), De.return = ve, ve = De), z(ve)) : c(ve, he);
    }
    return function(ve, he, Ce, De) {
      try {
        Fu = 0;
        var lt = Vt(
          ve,
          he,
          Ce,
          De
        );
        return vl = null, lt;
      } catch (it) {
        if (it === xl || it === Ld) throw it;
        var Ot = Lr(29, it, null, ve.mode);
        return Ot.lanes = De, Ot.return = ve, Ot;
      } finally {
      }
    };
  }
  var fo = Kw(!0), Yw = Kw(!1), ps = !1;
  function Hm(i) {
    i.updateQueue = {
      baseState: i.memoizedState,
      firstBaseUpdate: null,
      lastBaseUpdate: null,
      shared: { pending: null, lanes: 0, hiddenCallbacks: null },
      callbacks: null
    };
  }
  function Gm(i, s) {
    i = i.updateQueue, s.updateQueue === i && (s.updateQueue = {
      baseState: i.baseState,
      firstBaseUpdate: i.firstBaseUpdate,
      lastBaseUpdate: i.lastBaseUpdate,
      shared: i.shared,
      callbacks: null
    });
  }
  function gs(i) {
    return { lane: i, tag: 0, payload: null, callback: null, next: null };
  }
  function ys(i, s, c) {
    var g = i.updateQueue;
    if (g === null) return null;
    if (g = g.shared, (Lt & 2) !== 0) {
      var b = g.pending;
      return b === null ? s.next = s : (s.next = b.next, b.next = s), g.pending = s, s = Nn(i), ro(i, null, c), s;
    }
    return ft(i, g, s, c), Nn(i);
  }
  function Uu(i, s, c) {
    if (s = s.updateQueue, s !== null && (s = s.shared, (c & 4194048) !== 0)) {
      var g = s.lanes;
      g &= i.pendingLanes, c |= g, s.lanes = c, Bt(i, c);
    }
  }
  function Vm(i, s) {
    var c = i.updateQueue, g = i.alternate;
    if (g !== null && (g = g.updateQueue, c === g)) {
      var b = null, S = null;
      if (c = c.firstBaseUpdate, c !== null) {
        do {
          var z = {
            lane: c.lane,
            tag: c.tag,
            payload: c.payload,
            callback: null,
            next: null
          };
          S === null ? b = S = z : S = S.next = z, c = c.next;
        } while (c !== null);
        S === null ? b = S = s : S = S.next = s;
      } else b = S = s;
      c = {
        baseState: g.baseState,
        firstBaseUpdate: b,
        lastBaseUpdate: S,
        shared: g.shared,
        callbacks: g.callbacks
      }, i.updateQueue = c;
      return;
    }
    i = c.lastBaseUpdate, i === null ? c.firstBaseUpdate = s : i.next = s, c.lastBaseUpdate = s;
  }
  var Km = !1;
  function Hu() {
    if (Km) {
      var i = yl;
      if (i !== null) throw i;
    }
  }
  function Gu(i, s, c, g) {
    Km = !1;
    var b = i.updateQueue;
    ps = !1;
    var S = b.firstBaseUpdate, z = b.lastBaseUpdate, K = b.shared.pending;
    if (K !== null) {
      b.shared.pending = null;
      var ae = K, Ee = ae.next;
      ae.next = null, z === null ? S = Ee : z.next = Ee, z = ae;
      var Oe = i.alternate;
      Oe !== null && (Oe = Oe.updateQueue, K = Oe.lastBaseUpdate, K !== z && (K === null ? Oe.firstBaseUpdate = Ee : K.next = Ee, Oe.lastBaseUpdate = ae));
    }
    if (S !== null) {
      var Le = b.baseState;
      z = 0, Oe = Ee = ae = null, K = S;
      do {
        var je = K.lane & -536870913, Me = je !== K.lane;
        if (Me ? (Et & je) === je : (g & je) === je) {
          je !== 0 && je === gl && (Km = !0), Oe !== null && (Oe = Oe.next = {
            lane: 0,
            tag: K.tag,
            payload: K.payload,
            callback: null,
            next: null
          });
          e: {
            var tt = i, ct = K;
            je = s;
            var Vt = c;
            switch (ct.tag) {
              case 1:
                if (tt = ct.payload, typeof tt == "function") {
                  Le = tt.call(Vt, Le, je);
                  break e;
                }
                Le = tt;
                break e;
              case 3:
                tt.flags = tt.flags & -65537 | 128;
              case 0:
                if (tt = ct.payload, je = typeof tt == "function" ? tt.call(Vt, Le, je) : tt, je == null) break e;
                Le = p({}, Le, je);
                break e;
              case 2:
                ps = !0;
            }
          }
          je = K.callback, je !== null && (i.flags |= 64, Me && (i.flags |= 8192), Me = b.callbacks, Me === null ? b.callbacks = [je] : Me.push(je));
        } else
          Me = {
            lane: je,
            tag: K.tag,
            payload: K.payload,
            callback: K.callback,
            next: null
          }, Oe === null ? (Ee = Oe = Me, ae = Le) : Oe = Oe.next = Me, z |= je;
        if (K = K.next, K === null) {
          if (K = b.shared.pending, K === null)
            break;
          Me = K, K = Me.next, Me.next = null, b.lastBaseUpdate = Me, b.shared.pending = null;
        }
      } while (!0);
      Oe === null && (ae = Le), b.baseState = ae, b.firstBaseUpdate = Ee, b.lastBaseUpdate = Oe, S === null && (b.shared.lanes = 0), _s |= z, i.lanes = z, i.memoizedState = Le;
    }
  }
  function Xw(i, s) {
    if (typeof i != "function")
      throw Error(r(191, i));
    i.call(s);
  }
  function Ww(i, s) {
    var c = i.callbacks;
    if (c !== null)
      for (i.callbacks = null, i = 0; i < c.length; i++)
        Xw(c[i], s);
  }
  var bl = L(null), Fd = L(0);
  function Qw(i, s) {
    i = Ia, F(Fd, i), F(bl, s), Ia = i | s.baseLanes;
  }
  function Ym() {
    F(Fd, Ia), F(bl, bl.current);
  }
  function Xm() {
    Ia = Fd.current, J(bl), J(Fd);
  }
  var qr = L(null), oi = null;
  function xs(i) {
    var s = i.alternate;
    F(wn, wn.current & 1), F(qr, i), oi === null && (s === null || bl.current !== null || s.memoizedState !== null) && (oi = i);
  }
  function Wm(i) {
    F(wn, wn.current), F(qr, i), oi === null && (oi = i);
  }
  function Zw(i) {
    i.tag === 22 ? (F(wn, wn.current), F(qr, i), oi === null && (oi = i)) : vs();
  }
  function vs() {
    F(wn, wn.current), F(qr, qr.current);
  }
  function Pr(i) {
    J(qr), oi === i && (oi = null), J(wn);
  }
  var wn = L(0);
  function $d(i) {
    for (var s = i; s !== null; ) {
      if (s.tag === 13) {
        var c = s.memoizedState;
        if (c !== null && (c = c.dehydrated, c === null || ng(c) || rg(c)))
          return s;
      } else if (s.tag === 19 && (s.memoizedProps.revealOrder === "forwards" || s.memoizedProps.revealOrder === "backwards" || s.memoizedProps.revealOrder === "unstable_legacy-backwards" || s.memoizedProps.revealOrder === "together")) {
        if ((s.flags & 128) !== 0) return s;
      } else if (s.child !== null) {
        s.child.return = s, s = s.child;
        continue;
      }
      if (s === i) break;
      for (; s.sibling === null; ) {
        if (s.return === null || s.return === i) return null;
        s = s.return;
      }
      s.sibling.return = s.return, s = s.sibling;
    }
    return null;
  }
  var ja = 0, yt = null, Ht = null, Tn = null, Ud = !1, wl = !1, ho = !1, Hd = 0, Vu = 0, _l = null, JA = 0;
  function yn() {
    throw Error(r(321));
  }
  function Qm(i, s) {
    if (s === null) return !1;
    for (var c = 0; c < s.length && c < i.length; c++)
      if (!ir(i[c], s[c])) return !1;
    return !0;
  }
  function Zm(i, s, c, g, b, S) {
    return ja = S, yt = s, s.memoizedState = null, s.updateQueue = null, s.lanes = 0, V.H = i === null || i.memoizedState === null ? D4 : hp, ho = !1, S = c(g, b), ho = !1, wl && (S = e4(
      s,
      c,
      g,
      b
    )), Jw(i), S;
  }
  function Jw(i) {
    V.H = Xu;
    var s = Ht !== null && Ht.next !== null;
    if (ja = 0, Tn = Ht = yt = null, Ud = !1, Vu = 0, _l = null, s) throw Error(r(300));
    i === null || An || (i = i.dependencies, i !== null && Od(i) && (An = !0));
  }
  function e4(i, s, c, g) {
    yt = i;
    var b = 0;
    do {
      if (wl && (_l = null), Vu = 0, wl = !1, 25 <= b) throw Error(r(301));
      if (b += 1, Tn = Ht = null, i.updateQueue != null) {
        var S = i.updateQueue;
        S.lastEffect = null, S.events = null, S.stores = null, S.memoCache != null && (S.memoCache.index = 0);
      }
      V.H = I4, S = s(c, g);
    } while (wl);
    return S;
  }
  function eM() {
    var i = V.H, s = i.useState()[0];
    return s = typeof s.then == "function" ? Ku(s) : s, i = i.useState()[0], (Ht !== null ? Ht.memoizedState : null) !== i && (yt.flags |= 1024), s;
  }
  function Jm() {
    var i = Hd !== 0;
    return Hd = 0, i;
  }
  function ep(i, s, c) {
    s.updateQueue = i.updateQueue, s.flags &= -2053, i.lanes &= ~c;
  }
  function tp(i) {
    if (Ud) {
      for (i = i.memoizedState; i !== null; ) {
        var s = i.queue;
        s !== null && (s.pending = null), i = i.next;
      }
      Ud = !1;
    }
    ja = 0, Tn = Ht = yt = null, wl = !1, Vu = Hd = 0, _l = null;
  }
  function mr() {
    var i = {
      memoizedState: null,
      baseState: null,
      baseQueue: null,
      queue: null,
      next: null
    };
    return Tn === null ? yt.memoizedState = Tn = i : Tn = Tn.next = i, Tn;
  }
  function _n() {
    if (Ht === null) {
      var i = yt.alternate;
      i = i !== null ? i.memoizedState : null;
    } else i = Ht.next;
    var s = Tn === null ? yt.memoizedState : Tn.next;
    if (s !== null)
      Tn = s, Ht = i;
    else {
      if (i === null)
        throw yt.alternate === null ? Error(r(467)) : Error(r(310));
      Ht = i, i = {
        memoizedState: Ht.memoizedState,
        baseState: Ht.baseState,
        baseQueue: Ht.baseQueue,
        queue: Ht.queue,
        next: null
      }, Tn === null ? yt.memoizedState = Tn = i : Tn = Tn.next = i;
    }
    return Tn;
  }
  function Gd() {
    return { lastEffect: null, events: null, stores: null, memoCache: null };
  }
  function Ku(i) {
    var s = Vu;
    return Vu += 1, _l === null && (_l = []), i = Hw(_l, i, s), s = yt, (Tn === null ? s.memoizedState : Tn.next) === null && (s = s.alternate, V.H = s === null || s.memoizedState === null ? D4 : hp), i;
  }
  function Vd(i) {
    if (i !== null && typeof i == "object") {
      if (typeof i.then == "function") return Ku(i);
      if (i.$$typeof === N) return Xn(i);
    }
    throw Error(r(438, String(i)));
  }
  function np(i) {
    var s = null, c = yt.updateQueue;
    if (c !== null && (s = c.memoCache), s == null) {
      var g = yt.alternate;
      g !== null && (g = g.updateQueue, g !== null && (g = g.memoCache, g != null && (s = {
        data: g.data.map(function(b) {
          return b.slice();
        }),
        index: 0
      })));
    }
    if (s == null && (s = { data: [], index: 0 }), c === null && (c = Gd(), yt.updateQueue = c), c.memoCache = s, c = s.data[s.index], c === void 0)
      for (c = s.data[s.index] = Array(i), g = 0; g < i; g++)
        c[g] = U;
    return s.index++, c;
  }
  function Ta(i, s) {
    return typeof s == "function" ? s(i) : s;
  }
  function Kd(i) {
    var s = _n();
    return rp(s, Ht, i);
  }
  function rp(i, s, c) {
    var g = i.queue;
    if (g === null) throw Error(r(311));
    g.lastRenderedReducer = c;
    var b = i.baseQueue, S = g.pending;
    if (S !== null) {
      if (b !== null) {
        var z = b.next;
        b.next = S.next, S.next = z;
      }
      s.baseQueue = b = S, g.pending = null;
    }
    if (S = i.baseState, b === null) i.memoizedState = S;
    else {
      s = b.next;
      var K = z = null, ae = null, Ee = s, Oe = !1;
      do {
        var Le = Ee.lane & -536870913;
        if (Le !== Ee.lane ? (Et & Le) === Le : (ja & Le) === Le) {
          var je = Ee.revertLane;
          if (je === 0)
            ae !== null && (ae = ae.next = {
              lane: 0,
              revertLane: 0,
              gesture: null,
              action: Ee.action,
              hasEagerState: Ee.hasEagerState,
              eagerState: Ee.eagerState,
              next: null
            }), Le === gl && (Oe = !0);
          else if ((ja & je) === je) {
            Ee = Ee.next, je === gl && (Oe = !0);
            continue;
          } else
            Le = {
              lane: 0,
              revertLane: Ee.revertLane,
              gesture: null,
              action: Ee.action,
              hasEagerState: Ee.hasEagerState,
              eagerState: Ee.eagerState,
              next: null
            }, ae === null ? (K = ae = Le, z = S) : ae = ae.next = Le, yt.lanes |= je, _s |= je;
          Le = Ee.action, ho && c(S, Le), S = Ee.hasEagerState ? Ee.eagerState : c(S, Le);
        } else
          je = {
            lane: Le,
            revertLane: Ee.revertLane,
            gesture: Ee.gesture,
            action: Ee.action,
            hasEagerState: Ee.hasEagerState,
            eagerState: Ee.eagerState,
            next: null
          }, ae === null ? (K = ae = je, z = S) : ae = ae.next = je, yt.lanes |= Le, _s |= Le;
        Ee = Ee.next;
      } while (Ee !== null && Ee !== s);
      if (ae === null ? z = S : ae.next = K, !ir(S, i.memoizedState) && (An = !0, Oe && (c = yl, c !== null)))
        throw c;
      i.memoizedState = S, i.baseState = z, i.baseQueue = ae, g.lastRenderedState = S;
    }
    return b === null && (g.lanes = 0), [i.memoizedState, g.dispatch];
  }
  function ip(i) {
    var s = _n(), c = s.queue;
    if (c === null) throw Error(r(311));
    c.lastRenderedReducer = i;
    var g = c.dispatch, b = c.pending, S = s.memoizedState;
    if (b !== null) {
      c.pending = null;
      var z = b = b.next;
      do
        S = i(S, z.action), z = z.next;
      while (z !== b);
      ir(S, s.memoizedState) || (An = !0), s.memoizedState = S, s.baseQueue === null && (s.baseState = S), c.lastRenderedState = S;
    }
    return [S, g];
  }
  function t4(i, s, c) {
    var g = yt, b = _n(), S = Tt;
    if (S) {
      if (c === void 0) throw Error(r(407));
      c = c();
    } else c = s();
    var z = !ir(
      (Ht || b).memoizedState,
      c
    );
    if (z && (b.memoizedState = c, An = !0), b = b.queue, op(i4.bind(null, g, b, i), [
      i
    ]), b.getSnapshot !== s || z || Tn !== null && Tn.memoizedState.tag & 1) {
      if (g.flags |= 2048, Sl(
        9,
        { destroy: void 0 },
        r4.bind(
          null,
          g,
          b,
          c,
          s
        ),
        null
      ), Xt === null) throw Error(r(349));
      S || (ja & 127) !== 0 || n4(g, s, c);
    }
    return c;
  }
  function n4(i, s, c) {
    i.flags |= 16384, i = { getSnapshot: s, value: c }, s = yt.updateQueue, s === null ? (s = Gd(), yt.updateQueue = s, s.stores = [i]) : (c = s.stores, c === null ? s.stores = [i] : c.push(i));
  }
  function r4(i, s, c, g) {
    s.value = c, s.getSnapshot = g, a4(s) && s4(i);
  }
  function i4(i, s, c) {
    return c(function() {
      a4(s) && s4(i);
    });
  }
  function a4(i) {
    var s = i.getSnapshot;
    i = i.value;
    try {
      var c = s();
      return !ir(i, c);
    } catch {
      return !0;
    }
  }
  function s4(i) {
    var s = sn(i, 2);
    s !== null && jr(s, i, 2);
  }
  function ap(i) {
    var s = mr();
    if (typeof i == "function") {
      var c = i;
      if (i = c(), ho) {
        en(!0);
        try {
          c();
        } finally {
          en(!1);
        }
      }
    }
    return s.memoizedState = s.baseState = i, s.queue = {
      pending: null,
      lanes: 0,
      dispatch: null,
      lastRenderedReducer: Ta,
      lastRenderedState: i
    }, s;
  }
  function o4(i, s, c, g) {
    return i.baseState = c, rp(
      i,
      Ht,
      typeof g == "function" ? g : Ta
    );
  }
  function tM(i, s, c, g, b) {
    if (Wd(i)) throw Error(r(485));
    if (i = s.action, i !== null) {
      var S = {
        payload: b,
        action: i,
        next: null,
        isTransition: !0,
        status: "pending",
        value: null,
        reason: null,
        listeners: [],
        then: function(z) {
          S.listeners.push(z);
        }
      };
      V.T !== null ? c(!0) : S.isTransition = !1, g(S), c = s.pending, c === null ? (S.next = s.pending = S, l4(s, S)) : (S.next = c.next, s.pending = c.next = S);
    }
  }
  function l4(i, s) {
    var c = s.action, g = s.payload, b = i.state;
    if (s.isTransition) {
      var S = V.T, z = {};
      V.T = z;
      try {
        var K = c(b, g), ae = V.S;
        ae !== null && ae(z, K), u4(i, s, K);
      } catch (Ee) {
        sp(i, s, Ee);
      } finally {
        S !== null && z.types !== null && (S.types = z.types), V.T = S;
      }
    } else
      try {
        S = c(b, g), u4(i, s, S);
      } catch (Ee) {
        sp(i, s, Ee);
      }
  }
  function u4(i, s, c) {
    c !== null && typeof c == "object" && typeof c.then == "function" ? c.then(
      function(g) {
        c4(i, s, g);
      },
      function(g) {
        return sp(i, s, g);
      }
    ) : c4(i, s, c);
  }
  function c4(i, s, c) {
    s.status = "fulfilled", s.value = c, d4(s), i.state = c, s = i.pending, s !== null && (c = s.next, c === s ? i.pending = null : (c = c.next, s.next = c, l4(i, c)));
  }
  function sp(i, s, c) {
    var g = i.pending;
    if (i.pending = null, g !== null) {
      g = g.next;
      do
        s.status = "rejected", s.reason = c, d4(s), s = s.next;
      while (s !== g);
    }
    i.action = null;
  }
  function d4(i) {
    i = i.listeners;
    for (var s = 0; s < i.length; s++) (0, i[s])();
  }
  function f4(i, s) {
    return s;
  }
  function h4(i, s) {
    if (Tt) {
      var c = Xt.formState;
      if (c !== null) {
        e: {
          var g = yt;
          if (Tt) {
            if (rn) {
              t: {
                for (var b = rn, S = si; b.nodeType !== 8; ) {
                  if (!S) {
                    b = null;
                    break t;
                  }
                  if (b = li(
                    b.nextSibling
                  ), b === null) {
                    b = null;
                    break t;
                  }
                }
                S = b.data, b = S === "F!" || S === "F" ? b : null;
              }
              if (b) {
                rn = li(
                  b.nextSibling
                ), g = b.data === "F!";
                break e;
              }
            }
            hs(g);
          }
          g = !1;
        }
        g && (s = c[0]);
      }
    }
    return c = mr(), c.memoizedState = c.baseState = s, g = {
      pending: null,
      lanes: 0,
      dispatch: null,
      lastRenderedReducer: f4,
      lastRenderedState: s
    }, c.queue = g, c = R4.bind(
      null,
      yt,
      g
    ), g.dispatch = c, g = ap(!1), S = fp.bind(
      null,
      yt,
      !1,
      g.queue
    ), g = mr(), b = {
      state: s,
      dispatch: null,
      action: i,
      pending: null
    }, g.queue = b, c = tM.bind(
      null,
      yt,
      b,
      S,
      c
    ), b.dispatch = c, g.memoizedState = i, [s, c, !1];
  }
  function m4(i) {
    var s = _n();
    return p4(s, Ht, i);
  }
  function p4(i, s, c) {
    if (s = rp(
      i,
      s,
      f4
    )[0], i = Kd(Ta)[0], typeof s == "object" && s !== null && typeof s.then == "function")
      try {
        var g = Ku(s);
      } catch (z) {
        throw z === xl ? Ld : z;
      }
    else g = s;
    s = _n();
    var b = s.queue, S = b.dispatch;
    return c !== s.memoizedState && (yt.flags |= 2048, Sl(
      9,
      { destroy: void 0 },
      nM.bind(null, b, c),
      null
    )), [g, S, i];
  }
  function nM(i, s) {
    i.action = s;
  }
  function g4(i) {
    var s = _n(), c = Ht;
    if (c !== null)
      return p4(s, c, i);
    _n(), s = s.memoizedState, c = _n();
    var g = c.queue.dispatch;
    return c.memoizedState = i, [s, g, !1];
  }
  function Sl(i, s, c, g) {
    return i = { tag: i, create: c, deps: g, inst: s, next: null }, s = yt.updateQueue, s === null && (s = Gd(), yt.updateQueue = s), c = s.lastEffect, c === null ? s.lastEffect = i.next = i : (g = c.next, c.next = i, i.next = g, s.lastEffect = i), i;
  }
  function y4() {
    return _n().memoizedState;
  }
  function Yd(i, s, c, g) {
    var b = mr();
    yt.flags |= i, b.memoizedState = Sl(
      1 | s,
      { destroy: void 0 },
      c,
      g === void 0 ? null : g
    );
  }
  function Xd(i, s, c, g) {
    var b = _n();
    g = g === void 0 ? null : g;
    var S = b.memoizedState.inst;
    Ht !== null && g !== null && Qm(g, Ht.memoizedState.deps) ? b.memoizedState = Sl(s, S, c, g) : (yt.flags |= i, b.memoizedState = Sl(
      1 | s,
      S,
      c,
      g
    ));
  }
  function x4(i, s) {
    Yd(8390656, 8, i, s);
  }
  function op(i, s) {
    Xd(2048, 8, i, s);
  }
  function rM(i) {
    yt.flags |= 4;
    var s = yt.updateQueue;
    if (s === null)
      s = Gd(), yt.updateQueue = s, s.events = [i];
    else {
      var c = s.events;
      c === null ? s.events = [i] : c.push(i);
    }
  }
  function v4(i) {
    var s = _n().memoizedState;
    return rM({ ref: s, nextImpl: i }), function() {
      if ((Lt & 2) !== 0) throw Error(r(440));
      return s.impl.apply(void 0, arguments);
    };
  }
  function b4(i, s) {
    return Xd(4, 2, i, s);
  }
  function w4(i, s) {
    return Xd(4, 4, i, s);
  }
  function _4(i, s) {
    if (typeof s == "function") {
      i = i();
      var c = s(i);
      return function() {
        typeof c == "function" ? c() : s(null);
      };
    }
    if (s != null)
      return i = i(), s.current = i, function() {
        s.current = null;
      };
  }
  function S4(i, s, c) {
    c = c != null ? c.concat([i]) : null, Xd(4, 4, _4.bind(null, s, i), c);
  }
  function lp() {
  }
  function C4(i, s) {
    var c = _n();
    s = s === void 0 ? null : s;
    var g = c.memoizedState;
    return s !== null && Qm(s, g[1]) ? g[0] : (c.memoizedState = [i, s], i);
  }
  function E4(i, s) {
    var c = _n();
    s = s === void 0 ? null : s;
    var g = c.memoizedState;
    if (s !== null && Qm(s, g[1]))
      return g[0];
    if (g = i(), ho) {
      en(!0);
      try {
        i();
      } finally {
        en(!1);
      }
    }
    return c.memoizedState = [g, s], g;
  }
  function up(i, s, c) {
    return c === void 0 || (ja & 1073741824) !== 0 && (Et & 261930) === 0 ? i.memoizedState = s : (i.memoizedState = c, i = k3(), yt.lanes |= i, _s |= i, c);
  }
  function k4(i, s, c, g) {
    return ir(c, s) ? c : bl.current !== null ? (i = up(i, c, g), ir(i, s) || (An = !0), i) : (ja & 42) === 0 || (ja & 1073741824) !== 0 && (Et & 261930) === 0 ? (An = !0, i.memoizedState = c) : (i = k3(), yt.lanes |= i, _s |= i, s);
  }
  function N4(i, s, c, g, b) {
    var S = ee.p;
    ee.p = S !== 0 && 8 > S ? S : 8;
    var z = V.T, K = {};
    V.T = K, fp(i, !1, s, c);
    try {
      var ae = b(), Ee = V.S;
      if (Ee !== null && Ee(K, ae), ae !== null && typeof ae == "object" && typeof ae.then == "function") {
        var Oe = ZA(
          ae,
          g
        );
        Yu(
          i,
          s,
          Oe,
          $r(i)
        );
      } else
        Yu(
          i,
          s,
          g,
          $r(i)
        );
    } catch (Le) {
      Yu(
        i,
        s,
        { then: function() {
        }, status: "rejected", reason: Le },
        $r()
      );
    } finally {
      ee.p = S, z !== null && K.types !== null && (z.types = K.types), V.T = z;
    }
  }
  function iM() {
  }
  function cp(i, s, c, g) {
    if (i.tag !== 5) throw Error(r(476));
    var b = j4(i).queue;
    N4(
      i,
      b,
      s,
      te,
      c === null ? iM : function() {
        return T4(i), c(g);
      }
    );
  }
  function j4(i) {
    var s = i.memoizedState;
    if (s !== null) return s;
    s = {
      memoizedState: te,
      baseState: te,
      baseQueue: null,
      queue: {
        pending: null,
        lanes: 0,
        dispatch: null,
        lastRenderedReducer: Ta,
        lastRenderedState: te
      },
      next: null
    };
    var c = {};
    return s.next = {
      memoizedState: c,
      baseState: c,
      baseQueue: null,
      queue: {
        pending: null,
        lanes: 0,
        dispatch: null,
        lastRenderedReducer: Ta,
        lastRenderedState: c
      },
      next: null
    }, i.memoizedState = s, i = i.alternate, i !== null && (i.memoizedState = s), s;
  }
  function T4(i) {
    var s = j4(i);
    s.next === null && (s = i.alternate.memoizedState), Yu(
      i,
      s.next.queue,
      {},
      $r()
    );
  }
  function dp() {
    return Xn(dc);
  }
  function A4() {
    return _n().memoizedState;
  }
  function M4() {
    return _n().memoizedState;
  }
  function aM(i) {
    for (var s = i.return; s !== null; ) {
      switch (s.tag) {
        case 24:
        case 3:
          var c = $r();
          i = gs(c);
          var g = ys(s, i, c);
          g !== null && (jr(g, s, c), Uu(g, s, c)), s = { cache: Bm() }, i.payload = s;
          return;
      }
      s = s.return;
    }
  }
  function sM(i, s, c) {
    var g = $r();
    c = {
      lane: g,
      revertLane: 0,
      gesture: null,
      action: c,
      hasEagerState: !1,
      eagerState: null,
      next: null
    }, Wd(i) ? z4(s, c) : (c = kn(i, s, c, g), c !== null && (jr(c, i, g), O4(c, s, g)));
  }
  function R4(i, s, c) {
    var g = $r();
    Yu(i, s, c, g);
  }
  function Yu(i, s, c, g) {
    var b = {
      lane: g,
      revertLane: 0,
      gesture: null,
      action: c,
      hasEagerState: !1,
      eagerState: null,
      next: null
    };
    if (Wd(i)) z4(s, b);
    else {
      var S = i.alternate;
      if (i.lanes === 0 && (S === null || S.lanes === 0) && (S = s.lastRenderedReducer, S !== null))
        try {
          var z = s.lastRenderedState, K = S(z, c);
          if (b.hasEagerState = !0, b.eagerState = K, ir(K, z))
            return ft(i, s, b, 0), Xt === null && Vn(), !1;
        } catch {
        } finally {
        }
      if (c = kn(i, s, b, g), c !== null)
        return jr(c, i, g), O4(c, s, g), !0;
    }
    return !1;
  }
  function fp(i, s, c, g) {
    if (g = {
      lane: 2,
      revertLane: Hp(),
      gesture: null,
      action: g,
      hasEagerState: !1,
      eagerState: null,
      next: null
    }, Wd(i)) {
      if (s) throw Error(r(479));
    } else
      s = kn(
        i,
        c,
        g,
        2
      ), s !== null && jr(s, i, 2);
  }
  function Wd(i) {
    var s = i.alternate;
    return i === yt || s !== null && s === yt;
  }
  function z4(i, s) {
    wl = Ud = !0;
    var c = i.pending;
    c === null ? s.next = s : (s.next = c.next, c.next = s), i.pending = s;
  }
  function O4(i, s, c) {
    if ((c & 4194048) !== 0) {
      var g = s.lanes;
      g &= i.pendingLanes, c |= g, s.lanes = c, Bt(i, c);
    }
  }
  var Xu = {
    readContext: Xn,
    use: Vd,
    useCallback: yn,
    useContext: yn,
    useEffect: yn,
    useImperativeHandle: yn,
    useLayoutEffect: yn,
    useInsertionEffect: yn,
    useMemo: yn,
    useReducer: yn,
    useRef: yn,
    useState: yn,
    useDebugValue: yn,
    useDeferredValue: yn,
    useTransition: yn,
    useSyncExternalStore: yn,
    useId: yn,
    useHostTransitionStatus: yn,
    useFormState: yn,
    useActionState: yn,
    useOptimistic: yn,
    useMemoCache: yn,
    useCacheRefresh: yn
  };
  Xu.useEffectEvent = yn;
  var D4 = {
    readContext: Xn,
    use: Vd,
    useCallback: function(i, s) {
      return mr().memoizedState = [
        i,
        s === void 0 ? null : s
      ], i;
    },
    useContext: Xn,
    useEffect: x4,
    useImperativeHandle: function(i, s, c) {
      c = c != null ? c.concat([i]) : null, Yd(
        4194308,
        4,
        _4.bind(null, s, i),
        c
      );
    },
    useLayoutEffect: function(i, s) {
      return Yd(4194308, 4, i, s);
    },
    useInsertionEffect: function(i, s) {
      Yd(4, 2, i, s);
    },
    useMemo: function(i, s) {
      var c = mr();
      s = s === void 0 ? null : s;
      var g = i();
      if (ho) {
        en(!0);
        try {
          i();
        } finally {
          en(!1);
        }
      }
      return c.memoizedState = [g, s], g;
    },
    useReducer: function(i, s, c) {
      var g = mr();
      if (c !== void 0) {
        var b = c(s);
        if (ho) {
          en(!0);
          try {
            c(s);
          } finally {
            en(!1);
          }
        }
      } else b = s;
      return g.memoizedState = g.baseState = b, i = {
        pending: null,
        lanes: 0,
        dispatch: null,
        lastRenderedReducer: i,
        lastRenderedState: b
      }, g.queue = i, i = i.dispatch = sM.bind(
        null,
        yt,
        i
      ), [g.memoizedState, i];
    },
    useRef: function(i) {
      var s = mr();
      return i = { current: i }, s.memoizedState = i;
    },
    useState: function(i) {
      i = ap(i);
      var s = i.queue, c = R4.bind(null, yt, s);
      return s.dispatch = c, [i.memoizedState, c];
    },
    useDebugValue: lp,
    useDeferredValue: function(i, s) {
      var c = mr();
      return up(c, i, s);
    },
    useTransition: function() {
      var i = ap(!1);
      return i = N4.bind(
        null,
        yt,
        i.queue,
        !0,
        !1
      ), mr().memoizedState = i, [!1, i];
    },
    useSyncExternalStore: function(i, s, c) {
      var g = yt, b = mr();
      if (Tt) {
        if (c === void 0)
          throw Error(r(407));
        c = c();
      } else {
        if (c = s(), Xt === null)
          throw Error(r(349));
        (Et & 127) !== 0 || n4(g, s, c);
      }
      b.memoizedState = c;
      var S = { value: c, getSnapshot: s };
      return b.queue = S, x4(i4.bind(null, g, S, i), [
        i
      ]), g.flags |= 2048, Sl(
        9,
        { destroy: void 0 },
        r4.bind(
          null,
          g,
          S,
          c,
          s
        ),
        null
      ), c;
    },
    useId: function() {
      var i = mr(), s = Xt.identifierPrefix;
      if (Tt) {
        var c = Ui, g = $i;
        c = (g & ~(1 << 32 - Ge(g) - 1)).toString(32) + c, s = "_" + s + "R_" + c, c = Hd++, 0 < c && (s += "H" + c.toString(32)), s += "_";
      } else
        c = JA++, s = "_" + s + "r_" + c.toString(32) + "_";
      return i.memoizedState = s;
    },
    useHostTransitionStatus: dp,
    useFormState: h4,
    useActionState: h4,
    useOptimistic: function(i) {
      var s = mr();
      s.memoizedState = s.baseState = i;
      var c = {
        pending: null,
        lanes: 0,
        dispatch: null,
        lastRenderedReducer: null,
        lastRenderedState: null
      };
      return s.queue = c, s = fp.bind(
        null,
        yt,
        !0,
        c
      ), c.dispatch = s, [i, s];
    },
    useMemoCache: np,
    useCacheRefresh: function() {
      return mr().memoizedState = aM.bind(
        null,
        yt
      );
    },
    useEffectEvent: function(i) {
      var s = mr(), c = { impl: i };
      return s.memoizedState = c, function() {
        if ((Lt & 2) !== 0)
          throw Error(r(440));
        return c.impl.apply(void 0, arguments);
      };
    }
  }, hp = {
    readContext: Xn,
    use: Vd,
    useCallback: C4,
    useContext: Xn,
    useEffect: op,
    useImperativeHandle: S4,
    useInsertionEffect: b4,
    useLayoutEffect: w4,
    useMemo: E4,
    useReducer: Kd,
    useRef: y4,
    useState: function() {
      return Kd(Ta);
    },
    useDebugValue: lp,
    useDeferredValue: function(i, s) {
      var c = _n();
      return k4(
        c,
        Ht.memoizedState,
        i,
        s
      );
    },
    useTransition: function() {
      var i = Kd(Ta)[0], s = _n().memoizedState;
      return [
        typeof i == "boolean" ? i : Ku(i),
        s
      ];
    },
    useSyncExternalStore: t4,
    useId: A4,
    useHostTransitionStatus: dp,
    useFormState: m4,
    useActionState: m4,
    useOptimistic: function(i, s) {
      var c = _n();
      return o4(c, Ht, i, s);
    },
    useMemoCache: np,
    useCacheRefresh: M4
  };
  hp.useEffectEvent = v4;
  var I4 = {
    readContext: Xn,
    use: Vd,
    useCallback: C4,
    useContext: Xn,
    useEffect: op,
    useImperativeHandle: S4,
    useInsertionEffect: b4,
    useLayoutEffect: w4,
    useMemo: E4,
    useReducer: ip,
    useRef: y4,
    useState: function() {
      return ip(Ta);
    },
    useDebugValue: lp,
    useDeferredValue: function(i, s) {
      var c = _n();
      return Ht === null ? up(c, i, s) : k4(
        c,
        Ht.memoizedState,
        i,
        s
      );
    },
    useTransition: function() {
      var i = ip(Ta)[0], s = _n().memoizedState;
      return [
        typeof i == "boolean" ? i : Ku(i),
        s
      ];
    },
    useSyncExternalStore: t4,
    useId: A4,
    useHostTransitionStatus: dp,
    useFormState: g4,
    useActionState: g4,
    useOptimistic: function(i, s) {
      var c = _n();
      return Ht !== null ? o4(c, Ht, i, s) : (c.baseState = i, [i, c.queue.dispatch]);
    },
    useMemoCache: np,
    useCacheRefresh: M4
  };
  I4.useEffectEvent = v4;
  function mp(i, s, c, g) {
    s = i.memoizedState, c = c(g, s), c = c == null ? s : p({}, s, c), i.memoizedState = c, i.lanes === 0 && (i.updateQueue.baseState = c);
  }
  var pp = {
    enqueueSetState: function(i, s, c) {
      i = i._reactInternals;
      var g = $r(), b = gs(g);
      b.payload = s, c != null && (b.callback = c), s = ys(i, b, g), s !== null && (jr(s, i, g), Uu(s, i, g));
    },
    enqueueReplaceState: function(i, s, c) {
      i = i._reactInternals;
      var g = $r(), b = gs(g);
      b.tag = 1, b.payload = s, c != null && (b.callback = c), s = ys(i, b, g), s !== null && (jr(s, i, g), Uu(s, i, g));
    },
    enqueueForceUpdate: function(i, s) {
      i = i._reactInternals;
      var c = $r(), g = gs(c);
      g.tag = 2, s != null && (g.callback = s), s = ys(i, g, c), s !== null && (jr(s, i, c), Uu(s, i, c));
    }
  };
  function L4(i, s, c, g, b, S, z) {
    return i = i.stateNode, typeof i.shouldComponentUpdate == "function" ? i.shouldComponentUpdate(g, S, z) : s.prototype && s.prototype.isPureReactComponent ? !v(c, g) || !v(b, S) : !0;
  }
  function q4(i, s, c, g) {
    i = s.state, typeof s.componentWillReceiveProps == "function" && s.componentWillReceiveProps(c, g), typeof s.UNSAFE_componentWillReceiveProps == "function" && s.UNSAFE_componentWillReceiveProps(c, g), s.state !== i && pp.enqueueReplaceState(s, s.state, null);
  }
  function mo(i, s) {
    var c = s;
    if ("ref" in s) {
      c = {};
      for (var g in s)
        g !== "ref" && (c[g] = s[g]);
    }
    if (i = i.defaultProps) {
      c === s && (c = p({}, c));
      for (var b in i)
        c[b] === void 0 && (c[b] = i[b]);
    }
    return c;
  }
  function P4(i) {
    Je(i);
  }
  function B4(i) {
    console.error(i);
  }
  function F4(i) {
    Je(i);
  }
  function Qd(i, s) {
    try {
      var c = i.onUncaughtError;
      c(s.value, { componentStack: s.stack });
    } catch (g) {
      setTimeout(function() {
        throw g;
      });
    }
  }
  function $4(i, s, c) {
    try {
      var g = i.onCaughtError;
      g(c.value, {
        componentStack: c.stack,
        errorBoundary: s.tag === 1 ? s.stateNode : null
      });
    } catch (b) {
      setTimeout(function() {
        throw b;
      });
    }
  }
  function gp(i, s, c) {
    return c = gs(c), c.tag = 3, c.payload = { element: null }, c.callback = function() {
      Qd(i, s);
    }, c;
  }
  function U4(i) {
    return i = gs(i), i.tag = 3, i;
  }
  function H4(i, s, c, g) {
    var b = c.type.getDerivedStateFromError;
    if (typeof b == "function") {
      var S = g.value;
      i.payload = function() {
        return b(S);
      }, i.callback = function() {
        $4(s, c, g);
      };
    }
    var z = c.stateNode;
    z !== null && typeof z.componentDidCatch == "function" && (i.callback = function() {
      $4(s, c, g), typeof b != "function" && (Ss === null ? Ss = /* @__PURE__ */ new Set([this]) : Ss.add(this));
      var K = g.stack;
      this.componentDidCatch(g.value, {
        componentStack: K !== null ? K : ""
      });
    });
  }
  function oM(i, s, c, g, b) {
    if (c.flags |= 32768, g !== null && typeof g == "object" && typeof g.then == "function") {
      if (s = c.alternate, s !== null && pl(
        s,
        c,
        b,
        !0
      ), c = qr.current, c !== null) {
        switch (c.tag) {
          case 31:
          case 13:
            return oi === null ? cf() : c.alternate === null && xn === 0 && (xn = 3), c.flags &= -257, c.flags |= 65536, c.lanes = b, g === qd ? c.flags |= 16384 : (s = c.updateQueue, s === null ? c.updateQueue = /* @__PURE__ */ new Set([g]) : s.add(g), Fp(i, g, b)), !1;
          case 22:
            return c.flags |= 65536, g === qd ? c.flags |= 16384 : (s = c.updateQueue, s === null ? (s = {
              transitions: null,
              markerInstances: null,
              retryQueue: /* @__PURE__ */ new Set([g])
            }, c.updateQueue = s) : (c = s.retryQueue, c === null ? s.retryQueue = /* @__PURE__ */ new Set([g]) : c.add(g)), Fp(i, g, b)), !1;
        }
        throw Error(r(435, c.tag));
      }
      return Fp(i, g, b), cf(), !1;
    }
    if (Tt)
      return s = qr.current, s !== null ? ((s.flags & 65536) === 0 && (s.flags |= 256), s.flags |= 65536, s.lanes = b, g !== Dm && (i = Error(r(422), { cause: g }), qu(ri(i, c)))) : (g !== Dm && (s = Error(r(423), {
        cause: g
      }), qu(
        ri(s, c)
      )), i = i.current.alternate, i.flags |= 65536, b &= -b, i.lanes |= b, g = ri(g, c), b = gp(
        i.stateNode,
        g,
        b
      ), Vm(i, b), xn !== 4 && (xn = 2)), !1;
    var S = Error(r(520), { cause: g });
    if (S = ri(S, c), rc === null ? rc = [S] : rc.push(S), xn !== 4 && (xn = 2), s === null) return !0;
    g = ri(g, c), c = s;
    do {
      switch (c.tag) {
        case 3:
          return c.flags |= 65536, i = b & -b, c.lanes |= i, i = gp(c.stateNode, g, i), Vm(c, i), !1;
        case 1:
          if (s = c.type, S = c.stateNode, (c.flags & 128) === 0 && (typeof s.getDerivedStateFromError == "function" || S !== null && typeof S.componentDidCatch == "function" && (Ss === null || !Ss.has(S))))
            return c.flags |= 65536, b &= -b, c.lanes |= b, b = U4(b), H4(
              b,
              i,
              c,
              g
            ), Vm(c, b), !1;
      }
      c = c.return;
    } while (c !== null);
    return !1;
  }
  var yp = Error(r(461)), An = !1;
  function Wn(i, s, c, g) {
    s.child = i === null ? Yw(s, null, c, g) : fo(
      s,
      i.child,
      c,
      g
    );
  }
  function G4(i, s, c, g, b) {
    c = c.render;
    var S = s.ref;
    if ("ref" in g) {
      var z = {};
      for (var K in g)
        K !== "ref" && (z[K] = g[K]);
    } else z = g;
    return oo(s), g = Zm(
      i,
      s,
      c,
      z,
      S,
      b
    ), K = Jm(), i !== null && !An ? (ep(i, s, b), Aa(i, s, b)) : (Tt && K && zm(s), s.flags |= 1, Wn(i, s, g, b), s.child);
  }
  function V4(i, s, c, g, b) {
    if (i === null) {
      var S = c.type;
      return typeof S == "function" && !Am(S) && S.defaultProps === void 0 && c.compare === null ? (s.tag = 15, s.type = S, K4(
        i,
        s,
        S,
        g,
        b
      )) : (i = Rd(
        c.type,
        null,
        g,
        s,
        s.mode,
        b
      ), i.ref = s.ref, i.return = s, s.child = i);
    }
    if (S = i.child, !Ep(i, b)) {
      var z = S.memoizedProps;
      if (c = c.compare, c = c !== null ? c : v, c(z, g) && i.ref === s.ref)
        return Aa(i, s, b);
    }
    return s.flags |= 1, i = Ca(S, g), i.ref = s.ref, i.return = s, s.child = i;
  }
  function K4(i, s, c, g, b) {
    if (i !== null) {
      var S = i.memoizedProps;
      if (v(S, g) && i.ref === s.ref)
        if (An = !1, s.pendingProps = g = S, Ep(i, b))
          (i.flags & 131072) !== 0 && (An = !0);
        else
          return s.lanes = i.lanes, Aa(i, s, b);
    }
    return xp(
      i,
      s,
      c,
      g,
      b
    );
  }
  function Y4(i, s, c, g) {
    var b = g.children, S = i !== null ? i.memoizedState : null;
    if (i === null && s.stateNode === null && (s.stateNode = {
      _visibility: 1,
      _pendingMarkers: null,
      _retryCache: null,
      _transitions: null
    }), g.mode === "hidden") {
      if ((s.flags & 128) !== 0) {
        if (S = S !== null ? S.baseLanes | c : c, i !== null) {
          for (g = s.child = i.child, b = 0; g !== null; )
            b = b | g.lanes | g.childLanes, g = g.sibling;
          g = b & ~S;
        } else g = 0, s.child = null;
        return X4(
          i,
          s,
          S,
          c,
          g
        );
      }
      if ((c & 536870912) !== 0)
        s.memoizedState = { baseLanes: 0, cachePool: null }, i !== null && Id(
          s,
          S !== null ? S.cachePool : null
        ), S !== null ? Qw(s, S) : Ym(), Zw(s);
      else
        return g = s.lanes = 536870912, X4(
          i,
          s,
          S !== null ? S.baseLanes | c : c,
          c,
          g
        );
    } else
      S !== null ? (Id(s, S.cachePool), Qw(s, S), vs(), s.memoizedState = null) : (i !== null && Id(s, null), Ym(), vs());
    return Wn(i, s, b, c), s.child;
  }
  function Wu(i, s) {
    return i !== null && i.tag === 22 || s.stateNode !== null || (s.stateNode = {
      _visibility: 1,
      _pendingMarkers: null,
      _retryCache: null,
      _transitions: null
    }), s.sibling;
  }
  function X4(i, s, c, g, b) {
    var S = $m();
    return S = S === null ? null : { parent: jn._currentValue, pool: S }, s.memoizedState = {
      baseLanes: c,
      cachePool: S
    }, i !== null && Id(s, null), Ym(), Zw(s), i !== null && pl(i, s, g, !0), s.childLanes = b, null;
  }
  function Zd(i, s) {
    return s = ef(
      { mode: s.mode, children: s.children },
      i.mode
    ), s.ref = i.ref, i.child = s, s.return = i, s;
  }
  function W4(i, s, c) {
    return fo(s, i.child, null, c), i = Zd(s, s.pendingProps), i.flags |= 2, Pr(s), s.memoizedState = null, i;
  }
  function lM(i, s, c) {
    var g = s.pendingProps, b = (s.flags & 128) !== 0;
    if (s.flags &= -129, i === null) {
      if (Tt) {
        if (g.mode === "hidden")
          return i = Zd(s, g), s.lanes = 536870912, Wu(null, i);
        if (Wm(s), (i = rn) ? (i = l5(
          i,
          si
        ), i = i !== null && i.data === "&" ? i : null, i !== null && (s.memoizedState = {
          dehydrated: i,
          treeContext: ds !== null ? { id: $i, overflow: Ui } : null,
          retryLane: 536870912,
          hydrationErrors: null
        }, c = zw(i), c.return = s, s.child = c, Yn = s, rn = null)) : i = null, i === null) throw hs(s);
        return s.lanes = 536870912, null;
      }
      return Zd(s, g);
    }
    var S = i.memoizedState;
    if (S !== null) {
      var z = S.dehydrated;
      if (Wm(s), b)
        if (s.flags & 256)
          s.flags &= -257, s = W4(
            i,
            s,
            c
          );
        else if (s.memoizedState !== null)
          s.child = i.child, s.flags |= 128, s = null;
        else throw Error(r(558));
      else if (An || pl(i, s, c, !1), b = (c & i.childLanes) !== 0, An || b) {
        if (g = Xt, g !== null && (z = dn(g, c), z !== 0 && z !== S.retryLane))
          throw S.retryLane = z, sn(i, z), jr(g, i, z), yp;
        cf(), s = W4(
          i,
          s,
          c
        );
      } else
        i = S.treeContext, rn = li(z.nextSibling), Yn = s, Tt = !0, fs = null, si = !1, i !== null && Iw(s, i), s = Zd(s, g), s.flags |= 4096;
      return s;
    }
    return i = Ca(i.child, {
      mode: g.mode,
      children: g.children
    }), i.ref = s.ref, s.child = i, i.return = s, i;
  }
  function Jd(i, s) {
    var c = s.ref;
    if (c === null)
      i !== null && i.ref !== null && (s.flags |= 4194816);
    else {
      if (typeof c != "function" && typeof c != "object")
        throw Error(r(284));
      (i === null || i.ref !== c) && (s.flags |= 4194816);
    }
  }
  function xp(i, s, c, g, b) {
    return oo(s), c = Zm(
      i,
      s,
      c,
      g,
      void 0,
      b
    ), g = Jm(), i !== null && !An ? (ep(i, s, b), Aa(i, s, b)) : (Tt && g && zm(s), s.flags |= 1, Wn(i, s, c, b), s.child);
  }
  function Q4(i, s, c, g, b, S) {
    return oo(s), s.updateQueue = null, c = e4(
      s,
      g,
      c,
      b
    ), Jw(i), g = Jm(), i !== null && !An ? (ep(i, s, S), Aa(i, s, S)) : (Tt && g && zm(s), s.flags |= 1, Wn(i, s, c, S), s.child);
  }
  function Z4(i, s, c, g, b) {
    if (oo(s), s.stateNode === null) {
      var S = Sr, z = c.contextType;
      typeof z == "object" && z !== null && (S = Xn(z)), S = new c(g, S), s.memoizedState = S.state !== null && S.state !== void 0 ? S.state : null, S.updater = pp, s.stateNode = S, S._reactInternals = s, S = s.stateNode, S.props = g, S.state = s.memoizedState, S.refs = {}, Hm(s), z = c.contextType, S.context = typeof z == "object" && z !== null ? Xn(z) : Sr, S.state = s.memoizedState, z = c.getDerivedStateFromProps, typeof z == "function" && (mp(
        s,
        c,
        z,
        g
      ), S.state = s.memoizedState), typeof c.getDerivedStateFromProps == "function" || typeof S.getSnapshotBeforeUpdate == "function" || typeof S.UNSAFE_componentWillMount != "function" && typeof S.componentWillMount != "function" || (z = S.state, typeof S.componentWillMount == "function" && S.componentWillMount(), typeof S.UNSAFE_componentWillMount == "function" && S.UNSAFE_componentWillMount(), z !== S.state && pp.enqueueReplaceState(S, S.state, null), Gu(s, g, S, b), Hu(), S.state = s.memoizedState), typeof S.componentDidMount == "function" && (s.flags |= 4194308), g = !0;
    } else if (i === null) {
      S = s.stateNode;
      var K = s.memoizedProps, ae = mo(c, K);
      S.props = ae;
      var Ee = S.context, Oe = c.contextType;
      z = Sr, typeof Oe == "object" && Oe !== null && (z = Xn(Oe));
      var Le = c.getDerivedStateFromProps;
      Oe = typeof Le == "function" || typeof S.getSnapshotBeforeUpdate == "function", K = s.pendingProps !== K, Oe || typeof S.UNSAFE_componentWillReceiveProps != "function" && typeof S.componentWillReceiveProps != "function" || (K || Ee !== z) && q4(
        s,
        S,
        g,
        z
      ), ps = !1;
      var je = s.memoizedState;
      S.state = je, Gu(s, g, S, b), Hu(), Ee = s.memoizedState, K || je !== Ee || ps ? (typeof Le == "function" && (mp(
        s,
        c,
        Le,
        g
      ), Ee = s.memoizedState), (ae = ps || L4(
        s,
        c,
        ae,
        g,
        je,
        Ee,
        z
      )) ? (Oe || typeof S.UNSAFE_componentWillMount != "function" && typeof S.componentWillMount != "function" || (typeof S.componentWillMount == "function" && S.componentWillMount(), typeof S.UNSAFE_componentWillMount == "function" && S.UNSAFE_componentWillMount()), typeof S.componentDidMount == "function" && (s.flags |= 4194308)) : (typeof S.componentDidMount == "function" && (s.flags |= 4194308), s.memoizedProps = g, s.memoizedState = Ee), S.props = g, S.state = Ee, S.context = z, g = ae) : (typeof S.componentDidMount == "function" && (s.flags |= 4194308), g = !1);
    } else {
      S = s.stateNode, Gm(i, s), z = s.memoizedProps, Oe = mo(c, z), S.props = Oe, Le = s.pendingProps, je = S.context, Ee = c.contextType, ae = Sr, typeof Ee == "object" && Ee !== null && (ae = Xn(Ee)), K = c.getDerivedStateFromProps, (Ee = typeof K == "function" || typeof S.getSnapshotBeforeUpdate == "function") || typeof S.UNSAFE_componentWillReceiveProps != "function" && typeof S.componentWillReceiveProps != "function" || (z !== Le || je !== ae) && q4(
        s,
        S,
        g,
        ae
      ), ps = !1, je = s.memoizedState, S.state = je, Gu(s, g, S, b), Hu();
      var Me = s.memoizedState;
      z !== Le || je !== Me || ps || i !== null && i.dependencies !== null && Od(i.dependencies) ? (typeof K == "function" && (mp(
        s,
        c,
        K,
        g
      ), Me = s.memoizedState), (Oe = ps || L4(
        s,
        c,
        Oe,
        g,
        je,
        Me,
        ae
      ) || i !== null && i.dependencies !== null && Od(i.dependencies)) ? (Ee || typeof S.UNSAFE_componentWillUpdate != "function" && typeof S.componentWillUpdate != "function" || (typeof S.componentWillUpdate == "function" && S.componentWillUpdate(g, Me, ae), typeof S.UNSAFE_componentWillUpdate == "function" && S.UNSAFE_componentWillUpdate(
        g,
        Me,
        ae
      )), typeof S.componentDidUpdate == "function" && (s.flags |= 4), typeof S.getSnapshotBeforeUpdate == "function" && (s.flags |= 1024)) : (typeof S.componentDidUpdate != "function" || z === i.memoizedProps && je === i.memoizedState || (s.flags |= 4), typeof S.getSnapshotBeforeUpdate != "function" || z === i.memoizedProps && je === i.memoizedState || (s.flags |= 1024), s.memoizedProps = g, s.memoizedState = Me), S.props = g, S.state = Me, S.context = ae, g = Oe) : (typeof S.componentDidUpdate != "function" || z === i.memoizedProps && je === i.memoizedState || (s.flags |= 4), typeof S.getSnapshotBeforeUpdate != "function" || z === i.memoizedProps && je === i.memoizedState || (s.flags |= 1024), g = !1);
    }
    return S = g, Jd(i, s), g = (s.flags & 128) !== 0, S || g ? (S = s.stateNode, c = g && typeof c.getDerivedStateFromError != "function" ? null : S.render(), s.flags |= 1, i !== null && g ? (s.child = fo(
      s,
      i.child,
      null,
      b
    ), s.child = fo(
      s,
      null,
      c,
      b
    )) : Wn(i, s, c, b), s.memoizedState = S.state, i = s.child) : i = Aa(
      i,
      s,
      b
    ), i;
  }
  function J4(i, s, c, g) {
    return ao(), s.flags |= 256, Wn(i, s, c, g), s.child;
  }
  var vp = {
    dehydrated: null,
    treeContext: null,
    retryLane: 0,
    hydrationErrors: null
  };
  function bp(i) {
    return { baseLanes: i, cachePool: $w() };
  }
  function wp(i, s, c) {
    return i = i !== null ? i.childLanes & ~c : 0, s && (i |= Fr), i;
  }
  function e3(i, s, c) {
    var g = s.pendingProps, b = !1, S = (s.flags & 128) !== 0, z;
    if ((z = S) || (z = i !== null && i.memoizedState === null ? !1 : (wn.current & 2) !== 0), z && (b = !0, s.flags &= -129), z = (s.flags & 32) !== 0, s.flags &= -33, i === null) {
      if (Tt) {
        if (b ? xs(s) : vs(), (i = rn) ? (i = l5(
          i,
          si
        ), i = i !== null && i.data !== "&" ? i : null, i !== null && (s.memoizedState = {
          dehydrated: i,
          treeContext: ds !== null ? { id: $i, overflow: Ui } : null,
          retryLane: 536870912,
          hydrationErrors: null
        }, c = zw(i), c.return = s, s.child = c, Yn = s, rn = null)) : i = null, i === null) throw hs(s);
        return rg(i) ? s.lanes = 32 : s.lanes = 536870912, null;
      }
      var K = g.children;
      return g = g.fallback, b ? (vs(), b = s.mode, K = ef(
        { mode: "hidden", children: K },
        b
      ), g = io(
        g,
        b,
        c,
        null
      ), K.return = s, g.return = s, K.sibling = g, s.child = K, g = s.child, g.memoizedState = bp(c), g.childLanes = wp(
        i,
        z,
        c
      ), s.memoizedState = vp, Wu(null, g)) : (xs(s), _p(s, K));
    }
    var ae = i.memoizedState;
    if (ae !== null && (K = ae.dehydrated, K !== null)) {
      if (S)
        s.flags & 256 ? (xs(s), s.flags &= -257, s = Sp(
          i,
          s,
          c
        )) : s.memoizedState !== null ? (vs(), s.child = i.child, s.flags |= 128, s = null) : (vs(), K = g.fallback, b = s.mode, g = ef(
          { mode: "visible", children: g.children },
          b
        ), K = io(
          K,
          b,
          c,
          null
        ), K.flags |= 2, g.return = s, K.return = s, g.sibling = K, s.child = g, fo(
          s,
          i.child,
          null,
          c
        ), g = s.child, g.memoizedState = bp(c), g.childLanes = wp(
          i,
          z,
          c
        ), s.memoizedState = vp, s = Wu(null, g));
      else if (xs(s), rg(K)) {
        if (z = K.nextSibling && K.nextSibling.dataset, z) var Ee = z.dgst;
        z = Ee, g = Error(r(419)), g.stack = "", g.digest = z, qu({ value: g, source: null, stack: null }), s = Sp(
          i,
          s,
          c
        );
      } else if (An || pl(i, s, c, !1), z = (c & i.childLanes) !== 0, An || z) {
        if (z = Xt, z !== null && (g = dn(z, c), g !== 0 && g !== ae.retryLane))
          throw ae.retryLane = g, sn(i, g), jr(z, i, g), yp;
        ng(K) || cf(), s = Sp(
          i,
          s,
          c
        );
      } else
        ng(K) ? (s.flags |= 192, s.child = i.child, s = null) : (i = ae.treeContext, rn = li(
          K.nextSibling
        ), Yn = s, Tt = !0, fs = null, si = !1, i !== null && Iw(s, i), s = _p(
          s,
          g.children
        ), s.flags |= 4096);
      return s;
    }
    return b ? (vs(), K = g.fallback, b = s.mode, ae = i.child, Ee = ae.sibling, g = Ca(ae, {
      mode: "hidden",
      children: g.children
    }), g.subtreeFlags = ae.subtreeFlags & 65011712, Ee !== null ? K = Ca(
      Ee,
      K
    ) : (K = io(
      K,
      b,
      c,
      null
    ), K.flags |= 2), K.return = s, g.return = s, g.sibling = K, s.child = g, Wu(null, g), g = s.child, K = i.child.memoizedState, K === null ? K = bp(c) : (b = K.cachePool, b !== null ? (ae = jn._currentValue, b = b.parent !== ae ? { parent: ae, pool: ae } : b) : b = $w(), K = {
      baseLanes: K.baseLanes | c,
      cachePool: b
    }), g.memoizedState = K, g.childLanes = wp(
      i,
      z,
      c
    ), s.memoizedState = vp, Wu(i.child, g)) : (xs(s), c = i.child, i = c.sibling, c = Ca(c, {
      mode: "visible",
      children: g.children
    }), c.return = s, c.sibling = null, i !== null && (z = s.deletions, z === null ? (s.deletions = [i], s.flags |= 16) : z.push(i)), s.child = c, s.memoizedState = null, c);
  }
  function _p(i, s) {
    return s = ef(
      { mode: "visible", children: s },
      i.mode
    ), s.return = i, i.child = s;
  }
  function ef(i, s) {
    return i = Lr(22, i, null, s), i.lanes = 0, i;
  }
  function Sp(i, s, c) {
    return fo(s, i.child, null, c), i = _p(
      s,
      s.pendingProps.children
    ), i.flags |= 2, s.memoizedState = null, i;
  }
  function t3(i, s, c) {
    i.lanes |= s;
    var g = i.alternate;
    g !== null && (g.lanes |= s), qm(i.return, s, c);
  }
  function Cp(i, s, c, g, b, S) {
    var z = i.memoizedState;
    z === null ? i.memoizedState = {
      isBackwards: s,
      rendering: null,
      renderingStartTime: 0,
      last: g,
      tail: c,
      tailMode: b,
      treeForkCount: S
    } : (z.isBackwards = s, z.rendering = null, z.renderingStartTime = 0, z.last = g, z.tail = c, z.tailMode = b, z.treeForkCount = S);
  }
  function n3(i, s, c) {
    var g = s.pendingProps, b = g.revealOrder, S = g.tail;
    g = g.children;
    var z = wn.current, K = (z & 2) !== 0;
    if (K ? (z = z & 1 | 2, s.flags |= 128) : z &= 1, F(wn, z), Wn(i, s, g, c), g = Tt ? Lu : 0, !K && i !== null && (i.flags & 128) !== 0)
      e: for (i = s.child; i !== null; ) {
        if (i.tag === 13)
          i.memoizedState !== null && t3(i, c, s);
        else if (i.tag === 19)
          t3(i, c, s);
        else if (i.child !== null) {
          i.child.return = i, i = i.child;
          continue;
        }
        if (i === s) break e;
        for (; i.sibling === null; ) {
          if (i.return === null || i.return === s)
            break e;
          i = i.return;
        }
        i.sibling.return = i.return, i = i.sibling;
      }
    switch (b) {
      case "forwards":
        for (c = s.child, b = null; c !== null; )
          i = c.alternate, i !== null && $d(i) === null && (b = c), c = c.sibling;
        c = b, c === null ? (b = s.child, s.child = null) : (b = c.sibling, c.sibling = null), Cp(
          s,
          !1,
          b,
          c,
          S,
          g
        );
        break;
      case "backwards":
      case "unstable_legacy-backwards":
        for (c = null, b = s.child, s.child = null; b !== null; ) {
          if (i = b.alternate, i !== null && $d(i) === null) {
            s.child = b;
            break;
          }
          i = b.sibling, b.sibling = c, c = b, b = i;
        }
        Cp(
          s,
          !0,
          c,
          null,
          S,
          g
        );
        break;
      case "together":
        Cp(
          s,
          !1,
          null,
          null,
          void 0,
          g
        );
        break;
      default:
        s.memoizedState = null;
    }
    return s.child;
  }
  function Aa(i, s, c) {
    if (i !== null && (s.dependencies = i.dependencies), _s |= s.lanes, (c & s.childLanes) === 0)
      if (i !== null) {
        if (pl(
          i,
          s,
          c,
          !1
        ), (c & s.childLanes) === 0)
          return null;
      } else return null;
    if (i !== null && s.child !== i.child)
      throw Error(r(153));
    if (s.child !== null) {
      for (i = s.child, c = Ca(i, i.pendingProps), s.child = c, c.return = s; i.sibling !== null; )
        i = i.sibling, c = c.sibling = Ca(i, i.pendingProps), c.return = s;
      c.sibling = null;
    }
    return s.child;
  }
  function Ep(i, s) {
    return (i.lanes & s) !== 0 ? !0 : (i = i.dependencies, !!(i !== null && Od(i)));
  }
  function uM(i, s, c) {
    switch (s.tag) {
      case 3:
        Te(s, s.stateNode.containerInfo), ms(s, jn, i.memoizedState.cache), ao();
        break;
      case 27:
      case 5:
        ke(s);
        break;
      case 4:
        Te(s, s.stateNode.containerInfo);
        break;
      case 10:
        ms(
          s,
          s.type,
          s.memoizedProps.value
        );
        break;
      case 31:
        if (s.memoizedState !== null)
          return s.flags |= 128, Wm(s), null;
        break;
      case 13:
        var g = s.memoizedState;
        if (g !== null)
          return g.dehydrated !== null ? (xs(s), s.flags |= 128, null) : (c & s.child.childLanes) !== 0 ? e3(i, s, c) : (xs(s), i = Aa(
            i,
            s,
            c
          ), i !== null ? i.sibling : null);
        xs(s);
        break;
      case 19:
        var b = (i.flags & 128) !== 0;
        if (g = (c & s.childLanes) !== 0, g || (pl(
          i,
          s,
          c,
          !1
        ), g = (c & s.childLanes) !== 0), b) {
          if (g)
            return n3(
              i,
              s,
              c
            );
          s.flags |= 128;
        }
        if (b = s.memoizedState, b !== null && (b.rendering = null, b.tail = null, b.lastEffect = null), F(wn, wn.current), g) break;
        return null;
      case 22:
        return s.lanes = 0, Y4(
          i,
          s,
          c,
          s.pendingProps
        );
      case 24:
        ms(s, jn, i.memoizedState.cache);
    }
    return Aa(i, s, c);
  }
  function r3(i, s, c) {
    if (i !== null)
      if (i.memoizedProps !== s.pendingProps)
        An = !0;
      else {
        if (!Ep(i, c) && (s.flags & 128) === 0)
          return An = !1, uM(
            i,
            s,
            c
          );
        An = (i.flags & 131072) !== 0;
      }
    else
      An = !1, Tt && (s.flags & 1048576) !== 0 && Dw(s, Lu, s.index);
    switch (s.lanes = 0, s.tag) {
      case 16:
        e: {
          var g = s.pendingProps;
          if (i = uo(s.elementType), s.type = i, typeof i == "function")
            Am(i) ? (g = mo(i, g), s.tag = 1, s = Z4(
              null,
              s,
              i,
              g,
              c
            )) : (s.tag = 0, s = xp(
              null,
              s,
              i,
              g,
              c
            ));
          else {
            if (i != null) {
              var b = i.$$typeof;
              if (b === A) {
                s.tag = 11, s = G4(
                  null,
                  s,
                  i,
                  g,
                  c
                );
                break e;
              } else if (b === O) {
                s.tag = 14, s = V4(
                  null,
                  s,
                  i,
                  g,
                  c
                );
                break e;
              }
            }
            throw s = q(i) || i, Error(r(306, s, ""));
          }
        }
        return s;
      case 0:
        return xp(
          i,
          s,
          s.type,
          s.pendingProps,
          c
        );
      case 1:
        return g = s.type, b = mo(
          g,
          s.pendingProps
        ), Z4(
          i,
          s,
          g,
          b,
          c
        );
      case 3:
        e: {
          if (Te(
            s,
            s.stateNode.containerInfo
          ), i === null) throw Error(r(387));
          g = s.pendingProps;
          var S = s.memoizedState;
          b = S.element, Gm(i, s), Gu(s, g, null, c);
          var z = s.memoizedState;
          if (g = z.cache, ms(s, jn, g), g !== S.cache && Pm(
            s,
            [jn],
            c,
            !0
          ), Hu(), g = z.element, S.isDehydrated)
            if (S = {
              element: g,
              isDehydrated: !1,
              cache: z.cache
            }, s.updateQueue.baseState = S, s.memoizedState = S, s.flags & 256) {
              s = J4(
                i,
                s,
                g,
                c
              );
              break e;
            } else if (g !== b) {
              b = ri(
                Error(r(424)),
                s
              ), qu(b), s = J4(
                i,
                s,
                g,
                c
              );
              break e;
            } else {
              switch (i = s.stateNode.containerInfo, i.nodeType) {
                case 9:
                  i = i.body;
                  break;
                default:
                  i = i.nodeName === "HTML" ? i.ownerDocument.body : i;
              }
              for (rn = li(i.firstChild), Yn = s, Tt = !0, fs = null, si = !0, c = Yw(
                s,
                null,
                g,
                c
              ), s.child = c; c; )
                c.flags = c.flags & -3 | 4096, c = c.sibling;
            }
          else {
            if (ao(), g === b) {
              s = Aa(
                i,
                s,
                c
              );
              break e;
            }
            Wn(i, s, g, c);
          }
          s = s.child;
        }
        return s;
      case 26:
        return Jd(i, s), i === null ? (c = m5(
          s.type,
          null,
          s.pendingProps,
          null
        )) ? s.memoizedState = c : Tt || (c = s.type, i = s.pendingProps, g = yf(
          fe.current
        ).createElement(c), g[Ut] = s, g[fn] = i, Qn(g, c, i), hn(g), s.stateNode = g) : s.memoizedState = m5(
          s.type,
          i.memoizedProps,
          s.pendingProps,
          i.memoizedState
        ), null;
      case 27:
        return ke(s), i === null && Tt && (g = s.stateNode = d5(
          s.type,
          s.pendingProps,
          fe.current
        ), Yn = s, si = !0, b = rn, Ns(s.type) ? (ig = b, rn = li(g.firstChild)) : rn = b), Wn(
          i,
          s,
          s.pendingProps.children,
          c
        ), Jd(i, s), i === null && (s.flags |= 4194304), s.child;
      case 5:
        return i === null && Tt && ((b = g = rn) && (g = PM(
          g,
          s.type,
          s.pendingProps,
          si
        ), g !== null ? (s.stateNode = g, Yn = s, rn = li(g.firstChild), si = !1, b = !0) : b = !1), b || hs(s)), ke(s), b = s.type, S = s.pendingProps, z = i !== null ? i.memoizedProps : null, g = S.children, Jp(b, S) ? g = null : z !== null && Jp(b, z) && (s.flags |= 32), s.memoizedState !== null && (b = Zm(
          i,
          s,
          eM,
          null,
          null,
          c
        ), dc._currentValue = b), Jd(i, s), Wn(i, s, g, c), s.child;
      case 6:
        return i === null && Tt && ((i = c = rn) && (c = BM(
          c,
          s.pendingProps,
          si
        ), c !== null ? (s.stateNode = c, Yn = s, rn = null, i = !0) : i = !1), i || hs(s)), null;
      case 13:
        return e3(i, s, c);
      case 4:
        return Te(
          s,
          s.stateNode.containerInfo
        ), g = s.pendingProps, i === null ? s.child = fo(
          s,
          null,
          g,
          c
        ) : Wn(i, s, g, c), s.child;
      case 11:
        return G4(
          i,
          s,
          s.type,
          s.pendingProps,
          c
        );
      case 7:
        return Wn(
          i,
          s,
          s.pendingProps,
          c
        ), s.child;
      case 8:
        return Wn(
          i,
          s,
          s.pendingProps.children,
          c
        ), s.child;
      case 12:
        return Wn(
          i,
          s,
          s.pendingProps.children,
          c
        ), s.child;
      case 10:
        return g = s.pendingProps, ms(s, s.type, g.value), Wn(i, s, g.children, c), s.child;
      case 9:
        return b = s.type._context, g = s.pendingProps.children, oo(s), b = Xn(b), g = g(b), s.flags |= 1, Wn(i, s, g, c), s.child;
      case 14:
        return V4(
          i,
          s,
          s.type,
          s.pendingProps,
          c
        );
      case 15:
        return K4(
          i,
          s,
          s.type,
          s.pendingProps,
          c
        );
      case 19:
        return n3(i, s, c);
      case 31:
        return lM(i, s, c);
      case 22:
        return Y4(
          i,
          s,
          c,
          s.pendingProps
        );
      case 24:
        return oo(s), g = Xn(jn), i === null ? (b = $m(), b === null && (b = Xt, S = Bm(), b.pooledCache = S, S.refCount++, S !== null && (b.pooledCacheLanes |= c), b = S), s.memoizedState = { parent: g, cache: b }, Hm(s), ms(s, jn, b)) : ((i.lanes & c) !== 0 && (Gm(i, s), Gu(s, null, null, c), Hu()), b = i.memoizedState, S = s.memoizedState, b.parent !== g ? (b = { parent: g, cache: g }, s.memoizedState = b, s.lanes === 0 && (s.memoizedState = s.updateQueue.baseState = b), ms(s, jn, g)) : (g = S.cache, ms(s, jn, g), g !== b.cache && Pm(
          s,
          [jn],
          c,
          !0
        ))), Wn(
          i,
          s,
          s.pendingProps.children,
          c
        ), s.child;
      case 29:
        throw s.pendingProps;
    }
    throw Error(r(156, s.tag));
  }
  function Ma(i) {
    i.flags |= 4;
  }
  function kp(i, s, c, g, b) {
    if ((s = (i.mode & 32) !== 0) && (s = !1), s) {
      if (i.flags |= 16777216, (b & 335544128) === b)
        if (i.stateNode.complete) i.flags |= 8192;
        else if (A3()) i.flags |= 8192;
        else
          throw co = qd, Um;
    } else i.flags &= -16777217;
  }
  function i3(i, s) {
    if (s.type !== "stylesheet" || (s.state.loading & 4) !== 0)
      i.flags &= -16777217;
    else if (i.flags |= 16777216, !v5(s))
      if (A3()) i.flags |= 8192;
      else
        throw co = qd, Um;
  }
  function tf(i, s) {
    s !== null && (i.flags |= 4), i.flags & 16384 && (s = i.tag !== 22 ? Go() : 536870912, i.lanes |= s, Nl |= s);
  }
  function Qu(i, s) {
    if (!Tt)
      switch (i.tailMode) {
        case "hidden":
          s = i.tail;
          for (var c = null; s !== null; )
            s.alternate !== null && (c = s), s = s.sibling;
          c === null ? i.tail = null : c.sibling = null;
          break;
        case "collapsed":
          c = i.tail;
          for (var g = null; c !== null; )
            c.alternate !== null && (g = c), c = c.sibling;
          g === null ? s || i.tail === null ? i.tail = null : i.tail.sibling = null : g.sibling = null;
      }
  }
  function an(i) {
    var s = i.alternate !== null && i.alternate.child === i.child, c = 0, g = 0;
    if (s)
      for (var b = i.child; b !== null; )
        c |= b.lanes | b.childLanes, g |= b.subtreeFlags & 65011712, g |= b.flags & 65011712, b.return = i, b = b.sibling;
    else
      for (b = i.child; b !== null; )
        c |= b.lanes | b.childLanes, g |= b.subtreeFlags, g |= b.flags, b.return = i, b = b.sibling;
    return i.subtreeFlags |= g, i.childLanes = c, s;
  }
  function cM(i, s, c) {
    var g = s.pendingProps;
    switch (Om(s), s.tag) {
      case 16:
      case 15:
      case 0:
      case 11:
      case 7:
      case 8:
      case 12:
      case 9:
      case 14:
        return an(s), null;
      case 1:
        return an(s), null;
      case 3:
        return c = s.stateNode, g = null, i !== null && (g = i.memoizedState.cache), s.memoizedState.cache !== g && (s.flags |= 2048), Na(jn), we(), c.pendingContext && (c.context = c.pendingContext, c.pendingContext = null), (i === null || i.child === null) && (ml(s) ? Ma(s) : i === null || i.memoizedState.isDehydrated && (s.flags & 256) === 0 || (s.flags |= 1024, Im())), an(s), null;
      case 26:
        var b = s.type, S = s.memoizedState;
        return i === null ? (Ma(s), S !== null ? (an(s), i3(s, S)) : (an(s), kp(
          s,
          b,
          null,
          g,
          c
        ))) : S ? S !== i.memoizedState ? (Ma(s), an(s), i3(s, S)) : (an(s), s.flags &= -16777217) : (i = i.memoizedProps, i !== g && Ma(s), an(s), kp(
          s,
          b,
          i,
          g,
          c
        )), null;
      case 27:
        if (_e(s), c = fe.current, b = s.type, i !== null && s.stateNode != null)
          i.memoizedProps !== g && Ma(s);
        else {
          if (!g) {
            if (s.stateNode === null)
              throw Error(r(166));
            return an(s), null;
          }
          i = Z.current, ml(s) ? Lw(s) : (i = d5(b, g, c), s.stateNode = i, Ma(s));
        }
        return an(s), null;
      case 5:
        if (_e(s), b = s.type, i !== null && s.stateNode != null)
          i.memoizedProps !== g && Ma(s);
        else {
          if (!g) {
            if (s.stateNode === null)
              throw Error(r(166));
            return an(s), null;
          }
          if (S = Z.current, ml(s))
            Lw(s);
          else {
            var z = yf(
              fe.current
            );
            switch (S) {
              case 1:
                S = z.createElementNS(
                  "http://www.w3.org/2000/svg",
                  b
                );
                break;
              case 2:
                S = z.createElementNS(
                  "http://www.w3.org/1998/Math/MathML",
                  b
                );
                break;
              default:
                switch (b) {
                  case "svg":
                    S = z.createElementNS(
                      "http://www.w3.org/2000/svg",
                      b
                    );
                    break;
                  case "math":
                    S = z.createElementNS(
                      "http://www.w3.org/1998/Math/MathML",
                      b
                    );
                    break;
                  case "script":
                    S = z.createElement("div"), S.innerHTML = "<script><\/script>", S = S.removeChild(
                      S.firstChild
                    );
                    break;
                  case "select":
                    S = typeof g.is == "string" ? z.createElement("select", {
                      is: g.is
                    }) : z.createElement("select"), g.multiple ? S.multiple = !0 : g.size && (S.size = g.size);
                    break;
                  default:
                    S = typeof g.is == "string" ? z.createElement(b, { is: g.is }) : z.createElement(b);
                }
            }
            S[Ut] = s, S[fn] = g;
            e: for (z = s.child; z !== null; ) {
              if (z.tag === 5 || z.tag === 6)
                S.appendChild(z.stateNode);
              else if (z.tag !== 4 && z.tag !== 27 && z.child !== null) {
                z.child.return = z, z = z.child;
                continue;
              }
              if (z === s) break e;
              for (; z.sibling === null; ) {
                if (z.return === null || z.return === s)
                  break e;
                z = z.return;
              }
              z.sibling.return = z.return, z = z.sibling;
            }
            s.stateNode = S;
            e: switch (Qn(S, b, g), b) {
              case "button":
              case "input":
              case "select":
              case "textarea":
                g = !!g.autoFocus;
                break e;
              case "img":
                g = !0;
                break e;
              default:
                g = !1;
            }
            g && Ma(s);
          }
        }
        return an(s), kp(
          s,
          s.type,
          i === null ? null : i.memoizedProps,
          s.pendingProps,
          c
        ), null;
      case 6:
        if (i && s.stateNode != null)
          i.memoizedProps !== g && Ma(s);
        else {
          if (typeof g != "string" && s.stateNode === null)
            throw Error(r(166));
          if (i = fe.current, ml(s)) {
            if (i = s.stateNode, c = s.memoizedProps, g = null, b = Yn, b !== null)
              switch (b.tag) {
                case 27:
                case 5:
                  g = b.memoizedProps;
              }
            i[Ut] = s, i = !!(i.nodeValue === c || g !== null && g.suppressHydrationWarning === !0 || e5(i.nodeValue, c)), i || hs(s, !0);
          } else
            i = yf(i).createTextNode(
              g
            ), i[Ut] = s, s.stateNode = i;
        }
        return an(s), null;
      case 31:
        if (c = s.memoizedState, i === null || i.memoizedState !== null) {
          if (g = ml(s), c !== null) {
            if (i === null) {
              if (!g) throw Error(r(318));
              if (i = s.memoizedState, i = i !== null ? i.dehydrated : null, !i) throw Error(r(557));
              i[Ut] = s;
            } else
              ao(), (s.flags & 128) === 0 && (s.memoizedState = null), s.flags |= 4;
            an(s), i = !1;
          } else
            c = Im(), i !== null && i.memoizedState !== null && (i.memoizedState.hydrationErrors = c), i = !0;
          if (!i)
            return s.flags & 256 ? (Pr(s), s) : (Pr(s), null);
          if ((s.flags & 128) !== 0)
            throw Error(r(558));
        }
        return an(s), null;
      case 13:
        if (g = s.memoizedState, i === null || i.memoizedState !== null && i.memoizedState.dehydrated !== null) {
          if (b = ml(s), g !== null && g.dehydrated !== null) {
            if (i === null) {
              if (!b) throw Error(r(318));
              if (b = s.memoizedState, b = b !== null ? b.dehydrated : null, !b) throw Error(r(317));
              b[Ut] = s;
            } else
              ao(), (s.flags & 128) === 0 && (s.memoizedState = null), s.flags |= 4;
            an(s), b = !1;
          } else
            b = Im(), i !== null && i.memoizedState !== null && (i.memoizedState.hydrationErrors = b), b = !0;
          if (!b)
            return s.flags & 256 ? (Pr(s), s) : (Pr(s), null);
        }
        return Pr(s), (s.flags & 128) !== 0 ? (s.lanes = c, s) : (c = g !== null, i = i !== null && i.memoizedState !== null, c && (g = s.child, b = null, g.alternate !== null && g.alternate.memoizedState !== null && g.alternate.memoizedState.cachePool !== null && (b = g.alternate.memoizedState.cachePool.pool), S = null, g.memoizedState !== null && g.memoizedState.cachePool !== null && (S = g.memoizedState.cachePool.pool), S !== b && (g.flags |= 2048)), c !== i && c && (s.child.flags |= 8192), tf(s, s.updateQueue), an(s), null);
      case 4:
        return we(), i === null && Yp(s.stateNode.containerInfo), an(s), null;
      case 10:
        return Na(s.type), an(s), null;
      case 19:
        if (J(wn), g = s.memoizedState, g === null) return an(s), null;
        if (b = (s.flags & 128) !== 0, S = g.rendering, S === null)
          if (b) Qu(g, !1);
          else {
            if (xn !== 0 || i !== null && (i.flags & 128) !== 0)
              for (i = s.child; i !== null; ) {
                if (S = $d(i), S !== null) {
                  for (s.flags |= 128, Qu(g, !1), i = S.updateQueue, s.updateQueue = i, tf(s, i), s.subtreeFlags = 0, i = c, c = s.child; c !== null; )
                    Rw(c, i), c = c.sibling;
                  return F(
                    wn,
                    wn.current & 1 | 2
                  ), Tt && Ea(s, g.treeForkCount), s.child;
                }
                i = i.sibling;
              }
            g.tail !== null && Yt() > of && (s.flags |= 128, b = !0, Qu(g, !1), s.lanes = 4194304);
          }
        else {
          if (!b)
            if (i = $d(S), i !== null) {
              if (s.flags |= 128, b = !0, i = i.updateQueue, s.updateQueue = i, tf(s, i), Qu(g, !0), g.tail === null && g.tailMode === "hidden" && !S.alternate && !Tt)
                return an(s), null;
            } else
              2 * Yt() - g.renderingStartTime > of && c !== 536870912 && (s.flags |= 128, b = !0, Qu(g, !1), s.lanes = 4194304);
          g.isBackwards ? (S.sibling = s.child, s.child = S) : (i = g.last, i !== null ? i.sibling = S : s.child = S, g.last = S);
        }
        return g.tail !== null ? (i = g.tail, g.rendering = i, g.tail = i.sibling, g.renderingStartTime = Yt(), i.sibling = null, c = wn.current, F(
          wn,
          b ? c & 1 | 2 : c & 1
        ), Tt && Ea(s, g.treeForkCount), i) : (an(s), null);
      case 22:
      case 23:
        return Pr(s), Xm(), g = s.memoizedState !== null, i !== null ? i.memoizedState !== null !== g && (s.flags |= 8192) : g && (s.flags |= 8192), g ? (c & 536870912) !== 0 && (s.flags & 128) === 0 && (an(s), s.subtreeFlags & 6 && (s.flags |= 8192)) : an(s), c = s.updateQueue, c !== null && tf(s, c.retryQueue), c = null, i !== null && i.memoizedState !== null && i.memoizedState.cachePool !== null && (c = i.memoizedState.cachePool.pool), g = null, s.memoizedState !== null && s.memoizedState.cachePool !== null && (g = s.memoizedState.cachePool.pool), g !== c && (s.flags |= 2048), i !== null && J(lo), null;
      case 24:
        return c = null, i !== null && (c = i.memoizedState.cache), s.memoizedState.cache !== c && (s.flags |= 2048), Na(jn), an(s), null;
      case 25:
        return null;
      case 30:
        return null;
    }
    throw Error(r(156, s.tag));
  }
  function dM(i, s) {
    switch (Om(s), s.tag) {
      case 1:
        return i = s.flags, i & 65536 ? (s.flags = i & -65537 | 128, s) : null;
      case 3:
        return Na(jn), we(), i = s.flags, (i & 65536) !== 0 && (i & 128) === 0 ? (s.flags = i & -65537 | 128, s) : null;
      case 26:
      case 27:
      case 5:
        return _e(s), null;
      case 31:
        if (s.memoizedState !== null) {
          if (Pr(s), s.alternate === null)
            throw Error(r(340));
          ao();
        }
        return i = s.flags, i & 65536 ? (s.flags = i & -65537 | 128, s) : null;
      case 13:
        if (Pr(s), i = s.memoizedState, i !== null && i.dehydrated !== null) {
          if (s.alternate === null)
            throw Error(r(340));
          ao();
        }
        return i = s.flags, i & 65536 ? (s.flags = i & -65537 | 128, s) : null;
      case 19:
        return J(wn), null;
      case 4:
        return we(), null;
      case 10:
        return Na(s.type), null;
      case 22:
      case 23:
        return Pr(s), Xm(), i !== null && J(lo), i = s.flags, i & 65536 ? (s.flags = i & -65537 | 128, s) : null;
      case 24:
        return Na(jn), null;
      case 25:
        return null;
      default:
        return null;
    }
  }
  function a3(i, s) {
    switch (Om(s), s.tag) {
      case 3:
        Na(jn), we();
        break;
      case 26:
      case 27:
      case 5:
        _e(s);
        break;
      case 4:
        we();
        break;
      case 31:
        s.memoizedState !== null && Pr(s);
        break;
      case 13:
        Pr(s);
        break;
      case 19:
        J(wn);
        break;
      case 10:
        Na(s.type);
        break;
      case 22:
      case 23:
        Pr(s), Xm(), i !== null && J(lo);
        break;
      case 24:
        Na(jn);
    }
  }
  function Zu(i, s) {
    try {
      var c = s.updateQueue, g = c !== null ? c.lastEffect : null;
      if (g !== null) {
        var b = g.next;
        c = b;
        do {
          if ((c.tag & i) === i) {
            g = void 0;
            var S = c.create, z = c.inst;
            g = S(), z.destroy = g;
          }
          c = c.next;
        } while (c !== b);
      }
    } catch (K) {
      $t(s, s.return, K);
    }
  }
  function bs(i, s, c) {
    try {
      var g = s.updateQueue, b = g !== null ? g.lastEffect : null;
      if (b !== null) {
        var S = b.next;
        g = S;
        do {
          if ((g.tag & i) === i) {
            var z = g.inst, K = z.destroy;
            if (K !== void 0) {
              z.destroy = void 0, b = s;
              var ae = c, Ee = K;
              try {
                Ee();
              } catch (Oe) {
                $t(
                  b,
                  ae,
                  Oe
                );
              }
            }
          }
          g = g.next;
        } while (g !== S);
      }
    } catch (Oe) {
      $t(s, s.return, Oe);
    }
  }
  function s3(i) {
    var s = i.updateQueue;
    if (s !== null) {
      var c = i.stateNode;
      try {
        Ww(s, c);
      } catch (g) {
        $t(i, i.return, g);
      }
    }
  }
  function o3(i, s, c) {
    c.props = mo(
      i.type,
      i.memoizedProps
    ), c.state = i.memoizedState;
    try {
      c.componentWillUnmount();
    } catch (g) {
      $t(i, s, g);
    }
  }
  function Ju(i, s) {
    try {
      var c = i.ref;
      if (c !== null) {
        switch (i.tag) {
          case 26:
          case 27:
          case 5:
            var g = i.stateNode;
            break;
          case 30:
            g = i.stateNode;
            break;
          default:
            g = i.stateNode;
        }
        typeof c == "function" ? i.refCleanup = c(g) : c.current = g;
      }
    } catch (b) {
      $t(i, s, b);
    }
  }
  function Hi(i, s) {
    var c = i.ref, g = i.refCleanup;
    if (c !== null)
      if (typeof g == "function")
        try {
          g();
        } catch (b) {
          $t(i, s, b);
        } finally {
          i.refCleanup = null, i = i.alternate, i != null && (i.refCleanup = null);
        }
      else if (typeof c == "function")
        try {
          c(null);
        } catch (b) {
          $t(i, s, b);
        }
      else c.current = null;
  }
  function l3(i) {
    var s = i.type, c = i.memoizedProps, g = i.stateNode;
    try {
      e: switch (s) {
        case "button":
        case "input":
        case "select":
        case "textarea":
          c.autoFocus && g.focus();
          break e;
        case "img":
          c.src ? g.src = c.src : c.srcSet && (g.srcset = c.srcSet);
      }
    } catch (b) {
      $t(i, i.return, b);
    }
  }
  function Np(i, s, c) {
    try {
      var g = i.stateNode;
      zM(g, i.type, c, s), g[fn] = s;
    } catch (b) {
      $t(i, i.return, b);
    }
  }
  function u3(i) {
    return i.tag === 5 || i.tag === 3 || i.tag === 26 || i.tag === 27 && Ns(i.type) || i.tag === 4;
  }
  function jp(i) {
    e: for (; ; ) {
      for (; i.sibling === null; ) {
        if (i.return === null || u3(i.return)) return null;
        i = i.return;
      }
      for (i.sibling.return = i.return, i = i.sibling; i.tag !== 5 && i.tag !== 6 && i.tag !== 18; ) {
        if (i.tag === 27 && Ns(i.type) || i.flags & 2 || i.child === null || i.tag === 4) continue e;
        i.child.return = i, i = i.child;
      }
      if (!(i.flags & 2)) return i.stateNode;
    }
  }
  function Tp(i, s, c) {
    var g = i.tag;
    if (g === 5 || g === 6)
      i = i.stateNode, s ? (c.nodeType === 9 ? c.body : c.nodeName === "HTML" ? c.ownerDocument.body : c).insertBefore(i, s) : (s = c.nodeType === 9 ? c.body : c.nodeName === "HTML" ? c.ownerDocument.body : c, s.appendChild(i), c = c._reactRootContainer, c != null || s.onclick !== null || (s.onclick = _r));
    else if (g !== 4 && (g === 27 && Ns(i.type) && (c = i.stateNode, s = null), i = i.child, i !== null))
      for (Tp(i, s, c), i = i.sibling; i !== null; )
        Tp(i, s, c), i = i.sibling;
  }
  function nf(i, s, c) {
    var g = i.tag;
    if (g === 5 || g === 6)
      i = i.stateNode, s ? c.insertBefore(i, s) : c.appendChild(i);
    else if (g !== 4 && (g === 27 && Ns(i.type) && (c = i.stateNode), i = i.child, i !== null))
      for (nf(i, s, c), i = i.sibling; i !== null; )
        nf(i, s, c), i = i.sibling;
  }
  function c3(i) {
    var s = i.stateNode, c = i.memoizedProps;
    try {
      for (var g = i.type, b = s.attributes; b.length; )
        s.removeAttributeNode(b[0]);
      Qn(s, g, c), s[Ut] = i, s[fn] = c;
    } catch (S) {
      $t(i, i.return, S);
    }
  }
  var Ra = !1, Mn = !1, Ap = !1, d3 = typeof WeakSet == "function" ? WeakSet : Set, Kn = null;
  function fM(i, s) {
    if (i = i.containerInfo, Qp = Cf, i = I(i), $(i)) {
      if ("selectionStart" in i)
        var c = {
          start: i.selectionStart,
          end: i.selectionEnd
        };
      else
        e: {
          c = (c = i.ownerDocument) && c.defaultView || window;
          var g = c.getSelection && c.getSelection();
          if (g && g.rangeCount !== 0) {
            c = g.anchorNode;
            var b = g.anchorOffset, S = g.focusNode;
            g = g.focusOffset;
            try {
              c.nodeType, S.nodeType;
            } catch {
              c = null;
              break e;
            }
            var z = 0, K = -1, ae = -1, Ee = 0, Oe = 0, Le = i, je = null;
            t: for (; ; ) {
              for (var Me; Le !== c || b !== 0 && Le.nodeType !== 3 || (K = z + b), Le !== S || g !== 0 && Le.nodeType !== 3 || (ae = z + g), Le.nodeType === 3 && (z += Le.nodeValue.length), (Me = Le.firstChild) !== null; )
                je = Le, Le = Me;
              for (; ; ) {
                if (Le === i) break t;
                if (je === c && ++Ee === b && (K = z), je === S && ++Oe === g && (ae = z), (Me = Le.nextSibling) !== null) break;
                Le = je, je = Le.parentNode;
              }
              Le = Me;
            }
            c = K === -1 || ae === -1 ? null : { start: K, end: ae };
          } else c = null;
        }
      c = c || { start: 0, end: 0 };
    } else c = null;
    for (Zp = { focusedElem: i, selectionRange: c }, Cf = !1, Kn = s; Kn !== null; )
      if (s = Kn, i = s.child, (s.subtreeFlags & 1028) !== 0 && i !== null)
        i.return = s, Kn = i;
      else
        for (; Kn !== null; ) {
          switch (s = Kn, S = s.alternate, i = s.flags, s.tag) {
            case 0:
              if ((i & 4) !== 0 && (i = s.updateQueue, i = i !== null ? i.events : null, i !== null))
                for (c = 0; c < i.length; c++)
                  b = i[c], b.ref.impl = b.nextImpl;
              break;
            case 11:
            case 15:
              break;
            case 1:
              if ((i & 1024) !== 0 && S !== null) {
                i = void 0, c = s, b = S.memoizedProps, S = S.memoizedState, g = c.stateNode;
                try {
                  var tt = mo(
                    c.type,
                    b
                  );
                  i = g.getSnapshotBeforeUpdate(
                    tt,
                    S
                  ), g.__reactInternalSnapshotBeforeUpdate = i;
                } catch (ct) {
                  $t(
                    c,
                    c.return,
                    ct
                  );
                }
              }
              break;
            case 3:
              if ((i & 1024) !== 0) {
                if (i = s.stateNode.containerInfo, c = i.nodeType, c === 9)
                  tg(i);
                else if (c === 1)
                  switch (i.nodeName) {
                    case "HEAD":
                    case "HTML":
                    case "BODY":
                      tg(i);
                      break;
                    default:
                      i.textContent = "";
                  }
              }
              break;
            case 5:
            case 26:
            case 27:
            case 6:
            case 4:
            case 17:
              break;
            default:
              if ((i & 1024) !== 0) throw Error(r(163));
          }
          if (i = s.sibling, i !== null) {
            i.return = s.return, Kn = i;
            break;
          }
          Kn = s.return;
        }
  }
  function f3(i, s, c) {
    var g = c.flags;
    switch (c.tag) {
      case 0:
      case 11:
      case 15:
        Oa(i, c), g & 4 && Zu(5, c);
        break;
      case 1:
        if (Oa(i, c), g & 4)
          if (i = c.stateNode, s === null)
            try {
              i.componentDidMount();
            } catch (z) {
              $t(c, c.return, z);
            }
          else {
            var b = mo(
              c.type,
              s.memoizedProps
            );
            s = s.memoizedState;
            try {
              i.componentDidUpdate(
                b,
                s,
                i.__reactInternalSnapshotBeforeUpdate
              );
            } catch (z) {
              $t(
                c,
                c.return,
                z
              );
            }
          }
        g & 64 && s3(c), g & 512 && Ju(c, c.return);
        break;
      case 3:
        if (Oa(i, c), g & 64 && (i = c.updateQueue, i !== null)) {
          if (s = null, c.child !== null)
            switch (c.child.tag) {
              case 27:
              case 5:
                s = c.child.stateNode;
                break;
              case 1:
                s = c.child.stateNode;
            }
          try {
            Ww(i, s);
          } catch (z) {
            $t(c, c.return, z);
          }
        }
        break;
      case 27:
        s === null && g & 4 && c3(c);
      case 26:
      case 5:
        Oa(i, c), s === null && g & 4 && l3(c), g & 512 && Ju(c, c.return);
        break;
      case 12:
        Oa(i, c);
        break;
      case 31:
        Oa(i, c), g & 4 && p3(i, c);
        break;
      case 13:
        Oa(i, c), g & 4 && g3(i, c), g & 64 && (i = c.memoizedState, i !== null && (i = i.dehydrated, i !== null && (c = wM.bind(
          null,
          c
        ), FM(i, c))));
        break;
      case 22:
        if (g = c.memoizedState !== null || Ra, !g) {
          s = s !== null && s.memoizedState !== null || Mn, b = Ra;
          var S = Mn;
          Ra = g, (Mn = s) && !S ? Da(
            i,
            c,
            (c.subtreeFlags & 8772) !== 0
          ) : Oa(i, c), Ra = b, Mn = S;
        }
        break;
      case 30:
        break;
      default:
        Oa(i, c);
    }
  }
  function h3(i) {
    var s = i.alternate;
    s !== null && (i.alternate = null, h3(s)), i.child = null, i.deletions = null, i.sibling = null, i.tag === 5 && (s = i.stateNode, s !== null && Ja(s)), i.stateNode = null, i.return = null, i.dependencies = null, i.memoizedProps = null, i.memoizedState = null, i.pendingProps = null, i.stateNode = null, i.updateQueue = null;
  }
  var on = null, Cr = !1;
  function za(i, s, c) {
    for (c = c.child; c !== null; )
      m3(i, s, c), c = c.sibling;
  }
  function m3(i, s, c) {
    if (Rt && typeof Rt.onCommitFiberUnmount == "function")
      try {
        Rt.onCommitFiberUnmount(It, c);
      } catch {
      }
    switch (c.tag) {
      case 26:
        Mn || Hi(c, s), za(
          i,
          s,
          c
        ), c.memoizedState ? c.memoizedState.count-- : c.stateNode && (c = c.stateNode, c.parentNode.removeChild(c));
        break;
      case 27:
        Mn || Hi(c, s);
        var g = on, b = Cr;
        Ns(c.type) && (on = c.stateNode, Cr = !1), za(
          i,
          s,
          c
        ), lc(c.stateNode), on = g, Cr = b;
        break;
      case 5:
        Mn || Hi(c, s);
      case 6:
        if (g = on, b = Cr, on = null, za(
          i,
          s,
          c
        ), on = g, Cr = b, on !== null)
          if (Cr)
            try {
              (on.nodeType === 9 ? on.body : on.nodeName === "HTML" ? on.ownerDocument.body : on).removeChild(c.stateNode);
            } catch (S) {
              $t(
                c,
                s,
                S
              );
            }
          else
            try {
              on.removeChild(c.stateNode);
            } catch (S) {
              $t(
                c,
                s,
                S
              );
            }
        break;
      case 18:
        on !== null && (Cr ? (i = on, s5(
          i.nodeType === 9 ? i.body : i.nodeName === "HTML" ? i.ownerDocument.body : i,
          c.stateNode
        ), Dl(i)) : s5(on, c.stateNode));
        break;
      case 4:
        g = on, b = Cr, on = c.stateNode.containerInfo, Cr = !0, za(
          i,
          s,
          c
        ), on = g, Cr = b;
        break;
      case 0:
      case 11:
      case 14:
      case 15:
        bs(2, c, s), Mn || bs(4, c, s), za(
          i,
          s,
          c
        );
        break;
      case 1:
        Mn || (Hi(c, s), g = c.stateNode, typeof g.componentWillUnmount == "function" && o3(
          c,
          s,
          g
        )), za(
          i,
          s,
          c
        );
        break;
      case 21:
        za(
          i,
          s,
          c
        );
        break;
      case 22:
        Mn = (g = Mn) || c.memoizedState !== null, za(
          i,
          s,
          c
        ), Mn = g;
        break;
      default:
        za(
          i,
          s,
          c
        );
    }
  }
  function p3(i, s) {
    if (s.memoizedState === null && (i = s.alternate, i !== null && (i = i.memoizedState, i !== null))) {
      i = i.dehydrated;
      try {
        Dl(i);
      } catch (c) {
        $t(s, s.return, c);
      }
    }
  }
  function g3(i, s) {
    if (s.memoizedState === null && (i = s.alternate, i !== null && (i = i.memoizedState, i !== null && (i = i.dehydrated, i !== null))))
      try {
        Dl(i);
      } catch (c) {
        $t(s, s.return, c);
      }
  }
  function hM(i) {
    switch (i.tag) {
      case 31:
      case 13:
      case 19:
        var s = i.stateNode;
        return s === null && (s = i.stateNode = new d3()), s;
      case 22:
        return i = i.stateNode, s = i._retryCache, s === null && (s = i._retryCache = new d3()), s;
      default:
        throw Error(r(435, i.tag));
    }
  }
  function rf(i, s) {
    var c = hM(i);
    s.forEach(function(g) {
      if (!c.has(g)) {
        c.add(g);
        var b = _M.bind(null, i, g);
        g.then(b, b);
      }
    });
  }
  function Er(i, s) {
    var c = s.deletions;
    if (c !== null)
      for (var g = 0; g < c.length; g++) {
        var b = c[g], S = i, z = s, K = z;
        e: for (; K !== null; ) {
          switch (K.tag) {
            case 27:
              if (Ns(K.type)) {
                on = K.stateNode, Cr = !1;
                break e;
              }
              break;
            case 5:
              on = K.stateNode, Cr = !1;
              break e;
            case 3:
            case 4:
              on = K.stateNode.containerInfo, Cr = !0;
              break e;
          }
          K = K.return;
        }
        if (on === null) throw Error(r(160));
        m3(S, z, b), on = null, Cr = !1, S = b.alternate, S !== null && (S.return = null), b.return = null;
      }
    if (s.subtreeFlags & 13886)
      for (s = s.child; s !== null; )
        y3(s, i), s = s.sibling;
  }
  var _i = null;
  function y3(i, s) {
    var c = i.alternate, g = i.flags;
    switch (i.tag) {
      case 0:
      case 11:
      case 14:
      case 15:
        Er(s, i), kr(i), g & 4 && (bs(3, i, i.return), Zu(3, i), bs(5, i, i.return));
        break;
      case 1:
        Er(s, i), kr(i), g & 512 && (Mn || c === null || Hi(c, c.return)), g & 64 && Ra && (i = i.updateQueue, i !== null && (g = i.callbacks, g !== null && (c = i.shared.hiddenCallbacks, i.shared.hiddenCallbacks = c === null ? g : c.concat(g))));
        break;
      case 26:
        var b = _i;
        if (Er(s, i), kr(i), g & 512 && (Mn || c === null || Hi(c, c.return)), g & 4) {
          var S = c !== null ? c.memoizedState : null;
          if (g = i.memoizedState, c === null)
            if (g === null)
              if (i.stateNode === null) {
                e: {
                  g = i.type, c = i.memoizedProps, b = b.ownerDocument || b;
                  t: switch (g) {
                    case "title":
                      S = b.getElementsByTagName("title")[0], (!S || S[dr] || S[Ut] || S.namespaceURI === "http://www.w3.org/2000/svg" || S.hasAttribute("itemprop")) && (S = b.createElement(g), b.head.insertBefore(
                        S,
                        b.querySelector("head > title")
                      )), Qn(S, g, c), S[Ut] = i, hn(S), g = S;
                      break e;
                    case "link":
                      var z = y5(
                        "link",
                        "href",
                        b
                      ).get(g + (c.href || ""));
                      if (z) {
                        for (var K = 0; K < z.length; K++)
                          if (S = z[K], S.getAttribute("href") === (c.href == null || c.href === "" ? null : c.href) && S.getAttribute("rel") === (c.rel == null ? null : c.rel) && S.getAttribute("title") === (c.title == null ? null : c.title) && S.getAttribute("crossorigin") === (c.crossOrigin == null ? null : c.crossOrigin)) {
                            z.splice(K, 1);
                            break t;
                          }
                      }
                      S = b.createElement(g), Qn(S, g, c), b.head.appendChild(S);
                      break;
                    case "meta":
                      if (z = y5(
                        "meta",
                        "content",
                        b
                      ).get(g + (c.content || ""))) {
                        for (K = 0; K < z.length; K++)
                          if (S = z[K], S.getAttribute("content") === (c.content == null ? null : "" + c.content) && S.getAttribute("name") === (c.name == null ? null : c.name) && S.getAttribute("property") === (c.property == null ? null : c.property) && S.getAttribute("http-equiv") === (c.httpEquiv == null ? null : c.httpEquiv) && S.getAttribute("charset") === (c.charSet == null ? null : c.charSet)) {
                            z.splice(K, 1);
                            break t;
                          }
                      }
                      S = b.createElement(g), Qn(S, g, c), b.head.appendChild(S);
                      break;
                    default:
                      throw Error(r(468, g));
                  }
                  S[Ut] = i, hn(S), g = S;
                }
                i.stateNode = g;
              } else
                x5(
                  b,
                  i.type,
                  i.stateNode
                );
            else
              i.stateNode = g5(
                b,
                g,
                i.memoizedProps
              );
          else
            S !== g ? (S === null ? c.stateNode !== null && (c = c.stateNode, c.parentNode.removeChild(c)) : S.count--, g === null ? x5(
              b,
              i.type,
              i.stateNode
            ) : g5(
              b,
              g,
              i.memoizedProps
            )) : g === null && i.stateNode !== null && Np(
              i,
              i.memoizedProps,
              c.memoizedProps
            );
        }
        break;
      case 27:
        Er(s, i), kr(i), g & 512 && (Mn || c === null || Hi(c, c.return)), c !== null && g & 4 && Np(
          i,
          i.memoizedProps,
          c.memoizedProps
        );
        break;
      case 5:
        if (Er(s, i), kr(i), g & 512 && (Mn || c === null || Hi(c, c.return)), i.flags & 32) {
          b = i.stateNode;
          try {
            pa(b, "");
          } catch (tt) {
            $t(i, i.return, tt);
          }
        }
        g & 4 && i.stateNode != null && (b = i.memoizedProps, Np(
          i,
          b,
          c !== null ? c.memoizedProps : b
        )), g & 1024 && (Ap = !0);
        break;
      case 6:
        if (Er(s, i), kr(i), g & 4) {
          if (i.stateNode === null)
            throw Error(r(162));
          g = i.memoizedProps, c = i.stateNode;
          try {
            c.nodeValue = g;
          } catch (tt) {
            $t(i, i.return, tt);
          }
        }
        break;
      case 3:
        if (bf = null, b = _i, _i = xf(s.containerInfo), Er(s, i), _i = b, kr(i), g & 4 && c !== null && c.memoizedState.isDehydrated)
          try {
            Dl(s.containerInfo);
          } catch (tt) {
            $t(i, i.return, tt);
          }
        Ap && (Ap = !1, x3(i));
        break;
      case 4:
        g = _i, _i = xf(
          i.stateNode.containerInfo
        ), Er(s, i), kr(i), _i = g;
        break;
      case 12:
        Er(s, i), kr(i);
        break;
      case 31:
        Er(s, i), kr(i), g & 4 && (g = i.updateQueue, g !== null && (i.updateQueue = null, rf(i, g)));
        break;
      case 13:
        Er(s, i), kr(i), i.child.flags & 8192 && i.memoizedState !== null != (c !== null && c.memoizedState !== null) && (sf = Yt()), g & 4 && (g = i.updateQueue, g !== null && (i.updateQueue = null, rf(i, g)));
        break;
      case 22:
        b = i.memoizedState !== null;
        var ae = c !== null && c.memoizedState !== null, Ee = Ra, Oe = Mn;
        if (Ra = Ee || b, Mn = Oe || ae, Er(s, i), Mn = Oe, Ra = Ee, kr(i), g & 8192)
          e: for (s = i.stateNode, s._visibility = b ? s._visibility & -2 : s._visibility | 1, b && (c === null || ae || Ra || Mn || po(i)), c = null, s = i; ; ) {
            if (s.tag === 5 || s.tag === 26) {
              if (c === null) {
                ae = c = s;
                try {
                  if (S = ae.stateNode, b)
                    z = S.style, typeof z.setProperty == "function" ? z.setProperty("display", "none", "important") : z.display = "none";
                  else {
                    K = ae.stateNode;
                    var Le = ae.memoizedProps.style, je = Le != null && Le.hasOwnProperty("display") ? Le.display : null;
                    K.style.display = je == null || typeof je == "boolean" ? "" : ("" + je).trim();
                  }
                } catch (tt) {
                  $t(ae, ae.return, tt);
                }
              }
            } else if (s.tag === 6) {
              if (c === null) {
                ae = s;
                try {
                  ae.stateNode.nodeValue = b ? "" : ae.memoizedProps;
                } catch (tt) {
                  $t(ae, ae.return, tt);
                }
              }
            } else if (s.tag === 18) {
              if (c === null) {
                ae = s;
                try {
                  var Me = ae.stateNode;
                  b ? o5(Me, !0) : o5(ae.stateNode, !1);
                } catch (tt) {
                  $t(ae, ae.return, tt);
                }
              }
            } else if ((s.tag !== 22 && s.tag !== 23 || s.memoizedState === null || s === i) && s.child !== null) {
              s.child.return = s, s = s.child;
              continue;
            }
            if (s === i) break e;
            for (; s.sibling === null; ) {
              if (s.return === null || s.return === i) break e;
              c === s && (c = null), s = s.return;
            }
            c === s && (c = null), s.sibling.return = s.return, s = s.sibling;
          }
        g & 4 && (g = i.updateQueue, g !== null && (c = g.retryQueue, c !== null && (g.retryQueue = null, rf(i, c))));
        break;
      case 19:
        Er(s, i), kr(i), g & 4 && (g = i.updateQueue, g !== null && (i.updateQueue = null, rf(i, g)));
        break;
      case 30:
        break;
      case 21:
        break;
      default:
        Er(s, i), kr(i);
    }
  }
  function kr(i) {
    var s = i.flags;
    if (s & 2) {
      try {
        for (var c, g = i.return; g !== null; ) {
          if (u3(g)) {
            c = g;
            break;
          }
          g = g.return;
        }
        if (c == null) throw Error(r(160));
        switch (c.tag) {
          case 27:
            var b = c.stateNode, S = jp(i);
            nf(i, S, b);
            break;
          case 5:
            var z = c.stateNode;
            c.flags & 32 && (pa(z, ""), c.flags &= -33);
            var K = jp(i);
            nf(i, K, z);
            break;
          case 3:
          case 4:
            var ae = c.stateNode.containerInfo, Ee = jp(i);
            Tp(
              i,
              Ee,
              ae
            );
            break;
          default:
            throw Error(r(161));
        }
      } catch (Oe) {
        $t(i, i.return, Oe);
      }
      i.flags &= -3;
    }
    s & 4096 && (i.flags &= -4097);
  }
  function x3(i) {
    if (i.subtreeFlags & 1024)
      for (i = i.child; i !== null; ) {
        var s = i;
        x3(s), s.tag === 5 && s.flags & 1024 && s.stateNode.reset(), i = i.sibling;
      }
  }
  function Oa(i, s) {
    if (s.subtreeFlags & 8772)
      for (s = s.child; s !== null; )
        f3(i, s.alternate, s), s = s.sibling;
  }
  function po(i) {
    for (i = i.child; i !== null; ) {
      var s = i;
      switch (s.tag) {
        case 0:
        case 11:
        case 14:
        case 15:
          bs(4, s, s.return), po(s);
          break;
        case 1:
          Hi(s, s.return);
          var c = s.stateNode;
          typeof c.componentWillUnmount == "function" && o3(
            s,
            s.return,
            c
          ), po(s);
          break;
        case 27:
          lc(s.stateNode);
        case 26:
        case 5:
          Hi(s, s.return), po(s);
          break;
        case 22:
          s.memoizedState === null && po(s);
          break;
        case 30:
          po(s);
          break;
        default:
          po(s);
      }
      i = i.sibling;
    }
  }
  function Da(i, s, c) {
    for (c = c && (s.subtreeFlags & 8772) !== 0, s = s.child; s !== null; ) {
      var g = s.alternate, b = i, S = s, z = S.flags;
      switch (S.tag) {
        case 0:
        case 11:
        case 15:
          Da(
            b,
            S,
            c
          ), Zu(4, S);
          break;
        case 1:
          if (Da(
            b,
            S,
            c
          ), g = S, b = g.stateNode, typeof b.componentDidMount == "function")
            try {
              b.componentDidMount();
            } catch (Ee) {
              $t(g, g.return, Ee);
            }
          if (g = S, b = g.updateQueue, b !== null) {
            var K = g.stateNode;
            try {
              var ae = b.shared.hiddenCallbacks;
              if (ae !== null)
                for (b.shared.hiddenCallbacks = null, b = 0; b < ae.length; b++)
                  Xw(ae[b], K);
            } catch (Ee) {
              $t(g, g.return, Ee);
            }
          }
          c && z & 64 && s3(S), Ju(S, S.return);
          break;
        case 27:
          c3(S);
        case 26:
        case 5:
          Da(
            b,
            S,
            c
          ), c && g === null && z & 4 && l3(S), Ju(S, S.return);
          break;
        case 12:
          Da(
            b,
            S,
            c
          );
          break;
        case 31:
          Da(
            b,
            S,
            c
          ), c && z & 4 && p3(b, S);
          break;
        case 13:
          Da(
            b,
            S,
            c
          ), c && z & 4 && g3(b, S);
          break;
        case 22:
          S.memoizedState === null && Da(
            b,
            S,
            c
          ), Ju(S, S.return);
          break;
        case 30:
          break;
        default:
          Da(
            b,
            S,
            c
          );
      }
      s = s.sibling;
    }
  }
  function Mp(i, s) {
    var c = null;
    i !== null && i.memoizedState !== null && i.memoizedState.cachePool !== null && (c = i.memoizedState.cachePool.pool), i = null, s.memoizedState !== null && s.memoizedState.cachePool !== null && (i = s.memoizedState.cachePool.pool), i !== c && (i != null && i.refCount++, c != null && Pu(c));
  }
  function Rp(i, s) {
    i = null, s.alternate !== null && (i = s.alternate.memoizedState.cache), s = s.memoizedState.cache, s !== i && (s.refCount++, i != null && Pu(i));
  }
  function Si(i, s, c, g) {
    if (s.subtreeFlags & 10256)
      for (s = s.child; s !== null; )
        v3(
          i,
          s,
          c,
          g
        ), s = s.sibling;
  }
  function v3(i, s, c, g) {
    var b = s.flags;
    switch (s.tag) {
      case 0:
      case 11:
      case 15:
        Si(
          i,
          s,
          c,
          g
        ), b & 2048 && Zu(9, s);
        break;
      case 1:
        Si(
          i,
          s,
          c,
          g
        );
        break;
      case 3:
        Si(
          i,
          s,
          c,
          g
        ), b & 2048 && (i = null, s.alternate !== null && (i = s.alternate.memoizedState.cache), s = s.memoizedState.cache, s !== i && (s.refCount++, i != null && Pu(i)));
        break;
      case 12:
        if (b & 2048) {
          Si(
            i,
            s,
            c,
            g
          ), i = s.stateNode;
          try {
            var S = s.memoizedProps, z = S.id, K = S.onPostCommit;
            typeof K == "function" && K(
              z,
              s.alternate === null ? "mount" : "update",
              i.passiveEffectDuration,
              -0
            );
          } catch (ae) {
            $t(s, s.return, ae);
          }
        } else
          Si(
            i,
            s,
            c,
            g
          );
        break;
      case 31:
        Si(
          i,
          s,
          c,
          g
        );
        break;
      case 13:
        Si(
          i,
          s,
          c,
          g
        );
        break;
      case 23:
        break;
      case 22:
        S = s.stateNode, z = s.alternate, s.memoizedState !== null ? S._visibility & 2 ? Si(
          i,
          s,
          c,
          g
        ) : ec(i, s) : S._visibility & 2 ? Si(
          i,
          s,
          c,
          g
        ) : (S._visibility |= 2, Cl(
          i,
          s,
          c,
          g,
          (s.subtreeFlags & 10256) !== 0 || !1
        )), b & 2048 && Mp(z, s);
        break;
      case 24:
        Si(
          i,
          s,
          c,
          g
        ), b & 2048 && Rp(s.alternate, s);
        break;
      default:
        Si(
          i,
          s,
          c,
          g
        );
    }
  }
  function Cl(i, s, c, g, b) {
    for (b = b && ((s.subtreeFlags & 10256) !== 0 || !1), s = s.child; s !== null; ) {
      var S = i, z = s, K = c, ae = g, Ee = z.flags;
      switch (z.tag) {
        case 0:
        case 11:
        case 15:
          Cl(
            S,
            z,
            K,
            ae,
            b
          ), Zu(8, z);
          break;
        case 23:
          break;
        case 22:
          var Oe = z.stateNode;
          z.memoizedState !== null ? Oe._visibility & 2 ? Cl(
            S,
            z,
            K,
            ae,
            b
          ) : ec(
            S,
            z
          ) : (Oe._visibility |= 2, Cl(
            S,
            z,
            K,
            ae,
            b
          )), b && Ee & 2048 && Mp(
            z.alternate,
            z
          );
          break;
        case 24:
          Cl(
            S,
            z,
            K,
            ae,
            b
          ), b && Ee & 2048 && Rp(z.alternate, z);
          break;
        default:
          Cl(
            S,
            z,
            K,
            ae,
            b
          );
      }
      s = s.sibling;
    }
  }
  function ec(i, s) {
    if (s.subtreeFlags & 10256)
      for (s = s.child; s !== null; ) {
        var c = i, g = s, b = g.flags;
        switch (g.tag) {
          case 22:
            ec(c, g), b & 2048 && Mp(
              g.alternate,
              g
            );
            break;
          case 24:
            ec(c, g), b & 2048 && Rp(g.alternate, g);
            break;
          default:
            ec(c, g);
        }
        s = s.sibling;
      }
  }
  var tc = 8192;
  function El(i, s, c) {
    if (i.subtreeFlags & tc)
      for (i = i.child; i !== null; )
        b3(
          i,
          s,
          c
        ), i = i.sibling;
  }
  function b3(i, s, c) {
    switch (i.tag) {
      case 26:
        El(
          i,
          s,
          c
        ), i.flags & tc && i.memoizedState !== null && JM(
          c,
          _i,
          i.memoizedState,
          i.memoizedProps
        );
        break;
      case 5:
        El(
          i,
          s,
          c
        );
        break;
      case 3:
      case 4:
        var g = _i;
        _i = xf(i.stateNode.containerInfo), El(
          i,
          s,
          c
        ), _i = g;
        break;
      case 22:
        i.memoizedState === null && (g = i.alternate, g !== null && g.memoizedState !== null ? (g = tc, tc = 16777216, El(
          i,
          s,
          c
        ), tc = g) : El(
          i,
          s,
          c
        ));
        break;
      default:
        El(
          i,
          s,
          c
        );
    }
  }
  function w3(i) {
    var s = i.alternate;
    if (s !== null && (i = s.child, i !== null)) {
      s.child = null;
      do
        s = i.sibling, i.sibling = null, i = s;
      while (i !== null);
    }
  }
  function nc(i) {
    var s = i.deletions;
    if ((i.flags & 16) !== 0) {
      if (s !== null)
        for (var c = 0; c < s.length; c++) {
          var g = s[c];
          Kn = g, S3(
            g,
            i
          );
        }
      w3(i);
    }
    if (i.subtreeFlags & 10256)
      for (i = i.child; i !== null; )
        _3(i), i = i.sibling;
  }
  function _3(i) {
    switch (i.tag) {
      case 0:
      case 11:
      case 15:
        nc(i), i.flags & 2048 && bs(9, i, i.return);
        break;
      case 3:
        nc(i);
        break;
      case 12:
        nc(i);
        break;
      case 22:
        var s = i.stateNode;
        i.memoizedState !== null && s._visibility & 2 && (i.return === null || i.return.tag !== 13) ? (s._visibility &= -3, af(i)) : nc(i);
        break;
      default:
        nc(i);
    }
  }
  function af(i) {
    var s = i.deletions;
    if ((i.flags & 16) !== 0) {
      if (s !== null)
        for (var c = 0; c < s.length; c++) {
          var g = s[c];
          Kn = g, S3(
            g,
            i
          );
        }
      w3(i);
    }
    for (i = i.child; i !== null; ) {
      switch (s = i, s.tag) {
        case 0:
        case 11:
        case 15:
          bs(8, s, s.return), af(s);
          break;
        case 22:
          c = s.stateNode, c._visibility & 2 && (c._visibility &= -3, af(s));
          break;
        default:
          af(s);
      }
      i = i.sibling;
    }
  }
  function S3(i, s) {
    for (; Kn !== null; ) {
      var c = Kn;
      switch (c.tag) {
        case 0:
        case 11:
        case 15:
          bs(8, c, s);
          break;
        case 23:
        case 22:
          if (c.memoizedState !== null && c.memoizedState.cachePool !== null) {
            var g = c.memoizedState.cachePool.pool;
            g != null && g.refCount++;
          }
          break;
        case 24:
          Pu(c.memoizedState.cache);
      }
      if (g = c.child, g !== null) g.return = c, Kn = g;
      else
        e: for (c = i; Kn !== null; ) {
          g = Kn;
          var b = g.sibling, S = g.return;
          if (h3(g), g === c) {
            Kn = null;
            break e;
          }
          if (b !== null) {
            b.return = S, Kn = b;
            break e;
          }
          Kn = S;
        }
    }
  }
  var mM = {
    getCacheForType: function(i) {
      var s = Xn(jn), c = s.data.get(i);
      return c === void 0 && (c = i(), s.data.set(i, c)), c;
    },
    cacheSignal: function() {
      return Xn(jn).controller.signal;
    }
  }, pM = typeof WeakMap == "function" ? WeakMap : Map, Lt = 0, Xt = null, wt = null, Et = 0, Ft = 0, Br = null, ws = !1, kl = !1, zp = !1, Ia = 0, xn = 0, _s = 0, go = 0, Op = 0, Fr = 0, Nl = 0, rc = null, Nr = null, Dp = !1, sf = 0, C3 = 0, of = 1 / 0, lf = null, Ss = null, qn = 0, Cs = null, jl = null, La = 0, Ip = 0, Lp = null, E3 = null, ic = 0, qp = null;
  function $r() {
    return (Lt & 2) !== 0 && Et !== 0 ? Et & -Et : V.T !== null ? Hp() : la();
  }
  function k3() {
    if (Fr === 0)
      if ((Et & 536870912) === 0 || Tt) {
        var i = Ii;
        Ii <<= 1, (Ii & 3932160) === 0 && (Ii = 262144), Fr = i;
      } else Fr = 536870912;
    return i = qr.current, i !== null && (i.flags |= 32), Fr;
  }
  function jr(i, s, c) {
    (i === Xt && (Ft === 2 || Ft === 9) || i.cancelPendingCommit !== null) && (Tl(i, 0), Es(
      i,
      Et,
      Fr,
      !1
    )), xr(i, c), ((Lt & 2) === 0 || i !== Xt) && (i === Xt && ((Lt & 2) === 0 && (go |= c), xn === 4 && Es(
      i,
      Et,
      Fr,
      !1
    )), Gi(i));
  }
  function N3(i, s, c) {
    if ((Lt & 6) !== 0) throw Error(r(327));
    var g = !c && (s & 127) === 0 && (s & i.expiredLanes) === 0 || gi(i, s), b = g ? xM(i, s) : Bp(i, s, !0), S = g;
    do {
      if (b === 0) {
        kl && !g && Es(i, s, 0, !1);
        break;
      } else {
        if (c = i.current.alternate, S && !gM(c)) {
          b = Bp(i, s, !1), S = !1;
          continue;
        }
        if (b === 2) {
          if (S = s, i.errorRecoveryDisabledLanes & S)
            var z = 0;
          else
            z = i.pendingLanes & -536870913, z = z !== 0 ? z : z & 536870912 ? 536870912 : 0;
          if (z !== 0) {
            s = z;
            e: {
              var K = i;
              b = rc;
              var ae = K.current.memoizedState.isDehydrated;
              if (ae && (Tl(K, z).flags |= 256), z = Bp(
                K,
                z,
                !1
              ), z !== 2) {
                if (zp && !ae) {
                  K.errorRecoveryDisabledLanes |= S, go |= S, b = 4;
                  break e;
                }
                S = Nr, Nr = b, S !== null && (Nr === null ? Nr = S : Nr.push.apply(
                  Nr,
                  S
                ));
              }
              b = z;
            }
            if (S = !1, b !== 2) continue;
          }
        }
        if (b === 1) {
          Tl(i, 0), Es(i, s, 0, !0);
          break;
        }
        e: {
          switch (g = i, S = b, S) {
            case 0:
            case 1:
              throw Error(r(345));
            case 4:
              if ((s & 4194048) !== s) break;
            case 6:
              Es(
                g,
                s,
                Fr,
                !ws
              );
              break e;
            case 2:
              Nr = null;
              break;
            case 3:
            case 5:
              break;
            default:
              throw Error(r(329));
          }
          if ((s & 62914560) === s && (b = sf + 300 - Yt(), 10 < b)) {
            if (Es(
              g,
              s,
              Fr,
              !ws
            ), sa(g, 0, !0) !== 0) break e;
            La = s, g.timeoutHandle = i5(
              j3.bind(
                null,
                g,
                c,
                Nr,
                lf,
                Dp,
                s,
                Fr,
                go,
                Nl,
                ws,
                S,
                "Throttled",
                -0,
                0
              ),
              b
            );
            break e;
          }
          j3(
            g,
            c,
            Nr,
            lf,
            Dp,
            s,
            Fr,
            go,
            Nl,
            ws,
            S,
            null,
            -0,
            0
          );
        }
      }
      break;
    } while (!0);
    Gi(i);
  }
  function j3(i, s, c, g, b, S, z, K, ae, Ee, Oe, Le, je, Me) {
    if (i.timeoutHandle = -1, Le = s.subtreeFlags, Le & 8192 || (Le & 16785408) === 16785408) {
      Le = {
        stylesheets: null,
        count: 0,
        imgCount: 0,
        imgBytes: 0,
        suspenseyImages: [],
        waitingForImages: !0,
        waitingForViewTransition: !1,
        unsuspend: _r
      }, b3(
        s,
        S,
        Le
      );
      var tt = (S & 62914560) === S ? sf - Yt() : (S & 4194048) === S ? C3 - Yt() : 0;
      if (tt = eR(
        Le,
        tt
      ), tt !== null) {
        La = S, i.cancelPendingCommit = tt(
          I3.bind(
            null,
            i,
            s,
            S,
            c,
            g,
            b,
            z,
            K,
            ae,
            Oe,
            Le,
            null,
            je,
            Me
          )
        ), Es(i, S, z, !Ee);
        return;
      }
    }
    I3(
      i,
      s,
      S,
      c,
      g,
      b,
      z,
      K,
      ae
    );
  }
  function gM(i) {
    for (var s = i; ; ) {
      var c = s.tag;
      if ((c === 0 || c === 11 || c === 15) && s.flags & 16384 && (c = s.updateQueue, c !== null && (c = c.stores, c !== null)))
        for (var g = 0; g < c.length; g++) {
          var b = c[g], S = b.getSnapshot;
          b = b.value;
          try {
            if (!ir(S(), b)) return !1;
          } catch {
            return !1;
          }
        }
      if (c = s.child, s.subtreeFlags & 16384 && c !== null)
        c.return = s, s = c;
      else {
        if (s === i) break;
        for (; s.sibling === null; ) {
          if (s.return === null || s.return === i) return !0;
          s = s.return;
        }
        s.sibling.return = s.return, s = s.sibling;
      }
    }
    return !0;
  }
  function Es(i, s, c, g) {
    s &= ~Op, s &= ~go, i.suspendedLanes |= s, i.pingedLanes &= ~s, g && (i.warmLanes |= s), g = i.expirationTimes;
    for (var b = s; 0 < b; ) {
      var S = 31 - Ge(b), z = 1 << S;
      g[S] = -1, b &= ~z;
    }
    c !== 0 && oa(i, c, s);
  }
  function uf() {
    return (Lt & 6) === 0 ? (ac(0), !1) : !0;
  }
  function Pp() {
    if (wt !== null) {
      if (Ft === 0)
        var i = wt.return;
      else
        i = wt, ka = so = null, tp(i), vl = null, Fu = 0, i = wt;
      for (; i !== null; )
        a3(i.alternate, i), i = i.return;
      wt = null;
    }
  }
  function Tl(i, s) {
    var c = i.timeoutHandle;
    c !== -1 && (i.timeoutHandle = -1, IM(c)), c = i.cancelPendingCommit, c !== null && (i.cancelPendingCommit = null, c()), La = 0, Pp(), Xt = i, wt = c = Ca(i.current, null), Et = s, Ft = 0, Br = null, ws = !1, kl = gi(i, s), zp = !1, Nl = Fr = Op = go = _s = xn = 0, Nr = rc = null, Dp = !1, (s & 8) !== 0 && (s |= s & 32);
    var g = i.entangledLanes;
    if (g !== 0)
      for (i = i.entanglements, g &= s; 0 < g; ) {
        var b = 31 - Ge(g), S = 1 << b;
        s |= i[b], g &= ~S;
      }
    return Ia = s, Vn(), c;
  }
  function T3(i, s) {
    yt = null, V.H = Xu, s === xl || s === Ld ? (s = Gw(), Ft = 3) : s === Um ? (s = Gw(), Ft = 4) : Ft = s === yp ? 8 : s !== null && typeof s == "object" && typeof s.then == "function" ? 6 : 1, Br = s, wt === null && (xn = 1, Qd(
      i,
      ri(s, i.current)
    ));
  }
  function A3() {
    var i = qr.current;
    return i === null ? !0 : (Et & 4194048) === Et ? oi === null : (Et & 62914560) === Et || (Et & 536870912) !== 0 ? i === oi : !1;
  }
  function M3() {
    var i = V.H;
    return V.H = Xu, i === null ? Xu : i;
  }
  function R3() {
    var i = V.A;
    return V.A = mM, i;
  }
  function cf() {
    xn = 4, ws || (Et & 4194048) !== Et && qr.current !== null || (kl = !0), (_s & 134217727) === 0 && (go & 134217727) === 0 || Xt === null || Es(
      Xt,
      Et,
      Fr,
      !1
    );
  }
  function Bp(i, s, c) {
    var g = Lt;
    Lt |= 2;
    var b = M3(), S = R3();
    (Xt !== i || Et !== s) && (lf = null, Tl(i, s)), s = !1;
    var z = xn;
    e: do
      try {
        if (Ft !== 0 && wt !== null) {
          var K = wt, ae = Br;
          switch (Ft) {
            case 8:
              Pp(), z = 6;
              break e;
            case 3:
            case 2:
            case 9:
            case 6:
              qr.current === null && (s = !0);
              var Ee = Ft;
              if (Ft = 0, Br = null, Al(i, K, ae, Ee), c && kl) {
                z = 0;
                break e;
              }
              break;
            default:
              Ee = Ft, Ft = 0, Br = null, Al(i, K, ae, Ee);
          }
        }
        yM(), z = xn;
        break;
      } catch (Oe) {
        T3(i, Oe);
      }
    while (!0);
    return s && i.shellSuspendCounter++, ka = so = null, Lt = g, V.H = b, V.A = S, wt === null && (Xt = null, Et = 0, Vn()), z;
  }
  function yM() {
    for (; wt !== null; ) z3(wt);
  }
  function xM(i, s) {
    var c = Lt;
    Lt |= 2;
    var g = M3(), b = R3();
    Xt !== i || Et !== s ? (lf = null, of = Yt() + 500, Tl(i, s)) : kl = gi(
      i,
      s
    );
    e: do
      try {
        if (Ft !== 0 && wt !== null) {
          s = wt;
          var S = Br;
          t: switch (Ft) {
            case 1:
              Ft = 0, Br = null, Al(i, s, S, 1);
              break;
            case 2:
            case 9:
              if (Uw(S)) {
                Ft = 0, Br = null, O3(s);
                break;
              }
              s = function() {
                Ft !== 2 && Ft !== 9 || Xt !== i || (Ft = 7), Gi(i);
              }, S.then(s, s);
              break e;
            case 3:
              Ft = 7;
              break e;
            case 4:
              Ft = 5;
              break e;
            case 7:
              Uw(S) ? (Ft = 0, Br = null, O3(s)) : (Ft = 0, Br = null, Al(i, s, S, 7));
              break;
            case 5:
              var z = null;
              switch (wt.tag) {
                case 26:
                  z = wt.memoizedState;
                case 5:
                case 27:
                  var K = wt;
                  if (z ? v5(z) : K.stateNode.complete) {
                    Ft = 0, Br = null;
                    var ae = K.sibling;
                    if (ae !== null) wt = ae;
                    else {
                      var Ee = K.return;
                      Ee !== null ? (wt = Ee, df(Ee)) : wt = null;
                    }
                    break t;
                  }
              }
              Ft = 0, Br = null, Al(i, s, S, 5);
              break;
            case 6:
              Ft = 0, Br = null, Al(i, s, S, 6);
              break;
            case 8:
              Pp(), xn = 6;
              break e;
            default:
              throw Error(r(462));
          }
        }
        vM();
        break;
      } catch (Oe) {
        T3(i, Oe);
      }
    while (!0);
    return ka = so = null, V.H = g, V.A = b, Lt = c, wt !== null ? 0 : (Xt = null, Et = 0, Vn(), xn);
  }
  function vM() {
    for (; wt !== null && !vn(); )
      z3(wt);
  }
  function z3(i) {
    var s = r3(i.alternate, i, Ia);
    i.memoizedProps = i.pendingProps, s === null ? df(i) : wt = s;
  }
  function O3(i) {
    var s = i, c = s.alternate;
    switch (s.tag) {
      case 15:
      case 0:
        s = Q4(
          c,
          s,
          s.pendingProps,
          s.type,
          void 0,
          Et
        );
        break;
      case 11:
        s = Q4(
          c,
          s,
          s.pendingProps,
          s.type.render,
          s.ref,
          Et
        );
        break;
      case 5:
        tp(s);
      default:
        a3(c, s), s = wt = Rw(s, Ia), s = r3(c, s, Ia);
    }
    i.memoizedProps = i.pendingProps, s === null ? df(i) : wt = s;
  }
  function Al(i, s, c, g) {
    ka = so = null, tp(s), vl = null, Fu = 0;
    var b = s.return;
    try {
      if (oM(
        i,
        b,
        s,
        c,
        Et
      )) {
        xn = 1, Qd(
          i,
          ri(c, i.current)
        ), wt = null;
        return;
      }
    } catch (S) {
      if (b !== null) throw wt = b, S;
      xn = 1, Qd(
        i,
        ri(c, i.current)
      ), wt = null;
      return;
    }
    s.flags & 32768 ? (Tt || g === 1 ? i = !0 : kl || (Et & 536870912) !== 0 ? i = !1 : (ws = i = !0, (g === 2 || g === 9 || g === 3 || g === 6) && (g = qr.current, g !== null && g.tag === 13 && (g.flags |= 16384))), D3(s, i)) : df(s);
  }
  function df(i) {
    var s = i;
    do {
      if ((s.flags & 32768) !== 0) {
        D3(
          s,
          ws
        );
        return;
      }
      i = s.return;
      var c = cM(
        s.alternate,
        s,
        Ia
      );
      if (c !== null) {
        wt = c;
        return;
      }
      if (s = s.sibling, s !== null) {
        wt = s;
        return;
      }
      wt = s = i;
    } while (s !== null);
    xn === 0 && (xn = 5);
  }
  function D3(i, s) {
    do {
      var c = dM(i.alternate, i);
      if (c !== null) {
        c.flags &= 32767, wt = c;
        return;
      }
      if (c = i.return, c !== null && (c.flags |= 32768, c.subtreeFlags = 0, c.deletions = null), !s && (i = i.sibling, i !== null)) {
        wt = i;
        return;
      }
      wt = i = c;
    } while (i !== null);
    xn = 6, wt = null;
  }
  function I3(i, s, c, g, b, S, z, K, ae) {
    i.cancelPendingCommit = null;
    do
      ff();
    while (qn !== 0);
    if ((Lt & 6) !== 0) throw Error(r(327));
    if (s !== null) {
      if (s === i.current) throw Error(r(177));
      if (S = s.lanes | s.childLanes, S |= gt, Gs(
        i,
        c,
        S,
        z,
        K,
        ae
      ), i === Xt && (wt = Xt = null, Et = 0), jl = s, Cs = i, La = c, Ip = S, Lp = b, E3 = g, (s.subtreeFlags & 10256) !== 0 || (s.flags & 10256) !== 0 ? (i.callbackNode = null, i.callbackPriority = 0, SM(rt, function() {
        return F3(), null;
      })) : (i.callbackNode = null, i.callbackPriority = 0), g = (s.flags & 13878) !== 0, (s.subtreeFlags & 13878) !== 0 || g) {
        g = V.T, V.T = null, b = ee.p, ee.p = 2, z = Lt, Lt |= 4;
        try {
          fM(i, s, c);
        } finally {
          Lt = z, ee.p = b, V.T = g;
        }
      }
      qn = 1, L3(), q3(), P3();
    }
  }
  function L3() {
    if (qn === 1) {
      qn = 0;
      var i = Cs, s = jl, c = (s.flags & 13878) !== 0;
      if ((s.subtreeFlags & 13878) !== 0 || c) {
        c = V.T, V.T = null;
        var g = ee.p;
        ee.p = 2;
        var b = Lt;
        Lt |= 4;
        try {
          y3(s, i);
          var S = Zp, z = I(i.containerInfo), K = S.focusedElem, ae = S.selectionRange;
          if (z !== K && K && K.ownerDocument && R(
            K.ownerDocument.documentElement,
            K
          )) {
            if (ae !== null && $(K)) {
              var Ee = ae.start, Oe = ae.end;
              if (Oe === void 0 && (Oe = Ee), "selectionStart" in K)
                K.selectionStart = Ee, K.selectionEnd = Math.min(
                  Oe,
                  K.value.length
                );
              else {
                var Le = K.ownerDocument || document, je = Le && Le.defaultView || window;
                if (je.getSelection) {
                  var Me = je.getSelection(), tt = K.textContent.length, ct = Math.min(ae.start, tt), Vt = ae.end === void 0 ? ct : Math.min(ae.end, tt);
                  !Me.extend && ct > Vt && (z = Vt, Vt = ct, ct = z);
                  var ve = j(
                    K,
                    ct
                  ), he = j(
                    K,
                    Vt
                  );
                  if (ve && he && (Me.rangeCount !== 1 || Me.anchorNode !== ve.node || Me.anchorOffset !== ve.offset || Me.focusNode !== he.node || Me.focusOffset !== he.offset)) {
                    var Ce = Le.createRange();
                    Ce.setStart(ve.node, ve.offset), Me.removeAllRanges(), ct > Vt ? (Me.addRange(Ce), Me.extend(he.node, he.offset)) : (Ce.setEnd(he.node, he.offset), Me.addRange(Ce));
                  }
                }
              }
            }
            for (Le = [], Me = K; Me = Me.parentNode; )
              Me.nodeType === 1 && Le.push({
                element: Me,
                left: Me.scrollLeft,
                top: Me.scrollTop
              });
            for (typeof K.focus == "function" && K.focus(), K = 0; K < Le.length; K++) {
              var De = Le[K];
              De.element.scrollLeft = De.left, De.element.scrollTop = De.top;
            }
          }
          Cf = !!Qp, Zp = Qp = null;
        } finally {
          Lt = b, ee.p = g, V.T = c;
        }
      }
      i.current = s, qn = 2;
    }
  }
  function q3() {
    if (qn === 2) {
      qn = 0;
      var i = Cs, s = jl, c = (s.flags & 8772) !== 0;
      if ((s.subtreeFlags & 8772) !== 0 || c) {
        c = V.T, V.T = null;
        var g = ee.p;
        ee.p = 2;
        var b = Lt;
        Lt |= 4;
        try {
          f3(i, s.alternate, s);
        } finally {
          Lt = b, ee.p = g, V.T = c;
        }
      }
      qn = 3;
    }
  }
  function P3() {
    if (qn === 4 || qn === 3) {
      qn = 0, qt();
      var i = Cs, s = jl, c = La, g = E3;
      (s.subtreeFlags & 10256) !== 0 || (s.flags & 10256) !== 0 ? qn = 5 : (qn = 0, jl = Cs = null, B3(i, i.pendingLanes));
      var b = i.pendingLanes;
      if (b === 0 && (Ss = null), Li(c), s = s.stateNode, Rt && typeof Rt.onCommitFiberRoot == "function")
        try {
          Rt.onCommitFiberRoot(
            It,
            s,
            void 0,
            (s.current.flags & 128) === 128
          );
        } catch {
        }
      if (g !== null) {
        s = V.T, b = ee.p, ee.p = 2, V.T = null;
        try {
          for (var S = i.onRecoverableError, z = 0; z < g.length; z++) {
            var K = g[z];
            S(K.value, {
              componentStack: K.stack
            });
          }
        } finally {
          V.T = s, ee.p = b;
        }
      }
      (La & 3) !== 0 && ff(), Gi(i), b = i.pendingLanes, (c & 261930) !== 0 && (b & 42) !== 0 ? i === qp ? ic++ : (ic = 0, qp = i) : ic = 0, ac(0);
    }
  }
  function B3(i, s) {
    (i.pooledCacheLanes &= s) === 0 && (s = i.pooledCache, s != null && (i.pooledCache = null, Pu(s)));
  }
  function ff() {
    return L3(), q3(), P3(), F3();
  }
  function F3() {
    if (qn !== 5) return !1;
    var i = Cs, s = Ip;
    Ip = 0;
    var c = Li(La), g = V.T, b = ee.p;
    try {
      ee.p = 32 > c ? 32 : c, V.T = null, c = Lp, Lp = null;
      var S = Cs, z = La;
      if (qn = 0, jl = Cs = null, La = 0, (Lt & 6) !== 0) throw Error(r(331));
      var K = Lt;
      if (Lt |= 4, _3(S.current), v3(
        S,
        S.current,
        z,
        c
      ), Lt = K, ac(0, !1), Rt && typeof Rt.onPostCommitFiberRoot == "function")
        try {
          Rt.onPostCommitFiberRoot(It, S);
        } catch {
        }
      return !0;
    } finally {
      ee.p = b, V.T = g, B3(i, s);
    }
  }
  function $3(i, s, c) {
    s = ri(c, s), s = gp(i.stateNode, s, 2), i = ys(i, s, 2), i !== null && (xr(i, 2), Gi(i));
  }
  function $t(i, s, c) {
    if (i.tag === 3)
      $3(i, i, c);
    else
      for (; s !== null; ) {
        if (s.tag === 3) {
          $3(
            s,
            i,
            c
          );
          break;
        } else if (s.tag === 1) {
          var g = s.stateNode;
          if (typeof s.type.getDerivedStateFromError == "function" || typeof g.componentDidCatch == "function" && (Ss === null || !Ss.has(g))) {
            i = ri(c, i), c = U4(2), g = ys(s, c, 2), g !== null && (H4(
              c,
              g,
              s,
              i
            ), xr(g, 2), Gi(g));
            break;
          }
        }
        s = s.return;
      }
  }
  function Fp(i, s, c) {
    var g = i.pingCache;
    if (g === null) {
      g = i.pingCache = new pM();
      var b = /* @__PURE__ */ new Set();
      g.set(s, b);
    } else
      b = g.get(s), b === void 0 && (b = /* @__PURE__ */ new Set(), g.set(s, b));
    b.has(c) || (zp = !0, b.add(c), i = bM.bind(null, i, s, c), s.then(i, i));
  }
  function bM(i, s, c) {
    var g = i.pingCache;
    g !== null && g.delete(s), i.pingedLanes |= i.suspendedLanes & c, i.warmLanes &= ~c, Xt === i && (Et & c) === c && (xn === 4 || xn === 3 && (Et & 62914560) === Et && 300 > Yt() - sf ? (Lt & 2) === 0 && Tl(i, 0) : Op |= c, Nl === Et && (Nl = 0)), Gi(i);
  }
  function U3(i, s) {
    s === 0 && (s = Go()), i = sn(i, s), i !== null && (xr(i, s), Gi(i));
  }
  function wM(i) {
    var s = i.memoizedState, c = 0;
    s !== null && (c = s.retryLane), U3(i, c);
  }
  function _M(i, s) {
    var c = 0;
    switch (i.tag) {
      case 31:
      case 13:
        var g = i.stateNode, b = i.memoizedState;
        b !== null && (c = b.retryLane);
        break;
      case 19:
        g = i.stateNode;
        break;
      case 22:
        g = i.stateNode._retryCache;
        break;
      default:
        throw Error(r(314));
    }
    g !== null && g.delete(s), U3(i, c);
  }
  function SM(i, s) {
    return Sn(i, s);
  }
  var hf = null, Ml = null, $p = !1, mf = !1, Up = !1, ks = 0;
  function Gi(i) {
    i !== Ml && i.next === null && (Ml === null ? hf = Ml = i : Ml = Ml.next = i), mf = !0, $p || ($p = !0, EM());
  }
  function ac(i, s) {
    if (!Up && mf) {
      Up = !0;
      do
        for (var c = !1, g = hf; g !== null; ) {
          if (i !== 0) {
            var b = g.pendingLanes;
            if (b === 0) var S = 0;
            else {
              var z = g.suspendedLanes, K = g.pingedLanes;
              S = (1 << 31 - Ge(42 | i) + 1) - 1, S &= b & ~(z & ~K), S = S & 201326741 ? S & 201326741 | 1 : S ? S | 2 : 0;
            }
            S !== 0 && (c = !0, K3(g, S));
          } else
            S = Et, S = sa(
              g,
              g === Xt ? S : 0,
              g.cancelPendingCommit !== null || g.timeoutHandle !== -1
            ), (S & 3) === 0 || gi(g, S) || (c = !0, K3(g, S));
          g = g.next;
        }
      while (c);
      Up = !1;
    }
  }
  function CM() {
    H3();
  }
  function H3() {
    mf = $p = !1;
    var i = 0;
    ks !== 0 && DM() && (i = ks);
    for (var s = Yt(), c = null, g = hf; g !== null; ) {
      var b = g.next, S = G3(g, s);
      S === 0 ? (g.next = null, c === null ? hf = b : c.next = b, b === null && (Ml = c)) : (c = g, (i !== 0 || (S & 3) !== 0) && (mf = !0)), g = b;
    }
    qn !== 0 && qn !== 5 || ac(i), ks !== 0 && (ks = 0);
  }
  function G3(i, s) {
    for (var c = i.suspendedLanes, g = i.pingedLanes, b = i.expirationTimes, S = i.pendingLanes & -62914561; 0 < S; ) {
      var z = 31 - Ge(S), K = 1 << z, ae = b[z];
      ae === -1 ? ((K & c) === 0 || (K & g) !== 0) && (b[z] = xu(K, s)) : ae <= s && (i.expiredLanes |= K), S &= ~K;
    }
    if (s = Xt, c = Et, c = sa(
      i,
      i === s ? c : 0,
      i.cancelPendingCommit !== null || i.timeoutHandle !== -1
    ), g = i.callbackNode, c === 0 || i === s && (Ft === 2 || Ft === 9) || i.cancelPendingCommit !== null)
      return g !== null && g !== null && Kt(g), i.callbackNode = null, i.callbackPriority = 0;
    if ((c & 3) === 0 || gi(i, c)) {
      if (s = c & -c, s === i.callbackPriority) return s;
      switch (g !== null && Kt(g), Li(c)) {
        case 2:
        case 8:
          c = Be;
          break;
        case 32:
          c = rt;
          break;
        case 268435456:
          c = xt;
          break;
        default:
          c = rt;
      }
      return g = V3.bind(null, i), c = Sn(c, g), i.callbackPriority = s, i.callbackNode = c, s;
    }
    return g !== null && g !== null && Kt(g), i.callbackPriority = 2, i.callbackNode = null, 2;
  }
  function V3(i, s) {
    if (qn !== 0 && qn !== 5)
      return i.callbackNode = null, i.callbackPriority = 0, null;
    var c = i.callbackNode;
    if (ff() && i.callbackNode !== c)
      return null;
    var g = Et;
    return g = sa(
      i,
      i === Xt ? g : 0,
      i.cancelPendingCommit !== null || i.timeoutHandle !== -1
    ), g === 0 ? null : (N3(i, g, s), G3(i, Yt()), i.callbackNode != null && i.callbackNode === c ? V3.bind(null, i) : null);
  }
  function K3(i, s) {
    if (ff()) return null;
    N3(i, s, !0);
  }
  function EM() {
    LM(function() {
      (Lt & 6) !== 0 ? Sn(
        Re,
        CM
      ) : H3();
    });
  }
  function Hp() {
    if (ks === 0) {
      var i = gl;
      i === 0 && (i = Ye, Ye <<= 1, (Ye & 261888) === 0 && (Ye = 256)), ks = i;
    }
    return ks;
  }
  function Y3(i) {
    return i == null || typeof i == "symbol" || typeof i == "boolean" ? null : typeof i == "function" ? i : wi("" + i);
  }
  function X3(i, s) {
    var c = s.ownerDocument.createElement("input");
    return c.name = s.name, c.value = s.value, i.id && c.setAttribute("form", i.id), s.parentNode.insertBefore(c, s), i = new FormData(i), c.parentNode.removeChild(c), i;
  }
  function kM(i, s, c, g, b) {
    if (s === "submit" && c && c.stateNode === b) {
      var S = Y3(
        (b[fn] || null).action
      ), z = g.submitter;
      z && (s = (s = z[fn] || null) ? Y3(s.formAction) : z.getAttribute("formAction"), s !== null && (S = s, z = null));
      var K = new Qo(
        "action",
        "action",
        null,
        g,
        b
      );
      i.push({
        event: K,
        listeners: [
          {
            instance: null,
            listener: function() {
              if (g.defaultPrevented) {
                if (ks !== 0) {
                  var ae = z ? X3(b, z) : new FormData(b);
                  cp(
                    c,
                    {
                      pending: !0,
                      data: ae,
                      method: b.method,
                      action: S
                    },
                    null,
                    ae
                  );
                }
              } else
                typeof S == "function" && (K.preventDefault(), ae = z ? X3(b, z) : new FormData(b), cp(
                  c,
                  {
                    pending: !0,
                    data: ae,
                    method: b.method,
                    action: S
                  },
                  S,
                  ae
                ));
            },
            currentTarget: b
          }
        ]
      });
    }
  }
  for (var Gp = 0; Gp < Ke.length; Gp++) {
    var Vp = Ke[Gp], NM = Vp.toLowerCase(), jM = Vp[0].toUpperCase() + Vp.slice(1);
    $e(
      NM,
      "on" + jM
    );
  }
  $e(be, "onAnimationEnd"), $e(Ne, "onAnimationIteration"), $e(ze, "onAnimationStart"), $e("dblclick", "onDoubleClick"), $e("focusin", "onFocus"), $e("focusout", "onBlur"), $e(Ie, "onTransitionRun"), $e(He, "onTransitionStart"), $e(Xe, "onTransitionCancel"), $e(Fe, "onTransitionEnd"), Jr("onMouseEnter", ["mouseout", "mouseover"]), Jr("onMouseLeave", ["mouseout", "mouseover"]), Jr("onPointerEnter", ["pointerout", "pointerover"]), Jr("onPointerLeave", ["pointerout", "pointerover"]), Dr(
    "onChange",
    "change click focusin focusout input keydown keyup selectionchange".split(" ")
  ), Dr(
    "onSelect",
    "focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(
      " "
    )
  ), Dr("onBeforeInput", [
    "compositionend",
    "keypress",
    "textInput",
    "paste"
  ]), Dr(
    "onCompositionEnd",
    "compositionend focusout keydown keypress keyup mousedown".split(" ")
  ), Dr(
    "onCompositionStart",
    "compositionstart focusout keydown keypress keyup mousedown".split(" ")
  ), Dr(
    "onCompositionUpdate",
    "compositionupdate focusout keydown keypress keyup mousedown".split(" ")
  );
  var sc = "abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(
    " "
  ), TM = new Set(
    "beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(sc)
  );
  function W3(i, s) {
    s = (s & 4) !== 0;
    for (var c = 0; c < i.length; c++) {
      var g = i[c], b = g.event;
      g = g.listeners;
      e: {
        var S = void 0;
        if (s)
          for (var z = g.length - 1; 0 <= z; z--) {
            var K = g[z], ae = K.instance, Ee = K.currentTarget;
            if (K = K.listener, ae !== S && b.isPropagationStopped())
              break e;
            S = K, b.currentTarget = Ee;
            try {
              S(b);
            } catch (Oe) {
              Je(Oe);
            }
            b.currentTarget = null, S = ae;
          }
        else
          for (z = 0; z < g.length; z++) {
            if (K = g[z], ae = K.instance, Ee = K.currentTarget, K = K.listener, ae !== S && b.isPropagationStopped())
              break e;
            S = K, b.currentTarget = Ee;
            try {
              S(b);
            } catch (Oe) {
              Je(Oe);
            }
            b.currentTarget = null, S = ae;
          }
      }
    }
  }
  function _t(i, s) {
    var c = s[yi];
    c === void 0 && (c = s[yi] = /* @__PURE__ */ new Set());
    var g = i + "__bubble";
    c.has(g) || (Q3(s, i, 2, !1), c.add(g));
  }
  function Kp(i, s, c) {
    var g = 0;
    s && (g |= 4), Q3(
      c,
      i,
      g,
      s
    );
  }
  var pf = "_reactListening" + Math.random().toString(36).slice(2);
  function Yp(i) {
    if (!i[pf]) {
      i[pf] = !0, xi.forEach(function(c) {
        c !== "selectionchange" && (TM.has(c) || Kp(c, !1, i), Kp(c, !0, i));
      });
      var s = i.nodeType === 9 ? i : i.ownerDocument;
      s === null || s[pf] || (s[pf] = !0, Kp("selectionchange", !1, s));
    }
  }
  function Q3(i, s, c, g) {
    switch (k5(s)) {
      case 2:
        var b = rR;
        break;
      case 8:
        b = iR;
        break;
      default:
        b = ug;
    }
    c = b.bind(
      null,
      s,
      c,
      i
    ), b = void 0, !_u || s !== "touchstart" && s !== "touchmove" && s !== "wheel" || (b = !0), g ? b !== void 0 ? i.addEventListener(s, c, {
      capture: !0,
      passive: b
    }) : i.addEventListener(s, c, !0) : b !== void 0 ? i.addEventListener(s, c, {
      passive: b
    }) : i.addEventListener(s, c, !1);
  }
  function Xp(i, s, c, g, b) {
    var S = g;
    if ((s & 1) === 0 && (s & 2) === 0 && g !== null)
      e: for (; ; ) {
        if (g === null) return;
        var z = g.tag;
        if (z === 3 || z === 4) {
          var K = g.stateNode.containerInfo;
          if (K === b) break;
          if (z === 4)
            for (z = g.return; z !== null; ) {
              var ae = z.tag;
              if ((ae === 3 || ae === 4) && z.stateNode.containerInfo === b)
                return;
              z = z.return;
            }
          for (; K !== null; ) {
            if (z = Zr(K), z === null) return;
            if (ae = z.tag, ae === 5 || ae === 6 || ae === 26 || ae === 27) {
              g = S = z;
              continue e;
            }
            K = K.parentNode;
          }
        }
        g = g.return;
      }
    ns(function() {
      var Ee = S, Oe = Xo(c), Le = [];
      e: {
        var je = Ve.get(i);
        if (je !== void 0) {
          var Me = Qo, tt = i;
          switch (i) {
            case "keypress":
              if (as(c) === 0) break e;
            case "keydown":
            case "keyup":
              Me = il;
              break;
            case "focusin":
              tt = "focus", Me = ss;
              break;
            case "focusout":
              tt = "blur", Me = ss;
              break;
            case "beforeblur":
            case "afterblur":
              Me = ss;
              break;
            case "click":
              if (c.button === 2) break e;
            case "auxclick":
            case "dblclick":
            case "mousedown":
            case "mousemove":
            case "mouseup":
            case "mouseout":
            case "mouseover":
            case "contextmenu":
              Me = el;
              break;
            case "drag":
            case "dragend":
            case "dragenter":
            case "dragexit":
            case "dragleave":
            case "dragover":
            case "dragstart":
            case "drop":
              Me = wd;
              break;
            case "touchcancel":
            case "touchend":
            case "touchmove":
            case "touchstart":
              Me = Tu;
              break;
            case be:
            case Ne:
            case ze:
              Me = _d;
              break;
            case Fe:
              Me = Au;
              break;
            case "scroll":
            case "scrollend":
              Me = Zo;
              break;
            case "wheel":
              Me = sl;
              break;
            case "copy":
            case "cut":
            case "paste":
              Me = os;
              break;
            case "gotpointercapture":
            case "lostpointercapture":
            case "pointercancel":
            case "pointerdown":
            case "pointermove":
            case "pointerout":
            case "pointerover":
            case "pointerup":
              Me = ju;
              break;
            case "toggle":
            case "beforetoggle":
              Me = Ed;
          }
          var ct = (s & 4) !== 0, Vt = !ct && (i === "scroll" || i === "scrollend"), ve = ct ? je !== null ? je + "Capture" : null : je;
          ct = [];
          for (var he = Ee, Ce; he !== null; ) {
            var De = he;
            if (Ce = De.stateNode, De = De.tag, De !== 5 && De !== 26 && De !== 27 || Ce === null || ve === null || (De = xa(he, ve), De != null && ct.push(
              oc(he, De, Ce)
            )), Vt) break;
            he = he.return;
          }
          0 < ct.length && (je = new Me(
            je,
            tt,
            null,
            c,
            Oe
          ), Le.push({ event: je, listeners: ct }));
        }
      }
      if ((s & 7) === 0) {
        e: {
          if (je = i === "mouseover" || i === "pointerover", Me = i === "mouseout" || i === "pointerout", je && c !== ei && (tt = c.relatedTarget || c.fromElement) && (Zr(tt) || tt[$n]))
            break e;
          if ((Me || je) && (je = Oe.window === Oe ? Oe : (je = Oe.ownerDocument) ? je.defaultView || je.parentWindow : window, Me ? (tt = c.relatedTarget || c.toElement, Me = Ee, tt = tt ? Zr(tt) : null, tt !== null && (Vt = o(tt), ct = tt.tag, tt !== Vt || ct !== 5 && ct !== 27 && ct !== 6) && (tt = null)) : (Me = null, tt = Ee), Me !== tt)) {
            if (ct = el, De = "onMouseLeave", ve = "onMouseEnter", he = "mouse", (i === "pointerout" || i === "pointerover") && (ct = ju, De = "onPointerLeave", ve = "onPointerEnter", he = "pointer"), Vt = Me == null ? je : nr(Me), Ce = tt == null ? je : nr(tt), je = new ct(
              De,
              he + "leave",
              Me,
              c,
              Oe
            ), je.target = Vt, je.relatedTarget = Ce, De = null, Zr(Oe) === Ee && (ct = new ct(
              ve,
              he + "enter",
              tt,
              c,
              Oe
            ), ct.target = Ce, ct.relatedTarget = Vt, De = ct), Vt = De, Me && tt)
              t: {
                for (ct = AM, ve = Me, he = tt, Ce = 0, De = ve; De; De = ct(De))
                  Ce++;
                De = 0;
                for (var lt = he; lt; lt = ct(lt))
                  De++;
                for (; 0 < Ce - De; )
                  ve = ct(ve), Ce--;
                for (; 0 < De - Ce; )
                  he = ct(he), De--;
                for (; Ce--; ) {
                  if (ve === he || he !== null && ve === he.alternate) {
                    ct = ve;
                    break t;
                  }
                  ve = ct(ve), he = ct(he);
                }
                ct = null;
              }
            else ct = null;
            Me !== null && Z3(
              Le,
              je,
              Me,
              ct,
              !1
            ), tt !== null && Vt !== null && Z3(
              Le,
              Vt,
              tt,
              ct,
              !0
            );
          }
        }
        e: {
          if (je = Ee ? nr(Ee) : window, Me = je.nodeName && je.nodeName.toLowerCase(), Me === "select" || Me === "input" && je.type === "file")
            var Ot = no;
          else if (ul(je))
            if (ni)
              Ot = cs;
            else {
              Ot = Sa;
              var it = Md;
            }
          else
            Me = je.nodeName, !Me || Me.toLowerCase() !== "input" || je.type !== "checkbox" && je.type !== "radio" ? Ee && wu(Ee.elementType) && (Ot = no) : Ot = Du;
          if (Ot && (Ot = Ot(i, Ee))) {
            Ou(
              Le,
              Ot,
              c,
              Oe
            );
            break e;
          }
          it && it(i, je, Ee), i === "focusout" && Ee && je.type === "number" && Ee.memoizedProps.value != null && ma(je, "number", je.value);
        }
        switch (it = Ee ? nr(Ee) : window, i) {
          case "focusin":
            (ul(it) || it.contentEditable === "true") && (ne = it, ue = Ee, ce = null);
            break;
          case "focusout":
            ce = ue = ne = null;
            break;
          case "mousedown":
            ge = !0;
            break;
          case "contextmenu":
          case "mouseup":
          case "dragend":
            ge = !1, se(Le, c, Oe);
            break;
          case "selectionchange":
            if (Q) break;
          case "keydown":
          case "keyup":
            se(Le, c, Oe);
        }
        var vt;
        if (eo)
          e: {
            switch (i) {
              case "compositionstart":
                var kt = "onCompositionStart";
                break e;
              case "compositionend":
                kt = "onCompositionEnd";
                break e;
              case "compositionupdate":
                kt = "onCompositionUpdate";
                break e;
            }
            kt = void 0;
          }
        else
          _a ? zu(i, c) && (kt = "onCompositionEnd") : i === "keydown" && c.keyCode === 229 && (kt = "onCompositionStart");
        kt && (ol && c.locale !== "ko" && (_a || kt !== "onCompositionStart" ? kt === "onCompositionEnd" && _a && (vt = is()) : (ti = Oe, Wo = "value" in ti ? ti.value : ti.textContent, _a = !0)), it = gf(Ee, kt), 0 < it.length && (kt = new rl(
          kt,
          i,
          null,
          c,
          Oe
        ), Le.push({ event: kt, listeners: it }), vt ? kt.data = vt : (vt = Nd(c), vt !== null && (kt.data = vt)))), (vt = Nm ? jd(i, c) : jm(i, c)) && (kt = gf(Ee, "onBeforeInput"), 0 < kt.length && (it = new rl(
          "onBeforeInput",
          "beforeinput",
          null,
          c,
          Oe
        ), Le.push({
          event: it,
          listeners: kt
        }), it.data = vt)), kM(
          Le,
          i,
          Ee,
          c,
          Oe
        );
      }
      W3(Le, s);
    });
  }
  function oc(i, s, c) {
    return {
      instance: i,
      listener: s,
      currentTarget: c
    };
  }
  function gf(i, s) {
    for (var c = s + "Capture", g = []; i !== null; ) {
      var b = i, S = b.stateNode;
      if (b = b.tag, b !== 5 && b !== 26 && b !== 27 || S === null || (b = xa(i, c), b != null && g.unshift(
        oc(i, b, S)
      ), b = xa(i, s), b != null && g.push(
        oc(i, b, S)
      )), i.tag === 3) return g;
      i = i.return;
    }
    return [];
  }
  function AM(i) {
    if (i === null) return null;
    do
      i = i.return;
    while (i && i.tag !== 5 && i.tag !== 27);
    return i || null;
  }
  function Z3(i, s, c, g, b) {
    for (var S = s._reactName, z = []; c !== null && c !== g; ) {
      var K = c, ae = K.alternate, Ee = K.stateNode;
      if (K = K.tag, ae !== null && ae === g) break;
      K !== 5 && K !== 26 && K !== 27 || Ee === null || (ae = Ee, b ? (Ee = xa(c, S), Ee != null && z.unshift(
        oc(c, Ee, ae)
      )) : b || (Ee = xa(c, S), Ee != null && z.push(
        oc(c, Ee, ae)
      ))), c = c.return;
    }
    z.length !== 0 && i.push({ event: s, listeners: z });
  }
  var MM = /\r\n?/g, RM = /\u0000|\uFFFD/g;
  function J3(i) {
    return (typeof i == "string" ? i : "" + i).replace(MM, `
`).replace(RM, "");
  }
  function e5(i, s) {
    return s = J3(s), J3(i) === s;
  }
  function Gt(i, s, c, g, b, S) {
    switch (c) {
      case "children":
        typeof g == "string" ? s === "body" || s === "textarea" && g === "" || pa(i, g) : (typeof g == "number" || typeof g == "bigint") && s !== "body" && pa(i, "" + g);
        break;
      case "className":
        fa(i, "class", g);
        break;
      case "tabIndex":
        fa(i, "tabindex", g);
        break;
      case "dir":
      case "role":
      case "viewBox":
      case "width":
      case "height":
        fa(i, c, g);
        break;
      case "style":
        bu(i, g, S);
        break;
      case "data":
        if (s !== "object") {
          fa(i, "data", g);
          break;
        }
      case "src":
      case "href":
        if (g === "" && (s !== "a" || c !== "href")) {
          i.removeAttribute(c);
          break;
        }
        if (g == null || typeof g == "function" || typeof g == "symbol" || typeof g == "boolean") {
          i.removeAttribute(c);
          break;
        }
        g = wi("" + g), i.setAttribute(c, g);
        break;
      case "action":
      case "formAction":
        if (typeof g == "function") {
          i.setAttribute(
            c,
            "javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')"
          );
          break;
        } else
          typeof S == "function" && (c === "formAction" ? (s !== "input" && Gt(i, s, "name", b.name, b, null), Gt(
            i,
            s,
            "formEncType",
            b.formEncType,
            b,
            null
          ), Gt(
            i,
            s,
            "formMethod",
            b.formMethod,
            b,
            null
          ), Gt(
            i,
            s,
            "formTarget",
            b.formTarget,
            b,
            null
          )) : (Gt(i, s, "encType", b.encType, b, null), Gt(i, s, "method", b.method, b, null), Gt(i, s, "target", b.target, b, null)));
        if (g == null || typeof g == "symbol" || typeof g == "boolean") {
          i.removeAttribute(c);
          break;
        }
        g = wi("" + g), i.setAttribute(c, g);
        break;
      case "onClick":
        g != null && (i.onclick = _r);
        break;
      case "onScroll":
        g != null && _t("scroll", i);
        break;
      case "onScrollEnd":
        g != null && _t("scrollend", i);
        break;
      case "dangerouslySetInnerHTML":
        if (g != null) {
          if (typeof g != "object" || !("__html" in g))
            throw Error(r(61));
          if (c = g.__html, c != null) {
            if (b.children != null) throw Error(r(60));
            i.innerHTML = c;
          }
        }
        break;
      case "multiple":
        i.multiple = g && typeof g != "function" && typeof g != "symbol";
        break;
      case "muted":
        i.muted = g && typeof g != "function" && typeof g != "symbol";
        break;
      case "suppressContentEditableWarning":
      case "suppressHydrationWarning":
      case "defaultValue":
      case "defaultChecked":
      case "innerHTML":
      case "ref":
        break;
      case "autoFocus":
        break;
      case "xlinkHref":
        if (g == null || typeof g == "function" || typeof g == "boolean" || typeof g == "symbol") {
          i.removeAttribute("xlink:href");
          break;
        }
        c = wi("" + g), i.setAttributeNS(
          "http://www.w3.org/1999/xlink",
          "xlink:href",
          c
        );
        break;
      case "contentEditable":
      case "spellCheck":
      case "draggable":
      case "value":
      case "autoReverse":
      case "externalResourcesRequired":
      case "focusable":
      case "preserveAlpha":
        g != null && typeof g != "function" && typeof g != "symbol" ? i.setAttribute(c, "" + g) : i.removeAttribute(c);
        break;
      case "inert":
      case "allowFullScreen":
      case "async":
      case "autoPlay":
      case "controls":
      case "default":
      case "defer":
      case "disabled":
      case "disablePictureInPicture":
      case "disableRemotePlayback":
      case "formNoValidate":
      case "hidden":
      case "loop":
      case "noModule":
      case "noValidate":
      case "open":
      case "playsInline":
      case "readOnly":
      case "required":
      case "reversed":
      case "scoped":
      case "seamless":
      case "itemScope":
        g && typeof g != "function" && typeof g != "symbol" ? i.setAttribute(c, "") : i.removeAttribute(c);
        break;
      case "capture":
      case "download":
        g === !0 ? i.setAttribute(c, "") : g !== !1 && g != null && typeof g != "function" && typeof g != "symbol" ? i.setAttribute(c, g) : i.removeAttribute(c);
        break;
      case "cols":
      case "rows":
      case "size":
      case "span":
        g != null && typeof g != "function" && typeof g != "symbol" && !isNaN(g) && 1 <= g ? i.setAttribute(c, g) : i.removeAttribute(c);
        break;
      case "rowSpan":
      case "start":
        g == null || typeof g == "function" || typeof g == "symbol" || isNaN(g) ? i.removeAttribute(c) : i.setAttribute(c, g);
        break;
      case "popover":
        _t("beforetoggle", i), _t("toggle", i), pt(i, "popover", g);
        break;
      case "xlinkActuate":
        vr(
          i,
          "http://www.w3.org/1999/xlink",
          "xlink:actuate",
          g
        );
        break;
      case "xlinkArcrole":
        vr(
          i,
          "http://www.w3.org/1999/xlink",
          "xlink:arcrole",
          g
        );
        break;
      case "xlinkRole":
        vr(
          i,
          "http://www.w3.org/1999/xlink",
          "xlink:role",
          g
        );
        break;
      case "xlinkShow":
        vr(
          i,
          "http://www.w3.org/1999/xlink",
          "xlink:show",
          g
        );
        break;
      case "xlinkTitle":
        vr(
          i,
          "http://www.w3.org/1999/xlink",
          "xlink:title",
          g
        );
        break;
      case "xlinkType":
        vr(
          i,
          "http://www.w3.org/1999/xlink",
          "xlink:type",
          g
        );
        break;
      case "xmlBase":
        vr(
          i,
          "http://www.w3.org/XML/1998/namespace",
          "xml:base",
          g
        );
        break;
      case "xmlLang":
        vr(
          i,
          "http://www.w3.org/XML/1998/namespace",
          "xml:lang",
          g
        );
        break;
      case "xmlSpace":
        vr(
          i,
          "http://www.w3.org/XML/1998/namespace",
          "xml:space",
          g
        );
        break;
      case "is":
        pt(i, "is", g);
        break;
      case "innerText":
      case "textContent":
        break;
      default:
        (!(2 < c.length) || c[0] !== "o" && c[0] !== "O" || c[1] !== "n" && c[1] !== "N") && (c = Cm.get(c) || c, pt(i, c, g));
    }
  }
  function Wp(i, s, c, g, b, S) {
    switch (c) {
      case "style":
        bu(i, g, S);
        break;
      case "dangerouslySetInnerHTML":
        if (g != null) {
          if (typeof g != "object" || !("__html" in g))
            throw Error(r(61));
          if (c = g.__html, c != null) {
            if (b.children != null) throw Error(r(60));
            i.innerHTML = c;
          }
        }
        break;
      case "children":
        typeof g == "string" ? pa(i, g) : (typeof g == "number" || typeof g == "bigint") && pa(i, "" + g);
        break;
      case "onScroll":
        g != null && _t("scroll", i);
        break;
      case "onScrollEnd":
        g != null && _t("scrollend", i);
        break;
      case "onClick":
        g != null && (i.onclick = _r);
        break;
      case "suppressContentEditableWarning":
      case "suppressHydrationWarning":
      case "innerHTML":
      case "ref":
        break;
      case "innerText":
      case "textContent":
        break;
      default:
        if (!ca.hasOwnProperty(c))
          e: {
            if (c[0] === "o" && c[1] === "n" && (b = c.endsWith("Capture"), s = c.slice(2, b ? c.length - 7 : void 0), S = i[fn] || null, S = S != null ? S[c] : null, typeof S == "function" && i.removeEventListener(s, S, b), typeof g == "function")) {
              typeof S != "function" && S !== null && (c in i ? i[c] = null : i.hasAttribute(c) && i.removeAttribute(c)), i.addEventListener(s, g, b);
              break e;
            }
            c in i ? i[c] = g : g === !0 ? i.setAttribute(c, "") : pt(i, c, g);
          }
    }
  }
  function Qn(i, s, c) {
    switch (s) {
      case "div":
      case "span":
      case "svg":
      case "path":
      case "a":
      case "g":
      case "p":
      case "li":
        break;
      case "img":
        _t("error", i), _t("load", i);
        var g = !1, b = !1, S;
        for (S in c)
          if (c.hasOwnProperty(S)) {
            var z = c[S];
            if (z != null)
              switch (S) {
                case "src":
                  g = !0;
                  break;
                case "srcSet":
                  b = !0;
                  break;
                case "children":
                case "dangerouslySetInnerHTML":
                  throw Error(r(137, s));
                default:
                  Gt(i, s, S, z, c, null);
              }
          }
        b && Gt(i, s, "srcSet", c.srcSet, c, null), g && Gt(i, s, "src", c.src, c, null);
        return;
      case "input":
        _t("invalid", i);
        var K = S = z = b = null, ae = null, Ee = null;
        for (g in c)
          if (c.hasOwnProperty(g)) {
            var Oe = c[g];
            if (Oe != null)
              switch (g) {
                case "name":
                  b = Oe;
                  break;
                case "type":
                  z = Oe;
                  break;
                case "checked":
                  ae = Oe;
                  break;
                case "defaultChecked":
                  Ee = Oe;
                  break;
                case "value":
                  S = Oe;
                  break;
                case "defaultValue":
                  K = Oe;
                  break;
                case "children":
                case "dangerouslySetInnerHTML":
                  if (Oe != null)
                    throw Error(r(137, s));
                  break;
                default:
                  Gt(i, s, g, Oe, c, null);
              }
          }
        ts(
          i,
          S,
          K,
          ae,
          Ee,
          z,
          b,
          !1
        );
        return;
      case "select":
        _t("invalid", i), g = z = S = null;
        for (b in c)
          if (c.hasOwnProperty(b) && (K = c[b], K != null))
            switch (b) {
              case "value":
                S = K;
                break;
              case "defaultValue":
                z = K;
                break;
              case "multiple":
                g = K;
              default:
                Gt(i, s, b, K, c, null);
            }
        s = S, c = z, i.multiple = !!g, s != null ? wr(i, !!g, s, !1) : c != null && wr(i, !!g, c, !0);
        return;
      case "textarea":
        _t("invalid", i), S = b = g = null;
        for (z in c)
          if (c.hasOwnProperty(z) && (K = c[z], K != null))
            switch (z) {
              case "value":
                g = K;
                break;
              case "defaultValue":
                b = K;
                break;
              case "children":
                S = K;
                break;
              case "dangerouslySetInnerHTML":
                if (K != null) throw Error(r(91));
                break;
              default:
                Gt(i, s, z, K, c, null);
            }
        Xs(i, g, b, S);
        return;
      case "option":
        for (ae in c)
          if (c.hasOwnProperty(ae) && (g = c[ae], g != null))
            switch (ae) {
              case "selected":
                i.selected = g && typeof g != "function" && typeof g != "symbol";
                break;
              default:
                Gt(i, s, ae, g, c, null);
            }
        return;
      case "dialog":
        _t("beforetoggle", i), _t("toggle", i), _t("cancel", i), _t("close", i);
        break;
      case "iframe":
      case "object":
        _t("load", i);
        break;
      case "video":
      case "audio":
        for (g = 0; g < sc.length; g++)
          _t(sc[g], i);
        break;
      case "image":
        _t("error", i), _t("load", i);
        break;
      case "details":
        _t("toggle", i);
        break;
      case "embed":
      case "source":
      case "link":
        _t("error", i), _t("load", i);
      case "area":
      case "base":
      case "br":
      case "col":
      case "hr":
      case "keygen":
      case "meta":
      case "param":
      case "track":
      case "wbr":
      case "menuitem":
        for (Ee in c)
          if (c.hasOwnProperty(Ee) && (g = c[Ee], g != null))
            switch (Ee) {
              case "children":
              case "dangerouslySetInnerHTML":
                throw Error(r(137, s));
              default:
                Gt(i, s, Ee, g, c, null);
            }
        return;
      default:
        if (wu(s)) {
          for (Oe in c)
            c.hasOwnProperty(Oe) && (g = c[Oe], g !== void 0 && Wp(
              i,
              s,
              Oe,
              g,
              c,
              void 0
            ));
          return;
        }
    }
    for (K in c)
      c.hasOwnProperty(K) && (g = c[K], g != null && Gt(i, s, K, g, c, null));
  }
  function zM(i, s, c, g) {
    switch (s) {
      case "div":
      case "span":
      case "svg":
      case "path":
      case "a":
      case "g":
      case "p":
      case "li":
        break;
      case "input":
        var b = null, S = null, z = null, K = null, ae = null, Ee = null, Oe = null;
        for (Me in c) {
          var Le = c[Me];
          if (c.hasOwnProperty(Me) && Le != null)
            switch (Me) {
              case "checked":
                break;
              case "value":
                break;
              case "defaultValue":
                ae = Le;
              default:
                g.hasOwnProperty(Me) || Gt(i, s, Me, null, g, Le);
            }
        }
        for (var je in g) {
          var Me = g[je];
          if (Le = c[je], g.hasOwnProperty(je) && (Me != null || Le != null))
            switch (je) {
              case "type":
                S = Me;
                break;
              case "name":
                b = Me;
                break;
              case "checked":
                Ee = Me;
                break;
              case "defaultChecked":
                Oe = Me;
                break;
              case "value":
                z = Me;
                break;
              case "defaultValue":
                K = Me;
                break;
              case "children":
              case "dangerouslySetInnerHTML":
                if (Me != null)
                  throw Error(r(137, s));
                break;
              default:
                Me !== Le && Gt(
                  i,
                  s,
                  je,
                  Me,
                  g,
                  Le
                );
            }
        }
        br(
          i,
          z,
          K,
          ae,
          Ee,
          Oe,
          S,
          b
        );
        return;
      case "select":
        Me = z = K = je = null;
        for (S in c)
          if (ae = c[S], c.hasOwnProperty(S) && ae != null)
            switch (S) {
              case "value":
                break;
              case "multiple":
                Me = ae;
              default:
                g.hasOwnProperty(S) || Gt(
                  i,
                  s,
                  S,
                  null,
                  g,
                  ae
                );
            }
        for (b in g)
          if (S = g[b], ae = c[b], g.hasOwnProperty(b) && (S != null || ae != null))
            switch (b) {
              case "value":
                je = S;
                break;
              case "defaultValue":
                K = S;
                break;
              case "multiple":
                z = S;
              default:
                S !== ae && Gt(
                  i,
                  s,
                  b,
                  S,
                  g,
                  ae
                );
            }
        s = K, c = z, g = Me, je != null ? wr(i, !!c, je, !1) : !!g != !!c && (s != null ? wr(i, !!c, s, !0) : wr(i, !!c, c ? [] : "", !1));
        return;
      case "textarea":
        Me = je = null;
        for (K in c)
          if (b = c[K], c.hasOwnProperty(K) && b != null && !g.hasOwnProperty(K))
            switch (K) {
              case "value":
                break;
              case "children":
                break;
              default:
                Gt(i, s, K, null, g, b);
            }
        for (z in g)
          if (b = g[z], S = c[z], g.hasOwnProperty(z) && (b != null || S != null))
            switch (z) {
              case "value":
                je = b;
                break;
              case "defaultValue":
                Me = b;
                break;
              case "children":
                break;
              case "dangerouslySetInnerHTML":
                if (b != null) throw Error(r(91));
                break;
              default:
                b !== S && Gt(i, s, z, b, g, S);
            }
        vu(i, je, Me);
        return;
      case "option":
        for (var tt in c)
          if (je = c[tt], c.hasOwnProperty(tt) && je != null && !g.hasOwnProperty(tt))
            switch (tt) {
              case "selected":
                i.selected = !1;
                break;
              default:
                Gt(
                  i,
                  s,
                  tt,
                  null,
                  g,
                  je
                );
            }
        for (ae in g)
          if (je = g[ae], Me = c[ae], g.hasOwnProperty(ae) && je !== Me && (je != null || Me != null))
            switch (ae) {
              case "selected":
                i.selected = je && typeof je != "function" && typeof je != "symbol";
                break;
              default:
                Gt(
                  i,
                  s,
                  ae,
                  je,
                  g,
                  Me
                );
            }
        return;
      case "img":
      case "link":
      case "area":
      case "base":
      case "br":
      case "col":
      case "embed":
      case "hr":
      case "keygen":
      case "meta":
      case "param":
      case "source":
      case "track":
      case "wbr":
      case "menuitem":
        for (var ct in c)
          je = c[ct], c.hasOwnProperty(ct) && je != null && !g.hasOwnProperty(ct) && Gt(i, s, ct, null, g, je);
        for (Ee in g)
          if (je = g[Ee], Me = c[Ee], g.hasOwnProperty(Ee) && je !== Me && (je != null || Me != null))
            switch (Ee) {
              case "children":
              case "dangerouslySetInnerHTML":
                if (je != null)
                  throw Error(r(137, s));
                break;
              default:
                Gt(
                  i,
                  s,
                  Ee,
                  je,
                  g,
                  Me
                );
            }
        return;
      default:
        if (wu(s)) {
          for (var Vt in c)
            je = c[Vt], c.hasOwnProperty(Vt) && je !== void 0 && !g.hasOwnProperty(Vt) && Wp(
              i,
              s,
              Vt,
              void 0,
              g,
              je
            );
          for (Oe in g)
            je = g[Oe], Me = c[Oe], !g.hasOwnProperty(Oe) || je === Me || je === void 0 && Me === void 0 || Wp(
              i,
              s,
              Oe,
              je,
              g,
              Me
            );
          return;
        }
    }
    for (var ve in c)
      je = c[ve], c.hasOwnProperty(ve) && je != null && !g.hasOwnProperty(ve) && Gt(i, s, ve, null, g, je);
    for (Le in g)
      je = g[Le], Me = c[Le], !g.hasOwnProperty(Le) || je === Me || je == null && Me == null || Gt(i, s, Le, je, g, Me);
  }
  function t5(i) {
    switch (i) {
      case "css":
      case "script":
      case "font":
      case "img":
      case "image":
      case "input":
      case "link":
        return !0;
      default:
        return !1;
    }
  }
  function OM() {
    if (typeof performance.getEntriesByType == "function") {
      for (var i = 0, s = 0, c = performance.getEntriesByType("resource"), g = 0; g < c.length; g++) {
        var b = c[g], S = b.transferSize, z = b.initiatorType, K = b.duration;
        if (S && K && t5(z)) {
          for (z = 0, K = b.responseEnd, g += 1; g < c.length; g++) {
            var ae = c[g], Ee = ae.startTime;
            if (Ee > K) break;
            var Oe = ae.transferSize, Le = ae.initiatorType;
            Oe && t5(Le) && (ae = ae.responseEnd, z += Oe * (ae < K ? 1 : (K - Ee) / (ae - Ee)));
          }
          if (--g, s += 8 * (S + z) / (b.duration / 1e3), i++, 10 < i) break;
        }
      }
      if (0 < i) return s / i / 1e6;
    }
    return navigator.connection && (i = navigator.connection.downlink, typeof i == "number") ? i : 5;
  }
  var Qp = null, Zp = null;
  function yf(i) {
    return i.nodeType === 9 ? i : i.ownerDocument;
  }
  function n5(i) {
    switch (i) {
      case "http://www.w3.org/2000/svg":
        return 1;
      case "http://www.w3.org/1998/Math/MathML":
        return 2;
      default:
        return 0;
    }
  }
  function r5(i, s) {
    if (i === 0)
      switch (s) {
        case "svg":
          return 1;
        case "math":
          return 2;
        default:
          return 0;
      }
    return i === 1 && s === "foreignObject" ? 0 : i;
  }
  function Jp(i, s) {
    return i === "textarea" || i === "noscript" || typeof s.children == "string" || typeof s.children == "number" || typeof s.children == "bigint" || typeof s.dangerouslySetInnerHTML == "object" && s.dangerouslySetInnerHTML !== null && s.dangerouslySetInnerHTML.__html != null;
  }
  var eg = null;
  function DM() {
    var i = window.event;
    return i && i.type === "popstate" ? i === eg ? !1 : (eg = i, !0) : (eg = null, !1);
  }
  var i5 = typeof setTimeout == "function" ? setTimeout : void 0, IM = typeof clearTimeout == "function" ? clearTimeout : void 0, a5 = typeof Promise == "function" ? Promise : void 0, LM = typeof queueMicrotask == "function" ? queueMicrotask : typeof a5 < "u" ? function(i) {
    return a5.resolve(null).then(i).catch(qM);
  } : i5;
  function qM(i) {
    setTimeout(function() {
      throw i;
    });
  }
  function Ns(i) {
    return i === "head";
  }
  function s5(i, s) {
    var c = s, g = 0;
    do {
      var b = c.nextSibling;
      if (i.removeChild(c), b && b.nodeType === 8)
        if (c = b.data, c === "/$" || c === "/&") {
          if (g === 0) {
            i.removeChild(b), Dl(s);
            return;
          }
          g--;
        } else if (c === "$" || c === "$?" || c === "$~" || c === "$!" || c === "&")
          g++;
        else if (c === "html")
          lc(i.ownerDocument.documentElement);
        else if (c === "head") {
          c = i.ownerDocument.head, lc(c);
          for (var S = c.firstChild; S; ) {
            var z = S.nextSibling, K = S.nodeName;
            S[dr] || K === "SCRIPT" || K === "STYLE" || K === "LINK" && S.rel.toLowerCase() === "stylesheet" || c.removeChild(S), S = z;
          }
        } else
          c === "body" && lc(i.ownerDocument.body);
      c = b;
    } while (c);
    Dl(s);
  }
  function o5(i, s) {
    var c = i;
    i = 0;
    do {
      var g = c.nextSibling;
      if (c.nodeType === 1 ? s ? (c._stashedDisplay = c.style.display, c.style.display = "none") : (c.style.display = c._stashedDisplay || "", c.getAttribute("style") === "" && c.removeAttribute("style")) : c.nodeType === 3 && (s ? (c._stashedText = c.nodeValue, c.nodeValue = "") : c.nodeValue = c._stashedText || ""), g && g.nodeType === 8)
        if (c = g.data, c === "/$") {
          if (i === 0) break;
          i--;
        } else
          c !== "$" && c !== "$?" && c !== "$~" && c !== "$!" || i++;
      c = g;
    } while (c);
  }
  function tg(i) {
    var s = i.firstChild;
    for (s && s.nodeType === 10 && (s = s.nextSibling); s; ) {
      var c = s;
      switch (s = s.nextSibling, c.nodeName) {
        case "HTML":
        case "HEAD":
        case "BODY":
          tg(c), Ja(c);
          continue;
        case "SCRIPT":
        case "STYLE":
          continue;
        case "LINK":
          if (c.rel.toLowerCase() === "stylesheet") continue;
      }
      i.removeChild(c);
    }
  }
  function PM(i, s, c, g) {
    for (; i.nodeType === 1; ) {
      var b = c;
      if (i.nodeName.toLowerCase() !== s.toLowerCase()) {
        if (!g && (i.nodeName !== "INPUT" || i.type !== "hidden"))
          break;
      } else if (g) {
        if (!i[dr])
          switch (s) {
            case "meta":
              if (!i.hasAttribute("itemprop")) break;
              return i;
            case "link":
              if (S = i.getAttribute("rel"), S === "stylesheet" && i.hasAttribute("data-precedence"))
                break;
              if (S !== b.rel || i.getAttribute("href") !== (b.href == null || b.href === "" ? null : b.href) || i.getAttribute("crossorigin") !== (b.crossOrigin == null ? null : b.crossOrigin) || i.getAttribute("title") !== (b.title == null ? null : b.title))
                break;
              return i;
            case "style":
              if (i.hasAttribute("data-precedence")) break;
              return i;
            case "script":
              if (S = i.getAttribute("src"), (S !== (b.src == null ? null : b.src) || i.getAttribute("type") !== (b.type == null ? null : b.type) || i.getAttribute("crossorigin") !== (b.crossOrigin == null ? null : b.crossOrigin)) && S && i.hasAttribute("async") && !i.hasAttribute("itemprop"))
                break;
              return i;
            default:
              return i;
          }
      } else if (s === "input" && i.type === "hidden") {
        var S = b.name == null ? null : "" + b.name;
        if (b.type === "hidden" && i.getAttribute("name") === S)
          return i;
      } else return i;
      if (i = li(i.nextSibling), i === null) break;
    }
    return null;
  }
  function BM(i, s, c) {
    if (s === "") return null;
    for (; i.nodeType !== 3; )
      if ((i.nodeType !== 1 || i.nodeName !== "INPUT" || i.type !== "hidden") && !c || (i = li(i.nextSibling), i === null)) return null;
    return i;
  }
  function l5(i, s) {
    for (; i.nodeType !== 8; )
      if ((i.nodeType !== 1 || i.nodeName !== "INPUT" || i.type !== "hidden") && !s || (i = li(i.nextSibling), i === null)) return null;
    return i;
  }
  function ng(i) {
    return i.data === "$?" || i.data === "$~";
  }
  function rg(i) {
    return i.data === "$!" || i.data === "$?" && i.ownerDocument.readyState !== "loading";
  }
  function FM(i, s) {
    var c = i.ownerDocument;
    if (i.data === "$~") i._reactRetry = s;
    else if (i.data !== "$?" || c.readyState !== "loading")
      s();
    else {
      var g = function() {
        s(), c.removeEventListener("DOMContentLoaded", g);
      };
      c.addEventListener("DOMContentLoaded", g), i._reactRetry = g;
    }
  }
  function li(i) {
    for (; i != null; i = i.nextSibling) {
      var s = i.nodeType;
      if (s === 1 || s === 3) break;
      if (s === 8) {
        if (s = i.data, s === "$" || s === "$!" || s === "$?" || s === "$~" || s === "&" || s === "F!" || s === "F")
          break;
        if (s === "/$" || s === "/&") return null;
      }
    }
    return i;
  }
  var ig = null;
  function u5(i) {
    i = i.nextSibling;
    for (var s = 0; i; ) {
      if (i.nodeType === 8) {
        var c = i.data;
        if (c === "/$" || c === "/&") {
          if (s === 0)
            return li(i.nextSibling);
          s--;
        } else
          c !== "$" && c !== "$!" && c !== "$?" && c !== "$~" && c !== "&" || s++;
      }
      i = i.nextSibling;
    }
    return null;
  }
  function c5(i) {
    i = i.previousSibling;
    for (var s = 0; i; ) {
      if (i.nodeType === 8) {
        var c = i.data;
        if (c === "$" || c === "$!" || c === "$?" || c === "$~" || c === "&") {
          if (s === 0) return i;
          s--;
        } else c !== "/$" && c !== "/&" || s++;
      }
      i = i.previousSibling;
    }
    return null;
  }
  function d5(i, s, c) {
    switch (s = yf(c), i) {
      case "html":
        if (i = s.documentElement, !i) throw Error(r(452));
        return i;
      case "head":
        if (i = s.head, !i) throw Error(r(453));
        return i;
      case "body":
        if (i = s.body, !i) throw Error(r(454));
        return i;
      default:
        throw Error(r(451));
    }
  }
  function lc(i) {
    for (var s = i.attributes; s.length; )
      i.removeAttributeNode(s[0]);
    Ja(i);
  }
  var ui = /* @__PURE__ */ new Map(), f5 = /* @__PURE__ */ new Set();
  function xf(i) {
    return typeof i.getRootNode == "function" ? i.getRootNode() : i.nodeType === 9 ? i : i.ownerDocument;
  }
  var qa = ee.d;
  ee.d = {
    f: $M,
    r: UM,
    D: HM,
    C: GM,
    L: VM,
    m: KM,
    X: XM,
    S: YM,
    M: WM
  };
  function $M() {
    var i = qa.f(), s = uf();
    return i || s;
  }
  function UM(i) {
    var s = Pt(i);
    s !== null && s.tag === 5 && s.type === "form" ? T4(s) : qa.r(i);
  }
  var Rl = typeof document > "u" ? null : document;
  function h5(i, s, c) {
    var g = Rl;
    if (g && typeof s == "string" && s) {
      var b = Cn(s);
      b = 'link[rel="' + i + '"][href="' + b + '"]', typeof c == "string" && (b += '[crossorigin="' + c + '"]'), f5.has(b) || (f5.add(b), i = { rel: i, crossOrigin: c, href: s }, g.querySelector(b) === null && (s = g.createElement("link"), Qn(s, "link", i), hn(s), g.head.appendChild(s)));
    }
  }
  function HM(i) {
    qa.D(i), h5("dns-prefetch", i, null);
  }
  function GM(i, s) {
    qa.C(i, s), h5("preconnect", i, s);
  }
  function VM(i, s, c) {
    qa.L(i, s, c);
    var g = Rl;
    if (g && i && s) {
      var b = 'link[rel="preload"][as="' + Cn(s) + '"]';
      s === "image" && c && c.imageSrcSet ? (b += '[imagesrcset="' + Cn(
        c.imageSrcSet
      ) + '"]', typeof c.imageSizes == "string" && (b += '[imagesizes="' + Cn(
        c.imageSizes
      ) + '"]')) : b += '[href="' + Cn(i) + '"]';
      var S = b;
      switch (s) {
        case "style":
          S = zl(i);
          break;
        case "script":
          S = Ol(i);
      }
      ui.has(S) || (i = p(
        {
          rel: "preload",
          href: s === "image" && c && c.imageSrcSet ? void 0 : i,
          as: s
        },
        c
      ), ui.set(S, i), g.querySelector(b) !== null || s === "style" && g.querySelector(uc(S)) || s === "script" && g.querySelector(cc(S)) || (s = g.createElement("link"), Qn(s, "link", i), hn(s), g.head.appendChild(s)));
    }
  }
  function KM(i, s) {
    qa.m(i, s);
    var c = Rl;
    if (c && i) {
      var g = s && typeof s.as == "string" ? s.as : "script", b = 'link[rel="modulepreload"][as="' + Cn(g) + '"][href="' + Cn(i) + '"]', S = b;
      switch (g) {
        case "audioworklet":
        case "paintworklet":
        case "serviceworker":
        case "sharedworker":
        case "worker":
        case "script":
          S = Ol(i);
      }
      if (!ui.has(S) && (i = p({ rel: "modulepreload", href: i }, s), ui.set(S, i), c.querySelector(b) === null)) {
        switch (g) {
          case "audioworklet":
          case "paintworklet":
          case "serviceworker":
          case "sharedworker":
          case "worker":
          case "script":
            if (c.querySelector(cc(S)))
              return;
        }
        g = c.createElement("link"), Qn(g, "link", i), hn(g), c.head.appendChild(g);
      }
    }
  }
  function YM(i, s, c) {
    qa.S(i, s, c);
    var g = Rl;
    if (g && i) {
      var b = Un(g).hoistableStyles, S = zl(i);
      s = s || "default";
      var z = b.get(S);
      if (!z) {
        var K = { loading: 0, preload: null };
        if (z = g.querySelector(
          uc(S)
        ))
          K.loading = 5;
        else {
          i = p(
            { rel: "stylesheet", href: i, "data-precedence": s },
            c
          ), (c = ui.get(S)) && ag(i, c);
          var ae = z = g.createElement("link");
          hn(ae), Qn(ae, "link", i), ae._p = new Promise(function(Ee, Oe) {
            ae.onload = Ee, ae.onerror = Oe;
          }), ae.addEventListener("load", function() {
            K.loading |= 1;
          }), ae.addEventListener("error", function() {
            K.loading |= 2;
          }), K.loading |= 4, vf(z, s, g);
        }
        z = {
          type: "stylesheet",
          instance: z,
          count: 1,
          state: K
        }, b.set(S, z);
      }
    }
  }
  function XM(i, s) {
    qa.X(i, s);
    var c = Rl;
    if (c && i) {
      var g = Un(c).hoistableScripts, b = Ol(i), S = g.get(b);
      S || (S = c.querySelector(cc(b)), S || (i = p({ src: i, async: !0 }, s), (s = ui.get(b)) && sg(i, s), S = c.createElement("script"), hn(S), Qn(S, "link", i), c.head.appendChild(S)), S = {
        type: "script",
        instance: S,
        count: 1,
        state: null
      }, g.set(b, S));
    }
  }
  function WM(i, s) {
    qa.M(i, s);
    var c = Rl;
    if (c && i) {
      var g = Un(c).hoistableScripts, b = Ol(i), S = g.get(b);
      S || (S = c.querySelector(cc(b)), S || (i = p({ src: i, async: !0, type: "module" }, s), (s = ui.get(b)) && sg(i, s), S = c.createElement("script"), hn(S), Qn(S, "link", i), c.head.appendChild(S)), S = {
        type: "script",
        instance: S,
        count: 1,
        state: null
      }, g.set(b, S));
    }
  }
  function m5(i, s, c, g) {
    var b = (b = fe.current) ? xf(b) : null;
    if (!b) throw Error(r(446));
    switch (i) {
      case "meta":
      case "title":
        return null;
      case "style":
        return typeof c.precedence == "string" && typeof c.href == "string" ? (s = zl(c.href), c = Un(
          b
        ).hoistableStyles, g = c.get(s), g || (g = {
          type: "style",
          instance: null,
          count: 0,
          state: null
        }, c.set(s, g)), g) : { type: "void", instance: null, count: 0, state: null };
      case "link":
        if (c.rel === "stylesheet" && typeof c.href == "string" && typeof c.precedence == "string") {
          i = zl(c.href);
          var S = Un(
            b
          ).hoistableStyles, z = S.get(i);
          if (z || (b = b.ownerDocument || b, z = {
            type: "stylesheet",
            instance: null,
            count: 0,
            state: { loading: 0, preload: null }
          }, S.set(i, z), (S = b.querySelector(
            uc(i)
          )) && !S._p && (z.instance = S, z.state.loading = 5), ui.has(i) || (c = {
            rel: "preload",
            as: "style",
            href: c.href,
            crossOrigin: c.crossOrigin,
            integrity: c.integrity,
            media: c.media,
            hrefLang: c.hrefLang,
            referrerPolicy: c.referrerPolicy
          }, ui.set(i, c), S || QM(
            b,
            i,
            c,
            z.state
          ))), s && g === null)
            throw Error(r(528, ""));
          return z;
        }
        if (s && g !== null)
          throw Error(r(529, ""));
        return null;
      case "script":
        return s = c.async, c = c.src, typeof c == "string" && s && typeof s != "function" && typeof s != "symbol" ? (s = Ol(c), c = Un(
          b
        ).hoistableScripts, g = c.get(s), g || (g = {
          type: "script",
          instance: null,
          count: 0,
          state: null
        }, c.set(s, g)), g) : { type: "void", instance: null, count: 0, state: null };
      default:
        throw Error(r(444, i));
    }
  }
  function zl(i) {
    return 'href="' + Cn(i) + '"';
  }
  function uc(i) {
    return 'link[rel="stylesheet"][' + i + "]";
  }
  function p5(i) {
    return p({}, i, {
      "data-precedence": i.precedence,
      precedence: null
    });
  }
  function QM(i, s, c, g) {
    i.querySelector('link[rel="preload"][as="style"][' + s + "]") ? g.loading = 1 : (s = i.createElement("link"), g.preload = s, s.addEventListener("load", function() {
      return g.loading |= 1;
    }), s.addEventListener("error", function() {
      return g.loading |= 2;
    }), Qn(s, "link", c), hn(s), i.head.appendChild(s));
  }
  function Ol(i) {
    return '[src="' + Cn(i) + '"]';
  }
  function cc(i) {
    return "script[async]" + i;
  }
  function g5(i, s, c) {
    if (s.count++, s.instance === null)
      switch (s.type) {
        case "style":
          var g = i.querySelector(
            'style[data-href~="' + Cn(c.href) + '"]'
          );
          if (g)
            return s.instance = g, hn(g), g;
          var b = p({}, c, {
            "data-href": c.href,
            "data-precedence": c.precedence,
            href: null,
            precedence: null
          });
          return g = (i.ownerDocument || i).createElement(
            "style"
          ), hn(g), Qn(g, "style", b), vf(g, c.precedence, i), s.instance = g;
        case "stylesheet":
          b = zl(c.href);
          var S = i.querySelector(
            uc(b)
          );
          if (S)
            return s.state.loading |= 4, s.instance = S, hn(S), S;
          g = p5(c), (b = ui.get(b)) && ag(g, b), S = (i.ownerDocument || i).createElement("link"), hn(S);
          var z = S;
          return z._p = new Promise(function(K, ae) {
            z.onload = K, z.onerror = ae;
          }), Qn(S, "link", g), s.state.loading |= 4, vf(S, c.precedence, i), s.instance = S;
        case "script":
          return S = Ol(c.src), (b = i.querySelector(
            cc(S)
          )) ? (s.instance = b, hn(b), b) : (g = c, (b = ui.get(S)) && (g = p({}, c), sg(g, b)), i = i.ownerDocument || i, b = i.createElement("script"), hn(b), Qn(b, "link", g), i.head.appendChild(b), s.instance = b);
        case "void":
          return null;
        default:
          throw Error(r(443, s.type));
      }
    else
      s.type === "stylesheet" && (s.state.loading & 4) === 0 && (g = s.instance, s.state.loading |= 4, vf(g, c.precedence, i));
    return s.instance;
  }
  function vf(i, s, c) {
    for (var g = c.querySelectorAll(
      'link[rel="stylesheet"][data-precedence],style[data-precedence]'
    ), b = g.length ? g[g.length - 1] : null, S = b, z = 0; z < g.length; z++) {
      var K = g[z];
      if (K.dataset.precedence === s) S = K;
      else if (S !== b) break;
    }
    S ? S.parentNode.insertBefore(i, S.nextSibling) : (s = c.nodeType === 9 ? c.head : c, s.insertBefore(i, s.firstChild));
  }
  function ag(i, s) {
    i.crossOrigin == null && (i.crossOrigin = s.crossOrigin), i.referrerPolicy == null && (i.referrerPolicy = s.referrerPolicy), i.title == null && (i.title = s.title);
  }
  function sg(i, s) {
    i.crossOrigin == null && (i.crossOrigin = s.crossOrigin), i.referrerPolicy == null && (i.referrerPolicy = s.referrerPolicy), i.integrity == null && (i.integrity = s.integrity);
  }
  var bf = null;
  function y5(i, s, c) {
    if (bf === null) {
      var g = /* @__PURE__ */ new Map(), b = bf = /* @__PURE__ */ new Map();
      b.set(c, g);
    } else
      b = bf, g = b.get(c), g || (g = /* @__PURE__ */ new Map(), b.set(c, g));
    if (g.has(i)) return g;
    for (g.set(i, null), c = c.getElementsByTagName(i), b = 0; b < c.length; b++) {
      var S = c[b];
      if (!(S[dr] || S[Ut] || i === "link" && S.getAttribute("rel") === "stylesheet") && S.namespaceURI !== "http://www.w3.org/2000/svg") {
        var z = S.getAttribute(s) || "";
        z = i + z;
        var K = g.get(z);
        K ? K.push(S) : g.set(z, [S]);
      }
    }
    return g;
  }
  function x5(i, s, c) {
    i = i.ownerDocument || i, i.head.insertBefore(
      c,
      s === "title" ? i.querySelector("head > title") : null
    );
  }
  function ZM(i, s, c) {
    if (c === 1 || s.itemProp != null) return !1;
    switch (i) {
      case "meta":
      case "title":
        return !0;
      case "style":
        if (typeof s.precedence != "string" || typeof s.href != "string" || s.href === "")
          break;
        return !0;
      case "link":
        if (typeof s.rel != "string" || typeof s.href != "string" || s.href === "" || s.onLoad || s.onError)
          break;
        switch (s.rel) {
          case "stylesheet":
            return i = s.disabled, typeof s.precedence == "string" && i == null;
          default:
            return !0;
        }
      case "script":
        if (s.async && typeof s.async != "function" && typeof s.async != "symbol" && !s.onLoad && !s.onError && s.src && typeof s.src == "string")
          return !0;
    }
    return !1;
  }
  function v5(i) {
    return !(i.type === "stylesheet" && (i.state.loading & 3) === 0);
  }
  function JM(i, s, c, g) {
    if (c.type === "stylesheet" && (typeof g.media != "string" || matchMedia(g.media).matches !== !1) && (c.state.loading & 4) === 0) {
      if (c.instance === null) {
        var b = zl(g.href), S = s.querySelector(
          uc(b)
        );
        if (S) {
          s = S._p, s !== null && typeof s == "object" && typeof s.then == "function" && (i.count++, i = wf.bind(i), s.then(i, i)), c.state.loading |= 4, c.instance = S, hn(S);
          return;
        }
        S = s.ownerDocument || s, g = p5(g), (b = ui.get(b)) && ag(g, b), S = S.createElement("link"), hn(S);
        var z = S;
        z._p = new Promise(function(K, ae) {
          z.onload = K, z.onerror = ae;
        }), Qn(S, "link", g), c.instance = S;
      }
      i.stylesheets === null && (i.stylesheets = /* @__PURE__ */ new Map()), i.stylesheets.set(c, s), (s = c.state.preload) && (c.state.loading & 3) === 0 && (i.count++, c = wf.bind(i), s.addEventListener("load", c), s.addEventListener("error", c));
    }
  }
  var og = 0;
  function eR(i, s) {
    return i.stylesheets && i.count === 0 && Sf(i, i.stylesheets), 0 < i.count || 0 < i.imgCount ? function(c) {
      var g = setTimeout(function() {
        if (i.stylesheets && Sf(i, i.stylesheets), i.unsuspend) {
          var S = i.unsuspend;
          i.unsuspend = null, S();
        }
      }, 6e4 + s);
      0 < i.imgBytes && og === 0 && (og = 62500 * OM());
      var b = setTimeout(
        function() {
          if (i.waitingForImages = !1, i.count === 0 && (i.stylesheets && Sf(i, i.stylesheets), i.unsuspend)) {
            var S = i.unsuspend;
            i.unsuspend = null, S();
          }
        },
        (i.imgBytes > og ? 50 : 800) + s
      );
      return i.unsuspend = c, function() {
        i.unsuspend = null, clearTimeout(g), clearTimeout(b);
      };
    } : null;
  }
  function wf() {
    if (this.count--, this.count === 0 && (this.imgCount === 0 || !this.waitingForImages)) {
      if (this.stylesheets) Sf(this, this.stylesheets);
      else if (this.unsuspend) {
        var i = this.unsuspend;
        this.unsuspend = null, i();
      }
    }
  }
  var _f = null;
  function Sf(i, s) {
    i.stylesheets = null, i.unsuspend !== null && (i.count++, _f = /* @__PURE__ */ new Map(), s.forEach(tR, i), _f = null, wf.call(i));
  }
  function tR(i, s) {
    if (!(s.state.loading & 4)) {
      var c = _f.get(i);
      if (c) var g = c.get(null);
      else {
        c = /* @__PURE__ */ new Map(), _f.set(i, c);
        for (var b = i.querySelectorAll(
          "link[data-precedence],style[data-precedence]"
        ), S = 0; S < b.length; S++) {
          var z = b[S];
          (z.nodeName === "LINK" || z.getAttribute("media") !== "not all") && (c.set(z.dataset.precedence, z), g = z);
        }
        g && c.set(null, g);
      }
      b = s.instance, z = b.getAttribute("data-precedence"), S = c.get(z) || g, S === g && c.set(null, b), c.set(z, b), this.count++, g = wf.bind(this), b.addEventListener("load", g), b.addEventListener("error", g), S ? S.parentNode.insertBefore(b, S.nextSibling) : (i = i.nodeType === 9 ? i.head : i, i.insertBefore(b, i.firstChild)), s.state.loading |= 4;
    }
  }
  var dc = {
    $$typeof: N,
    Provider: null,
    Consumer: null,
    _currentValue: te,
    _currentValue2: te,
    _threadCount: 0
  };
  function nR(i, s, c, g, b, S, z, K, ae) {
    this.tag = 1, this.containerInfo = i, this.pingCache = this.current = this.pendingChildren = null, this.timeoutHandle = -1, this.callbackNode = this.next = this.pendingContext = this.context = this.cancelPendingCommit = null, this.callbackPriority = 0, this.expirationTimes = Xr(-1), this.entangledLanes = this.shellSuspendCounter = this.errorRecoveryDisabledLanes = this.expiredLanes = this.warmLanes = this.pingedLanes = this.suspendedLanes = this.pendingLanes = 0, this.entanglements = Xr(0), this.hiddenUpdates = Xr(null), this.identifierPrefix = g, this.onUncaughtError = b, this.onCaughtError = S, this.onRecoverableError = z, this.pooledCache = null, this.pooledCacheLanes = 0, this.formState = ae, this.incompleteTransitions = /* @__PURE__ */ new Map();
  }
  function b5(i, s, c, g, b, S, z, K, ae, Ee, Oe, Le) {
    return i = new nR(
      i,
      s,
      c,
      z,
      ae,
      Ee,
      Oe,
      Le,
      K
    ), s = 1, S === !0 && (s |= 24), S = Lr(3, null, null, s), i.current = S, S.stateNode = i, s = Bm(), s.refCount++, i.pooledCache = s, s.refCount++, S.memoizedState = {
      element: g,
      isDehydrated: c,
      cache: s
    }, Hm(S), i;
  }
  function w5(i) {
    return i ? (i = Sr, i) : Sr;
  }
  function _5(i, s, c, g, b, S) {
    b = w5(b), g.context === null ? g.context = b : g.pendingContext = b, g = gs(s), g.payload = { element: c }, S = S === void 0 ? null : S, S !== null && (g.callback = S), c = ys(i, g, s), c !== null && (jr(c, i, s), Uu(c, i, s));
  }
  function S5(i, s) {
    if (i = i.memoizedState, i !== null && i.dehydrated !== null) {
      var c = i.retryLane;
      i.retryLane = c !== 0 && c < s ? c : s;
    }
  }
  function lg(i, s) {
    S5(i, s), (i = i.alternate) && S5(i, s);
  }
  function C5(i) {
    if (i.tag === 13 || i.tag === 31) {
      var s = sn(i, 67108864);
      s !== null && jr(s, i, 67108864), lg(i, 67108864);
    }
  }
  function E5(i) {
    if (i.tag === 13 || i.tag === 31) {
      var s = $r();
      s = Vs(s);
      var c = sn(i, s);
      c !== null && jr(c, i, s), lg(i, s);
    }
  }
  var Cf = !0;
  function rR(i, s, c, g) {
    var b = V.T;
    V.T = null;
    var S = ee.p;
    try {
      ee.p = 2, ug(i, s, c, g);
    } finally {
      ee.p = S, V.T = b;
    }
  }
  function iR(i, s, c, g) {
    var b = V.T;
    V.T = null;
    var S = ee.p;
    try {
      ee.p = 8, ug(i, s, c, g);
    } finally {
      ee.p = S, V.T = b;
    }
  }
  function ug(i, s, c, g) {
    if (Cf) {
      var b = cg(g);
      if (b === null)
        Xp(
          i,
          s,
          g,
          Ef,
          c
        ), N5(i, g);
      else if (sR(
        b,
        i,
        s,
        c,
        g
      ))
        g.stopPropagation();
      else if (N5(i, g), s & 4 && -1 < aR.indexOf(i)) {
        for (; b !== null; ) {
          var S = Pt(b);
          if (S !== null)
            switch (S.tag) {
              case 3:
                if (S = S.stateNode, S.current.memoizedState.isDehydrated) {
                  var z = Or(S.pendingLanes);
                  if (z !== 0) {
                    var K = S;
                    for (K.pendingLanes |= 2, K.entangledLanes |= 2; z; ) {
                      var ae = 1 << 31 - Ge(z);
                      K.entanglements[1] |= ae, z &= ~ae;
                    }
                    Gi(S), (Lt & 6) === 0 && (of = Yt() + 500, ac(0));
                  }
                }
                break;
              case 31:
              case 13:
                K = sn(S, 2), K !== null && jr(K, S, 2), uf(), lg(S, 2);
            }
          if (S = cg(g), S === null && Xp(
            i,
            s,
            g,
            Ef,
            c
          ), S === b) break;
          b = S;
        }
        b !== null && g.stopPropagation();
      } else
        Xp(
          i,
          s,
          g,
          null,
          c
        );
    }
  }
  function cg(i) {
    return i = Xo(i), dg(i);
  }
  var Ef = null;
  function dg(i) {
    if (Ef = null, i = Zr(i), i !== null) {
      var s = o(i);
      if (s === null) i = null;
      else {
        var c = s.tag;
        if (c === 13) {
          if (i = l(s), i !== null) return i;
          i = null;
        } else if (c === 31) {
          if (i = u(s), i !== null) return i;
          i = null;
        } else if (c === 3) {
          if (s.stateNode.current.memoizedState.isDehydrated)
            return s.tag === 3 ? s.stateNode.containerInfo : null;
          i = null;
        } else s !== i && (i = null);
      }
    }
    return Ef = i, null;
  }
  function k5(i) {
    switch (i) {
      case "beforetoggle":
      case "cancel":
      case "click":
      case "close":
      case "contextmenu":
      case "copy":
      case "cut":
      case "auxclick":
      case "dblclick":
      case "dragend":
      case "dragstart":
      case "drop":
      case "focusin":
      case "focusout":
      case "input":
      case "invalid":
      case "keydown":
      case "keypress":
      case "keyup":
      case "mousedown":
      case "mouseup":
      case "paste":
      case "pause":
      case "play":
      case "pointercancel":
      case "pointerdown":
      case "pointerup":
      case "ratechange":
      case "reset":
      case "resize":
      case "seeked":
      case "submit":
      case "toggle":
      case "touchcancel":
      case "touchend":
      case "touchstart":
      case "volumechange":
      case "change":
      case "selectionchange":
      case "textInput":
      case "compositionstart":
      case "compositionend":
      case "compositionupdate":
      case "beforeblur":
      case "afterblur":
      case "beforeinput":
      case "blur":
      case "fullscreenchange":
      case "focus":
      case "hashchange":
      case "popstate":
      case "select":
      case "selectstart":
        return 2;
      case "drag":
      case "dragenter":
      case "dragexit":
      case "dragleave":
      case "dragover":
      case "mousemove":
      case "mouseout":
      case "mouseover":
      case "pointermove":
      case "pointerout":
      case "pointerover":
      case "scroll":
      case "touchmove":
      case "wheel":
      case "mouseenter":
      case "mouseleave":
      case "pointerenter":
      case "pointerleave":
        return 8;
      case "message":
        switch (In()) {
          case Re:
            return 2;
          case Be:
            return 8;
          case rt:
          case dt:
            return 32;
          case xt:
            return 268435456;
          default:
            return 32;
        }
      default:
        return 32;
    }
  }
  var fg = !1, js = null, Ts = null, As = null, fc = /* @__PURE__ */ new Map(), hc = /* @__PURE__ */ new Map(), Ms = [], aR = "mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(
    " "
  );
  function N5(i, s) {
    switch (i) {
      case "focusin":
      case "focusout":
        js = null;
        break;
      case "dragenter":
      case "dragleave":
        Ts = null;
        break;
      case "mouseover":
      case "mouseout":
        As = null;
        break;
      case "pointerover":
      case "pointerout":
        fc.delete(s.pointerId);
        break;
      case "gotpointercapture":
      case "lostpointercapture":
        hc.delete(s.pointerId);
    }
  }
  function mc(i, s, c, g, b, S) {
    return i === null || i.nativeEvent !== S ? (i = {
      blockedOn: s,
      domEventName: c,
      eventSystemFlags: g,
      nativeEvent: S,
      targetContainers: [b]
    }, s !== null && (s = Pt(s), s !== null && C5(s)), i) : (i.eventSystemFlags |= g, s = i.targetContainers, b !== null && s.indexOf(b) === -1 && s.push(b), i);
  }
  function sR(i, s, c, g, b) {
    switch (s) {
      case "focusin":
        return js = mc(
          js,
          i,
          s,
          c,
          g,
          b
        ), !0;
      case "dragenter":
        return Ts = mc(
          Ts,
          i,
          s,
          c,
          g,
          b
        ), !0;
      case "mouseover":
        return As = mc(
          As,
          i,
          s,
          c,
          g,
          b
        ), !0;
      case "pointerover":
        var S = b.pointerId;
        return fc.set(
          S,
          mc(
            fc.get(S) || null,
            i,
            s,
            c,
            g,
            b
          )
        ), !0;
      case "gotpointercapture":
        return S = b.pointerId, hc.set(
          S,
          mc(
            hc.get(S) || null,
            i,
            s,
            c,
            g,
            b
          )
        ), !0;
    }
    return !1;
  }
  function j5(i) {
    var s = Zr(i.target);
    if (s !== null) {
      var c = o(s);
      if (c !== null) {
        if (s = c.tag, s === 13) {
          if (s = l(c), s !== null) {
            i.blockedOn = s, ua(i.priority, function() {
              E5(c);
            });
            return;
          }
        } else if (s === 31) {
          if (s = u(c), s !== null) {
            i.blockedOn = s, ua(i.priority, function() {
              E5(c);
            });
            return;
          }
        } else if (s === 3 && c.stateNode.current.memoizedState.isDehydrated) {
          i.blockedOn = c.tag === 3 ? c.stateNode.containerInfo : null;
          return;
        }
      }
    }
    i.blockedOn = null;
  }
  function kf(i) {
    if (i.blockedOn !== null) return !1;
    for (var s = i.targetContainers; 0 < s.length; ) {
      var c = cg(i.nativeEvent);
      if (c === null) {
        c = i.nativeEvent;
        var g = new c.constructor(
          c.type,
          c
        );
        ei = g, c.target.dispatchEvent(g), ei = null;
      } else
        return s = Pt(c), s !== null && C5(s), i.blockedOn = c, !1;
      s.shift();
    }
    return !0;
  }
  function T5(i, s, c) {
    kf(i) && c.delete(s);
  }
  function oR() {
    fg = !1, js !== null && kf(js) && (js = null), Ts !== null && kf(Ts) && (Ts = null), As !== null && kf(As) && (As = null), fc.forEach(T5), hc.forEach(T5);
  }
  function Nf(i, s) {
    i.blockedOn === s && (i.blockedOn = null, fg || (fg = !0, e.unstable_scheduleCallback(
      e.unstable_NormalPriority,
      oR
    )));
  }
  var jf = null;
  function A5(i) {
    jf !== i && (jf = i, e.unstable_scheduleCallback(
      e.unstable_NormalPriority,
      function() {
        jf === i && (jf = null);
        for (var s = 0; s < i.length; s += 3) {
          var c = i[s], g = i[s + 1], b = i[s + 2];
          if (typeof g != "function") {
            if (dg(g || c) === null)
              continue;
            break;
          }
          var S = Pt(c);
          S !== null && (i.splice(s, 3), s -= 3, cp(
            S,
            {
              pending: !0,
              data: b,
              method: c.method,
              action: g
            },
            g,
            b
          ));
        }
      }
    ));
  }
  function Dl(i) {
    function s(ae) {
      return Nf(ae, i);
    }
    js !== null && Nf(js, i), Ts !== null && Nf(Ts, i), As !== null && Nf(As, i), fc.forEach(s), hc.forEach(s);
    for (var c = 0; c < Ms.length; c++) {
      var g = Ms[c];
      g.blockedOn === i && (g.blockedOn = null);
    }
    for (; 0 < Ms.length && (c = Ms[0], c.blockedOn === null); )
      j5(c), c.blockedOn === null && Ms.shift();
    if (c = (i.ownerDocument || i).$$reactFormReplay, c != null)
      for (g = 0; g < c.length; g += 3) {
        var b = c[g], S = c[g + 1], z = b[fn] || null;
        if (typeof S == "function")
          z || A5(c);
        else if (z) {
          var K = null;
          if (S && S.hasAttribute("formAction")) {
            if (b = S, z = S[fn] || null)
              K = z.formAction;
            else if (dg(b) !== null) continue;
          } else K = z.action;
          typeof K == "function" ? c[g + 1] = K : (c.splice(g, 3), g -= 3), A5(c);
        }
      }
  }
  function M5() {
    function i(S) {
      S.canIntercept && S.info === "react-transition" && S.intercept({
        handler: function() {
          return new Promise(function(z) {
            return b = z;
          });
        },
        focusReset: "manual",
        scroll: "manual"
      });
    }
    function s() {
      b !== null && (b(), b = null), g || setTimeout(c, 20);
    }
    function c() {
      if (!g && !navigation.transition) {
        var S = navigation.currentEntry;
        S && S.url != null && navigation.navigate(S.url, {
          state: S.getState(),
          info: "react-transition",
          history: "replace"
        });
      }
    }
    if (typeof navigation == "object") {
      var g = !1, b = null;
      return navigation.addEventListener("navigate", i), navigation.addEventListener("navigatesuccess", s), navigation.addEventListener("navigateerror", s), setTimeout(c, 100), function() {
        g = !0, navigation.removeEventListener("navigate", i), navigation.removeEventListener("navigatesuccess", s), navigation.removeEventListener("navigateerror", s), b !== null && (b(), b = null);
      };
    }
  }
  function hg(i) {
    this._internalRoot = i;
  }
  Tf.prototype.render = hg.prototype.render = function(i) {
    var s = this._internalRoot;
    if (s === null) throw Error(r(409));
    var c = s.current, g = $r();
    _5(c, g, i, s, null, null);
  }, Tf.prototype.unmount = hg.prototype.unmount = function() {
    var i = this._internalRoot;
    if (i !== null) {
      this._internalRoot = null;
      var s = i.containerInfo;
      _5(i.current, 2, null, i, null, null), uf(), s[$n] = null;
    }
  };
  function Tf(i) {
    this._internalRoot = i;
  }
  Tf.prototype.unstable_scheduleHydration = function(i) {
    if (i) {
      var s = la();
      i = { blockedOn: null, target: i, priority: s };
      for (var c = 0; c < Ms.length && s !== 0 && s < Ms[c].priority; c++) ;
      Ms.splice(c, 0, i), c === 0 && j5(i);
    }
  };
  var R5 = t.version;
  if (R5 !== "19.2.3")
    throw Error(
      r(
        527,
        R5,
        "19.2.3"
      )
    );
  ee.findDOMNode = function(i) {
    var s = i._reactInternals;
    if (s === void 0)
      throw typeof i.render == "function" ? Error(r(188)) : (i = Object.keys(i).join(","), Error(r(268, i)));
    return i = d(s), i = i !== null ? m(i) : null, i = i === null ? null : i.stateNode, i;
  };
  var lR = {
    bundleType: 0,
    version: "19.2.3",
    rendererPackageName: "react-dom",
    currentDispatcherRef: V,
    reconcilerVersion: "19.2.3"
  };
  if (typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ < "u") {
    var Af = __REACT_DEVTOOLS_GLOBAL_HOOK__;
    if (!Af.isDisabled && Af.supportsFiber)
      try {
        It = Af.inject(
          lR
        ), Rt = Af;
      } catch {
      }
  }
  return gc.createRoot = function(i, s) {
    if (!a(i)) throw Error(r(299));
    var c = !1, g = "", b = P4, S = B4, z = F4;
    return s != null && (s.unstable_strictMode === !0 && (c = !0), s.identifierPrefix !== void 0 && (g = s.identifierPrefix), s.onUncaughtError !== void 0 && (b = s.onUncaughtError), s.onCaughtError !== void 0 && (S = s.onCaughtError), s.onRecoverableError !== void 0 && (z = s.onRecoverableError)), s = b5(
      i,
      1,
      !1,
      null,
      null,
      c,
      g,
      null,
      b,
      S,
      z,
      M5
    ), i[$n] = s.current, Yp(i), new hg(s);
  }, gc.hydrateRoot = function(i, s, c) {
    if (!a(i)) throw Error(r(299));
    var g = !1, b = "", S = P4, z = B4, K = F4, ae = null;
    return c != null && (c.unstable_strictMode === !0 && (g = !0), c.identifierPrefix !== void 0 && (b = c.identifierPrefix), c.onUncaughtError !== void 0 && (S = c.onUncaughtError), c.onCaughtError !== void 0 && (z = c.onCaughtError), c.onRecoverableError !== void 0 && (K = c.onRecoverableError), c.formState !== void 0 && (ae = c.formState)), s = b5(
      i,
      1,
      !0,
      s,
      c ?? null,
      g,
      b,
      ae,
      S,
      z,
      K,
      M5
    ), s.context = w5(null), c = s.current, g = $r(), g = Vs(g), b = gs(g), b.callback = null, ys(c, b, g), c = g, s.current.lanes = c, xr(s, c), Gi(s), i[$n] = s.current, Yp(i), new Tf(s);
  }, gc.version = "19.2.3", gc;
}
var $5;
function vR() {
  if ($5) return gg.exports;
  $5 = 1;
  function e() {
    if (!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ > "u" || typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE != "function"))
      try {
        __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e);
      } catch (t) {
        console.error(t);
      }
  }
  return e(), gg.exports = xR(), gg.exports;
}
var bR = vR();
const ej = /* @__PURE__ */ $s(bR), wR = () => {
  if (document.getElementById("engram-font-preload")) return;
  [
    "https://fonts.googleapis.com/css2?family=Inter:wght@200;300;400;500;600&display=swap",
    "https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500&display=swap"
  ].forEach((t, n) => {
    const r = document.createElement("link");
    r.rel = "preload", r.as = "style", r.href = t, n === 0 && (r.id = "engram-font-preload"), document.head.appendChild(r);
    const a = document.createElement("link");
    a.rel = "stylesheet", a.href = t, document.head.appendChild(a);
  });
}, _R = () => (P.useEffect(() => {
  wR();
}, []), /* @__PURE__ */ h.jsx("style", { children: `
    :root {
      --font-sans: 'Inter', system-ui, -apple-system, sans-serif;
      --font-mono: 'JetBrains Mono', monospace;
    }

    body {
      font-family: var(--font-sans);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    
    .font-mono {
      font-family: var(--font-mono);
    }
    
    /* Custom Scrollbar for dark theme - Minimalist */
    ::-webkit-scrollbar {
      width: 6px;
      height: 6px;
    }
    ::-webkit-scrollbar-track {
      background: transparent;
    }
    ::-webkit-scrollbar-thumb {
      background: rgba(63, 63, 70, 0.4); /* zinc-700 with opacity */
      border-radius: 3px;
    }
    ::-webkit-scrollbar-thumb:hover {
      background: rgba(82, 82, 91, 0.6); /* zinc-600 with opacity */
    }

    /* Animation Utilities */
    .animate-float {
      animation: float 6s ease-in-out infinite;
    }
    .animate-in {
      animation: fadeIn 0.3s ease-out forwards;
    }
    .fade-in {
      opacity: 0;
      animation: fadeIn 0.3s ease-out forwards;
    }
    
    @keyframes float {
      0% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
      100% { transform: translateY(0px); }
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(5px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Utility to hide scrollbar but keep functionality */
    .no-scrollbar::-webkit-scrollbar {
      display: none;
    }
    .no-scrollbar {
      -ms-overflow-style: none;
      scrollbar-width: none;
    }
  ` }));
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const SR = (e) => e.replace(/([a-z0-9])([A-Z])/g, "$1-$2").toLowerCase(), CR = (e) => e.replace(
  /^([A-Z])|[\s-_]+(\w)/g,
  (t, n, r) => r ? r.toUpperCase() : n.toLowerCase()
), U5 = (e) => {
  const t = CR(e);
  return t.charAt(0).toUpperCase() + t.slice(1);
}, tj = (...e) => e.filter((t, n, r) => !!t && t.trim() !== "" && r.indexOf(t) === n).join(" ").trim(), ER = (e) => {
  for (const t in e)
    if (t.startsWith("aria-") || t === "role" || t === "title")
      return !0;
};
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
var kR = {
  xmlns: "http://www.w3.org/2000/svg",
  width: 24,
  height: 24,
  viewBox: "0 0 24 24",
  fill: "none",
  stroke: "currentColor",
  strokeWidth: 2,
  strokeLinecap: "round",
  strokeLinejoin: "round"
};
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const NR = P.forwardRef(
  ({
    color: e = "currentColor",
    size: t = 24,
    strokeWidth: n = 2,
    absoluteStrokeWidth: r,
    className: a = "",
    children: o,
    iconNode: l,
    ...u
  }, f) => P.createElement(
    "svg",
    {
      ref: f,
      ...kR,
      width: t,
      height: t,
      stroke: e,
      strokeWidth: r ? Number(n) * 24 / Number(t) : n,
      className: tj("lucide", a),
      ...!o && !ER(u) && { "aria-hidden": "true" },
      ...u
    },
    [
      ...l.map(([d, m]) => P.createElement(d, m)),
      ...Array.isArray(o) ? o : [o]
    ]
  )
);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Ze = (e, t) => {
  const n = P.forwardRef(
    ({ className: r, ...a }, o) => P.createElement(NR, {
      ref: o,
      iconNode: t,
      className: tj(
        `lucide-${SR(U5(e))}`,
        `lucide-${e}`,
        r
      ),
      ...a
    })
  );
  return n.displayName = U5(e), n;
};
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const jR = [
  ["path", { d: "M12 17V3", key: "1cwfxf" }],
  ["path", { d: "m6 11 6 6 6-6", key: "12ii2o" }],
  ["path", { d: "M19 21H5", key: "150jfl" }]
], TR = Ze("arrow-down-to-line", jR);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const AR = [
  ["path", { d: "m12 19-7-7 7-7", key: "1l729n" }],
  ["path", { d: "M19 12H5", key: "x3x0zl" }]
], p2 = Ze("arrow-left", AR);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const MR = [
  ["path", { d: "M10.268 21a2 2 0 0 0 3.464 0", key: "vwvbt9" }],
  [
    "path",
    {
      d: "M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",
      key: "11g9vi"
    }
  ]
], RR = Ze("bell", MR);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const zR = [
  ["path", { d: "M12 7v14", key: "1akyts" }],
  [
    "path",
    {
      d: "M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",
      key: "ruj8y"
    }
  ]
], OR = Ze("book-open", zR);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const DR = [
  [
    "path",
    {
      d: "M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",
      key: "k3hazp"
    }
  ]
], IR = Ze("book", DR);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const LR = [
  ["path", { d: "M12 8V4H8", key: "hb8ula" }],
  ["rect", { width: "16", height: "12", x: "4", y: "8", rx: "2", key: "enze0r" }],
  ["path", { d: "M2 14h2", key: "vft8re" }],
  ["path", { d: "M20 14h2", key: "4cs60a" }],
  ["path", { d: "M15 13v2", key: "1xurst" }],
  ["path", { d: "M9 13v2", key: "rq6x2g" }]
], nj = Ze("bot", LR);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const qR = [
  [
    "path",
    { d: "M8 3H7a2 2 0 0 0-2 2v5a2 2 0 0 1-2 2 2 2 0 0 1 2 2v5c0 1.1.9 2 2 2h1", key: "ezmyqa" }
  ],
  [
    "path",
    {
      d: "M16 21h1a2 2 0 0 0 2-2v-5c0-1.1.9-2 2-2a2 2 0 0 1-2-2V5a2 2 0 0 0-2-2h-1",
      key: "e1hn23"
    }
  ]
], rj = Ze("braces", qR);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const PR = [
  [
    "path",
    {
      d: "M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",
      key: "l5xja"
    }
  ],
  ["path", { d: "M9 13a4.5 4.5 0 0 0 3-4", key: "10igwf" }],
  ["path", { d: "M6.003 5.125A3 3 0 0 0 6.401 6.5", key: "105sqy" }],
  ["path", { d: "M3.477 10.896a4 4 0 0 1 .585-.396", key: "ql3yin" }],
  ["path", { d: "M6 18a4 4 0 0 1-1.967-.516", key: "2e4loj" }],
  ["path", { d: "M12 13h4", key: "1ku699" }],
  ["path", { d: "M12 18h6a2 2 0 0 1 2 2v1", key: "105ag5" }],
  ["path", { d: "M12 8h8", key: "1lhi5i" }],
  ["path", { d: "M16 8V5a2 2 0 0 1 2-2", key: "u6izg6" }],
  ["circle", { cx: "16", cy: "13", r: ".5", key: "ry7gng" }],
  ["circle", { cx: "18", cy: "3", r: ".5", key: "1aiba7" }],
  ["circle", { cx: "20", cy: "21", r: ".5", key: "yhc1fs" }],
  ["circle", { cx: "20", cy: "8", r: ".5", key: "1e43v0" }]
], BR = Ze("brain-circuit", PR);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const FR = [
  ["path", { d: "M12 18V5", key: "adv99a" }],
  ["path", { d: "M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4", key: "1e3is1" }],
  ["path", { d: "M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5", key: "1gqd8o" }],
  ["path", { d: "M17.997 5.125a4 4 0 0 1 2.526 5.77", key: "iwvgf7" }],
  ["path", { d: "M18 18a4 4 0 0 0 2-7.464", key: "efp6ie" }],
  ["path", { d: "M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517", key: "1gq6am" }],
  ["path", { d: "M6 18a4 4 0 0 1-2-7.464", key: "k1g0md" }],
  ["path", { d: "M6.003 5.125a4 4 0 0 0-2.526 5.77", key: "q97ue3" }]
], ij = Ze("brain", FR);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const $R = [
  ["path", { d: "M12 20v-9", key: "1qisl0" }],
  ["path", { d: "M14 7a4 4 0 0 1 4 4v3a6 6 0 0 1-12 0v-3a4 4 0 0 1 4-4z", key: "uouzyp" }],
  ["path", { d: "M14.12 3.88 16 2", key: "qol33r" }],
  ["path", { d: "M21 21a4 4 0 0 0-3.81-4", key: "1b0z45" }],
  ["path", { d: "M21 5a4 4 0 0 1-3.55 3.97", key: "5cxbf6" }],
  ["path", { d: "M22 13h-4", key: "1jl80f" }],
  ["path", { d: "M3 21a4 4 0 0 1 3.81-4", key: "1fjd4g" }],
  ["path", { d: "M3 5a4 4 0 0 0 3.55 3.97", key: "1d7oge" }],
  ["path", { d: "M6 13H2", key: "82j7cp" }],
  ["path", { d: "m8 2 1.88 1.88", key: "fmnt4t" }],
  ["path", { d: "M9 7.13V6a3 3 0 1 1 6 0v1.13", key: "1vgav8" }]
], UR = Ze("bug", $R);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const HR = [
  ["rect", { width: "16", height: "20", x: "4", y: "2", rx: "2", key: "1nb95v" }],
  ["line", { x1: "8", x2: "16", y1: "6", y2: "6", key: "x4nwl0" }],
  ["line", { x1: "16", x2: "16", y1: "14", y2: "18", key: "wjye3r" }],
  ["path", { d: "M16 10h.01", key: "1m94wz" }],
  ["path", { d: "M12 10h.01", key: "1nrarc" }],
  ["path", { d: "M8 10h.01", key: "19clt8" }],
  ["path", { d: "M12 14h.01", key: "1etili" }],
  ["path", { d: "M8 14h.01", key: "6423bh" }],
  ["path", { d: "M12 18h.01", key: "mhygvu" }],
  ["path", { d: "M8 18h.01", key: "lrp35t" }]
], GR = Ze("calculator", HR);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const VR = [["path", { d: "M20 6 9 17l-5-5", key: "1gmf2c" }]], zh = Ze("check", VR);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const KR = [["path", { d: "m6 9 6 6 6-6", key: "qrunsl" }]], Ro = Ze("chevron-down", KR);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const YR = [["path", { d: "m9 18 6-6-6-6", key: "mthhwq" }]], lu = Ze("chevron-right", YR);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const XR = [
  ["circle", { cx: "12", cy: "12", r: "10", key: "1mglay" }],
  ["line", { x1: "12", x2: "12", y1: "8", y2: "12", key: "1pkeuh" }],
  ["line", { x1: "12", x2: "12.01", y1: "16", y2: "16", key: "4dfq90" }]
], Fs = Ze("circle-alert", XR);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const WR = [
  ["path", { d: "M21.801 10A10 10 0 1 1 17 3.335", key: "yps3ct" }],
  ["path", { d: "m9 11 3 3L22 4", key: "1pflzl" }]
], g2 = Ze("circle-check-big", WR);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const QR = [
  ["circle", { cx: "12", cy: "12", r: "10", key: "1mglay" }],
  ["path", { d: "m9 12 2 2 4-4", key: "dzmm74" }]
], Oh = Ze("circle-check", QR);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const ZR = [
  ["circle", { cx: "12", cy: "12", r: "10", key: "1mglay" }],
  ["path", { d: "m15 9-6 6", key: "1uzhvr" }],
  ["path", { d: "m9 9 6 6", key: "z0biqf" }]
], JR = Ze("circle-x", ZR);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const ez = [
  ["path", { d: "M12 6v6l4 2", key: "mmk7yg" }],
  ["circle", { cx: "12", cy: "12", r: "10", key: "1mglay" }]
], lh = Ze("clock", ez);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const tz = [
  ["path", { d: "M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z", key: "p7xjir" }]
], nz = Ze("cloud", tz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const rz = [
  [
    "path",
    { d: "M15 6v12a3 3 0 1 0 3-3H6a3 3 0 1 0 3 3V6a3 3 0 1 0-3 3h12a3 3 0 1 0-3-3", key: "11bfej" }
  ]
], H5 = Ze("command", rz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const iz = [
  ["rect", { width: "14", height: "14", x: "8", y: "8", rx: "2", ry: "2", key: "17jyea" }],
  ["path", { d: "M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2", key: "zix9uf" }]
], y2 = Ze("copy", iz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const az = [
  ["path", { d: "M20 4v7a4 4 0 0 1-4 4H4", key: "6o5b7l" }],
  ["path", { d: "m9 10-5 5 5 5", key: "1kshq7" }]
], G5 = Ze("corner-down-left", az);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const sz = [
  ["path", { d: "M12 20v2", key: "1lh1kg" }],
  ["path", { d: "M12 2v2", key: "tus03m" }],
  ["path", { d: "M17 20v2", key: "1rnc9c" }],
  ["path", { d: "M17 2v2", key: "11trls" }],
  ["path", { d: "M2 12h2", key: "1t8f8n" }],
  ["path", { d: "M2 17h2", key: "7oei6x" }],
  ["path", { d: "M2 7h2", key: "asdhe0" }],
  ["path", { d: "M20 12h2", key: "1q8mjw" }],
  ["path", { d: "M20 17h2", key: "1fpfkl" }],
  ["path", { d: "M20 7h2", key: "1o8tra" }],
  ["path", { d: "M7 20v2", key: "4gnj0m" }],
  ["path", { d: "M7 2v2", key: "1i4yhu" }],
  ["rect", { x: "4", y: "4", width: "16", height: "16", rx: "2", key: "1vbyd7" }],
  ["rect", { x: "8", y: "8", width: "8", height: "8", rx: "1", key: "z9xiuo" }]
], x2 = Ze("cpu", sz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const oz = [
  ["ellipse", { cx: "12", cy: "5", rx: "9", ry: "3", key: "msslwz" }],
  ["path", { d: "M3 5V19A9 3 0 0 0 21 19V5", key: "1wlel7" }],
  ["path", { d: "M3 12A9 3 0 0 0 21 12", key: "mv7ke4" }]
], Dh = Ze("database", oz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const lz = [
  ["path", { d: "M12 15V3", key: "m9g1x1" }],
  ["path", { d: "M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4", key: "ih7n3h" }],
  ["path", { d: "m7 10 5 5 5-5", key: "brsn70" }]
], Dc = Ze("download", lz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const uz = [
  ["path", { d: "M15 3h6v6", key: "1q9fwt" }],
  ["path", { d: "M10 14 21 3", key: "gplh6r" }],
  ["path", { d: "M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6", key: "a6xqqp" }]
], cz = Ze("external-link", uz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const dz = [
  [
    "path",
    {
      d: "M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",
      key: "1nclc0"
    }
  ],
  ["circle", { cx: "12", cy: "12", r: "3", key: "1v7zrd" }]
], V5 = Ze("eye", dz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const fz = [
  [
    "path",
    {
      d: "M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",
      key: "1oefj6"
    }
  ],
  ["path", { d: "M14 2v5a1 1 0 0 0 1 1h5", key: "wfsgrz" }],
  ["path", { d: "M10 9H8", key: "b1mrlr" }],
  ["path", { d: "M16 13H8", key: "t4e002" }],
  ["path", { d: "M16 17H8", key: "z1uh3a" }]
], uu = Ze("file-text", fz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const hz = [
  [
    "path",
    {
      d: "M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",
      key: "sc7q7i"
    }
  ]
], mz = Ze("funnel", hz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const pz = [
  ["line", { x1: "6", x2: "6", y1: "3", y2: "15", key: "17qcm7" }],
  ["circle", { cx: "18", cy: "6", r: "3", key: "1h7g24" }],
  ["circle", { cx: "6", cy: "18", r: "3", key: "fqmcym" }],
  ["path", { d: "M18 9a9 9 0 0 1-9 9", key: "n2h4wq" }]
], gz = Ze("git-branch", pz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const yz = [
  [
    "path",
    {
      d: "M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",
      key: "tonef"
    }
  ],
  ["path", { d: "M9 18c-4.51 2-5-2-7-2", key: "9comsn" }]
], xz = Ze("github", yz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const vz = [
  ["circle", { cx: "9", cy: "12", r: "1", key: "1vctgf" }],
  ["circle", { cx: "9", cy: "5", r: "1", key: "hp0tcf" }],
  ["circle", { cx: "9", cy: "19", r: "1", key: "fkjjf6" }],
  ["circle", { cx: "15", cy: "12", r: "1", key: "1tmaij" }],
  ["circle", { cx: "15", cy: "5", r: "1", key: "19l28e" }],
  ["circle", { cx: "15", cy: "19", r: "1", key: "f4zoj3" }]
], bz = Ze("grip-vertical", vz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const wz = [
  ["line", { x1: "4", x2: "20", y1: "9", y2: "9", key: "4lhtct" }],
  ["line", { x1: "4", x2: "20", y1: "15", y2: "15", key: "vyu0kd" }],
  ["line", { x1: "10", x2: "8", y1: "3", y2: "21", key: "1ggp8o" }],
  ["line", { x1: "16", x2: "14", y1: "3", y2: "21", key: "weycgp" }]
], _z = Ze("hash", wz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Sz = [
  ["path", { d: "M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8", key: "5wwlr5" }],
  [
    "path",
    {
      d: "M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",
      key: "r6nss1"
    }
  ]
], Cz = Ze("house", Sz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Ez = [
  ["circle", { cx: "12", cy: "12", r: "10", key: "1mglay" }],
  ["path", { d: "M12 16v-4", key: "1dtifu" }],
  ["path", { d: "M12 8h.01", key: "e9boi3" }]
], kz = Ze("info", Ez);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Nz = [
  ["path", { d: "m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4", key: "g0fldk" }],
  ["path", { d: "m21 2-9.6 9.6", key: "1j0ho8" }],
  ["circle", { cx: "7.5", cy: "15.5", r: "5.5", key: "yqb3hr" }]
], Ih = Ze("key", Nz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const jz = [
  [
    "path",
    {
      d: "M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",
      key: "zw3jo"
    }
  ],
  [
    "path",
    {
      d: "M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",
      key: "1wduqc"
    }
  ],
  [
    "path",
    {
      d: "M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",
      key: "kqbvx6"
    }
  ]
], v2 = Ze("layers", jz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Tz = [
  ["rect", { width: "7", height: "9", x: "3", y: "3", rx: "1", key: "10lvy0" }],
  ["rect", { width: "7", height: "5", x: "14", y: "3", rx: "1", key: "16une8" }],
  ["rect", { width: "7", height: "9", x: "14", y: "12", rx: "1", key: "1hutg5" }],
  ["rect", { width: "7", height: "5", x: "3", y: "16", rx: "1", key: "ldoo1y" }]
], Az = Ze("layout-dashboard", Tz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Mz = [
  ["rect", { width: "7", height: "7", x: "3", y: "3", rx: "1", key: "1g98yp" }],
  ["rect", { width: "7", height: "7", x: "14", y: "3", rx: "1", key: "6d4xhi" }],
  ["rect", { width: "7", height: "7", x: "14", y: "14", rx: "1", key: "nxv5o0" }],
  ["rect", { width: "7", height: "7", x: "3", y: "14", rx: "1", key: "1bb6yr" }]
], Rz = Ze("layout-grid", Mz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const zz = [
  ["path", { d: "M8 5h13", key: "1pao27" }],
  ["path", { d: "M13 12h8", key: "h98zly" }],
  ["path", { d: "M13 19h8", key: "c3s6r1" }],
  ["path", { d: "M3 10a2 2 0 0 0 2 2h3", key: "1npucw" }],
  ["path", { d: "M3 5v12a2 2 0 0 0 2 2h3", key: "x1gjn2" }]
], Oz = Ze("list-tree", zz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Dz = [
  ["path", { d: "M3 5h.01", key: "18ugdj" }],
  ["path", { d: "M3 12h.01", key: "nlz23k" }],
  ["path", { d: "M3 19h.01", key: "noohij" }],
  ["path", { d: "M8 5h13", key: "1pao27" }],
  ["path", { d: "M8 12h13", key: "1za7za" }],
  ["path", { d: "M8 19h13", key: "m83p4d" }]
], Iz = Ze("list", Dz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Lz = [["path", { d: "M21 12a9 9 0 1 1-6.219-8.56", key: "13zald" }]], Ka = Ze("loader-circle", Lz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const qz = [
  ["path", { d: "M4 5h16", key: "1tepv9" }],
  ["path", { d: "M4 12h16", key: "1lakjw" }],
  ["path", { d: "M4 19h16", key: "1djgab" }]
], Pz = Ze("menu", qz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Bz = [
  [
    "path",
    {
      d: "M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",
      key: "18887p"
    }
  ]
], Fz = Ze("message-square", Bz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const $z = [
  [
    "path",
    {
      d: "M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",
      key: "kfwtm"
    }
  ]
], K5 = Ze("moon", $z);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Uz = [
  ["rect", { x: "16", y: "16", width: "6", height: "6", rx: "1", key: "4q2zg0" }],
  ["rect", { x: "2", y: "16", width: "6", height: "6", rx: "1", key: "8cvhb9" }],
  ["rect", { x: "9", y: "2", width: "6", height: "6", rx: "1", key: "1egb70" }],
  ["path", { d: "M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3", key: "1jsf9p" }],
  ["path", { d: "M12 12V8", key: "2874zd" }]
], aj = Ze("network", Uz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Hz = [
  [
    "path",
    {
      d: "M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",
      key: "e79jfc"
    }
  ],
  ["circle", { cx: "13.5", cy: "6.5", r: ".5", fill: "currentColor", key: "1okk4w" }],
  ["circle", { cx: "17.5", cy: "10.5", r: ".5", fill: "currentColor", key: "f64h9f" }],
  ["circle", { cx: "6.5", cy: "12.5", r: ".5", fill: "currentColor", key: "qy21gx" }],
  ["circle", { cx: "8.5", cy: "7.5", r: ".5", fill: "currentColor", key: "fotxhn" }]
], Y5 = Ze("palette", Hz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Gz = [
  ["rect", { x: "14", y: "3", width: "5", height: "18", rx: "1", key: "kaeet6" }],
  ["rect", { x: "5", y: "3", width: "5", height: "18", rx: "1", key: "1wsw3u" }]
], sj = Ze("pause", Gz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Vz = [
  [
    "path",
    {
      d: "M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",
      key: "1a8usu"
    }
  ]
], Kz = Ze("pen", Vz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Yz = [
  [
    "path",
    {
      d: "M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",
      key: "10ikf1"
    }
  ]
], Uc = Ze("play", Yz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Xz = [
  ["path", { d: "M5 12h14", key: "1ays0h" }],
  ["path", { d: "M12 5v14", key: "s699le" }]
], b2 = Ze("plus", Xz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Wz = [
  ["path", { d: "M12 2v10", key: "mnfbl" }],
  ["path", { d: "M18.4 6.6a9 9 0 1 1-12.77.04", key: "obofu9" }]
], Lh = Ze("power", Wz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Qz = [
  ["path", { d: "M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8", key: "v9h5vc" }],
  ["path", { d: "M21 3v5h-5", key: "1q7to0" }],
  ["path", { d: "M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16", key: "3uifl3" }],
  ["path", { d: "M8 16H3v5", key: "1cv678" }]
], zn = Ze("refresh-cw", Qz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Zz = [
  ["path", { d: "M17 3v10", key: "15fgeh" }],
  ["path", { d: "m12.67 5.5 8.66 5", key: "1gpheq" }],
  ["path", { d: "m12.67 10.5 8.66-5", key: "1dkfa6" }],
  [
    "path",
    { d: "M9 17a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h2a2 2 0 0 0 2-2v-2z", key: "swwfx4" }
  ]
], oj = Ze("regex", Zz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Jz = [
  ["path", { d: "M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8", key: "1357e3" }],
  ["path", { d: "M3 3v5h5", key: "1xhq8a" }]
], lj = Ze("rotate-ccw", Jz);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const eO = [
  [
    "path",
    {
      d: "M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",
      key: "1c8476"
    }
  ],
  ["path", { d: "M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7", key: "1ydtos" }],
  ["path", { d: "M7 3v4a1 1 0 0 0 1 1h7", key: "t51u73" }]
], Tc = Ze("save", eO);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const tO = [
  ["circle", { cx: "6", cy: "6", r: "3", key: "1lh9wr" }],
  ["path", { d: "M8.12 8.12 12 12", key: "1alkpv" }],
  ["path", { d: "M20 4 8.12 15.88", key: "xgtan2" }],
  ["circle", { cx: "6", cy: "18", r: "3", key: "fqmcym" }],
  ["path", { d: "M14.8 14.8 20 20", key: "ptml3r" }]
], nO = Ze("scissors", tO);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const rO = [
  ["path", { d: "M15 12h-5", key: "r7krc0" }],
  ["path", { d: "M15 8h-5", key: "1khuty" }],
  ["path", { d: "M19 17V5a2 2 0 0 0-2-2H4", key: "zz82l3" }],
  [
    "path",
    {
      d: "M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",
      key: "1ph1d7"
    }
  ]
], iO = Ze("scroll-text", rO);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const aO = [
  ["path", { d: "m21 21-4.34-4.34", key: "14j7rj" }],
  ["circle", { cx: "11", cy: "11", r: "8", key: "4ej97u" }]
], hi = Ze("search", aO);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const sO = [
  [
    "path",
    {
      d: "M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",
      key: "1ffxy3"
    }
  ],
  ["path", { d: "m21.854 2.147-10.94 10.939", key: "12cjpa" }]
], oO = Ze("send", sO);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const lO = [
  ["rect", { width: "20", height: "8", x: "2", y: "2", rx: "2", ry: "2", key: "ngkwjq" }],
  ["rect", { width: "20", height: "8", x: "2", y: "14", rx: "2", ry: "2", key: "iecqi9" }],
  ["line", { x1: "6", x2: "6.01", y1: "6", y2: "6", key: "16zg32" }],
  ["line", { x1: "6", x2: "6.01", y1: "18", y2: "18", key: "nzw8ys" }]
], uO = Ze("server", lO);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const cO = [
  [
    "path",
    {
      d: "M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",
      key: "1i5ecw"
    }
  ],
  ["circle", { cx: "12", cy: "12", r: "3", key: "1v7zrd" }]
], uh = Ze("settings", cO);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const dO = [
  ["path", { d: "M10 8h4", key: "1sr2af" }],
  ["path", { d: "M12 21v-9", key: "17s77i" }],
  ["path", { d: "M12 8V3", key: "13r4qs" }],
  ["path", { d: "M17 16h4", key: "h1uq16" }],
  ["path", { d: "M19 12V3", key: "o1uvq1" }],
  ["path", { d: "M19 21v-5", key: "qua636" }],
  ["path", { d: "M3 14h4", key: "bcjad9" }],
  ["path", { d: "M5 10V3", key: "cb8scm" }],
  ["path", { d: "M5 21v-7", key: "1w1uti" }]
], X5 = Ze("sliders-vertical", dO);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const fO = [
  [
    "path",
    {
      d: "M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",
      key: "1s2grr"
    }
  ],
  ["path", { d: "M20 2v4", key: "1rf3ol" }],
  ["path", { d: "M22 4h-4", key: "gwowj6" }],
  ["circle", { cx: "4", cy: "20", r: "2", key: "6kqj1y" }]
], uj = Ze("sparkles", fO);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const hO = [
  ["rect", { width: "18", height: "18", x: "3", y: "3", rx: "2", key: "afitv7" }]
], cj = Ze("square", hO);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const mO = [
  ["circle", { cx: "12", cy: "12", r: "4", key: "4exip2" }],
  ["path", { d: "M12 2v2", key: "tus03m" }],
  ["path", { d: "M12 20v2", key: "1lh1kg" }],
  ["path", { d: "m4.93 4.93 1.41 1.41", key: "149t6j" }],
  ["path", { d: "m17.66 17.66 1.41 1.41", key: "ptbguv" }],
  ["path", { d: "M2 12h2", key: "1t8f8n" }],
  ["path", { d: "M20 12h2", key: "1q8mjw" }],
  ["path", { d: "m6.34 17.66-1.41 1.41", key: "1m8zz5" }],
  ["path", { d: "m19.07 4.93-1.41 1.41", key: "1shlcs" }]
], pO = Ze("sun", mO);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const gO = [
  ["circle", { cx: "12", cy: "12", r: "10", key: "1mglay" }],
  ["circle", { cx: "12", cy: "12", r: "6", key: "1vlfrh" }],
  ["circle", { cx: "12", cy: "12", r: "2", key: "1c9p78" }]
], w2 = Ze("target", gO);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const yO = [
  ["path", { d: "M12 19h8", key: "baeox8" }],
  ["path", { d: "m4 17 6-6-6-6", key: "1yngyt" }]
], qh = Ze("terminal", yO);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const xO = [
  ["path", { d: "M10 11v6", key: "nco0om" }],
  ["path", { d: "M14 11v6", key: "outv1u" }],
  ["path", { d: "M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6", key: "miytrc" }],
  ["path", { d: "M3 6h18", key: "d0wm0j" }],
  ["path", { d: "M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2", key: "e791ji" }]
], Ri = Ze("trash-2", xO);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const vO = [
  [
    "path",
    {
      d: "m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",
      key: "wmoenq"
    }
  ],
  ["path", { d: "M12 9v4", key: "juzpu7" }],
  ["path", { d: "M12 17h.01", key: "p32p05" }]
], dj = Ze("triangle-alert", vO);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const bO = [
  ["path", { d: "M12 3v12", key: "1x0j5s" }],
  ["path", { d: "m17 8-5-5-5 5", key: "7q97r8" }],
  ["path", { d: "M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4", key: "ih7n3h" }]
], fj = Ze("upload", bO);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const wO = [
  [
    "path",
    {
      d: "m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",
      key: "ul74o6"
    }
  ],
  ["path", { d: "m14 7 3 3", key: "1r5n42" }],
  ["path", { d: "M5 6v4", key: "ilb8ba" }],
  ["path", { d: "M19 14v4", key: "blhpug" }],
  ["path", { d: "M10 2v2", key: "7u0qdc" }],
  ["path", { d: "M7 8H3", key: "zfb6yr" }],
  ["path", { d: "M21 16h-4", key: "1cnmox" }],
  ["path", { d: "M11 3H9", key: "1obp7u" }]
], hj = Ze("wand-sparkles", wO);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const _O = [
  ["path", { d: "M18 6 6 18", key: "1bl5f8" }],
  ["path", { d: "m6 6 12 12", key: "d8bk6v" }]
], cu = Ze("x", _O);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const SO = [
  [
    "path",
    {
      d: "M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",
      key: "1xq2db"
    }
  ]
], Po = Ze("zap", SO);
var mj = JN();
const _2 = /* @__PURE__ */ $s(mj);
class CO {
  constructor() {
    nt(this, "adapters", []);
  }
  registerAdapter(t) {
    this.adapters.push(t);
  }
  async search(t) {
    return t.trim() ? (await Promise.all(this.adapters.map((r) => r.search(t)))).flat().sort((r, a) => (a.score || 0) - (r.score || 0)) : [];
  }
}
const Ul = new CO(), EO = [
  // Sub-view Navigation (Deep Links)
  // These are NOT in the main sidebar, so we keep them here.
  {
    id: "nav-prompt",
    icon: uh,
    label: "",
    description: " Prompt ",
    action: (e) => e("presets:prompt"),
    keywords: ["prompt", "template", "", ""],
    type: "navigation"
  },
  {
    id: "nav-regex",
    icon: uh,
    label: "",
    description: " Regex ",
    action: (e) => e("presets:regex"),
    keywords: ["regex", "rule", "", ""],
    type: "navigation"
  },
  {
    id: "nav-worldbook",
    icon: Cz,
    label: "",
    description: " World Info  Lorebook",
    action: (e) => e("presets:worldbook"),
    keywords: ["world", "book", "lore", ""],
    type: "navigation"
  }
], ch = [
  { id: "dashboard", icon: Az, label: "", path: "/dashboard" },
  { id: "memory", icon: Oz, label: "", path: "/memory" },
  { id: "processing", icon: x2, label: "", path: "/processing" },
  { id: "presets", icon: Ih, label: "API ", path: "/presets" },
  { id: "devlog", icon: qh, label: "", path: "/devlog" },
  { id: "settings", icon: uh, label: "", path: "/settings" }
], kO = {}, W5 = (e) => {
  let t;
  const n = /* @__PURE__ */ new Set(), r = (m, p) => {
    const x = typeof m == "function" ? m(t) : m;
    if (!Object.is(x, t)) {
      const y = t;
      t = p ?? (typeof x != "object" || x === null) ? x : Object.assign({}, t, x), n.forEach((w) => w(t, y));
    }
  }, a = () => t, f = { setState: r, getState: a, getInitialState: () => d, subscribe: (m) => (n.add(m), () => n.delete(m)), destroy: () => {
    (kO ? "production" : void 0) !== "production" && console.warn(
      "[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."
    ), n.clear();
  } }, d = t = e(r, a, f);
  return f;
}, pj = (e) => e ? W5(e) : W5;
var bg = { exports: {} }, wg = {}, _g = { exports: {} }, Sg = {};
/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var Q5;
function NO() {
  if (Q5) return Sg;
  Q5 = 1;
  var e = id();
  function t(p, x) {
    return p === x && (p !== 0 || 1 / p === 1 / x) || p !== p && x !== x;
  }
  var n = typeof Object.is == "function" ? Object.is : t, r = e.useState, a = e.useEffect, o = e.useLayoutEffect, l = e.useDebugValue;
  function u(p, x) {
    var y = x(), w = r({ inst: { value: y, getSnapshot: x } }), E = w[0].inst, k = w[1];
    return o(
      function() {
        E.value = y, E.getSnapshot = x, f(E) && k({ inst: E });
      },
      [p, y, x]
    ), a(
      function() {
        return f(E) && k({ inst: E }), p(function() {
          f(E) && k({ inst: E });
        });
      },
      [p]
    ), l(y), y;
  }
  function f(p) {
    var x = p.getSnapshot;
    p = p.value;
    try {
      var y = x();
      return !n(p, y);
    } catch {
      return !0;
    }
  }
  function d(p, x) {
    return x();
  }
  var m = typeof window > "u" || typeof window.document > "u" || typeof window.document.createElement > "u" ? d : u;
  return Sg.useSyncExternalStore = e.useSyncExternalStore !== void 0 ? e.useSyncExternalStore : m, Sg;
}
var Z5;
function jO() {
  return Z5 || (Z5 = 1, _g.exports = NO()), _g.exports;
}
/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var J5;
function TO() {
  if (J5) return wg;
  J5 = 1;
  var e = id(), t = jO();
  function n(d, m) {
    return d === m && (d !== 0 || 1 / d === 1 / m) || d !== d && m !== m;
  }
  var r = typeof Object.is == "function" ? Object.is : n, a = t.useSyncExternalStore, o = e.useRef, l = e.useEffect, u = e.useMemo, f = e.useDebugValue;
  return wg.useSyncExternalStoreWithSelector = function(d, m, p, x, y) {
    var w = o(null);
    if (w.current === null) {
      var E = { hasValue: !1, value: null };
      w.current = E;
    } else E = w.current;
    w = u(
      function() {
        function C(M) {
          if (!T) {
            if (T = !0, N = M, M = x(M), y !== void 0 && E.hasValue) {
              var O = E.value;
              if (y(O, M))
                return A = O;
            }
            return A = M;
          }
          if (O = A, r(N, M)) return O;
          var Y = x(M);
          return y !== void 0 && y(O, Y) ? (N = M, O) : (N = M, A = Y);
        }
        var T = !1, N, A, D = p === void 0 ? null : p;
        return [
          function() {
            return C(m());
          },
          D === null ? void 0 : function() {
            return C(D());
          }
        ];
      },
      [m, p, x, y]
    );
    var k = a(d, w[0], w[1]);
    return l(
      function() {
        E.hasValue = !0, E.value = k;
      },
      [k]
    ), f(k), k;
  }, wg;
}
var e_;
function AO() {
  return e_ || (e_ = 1, bg.exports = TO()), bg.exports;
}
var MO = AO();
const gj = /* @__PURE__ */ $s(MO), yj = {}, { useDebugValue: RO } = m2, { useSyncExternalStoreWithSelector: zO } = gj;
let t_ = !1;
const OO = (e) => e;
function DO(e, t = OO, n) {
  (yj ? "production" : void 0) !== "production" && n && !t_ && (console.warn(
    "[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"
  ), t_ = !0);
  const r = zO(
    e.subscribe,
    e.getState,
    e.getServerState || e.getInitialState,
    t,
    n
  );
  return RO(r), r;
}
const n_ = (e) => {
  (yj ? "production" : void 0) !== "production" && typeof e != "function" && console.warn(
    "[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`."
  );
  const t = typeof e == "function" ? pj(e) : e, n = (r, a) => DO(t, r, a);
  return Object.assign(n, t), n;
}, xj = (e) => e ? n_(e) : n_, IO = {
  name: "Paper (Light)",
  colors: {
    background: "oklch(1.0000 0 0)",
    foreground: "oklch(0.1884 0.0128 248.5103)",
    card: "oklch(0.9784 0.0011 197.1387)",
    cardForeground: "oklch(0.1884 0.0128 248.5103)",
    popover: "oklch(1.0000 0 0)",
    popoverForeground: "oklch(0.1884 0.0128 248.5103)",
    primary: "oklch(0.6723 0.1606 244.9955)",
    primaryForeground: "oklch(1.0000 0 0)",
    secondary: "oklch(0.1884 0.0128 248.5103)",
    secondaryForeground: "oklch(1.0000 0 0)",
    muted: "oklch(0.9222 0.0013 286.3737)",
    mutedForeground: "oklch(0.1884 0.0128 248.5103)",
    accent: "oklch(0.9392 0.0166 250.8453)",
    accentForeground: "oklch(0.6723 0.1606 244.9955)",
    destructive: "oklch(0.6188 0.2376 25.7658)",
    destructiveForeground: "oklch(1.0000 0 0)",
    border: "oklch(0.1884 0.0128 248.5103 / 0.15)",
    // Darker (Foreground based) as requested
    input: "oklch(0.9809 0.0025 228.7836)",
    ring: "oklch(0.6818 0.1584 243.3540)",
    chart1: "oklch(0.6723 0.1606 244.9955)",
    chart2: "oklch(0.6907 0.1554 160.3454)",
    chart3: "oklch(0.8214 0.1600 82.5337)",
    chart4: "oklch(0.7064 0.1822 151.7125)",
    chart5: "oklch(0.5919 0.2186 10.5826)",
    sidebar: "oklch(0.9784 0.0011 197.1387)",
    sidebarForeground: "oklch(0.1884 0.0128 248.5103)",
    sidebarPrimary: "oklch(0.6723 0.1606 244.9955)",
    sidebarPrimaryForeground: "oklch(1.0000 0 0)",
    sidebarAccent: "oklch(0.9392 0.0166 250.8453)",
    sidebarAccentForeground: "oklch(0.6723 0.1606 244.9955)",
    sidebarBorder: "oklch(0.1884 0.0128 248.5103 / 0.1)",
    // Darker (Foreground based)
    sidebarRing: "oklch(0.6818 0.1584 243.3540)"
  },
  variables: {
    radius: "1.3rem"
  }
}, LO = {
  name: "Claude (Dark)",
  colors: {
    background: "oklch(0.2679 0.0036 106.6427)",
    foreground: "oklch(0.8074 0.0142 93.0137)",
    card: "oklch(0.2679 0.0036 106.6427)",
    cardForeground: "oklch(0.8074 0.0142 93.0137)",
    popover: "oklch(0.2357 0.0024 67.7077)",
    popoverForeground: "oklch(0.8074 0.0142 93.0137)",
    primary: "oklch(0.6724 0.1308 38.7559)",
    primaryForeground: "oklch(1.0000 0 0)",
    secondary: "oklch(0.2213 0.0038 106.7070)",
    secondaryForeground: "oklch(0.8074 0.0142 93.0137)",
    muted: "oklch(0.2357 0.0024 67.7077)",
    mutedForeground: "oklch(0.7713 0.0169 99.0657)",
    accent: "oklch(0.6724 0.1308 38.7559)",
    accentForeground: "oklch(1.0000 0 0)",
    destructive: "oklch(0.6368 0.2078 25.3313)",
    destructiveForeground: "oklch(1.0000 0 0)",
    border: "oklch(0.8074 0.0142 93.0137 / 0.15)",
    // Foreground / 0.15
    input: "oklch(0.4336 0.0113 100.2195)",
    ring: "oklch(0.6724 0.1308 38.7559)",
    chart1: "oklch(0.6724 0.1308 38.7559)",
    chart2: "oklch(0.6898 0.1581 290.4107)",
    chart3: "oklch(0.8816 0.0276 93.1280)",
    chart4: "oklch(0.3074 0.0516 289.3230)",
    chart5: "oklch(0.6368 0.2078 25.3313)",
    sidebar: "oklch(0.2357 0.0024 67.7077)",
    sidebarForeground: "oklch(0.7713 0.0169 99.0657)",
    sidebarPrimary: "oklch(0.6724 0.1308 38.7559)",
    sidebarPrimaryForeground: "oklch(1.0000 0 0)",
    sidebarAccent: "oklch(0.2213 0.0038 106.7070)",
    sidebarAccentForeground: "oklch(0.8074 0.0142 93.0137)",
    sidebarBorder: "oklch(0.7713 0.0169 99.0657 / 0.15)",
    // SidebarForeground / 0.15
    sidebarRing: "oklch(0.6724 0.1308 38.7559)"
  },
  variables: {
    radius: "0.4rem"
  }
}, qO = {
  name: "Twitter (Dark)",
  colors: {
    background: "oklch(0 0 0)",
    foreground: "oklch(0.9328 0.0025 228.7857)",
    card: "oklch(0 0 0)",
    // Matching background for seamless look, or slightly lighter
    cardForeground: "oklch(0.9328 0.0025 228.7857)",
    popover: "oklch(0 0 0)",
    popoverForeground: "oklch(0.9328 0.0025 228.7857)",
    primary: "oklch(0.6692 0.1607 245.0110)",
    primaryForeground: "oklch(1.0000 0 0)",
    secondary: "oklch(0.2097 0.0080 274.5332)",
    // Using card color from ref as secondary
    secondaryForeground: "oklch(0.8853 0 0)",
    muted: "oklch(0.2090 0 0)",
    mutedForeground: "oklch(0.5637 0.0078 247.9662)",
    accent: "oklch(0.1928 0.0331 242.5459)",
    accentForeground: "oklch(0.6692 0.1607 245.0110)",
    destructive: "oklch(0.6188 0.2376 25.7658)",
    destructiveForeground: "oklch(1.0000 0 0)",
    border: "oklch(0.9328 0.0025 228.7857 / 0.15)",
    // Foreground / 0.15
    input: "oklch(0.3020 0.0288 244.8244)",
    ring: "oklch(0.6818 0.1584 243.3540)",
    chart1: "oklch(0.6723 0.1606 244.9955)",
    chart2: "oklch(0.6907 0.1554 160.3454)",
    chart3: "oklch(0.8214 0.1600 82.5337)",
    chart4: "oklch(0.7064 0.1822 151.7125)",
    chart5: "oklch(0.5919 0.2186 10.5826)",
    sidebar: "oklch(0 0 0)",
    sidebarForeground: "oklch(0.9328 0.0025 228.7857)",
    sidebarPrimary: "oklch(0.6692 0.1607 245.0110)",
    sidebarPrimaryForeground: "oklch(1.0000 0 0)",
    sidebarAccent: "oklch(0.1928 0.0331 242.5459)",
    sidebarAccentForeground: "oklch(0.6692 0.1607 245.0110)",
    sidebarBorder: "oklch(0.9328 0.0025 228.7857 / 0.15)",
    // SidebarForeground / 0.15
    sidebarRing: "oklch(0.6818 0.1584 243.3540)"
  },
  variables: {
    radius: "1.3rem"
  }
}, PO = {
  name: "Discord (Dark)",
  colors: {
    background: "#313338",
    foreground: "#f2f3f5",
    card: "#2b2d31",
    cardForeground: "#f2f3f5",
    popover: "#313338",
    popoverForeground: "#f2f3f5",
    primary: "#5865f2",
    primaryForeground: "#ffffff",
    secondary: "#2b2d31",
    secondaryForeground: "#f2f3f5",
    muted: "#1e1f22",
    mutedForeground: "#949ba4",
    accent: "#3f4147",
    accentForeground: "#f2f3f5",
    destructive: "#fa777c",
    destructiveForeground: "#313338",
    border: "#f2f3f526",
    // Foreground #f2f3f5 with ~15% alpha
    input: "#1e1f22",
    ring: "#5865f2",
    chart1: "#5865f2",
    chart2: "#23a559",
    chart3: "#f0b232",
    chart4: "#00a8fc",
    chart5: "#eb459e",
    sidebar: "#1e1f22",
    sidebarForeground: "#949ba4",
    sidebarPrimary: "#5865f2",
    sidebarPrimaryForeground: "#ffffff",
    sidebarAccent: "#3f4147",
    sidebarAccentForeground: "#f2f3f5",
    sidebarBorder: "#949ba426",
    // SidebarForeground #949ba4 with ~15% alpha
    sidebarRing: "#5865f2"
  },
  variables: {
    radius: "0.25rem"
  }
}, BO = {
  name: "Catppuccin Mocha",
  colors: {
    background: "#1e1e2e",
    // foreground: '#cdd6f4', // Old Text
    foreground: "#cba6f7",
    // Modified: Mauve as requested
    card: "#313244",
    cardForeground: "#cba6f7",
    // Also match text
    popover: "#1e1e2e",
    popoverForeground: "#cba6f7",
    primary: "#89b4fa",
    primaryForeground: "#1e1e2e",
    secondary: "#45475a",
    secondaryForeground: "#cba6f7",
    muted: "#313244",
    mutedForeground: "#a6adc8",
    accent: "#45475a",
    accentForeground: "#cba6f7",
    destructive: "#f38ba8",
    destructiveForeground: "#1e1e2e",
    border: "#cba6f726",
    // Mauve with ~15% alpha
    input: "#313244",
    ring: "#89b4fa",
    chart1: "#89b4fa",
    chart2: "#a6e3a1",
    chart3: "#f9e2af",
    chart4: "#fab387",
    chart5: "#cba6f7",
    sidebar: "#181825",
    sidebarForeground: "#cba6f7",
    // Mauve
    sidebarPrimary: "#89b4fa",
    sidebarPrimaryForeground: "#1e1e2e",
    sidebarAccent: "#313244",
    sidebarAccentForeground: "#cba6f7",
    sidebarBorder: "#cba6f726",
    // Mauve with ~15% alpha
    sidebarRing: "#89b4fa"
  },
  variables: {
    radius: "0.5rem"
  }
}, FO = {
  name: "SillyTavern ()",
  colors: {
    background: "var(--SmartThemeBlurTintColor)",
    foreground: "var(--SmartThemeBodyColor)",
    card: "var(--SmartThemeBlurTintColor)",
    cardForeground: "var(--SmartThemeBodyColor)",
    popover: "var(--SmartThemeBlurTintColor)",
    popoverForeground: "var(--SmartThemeBodyColor)",
    primary: "var(--SmartThemeQuoteColor)",
    primaryForeground: "var(--SmartThemeBodyColor)",
    secondary: "var(--SmartThemeBorderColor)",
    secondaryForeground: "var(--SmartThemeBodyColor)",
    muted: "rgba(0,0,0,0.2)",
    mutedForeground: "rgba(255,255,255,0.5)",
    accent: "var(--SmartThemeQuoteColor)",
    accentForeground: "var(--SmartThemeBodyColor)",
    destructive: "var(--SmartThemeBorderColor)",
    destructiveForeground: "var(--SmartThemeBodyColor)",
    border: "var(--SmartThemeBorderColor)",
    input: "var(--SmartThemeBorderColor)",
    ring: "var(--SmartThemeQuoteColor)",
    chart1: "var(--SmartThemeQuoteColor)",
    chart2: "var(--SmartThemeQuoteColor)",
    chart3: "var(--SmartThemeQuoteColor)",
    chart4: "var(--SmartThemeQuoteColor)",
    chart5: "var(--SmartThemeQuoteColor)",
    sidebar: "var(--SmartThemeBlurTintColor)",
    sidebarForeground: "var(--SmartThemeBodyColor)",
    sidebarPrimary: "var(--SmartThemeQuoteColor)",
    sidebarPrimaryForeground: "var(--SmartThemeBodyColor)",
    sidebarAccent: "var(--SmartThemeBorderColor)",
    sidebarAccentForeground: "var(--SmartThemeBodyColor)",
    sidebarBorder: "var(--SmartThemeBorderColor)",
    sidebarRing: "var(--SmartThemeQuoteColor)"
  },
  variables: {
    radius: "0.4rem"
  }
}, $O = {
  name: "Glass (Frosted)",
  colors: {
    // 
    background: "rgba(255, 255, 255, var(--glass-opacity, 0.1))",
    foreground: "#0f172a",
    //  (Slate-900) 
    //  - 
    card: "rgba(255, 255, 255, var(--glass-opacity, 0.25))",
    cardForeground: "#0f172a",
    popover: "rgba(255, 255, 255, var(--glass-opacity, 0.4))",
    popoverForeground: "#0f172a",
    primary: "rgba(15, 23, 42, 0.8)",
    // 
    primaryForeground: "#ffffff",
    secondary: "rgba(255, 255, 255, 0.3)",
    secondaryForeground: "#0f172a",
    muted: "rgba(255, 255, 255, 0.3)",
    mutedForeground: "rgba(15, 23, 42, 0.6)",
    accent: "rgba(255, 255, 255, 0.4)",
    accentForeground: "#0f172a",
    destructive: "rgba(239, 68, 68, 0.8)",
    destructiveForeground: "#ffffff",
    border: "rgba(15, 23, 42, 0.15)",
    // Lighter base (will be resistant to fade)
    input: "rgba(255, 255, 255, 0.4)",
    ring: "rgba(15, 23, 42, 0.4)",
    chart1: "#0f172a",
    chart2: "rgba(15, 23, 42, 0.8)",
    chart3: "rgba(15, 23, 42, 0.6)",
    chart4: "rgba(15, 23, 42, 0.4)",
    chart5: "rgba(15, 23, 42, 0.2)",
    sidebar: "rgba(255, 255, 255, var(--glass-opacity, 0.15))",
    sidebarForeground: "#0f172a",
    sidebarPrimary: "rgba(15, 23, 42, 0.8)",
    sidebarPrimaryForeground: "#ffffff",
    sidebarAccent: "rgba(255, 255, 255, 0.3)",
    sidebarAccentForeground: "#0f172a",
    sidebarBorder: "rgba(15, 23, 42, 0.1)",
    // Lighter base
    sidebarRing: "rgba(15, 23, 42, 0.4)"
  },
  variables: {
    radius: "1rem"
  }
}, Xf = {
  sillytavern: FO,
  // SillyTavern 
  paperLight: IO,
  twitterDark: qO,
  claudeDark: LO,
  catppuccin: BO,
  discord: PO,
  glass: $O
}, Zn = [];
for (let e = 0; e < 256; ++e)
  Zn.push((e + 256).toString(16).slice(1));
function UO(e, t = 0) {
  return (Zn[e[t + 0]] + Zn[e[t + 1]] + Zn[e[t + 2]] + Zn[e[t + 3]] + "-" + Zn[e[t + 4]] + Zn[e[t + 5]] + "-" + Zn[e[t + 6]] + Zn[e[t + 7]] + "-" + Zn[e[t + 8]] + Zn[e[t + 9]] + "-" + Zn[e[t + 10]] + Zn[e[t + 11]] + Zn[e[t + 12]] + Zn[e[t + 13]] + Zn[e[t + 14]] + Zn[e[t + 15]]).toLowerCase();
}
let Cg;
const HO = new Uint8Array(16);
function GO() {
  if (!Cg) {
    if (typeof crypto > "u" || !crypto.getRandomValues)
      throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");
    Cg = crypto.getRandomValues.bind(crypto);
  }
  return Cg(HO);
}
const VO = typeof crypto < "u" && crypto.randomUUID && crypto.randomUUID.bind(crypto), r_ = { randomUUID: VO };
function KO(e, t, n) {
  var a;
  e = e || {};
  const r = e.random ?? ((a = e.rng) == null ? void 0 : a.call(e)) ?? GO();
  if (r.length < 16)
    throw new Error("Random bytes length must be >= 16");
  return r[6] = r[6] & 15 | 64, r[8] = r[8] & 63 | 128, UO(r);
}
function Hl(e, t, n) {
  return r_.randomUUID && !e ? r_.randomUUID() : KO(e);
}
var Cb = function(e, t) {
  return Cb = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(n, r) {
    n.__proto__ = r;
  } || function(n, r) {
    for (var a in r) Object.prototype.hasOwnProperty.call(r, a) && (n[a] = r[a]);
  }, Cb(e, t);
};
function ad(e, t) {
  if (typeof t != "function" && t !== null)
    throw new TypeError("Class extends value " + String(t) + " is not a constructor or null");
  Cb(e, t);
  function n() {
    this.constructor = e;
  }
  e.prototype = t === null ? Object.create(t) : (n.prototype = t.prototype, new n());
}
function Eb(e) {
  var t = typeof Symbol == "function" && Symbol.iterator, n = t && e[t], r = 0;
  if (n) return n.call(e);
  if (e && typeof e.length == "number") return {
    next: function() {
      return e && r >= e.length && (e = void 0), { value: e && e[r++], done: !e };
    }
  };
  throw new TypeError(t ? "Object is not iterable." : "Symbol.iterator is not defined.");
}
function kb(e, t) {
  var n = typeof Symbol == "function" && e[Symbol.iterator];
  if (!n) return e;
  var r = n.call(e), a, o = [], l;
  try {
    for (; (t === void 0 || t-- > 0) && !(a = r.next()).done; ) o.push(a.value);
  } catch (u) {
    l = { error: u };
  } finally {
    try {
      a && !a.done && (n = r.return) && n.call(r);
    } finally {
      if (l) throw l.error;
    }
  }
  return o;
}
function Nb(e, t, n) {
  if (n || arguments.length === 2) for (var r = 0, a = t.length, o; r < a; r++)
    (o || !(r in t)) && (o || (o = Array.prototype.slice.call(t, 0, r)), o[r] = t[r]);
  return e.concat(o || Array.prototype.slice.call(t));
}
function Ji(e) {
  return typeof e == "function";
}
function vj(e) {
  var t = function(r) {
    Error.call(r), r.stack = new Error().stack;
  }, n = e(t);
  return n.prototype = Object.create(Error.prototype), n.prototype.constructor = n, n;
}
var Eg = vj(function(e) {
  return function(n) {
    e(this), this.message = n ? n.length + ` errors occurred during unsubscription:
` + n.map(function(r, a) {
      return a + 1 + ") " + r.toString();
    }).join(`
  `) : "", this.name = "UnsubscriptionError", this.errors = n;
  };
});
function jb(e, t) {
  if (e) {
    var n = e.indexOf(t);
    0 <= n && e.splice(n, 1);
  }
}
var Ph = (function() {
  function e(t) {
    this.initialTeardown = t, this.closed = !1, this._parentage = null, this._finalizers = null;
  }
  return e.prototype.unsubscribe = function() {
    var t, n, r, a, o;
    if (!this.closed) {
      this.closed = !0;
      var l = this._parentage;
      if (l)
        if (this._parentage = null, Array.isArray(l))
          try {
            for (var u = Eb(l), f = u.next(); !f.done; f = u.next()) {
              var d = f.value;
              d.remove(this);
            }
          } catch (E) {
            t = { error: E };
          } finally {
            try {
              f && !f.done && (n = u.return) && n.call(u);
            } finally {
              if (t) throw t.error;
            }
          }
        else
          l.remove(this);
      var m = this.initialTeardown;
      if (Ji(m))
        try {
          m();
        } catch (E) {
          o = E instanceof Eg ? E.errors : [E];
        }
      var p = this._finalizers;
      if (p) {
        this._finalizers = null;
        try {
          for (var x = Eb(p), y = x.next(); !y.done; y = x.next()) {
            var w = y.value;
            try {
              i_(w);
            } catch (E) {
              o = o ?? [], E instanceof Eg ? o = Nb(Nb([], kb(o)), kb(E.errors)) : o.push(E);
            }
          }
        } catch (E) {
          r = { error: E };
        } finally {
          try {
            y && !y.done && (a = x.return) && a.call(x);
          } finally {
            if (r) throw r.error;
          }
        }
      }
      if (o)
        throw new Eg(o);
    }
  }, e.prototype.add = function(t) {
    var n;
    if (t && t !== this)
      if (this.closed)
        i_(t);
      else {
        if (t instanceof e) {
          if (t.closed || t._hasParent(this))
            return;
          t._addParent(this);
        }
        (this._finalizers = (n = this._finalizers) !== null && n !== void 0 ? n : []).push(t);
      }
  }, e.prototype._hasParent = function(t) {
    var n = this._parentage;
    return n === t || Array.isArray(n) && n.includes(t);
  }, e.prototype._addParent = function(t) {
    var n = this._parentage;
    this._parentage = Array.isArray(n) ? (n.push(t), n) : n ? [n, t] : t;
  }, e.prototype._removeParent = function(t) {
    var n = this._parentage;
    n === t ? this._parentage = null : Array.isArray(n) && jb(n, t);
  }, e.prototype.remove = function(t) {
    var n = this._finalizers;
    n && jb(n, t), t instanceof e && t._removeParent(this);
  }, e.EMPTY = (function() {
    var t = new e();
    return t.closed = !0, t;
  })(), e;
})(), bj = Ph.EMPTY;
function wj(e) {
  return e instanceof Ph || e && "closed" in e && Ji(e.remove) && Ji(e.add) && Ji(e.unsubscribe);
}
function i_(e) {
  Ji(e) ? e() : e.unsubscribe();
}
var YO = {
  Promise: void 0
}, XO = {
  setTimeout: function(e, t) {
    for (var n = [], r = 2; r < arguments.length; r++)
      n[r - 2] = arguments[r];
    return setTimeout.apply(void 0, Nb([e, t], kb(n)));
  },
  clearTimeout: function(e) {
    return clearTimeout(e);
  },
  delegate: void 0
};
function WO(e) {
  XO.setTimeout(function() {
    throw e;
  });
}
function a_() {
}
function Wf(e) {
  e();
}
var S2 = (function(e) {
  ad(t, e);
  function t(n) {
    var r = e.call(this) || this;
    return r.isStopped = !1, n ? (r.destination = n, wj(n) && n.add(r)) : r.destination = JO, r;
  }
  return t.create = function(n, r, a) {
    return new Tb(n, r, a);
  }, t.prototype.next = function(n) {
    this.isStopped || this._next(n);
  }, t.prototype.error = function(n) {
    this.isStopped || (this.isStopped = !0, this._error(n));
  }, t.prototype.complete = function() {
    this.isStopped || (this.isStopped = !0, this._complete());
  }, t.prototype.unsubscribe = function() {
    this.closed || (this.isStopped = !0, e.prototype.unsubscribe.call(this), this.destination = null);
  }, t.prototype._next = function(n) {
    this.destination.next(n);
  }, t.prototype._error = function(n) {
    try {
      this.destination.error(n);
    } finally {
      this.unsubscribe();
    }
  }, t.prototype._complete = function() {
    try {
      this.destination.complete();
    } finally {
      this.unsubscribe();
    }
  }, t;
})(Ph), QO = (function() {
  function e(t) {
    this.partialObserver = t;
  }
  return e.prototype.next = function(t) {
    var n = this.partialObserver;
    if (n.next)
      try {
        n.next(t);
      } catch (r) {
        Mf(r);
      }
  }, e.prototype.error = function(t) {
    var n = this.partialObserver;
    if (n.error)
      try {
        n.error(t);
      } catch (r) {
        Mf(r);
      }
    else
      Mf(t);
  }, e.prototype.complete = function() {
    var t = this.partialObserver;
    if (t.complete)
      try {
        t.complete();
      } catch (n) {
        Mf(n);
      }
  }, e;
})(), Tb = (function(e) {
  ad(t, e);
  function t(n, r, a) {
    var o = e.call(this) || this, l;
    return Ji(n) || !n ? l = {
      next: n ?? void 0,
      error: r ?? void 0,
      complete: a ?? void 0
    } : l = n, o.destination = new QO(l), o;
  }
  return t;
})(S2);
function Mf(e) {
  WO(e);
}
function ZO(e) {
  throw e;
}
var JO = {
  closed: !0,
  next: a_,
  error: ZO,
  complete: a_
}, eD = (function() {
  return typeof Symbol == "function" && Symbol.observable || "@@observable";
})();
function tD(e) {
  return e;
}
function nD(e) {
  return e.length === 0 ? tD : e.length === 1 ? e[0] : function(n) {
    return e.reduce(function(r, a) {
      return a(r);
    }, n);
  };
}
var s_ = (function() {
  function e(t) {
    t && (this._subscribe = t);
  }
  return e.prototype.lift = function(t) {
    var n = new e();
    return n.source = this, n.operator = t, n;
  }, e.prototype.subscribe = function(t, n, r) {
    var a = this, o = iD(t) ? t : new Tb(t, n, r);
    return Wf(function() {
      var l = a, u = l.operator, f = l.source;
      o.add(u ? u.call(o, f) : f ? a._subscribe(o) : a._trySubscribe(o));
    }), o;
  }, e.prototype._trySubscribe = function(t) {
    try {
      return this._subscribe(t);
    } catch (n) {
      t.error(n);
    }
  }, e.prototype.forEach = function(t, n) {
    var r = this;
    return n = o_(n), new n(function(a, o) {
      var l = new Tb({
        next: function(u) {
          try {
            t(u);
          } catch (f) {
            o(f), l.unsubscribe();
          }
        },
        error: o,
        complete: a
      });
      r.subscribe(l);
    });
  }, e.prototype._subscribe = function(t) {
    var n;
    return (n = this.source) === null || n === void 0 ? void 0 : n.subscribe(t);
  }, e.prototype[eD] = function() {
    return this;
  }, e.prototype.pipe = function() {
    for (var t = [], n = 0; n < arguments.length; n++)
      t[n] = arguments[n];
    return nD(t)(this);
  }, e.prototype.toPromise = function(t) {
    var n = this;
    return t = o_(t), new t(function(r, a) {
      var o;
      n.subscribe(function(l) {
        return o = l;
      }, function(l) {
        return a(l);
      }, function() {
        return r(o);
      });
    });
  }, e.create = function(t) {
    return new e(t);
  }, e;
})();
function o_(e) {
  var t;
  return (t = e ?? YO.Promise) !== null && t !== void 0 ? t : Promise;
}
function rD(e) {
  return e && Ji(e.next) && Ji(e.error) && Ji(e.complete);
}
function iD(e) {
  return e && e instanceof S2 || rD(e) && wj(e);
}
function aD(e) {
  return Ji(e == null ? void 0 : e.lift);
}
function sD(e) {
  return function(t) {
    if (aD(t))
      return t.lift(function(n) {
        try {
          return e(n, this);
        } catch (r) {
          this.error(r);
        }
      });
    throw new TypeError("Unable to lift unknown Observable type");
  };
}
function oD(e, t, n, r, a) {
  return new lD(e, t, n, r, a);
}
var lD = (function(e) {
  ad(t, e);
  function t(n, r, a, o, l, u) {
    var f = e.call(this, n) || this;
    return f.onFinalize = l, f.shouldUnsubscribe = u, f._next = r ? function(d) {
      try {
        r(d);
      } catch (m) {
        n.error(m);
      }
    } : e.prototype._next, f._error = o ? function(d) {
      try {
        o(d);
      } catch (m) {
        n.error(m);
      } finally {
        this.unsubscribe();
      }
    } : e.prototype._error, f._complete = a ? function() {
      try {
        a();
      } catch (d) {
        n.error(d);
      } finally {
        this.unsubscribe();
      }
    } : e.prototype._complete, f;
  }
  return t.prototype.unsubscribe = function() {
    var n;
    if (!this.shouldUnsubscribe || this.shouldUnsubscribe()) {
      var r = this.closed;
      e.prototype.unsubscribe.call(this), !r && ((n = this.onFinalize) === null || n === void 0 || n.call(this));
    }
  }, t;
})(S2), uD = vj(function(e) {
  return function() {
    e(this), this.name = "ObjectUnsubscribedError", this.message = "object unsubscribed";
  };
}), C2 = (function(e) {
  ad(t, e);
  function t() {
    var n = e.call(this) || this;
    return n.closed = !1, n.currentObservers = null, n.observers = [], n.isStopped = !1, n.hasError = !1, n.thrownError = null, n;
  }
  return t.prototype.lift = function(n) {
    var r = new l_(this, this);
    return r.operator = n, r;
  }, t.prototype._throwIfClosed = function() {
    if (this.closed)
      throw new uD();
  }, t.prototype.next = function(n) {
    var r = this;
    Wf(function() {
      var a, o;
      if (r._throwIfClosed(), !r.isStopped) {
        r.currentObservers || (r.currentObservers = Array.from(r.observers));
        try {
          for (var l = Eb(r.currentObservers), u = l.next(); !u.done; u = l.next()) {
            var f = u.value;
            f.next(n);
          }
        } catch (d) {
          a = { error: d };
        } finally {
          try {
            u && !u.done && (o = l.return) && o.call(l);
          } finally {
            if (a) throw a.error;
          }
        }
      }
    });
  }, t.prototype.error = function(n) {
    var r = this;
    Wf(function() {
      if (r._throwIfClosed(), !r.isStopped) {
        r.hasError = r.isStopped = !0, r.thrownError = n;
        for (var a = r.observers; a.length; )
          a.shift().error(n);
      }
    });
  }, t.prototype.complete = function() {
    var n = this;
    Wf(function() {
      if (n._throwIfClosed(), !n.isStopped) {
        n.isStopped = !0;
        for (var r = n.observers; r.length; )
          r.shift().complete();
      }
    });
  }, t.prototype.unsubscribe = function() {
    this.isStopped = this.closed = !0, this.observers = this.currentObservers = null;
  }, Object.defineProperty(t.prototype, "observed", {
    get: function() {
      var n;
      return ((n = this.observers) === null || n === void 0 ? void 0 : n.length) > 0;
    },
    enumerable: !1,
    configurable: !0
  }), t.prototype._trySubscribe = function(n) {
    return this._throwIfClosed(), e.prototype._trySubscribe.call(this, n);
  }, t.prototype._subscribe = function(n) {
    return this._throwIfClosed(), this._checkFinalizedStatuses(n), this._innerSubscribe(n);
  }, t.prototype._innerSubscribe = function(n) {
    var r = this, a = this, o = a.hasError, l = a.isStopped, u = a.observers;
    return o || l ? bj : (this.currentObservers = null, u.push(n), new Ph(function() {
      r.currentObservers = null, jb(u, n);
    }));
  }, t.prototype._checkFinalizedStatuses = function(n) {
    var r = this, a = r.hasError, o = r.thrownError, l = r.isStopped;
    a ? n.error(o) : l && n.complete();
  }, t.prototype.asObservable = function() {
    var n = new s_();
    return n.source = this, n;
  }, t.create = function(n, r) {
    return new l_(n, r);
  }, t;
})(s_), l_ = (function(e) {
  ad(t, e);
  function t(n, r) {
    var a = e.call(this) || this;
    return a.destination = n, a.source = r, a;
  }
  return t.prototype.next = function(n) {
    var r, a;
    (a = (r = this.destination) === null || r === void 0 ? void 0 : r.next) === null || a === void 0 || a.call(r, n);
  }, t.prototype.error = function(n) {
    var r, a;
    (a = (r = this.destination) === null || r === void 0 ? void 0 : r.error) === null || a === void 0 || a.call(r, n);
  }, t.prototype.complete = function() {
    var n, r;
    (r = (n = this.destination) === null || n === void 0 ? void 0 : n.complete) === null || r === void 0 || r.call(n);
  }, t.prototype._subscribe = function(n) {
    var r, a;
    return (a = (r = this.source) === null || r === void 0 ? void 0 : r.subscribe(n)) !== null && a !== void 0 ? a : bj;
  }, t;
})(C2);
function cD(e, t) {
  return sD(function(n, r) {
    var a = 0;
    n.subscribe(oD(r, function(o) {
      return e.call(t, o, a++) && r.next(o);
    }));
  });
}
const Rf = new C2(), dD = {
  /**
   * 
   */
  emit(e) {
    Rf.next({
      ...e,
      timestamp: Date.now()
    });
  },
  /**
   * 
   */
  subscribe(e) {
    const t = Rf.subscribe(e);
    return {
      unsubscribe: () => t.unsubscribe()
    };
  },
  /**
   * 
   */
  on(e, t) {
    const n = Rf.pipe(cD((r) => r.type === e)).subscribe((r) => t(r.payload));
    return {
      unsubscribe: () => n.unsubscribe()
    };
  },
  /**
   *  RxJS 
   */
  asObservable() {
    return Rf.asObservable();
  }
};
var Zt = /* @__PURE__ */ ((e) => (e[e.DEBUG = 0] = "DEBUG", e[e.INFO = 1] = "INFO", e[e.SUCCESS = 2] = "SUCCESS", e[e.WARN = 3] = "WARN", e[e.ERROR = 4] = "ERROR", e))(Zt || {});
const dh = {
  0: { label: "DEBUG", icon: "", color: "#6c757d" },
  1: { label: "INFO", icon: "", color: "#17a2b8" },
  2: { label: "OK", icon: "", color: "#28a745" },
  3: { label: "WARN", icon: "", color: "#ffc107" },
  4: { label: "ERROR", icon: "", color: "#dc3545" }
}, _j = {
  maxEntries: 5e3,
  minLevel: 0
  /* DEBUG */
}, Sj = new C2();
let Fa = [], Ic = { ..._j };
function fD(e) {
  return new Date(e).toTimeString().slice(0, 8);
}
function Gl(e, t, n, r) {
  if (e < Ic.minLevel) return;
  const a = {
    id: Hl(),
    timestamp: Date.now(),
    level: e,
    module: t,
    message: n,
    data: r
  };
  Fa.push(a), Fa.length > Ic.maxEntries && (Fa = Fa.slice(-Ic.maxEntries)), Sj.next(a);
}
function hD() {
  dD.subscribe((e) => {
    const n = {
      INGESTION_START: Zt.INFO,
      INGESTION_COMPLETE: Zt.SUCCESS,
      ENTITY_CREATED: Zt.INFO,
      MEMORY_STORED: Zt.SUCCESS,
      RETRIEVAL_START: Zt.DEBUG,
      RETRIEVAL_COMPLETE: Zt.SUCCESS,
      CHAT_CHANGED: Zt.INFO,
      MESSAGE_RECEIVED: Zt.DEBUG
    }[e.type] ?? Zt.DEBUG;
    Gl(n, "EventBus", `${e.type}`, e.payload);
  });
}
const le = {
  /**
   *  Logger
   */
  init(e) {
    e && (Ic = { ...Ic, ...e }), Fa = [], hD(), le.info("Logger", "Logger ");
  },
  /**
   * DEBUG 
   */
  debug(e, t, n) {
    Gl(Zt.DEBUG, e, t, n);
  },
  /**
   * INFO 
   */
  info(e, t, n) {
    Gl(Zt.INFO, e, t, n);
  },
  /**
   * SUCCESS 
   */
  success(e, t, n) {
    Gl(Zt.SUCCESS, e, t, n);
  },
  /**
   * WARN 
   */
  warn(e, t, n) {
    Gl(Zt.WARN, e, t, n);
  },
  /**
   * ERROR 
   */
  error(e, t, n) {
    Gl(Zt.ERROR, e, t, n);
  },
  /**
   * 
   */
  getLogs() {
    return [...Fa];
  },
  /**
   * 
   */
  subscribe(e) {
    const t = Sj.subscribe(e);
    return () => t.unsubscribe();
  },
  /**
   * 
   */
  clear() {
    Fa = [], le.info("Logger", "");
  },
  /**
   *  Markdown 
   */
  exportToMarkdown() {
    const e = /* @__PURE__ */ new Date();
    e.toISOString().slice(0, 10), e.toTimeString().slice(0, 8).replace(/:/g, "");
    const t = {
      [Zt.DEBUG]: "DEBUG",
      [Zt.INFO]: "INFO",
      [Zt.SUCCESS]: "SUCCESS",
      [Zt.WARN]: "WARN",
      [Zt.ERROR]: "ERROR"
    };
    let n = `# Engram Debug Log

`;
    n += `- ****: ${e.toLocaleString("zh-CN")}
`, n += `- ****: 0.1.0
`, n += `- ****: ${Fa.length}

`, n += `---

`, n += `## 

`, n += "```\n";
    for (const r of Fa) {
      const a = fD(r.timestamp), o = t[r.level].padEnd(7), l = r.module.padEnd(16);
      if (n += `[${a}] [${l}] ${o} ${r.message}
`, r.data !== void 0) {
        const u = JSON.stringify(r.data, null, 2).split(`
`).map((f) => `    ${f}`).join(`
`);
        n += `${u}
`;
      }
    }
    return n += "```\n", n;
  },
  /**
   * 
   */
  getExportFilename() {
    const e = /* @__PURE__ */ new Date(), t = e.toISOString().slice(0, 10), n = e.toTimeString().slice(0, 8).replace(/:/g, "");
    return `engram_log_${t}_${n}.md`;
  }
}, u_ = 100;
class mD {
  constructor() {
    nt(this, "entries", []);
    nt(this, "listeners", /* @__PURE__ */ new Set());
  }
  /**
   * 
   */
  logSend(t) {
    const n = `log_${Date.now()}_${Math.random().toString(36).slice(2, 8)}`, r = {
      id: n,
      timestamp: Date.now(),
      type: t.type,
      direction: "sent",
      systemPrompt: t.systemPrompt,
      userPrompt: t.userPrompt,
      tokensSent: t.tokensSent,
      model: t.model,
      character: t.character,
      floorRange: t.floorRange,
      status: "pending"
    };
    return this.entries.unshift(r), this.trimEntries(), this.notifyListeners(), n;
  }
  /**
   * 
   */
  logReceive(t, n) {
    const r = this.entries.find((l) => l.id === t);
    if (!r) return;
    const a = {
      id: `${t}_recv`,
      timestamp: Date.now(),
      type: r.type,
      direction: "received",
      response: n.response,
      tokensReceived: n.tokensReceived,
      status: n.status,
      error: n.error,
      duration: n.duration,
      model: r.model,
      character: r.character,
      floorRange: r.floorRange
    };
    r.status = n.status, r.duration = n.duration;
    const o = this.entries.findIndex((l) => l.id === t);
    o >= 0 ? this.entries.splice(o, 0, a) : this.entries.unshift(a), this.trimEntries(), this.notifyListeners();
  }
  /**
   * 
   */
  async logCall(t, n) {
    const r = this.logSend(t), a = Date.now();
    try {
      const o = await n();
      return this.logReceive(r, {
        response: typeof o == "string" ? o : JSON.stringify(o),
        status: "success",
        duration: Date.now() - a
      }), o;
    } catch (o) {
      throw this.logReceive(r, {
        status: "error",
        error: o instanceof Error ? o.message : String(o),
        duration: Date.now() - a
      }), o;
    }
  }
  /**
   * 
   */
  getAll() {
    return [...this.entries];
  }
  /**
   * +
   */
  getPaired() {
    const t = [], n = this.entries.filter((r) => r.direction === "sent");
    for (const r of n) {
      const a = this.entries.find(
        (o) => o.id === `${r.id}_recv` && o.direction === "received"
      );
      t.push({ sent: r, received: a });
    }
    return t;
  }
  /**
   * 
   */
  clear() {
    this.entries = [], this.notifyListeners();
  }
  /**
   * 
   */
  subscribe(t) {
    return this.listeners.add(t), () => this.listeners.delete(t);
  }
  /**
   * 
   */
  getCount() {
    return this.entries.filter((t) => t.direction === "sent").length;
  }
  /**
   * 
   */
  trimEntries() {
    this.entries.length > u_ * 2 && (this.entries = this.entries.slice(0, u_ * 2));
  }
  /**
   * 
   */
  notifyListeners() {
    for (const t of this.listeners)
      t();
  }
}
const Vr = new mD(), E2 = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  DEFAULT_LOGGER_CONFIG: _j,
  LogLevel: Zt,
  LogLevelConfig: dh,
  Logger: le,
  ModelLogger: Vr
}, Symbol.toStringTag, { value: "Module" })), pD = `<system_configuration>
  <role_definition>
    : 
    : """"""
    
    :
      : 
      : 
      : 
      : 
    
    :
      - 
      -  YAML 
      - 
      - 
  </role_definition>

  <formatting_protocol>
    :  JSON 
    :
      - summary: //
      - meta:  (role, location, event, logic, causality)
      - significance_score: 0.0-1.0 
  </formatting_protocol>

  <logic_protocol>
    :
      : ""
      : """"
    
    :
      : 
      : 
        : "102344"
        : "1""3"""
      : 
        :  HH:MM (14:30)
        :  
        :   

     (Token):
      : 
      : 
       ():
        1: {{user}}
        2: {{user}}
        3: {{user}}...
       ():
        1: [ | {{user}}, , ] {{user}} ( | 0.7)

     ():
      -: "/"
        : {{user}}
        : {{user}}
      : ""
        : {{user}}...
        : {{user}}
      : 
        : {{user}}{{user}}...
        : {{user}}
      : """"
        : {{user}}
        : {{user}}

     ():
      _ (Foundation):
        : 0.1 - 0.4
        : >60%
        : """" 0.3-0.4 ()
      _ (Propulsion):
        : 0.5 - 0.7
        :  <30%
        : 
      _ (Keystone):
        : 0.8 - 0.9
        :  <10%
        : 
        : 
      _ (Turning Point):
        : 1.0
        : "" 1%
        : 
  </logic_protocol>

  <output_template>
    <think>
      :
        : \${}
        : \${}
      
      :
        : \${}
        : \${}
      
      :
        : \${}
        : \${}
      
      :
        : \${}
        : \${}
    </think>

    \`\`\`json
    {
      "events": [
        {
          "summary": "//",
          "meta": {
            "time_anchor": " 102344 ",
            "role": [""],
            "location": "",
            "event": "",
            "logic": [""],
            "causality": "Start|Chain|End"
          },
          "significance_score": 0.7
        }
      ]
    }
    \`\`\`
  </output_template>
  
  <example_demonstration>
    :
      "ABBA
      () AB""A""
      () A""A"""

    AI:
      <think>
        :
          : //
          : 
        
        :
          1: A (//) -> 
          2: B (//) -> 
          3:  +  -> 
          4:  +  -> 
      </think>

      \`\`\`json
      {
        "events": [
          {
            "summary": "ABBA",
            "meta": {
              "time_anchor": "102344 ",
              "role": ["A", "B"],
              "location": "",
              "event": "",
              "logic": ["", "", ""],
              "causality": "Start"
            },
            "significance_score": 0.8
          },
          {
            "summary": "ABA",
            "meta": {
              "role": ["A", "B", ""],
              "location": "",
              "event": "",
              "logic": ["", "", ""],
              "causality": "Chain"
            },
            "significance_score": 0.8
          },
          {
            "summary": "A",
            "meta": {
              "role": ["A", ""],
              "location": "",
              "event": "",
              "logic": ["", "", ""],
              "causality": "Start"
            },
            "significance_score": 0.6
          }
        ]
      }
      \`\`\`
  </example_demonstration>
</system_configuration>
`, Cj = `<system_configuration>
  <role_definition>
    : 
    : "" Token 
    
    :
      : 
      : 
      : 
      : 
    
    :
      - 
      - 
      - 
      - 
  </role_definition>

  <compression_protocol>
    _: 
      : 
      :
        - P0 (): //
        - P1 (): /
        - P2 (): 
    
    _:
      : 
      :   
    
    _:
      : 
      :
        : "A " + "A "  "A " ()
        : "A "
  </compression_protocol>

  <merge_strategy>
    _:
      : 
      :
        :
          1. [3 | ] A  ( | 0.2)
          2. [5 | ] A  ( | 0.2)
          3. [7 | ] A  ( | 0.5)
        :
          1. [3-7 | ] A  ( | 0.5)
    
    _:
      : 
      : 
    
    _:
      : 
      :
        : "A " + "A " + "A "
        : "A "
      : ""
  </merge_strategy>

  <output_format>
    :  JSON  text_summary 
    :
      - summary: 
      - meta:  (role, location, event, logic, causality)
      - significance_score: 0.0-1.0  ()
    
    :  30-50%
  </output_format>

  <example_demonstration>
     ():
      \`\`\`
      (102344 ) AB
      Role: [A, B]
      Loc: 
      Event: 
      Logic: []
      Causality: Start
      Significance: 0.8

      (102344 ) BA
      Role: [A, B]
      Loc: 
      Event: 
      Logic: []
      Causality: Chain
      Significance: 0.6

      (1023-1026 ) AB
      Role: [A, ]
      Loc: 
      Event: 
      Logic: []
      Causality: Chain
      Significance: 0.4

      (1026 ) A
      Role: [A, B]
      Loc: B
      Event: 
      Logic: []
      Causality: End
      Significance: 0.8

      (410 ) A
      Role: [A]
      Loc: 
      Event: 
      Logic: []
      Causality: Start
      Significance: 0.3

      (410 14:30) A
      Role: [A, ]
      Loc: 
      Event: 
      Logic: [, ]
      Causality: Chain
      Significance: 0.7
      \`\`\`

     (JSON ):
      \`\`\`json
      {
        "events": [
          {
            "summary": "ABBA",
            "meta": {
              "time_anchor": "102344",
              "role": ["A", "B"],
              "location": "",
              "event": "",
              "logic": ["", "", ""],
              "causality": "Start"
            },
            "significance_score": 0.8
          },
          {
            "summary": "AB",
            "meta": {
              "time_anchor": "1023-1026",
              "role": ["A", "B", ""],
              "location": "",
              "event": "",
              "logic": ["", ""],
              "causality": "Chain"
            },
            "significance_score": 0.8
          },
          {
            "summary": "A",
            "meta": {
              "time_anchor": "410",
              "role": ["A", ""],
              "location": "",
              "event": "",
              "logic": ["", "", ""],
              "causality": "Start"
            },
            "significance_score": 0.7
          }
        ]
      }
      \`\`\`
  </example_demonstration>
</system_configuration>

`, gD = `# Query 

""""

---

## 

****
{{worldbookContext}}

****
{{chatHistory}}

---

## 


1. ****""""""
2. ****
3. ****

---

## 

\`\`\`xml
<think>
[]
</think>

<query>
1, 2, 3, ...
</query>

<output>
[]
</output>
\`\`\`

---

## 

****

****
\`\`\`xml
<think>

- "" Alice  Bob
- ""
</think>

<query>
Alice, Bob, , , , 
</query>

<output>
 Alice  Bob 
</output>
\`\`\`

---

## 

{{userInput}}
`, yD = `<system_configuration>
  <role_definition>
    :  / 
    : 

    :
      : 
      : 
      : """"

    :
      - 
      - 
      - 
      -  plot 
  </role_definition>

  <behavior_guidelines>
    :
      : 
      :
        1. 
        2. 
        3. 
      :
        : 
        : 
      :  think  output 

    :
      : 
      :
        - :  "500"   ""
        - :  "3"   ""
        - : 
        - :  ""   ""
      : AI
  </behavior_guidelines>

  <core_rules>
    A_:
      A1_:
        : 
        NPC: NPC
        : 

      A2_:
        : 10
        : NPC510
        : 

      A3_:
        : 20
        :
          : 
          : 
        : 

      A4_:
        :
          1: 
          2: 
          3: 

        :
          : 
          : 80
          : 100
          : 

    B_:
      B1_:
        : 
        : 
        : 

      B2_:
        : /
          : [] [: X] []  []  []
        : 
          : [] [] [] [] [: X]
        : 
          : [] [: X] []  []

      B3_:
        : 1-2
        : 

    C_:
      : 
      :
        : 
        : 
        : 
        :  {{user}} 
      :
        : 
        : 
  </core_rules>

  <writing_style>
    :
      : 
      : 
      : 
      : 
      : 
  </writing_style>

  <output_template>
    <think>
      :
        :
          : \${}
          : \${}
          : \${}
        :
          : \${}
          : \${}
        :
          : \${}
          : \${//}

      10:
        : \${}
        :
          1: \${}
          2: \${}
          ...
        :
          : \${}
        :
          : \${}
          : \${}

      :
        : \${}
        : \${} + \${} = \${}/100
        : \${} + \${} = \${}/100
        : \${(80)(100)}

      :
        :
          : \${/}
          : \${}
    </think>

    <query>
    \${ RAG }
    1, , , , ...
    </query>

    <output>
    <plot>
      <directive>
        <goal>\${}</goal>
        <plot_summary>\${}</plot_summary>
        <key_points>
          <point>\${+}</point>
          <point>\${}</point>
          <point>\${}</point>
          <point>\${}</point>
          <point>\${}</point>
        </key_points>
      </directive>

      :
        : \${}/100 \${}
        : \${}/100
        : \${}
        : \${}
        : \${}
        : \${}
        : \${NPC -  ()}

        :
          1. \${[] [] }
          2. \${[] [] }
    </plot>
    </output>
  </output_template>
</system_configuration>
`, xD = `# 



---

## 

****
{{context}}

****
{{chatHistory}}

---

## 


1. ****
2. ****
3. ****
4. ****

---

## 

\`\`\`xml
<think>
[]
</think>

<output>
[]
</output>
\`\`\`

---

## 

****

****
\`\`\`xml
<think>

- 
- 
- 
</think>

<output>

</output>
\`\`\`

---

## 

{{userInput}}
`, Ej = `<system_configuration>
  <role_definition>
    : 
    : 
    
    :
      : 
      : 
    
    :
      - 
      - 
      -  existingEntities
      - 
  </role_definition>

  <entity_types>
    char: / ()
    loc:  ()
    item:  ()
    concept: 
    unknown: 
  </entity_types>

  <extraction_rules>
    :
      - 
      -  ("""")
      -  ("""")
      -  ()
    
    :
      -  aliases
      - : ""  """"
    
    :
      -  existingEntities 
      -  name ()
      -  () profile.identity 
  </extraction_rules>

  <profile_structure>
    profile  JSON 
    
     ():
      - relations: EntityRelation[]  
        : target (), type ()
        : description ()
    
     ():
      - identity: string  
      - tags: string[]  
      
     (char) :
      - personality: string  
      - skills: string[]  /
      - affiliation: string  
      
     (loc) :
      - atmosphere: string  
      - features: string[]  
      
     (item) :
      - owner: string  
      - abilities: string[]  
  </profile_structure>

  <output_template>
    <think>
      :
         existingEntities 
        /
      
      :
        
        
      
      :
        
        
    </think>

    \`\`\`json
    {
      "entities": [
        {
          "name": "",
          "type": "char|loc|item|concept",
          "aliases": ["1", "2"],
          "profile": {
            "identity": "",
            "relations": [
              { "target": "", "type": "", "description": "" }
            ],
            "": ""
          }
        }
      ]
    }
    \`\`\`
  </output_template>

  <example_demonstration>
    :
      chatHistory: "ABAB"
      existingEntities: []

    :
      \`\`\`json
      {
        "entities": [
          {
            "name": "A",
            "type": "char",
            "aliases": ["A"],
            "profile": {
              "identity": "",
              "personality": "",
              "relations": [
                { "target": "B", "type": "", "description": "AB" }
              ]
            }
          },
          {
            "name": "B",
            "type": "char",
            "aliases": ["B"],
            "profile": {
              "identity": "A",
              "affiliation": "",
              "relations": [
                { "target": "A", "type": "", "description": "A" }
              ]
            }
          },
          {
            "name": "",
            "type": "loc",
            "aliases": [],
            "profile": {
              "atmosphere": "",
              "features": ["", ""]
            }
          }
        ]
      }
      \`\`\`
  </example_demonstration>
</system_configuration>
`, kj = {
  enabled: !0,
  decayFactor: 0.15,
  maxStickRounds: 3
};
class vD {
  constructor() {
    /** : eventId -> StickyCacheEntry */
    nt(this, "cache", /* @__PURE__ */ new Map());
    /**  */
    nt(this, "currentRound", 0);
  }
  /**
   * 
   */
  nextRound() {
    this.currentRound++, le.debug("StickyCache", ` ${this.currentRound} `);
  }
  /**
   * 
   */
  getCurrentRound() {
    return this.currentRound;
  }
  /**
   * 
   */
  markRecalled(t) {
    const n = this.cache.get(t);
    n && n.lastRound === this.currentRound - 1 ? this.cache.set(t, {
      lastRound: this.currentRound,
      consecutiveCount: n.consecutiveCount + 1
    }) : this.cache.set(t, {
      lastRound: this.currentRound,
      consecutiveCount: 1
    });
  }
  /**
   * 
   */
  markRecalledBatch(t) {
    t.forEach((n) => this.markRecalled(n));
  }
  /**
   * 
   *
   * @param eventId  ID
   * @param config 
   * @returns  [0, 1]0 = 1 = 
   */
  getStickyPenalty(t, n) {
    if (!n.enabled) return 0;
    const r = this.cache.get(t);
    return !r || this.currentRound - r.lastRound > n.maxStickRounds ? 0 : Math.min(1, r.consecutiveCount * n.decayFactor);
  }
  /**
   * 
   */
  isSticky(t, n) {
    return this.getStickyPenalty(t, n) > 0;
  }
  /**
   * 
   *
   * @param maxAge 
   */
  cleanup(t = 10) {
    let n = 0;
    for (const [r, a] of this.cache)
      this.currentRound - a.lastRound > t && (this.cache.delete(r), n++);
    n > 0 && le.debug("StickyCache", ` ${n} `);
  }
  /**
   * 
   */
  clear() {
    this.cache.clear(), this.currentRound = 0, le.debug("StickyCache", "");
  }
  /**
   * 
   */
  getStats() {
    return {
      size: this.cache.size,
      currentRound: this.currentRound
    };
  }
  /**
   * /
   */
  getEventInfo(t) {
    return this.cache.get(t);
  }
}
const yc = new vD(), fh = [
  { value: "summary", label: "", description: " JSON " },
  { value: "trim", label: "/", description: "" },
  { value: "preprocessing", label: "", description: "Query //" },
  { value: "entity_extraction", label: "", description: "" }
], bD = [
  {
    id: "custom_user_profile",
    name: "",
    content: "",
    // 
    enabled: !0,
    createdAt: Date.now()
  }
], Nj = {
  enabled: !1,
  trigger: "floor",
  floorInterval: 50,
  keepRecentCount: 5
}, wD = {
  enableNativeRegex: !0,
  enableEngramRegex: !0
}, Bh = {
  enabled: !0,
  useEmbedding: !0,
  useRerank: !1,
  usePreprocessing: !1,
  useBruteForce: !1,
  //  Embedding 
  embedding: {
    topK: 20,
    minScoreThreshold: 0.3
  },
  sticky: { ...kj, enabled: !0 }
}, _D = {
  temperature: 0.7,
  topP: 0.95,
  maxTokens: 2048,
  frequencyPenalty: 0,
  presencePenalty: 0
}, SD = {
  maxChatHistory: 10
}, CD = {
  source: "transformers"
}, ED = {
  enabled: !1,
  url: "",
  apiKey: "",
  model: "",
  topN: 5,
  hybridAlpha: 0.5
}, c_ = {
  enabled: !1,
  trigger: "with_trim",
  concurrency: 5,
  keepRecentCount: 3
};
function jj(e = "") {
  const t = Date.now();
  return {
    id: `preset_${t}`,
    name: e,
    source: "tavern",
    parameters: { ..._D },
    context: { ...SD },
    isDefault: !0,
    createdAt: t,
    updatedAt: t
  };
}
function Ba(e, t, n = {}) {
  const r = Date.now();
  return {
    id: n.id || `template_${r}_${Math.random().toString(36).slice(2, 8)}`,
    name: e,
    category: t,
    enabled: n.enabled ?? !1,
    isBuiltIn: n.isBuiltIn ?? !1,
    boundPresetId: n.boundPresetId ?? null,
    systemPrompt: n.systemPrompt ?? "",
    userPromptTemplate: n.userPromptTemplate ?? "",
    outputFormat: n.outputFormat ?? "plain",
    availableVariables: n.availableVariables ?? ["{{chatHistory}}", "{{context}}", "{{char}}", "{{user}}"],
    createdAt: r,
    updatedAt: r
  };
}
function k2() {
  return [
    Ba("", "summary", {
      id: "builtin_summary",
      enabled: !0,
      isBuiltIn: !0,
      systemPrompt: pD,
      userPromptTemplate: `{{worldbookContext}}


{{chatHistory}}

---
 JSON `,
      outputFormat: "json"
    }),
    Ba("", "trim", {
      id: "builtin_trim",
      enabled: !0,
      isBuiltIn: !0,
      systemPrompt: Cj,
      userPromptTemplate: `{{worldbookContext}}




{{engramSummaries}}

`,
      outputFormat: "json"
    }),
    Ba("Query ", "preprocessing", {
      id: "builtin_query_enhance",
      enabled: !0,
      isBuiltIn: !0,
      systemPrompt: gD,
      userPromptTemplate: `****:
{{worldbookContext}}

****:
{{chatHistory}}

****:
{{userInput}}

---
`,
      outputFormat: "plain",
      // 
      availableVariables: ["{{worldbookContext}}", "{{chatHistory}}", "{{userInput}}", "{{char}}", "{{user}}"]
    }),
    Ba("", "preprocessing", {
      id: "builtin_plot_director",
      enabled: !1,
      // 
      isBuiltIn: !0,
      systemPrompt: yD,
      userPromptTemplate: `****:
{{worldbookContext}}

****:
{{chatHistory}}

****:
{{userInput}}

---
`,
      outputFormat: "plain",
      //  AI 
      availableVariables: ["{{worldbookContext}}", "{{context}}", "{{chatHistory}}", "{{userInput}}", "{{char}}", "{{user}}"]
    }),
    Ba("", "preprocessing", {
      id: "builtin_description_enhance",
      enabled: !1,
      // 
      isBuiltIn: !0,
      systemPrompt: xD,
      userPromptTemplate: `****:
{{chatHistory}}

****:
{{userInput}}

---
`,
      outputFormat: "plain",
      // 
      availableVariables: ["{{context}}", "{{chatHistory}}", "{{userInput}}", "{{char}}", "{{user}}"]
    }),
    // V0.9: 
    Ba("", "entity_extraction", {
      id: "builtin_entity_extraction",
      enabled: !1,
      // 
      isBuiltIn: !0,
      systemPrompt: Ej,
      userPromptTemplate: `

{{engramGraph}}

---
 JSON `,
      outputFormat: "json",
      availableVariables: ["{{engramGraph}}", "{{worldbookContext}}", "{{char}}", "{{user}}"]
    })
  ];
}
function Tj(e) {
  return k2().find((t) => t.id === e);
}
function N2(e) {
  return k2().find((t) => t.category === e) || null;
}
const kD = {
  enabled: !0,
  includeGlobal: !0,
  disabledWorldbooks: [],
  enableEJS: !0
  // V0.8  EJS
}, ND = {
  enabled: !1,
  trigger: "token",
  tokenLimit: 4096,
  countLimit: 5,
  keepRecentCount: 3,
  preserveOriginal: !1,
  previewEnabled: !0
};
function d_() {
  return {
    llmPresets: [jj()],
    selectedPresetId: null,
    vectorConfig: { ...CD },
    rerankConfig: { ...ED },
    promptTemplates: k2(),
    worldbookConfig: { ...kD },
    regexConfig: { ...wD },
    // V0.8
    recallConfig: { ...Bh },
    // V0.8.5
    customMacros: [...bD]
    // V0.9.2
  };
}
const yo = Object.freeze({
  theme: "odysseia",
  presets: {},
  templates: {},
  promptTemplates: [],
  hasSeenWelcome: !1,
  lastReadVersion: "0.0.0",
  summarizerConfig: {},
  trimmerConfig: {},
  regexRules: [],
  apiSettings: null,
  preprocessingConfig: null,
  // V0.8: 
  linkedDeletion: {
    enabled: !0,
    deleteWorldbook: !0,
    deleteChatWorldbook: !1,
    // 
    deleteIndexedDB: !1,
    showConfirmation: !0
  },
  glassSettings: {
    enabled: !0,
    opacity: 0.3,
    blur: 10
  }
});
class We {
  /**
   *  SillyTavern context
   */
  static getContext() {
    var t, n;
    return (n = (t = window.SillyTavern) == null ? void 0 : t.getContext) == null ? void 0 : n.call(t);
  }
  /**
   * 
   * 
   */
  static getSettings() {
    const t = this.getContext();
    return t != null && t.extensionSettings ? (t.extensionSettings[this.EXTENSION_NAME] || (t.extensionSettings[this.EXTENSION_NAME] = { ...yo }, le.debug("SettingsManager", "Initialized engram settings with defaults"), this.save()), t.extensionSettings[this.EXTENSION_NAME]) : (le.warn("SettingsManager", "SillyTavern context.extensionSettings not available"), { ...yo });
  }
  static getExtensionSettings() {
    return this.getSettings();
  }
  /**
   * 
   * 
   */
  static initSettings() {
    const t = this.getContext();
    if (!(t != null && t.extensionSettings)) {
      le.warn("SettingsManager", "Cannot init settings: context not available");
      return;
    }
    let n = !1;
    t.extensionSettings[this.EXTENSION_NAME] || (t.extensionSettings[this.EXTENSION_NAME] = { ...yo }, n = !0, le.info("SettingsManager", "Created engram settings"));
    const r = t.extensionSettings[this.EXTENSION_NAME];
    for (const a of Object.keys(yo))
      a in r || (r[a] = yo[a], n = !0, le.debug("SettingsManager", `Added missing field: ${a}`));
    n && this.save();
  }
  /**
   * Get a specific setting value
   */
  static get(t) {
    const r = this.getExtensionSettings()[t];
    return r !== void 0 ? r : yo[t];
  }
  /**
   * Save a specific setting value
   *  context.extensionSettings 
   */
  static set(t, n) {
    const r = this.getContext();
    if (!(r != null && r.extensionSettings)) {
      le.warn("SettingsManager", "Cannot set: context.extensionSettings not available");
      return;
    }
    r.extensionSettings[this.EXTENSION_NAME] || (r.extensionSettings[this.EXTENSION_NAME] = { ...yo }), r.extensionSettings[this.EXTENSION_NAME][t] = n, le.debug("SettingsManager", `Set ${String(t)} = ${JSON.stringify(n)}`), this.save();
  }
  /**
   * 
   */
  static save() {
    const t = this.getContext();
    t != null && t.saveSettingsDebounced ? (t.saveSettingsDebounced(), le.debug("SettingsManager", "Saved via context.saveSettingsDebounced")) : le.warn("SettingsManager", "saveSettingsDebounced not available");
  }
  /**
   * Load settings from SillyTavern global state
   * 
   */
  static loadSettings() {
    return this.getExtensionSettings();
  }
  /**
   * 
   * @param category 
   * @returns  null
   */
  static getEnabledPromptTemplate(t) {
    const n = this.get("apiSettings");
    return ((n == null ? void 0 : n.promptTemplates) || []).find((a) => a.category === t && a.enabled) || null;
  }
  /**
   *  ID 
   * @param id  ID
   * @returns  null
   */
  static getPromptTemplateById(t) {
    const n = this.get("apiSettings"), r = (n == null ? void 0 : n.promptTemplates) || [], a = r.find((l) => l.id === t);
    if (a) return a;
    const o = Tj(t);
    return o || r.find((l) => l.category === t && l.enabled) || null;
  }
  /**
   * 
   * @returns summarizerConfig 
   */
  static getSummarizerSettings() {
    return this.get("summarizerConfig") || {};
  }
  /**
   * 
   * @param config 
   */
  static setSummarizerSettings(t) {
    const n = this.getSummarizerSettings();
    this.set("summarizerConfig", { ...n, ...t });
  }
  /**
   * 
   * @returns RegexRule[] 
   */
  static getRegexRules() {
    return this.get("regexRules") || [];
  }
  /**
   * 
   * @param rules 
   */
  static setRegexRules(t) {
    this.set("regexRules", t);
  }
}
nt(We, "EXTENSION_NAME", "engram");
const Aj = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  SettingsManager: We
}, Symbol.toStringTag, { value: "Module" }));
class qs {
  /**
   * 
   */
  static init() {
    this.injectStyles();
    let n = We.loadSettings().theme;
    n || (n = localStorage.getItem(this.STORAGE_KEY), n && We.set("theme", n));
    const r = Xf[n] ? n : "claudeDark";
    this.setTheme(r), le.info("ThemeManager", `: ${r}`);
  }
  /**
   * 
   */
  static setTheme(t) {
    Xf[t] || (le.warn("ThemeManager", `: ${t},  claudeDark`), t = "claudeDark"), this.currentTheme = t, We.set("theme", t), localStorage.setItem(this.STORAGE_KEY, t), this.applyThemeVariables(t);
  }
  /**
   * 
   */
  static getTheme() {
    return this.currentTheme;
  }
  /**
   *  (dist/style.css)
   */
  static injectStyles() {
    const t = "engram-styles";
    if (document.getElementById(t)) return;
    const n = document.createElement("link");
    n.id = t, n.rel = "stylesheet", n.type = "text/css", n.href = `scripts/extensions/Engram_project/dist/style.css?v=${Date.now()}`, document.head.appendChild(n);
  }
  /**
   *  CSS 
   */
  static applyThemeVariables(t) {
    var w, E;
    const n = Xf[t];
    if (!n) return;
    const r = document.documentElement, a = (k, C) => {
      r.style.setProperty(k, C);
    }, o = We.getSettings(), u = ((w = o.glassSettings) == null ? void 0 : w.enabled) ?? !0 ? ((E = o.glassSettings) == null ? void 0 : E.opacity) ?? 1 : 1, d = !(t === "glass") && u < 1, m = Math.round((1 - u) * 100), p = [
      "background",
      "card",
      "popover",
      "sidebar",
      "secondary",
      "muted",
      "input",
      "border",
      "sidebarBorder"
    ];
    Object.entries(n.colors).forEach(([k, C]) => {
      let T = `--${k.replace(/([A-Z])/g, "-$1").toLowerCase()}`;
      T = T.replace(/(\d+)/, "-$1");
      let N = C;
      if (d && p.includes(k)) {
        const D = k.toLowerCase().includes("border") ? Math.round(m * 0.1) : m;
        N = `color-mix(in srgb, ${C}, transparent ${D}%)`;
      }
      a(T, N);
    }), Object.entries(n.variables).forEach(([k, C]) => {
      a(`--${k}`, C);
    }), t !== "paperLight" ? r.classList.add("dark") : r.classList.remove("dark");
    const y = We.getSettings().glassSettings;
    y && y.enabled ? (a("--glass-opacity", y.opacity.toString()), a("--glass-blur", `${y.blur}px`), y.blur > 0 ? a("--glass-backdrop-filter", `blur(${y.blur}px)`) : a("--glass-backdrop-filter", "none")) : (a("--glass-opacity", "1"), a("--glass-blur", "0px"), a("--glass-backdrop-filter", "none"));
  }
}
nt(qs, "STORAGE_KEY", "engram-theme"), nt(qs, "currentTheme", "claudeDark");
const Qf = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  ThemeManager: qs
}, Symbol.toStringTag, { value: "Module" })), jD = xj((e) => ({
  theme: qs.getTheme(),
  isDarkMode: qs.getTheme() !== "paperLight",
  setTheme: (t) => {
    qs.setTheme(t), e({
      theme: t,
      isDarkMode: t !== "paperLight"
    });
  }
}));
class Mj {
  async search(t) {
    const n = t.toLowerCase().trim(), r = ch.map((l) => ({
      id: `nav-${l.id}`,
      type: "navigation",
      // Explicitly cast to 'navigation' | 'action' | 'setting' | 'log'
      title: l.label,
      description: `Navigate to ${l.label}`,
      // Auto-generated description
      icon: l.icon,
      action: (u) => u(l.path),
      score: 10
    })).filter(
      (l) => l.title.toLowerCase().includes(n) || l.id.includes(n)
    ), a = EO.filter(
      (l) => {
        var u;
        return l.label.toLowerCase().includes(n) || ((u = l.description) == null ? void 0 : u.toLowerCase().includes(n)) || l.keywords.some((f) => f.toLowerCase().includes(n));
      }
    ).map((l) => ({
      id: l.id,
      type: "command",
      title: l.label,
      description: l.description,
      icon: l.icon,
      action: l.action,
      score: 9
    })), o = this.getThemeCommands().filter(
      (l) => {
        var u;
        return l.title.toLowerCase().includes(n) || ((u = l.keywords) == null ? void 0 : u.some((f) => f.toLowerCase().includes(n)));
      }
    );
    return [...r, ...a, ...o];
  }
  getThemeCommands() {
    const t = jD.getState().setTheme;
    return [
      {
        id: "theme-paper-light",
        type: "command",
        title: ": Paper Light (Twitter)",
        description: "",
        icon: pO,
        action: () => t("paperLight"),
        keywords: ["theme", "light", "white", "twitter", "paper", ""],
        score: 5
      },
      {
        id: "theme-twitter-dark",
        type: "command",
        title: ": Twitter Dark",
        description: "",
        icon: K5,
        action: () => t("twitterDark"),
        keywords: ["theme", "dark", "black", "twitter", "blue", ""],
        score: 5
      },
      {
        id: "theme-claude-dark",
        type: "command",
        title: ": Claude Dark",
        description: "",
        icon: K5,
        action: () => t("claudeDark"),
        keywords: ["theme", "dark", "claude", "paper", ""],
        score: 5
      },
      {
        id: "theme-catppuccin",
        type: "command",
        title: ": Catppuccin Mocha",
        description: "",
        icon: Y5,
        action: () => t("catppuccin"),
        keywords: ["theme", "dark", "catppuccin", "mocha", ""],
        score: 5
      },
      {
        id: "theme-discord",
        type: "command",
        title: ": Discord Dark",
        description: " Discord ",
        icon: Y5,
        action: () => t("discord"),
        keywords: ["theme", "dark", "discord", "game", ""],
        score: 5
      }
    ];
  }
}
class TD {
  async search(t) {
    const n = t.toLowerCase().trim();
    return this.getAllSettings().filter(
      (r) => {
        var a;
        return r.title.toLowerCase().includes(n) || ((a = r.keywords) == null ? void 0 : a.some((o) => o.toLowerCase().includes(n)));
      }
    );
  }
  getAllSettings() {
    return [
      // API Settings
      {
        id: "setting-api-key",
        type: "setting",
        title: " API Key",
        description: " LLM ",
        icon: Ih,
        action: (t) => t("/api"),
        // Default to API page
        keywords: ["api", "key", "token", "credential"],
        score: 8
      },
      {
        id: "setting-model",
        type: "setting",
        title: " (Model)",
        description: " LLM ",
        icon: x2,
        action: (t) => t("/api"),
        keywords: ["model", "llm", "change", "switch"],
        score: 8
      },
      // Parameters
      {
        id: "setting-temperature",
        type: "setting",
        title: " (Temperature)",
        description: "",
        icon: X5,
        action: (t) => t("/api"),
        keywords: ["temp", "temperature", "random", "creativity"],
        score: 7
      },
      {
        id: "setting-top-p",
        type: "setting",
        title: " Top P",
        description: "",
        icon: X5,
        action: (t) => t("/api"),
        keywords: ["top", "p", "nucleus", "sampling"],
        score: 7
      },
      // Vector/RAG
      {
        id: "setting-vector",
        type: "setting",
        title: " (Vectorization)",
        description: "",
        icon: Dh,
        action: (t) => t("/processing"),
        // processing:vectorization ideally
        keywords: ["vector", "embedding", "db", "store"],
        score: 7
      },
      {
        id: "setting-recall",
        type: "setting",
        title: " (Recall)",
        description: " RAG ",
        icon: Fz,
        action: (t) => t("/processing"),
        // processing:recall
        keywords: ["recall", "rag", "retrieval", "search"],
        score: 7
      }
    ];
  }
}
class AD {
  async search(t) {
    const n = t.toLowerCase().trim();
    return ["log", "debug", "error", "warn", "info", "dev"].some((a) => a.includes(n)) || n.includes("log") ? this.getLogActions() : [];
  }
  getLogActions() {
    return [
      {
        id: "log-view-all",
        type: "log",
        title: " (DevLog)",
        description: "",
        icon: qh,
        action: (t) => t("devlog"),
        score: 9
      },
      {
        id: "log-errors",
        type: "log",
        title: " (Errors)",
        description: "",
        icon: UR,
        action: (t) => t("devlog"),
        // In future: nav('/dev?filter=error')
        score: 8
      }
    ];
  }
}
function Ga() {
  var e, t;
  try {
    return ((t = (e = window.SillyTavern) == null ? void 0 : e.getContext) == null ? void 0 : t.call(e)) || null;
  } catch (n) {
    return console.warn("[Engram] Failed to get ST context:", n), null;
  }
}
function MD() {
  const e = Ga();
  return (e == null ? void 0 : e.chat) || [];
}
function RD() {
  return MD();
}
function or() {
  const e = Ga();
  return (e == null ? void 0 : e.chatId) || null;
}
function Hc() {
  const e = Ga();
  return e ? {
    name: e.name2,
    id: e.characterId
  } : null;
}
function j2() {
  try {
    return window.selected_model || void 0;
  } catch {
    return;
  }
}
function zD() {
  return Ga() !== null;
}
var Zf = { exports: {} }, OD = Zf.exports, f_;
function DD() {
  return f_ || (f_ = 1, (function(e, t) {
    (function(n, r) {
      e.exports = r();
    })(OD, function() {
      var n = function(v, _) {
        return (n = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(j, R) {
          j.__proto__ = R;
        } || function(j, R) {
          for (var I in R) Object.prototype.hasOwnProperty.call(R, I) && (j[I] = R[I]);
        })(v, _);
      }, r = function() {
        return (r = Object.assign || function(v) {
          for (var _, j = 1, R = arguments.length; j < R; j++) for (var I in _ = arguments[j]) Object.prototype.hasOwnProperty.call(_, I) && (v[I] = _[I]);
          return v;
        }).apply(this, arguments);
      };
      function a(v, _, j) {
        for (var R, I = 0, $ = _.length; I < $; I++) !R && I in _ || ((R = R || Array.prototype.slice.call(_, 0, I))[I] = _[I]);
        return v.concat(R || Array.prototype.slice.call(_));
      }
      var o = typeof globalThis < "u" ? globalThis : typeof self < "u" ? self : typeof window < "u" ? window : jc, l = Object.keys, u = Array.isArray;
      function f(v, _) {
        return typeof _ != "object" || l(_).forEach(function(j) {
          v[j] = _[j];
        }), v;
      }
      typeof Promise > "u" || o.Promise || (o.Promise = Promise);
      var d = Object.getPrototypeOf, m = {}.hasOwnProperty;
      function p(v, _) {
        return m.call(v, _);
      }
      function x(v, _) {
        typeof _ == "function" && (_ = _(d(v))), (typeof Reflect > "u" ? l : Reflect.ownKeys)(_).forEach(function(j) {
          w(v, j, _[j]);
        });
      }
      var y = Object.defineProperty;
      function w(v, _, j, R) {
        y(v, _, f(j && p(j, "get") && typeof j.get == "function" ? { get: j.get, set: j.set, configurable: !0 } : { value: j, configurable: !0, writable: !0 }, R));
      }
      function E(v) {
        return { from: function(_) {
          return v.prototype = Object.create(_.prototype), w(v.prototype, "constructor", v), { extend: x.bind(null, v.prototype) };
        } };
      }
      var k = Object.getOwnPropertyDescriptor, C = [].slice;
      function T(v, _, j) {
        return C.call(v, _, j);
      }
      function N(v, _) {
        return _(v);
      }
      function A(v) {
        if (!v) throw new Error("Assertion Failed");
      }
      function D(v) {
        o.setImmediate ? setImmediate(v) : setTimeout(v, 0);
      }
      function M(v, _) {
        if (typeof _ == "string" && p(v, _)) return v[_];
        if (!_) return v;
        if (typeof _ != "string") {
          for (var j = [], R = 0, I = _.length; R < I; ++R) {
            var $ = M(v, _[R]);
            j.push($);
          }
          return j;
        }
        var Q = _.indexOf(".");
        if (Q !== -1) {
          var ne = v[_.substr(0, Q)];
          return ne == null ? void 0 : M(ne, _.substr(Q + 1));
        }
      }
      function O(v, _, j) {
        if (v && _ !== void 0 && !("isFrozen" in Object && Object.isFrozen(v))) if (typeof _ != "string" && "length" in _) {
          A(typeof j != "string" && "length" in j);
          for (var R = 0, I = _.length; R < I; ++R) O(v, _[R], j[R]);
        } else {
          var $, Q, ne = _.indexOf(".");
          ne !== -1 ? ($ = _.substr(0, ne), (Q = _.substr(ne + 1)) === "" ? j === void 0 ? u(v) && !isNaN(parseInt($)) ? v.splice($, 1) : delete v[$] : v[$] = j : O(ne = !(ne = v[$]) || !p(v, $) ? v[$] = {} : ne, Q, j)) : j === void 0 ? u(v) && !isNaN(parseInt(_)) ? v.splice(_, 1) : delete v[_] : v[_] = j;
        }
      }
      function Y(v) {
        var _, j = {};
        for (_ in v) p(v, _) && (j[_] = v[_]);
        return j;
      }
      var X = [].concat;
      function U(v) {
        return X.apply([], v);
      }
      var Re = "BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(U([8, 16, 32, 64].map(function(v) {
        return ["Int", "Uint", "Float"].map(function(_) {
          return _ + v + "Array";
        });
      }))).filter(function(v) {
        return o[v];
      }), B = new Set(Re.map(function(v) {
        return o[v];
      })), G = null;
      function re(v) {
        return G = /* @__PURE__ */ new WeakMap(), v = (function _(j) {
          if (!j || typeof j != "object") return j;
          var R = G.get(j);
          if (R) return R;
          if (u(j)) {
            R = [], G.set(j, R);
            for (var I = 0, $ = j.length; I < $; ++I) R.push(_(j[I]));
          } else if (B.has(j.constructor)) R = j;
          else {
            var Q, ne = d(j);
            for (Q in R = ne === Object.prototype ? {} : Object.create(ne), G.set(j, R), j) p(j, Q) && (R[Q] = _(j[Q]));
          }
          return R;
        })(v), G = null, v;
      }
      var q = {}.toString;
      function W(v) {
        return q.call(v).slice(8, -1);
      }
      var V = typeof Symbol < "u" ? Symbol.iterator : "@@iterator", ee = typeof V == "symbol" ? function(v) {
        var _;
        return v != null && (_ = v[V]) && _.apply(v);
      } : function() {
        return null;
      };
      function te(v, _) {
        return _ = v.indexOf(_), 0 <= _ && v.splice(_, 1), 0 <= _;
      }
      var ie = {};
      function H(v) {
        var _, j, R, I;
        if (arguments.length === 1) {
          if (u(v)) return v.slice();
          if (this === ie && typeof v == "string") return [v];
          if (I = ee(v)) {
            for (j = []; !(R = I.next()).done; ) j.push(R.value);
            return j;
          }
          if (v == null) return [v];
          if (typeof (_ = v.length) != "number") return [v];
          for (j = new Array(_); _--; ) j[_] = v[_];
          return j;
        }
        for (_ = arguments.length, j = new Array(_); _--; ) j[_] = arguments[_];
        return j;
      }
      var L = typeof Symbol < "u" ? function(v) {
        return v[Symbol.toStringTag] === "AsyncFunction";
      } : function() {
        return !1;
      }, In = ["Unknown", "Constraint", "Data", "TransactionInactive", "ReadOnly", "Version", "NotFound", "InvalidState", "InvalidAccess", "Abort", "Timeout", "QuotaExceeded", "Syntax", "DataClone"], hr = ["Modify", "Bulk", "OpenFailed", "VersionChange", "Schema", "Upgrade", "InvalidTable", "MissingAPI", "NoSuchDatabase", "InvalidArgument", "SubTransaction", "Unsupported", "Internal", "DatabaseClosed", "PrematureCommit", "ForeignAwait"].concat(In), J = { VersionChanged: "Database version changed by other database connection", DatabaseClosed: "Database has been closed", Abort: "Transaction aborted", TransactionInactive: "Transaction has already completed or failed", MissingAPI: "IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb" };
      function F(v, _) {
        this.name = v, this.message = _;
      }
      function Z(v, _) {
        return v + ". Errors: " + Object.keys(_).map(function(j) {
          return _[j].toString();
        }).filter(function(j, R, I) {
          return I.indexOf(j) === R;
        }).join(`
`);
      }
      function oe(v, _, j, R) {
        this.failures = _, this.failedKeys = R, this.successCount = j, this.message = Z(v, _);
      }
      function fe(v, _) {
        this.name = "BulkError", this.failures = Object.keys(_).map(function(j) {
          return _[j];
        }), this.failuresByPos = _, this.message = Z(v, this.failures);
      }
      E(F).from(Error).extend({ toString: function() {
        return this.name + ": " + this.message;
      } }), E(oe).from(F), E(fe).from(F);
      var Se = hr.reduce(function(v, _) {
        return v[_] = _ + "Error", v;
      }, {}), Te = F, we = hr.reduce(function(v, _) {
        var j = _ + "Error";
        function R(I, $) {
          this.name = j, I ? typeof I == "string" ? (this.message = "".concat(I).concat($ ? `
 ` + $ : ""), this.inner = $ || null) : typeof I == "object" && (this.message = "".concat(I.name, " ").concat(I.message), this.inner = I) : (this.message = J[_] || j, this.inner = null);
        }
        return E(R).from(Te), v[_] = R, v;
      }, {});
      we.Syntax = SyntaxError, we.Type = TypeError, we.Range = RangeError;
      var ke = In.reduce(function(v, _) {
        return v[_ + "Error"] = we[_], v;
      }, {}), _e = hr.reduce(function(v, _) {
        return ["Syntax", "Type", "Range"].indexOf(_) === -1 && (v[_ + "Error"] = we[_]), v;
      }, {});
      function Ae() {
      }
      function Pe(v) {
        return v;
      }
      function Qe(v, _) {
        return v == null || v === Pe ? _ : function(j) {
          return _(v(j));
        };
      }
      function qe(v, _) {
        return function() {
          v.apply(this, arguments), _.apply(this, arguments);
        };
      }
      function at(v, _) {
        return v === Ae ? _ : function() {
          var j = v.apply(this, arguments);
          j !== void 0 && (arguments[0] = j);
          var R = this.onsuccess, I = this.onerror;
          this.onsuccess = null, this.onerror = null;
          var $ = _.apply(this, arguments);
          return R && (this.onsuccess = this.onsuccess ? qe(R, this.onsuccess) : R), I && (this.onerror = this.onerror ? qe(I, this.onerror) : I), $ !== void 0 ? $ : j;
        };
      }
      function st(v, _) {
        return v === Ae ? _ : function() {
          v.apply(this, arguments);
          var j = this.onsuccess, R = this.onerror;
          this.onsuccess = this.onerror = null, _.apply(this, arguments), j && (this.onsuccess = this.onsuccess ? qe(j, this.onsuccess) : j), R && (this.onerror = this.onerror ? qe(R, this.onerror) : R);
        };
      }
      function mn(v, _) {
        return v === Ae ? _ : function(j) {
          var R = v.apply(this, arguments);
          f(j, R);
          var I = this.onsuccess, $ = this.onerror;
          return this.onsuccess = null, this.onerror = null, j = _.apply(this, arguments), I && (this.onsuccess = this.onsuccess ? qe(I, this.onsuccess) : I), $ && (this.onerror = this.onerror ? qe($, this.onerror) : $), R === void 0 ? j === void 0 ? void 0 : j : f(R, j);
        };
      }
      function Jt(v, _) {
        return v === Ae ? _ : function() {
          return _.apply(this, arguments) !== !1 && v.apply(this, arguments);
        };
      }
      function Sn(v, _) {
        return v === Ae ? _ : function() {
          var j = v.apply(this, arguments);
          if (j && typeof j.then == "function") {
            for (var R = this, I = arguments.length, $ = new Array(I); I--; ) $[I] = arguments[I];
            return j.then(function() {
              return _.apply(R, $);
            });
          }
          return _.apply(this, arguments);
        };
      }
      _e.ModifyError = oe, _e.DexieError = F, _e.BulkError = fe;
      var Kt = typeof location < "u" && /^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);
      function vn(v) {
        Kt = v;
      }
      var qt = {}, Yt = 100, Re = typeof Promise > "u" ? [] : (function() {
        var v = Promise.resolve();
        if (typeof crypto > "u" || !crypto.subtle) return [v, d(v), v];
        var _ = crypto.subtle.digest("SHA-512", new Uint8Array([0]));
        return [_, d(_), v];
      })(), In = Re[0], hr = Re[1], Re = Re[2], hr = hr && hr.then, Be = In && In.constructor, rt = !!Re, dt = function(v, _) {
        tr.push([v, _]), pn && (queueMicrotask(Go), pn = !1);
      }, xt = !0, pn = !0, gn = [], It = [], Rt = Pe, en = { id: "global", global: !0, ref: 0, unhandleds: [], onunhandled: Ae, pgp: !1, env: {}, finalize: Ae }, Ge = en, tr = [], bn = 0, Za = [];
      function Ye(v) {
        if (typeof this != "object") throw new TypeError("Promises must be constructed via new");
        this._listeners = [], this._lib = !1;
        var _ = this._PSD = Ge;
        if (typeof v != "function") {
          if (v !== qt) throw new TypeError("Not a function");
          return this._state = arguments[1], this._value = arguments[2], void (this._state === !1 && Or(this, this._value));
        }
        this._state = null, this._value = null, ++_.ref, (function j(R, I) {
          try {
            I(function($) {
              if (R._state === null) {
                if ($ === R) throw new TypeError("A promise cannot be resolved with itself.");
                var Q = R._lib && Xr();
                $ && typeof $.then == "function" ? j(R, function(ne, ue) {
                  $ instanceof Ye ? $._then(ne, ue) : $.then(ne, ue);
                }) : (R._state = !0, R._value = $, sa(R)), Q && xr();
              }
            }, Or.bind(null, R));
          } catch ($) {
            Or(R, $);
          }
        })(this, v);
      }
      var Ii = { get: function() {
        var v = Ge, _ = ua;
        function j(R, I) {
          var $ = this, Q = !v.global && (v !== Ge || _ !== ua), ne = Q && !$n(), ue = new Ye(function(ce, ge) {
            gi($, new aa(Ja(R, v, Q, ne), Ja(I, v, Q, ne), ce, ge, v));
          });
          return this._consoleTask && (ue._consoleTask = this._consoleTask), ue;
        }
        return j.prototype = qt, j;
      }, set: function(v) {
        w(this, "then", v && v.prototype === qt ? Ii : { get: function() {
          return v;
        }, set: Ii.set });
      } };
      function aa(v, _, j, R, I) {
        this.onFulfilled = typeof v == "function" ? v : null, this.onRejected = typeof _ == "function" ? _ : null, this.resolve = j, this.reject = R, this.psd = I;
      }
      function Or(v, _) {
        var j, R;
        It.push(_), v._state === null && (j = v._lib && Xr(), _ = Rt(_), v._state = !1, v._value = _, R = v, gn.some(function(I) {
          return I._value === R._value;
        }) || gn.push(R), sa(v), j && xr());
      }
      function sa(v) {
        var _ = v._listeners;
        v._listeners = [];
        for (var j = 0, R = _.length; j < R; ++j) gi(v, _[j]);
        var I = v._PSD;
        --I.ref || I.finalize(), bn === 0 && (++bn, dt(function() {
          --bn == 0 && Gs();
        }, []));
      }
      function gi(v, _) {
        if (v._state !== null) {
          var j = v._state ? _.onFulfilled : _.onRejected;
          if (j === null) return (v._state ? _.resolve : _.reject)(v._value);
          ++_.psd.ref, ++bn, dt(xu, [j, v, _]);
        } else v._listeners.push(_);
      }
      function xu(v, _, j) {
        try {
          var R, I = _._value;
          !_._state && It.length && (It = []), R = Kt && _._consoleTask ? _._consoleTask.run(function() {
            return v(I);
          }) : v(I), _._state || It.indexOf(I) !== -1 || (function($) {
            for (var Q = gn.length; Q; ) if (gn[--Q]._value === $._value) return gn.splice(Q, 1);
          })(_), j.resolve(R);
        } catch ($) {
          j.reject($);
        } finally {
          --bn == 0 && Gs(), --j.psd.ref || j.psd.finalize();
        }
      }
      function Go() {
        dr(en, function() {
          Xr() && xr();
        });
      }
      function Xr() {
        var v = xt;
        return pn = xt = !1, v;
      }
      function xr() {
        var v, _, j;
        do
          for (; 0 < tr.length; ) for (v = tr, tr = [], j = v.length, _ = 0; _ < j; ++_) {
            var R = v[_];
            R[0].apply(null, R[1]);
          }
        while (0 < tr.length);
        pn = xt = !0;
      }
      function Gs() {
        var v = gn;
        gn = [], v.forEach(function(R) {
          R._PSD.onunhandled.call(null, R._value, R);
        });
        for (var _ = Za.slice(0), j = _.length; j; ) _[--j]();
      }
      function oa(v) {
        return new Ye(qt, !1, v);
      }
      function Bt(v, _) {
        var j = Ge;
        return function() {
          var R = Xr(), I = Ge;
          try {
            return Qr(j, !0), v.apply(this, arguments);
          } catch ($) {
            _ && _($);
          } finally {
            Qr(I, !1), R && xr();
          }
        };
      }
      x(Ye.prototype, { then: Ii, _then: function(v, _) {
        gi(this, new aa(null, null, v, _, Ge));
      }, catch: function(v) {
        if (arguments.length === 1) return this.then(null, v);
        var _ = v, j = arguments[1];
        return typeof _ == "function" ? this.then(null, function(R) {
          return (R instanceof _ ? j : oa)(R);
        }) : this.then(null, function(R) {
          return (R && R.name === _ ? j : oa)(R);
        });
      }, finally: function(v) {
        return this.then(function(_) {
          return Ye.resolve(v()).then(function() {
            return _;
          });
        }, function(_) {
          return Ye.resolve(v()).then(function() {
            return oa(_);
          });
        });
      }, timeout: function(v, _) {
        var j = this;
        return v < 1 / 0 ? new Ye(function(R, I) {
          var $ = setTimeout(function() {
            return I(new we.Timeout(_));
          }, v);
          j.then(R, I).finally(clearTimeout.bind(null, $));
        }) : this;
      } }), typeof Symbol < "u" && Symbol.toStringTag && w(Ye.prototype, Symbol.toStringTag, "Dexie.Promise"), en.env = Ks(), x(Ye, { all: function() {
        var v = H.apply(null, arguments).map(yi);
        return new Ye(function(_, j) {
          v.length === 0 && _([]);
          var R = v.length;
          v.forEach(function(I, $) {
            return Ye.resolve(I).then(function(Q) {
              v[$] = Q, --R || _(v);
            }, j);
          });
        });
      }, resolve: function(v) {
        return v instanceof Ye ? v : v && typeof v.then == "function" ? new Ye(function(_, j) {
          v.then(_, j);
        }) : new Ye(qt, !0, v);
      }, reject: oa, race: function() {
        var v = H.apply(null, arguments).map(yi);
        return new Ye(function(_, j) {
          v.map(function(R) {
            return Ye.resolve(R).then(_, j);
          });
        });
      }, PSD: { get: function() {
        return Ge;
      }, set: function(v) {
        return Ge = v;
      } }, totalEchoes: { get: function() {
        return ua;
      } }, newPSD: Ut, usePSD: dr, scheduler: { get: function() {
        return dt;
      }, set: function(v) {
        dt = v;
      } }, rejectionMapper: { get: function() {
        return Rt;
      }, set: function(v) {
        Rt = v;
      } }, follow: function(v, _) {
        return new Ye(function(j, R) {
          return Ut(function(I, $) {
            var Q = Ge;
            Q.unhandleds = [], Q.onunhandled = $, Q.finalize = qe(function() {
              var ne, ue = this;
              ne = function() {
                ue.unhandleds.length === 0 ? I() : $(ue.unhandleds[0]);
              }, Za.push(function ce() {
                ne(), Za.splice(Za.indexOf(ce), 1);
              }), ++bn, dt(function() {
                --bn == 0 && Gs();
              }, []);
            }, Q.finalize), v();
          }, _, j, R);
        });
      } }), Be && (Be.allSettled && w(Ye, "allSettled", function() {
        var v = H.apply(null, arguments).map(yi);
        return new Ye(function(_) {
          v.length === 0 && _([]);
          var j = v.length, R = new Array(j);
          v.forEach(function(I, $) {
            return Ye.resolve(I).then(function(Q) {
              return R[$] = { status: "fulfilled", value: Q };
            }, function(Q) {
              return R[$] = { status: "rejected", reason: Q };
            }).then(function() {
              return --j || _(R);
            });
          });
        });
      }), Be.any && typeof AggregateError < "u" && w(Ye, "any", function() {
        var v = H.apply(null, arguments).map(yi);
        return new Ye(function(_, j) {
          v.length === 0 && j(new AggregateError([]));
          var R = v.length, I = new Array(R);
          v.forEach(function($, Q) {
            return Ye.resolve($).then(function(ne) {
              return _(ne);
            }, function(ne) {
              I[Q] = ne, --R || j(new AggregateError(I));
            });
          });
        });
      }), Be.withResolvers && (Ye.withResolvers = Be.withResolvers));
      var dn = { awaits: 0, echoes: 0, id: 0 }, Vs = 0, Li = [], la = 0, ua = 0, Wr = 0;
      function Ut(v, _, j, R) {
        var I = Ge, $ = Object.create(I);
        return $.parent = I, $.ref = 0, $.global = !1, $.id = ++Wr, en.env, $.env = rt ? { Promise: Ye, PromiseProp: { value: Ye, configurable: !0, writable: !0 }, all: Ye.all, race: Ye.race, allSettled: Ye.allSettled, any: Ye.any, resolve: Ye.resolve, reject: Ye.reject } : {}, _ && f($, _), ++I.ref, $.finalize = function() {
          --this.parent.ref || this.parent.finalize();
        }, R = dr($, v, j, R), $.ref === 0 && $.finalize(), R;
      }
      function fn() {
        return dn.id || (dn.id = ++Vs), ++dn.awaits, dn.echoes += Yt, dn.id;
      }
      function $n() {
        return !!dn.awaits && (--dn.awaits == 0 && (dn.id = 0), dn.echoes = dn.awaits * Yt, !0);
      }
      function yi(v) {
        return dn.echoes && v && v.constructor === Be ? (fn(), v.then(function(_) {
          return $n(), _;
        }, function(_) {
          return $n(), Pt(_);
        })) : v;
      }
      function Vo() {
        var v = Li[Li.length - 1];
        Li.pop(), Qr(v, !1);
      }
      function Qr(v, _) {
        var j, R = Ge;
        (_ ? !dn.echoes || la++ && v === Ge : !la || --la && v === Ge) || queueMicrotask(_ ? (function(I) {
          ++ua, dn.echoes && --dn.echoes != 0 || (dn.echoes = dn.awaits = dn.id = 0), Li.push(Ge), Qr(I, !0);
        }).bind(null, v) : Vo), v !== Ge && (Ge = v, R === en && (en.env = Ks()), rt && (j = en.env.Promise, _ = v.env, (R.global || v.global) && (Object.defineProperty(o, "Promise", _.PromiseProp), j.all = _.all, j.race = _.race, j.resolve = _.resolve, j.reject = _.reject, _.allSettled && (j.allSettled = _.allSettled), _.any && (j.any = _.any))));
      }
      function Ks() {
        var v = o.Promise;
        return rt ? { Promise: v, PromiseProp: Object.getOwnPropertyDescriptor(o, "Promise"), all: v.all, race: v.race, allSettled: v.allSettled, any: v.any, resolve: v.resolve, reject: v.reject } : {};
      }
      function dr(v, _, j, R, I) {
        var $ = Ge;
        try {
          return Qr(v, !0), _(j, R, I);
        } finally {
          Qr($, !1);
        }
      }
      function Ja(v, _, j, R) {
        return typeof v != "function" ? v : function() {
          var I = Ge;
          j && fn(), Qr(_, !0);
          try {
            return v.apply(this, arguments);
          } finally {
            Qr(I, !1), R && queueMicrotask($n);
          }
        };
      }
      function Zr(v) {
        Promise === Be && dn.echoes === 0 ? la === 0 ? v() : enqueueNativeMicroTask(v) : setTimeout(v, 0);
      }
      ("" + hr).indexOf("[native code]") === -1 && (fn = $n = Ae);
      var Pt = Ye.reject, nr = "", Un = "Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.", hn = "String expected.", xi = [], ca = "__dbnames", Dr = "readonly", Jr = "readwrite";
      function vi(v, _) {
        return v ? _ ? function() {
          return v.apply(this, arguments) && _.apply(this, arguments);
        } : v : _;
      }
      var es = { type: 3, lower: -1 / 0, lowerOpen: !1, upper: [[]], upperOpen: !1 };
      function da(v) {
        return typeof v != "string" || /\./.test(v) ? function(_) {
          return _;
        } : function(_) {
          return _[v] === void 0 && v in _ && delete (_ = re(_))[v], _;
        };
      }
      function Ko() {
        throw we.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.");
      }
      function pt(v, _) {
        try {
          var j = fa(v), R = fa(_);
          if (j !== R) return j === "Array" ? 1 : R === "Array" ? -1 : j === "binary" ? 1 : R === "binary" ? -1 : j === "string" ? 1 : R === "string" ? -1 : j === "Date" ? 1 : R !== "Date" ? NaN : -1;
          switch (j) {
            case "number":
            case "Date":
            case "string":
              return _ < v ? 1 : v < _ ? -1 : 0;
            case "binary":
              return (function(I, $) {
                for (var Q = I.length, ne = $.length, ue = Q < ne ? Q : ne, ce = 0; ce < ue; ++ce) if (I[ce] !== $[ce]) return I[ce] < $[ce] ? -1 : 1;
                return Q === ne ? 0 : Q < ne ? -1 : 1;
              })(vr(v), vr(_));
            case "Array":
              return (function(I, $) {
                for (var Q = I.length, ne = $.length, ue = Q < ne ? Q : ne, ce = 0; ce < ue; ++ce) {
                  var ge = pt(I[ce], $[ce]);
                  if (ge !== 0) return ge;
                }
                return Q === ne ? 0 : Q < ne ? -1 : 1;
              })(v, _);
          }
        } catch {
        }
        return NaN;
      }
      function fa(v) {
        var _ = typeof v;
        return _ != "object" ? _ : ArrayBuffer.isView(v) ? "binary" : (v = W(v), v === "ArrayBuffer" ? "binary" : v);
      }
      function vr(v) {
        return v instanceof Uint8Array ? v : ArrayBuffer.isView(v) ? new Uint8Array(v.buffer, v.byteOffset, v.byteLength) : new Uint8Array(v);
      }
      function Ln(v, _, j) {
        var R = v.schema.yProps;
        return R ? (_ && 0 < j.numFailures && (_ = _.filter(function(I, $) {
          return !j.failures[$];
        })), Promise.all(R.map(function(I) {
          return I = I.updatesTable, _ ? v.db.table(I).where("k").anyOf(_).delete() : v.db.table(I).clear();
        })).then(function() {
          return j;
        })) : j;
      }
      var qi = (Yo.prototype.execute = function(v) {
        var _ = this["@@propmod"];
        if (_.add !== void 0) {
          var j = _.add;
          if (u(j)) return a(a([], u(v) ? v : [], !0), j).sort();
          if (typeof j == "number") return (Number(v) || 0) + j;
          if (typeof j == "bigint") try {
            return BigInt(v) + j;
          } catch {
            return BigInt(0) + j;
          }
          throw new TypeError("Invalid term ".concat(j));
        }
        if (_.remove !== void 0) {
          var R = _.remove;
          if (u(R)) return u(v) ? v.filter(function(I) {
            return !R.includes(I);
          }).sort() : [];
          if (typeof R == "number") return Number(v) - R;
          if (typeof R == "bigint") try {
            return BigInt(v) - R;
          } catch {
            return BigInt(0) - R;
          }
          throw new TypeError("Invalid subtrahend ".concat(R));
        }
        return j = (j = _.replacePrefix) === null || j === void 0 ? void 0 : j[0], j && typeof v == "string" && v.startsWith(j) ? _.replacePrefix[1] + v.substring(j.length) : v;
      }, Yo);
      function Yo(v) {
        this["@@propmod"] = v;
      }
      function bi(v, _) {
        for (var j = l(_), R = j.length, I = !1, $ = 0; $ < R; ++$) {
          var Q = j[$], ne = _[Q], ue = M(v, Q);
          ne instanceof qi ? (O(v, Q, ne.execute(ue)), I = !0) : ue !== ne && (O(v, Q, ne), I = !0);
        }
        return I;
      }
      var Ys = (At.prototype._trans = function(v, _, j) {
        var R = this._tx || Ge.trans, I = this.name, $ = Kt && typeof console < "u" && console.createTask && console.createTask("Dexie: ".concat(v === "readonly" ? "read" : "write", " ").concat(this.name));
        function Q(ce, ge, se) {
          if (!se.schema[I]) throw new we.NotFound("Table " + I + " not part of transaction");
          return _(se.idbtrans, se);
        }
        var ne = Xr();
        try {
          var ue = R && R.db._novip === this.db._novip ? R === Ge.trans ? R._promise(v, Q, j) : Ut(function() {
            return R._promise(v, Q, j);
          }, { trans: R, transless: Ge.transless || Ge }) : (function ce(ge, se, xe, de) {
            if (ge.idbdb && (ge._state.openComplete || Ge.letThrough || ge._vip)) {
              var me = ge._createTransaction(se, xe, ge._dbSchema);
              try {
                me.create(), ge._state.PR1398_maxLoop = 3;
              } catch (pe) {
                return pe.name === Se.InvalidState && ge.isOpen() && 0 < --ge._state.PR1398_maxLoop ? (console.warn("Dexie: Need to reopen db"), ge.close({ disableAutoOpen: !1 }), ge.open().then(function() {
                  return ce(ge, se, xe, de);
                })) : Pt(pe);
              }
              return me._promise(se, function(pe, ye) {
                return Ut(function() {
                  return Ge.trans = me, de(pe, ye, me);
                });
              }).then(function(pe) {
                if (se === "readwrite") try {
                  me.idbtrans.commit();
                } catch {
                }
                return se === "readonly" ? pe : me._completion.then(function() {
                  return pe;
                });
              });
            }
            if (ge._state.openComplete) return Pt(new we.DatabaseClosed(ge._state.dbOpenError));
            if (!ge._state.isBeingOpened) {
              if (!ge._state.autoOpen) return Pt(new we.DatabaseClosed());
              ge.open().catch(Ae);
            }
            return ge._state.dbReadyPromise.then(function() {
              return ce(ge, se, xe, de);
            });
          })(this.db, v, [this.name], Q);
          return $ && (ue._consoleTask = $, ue = ue.catch(function(ce) {
            return console.trace(ce), Pt(ce);
          })), ue;
        } finally {
          ne && xr();
        }
      }, At.prototype.get = function(v, _) {
        var j = this;
        return v && v.constructor === Object ? this.where(v).first(_) : v == null ? Pt(new we.Type("Invalid argument to Table.get()")) : this._trans("readonly", function(R) {
          return j.core.get({ trans: R, key: v }).then(function(I) {
            return j.hook.reading.fire(I);
          });
        }).then(_);
      }, At.prototype.where = function(v) {
        if (typeof v == "string") return new this.db.WhereClause(this, v);
        if (u(v)) return new this.db.WhereClause(this, "[".concat(v.join("+"), "]"));
        var _ = l(v);
        if (_.length === 1) return this.where(_[0]).equals(v[_[0]]);
        var j = this.schema.indexes.concat(this.schema.primKey).filter(function(ne) {
          if (ne.compound && _.every(function(ce) {
            return 0 <= ne.keyPath.indexOf(ce);
          })) {
            for (var ue = 0; ue < _.length; ++ue) if (_.indexOf(ne.keyPath[ue]) === -1) return !1;
            return !0;
          }
          return !1;
        }).sort(function(ne, ue) {
          return ne.keyPath.length - ue.keyPath.length;
        })[0];
        if (j && this.db._maxKey !== nr) {
          var $ = j.keyPath.slice(0, _.length);
          return this.where($).equals($.map(function(ue) {
            return v[ue];
          }));
        }
        !j && Kt && console.warn("The query ".concat(JSON.stringify(v), " on ").concat(this.name, " would benefit from a ") + "compound index [".concat(_.join("+"), "]"));
        var R = this.schema.idxByName;
        function I(ne, ue) {
          return pt(ne, ue) === 0;
        }
        var Q = _.reduce(function(se, ue) {
          var ce = se[0], ge = se[1], se = R[ue], xe = v[ue];
          return [ce || se, ce || !se ? vi(ge, se && se.multi ? function(de) {
            return de = M(de, ue), u(de) && de.some(function(me) {
              return I(xe, me);
            });
          } : function(de) {
            return I(xe, M(de, ue));
          }) : ge];
        }, [null, null]), $ = Q[0], Q = Q[1];
        return $ ? this.where($.name).equals(v[$.keyPath]).filter(Q) : j ? this.filter(Q) : this.where(_).equals("");
      }, At.prototype.filter = function(v) {
        return this.toCollection().and(v);
      }, At.prototype.count = function(v) {
        return this.toCollection().count(v);
      }, At.prototype.offset = function(v) {
        return this.toCollection().offset(v);
      }, At.prototype.limit = function(v) {
        return this.toCollection().limit(v);
      }, At.prototype.each = function(v) {
        return this.toCollection().each(v);
      }, At.prototype.toArray = function(v) {
        return this.toCollection().toArray(v);
      }, At.prototype.toCollection = function() {
        return new this.db.Collection(new this.db.WhereClause(this));
      }, At.prototype.orderBy = function(v) {
        return new this.db.Collection(new this.db.WhereClause(this, u(v) ? "[".concat(v.join("+"), "]") : v));
      }, At.prototype.reverse = function() {
        return this.toCollection().reverse();
      }, At.prototype.mapToClass = function(v) {
        var _, j = this.db, R = this.name;
        function I() {
          return _ !== null && _.apply(this, arguments) || this;
        }
        (this.schema.mappedClass = v).prototype instanceof Ko && ((function(ue, ce) {
          if (typeof ce != "function" && ce !== null) throw new TypeError("Class extends value " + String(ce) + " is not a constructor or null");
          function ge() {
            this.constructor = ue;
          }
          n(ue, ce), ue.prototype = ce === null ? Object.create(ce) : (ge.prototype = ce.prototype, new ge());
        })(I, _ = v), Object.defineProperty(I.prototype, "db", { get: function() {
          return j;
        }, enumerable: !1, configurable: !0 }), I.prototype.table = function() {
          return R;
        }, v = I);
        for (var $ = /* @__PURE__ */ new Set(), Q = v.prototype; Q; Q = d(Q)) Object.getOwnPropertyNames(Q).forEach(function(ue) {
          return $.add(ue);
        });
        function ne(ue) {
          if (!ue) return ue;
          var ce, ge = Object.create(v.prototype);
          for (ce in ue) if (!$.has(ce)) try {
            ge[ce] = ue[ce];
          } catch {
          }
          return ge;
        }
        return this.schema.readHook && this.hook.reading.unsubscribe(this.schema.readHook), this.schema.readHook = ne, this.hook("reading", ne), v;
      }, At.prototype.defineClass = function() {
        return this.mapToClass(function(v) {
          f(this, v);
        });
      }, At.prototype.add = function(v, _) {
        var j = this, R = this.schema.primKey, I = R.auto, $ = R.keyPath, Q = v;
        return $ && I && (Q = da($)(v)), this._trans("readwrite", function(ne) {
          return j.core.mutate({ trans: ne, type: "add", keys: _ != null ? [_] : null, values: [Q] });
        }).then(function(ne) {
          return ne.numFailures ? Ye.reject(ne.failures[0]) : ne.lastResult;
        }).then(function(ne) {
          if ($) try {
            O(v, $, ne);
          } catch {
          }
          return ne;
        });
      }, At.prototype.upsert = function(v, _) {
        var j = this, R = this.schema.primKey.keyPath;
        return this._trans("readwrite", function(I) {
          return j.core.get({ trans: I, key: v }).then(function($) {
            var Q = $ ?? {};
            return bi(Q, _), R && O(Q, R, v), j.core.mutate({ trans: I, type: "put", values: [Q], keys: [v], upsert: !0, updates: { keys: [v], changeSpecs: [_] } }).then(function(ne) {
              return ne.numFailures ? Ye.reject(ne.failures[0]) : !!$;
            });
          });
        });
      }, At.prototype.update = function(v, _) {
        return typeof v != "object" || u(v) ? this.where(":id").equals(v).modify(_) : (v = M(v, this.schema.primKey.keyPath), v === void 0 ? Pt(new we.InvalidArgument("Given object does not contain its primary key")) : this.where(":id").equals(v).modify(_));
      }, At.prototype.put = function(v, _) {
        var j = this, R = this.schema.primKey, I = R.auto, $ = R.keyPath, Q = v;
        return $ && I && (Q = da($)(v)), this._trans("readwrite", function(ne) {
          return j.core.mutate({ trans: ne, type: "put", values: [Q], keys: _ != null ? [_] : null });
        }).then(function(ne) {
          return ne.numFailures ? Ye.reject(ne.failures[0]) : ne.lastResult;
        }).then(function(ne) {
          if ($) try {
            O(v, $, ne);
          } catch {
          }
          return ne;
        });
      }, At.prototype.delete = function(v) {
        var _ = this;
        return this._trans("readwrite", function(j) {
          return _.core.mutate({ trans: j, type: "delete", keys: [v] }).then(function(R) {
            return Ln(_, [v], R);
          }).then(function(R) {
            return R.numFailures ? Ye.reject(R.failures[0]) : void 0;
          });
        });
      }, At.prototype.clear = function() {
        var v = this;
        return this._trans("readwrite", function(_) {
          return v.core.mutate({ trans: _, type: "deleteRange", range: es }).then(function(j) {
            return Ln(v, null, j);
          });
        }).then(function(_) {
          return _.numFailures ? Ye.reject(_.failures[0]) : void 0;
        });
      }, At.prototype.bulkGet = function(v) {
        var _ = this;
        return this._trans("readonly", function(j) {
          return _.core.getMany({ keys: v, trans: j }).then(function(R) {
            return R.map(function(I) {
              return _.hook.reading.fire(I);
            });
          });
        });
      }, At.prototype.bulkAdd = function(v, _, j) {
        var R = this, I = Array.isArray(_) ? _ : void 0, $ = (j = j || (I ? void 0 : _)) ? j.allKeys : void 0;
        return this._trans("readwrite", function(Q) {
          var ce = R.schema.primKey, ne = ce.auto, ce = ce.keyPath;
          if (ce && I) throw new we.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");
          if (I && I.length !== v.length) throw new we.InvalidArgument("Arguments objects and keys must have the same length");
          var ue = v.length, ce = ce && ne ? v.map(da(ce)) : v;
          return R.core.mutate({ trans: Q, type: "add", keys: I, values: ce, wantResults: $ }).then(function(me) {
            var se = me.numFailures, xe = me.results, de = me.lastResult, me = me.failures;
            if (se === 0) return $ ? xe : de;
            throw new fe("".concat(R.name, ".bulkAdd(): ").concat(se, " of ").concat(ue, " operations failed"), me);
          });
        });
      }, At.prototype.bulkPut = function(v, _, j) {
        var R = this, I = Array.isArray(_) ? _ : void 0, $ = (j = j || (I ? void 0 : _)) ? j.allKeys : void 0;
        return this._trans("readwrite", function(Q) {
          var ce = R.schema.primKey, ne = ce.auto, ce = ce.keyPath;
          if (ce && I) throw new we.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");
          if (I && I.length !== v.length) throw new we.InvalidArgument("Arguments objects and keys must have the same length");
          var ue = v.length, ce = ce && ne ? v.map(da(ce)) : v;
          return R.core.mutate({ trans: Q, type: "put", keys: I, values: ce, wantResults: $ }).then(function(me) {
            var se = me.numFailures, xe = me.results, de = me.lastResult, me = me.failures;
            if (se === 0) return $ ? xe : de;
            throw new fe("".concat(R.name, ".bulkPut(): ").concat(se, " of ").concat(ue, " operations failed"), me);
          });
        });
      }, At.prototype.bulkUpdate = function(v) {
        var _ = this, j = this.core, R = v.map(function(Q) {
          return Q.key;
        }), I = v.map(function(Q) {
          return Q.changes;
        }), $ = [];
        return this._trans("readwrite", function(Q) {
          return j.getMany({ trans: Q, keys: R, cache: "clone" }).then(function(ne) {
            var ue = [], ce = [];
            v.forEach(function(se, xe) {
              var de = se.key, me = se.changes, pe = ne[xe];
              if (pe) {
                for (var ye = 0, be = Object.keys(me); ye < be.length; ye++) {
                  var Ne = be[ye], ze = me[Ne];
                  if (Ne === _.schema.primKey.keyPath) {
                    if (pt(ze, de) !== 0) throw new we.Constraint("Cannot update primary key in bulkUpdate()");
                  } else O(pe, Ne, ze);
                }
                $.push(xe), ue.push(de), ce.push(pe);
              }
            });
            var ge = ue.length;
            return j.mutate({ trans: Q, type: "put", keys: ue, values: ce, updates: { keys: R, changeSpecs: I } }).then(function(se) {
              var xe = se.numFailures, de = se.failures;
              if (xe === 0) return ge;
              for (var me = 0, pe = Object.keys(de); me < pe.length; me++) {
                var ye, be = pe[me], Ne = $[Number(be)];
                Ne != null && (ye = de[be], delete de[be], de[Ne] = ye);
              }
              throw new fe("".concat(_.name, ".bulkUpdate(): ").concat(xe, " of ").concat(ge, " operations failed"), de);
            });
          });
        });
      }, At.prototype.bulkDelete = function(v) {
        var _ = this, j = v.length;
        return this._trans("readwrite", function(R) {
          return _.core.mutate({ trans: R, type: "delete", keys: v }).then(function(I) {
            return Ln(_, v, I);
          });
        }).then(function(Q) {
          var I = Q.numFailures, $ = Q.lastResult, Q = Q.failures;
          if (I === 0) return $;
          throw new fe("".concat(_.name, ".bulkDelete(): ").concat(I, " of ").concat(j, " operations failed"), Q);
        });
      }, At);
      function At() {
      }
      function ha(v) {
        function _(Q, ne) {
          if (ne) {
            for (var ue = arguments.length, ce = new Array(ue - 1); --ue; ) ce[ue - 1] = arguments[ue];
            return j[Q].subscribe.apply(null, ce), v;
          }
          if (typeof Q == "string") return j[Q];
        }
        var j = {};
        _.addEventType = $;
        for (var R = 1, I = arguments.length; R < I; ++R) $(arguments[R]);
        return _;
        function $(Q, ne, ue) {
          if (typeof Q != "object") {
            var ce;
            ne = ne || Jt;
            var ge = { subscribers: [], fire: ue = ue || Ae, subscribe: function(se) {
              ge.subscribers.indexOf(se) === -1 && (ge.subscribers.push(se), ge.fire = ne(ge.fire, se));
            }, unsubscribe: function(se) {
              ge.subscribers = ge.subscribers.filter(function(xe) {
                return xe !== se;
              }), ge.fire = ge.subscribers.reduce(ne, ue);
            } };
            return j[Q] = _[Q] = ge;
          }
          l(ce = Q).forEach(function(se) {
            var xe = ce[se];
            if (u(xe)) $(se, ce[se][0], ce[se][1]);
            else {
              if (xe !== "asap") throw new we.InvalidArgument("Invalid event config");
              var de = $(se, Pe, function() {
                for (var me = arguments.length, pe = new Array(me); me--; ) pe[me] = arguments[me];
                de.subscribers.forEach(function(ye) {
                  D(function() {
                    ye.apply(null, pe);
                  });
                });
              });
            }
          });
        }
      }
      function Cn(v, _) {
        return E(_).from({ prototype: v }), _;
      }
      function br(v, _) {
        return !(v.filter || v.algorithm || v.or) && (_ ? v.justLimit : !v.replayFilter);
      }
      function ts(v, _) {
        v.filter = vi(v.filter, _);
      }
      function ma(v, _, j) {
        var R = v.replayFilter;
        v.replayFilter = R ? function() {
          return vi(R(), _());
        } : _, v.justLimit = j && !R;
      }
      function wr(v, _) {
        if (v.isPrimKey) return _.primaryKey;
        var j = _.getIndexByKeyPath(v.index);
        if (!j) throw new we.Schema("KeyPath " + v.index + " on object store " + _.name + " is not indexed");
        return j;
      }
      function vu(v, _, j) {
        var R = wr(v, _.schema);
        return _.openCursor({ trans: j, values: !v.keysOnly, reverse: v.dir === "prev", unique: !!v.unique, query: { index: R, range: v.range } });
      }
      function Xs(v, _, j, R) {
        var I = v.replayFilter ? vi(v.filter, v.replayFilter()) : v.filter;
        if (v.or) {
          var $ = {}, Q = function(ne, ue, ce) {
            var ge, se;
            I && !I(ue, ce, function(xe) {
              return ue.stop(xe);
            }, function(xe) {
              return ue.fail(xe);
            }) || ((se = "" + (ge = ue.primaryKey)) == "[object ArrayBuffer]" && (se = "" + new Uint8Array(ge)), p($, se) || ($[se] = !0, _(ne, ue, ce)));
          };
          return Promise.all([v.or._iterate(Q, j), pa(vu(v, R, j), v.algorithm, Q, !v.keysOnly && v.valueMapper)]);
        }
        return pa(vu(v, R, j), vi(v.algorithm, I), _, !v.keysOnly && v.valueMapper);
      }
      function pa(v, _, j, R) {
        var I = Bt(R ? function($, Q, ne) {
          return j(R($), Q, ne);
        } : j);
        return v.then(function($) {
          if ($) return $.start(function() {
            var Q = function() {
              return $.continue();
            };
            _ && !_($, function(ne) {
              return Q = ne;
            }, function(ne) {
              $.stop(ne), Q = Ae;
            }, function(ne) {
              $.fail(ne), Q = Ae;
            }) || I($.value, $, function(ne) {
              return Q = ne;
            }), Q();
          });
        });
      }
      var Sm = (jt.prototype._read = function(v, _) {
        var j = this._ctx;
        return j.error ? j.table._trans(null, Pt.bind(null, j.error)) : j.table._trans("readonly", v).then(_);
      }, jt.prototype._write = function(v) {
        var _ = this._ctx;
        return _.error ? _.table._trans(null, Pt.bind(null, _.error)) : _.table._trans("readwrite", v, "locked");
      }, jt.prototype._addAlgorithm = function(v) {
        var _ = this._ctx;
        _.algorithm = vi(_.algorithm, v);
      }, jt.prototype._iterate = function(v, _) {
        return Xs(this._ctx, v, _, this._ctx.table.core);
      }, jt.prototype.clone = function(v) {
        var _ = Object.create(this.constructor.prototype), j = Object.create(this._ctx);
        return v && f(j, v), _._ctx = j, _;
      }, jt.prototype.raw = function() {
        return this._ctx.valueMapper = null, this;
      }, jt.prototype.each = function(v) {
        var _ = this._ctx;
        return this._read(function(j) {
          return Xs(_, v, j, _.table.core);
        });
      }, jt.prototype.count = function(v) {
        var _ = this;
        return this._read(function(j) {
          var R = _._ctx, I = R.table.core;
          if (br(R, !0)) return I.count({ trans: j, query: { index: wr(R, I.schema), range: R.range } }).then(function(Q) {
            return Math.min(Q, R.limit);
          });
          var $ = 0;
          return Xs(R, function() {
            return ++$, !1;
          }, j, I).then(function() {
            return $;
          });
        }).then(v);
      }, jt.prototype.sortBy = function(v, _) {
        var j = v.split(".").reverse(), R = j[0], I = j.length - 1;
        function $(ue, ce) {
          return ce ? $(ue[j[ce]], ce - 1) : ue[R];
        }
        var Q = this._ctx.dir === "next" ? 1 : -1;
        function ne(ue, ce) {
          return pt($(ue, I), $(ce, I)) * Q;
        }
        return this.toArray(function(ue) {
          return ue.sort(ne);
        }).then(_);
      }, jt.prototype.toArray = function(v) {
        var _ = this;
        return this._read(function(j) {
          var R = _._ctx;
          if (R.dir === "next" && br(R, !0) && 0 < R.limit) {
            var I = R.valueMapper, $ = wr(R, R.table.core.schema);
            return R.table.core.query({ trans: j, limit: R.limit, values: !0, query: { index: $, range: R.range } }).then(function(ne) {
              return ne = ne.result, I ? ne.map(I) : ne;
            });
          }
          var Q = [];
          return Xs(R, function(ne) {
            return Q.push(ne);
          }, j, R.table.core).then(function() {
            return Q;
          });
        }, v);
      }, jt.prototype.offset = function(v) {
        var _ = this._ctx;
        return v <= 0 || (_.offset += v, br(_) ? ma(_, function() {
          var j = v;
          return function(R, I) {
            return j === 0 || (j === 1 ? --j : I(function() {
              R.advance(j), j = 0;
            }), !1);
          };
        }) : ma(_, function() {
          var j = v;
          return function() {
            return --j < 0;
          };
        })), this;
      }, jt.prototype.limit = function(v) {
        return this._ctx.limit = Math.min(this._ctx.limit, v), ma(this._ctx, function() {
          var _ = v;
          return function(j, R, I) {
            return --_ <= 0 && R(I), 0 <= _;
          };
        }, !0), this;
      }, jt.prototype.until = function(v, _) {
        return ts(this._ctx, function(j, R, I) {
          return !v(j.value) || (R(I), _);
        }), this;
      }, jt.prototype.first = function(v) {
        return this.limit(1).toArray(function(_) {
          return _[0];
        }).then(v);
      }, jt.prototype.last = function(v) {
        return this.reverse().first(v);
      }, jt.prototype.filter = function(v) {
        var _;
        return ts(this._ctx, function(j) {
          return v(j.value);
        }), (_ = this._ctx).isMatch = vi(_.isMatch, v), this;
      }, jt.prototype.and = function(v) {
        return this.filter(v);
      }, jt.prototype.or = function(v) {
        return new this.db.WhereClause(this._ctx.table, v, this);
      }, jt.prototype.reverse = function() {
        return this._ctx.dir = this._ctx.dir === "prev" ? "next" : "prev", this._ondirectionchange && this._ondirectionchange(this._ctx.dir), this;
      }, jt.prototype.desc = function() {
        return this.reverse();
      }, jt.prototype.eachKey = function(v) {
        var _ = this._ctx;
        return _.keysOnly = !_.isMatch, this.each(function(j, R) {
          v(R.key, R);
        });
      }, jt.prototype.eachUniqueKey = function(v) {
        return this._ctx.unique = "unique", this.eachKey(v);
      }, jt.prototype.eachPrimaryKey = function(v) {
        var _ = this._ctx;
        return _.keysOnly = !_.isMatch, this.each(function(j, R) {
          v(R.primaryKey, R);
        });
      }, jt.prototype.keys = function(v) {
        var _ = this._ctx;
        _.keysOnly = !_.isMatch;
        var j = [];
        return this.each(function(R, I) {
          j.push(I.key);
        }).then(function() {
          return j;
        }).then(v);
      }, jt.prototype.primaryKeys = function(v) {
        var _ = this._ctx;
        if (_.dir === "next" && br(_, !0) && 0 < _.limit) return this._read(function(R) {
          var I = wr(_, _.table.core.schema);
          return _.table.core.query({ trans: R, values: !1, limit: _.limit, query: { index: I, range: _.range } });
        }).then(function(R) {
          return R.result;
        }).then(v);
        _.keysOnly = !_.isMatch;
        var j = [];
        return this.each(function(R, I) {
          j.push(I.primaryKey);
        }).then(function() {
          return j;
        }).then(v);
      }, jt.prototype.uniqueKeys = function(v) {
        return this._ctx.unique = "unique", this.keys(v);
      }, jt.prototype.firstKey = function(v) {
        return this.limit(1).keys(function(_) {
          return _[0];
        }).then(v);
      }, jt.prototype.lastKey = function(v) {
        return this.reverse().firstKey(v);
      }, jt.prototype.distinct = function() {
        var v = this._ctx, v = v.index && v.table.schema.idxByName[v.index];
        if (!v || !v.multi) return this;
        var _ = {};
        return ts(this._ctx, function(I) {
          var R = I.primaryKey.toString(), I = p(_, R);
          return _[R] = !0, !I;
        }), this;
      }, jt.prototype.modify = function(v) {
        var _ = this, j = this._ctx;
        return this._write(function(R) {
          var I = typeof v == "function" ? v : function(pe) {
            return bi(pe, v);
          }, $ = j.table.core, ce = $.schema.primaryKey, Q = ce.outbound, ne = ce.extractKey, ue = 200, ce = _.db._options.modifyChunkSize;
          ce && (ue = typeof ce == "object" ? ce[$.name] || ce["*"] || 200 : ce);
          function ge(pe, Ne) {
            var be = Ne.failures, Ne = Ne.numFailures;
            xe += pe - Ne;
            for (var ze = 0, Ie = l(be); ze < Ie.length; ze++) {
              var He = Ie[ze];
              se.push(be[He]);
            }
          }
          var se = [], xe = 0, de = [], me = v === bu;
          return _.clone().primaryKeys().then(function(pe) {
            function ye(Ne) {
              var ze = Math.min(ue, pe.length - Ne), Ie = pe.slice(Ne, Ne + ze);
              return (me ? Promise.resolve([]) : $.getMany({ trans: R, keys: Ie, cache: "immutable" })).then(function(He) {
                var Xe = [], Fe = [], Ve = Q ? [] : null, Ke = me ? Ie : [];
                if (!me) for (var $e = 0; $e < ze; ++$e) {
                  var Je = He[$e], ot = { value: re(Je), primKey: pe[Ne + $e] };
                  I.call(ot, ot.value, ot) !== !1 && (ot.value == null ? Ke.push(pe[Ne + $e]) : Q || pt(ne(Je), ne(ot.value)) === 0 ? (Fe.push(ot.value), Q && Ve.push(pe[Ne + $e])) : (Ke.push(pe[Ne + $e]), Xe.push(ot.value)));
                }
                return Promise.resolve(0 < Xe.length && $.mutate({ trans: R, type: "add", values: Xe }).then(function(ht) {
                  for (var gt in ht.failures) Ke.splice(parseInt(gt), 1);
                  ge(Xe.length, ht);
                })).then(function() {
                  return (0 < Fe.length || be && typeof v == "object") && $.mutate({ trans: R, type: "put", keys: Ve, values: Fe, criteria: be, changeSpec: typeof v != "function" && v, isAdditionalChunk: 0 < Ne }).then(function(ht) {
                    return ge(Fe.length, ht);
                  });
                }).then(function() {
                  return (0 < Ke.length || be && me) && $.mutate({ trans: R, type: "delete", keys: Ke, criteria: be, isAdditionalChunk: 0 < Ne }).then(function(ht) {
                    return Ln(j.table, Ke, ht);
                  }).then(function(ht) {
                    return ge(Ke.length, ht);
                  });
                }).then(function() {
                  return pe.length > Ne + ze && ye(Ne + ue);
                });
              });
            }
            var be = br(j) && j.limit === 1 / 0 && (typeof v != "function" || me) && { index: j.index, range: j.range };
            return ye(0).then(function() {
              if (0 < se.length) throw new oe("Error modifying one or more objects", se, xe, de);
              return pe.length;
            });
          });
        });
      }, jt.prototype.delete = function() {
        var v = this._ctx, _ = v.range;
        return !br(v) || v.table.schema.yProps || !v.isPrimKey && _.type !== 3 ? this.modify(bu) : this._write(function(j) {
          var R = v.table.core.schema.primaryKey, I = _;
          return v.table.core.count({ trans: j, query: { index: R, range: I } }).then(function($) {
            return v.table.core.mutate({ trans: j, type: "deleteRange", range: I }).then(function(ue) {
              var ne = ue.failures, ue = ue.numFailures;
              if (ue) throw new oe("Could not delete some values", Object.keys(ne).map(function(ce) {
                return ne[ce];
              }), $ - ue);
              return $ - ue;
            });
          });
        });
      }, jt);
      function jt() {
      }
      var bu = function(v, _) {
        return _.value = null;
      };
      function wu(v, _) {
        return v < _ ? -1 : v === _ ? 0 : 1;
      }
      function Cm(v, _) {
        return _ < v ? -1 : v === _ ? 0 : 1;
      }
      function fr(v, _, j) {
        return v = v instanceof ga ? new v.Collection(v) : v, v._ctx.error = new (j || TypeError)(_), v;
      }
      function wi(v) {
        return new v.Collection(v, function() {
          return Xo("");
        }).limit(0);
      }
      function _r(v, _, j, R) {
        var I, $, Q, ne, ue, ce, ge, se = j.length;
        if (!j.every(function(me) {
          return typeof me == "string";
        })) return fr(v, hn);
        function xe(me) {
          I = me === "next" ? function(ye) {
            return ye.toUpperCase();
          } : function(ye) {
            return ye.toLowerCase();
          }, $ = me === "next" ? function(ye) {
            return ye.toLowerCase();
          } : function(ye) {
            return ye.toUpperCase();
          }, Q = me === "next" ? wu : Cm;
          var pe = j.map(function(ye) {
            return { lower: $(ye), upper: I(ye) };
          }).sort(function(ye, be) {
            return Q(ye.lower, be.lower);
          });
          ne = pe.map(function(ye) {
            return ye.upper;
          }), ue = pe.map(function(ye) {
            return ye.lower;
          }), ge = (ce = me) === "next" ? "" : R;
        }
        xe("next"), v = new v.Collection(v, function() {
          return ei(ne[0], ue[se - 1] + R);
        }), v._ondirectionchange = function(me) {
          xe(me);
        };
        var de = 0;
        return v._addAlgorithm(function(me, pe, ye) {
          var be = me.key;
          if (typeof be != "string") return !1;
          var Ne = $(be);
          if (_(Ne, ue, de)) return !0;
          for (var ze = null, Ie = de; Ie < se; ++Ie) {
            var He = (function(Xe, Fe, Ve, Ke, $e, Je) {
              for (var ot = Math.min(Xe.length, Ke.length), ht = -1, gt = 0; gt < ot; ++gt) {
                var Vn = Fe[gt];
                if (Vn !== Ke[gt]) return $e(Xe[gt], Ve[gt]) < 0 ? Xe.substr(0, gt) + Ve[gt] + Ve.substr(gt + 1) : $e(Xe[gt], Ke[gt]) < 0 ? Xe.substr(0, gt) + Ke[gt] + Ve.substr(gt + 1) : 0 <= ht ? Xe.substr(0, ht) + Fe[ht] + Ve.substr(ht + 1) : null;
                $e(Xe[gt], Vn) < 0 && (ht = gt);
              }
              return ot < Ke.length && Je === "next" ? Xe + Ve.substr(Xe.length) : ot < Xe.length && Je === "prev" ? Xe.substr(0, Ve.length) : ht < 0 ? null : Xe.substr(0, ht) + Ke[ht] + Ve.substr(ht + 1);
            })(be, Ne, ne[Ie], ue[Ie], Q, ce);
            He === null && ze === null ? de = Ie + 1 : (ze === null || 0 < Q(ze, He)) && (ze = He);
          }
          return pe(ze !== null ? function() {
            me.continue(ze + ge);
          } : ye), !1;
        }), v;
      }
      function ei(v, _, j, R) {
        return { type: 2, lower: v, upper: _, lowerOpen: j, upperOpen: R };
      }
      function Xo(v) {
        return { type: 1, lower: v, upper: v };
      }
      var ga = (Object.defineProperty(tn.prototype, "Collection", { get: function() {
        return this._ctx.table.db.Collection;
      }, enumerable: !1, configurable: !0 }), tn.prototype.between = function(v, _, j, R) {
        j = j !== !1, R = R === !0;
        try {
          return 0 < this._cmp(v, _) || this._cmp(v, _) === 0 && (j || R) && (!j || !R) ? wi(this) : new this.Collection(this, function() {
            return ei(v, _, !j, !R);
          });
        } catch {
          return fr(this, Un);
        }
      }, tn.prototype.equals = function(v) {
        return v == null ? fr(this, Un) : new this.Collection(this, function() {
          return Xo(v);
        });
      }, tn.prototype.above = function(v) {
        return v == null ? fr(this, Un) : new this.Collection(this, function() {
          return ei(v, void 0, !0);
        });
      }, tn.prototype.aboveOrEqual = function(v) {
        return v == null ? fr(this, Un) : new this.Collection(this, function() {
          return ei(v, void 0, !1);
        });
      }, tn.prototype.below = function(v) {
        return v == null ? fr(this, Un) : new this.Collection(this, function() {
          return ei(void 0, v, !1, !0);
        });
      }, tn.prototype.belowOrEqual = function(v) {
        return v == null ? fr(this, Un) : new this.Collection(this, function() {
          return ei(void 0, v);
        });
      }, tn.prototype.startsWith = function(v) {
        return typeof v != "string" ? fr(this, hn) : this.between(v, v + nr, !0, !0);
      }, tn.prototype.startsWithIgnoreCase = function(v) {
        return v === "" ? this.startsWith(v) : _r(this, function(_, j) {
          return _.indexOf(j[0]) === 0;
        }, [v], nr);
      }, tn.prototype.equalsIgnoreCase = function(v) {
        return _r(this, function(_, j) {
          return _ === j[0];
        }, [v], "");
      }, tn.prototype.anyOfIgnoreCase = function() {
        var v = H.apply(ie, arguments);
        return v.length === 0 ? wi(this) : _r(this, function(_, j) {
          return j.indexOf(_) !== -1;
        }, v, "");
      }, tn.prototype.startsWithAnyOfIgnoreCase = function() {
        var v = H.apply(ie, arguments);
        return v.length === 0 ? wi(this) : _r(this, function(_, j) {
          return j.some(function(R) {
            return _.indexOf(R) === 0;
          });
        }, v, nr);
      }, tn.prototype.anyOf = function() {
        var v = this, _ = H.apply(ie, arguments), j = this._cmp;
        try {
          _.sort(j);
        } catch {
          return fr(this, Un);
        }
        if (_.length === 0) return wi(this);
        var R = new this.Collection(this, function() {
          return ei(_[0], _[_.length - 1]);
        });
        R._ondirectionchange = function($) {
          j = $ === "next" ? v._ascending : v._descending, _.sort(j);
        };
        var I = 0;
        return R._addAlgorithm(function($, Q, ne) {
          for (var ue = $.key; 0 < j(ue, _[I]); ) if (++I === _.length) return Q(ne), !1;
          return j(ue, _[I]) === 0 || (Q(function() {
            $.continue(_[I]);
          }), !1);
        }), R;
      }, tn.prototype.notEqual = function(v) {
        return this.inAnyRange([[-1 / 0, v], [v, this.db._maxKey]], { includeLowers: !1, includeUppers: !1 });
      }, tn.prototype.noneOf = function() {
        var v = H.apply(ie, arguments);
        if (v.length === 0) return new this.Collection(this);
        try {
          v.sort(this._ascending);
        } catch {
          return fr(this, Un);
        }
        var _ = v.reduce(function(j, R) {
          return j ? j.concat([[j[j.length - 1][1], R]]) : [[-1 / 0, R]];
        }, null);
        return _.push([v[v.length - 1], this.db._maxKey]), this.inAnyRange(_, { includeLowers: !1, includeUppers: !1 });
      }, tn.prototype.inAnyRange = function(be, _) {
        var j = this, R = this._cmp, I = this._ascending, $ = this._descending, Q = this._min, ne = this._max;
        if (be.length === 0) return wi(this);
        if (!be.every(function(Ne) {
          return Ne[0] !== void 0 && Ne[1] !== void 0 && I(Ne[0], Ne[1]) <= 0;
        })) return fr(this, "First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower", we.InvalidArgument);
        var ue = !_ || _.includeLowers !== !1, ce = _ && _.includeUppers === !0, ge, se = I;
        function xe(Ne, ze) {
          return se(Ne[0], ze[0]);
        }
        try {
          (ge = be.reduce(function(Ne, ze) {
            for (var Ie = 0, He = Ne.length; Ie < He; ++Ie) {
              var Xe = Ne[Ie];
              if (R(ze[0], Xe[1]) < 0 && 0 < R(ze[1], Xe[0])) {
                Xe[0] = Q(Xe[0], ze[0]), Xe[1] = ne(Xe[1], ze[1]);
                break;
              }
            }
            return Ie === He && Ne.push(ze), Ne;
          }, [])).sort(xe);
        } catch {
          return fr(this, Un);
        }
        var de = 0, me = ce ? function(Ne) {
          return 0 < I(Ne, ge[de][1]);
        } : function(Ne) {
          return 0 <= I(Ne, ge[de][1]);
        }, pe = ue ? function(Ne) {
          return 0 < $(Ne, ge[de][0]);
        } : function(Ne) {
          return 0 <= $(Ne, ge[de][0]);
        }, ye = me, be = new this.Collection(this, function() {
          return ei(ge[0][0], ge[ge.length - 1][1], !ue, !ce);
        });
        return be._ondirectionchange = function(Ne) {
          se = Ne === "next" ? (ye = me, I) : (ye = pe, $), ge.sort(xe);
        }, be._addAlgorithm(function(Ne, ze, Ie) {
          for (var He, Xe = Ne.key; ye(Xe); ) if (++de === ge.length) return ze(Ie), !1;
          return !me(He = Xe) && !pe(He) || (j._cmp(Xe, ge[de][1]) === 0 || j._cmp(Xe, ge[de][0]) === 0 || ze(function() {
            se === I ? Ne.continue(ge[de][0]) : Ne.continue(ge[de][1]);
          }), !1);
        }), be;
      }, tn.prototype.startsWithAnyOf = function() {
        var v = H.apply(ie, arguments);
        return v.every(function(_) {
          return typeof _ == "string";
        }) ? v.length === 0 ? wi(this) : this.inAnyRange(v.map(function(_) {
          return [_, _ + nr];
        })) : fr(this, "startsWithAnyOf() only works with strings");
      }, tn);
      function tn() {
      }
      function Ir(v) {
        return Bt(function(_) {
          return ya(_), v(_.target.error), !1;
        });
      }
      function ya(v) {
        v.stopPropagation && v.stopPropagation(), v.preventDefault && v.preventDefault();
      }
      var ns = "storagemutated", xa = "x-storagemutated-1", Hn = ha(null, ns), _u = (rr.prototype._lock = function() {
        return A(!Ge.global), ++this._reculock, this._reculock !== 1 || Ge.global || (Ge.lockOwnerFor = this), this;
      }, rr.prototype._unlock = function() {
        if (A(!Ge.global), --this._reculock == 0) for (Ge.global || (Ge.lockOwnerFor = null); 0 < this._blockedFuncs.length && !this._locked(); ) {
          var v = this._blockedFuncs.shift();
          try {
            dr(v[1], v[0]);
          } catch {
          }
        }
        return this;
      }, rr.prototype._locked = function() {
        return this._reculock && Ge.lockOwnerFor !== this;
      }, rr.prototype.create = function(v) {
        var _ = this;
        if (!this.mode) return this;
        var j = this.db.idbdb, R = this.db._state.dbOpenError;
        if (A(!this.idbtrans), !v && !j) switch (R && R.name) {
          case "DatabaseClosedError":
            throw new we.DatabaseClosed(R);
          case "MissingAPIError":
            throw new we.MissingAPI(R.message, R);
          default:
            throw new we.OpenFailed(R);
        }
        if (!this.active) throw new we.TransactionInactive();
        return A(this._completion._state === null), (v = this.idbtrans = v || (this.db.core || j).transaction(this.storeNames, this.mode, { durability: this.chromeTransactionDurability })).onerror = Bt(function(I) {
          ya(I), _._reject(v.error);
        }), v.onabort = Bt(function(I) {
          ya(I), _.active && _._reject(new we.Abort(v.error)), _.active = !1, _.on("abort").fire(I);
        }), v.oncomplete = Bt(function() {
          _.active = !1, _._resolve(), "mutatedParts" in v && Hn.storagemutated.fire(v.mutatedParts);
        }), this;
      }, rr.prototype._promise = function(v, _, j) {
        var R = this;
        if (v === "readwrite" && this.mode !== "readwrite") return Pt(new we.ReadOnly("Transaction is readonly"));
        if (!this.active) return Pt(new we.TransactionInactive());
        if (this._locked()) return new Ye(function($, Q) {
          R._blockedFuncs.push([function() {
            R._promise(v, _, j).then($, Q);
          }, Ge]);
        });
        if (j) return Ut(function() {
          var $ = new Ye(function(Q, ne) {
            R._lock();
            var ue = _(Q, ne, R);
            ue && ue.then && ue.then(Q, ne);
          });
          return $.finally(function() {
            return R._unlock();
          }), $._lib = !0, $;
        });
        var I = new Ye(function($, Q) {
          var ne = _($, Q, R);
          ne && ne.then && ne.then($, Q);
        });
        return I._lib = !0, I;
      }, rr.prototype._root = function() {
        return this.parent ? this.parent._root() : this;
      }, rr.prototype.waitFor = function(v) {
        var _, j = this._root(), R = Ye.resolve(v);
        j._waitingFor ? j._waitingFor = j._waitingFor.then(function() {
          return R;
        }) : (j._waitingFor = R, j._waitingQueue = [], _ = j.idbtrans.objectStore(j.storeNames[0]), (function $() {
          for (++j._spinCount; j._waitingQueue.length; ) j._waitingQueue.shift()();
          j._waitingFor && (_.get(-1 / 0).onsuccess = $);
        })());
        var I = j._waitingFor;
        return new Ye(function($, Q) {
          R.then(function(ne) {
            return j._waitingQueue.push(Bt($.bind(null, ne)));
          }, function(ne) {
            return j._waitingQueue.push(Bt(Q.bind(null, ne)));
          }).finally(function() {
            j._waitingFor === I && (j._waitingFor = null);
          });
        });
      }, rr.prototype.abort = function() {
        this.active && (this.active = !1, this.idbtrans && this.idbtrans.abort(), this._reject(new we.Abort()));
      }, rr.prototype.table = function(v) {
        var _ = this._memoizedTables || (this._memoizedTables = {});
        if (p(_, v)) return _[v];
        var j = this.schema[v];
        if (!j) throw new we.NotFound("Table " + v + " not part of transaction");
        return j = new this.db.Table(v, j, this), j.core = this.db.core.table(v), _[v] = j;
      }, rr);
      function rr() {
      }
      function ti(v, _, j, R, I, $, Q, ne) {
        return { name: v, keyPath: _, unique: j, multi: R, auto: I, compound: $, src: (j && !Q ? "&" : "") + (R ? "*" : "") + (I ? "++" : "") + Wo(_), type: ne };
      }
      function Wo(v) {
        return typeof v == "string" ? v : v ? "[" + [].join.call(v, "+") + "]" : "";
      }
      function rs(v, _, j) {
        return { name: v, primKey: _, indexes: j, mappedClass: null, idxByName: (R = function(I) {
          return [I.name, I];
        }, j.reduce(function(I, $, Q) {
          return Q = R($, Q), Q && (I[Q[0]] = Q[1]), I;
        }, {})) };
        var R;
      }
      var is = function(v) {
        try {
          return v.only([[]]), is = function() {
            return [[]];
          }, [[]];
        } catch {
          return is = function() {
            return nr;
          }, nr;
        }
      };
      function as(v) {
        return v == null ? function() {
        } : typeof v == "string" ? (_ = v).split(".").length === 1 ? function(j) {
          return j[_];
        } : function(j) {
          return M(j, _);
        } : function(j) {
          return M(j, v);
        };
        var _;
      }
      function Ws(v) {
        return [].slice.call(v);
      }
      var bd = 0;
      function En(v) {
        return v == null ? ":id" : typeof v == "string" ? v : "[".concat(v.join("+"), "]");
      }
      function va(v, _, ue) {
        function R(ye) {
          if (ye.type === 3) return null;
          if (ye.type === 4) throw new Error("Cannot convert never type to IDBKeyRange");
          var de = ye.lower, me = ye.upper, pe = ye.lowerOpen, ye = ye.upperOpen;
          return de === void 0 ? me === void 0 ? null : _.upperBound(me, !!ye) : me === void 0 ? _.lowerBound(de, !!pe) : _.bound(de, me, !!pe, !!ye);
        }
        function I(xe) {
          var de, me = xe.name;
          return { name: me, schema: xe, mutate: function(pe) {
            var ye = pe.trans, be = pe.type, Ne = pe.keys, ze = pe.values, Ie = pe.range;
            return new Promise(function(He, Xe) {
              He = Bt(He);
              var Fe = ye.objectStore(me), Ve = Fe.keyPath == null, Ke = be === "put" || be === "add";
              if (!Ke && be !== "delete" && be !== "deleteRange") throw new Error("Invalid operation type: " + be);
              var $e, Je = (Ne || ze || { length: 1 }).length;
              if (Ne && ze && Ne.length !== ze.length) throw new Error("Given keys array must have same length as given values array.");
              if (Je === 0) return He({ numFailures: 0, failures: {}, results: [], lastResult: void 0 });
              function ot(Nn) {
                ++Vn, ya(Nn);
              }
              var ht = [], gt = [], Vn = 0;
              if (be === "deleteRange") {
                if (Ie.type === 4) return He({ numFailures: Vn, failures: gt, results: [], lastResult: void 0 });
                Ie.type === 3 ? ht.push($e = Fe.clear()) : ht.push($e = Fe.delete(R(Ie)));
              } else {
                var Ve = Ke ? Ve ? [ze, Ne] : [ze, null] : [Ne, null], ft = Ve[0], kn = Ve[1];
                if (Ke) for (var sn = 0; sn < Je; ++sn) ht.push($e = kn && kn[sn] !== void 0 ? Fe[be](ft[sn], kn[sn]) : Fe[be](ft[sn])), $e.onerror = ot;
                else for (sn = 0; sn < Je; ++sn) ht.push($e = Fe[be](ft[sn])), $e.onerror = ot;
              }
              function ro(Nn) {
                Nn = Nn.target.result, ht.forEach(function(Sr, Iu) {
                  return Sr.error != null && (gt[Iu] = Sr.error);
                }), He({ numFailures: Vn, failures: gt, results: be === "delete" ? Ne : ht.map(function(Sr) {
                  return Sr.result;
                }), lastResult: Nn });
              }
              $e.onerror = function(Nn) {
                ot(Nn), ro(Nn);
              }, $e.onsuccess = ro;
            });
          }, getMany: function(pe) {
            var ye = pe.trans, be = pe.keys;
            return new Promise(function(Ne, ze) {
              Ne = Bt(Ne);
              for (var Ie, He = ye.objectStore(me), Xe = be.length, Fe = new Array(Xe), Ve = 0, Ke = 0, $e = function(ht) {
                ht = ht.target, Fe[ht._pos] = ht.result, ++Ke === Ve && Ne(Fe);
              }, Je = Ir(ze), ot = 0; ot < Xe; ++ot) be[ot] != null && ((Ie = He.get(be[ot]))._pos = ot, Ie.onsuccess = $e, Ie.onerror = Je, ++Ve);
              Ve === 0 && Ne(Fe);
            });
          }, get: function(pe) {
            var ye = pe.trans, be = pe.key;
            return new Promise(function(Ne, ze) {
              Ne = Bt(Ne);
              var Ie = ye.objectStore(me).get(be);
              Ie.onsuccess = function(He) {
                return Ne(He.target.result);
              }, Ie.onerror = Ir(ze);
            });
          }, query: (de = ce, function(pe) {
            return new Promise(function(ye, be) {
              ye = Bt(ye);
              var Ne, ze, Ie, Ve = pe.trans, He = pe.values, Xe = pe.limit, $e = pe.query, Fe = Xe === 1 / 0 ? void 0 : Xe, Ke = $e.index, $e = $e.range, Ve = Ve.objectStore(me), Ke = Ke.isPrimaryKey ? Ve : Ve.index(Ke.name), $e = R($e);
              if (Xe === 0) return ye({ result: [] });
              de ? ((Fe = He ? Ke.getAll($e, Fe) : Ke.getAllKeys($e, Fe)).onsuccess = function(Je) {
                return ye({ result: Je.target.result });
              }, Fe.onerror = Ir(be)) : (Ne = 0, ze = !He && "openKeyCursor" in Ke ? Ke.openKeyCursor($e) : Ke.openCursor($e), Ie = [], ze.onsuccess = function(Je) {
                var ot = ze.result;
                return ot ? (Ie.push(He ? ot.value : ot.primaryKey), ++Ne === Xe ? ye({ result: Ie }) : void ot.continue()) : ye({ result: Ie });
              }, ze.onerror = Ir(be));
            });
          }), openCursor: function(pe) {
            var ye = pe.trans, be = pe.values, Ne = pe.query, ze = pe.reverse, Ie = pe.unique;
            return new Promise(function(He, Xe) {
              He = Bt(He);
              var Ke = Ne.index, Fe = Ne.range, Ve = ye.objectStore(me), Ve = Ke.isPrimaryKey ? Ve : Ve.index(Ke.name), Ke = ze ? Ie ? "prevunique" : "prev" : Ie ? "nextunique" : "next", $e = !be && "openKeyCursor" in Ve ? Ve.openKeyCursor(R(Fe), Ke) : Ve.openCursor(R(Fe), Ke);
              $e.onerror = Ir(Xe), $e.onsuccess = Bt(function(Je) {
                var ot, ht, gt, Vn, ft = $e.result;
                ft ? (ft.___id = ++bd, ft.done = !1, ot = ft.continue.bind(ft), ht = (ht = ft.continuePrimaryKey) && ht.bind(ft), gt = ft.advance.bind(ft), Vn = function() {
                  throw new Error("Cursor not stopped");
                }, ft.trans = ye, ft.stop = ft.continue = ft.continuePrimaryKey = ft.advance = function() {
                  throw new Error("Cursor not started");
                }, ft.fail = Bt(Xe), ft.next = function() {
                  var kn = this, sn = 1;
                  return this.start(function() {
                    return sn-- ? kn.continue() : kn.stop();
                  }).then(function() {
                    return kn;
                  });
                }, ft.start = function(kn) {
                  function sn() {
                    if ($e.result) try {
                      kn();
                    } catch (Nn) {
                      ft.fail(Nn);
                    }
                    else ft.done = !0, ft.start = function() {
                      throw new Error("Cursor behind last entry");
                    }, ft.stop();
                  }
                  var ro = new Promise(function(Nn, Sr) {
                    Nn = Bt(Nn), $e.onerror = Ir(Sr), ft.fail = Sr, ft.stop = function(Iu) {
                      ft.stop = ft.continue = ft.continuePrimaryKey = ft.advance = Vn, Nn(Iu);
                    };
                  });
                  return $e.onsuccess = Bt(function(Nn) {
                    $e.onsuccess = sn, sn();
                  }), ft.continue = ot, ft.continuePrimaryKey = ht, ft.advance = gt, sn(), ro;
                }, He(ft)) : He(null);
              }, Xe);
            });
          }, count: function(pe) {
            var ye = pe.query, be = pe.trans, Ne = ye.index, ze = ye.range;
            return new Promise(function(Ie, He) {
              var Xe = be.objectStore(me), Fe = Ne.isPrimaryKey ? Xe : Xe.index(Ne.name), Xe = R(ze), Fe = Xe ? Fe.count(Xe) : Fe.count();
              Fe.onsuccess = Bt(function(Ve) {
                return Ie(Ve.target.result);
              }), Fe.onerror = Ir(He);
            });
          } };
        }
        var $, Q, ne, ge = (Q = ue, ne = Ws(($ = v).objectStoreNames), { schema: { name: $.name, tables: ne.map(function(xe) {
          return Q.objectStore(xe);
        }).map(function(xe) {
          var de = xe.keyPath, ye = xe.autoIncrement, me = u(de), pe = {}, ye = { name: xe.name, primaryKey: { name: null, isPrimaryKey: !0, outbound: de == null, compound: me, keyPath: de, autoIncrement: ye, unique: !0, extractKey: as(de) }, indexes: Ws(xe.indexNames).map(function(be) {
            return xe.index(be);
          }).map(function(Ie) {
            var Ne = Ie.name, ze = Ie.unique, He = Ie.multiEntry, Ie = Ie.keyPath, He = { name: Ne, compound: u(Ie), keyPath: Ie, unique: ze, multiEntry: He, extractKey: as(Ie) };
            return pe[En(Ie)] = He;
          }), getIndexByKeyPath: function(be) {
            return pe[En(be)];
          } };
          return pe[":id"] = ye.primaryKey, de != null && (pe[En(de)] = ye.primaryKey), ye;
        }) }, hasGetAll: 0 < ne.length && "getAll" in Q.objectStore(ne[0]) && !(typeof navigator < "u" && /Safari/.test(navigator.userAgent) && !/(Chrome\/|Edge\/)/.test(navigator.userAgent) && [].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1] < 604) }), ue = ge.schema, ce = ge.hasGetAll, ge = ue.tables.map(I), se = {};
        return ge.forEach(function(xe) {
          return se[xe.name] = xe;
        }), { stack: "dbcore", transaction: v.transaction.bind(v), table: function(xe) {
          if (!se[xe]) throw new Error("Table '".concat(xe, "' not found"));
          return se[xe];
        }, MIN_KEY: -1 / 0, MAX_KEY: is(_), schema: ue };
      }
      function Qo(v, _, j, R) {
        var I = j.IDBKeyRange;
        return j.indexedDB, { dbcore: (R = va(_, I, R), v.dbcore.reduce(function($, Q) {
          return Q = Q.create, r(r({}, $), Q($));
        }, R)) };
      }
      function Pi(v, R) {
        var j = R.db, R = Qo(v._middlewares, j, v._deps, R);
        v.core = R.dbcore, v.tables.forEach(function(I) {
          var $ = I.name;
          v.core.schema.tables.some(function(Q) {
            return Q.name === $;
          }) && (I.core = v.core.table($), v[$] instanceof v.Table && (v[$].core = I.core));
        });
      }
      function Zo(v, _, j, R) {
        j.forEach(function(I) {
          var $ = R[I];
          _.forEach(function(Q) {
            var ne = (function ue(ce, ge) {
              return k(ce, ge) || (ce = d(ce)) && ue(ce, ge);
            })(Q, I);
            (!ne || "value" in ne && ne.value === void 0) && (Q === v.Transaction.prototype || Q instanceof v.Transaction ? w(Q, I, { get: function() {
              return this.table(I);
            }, set: function(ue) {
              y(this, I, { value: ue, writable: !0, configurable: !0, enumerable: !0 });
            } }) : Q[I] = new v.Table(I, $));
          });
        });
      }
      function Qs(v, _) {
        _.forEach(function(j) {
          for (var R in j) j[R] instanceof v.Table && delete j[R];
        });
      }
      function Su(v, _) {
        return v._cfg.version - _._cfg.version;
      }
      function Zs(v, _, j, R) {
        var I = v._dbSchema;
        j.objectStoreNames.contains("$meta") && !I.$meta && (I.$meta = rs("$meta", _d("")[0], []), v._storeNames.push("$meta"));
        var $ = v._createTransaction("readwrite", v._storeNames, I);
        $.create(j), $._completion.catch(R);
        var Q = $._reject.bind($), ne = Ge.transless || Ge;
        Ut(function() {
          return Ge.trans = $, Ge.transless = ne, _ !== 0 ? (Pi(v, j), ce = _, ((ue = $).storeNames.includes("$meta") ? ue.table("$meta").get("version").then(function(ge) {
            return ge ?? ce;
          }) : Ye.resolve(ce)).then(function(ge) {
            return xe = ge, de = $, me = j, pe = [], ge = (se = v)._versions, ye = se._dbSchema = ss(0, se.idbdb, me), (ge = ge.filter(function(be) {
              return be._cfg.version >= xe;
            })).length !== 0 ? (ge.forEach(function(be) {
              pe.push(function() {
                var Ne = ye, ze = be._cfg.dbschema;
                nl(se, Ne, me), nl(se, ze, me), ye = se._dbSchema = ze;
                var Ie = el(Ne, ze);
                Ie.add.forEach(function(Ke) {
                  Cu(me, Ke[0], Ke[1].primKey, Ke[1].indexes);
                }), Ie.change.forEach(function(Ke) {
                  if (Ke.recreate) throw new we.Upgrade("Not yet support for changing primary key");
                  var $e = me.objectStore(Ke.name);
                  Ke.add.forEach(function(Je) {
                    return tl($e, Je);
                  }), Ke.change.forEach(function(Je) {
                    $e.deleteIndex(Je.name), tl($e, Je);
                  }), Ke.del.forEach(function(Je) {
                    return $e.deleteIndex(Je);
                  });
                });
                var He = be._cfg.contentUpgrade;
                if (He && be._cfg.version > xe) {
                  Pi(se, me), de._memoizedTables = {};
                  var Xe = Y(ze);
                  Ie.del.forEach(function(Ke) {
                    Xe[Ke] = Ne[Ke];
                  }), Qs(se, [se.Transaction.prototype]), Zo(se, [se.Transaction.prototype], l(Xe), Xe), de.schema = Xe;
                  var Fe, Ve = L(He);
                  return Ve && fn(), Ie = Ye.follow(function() {
                    var Ke;
                    (Fe = He(de)) && Ve && (Ke = $n.bind(null, null), Fe.then(Ke, Ke));
                  }), Fe && typeof Fe.then == "function" ? Ye.resolve(Fe) : Ie.then(function() {
                    return Fe;
                  });
                }
              }), pe.push(function(Ne) {
                var ze, Ie, He = be._cfg.dbschema;
                ze = He, Ie = Ne, [].slice.call(Ie.db.objectStoreNames).forEach(function(Xe) {
                  return ze[Xe] == null && Ie.db.deleteObjectStore(Xe);
                }), Qs(se, [se.Transaction.prototype]), Zo(se, [se.Transaction.prototype], se._storeNames, se._dbSchema), de.schema = se._dbSchema;
              }), pe.push(function(Ne) {
                se.idbdb.objectStoreNames.contains("$meta") && (Math.ceil(se.idbdb.version / 10) === be._cfg.version ? (se.idbdb.deleteObjectStore("$meta"), delete se._dbSchema.$meta, se._storeNames = se._storeNames.filter(function(ze) {
                  return ze !== "$meta";
                })) : Ne.objectStore("$meta").put(be._cfg.version, "version"));
              });
            }), (function be() {
              return pe.length ? Ye.resolve(pe.shift()(de.idbtrans)).then(be) : Ye.resolve();
            })().then(function() {
              wd(ye, me);
            })) : Ye.resolve();
            var se, xe, de, me, pe, ye;
          }).catch(Q)) : (l(I).forEach(function(ge) {
            Cu(j, ge, I[ge].primKey, I[ge].indexes);
          }), Pi(v, j), void Ye.follow(function() {
            return v.on.populate.fire($);
          }).catch(Q));
          var ue, ce;
        });
      }
      function Jo(v, _) {
        wd(v._dbSchema, _), _.db.version % 10 != 0 || _.objectStoreNames.contains("$meta") || _.db.createObjectStore("$meta").add(Math.ceil(_.db.version / 10 - 1), "version");
        var j = ss(0, v.idbdb, _);
        nl(v, v._dbSchema, _);
        for (var R = 0, I = el(j, v._dbSchema).change; R < I.length; R++) {
          var $ = (function(Q) {
            if (Q.change.length || Q.recreate) return console.warn("Unable to patch indexes of table ".concat(Q.name, " because it has changes on the type of index or primary key.")), { value: void 0 };
            var ne = _.objectStore(Q.name);
            Q.add.forEach(function(ue) {
              Kt && console.debug("Dexie upgrade patch: Creating missing index ".concat(Q.name, ".").concat(ue.src)), tl(ne, ue);
            });
          })(I[R]);
          if (typeof $ == "object") return $.value;
        }
      }
      function el(v, _) {
        var j, R = { del: [], add: [], change: [] };
        for (j in v) _[j] || R.del.push(j);
        for (j in _) {
          var I = v[j], $ = _[j];
          if (I) {
            var Q = { name: j, def: $, recreate: !1, del: [], add: [], change: [] };
            if ("" + (I.primKey.keyPath || "") != "" + ($.primKey.keyPath || "") || I.primKey.auto !== $.primKey.auto) Q.recreate = !0, R.change.push(Q);
            else {
              var ne = I.idxByName, ue = $.idxByName, ce = void 0;
              for (ce in ne) ue[ce] || Q.del.push(ce);
              for (ce in ue) {
                var ge = ne[ce], se = ue[ce];
                ge ? ge.src !== se.src && Q.change.push(se) : Q.add.push(se);
              }
              (0 < Q.del.length || 0 < Q.add.length || 0 < Q.change.length) && R.change.push(Q);
            }
          } else R.add.push([j, $]);
        }
        return R;
      }
      function Cu(v, _, j, R) {
        var I = v.db.createObjectStore(_, j.keyPath ? { keyPath: j.keyPath, autoIncrement: j.auto } : { autoIncrement: j.auto });
        return R.forEach(function($) {
          return tl(I, $);
        }), I;
      }
      function wd(v, _) {
        l(v).forEach(function(j) {
          _.db.objectStoreNames.contains(j) || (Kt && console.debug("Dexie: Creating missing table", j), Cu(_, j, v[j].primKey, v[j].indexes));
        });
      }
      function tl(v, _) {
        v.createIndex(_.name, _.keyPath, { unique: _.unique, multiEntry: _.multi });
      }
      function ss(v, _, j) {
        var R = {};
        return T(_.objectStoreNames, 0).forEach(function(I) {
          for (var $ = j.objectStore(I), Q = ti(Wo(ce = $.keyPath), ce || "", !0, !1, !!$.autoIncrement, ce && typeof ce != "string", !0), ne = [], ue = 0; ue < $.indexNames.length; ++ue) {
            var ge = $.index($.indexNames[ue]), ce = ge.keyPath, ge = ti(ge.name, ce, !!ge.unique, !!ge.multiEntry, !1, ce && typeof ce != "string", !1);
            ne.push(ge);
          }
          R[I] = rs(I, Q, ne);
        }), R;
      }
      function nl(v, _, j) {
        for (var R = j.db.objectStoreNames, I = 0; I < R.length; ++I) {
          var $ = R[I], Q = j.objectStore($);
          v._hasGetAll = "getAll" in Q;
          for (var ne = 0; ne < Q.indexNames.length; ++ne) {
            var ue = Q.indexNames[ne], ce = Q.index(ue).keyPath, ge = typeof ce == "string" ? ce : "[" + T(ce).join("+") + "]";
            !_[$] || (ce = _[$].idxByName[ge]) && (ce.name = ue, delete _[$].idxByName[ge], _[$].idxByName[ue] = ce);
          }
        }
        typeof navigator < "u" && /Safari/.test(navigator.userAgent) && !/(Chrome\/|Edge\/)/.test(navigator.userAgent) && o.WorkerGlobalScope && o instanceof o.WorkerGlobalScope && [].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1] < 604 && (v._hasGetAll = !1);
      }
      function _d(v) {
        return v.split(",").map(function(_, j) {
          var $ = _.split(":"), R = (I = $[1]) === null || I === void 0 ? void 0 : I.trim(), I = (_ = $[0].trim()).replace(/([&*]|\+\+)/g, ""), $ = /^\[/.test(I) ? I.match(/^\[(.*)\]$/)[1].split("+") : I;
          return ti(I, $ || null, /\&/.test(_), /\*/.test(_), /\+\+/.test(_), u($), j === 0, R);
        });
      }
      var Em = (os.prototype._createTableSchema = rs, os.prototype._parseIndexSyntax = _d, os.prototype._parseStoresSpec = function(v, _) {
        var j = this;
        l(v).forEach(function(R) {
          if (v[R] !== null) {
            var I = j._parseIndexSyntax(v[R]), $ = I.shift();
            if (!$) throw new we.Schema("Invalid schema for table " + R + ": " + v[R]);
            if ($.unique = !0, $.multi) throw new we.Schema("Primary key cannot be multiEntry*");
            I.forEach(function(Q) {
              if (Q.auto) throw new we.Schema("Only primary key can be marked as autoIncrement (++)");
              if (!Q.keyPath) throw new we.Schema("Index must have a name and cannot be an empty string");
            }), I = j._createTableSchema(R, $, I), _[R] = I;
          }
        });
      }, os.prototype.stores = function(j) {
        var _ = this.db;
        this._cfg.storesSource = this._cfg.storesSource ? f(this._cfg.storesSource, j) : j;
        var j = _._versions, R = {}, I = {};
        return j.forEach(function($) {
          f(R, $._cfg.storesSource), I = $._cfg.dbschema = {}, $._parseStoresSpec(R, I);
        }), _._dbSchema = I, Qs(_, [_._allTables, _, _.Transaction.prototype]), Zo(_, [_._allTables, _, _.Transaction.prototype, this._cfg.tables], l(I), I), _._storeNames = l(I), this;
      }, os.prototype.upgrade = function(v) {
        return this._cfg.contentUpgrade = Sn(this._cfg.contentUpgrade || Ae, v), this;
      }, os);
      function os() {
      }
      function Eu(v, _) {
        var j = v._dbNamesDB;
        return j || (j = v._dbNamesDB = new ni(ca, { addons: [], indexedDB: v, IDBKeyRange: _ })).version(1).stores({ dbnames: "name" }), j.table("dbnames");
      }
      function rl(v) {
        return v && typeof v.databases == "function";
      }
      function ku(v) {
        return Ut(function() {
          return Ge.letThrough = !0, v();
        });
      }
      function Nu(v) {
        return !("from" in v);
      }
      var Gn = function(v, _) {
        if (!this) {
          var j = new Gn();
          return v && "d" in v && f(j, v), j;
        }
        f(this, arguments.length ? { d: 1, from: v, to: 1 < arguments.length ? _ : v } : { d: 0 });
      };
      function Js(v, _, j) {
        var R = pt(_, j);
        if (!isNaN(R)) {
          if (0 < R) throw RangeError();
          if (Nu(v)) return f(v, { from: _, to: j, d: 1 });
          var I = v.l, R = v.r;
          if (pt(j, v.from) < 0) return I ? Js(I, _, j) : v.l = { from: _, to: j, d: 1, l: null, r: null }, Cd(v);
          if (0 < pt(_, v.to)) return R ? Js(R, _, j) : v.r = { from: _, to: j, d: 1, l: null, r: null }, Cd(v);
          pt(_, v.from) < 0 && (v.from = _, v.l = null, v.d = R ? R.d + 1 : 1), 0 < pt(j, v.to) && (v.to = j, v.r = null, v.d = v.l ? v.l.d + 1 : 1), j = !v.r, I && !v.l && ba(v, I), R && j && ba(v, R);
        }
      }
      function ba(v, _) {
        Nu(_) || (function j(R, ue) {
          var $ = ue.from, Q = ue.to, ne = ue.l, ue = ue.r;
          Js(R, $, Q), ne && j(R, ne), ue && j(R, ue);
        })(v, _);
      }
      function Sd(v, _) {
        var j = il(_), R = j.next();
        if (R.done) return !1;
        for (var I = R.value, $ = il(v), Q = $.next(I.from), ne = Q.value; !R.done && !Q.done; ) {
          if (pt(ne.from, I.to) <= 0 && 0 <= pt(ne.to, I.from)) return !0;
          pt(I.from, ne.from) < 0 ? I = (R = j.next(ne.from)).value : ne = (Q = $.next(I.from)).value;
        }
        return !1;
      }
      function il(v) {
        var _ = Nu(v) ? null : { s: 0, n: v };
        return { next: function(j) {
          for (var R = 0 < arguments.length; _; ) switch (_.s) {
            case 0:
              if (_.s = 1, R) for (; _.n.l && pt(j, _.n.from) < 0; ) _ = { up: _, n: _.n.l, s: 1 };
              else for (; _.n.l; ) _ = { up: _, n: _.n.l, s: 1 };
            case 1:
              if (_.s = 2, !R || pt(j, _.n.to) <= 0) return { value: _.n, done: !1 };
            case 2:
              if (_.n.r) {
                _.s = 3, _ = { up: _, n: _.n.r, s: 0 };
                continue;
              }
            case 3:
              _ = _.up;
          }
          return { done: !0 };
        } };
      }
      function Cd(v) {
        var _, j, R = (((_ = v.r) === null || _ === void 0 ? void 0 : _.d) || 0) - (((j = v.l) === null || j === void 0 ? void 0 : j.d) || 0), I = 1 < R ? "r" : R < -1 ? "l" : "";
        I && (_ = I == "r" ? "l" : "r", j = r({}, v), R = v[I], v.from = R.from, v.to = R.to, v[I] = R[I], j[I] = R[_], (v[_] = j).d = ju(j)), v.d = ju(v);
      }
      function ju(j) {
        var _ = j.r, j = j.l;
        return (_ ? j ? Math.max(_.d, j.d) : _.d : j ? j.d : 0) + 1;
      }
      function al(v, _) {
        return l(_).forEach(function(j) {
          v[j] ? ba(v[j], _[j]) : v[j] = (function R(I) {
            var $, Q, ne = {};
            for ($ in I) p(I, $) && (Q = I[$], ne[$] = !Q || typeof Q != "object" || B.has(Q.constructor) ? Q : R(Q));
            return ne;
          })(_[j]);
        }), v;
      }
      function Tu(v, _) {
        return v.all || _.all || Object.keys(v).some(function(j) {
          return _[j] && Sd(_[j], v[j]);
        });
      }
      x(Gn.prototype, ((hr = { add: function(v) {
        return ba(this, v), this;
      }, addKey: function(v) {
        return Js(this, v, v), this;
      }, addKeys: function(v) {
        var _ = this;
        return v.forEach(function(j) {
          return Js(_, j, j);
        }), this;
      }, hasKey: function(v) {
        var _ = il(this).next(v).value;
        return _ && pt(_.from, v) <= 0 && 0 <= pt(_.to, v);
      } })[V] = function() {
        return il(this);
      }, hr));
      var wa = {}, Au = {}, Mu = !1;
      function sl(v) {
        al(Au, v), Mu || (Mu = !0, setTimeout(function() {
          Mu = !1, Ru(Au, !(Au = {}));
        }, 0));
      }
      function Ru(v, _) {
        _ === void 0 && (_ = !1);
        var j = /* @__PURE__ */ new Set();
        if (v.all) for (var R = 0, I = Object.values(wa); R < I.length; R++) Ed(Q = I[R], v, j, _);
        else for (var $ in v) {
          var Q, ne = /^idb\:\/\/(.*)\/(.*)\//.exec($);
          ne && ($ = ne[1], ne = ne[2], (Q = wa["idb://".concat($, "/").concat(ne)]) && Ed(Q, v, j, _));
        }
        j.forEach(function(ue) {
          return ue();
        });
      }
      function Ed(v, _, j, R) {
        for (var I = [], $ = 0, Q = Object.entries(v.queries.query); $ < Q.length; $++) {
          for (var ne = Q[$], ue = ne[0], ce = [], ge = 0, se = ne[1]; ge < se.length; ge++) {
            var xe = se[ge];
            Tu(_, xe.obsSet) ? xe.subscribers.forEach(function(ye) {
              return j.add(ye);
            }) : R && ce.push(xe);
          }
          R && I.push([ue, ce]);
        }
        if (R) for (var de = 0, me = I; de < me.length; de++) {
          var pe = me[de], ue = pe[0], ce = pe[1];
          v.queries.query[ue] = ce;
        }
      }
      function km(v) {
        var _ = v._state, j = v._deps.indexedDB;
        if (_.isBeingOpened || v.idbdb) return _.dbReadyPromise.then(function() {
          return _.dbOpenError ? Pt(_.dbOpenError) : v;
        });
        _.isBeingOpened = !0, _.dbOpenError = null, _.openComplete = !1;
        var R = _.openCanceller, I = Math.round(10 * v.verno), $ = !1;
        function Q() {
          if (_.openCanceller !== R) throw new we.DatabaseClosed("db.open() was cancelled");
        }
        function ne() {
          return new Ye(function(xe, de) {
            if (Q(), !j) throw new we.MissingAPI();
            var me = v.name, pe = _.autoSchema || !I ? j.open(me) : j.open(me, I);
            if (!pe) throw new we.MissingAPI();
            pe.onerror = Ir(de), pe.onblocked = Bt(v._fireOnBlocked), pe.onupgradeneeded = Bt(function(ye) {
              var be;
              ge = pe.transaction, _.autoSchema && !v._options.allowEmptyDB ? (pe.onerror = ya, ge.abort(), pe.result.close(), (be = j.deleteDatabase(me)).onsuccess = be.onerror = Bt(function() {
                de(new we.NoSuchDatabase("Database ".concat(me, " doesnt exist")));
              })) : (ge.onerror = Ir(de), ye = ye.oldVersion > Math.pow(2, 62) ? 0 : ye.oldVersion, se = ye < 1, v.idbdb = pe.result, $ && Jo(v, ge), Zs(v, ye / 10, ge, de));
            }, de), pe.onsuccess = Bt(function() {
              ge = null;
              var ye, be, Ne, ze, Ie, He = v.idbdb = pe.result, Xe = T(He.objectStoreNames);
              if (0 < Xe.length) try {
                var Fe = He.transaction((ze = Xe).length === 1 ? ze[0] : ze, "readonly");
                if (_.autoSchema) be = He, Ne = Fe, (ye = v).verno = be.version / 10, Ne = ye._dbSchema = ss(0, be, Ne), ye._storeNames = T(be.objectStoreNames, 0), Zo(ye, [ye._allTables], l(Ne), Ne);
                else if (nl(v, v._dbSchema, Fe), ((Ie = el(ss(0, (Ie = v).idbdb, Fe), Ie._dbSchema)).add.length || Ie.change.some(function(Ve) {
                  return Ve.add.length || Ve.change.length;
                })) && !$) return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."), He.close(), I = He.version + 1, $ = !0, xe(ne());
                Pi(v, Fe);
              } catch {
              }
              xi.push(v), He.onversionchange = Bt(function(Ve) {
                _.vcFired = !0, v.on("versionchange").fire(Ve);
              }), He.onclose = Bt(function() {
                v.close({ disableAutoOpen: !1 });
              }), se && (Ie = v._deps, Fe = me, He = Ie.indexedDB, Ie = Ie.IDBKeyRange, rl(He) || Fe === ca || Eu(He, Ie).put({ name: Fe }).catch(Ae)), xe();
            }, de);
          }).catch(function(xe) {
            switch (xe == null ? void 0 : xe.name) {
              case "UnknownError":
                if (0 < _.PR1398_maxLoop) return _.PR1398_maxLoop--, console.warn("Dexie: Workaround for Chrome UnknownError on open()"), ne();
                break;
              case "VersionError":
                if (0 < I) return I = 0, ne();
            }
            return Ye.reject(xe);
          });
        }
        var ue, ce = _.dbReadyResolve, ge = null, se = !1;
        return Ye.race([R, (typeof navigator > "u" ? Ye.resolve() : !navigator.userAgentData && /Safari\//.test(navigator.userAgent) && !/Chrom(e|ium)\//.test(navigator.userAgent) && indexedDB.databases ? new Promise(function(xe) {
          function de() {
            return indexedDB.databases().finally(xe);
          }
          ue = setInterval(de, 100), de();
        }).finally(function() {
          return clearInterval(ue);
        }) : Promise.resolve()).then(ne)]).then(function() {
          return Q(), _.onReadyBeingFired = [], Ye.resolve(ku(function() {
            return v.on.ready.fire(v.vip);
          })).then(function xe() {
            if (0 < _.onReadyBeingFired.length) {
              var de = _.onReadyBeingFired.reduce(Sn, Ae);
              return _.onReadyBeingFired = [], Ye.resolve(ku(function() {
                return de(v.vip);
              })).then(xe);
            }
          });
        }).finally(function() {
          _.openCanceller === R && (_.onReadyBeingFired = null, _.isBeingOpened = !1);
        }).catch(function(xe) {
          _.dbOpenError = xe;
          try {
            ge && ge.abort();
          } catch {
          }
          return R === _.openCanceller && v._close(), Pt(xe);
        }).finally(function() {
          _.openComplete = !0, ce();
        }).then(function() {
          var xe;
          return se && (xe = {}, v.tables.forEach(function(de) {
            de.schema.indexes.forEach(function(me) {
              me.name && (xe["idb://".concat(v.name, "/").concat(de.name, "/").concat(me.name)] = new Gn(-1 / 0, [[[]]]));
            }), xe["idb://".concat(v.name, "/").concat(de.name, "/")] = xe["idb://".concat(v.name, "/").concat(de.name, "/:dels")] = new Gn(-1 / 0, [[[]]]);
          }), Hn(ns).fire(xe), Ru(xe, !0)), v;
        });
      }
      function eo(v) {
        function _($) {
          return v.next($);
        }
        var j = I(_), R = I(function($) {
          return v.throw($);
        });
        function I($) {
          return function(ue) {
            var ne = $(ue), ue = ne.value;
            return ne.done ? ue : ue && typeof ue.then == "function" ? ue.then(j, R) : u(ue) ? Promise.all(ue).then(j, R) : j(ue);
          };
        }
        return I(_)();
      }
      function Bi(v, _, j) {
        for (var R = u(v) ? v.slice() : [v], I = 0; I < j; ++I) R.push(_);
        return R;
      }
      var Nm = { stack: "dbcore", name: "VirtualIndexMiddleware", level: 1, create: function(v) {
        return r(r({}, v), { table: function(_) {
          var j = v.table(_), R = j.schema, I = {}, $ = [];
          function Q(se, xe, de) {
            var me = En(se), pe = I[me] = I[me] || [], ye = se == null ? 0 : typeof se == "string" ? 1 : se.length, be = 0 < xe, be = r(r({}, de), { name: be ? "".concat(me, "(virtual-from:").concat(de.name, ")") : de.name, lowLevelIndex: de, isVirtual: be, keyTail: xe, keyLength: ye, extractKey: as(se), unique: !be && de.unique });
            return pe.push(be), be.isPrimaryKey || $.push(be), 1 < ye && Q(ye === 2 ? se[0] : se.slice(0, ye - 1), xe + 1, de), pe.sort(function(Ne, ze) {
              return Ne.keyTail - ze.keyTail;
            }), be;
          }
          _ = Q(R.primaryKey.keyPath, 0, R.primaryKey), I[":id"] = [_];
          for (var ne = 0, ue = R.indexes; ne < ue.length; ne++) {
            var ce = ue[ne];
            Q(ce.keyPath, 0, ce);
          }
          function ge(se) {
            var xe, de = se.query.index;
            return de.isVirtual ? r(r({}, se), { query: { index: de.lowLevelIndex, range: (xe = se.query.range, de = de.keyTail, { type: xe.type === 1 ? 2 : xe.type, lower: Bi(xe.lower, xe.lowerOpen ? v.MAX_KEY : v.MIN_KEY, de), lowerOpen: !0, upper: Bi(xe.upper, xe.upperOpen ? v.MIN_KEY : v.MAX_KEY, de), upperOpen: !0 }) } }) : se;
          }
          return r(r({}, j), { schema: r(r({}, R), { primaryKey: _, indexes: $, getIndexByKeyPath: function(se) {
            return (se = I[En(se)]) && se[0];
          } }), count: function(se) {
            return j.count(ge(se));
          }, query: function(se) {
            return j.query(ge(se));
          }, openCursor: function(se) {
            var xe = se.query.index, de = xe.keyTail, me = xe.isVirtual, pe = xe.keyLength;
            return me ? j.openCursor(ge(se)).then(function(be) {
              return be && ye(be);
            }) : j.openCursor(se);
            function ye(be) {
              return Object.create(be, { continue: { value: function(Ne) {
                Ne != null ? be.continue(Bi(Ne, se.reverse ? v.MAX_KEY : v.MIN_KEY, de)) : se.unique ? be.continue(be.key.slice(0, pe).concat(se.reverse ? v.MIN_KEY : v.MAX_KEY, de)) : be.continue();
              } }, continuePrimaryKey: { value: function(Ne, ze) {
                be.continuePrimaryKey(Bi(Ne, v.MAX_KEY, de), ze);
              } }, primaryKey: { get: function() {
                return be.primaryKey;
              } }, key: { get: function() {
                var Ne = be.key;
                return pe === 1 ? Ne[0] : Ne.slice(0, pe);
              } }, value: { get: function() {
                return be.value;
              } } });
            }
          } });
        } });
      } };
      function ol(v, _, j, R) {
        return j = j || {}, R = R || "", l(v).forEach(function(I) {
          var $, Q, ne;
          p(_, I) ? ($ = v[I], Q = _[I], typeof $ == "object" && typeof Q == "object" && $ && Q ? (ne = W($)) !== W(Q) ? j[R + I] = _[I] : ne === "Object" ? ol($, Q, j, R + I + ".") : $ !== Q && (j[R + I] = _[I]) : $ !== Q && (j[R + I] = _[I])) : j[R + I] = void 0;
        }), l(_).forEach(function(I) {
          p(v, I) || (j[R + I] = _[I]);
        }), j;
      }
      function ll(v, _) {
        return _.type === "delete" ? _.keys : _.keys || _.values.map(v.extractKey);
      }
      var kd = { stack: "dbcore", name: "HooksMiddleware", level: 2, create: function(v) {
        return r(r({}, v), { table: function(_) {
          var j = v.table(_), R = j.schema.primaryKey;
          return r(r({}, j), { mutate: function(I) {
            var $ = Ge.trans, Q = $.table(_).hook, ne = Q.deleting, ue = Q.creating, ce = Q.updating;
            switch (I.type) {
              case "add":
                if (ue.fire === Ae) break;
                return $._promise("readwrite", function() {
                  return ge(I);
                }, !0);
              case "put":
                if (ue.fire === Ae && ce.fire === Ae) break;
                return $._promise("readwrite", function() {
                  return ge(I);
                }, !0);
              case "delete":
                if (ne.fire === Ae) break;
                return $._promise("readwrite", function() {
                  return ge(I);
                }, !0);
              case "deleteRange":
                if (ne.fire === Ae) break;
                return $._promise("readwrite", function() {
                  return (function se(xe, de, me) {
                    return j.query({ trans: xe, values: !1, query: { index: R, range: de }, limit: me }).then(function(pe) {
                      var ye = pe.result;
                      return ge({ type: "delete", keys: ye, trans: xe }).then(function(be) {
                        return 0 < be.numFailures ? Promise.reject(be.failures[0]) : ye.length < me ? { failures: [], numFailures: 0, lastResult: void 0 } : se(xe, r(r({}, de), { lower: ye[ye.length - 1], lowerOpen: !0 }), me);
                      });
                    });
                  })(I.trans, I.range, 1e4);
                }, !0);
            }
            return j.mutate(I);
            function ge(se) {
              var xe, de, me, pe = Ge.trans, ye = se.keys || ll(R, se);
              if (!ye) throw new Error("Keys missing");
              return (se = se.type === "add" || se.type === "put" ? r(r({}, se), { keys: ye }) : r({}, se)).type !== "delete" && (se.values = a([], se.values)), se.keys && (se.keys = a([], se.keys)), xe = j, me = ye, ((de = se).type === "add" ? Promise.resolve([]) : xe.getMany({ trans: de.trans, keys: me, cache: "immutable" })).then(function(be) {
                var Ne = ye.map(function(ze, Ie) {
                  var He, Xe, Fe, Ve = be[Ie], Ke = { onerror: null, onsuccess: null };
                  return se.type === "delete" ? ne.fire.call(Ke, ze, Ve, pe) : se.type === "add" || Ve === void 0 ? (He = ue.fire.call(Ke, ze, se.values[Ie], pe), ze == null && He != null && (se.keys[Ie] = ze = He, R.outbound || O(se.values[Ie], R.keyPath, ze))) : (He = ol(Ve, se.values[Ie]), (Xe = ce.fire.call(Ke, He, ze, Ve, pe)) && (Fe = se.values[Ie], Object.keys(Xe).forEach(function($e) {
                    p(Fe, $e) ? Fe[$e] = Xe[$e] : O(Fe, $e, Xe[$e]);
                  }))), Ke;
                });
                return j.mutate(se).then(function(ze) {
                  for (var Ie = ze.failures, He = ze.results, Xe = ze.numFailures, ze = ze.lastResult, Fe = 0; Fe < ye.length; ++Fe) {
                    var Ve = (He || ye)[Fe], Ke = Ne[Fe];
                    Ve == null ? Ke.onerror && Ke.onerror(Ie[Fe]) : Ke.onsuccess && Ke.onsuccess(se.type === "put" && be[Fe] ? se.values[Fe] : Ve);
                  }
                  return { failures: Ie, results: He, numFailures: Xe, lastResult: ze };
                }).catch(function(ze) {
                  return Ne.forEach(function(Ie) {
                    return Ie.onerror && Ie.onerror(ze);
                  }), Promise.reject(ze);
                });
              });
            }
          } });
        } });
      } };
      function zu(v, _, j) {
        try {
          if (!_ || _.keys.length < v.length) return null;
          for (var R = [], I = 0, $ = 0; I < _.keys.length && $ < v.length; ++I) pt(_.keys[I], v[$]) === 0 && (R.push(j ? re(_.values[I]) : _.values[I]), ++$);
          return R.length === v.length ? R : null;
        } catch {
          return null;
        }
      }
      var Nd = { stack: "dbcore", level: -1, create: function(v) {
        return { table: function(_) {
          var j = v.table(_);
          return r(r({}, j), { getMany: function(R) {
            if (!R.cache) return j.getMany(R);
            var I = zu(R.keys, R.trans._cache, R.cache === "clone");
            return I ? Ye.resolve(I) : j.getMany(R).then(function($) {
              return R.trans._cache = { keys: R.keys, values: R.cache === "clone" ? re($) : $ }, $;
            });
          }, mutate: function(R) {
            return R.type !== "add" && (R.trans._cache = null), j.mutate(R);
          } });
        } };
      } };
      function _a(v, _) {
        return v.trans.mode === "readonly" && !!v.subscr && !v.trans.explicit && v.trans.db._options.cache !== "disabled" && !_.schema.primaryKey.outbound;
      }
      function jd(v, _) {
        switch (v) {
          case "query":
            return _.values && !_.unique;
          case "get":
          case "getMany":
          case "count":
          case "openCursor":
            return !1;
        }
      }
      var jm = { stack: "dbcore", level: 0, name: "Observability", create: function(v) {
        var _ = v.schema.name, j = new Gn(v.MIN_KEY, v.MAX_KEY);
        return r(r({}, v), { transaction: function(R, I, $) {
          if (Ge.subscr && I !== "readonly") throw new we.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Ge.querier));
          return v.transaction(R, I, $);
        }, table: function(R) {
          var I = v.table(R), $ = I.schema, Q = $.primaryKey, se = $.indexes, ne = Q.extractKey, ue = Q.outbound, ce = Q.autoIncrement && se.filter(function(de) {
            return de.compound && de.keyPath.includes(Q.keyPath);
          }), ge = r(r({}, I), { mutate: function(de) {
            function me($e) {
              return $e = "idb://".concat(_, "/").concat(R, "/").concat($e), ze[$e] || (ze[$e] = new Gn());
            }
            var pe, ye, be, Ne = de.trans, ze = de.mutatedParts || (de.mutatedParts = {}), Ie = me(""), He = me(":dels"), Xe = de.type, Ke = de.type === "deleteRange" ? [de.range] : de.type === "delete" ? [de.keys] : de.values.length < 50 ? [ll(Q, de).filter(function($e) {
              return $e;
            }), de.values] : [], Fe = Ke[0], Ve = Ke[1], Ke = de.trans._cache;
            return u(Fe) ? (Ie.addKeys(Fe), (Ke = Xe === "delete" || Fe.length === Ve.length ? zu(Fe, Ke) : null) || He.addKeys(Fe), (Ke || Ve) && (pe = me, ye = Ke, be = Ve, $.indexes.forEach(function($e) {
              var Je = pe($e.name || "");
              function ot(gt) {
                return gt != null ? $e.extractKey(gt) : null;
              }
              function ht(gt) {
                return $e.multiEntry && u(gt) ? gt.forEach(function(Vn) {
                  return Je.addKey(Vn);
                }) : Je.addKey(gt);
              }
              (ye || be).forEach(function(gt, kn) {
                var ft = ye && ot(ye[kn]), kn = be && ot(be[kn]);
                pt(ft, kn) !== 0 && (ft != null && ht(ft), kn != null && ht(kn));
              });
            }))) : Fe ? (Ve = { from: (Ve = Fe.lower) !== null && Ve !== void 0 ? Ve : v.MIN_KEY, to: (Ve = Fe.upper) !== null && Ve !== void 0 ? Ve : v.MAX_KEY }, He.add(Ve), Ie.add(Ve)) : (Ie.add(j), He.add(j), $.indexes.forEach(function($e) {
              return me($e.name).add(j);
            })), I.mutate(de).then(function($e) {
              return !Fe || de.type !== "add" && de.type !== "put" || (Ie.addKeys($e.results), ce && ce.forEach(function(Je) {
                for (var ot = de.values.map(function(ft) {
                  return Je.extractKey(ft);
                }), ht = Je.keyPath.findIndex(function(ft) {
                  return ft === Q.keyPath;
                }), gt = 0, Vn = $e.results.length; gt < Vn; ++gt) ot[gt][ht] = $e.results[gt];
                me(Je.name).addKeys(ot);
              })), Ne.mutatedParts = al(Ne.mutatedParts || {}, ze), $e;
            });
          } }), se = function(me) {
            var pe = me.query, me = pe.index, pe = pe.range;
            return [me, new Gn((me = pe.lower) !== null && me !== void 0 ? me : v.MIN_KEY, (pe = pe.upper) !== null && pe !== void 0 ? pe : v.MAX_KEY)];
          }, xe = { get: function(de) {
            return [Q, new Gn(de.key)];
          }, getMany: function(de) {
            return [Q, new Gn().addKeys(de.keys)];
          }, count: se, query: se, openCursor: se };
          return l(xe).forEach(function(de) {
            ge[de] = function(me) {
              var pe = Ge.subscr, ye = !!pe, be = _a(Ge, I) && jd(de, me) ? me.obsSet = {} : pe;
              if (ye) {
                var Ne = function(Ve) {
                  return Ve = "idb://".concat(_, "/").concat(R, "/").concat(Ve), be[Ve] || (be[Ve] = new Gn());
                }, ze = Ne(""), Ie = Ne(":dels"), pe = xe[de](me), ye = pe[0], pe = pe[1];
                if ((de === "query" && ye.isPrimaryKey && !me.values ? Ie : Ne(ye.name || "")).add(pe), !ye.isPrimaryKey) {
                  if (de !== "count") {
                    var He = de === "query" && ue && me.values && I.query(r(r({}, me), { values: !1 }));
                    return I[de].apply(this, arguments).then(function(Ve) {
                      if (de === "query") {
                        if (ue && me.values) return He.then(function(ot) {
                          return ot = ot.result, ze.addKeys(ot), Ve;
                        });
                        var Ke = me.values ? Ve.result.map(ne) : Ve.result;
                        (me.values ? ze : Ie).addKeys(Ke);
                      } else if (de === "openCursor") {
                        var $e = Ve, Je = me.values;
                        return $e && Object.create($e, { key: { get: function() {
                          return Ie.addKey($e.primaryKey), $e.key;
                        } }, primaryKey: { get: function() {
                          var ot = $e.primaryKey;
                          return Ie.addKey(ot), ot;
                        } }, value: { get: function() {
                          return Je && ze.addKey($e.primaryKey), $e.value;
                        } } });
                      }
                      return Ve;
                    });
                  }
                  Ie.add(j);
                }
              }
              return I[de].apply(this, arguments);
            };
          }), ge;
        } });
      } };
      function Td(v, _, j) {
        if (j.numFailures === 0) return _;
        if (_.type === "deleteRange") return null;
        var R = _.keys ? _.keys.length : "values" in _ && _.values ? _.values.length : 1;
        return j.numFailures === R ? null : (_ = r({}, _), u(_.keys) && (_.keys = _.keys.filter(function(I, $) {
          return !($ in j.failures);
        })), "values" in _ && u(_.values) && (_.values = _.values.filter(function(I, $) {
          return !($ in j.failures);
        })), _);
      }
      function ul(v, _) {
        return j = v, ((R = _).lower === void 0 || (R.lowerOpen ? 0 < pt(j, R.lower) : 0 <= pt(j, R.lower))) && (v = v, (_ = _).upper === void 0 || (_.upperOpen ? pt(v, _.upper) < 0 : pt(v, _.upper) <= 0));
        var j, R;
      }
      function Ou(v, _, xe, R, I, $) {
        if (!xe || xe.length === 0) return v;
        var Q = _.query.index, ne = Q.multiEntry, ue = _.query.range, ce = R.schema.primaryKey.extractKey, ge = Q.extractKey, se = (Q.lowLevelIndex || Q).extractKey, xe = xe.reduce(function(de, me) {
          var pe = de, ye = [];
          if (me.type === "add" || me.type === "put") for (var be = new Gn(), Ne = me.values.length - 1; 0 <= Ne; --Ne) {
            var ze, Ie = me.values[Ne], He = ce(Ie);
            be.hasKey(He) || (ze = ge(Ie), (ne && u(ze) ? ze.some(function($e) {
              return ul($e, ue);
            }) : ul(ze, ue)) && (be.addKey(He), ye.push(Ie)));
          }
          switch (me.type) {
            case "add":
              var Xe = new Gn().addKeys(_.values ? de.map(function(Je) {
                return ce(Je);
              }) : de), pe = de.concat(_.values ? ye.filter(function(Je) {
                return Je = ce(Je), !Xe.hasKey(Je) && (Xe.addKey(Je), !0);
              }) : ye.map(function(Je) {
                return ce(Je);
              }).filter(function(Je) {
                return !Xe.hasKey(Je) && (Xe.addKey(Je), !0);
              }));
              break;
            case "put":
              var Fe = new Gn().addKeys(me.values.map(function(Je) {
                return ce(Je);
              }));
              pe = de.filter(function(Je) {
                return !Fe.hasKey(_.values ? ce(Je) : Je);
              }).concat(_.values ? ye : ye.map(function(Je) {
                return ce(Je);
              }));
              break;
            case "delete":
              var Ve = new Gn().addKeys(me.keys);
              pe = de.filter(function(Je) {
                return !Ve.hasKey(_.values ? ce(Je) : Je);
              });
              break;
            case "deleteRange":
              var Ke = me.range;
              pe = de.filter(function(Je) {
                return !ul(ce(Je), Ke);
              });
          }
          return pe;
        }, v);
        return xe === v ? v : (xe.sort(function(de, me) {
          return pt(se(de), se(me)) || pt(ce(de), ce(me));
        }), _.limit && _.limit < 1 / 0 && (xe.length > _.limit ? xe.length = _.limit : v.length === _.limit && xe.length < _.limit && (I.dirty = !0)), $ ? Object.freeze(xe) : xe);
      }
      function ls(v, _) {
        return pt(v.lower, _.lower) === 0 && pt(v.upper, _.upper) === 0 && !!v.lowerOpen == !!_.lowerOpen && !!v.upperOpen == !!_.upperOpen;
      }
      function to(v, _) {
        return (function(j, R, I, $) {
          if (j === void 0) return R !== void 0 ? -1 : 0;
          if (R === void 0) return 1;
          if ((R = pt(j, R)) === 0) {
            if (I && $) return 0;
            if (I) return 1;
            if ($) return -1;
          }
          return R;
        })(v.lower, _.lower, v.lowerOpen, _.lowerOpen) <= 0 && 0 <= (function(j, R, I, $) {
          if (j === void 0) return R !== void 0 ? 1 : 0;
          if (R === void 0) return -1;
          if ((R = pt(j, R)) === 0) {
            if (I && $) return 0;
            if (I) return -1;
            if ($) return 1;
          }
          return R;
        })(v.upper, _.upper, v.upperOpen, _.upperOpen);
      }
      function Tm(v, _, j, R) {
        v.subscribers.add(j), R.addEventListener("abort", function() {
          var I, $;
          v.subscribers.delete(j), v.subscribers.size === 0 && (I = v, $ = _, setTimeout(function() {
            I.subscribers.size === 0 && te($, I);
          }, 3e3));
        });
      }
      var cl = { stack: "dbcore", level: 0, name: "Cache", create: function(v) {
        var _ = v.schema.name;
        return r(r({}, v), { transaction: function(j, R, I) {
          var $, Q, ne = v.transaction(j, R, I);
          return R === "readwrite" && (Q = ($ = new AbortController()).signal, I = function(ue) {
            return function() {
              if ($.abort(), R === "readwrite") {
                for (var ce = /* @__PURE__ */ new Set(), ge = 0, se = j; ge < se.length; ge++) {
                  var xe = se[ge], de = wa["idb://".concat(_, "/").concat(xe)];
                  if (de) {
                    var me = v.table(xe), pe = de.optimisticOps.filter(function(Je) {
                      return Je.trans === ne;
                    });
                    if (ne._explicit && ue && ne.mutatedParts) for (var ye = 0, be = Object.values(de.queries.query); ye < be.length; ye++) for (var Ne = 0, ze = (Xe = be[ye]).slice(); Ne < ze.length; Ne++) Tu((Fe = ze[Ne]).obsSet, ne.mutatedParts) && (te(Xe, Fe), Fe.subscribers.forEach(function(Je) {
                      return ce.add(Je);
                    }));
                    else if (0 < pe.length) {
                      de.optimisticOps = de.optimisticOps.filter(function(Je) {
                        return Je.trans !== ne;
                      });
                      for (var Ie = 0, He = Object.values(de.queries.query); Ie < He.length; Ie++) for (var Xe, Fe, Ve, Ke = 0, $e = (Xe = He[Ie]).slice(); Ke < $e.length; Ke++) (Fe = $e[Ke]).res != null && ne.mutatedParts && (ue && !Fe.dirty ? (Ve = Object.isFrozen(Fe.res), Ve = Ou(Fe.res, Fe.req, pe, me, Fe, Ve), Fe.dirty ? (te(Xe, Fe), Fe.subscribers.forEach(function(Je) {
                        return ce.add(Je);
                      })) : Ve !== Fe.res && (Fe.res = Ve, Fe.promise = Ye.resolve({ result: Ve }))) : (Fe.dirty && te(Xe, Fe), Fe.subscribers.forEach(function(Je) {
                        return ce.add(Je);
                      })));
                    }
                  }
                }
                ce.forEach(function(Je) {
                  return Je();
                });
              }
            };
          }, ne.addEventListener("abort", I(!1), { signal: Q }), ne.addEventListener("error", I(!1), { signal: Q }), ne.addEventListener("complete", I(!0), { signal: Q })), ne;
        }, table: function(j) {
          var R = v.table(j), I = R.schema.primaryKey;
          return r(r({}, R), { mutate: function($) {
            var Q = Ge.trans;
            if (I.outbound || Q.db._options.cache === "disabled" || Q.explicit || Q.idbtrans.mode !== "readwrite") return R.mutate($);
            var ne = wa["idb://".concat(_, "/").concat(j)];
            return ne ? (Q = R.mutate($), $.type !== "add" && $.type !== "put" || !(50 <= $.values.length || ll(I, $).some(function(ue) {
              return ue == null;
            })) ? (ne.optimisticOps.push($), $.mutatedParts && sl($.mutatedParts), Q.then(function(ue) {
              0 < ue.numFailures && (te(ne.optimisticOps, $), (ue = Td(0, $, ue)) && ne.optimisticOps.push(ue), $.mutatedParts && sl($.mutatedParts));
            }), Q.catch(function() {
              te(ne.optimisticOps, $), $.mutatedParts && sl($.mutatedParts);
            })) : Q.then(function(ue) {
              var ce = Td(0, r(r({}, $), { values: $.values.map(function(ge, se) {
                var xe;
                return ue.failures[se] ? ge : (ge = (xe = I.keyPath) !== null && xe !== void 0 && xe.includes(".") ? re(ge) : r({}, ge), O(ge, I.keyPath, ue.results[se]), ge);
              }) }), ue);
              ne.optimisticOps.push(ce), queueMicrotask(function() {
                return $.mutatedParts && sl($.mutatedParts);
              });
            }), Q) : R.mutate($);
          }, query: function($) {
            if (!_a(Ge, R) || !jd("query", $)) return R.query($);
            var Q = ((ce = Ge.trans) === null || ce === void 0 ? void 0 : ce.db._options.cache) === "immutable", se = Ge, ne = se.requery, ue = se.signal, ce = (function(me, pe, ye, be) {
              var Ne = wa["idb://".concat(me, "/").concat(pe)];
              if (!Ne) return [];
              if (!(pe = Ne.queries[ye])) return [null, !1, Ne, null];
              var ze = pe[(be.query ? be.query.index.name : null) || ""];
              if (!ze) return [null, !1, Ne, null];
              switch (ye) {
                case "query":
                  var Ie = ze.find(function(He) {
                    return He.req.limit === be.limit && He.req.values === be.values && ls(He.req.query.range, be.query.range);
                  });
                  return Ie ? [Ie, !0, Ne, ze] : [ze.find(function(He) {
                    return ("limit" in He.req ? He.req.limit : 1 / 0) >= be.limit && (!be.values || He.req.values) && to(He.req.query.range, be.query.range);
                  }), !1, Ne, ze];
                case "count":
                  return Ie = ze.find(function(He) {
                    return ls(He.req.query.range, be.query.range);
                  }), [Ie, !!Ie, Ne, ze];
              }
            })(_, j, "query", $), ge = ce[0], se = ce[1], xe = ce[2], de = ce[3];
            return ge && se ? ge.obsSet = $.obsSet : (se = R.query($).then(function(me) {
              var pe = me.result;
              if (ge && (ge.res = pe), Q) {
                for (var ye = 0, be = pe.length; ye < be; ++ye) Object.freeze(pe[ye]);
                Object.freeze(pe);
              } else me.result = re(pe);
              return me;
            }).catch(function(me) {
              return de && ge && te(de, ge), Promise.reject(me);
            }), ge = { obsSet: $.obsSet, promise: se, subscribers: /* @__PURE__ */ new Set(), type: "query", req: $, dirty: !1 }, de ? de.push(ge) : (de = [ge], (xe = xe || (wa["idb://".concat(_, "/").concat(j)] = { queries: { query: {}, count: {} }, objs: /* @__PURE__ */ new Map(), optimisticOps: [], unsignaledParts: {} })).queries.query[$.query.index.name || ""] = de)), Tm(ge, de, ne, ue), ge.promise.then(function(me) {
              return { result: Ou(me.result, $, xe == null ? void 0 : xe.optimisticOps, R, ge, Q) };
            });
          } });
        } });
      } };
      function no(v, _) {
        return new Proxy(v, { get: function(j, R, I) {
          return R === "db" ? _ : Reflect.get(j, R, I);
        } });
      }
      var ni = (nn.prototype.version = function(v) {
        if (isNaN(v) || v < 0.1) throw new we.Type("Given version is not a positive number");
        if (v = Math.round(10 * v) / 10, this.idbdb || this._state.isBeingOpened) throw new we.Schema("Cannot add version when database is open");
        this.verno = Math.max(this.verno, v);
        var _ = this._versions, j = _.filter(function(R) {
          return R._cfg.version === v;
        })[0];
        return j || (j = new this.Version(v), _.push(j), _.sort(Su), j.stores({}), this._state.autoSchema = !1, j);
      }, nn.prototype._whenReady = function(v) {
        var _ = this;
        return this.idbdb && (this._state.openComplete || Ge.letThrough || this._vip) ? v() : new Ye(function(j, R) {
          if (_._state.openComplete) return R(new we.DatabaseClosed(_._state.dbOpenError));
          if (!_._state.isBeingOpened) {
            if (!_._state.autoOpen) return void R(new we.DatabaseClosed());
            _.open().catch(Ae);
          }
          _._state.dbReadyPromise.then(j, R);
        }).then(v);
      }, nn.prototype.use = function(v) {
        var _ = v.stack, j = v.create, R = v.level, I = v.name;
        return I && this.unuse({ stack: _, name: I }), v = this._middlewares[_] || (this._middlewares[_] = []), v.push({ stack: _, create: j, level: R ?? 10, name: I }), v.sort(function($, Q) {
          return $.level - Q.level;
        }), this;
      }, nn.prototype.unuse = function(v) {
        var _ = v.stack, j = v.name, R = v.create;
        return _ && this._middlewares[_] && (this._middlewares[_] = this._middlewares[_].filter(function(I) {
          return R ? I.create !== R : !!j && I.name !== j;
        })), this;
      }, nn.prototype.open = function() {
        var v = this;
        return dr(en, function() {
          return km(v);
        });
      }, nn.prototype._close = function() {
        this.on.close.fire(new CustomEvent("close"));
        var v = this._state, _ = xi.indexOf(this);
        if (0 <= _ && xi.splice(_, 1), this.idbdb) {
          try {
            this.idbdb.close();
          } catch {
          }
          this.idbdb = null;
        }
        v.isBeingOpened || (v.dbReadyPromise = new Ye(function(j) {
          v.dbReadyResolve = j;
        }), v.openCanceller = new Ye(function(j, R) {
          v.cancelOpen = R;
        }));
      }, nn.prototype.close = function(j) {
        var _ = (j === void 0 ? { disableAutoOpen: !0 } : j).disableAutoOpen, j = this._state;
        _ ? (j.isBeingOpened && j.cancelOpen(new we.DatabaseClosed()), this._close(), j.autoOpen = !1, j.dbOpenError = new we.DatabaseClosed()) : (this._close(), j.autoOpen = this._options.autoOpen || j.isBeingOpened, j.openComplete = !1, j.dbOpenError = null);
      }, nn.prototype.delete = function(v) {
        var _ = this;
        v === void 0 && (v = { disableAutoOpen: !0 });
        var j = 0 < arguments.length && typeof arguments[0] != "object", R = this._state;
        return new Ye(function(I, $) {
          function Q() {
            _.close(v);
            var ne = _._deps.indexedDB.deleteDatabase(_.name);
            ne.onsuccess = Bt(function() {
              var ue, ce, ge;
              ue = _._deps, ce = _.name, ge = ue.indexedDB, ue = ue.IDBKeyRange, rl(ge) || ce === ca || Eu(ge, ue).delete(ce).catch(Ae), I();
            }), ne.onerror = Ir($), ne.onblocked = _._fireOnBlocked;
          }
          if (j) throw new we.InvalidArgument("Invalid closeOptions argument to db.delete()");
          R.isBeingOpened ? R.dbReadyPromise.then(Q) : Q();
        });
      }, nn.prototype.backendDB = function() {
        return this.idbdb;
      }, nn.prototype.isOpen = function() {
        return this.idbdb !== null;
      }, nn.prototype.hasBeenClosed = function() {
        var v = this._state.dbOpenError;
        return v && v.name === "DatabaseClosed";
      }, nn.prototype.hasFailed = function() {
        return this._state.dbOpenError !== null;
      }, nn.prototype.dynamicallyOpened = function() {
        return this._state.autoSchema;
      }, Object.defineProperty(nn.prototype, "tables", { get: function() {
        var v = this;
        return l(this._allTables).map(function(_) {
          return v._allTables[_];
        });
      }, enumerable: !1, configurable: !0 }), nn.prototype.transaction = function() {
        var v = (function(_, j, R) {
          var I = arguments.length;
          if (I < 2) throw new we.InvalidArgument("Too few arguments");
          for (var $ = new Array(I - 1); --I; ) $[I - 1] = arguments[I];
          return R = $.pop(), [_, U($), R];
        }).apply(this, arguments);
        return this._transaction.apply(this, v);
      }, nn.prototype._transaction = function(v, _, j) {
        var R = this, I = Ge.trans;
        I && I.db === this && v.indexOf("!") === -1 || (I = null);
        var $, Q, ne = v.indexOf("?") !== -1;
        v = v.replace("!", "").replace("?", "");
        try {
          if (Q = _.map(function(ce) {
            if (ce = ce instanceof R.Table ? ce.name : ce, typeof ce != "string") throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");
            return ce;
          }), v == "r" || v === Dr) $ = Dr;
          else {
            if (v != "rw" && v != Jr) throw new we.InvalidArgument("Invalid transaction mode: " + v);
            $ = Jr;
          }
          if (I) {
            if (I.mode === Dr && $ === Jr) {
              if (!ne) throw new we.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");
              I = null;
            }
            I && Q.forEach(function(ce) {
              if (I && I.storeNames.indexOf(ce) === -1) {
                if (!ne) throw new we.SubTransaction("Table " + ce + " not included in parent transaction.");
                I = null;
              }
            }), ne && I && !I.active && (I = null);
          }
        } catch (ce) {
          return I ? I._promise(null, function(ge, se) {
            se(ce);
          }) : Pt(ce);
        }
        var ue = (function ce(ge, se, xe, de, me) {
          return Ye.resolve().then(function() {
            var pe = Ge.transless || Ge, ye = ge._createTransaction(se, xe, ge._dbSchema, de);
            if (ye.explicit = !0, pe = { trans: ye, transless: pe }, de) ye.idbtrans = de.idbtrans;
            else try {
              ye.create(), ye.idbtrans._explicit = !0, ge._state.PR1398_maxLoop = 3;
            } catch (ze) {
              return ze.name === Se.InvalidState && ge.isOpen() && 0 < --ge._state.PR1398_maxLoop ? (console.warn("Dexie: Need to reopen db"), ge.close({ disableAutoOpen: !1 }), ge.open().then(function() {
                return ce(ge, se, xe, null, me);
              })) : Pt(ze);
            }
            var be, Ne = L(me);
            return Ne && fn(), pe = Ye.follow(function() {
              var ze;
              (be = me.call(ye, ye)) && (Ne ? (ze = $n.bind(null, null), be.then(ze, ze)) : typeof be.next == "function" && typeof be.throw == "function" && (be = eo(be)));
            }, pe), (be && typeof be.then == "function" ? Ye.resolve(be).then(function(ze) {
              return ye.active ? ze : Pt(new we.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"));
            }) : pe.then(function() {
              return be;
            })).then(function(ze) {
              return de && ye._resolve(), ye._completion.then(function() {
                return ze;
              });
            }).catch(function(ze) {
              return ye._reject(ze), Pt(ze);
            });
          });
        }).bind(null, this, $, Q, I, j);
        return I ? I._promise($, ue, "lock") : Ge.trans ? dr(Ge.transless, function() {
          return R._whenReady(ue);
        }) : this._whenReady(ue);
      }, nn.prototype.table = function(v) {
        if (!p(this._allTables, v)) throw new we.InvalidTable("Table ".concat(v, " does not exist"));
        return this._allTables[v];
      }, nn);
      function nn(v, _) {
        var j = this;
        this._middlewares = {}, this.verno = 0;
        var R = nn.dependencies;
        this._options = _ = r({ addons: nn.addons, autoOpen: !0, indexedDB: R.indexedDB, IDBKeyRange: R.IDBKeyRange, cache: "cloned" }, _), this._deps = { indexedDB: _.indexedDB, IDBKeyRange: _.IDBKeyRange }, R = _.addons, this._dbSchema = {}, this._versions = [], this._storeNames = [], this._allTables = {}, this.idbdb = null, this._novip = this;
        var I, $, Q, ne, ue, ce = { dbOpenError: null, isBeingOpened: !1, onReadyBeingFired: null, openComplete: !1, dbReadyResolve: Ae, dbReadyPromise: null, cancelOpen: Ae, openCanceller: null, autoSchema: !0, PR1398_maxLoop: 3, autoOpen: _.autoOpen };
        ce.dbReadyPromise = new Ye(function(se) {
          ce.dbReadyResolve = se;
        }), ce.openCanceller = new Ye(function(se, xe) {
          ce.cancelOpen = xe;
        }), this._state = ce, this.name = v, this.on = ha(this, "populate", "blocked", "versionchange", "close", { ready: [Sn, Ae] }), this.once = function(se, xe) {
          var de = function() {
            for (var me = [], pe = 0; pe < arguments.length; pe++) me[pe] = arguments[pe];
            j.on(se).unsubscribe(de), xe.apply(j, me);
          };
          return j.on(se, de);
        }, this.on.ready.subscribe = N(this.on.ready.subscribe, function(se) {
          return function(xe, de) {
            nn.vip(function() {
              var me, pe = j._state;
              pe.openComplete ? (pe.dbOpenError || Ye.resolve().then(xe), de && se(xe)) : pe.onReadyBeingFired ? (pe.onReadyBeingFired.push(xe), de && se(xe)) : (se(xe), me = j, de || se(function ye() {
                me.on.ready.unsubscribe(xe), me.on.ready.unsubscribe(ye);
              }));
            });
          };
        }), this.Collection = (I = this, Cn(Sm.prototype, function(be, ye) {
          this.db = I;
          var de = es, me = null;
          if (ye) try {
            de = ye();
          } catch (Ne) {
            me = Ne;
          }
          var pe = be._ctx, ye = pe.table, be = ye.hook.reading.fire;
          this._ctx = { table: ye, index: pe.index, isPrimKey: !pe.index || ye.schema.primKey.keyPath && pe.index === ye.schema.primKey.name, range: de, keysOnly: !1, dir: "next", unique: "", algorithm: null, filter: null, replayFilter: null, justLimit: !0, isMatch: null, offset: 0, limit: 1 / 0, error: me, or: pe.or, valueMapper: be !== Pe ? be : null };
        })), this.Table = ($ = this, Cn(Ys.prototype, function(se, xe, de) {
          this.db = $, this._tx = de, this.name = se, this.schema = xe, this.hook = $._allTables[se] ? $._allTables[se].hook : ha(null, { creating: [at, Ae], reading: [Qe, Pe], updating: [mn, Ae], deleting: [st, Ae] });
        })), this.Transaction = (Q = this, Cn(_u.prototype, function(se, xe, de, me, pe) {
          var ye = this;
          se !== "readonly" && xe.forEach(function(be) {
            be = (be = de[be]) === null || be === void 0 ? void 0 : be.yProps, be && (xe = xe.concat(be.map(function(Ne) {
              return Ne.updatesTable;
            })));
          }), this.db = Q, this.mode = se, this.storeNames = xe, this.schema = de, this.chromeTransactionDurability = me, this.idbtrans = null, this.on = ha(this, "complete", "error", "abort"), this.parent = pe || null, this.active = !0, this._reculock = 0, this._blockedFuncs = [], this._resolve = null, this._reject = null, this._waitingFor = null, this._waitingQueue = null, this._spinCount = 0, this._completion = new Ye(function(be, Ne) {
            ye._resolve = be, ye._reject = Ne;
          }), this._completion.then(function() {
            ye.active = !1, ye.on.complete.fire();
          }, function(be) {
            var Ne = ye.active;
            return ye.active = !1, ye.on.error.fire(be), ye.parent ? ye.parent._reject(be) : Ne && ye.idbtrans && ye.idbtrans.abort(), Pt(be);
          });
        })), this.Version = (ne = this, Cn(Em.prototype, function(se) {
          this.db = ne, this._cfg = { version: se, storesSource: null, dbschema: {}, tables: {}, contentUpgrade: null };
        })), this.WhereClause = (ue = this, Cn(ga.prototype, function(se, xe, de) {
          if (this.db = ue, this._ctx = { table: se, index: xe === ":id" ? null : xe, or: de }, this._cmp = this._ascending = pt, this._descending = function(me, pe) {
            return pt(pe, me);
          }, this._max = function(me, pe) {
            return 0 < pt(me, pe) ? me : pe;
          }, this._min = function(me, pe) {
            return pt(me, pe) < 0 ? me : pe;
          }, this._IDBKeyRange = ue._deps.IDBKeyRange, !this._IDBKeyRange) throw new we.MissingAPI();
        })), this.on("versionchange", function(se) {
          0 < se.newVersion ? console.warn("Another connection wants to upgrade database '".concat(j.name, "'. Closing db now to resume the upgrade.")) : console.warn("Another connection wants to delete database '".concat(j.name, "'. Closing db now to resume the delete request.")), j.close({ disableAutoOpen: !1 });
        }), this.on("blocked", function(se) {
          !se.newVersion || se.newVersion < se.oldVersion ? console.warn("Dexie.delete('".concat(j.name, "') was blocked")) : console.warn("Upgrade '".concat(j.name, "' blocked by other connection holding version ").concat(se.oldVersion / 10));
        }), this._maxKey = is(_.IDBKeyRange), this._createTransaction = function(se, xe, de, me) {
          return new j.Transaction(se, xe, de, j._options.chromeTransactionDurability, me);
        }, this._fireOnBlocked = function(se) {
          j.on("blocked").fire(se), xi.filter(function(xe) {
            return xe.name === j.name && xe !== j && !xe._state.vcFired;
          }).map(function(xe) {
            return xe.on("versionchange").fire(se);
          });
        }, this.use(Nd), this.use(cl), this.use(jm), this.use(Nm), this.use(kd);
        var ge = new Proxy(this, { get: function(se, xe, de) {
          if (xe === "_vip") return !0;
          if (xe === "table") return function(pe) {
            return no(j.table(pe), ge);
          };
          var me = Reflect.get(se, xe, de);
          return me instanceof Ys ? no(me, ge) : xe === "tables" ? me.map(function(pe) {
            return no(pe, ge);
          }) : xe === "_createTransaction" ? function() {
            return no(me.apply(this, arguments), ge);
          } : me;
        } });
        this.vip = ge, R.forEach(function(se) {
          return se(j);
        });
      }
      var us, hr = typeof Symbol < "u" && "observable" in Symbol ? Symbol.observable : "@@observable", Ad = (dl.prototype.subscribe = function(v, _, j) {
        return this._subscribe(v && typeof v != "function" ? v : { next: v, error: _, complete: j });
      }, dl.prototype[hr] = function() {
        return this;
      }, dl);
      function dl(v) {
        this._subscribe = v;
      }
      try {
        us = { indexedDB: o.indexedDB || o.mozIndexedDB || o.webkitIndexedDB || o.msIndexedDB, IDBKeyRange: o.IDBKeyRange || o.webkitIDBKeyRange };
      } catch {
        us = { indexedDB: null, IDBKeyRange: null };
      }
      function Md(v) {
        var _, j = !1, R = new Ad(function(I) {
          var $ = L(v), Q, ne = !1, ue = {}, ce = {}, ge = { get closed() {
            return ne;
          }, unsubscribe: function() {
            ne || (ne = !0, Q && Q.abort(), se && Hn.storagemutated.unsubscribe(de));
          } };
          I.start && I.start(ge);
          var se = !1, xe = function() {
            return Zr(me);
          }, de = function(pe) {
            al(ue, pe), Tu(ce, ue) && xe();
          }, me = function() {
            var pe, ye, be;
            !ne && us.indexedDB && (ue = {}, pe = {}, Q && Q.abort(), Q = new AbortController(), be = (function(Ne) {
              var ze = Xr();
              try {
                $ && fn();
                var Ie = Ut(v, Ne);
                return Ie = $ ? Ie.finally($n) : Ie;
              } finally {
                ze && xr();
              }
            })(ye = { subscr: pe, signal: Q.signal, requery: xe, querier: v, trans: null }), Promise.resolve(be).then(function(Ne) {
              j = !0, _ = Ne, ne || ye.signal.aborted || (ue = {}, (function(ze) {
                for (var Ie in ze) if (p(ze, Ie)) return;
                return 1;
              })(ce = pe) || se || (Hn(ns, de), se = !0), Zr(function() {
                return !ne && I.next && I.next(Ne);
              }));
            }, function(Ne) {
              j = !1, ["DatabaseClosedError", "AbortError"].includes(Ne == null ? void 0 : Ne.name) || ne || Zr(function() {
                ne || I.error && I.error(Ne);
              });
            }));
          };
          return setTimeout(xe, 0), ge;
        });
        return R.hasValue = function() {
          return j;
        }, R.getValue = function() {
          return _;
        }, R;
      }
      var Sa = ni;
      function Du(v) {
        var _ = Fi;
        try {
          Fi = !0, Hn.storagemutated.fire(v), Ru(v, !0);
        } finally {
          Fi = _;
        }
      }
      x(Sa, r(r({}, _e), { delete: function(v) {
        return new Sa(v, { addons: [] }).delete();
      }, exists: function(v) {
        return new Sa(v, { addons: [] }).open().then(function(_) {
          return _.close(), !0;
        }).catch("NoSuchDatabaseError", function() {
          return !1;
        });
      }, getDatabaseNames: function(v) {
        try {
          return _ = Sa.dependencies, j = _.indexedDB, _ = _.IDBKeyRange, (rl(j) ? Promise.resolve(j.databases()).then(function(R) {
            return R.map(function(I) {
              return I.name;
            }).filter(function(I) {
              return I !== ca;
            });
          }) : Eu(j, _).toCollection().primaryKeys()).then(v);
        } catch {
          return Pt(new we.MissingAPI());
        }
        var _, j;
      }, defineClass: function() {
        return function(v) {
          f(this, v);
        };
      }, ignoreTransaction: function(v) {
        return Ge.trans ? dr(Ge.transless, v) : v();
      }, vip: ku, async: function(v) {
        return function() {
          try {
            var _ = eo(v.apply(this, arguments));
            return _ && typeof _.then == "function" ? _ : Ye.resolve(_);
          } catch (j) {
            return Pt(j);
          }
        };
      }, spawn: function(v, _, j) {
        try {
          var R = eo(v.apply(j, _ || []));
          return R && typeof R.then == "function" ? R : Ye.resolve(R);
        } catch (I) {
          return Pt(I);
        }
      }, currentTransaction: { get: function() {
        return Ge.trans || null;
      } }, waitFor: function(v, _) {
        return _ = Ye.resolve(typeof v == "function" ? Sa.ignoreTransaction(v) : v).timeout(_ || 6e4), Ge.trans ? Ge.trans.waitFor(_) : _;
      }, Promise: Ye, debug: { get: function() {
        return Kt;
      }, set: function(v) {
        vn(v);
      } }, derive: E, extend: f, props: x, override: N, Events: ha, on: Hn, liveQuery: Md, extendObservabilitySet: al, getByKeyPath: M, setByKeyPath: O, delByKeyPath: function(v, _) {
        typeof _ == "string" ? O(v, _, void 0) : "length" in _ && [].map.call(_, function(j) {
          O(v, j, void 0);
        });
      }, shallowClone: Y, deepClone: re, getObjectDiff: ol, cmp: pt, asap: D, minKey: -1 / 0, addons: [], connections: xi, errnames: Se, dependencies: us, cache: wa, semVer: "4.2.1", version: "4.2.1".split(".").map(function(v) {
        return parseInt(v);
      }).reduce(function(v, _, j) {
        return v + _ / Math.pow(10, 2 * j);
      }) })), Sa.maxKey = is(Sa.dependencies.IDBKeyRange), typeof dispatchEvent < "u" && typeof addEventListener < "u" && (Hn(ns, function(v) {
        Fi || (v = new CustomEvent(xa, { detail: v }), Fi = !0, dispatchEvent(v), Fi = !1);
      }), addEventListener(xa, function(v) {
        v = v.detail, Fi || Du(v);
      }));
      var cs, Fi = !1, ir = function() {
      };
      return typeof BroadcastChannel < "u" && ((ir = function() {
        (cs = new BroadcastChannel(xa)).onmessage = function(v) {
          return v.data && Du(v.data);
        };
      })(), typeof cs.unref == "function" && cs.unref(), Hn(ns, function(v) {
        Fi || cs.postMessage(v);
      })), typeof addEventListener < "u" && (addEventListener("pagehide", function(v) {
        if (!ni.disableBfCache && v.persisted) {
          Kt && console.debug("Dexie: handling persisted pagehide"), cs != null && cs.close();
          for (var _ = 0, j = xi; _ < j.length; _++) j[_].close({ disableAutoOpen: !1 });
        }
      }), addEventListener("pageshow", function(v) {
        !ni.disableBfCache && v.persisted && (Kt && console.debug("Dexie: handling persisted pageshow"), ir(), Du({ all: new Gn(-1 / 0, [[]]) }));
      })), Ye.rejectionMapper = function(v, _) {
        return !v || v instanceof F || v instanceof TypeError || v instanceof SyntaxError || !v.name || !ke[v.name] ? v : (_ = new ke[v.name](_ || v.message, v), "stack" in v && w(_, "stack", { get: function() {
          return this.inner.stack;
        } }), _);
      }, vn(Kt), r(ni, Object.freeze({ __proto__: null, Dexie: ni, liveQuery: Md, Entity: Ko, cmp: pt, PropModification: qi, replacePrefix: function(v, _) {
        return new qi({ replacePrefix: [v, _] });
      }, add: function(v) {
        return new qi({ add: v });
      }, remove: function(v) {
        return new qi({ remove: v });
      }, default: ni, RangeSet: Gn, mergeRanges: ba, rangesOverlap: Sd }), { default: ni }), ni;
    });
  })(Zf)), Zf.exports;
}
var ID = DD();
const Ab = /* @__PURE__ */ $s(ID), h_ = Symbol.for("Dexie"), Gc = globalThis[h_] || (globalThis[h_] = Ab);
if (Ab.semVer !== Gc.semVer)
  throw new Error(`Two different versions of Dexie loaded in the same app: ${Ab.semVer} and ${Gc.semVer}`);
const {
  liveQuery: nte,
  mergeRanges: rte,
  rangesOverlap: ite,
  RangeSet: ate,
  cmp: ste,
  Entity: ote,
  PropModification: lte,
  replacePrefix: ute,
  add: cte,
  remove: dte,
  DexieYProvider: fte
} = Gc;
class Rj extends Gc {
  constructor(n) {
    super(`Engram_${n}`);
    nt(this, "events");
    nt(this, "entities");
    nt(this, "meta");
    this.version(2).stores({
      // Events: 
      events: "id, timestamp, significance_score, level",
      // Entities:  (V0.9.4:  aliases )
      entities: "id, type, name, *aliases",
      // Meta:  (lastSummarizedFloor )
      meta: "key"
    });
  }
}
const No = /* @__PURE__ */ new Map();
function jo(e) {
  if (!e)
    throw new Error("[Engram DB] chatId is required");
  return No.has(e) || (console.debug(`[Engram DB] Creating database for chat: ${e}`), No.set(e, new Rj(e))), No.get(e);
}
function zj(e) {
  const t = No.get(e);
  t && (t.close(), No.delete(e), console.debug(`[Engram DB] Closed database for chat: ${e}`));
}
function LD(e) {
  return No.has(e);
}
function Ps(e) {
  return No.get(e) || null;
}
async function qD(e) {
  zj(e), await Gc.delete(`Engram_${e}`), console.info(`[Engram DB] Deleted database for chat: ${e}`);
}
const PD = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  ChatDatabase: Rj,
  closeDb: zj,
  deleteDatabase: qD,
  getDbForChat: jo,
  hasDbForChat: LD,
  tryGetDbForChat: Ps
}, Symbol.toStringTag, { value: "Module" }));
class BD {
  async search(t) {
    const n = t.toLowerCase().trim();
    if (!n || n.length < 2) return [];
    const r = or();
    if (!r) return [];
    const a = Ps(r);
    if (!a) return [];
    try {
      return (await a.events.filter((l) => l.summary.toLowerCase().includes(n)).reverse().limit(5).toArray()).map((l) => ({
        id: `memory-${l.id}`,
        type: "memory",
        title: l.summary.slice(0, 50) + (l.summary.length > 50 ? "..." : ""),
        description: new Date(l.timestamp).toLocaleString(),
        icon: uu,
        action: (u) => u("/memory"),
        // TODO: Nav to specific item?
        score: 5
        // Lower score than exact commands
      }));
    } catch (o) {
      return console.error("Memory search failed", o), [];
    }
  }
}
class FD {
  async search(t) {
    const n = t.toLowerCase().trim();
    if (!n) return [];
    const r = [];
    return (We.get("promptTemplates") || []).forEach((o) => {
      o.name.toLowerCase().includes(n) && r.push({
        id: `template-${o.id}`,
        type: "setting",
        // or 'template'
        title: `: ${o.name}`,
        description: `Prompt Template (${o.category})`,
        icon: uu,
        action: (l) => l("presets:prompt"),
        // Ideally navigates to specific template
        score: 7
      });
    }), r;
  }
}
window.__ENGRAM_SEARCH_INIT__ || (Ul.registerAdapter(new Mj()), Ul.registerAdapter(new TD()), Ul.registerAdapter(new AD()), Ul.registerAdapter(new BD()), Ul.registerAdapter(new FD()), window.__ENGRAM_SEARCH_INIT__ = !0);
const $D = ({ onNavigate: e }) => {
  const [t, n] = P.useState(""), [r, a] = P.useState(!1), [o, l] = P.useState(0), [u, f] = P.useState([]), d = P.useRef(null);
  P.useEffect(() => {
    (async () => {
      if (!t.trim()) {
        const E = await new Mj().search("");
        f(E);
        return;
      }
      const w = await Ul.search(t);
      f(w), l(0);
    })();
  }, [t, r]), P.useEffect(() => {
    const y = (w) => {
      (w.metaKey || w.ctrlKey) && w.key === "k" && (w.preventDefault(), a(!0));
    };
    return window.addEventListener("keydown", y), () => window.removeEventListener("keydown", y);
  }, []), P.useEffect(() => {
    r && setTimeout(() => {
      var y;
      return (y = d.current) == null ? void 0 : y.focus();
    }, 50);
  }, [r]);
  const m = (y) => {
    const w = u.length + (t ? 1 : 0);
    switch (y.key) {
      case "ArrowDown":
        y.preventDefault(), l((E) => (E + 1) % w);
        break;
      case "ArrowUp":
        y.preventDefault(), l((E) => (E - 1 + w) % w);
        break;
      case "Enter":
        y.preventDefault(), p();
        break;
      case "Escape":
        a(!1);
        break;
    }
  }, p = () => {
    u.length > 0 && o < u.length ? u[o].action(e) : t && (console.log("Searching memory for:", t), e("/memory")), a(!1), n("");
  }, x = /* @__PURE__ */ h.jsx(
    "div",
    {
      className: "fixed inset-0 flex items-start justify-center pt-[15vh] px-4 animate-in fade-in duration-200",
      style: {
        height: "100dvh",
        width: "100vw",
        backgroundColor: "rgba(0,0,0,0.4)",
        // Slightly more transparent to not feel too heavy
        backdropFilter: "var(--glass-backdrop-filter, blur(4px))",
        zIndex: 2147483647
        // Max safe integer to ensure it's on top of SillyTavern UI
      },
      onClick: (y) => {
        y.target === y.currentTarget && a(!1);
      },
      children: /* @__PURE__ */ h.jsxs(
        "div",
        {
          className: "w-full max-w-xl border border-border rounded-xl shadow-2xl overflow-hidden flex flex-col animate-in zoom-in-95 slide-in-from-top-4 duration-200",
          style: {
            backgroundColor: "var(--popover)",
            color: "var(--popover-foreground)",
            backdropFilter: "var(--glass-backdrop-filter)",
            maxHeight: "70vh"
          },
          children: [
            /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-3 px-4 py-3 border-b border-border/50", children: [
              /* @__PURE__ */ h.jsx(hi, { size: 20, className: "text-muted-foreground shrink-0" }),
              /* @__PURE__ */ h.jsx(
                "input",
                {
                  ref: d,
                  type: "text",
                  className: "flex-1 bg-transparent border-none outline-none text-lg text-foreground placeholder:text-muted-foreground/50",
                  placeholder: "...",
                  value: t,
                  onChange: (y) => n(y.target.value),
                  onKeyDown: m
                }
              ),
              /* @__PURE__ */ h.jsx("div", { className: "text-[10px] text-muted-foreground border border-border px-1.5 py-0.5 rounded bg-muted/50 hidden sm:block", children: "ESC" })
            ] }),
            /* @__PURE__ */ h.jsxs("div", { className: "overflow-y-auto p-2 scroll-smooth", children: [
              u.length > 0 && /* @__PURE__ */ h.jsx("div", { className: "space-y-1", children: u.map((y, w) => /* @__PURE__ */ h.jsxs(
                "div",
                {
                  className: `flex items-center gap-3 px-3 py-2.5 rounded-lg cursor-pointer transition-colors ${w === o ? "bg-primary/10 text-primary" : "text-foreground hover:bg-muted/50"}`,
                  onClick: () => {
                    y.action(e), a(!1), n("");
                  },
                  onMouseEnter: () => l(w),
                  children: [
                    /* @__PURE__ */ h.jsx("div", { className: `
                                        w-8 h-8 rounded-md flex items-center justify-center shrink-0
                                        ${w === o ? "bg-primary/20" : "bg-muted/50 text-muted-foreground"}
                                    `, children: y.icon ? /* @__PURE__ */ h.jsx(y.icon, { size: 16 }) : /* @__PURE__ */ h.jsx(H5, { size: 16 }) }),
                    /* @__PURE__ */ h.jsxs("div", { className: "flex-1 min-w-0", children: [
                      /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-2", children: [
                        /* @__PURE__ */ h.jsx("span", { className: "text-sm font-medium", children: y.title }),
                        y.type !== "command" && /* @__PURE__ */ h.jsx("span", { className: "text-[10px] px-1.5 py-0.5 rounded-full bg-muted text-muted-foreground uppercase", children: y.type })
                      ] }),
                      y.description && /* @__PURE__ */ h.jsx("div", { className: "text-xs text-muted-foreground/80 truncate", children: y.description })
                    ] }),
                    w === o && /* @__PURE__ */ h.jsx(G5, { size: 16, className: "text-muted-foreground/50" })
                  ]
                },
                y.id
              )) }),
              t && /* @__PURE__ */ h.jsxs(
                "div",
                {
                  className: `
                            mt-2 pt-2 border-t border-border/50
                            flex items-center gap-3 px-3 py-2.5 rounded-lg cursor-pointer transition-colors
                            ${o === u.length ? "bg-primary/10 text-primary" : "text-foreground hover:bg-muted/50"}
                        `,
                  onClick: () => p(),
                  onMouseEnter: () => l(u.length),
                  children: [
                    /* @__PURE__ */ h.jsx("div", { className: `w-8 h-8 rounded-md flex items-center justify-center shrink-0 ${o === u.length ? "bg-primary/20" : "bg-muted/50 text-muted-foreground"}`, children: /* @__PURE__ */ h.jsx(hi, { size: 16 }) }),
                    /* @__PURE__ */ h.jsxs("div", { className: "flex-1 min-w-0", children: [
                      /* @__PURE__ */ h.jsxs("div", { className: "text-sm font-medium", children: [
                        ': "',
                        /* @__PURE__ */ h.jsx("span", { className: "text-primary", children: t }),
                        '"'
                      ] }),
                      /* @__PURE__ */ h.jsx("div", { className: "text-xs text-muted-foreground/80", children: "..." })
                    ] }),
                    o === u.length && /* @__PURE__ */ h.jsx(G5, { size: 16, className: "text-muted-foreground/50" })
                  ]
                }
              ),
              u.length === 0 && !t && /* @__PURE__ */ h.jsxs("div", { className: "px-4 py-8 text-center text-muted-foreground text-sm", children: [
                /* @__PURE__ */ h.jsx(H5, { size: 32, className: "mx-auto mb-2 opacity-20" }),
                /* @__PURE__ */ h.jsx("p", { children: " (Cmd+K)" })
              ] })
            ] })
          ]
        }
      )
    }
  );
  return /* @__PURE__ */ h.jsxs(h.Fragment, { children: [
    /* @__PURE__ */ h.jsx(
      "button",
      {
        onClick: () => a(!0),
        className: "p-2 rounded-md hover:bg-accent hover:text-accent-foreground transition-colors text-muted-foreground",
        title: " (Cmd+K)",
        children: /* @__PURE__ */ h.jsx(hi, { size: 20 })
      }
    ),
    r && _2.createPortal(x, document.body)
  ] });
}, UD = ({ className: e = "", size: t = 24 }) => /* @__PURE__ */ h.jsx(
  "svg",
  {
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 400 592",
    width: t,
    height: t,
    className: e,
    "aria-label": "Engram Icon",
    children: /* @__PURE__ */ h.jsx(
      "path",
      {
        fill: "currentColor",
        d: `M103.875908,522.166260 
                C75.225380,521.276611 55.289425,503.229828 52.249313,475.852142 
                C49.879883,454.514191 63.027035,433.000366 83.930901,424.858398 
                C88.449257,423.098541 89.857674,420.860199 89.801926,416.150269 
                C89.555420,395.322357 89.621246,374.489380 89.762306,353.659515 
                C89.787170,349.987000 88.728760,348.057556 85.120293,346.642609 
                C64.672897,338.625031 52.338894,320.951630 52.085896,299.869415 
                C51.832878,278.785156 63.730618,260.903198 84.118019,252.449951 
                C88.288918,250.720566 89.867378,248.680847 89.807304,244.052597 
                C89.539139,223.391968 89.589142,202.724701 89.796356,182.062561 
                C89.836380,178.071609 88.518524,176.326385 84.841705,174.787247 
                C57.730556,163.438416 45.530682,135.966721 55.436111,109.194000 
                C62.627293,89.757439 81.922821,76.710289 103.282494,76.841476 
                C124.355003,76.970901 143.082275,89.740875 149.993118,109.121849 
                C151.315979,112.831749 153.184799,113.869263 156.863403,113.853104 
                C186.192612,113.724319 215.522736,113.698357 244.851929,113.811600 
                C248.773117,113.826736 250.677307,112.652130 252.052902,108.765602 
                C259.013885,89.098465 278.589447,76.365829 300.503601,76.811897 
                C322.171844,77.252960 341.040283,91.132324 347.255371,111.201912 
                C356.569763,141.279358 340.344788,170.373184 309.893127,176.623123 
                C283.359375,182.068970 260.376740,167.450562 251.980011,145.670181 
                C250.492157,141.810806 248.818085,140.240295 244.552948,140.266785 
                C215.390915,140.447968 186.227219,140.357330 157.064072,140.375076 
                C154.628784,140.376556 151.855545,139.805771 151.141357,143.359161 
                C150.400787,147.043839 146.628937,150.064713 151.136917,154.478546 
                C184.592346,187.235229 217.778336,220.267349 250.982285,253.280014 
                C253.021469,255.307434 254.527191,255.254166 257.033264,254.047714 
                C276.199188,244.820953 294.752930,247.045853 310.978485,259.993408 
                C328.011017,273.584869 333.936798,292.106659 327.764038,313.282837 
                C321.779785,333.812378 307.254517,345.637268 286.367889,349.037231 
                C276.405396,350.658997 266.352570,349.443024 257.275055,344.363342 
                C254.265045,342.678986 252.301132,343.049744 249.903275,345.441406 
                C230.205368,365.088531 210.395386,384.623230 190.631638,404.204376 
                C177.732651,416.984222 164.859726,429.790344 151.962982,442.572388 
                C148.257980,446.244415 148.113403,452.901764 151.629196,456.671387 
                C152.707138,457.827148 154.029282,457.681976 155.328629,457.681946 
                C185.658203,457.681458 215.987854,457.631042 246.317261,457.695557 
                C249.355972,457.702026 250.687012,456.399414 251.717636,453.698944 
                C259.314423,433.793579 278.324493,420.868317 299.341309,421.146240 
                C320.526215,421.426361 339.575745,434.206421 346.686249,452.909271 
                C354.337341,473.034058 348.794159,495.642761 332.699371,509.956390 
                C307.061371,532.757202 263.380280,521.715210 251.978027,489.436371 
                C250.838303,486.209961 249.371201,484.953583 245.964813,484.962799 
                C216.302094,485.043304 186.639008,484.985840 156.976028,484.969330 
                C154.436981,484.967896 152.081528,484.923981 150.916916,488.054077 
                C142.892441,509.621246 126.842339,520.325989 103.875908,522.166260 
                M141.430466,266.110352 
                C145.394760,270.906738 148.503693,276.196198 150.388428,282.139069 
                C151.211502,284.734314 152.692291,285.770782 155.494156,285.760895 
                C179.139755,285.677429 202.787949,285.547394 226.430206,285.843811 
                C232.373352,285.918304 231.388184,281.058533 233.335602,278.254700 
                C235.007233,275.847992 233.916855,274.189880 232.000244,272.304352 
                C199.956863,240.780380 167.866821,209.301468 136.133682,177.467056 
                C131.183243,172.500824 127.483856,170.729507 121.013550,174.621368 
                C117.660522,176.638214 116.183739,178.155136 116.217278,182.042480 
                C116.398239,203.022598 116.444160,224.006012 116.243645,244.985474 
                C116.204666,249.064667 117.676285,250.918961 121.328865,252.228989 
                C128.972488,254.970444 135.505173,259.524170 141.430466,266.110352 
                M116.349434,377.499908 
                C116.351860,390.663696 116.870338,403.855377 116.161102,416.980713 
                C115.742699,424.723846 121.926743,423.801880 125.649162,426.262665 
                C129.080231,428.530792 130.798965,425.706268 132.741440,423.784821 
                C165.551407,391.329803 198.234940,358.745361 231.274231,326.525696 
                C235.764252,322.147095 232.377243,319.155212 231.599960,315.493317 
                C230.884583,312.123138 228.193359,312.382568 225.670288,312.382812 
                C202.675171,312.384949 179.679749,312.445435 156.685303,312.323212 
                C153.331955,312.305389 151.624329,313.386505 150.456299,316.584381 
                C145.119888,331.194611 135.004120,341.287384 120.496223,346.769958 
                C117.238434,348.001068 116.190170,349.706024 116.267418,353.006317 
                C116.450615,360.833862 116.340004,368.668243 116.349434,377.499908z`
      }
    )
  }
), HD = ({
  onToggleSidebar: e,
  isMobile: t,
  // Deprecated prop, handled by CSS
  onClose: n,
  onNavigate: r
}) => /* @__PURE__ */ h.jsxs("header", { className: "h-10 flex items-center justify-between px-4 bg-transparent z-50 transition-all duration-300 w-full flex-shrink-0", children: [
  /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-3 w-16 md:w-64", children: [
    /* @__PURE__ */ h.jsx(
      "button",
      {
        className: "p-2 -ml-2 rounded-md hover:bg-sidebar-accent hover:text-sidebar-accent-foreground transition-colors md:hidden",
        onClick: e,
        title: "",
        children: /* @__PURE__ */ h.jsx(Pz, { size: 18 })
      }
    ),
    /* @__PURE__ */ h.jsxs("div", { className: "hidden md:flex items-center gap-2", children: [
      /* @__PURE__ */ h.jsx(UD, { size: 18, className: "text-primary" }),
      /* @__PURE__ */ h.jsx("span", { className: "font-semibold text-sidebar-foreground tracking-tight", children: "Engram" })
    ] })
  ] }),
  /* @__PURE__ */ h.jsx("div", { className: "flex-1" }),
  /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-1 md:gap-2", children: [
    /* @__PURE__ */ h.jsx($D, { onNavigate: r }),
    /* @__PURE__ */ h.jsx("div", { className: "h-4 w-[1px] bg-border mx-1" }),
    /* @__PURE__ */ h.jsx(
      "button",
      {
        className: "p-2 rounded-md hover:bg-destructive hover:text-destructive-foreground transition-colors text-muted-foreground",
        onClick: n,
        title: "",
        children: /* @__PURE__ */ h.jsx(cu, { size: 20 })
      }
    )
  ] })
] }), GD = ({ className: e = "", height: t = 24 }) => {
  const n = Math.round(t * 3.17);
  return /* @__PURE__ */ h.jsxs(
    "svg",
    {
      xmlns: "http://www.w3.org/2000/svg",
      viewBox: "235 175 555 175",
      width: n,
      height: t,
      className: e,
      "aria-label": "Engram",
      children: [
        /* @__PURE__ */ h.jsx("path", { fill: "currentColor", d: "M752.3,294.5c-0.2-11.8-0.3-23.1-0.4-34.4c0-2.7,0-5.3-0.2-8c-0.6-6.4-4.1-10.1-9.8-10.9 c-6.9-0.9-12.2,2-14.5,7.9c-1,2.5-1.2,5.2-1.2,7.9c0,11,-0.3,22,0,33c0.1,5.2-1.7,6.9-6.7,6.4c-3.3-0.3-6.7-0.3-10,0 c-4.9,0.5-5.9-1.9-5.8-6.2c0.2-11.8,0.2-23.7,0-35.5c-0.2-9.4-5.4-14.3-14.1-13.5c-6.4,0.6-11.1,5.7-11.3,13 c-0.3,11.7-0.2,23.3-0.3,35c0,7.1,0,7.1-7.3,7.1c-3.3,0-6.7-0.1-10,0c-3.3,0.1-4.9-1.1-4.9-4.6c0.1-21.5,0-43-0.1-64.5 c0-2.9,1.3-4.3,4.2-4.3c3.2,0,6.3-0.1,9.5,0.1c4,0,8.8-1,7.5,6.6c8.6-6.1,16.9-8.7,26.3-7c5.2,1,10.1,2.7,13.7,6.6 c2.8,2.9,4.6,2.4,7.4,0c6.8-5.8,15-7.9,23.8-6.9c16.3,1.8,25.1,11.7,25.8,29.5c0.5,13.3,0.1,26.6,0.2,40 c0,3.4-1.2,5.1-4.7,4.7C763.8,295.7,757.9,298,752.3,294.5z" }),
        /* @__PURE__ */ h.jsx("path", { fill: "currentColor", d: "M463.1,324.1c-10.8-0.7-20.9-2.4-30.2-7.5c-3.6-2-5-4-2.4-7.8c2.3-3.4,4.1-7.1,6.5-11.3 c6.1,3.6,11.8,6.8,18.5,7.7c5.3,0.7,10.6,1.1,15.8-0.5c8.3-2.6,12.2-9.1,10.9-18.6c-9.1,7.5-19.3,8.6-30.2,6.4 c-7.8-1.6-14.2-5.6-19.2-11.8c-10.5-12.8-10.6-32.5-0.5-45.5c11.2-14.3,28.6-16.4,50.9-6.1c-0.4-6.2,3.5-6.3,8.1-6.2 c13,0.2,13,0.1,13,13c0,16.3-0.5,32.7,0.1,49C505.4,309.3,491.3,322.1,467.6,324C466.2,324.1,464.9,324.1,463.1,324.1z M482.1,252.6 c-0.6-2.1-1.6-4-3-5.7c-4.6-6-13.5-8.4-21.2-5.5c-7.4,2.7-11.1,8.9-10.6,17.8c0.4,7.4,5.7,13.5,13.6,15.2 C474.1,277.2,485.2,266.4,482.1,252.6z" }),
        /* @__PURE__ */ h.jsx("path", { fill: "currentColor", d: "M258.1,201.6c20.3,0,40.1,0.1,60-0.1c4.5,0,6.3,1.3,6.1,5.9c-0.4,14.6,2.1,12.6-12.7,12.7 c-10.7,0.1-21.3,0.1-32-0.1c-3.8-0.1-5.2,1-5.3,5.1c0,13.4-0.2,13.4,13.4,13.4c8.7,0,17.3,0.1,26,0c3.4-0.1,4.7,1.2,4.7,4.7 c-0.2,16.4,1.9,13.7-13.1,13.9c-8.8,0.1-17.7,0.1-26.5,0c-3.2,0-4.6,1.1-4.4,4.4c0.2,3.8,0.2,7.7,0,11.5 c-0.2,3.5,1.1,4.7,4.6,4.7c13.7-0.1,27.3,0.2,41-0.1c5.1-0.1,6.6,1.5,6.5,6.5c-0.2,12.3,0,12.3-12.1,12.3 c-18.7-0.1-37.3-0.2-56,0c-4.9,0.1-6.7-1.2-6.7-6.4c0.2-27.5,0.2-55,0-82.5C251.6,203,253,200.9,258.1,201.6z" }),
        /* @__PURE__ */ h.jsx("path", { fill: "currentColor", d: "M599.5,239.6c-5.6,0.9-10.6,2.1-15,4.9c-2.5,1.6-4,0.9-5.1-1.6c-0.9-2-1.9-3.9-2.9-5.8 c-3.1-6.1-3-6.4,3-9.3c11.6-5.6,23.9-7.1,36.5-4.6c15.1,2.9,23.6,12.8,24.1,28.7c0.4,13.3,0.1,26.6,0.2,40 c0,3.5-1.5,4.8-4.8,4.6c-3,0-6,0-9,0.1c-4.2,0.2-8.1,0.2-6.6-6.6c-12.4,9.5-24.9,10.4-37.7,3.9c-8.5-4.3-11.9-12-11.3-21.2 c0.6-9.1,5.9-15,14.4-17.9c5.7-1.9,11.6-2.8,17.7-2.8c4.6,0,9.3,0.5,13.8-0.4c1.9-7.2-7.4-13.5-17.2-11.9 M617.7,271.9 c-0.1-2.5,1-5.8-3.3-5.8c-5,0-10-0.1-15,0.2c-4,0.3-6.9,2.4-7.1,6.9c-0.2,4.5,2.2,7.2,6.3,8.4C606.5,283.8,613.8,280.3,617.7,271.9z" }),
        /* @__PURE__ */ h.jsx("path", { fill: "currentColor", d: "M346.2,222.9c2.6,0,4.8,0.1,7,0c4.7-0.4,8.1,0.7,7,7.3c6-4,11.6-7.1,18.2-7.9c18.2-2.1,34.8,7.7,35,29.4 c0.1,13.2-0.1,26.3,0.1,39.5c0,3.9-1.2,5.5-5.2,5.2c-4,0-8,0-12,0.2c-3.5,0.2-4.7-1.3-4.7-4.7c0.1-10.3,0.1-20.7,0-31 c0-2.3-0.1-4.7-0.5-7c-1.3-8.4-5.4-12.3-12.9-12.6c-8.4-0.3-14.3,3.9-16,11.9c-2,9.6-0.7,19.3-0.9,28.9 c-0.2,14.4,0,14.4-14.4,14.4c-7.8,0-7.9,0-7.9-8c0-19.5,0-39,0-58.5C339,223.3,339.2,223.2,346.2,222.9z" }),
        /* @__PURE__ */ h.jsx("path", { fill: "currentColor", d: "M543.2,258.4c-0.1,11.1-0.3,21.8-0.2,32.4c0,4-1.2,5.9-5.4,5.6c-4.3-0.3-8.7-0.1-13-0.1 c-2.7,0-3.9-1.3-3.9-4c0-21.8,0-43.6,0-65.5c0-2.8,1.3-3.9,3.9-4c2.8,0,5.7,0,8.5-0.1c4.8-0.2,9.6-0.5,8.7,6.4 c2.1,0.8,2.8-0.7,3.9-1.3c2.3-1.2,4.5-2.8,7-3.8c11.8-4.7,14.3-3,14.3,9.3c0,0.8-0.1,1.7,0,2.5c0.6,4.6-1,6.4-6,6.5 C550,242.6,544.8,247.5,543.2,258.4z" })
      ]
    }
  );
}, VD = "0.9.4", Oj = {
  version: VD
}, m_ = ({
  activeTab: e,
  onNavigate: t,
  isMobile: n,
  isOpen: r = !1,
  onClose: a,
  onShowUpdateNotice: o,
  hasUnreadUpdate: l
}) => {
  const u = (d) => {
    t(d), n && a && a();
  }, f = () => /* @__PURE__ */ h.jsxs("div", { className: "pt-4 border-t border-border/30 mt-2 space-y-2", children: [
    /* @__PURE__ */ h.jsxs(
      "button",
      {
        onClick: o,
        className: "w-full flex items-center gap-2 px-2 py-1.5 rounded-lg transition-all duration-200 text-muted-foreground hover:text-foreground hover:bg-muted/10 text-left",
        children: [
          /* @__PURE__ */ h.jsxs("div", { className: "relative", children: [
            /* @__PURE__ */ h.jsx(RR, { size: 16, strokeWidth: 1.5 }),
            l && /* @__PURE__ */ h.jsx("span", { className: "absolute -top-1 -right-1 w-2 h-2 bg-red-500 rounded-full animate-pulse" })
          ] }),
          /* @__PURE__ */ h.jsx("span", { className: "text-xs", children: "" }),
          l && /* @__PURE__ */ h.jsx("span", { className: "ml-auto text-[10px] px-1.5 py-0.5 bg-primary/20 text-primary rounded-full", children: "NEW" })
        ]
      }
    ),
    /* @__PURE__ */ h.jsxs(
      "a",
      {
        href: "https://github.com/shiyue137mh-netizen/Engram",
        target: "_blank",
        rel: "noopener noreferrer",
        className: "group w-full flex items-center gap-2 px-2 py-1.5 rounded-lg transition-all duration-200 text-muted-foreground hover:text-foreground hover:bg-muted/10",
        title: "",
        children: [
          /* @__PURE__ */ h.jsx(xz, { size: 16, strokeWidth: 1.5, className: "group-hover:text-primary transition-colors" }),
          /* @__PURE__ */ h.jsx("span", { className: "text-xs", children: "GitHub" }),
          /* @__PURE__ */ h.jsx("span", { className: "ml-auto text-[10px] text-primary opacity-0 group-hover:opacity-100 transition-opacity", children: "Star " })
        ]
      }
    ),
    /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-2 px-2 py-1 opacity-50", children: [
      /* @__PURE__ */ h.jsx(GD, { height: 12 }),
      /* @__PURE__ */ h.jsxs("span", { className: "text-[10px] text-muted-foreground font-mono", children: [
        "v",
        Oj.version
      ] })
    ] })
  ] });
  return n && !r ? null : n ? /* @__PURE__ */ h.jsxs(
    "div",
    {
      className: "fixed inset-0 z-[60] flex justify-start",
      style: { height: "100dvh", width: "100vw" },
      children: [
        /* @__PURE__ */ h.jsx(
          "div",
          {
            className: "absolute inset-0 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",
            onClick: a
          }
        ),
        /* @__PURE__ */ h.jsxs(
          "div",
          {
            id: "mobile-menu-drawer",
            className: "relative w-64 max-w-[80vw] h-full bg-sidebar border-r border-border shadow-2xl flex flex-col p-6 animate-in slide-in-from-left duration-300",
            style: { height: "100dvh" },
            children: [
              /* @__PURE__ */ h.jsxs("div", { className: "flex justify-between items-center mb-8", children: [
                /* @__PURE__ */ h.jsx("span", { className: "text-lg font-semibold text-sidebar-foreground/80", children: "" }),
                /* @__PURE__ */ h.jsx(
                  "button",
                  {
                    onClick: a,
                    className: "p-2 -mr-2 rounded-md hover:bg-sidebar-accent text-muted-foreground hover:text-sidebar-accent-foreground transition-colors",
                    children: /* @__PURE__ */ h.jsx(cu, { size: 20 })
                  }
                )
              ] }),
              /* @__PURE__ */ h.jsx("nav", { className: "space-y-2 flex-1 overflow-y-auto", children: ch.map((d) => {
                const m = d.icon, p = e === d.id;
                return /* @__PURE__ */ h.jsxs(
                  "button",
                  {
                    onClick: () => u(d.id),
                    className: `
                                    w-full flex items-center gap-4 px-4 py-3 rounded-xl text-left transition-all duration-200
                                    ${p ? "bg-primary/10 text-primary font-medium" : "text-muted-foreground hover:bg-sidebar-accent hover:text-sidebar-foreground"}
                                `,
                    children: [
                      /* @__PURE__ */ h.jsx(m, { size: 22, className: p ? "text-primary" : "text-muted-foreground/70" }),
                      /* @__PURE__ */ h.jsx("span", { children: d.label })
                    ]
                  },
                  d.id
                );
              }) }),
              /* @__PURE__ */ h.jsx("div", { className: "mt-auto", children: /* @__PURE__ */ h.jsx(f, {}) })
            ]
          }
        )
      ]
    }
  ) : /* @__PURE__ */ h.jsxs("aside", { className: "[display:none] md:flex w-36 flex-shrink-0 bg-sidebar flex-col z-40 pt-4 px-2 border-r border-border/50 animate-in slide-in-from-left-4 fade-in duration-500 fill-mode-both", style: { animationDelay: "100ms", animationFillMode: "both" }, children: [
    /* @__PURE__ */ h.jsx("nav", { className: "flex-1 w-full flex flex-col gap-1 overflow-y-auto no-scrollbar", children: ch.map((d) => {
      const m = d.icon, p = e === d.id;
      return /* @__PURE__ */ h.jsxs(
        "button",
        {
          onClick: () => u(d.id),
          className: `
                                    w-full flex items-center gap-2 px-2 py-2 rounded-lg transition-all duration-200 text-left
                                    ${p ? "bg-primary/10 text-primary" : "text-muted-foreground hover:text-foreground hover:bg-muted/10"}
                                `,
          children: [
            /* @__PURE__ */ h.jsx(m, { size: 18, strokeWidth: p ? 2 : 1.5, className: "flex-shrink-0" }),
            /* @__PURE__ */ h.jsx("span", { className: `text-xs ${p ? "font-medium" : "font-normal"}`, children: d.label })
          ]
        },
        d.id
      );
    }) }),
    /* @__PURE__ */ h.jsx("div", { className: "pb-3", children: /* @__PURE__ */ h.jsx(f, {}) })
  ] });
}, zf = {
  timeOut: 5e3,
  extendedTimeOut: 1e3,
  closeButton: !0,
  progressBar: !0
}, _o = class _o {
  constructor() {
  }
  static getInstance() {
    return _o.instance || (_o.instance = new _o()), _o.instance;
  }
  /**
   *  toastr 
   */
  getToastr() {
    return window.toastr || null;
  }
  /**
   * 
   */
  success(t, n = "Engram", r = {}) {
    const a = this.getToastr();
    a ? a.success(t, n, { ...zf, ...r }) : console.log(`[Engram] SUCCESS: ${n} - ${t}`), le.info("Notification", `Success: ${t}`);
  }
  /**
   * 
   */
  info(t, n = "Engram", r = {}) {
    const a = this.getToastr();
    a ? a.info(t, n, { ...zf, ...r }) : console.log(`[Engram] INFO: ${n} - ${t}`), le.info("Notification", `Info: ${t}`);
  }
  /**
   * 
   */
  warning(t, n = "Engram", r = {}) {
    const a = this.getToastr();
    a ? a.warning(t, n, { ...zf, ...r }) : console.warn(`[Engram] WARNING: ${n} - ${t}`), le.warn("Notification", `Warning: ${t}`);
  }
  /**
   * 
   */
  error(t, n = "Engram", r = {}) {
    const a = this.getToastr();
    a ? a.error(t, n, { ...zf, timeOut: 8e3, ...r }) : console.error(`[Engram] ERROR: ${n} - ${t}`), le.error("Notification", `Error: ${t}`);
  }
  /**
   * 
   * @param message 
   * @param title 
   * @param onCancel 
   * @returns toastr 
   */
  running(t, n = "Engram", r) {
    const a = this.getToastr();
    if (a) {
      const o = r ? `${t} <small style="opacity:0.7">()</small>` : t;
      return a.info(o, n, {
        timeOut: 2e4,
        //  20 
        extendedTimeOut: 0,
        // 
        closeButton: !1,
        // 
        progressBar: !0,
        // 
        tapToDismiss: !!r,
        // 
        onclick: r ? () => {
          le.info("Notification", ""), r();
        } : void 0,
        escapeHtml: !1
        //  HTML
      });
    } else
      return console.log(`[Engram] RUNNING: ${n} - ${t}`), null;
  }
  /**
   *  toastr 
   */
  remove(t) {
    const n = this.getToastr();
    n && t && n.remove(t);
  }
  /**
   * 
   */
  clear() {
    const t = this.getToastr();
    t && t.clear();
  }
};
nt(_o, "instance");
let Mb = _o;
const St = Mb.getInstance(), Il = {
  owner: "shiyue137mh-netizen",
  repo: "Engram",
  branch: "master"
}, Of = Oj.version;
let xc = null, vc = null;
function kg(e, t) {
  const n = e.split(".").map(Number), r = t.split(".").map(Number);
  for (let a = 0; a < Math.max(n.length, r.length); a++) {
    const o = n[a] || 0, l = r[a] || 0;
    if (o > l) return 1;
    if (o < l) return -1;
  }
  return 0;
}
class Is {
  /**
   * 
   */
  static getCurrentVersion() {
    return Of;
  }
  /**
   *  GitHub 
   */
  static async getLatestVersion() {
    if (xc)
      return xc;
    try {
      const t = `https://raw.githubusercontent.com/${Il.owner}/${Il.repo}/${Il.branch}/manifest.json`, n = await fetch(t);
      return n.ok ? (xc = (await n.json()).version || null, xc) : null;
    } catch {
      return null;
    }
  }
  /**
   * 
   */
  static async hasUpdate() {
    const t = await this.getLatestVersion();
    return t ? kg(t, Of) > 0 : !1;
  }
  /**
   * 
   */
  static async getChangelog() {
    if (vc)
      return vc;
    try {
      const t = `https://raw.githubusercontent.com/${Il.owner}/${Il.repo}/${Il.branch}/CHANGELOG.md`, n = await fetch(t);
      return n.ok ? (vc = await n.text(), vc) : (console.warn("[Engram] UpdateService: ", n.status), St.warning(`: ${n.status}`, ""), null);
    } catch (t) {
      return console.error("[Engram] UpdateService: ", t), St.error("", ""), null;
    }
  }
  /**
   * 
   */
  static getReadVersion() {
    try {
      return We.get("lastReadVersion") || "0.0.0";
    } catch {
      return "0.0.0";
    }
  }
  /**
   * 
   */
  static async markAsRead(t) {
    const n = t || await this.getLatestVersion() || Of;
    try {
      We.set("lastReadVersion", n), console.debug("[Engram] UpdateService: ", n);
    } catch (r) {
      console.error("[Engram] UpdateService: ", r);
    }
  }
  /**
   * 
   */
  static async hasUnreadUpdate() {
    const t = await this.getLatestVersion();
    if (!t || kg(t, Of) <= 0)
      return !1;
    const n = this.getReadVersion();
    return kg(t, n) > 0;
  }
  /**
   * 
   */
  static clearCache() {
    xc = null, vc = null;
  }
}
function KD(e, t) {
  const n = {};
  return (e[e.length - 1] === "" ? [...e, ""] : e).join(
    (n.padRight ? " " : "") + "," + (n.padLeft === !1 ? "" : " ")
  ).trim();
}
const YD = /^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u, XD = /^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u, WD = {};
function p_(e, t) {
  return (WD.jsx ? XD : YD).test(e);
}
const QD = /[ \t\n\f\r]/g;
function ZD(e) {
  return typeof e == "object" ? e.type === "text" ? g_(e.value) : !1 : g_(e);
}
function g_(e) {
  return e.replace(QD, "") === "";
}
class sd {
  /**
   * @param {SchemaType['property']} property
   *   Property.
   * @param {SchemaType['normal']} normal
   *   Normal.
   * @param {Space | undefined} [space]
   *   Space.
   * @returns
   *   Schema.
   */
  constructor(t, n, r) {
    this.normal = n, this.property = t, r && (this.space = r);
  }
}
sd.prototype.normal = {};
sd.prototype.property = {};
sd.prototype.space = void 0;
function Dj(e, t) {
  const n = {}, r = {};
  for (const a of e)
    Object.assign(n, a.property), Object.assign(r, a.normal);
  return new sd(n, r, t);
}
function Rb(e) {
  return e.toLowerCase();
}
class zr {
  /**
   * @param {string} property
   *   Property.
   * @param {string} attribute
   *   Attribute.
   * @returns
   *   Info.
   */
  constructor(t, n) {
    this.attribute = n, this.property = t;
  }
}
zr.prototype.attribute = "";
zr.prototype.booleanish = !1;
zr.prototype.boolean = !1;
zr.prototype.commaOrSpaceSeparated = !1;
zr.prototype.commaSeparated = !1;
zr.prototype.defined = !1;
zr.prototype.mustUseProperty = !1;
zr.prototype.number = !1;
zr.prototype.overloadedBoolean = !1;
zr.prototype.property = "";
zr.prototype.spaceSeparated = !1;
zr.prototype.space = void 0;
let JD = 0;
const bt = Bo(), Rn = Bo(), zb = Bo(), Ue = Bo(), Qt = Bo(), Wl = Bo(), Hr = Bo();
function Bo() {
  return 2 ** ++JD;
}
const Ob = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  boolean: bt,
  booleanish: Rn,
  commaOrSpaceSeparated: Hr,
  commaSeparated: Wl,
  number: Ue,
  overloadedBoolean: zb,
  spaceSeparated: Qt
}, Symbol.toStringTag, { value: "Module" })), Ng = (
  /** @type {ReadonlyArray<keyof typeof types>} */
  Object.keys(Ob)
);
class T2 extends zr {
  /**
   * @constructor
   * @param {string} property
   *   Property.
   * @param {string} attribute
   *   Attribute.
   * @param {number | null | undefined} [mask]
   *   Mask.
   * @param {Space | undefined} [space]
   *   Space.
   * @returns
   *   Info.
   */
  constructor(t, n, r, a) {
    let o = -1;
    if (super(t, n), y_(this, "space", a), typeof r == "number")
      for (; ++o < Ng.length; ) {
        const l = Ng[o];
        y_(this, Ng[o], (r & Ob[l]) === Ob[l]);
      }
  }
}
T2.prototype.defined = !0;
function y_(e, t, n) {
  n && (e[t] = n);
}
function du(e) {
  const t = {}, n = {};
  for (const [r, a] of Object.entries(e.properties)) {
    const o = new T2(
      r,
      e.transform(e.attributes || {}, r),
      a,
      e.space
    );
    e.mustUseProperty && e.mustUseProperty.includes(r) && (o.mustUseProperty = !0), t[r] = o, n[Rb(r)] = r, n[Rb(o.attribute)] = r;
  }
  return new sd(t, n, e.space);
}
const Ij = du({
  properties: {
    ariaActiveDescendant: null,
    ariaAtomic: Rn,
    ariaAutoComplete: null,
    ariaBusy: Rn,
    ariaChecked: Rn,
    ariaColCount: Ue,
    ariaColIndex: Ue,
    ariaColSpan: Ue,
    ariaControls: Qt,
    ariaCurrent: null,
    ariaDescribedBy: Qt,
    ariaDetails: null,
    ariaDisabled: Rn,
    ariaDropEffect: Qt,
    ariaErrorMessage: null,
    ariaExpanded: Rn,
    ariaFlowTo: Qt,
    ariaGrabbed: Rn,
    ariaHasPopup: null,
    ariaHidden: Rn,
    ariaInvalid: null,
    ariaKeyShortcuts: null,
    ariaLabel: null,
    ariaLabelledBy: Qt,
    ariaLevel: Ue,
    ariaLive: null,
    ariaModal: Rn,
    ariaMultiLine: Rn,
    ariaMultiSelectable: Rn,
    ariaOrientation: null,
    ariaOwns: Qt,
    ariaPlaceholder: null,
    ariaPosInSet: Ue,
    ariaPressed: Rn,
    ariaReadOnly: Rn,
    ariaRelevant: null,
    ariaRequired: Rn,
    ariaRoleDescription: Qt,
    ariaRowCount: Ue,
    ariaRowIndex: Ue,
    ariaRowSpan: Ue,
    ariaSelected: Rn,
    ariaSetSize: Ue,
    ariaSort: null,
    ariaValueMax: Ue,
    ariaValueMin: Ue,
    ariaValueNow: Ue,
    ariaValueText: null,
    role: null
  },
  transform(e, t) {
    return t === "role" ? t : "aria-" + t.slice(4).toLowerCase();
  }
});
function Lj(e, t) {
  return t in e ? e[t] : t;
}
function qj(e, t) {
  return Lj(e, t.toLowerCase());
}
const eI = du({
  attributes: {
    acceptcharset: "accept-charset",
    classname: "class",
    htmlfor: "for",
    httpequiv: "http-equiv"
  },
  mustUseProperty: ["checked", "multiple", "muted", "selected"],
  properties: {
    // Standard Properties.
    abbr: null,
    accept: Wl,
    acceptCharset: Qt,
    accessKey: Qt,
    action: null,
    allow: null,
    allowFullScreen: bt,
    allowPaymentRequest: bt,
    allowUserMedia: bt,
    alt: null,
    as: null,
    async: bt,
    autoCapitalize: null,
    autoComplete: Qt,
    autoFocus: bt,
    autoPlay: bt,
    blocking: Qt,
    capture: null,
    charSet: null,
    checked: bt,
    cite: null,
    className: Qt,
    cols: Ue,
    colSpan: null,
    content: null,
    contentEditable: Rn,
    controls: bt,
    controlsList: Qt,
    coords: Ue | Wl,
    crossOrigin: null,
    data: null,
    dateTime: null,
    decoding: null,
    default: bt,
    defer: bt,
    dir: null,
    dirName: null,
    disabled: bt,
    download: zb,
    draggable: Rn,
    encType: null,
    enterKeyHint: null,
    fetchPriority: null,
    form: null,
    formAction: null,
    formEncType: null,
    formMethod: null,
    formNoValidate: bt,
    formTarget: null,
    headers: Qt,
    height: Ue,
    hidden: zb,
    high: Ue,
    href: null,
    hrefLang: null,
    htmlFor: Qt,
    httpEquiv: Qt,
    id: null,
    imageSizes: null,
    imageSrcSet: null,
    inert: bt,
    inputMode: null,
    integrity: null,
    is: null,
    isMap: bt,
    itemId: null,
    itemProp: Qt,
    itemRef: Qt,
    itemScope: bt,
    itemType: Qt,
    kind: null,
    label: null,
    lang: null,
    language: null,
    list: null,
    loading: null,
    loop: bt,
    low: Ue,
    manifest: null,
    max: null,
    maxLength: Ue,
    media: null,
    method: null,
    min: null,
    minLength: Ue,
    multiple: bt,
    muted: bt,
    name: null,
    nonce: null,
    noModule: bt,
    noValidate: bt,
    onAbort: null,
    onAfterPrint: null,
    onAuxClick: null,
    onBeforeMatch: null,
    onBeforePrint: null,
    onBeforeToggle: null,
    onBeforeUnload: null,
    onBlur: null,
    onCancel: null,
    onCanPlay: null,
    onCanPlayThrough: null,
    onChange: null,
    onClick: null,
    onClose: null,
    onContextLost: null,
    onContextMenu: null,
    onContextRestored: null,
    onCopy: null,
    onCueChange: null,
    onCut: null,
    onDblClick: null,
    onDrag: null,
    onDragEnd: null,
    onDragEnter: null,
    onDragExit: null,
    onDragLeave: null,
    onDragOver: null,
    onDragStart: null,
    onDrop: null,
    onDurationChange: null,
    onEmptied: null,
    onEnded: null,
    onError: null,
    onFocus: null,
    onFormData: null,
    onHashChange: null,
    onInput: null,
    onInvalid: null,
    onKeyDown: null,
    onKeyPress: null,
    onKeyUp: null,
    onLanguageChange: null,
    onLoad: null,
    onLoadedData: null,
    onLoadedMetadata: null,
    onLoadEnd: null,
    onLoadStart: null,
    onMessage: null,
    onMessageError: null,
    onMouseDown: null,
    onMouseEnter: null,
    onMouseLeave: null,
    onMouseMove: null,
    onMouseOut: null,
    onMouseOver: null,
    onMouseUp: null,
    onOffline: null,
    onOnline: null,
    onPageHide: null,
    onPageShow: null,
    onPaste: null,
    onPause: null,
    onPlay: null,
    onPlaying: null,
    onPopState: null,
    onProgress: null,
    onRateChange: null,
    onRejectionHandled: null,
    onReset: null,
    onResize: null,
    onScroll: null,
    onScrollEnd: null,
    onSecurityPolicyViolation: null,
    onSeeked: null,
    onSeeking: null,
    onSelect: null,
    onSlotChange: null,
    onStalled: null,
    onStorage: null,
    onSubmit: null,
    onSuspend: null,
    onTimeUpdate: null,
    onToggle: null,
    onUnhandledRejection: null,
    onUnload: null,
    onVolumeChange: null,
    onWaiting: null,
    onWheel: null,
    open: bt,
    optimum: Ue,
    pattern: null,
    ping: Qt,
    placeholder: null,
    playsInline: bt,
    popover: null,
    popoverTarget: null,
    popoverTargetAction: null,
    poster: null,
    preload: null,
    readOnly: bt,
    referrerPolicy: null,
    rel: Qt,
    required: bt,
    reversed: bt,
    rows: Ue,
    rowSpan: Ue,
    sandbox: Qt,
    scope: null,
    scoped: bt,
    seamless: bt,
    selected: bt,
    shadowRootClonable: bt,
    shadowRootDelegatesFocus: bt,
    shadowRootMode: null,
    shape: null,
    size: Ue,
    sizes: null,
    slot: null,
    span: Ue,
    spellCheck: Rn,
    src: null,
    srcDoc: null,
    srcLang: null,
    srcSet: null,
    start: Ue,
    step: null,
    style: null,
    tabIndex: Ue,
    target: null,
    title: null,
    translate: null,
    type: null,
    typeMustMatch: bt,
    useMap: null,
    value: Rn,
    width: Ue,
    wrap: null,
    writingSuggestions: null,
    // Legacy.
    // See: https://html.spec.whatwg.org/#other-elements,-attributes-and-apis
    align: null,
    // Several. Use CSS `text-align` instead,
    aLink: null,
    // `<body>`. Use CSS `a:active {color}` instead
    archive: Qt,
    // `<object>`. List of URIs to archives
    axis: null,
    // `<td>` and `<th>`. Use `scope` on `<th>`
    background: null,
    // `<body>`. Use CSS `background-image` instead
    bgColor: null,
    // `<body>` and table elements. Use CSS `background-color` instead
    border: Ue,
    // `<table>`. Use CSS `border-width` instead,
    borderColor: null,
    // `<table>`. Use CSS `border-color` instead,
    bottomMargin: Ue,
    // `<body>`
    cellPadding: null,
    // `<table>`
    cellSpacing: null,
    // `<table>`
    char: null,
    // Several table elements. When `align=char`, sets the character to align on
    charOff: null,
    // Several table elements. When `char`, offsets the alignment
    classId: null,
    // `<object>`
    clear: null,
    // `<br>`. Use CSS `clear` instead
    code: null,
    // `<object>`
    codeBase: null,
    // `<object>`
    codeType: null,
    // `<object>`
    color: null,
    // `<font>` and `<hr>`. Use CSS instead
    compact: bt,
    // Lists. Use CSS to reduce space between items instead
    declare: bt,
    // `<object>`
    event: null,
    // `<script>`
    face: null,
    // `<font>`. Use CSS instead
    frame: null,
    // `<table>`
    frameBorder: null,
    // `<iframe>`. Use CSS `border` instead
    hSpace: Ue,
    // `<img>` and `<object>`
    leftMargin: Ue,
    // `<body>`
    link: null,
    // `<body>`. Use CSS `a:link {color: *}` instead
    longDesc: null,
    // `<frame>`, `<iframe>`, and `<img>`. Use an `<a>`
    lowSrc: null,
    // `<img>`. Use a `<picture>`
    marginHeight: Ue,
    // `<body>`
    marginWidth: Ue,
    // `<body>`
    noResize: bt,
    // `<frame>`
    noHref: bt,
    // `<area>`. Use no href instead of an explicit `nohref`
    noShade: bt,
    // `<hr>`. Use background-color and height instead of borders
    noWrap: bt,
    // `<td>` and `<th>`
    object: null,
    // `<applet>`
    profile: null,
    // `<head>`
    prompt: null,
    // `<isindex>`
    rev: null,
    // `<link>`
    rightMargin: Ue,
    // `<body>`
    rules: null,
    // `<table>`
    scheme: null,
    // `<meta>`
    scrolling: Rn,
    // `<frame>`. Use overflow in the child context
    standby: null,
    // `<object>`
    summary: null,
    // `<table>`
    text: null,
    // `<body>`. Use CSS `color` instead
    topMargin: Ue,
    // `<body>`
    valueType: null,
    // `<param>`
    version: null,
    // `<html>`. Use a doctype.
    vAlign: null,
    // Several. Use CSS `vertical-align` instead
    vLink: null,
    // `<body>`. Use CSS `a:visited {color}` instead
    vSpace: Ue,
    // `<img>` and `<object>`
    // Non-standard Properties.
    allowTransparency: null,
    autoCorrect: null,
    autoSave: null,
    disablePictureInPicture: bt,
    disableRemotePlayback: bt,
    prefix: null,
    property: null,
    results: Ue,
    security: null,
    unselectable: null
  },
  space: "html",
  transform: qj
}), tI = du({
  attributes: {
    accentHeight: "accent-height",
    alignmentBaseline: "alignment-baseline",
    arabicForm: "arabic-form",
    baselineShift: "baseline-shift",
    capHeight: "cap-height",
    className: "class",
    clipPath: "clip-path",
    clipRule: "clip-rule",
    colorInterpolation: "color-interpolation",
    colorInterpolationFilters: "color-interpolation-filters",
    colorProfile: "color-profile",
    colorRendering: "color-rendering",
    crossOrigin: "crossorigin",
    dataType: "datatype",
    dominantBaseline: "dominant-baseline",
    enableBackground: "enable-background",
    fillOpacity: "fill-opacity",
    fillRule: "fill-rule",
    floodColor: "flood-color",
    floodOpacity: "flood-opacity",
    fontFamily: "font-family",
    fontSize: "font-size",
    fontSizeAdjust: "font-size-adjust",
    fontStretch: "font-stretch",
    fontStyle: "font-style",
    fontVariant: "font-variant",
    fontWeight: "font-weight",
    glyphName: "glyph-name",
    glyphOrientationHorizontal: "glyph-orientation-horizontal",
    glyphOrientationVertical: "glyph-orientation-vertical",
    hrefLang: "hreflang",
    horizAdvX: "horiz-adv-x",
    horizOriginX: "horiz-origin-x",
    horizOriginY: "horiz-origin-y",
    imageRendering: "image-rendering",
    letterSpacing: "letter-spacing",
    lightingColor: "lighting-color",
    markerEnd: "marker-end",
    markerMid: "marker-mid",
    markerStart: "marker-start",
    navDown: "nav-down",
    navDownLeft: "nav-down-left",
    navDownRight: "nav-down-right",
    navLeft: "nav-left",
    navNext: "nav-next",
    navPrev: "nav-prev",
    navRight: "nav-right",
    navUp: "nav-up",
    navUpLeft: "nav-up-left",
    navUpRight: "nav-up-right",
    onAbort: "onabort",
    onActivate: "onactivate",
    onAfterPrint: "onafterprint",
    onBeforePrint: "onbeforeprint",
    onBegin: "onbegin",
    onCancel: "oncancel",
    onCanPlay: "oncanplay",
    onCanPlayThrough: "oncanplaythrough",
    onChange: "onchange",
    onClick: "onclick",
    onClose: "onclose",
    onCopy: "oncopy",
    onCueChange: "oncuechange",
    onCut: "oncut",
    onDblClick: "ondblclick",
    onDrag: "ondrag",
    onDragEnd: "ondragend",
    onDragEnter: "ondragenter",
    onDragExit: "ondragexit",
    onDragLeave: "ondragleave",
    onDragOver: "ondragover",
    onDragStart: "ondragstart",
    onDrop: "ondrop",
    onDurationChange: "ondurationchange",
    onEmptied: "onemptied",
    onEnd: "onend",
    onEnded: "onended",
    onError: "onerror",
    onFocus: "onfocus",
    onFocusIn: "onfocusin",
    onFocusOut: "onfocusout",
    onHashChange: "onhashchange",
    onInput: "oninput",
    onInvalid: "oninvalid",
    onKeyDown: "onkeydown",
    onKeyPress: "onkeypress",
    onKeyUp: "onkeyup",
    onLoad: "onload",
    onLoadedData: "onloadeddata",
    onLoadedMetadata: "onloadedmetadata",
    onLoadStart: "onloadstart",
    onMessage: "onmessage",
    onMouseDown: "onmousedown",
    onMouseEnter: "onmouseenter",
    onMouseLeave: "onmouseleave",
    onMouseMove: "onmousemove",
    onMouseOut: "onmouseout",
    onMouseOver: "onmouseover",
    onMouseUp: "onmouseup",
    onMouseWheel: "onmousewheel",
    onOffline: "onoffline",
    onOnline: "ononline",
    onPageHide: "onpagehide",
    onPageShow: "onpageshow",
    onPaste: "onpaste",
    onPause: "onpause",
    onPlay: "onplay",
    onPlaying: "onplaying",
    onPopState: "onpopstate",
    onProgress: "onprogress",
    onRateChange: "onratechange",
    onRepeat: "onrepeat",
    onReset: "onreset",
    onResize: "onresize",
    onScroll: "onscroll",
    onSeeked: "onseeked",
    onSeeking: "onseeking",
    onSelect: "onselect",
    onShow: "onshow",
    onStalled: "onstalled",
    onStorage: "onstorage",
    onSubmit: "onsubmit",
    onSuspend: "onsuspend",
    onTimeUpdate: "ontimeupdate",
    onToggle: "ontoggle",
    onUnload: "onunload",
    onVolumeChange: "onvolumechange",
    onWaiting: "onwaiting",
    onZoom: "onzoom",
    overlinePosition: "overline-position",
    overlineThickness: "overline-thickness",
    paintOrder: "paint-order",
    panose1: "panose-1",
    pointerEvents: "pointer-events",
    referrerPolicy: "referrerpolicy",
    renderingIntent: "rendering-intent",
    shapeRendering: "shape-rendering",
    stopColor: "stop-color",
    stopOpacity: "stop-opacity",
    strikethroughPosition: "strikethrough-position",
    strikethroughThickness: "strikethrough-thickness",
    strokeDashArray: "stroke-dasharray",
    strokeDashOffset: "stroke-dashoffset",
    strokeLineCap: "stroke-linecap",
    strokeLineJoin: "stroke-linejoin",
    strokeMiterLimit: "stroke-miterlimit",
    strokeOpacity: "stroke-opacity",
    strokeWidth: "stroke-width",
    tabIndex: "tabindex",
    textAnchor: "text-anchor",
    textDecoration: "text-decoration",
    textRendering: "text-rendering",
    transformOrigin: "transform-origin",
    typeOf: "typeof",
    underlinePosition: "underline-position",
    underlineThickness: "underline-thickness",
    unicodeBidi: "unicode-bidi",
    unicodeRange: "unicode-range",
    unitsPerEm: "units-per-em",
    vAlphabetic: "v-alphabetic",
    vHanging: "v-hanging",
    vIdeographic: "v-ideographic",
    vMathematical: "v-mathematical",
    vectorEffect: "vector-effect",
    vertAdvY: "vert-adv-y",
    vertOriginX: "vert-origin-x",
    vertOriginY: "vert-origin-y",
    wordSpacing: "word-spacing",
    writingMode: "writing-mode",
    xHeight: "x-height",
    // These were camelcased in Tiny. Now lowercased in SVG 2
    playbackOrder: "playbackorder",
    timelineBegin: "timelinebegin"
  },
  properties: {
    about: Hr,
    accentHeight: Ue,
    accumulate: null,
    additive: null,
    alignmentBaseline: null,
    alphabetic: Ue,
    amplitude: Ue,
    arabicForm: null,
    ascent: Ue,
    attributeName: null,
    attributeType: null,
    azimuth: Ue,
    bandwidth: null,
    baselineShift: null,
    baseFrequency: null,
    baseProfile: null,
    bbox: null,
    begin: null,
    bias: Ue,
    by: null,
    calcMode: null,
    capHeight: Ue,
    className: Qt,
    clip: null,
    clipPath: null,
    clipPathUnits: null,
    clipRule: null,
    color: null,
    colorInterpolation: null,
    colorInterpolationFilters: null,
    colorProfile: null,
    colorRendering: null,
    content: null,
    contentScriptType: null,
    contentStyleType: null,
    crossOrigin: null,
    cursor: null,
    cx: null,
    cy: null,
    d: null,
    dataType: null,
    defaultAction: null,
    descent: Ue,
    diffuseConstant: Ue,
    direction: null,
    display: null,
    dur: null,
    divisor: Ue,
    dominantBaseline: null,
    download: bt,
    dx: null,
    dy: null,
    edgeMode: null,
    editable: null,
    elevation: Ue,
    enableBackground: null,
    end: null,
    event: null,
    exponent: Ue,
    externalResourcesRequired: null,
    fill: null,
    fillOpacity: Ue,
    fillRule: null,
    filter: null,
    filterRes: null,
    filterUnits: null,
    floodColor: null,
    floodOpacity: null,
    focusable: null,
    focusHighlight: null,
    fontFamily: null,
    fontSize: null,
    fontSizeAdjust: null,
    fontStretch: null,
    fontStyle: null,
    fontVariant: null,
    fontWeight: null,
    format: null,
    fr: null,
    from: null,
    fx: null,
    fy: null,
    g1: Wl,
    g2: Wl,
    glyphName: Wl,
    glyphOrientationHorizontal: null,
    glyphOrientationVertical: null,
    glyphRef: null,
    gradientTransform: null,
    gradientUnits: null,
    handler: null,
    hanging: Ue,
    hatchContentUnits: null,
    hatchUnits: null,
    height: null,
    href: null,
    hrefLang: null,
    horizAdvX: Ue,
    horizOriginX: Ue,
    horizOriginY: Ue,
    id: null,
    ideographic: Ue,
    imageRendering: null,
    initialVisibility: null,
    in: null,
    in2: null,
    intercept: Ue,
    k: Ue,
    k1: Ue,
    k2: Ue,
    k3: Ue,
    k4: Ue,
    kernelMatrix: Hr,
    kernelUnitLength: null,
    keyPoints: null,
    // SEMI_COLON_SEPARATED
    keySplines: null,
    // SEMI_COLON_SEPARATED
    keyTimes: null,
    // SEMI_COLON_SEPARATED
    kerning: null,
    lang: null,
    lengthAdjust: null,
    letterSpacing: null,
    lightingColor: null,
    limitingConeAngle: Ue,
    local: null,
    markerEnd: null,
    markerMid: null,
    markerStart: null,
    markerHeight: null,
    markerUnits: null,
    markerWidth: null,
    mask: null,
    maskContentUnits: null,
    maskUnits: null,
    mathematical: null,
    max: null,
    media: null,
    mediaCharacterEncoding: null,
    mediaContentEncodings: null,
    mediaSize: Ue,
    mediaTime: null,
    method: null,
    min: null,
    mode: null,
    name: null,
    navDown: null,
    navDownLeft: null,
    navDownRight: null,
    navLeft: null,
    navNext: null,
    navPrev: null,
    navRight: null,
    navUp: null,
    navUpLeft: null,
    navUpRight: null,
    numOctaves: null,
    observer: null,
    offset: null,
    onAbort: null,
    onActivate: null,
    onAfterPrint: null,
    onBeforePrint: null,
    onBegin: null,
    onCancel: null,
    onCanPlay: null,
    onCanPlayThrough: null,
    onChange: null,
    onClick: null,
    onClose: null,
    onCopy: null,
    onCueChange: null,
    onCut: null,
    onDblClick: null,
    onDrag: null,
    onDragEnd: null,
    onDragEnter: null,
    onDragExit: null,
    onDragLeave: null,
    onDragOver: null,
    onDragStart: null,
    onDrop: null,
    onDurationChange: null,
    onEmptied: null,
    onEnd: null,
    onEnded: null,
    onError: null,
    onFocus: null,
    onFocusIn: null,
    onFocusOut: null,
    onHashChange: null,
    onInput: null,
    onInvalid: null,
    onKeyDown: null,
    onKeyPress: null,
    onKeyUp: null,
    onLoad: null,
    onLoadedData: null,
    onLoadedMetadata: null,
    onLoadStart: null,
    onMessage: null,
    onMouseDown: null,
    onMouseEnter: null,
    onMouseLeave: null,
    onMouseMove: null,
    onMouseOut: null,
    onMouseOver: null,
    onMouseUp: null,
    onMouseWheel: null,
    onOffline: null,
    onOnline: null,
    onPageHide: null,
    onPageShow: null,
    onPaste: null,
    onPause: null,
    onPlay: null,
    onPlaying: null,
    onPopState: null,
    onProgress: null,
    onRateChange: null,
    onRepeat: null,
    onReset: null,
    onResize: null,
    onScroll: null,
    onSeeked: null,
    onSeeking: null,
    onSelect: null,
    onShow: null,
    onStalled: null,
    onStorage: null,
    onSubmit: null,
    onSuspend: null,
    onTimeUpdate: null,
    onToggle: null,
    onUnload: null,
    onVolumeChange: null,
    onWaiting: null,
    onZoom: null,
    opacity: null,
    operator: null,
    order: null,
    orient: null,
    orientation: null,
    origin: null,
    overflow: null,
    overlay: null,
    overlinePosition: Ue,
    overlineThickness: Ue,
    paintOrder: null,
    panose1: null,
    path: null,
    pathLength: Ue,
    patternContentUnits: null,
    patternTransform: null,
    patternUnits: null,
    phase: null,
    ping: Qt,
    pitch: null,
    playbackOrder: null,
    pointerEvents: null,
    points: null,
    pointsAtX: Ue,
    pointsAtY: Ue,
    pointsAtZ: Ue,
    preserveAlpha: null,
    preserveAspectRatio: null,
    primitiveUnits: null,
    propagate: null,
    property: Hr,
    r: null,
    radius: null,
    referrerPolicy: null,
    refX: null,
    refY: null,
    rel: Hr,
    rev: Hr,
    renderingIntent: null,
    repeatCount: null,
    repeatDur: null,
    requiredExtensions: Hr,
    requiredFeatures: Hr,
    requiredFonts: Hr,
    requiredFormats: Hr,
    resource: null,
    restart: null,
    result: null,
    rotate: null,
    rx: null,
    ry: null,
    scale: null,
    seed: null,
    shapeRendering: null,
    side: null,
    slope: null,
    snapshotTime: null,
    specularConstant: Ue,
    specularExponent: Ue,
    spreadMethod: null,
    spacing: null,
    startOffset: null,
    stdDeviation: null,
    stemh: null,
    stemv: null,
    stitchTiles: null,
    stopColor: null,
    stopOpacity: null,
    strikethroughPosition: Ue,
    strikethroughThickness: Ue,
    string: null,
    stroke: null,
    strokeDashArray: Hr,
    strokeDashOffset: null,
    strokeLineCap: null,
    strokeLineJoin: null,
    strokeMiterLimit: Ue,
    strokeOpacity: Ue,
    strokeWidth: null,
    style: null,
    surfaceScale: Ue,
    syncBehavior: null,
    syncBehaviorDefault: null,
    syncMaster: null,
    syncTolerance: null,
    syncToleranceDefault: null,
    systemLanguage: Hr,
    tabIndex: Ue,
    tableValues: null,
    target: null,
    targetX: Ue,
    targetY: Ue,
    textAnchor: null,
    textDecoration: null,
    textRendering: null,
    textLength: null,
    timelineBegin: null,
    title: null,
    transformBehavior: null,
    type: null,
    typeOf: Hr,
    to: null,
    transform: null,
    transformOrigin: null,
    u1: null,
    u2: null,
    underlinePosition: Ue,
    underlineThickness: Ue,
    unicode: null,
    unicodeBidi: null,
    unicodeRange: null,
    unitsPerEm: Ue,
    values: null,
    vAlphabetic: Ue,
    vMathematical: Ue,
    vectorEffect: null,
    vHanging: Ue,
    vIdeographic: Ue,
    version: null,
    vertAdvY: Ue,
    vertOriginX: Ue,
    vertOriginY: Ue,
    viewBox: null,
    viewTarget: null,
    visibility: null,
    width: null,
    widths: null,
    wordSpacing: null,
    writingMode: null,
    x: null,
    x1: null,
    x2: null,
    xChannelSelector: null,
    xHeight: Ue,
    y: null,
    y1: null,
    y2: null,
    yChannelSelector: null,
    z: null,
    zoomAndPan: null
  },
  space: "svg",
  transform: Lj
}), Pj = du({
  properties: {
    xLinkActuate: null,
    xLinkArcRole: null,
    xLinkHref: null,
    xLinkRole: null,
    xLinkShow: null,
    xLinkTitle: null,
    xLinkType: null
  },
  space: "xlink",
  transform(e, t) {
    return "xlink:" + t.slice(5).toLowerCase();
  }
}), Bj = du({
  attributes: { xmlnsxlink: "xmlns:xlink" },
  properties: { xmlnsXLink: null, xmlns: null },
  space: "xmlns",
  transform: qj
}), Fj = du({
  properties: { xmlBase: null, xmlLang: null, xmlSpace: null },
  space: "xml",
  transform(e, t) {
    return "xml:" + t.slice(3).toLowerCase();
  }
}), nI = {
  classId: "classID",
  dataType: "datatype",
  itemId: "itemID",
  strokeDashArray: "strokeDasharray",
  strokeDashOffset: "strokeDashoffset",
  strokeLineCap: "strokeLinecap",
  strokeLineJoin: "strokeLinejoin",
  strokeMiterLimit: "strokeMiterlimit",
  typeOf: "typeof",
  xLinkActuate: "xlinkActuate",
  xLinkArcRole: "xlinkArcrole",
  xLinkHref: "xlinkHref",
  xLinkRole: "xlinkRole",
  xLinkShow: "xlinkShow",
  xLinkTitle: "xlinkTitle",
  xLinkType: "xlinkType",
  xmlnsXLink: "xmlnsXlink"
}, rI = /[A-Z]/g, x_ = /-[a-z]/g, iI = /^data[-\w.:]+$/i;
function aI(e, t) {
  const n = Rb(t);
  let r = t, a = zr;
  if (n in e.normal)
    return e.property[e.normal[n]];
  if (n.length > 4 && n.slice(0, 4) === "data" && iI.test(t)) {
    if (t.charAt(4) === "-") {
      const o = t.slice(5).replace(x_, oI);
      r = "data" + o.charAt(0).toUpperCase() + o.slice(1);
    } else {
      const o = t.slice(4);
      if (!x_.test(o)) {
        let l = o.replace(rI, sI);
        l.charAt(0) !== "-" && (l = "-" + l), t = "data" + l;
      }
    }
    a = T2;
  }
  return new a(r, t);
}
function sI(e) {
  return "-" + e.toLowerCase();
}
function oI(e) {
  return e.charAt(1).toUpperCase();
}
const lI = Dj([Ij, eI, Pj, Bj, Fj], "html"), A2 = Dj([Ij, tI, Pj, Bj, Fj], "svg");
function uI(e) {
  return e.join(" ").trim();
}
var Ll = {}, jg, v_;
function cI() {
  if (v_) return jg;
  v_ = 1;
  var e = /\/\*[^*]*\*+([^/*][^*]*\*+)*\//g, t = /\n/g, n = /^\s*/, r = /^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/, a = /^:\s*/, o = /^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/, l = /^[;\s]*/, u = /^\s+|\s+$/g, f = `
`, d = "/", m = "*", p = "", x = "comment", y = "declaration";
  function w(k, C) {
    if (typeof k != "string")
      throw new TypeError("First argument must be a string");
    if (!k) return [];
    C = C || {};
    var T = 1, N = 1;
    function A(q) {
      var W = q.match(t);
      W && (T += W.length);
      var V = q.lastIndexOf(f);
      N = ~V ? q.length - V : N + q.length;
    }
    function D() {
      var q = { line: T, column: N };
      return function(W) {
        return W.position = new M(q), X(), W;
      };
    }
    function M(q) {
      this.start = q, this.end = { line: T, column: N }, this.source = C.source;
    }
    M.prototype.content = k;
    function O(q) {
      var W = new Error(
        C.source + ":" + T + ":" + N + ": " + q
      );
      if (W.reason = q, W.filename = C.source, W.line = T, W.column = N, W.source = k, !C.silent) throw W;
    }
    function Y(q) {
      var W = q.exec(k);
      if (W) {
        var V = W[0];
        return A(V), k = k.slice(V.length), W;
      }
    }
    function X() {
      Y(n);
    }
    function U(q) {
      var W;
      for (q = q || []; W = B(); )
        W !== !1 && q.push(W);
      return q;
    }
    function B() {
      var q = D();
      if (!(d != k.charAt(0) || m != k.charAt(1))) {
        for (var W = 2; p != k.charAt(W) && (m != k.charAt(W) || d != k.charAt(W + 1)); )
          ++W;
        if (W += 2, p === k.charAt(W - 1))
          return O("End of comment missing");
        var V = k.slice(2, W - 2);
        return N += 2, A(V), k = k.slice(W), N += 2, q({
          type: x,
          comment: V
        });
      }
    }
    function G() {
      var q = D(), W = Y(r);
      if (W) {
        if (B(), !Y(a)) return O("property missing ':'");
        var V = Y(o), ee = q({
          type: y,
          property: E(W[0].replace(e, p)),
          value: V ? E(V[0].replace(e, p)) : p
        });
        return Y(l), ee;
      }
    }
    function re() {
      var q = [];
      U(q);
      for (var W; W = G(); )
        W !== !1 && (q.push(W), U(q));
      return q;
    }
    return X(), re();
  }
  function E(k) {
    return k ? k.replace(u, p) : p;
  }
  return jg = w, jg;
}
var b_;
function dI() {
  if (b_) return Ll;
  b_ = 1;
  var e = Ll && Ll.__importDefault || function(r) {
    return r && r.__esModule ? r : { default: r };
  };
  Object.defineProperty(Ll, "__esModule", { value: !0 }), Ll.default = n;
  const t = e(cI());
  function n(r, a) {
    let o = null;
    if (!r || typeof r != "string")
      return o;
    const l = (0, t.default)(r), u = typeof a == "function";
    return l.forEach((f) => {
      if (f.type !== "declaration")
        return;
      const { property: d, value: m } = f;
      u ? a(d, m, f) : m && (o = o || {}, o[d] = m);
    }), o;
  }
  return Ll;
}
var bc = {}, w_;
function fI() {
  if (w_) return bc;
  w_ = 1, Object.defineProperty(bc, "__esModule", { value: !0 }), bc.camelCase = void 0;
  var e = /^--[a-zA-Z0-9_-]+$/, t = /-([a-z])/g, n = /^[^-]+$/, r = /^-(webkit|moz|ms|o|khtml)-/, a = /^-(ms)-/, o = function(d) {
    return !d || n.test(d) || e.test(d);
  }, l = function(d, m) {
    return m.toUpperCase();
  }, u = function(d, m) {
    return "".concat(m, "-");
  }, f = function(d, m) {
    return m === void 0 && (m = {}), o(d) ? d : (d = d.toLowerCase(), m.reactCompat ? d = d.replace(a, u) : d = d.replace(r, u), d.replace(t, l));
  };
  return bc.camelCase = f, bc;
}
var wc, __;
function hI() {
  if (__) return wc;
  __ = 1;
  var e = wc && wc.__importDefault || function(a) {
    return a && a.__esModule ? a : { default: a };
  }, t = e(dI()), n = fI();
  function r(a, o) {
    var l = {};
    return !a || typeof a != "string" || (0, t.default)(a, function(u, f) {
      u && f && (l[(0, n.camelCase)(u, o)] = f);
    }), l;
  }
  return r.default = r, wc = r, wc;
}
var mI = hI();
const pI = /* @__PURE__ */ $s(mI), $j = Uj("end"), M2 = Uj("start");
function Uj(e) {
  return t;
  function t(n) {
    const r = n && n.position && n.position[e] || {};
    if (typeof r.line == "number" && r.line > 0 && typeof r.column == "number" && r.column > 0)
      return {
        line: r.line,
        column: r.column,
        offset: typeof r.offset == "number" && r.offset > -1 ? r.offset : void 0
      };
  }
}
function gI(e) {
  const t = M2(e), n = $j(e);
  if (t && n)
    return { start: t, end: n };
}
function Lc(e) {
  return !e || typeof e != "object" ? "" : "position" in e || "type" in e ? S_(e.position) : "start" in e || "end" in e ? S_(e) : "line" in e || "column" in e ? Db(e) : "";
}
function Db(e) {
  return C_(e && e.line) + ":" + C_(e && e.column);
}
function S_(e) {
  return Db(e && e.start) + "-" + Db(e && e.end);
}
function C_(e) {
  return e && typeof e == "number" ? e : 1;
}
class cr extends Error {
  /**
   * Create a message for `reason`.
   *
   * >  **Note**: also has obsolete signatures.
   *
   * @overload
   * @param {string} reason
   * @param {Options | null | undefined} [options]
   * @returns
   *
   * @overload
   * @param {string} reason
   * @param {Node | NodeLike | null | undefined} parent
   * @param {string | null | undefined} [origin]
   * @returns
   *
   * @overload
   * @param {string} reason
   * @param {Point | Position | null | undefined} place
   * @param {string | null | undefined} [origin]
   * @returns
   *
   * @overload
   * @param {string} reason
   * @param {string | null | undefined} [origin]
   * @returns
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {Node | NodeLike | null | undefined} parent
   * @param {string | null | undefined} [origin]
   * @returns
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {Point | Position | null | undefined} place
   * @param {string | null | undefined} [origin]
   * @returns
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {string | null | undefined} [origin]
   * @returns
   *
   * @param {Error | VFileMessage | string} causeOrReason
   *   Reason for message, should use markdown.
   * @param {Node | NodeLike | Options | Point | Position | string | null | undefined} [optionsOrParentOrPlace]
   *   Configuration (optional).
   * @param {string | null | undefined} [origin]
   *   Place in code where the message originates (example:
   *   `'my-package:my-rule'` or `'my-rule'`).
   * @returns
   *   Instance of `VFileMessage`.
   */
  // eslint-disable-next-line complexity
  constructor(t, n, r) {
    super(), typeof n == "string" && (r = n, n = void 0);
    let a = "", o = {}, l = !1;
    if (n && ("line" in n && "column" in n ? o = { place: n } : "start" in n && "end" in n ? o = { place: n } : "type" in n ? o = {
      ancestors: [n],
      place: n.position
    } : o = { ...n }), typeof t == "string" ? a = t : !o.cause && t && (l = !0, a = t.message, o.cause = t), !o.ruleId && !o.source && typeof r == "string") {
      const f = r.indexOf(":");
      f === -1 ? o.ruleId = r : (o.source = r.slice(0, f), o.ruleId = r.slice(f + 1));
    }
    if (!o.place && o.ancestors && o.ancestors) {
      const f = o.ancestors[o.ancestors.length - 1];
      f && (o.place = f.position);
    }
    const u = o.place && "start" in o.place ? o.place.start : o.place;
    this.ancestors = o.ancestors || void 0, this.cause = o.cause || void 0, this.column = u ? u.column : void 0, this.fatal = void 0, this.file = "", this.message = a, this.line = u ? u.line : void 0, this.name = Lc(o.place) || "1:1", this.place = o.place || void 0, this.reason = this.message, this.ruleId = o.ruleId || void 0, this.source = o.source || void 0, this.stack = l && o.cause && typeof o.cause.stack == "string" ? o.cause.stack : "", this.actual = void 0, this.expected = void 0, this.note = void 0, this.url = void 0;
  }
}
cr.prototype.file = "";
cr.prototype.name = "";
cr.prototype.reason = "";
cr.prototype.message = "";
cr.prototype.stack = "";
cr.prototype.column = void 0;
cr.prototype.line = void 0;
cr.prototype.ancestors = void 0;
cr.prototype.cause = void 0;
cr.prototype.fatal = void 0;
cr.prototype.place = void 0;
cr.prototype.ruleId = void 0;
cr.prototype.source = void 0;
const R2 = {}.hasOwnProperty, yI = /* @__PURE__ */ new Map(), xI = /[A-Z]/g, vI = /* @__PURE__ */ new Set(["table", "tbody", "thead", "tfoot", "tr"]), bI = /* @__PURE__ */ new Set(["td", "th"]), Hj = "https://github.com/syntax-tree/hast-util-to-jsx-runtime";
function wI(e, t) {
  if (!t || t.Fragment === void 0)
    throw new TypeError("Expected `Fragment` in options");
  const n = t.filePath || void 0;
  let r;
  if (t.development) {
    if (typeof t.jsxDEV != "function")
      throw new TypeError(
        "Expected `jsxDEV` in options when `development: true`"
      );
    r = TI(n, t.jsxDEV);
  } else {
    if (typeof t.jsx != "function")
      throw new TypeError("Expected `jsx` in production options");
    if (typeof t.jsxs != "function")
      throw new TypeError("Expected `jsxs` in production options");
    r = jI(n, t.jsx, t.jsxs);
  }
  const a = {
    Fragment: t.Fragment,
    ancestors: [],
    components: t.components || {},
    create: r,
    elementAttributeNameCase: t.elementAttributeNameCase || "react",
    evaluater: t.createEvaluater ? t.createEvaluater() : void 0,
    filePath: n,
    ignoreInvalidStyle: t.ignoreInvalidStyle || !1,
    passKeys: t.passKeys !== !1,
    passNode: t.passNode || !1,
    schema: t.space === "svg" ? A2 : lI,
    stylePropertyNameCase: t.stylePropertyNameCase || "dom",
    tableCellAlignToStyle: t.tableCellAlignToStyle !== !1
  }, o = Gj(a, e, void 0);
  return o && typeof o != "string" ? o : a.create(
    e,
    a.Fragment,
    { children: o || void 0 },
    void 0
  );
}
function Gj(e, t, n) {
  if (t.type === "element")
    return _I(e, t, n);
  if (t.type === "mdxFlowExpression" || t.type === "mdxTextExpression")
    return SI(e, t);
  if (t.type === "mdxJsxFlowElement" || t.type === "mdxJsxTextElement")
    return EI(e, t, n);
  if (t.type === "mdxjsEsm")
    return CI(e, t);
  if (t.type === "root")
    return kI(e, t, n);
  if (t.type === "text")
    return NI(e, t);
}
function _I(e, t, n) {
  const r = e.schema;
  let a = r;
  t.tagName.toLowerCase() === "svg" && r.space === "html" && (a = A2, e.schema = a), e.ancestors.push(t);
  const o = Kj(e, t.tagName, !1), l = AI(e, t);
  let u = O2(e, t);
  return vI.has(t.tagName) && (u = u.filter(function(f) {
    return typeof f == "string" ? !ZD(f) : !0;
  })), Vj(e, l, o, t), z2(l, u), e.ancestors.pop(), e.schema = r, e.create(t, o, l, n);
}
function SI(e, t) {
  if (t.data && t.data.estree && e.evaluater) {
    const r = t.data.estree.body[0];
    return r.type, /** @type {Child | undefined} */
    e.evaluater.evaluateExpression(r.expression);
  }
  Vc(e, t.position);
}
function CI(e, t) {
  if (t.data && t.data.estree && e.evaluater)
    return (
      /** @type {Child | undefined} */
      e.evaluater.evaluateProgram(t.data.estree)
    );
  Vc(e, t.position);
}
function EI(e, t, n) {
  const r = e.schema;
  let a = r;
  t.name === "svg" && r.space === "html" && (a = A2, e.schema = a), e.ancestors.push(t);
  const o = t.name === null ? e.Fragment : Kj(e, t.name, !0), l = MI(e, t), u = O2(e, t);
  return Vj(e, l, o, t), z2(l, u), e.ancestors.pop(), e.schema = r, e.create(t, o, l, n);
}
function kI(e, t, n) {
  const r = {};
  return z2(r, O2(e, t)), e.create(t, e.Fragment, r, n);
}
function NI(e, t) {
  return t.value;
}
function Vj(e, t, n, r) {
  typeof n != "string" && n !== e.Fragment && e.passNode && (t.node = r);
}
function z2(e, t) {
  if (t.length > 0) {
    const n = t.length > 1 ? t : t[0];
    n && (e.children = n);
  }
}
function jI(e, t, n) {
  return r;
  function r(a, o, l, u) {
    const d = Array.isArray(l.children) ? n : t;
    return u ? d(o, l, u) : d(o, l);
  }
}
function TI(e, t) {
  return n;
  function n(r, a, o, l) {
    const u = Array.isArray(o.children), f = M2(r);
    return t(
      a,
      o,
      l,
      u,
      {
        columnNumber: f ? f.column - 1 : void 0,
        fileName: e,
        lineNumber: f ? f.line : void 0
      },
      void 0
    );
  }
}
function AI(e, t) {
  const n = {};
  let r, a;
  for (a in t.properties)
    if (a !== "children" && R2.call(t.properties, a)) {
      const o = RI(e, a, t.properties[a]);
      if (o) {
        const [l, u] = o;
        e.tableCellAlignToStyle && l === "align" && typeof u == "string" && bI.has(t.tagName) ? r = u : n[l] = u;
      }
    }
  if (r) {
    const o = (
      /** @type {Style} */
      n.style || (n.style = {})
    );
    o[e.stylePropertyNameCase === "css" ? "text-align" : "textAlign"] = r;
  }
  return n;
}
function MI(e, t) {
  const n = {};
  for (const r of t.attributes)
    if (r.type === "mdxJsxExpressionAttribute")
      if (r.data && r.data.estree && e.evaluater) {
        const o = r.data.estree.body[0];
        o.type;
        const l = o.expression;
        l.type;
        const u = l.properties[0];
        u.type, Object.assign(
          n,
          e.evaluater.evaluateExpression(u.argument)
        );
      } else
        Vc(e, t.position);
    else {
      const a = r.name;
      let o;
      if (r.value && typeof r.value == "object")
        if (r.value.data && r.value.data.estree && e.evaluater) {
          const u = r.value.data.estree.body[0];
          u.type, o = e.evaluater.evaluateExpression(u.expression);
        } else
          Vc(e, t.position);
      else
        o = r.value === null ? !0 : r.value;
      n[a] = /** @type {Props[keyof Props]} */
      o;
    }
  return n;
}
function O2(e, t) {
  const n = [];
  let r = -1;
  const a = e.passKeys ? /* @__PURE__ */ new Map() : yI;
  for (; ++r < t.children.length; ) {
    const o = t.children[r];
    let l;
    if (e.passKeys) {
      const f = o.type === "element" ? o.tagName : o.type === "mdxJsxFlowElement" || o.type === "mdxJsxTextElement" ? o.name : void 0;
      if (f) {
        const d = a.get(f) || 0;
        l = f + "-" + d, a.set(f, d + 1);
      }
    }
    const u = Gj(e, o, l);
    u !== void 0 && n.push(u);
  }
  return n;
}
function RI(e, t, n) {
  const r = aI(e.schema, t);
  if (!(n == null || typeof n == "number" && Number.isNaN(n))) {
    if (Array.isArray(n) && (n = r.commaSeparated ? KD(n) : uI(n)), r.property === "style") {
      let a = typeof n == "object" ? n : zI(e, String(n));
      return e.stylePropertyNameCase === "css" && (a = OI(a)), ["style", a];
    }
    return [
      e.elementAttributeNameCase === "react" && r.space ? nI[r.property] || r.property : r.attribute,
      n
    ];
  }
}
function zI(e, t) {
  try {
    return pI(t, { reactCompat: !0 });
  } catch (n) {
    if (e.ignoreInvalidStyle)
      return {};
    const r = (
      /** @type {Error} */
      n
    ), a = new cr("Cannot parse `style` attribute", {
      ancestors: e.ancestors,
      cause: r,
      ruleId: "style",
      source: "hast-util-to-jsx-runtime"
    });
    throw a.file = e.filePath || void 0, a.url = Hj + "#cannot-parse-style-attribute", a;
  }
}
function Kj(e, t, n) {
  let r;
  if (!n)
    r = { type: "Literal", value: t };
  else if (t.includes(".")) {
    const a = t.split(".");
    let o = -1, l;
    for (; ++o < a.length; ) {
      const u = p_(a[o]) ? { type: "Identifier", name: a[o] } : { type: "Literal", value: a[o] };
      l = l ? {
        type: "MemberExpression",
        object: l,
        property: u,
        computed: !!(o && u.type === "Literal"),
        optional: !1
      } : u;
    }
    r = l;
  } else
    r = p_(t) && !/^[a-z]/.test(t) ? { type: "Identifier", name: t } : { type: "Literal", value: t };
  if (r.type === "Literal") {
    const a = (
      /** @type {string | number} */
      r.value
    );
    return R2.call(e.components, a) ? e.components[a] : a;
  }
  if (e.evaluater)
    return e.evaluater.evaluateExpression(r);
  Vc(e);
}
function Vc(e, t) {
  const n = new cr(
    "Cannot handle MDX estrees without `createEvaluater`",
    {
      ancestors: e.ancestors,
      place: t,
      ruleId: "mdx-estree",
      source: "hast-util-to-jsx-runtime"
    }
  );
  throw n.file = e.filePath || void 0, n.url = Hj + "#cannot-handle-mdx-estrees-without-createevaluater", n;
}
function OI(e) {
  const t = {};
  let n;
  for (n in e)
    R2.call(e, n) && (t[DI(n)] = e[n]);
  return t;
}
function DI(e) {
  let t = e.replace(xI, II);
  return t.slice(0, 3) === "ms-" && (t = "-" + t), t;
}
function II(e) {
  return "-" + e.toLowerCase();
}
const Tg = {
  action: ["form"],
  cite: ["blockquote", "del", "ins", "q"],
  data: ["object"],
  formAction: ["button", "input"],
  href: ["a", "area", "base", "link"],
  icon: ["menuitem"],
  itemId: null,
  manifest: ["html"],
  ping: ["a", "area"],
  poster: ["video"],
  src: [
    "audio",
    "embed",
    "iframe",
    "img",
    "input",
    "script",
    "source",
    "track",
    "video"
  ]
}, LI = {};
function D2(e, t) {
  const n = LI, r = typeof n.includeImageAlt == "boolean" ? n.includeImageAlt : !0, a = typeof n.includeHtml == "boolean" ? n.includeHtml : !0;
  return Yj(e, r, a);
}
function Yj(e, t, n) {
  if (qI(e)) {
    if ("value" in e)
      return e.type === "html" && !n ? "" : e.value;
    if (t && "alt" in e && e.alt)
      return e.alt;
    if ("children" in e)
      return E_(e.children, t, n);
  }
  return Array.isArray(e) ? E_(e, t, n) : "";
}
function E_(e, t, n) {
  const r = [];
  let a = -1;
  for (; ++a < e.length; )
    r[a] = Yj(e[a], t, n);
  return r.join("");
}
function qI(e) {
  return !!(e && typeof e == "object");
}
const k_ = document.createElement("i");
function I2(e) {
  const t = "&" + e + ";";
  k_.innerHTML = t;
  const n = k_.textContent;
  return (
    // @ts-expect-error: TypeScript is wrong that `textContent` on elements can
    // yield `null`.
    n.charCodeAt(n.length - 1) === 59 && e !== "semi" || n === t ? !1 : n
  );
}
function Kr(e, t, n, r) {
  const a = e.length;
  let o = 0, l;
  if (t < 0 ? t = -t > a ? 0 : a + t : t = t > a ? a : t, n = n > 0 ? n : 0, r.length < 1e4)
    l = Array.from(r), l.unshift(t, n), e.splice(...l);
  else
    for (n && e.splice(t, n); o < r.length; )
      l = r.slice(o, o + 1e4), l.unshift(t, 0), e.splice(...l), o += 1e4, t += 1e4;
}
function ci(e, t) {
  return e.length > 0 ? (Kr(e, e.length, 0, t), e) : t;
}
const N_ = {}.hasOwnProperty;
function Xj(e) {
  const t = {};
  let n = -1;
  for (; ++n < e.length; )
    PI(t, e[n]);
  return t;
}
function PI(e, t) {
  let n;
  for (n in t) {
    const a = (N_.call(e, n) ? e[n] : void 0) || (e[n] = {}), o = t[n];
    let l;
    if (o)
      for (l in o) {
        N_.call(a, l) || (a[l] = []);
        const u = o[l];
        BI(
          // @ts-expect-error Looks like a list.
          a[l],
          Array.isArray(u) ? u : u ? [u] : []
        );
      }
  }
}
function BI(e, t) {
  let n = -1;
  const r = [];
  for (; ++n < t.length; )
    (t[n].add === "after" ? e : r).push(t[n]);
  Kr(e, 0, 0, r);
}
function Wj(e, t) {
  const n = Number.parseInt(e, t);
  return (
    // C0 except for HT, LF, FF, CR, space.
    n < 9 || n === 11 || n > 13 && n < 32 || // Control character (DEL) of C0, and C1 controls.
    n > 126 && n < 160 || // Lone high surrogates and low surrogates.
    n > 55295 && n < 57344 || // Noncharacters.
    n > 64975 && n < 65008 || /* eslint-disable no-bitwise */
    (n & 65535) === 65535 || (n & 65535) === 65534 || /* eslint-enable no-bitwise */
    // Out of range
    n > 1114111 ? "" : String.fromCodePoint(n)
  );
}
function Mi(e) {
  return e.replace(/[\t\n\r ]+/g, " ").replace(/^ | $/g, "").toLowerCase().toUpperCase();
}
const pr = Us(/[A-Za-z]/), lr = Us(/[\dA-Za-z]/), FI = Us(/[#-'*+\--9=?A-Z^-~]/);
function hh(e) {
  return (
    // Special whitespace codes (which have negative values), C0 and Control
    // character DEL
    e !== null && (e < 32 || e === 127)
  );
}
const Ib = Us(/\d/), $I = Us(/[\dA-Fa-f]/), UI = Us(/[!-/:-@[-`{-~]/);
function ut(e) {
  return e !== null && e < -2;
}
function Wt(e) {
  return e !== null && (e < 0 || e === 32);
}
function Ct(e) {
  return e === -2 || e === -1 || e === 32;
}
const Fh = Us(new RegExp("\\p{P}|\\p{S}", "u")), zo = Us(/\s/);
function Us(e) {
  return t;
  function t(n) {
    return n !== null && n > -1 && e.test(String.fromCharCode(n));
  }
}
function fu(e) {
  const t = [];
  let n = -1, r = 0, a = 0;
  for (; ++n < e.length; ) {
    const o = e.charCodeAt(n);
    let l = "";
    if (o === 37 && lr(e.charCodeAt(n + 1)) && lr(e.charCodeAt(n + 2)))
      a = 2;
    else if (o < 128)
      /[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(o)) || (l = String.fromCharCode(o));
    else if (o > 55295 && o < 57344) {
      const u = e.charCodeAt(n + 1);
      o < 56320 && u > 56319 && u < 57344 ? (l = String.fromCharCode(o, u), a = 1) : l = "";
    } else
      l = String.fromCharCode(o);
    l && (t.push(e.slice(r, n), encodeURIComponent(l)), r = n + a + 1, l = ""), a && (n += a, a = 0);
  }
  return t.join("") + e.slice(r);
}
function Mt(e, t, n, r) {
  const a = r ? r - 1 : Number.POSITIVE_INFINITY;
  let o = 0;
  return l;
  function l(f) {
    return Ct(f) ? (e.enter(n), u(f)) : t(f);
  }
  function u(f) {
    return Ct(f) && o++ < a ? (e.consume(f), u) : (e.exit(n), t(f));
  }
}
const HI = {
  tokenize: GI
};
function GI(e) {
  const t = e.attempt(this.parser.constructs.contentInitial, r, a);
  let n;
  return t;
  function r(u) {
    if (u === null) {
      e.consume(u);
      return;
    }
    return e.enter("lineEnding"), e.consume(u), e.exit("lineEnding"), Mt(e, t, "linePrefix");
  }
  function a(u) {
    return e.enter("paragraph"), o(u);
  }
  function o(u) {
    const f = e.enter("chunkText", {
      contentType: "text",
      previous: n
    });
    return n && (n.next = f), n = f, l(u);
  }
  function l(u) {
    if (u === null) {
      e.exit("chunkText"), e.exit("paragraph"), e.consume(u);
      return;
    }
    return ut(u) ? (e.consume(u), e.exit("chunkText"), o) : (e.consume(u), l);
  }
}
const VI = {
  tokenize: KI
}, j_ = {
  tokenize: YI
};
function KI(e) {
  const t = this, n = [];
  let r = 0, a, o, l;
  return u;
  function u(N) {
    if (r < n.length) {
      const A = n[r];
      return t.containerState = A[1], e.attempt(A[0].continuation, f, d)(N);
    }
    return d(N);
  }
  function f(N) {
    if (r++, t.containerState._closeFlow) {
      t.containerState._closeFlow = void 0, a && T();
      const A = t.events.length;
      let D = A, M;
      for (; D--; )
        if (t.events[D][0] === "exit" && t.events[D][1].type === "chunkFlow") {
          M = t.events[D][1].end;
          break;
        }
      C(r);
      let O = A;
      for (; O < t.events.length; )
        t.events[O][1].end = {
          ...M
        }, O++;
      return Kr(t.events, D + 1, 0, t.events.slice(A)), t.events.length = O, d(N);
    }
    return u(N);
  }
  function d(N) {
    if (r === n.length) {
      if (!a)
        return x(N);
      if (a.currentConstruct && a.currentConstruct.concrete)
        return w(N);
      t.interrupt = !!(a.currentConstruct && !a._gfmTableDynamicInterruptHack);
    }
    return t.containerState = {}, e.check(j_, m, p)(N);
  }
  function m(N) {
    return a && T(), C(r), x(N);
  }
  function p(N) {
    return t.parser.lazy[t.now().line] = r !== n.length, l = t.now().offset, w(N);
  }
  function x(N) {
    return t.containerState = {}, e.attempt(j_, y, w)(N);
  }
  function y(N) {
    return r++, n.push([t.currentConstruct, t.containerState]), x(N);
  }
  function w(N) {
    if (N === null) {
      a && T(), C(0), e.consume(N);
      return;
    }
    return a = a || t.parser.flow(t.now()), e.enter("chunkFlow", {
      _tokenizer: a,
      contentType: "flow",
      previous: o
    }), E(N);
  }
  function E(N) {
    if (N === null) {
      k(e.exit("chunkFlow"), !0), C(0), e.consume(N);
      return;
    }
    return ut(N) ? (e.consume(N), k(e.exit("chunkFlow")), r = 0, t.interrupt = void 0, u) : (e.consume(N), E);
  }
  function k(N, A) {
    const D = t.sliceStream(N);
    if (A && D.push(null), N.previous = o, o && (o.next = N), o = N, a.defineSkip(N.start), a.write(D), t.parser.lazy[N.start.line]) {
      let M = a.events.length;
      for (; M--; )
        if (
          // The token starts before the line ending
          a.events[M][1].start.offset < l && // and either is not ended yet
          (!a.events[M][1].end || // or ends after it.
          a.events[M][1].end.offset > l)
        )
          return;
      const O = t.events.length;
      let Y = O, X, U;
      for (; Y--; )
        if (t.events[Y][0] === "exit" && t.events[Y][1].type === "chunkFlow") {
          if (X) {
            U = t.events[Y][1].end;
            break;
          }
          X = !0;
        }
      for (C(r), M = O; M < t.events.length; )
        t.events[M][1].end = {
          ...U
        }, M++;
      Kr(t.events, Y + 1, 0, t.events.slice(O)), t.events.length = M;
    }
  }
  function C(N) {
    let A = n.length;
    for (; A-- > N; ) {
      const D = n[A];
      t.containerState = D[1], D[0].exit.call(t, e);
    }
    n.length = N;
  }
  function T() {
    a.write([null]), o = void 0, a = void 0, t.containerState._closeFlow = void 0;
  }
}
function YI(e, t, n) {
  return Mt(e, e.attempt(this.parser.constructs.document, t, n), "linePrefix", this.parser.constructs.disable.null.includes("codeIndented") ? void 0 : 4);
}
function Jl(e) {
  if (e === null || Wt(e) || zo(e))
    return 1;
  if (Fh(e))
    return 2;
}
function $h(e, t, n) {
  const r = [];
  let a = -1;
  for (; ++a < e.length; ) {
    const o = e[a].resolveAll;
    o && !r.includes(o) && (t = o(t, n), r.push(o));
  }
  return t;
}
const Lb = {
  name: "attention",
  resolveAll: XI,
  tokenize: WI
};
function XI(e, t) {
  let n = -1, r, a, o, l, u, f, d, m;
  for (; ++n < e.length; )
    if (e[n][0] === "enter" && e[n][1].type === "attentionSequence" && e[n][1]._close) {
      for (r = n; r--; )
        if (e[r][0] === "exit" && e[r][1].type === "attentionSequence" && e[r][1]._open && // If the markers are the same:
        t.sliceSerialize(e[r][1]).charCodeAt(0) === t.sliceSerialize(e[n][1]).charCodeAt(0)) {
          if ((e[r][1]._close || e[n][1]._open) && (e[n][1].end.offset - e[n][1].start.offset) % 3 && !((e[r][1].end.offset - e[r][1].start.offset + e[n][1].end.offset - e[n][1].start.offset) % 3))
            continue;
          f = e[r][1].end.offset - e[r][1].start.offset > 1 && e[n][1].end.offset - e[n][1].start.offset > 1 ? 2 : 1;
          const p = {
            ...e[r][1].end
          }, x = {
            ...e[n][1].start
          };
          T_(p, -f), T_(x, f), l = {
            type: f > 1 ? "strongSequence" : "emphasisSequence",
            start: p,
            end: {
              ...e[r][1].end
            }
          }, u = {
            type: f > 1 ? "strongSequence" : "emphasisSequence",
            start: {
              ...e[n][1].start
            },
            end: x
          }, o = {
            type: f > 1 ? "strongText" : "emphasisText",
            start: {
              ...e[r][1].end
            },
            end: {
              ...e[n][1].start
            }
          }, a = {
            type: f > 1 ? "strong" : "emphasis",
            start: {
              ...l.start
            },
            end: {
              ...u.end
            }
          }, e[r][1].end = {
            ...l.start
          }, e[n][1].start = {
            ...u.end
          }, d = [], e[r][1].end.offset - e[r][1].start.offset && (d = ci(d, [["enter", e[r][1], t], ["exit", e[r][1], t]])), d = ci(d, [["enter", a, t], ["enter", l, t], ["exit", l, t], ["enter", o, t]]), d = ci(d, $h(t.parser.constructs.insideSpan.null, e.slice(r + 1, n), t)), d = ci(d, [["exit", o, t], ["enter", u, t], ["exit", u, t], ["exit", a, t]]), e[n][1].end.offset - e[n][1].start.offset ? (m = 2, d = ci(d, [["enter", e[n][1], t], ["exit", e[n][1], t]])) : m = 0, Kr(e, r - 1, n - r + 3, d), n = r + d.length - m - 2;
          break;
        }
    }
  for (n = -1; ++n < e.length; )
    e[n][1].type === "attentionSequence" && (e[n][1].type = "data");
  return e;
}
function WI(e, t) {
  const n = this.parser.constructs.attentionMarkers.null, r = this.previous, a = Jl(r);
  let o;
  return l;
  function l(f) {
    return o = f, e.enter("attentionSequence"), u(f);
  }
  function u(f) {
    if (f === o)
      return e.consume(f), u;
    const d = e.exit("attentionSequence"), m = Jl(f), p = !m || m === 2 && a || n.includes(f), x = !a || a === 2 && m || n.includes(r);
    return d._open = !!(o === 42 ? p : p && (a || !x)), d._close = !!(o === 42 ? x : x && (m || !p)), t(f);
  }
}
function T_(e, t) {
  e.column += t, e.offset += t, e._bufferIndex += t;
}
const QI = {
  name: "autolink",
  tokenize: ZI
};
function ZI(e, t, n) {
  let r = 0;
  return a;
  function a(y) {
    return e.enter("autolink"), e.enter("autolinkMarker"), e.consume(y), e.exit("autolinkMarker"), e.enter("autolinkProtocol"), o;
  }
  function o(y) {
    return pr(y) ? (e.consume(y), l) : y === 64 ? n(y) : d(y);
  }
  function l(y) {
    return y === 43 || y === 45 || y === 46 || lr(y) ? (r = 1, u(y)) : d(y);
  }
  function u(y) {
    return y === 58 ? (e.consume(y), r = 0, f) : (y === 43 || y === 45 || y === 46 || lr(y)) && r++ < 32 ? (e.consume(y), u) : (r = 0, d(y));
  }
  function f(y) {
    return y === 62 ? (e.exit("autolinkProtocol"), e.enter("autolinkMarker"), e.consume(y), e.exit("autolinkMarker"), e.exit("autolink"), t) : y === null || y === 32 || y === 60 || hh(y) ? n(y) : (e.consume(y), f);
  }
  function d(y) {
    return y === 64 ? (e.consume(y), m) : FI(y) ? (e.consume(y), d) : n(y);
  }
  function m(y) {
    return lr(y) ? p(y) : n(y);
  }
  function p(y) {
    return y === 46 ? (e.consume(y), r = 0, m) : y === 62 ? (e.exit("autolinkProtocol").type = "autolinkEmail", e.enter("autolinkMarker"), e.consume(y), e.exit("autolinkMarker"), e.exit("autolink"), t) : x(y);
  }
  function x(y) {
    if ((y === 45 || lr(y)) && r++ < 63) {
      const w = y === 45 ? x : p;
      return e.consume(y), w;
    }
    return n(y);
  }
}
const od = {
  partial: !0,
  tokenize: JI
};
function JI(e, t, n) {
  return r;
  function r(o) {
    return Ct(o) ? Mt(e, a, "linePrefix")(o) : a(o);
  }
  function a(o) {
    return o === null || ut(o) ? t(o) : n(o);
  }
}
const Qj = {
  continuation: {
    tokenize: tL
  },
  exit: nL,
  name: "blockQuote",
  tokenize: eL
};
function eL(e, t, n) {
  const r = this;
  return a;
  function a(l) {
    if (l === 62) {
      const u = r.containerState;
      return u.open || (e.enter("blockQuote", {
        _container: !0
      }), u.open = !0), e.enter("blockQuotePrefix"), e.enter("blockQuoteMarker"), e.consume(l), e.exit("blockQuoteMarker"), o;
    }
    return n(l);
  }
  function o(l) {
    return Ct(l) ? (e.enter("blockQuotePrefixWhitespace"), e.consume(l), e.exit("blockQuotePrefixWhitespace"), e.exit("blockQuotePrefix"), t) : (e.exit("blockQuotePrefix"), t(l));
  }
}
function tL(e, t, n) {
  const r = this;
  return a;
  function a(l) {
    return Ct(l) ? Mt(e, o, "linePrefix", r.parser.constructs.disable.null.includes("codeIndented") ? void 0 : 4)(l) : o(l);
  }
  function o(l) {
    return e.attempt(Qj, t, n)(l);
  }
}
function nL(e) {
  e.exit("blockQuote");
}
const Zj = {
  name: "characterEscape",
  tokenize: rL
};
function rL(e, t, n) {
  return r;
  function r(o) {
    return e.enter("characterEscape"), e.enter("escapeMarker"), e.consume(o), e.exit("escapeMarker"), a;
  }
  function a(o) {
    return UI(o) ? (e.enter("characterEscapeValue"), e.consume(o), e.exit("characterEscapeValue"), e.exit("characterEscape"), t) : n(o);
  }
}
const Jj = {
  name: "characterReference",
  tokenize: iL
};
function iL(e, t, n) {
  const r = this;
  let a = 0, o, l;
  return u;
  function u(p) {
    return e.enter("characterReference"), e.enter("characterReferenceMarker"), e.consume(p), e.exit("characterReferenceMarker"), f;
  }
  function f(p) {
    return p === 35 ? (e.enter("characterReferenceMarkerNumeric"), e.consume(p), e.exit("characterReferenceMarkerNumeric"), d) : (e.enter("characterReferenceValue"), o = 31, l = lr, m(p));
  }
  function d(p) {
    return p === 88 || p === 120 ? (e.enter("characterReferenceMarkerHexadecimal"), e.consume(p), e.exit("characterReferenceMarkerHexadecimal"), e.enter("characterReferenceValue"), o = 6, l = $I, m) : (e.enter("characterReferenceValue"), o = 7, l = Ib, m(p));
  }
  function m(p) {
    if (p === 59 && a) {
      const x = e.exit("characterReferenceValue");
      return l === lr && !I2(r.sliceSerialize(x)) ? n(p) : (e.enter("characterReferenceMarker"), e.consume(p), e.exit("characterReferenceMarker"), e.exit("characterReference"), t);
    }
    return l(p) && a++ < o ? (e.consume(p), m) : n(p);
  }
}
const A_ = {
  partial: !0,
  tokenize: sL
}, M_ = {
  concrete: !0,
  name: "codeFenced",
  tokenize: aL
};
function aL(e, t, n) {
  const r = this, a = {
    partial: !0,
    tokenize: D
  };
  let o = 0, l = 0, u;
  return f;
  function f(M) {
    return d(M);
  }
  function d(M) {
    const O = r.events[r.events.length - 1];
    return o = O && O[1].type === "linePrefix" ? O[2].sliceSerialize(O[1], !0).length : 0, u = M, e.enter("codeFenced"), e.enter("codeFencedFence"), e.enter("codeFencedFenceSequence"), m(M);
  }
  function m(M) {
    return M === u ? (l++, e.consume(M), m) : l < 3 ? n(M) : (e.exit("codeFencedFenceSequence"), Ct(M) ? Mt(e, p, "whitespace")(M) : p(M));
  }
  function p(M) {
    return M === null || ut(M) ? (e.exit("codeFencedFence"), r.interrupt ? t(M) : e.check(A_, E, A)(M)) : (e.enter("codeFencedFenceInfo"), e.enter("chunkString", {
      contentType: "string"
    }), x(M));
  }
  function x(M) {
    return M === null || ut(M) ? (e.exit("chunkString"), e.exit("codeFencedFenceInfo"), p(M)) : Ct(M) ? (e.exit("chunkString"), e.exit("codeFencedFenceInfo"), Mt(e, y, "whitespace")(M)) : M === 96 && M === u ? n(M) : (e.consume(M), x);
  }
  function y(M) {
    return M === null || ut(M) ? p(M) : (e.enter("codeFencedFenceMeta"), e.enter("chunkString", {
      contentType: "string"
    }), w(M));
  }
  function w(M) {
    return M === null || ut(M) ? (e.exit("chunkString"), e.exit("codeFencedFenceMeta"), p(M)) : M === 96 && M === u ? n(M) : (e.consume(M), w);
  }
  function E(M) {
    return e.attempt(a, A, k)(M);
  }
  function k(M) {
    return e.enter("lineEnding"), e.consume(M), e.exit("lineEnding"), C;
  }
  function C(M) {
    return o > 0 && Ct(M) ? Mt(e, T, "linePrefix", o + 1)(M) : T(M);
  }
  function T(M) {
    return M === null || ut(M) ? e.check(A_, E, A)(M) : (e.enter("codeFlowValue"), N(M));
  }
  function N(M) {
    return M === null || ut(M) ? (e.exit("codeFlowValue"), T(M)) : (e.consume(M), N);
  }
  function A(M) {
    return e.exit("codeFenced"), t(M);
  }
  function D(M, O, Y) {
    let X = 0;
    return U;
    function U(W) {
      return M.enter("lineEnding"), M.consume(W), M.exit("lineEnding"), B;
    }
    function B(W) {
      return M.enter("codeFencedFence"), Ct(W) ? Mt(M, G, "linePrefix", r.parser.constructs.disable.null.includes("codeIndented") ? void 0 : 4)(W) : G(W);
    }
    function G(W) {
      return W === u ? (M.enter("codeFencedFenceSequence"), re(W)) : Y(W);
    }
    function re(W) {
      return W === u ? (X++, M.consume(W), re) : X >= l ? (M.exit("codeFencedFenceSequence"), Ct(W) ? Mt(M, q, "whitespace")(W) : q(W)) : Y(W);
    }
    function q(W) {
      return W === null || ut(W) ? (M.exit("codeFencedFence"), O(W)) : Y(W);
    }
  }
}
function sL(e, t, n) {
  const r = this;
  return a;
  function a(l) {
    return l === null ? n(l) : (e.enter("lineEnding"), e.consume(l), e.exit("lineEnding"), o);
  }
  function o(l) {
    return r.parser.lazy[r.now().line] ? n(l) : t(l);
  }
}
const Ag = {
  name: "codeIndented",
  tokenize: lL
}, oL = {
  partial: !0,
  tokenize: uL
};
function lL(e, t, n) {
  const r = this;
  return a;
  function a(d) {
    return e.enter("codeIndented"), Mt(e, o, "linePrefix", 5)(d);
  }
  function o(d) {
    const m = r.events[r.events.length - 1];
    return m && m[1].type === "linePrefix" && m[2].sliceSerialize(m[1], !0).length >= 4 ? l(d) : n(d);
  }
  function l(d) {
    return d === null ? f(d) : ut(d) ? e.attempt(oL, l, f)(d) : (e.enter("codeFlowValue"), u(d));
  }
  function u(d) {
    return d === null || ut(d) ? (e.exit("codeFlowValue"), l(d)) : (e.consume(d), u);
  }
  function f(d) {
    return e.exit("codeIndented"), t(d);
  }
}
function uL(e, t, n) {
  const r = this;
  return a;
  function a(l) {
    return r.parser.lazy[r.now().line] ? n(l) : ut(l) ? (e.enter("lineEnding"), e.consume(l), e.exit("lineEnding"), a) : Mt(e, o, "linePrefix", 5)(l);
  }
  function o(l) {
    const u = r.events[r.events.length - 1];
    return u && u[1].type === "linePrefix" && u[2].sliceSerialize(u[1], !0).length >= 4 ? t(l) : ut(l) ? a(l) : n(l);
  }
}
const cL = {
  name: "codeText",
  previous: fL,
  resolve: dL,
  tokenize: hL
};
function dL(e) {
  let t = e.length - 4, n = 3, r, a;
  if ((e[n][1].type === "lineEnding" || e[n][1].type === "space") && (e[t][1].type === "lineEnding" || e[t][1].type === "space")) {
    for (r = n; ++r < t; )
      if (e[r][1].type === "codeTextData") {
        e[n][1].type = "codeTextPadding", e[t][1].type = "codeTextPadding", n += 2, t -= 2;
        break;
      }
  }
  for (r = n - 1, t++; ++r <= t; )
    a === void 0 ? r !== t && e[r][1].type !== "lineEnding" && (a = r) : (r === t || e[r][1].type === "lineEnding") && (e[a][1].type = "codeTextData", r !== a + 2 && (e[a][1].end = e[r - 1][1].end, e.splice(a + 2, r - a - 2), t -= r - a - 2, r = a + 2), a = void 0);
  return e;
}
function fL(e) {
  return e !== 96 || this.events[this.events.length - 1][1].type === "characterEscape";
}
function hL(e, t, n) {
  let r = 0, a, o;
  return l;
  function l(p) {
    return e.enter("codeText"), e.enter("codeTextSequence"), u(p);
  }
  function u(p) {
    return p === 96 ? (e.consume(p), r++, u) : (e.exit("codeTextSequence"), f(p));
  }
  function f(p) {
    return p === null ? n(p) : p === 32 ? (e.enter("space"), e.consume(p), e.exit("space"), f) : p === 96 ? (o = e.enter("codeTextSequence"), a = 0, m(p)) : ut(p) ? (e.enter("lineEnding"), e.consume(p), e.exit("lineEnding"), f) : (e.enter("codeTextData"), d(p));
  }
  function d(p) {
    return p === null || p === 32 || p === 96 || ut(p) ? (e.exit("codeTextData"), f(p)) : (e.consume(p), d);
  }
  function m(p) {
    return p === 96 ? (e.consume(p), a++, m) : a === r ? (e.exit("codeTextSequence"), e.exit("codeText"), t(p)) : (o.type = "codeTextData", d(p));
  }
}
class mL {
  /**
   * @param {ReadonlyArray<T> | null | undefined} [initial]
   *   Initial items (optional).
   * @returns
   *   Splice buffer.
   */
  constructor(t) {
    this.left = t ? [...t] : [], this.right = [];
  }
  /**
   * Array access;
   * does not move the cursor.
   *
   * @param {number} index
   *   Index.
   * @return {T}
   *   Item.
   */
  get(t) {
    if (t < 0 || t >= this.left.length + this.right.length)
      throw new RangeError("Cannot access index `" + t + "` in a splice buffer of size `" + (this.left.length + this.right.length) + "`");
    return t < this.left.length ? this.left[t] : this.right[this.right.length - t + this.left.length - 1];
  }
  /**
   * The length of the splice buffer, one greater than the largest index in the
   * array.
   */
  get length() {
    return this.left.length + this.right.length;
  }
  /**
   * Remove and return `list[0]`;
   * moves the cursor to `0`.
   *
   * @returns {T | undefined}
   *   Item, optional.
   */
  shift() {
    return this.setCursor(0), this.right.pop();
  }
  /**
   * Slice the buffer to get an array;
   * does not move the cursor.
   *
   * @param {number} start
   *   Start.
   * @param {number | null | undefined} [end]
   *   End (optional).
   * @returns {Array<T>}
   *   Array of items.
   */
  slice(t, n) {
    const r = n ?? Number.POSITIVE_INFINITY;
    return r < this.left.length ? this.left.slice(t, r) : t > this.left.length ? this.right.slice(this.right.length - r + this.left.length, this.right.length - t + this.left.length).reverse() : this.left.slice(t).concat(this.right.slice(this.right.length - r + this.left.length).reverse());
  }
  /**
   * Mimics the behavior of Array.prototype.splice() except for the change of
   * interface necessary to avoid segfaults when patching in very large arrays.
   *
   * This operation moves cursor is moved to `start` and results in the cursor
   * placed after any inserted items.
   *
   * @param {number} start
   *   Start;
   *   zero-based index at which to start changing the array;
   *   negative numbers count backwards from the end of the array and values
   *   that are out-of bounds are clamped to the appropriate end of the array.
   * @param {number | null | undefined} [deleteCount=0]
   *   Delete count (default: `0`);
   *   maximum number of elements to delete, starting from start.
   * @param {Array<T> | null | undefined} [items=[]]
   *   Items to include in place of the deleted items (default: `[]`).
   * @return {Array<T>}
   *   Any removed items.
   */
  splice(t, n, r) {
    const a = n || 0;
    this.setCursor(Math.trunc(t));
    const o = this.right.splice(this.right.length - a, Number.POSITIVE_INFINITY);
    return r && _c(this.left, r), o.reverse();
  }
  /**
   * Remove and return the highest-numbered item in the array, so
   * `list[list.length - 1]`;
   * Moves the cursor to `length`.
   *
   * @returns {T | undefined}
   *   Item, optional.
   */
  pop() {
    return this.setCursor(Number.POSITIVE_INFINITY), this.left.pop();
  }
  /**
   * Inserts a single item to the high-numbered side of the array;
   * moves the cursor to `length`.
   *
   * @param {T} item
   *   Item.
   * @returns {undefined}
   *   Nothing.
   */
  push(t) {
    this.setCursor(Number.POSITIVE_INFINITY), this.left.push(t);
  }
  /**
   * Inserts many items to the high-numbered side of the array.
   * Moves the cursor to `length`.
   *
   * @param {Array<T>} items
   *   Items.
   * @returns {undefined}
   *   Nothing.
   */
  pushMany(t) {
    this.setCursor(Number.POSITIVE_INFINITY), _c(this.left, t);
  }
  /**
   * Inserts a single item to the low-numbered side of the array;
   * Moves the cursor to `0`.
   *
   * @param {T} item
   *   Item.
   * @returns {undefined}
   *   Nothing.
   */
  unshift(t) {
    this.setCursor(0), this.right.push(t);
  }
  /**
   * Inserts many items to the low-numbered side of the array;
   * moves the cursor to `0`.
   *
   * @param {Array<T>} items
   *   Items.
   * @returns {undefined}
   *   Nothing.
   */
  unshiftMany(t) {
    this.setCursor(0), _c(this.right, t.reverse());
  }
  /**
   * Move the cursor to a specific position in the array. Requires
   * time proportional to the distance moved.
   *
   * If `n < 0`, the cursor will end up at the beginning.
   * If `n > length`, the cursor will end up at the end.
   *
   * @param {number} n
   *   Position.
   * @return {undefined}
   *   Nothing.
   */
  setCursor(t) {
    if (!(t === this.left.length || t > this.left.length && this.right.length === 0 || t < 0 && this.left.length === 0))
      if (t < this.left.length) {
        const n = this.left.splice(t, Number.POSITIVE_INFINITY);
        _c(this.right, n.reverse());
      } else {
        const n = this.right.splice(this.left.length + this.right.length - t, Number.POSITIVE_INFINITY);
        _c(this.left, n.reverse());
      }
  }
}
function _c(e, t) {
  let n = 0;
  if (t.length < 1e4)
    e.push(...t);
  else
    for (; n < t.length; )
      e.push(...t.slice(n, n + 1e4)), n += 1e4;
}
function e7(e) {
  const t = {};
  let n = -1, r, a, o, l, u, f, d;
  const m = new mL(e);
  for (; ++n < m.length; ) {
    for (; n in t; )
      n = t[n];
    if (r = m.get(n), n && r[1].type === "chunkFlow" && m.get(n - 1)[1].type === "listItemPrefix" && (f = r[1]._tokenizer.events, o = 0, o < f.length && f[o][1].type === "lineEndingBlank" && (o += 2), o < f.length && f[o][1].type === "content"))
      for (; ++o < f.length && f[o][1].type !== "content"; )
        f[o][1].type === "chunkText" && (f[o][1]._isInFirstContentOfListItem = !0, o++);
    if (r[0] === "enter")
      r[1].contentType && (Object.assign(t, pL(m, n)), n = t[n], d = !0);
    else if (r[1]._container) {
      for (o = n, a = void 0; o--; )
        if (l = m.get(o), l[1].type === "lineEnding" || l[1].type === "lineEndingBlank")
          l[0] === "enter" && (a && (m.get(a)[1].type = "lineEndingBlank"), l[1].type = "lineEnding", a = o);
        else if (!(l[1].type === "linePrefix" || l[1].type === "listItemIndent")) break;
      a && (r[1].end = {
        ...m.get(a)[1].start
      }, u = m.slice(a, n), u.unshift(r), m.splice(a, n - a + 1, u));
    }
  }
  return Kr(e, 0, Number.POSITIVE_INFINITY, m.slice(0)), !d;
}
function pL(e, t) {
  const n = e.get(t)[1], r = e.get(t)[2];
  let a = t - 1;
  const o = [];
  let l = n._tokenizer;
  l || (l = r.parser[n.contentType](n.start), n._contentTypeTextTrailing && (l._contentTypeTextTrailing = !0));
  const u = l.events, f = [], d = {};
  let m, p, x = -1, y = n, w = 0, E = 0;
  const k = [E];
  for (; y; ) {
    for (; e.get(++a)[1] !== y; )
      ;
    o.push(a), y._tokenizer || (m = r.sliceStream(y), y.next || m.push(null), p && l.defineSkip(y.start), y._isInFirstContentOfListItem && (l._gfmTasklistFirstContentOfListItem = !0), l.write(m), y._isInFirstContentOfListItem && (l._gfmTasklistFirstContentOfListItem = void 0)), p = y, y = y.next;
  }
  for (y = n; ++x < u.length; )
    // Find a void token that includes a break.
    u[x][0] === "exit" && u[x - 1][0] === "enter" && u[x][1].type === u[x - 1][1].type && u[x][1].start.line !== u[x][1].end.line && (E = x + 1, k.push(E), y._tokenizer = void 0, y.previous = void 0, y = y.next);
  for (l.events = [], y ? (y._tokenizer = void 0, y.previous = void 0) : k.pop(), x = k.length; x--; ) {
    const C = u.slice(k[x], k[x + 1]), T = o.pop();
    f.push([T, T + C.length - 1]), e.splice(T, 2, C);
  }
  for (f.reverse(), x = -1; ++x < f.length; )
    d[w + f[x][0]] = w + f[x][1], w += f[x][1] - f[x][0] - 1;
  return d;
}
const gL = {
  resolve: xL,
  tokenize: vL
}, yL = {
  partial: !0,
  tokenize: bL
};
function xL(e) {
  return e7(e), e;
}
function vL(e, t) {
  let n;
  return r;
  function r(u) {
    return e.enter("content"), n = e.enter("chunkContent", {
      contentType: "content"
    }), a(u);
  }
  function a(u) {
    return u === null ? o(u) : ut(u) ? e.check(yL, l, o)(u) : (e.consume(u), a);
  }
  function o(u) {
    return e.exit("chunkContent"), e.exit("content"), t(u);
  }
  function l(u) {
    return e.consume(u), e.exit("chunkContent"), n.next = e.enter("chunkContent", {
      contentType: "content",
      previous: n
    }), n = n.next, a;
  }
}
function bL(e, t, n) {
  const r = this;
  return a;
  function a(l) {
    return e.exit("chunkContent"), e.enter("lineEnding"), e.consume(l), e.exit("lineEnding"), Mt(e, o, "linePrefix");
  }
  function o(l) {
    if (l === null || ut(l))
      return n(l);
    const u = r.events[r.events.length - 1];
    return !r.parser.constructs.disable.null.includes("codeIndented") && u && u[1].type === "linePrefix" && u[2].sliceSerialize(u[1], !0).length >= 4 ? t(l) : e.interrupt(r.parser.constructs.flow, n, t)(l);
  }
}
function t7(e, t, n, r, a, o, l, u, f) {
  const d = f || Number.POSITIVE_INFINITY;
  let m = 0;
  return p;
  function p(C) {
    return C === 60 ? (e.enter(r), e.enter(a), e.enter(o), e.consume(C), e.exit(o), x) : C === null || C === 32 || C === 41 || hh(C) ? n(C) : (e.enter(r), e.enter(l), e.enter(u), e.enter("chunkString", {
      contentType: "string"
    }), E(C));
  }
  function x(C) {
    return C === 62 ? (e.enter(o), e.consume(C), e.exit(o), e.exit(a), e.exit(r), t) : (e.enter(u), e.enter("chunkString", {
      contentType: "string"
    }), y(C));
  }
  function y(C) {
    return C === 62 ? (e.exit("chunkString"), e.exit(u), x(C)) : C === null || C === 60 || ut(C) ? n(C) : (e.consume(C), C === 92 ? w : y);
  }
  function w(C) {
    return C === 60 || C === 62 || C === 92 ? (e.consume(C), y) : y(C);
  }
  function E(C) {
    return !m && (C === null || C === 41 || Wt(C)) ? (e.exit("chunkString"), e.exit(u), e.exit(l), e.exit(r), t(C)) : m < d && C === 40 ? (e.consume(C), m++, E) : C === 41 ? (e.consume(C), m--, E) : C === null || C === 32 || C === 40 || hh(C) ? n(C) : (e.consume(C), C === 92 ? k : E);
  }
  function k(C) {
    return C === 40 || C === 41 || C === 92 ? (e.consume(C), E) : E(C);
  }
}
function n7(e, t, n, r, a, o) {
  const l = this;
  let u = 0, f;
  return d;
  function d(y) {
    return e.enter(r), e.enter(a), e.consume(y), e.exit(a), e.enter(o), m;
  }
  function m(y) {
    return u > 999 || y === null || y === 91 || y === 93 && !f || // To do: remove in the future once weve switched from
    // `micromark-extension-footnote` to `micromark-extension-gfm-footnote`,
    // which doesnt need this.
    // Hidden footnotes hook.
    /* c8 ignore next 3 */
    y === 94 && !u && "_hiddenFootnoteSupport" in l.parser.constructs ? n(y) : y === 93 ? (e.exit(o), e.enter(a), e.consume(y), e.exit(a), e.exit(r), t) : ut(y) ? (e.enter("lineEnding"), e.consume(y), e.exit("lineEnding"), m) : (e.enter("chunkString", {
      contentType: "string"
    }), p(y));
  }
  function p(y) {
    return y === null || y === 91 || y === 93 || ut(y) || u++ > 999 ? (e.exit("chunkString"), m(y)) : (e.consume(y), f || (f = !Ct(y)), y === 92 ? x : p);
  }
  function x(y) {
    return y === 91 || y === 92 || y === 93 ? (e.consume(y), u++, p) : p(y);
  }
}
function r7(e, t, n, r, a, o) {
  let l;
  return u;
  function u(x) {
    return x === 34 || x === 39 || x === 40 ? (e.enter(r), e.enter(a), e.consume(x), e.exit(a), l = x === 40 ? 41 : x, f) : n(x);
  }
  function f(x) {
    return x === l ? (e.enter(a), e.consume(x), e.exit(a), e.exit(r), t) : (e.enter(o), d(x));
  }
  function d(x) {
    return x === l ? (e.exit(o), f(l)) : x === null ? n(x) : ut(x) ? (e.enter("lineEnding"), e.consume(x), e.exit("lineEnding"), Mt(e, d, "linePrefix")) : (e.enter("chunkString", {
      contentType: "string"
    }), m(x));
  }
  function m(x) {
    return x === l || x === null || ut(x) ? (e.exit("chunkString"), d(x)) : (e.consume(x), x === 92 ? p : m);
  }
  function p(x) {
    return x === l || x === 92 ? (e.consume(x), m) : m(x);
  }
}
function qc(e, t) {
  let n;
  return r;
  function r(a) {
    return ut(a) ? (e.enter("lineEnding"), e.consume(a), e.exit("lineEnding"), n = !0, r) : Ct(a) ? Mt(e, r, n ? "linePrefix" : "lineSuffix")(a) : t(a);
  }
}
const wL = {
  name: "definition",
  tokenize: SL
}, _L = {
  partial: !0,
  tokenize: CL
};
function SL(e, t, n) {
  const r = this;
  let a;
  return o;
  function o(y) {
    return e.enter("definition"), l(y);
  }
  function l(y) {
    return n7.call(
      r,
      e,
      u,
      // Note: we dont need to reset the way `markdown-rs` does.
      n,
      "definitionLabel",
      "definitionLabelMarker",
      "definitionLabelString"
    )(y);
  }
  function u(y) {
    return a = Mi(r.sliceSerialize(r.events[r.events.length - 1][1]).slice(1, -1)), y === 58 ? (e.enter("definitionMarker"), e.consume(y), e.exit("definitionMarker"), f) : n(y);
  }
  function f(y) {
    return Wt(y) ? qc(e, d)(y) : d(y);
  }
  function d(y) {
    return t7(
      e,
      m,
      // Note: we dont need to reset the way `markdown-rs` does.
      n,
      "definitionDestination",
      "definitionDestinationLiteral",
      "definitionDestinationLiteralMarker",
      "definitionDestinationRaw",
      "definitionDestinationString"
    )(y);
  }
  function m(y) {
    return e.attempt(_L, p, p)(y);
  }
  function p(y) {
    return Ct(y) ? Mt(e, x, "whitespace")(y) : x(y);
  }
  function x(y) {
    return y === null || ut(y) ? (e.exit("definition"), r.parser.defined.push(a), t(y)) : n(y);
  }
}
function CL(e, t, n) {
  return r;
  function r(u) {
    return Wt(u) ? qc(e, a)(u) : n(u);
  }
  function a(u) {
    return r7(e, o, n, "definitionTitle", "definitionTitleMarker", "definitionTitleString")(u);
  }
  function o(u) {
    return Ct(u) ? Mt(e, l, "whitespace")(u) : l(u);
  }
  function l(u) {
    return u === null || ut(u) ? t(u) : n(u);
  }
}
const EL = {
  name: "hardBreakEscape",
  tokenize: kL
};
function kL(e, t, n) {
  return r;
  function r(o) {
    return e.enter("hardBreakEscape"), e.consume(o), a;
  }
  function a(o) {
    return ut(o) ? (e.exit("hardBreakEscape"), t(o)) : n(o);
  }
}
const NL = {
  name: "headingAtx",
  resolve: jL,
  tokenize: TL
};
function jL(e, t) {
  let n = e.length - 2, r = 3, a, o;
  return e[r][1].type === "whitespace" && (r += 2), n - 2 > r && e[n][1].type === "whitespace" && (n -= 2), e[n][1].type === "atxHeadingSequence" && (r === n - 1 || n - 4 > r && e[n - 2][1].type === "whitespace") && (n -= r + 1 === n ? 2 : 4), n > r && (a = {
    type: "atxHeadingText",
    start: e[r][1].start,
    end: e[n][1].end
  }, o = {
    type: "chunkText",
    start: e[r][1].start,
    end: e[n][1].end,
    contentType: "text"
  }, Kr(e, r, n - r + 1, [["enter", a, t], ["enter", o, t], ["exit", o, t], ["exit", a, t]])), e;
}
function TL(e, t, n) {
  let r = 0;
  return a;
  function a(m) {
    return e.enter("atxHeading"), o(m);
  }
  function o(m) {
    return e.enter("atxHeadingSequence"), l(m);
  }
  function l(m) {
    return m === 35 && r++ < 6 ? (e.consume(m), l) : m === null || Wt(m) ? (e.exit("atxHeadingSequence"), u(m)) : n(m);
  }
  function u(m) {
    return m === 35 ? (e.enter("atxHeadingSequence"), f(m)) : m === null || ut(m) ? (e.exit("atxHeading"), t(m)) : Ct(m) ? Mt(e, u, "whitespace")(m) : (e.enter("atxHeadingText"), d(m));
  }
  function f(m) {
    return m === 35 ? (e.consume(m), f) : (e.exit("atxHeadingSequence"), u(m));
  }
  function d(m) {
    return m === null || m === 35 || Wt(m) ? (e.exit("atxHeadingText"), u(m)) : (e.consume(m), d);
  }
}
const AL = [
  "address",
  "article",
  "aside",
  "base",
  "basefont",
  "blockquote",
  "body",
  "caption",
  "center",
  "col",
  "colgroup",
  "dd",
  "details",
  "dialog",
  "dir",
  "div",
  "dl",
  "dt",
  "fieldset",
  "figcaption",
  "figure",
  "footer",
  "form",
  "frame",
  "frameset",
  "h1",
  "h2",
  "h3",
  "h4",
  "h5",
  "h6",
  "head",
  "header",
  "hr",
  "html",
  "iframe",
  "legend",
  "li",
  "link",
  "main",
  "menu",
  "menuitem",
  "nav",
  "noframes",
  "ol",
  "optgroup",
  "option",
  "p",
  "param",
  "search",
  "section",
  "summary",
  "table",
  "tbody",
  "td",
  "tfoot",
  "th",
  "thead",
  "title",
  "tr",
  "track",
  "ul"
], R_ = ["pre", "script", "style", "textarea"], ML = {
  concrete: !0,
  name: "htmlFlow",
  resolveTo: OL,
  tokenize: DL
}, RL = {
  partial: !0,
  tokenize: LL
}, zL = {
  partial: !0,
  tokenize: IL
};
function OL(e) {
  let t = e.length;
  for (; t-- && !(e[t][0] === "enter" && e[t][1].type === "htmlFlow"); )
    ;
  return t > 1 && e[t - 2][1].type === "linePrefix" && (e[t][1].start = e[t - 2][1].start, e[t + 1][1].start = e[t - 2][1].start, e.splice(t - 2, 2)), e;
}
function DL(e, t, n) {
  const r = this;
  let a, o, l, u, f;
  return d;
  function d(F) {
    return m(F);
  }
  function m(F) {
    return e.enter("htmlFlow"), e.enter("htmlFlowData"), e.consume(F), p;
  }
  function p(F) {
    return F === 33 ? (e.consume(F), x) : F === 47 ? (e.consume(F), o = !0, E) : F === 63 ? (e.consume(F), a = 3, r.interrupt ? t : H) : pr(F) ? (e.consume(F), l = String.fromCharCode(F), k) : n(F);
  }
  function x(F) {
    return F === 45 ? (e.consume(F), a = 2, y) : F === 91 ? (e.consume(F), a = 5, u = 0, w) : pr(F) ? (e.consume(F), a = 4, r.interrupt ? t : H) : n(F);
  }
  function y(F) {
    return F === 45 ? (e.consume(F), r.interrupt ? t : H) : n(F);
  }
  function w(F) {
    const Z = "CDATA[";
    return F === Z.charCodeAt(u++) ? (e.consume(F), u === Z.length ? r.interrupt ? t : G : w) : n(F);
  }
  function E(F) {
    return pr(F) ? (e.consume(F), l = String.fromCharCode(F), k) : n(F);
  }
  function k(F) {
    if (F === null || F === 47 || F === 62 || Wt(F)) {
      const Z = F === 47, oe = l.toLowerCase();
      return !Z && !o && R_.includes(oe) ? (a = 1, r.interrupt ? t(F) : G(F)) : AL.includes(l.toLowerCase()) ? (a = 6, Z ? (e.consume(F), C) : r.interrupt ? t(F) : G(F)) : (a = 7, r.interrupt && !r.parser.lazy[r.now().line] ? n(F) : o ? T(F) : N(F));
    }
    return F === 45 || lr(F) ? (e.consume(F), l += String.fromCharCode(F), k) : n(F);
  }
  function C(F) {
    return F === 62 ? (e.consume(F), r.interrupt ? t : G) : n(F);
  }
  function T(F) {
    return Ct(F) ? (e.consume(F), T) : U(F);
  }
  function N(F) {
    return F === 47 ? (e.consume(F), U) : F === 58 || F === 95 || pr(F) ? (e.consume(F), A) : Ct(F) ? (e.consume(F), N) : U(F);
  }
  function A(F) {
    return F === 45 || F === 46 || F === 58 || F === 95 || lr(F) ? (e.consume(F), A) : D(F);
  }
  function D(F) {
    return F === 61 ? (e.consume(F), M) : Ct(F) ? (e.consume(F), D) : N(F);
  }
  function M(F) {
    return F === null || F === 60 || F === 61 || F === 62 || F === 96 ? n(F) : F === 34 || F === 39 ? (e.consume(F), f = F, O) : Ct(F) ? (e.consume(F), M) : Y(F);
  }
  function O(F) {
    return F === f ? (e.consume(F), f = null, X) : F === null || ut(F) ? n(F) : (e.consume(F), O);
  }
  function Y(F) {
    return F === null || F === 34 || F === 39 || F === 47 || F === 60 || F === 61 || F === 62 || F === 96 || Wt(F) ? D(F) : (e.consume(F), Y);
  }
  function X(F) {
    return F === 47 || F === 62 || Ct(F) ? N(F) : n(F);
  }
  function U(F) {
    return F === 62 ? (e.consume(F), B) : n(F);
  }
  function B(F) {
    return F === null || ut(F) ? G(F) : Ct(F) ? (e.consume(F), B) : n(F);
  }
  function G(F) {
    return F === 45 && a === 2 ? (e.consume(F), V) : F === 60 && a === 1 ? (e.consume(F), ee) : F === 62 && a === 4 ? (e.consume(F), L) : F === 63 && a === 3 ? (e.consume(F), H) : F === 93 && a === 5 ? (e.consume(F), ie) : ut(F) && (a === 6 || a === 7) ? (e.exit("htmlFlowData"), e.check(RL, J, re)(F)) : F === null || ut(F) ? (e.exit("htmlFlowData"), re(F)) : (e.consume(F), G);
  }
  function re(F) {
    return e.check(zL, q, J)(F);
  }
  function q(F) {
    return e.enter("lineEnding"), e.consume(F), e.exit("lineEnding"), W;
  }
  function W(F) {
    return F === null || ut(F) ? re(F) : (e.enter("htmlFlowData"), G(F));
  }
  function V(F) {
    return F === 45 ? (e.consume(F), H) : G(F);
  }
  function ee(F) {
    return F === 47 ? (e.consume(F), l = "", te) : G(F);
  }
  function te(F) {
    if (F === 62) {
      const Z = l.toLowerCase();
      return R_.includes(Z) ? (e.consume(F), L) : G(F);
    }
    return pr(F) && l.length < 8 ? (e.consume(F), l += String.fromCharCode(F), te) : G(F);
  }
  function ie(F) {
    return F === 93 ? (e.consume(F), H) : G(F);
  }
  function H(F) {
    return F === 62 ? (e.consume(F), L) : F === 45 && a === 2 ? (e.consume(F), H) : G(F);
  }
  function L(F) {
    return F === null || ut(F) ? (e.exit("htmlFlowData"), J(F)) : (e.consume(F), L);
  }
  function J(F) {
    return e.exit("htmlFlow"), t(F);
  }
}
function IL(e, t, n) {
  const r = this;
  return a;
  function a(l) {
    return ut(l) ? (e.enter("lineEnding"), e.consume(l), e.exit("lineEnding"), o) : n(l);
  }
  function o(l) {
    return r.parser.lazy[r.now().line] ? n(l) : t(l);
  }
}
function LL(e, t, n) {
  return r;
  function r(a) {
    return e.enter("lineEnding"), e.consume(a), e.exit("lineEnding"), e.attempt(od, t, n);
  }
}
const qL = {
  name: "htmlText",
  tokenize: PL
};
function PL(e, t, n) {
  const r = this;
  let a, o, l;
  return u;
  function u(H) {
    return e.enter("htmlText"), e.enter("htmlTextData"), e.consume(H), f;
  }
  function f(H) {
    return H === 33 ? (e.consume(H), d) : H === 47 ? (e.consume(H), D) : H === 63 ? (e.consume(H), N) : pr(H) ? (e.consume(H), Y) : n(H);
  }
  function d(H) {
    return H === 45 ? (e.consume(H), m) : H === 91 ? (e.consume(H), o = 0, w) : pr(H) ? (e.consume(H), T) : n(H);
  }
  function m(H) {
    return H === 45 ? (e.consume(H), y) : n(H);
  }
  function p(H) {
    return H === null ? n(H) : H === 45 ? (e.consume(H), x) : ut(H) ? (l = p, ee(H)) : (e.consume(H), p);
  }
  function x(H) {
    return H === 45 ? (e.consume(H), y) : p(H);
  }
  function y(H) {
    return H === 62 ? V(H) : H === 45 ? x(H) : p(H);
  }
  function w(H) {
    const L = "CDATA[";
    return H === L.charCodeAt(o++) ? (e.consume(H), o === L.length ? E : w) : n(H);
  }
  function E(H) {
    return H === null ? n(H) : H === 93 ? (e.consume(H), k) : ut(H) ? (l = E, ee(H)) : (e.consume(H), E);
  }
  function k(H) {
    return H === 93 ? (e.consume(H), C) : E(H);
  }
  function C(H) {
    return H === 62 ? V(H) : H === 93 ? (e.consume(H), C) : E(H);
  }
  function T(H) {
    return H === null || H === 62 ? V(H) : ut(H) ? (l = T, ee(H)) : (e.consume(H), T);
  }
  function N(H) {
    return H === null ? n(H) : H === 63 ? (e.consume(H), A) : ut(H) ? (l = N, ee(H)) : (e.consume(H), N);
  }
  function A(H) {
    return H === 62 ? V(H) : N(H);
  }
  function D(H) {
    return pr(H) ? (e.consume(H), M) : n(H);
  }
  function M(H) {
    return H === 45 || lr(H) ? (e.consume(H), M) : O(H);
  }
  function O(H) {
    return ut(H) ? (l = O, ee(H)) : Ct(H) ? (e.consume(H), O) : V(H);
  }
  function Y(H) {
    return H === 45 || lr(H) ? (e.consume(H), Y) : H === 47 || H === 62 || Wt(H) ? X(H) : n(H);
  }
  function X(H) {
    return H === 47 ? (e.consume(H), V) : H === 58 || H === 95 || pr(H) ? (e.consume(H), U) : ut(H) ? (l = X, ee(H)) : Ct(H) ? (e.consume(H), X) : V(H);
  }
  function U(H) {
    return H === 45 || H === 46 || H === 58 || H === 95 || lr(H) ? (e.consume(H), U) : B(H);
  }
  function B(H) {
    return H === 61 ? (e.consume(H), G) : ut(H) ? (l = B, ee(H)) : Ct(H) ? (e.consume(H), B) : X(H);
  }
  function G(H) {
    return H === null || H === 60 || H === 61 || H === 62 || H === 96 ? n(H) : H === 34 || H === 39 ? (e.consume(H), a = H, re) : ut(H) ? (l = G, ee(H)) : Ct(H) ? (e.consume(H), G) : (e.consume(H), q);
  }
  function re(H) {
    return H === a ? (e.consume(H), a = void 0, W) : H === null ? n(H) : ut(H) ? (l = re, ee(H)) : (e.consume(H), re);
  }
  function q(H) {
    return H === null || H === 34 || H === 39 || H === 60 || H === 61 || H === 96 ? n(H) : H === 47 || H === 62 || Wt(H) ? X(H) : (e.consume(H), q);
  }
  function W(H) {
    return H === 47 || H === 62 || Wt(H) ? X(H) : n(H);
  }
  function V(H) {
    return H === 62 ? (e.consume(H), e.exit("htmlTextData"), e.exit("htmlText"), t) : n(H);
  }
  function ee(H) {
    return e.exit("htmlTextData"), e.enter("lineEnding"), e.consume(H), e.exit("lineEnding"), te;
  }
  function te(H) {
    return Ct(H) ? Mt(e, ie, "linePrefix", r.parser.constructs.disable.null.includes("codeIndented") ? void 0 : 4)(H) : ie(H);
  }
  function ie(H) {
    return e.enter("htmlTextData"), l(H);
  }
}
const L2 = {
  name: "labelEnd",
  resolveAll: UL,
  resolveTo: HL,
  tokenize: GL
}, BL = {
  tokenize: VL
}, FL = {
  tokenize: KL
}, $L = {
  tokenize: YL
};
function UL(e) {
  let t = -1;
  const n = [];
  for (; ++t < e.length; ) {
    const r = e[t][1];
    if (n.push(e[t]), r.type === "labelImage" || r.type === "labelLink" || r.type === "labelEnd") {
      const a = r.type === "labelImage" ? 4 : 2;
      r.type = "data", t += a;
    }
  }
  return e.length !== n.length && Kr(e, 0, e.length, n), e;
}
function HL(e, t) {
  let n = e.length, r = 0, a, o, l, u;
  for (; n--; )
    if (a = e[n][1], o) {
      if (a.type === "link" || a.type === "labelLink" && a._inactive)
        break;
      e[n][0] === "enter" && a.type === "labelLink" && (a._inactive = !0);
    } else if (l) {
      if (e[n][0] === "enter" && (a.type === "labelImage" || a.type === "labelLink") && !a._balanced && (o = n, a.type !== "labelLink")) {
        r = 2;
        break;
      }
    } else a.type === "labelEnd" && (l = n);
  const f = {
    type: e[o][1].type === "labelLink" ? "link" : "image",
    start: {
      ...e[o][1].start
    },
    end: {
      ...e[e.length - 1][1].end
    }
  }, d = {
    type: "label",
    start: {
      ...e[o][1].start
    },
    end: {
      ...e[l][1].end
    }
  }, m = {
    type: "labelText",
    start: {
      ...e[o + r + 2][1].end
    },
    end: {
      ...e[l - 2][1].start
    }
  };
  return u = [["enter", f, t], ["enter", d, t]], u = ci(u, e.slice(o + 1, o + r + 3)), u = ci(u, [["enter", m, t]]), u = ci(u, $h(t.parser.constructs.insideSpan.null, e.slice(o + r + 4, l - 3), t)), u = ci(u, [["exit", m, t], e[l - 2], e[l - 1], ["exit", d, t]]), u = ci(u, e.slice(l + 1)), u = ci(u, [["exit", f, t]]), Kr(e, o, e.length, u), e;
}
function GL(e, t, n) {
  const r = this;
  let a = r.events.length, o, l;
  for (; a--; )
    if ((r.events[a][1].type === "labelImage" || r.events[a][1].type === "labelLink") && !r.events[a][1]._balanced) {
      o = r.events[a][1];
      break;
    }
  return u;
  function u(x) {
    return o ? o._inactive ? p(x) : (l = r.parser.defined.includes(Mi(r.sliceSerialize({
      start: o.end,
      end: r.now()
    }))), e.enter("labelEnd"), e.enter("labelMarker"), e.consume(x), e.exit("labelMarker"), e.exit("labelEnd"), f) : n(x);
  }
  function f(x) {
    return x === 40 ? e.attempt(BL, m, l ? m : p)(x) : x === 91 ? e.attempt(FL, m, l ? d : p)(x) : l ? m(x) : p(x);
  }
  function d(x) {
    return e.attempt($L, m, p)(x);
  }
  function m(x) {
    return t(x);
  }
  function p(x) {
    return o._balanced = !0, n(x);
  }
}
function VL(e, t, n) {
  return r;
  function r(p) {
    return e.enter("resource"), e.enter("resourceMarker"), e.consume(p), e.exit("resourceMarker"), a;
  }
  function a(p) {
    return Wt(p) ? qc(e, o)(p) : o(p);
  }
  function o(p) {
    return p === 41 ? m(p) : t7(e, l, u, "resourceDestination", "resourceDestinationLiteral", "resourceDestinationLiteralMarker", "resourceDestinationRaw", "resourceDestinationString", 32)(p);
  }
  function l(p) {
    return Wt(p) ? qc(e, f)(p) : m(p);
  }
  function u(p) {
    return n(p);
  }
  function f(p) {
    return p === 34 || p === 39 || p === 40 ? r7(e, d, n, "resourceTitle", "resourceTitleMarker", "resourceTitleString")(p) : m(p);
  }
  function d(p) {
    return Wt(p) ? qc(e, m)(p) : m(p);
  }
  function m(p) {
    return p === 41 ? (e.enter("resourceMarker"), e.consume(p), e.exit("resourceMarker"), e.exit("resource"), t) : n(p);
  }
}
function KL(e, t, n) {
  const r = this;
  return a;
  function a(u) {
    return n7.call(r, e, o, l, "reference", "referenceMarker", "referenceString")(u);
  }
  function o(u) {
    return r.parser.defined.includes(Mi(r.sliceSerialize(r.events[r.events.length - 1][1]).slice(1, -1))) ? t(u) : n(u);
  }
  function l(u) {
    return n(u);
  }
}
function YL(e, t, n) {
  return r;
  function r(o) {
    return e.enter("reference"), e.enter("referenceMarker"), e.consume(o), e.exit("referenceMarker"), a;
  }
  function a(o) {
    return o === 93 ? (e.enter("referenceMarker"), e.consume(o), e.exit("referenceMarker"), e.exit("reference"), t) : n(o);
  }
}
const XL = {
  name: "labelStartImage",
  resolveAll: L2.resolveAll,
  tokenize: WL
};
function WL(e, t, n) {
  const r = this;
  return a;
  function a(u) {
    return e.enter("labelImage"), e.enter("labelImageMarker"), e.consume(u), e.exit("labelImageMarker"), o;
  }
  function o(u) {
    return u === 91 ? (e.enter("labelMarker"), e.consume(u), e.exit("labelMarker"), e.exit("labelImage"), l) : n(u);
  }
  function l(u) {
    return u === 94 && "_hiddenFootnoteSupport" in r.parser.constructs ? n(u) : t(u);
  }
}
const QL = {
  name: "labelStartLink",
  resolveAll: L2.resolveAll,
  tokenize: ZL
};
function ZL(e, t, n) {
  const r = this;
  return a;
  function a(l) {
    return e.enter("labelLink"), e.enter("labelMarker"), e.consume(l), e.exit("labelMarker"), e.exit("labelLink"), o;
  }
  function o(l) {
    return l === 94 && "_hiddenFootnoteSupport" in r.parser.constructs ? n(l) : t(l);
  }
}
const Mg = {
  name: "lineEnding",
  tokenize: JL
};
function JL(e, t) {
  return n;
  function n(r) {
    return e.enter("lineEnding"), e.consume(r), e.exit("lineEnding"), Mt(e, t, "linePrefix");
  }
}
const Jf = {
  name: "thematicBreak",
  tokenize: eq
};
function eq(e, t, n) {
  let r = 0, a;
  return o;
  function o(d) {
    return e.enter("thematicBreak"), l(d);
  }
  function l(d) {
    return a = d, u(d);
  }
  function u(d) {
    return d === a ? (e.enter("thematicBreakSequence"), f(d)) : r >= 3 && (d === null || ut(d)) ? (e.exit("thematicBreak"), t(d)) : n(d);
  }
  function f(d) {
    return d === a ? (e.consume(d), r++, f) : (e.exit("thematicBreakSequence"), Ct(d) ? Mt(e, u, "whitespace")(d) : u(d));
  }
}
const Tr = {
  continuation: {
    tokenize: iq
  },
  exit: sq,
  name: "list",
  tokenize: rq
}, tq = {
  partial: !0,
  tokenize: oq
}, nq = {
  partial: !0,
  tokenize: aq
};
function rq(e, t, n) {
  const r = this, a = r.events[r.events.length - 1];
  let o = a && a[1].type === "linePrefix" ? a[2].sliceSerialize(a[1], !0).length : 0, l = 0;
  return u;
  function u(y) {
    const w = r.containerState.type || (y === 42 || y === 43 || y === 45 ? "listUnordered" : "listOrdered");
    if (w === "listUnordered" ? !r.containerState.marker || y === r.containerState.marker : Ib(y)) {
      if (r.containerState.type || (r.containerState.type = w, e.enter(w, {
        _container: !0
      })), w === "listUnordered")
        return e.enter("listItemPrefix"), y === 42 || y === 45 ? e.check(Jf, n, d)(y) : d(y);
      if (!r.interrupt || y === 49)
        return e.enter("listItemPrefix"), e.enter("listItemValue"), f(y);
    }
    return n(y);
  }
  function f(y) {
    return Ib(y) && ++l < 10 ? (e.consume(y), f) : (!r.interrupt || l < 2) && (r.containerState.marker ? y === r.containerState.marker : y === 41 || y === 46) ? (e.exit("listItemValue"), d(y)) : n(y);
  }
  function d(y) {
    return e.enter("listItemMarker"), e.consume(y), e.exit("listItemMarker"), r.containerState.marker = r.containerState.marker || y, e.check(
      od,
      // Cant be empty when interrupting.
      r.interrupt ? n : m,
      e.attempt(tq, x, p)
    );
  }
  function m(y) {
    return r.containerState.initialBlankLine = !0, o++, x(y);
  }
  function p(y) {
    return Ct(y) ? (e.enter("listItemPrefixWhitespace"), e.consume(y), e.exit("listItemPrefixWhitespace"), x) : n(y);
  }
  function x(y) {
    return r.containerState.size = o + r.sliceSerialize(e.exit("listItemPrefix"), !0).length, t(y);
  }
}
function iq(e, t, n) {
  const r = this;
  return r.containerState._closeFlow = void 0, e.check(od, a, o);
  function a(u) {
    return r.containerState.furtherBlankLines = r.containerState.furtherBlankLines || r.containerState.initialBlankLine, Mt(e, t, "listItemIndent", r.containerState.size + 1)(u);
  }
  function o(u) {
    return r.containerState.furtherBlankLines || !Ct(u) ? (r.containerState.furtherBlankLines = void 0, r.containerState.initialBlankLine = void 0, l(u)) : (r.containerState.furtherBlankLines = void 0, r.containerState.initialBlankLine = void 0, e.attempt(nq, t, l)(u));
  }
  function l(u) {
    return r.containerState._closeFlow = !0, r.interrupt = void 0, Mt(e, e.attempt(Tr, t, n), "linePrefix", r.parser.constructs.disable.null.includes("codeIndented") ? void 0 : 4)(u);
  }
}
function aq(e, t, n) {
  const r = this;
  return Mt(e, a, "listItemIndent", r.containerState.size + 1);
  function a(o) {
    const l = r.events[r.events.length - 1];
    return l && l[1].type === "listItemIndent" && l[2].sliceSerialize(l[1], !0).length === r.containerState.size ? t(o) : n(o);
  }
}
function sq(e) {
  e.exit(this.containerState.type);
}
function oq(e, t, n) {
  const r = this;
  return Mt(e, a, "listItemPrefixWhitespace", r.parser.constructs.disable.null.includes("codeIndented") ? void 0 : 5);
  function a(o) {
    const l = r.events[r.events.length - 1];
    return !Ct(o) && l && l[1].type === "listItemPrefixWhitespace" ? t(o) : n(o);
  }
}
const z_ = {
  name: "setextUnderline",
  resolveTo: lq,
  tokenize: uq
};
function lq(e, t) {
  let n = e.length, r, a, o;
  for (; n--; )
    if (e[n][0] === "enter") {
      if (e[n][1].type === "content") {
        r = n;
        break;
      }
      e[n][1].type === "paragraph" && (a = n);
    } else
      e[n][1].type === "content" && e.splice(n, 1), !o && e[n][1].type === "definition" && (o = n);
  const l = {
    type: "setextHeading",
    start: {
      ...e[r][1].start
    },
    end: {
      ...e[e.length - 1][1].end
    }
  };
  return e[a][1].type = "setextHeadingText", o ? (e.splice(a, 0, ["enter", l, t]), e.splice(o + 1, 0, ["exit", e[r][1], t]), e[r][1].end = {
    ...e[o][1].end
  }) : e[r][1] = l, e.push(["exit", l, t]), e;
}
function uq(e, t, n) {
  const r = this;
  let a;
  return o;
  function o(d) {
    let m = r.events.length, p;
    for (; m--; )
      if (r.events[m][1].type !== "lineEnding" && r.events[m][1].type !== "linePrefix" && r.events[m][1].type !== "content") {
        p = r.events[m][1].type === "paragraph";
        break;
      }
    return !r.parser.lazy[r.now().line] && (r.interrupt || p) ? (e.enter("setextHeadingLine"), a = d, l(d)) : n(d);
  }
  function l(d) {
    return e.enter("setextHeadingLineSequence"), u(d);
  }
  function u(d) {
    return d === a ? (e.consume(d), u) : (e.exit("setextHeadingLineSequence"), Ct(d) ? Mt(e, f, "lineSuffix")(d) : f(d));
  }
  function f(d) {
    return d === null || ut(d) ? (e.exit("setextHeadingLine"), t(d)) : n(d);
  }
}
const cq = {
  tokenize: dq
};
function dq(e) {
  const t = this, n = e.attempt(
    // Try to parse a blank line.
    od,
    r,
    // Try to parse initial flow (essentially, only code).
    e.attempt(this.parser.constructs.flowInitial, a, Mt(e, e.attempt(this.parser.constructs.flow, a, e.attempt(gL, a)), "linePrefix"))
  );
  return n;
  function r(o) {
    if (o === null) {
      e.consume(o);
      return;
    }
    return e.enter("lineEndingBlank"), e.consume(o), e.exit("lineEndingBlank"), t.currentConstruct = void 0, n;
  }
  function a(o) {
    if (o === null) {
      e.consume(o);
      return;
    }
    return e.enter("lineEnding"), e.consume(o), e.exit("lineEnding"), t.currentConstruct = void 0, n;
  }
}
const fq = {
  resolveAll: a7()
}, hq = i7("string"), mq = i7("text");
function i7(e) {
  return {
    resolveAll: a7(e === "text" ? pq : void 0),
    tokenize: t
  };
  function t(n) {
    const r = this, a = this.parser.constructs[e], o = n.attempt(a, l, u);
    return l;
    function l(m) {
      return d(m) ? o(m) : u(m);
    }
    function u(m) {
      if (m === null) {
        n.consume(m);
        return;
      }
      return n.enter("data"), n.consume(m), f;
    }
    function f(m) {
      return d(m) ? (n.exit("data"), o(m)) : (n.consume(m), f);
    }
    function d(m) {
      if (m === null)
        return !0;
      const p = a[m];
      let x = -1;
      if (p)
        for (; ++x < p.length; ) {
          const y = p[x];
          if (!y.previous || y.previous.call(r, r.previous))
            return !0;
        }
      return !1;
    }
  }
}
function a7(e) {
  return t;
  function t(n, r) {
    let a = -1, o;
    for (; ++a <= n.length; )
      o === void 0 ? n[a] && n[a][1].type === "data" && (o = a, a++) : (!n[a] || n[a][1].type !== "data") && (a !== o + 2 && (n[o][1].end = n[a - 1][1].end, n.splice(o + 2, a - o - 2), a = o + 2), o = void 0);
    return e ? e(n, r) : n;
  }
}
function pq(e, t) {
  let n = 0;
  for (; ++n <= e.length; )
    if ((n === e.length || e[n][1].type === "lineEnding") && e[n - 1][1].type === "data") {
      const r = e[n - 1][1], a = t.sliceStream(r);
      let o = a.length, l = -1, u = 0, f;
      for (; o--; ) {
        const d = a[o];
        if (typeof d == "string") {
          for (l = d.length; d.charCodeAt(l - 1) === 32; )
            u++, l--;
          if (l) break;
          l = -1;
        } else if (d === -2)
          f = !0, u++;
        else if (d !== -1) {
          o++;
          break;
        }
      }
      if (t._contentTypeTextTrailing && n === e.length && (u = 0), u) {
        const d = {
          type: n === e.length || f || u < 2 ? "lineSuffix" : "hardBreakTrailing",
          start: {
            _bufferIndex: o ? l : r.start._bufferIndex + l,
            _index: r.start._index + o,
            line: r.end.line,
            column: r.end.column - u,
            offset: r.end.offset - u
          },
          end: {
            ...r.end
          }
        };
        r.end = {
          ...d.start
        }, r.start.offset === r.end.offset ? Object.assign(r, d) : (e.splice(n, 0, ["enter", d, t], ["exit", d, t]), n += 2);
      }
      n++;
    }
  return e;
}
const gq = {
  42: Tr,
  43: Tr,
  45: Tr,
  48: Tr,
  49: Tr,
  50: Tr,
  51: Tr,
  52: Tr,
  53: Tr,
  54: Tr,
  55: Tr,
  56: Tr,
  57: Tr,
  62: Qj
}, yq = {
  91: wL
}, xq = {
  [-2]: Ag,
  [-1]: Ag,
  32: Ag
}, vq = {
  35: NL,
  42: Jf,
  45: [z_, Jf],
  60: ML,
  61: z_,
  95: Jf,
  96: M_,
  126: M_
}, bq = {
  38: Jj,
  92: Zj
}, wq = {
  [-5]: Mg,
  [-4]: Mg,
  [-3]: Mg,
  33: XL,
  38: Jj,
  42: Lb,
  60: [QI, qL],
  91: QL,
  92: [EL, Zj],
  93: L2,
  95: Lb,
  96: cL
}, _q = {
  null: [Lb, fq]
}, Sq = {
  null: [42, 95]
}, Cq = {
  null: []
}, Eq = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  attentionMarkers: Sq,
  contentInitial: yq,
  disable: Cq,
  document: gq,
  flow: vq,
  flowInitial: xq,
  insideSpan: _q,
  string: bq,
  text: wq
}, Symbol.toStringTag, { value: "Module" }));
function kq(e, t, n) {
  let r = {
    _bufferIndex: -1,
    _index: 0,
    line: n && n.line || 1,
    column: n && n.column || 1,
    offset: n && n.offset || 0
  };
  const a = {}, o = [];
  let l = [], u = [];
  const f = {
    attempt: O(D),
    check: O(M),
    consume: T,
    enter: N,
    exit: A,
    interrupt: O(M, {
      interrupt: !0
    })
  }, d = {
    code: null,
    containerState: {},
    defineSkip: E,
    events: [],
    now: w,
    parser: e,
    previous: null,
    sliceSerialize: x,
    sliceStream: y,
    write: p
  };
  let m = t.tokenize.call(d, f);
  return t.resolveAll && o.push(t), d;
  function p(B) {
    return l = ci(l, B), k(), l[l.length - 1] !== null ? [] : (Y(t, 0), d.events = $h(o, d.events, d), d.events);
  }
  function x(B, G) {
    return jq(y(B), G);
  }
  function y(B) {
    return Nq(l, B);
  }
  function w() {
    const {
      _bufferIndex: B,
      _index: G,
      line: re,
      column: q,
      offset: W
    } = r;
    return {
      _bufferIndex: B,
      _index: G,
      line: re,
      column: q,
      offset: W
    };
  }
  function E(B) {
    a[B.line] = B.column, U();
  }
  function k() {
    let B;
    for (; r._index < l.length; ) {
      const G = l[r._index];
      if (typeof G == "string")
        for (B = r._index, r._bufferIndex < 0 && (r._bufferIndex = 0); r._index === B && r._bufferIndex < G.length; )
          C(G.charCodeAt(r._bufferIndex));
      else
        C(G);
    }
  }
  function C(B) {
    m = m(B);
  }
  function T(B) {
    ut(B) ? (r.line++, r.column = 1, r.offset += B === -3 ? 2 : 1, U()) : B !== -1 && (r.column++, r.offset++), r._bufferIndex < 0 ? r._index++ : (r._bufferIndex++, r._bufferIndex === // Points w/ non-negative `_bufferIndex` reference
    // strings.
    /** @type {string} */
    l[r._index].length && (r._bufferIndex = -1, r._index++)), d.previous = B;
  }
  function N(B, G) {
    const re = G || {};
    return re.type = B, re.start = w(), d.events.push(["enter", re, d]), u.push(re), re;
  }
  function A(B) {
    const G = u.pop();
    return G.end = w(), d.events.push(["exit", G, d]), G;
  }
  function D(B, G) {
    Y(B, G.from);
  }
  function M(B, G) {
    G.restore();
  }
  function O(B, G) {
    return re;
    function re(q, W, V) {
      let ee, te, ie, H;
      return Array.isArray(q) ? (
        /* c8 ignore next 1 */
        J(q)
      ) : "tokenize" in q ? (
        // Looks like a construct.
        J([
          /** @type {Construct} */
          q
        ])
      ) : L(q);
      function L(fe) {
        return Se;
        function Se(Te) {
          const we = Te !== null && fe[Te], ke = Te !== null && fe.null, _e = [
            // To do: add more extension tests.
            /* c8 ignore next 2 */
            ...Array.isArray(we) ? we : we ? [we] : [],
            ...Array.isArray(ke) ? ke : ke ? [ke] : []
          ];
          return J(_e)(Te);
        }
      }
      function J(fe) {
        return ee = fe, te = 0, fe.length === 0 ? V : F(fe[te]);
      }
      function F(fe) {
        return Se;
        function Se(Te) {
          return H = X(), ie = fe, fe.partial || (d.currentConstruct = fe), fe.name && d.parser.constructs.disable.null.includes(fe.name) ? oe() : fe.tokenize.call(
            // If we do have fields, create an object w/ `context` as its
            // prototype.
            // This allows a live binding, which is needed for `interrupt`.
            G ? Object.assign(Object.create(d), G) : d,
            f,
            Z,
            oe
          )(Te);
        }
      }
      function Z(fe) {
        return B(ie, H), W;
      }
      function oe(fe) {
        return H.restore(), ++te < ee.length ? F(ee[te]) : V;
      }
    }
  }
  function Y(B, G) {
    B.resolveAll && !o.includes(B) && o.push(B), B.resolve && Kr(d.events, G, d.events.length - G, B.resolve(d.events.slice(G), d)), B.resolveTo && (d.events = B.resolveTo(d.events, d));
  }
  function X() {
    const B = w(), G = d.previous, re = d.currentConstruct, q = d.events.length, W = Array.from(u);
    return {
      from: q,
      restore: V
    };
    function V() {
      r = B, d.previous = G, d.currentConstruct = re, d.events.length = q, u = W, U();
    }
  }
  function U() {
    r.line in a && r.column < 2 && (r.column = a[r.line], r.offset += a[r.line] - 1);
  }
}
function Nq(e, t) {
  const n = t.start._index, r = t.start._bufferIndex, a = t.end._index, o = t.end._bufferIndex;
  let l;
  if (n === a)
    l = [e[n].slice(r, o)];
  else {
    if (l = e.slice(n, a), r > -1) {
      const u = l[0];
      typeof u == "string" ? l[0] = u.slice(r) : l.shift();
    }
    o > 0 && l.push(e[a].slice(0, o));
  }
  return l;
}
function jq(e, t) {
  let n = -1;
  const r = [];
  let a;
  for (; ++n < e.length; ) {
    const o = e[n];
    let l;
    if (typeof o == "string")
      l = o;
    else switch (o) {
      case -5: {
        l = "\r";
        break;
      }
      case -4: {
        l = `
`;
        break;
      }
      case -3: {
        l = `\r
`;
        break;
      }
      case -2: {
        l = t ? " " : "	";
        break;
      }
      case -1: {
        if (!t && a) continue;
        l = " ";
        break;
      }
      default:
        l = String.fromCharCode(o);
    }
    a = o === -2, r.push(l);
  }
  return r.join("");
}
function Tq(e) {
  const r = {
    constructs: (
      /** @type {FullNormalizedExtension} */
      Xj([Eq, ...(e || {}).extensions || []])
    ),
    content: a(HI),
    defined: [],
    document: a(VI),
    flow: a(cq),
    lazy: {},
    string: a(hq),
    text: a(mq)
  };
  return r;
  function a(o) {
    return l;
    function l(u) {
      return kq(r, o, u);
    }
  }
}
function Aq(e) {
  for (; !e7(e); )
    ;
  return e;
}
const O_ = /[\0\t\n\r]/g;
function Mq() {
  let e = 1, t = "", n = !0, r;
  return a;
  function a(o, l, u) {
    const f = [];
    let d, m, p, x, y;
    for (o = t + (typeof o == "string" ? o.toString() : new TextDecoder(l || void 0).decode(o)), p = 0, t = "", n && (o.charCodeAt(0) === 65279 && p++, n = void 0); p < o.length; ) {
      if (O_.lastIndex = p, d = O_.exec(o), x = d && d.index !== void 0 ? d.index : o.length, y = o.charCodeAt(x), !d) {
        t = o.slice(p);
        break;
      }
      if (y === 10 && p === x && r)
        f.push(-3), r = void 0;
      else
        switch (r && (f.push(-5), r = void 0), p < x && (f.push(o.slice(p, x)), e += x - p), y) {
          case 0: {
            f.push(65533), e++;
            break;
          }
          case 9: {
            for (m = Math.ceil(e / 4) * 4, f.push(-2); e++ < m; ) f.push(-1);
            break;
          }
          case 10: {
            f.push(-4), e = 1;
            break;
          }
          default:
            r = !0, e = 1;
        }
      p = x + 1;
    }
    return u && (r && f.push(-5), t && f.push(t), f.push(null)), f;
  }
}
const Rq = /\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;
function zq(e) {
  return e.replace(Rq, Oq);
}
function Oq(e, t, n) {
  if (t)
    return t;
  if (n.charCodeAt(0) === 35) {
    const a = n.charCodeAt(1), o = a === 120 || a === 88;
    return Wj(n.slice(o ? 2 : 1), o ? 16 : 10);
  }
  return I2(n) || e;
}
const s7 = {}.hasOwnProperty;
function Dq(e, t, n) {
  return typeof t != "string" && (n = t, t = void 0), Iq(n)(Aq(Tq(n).document().write(Mq()(e, t, !0))));
}
function Iq(e) {
  const t = {
    transforms: [],
    canContainEols: ["emphasis", "fragment", "heading", "paragraph", "strong"],
    enter: {
      autolink: o(Jt),
      autolinkProtocol: X,
      autolinkEmail: X,
      atxHeading: o(qe),
      blockQuote: o(ke),
      characterEscape: X,
      characterReference: X,
      codeFenced: o(_e),
      codeFencedFenceInfo: l,
      codeFencedFenceMeta: l,
      codeIndented: o(_e, l),
      codeText: o(Ae, l),
      codeTextData: X,
      data: X,
      codeFlowValue: X,
      definition: o(Pe),
      definitionDestinationString: l,
      definitionLabelString: l,
      definitionTitleString: l,
      emphasis: o(Qe),
      hardBreakEscape: o(at),
      hardBreakTrailing: o(at),
      htmlFlow: o(st, l),
      htmlFlowData: X,
      htmlText: o(st, l),
      htmlTextData: X,
      image: o(mn),
      label: l,
      link: o(Jt),
      listItem: o(Kt),
      listItemValue: x,
      listOrdered: o(Sn, p),
      listUnordered: o(Sn),
      paragraph: o(vn),
      reference: F,
      referenceString: l,
      resourceDestinationString: l,
      resourceTitleString: l,
      setextHeading: o(qe),
      strong: o(qt),
      thematicBreak: o(In)
    },
    exit: {
      atxHeading: f(),
      atxHeadingSequence: D,
      autolink: f(),
      autolinkEmail: we,
      autolinkProtocol: Te,
      blockQuote: f(),
      characterEscapeValue: U,
      characterReferenceMarkerHexadecimal: oe,
      characterReferenceMarkerNumeric: oe,
      characterReferenceValue: fe,
      characterReference: Se,
      codeFenced: f(k),
      codeFencedFence: E,
      codeFencedFenceInfo: y,
      codeFencedFenceMeta: w,
      codeFlowValue: U,
      codeIndented: f(C),
      codeText: f(W),
      codeTextData: U,
      data: U,
      definition: f(),
      definitionDestinationString: A,
      definitionLabelString: T,
      definitionTitleString: N,
      emphasis: f(),
      hardBreakEscape: f(G),
      hardBreakTrailing: f(G),
      htmlFlow: f(re),
      htmlFlowData: U,
      htmlText: f(q),
      htmlTextData: U,
      image: f(ee),
      label: ie,
      labelText: te,
      lineEnding: B,
      link: f(V),
      listItem: f(),
      listOrdered: f(),
      listUnordered: f(),
      paragraph: f(),
      referenceString: Z,
      resourceDestinationString: H,
      resourceTitleString: L,
      resource: J,
      setextHeading: f(Y),
      setextHeadingLineSequence: O,
      setextHeadingText: M,
      strong: f(),
      thematicBreak: f()
    }
  };
  o7(t, (e || {}).mdastExtensions || []);
  const n = {};
  return r;
  function r(Re) {
    let Be = {
      type: "root",
      children: []
    };
    const rt = {
      stack: [Be],
      tokenStack: [],
      config: t,
      enter: u,
      exit: d,
      buffer: l,
      resume: m,
      data: n
    }, dt = [];
    let xt = -1;
    for (; ++xt < Re.length; )
      if (Re[xt][1].type === "listOrdered" || Re[xt][1].type === "listUnordered")
        if (Re[xt][0] === "enter")
          dt.push(xt);
        else {
          const pn = dt.pop();
          xt = a(Re, pn, xt);
        }
    for (xt = -1; ++xt < Re.length; ) {
      const pn = t[Re[xt][0]];
      s7.call(pn, Re[xt][1].type) && pn[Re[xt][1].type].call(Object.assign({
        sliceSerialize: Re[xt][2].sliceSerialize
      }, rt), Re[xt][1]);
    }
    if (rt.tokenStack.length > 0) {
      const pn = rt.tokenStack[rt.tokenStack.length - 1];
      (pn[1] || D_).call(rt, void 0, pn[0]);
    }
    for (Be.position = {
      start: zs(Re.length > 0 ? Re[0][1].start : {
        line: 1,
        column: 1,
        offset: 0
      }),
      end: zs(Re.length > 0 ? Re[Re.length - 2][1].end : {
        line: 1,
        column: 1,
        offset: 0
      })
    }, xt = -1; ++xt < t.transforms.length; )
      Be = t.transforms[xt](Be) || Be;
    return Be;
  }
  function a(Re, Be, rt) {
    let dt = Be - 1, xt = -1, pn = !1, gn, It, Rt, en;
    for (; ++dt <= rt; ) {
      const Ge = Re[dt];
      switch (Ge[1].type) {
        case "listUnordered":
        case "listOrdered":
        case "blockQuote": {
          Ge[0] === "enter" ? xt++ : xt--, en = void 0;
          break;
        }
        case "lineEndingBlank": {
          Ge[0] === "enter" && (gn && !en && !xt && !Rt && (Rt = dt), en = void 0);
          break;
        }
        case "linePrefix":
        case "listItemValue":
        case "listItemMarker":
        case "listItemPrefix":
        case "listItemPrefixWhitespace":
          break;
        default:
          en = void 0;
      }
      if (!xt && Ge[0] === "enter" && Ge[1].type === "listItemPrefix" || xt === -1 && Ge[0] === "exit" && (Ge[1].type === "listUnordered" || Ge[1].type === "listOrdered")) {
        if (gn) {
          let tr = dt;
          for (It = void 0; tr--; ) {
            const bn = Re[tr];
            if (bn[1].type === "lineEnding" || bn[1].type === "lineEndingBlank") {
              if (bn[0] === "exit") continue;
              It && (Re[It][1].type = "lineEndingBlank", pn = !0), bn[1].type = "lineEnding", It = tr;
            } else if (!(bn[1].type === "linePrefix" || bn[1].type === "blockQuotePrefix" || bn[1].type === "blockQuotePrefixWhitespace" || bn[1].type === "blockQuoteMarker" || bn[1].type === "listItemIndent")) break;
          }
          Rt && (!It || Rt < It) && (gn._spread = !0), gn.end = Object.assign({}, It ? Re[It][1].start : Ge[1].end), Re.splice(It || dt, 0, ["exit", gn, Ge[2]]), dt++, rt++;
        }
        if (Ge[1].type === "listItemPrefix") {
          const tr = {
            type: "listItem",
            _spread: !1,
            start: Object.assign({}, Ge[1].start),
            // @ts-expect-error: well add `end` in a second.
            end: void 0
          };
          gn = tr, Re.splice(dt, 0, ["enter", tr, Ge[2]]), dt++, rt++, Rt = void 0, en = !0;
        }
      }
    }
    return Re[Be][1]._spread = pn, rt;
  }
  function o(Re, Be) {
    return rt;
    function rt(dt) {
      u.call(this, Re(dt), dt), Be && Be.call(this, dt);
    }
  }
  function l() {
    this.stack.push({
      type: "fragment",
      children: []
    });
  }
  function u(Re, Be, rt) {
    this.stack[this.stack.length - 1].children.push(Re), this.stack.push(Re), this.tokenStack.push([Be, rt || void 0]), Re.position = {
      start: zs(Be.start),
      // @ts-expect-error: `end` will be patched later.
      end: void 0
    };
  }
  function f(Re) {
    return Be;
    function Be(rt) {
      Re && Re.call(this, rt), d.call(this, rt);
    }
  }
  function d(Re, Be) {
    const rt = this.stack.pop(), dt = this.tokenStack.pop();
    if (dt)
      dt[0].type !== Re.type && (Be ? Be.call(this, Re, dt[0]) : (dt[1] || D_).call(this, Re, dt[0]));
    else throw new Error("Cannot close `" + Re.type + "` (" + Lc({
      start: Re.start,
      end: Re.end
    }) + "): its not open");
    rt.position.end = zs(Re.end);
  }
  function m() {
    return D2(this.stack.pop());
  }
  function p() {
    this.data.expectingFirstListItemValue = !0;
  }
  function x(Re) {
    if (this.data.expectingFirstListItemValue) {
      const Be = this.stack[this.stack.length - 2];
      Be.start = Number.parseInt(this.sliceSerialize(Re), 10), this.data.expectingFirstListItemValue = void 0;
    }
  }
  function y() {
    const Re = this.resume(), Be = this.stack[this.stack.length - 1];
    Be.lang = Re;
  }
  function w() {
    const Re = this.resume(), Be = this.stack[this.stack.length - 1];
    Be.meta = Re;
  }
  function E() {
    this.data.flowCodeInside || (this.buffer(), this.data.flowCodeInside = !0);
  }
  function k() {
    const Re = this.resume(), Be = this.stack[this.stack.length - 1];
    Be.value = Re.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g, ""), this.data.flowCodeInside = void 0;
  }
  function C() {
    const Re = this.resume(), Be = this.stack[this.stack.length - 1];
    Be.value = Re.replace(/(\r?\n|\r)$/g, "");
  }
  function T(Re) {
    const Be = this.resume(), rt = this.stack[this.stack.length - 1];
    rt.label = Be, rt.identifier = Mi(this.sliceSerialize(Re)).toLowerCase();
  }
  function N() {
    const Re = this.resume(), Be = this.stack[this.stack.length - 1];
    Be.title = Re;
  }
  function A() {
    const Re = this.resume(), Be = this.stack[this.stack.length - 1];
    Be.url = Re;
  }
  function D(Re) {
    const Be = this.stack[this.stack.length - 1];
    if (!Be.depth) {
      const rt = this.sliceSerialize(Re).length;
      Be.depth = rt;
    }
  }
  function M() {
    this.data.setextHeadingSlurpLineEnding = !0;
  }
  function O(Re) {
    const Be = this.stack[this.stack.length - 1];
    Be.depth = this.sliceSerialize(Re).codePointAt(0) === 61 ? 1 : 2;
  }
  function Y() {
    this.data.setextHeadingSlurpLineEnding = void 0;
  }
  function X(Re) {
    const rt = this.stack[this.stack.length - 1].children;
    let dt = rt[rt.length - 1];
    (!dt || dt.type !== "text") && (dt = Yt(), dt.position = {
      start: zs(Re.start),
      // @ts-expect-error: well add `end` later.
      end: void 0
    }, rt.push(dt)), this.stack.push(dt);
  }
  function U(Re) {
    const Be = this.stack.pop();
    Be.value += this.sliceSerialize(Re), Be.position.end = zs(Re.end);
  }
  function B(Re) {
    const Be = this.stack[this.stack.length - 1];
    if (this.data.atHardBreak) {
      const rt = Be.children[Be.children.length - 1];
      rt.position.end = zs(Re.end), this.data.atHardBreak = void 0;
      return;
    }
    !this.data.setextHeadingSlurpLineEnding && t.canContainEols.includes(Be.type) && (X.call(this, Re), U.call(this, Re));
  }
  function G() {
    this.data.atHardBreak = !0;
  }
  function re() {
    const Re = this.resume(), Be = this.stack[this.stack.length - 1];
    Be.value = Re;
  }
  function q() {
    const Re = this.resume(), Be = this.stack[this.stack.length - 1];
    Be.value = Re;
  }
  function W() {
    const Re = this.resume(), Be = this.stack[this.stack.length - 1];
    Be.value = Re;
  }
  function V() {
    const Re = this.stack[this.stack.length - 1];
    if (this.data.inReference) {
      const Be = this.data.referenceType || "shortcut";
      Re.type += "Reference", Re.referenceType = Be, delete Re.url, delete Re.title;
    } else
      delete Re.identifier, delete Re.label;
    this.data.referenceType = void 0;
  }
  function ee() {
    const Re = this.stack[this.stack.length - 1];
    if (this.data.inReference) {
      const Be = this.data.referenceType || "shortcut";
      Re.type += "Reference", Re.referenceType = Be, delete Re.url, delete Re.title;
    } else
      delete Re.identifier, delete Re.label;
    this.data.referenceType = void 0;
  }
  function te(Re) {
    const Be = this.sliceSerialize(Re), rt = this.stack[this.stack.length - 2];
    rt.label = zq(Be), rt.identifier = Mi(Be).toLowerCase();
  }
  function ie() {
    const Re = this.stack[this.stack.length - 1], Be = this.resume(), rt = this.stack[this.stack.length - 1];
    if (this.data.inReference = !0, rt.type === "link") {
      const dt = Re.children;
      rt.children = dt;
    } else
      rt.alt = Be;
  }
  function H() {
    const Re = this.resume(), Be = this.stack[this.stack.length - 1];
    Be.url = Re;
  }
  function L() {
    const Re = this.resume(), Be = this.stack[this.stack.length - 1];
    Be.title = Re;
  }
  function J() {
    this.data.inReference = void 0;
  }
  function F() {
    this.data.referenceType = "collapsed";
  }
  function Z(Re) {
    const Be = this.resume(), rt = this.stack[this.stack.length - 1];
    rt.label = Be, rt.identifier = Mi(this.sliceSerialize(Re)).toLowerCase(), this.data.referenceType = "full";
  }
  function oe(Re) {
    this.data.characterReferenceType = Re.type;
  }
  function fe(Re) {
    const Be = this.sliceSerialize(Re), rt = this.data.characterReferenceType;
    let dt;
    rt ? (dt = Wj(Be, rt === "characterReferenceMarkerNumeric" ? 10 : 16), this.data.characterReferenceType = void 0) : dt = I2(Be);
    const xt = this.stack[this.stack.length - 1];
    xt.value += dt;
  }
  function Se(Re) {
    const Be = this.stack.pop();
    Be.position.end = zs(Re.end);
  }
  function Te(Re) {
    U.call(this, Re);
    const Be = this.stack[this.stack.length - 1];
    Be.url = this.sliceSerialize(Re);
  }
  function we(Re) {
    U.call(this, Re);
    const Be = this.stack[this.stack.length - 1];
    Be.url = "mailto:" + this.sliceSerialize(Re);
  }
  function ke() {
    return {
      type: "blockquote",
      children: []
    };
  }
  function _e() {
    return {
      type: "code",
      lang: null,
      meta: null,
      value: ""
    };
  }
  function Ae() {
    return {
      type: "inlineCode",
      value: ""
    };
  }
  function Pe() {
    return {
      type: "definition",
      identifier: "",
      label: null,
      title: null,
      url: ""
    };
  }
  function Qe() {
    return {
      type: "emphasis",
      children: []
    };
  }
  function qe() {
    return {
      type: "heading",
      // @ts-expect-error `depth` will be set later.
      depth: 0,
      children: []
    };
  }
  function at() {
    return {
      type: "break"
    };
  }
  function st() {
    return {
      type: "html",
      value: ""
    };
  }
  function mn() {
    return {
      type: "image",
      title: null,
      url: "",
      alt: null
    };
  }
  function Jt() {
    return {
      type: "link",
      title: null,
      url: "",
      children: []
    };
  }
  function Sn(Re) {
    return {
      type: "list",
      ordered: Re.type === "listOrdered",
      start: null,
      spread: Re._spread,
      children: []
    };
  }
  function Kt(Re) {
    return {
      type: "listItem",
      spread: Re._spread,
      checked: null,
      children: []
    };
  }
  function vn() {
    return {
      type: "paragraph",
      children: []
    };
  }
  function qt() {
    return {
      type: "strong",
      children: []
    };
  }
  function Yt() {
    return {
      type: "text",
      value: ""
    };
  }
  function In() {
    return {
      type: "thematicBreak"
    };
  }
}
function zs(e) {
  return {
    line: e.line,
    column: e.column,
    offset: e.offset
  };
}
function o7(e, t) {
  let n = -1;
  for (; ++n < t.length; ) {
    const r = t[n];
    Array.isArray(r) ? o7(e, r) : Lq(e, r);
  }
}
function Lq(e, t) {
  let n;
  for (n in t)
    if (s7.call(t, n))
      switch (n) {
        case "canContainEols": {
          const r = t[n];
          r && e[n].push(...r);
          break;
        }
        case "transforms": {
          const r = t[n];
          r && e[n].push(...r);
          break;
        }
        case "enter":
        case "exit": {
          const r = t[n];
          r && Object.assign(e[n], r);
          break;
        }
      }
}
function D_(e, t) {
  throw e ? new Error("Cannot close `" + e.type + "` (" + Lc({
    start: e.start,
    end: e.end
  }) + "): a different token (`" + t.type + "`, " + Lc({
    start: t.start,
    end: t.end
  }) + ") is open") : new Error("Cannot close document, a token (`" + t.type + "`, " + Lc({
    start: t.start,
    end: t.end
  }) + ") is still open");
}
function qq(e) {
  const t = this;
  t.parser = n;
  function n(r) {
    return Dq(r, {
      ...t.data("settings"),
      ...e,
      // Note: these options are not in the readme.
      // The goal is for them to be set by plugins on `data` instead of being
      // passed by users.
      extensions: t.data("micromarkExtensions") || [],
      mdastExtensions: t.data("fromMarkdownExtensions") || []
    });
  }
}
function Pq(e, t) {
  const n = {
    type: "element",
    tagName: "blockquote",
    properties: {},
    children: e.wrap(e.all(t), !0)
  };
  return e.patch(t, n), e.applyData(t, n);
}
function Bq(e, t) {
  const n = { type: "element", tagName: "br", properties: {}, children: [] };
  return e.patch(t, n), [e.applyData(t, n), { type: "text", value: `
` }];
}
function Fq(e, t) {
  const n = t.value ? t.value + `
` : "", r = {}, a = t.lang ? t.lang.split(/\s+/) : [];
  a.length > 0 && (r.className = ["language-" + a[0]]);
  let o = {
    type: "element",
    tagName: "code",
    properties: r,
    children: [{ type: "text", value: n }]
  };
  return t.meta && (o.data = { meta: t.meta }), e.patch(t, o), o = e.applyData(t, o), o = { type: "element", tagName: "pre", properties: {}, children: [o] }, e.patch(t, o), o;
}
function $q(e, t) {
  const n = {
    type: "element",
    tagName: "del",
    properties: {},
    children: e.all(t)
  };
  return e.patch(t, n), e.applyData(t, n);
}
function Uq(e, t) {
  const n = {
    type: "element",
    tagName: "em",
    properties: {},
    children: e.all(t)
  };
  return e.patch(t, n), e.applyData(t, n);
}
function Hq(e, t) {
  const n = typeof e.options.clobberPrefix == "string" ? e.options.clobberPrefix : "user-content-", r = String(t.identifier).toUpperCase(), a = fu(r.toLowerCase()), o = e.footnoteOrder.indexOf(r);
  let l, u = e.footnoteCounts.get(r);
  u === void 0 ? (u = 0, e.footnoteOrder.push(r), l = e.footnoteOrder.length) : l = o + 1, u += 1, e.footnoteCounts.set(r, u);
  const f = {
    type: "element",
    tagName: "a",
    properties: {
      href: "#" + n + "fn-" + a,
      id: n + "fnref-" + a + (u > 1 ? "-" + u : ""),
      dataFootnoteRef: !0,
      ariaDescribedBy: ["footnote-label"]
    },
    children: [{ type: "text", value: String(l) }]
  };
  e.patch(t, f);
  const d = {
    type: "element",
    tagName: "sup",
    properties: {},
    children: [f]
  };
  return e.patch(t, d), e.applyData(t, d);
}
function Gq(e, t) {
  const n = {
    type: "element",
    tagName: "h" + t.depth,
    properties: {},
    children: e.all(t)
  };
  return e.patch(t, n), e.applyData(t, n);
}
function Vq(e, t) {
  if (e.options.allowDangerousHtml) {
    const n = { type: "raw", value: t.value };
    return e.patch(t, n), e.applyData(t, n);
  }
}
function l7(e, t) {
  const n = t.referenceType;
  let r = "]";
  if (n === "collapsed" ? r += "[]" : n === "full" && (r += "[" + (t.label || t.identifier) + "]"), t.type === "imageReference")
    return [{ type: "text", value: "![" + t.alt + r }];
  const a = e.all(t), o = a[0];
  o && o.type === "text" ? o.value = "[" + o.value : a.unshift({ type: "text", value: "[" });
  const l = a[a.length - 1];
  return l && l.type === "text" ? l.value += r : a.push({ type: "text", value: r }), a;
}
function Kq(e, t) {
  const n = String(t.identifier).toUpperCase(), r = e.definitionById.get(n);
  if (!r)
    return l7(e, t);
  const a = { src: fu(r.url || ""), alt: t.alt };
  r.title !== null && r.title !== void 0 && (a.title = r.title);
  const o = { type: "element", tagName: "img", properties: a, children: [] };
  return e.patch(t, o), e.applyData(t, o);
}
function Yq(e, t) {
  const n = { src: fu(t.url) };
  t.alt !== null && t.alt !== void 0 && (n.alt = t.alt), t.title !== null && t.title !== void 0 && (n.title = t.title);
  const r = { type: "element", tagName: "img", properties: n, children: [] };
  return e.patch(t, r), e.applyData(t, r);
}
function Xq(e, t) {
  const n = { type: "text", value: t.value.replace(/\r?\n|\r/g, " ") };
  e.patch(t, n);
  const r = {
    type: "element",
    tagName: "code",
    properties: {},
    children: [n]
  };
  return e.patch(t, r), e.applyData(t, r);
}
function Wq(e, t) {
  const n = String(t.identifier).toUpperCase(), r = e.definitionById.get(n);
  if (!r)
    return l7(e, t);
  const a = { href: fu(r.url || "") };
  r.title !== null && r.title !== void 0 && (a.title = r.title);
  const o = {
    type: "element",
    tagName: "a",
    properties: a,
    children: e.all(t)
  };
  return e.patch(t, o), e.applyData(t, o);
}
function Qq(e, t) {
  const n = { href: fu(t.url) };
  t.title !== null && t.title !== void 0 && (n.title = t.title);
  const r = {
    type: "element",
    tagName: "a",
    properties: n,
    children: e.all(t)
  };
  return e.patch(t, r), e.applyData(t, r);
}
function Zq(e, t, n) {
  const r = e.all(t), a = n ? Jq(n) : u7(t), o = {}, l = [];
  if (typeof t.checked == "boolean") {
    const m = r[0];
    let p;
    m && m.type === "element" && m.tagName === "p" ? p = m : (p = { type: "element", tagName: "p", properties: {}, children: [] }, r.unshift(p)), p.children.length > 0 && p.children.unshift({ type: "text", value: " " }), p.children.unshift({
      type: "element",
      tagName: "input",
      properties: { type: "checkbox", checked: t.checked, disabled: !0 },
      children: []
    }), o.className = ["task-list-item"];
  }
  let u = -1;
  for (; ++u < r.length; ) {
    const m = r[u];
    (a || u !== 0 || m.type !== "element" || m.tagName !== "p") && l.push({ type: "text", value: `
` }), m.type === "element" && m.tagName === "p" && !a ? l.push(...m.children) : l.push(m);
  }
  const f = r[r.length - 1];
  f && (a || f.type !== "element" || f.tagName !== "p") && l.push({ type: "text", value: `
` });
  const d = { type: "element", tagName: "li", properties: o, children: l };
  return e.patch(t, d), e.applyData(t, d);
}
function Jq(e) {
  let t = !1;
  if (e.type === "list") {
    t = e.spread || !1;
    const n = e.children;
    let r = -1;
    for (; !t && ++r < n.length; )
      t = u7(n[r]);
  }
  return t;
}
function u7(e) {
  const t = e.spread;
  return t ?? e.children.length > 1;
}
function eP(e, t) {
  const n = {}, r = e.all(t);
  let a = -1;
  for (typeof t.start == "number" && t.start !== 1 && (n.start = t.start); ++a < r.length; ) {
    const l = r[a];
    if (l.type === "element" && l.tagName === "li" && l.properties && Array.isArray(l.properties.className) && l.properties.className.includes("task-list-item")) {
      n.className = ["contains-task-list"];
      break;
    }
  }
  const o = {
    type: "element",
    tagName: t.ordered ? "ol" : "ul",
    properties: n,
    children: e.wrap(r, !0)
  };
  return e.patch(t, o), e.applyData(t, o);
}
function tP(e, t) {
  const n = {
    type: "element",
    tagName: "p",
    properties: {},
    children: e.all(t)
  };
  return e.patch(t, n), e.applyData(t, n);
}
function nP(e, t) {
  const n = { type: "root", children: e.wrap(e.all(t)) };
  return e.patch(t, n), e.applyData(t, n);
}
function rP(e, t) {
  const n = {
    type: "element",
    tagName: "strong",
    properties: {},
    children: e.all(t)
  };
  return e.patch(t, n), e.applyData(t, n);
}
function iP(e, t) {
  const n = e.all(t), r = n.shift(), a = [];
  if (r) {
    const l = {
      type: "element",
      tagName: "thead",
      properties: {},
      children: e.wrap([r], !0)
    };
    e.patch(t.children[0], l), a.push(l);
  }
  if (n.length > 0) {
    const l = {
      type: "element",
      tagName: "tbody",
      properties: {},
      children: e.wrap(n, !0)
    }, u = M2(t.children[1]), f = $j(t.children[t.children.length - 1]);
    u && f && (l.position = { start: u, end: f }), a.push(l);
  }
  const o = {
    type: "element",
    tagName: "table",
    properties: {},
    children: e.wrap(a, !0)
  };
  return e.patch(t, o), e.applyData(t, o);
}
function aP(e, t, n) {
  const r = n ? n.children : void 0, o = (r ? r.indexOf(t) : 1) === 0 ? "th" : "td", l = n && n.type === "table" ? n.align : void 0, u = l ? l.length : t.children.length;
  let f = -1;
  const d = [];
  for (; ++f < u; ) {
    const p = t.children[f], x = {}, y = l ? l[f] : void 0;
    y && (x.align = y);
    let w = { type: "element", tagName: o, properties: x, children: [] };
    p && (w.children = e.all(p), e.patch(p, w), w = e.applyData(p, w)), d.push(w);
  }
  const m = {
    type: "element",
    tagName: "tr",
    properties: {},
    children: e.wrap(d, !0)
  };
  return e.patch(t, m), e.applyData(t, m);
}
function sP(e, t) {
  const n = {
    type: "element",
    tagName: "td",
    // Assume body cell.
    properties: {},
    children: e.all(t)
  };
  return e.patch(t, n), e.applyData(t, n);
}
const I_ = 9, L_ = 32;
function oP(e) {
  const t = String(e), n = /\r?\n|\r/g;
  let r = n.exec(t), a = 0;
  const o = [];
  for (; r; )
    o.push(
      q_(t.slice(a, r.index), a > 0, !0),
      r[0]
    ), a = r.index + r[0].length, r = n.exec(t);
  return o.push(q_(t.slice(a), a > 0, !1)), o.join("");
}
function q_(e, t, n) {
  let r = 0, a = e.length;
  if (t) {
    let o = e.codePointAt(r);
    for (; o === I_ || o === L_; )
      r++, o = e.codePointAt(r);
  }
  if (n) {
    let o = e.codePointAt(a - 1);
    for (; o === I_ || o === L_; )
      a--, o = e.codePointAt(a - 1);
  }
  return a > r ? e.slice(r, a) : "";
}
function lP(e, t) {
  const n = { type: "text", value: oP(String(t.value)) };
  return e.patch(t, n), e.applyData(t, n);
}
function uP(e, t) {
  const n = {
    type: "element",
    tagName: "hr",
    properties: {},
    children: []
  };
  return e.patch(t, n), e.applyData(t, n);
}
const cP = {
  blockquote: Pq,
  break: Bq,
  code: Fq,
  delete: $q,
  emphasis: Uq,
  footnoteReference: Hq,
  heading: Gq,
  html: Vq,
  imageReference: Kq,
  image: Yq,
  inlineCode: Xq,
  linkReference: Wq,
  link: Qq,
  listItem: Zq,
  list: eP,
  paragraph: tP,
  // @ts-expect-error: root is different, but hard to type.
  root: nP,
  strong: rP,
  table: iP,
  tableCell: sP,
  tableRow: aP,
  text: lP,
  thematicBreak: uP,
  toml: Df,
  yaml: Df,
  definition: Df,
  footnoteDefinition: Df
};
function Df() {
}
const c7 = -1, Uh = 0, Pc = 1, mh = 2, q2 = 3, P2 = 4, B2 = 5, F2 = 6, d7 = 7, f7 = 8, P_ = typeof self == "object" ? self : globalThis, dP = (e, t) => {
  const n = (a, o) => (e.set(o, a), a), r = (a) => {
    if (e.has(a))
      return e.get(a);
    const [o, l] = t[a];
    switch (o) {
      case Uh:
      case c7:
        return n(l, a);
      case Pc: {
        const u = n([], a);
        for (const f of l)
          u.push(r(f));
        return u;
      }
      case mh: {
        const u = n({}, a);
        for (const [f, d] of l)
          u[r(f)] = r(d);
        return u;
      }
      case q2:
        return n(new Date(l), a);
      case P2: {
        const { source: u, flags: f } = l;
        return n(new RegExp(u, f), a);
      }
      case B2: {
        const u = n(/* @__PURE__ */ new Map(), a);
        for (const [f, d] of l)
          u.set(r(f), r(d));
        return u;
      }
      case F2: {
        const u = n(/* @__PURE__ */ new Set(), a);
        for (const f of l)
          u.add(r(f));
        return u;
      }
      case d7: {
        const { name: u, message: f } = l;
        return n(new P_[u](f), a);
      }
      case f7:
        return n(BigInt(l), a);
      case "BigInt":
        return n(Object(BigInt(l)), a);
      case "ArrayBuffer":
        return n(new Uint8Array(l).buffer, l);
      case "DataView": {
        const { buffer: u } = new Uint8Array(l);
        return n(new DataView(u), l);
      }
    }
    return n(new P_[o](l), a);
  };
  return r;
}, B_ = (e) => dP(/* @__PURE__ */ new Map(), e)(0), ql = "", { toString: fP } = {}, { keys: hP } = Object, Sc = (e) => {
  const t = typeof e;
  if (t !== "object" || !e)
    return [Uh, t];
  const n = fP.call(e).slice(8, -1);
  switch (n) {
    case "Array":
      return [Pc, ql];
    case "Object":
      return [mh, ql];
    case "Date":
      return [q2, ql];
    case "RegExp":
      return [P2, ql];
    case "Map":
      return [B2, ql];
    case "Set":
      return [F2, ql];
    case "DataView":
      return [Pc, n];
  }
  return n.includes("Array") ? [Pc, n] : n.includes("Error") ? [d7, n] : [mh, n];
}, If = ([e, t]) => e === Uh && (t === "function" || t === "symbol"), mP = (e, t, n, r) => {
  const a = (l, u) => {
    const f = r.push(l) - 1;
    return n.set(u, f), f;
  }, o = (l) => {
    if (n.has(l))
      return n.get(l);
    let [u, f] = Sc(l);
    switch (u) {
      case Uh: {
        let m = l;
        switch (f) {
          case "bigint":
            u = f7, m = l.toString();
            break;
          case "function":
          case "symbol":
            if (e)
              throw new TypeError("unable to serialize " + f);
            m = null;
            break;
          case "undefined":
            return a([c7], l);
        }
        return a([u, m], l);
      }
      case Pc: {
        if (f) {
          let x = l;
          return f === "DataView" ? x = new Uint8Array(l.buffer) : f === "ArrayBuffer" && (x = new Uint8Array(l)), a([f, [...x]], l);
        }
        const m = [], p = a([u, m], l);
        for (const x of l)
          m.push(o(x));
        return p;
      }
      case mh: {
        if (f)
          switch (f) {
            case "BigInt":
              return a([f, l.toString()], l);
            case "Boolean":
            case "Number":
            case "String":
              return a([f, l.valueOf()], l);
          }
        if (t && "toJSON" in l)
          return o(l.toJSON());
        const m = [], p = a([u, m], l);
        for (const x of hP(l))
          (e || !If(Sc(l[x]))) && m.push([o(x), o(l[x])]);
        return p;
      }
      case q2:
        return a([u, l.toISOString()], l);
      case P2: {
        const { source: m, flags: p } = l;
        return a([u, { source: m, flags: p }], l);
      }
      case B2: {
        const m = [], p = a([u, m], l);
        for (const [x, y] of l)
          (e || !(If(Sc(x)) || If(Sc(y)))) && m.push([o(x), o(y)]);
        return p;
      }
      case F2: {
        const m = [], p = a([u, m], l);
        for (const x of l)
          (e || !If(Sc(x))) && m.push(o(x));
        return p;
      }
    }
    const { message: d } = l;
    return a([u, { name: f, message: d }], l);
  };
  return o;
}, F_ = (e, { json: t, lossy: n } = {}) => {
  const r = [];
  return mP(!(t || n), !!t, /* @__PURE__ */ new Map(), r)(e), r;
}, ph = typeof structuredClone == "function" ? (
  /* c8 ignore start */
  (e, t) => t && ("json" in t || "lossy" in t) ? B_(F_(e, t)) : structuredClone(e)
) : (e, t) => B_(F_(e, t));
function pP(e, t) {
  const n = [{ type: "text", value: "" }];
  return t > 1 && n.push({
    type: "element",
    tagName: "sup",
    properties: {},
    children: [{ type: "text", value: String(t) }]
  }), n;
}
function gP(e, t) {
  return "Back to reference " + (e + 1) + (t > 1 ? "-" + t : "");
}
function yP(e) {
  const t = typeof e.options.clobberPrefix == "string" ? e.options.clobberPrefix : "user-content-", n = e.options.footnoteBackContent || pP, r = e.options.footnoteBackLabel || gP, a = e.options.footnoteLabel || "Footnotes", o = e.options.footnoteLabelTagName || "h2", l = e.options.footnoteLabelProperties || {
    className: ["sr-only"]
  }, u = [];
  let f = -1;
  for (; ++f < e.footnoteOrder.length; ) {
    const d = e.footnoteById.get(
      e.footnoteOrder[f]
    );
    if (!d)
      continue;
    const m = e.all(d), p = String(d.identifier).toUpperCase(), x = fu(p.toLowerCase());
    let y = 0;
    const w = [], E = e.footnoteCounts.get(p);
    for (; E !== void 0 && ++y <= E; ) {
      w.length > 0 && w.push({ type: "text", value: " " });
      let T = typeof n == "string" ? n : n(f, y);
      typeof T == "string" && (T = { type: "text", value: T }), w.push({
        type: "element",
        tagName: "a",
        properties: {
          href: "#" + t + "fnref-" + x + (y > 1 ? "-" + y : ""),
          dataFootnoteBackref: "",
          ariaLabel: typeof r == "string" ? r : r(f, y),
          className: ["data-footnote-backref"]
        },
        children: Array.isArray(T) ? T : [T]
      });
    }
    const k = m[m.length - 1];
    if (k && k.type === "element" && k.tagName === "p") {
      const T = k.children[k.children.length - 1];
      T && T.type === "text" ? T.value += " " : k.children.push({ type: "text", value: " " }), k.children.push(...w);
    } else
      m.push(...w);
    const C = {
      type: "element",
      tagName: "li",
      properties: { id: t + "fn-" + x },
      children: e.wrap(m, !0)
    };
    e.patch(d, C), u.push(C);
  }
  if (u.length !== 0)
    return {
      type: "element",
      tagName: "section",
      properties: { dataFootnotes: !0, className: ["footnotes"] },
      children: [
        {
          type: "element",
          tagName: o,
          properties: {
            ...ph(l),
            id: "footnote-label"
          },
          children: [{ type: "text", value: a }]
        },
        { type: "text", value: `
` },
        {
          type: "element",
          tagName: "ol",
          properties: {},
          children: e.wrap(u, !0)
        },
        { type: "text", value: `
` }
      ]
    };
}
const Hh = (
  // Note: overloads in JSDoc cant yet use different `@template`s.
  /**
   * @type {(
   *   (<Condition extends string>(test: Condition) => (node: unknown, index?: number | null | undefined, parent?: Parent | null | undefined, context?: unknown) => node is Node & {type: Condition}) &
   *   (<Condition extends Props>(test: Condition) => (node: unknown, index?: number | null | undefined, parent?: Parent | null | undefined, context?: unknown) => node is Node & Condition) &
   *   (<Condition extends TestFunction>(test: Condition) => (node: unknown, index?: number | null | undefined, parent?: Parent | null | undefined, context?: unknown) => node is Node & Predicate<Condition, Node>) &
   *   ((test?: null | undefined) => (node?: unknown, index?: number | null | undefined, parent?: Parent | null | undefined, context?: unknown) => node is Node) &
   *   ((test?: Test) => Check)
   * )}
   */
  /**
   * @param {Test} [test]
   * @returns {Check}
   */
  (function(e) {
    if (e == null)
      return wP;
    if (typeof e == "function")
      return Gh(e);
    if (typeof e == "object")
      return Array.isArray(e) ? xP(e) : (
        // Cast because `ReadonlyArray` goes into the above but `isArray`
        // narrows to `Array`.
        vP(
          /** @type {Props} */
          e
        )
      );
    if (typeof e == "string")
      return bP(e);
    throw new Error("Expected function, string, or object as test");
  })
);
function xP(e) {
  const t = [];
  let n = -1;
  for (; ++n < e.length; )
    t[n] = Hh(e[n]);
  return Gh(r);
  function r(...a) {
    let o = -1;
    for (; ++o < t.length; )
      if (t[o].apply(this, a)) return !0;
    return !1;
  }
}
function vP(e) {
  const t = (
    /** @type {Record<string, unknown>} */
    e
  );
  return Gh(n);
  function n(r) {
    const a = (
      /** @type {Record<string, unknown>} */
      /** @type {unknown} */
      r
    );
    let o;
    for (o in e)
      if (a[o] !== t[o]) return !1;
    return !0;
  }
}
function bP(e) {
  return Gh(t);
  function t(n) {
    return n && n.type === e;
  }
}
function Gh(e) {
  return t;
  function t(n, r, a) {
    return !!(_P(n) && e.call(
      this,
      n,
      typeof r == "number" ? r : void 0,
      a || void 0
    ));
  }
}
function wP() {
  return !0;
}
function _P(e) {
  return e !== null && typeof e == "object" && "type" in e;
}
const h7 = [], SP = !0, qb = !1, CP = "skip";
function m7(e, t, n, r) {
  let a;
  typeof t == "function" && typeof n != "function" ? (r = n, n = t) : a = t;
  const o = Hh(a), l = r ? -1 : 1;
  u(e, void 0, [])();
  function u(f, d, m) {
    const p = (
      /** @type {Record<string, unknown>} */
      f && typeof f == "object" ? f : {}
    );
    if (typeof p.type == "string") {
      const y = (
        // `hast`
        typeof p.tagName == "string" ? p.tagName : (
          // `xast`
          typeof p.name == "string" ? p.name : void 0
        )
      );
      Object.defineProperty(x, "name", {
        value: "node (" + (f.type + (y ? "<" + y + ">" : "")) + ")"
      });
    }
    return x;
    function x() {
      let y = h7, w, E, k;
      if ((!t || o(f, d, m[m.length - 1] || void 0)) && (y = EP(n(f, m)), y[0] === qb))
        return y;
      if ("children" in f && f.children) {
        const C = (
          /** @type {UnistParent} */
          f
        );
        if (C.children && y[0] !== CP)
          for (E = (r ? C.children.length : -1) + l, k = m.concat(C); E > -1 && E < C.children.length; ) {
            const T = C.children[E];
            if (w = u(T, E, k)(), w[0] === qb)
              return w;
            E = typeof w[1] == "number" ? w[1] : E + l;
          }
      }
      return y;
    }
  }
}
function EP(e) {
  return Array.isArray(e) ? e : typeof e == "number" ? [SP, e] : e == null ? h7 : [e];
}
function $2(e, t, n, r) {
  let a, o, l;
  typeof t == "function" && typeof n != "function" ? (o = void 0, l = t, a = n) : (o = t, l = n, a = r), m7(e, o, u, a);
  function u(f, d) {
    const m = d[d.length - 1], p = m ? m.children.indexOf(f) : void 0;
    return l(f, p, m);
  }
}
const Pb = {}.hasOwnProperty, kP = {};
function NP(e, t) {
  const n = t || kP, r = /* @__PURE__ */ new Map(), a = /* @__PURE__ */ new Map(), o = /* @__PURE__ */ new Map(), l = { ...cP, ...n.handlers }, u = {
    all: d,
    applyData: TP,
    definitionById: r,
    footnoteById: a,
    footnoteCounts: o,
    footnoteOrder: [],
    handlers: l,
    one: f,
    options: n,
    patch: jP,
    wrap: MP
  };
  return $2(e, function(m) {
    if (m.type === "definition" || m.type === "footnoteDefinition") {
      const p = m.type === "definition" ? r : a, x = String(m.identifier).toUpperCase();
      p.has(x) || p.set(x, m);
    }
  }), u;
  function f(m, p) {
    const x = m.type, y = u.handlers[x];
    if (Pb.call(u.handlers, x) && y)
      return y(u, m, p);
    if (u.options.passThrough && u.options.passThrough.includes(x)) {
      if ("children" in m) {
        const { children: E, ...k } = m, C = ph(k);
        return C.children = u.all(m), C;
      }
      return ph(m);
    }
    return (u.options.unknownHandler || AP)(u, m, p);
  }
  function d(m) {
    const p = [];
    if ("children" in m) {
      const x = m.children;
      let y = -1;
      for (; ++y < x.length; ) {
        const w = u.one(x[y], m);
        if (w) {
          if (y && x[y - 1].type === "break" && (!Array.isArray(w) && w.type === "text" && (w.value = $_(w.value)), !Array.isArray(w) && w.type === "element")) {
            const E = w.children[0];
            E && E.type === "text" && (E.value = $_(E.value));
          }
          Array.isArray(w) ? p.push(...w) : p.push(w);
        }
      }
    }
    return p;
  }
}
function jP(e, t) {
  e.position && (t.position = gI(e));
}
function TP(e, t) {
  let n = t;
  if (e && e.data) {
    const r = e.data.hName, a = e.data.hChildren, o = e.data.hProperties;
    if (typeof r == "string")
      if (n.type === "element")
        n.tagName = r;
      else {
        const l = "children" in n ? n.children : [n];
        n = { type: "element", tagName: r, properties: {}, children: l };
      }
    n.type === "element" && o && Object.assign(n.properties, ph(o)), "children" in n && n.children && a !== null && a !== void 0 && (n.children = a);
  }
  return n;
}
function AP(e, t) {
  const n = t.data || {}, r = "value" in t && !(Pb.call(n, "hProperties") || Pb.call(n, "hChildren")) ? { type: "text", value: t.value } : {
    type: "element",
    tagName: "div",
    properties: {},
    children: e.all(t)
  };
  return e.patch(t, r), e.applyData(t, r);
}
function MP(e, t) {
  const n = [];
  let r = -1;
  for (t && n.push({ type: "text", value: `
` }); ++r < e.length; )
    r && n.push({ type: "text", value: `
` }), n.push(e[r]);
  return t && e.length > 0 && n.push({ type: "text", value: `
` }), n;
}
function $_(e) {
  let t = 0, n = e.charCodeAt(t);
  for (; n === 9 || n === 32; )
    t++, n = e.charCodeAt(t);
  return e.slice(t);
}
function U_(e, t) {
  const n = NP(e, t), r = n.one(e, void 0), a = yP(n), o = Array.isArray(r) ? { type: "root", children: r } : r || { type: "root", children: [] };
  return a && o.children.push({ type: "text", value: `
` }, a), o;
}
function RP(e, t) {
  return e && "run" in e ? async function(n, r) {
    const a = (
      /** @type {HastRoot} */
      U_(n, { file: r, ...t })
    );
    await e.run(a, r);
  } : function(n, r) {
    return (
      /** @type {HastRoot} */
      U_(n, { file: r, ...e || t })
    );
  };
}
function H_(e) {
  if (e)
    throw e;
}
var Rg, G_;
function zP() {
  if (G_) return Rg;
  G_ = 1;
  var e = Object.prototype.hasOwnProperty, t = Object.prototype.toString, n = Object.defineProperty, r = Object.getOwnPropertyDescriptor, a = function(d) {
    return typeof Array.isArray == "function" ? Array.isArray(d) : t.call(d) === "[object Array]";
  }, o = function(d) {
    if (!d || t.call(d) !== "[object Object]")
      return !1;
    var m = e.call(d, "constructor"), p = d.constructor && d.constructor.prototype && e.call(d.constructor.prototype, "isPrototypeOf");
    if (d.constructor && !m && !p)
      return !1;
    var x;
    for (x in d)
      ;
    return typeof x > "u" || e.call(d, x);
  }, l = function(d, m) {
    n && m.name === "__proto__" ? n(d, m.name, {
      enumerable: !0,
      configurable: !0,
      value: m.newValue,
      writable: !0
    }) : d[m.name] = m.newValue;
  }, u = function(d, m) {
    if (m === "__proto__")
      if (e.call(d, m)) {
        if (r)
          return r(d, m).value;
      } else return;
    return d[m];
  };
  return Rg = function f() {
    var d, m, p, x, y, w, E = arguments[0], k = 1, C = arguments.length, T = !1;
    for (typeof E == "boolean" && (T = E, E = arguments[1] || {}, k = 2), (E == null || typeof E != "object" && typeof E != "function") && (E = {}); k < C; ++k)
      if (d = arguments[k], d != null)
        for (m in d)
          p = u(E, m), x = u(d, m), E !== x && (T && x && (o(x) || (y = a(x))) ? (y ? (y = !1, w = p && a(p) ? p : []) : w = p && o(p) ? p : {}, l(E, { name: m, newValue: f(T, w, x) })) : typeof x < "u" && l(E, { name: m, newValue: x }));
    return E;
  }, Rg;
}
var OP = zP();
const zg = /* @__PURE__ */ $s(OP);
function Bb(e) {
  if (typeof e != "object" || e === null)
    return !1;
  const t = Object.getPrototypeOf(e);
  return (t === null || t === Object.prototype || Object.getPrototypeOf(t) === null) && !(Symbol.toStringTag in e) && !(Symbol.iterator in e);
}
function DP() {
  const e = [], t = { run: n, use: r };
  return t;
  function n(...a) {
    let o = -1;
    const l = a.pop();
    if (typeof l != "function")
      throw new TypeError("Expected function as last argument, not " + l);
    u(null, ...a);
    function u(f, ...d) {
      const m = e[++o];
      let p = -1;
      if (f) {
        l(f);
        return;
      }
      for (; ++p < a.length; )
        (d[p] === null || d[p] === void 0) && (d[p] = a[p]);
      a = d, m ? IP(m, u)(...d) : l(null, ...d);
    }
  }
  function r(a) {
    if (typeof a != "function")
      throw new TypeError(
        "Expected `middelware` to be a function, not " + a
      );
    return e.push(a), t;
  }
}
function IP(e, t) {
  let n;
  return r;
  function r(...l) {
    const u = e.length > l.length;
    let f;
    u && l.push(a);
    try {
      f = e.apply(this, l);
    } catch (d) {
      const m = (
        /** @type {Error} */
        d
      );
      if (u && n)
        throw m;
      return a(m);
    }
    u || (f && f.then && typeof f.then == "function" ? f.then(o, a) : f instanceof Error ? a(f) : o(f));
  }
  function a(l, ...u) {
    n || (n = !0, t(l, ...u));
  }
  function o(l) {
    a(null, l);
  }
}
const Yi = { basename: LP, dirname: qP, extname: PP, join: BP, sep: "/" };
function LP(e, t) {
  if (t !== void 0 && typeof t != "string")
    throw new TypeError('"ext" argument must be a string');
  ld(e);
  let n = 0, r = -1, a = e.length, o;
  if (t === void 0 || t.length === 0 || t.length > e.length) {
    for (; a--; )
      if (e.codePointAt(a) === 47) {
        if (o) {
          n = a + 1;
          break;
        }
      } else r < 0 && (o = !0, r = a + 1);
    return r < 0 ? "" : e.slice(n, r);
  }
  if (t === e)
    return "";
  let l = -1, u = t.length - 1;
  for (; a--; )
    if (e.codePointAt(a) === 47) {
      if (o) {
        n = a + 1;
        break;
      }
    } else
      l < 0 && (o = !0, l = a + 1), u > -1 && (e.codePointAt(a) === t.codePointAt(u--) ? u < 0 && (r = a) : (u = -1, r = l));
  return n === r ? r = l : r < 0 && (r = e.length), e.slice(n, r);
}
function qP(e) {
  if (ld(e), e.length === 0)
    return ".";
  let t = -1, n = e.length, r;
  for (; --n; )
    if (e.codePointAt(n) === 47) {
      if (r) {
        t = n;
        break;
      }
    } else r || (r = !0);
  return t < 0 ? e.codePointAt(0) === 47 ? "/" : "." : t === 1 && e.codePointAt(0) === 47 ? "//" : e.slice(0, t);
}
function PP(e) {
  ld(e);
  let t = e.length, n = -1, r = 0, a = -1, o = 0, l;
  for (; t--; ) {
    const u = e.codePointAt(t);
    if (u === 47) {
      if (l) {
        r = t + 1;
        break;
      }
      continue;
    }
    n < 0 && (l = !0, n = t + 1), u === 46 ? a < 0 ? a = t : o !== 1 && (o = 1) : a > -1 && (o = -1);
  }
  return a < 0 || n < 0 || // We saw a non-dot character immediately before the dot.
  o === 0 || // The (right-most) trimmed path component is exactly `..`.
  o === 1 && a === n - 1 && a === r + 1 ? "" : e.slice(a, n);
}
function BP(...e) {
  let t = -1, n;
  for (; ++t < e.length; )
    ld(e[t]), e[t] && (n = n === void 0 ? e[t] : n + "/" + e[t]);
  return n === void 0 ? "." : FP(n);
}
function FP(e) {
  ld(e);
  const t = e.codePointAt(0) === 47;
  let n = $P(e, !t);
  return n.length === 0 && !t && (n = "."), n.length > 0 && e.codePointAt(e.length - 1) === 47 && (n += "/"), t ? "/" + n : n;
}
function $P(e, t) {
  let n = "", r = 0, a = -1, o = 0, l = -1, u, f;
  for (; ++l <= e.length; ) {
    if (l < e.length)
      u = e.codePointAt(l);
    else {
      if (u === 47)
        break;
      u = 47;
    }
    if (u === 47) {
      if (!(a === l - 1 || o === 1)) if (a !== l - 1 && o === 2) {
        if (n.length < 2 || r !== 2 || n.codePointAt(n.length - 1) !== 46 || n.codePointAt(n.length - 2) !== 46) {
          if (n.length > 2) {
            if (f = n.lastIndexOf("/"), f !== n.length - 1) {
              f < 0 ? (n = "", r = 0) : (n = n.slice(0, f), r = n.length - 1 - n.lastIndexOf("/")), a = l, o = 0;
              continue;
            }
          } else if (n.length > 0) {
            n = "", r = 0, a = l, o = 0;
            continue;
          }
        }
        t && (n = n.length > 0 ? n + "/.." : "..", r = 2);
      } else
        n.length > 0 ? n += "/" + e.slice(a + 1, l) : n = e.slice(a + 1, l), r = l - a - 1;
      a = l, o = 0;
    } else u === 46 && o > -1 ? o++ : o = -1;
  }
  return n;
}
function ld(e) {
  if (typeof e != "string")
    throw new TypeError(
      "Path must be a string. Received " + JSON.stringify(e)
    );
}
const UP = { cwd: HP };
function HP() {
  return "/";
}
function Fb(e) {
  return !!(e !== null && typeof e == "object" && "href" in e && e.href && "protocol" in e && e.protocol && // @ts-expect-error: indexing is fine.
  e.auth === void 0);
}
function GP(e) {
  if (typeof e == "string")
    e = new URL(e);
  else if (!Fb(e)) {
    const t = new TypeError(
      'The "path" argument must be of type string or an instance of URL. Received `' + e + "`"
    );
    throw t.code = "ERR_INVALID_ARG_TYPE", t;
  }
  if (e.protocol !== "file:") {
    const t = new TypeError("The URL must be of scheme file");
    throw t.code = "ERR_INVALID_URL_SCHEME", t;
  }
  return VP(e);
}
function VP(e) {
  if (e.hostname !== "") {
    const r = new TypeError(
      'File URL host must be "localhost" or empty on darwin'
    );
    throw r.code = "ERR_INVALID_FILE_URL_HOST", r;
  }
  const t = e.pathname;
  let n = -1;
  for (; ++n < t.length; )
    if (t.codePointAt(n) === 37 && t.codePointAt(n + 1) === 50) {
      const r = t.codePointAt(n + 2);
      if (r === 70 || r === 102) {
        const a = new TypeError(
          "File URL path must not include encoded / characters"
        );
        throw a.code = "ERR_INVALID_FILE_URL_PATH", a;
      }
    }
  return decodeURIComponent(t);
}
const Og = (
  /** @type {const} */
  [
    "history",
    "path",
    "basename",
    "stem",
    "extname",
    "dirname"
  ]
);
class p7 {
  /**
   * Create a new virtual file.
   *
   * `options` is treated as:
   *
   * *   `string` or `Uint8Array`  `{value: options}`
   * *   `URL`  `{path: options}`
   * *   `VFile`  shallow copies its data over to the new file
   * *   `object`  all fields are shallow copied over to the new file
   *
   * Path related fields are set in the following order (least specific to
   * most specific): `history`, `path`, `basename`, `stem`, `extname`,
   * `dirname`.
   *
   * You cannot set `dirname` or `extname` without setting either `history`,
   * `path`, `basename`, or `stem` too.
   *
   * @param {Compatible | null | undefined} [value]
   *   File value.
   * @returns
   *   New instance.
   */
  constructor(t) {
    let n;
    t ? Fb(t) ? n = { path: t } : typeof t == "string" || KP(t) ? n = { value: t } : n = t : n = {}, this.cwd = "cwd" in n ? "" : UP.cwd(), this.data = {}, this.history = [], this.messages = [], this.value, this.map, this.result, this.stored;
    let r = -1;
    for (; ++r < Og.length; ) {
      const o = Og[r];
      o in n && n[o] !== void 0 && n[o] !== null && (this[o] = o === "history" ? [...n[o]] : n[o]);
    }
    let a;
    for (a in n)
      Og.includes(a) || (this[a] = n[a]);
  }
  /**
   * Get the basename (including extname) (example: `'index.min.js'`).
   *
   * @returns {string | undefined}
   *   Basename.
   */
  get basename() {
    return typeof this.path == "string" ? Yi.basename(this.path) : void 0;
  }
  /**
   * Set basename (including extname) (`'index.min.js'`).
   *
   * Cannot contain path separators (`'/'` on unix, macOS, and browsers, `'\'`
   * on windows).
   * Cannot be nullified (use `file.path = file.dirname` instead).
   *
   * @param {string} basename
   *   Basename.
   * @returns {undefined}
   *   Nothing.
   */
  set basename(t) {
    Ig(t, "basename"), Dg(t, "basename"), this.path = Yi.join(this.dirname || "", t);
  }
  /**
   * Get the parent path (example: `'~'`).
   *
   * @returns {string | undefined}
   *   Dirname.
   */
  get dirname() {
    return typeof this.path == "string" ? Yi.dirname(this.path) : void 0;
  }
  /**
   * Set the parent path (example: `'~'`).
   *
   * Cannot be set if theres no `path` yet.
   *
   * @param {string | undefined} dirname
   *   Dirname.
   * @returns {undefined}
   *   Nothing.
   */
  set dirname(t) {
    V_(this.basename, "dirname"), this.path = Yi.join(t || "", this.basename);
  }
  /**
   * Get the extname (including dot) (example: `'.js'`).
   *
   * @returns {string | undefined}
   *   Extname.
   */
  get extname() {
    return typeof this.path == "string" ? Yi.extname(this.path) : void 0;
  }
  /**
   * Set the extname (including dot) (example: `'.js'`).
   *
   * Cannot contain path separators (`'/'` on unix, macOS, and browsers, `'\'`
   * on windows).
   * Cannot be set if theres no `path` yet.
   *
   * @param {string | undefined} extname
   *   Extname.
   * @returns {undefined}
   *   Nothing.
   */
  set extname(t) {
    if (Dg(t, "extname"), V_(this.dirname, "extname"), t) {
      if (t.codePointAt(0) !== 46)
        throw new Error("`extname` must start with `.`");
      if (t.includes(".", 1))
        throw new Error("`extname` cannot contain multiple dots");
    }
    this.path = Yi.join(this.dirname, this.stem + (t || ""));
  }
  /**
   * Get the full path (example: `'~/index.min.js'`).
   *
   * @returns {string}
   *   Path.
   */
  get path() {
    return this.history[this.history.length - 1];
  }
  /**
   * Set the full path (example: `'~/index.min.js'`).
   *
   * Cannot be nullified.
   * You can set a file URL (a `URL` object with a `file:` protocol) which will
   * be turned into a path with `url.fileURLToPath`.
   *
   * @param {URL | string} path
   *   Path.
   * @returns {undefined}
   *   Nothing.
   */
  set path(t) {
    Fb(t) && (t = GP(t)), Ig(t, "path"), this.path !== t && this.history.push(t);
  }
  /**
   * Get the stem (basename w/o extname) (example: `'index.min'`).
   *
   * @returns {string | undefined}
   *   Stem.
   */
  get stem() {
    return typeof this.path == "string" ? Yi.basename(this.path, this.extname) : void 0;
  }
  /**
   * Set the stem (basename w/o extname) (example: `'index.min'`).
   *
   * Cannot contain path separators (`'/'` on unix, macOS, and browsers, `'\'`
   * on windows).
   * Cannot be nullified (use `file.path = file.dirname` instead).
   *
   * @param {string} stem
   *   Stem.
   * @returns {undefined}
   *   Nothing.
   */
  set stem(t) {
    Ig(t, "stem"), Dg(t, "stem"), this.path = Yi.join(this.dirname || "", t + (this.extname || ""));
  }
  // Normal prototypal methods.
  /**
   * Create a fatal message for `reason` associated with the file.
   *
   * The `fatal` field of the message is set to `true` (error; file not usable)
   * and the `file` field is set to the current file path.
   * The message is added to the `messages` field on `file`.
   *
   * >  **Note**: also has obsolete signatures.
   *
   * @overload
   * @param {string} reason
   * @param {MessageOptions | null | undefined} [options]
   * @returns {never}
   *
   * @overload
   * @param {string} reason
   * @param {Node | NodeLike | null | undefined} parent
   * @param {string | null | undefined} [origin]
   * @returns {never}
   *
   * @overload
   * @param {string} reason
   * @param {Point | Position | null | undefined} place
   * @param {string | null | undefined} [origin]
   * @returns {never}
   *
   * @overload
   * @param {string} reason
   * @param {string | null | undefined} [origin]
   * @returns {never}
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {Node | NodeLike | null | undefined} parent
   * @param {string | null | undefined} [origin]
   * @returns {never}
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {Point | Position | null | undefined} place
   * @param {string | null | undefined} [origin]
   * @returns {never}
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {string | null | undefined} [origin]
   * @returns {never}
   *
   * @param {Error | VFileMessage | string} causeOrReason
   *   Reason for message, should use markdown.
   * @param {Node | NodeLike | MessageOptions | Point | Position | string | null | undefined} [optionsOrParentOrPlace]
   *   Configuration (optional).
   * @param {string | null | undefined} [origin]
   *   Place in code where the message originates (example:
   *   `'my-package:my-rule'` or `'my-rule'`).
   * @returns {never}
   *   Never.
   * @throws {VFileMessage}
   *   Message.
   */
  fail(t, n, r) {
    const a = this.message(t, n, r);
    throw a.fatal = !0, a;
  }
  /**
   * Create an info message for `reason` associated with the file.
   *
   * The `fatal` field of the message is set to `undefined` (info; change
   * likely not needed) and the `file` field is set to the current file path.
   * The message is added to the `messages` field on `file`.
   *
   * >  **Note**: also has obsolete signatures.
   *
   * @overload
   * @param {string} reason
   * @param {MessageOptions | null | undefined} [options]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {string} reason
   * @param {Node | NodeLike | null | undefined} parent
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {string} reason
   * @param {Point | Position | null | undefined} place
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {string} reason
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {Node | NodeLike | null | undefined} parent
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {Point | Position | null | undefined} place
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @param {Error | VFileMessage | string} causeOrReason
   *   Reason for message, should use markdown.
   * @param {Node | NodeLike | MessageOptions | Point | Position | string | null | undefined} [optionsOrParentOrPlace]
   *   Configuration (optional).
   * @param {string | null | undefined} [origin]
   *   Place in code where the message originates (example:
   *   `'my-package:my-rule'` or `'my-rule'`).
   * @returns {VFileMessage}
   *   Message.
   */
  info(t, n, r) {
    const a = this.message(t, n, r);
    return a.fatal = void 0, a;
  }
  /**
   * Create a message for `reason` associated with the file.
   *
   * The `fatal` field of the message is set to `false` (warning; change may be
   * needed) and the `file` field is set to the current file path.
   * The message is added to the `messages` field on `file`.
   *
   * >  **Note**: also has obsolete signatures.
   *
   * @overload
   * @param {string} reason
   * @param {MessageOptions | null | undefined} [options]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {string} reason
   * @param {Node | NodeLike | null | undefined} parent
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {string} reason
   * @param {Point | Position | null | undefined} place
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {string} reason
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {Node | NodeLike | null | undefined} parent
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {Point | Position | null | undefined} place
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @param {Error | VFileMessage | string} causeOrReason
   *   Reason for message, should use markdown.
   * @param {Node | NodeLike | MessageOptions | Point | Position | string | null | undefined} [optionsOrParentOrPlace]
   *   Configuration (optional).
   * @param {string | null | undefined} [origin]
   *   Place in code where the message originates (example:
   *   `'my-package:my-rule'` or `'my-rule'`).
   * @returns {VFileMessage}
   *   Message.
   */
  message(t, n, r) {
    const a = new cr(
      // @ts-expect-error: the overloads are fine.
      t,
      n,
      r
    );
    return this.path && (a.name = this.path + ":" + a.name, a.file = this.path), a.fatal = !1, this.messages.push(a), a;
  }
  /**
   * Serialize the file.
   *
   * > **Note**: which encodings are supported depends on the engine.
   * > For info on Node.js, see:
   * > <https://nodejs.org/api/util.html#whatwg-supported-encodings>.
   *
   * @param {string | null | undefined} [encoding='utf8']
   *   Character encoding to understand `value` as when its a `Uint8Array`
   *   (default: `'utf-8'`).
   * @returns {string}
   *   Serialized file.
   */
  toString(t) {
    return this.value === void 0 ? "" : typeof this.value == "string" ? this.value : new TextDecoder(t || void 0).decode(this.value);
  }
}
function Dg(e, t) {
  if (e && e.includes(Yi.sep))
    throw new Error(
      "`" + t + "` cannot be a path: did not expect `" + Yi.sep + "`"
    );
}
function Ig(e, t) {
  if (!e)
    throw new Error("`" + t + "` cannot be empty");
}
function V_(e, t) {
  if (!e)
    throw new Error("Setting `" + t + "` requires `path` to be set too");
}
function KP(e) {
  return !!(e && typeof e == "object" && "byteLength" in e && "byteOffset" in e);
}
const YP = (
  /**
   * @type {new <Parameters extends Array<unknown>, Result>(property: string | symbol) => (...parameters: Parameters) => Result}
   */
  /** @type {unknown} */
  /**
   * @this {Function}
   * @param {string | symbol} property
   * @returns {(...parameters: Array<unknown>) => unknown}
   */
  (function(e) {
    const r = (
      /** @type {Record<string | symbol, Function>} */
      // Prototypes do exist.
      // type-coverage:ignore-next-line
      this.constructor.prototype
    ), a = r[e], o = function() {
      return a.apply(o, arguments);
    };
    return Object.setPrototypeOf(o, r), o;
  })
), XP = {}.hasOwnProperty;
class U2 extends YP {
  /**
   * Create a processor.
   */
  constructor() {
    super("copy"), this.Compiler = void 0, this.Parser = void 0, this.attachers = [], this.compiler = void 0, this.freezeIndex = -1, this.frozen = void 0, this.namespace = {}, this.parser = void 0, this.transformers = DP();
  }
  /**
   * Copy a processor.
   *
   * @deprecated
   *   This is a private internal method and should not be used.
   * @returns {Processor<ParseTree, HeadTree, TailTree, CompileTree, CompileResult>}
   *   New *unfrozen* processor ({@linkcode Processor}) that is
   *   configured to work the same as its ancestor.
   *   When the descendant processor is configured in the future it does not
   *   affect the ancestral processor.
   */
  copy() {
    const t = (
      /** @type {Processor<ParseTree, HeadTree, TailTree, CompileTree, CompileResult>} */
      new U2()
    );
    let n = -1;
    for (; ++n < this.attachers.length; ) {
      const r = this.attachers[n];
      t.use(...r);
    }
    return t.data(zg(!0, {}, this.namespace)), t;
  }
  /**
   * Configure the processor with info available to all plugins.
   * Information is stored in an object.
   *
   * Typically, options can be given to a specific plugin, but sometimes it
   * makes sense to have information shared with several plugins.
   * For example, a list of HTML elements that are self-closing, which is
   * needed during all phases.
   *
   * > **Note**: setting information cannot occur on *frozen* processors.
   * > Call the processor first to create a new unfrozen processor.
   *
   * > **Note**: to register custom data in TypeScript, augment the
   * > {@linkcode Data} interface.
   *
   * @example
   *   This example show how to get and set info:
   *
   *   ```js
   *   import {unified} from 'unified'
   *
   *   const processor = unified().data('alpha', 'bravo')
   *
   *   processor.data('alpha') // => 'bravo'
   *
   *   processor.data() // => {alpha: 'bravo'}
   *
   *   processor.data({charlie: 'delta'})
   *
   *   processor.data() // => {charlie: 'delta'}
   *   ```
   *
   * @template {keyof Data} Key
   *
   * @overload
   * @returns {Data}
   *
   * @overload
   * @param {Data} dataset
   * @returns {Processor<ParseTree, HeadTree, TailTree, CompileTree, CompileResult>}
   *
   * @overload
   * @param {Key} key
   * @returns {Data[Key]}
   *
   * @overload
   * @param {Key} key
   * @param {Data[Key]} value
   * @returns {Processor<ParseTree, HeadTree, TailTree, CompileTree, CompileResult>}
   *
   * @param {Data | Key} [key]
   *   Key to get or set, or entire dataset to set, or nothing to get the
   *   entire dataset (optional).
   * @param {Data[Key]} [value]
   *   Value to set (optional).
   * @returns {unknown}
   *   The current processor when setting, the value at `key` when getting, or
   *   the entire dataset when getting without key.
   */
  data(t, n) {
    return typeof t == "string" ? arguments.length === 2 ? (Pg("data", this.frozen), this.namespace[t] = n, this) : XP.call(this.namespace, t) && this.namespace[t] || void 0 : t ? (Pg("data", this.frozen), this.namespace = t, this) : this.namespace;
  }
  /**
   * Freeze a processor.
   *
   * Frozen processors are meant to be extended and not to be configured
   * directly.
   *
   * When a processor is frozen it cannot be unfrozen.
   * New processors working the same way can be created by calling the
   * processor.
   *
   * Its possible to freeze processors explicitly by calling `.freeze()`.
   * Processors freeze automatically when `.parse()`, `.run()`, `.runSync()`,
   * `.stringify()`, `.process()`, or `.processSync()` are called.
   *
   * @returns {Processor<ParseTree, HeadTree, TailTree, CompileTree, CompileResult>}
   *   The current processor.
   */
  freeze() {
    if (this.frozen)
      return this;
    const t = (
      /** @type {Processor} */
      /** @type {unknown} */
      this
    );
    for (; ++this.freezeIndex < this.attachers.length; ) {
      const [n, ...r] = this.attachers[this.freezeIndex];
      if (r[0] === !1)
        continue;
      r[0] === !0 && (r[0] = void 0);
      const a = n.call(t, ...r);
      typeof a == "function" && this.transformers.use(a);
    }
    return this.frozen = !0, this.freezeIndex = Number.POSITIVE_INFINITY, this;
  }
  /**
   * Parse text to a syntax tree.
   *
   * > **Note**: `parse` freezes the processor if not already *frozen*.
   *
   * > **Note**: `parse` performs the parse phase, not the run phase or other
   * > phases.
   *
   * @param {Compatible | undefined} [file]
   *   file to parse (optional); typically `string` or `VFile`; any value
   *   accepted as `x` in `new VFile(x)`.
   * @returns {ParseTree extends undefined ? Node : ParseTree}
   *   Syntax tree representing `file`.
   */
  parse(t) {
    this.freeze();
    const n = Lf(t), r = this.parser || this.Parser;
    return Lg("parse", r), r(String(n), n);
  }
  /**
   * Process the given file as configured on the processor.
   *
   * > **Note**: `process` freezes the processor if not already *frozen*.
   *
   * > **Note**: `process` performs the parse, run, and stringify phases.
   *
   * @overload
   * @param {Compatible | undefined} file
   * @param {ProcessCallback<VFileWithOutput<CompileResult>>} done
   * @returns {undefined}
   *
   * @overload
   * @param {Compatible | undefined} [file]
   * @returns {Promise<VFileWithOutput<CompileResult>>}
   *
   * @param {Compatible | undefined} [file]
   *   File (optional); typically `string` or `VFile`]; any value accepted as
   *   `x` in `new VFile(x)`.
   * @param {ProcessCallback<VFileWithOutput<CompileResult>> | undefined} [done]
   *   Callback (optional).
   * @returns {Promise<VFile> | undefined}
   *   Nothing if `done` is given.
   *   Otherwise a promise, rejected with a fatal error or resolved with the
   *   processed file.
   *
   *   The parsed, transformed, and compiled value is available at
   *   `file.value` (see note).
   *
   *   > **Note**: unified typically compiles by serializing: most
   *   > compilers return `string` (or `Uint8Array`).
   *   > Some compilers, such as the one configured with
   *   > [`rehype-react`][rehype-react], return other values (in this case, a
   *   > React tree).
   *   > If youre using a compiler that doesnt serialize, expect different
   *   > result values.
   *   >
   *   > To register custom results in TypeScript, add them to
   *   > {@linkcode CompileResultMap}.
   *
   *   [rehype-react]: https://github.com/rehypejs/rehype-react
   */
  process(t, n) {
    const r = this;
    return this.freeze(), Lg("process", this.parser || this.Parser), qg("process", this.compiler || this.Compiler), n ? a(void 0, n) : new Promise(a);
    function a(o, l) {
      const u = Lf(t), f = (
        /** @type {HeadTree extends undefined ? Node : HeadTree} */
        /** @type {unknown} */
        r.parse(u)
      );
      r.run(f, u, function(m, p, x) {
        if (m || !p || !x)
          return d(m);
        const y = (
          /** @type {CompileTree extends undefined ? Node : CompileTree} */
          /** @type {unknown} */
          p
        ), w = r.stringify(y, x);
        ZP(w) ? x.value = w : x.result = w, d(
          m,
          /** @type {VFileWithOutput<CompileResult>} */
          x
        );
      });
      function d(m, p) {
        m || !p ? l(m) : o ? o(p) : n(void 0, p);
      }
    }
  }
  /**
   * Process the given file as configured on the processor.
   *
   * An error is thrown if asynchronous transforms are configured.
   *
   * > **Note**: `processSync` freezes the processor if not already *frozen*.
   *
   * > **Note**: `processSync` performs the parse, run, and stringify phases.
   *
   * @param {Compatible | undefined} [file]
   *   File (optional); typically `string` or `VFile`; any value accepted as
   *   `x` in `new VFile(x)`.
   * @returns {VFileWithOutput<CompileResult>}
   *   The processed file.
   *
   *   The parsed, transformed, and compiled value is available at
   *   `file.value` (see note).
   *
   *   > **Note**: unified typically compiles by serializing: most
   *   > compilers return `string` (or `Uint8Array`).
   *   > Some compilers, such as the one configured with
   *   > [`rehype-react`][rehype-react], return other values (in this case, a
   *   > React tree).
   *   > If youre using a compiler that doesnt serialize, expect different
   *   > result values.
   *   >
   *   > To register custom results in TypeScript, add them to
   *   > {@linkcode CompileResultMap}.
   *
   *   [rehype-react]: https://github.com/rehypejs/rehype-react
   */
  processSync(t) {
    let n = !1, r;
    return this.freeze(), Lg("processSync", this.parser || this.Parser), qg("processSync", this.compiler || this.Compiler), this.process(t, a), Y_("processSync", "process", n), r;
    function a(o, l) {
      n = !0, H_(o), r = l;
    }
  }
  /**
   * Run *transformers* on a syntax tree.
   *
   * > **Note**: `run` freezes the processor if not already *frozen*.
   *
   * > **Note**: `run` performs the run phase, not other phases.
   *
   * @overload
   * @param {HeadTree extends undefined ? Node : HeadTree} tree
   * @param {RunCallback<TailTree extends undefined ? Node : TailTree>} done
   * @returns {undefined}
   *
   * @overload
   * @param {HeadTree extends undefined ? Node : HeadTree} tree
   * @param {Compatible | undefined} file
   * @param {RunCallback<TailTree extends undefined ? Node : TailTree>} done
   * @returns {undefined}
   *
   * @overload
   * @param {HeadTree extends undefined ? Node : HeadTree} tree
   * @param {Compatible | undefined} [file]
   * @returns {Promise<TailTree extends undefined ? Node : TailTree>}
   *
   * @param {HeadTree extends undefined ? Node : HeadTree} tree
   *   Tree to transform and inspect.
   * @param {(
   *   RunCallback<TailTree extends undefined ? Node : TailTree> |
   *   Compatible
   * )} [file]
   *   File associated with `node` (optional); any value accepted as `x` in
   *   `new VFile(x)`.
   * @param {RunCallback<TailTree extends undefined ? Node : TailTree>} [done]
   *   Callback (optional).
   * @returns {Promise<TailTree extends undefined ? Node : TailTree> | undefined}
   *   Nothing if `done` is given.
   *   Otherwise, a promise rejected with a fatal error or resolved with the
   *   transformed tree.
   */
  run(t, n, r) {
    K_(t), this.freeze();
    const a = this.transformers;
    return !r && typeof n == "function" && (r = n, n = void 0), r ? o(void 0, r) : new Promise(o);
    function o(l, u) {
      const f = Lf(n);
      a.run(t, f, d);
      function d(m, p, x) {
        const y = (
          /** @type {TailTree extends undefined ? Node : TailTree} */
          p || t
        );
        m ? u(m) : l ? l(y) : r(void 0, y, x);
      }
    }
  }
  /**
   * Run *transformers* on a syntax tree.
   *
   * An error is thrown if asynchronous transforms are configured.
   *
   * > **Note**: `runSync` freezes the processor if not already *frozen*.
   *
   * > **Note**: `runSync` performs the run phase, not other phases.
   *
   * @param {HeadTree extends undefined ? Node : HeadTree} tree
   *   Tree to transform and inspect.
   * @param {Compatible | undefined} [file]
   *   File associated with `node` (optional); any value accepted as `x` in
   *   `new VFile(x)`.
   * @returns {TailTree extends undefined ? Node : TailTree}
   *   Transformed tree.
   */
  runSync(t, n) {
    let r = !1, a;
    return this.run(t, n, o), Y_("runSync", "run", r), a;
    function o(l, u) {
      H_(l), a = u, r = !0;
    }
  }
  /**
   * Compile a syntax tree.
   *
   * > **Note**: `stringify` freezes the processor if not already *frozen*.
   *
   * > **Note**: `stringify` performs the stringify phase, not the run phase
   * > or other phases.
   *
   * @param {CompileTree extends undefined ? Node : CompileTree} tree
   *   Tree to compile.
   * @param {Compatible | undefined} [file]
   *   File associated with `node` (optional); any value accepted as `x` in
   *   `new VFile(x)`.
   * @returns {CompileResult extends undefined ? Value : CompileResult}
   *   Textual representation of the tree (see note).
   *
   *   > **Note**: unified typically compiles by serializing: most compilers
   *   > return `string` (or `Uint8Array`).
   *   > Some compilers, such as the one configured with
   *   > [`rehype-react`][rehype-react], return other values (in this case, a
   *   > React tree).
   *   > If youre using a compiler that doesnt serialize, expect different
   *   > result values.
   *   >
   *   > To register custom results in TypeScript, add them to
   *   > {@linkcode CompileResultMap}.
   *
   *   [rehype-react]: https://github.com/rehypejs/rehype-react
   */
  stringify(t, n) {
    this.freeze();
    const r = Lf(n), a = this.compiler || this.Compiler;
    return qg("stringify", a), K_(t), a(t, r);
  }
  /**
   * Configure the processor to use a plugin, a list of usable values, or a
   * preset.
   *
   * If the processor is already using a plugin, the previous plugin
   * configuration is changed based on the options that are passed in.
   * In other words, the plugin is not added a second time.
   *
   * > **Note**: `use` cannot be called on *frozen* processors.
   * > Call the processor first to create a new unfrozen processor.
   *
   * @example
   *   There are many ways to pass plugins to `.use()`.
   *   This example gives an overview:
   *
   *   ```js
   *   import {unified} from 'unified'
   *
   *   unified()
   *     // Plugin with options:
   *     .use(pluginA, {x: true, y: true})
   *     // Passing the same plugin again merges configuration (to `{x: true, y: false, z: true}`):
   *     .use(pluginA, {y: false, z: true})
   *     // Plugins:
   *     .use([pluginB, pluginC])
   *     // Two plugins, the second with options:
   *     .use([pluginD, [pluginE, {}]])
   *     // Preset with plugins and settings:
   *     .use({plugins: [pluginF, [pluginG, {}]], settings: {position: false}})
   *     // Settings only:
   *     .use({settings: {position: false}})
   *   ```
   *
   * @template {Array<unknown>} [Parameters=[]]
   * @template {Node | string | undefined} [Input=undefined]
   * @template [Output=Input]
   *
   * @overload
   * @param {Preset | null | undefined} [preset]
   * @returns {Processor<ParseTree, HeadTree, TailTree, CompileTree, CompileResult>}
   *
   * @overload
   * @param {PluggableList} list
   * @returns {Processor<ParseTree, HeadTree, TailTree, CompileTree, CompileResult>}
   *
   * @overload
   * @param {Plugin<Parameters, Input, Output>} plugin
   * @param {...(Parameters | [boolean])} parameters
   * @returns {UsePlugin<ParseTree, HeadTree, TailTree, CompileTree, CompileResult, Input, Output>}
   *
   * @param {PluggableList | Plugin | Preset | null | undefined} value
   *   Usable value.
   * @param {...unknown} parameters
   *   Parameters, when a plugin is given as a usable value.
   * @returns {Processor<ParseTree, HeadTree, TailTree, CompileTree, CompileResult>}
   *   Current processor.
   */
  use(t, ...n) {
    const r = this.attachers, a = this.namespace;
    if (Pg("use", this.frozen), t != null) if (typeof t == "function")
      f(t, n);
    else if (typeof t == "object")
      Array.isArray(t) ? u(t) : l(t);
    else
      throw new TypeError("Expected usable value, not `" + t + "`");
    return this;
    function o(d) {
      if (typeof d == "function")
        f(d, []);
      else if (typeof d == "object")
        if (Array.isArray(d)) {
          const [m, ...p] = (
            /** @type {PluginTuple<Array<unknown>>} */
            d
          );
          f(m, p);
        } else
          l(d);
      else
        throw new TypeError("Expected usable value, not `" + d + "`");
    }
    function l(d) {
      if (!("plugins" in d) && !("settings" in d))
        throw new Error(
          "Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither"
        );
      u(d.plugins), d.settings && (a.settings = zg(!0, a.settings, d.settings));
    }
    function u(d) {
      let m = -1;
      if (d != null) if (Array.isArray(d))
        for (; ++m < d.length; ) {
          const p = d[m];
          o(p);
        }
      else
        throw new TypeError("Expected a list of plugins, not `" + d + "`");
    }
    function f(d, m) {
      let p = -1, x = -1;
      for (; ++p < r.length; )
        if (r[p][0] === d) {
          x = p;
          break;
        }
      if (x === -1)
        r.push([d, ...m]);
      else if (m.length > 0) {
        let [y, ...w] = m;
        const E = r[x][1];
        Bb(E) && Bb(y) && (y = zg(!0, E, y)), r[x] = [d, y, ...w];
      }
    }
  }
}
const WP = new U2().freeze();
function Lg(e, t) {
  if (typeof t != "function")
    throw new TypeError("Cannot `" + e + "` without `parser`");
}
function qg(e, t) {
  if (typeof t != "function")
    throw new TypeError("Cannot `" + e + "` without `compiler`");
}
function Pg(e, t) {
  if (t)
    throw new Error(
      "Cannot call `" + e + "` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`."
    );
}
function K_(e) {
  if (!Bb(e) || typeof e.type != "string")
    throw new TypeError("Expected node, got `" + e + "`");
}
function Y_(e, t, n) {
  if (!n)
    throw new Error(
      "`" + e + "` finished async. Use `" + t + "` instead"
    );
}
function Lf(e) {
  return QP(e) ? e : new p7(e);
}
function QP(e) {
  return !!(e && typeof e == "object" && "message" in e && "messages" in e);
}
function ZP(e) {
  return typeof e == "string" || JP(e);
}
function JP(e) {
  return !!(e && typeof e == "object" && "byteLength" in e && "byteOffset" in e);
}
const eB = "https://github.com/remarkjs/react-markdown/blob/main/changelog.md", X_ = [], W_ = { allowDangerousHtml: !0 }, tB = /^(https?|ircs?|mailto|xmpp)$/i, nB = [
  { from: "astPlugins", id: "remove-buggy-html-in-markdown-parser" },
  { from: "allowDangerousHtml", id: "remove-buggy-html-in-markdown-parser" },
  {
    from: "allowNode",
    id: "replace-allownode-allowedtypes-and-disallowedtypes",
    to: "allowElement"
  },
  {
    from: "allowedTypes",
    id: "replace-allownode-allowedtypes-and-disallowedtypes",
    to: "allowedElements"
  },
  { from: "className", id: "remove-classname" },
  {
    from: "disallowedTypes",
    id: "replace-allownode-allowedtypes-and-disallowedtypes",
    to: "disallowedElements"
  },
  { from: "escapeHtml", id: "remove-buggy-html-in-markdown-parser" },
  { from: "includeElementIndex", id: "#remove-includeelementindex" },
  {
    from: "includeNodeIndex",
    id: "change-includenodeindex-to-includeelementindex"
  },
  { from: "linkTarget", id: "remove-linktarget" },
  { from: "plugins", id: "change-plugins-to-remarkplugins", to: "remarkPlugins" },
  { from: "rawSourcePos", id: "#remove-rawsourcepos" },
  { from: "renderers", id: "change-renderers-to-components", to: "components" },
  { from: "source", id: "change-source-to-children", to: "children" },
  { from: "sourcePos", id: "#remove-sourcepos" },
  { from: "transformImageUri", id: "#add-urltransform", to: "urlTransform" },
  { from: "transformLinkUri", id: "#add-urltransform", to: "urlTransform" }
];
function rB(e) {
  const t = iB(e), n = aB(e);
  return sB(t.runSync(t.parse(n), n), e);
}
function iB(e) {
  const t = e.rehypePlugins || X_, n = e.remarkPlugins || X_, r = e.remarkRehypeOptions ? { ...e.remarkRehypeOptions, ...W_ } : W_;
  return WP().use(qq).use(n).use(RP, r).use(t);
}
function aB(e) {
  const t = e.children || "", n = new p7();
  return typeof t == "string" && (n.value = t), n;
}
function sB(e, t) {
  const n = t.allowedElements, r = t.allowElement, a = t.components, o = t.disallowedElements, l = t.skipHtml, u = t.unwrapDisallowed, f = t.urlTransform || oB;
  for (const m of nB)
    Object.hasOwn(t, m.from) && ("" + m.from + (m.to ? "use `" + m.to + "` instead" : "remove it") + eB + m.id, void 0);
  return $2(e, d), wI(e, {
    Fragment: h.Fragment,
    components: a,
    ignoreInvalidStyle: !0,
    jsx: h.jsx,
    jsxs: h.jsxs,
    passKeys: !0,
    passNode: !0
  });
  function d(m, p, x) {
    if (m.type === "raw" && x && typeof p == "number")
      return l ? x.children.splice(p, 1) : x.children[p] = { type: "text", value: m.value }, p;
    if (m.type === "element") {
      let y;
      for (y in Tg)
        if (Object.hasOwn(Tg, y) && Object.hasOwn(m.properties, y)) {
          const w = m.properties[y], E = Tg[y];
          (E === null || E.includes(m.tagName)) && (m.properties[y] = f(String(w || ""), y, m));
        }
    }
    if (m.type === "element") {
      let y = n ? !n.includes(m.tagName) : o ? o.includes(m.tagName) : !1;
      if (!y && r && typeof p == "number" && (y = !r(m, p, x)), y && x && typeof p == "number")
        return u && m.children ? x.children.splice(p, 1, ...m.children) : x.children.splice(p, 1), p;
    }
  }
}
function oB(e) {
  const t = e.indexOf(":"), n = e.indexOf("?"), r = e.indexOf("#"), a = e.indexOf("/");
  return (
    // If there is no protocol, its relative.
    t === -1 || // If the first colon is after a `?`, `#`, or `/`, its not a protocol.
    a !== -1 && t > a || n !== -1 && t > n || r !== -1 && t > r || // It is a protocol, it should be allowed.
    tB.test(e.slice(0, t)) ? e : ""
  );
}
function Q_(e, t) {
  const n = String(e);
  if (typeof t != "string")
    throw new TypeError("Expected character");
  let r = 0, a = n.indexOf(t);
  for (; a !== -1; )
    r++, a = n.indexOf(t, a + t.length);
  return r;
}
function lB(e) {
  if (typeof e != "string")
    throw new TypeError("Expected a string");
  return e.replace(/[|\\{}()[\]^$+*?.]/g, "\\$&").replace(/-/g, "\\x2d");
}
function uB(e, t, n) {
  const a = Hh((n || {}).ignore || []), o = cB(t);
  let l = -1;
  for (; ++l < o.length; )
    m7(e, "text", u);
  function u(d, m) {
    let p = -1, x;
    for (; ++p < m.length; ) {
      const y = m[p], w = x ? x.children : void 0;
      if (a(
        y,
        w ? w.indexOf(y) : void 0,
        x
      ))
        return;
      x = y;
    }
    if (x)
      return f(d, m);
  }
  function f(d, m) {
    const p = m[m.length - 1], x = o[l][0], y = o[l][1];
    let w = 0;
    const k = p.children.indexOf(d);
    let C = !1, T = [];
    x.lastIndex = 0;
    let N = x.exec(d.value);
    for (; N; ) {
      const A = N.index, D = {
        index: N.index,
        input: N.input,
        stack: [...m, d]
      };
      let M = y(...N, D);
      if (typeof M == "string" && (M = M.length > 0 ? { type: "text", value: M } : void 0), M === !1 ? x.lastIndex = A + 1 : (w !== A && T.push({
        type: "text",
        value: d.value.slice(w, A)
      }), Array.isArray(M) ? T.push(...M) : M && T.push(M), w = A + N[0].length, C = !0), !x.global)
        break;
      N = x.exec(d.value);
    }
    return C ? (w < d.value.length && T.push({ type: "text", value: d.value.slice(w) }), p.children.splice(k, 1, ...T)) : T = [d], k + T.length;
  }
}
function cB(e) {
  const t = [];
  if (!Array.isArray(e))
    throw new TypeError("Expected find and replace tuple or list of tuples");
  const n = !e[0] || Array.isArray(e[0]) ? e : [e];
  let r = -1;
  for (; ++r < n.length; ) {
    const a = n[r];
    t.push([dB(a[0]), fB(a[1])]);
  }
  return t;
}
function dB(e) {
  return typeof e == "string" ? new RegExp(lB(e), "g") : e;
}
function fB(e) {
  return typeof e == "function" ? e : function() {
    return e;
  };
}
const Bg = "phrasing", Fg = ["autolink", "link", "image", "label"];
function hB() {
  return {
    transforms: [bB],
    enter: {
      literalAutolink: pB,
      literalAutolinkEmail: $g,
      literalAutolinkHttp: $g,
      literalAutolinkWww: $g
    },
    exit: {
      literalAutolink: vB,
      literalAutolinkEmail: xB,
      literalAutolinkHttp: gB,
      literalAutolinkWww: yB
    }
  };
}
function mB() {
  return {
    unsafe: [
      {
        character: "@",
        before: "[+\\-.\\w]",
        after: "[\\-.\\w]",
        inConstruct: Bg,
        notInConstruct: Fg
      },
      {
        character: ".",
        before: "[Ww]",
        after: "[\\-.\\w]",
        inConstruct: Bg,
        notInConstruct: Fg
      },
      {
        character: ":",
        before: "[ps]",
        after: "\\/",
        inConstruct: Bg,
        notInConstruct: Fg
      }
    ]
  };
}
function pB(e) {
  this.enter({ type: "link", title: null, url: "", children: [] }, e);
}
function $g(e) {
  this.config.enter.autolinkProtocol.call(this, e);
}
function gB(e) {
  this.config.exit.autolinkProtocol.call(this, e);
}
function yB(e) {
  this.config.exit.data.call(this, e);
  const t = this.stack[this.stack.length - 1];
  t.type, t.url = "http://" + this.sliceSerialize(e);
}
function xB(e) {
  this.config.exit.autolinkEmail.call(this, e);
}
function vB(e) {
  this.exit(e);
}
function bB(e) {
  uB(
    e,
    [
      [/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi, wB],
      [new RegExp("(?<=^|\\s|\\p{P}|\\p{S})([-.\\w+]+)@([-\\w]+(?:\\.[-\\w]+)+)", "gu"), _B]
    ],
    { ignore: ["link", "linkReference"] }
  );
}
function wB(e, t, n, r, a) {
  let o = "";
  if (!g7(a) || (/^w/i.test(t) && (n = t + n, t = "", o = "http://"), !SB(n)))
    return !1;
  const l = CB(n + r);
  if (!l[0]) return !1;
  const u = {
    type: "link",
    title: null,
    url: o + t + l[0],
    children: [{ type: "text", value: t + l[0] }]
  };
  return l[1] ? [u, { type: "text", value: l[1] }] : u;
}
function _B(e, t, n, r) {
  return (
    // Not an expected previous character.
    !g7(r, !0) || // Label ends in not allowed character.
    /[-\d_]$/.test(n) ? !1 : {
      type: "link",
      title: null,
      url: "mailto:" + t + "@" + n,
      children: [{ type: "text", value: t + "@" + n }]
    }
  );
}
function SB(e) {
  const t = e.split(".");
  return !(t.length < 2 || t[t.length - 1] && (/_/.test(t[t.length - 1]) || !/[a-zA-Z\d]/.test(t[t.length - 1])) || t[t.length - 2] && (/_/.test(t[t.length - 2]) || !/[a-zA-Z\d]/.test(t[t.length - 2])));
}
function CB(e) {
  const t = /[!"&'),.:;<>?\]}]+$/.exec(e);
  if (!t)
    return [e, void 0];
  e = e.slice(0, t.index);
  let n = t[0], r = n.indexOf(")");
  const a = Q_(e, "(");
  let o = Q_(e, ")");
  for (; r !== -1 && a > o; )
    e += n.slice(0, r + 1), n = n.slice(r + 1), r = n.indexOf(")"), o++;
  return [e, n];
}
function g7(e, t) {
  const n = e.input.charCodeAt(e.index - 1);
  return (e.index === 0 || zo(n) || Fh(n)) && // If its an email, the previous character should not be a slash.
  (!t || n !== 47);
}
y7.peek = zB;
function EB() {
  this.buffer();
}
function kB(e) {
  this.enter({ type: "footnoteReference", identifier: "", label: "" }, e);
}
function NB() {
  this.buffer();
}
function jB(e) {
  this.enter(
    { type: "footnoteDefinition", identifier: "", label: "", children: [] },
    e
  );
}
function TB(e) {
  const t = this.resume(), n = this.stack[this.stack.length - 1];
  n.type, n.identifier = Mi(
    this.sliceSerialize(e)
  ).toLowerCase(), n.label = t;
}
function AB(e) {
  this.exit(e);
}
function MB(e) {
  const t = this.resume(), n = this.stack[this.stack.length - 1];
  n.type, n.identifier = Mi(
    this.sliceSerialize(e)
  ).toLowerCase(), n.label = t;
}
function RB(e) {
  this.exit(e);
}
function zB() {
  return "[";
}
function y7(e, t, n, r) {
  const a = n.createTracker(r);
  let o = a.move("[^");
  const l = n.enter("footnoteReference"), u = n.enter("reference");
  return o += a.move(
    n.safe(n.associationId(e), { after: "]", before: o })
  ), u(), l(), o += a.move("]"), o;
}
function OB() {
  return {
    enter: {
      gfmFootnoteCallString: EB,
      gfmFootnoteCall: kB,
      gfmFootnoteDefinitionLabelString: NB,
      gfmFootnoteDefinition: jB
    },
    exit: {
      gfmFootnoteCallString: TB,
      gfmFootnoteCall: AB,
      gfmFootnoteDefinitionLabelString: MB,
      gfmFootnoteDefinition: RB
    }
  };
}
function DB(e) {
  let t = !1;
  return e && e.firstLineBlank && (t = !0), {
    handlers: { footnoteDefinition: n, footnoteReference: y7 },
    // This is on by default already.
    unsafe: [{ character: "[", inConstruct: ["label", "phrasing", "reference"] }]
  };
  function n(r, a, o, l) {
    const u = o.createTracker(l);
    let f = u.move("[^");
    const d = o.enter("footnoteDefinition"), m = o.enter("label");
    return f += u.move(
      o.safe(o.associationId(r), { before: f, after: "]" })
    ), m(), f += u.move("]:"), r.children && r.children.length > 0 && (u.shift(4), f += u.move(
      (t ? `
` : " ") + o.indentLines(
        o.containerFlow(r, u.current()),
        t ? x7 : IB
      )
    )), d(), f;
  }
}
function IB(e, t, n) {
  return t === 0 ? e : x7(e, t, n);
}
function x7(e, t, n) {
  return (n ? "" : "    ") + e;
}
const LB = [
  "autolink",
  "destinationLiteral",
  "destinationRaw",
  "reference",
  "titleQuote",
  "titleApostrophe"
];
v7.peek = $B;
function qB() {
  return {
    canContainEols: ["delete"],
    enter: { strikethrough: BB },
    exit: { strikethrough: FB }
  };
}
function PB() {
  return {
    unsafe: [
      {
        character: "~",
        inConstruct: "phrasing",
        notInConstruct: LB
      }
    ],
    handlers: { delete: v7 }
  };
}
function BB(e) {
  this.enter({ type: "delete", children: [] }, e);
}
function FB(e) {
  this.exit(e);
}
function v7(e, t, n, r) {
  const a = n.createTracker(r), o = n.enter("strikethrough");
  let l = a.move("~~");
  return l += n.containerPhrasing(e, {
    ...a.current(),
    before: l,
    after: "~"
  }), l += a.move("~~"), o(), l;
}
function $B() {
  return "~";
}
function UB(e) {
  return e.length;
}
function HB(e, t) {
  const n = t || {}, r = (n.align || []).concat(), a = n.stringLength || UB, o = [], l = [], u = [], f = [];
  let d = 0, m = -1;
  for (; ++m < e.length; ) {
    const E = [], k = [];
    let C = -1;
    for (e[m].length > d && (d = e[m].length); ++C < e[m].length; ) {
      const T = GB(e[m][C]);
      if (n.alignDelimiters !== !1) {
        const N = a(T);
        k[C] = N, (f[C] === void 0 || N > f[C]) && (f[C] = N);
      }
      E.push(T);
    }
    l[m] = E, u[m] = k;
  }
  let p = -1;
  if (typeof r == "object" && "length" in r)
    for (; ++p < d; )
      o[p] = Z_(r[p]);
  else {
    const E = Z_(r);
    for (; ++p < d; )
      o[p] = E;
  }
  p = -1;
  const x = [], y = [];
  for (; ++p < d; ) {
    const E = o[p];
    let k = "", C = "";
    E === 99 ? (k = ":", C = ":") : E === 108 ? k = ":" : E === 114 && (C = ":");
    let T = n.alignDelimiters === !1 ? 1 : Math.max(
      1,
      f[p] - k.length - C.length
    );
    const N = k + "-".repeat(T) + C;
    n.alignDelimiters !== !1 && (T = k.length + T + C.length, T > f[p] && (f[p] = T), y[p] = T), x[p] = N;
  }
  l.splice(1, 0, x), u.splice(1, 0, y), m = -1;
  const w = [];
  for (; ++m < l.length; ) {
    const E = l[m], k = u[m];
    p = -1;
    const C = [];
    for (; ++p < d; ) {
      const T = E[p] || "";
      let N = "", A = "";
      if (n.alignDelimiters !== !1) {
        const D = f[p] - (k[p] || 0), M = o[p];
        M === 114 ? N = " ".repeat(D) : M === 99 ? D % 2 ? (N = " ".repeat(D / 2 + 0.5), A = " ".repeat(D / 2 - 0.5)) : (N = " ".repeat(D / 2), A = N) : A = " ".repeat(D);
      }
      n.delimiterStart !== !1 && !p && C.push("|"), n.padding !== !1 && // Dont add the opening space if were not aligning and the cell is
      // empty: there will be a closing space.
      !(n.alignDelimiters === !1 && T === "") && (n.delimiterStart !== !1 || p) && C.push(" "), n.alignDelimiters !== !1 && C.push(N), C.push(T), n.alignDelimiters !== !1 && C.push(A), n.padding !== !1 && C.push(" "), (n.delimiterEnd !== !1 || p !== d - 1) && C.push("|");
    }
    w.push(
      n.delimiterEnd === !1 ? C.join("").replace(/ +$/, "") : C.join("")
    );
  }
  return w.join(`
`);
}
function GB(e) {
  return e == null ? "" : String(e);
}
function Z_(e) {
  const t = typeof e == "string" ? e.codePointAt(0) : 0;
  return t === 67 || t === 99 ? 99 : t === 76 || t === 108 ? 108 : t === 82 || t === 114 ? 114 : 0;
}
function VB(e, t, n, r) {
  const a = n.enter("blockquote"), o = n.createTracker(r);
  o.move("> "), o.shift(2);
  const l = n.indentLines(
    n.containerFlow(e, o.current()),
    KB
  );
  return a(), l;
}
function KB(e, t, n) {
  return ">" + (n ? "" : " ") + e;
}
function YB(e, t) {
  return J_(e, t.inConstruct, !0) && !J_(e, t.notInConstruct, !1);
}
function J_(e, t, n) {
  if (typeof t == "string" && (t = [t]), !t || t.length === 0)
    return n;
  let r = -1;
  for (; ++r < t.length; )
    if (e.includes(t[r]))
      return !0;
  return !1;
}
function eS(e, t, n, r) {
  let a = -1;
  for (; ++a < n.unsafe.length; )
    if (n.unsafe[a].character === `
` && YB(n.stack, n.unsafe[a]))
      return /[ \t]/.test(r.before) ? "" : " ";
  return `\\
`;
}
function XB(e, t) {
  const n = String(e);
  let r = n.indexOf(t), a = r, o = 0, l = 0;
  if (typeof t != "string")
    throw new TypeError("Expected substring");
  for (; r !== -1; )
    r === a ? ++o > l && (l = o) : o = 1, a = r + t.length, r = n.indexOf(t, a);
  return l;
}
function WB(e, t) {
  return !!(t.options.fences === !1 && e.value && // If theres no info
  !e.lang && // And theres a non-whitespace character
  /[^ \r\n]/.test(e.value) && // And the value doesnt start or end in a blank
  !/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value));
}
function QB(e) {
  const t = e.options.fence || "`";
  if (t !== "`" && t !== "~")
    throw new Error(
      "Cannot serialize code with `" + t + "` for `options.fence`, expected `` ` `` or `~`"
    );
  return t;
}
function ZB(e, t, n, r) {
  const a = QB(n), o = e.value || "", l = a === "`" ? "GraveAccent" : "Tilde";
  if (WB(e, n)) {
    const p = n.enter("codeIndented"), x = n.indentLines(o, JB);
    return p(), x;
  }
  const u = n.createTracker(r), f = a.repeat(Math.max(XB(o, a) + 1, 3)), d = n.enter("codeFenced");
  let m = u.move(f);
  if (e.lang) {
    const p = n.enter(`codeFencedLang${l}`);
    m += u.move(
      n.safe(e.lang, {
        before: m,
        after: " ",
        encode: ["`"],
        ...u.current()
      })
    ), p();
  }
  if (e.lang && e.meta) {
    const p = n.enter(`codeFencedMeta${l}`);
    m += u.move(" "), m += u.move(
      n.safe(e.meta, {
        before: m,
        after: `
`,
        encode: ["`"],
        ...u.current()
      })
    ), p();
  }
  return m += u.move(`
`), o && (m += u.move(o + `
`)), m += u.move(f), d(), m;
}
function JB(e, t, n) {
  return (n ? "" : "    ") + e;
}
function H2(e) {
  const t = e.options.quote || '"';
  if (t !== '"' && t !== "'")
    throw new Error(
      "Cannot serialize title with `" + t + "` for `options.quote`, expected `\"`, or `'`"
    );
  return t;
}
function eF(e, t, n, r) {
  const a = H2(n), o = a === '"' ? "Quote" : "Apostrophe", l = n.enter("definition");
  let u = n.enter("label");
  const f = n.createTracker(r);
  let d = f.move("[");
  return d += f.move(
    n.safe(n.associationId(e), {
      before: d,
      after: "]",
      ...f.current()
    })
  ), d += f.move("]: "), u(), // If theres no url, or
  !e.url || // If there are control characters or whitespace.
  /[\0- \u007F]/.test(e.url) ? (u = n.enter("destinationLiteral"), d += f.move("<"), d += f.move(
    n.safe(e.url, { before: d, after: ">", ...f.current() })
  ), d += f.move(">")) : (u = n.enter("destinationRaw"), d += f.move(
    n.safe(e.url, {
      before: d,
      after: e.title ? " " : `
`,
      ...f.current()
    })
  )), u(), e.title && (u = n.enter(`title${o}`), d += f.move(" " + a), d += f.move(
    n.safe(e.title, {
      before: d,
      after: a,
      ...f.current()
    })
  ), d += f.move(a), u()), l(), d;
}
function tF(e) {
  const t = e.options.emphasis || "*";
  if (t !== "*" && t !== "_")
    throw new Error(
      "Cannot serialize emphasis with `" + t + "` for `options.emphasis`, expected `*`, or `_`"
    );
  return t;
}
function Kc(e) {
  return "&#x" + e.toString(16).toUpperCase() + ";";
}
function gh(e, t, n) {
  const r = Jl(e), a = Jl(t);
  return r === void 0 ? a === void 0 ? (
    // Letter inside:
    // we have to encode *both* letters for `_` as it is looser.
    // it already forms for `*` (and GFMs `~`).
    n === "_" ? { inside: !0, outside: !0 } : { inside: !1, outside: !1 }
  ) : a === 1 ? (
    // Whitespace inside: encode both (letter, whitespace).
    { inside: !0, outside: !0 }
  ) : (
    // Punctuation inside: encode outer (letter)
    { inside: !1, outside: !0 }
  ) : r === 1 ? a === void 0 ? (
    // Letter inside: already forms.
    { inside: !1, outside: !1 }
  ) : a === 1 ? (
    // Whitespace inside: encode both (whitespace).
    { inside: !0, outside: !0 }
  ) : (
    // Punctuation inside: already forms.
    { inside: !1, outside: !1 }
  ) : a === void 0 ? (
    // Letter inside: already forms.
    { inside: !1, outside: !1 }
  ) : a === 1 ? (
    // Whitespace inside: encode inner (whitespace).
    { inside: !0, outside: !1 }
  ) : (
    // Punctuation inside: already forms.
    { inside: !1, outside: !1 }
  );
}
b7.peek = nF;
function b7(e, t, n, r) {
  const a = tF(n), o = n.enter("emphasis"), l = n.createTracker(r), u = l.move(a);
  let f = l.move(
    n.containerPhrasing(e, {
      after: a,
      before: u,
      ...l.current()
    })
  );
  const d = f.charCodeAt(0), m = gh(
    r.before.charCodeAt(r.before.length - 1),
    d,
    a
  );
  m.inside && (f = Kc(d) + f.slice(1));
  const p = f.charCodeAt(f.length - 1), x = gh(r.after.charCodeAt(0), p, a);
  x.inside && (f = f.slice(0, -1) + Kc(p));
  const y = l.move(a);
  return o(), n.attentionEncodeSurroundingInfo = {
    after: x.outside,
    before: m.outside
  }, u + f + y;
}
function nF(e, t, n) {
  return n.options.emphasis || "*";
}
function rF(e, t) {
  let n = !1;
  return $2(e, function(r) {
    if ("value" in r && /\r?\n|\r/.test(r.value) || r.type === "break")
      return n = !0, qb;
  }), !!((!e.depth || e.depth < 3) && D2(e) && (t.options.setext || n));
}
function iF(e, t, n, r) {
  const a = Math.max(Math.min(6, e.depth || 1), 1), o = n.createTracker(r);
  if (rF(e, n)) {
    const m = n.enter("headingSetext"), p = n.enter("phrasing"), x = n.containerPhrasing(e, {
      ...o.current(),
      before: `
`,
      after: `
`
    });
    return p(), m(), x + `
` + (a === 1 ? "=" : "-").repeat(
      // The whole size
      x.length - // Minus the position of the character after the last EOL (or
      // 0 if there is none)
      (Math.max(x.lastIndexOf("\r"), x.lastIndexOf(`
`)) + 1)
    );
  }
  const l = "#".repeat(a), u = n.enter("headingAtx"), f = n.enter("phrasing");
  o.move(l + " ");
  let d = n.containerPhrasing(e, {
    before: "# ",
    after: `
`,
    ...o.current()
  });
  return /^[\t ]/.test(d) && (d = Kc(d.charCodeAt(0)) + d.slice(1)), d = d ? l + " " + d : l, n.options.closeAtx && (d += " " + l), f(), u(), d;
}
w7.peek = aF;
function w7(e) {
  return e.value || "";
}
function aF() {
  return "<";
}
_7.peek = sF;
function _7(e, t, n, r) {
  const a = H2(n), o = a === '"' ? "Quote" : "Apostrophe", l = n.enter("image");
  let u = n.enter("label");
  const f = n.createTracker(r);
  let d = f.move("![");
  return d += f.move(
    n.safe(e.alt, { before: d, after: "]", ...f.current() })
  ), d += f.move("]("), u(), // If theres no url but there is a title
  !e.url && e.title || // If there are control characters or whitespace.
  /[\0- \u007F]/.test(e.url) ? (u = n.enter("destinationLiteral"), d += f.move("<"), d += f.move(
    n.safe(e.url, { before: d, after: ">", ...f.current() })
  ), d += f.move(">")) : (u = n.enter("destinationRaw"), d += f.move(
    n.safe(e.url, {
      before: d,
      after: e.title ? " " : ")",
      ...f.current()
    })
  )), u(), e.title && (u = n.enter(`title${o}`), d += f.move(" " + a), d += f.move(
    n.safe(e.title, {
      before: d,
      after: a,
      ...f.current()
    })
  ), d += f.move(a), u()), d += f.move(")"), l(), d;
}
function sF() {
  return "!";
}
S7.peek = oF;
function S7(e, t, n, r) {
  const a = e.referenceType, o = n.enter("imageReference");
  let l = n.enter("label");
  const u = n.createTracker(r);
  let f = u.move("![");
  const d = n.safe(e.alt, {
    before: f,
    after: "]",
    ...u.current()
  });
  f += u.move(d + "]["), l();
  const m = n.stack;
  n.stack = [], l = n.enter("reference");
  const p = n.safe(n.associationId(e), {
    before: f,
    after: "]",
    ...u.current()
  });
  return l(), n.stack = m, o(), a === "full" || !d || d !== p ? f += u.move(p + "]") : a === "shortcut" ? f = f.slice(0, -1) : f += u.move("]"), f;
}
function oF() {
  return "!";
}
C7.peek = lF;
function C7(e, t, n) {
  let r = e.value || "", a = "`", o = -1;
  for (; new RegExp("(^|[^`])" + a + "([^`]|$)").test(r); )
    a += "`";
  for (/[^ \r\n]/.test(r) && (/^[ \r\n]/.test(r) && /[ \r\n]$/.test(r) || /^`|`$/.test(r)) && (r = " " + r + " "); ++o < n.unsafe.length; ) {
    const l = n.unsafe[o], u = n.compilePattern(l);
    let f;
    if (l.atBreak)
      for (; f = u.exec(r); ) {
        let d = f.index;
        r.charCodeAt(d) === 10 && r.charCodeAt(d - 1) === 13 && d--, r = r.slice(0, d) + " " + r.slice(f.index + 1);
      }
  }
  return a + r + a;
}
function lF() {
  return "`";
}
function E7(e, t) {
  const n = D2(e);
  return !!(!t.options.resourceLink && // If theres a url
  e.url && // And theres a no title
  !e.title && // And the content of `node` is a single text node
  e.children && e.children.length === 1 && e.children[0].type === "text" && // And if the url is the same as the content
  (n === e.url || "mailto:" + n === e.url) && // And that starts w/ a protocol
  /^[a-z][a-z+.-]+:/i.test(e.url) && // And that doesnt contain ASCII control codes (character escapes and
  // references dont work), space, or angle brackets
  !/[\0- <>\u007F]/.test(e.url));
}
k7.peek = uF;
function k7(e, t, n, r) {
  const a = H2(n), o = a === '"' ? "Quote" : "Apostrophe", l = n.createTracker(r);
  let u, f;
  if (E7(e, n)) {
    const m = n.stack;
    n.stack = [], u = n.enter("autolink");
    let p = l.move("<");
    return p += l.move(
      n.containerPhrasing(e, {
        before: p,
        after: ">",
        ...l.current()
      })
    ), p += l.move(">"), u(), n.stack = m, p;
  }
  u = n.enter("link"), f = n.enter("label");
  let d = l.move("[");
  return d += l.move(
    n.containerPhrasing(e, {
      before: d,
      after: "](",
      ...l.current()
    })
  ), d += l.move("]("), f(), // If theres no url but there is a title
  !e.url && e.title || // If there are control characters or whitespace.
  /[\0- \u007F]/.test(e.url) ? (f = n.enter("destinationLiteral"), d += l.move("<"), d += l.move(
    n.safe(e.url, { before: d, after: ">", ...l.current() })
  ), d += l.move(">")) : (f = n.enter("destinationRaw"), d += l.move(
    n.safe(e.url, {
      before: d,
      after: e.title ? " " : ")",
      ...l.current()
    })
  )), f(), e.title && (f = n.enter(`title${o}`), d += l.move(" " + a), d += l.move(
    n.safe(e.title, {
      before: d,
      after: a,
      ...l.current()
    })
  ), d += l.move(a), f()), d += l.move(")"), u(), d;
}
function uF(e, t, n) {
  return E7(e, n) ? "<" : "[";
}
N7.peek = cF;
function N7(e, t, n, r) {
  const a = e.referenceType, o = n.enter("linkReference");
  let l = n.enter("label");
  const u = n.createTracker(r);
  let f = u.move("[");
  const d = n.containerPhrasing(e, {
    before: f,
    after: "]",
    ...u.current()
  });
  f += u.move(d + "]["), l();
  const m = n.stack;
  n.stack = [], l = n.enter("reference");
  const p = n.safe(n.associationId(e), {
    before: f,
    after: "]",
    ...u.current()
  });
  return l(), n.stack = m, o(), a === "full" || !d || d !== p ? f += u.move(p + "]") : a === "shortcut" ? f = f.slice(0, -1) : f += u.move("]"), f;
}
function cF() {
  return "[";
}
function G2(e) {
  const t = e.options.bullet || "*";
  if (t !== "*" && t !== "+" && t !== "-")
    throw new Error(
      "Cannot serialize items with `" + t + "` for `options.bullet`, expected `*`, `+`, or `-`"
    );
  return t;
}
function dF(e) {
  const t = G2(e), n = e.options.bulletOther;
  if (!n)
    return t === "*" ? "-" : "*";
  if (n !== "*" && n !== "+" && n !== "-")
    throw new Error(
      "Cannot serialize items with `" + n + "` for `options.bulletOther`, expected `*`, `+`, or `-`"
    );
  if (n === t)
    throw new Error(
      "Expected `bullet` (`" + t + "`) and `bulletOther` (`" + n + "`) to be different"
    );
  return n;
}
function fF(e) {
  const t = e.options.bulletOrdered || ".";
  if (t !== "." && t !== ")")
    throw new Error(
      "Cannot serialize items with `" + t + "` for `options.bulletOrdered`, expected `.` or `)`"
    );
  return t;
}
function j7(e) {
  const t = e.options.rule || "*";
  if (t !== "*" && t !== "-" && t !== "_")
    throw new Error(
      "Cannot serialize rules with `" + t + "` for `options.rule`, expected `*`, `-`, or `_`"
    );
  return t;
}
function hF(e, t, n, r) {
  const a = n.enter("list"), o = n.bulletCurrent;
  let l = e.ordered ? fF(n) : G2(n);
  const u = e.ordered ? l === "." ? ")" : "." : dF(n);
  let f = t && n.bulletLastUsed ? l === n.bulletLastUsed : !1;
  if (!e.ordered) {
    const m = e.children ? e.children[0] : void 0;
    if (
      // Bullet could be used as a thematic break marker:
      (l === "*" || l === "-") && // Empty first list item:
      m && (!m.children || !m.children[0]) && // Directly in two other list items:
      n.stack[n.stack.length - 1] === "list" && n.stack[n.stack.length - 2] === "listItem" && n.stack[n.stack.length - 3] === "list" && n.stack[n.stack.length - 4] === "listItem" && // That are each the first child.
      n.indexStack[n.indexStack.length - 1] === 0 && n.indexStack[n.indexStack.length - 2] === 0 && n.indexStack[n.indexStack.length - 3] === 0 && (f = !0), j7(n) === l && m
    ) {
      let p = -1;
      for (; ++p < e.children.length; ) {
        const x = e.children[p];
        if (x && x.type === "listItem" && x.children && x.children[0] && x.children[0].type === "thematicBreak") {
          f = !0;
          break;
        }
      }
    }
  }
  f && (l = u), n.bulletCurrent = l;
  const d = n.containerFlow(e, r);
  return n.bulletLastUsed = l, n.bulletCurrent = o, a(), d;
}
function mF(e) {
  const t = e.options.listItemIndent || "one";
  if (t !== "tab" && t !== "one" && t !== "mixed")
    throw new Error(
      "Cannot serialize items with `" + t + "` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`"
    );
  return t;
}
function pF(e, t, n, r) {
  const a = mF(n);
  let o = n.bulletCurrent || G2(n);
  t && t.type === "list" && t.ordered && (o = (typeof t.start == "number" && t.start > -1 ? t.start : 1) + (n.options.incrementListMarker === !1 ? 0 : t.children.indexOf(e)) + o);
  let l = o.length + 1;
  (a === "tab" || a === "mixed" && (t && t.type === "list" && t.spread || e.spread)) && (l = Math.ceil(l / 4) * 4);
  const u = n.createTracker(r);
  u.move(o + " ".repeat(l - o.length)), u.shift(l);
  const f = n.enter("listItem"), d = n.indentLines(
    n.containerFlow(e, u.current()),
    m
  );
  return f(), d;
  function m(p, x, y) {
    return x ? (y ? "" : " ".repeat(l)) + p : (y ? o : o + " ".repeat(l - o.length)) + p;
  }
}
function gF(e, t, n, r) {
  const a = n.enter("paragraph"), o = n.enter("phrasing"), l = n.containerPhrasing(e, r);
  return o(), a(), l;
}
const yF = (
  /** @type {(node?: unknown) => node is Exclude<PhrasingContent, Html>} */
  Hh([
    "break",
    "delete",
    "emphasis",
    // To do: next major: removed since footnotes were added to GFM.
    "footnote",
    "footnoteReference",
    "image",
    "imageReference",
    "inlineCode",
    // Enabled by `mdast-util-math`:
    "inlineMath",
    "link",
    "linkReference",
    // Enabled by `mdast-util-mdx`:
    "mdxJsxTextElement",
    // Enabled by `mdast-util-mdx`:
    "mdxTextExpression",
    "strong",
    "text",
    // Enabled by `mdast-util-directive`:
    "textDirective"
  ])
);
function xF(e, t, n, r) {
  return (e.children.some(function(l) {
    return yF(l);
  }) ? n.containerPhrasing : n.containerFlow).call(n, e, r);
}
function vF(e) {
  const t = e.options.strong || "*";
  if (t !== "*" && t !== "_")
    throw new Error(
      "Cannot serialize strong with `" + t + "` for `options.strong`, expected `*`, or `_`"
    );
  return t;
}
T7.peek = bF;
function T7(e, t, n, r) {
  const a = vF(n), o = n.enter("strong"), l = n.createTracker(r), u = l.move(a + a);
  let f = l.move(
    n.containerPhrasing(e, {
      after: a,
      before: u,
      ...l.current()
    })
  );
  const d = f.charCodeAt(0), m = gh(
    r.before.charCodeAt(r.before.length - 1),
    d,
    a
  );
  m.inside && (f = Kc(d) + f.slice(1));
  const p = f.charCodeAt(f.length - 1), x = gh(r.after.charCodeAt(0), p, a);
  x.inside && (f = f.slice(0, -1) + Kc(p));
  const y = l.move(a + a);
  return o(), n.attentionEncodeSurroundingInfo = {
    after: x.outside,
    before: m.outside
  }, u + f + y;
}
function bF(e, t, n) {
  return n.options.strong || "*";
}
function wF(e, t, n, r) {
  return n.safe(e.value, r);
}
function _F(e) {
  const t = e.options.ruleRepetition || 3;
  if (t < 3)
    throw new Error(
      "Cannot serialize rules with repetition `" + t + "` for `options.ruleRepetition`, expected `3` or more"
    );
  return t;
}
function SF(e, t, n) {
  const r = (j7(n) + (n.options.ruleSpaces ? " " : "")).repeat(_F(n));
  return n.options.ruleSpaces ? r.slice(0, -1) : r;
}
const A7 = {
  blockquote: VB,
  break: eS,
  code: ZB,
  definition: eF,
  emphasis: b7,
  hardBreak: eS,
  heading: iF,
  html: w7,
  image: _7,
  imageReference: S7,
  inlineCode: C7,
  link: k7,
  linkReference: N7,
  list: hF,
  listItem: pF,
  paragraph: gF,
  root: xF,
  strong: T7,
  text: wF,
  thematicBreak: SF
};
function CF() {
  return {
    enter: {
      table: EF,
      tableData: tS,
      tableHeader: tS,
      tableRow: NF
    },
    exit: {
      codeText: jF,
      table: kF,
      tableData: Ug,
      tableHeader: Ug,
      tableRow: Ug
    }
  };
}
function EF(e) {
  const t = e._align;
  this.enter(
    {
      type: "table",
      align: t.map(function(n) {
        return n === "none" ? null : n;
      }),
      children: []
    },
    e
  ), this.data.inTable = !0;
}
function kF(e) {
  this.exit(e), this.data.inTable = void 0;
}
function NF(e) {
  this.enter({ type: "tableRow", children: [] }, e);
}
function Ug(e) {
  this.exit(e);
}
function tS(e) {
  this.enter({ type: "tableCell", children: [] }, e);
}
function jF(e) {
  let t = this.resume();
  this.data.inTable && (t = t.replace(/\\([\\|])/g, TF));
  const n = this.stack[this.stack.length - 1];
  n.type, n.value = t, this.exit(e);
}
function TF(e, t) {
  return t === "|" ? t : e;
}
function AF(e) {
  const t = e || {}, n = t.tableCellPadding, r = t.tablePipeAlign, a = t.stringLength, o = n ? " " : "|";
  return {
    unsafe: [
      { character: "\r", inConstruct: "tableCell" },
      { character: `
`, inConstruct: "tableCell" },
      // A pipe, when followed by a tab or space (padding), or a dash or colon
      // (unpadded delimiter row), could result in a table.
      { atBreak: !0, character: "|", after: "[	 :-]" },
      // A pipe in a cell must be encoded.
      { character: "|", inConstruct: "tableCell" },
      // A colon must be followed by a dash, in which case it could start a
      // delimiter row.
      { atBreak: !0, character: ":", after: "-" },
      // A delimiter row can also start with a dash, when followed by more
      // dashes, a colon, or a pipe.
      // This is a stricter version than the built in check for lists, thematic
      // breaks, and setex heading underlines though:
      // <https://github.com/syntax-tree/mdast-util-to-markdown/blob/51a2038/lib/unsafe.js#L57>
      { atBreak: !0, character: "-", after: "[:|-]" }
    ],
    handlers: {
      inlineCode: x,
      table: l,
      tableCell: f,
      tableRow: u
    }
  };
  function l(y, w, E, k) {
    return d(m(y, E, k), y.align);
  }
  function u(y, w, E, k) {
    const C = p(y, E, k), T = d([C]);
    return T.slice(0, T.indexOf(`
`));
  }
  function f(y, w, E, k) {
    const C = E.enter("tableCell"), T = E.enter("phrasing"), N = E.containerPhrasing(y, {
      ...k,
      before: o,
      after: o
    });
    return T(), C(), N;
  }
  function d(y, w) {
    return HB(y, {
      align: w,
      // @ts-expect-error: `markdown-table` types should support `null`.
      alignDelimiters: r,
      // @ts-expect-error: `markdown-table` types should support `null`.
      padding: n,
      // @ts-expect-error: `markdown-table` types should support `null`.
      stringLength: a
    });
  }
  function m(y, w, E) {
    const k = y.children;
    let C = -1;
    const T = [], N = w.enter("table");
    for (; ++C < k.length; )
      T[C] = p(k[C], w, E);
    return N(), T;
  }
  function p(y, w, E) {
    const k = y.children;
    let C = -1;
    const T = [], N = w.enter("tableRow");
    for (; ++C < k.length; )
      T[C] = f(k[C], y, w, E);
    return N(), T;
  }
  function x(y, w, E) {
    let k = A7.inlineCode(y, w, E);
    return E.stack.includes("tableCell") && (k = k.replace(/\|/g, "\\$&")), k;
  }
}
function MF() {
  return {
    exit: {
      taskListCheckValueChecked: nS,
      taskListCheckValueUnchecked: nS,
      paragraph: zF
    }
  };
}
function RF() {
  return {
    unsafe: [{ atBreak: !0, character: "-", after: "[:|-]" }],
    handlers: { listItem: OF }
  };
}
function nS(e) {
  const t = this.stack[this.stack.length - 2];
  t.type, t.checked = e.type === "taskListCheckValueChecked";
}
function zF(e) {
  const t = this.stack[this.stack.length - 2];
  if (t && t.type === "listItem" && typeof t.checked == "boolean") {
    const n = this.stack[this.stack.length - 1];
    n.type;
    const r = n.children[0];
    if (r && r.type === "text") {
      const a = t.children;
      let o = -1, l;
      for (; ++o < a.length; ) {
        const u = a[o];
        if (u.type === "paragraph") {
          l = u;
          break;
        }
      }
      l === n && (r.value = r.value.slice(1), r.value.length === 0 ? n.children.shift() : n.position && r.position && typeof r.position.start.offset == "number" && (r.position.start.column++, r.position.start.offset++, n.position.start = Object.assign({}, r.position.start)));
    }
  }
  this.exit(e);
}
function OF(e, t, n, r) {
  const a = e.children[0], o = typeof e.checked == "boolean" && a && a.type === "paragraph", l = "[" + (e.checked ? "x" : " ") + "] ", u = n.createTracker(r);
  o && u.move(l);
  let f = A7.listItem(e, t, n, {
    ...r,
    ...u.current()
  });
  return o && (f = f.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/, d)), f;
  function d(m) {
    return m + l;
  }
}
function DF() {
  return [
    hB(),
    OB(),
    qB(),
    CF(),
    MF()
  ];
}
function IF(e) {
  return {
    extensions: [
      mB(),
      DB(e),
      PB(),
      AF(e),
      RF()
    ]
  };
}
const LF = {
  tokenize: UF,
  partial: !0
}, M7 = {
  tokenize: HF,
  partial: !0
}, R7 = {
  tokenize: GF,
  partial: !0
}, z7 = {
  tokenize: VF,
  partial: !0
}, qF = {
  tokenize: KF,
  partial: !0
}, O7 = {
  name: "wwwAutolink",
  tokenize: FF,
  previous: I7
}, D7 = {
  name: "protocolAutolink",
  tokenize: $F,
  previous: L7
}, Ya = {
  name: "emailAutolink",
  tokenize: BF,
  previous: q7
}, na = {};
function PF() {
  return {
    text: na
  };
}
let xo = 48;
for (; xo < 123; )
  na[xo] = Ya, xo++, xo === 58 ? xo = 65 : xo === 91 && (xo = 97);
na[43] = Ya;
na[45] = Ya;
na[46] = Ya;
na[95] = Ya;
na[72] = [Ya, D7];
na[104] = [Ya, D7];
na[87] = [Ya, O7];
na[119] = [Ya, O7];
function BF(e, t, n) {
  const r = this;
  let a, o;
  return l;
  function l(p) {
    return !$b(p) || !q7.call(r, r.previous) || V2(r.events) ? n(p) : (e.enter("literalAutolink"), e.enter("literalAutolinkEmail"), u(p));
  }
  function u(p) {
    return $b(p) ? (e.consume(p), u) : p === 64 ? (e.consume(p), f) : n(p);
  }
  function f(p) {
    return p === 46 ? e.check(qF, m, d)(p) : p === 45 || p === 95 || lr(p) ? (o = !0, e.consume(p), f) : m(p);
  }
  function d(p) {
    return e.consume(p), a = !0, f;
  }
  function m(p) {
    return o && a && pr(r.previous) ? (e.exit("literalAutolinkEmail"), e.exit("literalAutolink"), t(p)) : n(p);
  }
}
function FF(e, t, n) {
  const r = this;
  return a;
  function a(l) {
    return l !== 87 && l !== 119 || !I7.call(r, r.previous) || V2(r.events) ? n(l) : (e.enter("literalAutolink"), e.enter("literalAutolinkWww"), e.check(LF, e.attempt(M7, e.attempt(R7, o), n), n)(l));
  }
  function o(l) {
    return e.exit("literalAutolinkWww"), e.exit("literalAutolink"), t(l);
  }
}
function $F(e, t, n) {
  const r = this;
  let a = "", o = !1;
  return l;
  function l(p) {
    return (p === 72 || p === 104) && L7.call(r, r.previous) && !V2(r.events) ? (e.enter("literalAutolink"), e.enter("literalAutolinkHttp"), a += String.fromCodePoint(p), e.consume(p), u) : n(p);
  }
  function u(p) {
    if (pr(p) && a.length < 5)
      return a += String.fromCodePoint(p), e.consume(p), u;
    if (p === 58) {
      const x = a.toLowerCase();
      if (x === "http" || x === "https")
        return e.consume(p), f;
    }
    return n(p);
  }
  function f(p) {
    return p === 47 ? (e.consume(p), o ? d : (o = !0, f)) : n(p);
  }
  function d(p) {
    return p === null || hh(p) || Wt(p) || zo(p) || Fh(p) ? n(p) : e.attempt(M7, e.attempt(R7, m), n)(p);
  }
  function m(p) {
    return e.exit("literalAutolinkHttp"), e.exit("literalAutolink"), t(p);
  }
}
function UF(e, t, n) {
  let r = 0;
  return a;
  function a(l) {
    return (l === 87 || l === 119) && r < 3 ? (r++, e.consume(l), a) : l === 46 && r === 3 ? (e.consume(l), o) : n(l);
  }
  function o(l) {
    return l === null ? n(l) : t(l);
  }
}
function HF(e, t, n) {
  let r, a, o;
  return l;
  function l(d) {
    return d === 46 || d === 95 ? e.check(z7, f, u)(d) : d === null || Wt(d) || zo(d) || d !== 45 && Fh(d) ? f(d) : (o = !0, e.consume(d), l);
  }
  function u(d) {
    return d === 95 ? r = !0 : (a = r, r = void 0), e.consume(d), l;
  }
  function f(d) {
    return a || r || !o ? n(d) : t(d);
  }
}
function GF(e, t) {
  let n = 0, r = 0;
  return a;
  function a(l) {
    return l === 40 ? (n++, e.consume(l), a) : l === 41 && r < n ? o(l) : l === 33 || l === 34 || l === 38 || l === 39 || l === 41 || l === 42 || l === 44 || l === 46 || l === 58 || l === 59 || l === 60 || l === 63 || l === 93 || l === 95 || l === 126 ? e.check(z7, t, o)(l) : l === null || Wt(l) || zo(l) ? t(l) : (e.consume(l), a);
  }
  function o(l) {
    return l === 41 && r++, e.consume(l), a;
  }
}
function VF(e, t, n) {
  return r;
  function r(u) {
    return u === 33 || u === 34 || u === 39 || u === 41 || u === 42 || u === 44 || u === 46 || u === 58 || u === 59 || u === 63 || u === 95 || u === 126 ? (e.consume(u), r) : u === 38 ? (e.consume(u), o) : u === 93 ? (e.consume(u), a) : (
      // `<` is an end.
      u === 60 || // So is whitespace.
      u === null || Wt(u) || zo(u) ? t(u) : n(u)
    );
  }
  function a(u) {
    return u === null || u === 40 || u === 91 || Wt(u) || zo(u) ? t(u) : r(u);
  }
  function o(u) {
    return pr(u) ? l(u) : n(u);
  }
  function l(u) {
    return u === 59 ? (e.consume(u), r) : pr(u) ? (e.consume(u), l) : n(u);
  }
}
function KF(e, t, n) {
  return r;
  function r(o) {
    return e.consume(o), a;
  }
  function a(o) {
    return lr(o) ? n(o) : t(o);
  }
}
function I7(e) {
  return e === null || e === 40 || e === 42 || e === 95 || e === 91 || e === 93 || e === 126 || Wt(e);
}
function L7(e) {
  return !pr(e);
}
function q7(e) {
  return !(e === 47 || $b(e));
}
function $b(e) {
  return e === 43 || e === 45 || e === 46 || e === 95 || lr(e);
}
function V2(e) {
  let t = e.length, n = !1;
  for (; t--; ) {
    const r = e[t][1];
    if ((r.type === "labelLink" || r.type === "labelImage") && !r._balanced) {
      n = !0;
      break;
    }
    if (r._gfmAutolinkLiteralWalkedInto) {
      n = !1;
      break;
    }
  }
  return e.length > 0 && !n && (e[e.length - 1][1]._gfmAutolinkLiteralWalkedInto = !0), n;
}
const YF = {
  tokenize: n$,
  partial: !0
};
function XF() {
  return {
    document: {
      91: {
        name: "gfmFootnoteDefinition",
        tokenize: JF,
        continuation: {
          tokenize: e$
        },
        exit: t$
      }
    },
    text: {
      91: {
        name: "gfmFootnoteCall",
        tokenize: ZF
      },
      93: {
        name: "gfmPotentialFootnoteCall",
        add: "after",
        tokenize: WF,
        resolveTo: QF
      }
    }
  };
}
function WF(e, t, n) {
  const r = this;
  let a = r.events.length;
  const o = r.parser.gfmFootnotes || (r.parser.gfmFootnotes = []);
  let l;
  for (; a--; ) {
    const f = r.events[a][1];
    if (f.type === "labelImage") {
      l = f;
      break;
    }
    if (f.type === "gfmFootnoteCall" || f.type === "labelLink" || f.type === "label" || f.type === "image" || f.type === "link")
      break;
  }
  return u;
  function u(f) {
    if (!l || !l._balanced)
      return n(f);
    const d = Mi(r.sliceSerialize({
      start: l.end,
      end: r.now()
    }));
    return d.codePointAt(0) !== 94 || !o.includes(d.slice(1)) ? n(f) : (e.enter("gfmFootnoteCallLabelMarker"), e.consume(f), e.exit("gfmFootnoteCallLabelMarker"), t(f));
  }
}
function QF(e, t) {
  let n = e.length;
  for (; n--; )
    if (e[n][1].type === "labelImage" && e[n][0] === "enter") {
      e[n][1];
      break;
    }
  e[n + 1][1].type = "data", e[n + 3][1].type = "gfmFootnoteCallLabelMarker";
  const r = {
    type: "gfmFootnoteCall",
    start: Object.assign({}, e[n + 3][1].start),
    end: Object.assign({}, e[e.length - 1][1].end)
  }, a = {
    type: "gfmFootnoteCallMarker",
    start: Object.assign({}, e[n + 3][1].end),
    end: Object.assign({}, e[n + 3][1].end)
  };
  a.end.column++, a.end.offset++, a.end._bufferIndex++;
  const o = {
    type: "gfmFootnoteCallString",
    start: Object.assign({}, a.end),
    end: Object.assign({}, e[e.length - 1][1].start)
  }, l = {
    type: "chunkString",
    contentType: "string",
    start: Object.assign({}, o.start),
    end: Object.assign({}, o.end)
  }, u = [
    // Take the `labelImageMarker` (now `data`, the `!`)
    e[n + 1],
    e[n + 2],
    ["enter", r, t],
    // The `[`
    e[n + 3],
    e[n + 4],
    // The `^`.
    ["enter", a, t],
    ["exit", a, t],
    // Everything in between.
    ["enter", o, t],
    ["enter", l, t],
    ["exit", l, t],
    ["exit", o, t],
    // The ending (`]`, properly parsed and labelled).
    e[e.length - 2],
    e[e.length - 1],
    ["exit", r, t]
  ];
  return e.splice(n, e.length - n + 1, ...u), e;
}
function ZF(e, t, n) {
  const r = this, a = r.parser.gfmFootnotes || (r.parser.gfmFootnotes = []);
  let o = 0, l;
  return u;
  function u(p) {
    return e.enter("gfmFootnoteCall"), e.enter("gfmFootnoteCallLabelMarker"), e.consume(p), e.exit("gfmFootnoteCallLabelMarker"), f;
  }
  function f(p) {
    return p !== 94 ? n(p) : (e.enter("gfmFootnoteCallMarker"), e.consume(p), e.exit("gfmFootnoteCallMarker"), e.enter("gfmFootnoteCallString"), e.enter("chunkString").contentType = "string", d);
  }
  function d(p) {
    if (
      // Too long.
      o > 999 || // Closing brace with nothing.
      p === 93 && !l || // Space or tab is not supported by GFM for some reason.
      // `\n` and `[` not being supported makes sense.
      p === null || p === 91 || Wt(p)
    )
      return n(p);
    if (p === 93) {
      e.exit("chunkString");
      const x = e.exit("gfmFootnoteCallString");
      return a.includes(Mi(r.sliceSerialize(x))) ? (e.enter("gfmFootnoteCallLabelMarker"), e.consume(p), e.exit("gfmFootnoteCallLabelMarker"), e.exit("gfmFootnoteCall"), t) : n(p);
    }
    return Wt(p) || (l = !0), o++, e.consume(p), p === 92 ? m : d;
  }
  function m(p) {
    return p === 91 || p === 92 || p === 93 ? (e.consume(p), o++, d) : d(p);
  }
}
function JF(e, t, n) {
  const r = this, a = r.parser.gfmFootnotes || (r.parser.gfmFootnotes = []);
  let o, l = 0, u;
  return f;
  function f(w) {
    return e.enter("gfmFootnoteDefinition")._container = !0, e.enter("gfmFootnoteDefinitionLabel"), e.enter("gfmFootnoteDefinitionLabelMarker"), e.consume(w), e.exit("gfmFootnoteDefinitionLabelMarker"), d;
  }
  function d(w) {
    return w === 94 ? (e.enter("gfmFootnoteDefinitionMarker"), e.consume(w), e.exit("gfmFootnoteDefinitionMarker"), e.enter("gfmFootnoteDefinitionLabelString"), e.enter("chunkString").contentType = "string", m) : n(w);
  }
  function m(w) {
    if (
      // Too long.
      l > 999 || // Closing brace with nothing.
      w === 93 && !u || // Space or tab is not supported by GFM for some reason.
      // `\n` and `[` not being supported makes sense.
      w === null || w === 91 || Wt(w)
    )
      return n(w);
    if (w === 93) {
      e.exit("chunkString");
      const E = e.exit("gfmFootnoteDefinitionLabelString");
      return o = Mi(r.sliceSerialize(E)), e.enter("gfmFootnoteDefinitionLabelMarker"), e.consume(w), e.exit("gfmFootnoteDefinitionLabelMarker"), e.exit("gfmFootnoteDefinitionLabel"), x;
    }
    return Wt(w) || (u = !0), l++, e.consume(w), w === 92 ? p : m;
  }
  function p(w) {
    return w === 91 || w === 92 || w === 93 ? (e.consume(w), l++, m) : m(w);
  }
  function x(w) {
    return w === 58 ? (e.enter("definitionMarker"), e.consume(w), e.exit("definitionMarker"), a.includes(o) || a.push(o), Mt(e, y, "gfmFootnoteDefinitionWhitespace")) : n(w);
  }
  function y(w) {
    return t(w);
  }
}
function e$(e, t, n) {
  return e.check(od, t, e.attempt(YF, t, n));
}
function t$(e) {
  e.exit("gfmFootnoteDefinition");
}
function n$(e, t, n) {
  const r = this;
  return Mt(e, a, "gfmFootnoteDefinitionIndent", 5);
  function a(o) {
    const l = r.events[r.events.length - 1];
    return l && l[1].type === "gfmFootnoteDefinitionIndent" && l[2].sliceSerialize(l[1], !0).length === 4 ? t(o) : n(o);
  }
}
function r$(e) {
  let n = (e || {}).singleTilde;
  const r = {
    name: "strikethrough",
    tokenize: o,
    resolveAll: a
  };
  return n == null && (n = !0), {
    text: {
      126: r
    },
    insideSpan: {
      null: [r]
    },
    attentionMarkers: {
      null: [126]
    }
  };
  function a(l, u) {
    let f = -1;
    for (; ++f < l.length; )
      if (l[f][0] === "enter" && l[f][1].type === "strikethroughSequenceTemporary" && l[f][1]._close) {
        let d = f;
        for (; d--; )
          if (l[d][0] === "exit" && l[d][1].type === "strikethroughSequenceTemporary" && l[d][1]._open && // If the sizes are the same:
          l[f][1].end.offset - l[f][1].start.offset === l[d][1].end.offset - l[d][1].start.offset) {
            l[f][1].type = "strikethroughSequence", l[d][1].type = "strikethroughSequence";
            const m = {
              type: "strikethrough",
              start: Object.assign({}, l[d][1].start),
              end: Object.assign({}, l[f][1].end)
            }, p = {
              type: "strikethroughText",
              start: Object.assign({}, l[d][1].end),
              end: Object.assign({}, l[f][1].start)
            }, x = [["enter", m, u], ["enter", l[d][1], u], ["exit", l[d][1], u], ["enter", p, u]], y = u.parser.constructs.insideSpan.null;
            y && Kr(x, x.length, 0, $h(y, l.slice(d + 1, f), u)), Kr(x, x.length, 0, [["exit", p, u], ["enter", l[f][1], u], ["exit", l[f][1], u], ["exit", m, u]]), Kr(l, d - 1, f - d + 3, x), f = d + x.length - 2;
            break;
          }
      }
    for (f = -1; ++f < l.length; )
      l[f][1].type === "strikethroughSequenceTemporary" && (l[f][1].type = "data");
    return l;
  }
  function o(l, u, f) {
    const d = this.previous, m = this.events;
    let p = 0;
    return x;
    function x(w) {
      return d === 126 && m[m.length - 1][1].type !== "characterEscape" ? f(w) : (l.enter("strikethroughSequenceTemporary"), y(w));
    }
    function y(w) {
      const E = Jl(d);
      if (w === 126)
        return p > 1 ? f(w) : (l.consume(w), p++, y);
      if (p < 2 && !n) return f(w);
      const k = l.exit("strikethroughSequenceTemporary"), C = Jl(w);
      return k._open = !C || C === 2 && !!E, k._close = !E || E === 2 && !!C, u(w);
    }
  }
}
class i$ {
  /**
   * Create a new edit map.
   */
  constructor() {
    this.map = [];
  }
  /**
   * Create an edit: a remove and/or add at a certain place.
   *
   * @param {number} index
   * @param {number} remove
   * @param {Array<Event>} add
   * @returns {undefined}
   */
  add(t, n, r) {
    a$(this, t, n, r);
  }
  // To do: add this when moving to `micromark`.
  // /**
  //  * Create an edit: but insert `add` before existing additions.
  //  *
  //  * @param {number} index
  //  * @param {number} remove
  //  * @param {Array<Event>} add
  //  * @returns {undefined}
  //  */
  // addBefore(index, remove, add) {
  //   addImplementation(this, index, remove, add, true)
  // }
  /**
   * Done, change the events.
   *
   * @param {Array<Event>} events
   * @returns {undefined}
   */
  consume(t) {
    if (this.map.sort(function(o, l) {
      return o[0] - l[0];
    }), this.map.length === 0)
      return;
    let n = this.map.length;
    const r = [];
    for (; n > 0; )
      n -= 1, r.push(t.slice(this.map[n][0] + this.map[n][1]), this.map[n][2]), t.length = this.map[n][0];
    r.push(t.slice()), t.length = 0;
    let a = r.pop();
    for (; a; ) {
      for (const o of a)
        t.push(o);
      a = r.pop();
    }
    this.map.length = 0;
  }
}
function a$(e, t, n, r) {
  let a = 0;
  if (!(n === 0 && r.length === 0)) {
    for (; a < e.map.length; ) {
      if (e.map[a][0] === t) {
        e.map[a][1] += n, e.map[a][2].push(...r);
        return;
      }
      a += 1;
    }
    e.map.push([t, n, r]);
  }
}
function s$(e, t) {
  let n = !1;
  const r = [];
  for (; t < e.length; ) {
    const a = e[t];
    if (n) {
      if (a[0] === "enter")
        a[1].type === "tableContent" && r.push(e[t + 1][1].type === "tableDelimiterMarker" ? "left" : "none");
      else if (a[1].type === "tableContent") {
        if (e[t - 1][1].type === "tableDelimiterMarker") {
          const o = r.length - 1;
          r[o] = r[o] === "left" ? "center" : "right";
        }
      } else if (a[1].type === "tableDelimiterRow")
        break;
    } else a[0] === "enter" && a[1].type === "tableDelimiterRow" && (n = !0);
    t += 1;
  }
  return r;
}
function o$() {
  return {
    flow: {
      null: {
        name: "table",
        tokenize: l$,
        resolveAll: u$
      }
    }
  };
}
function l$(e, t, n) {
  const r = this;
  let a = 0, o = 0, l;
  return u;
  function u(U) {
    let B = r.events.length - 1;
    for (; B > -1; ) {
      const q = r.events[B][1].type;
      if (q === "lineEnding" || // Note: markdown-rs uses `whitespace` instead of `linePrefix`
      q === "linePrefix") B--;
      else break;
    }
    const G = B > -1 ? r.events[B][1].type : null, re = G === "tableHead" || G === "tableRow" ? M : f;
    return re === M && r.parser.lazy[r.now().line] ? n(U) : re(U);
  }
  function f(U) {
    return e.enter("tableHead"), e.enter("tableRow"), d(U);
  }
  function d(U) {
    return U === 124 || (l = !0, o += 1), m(U);
  }
  function m(U) {
    return U === null ? n(U) : ut(U) ? o > 1 ? (o = 0, r.interrupt = !0, e.exit("tableRow"), e.enter("lineEnding"), e.consume(U), e.exit("lineEnding"), y) : n(U) : Ct(U) ? Mt(e, m, "whitespace")(U) : (o += 1, l && (l = !1, a += 1), U === 124 ? (e.enter("tableCellDivider"), e.consume(U), e.exit("tableCellDivider"), l = !0, m) : (e.enter("data"), p(U)));
  }
  function p(U) {
    return U === null || U === 124 || Wt(U) ? (e.exit("data"), m(U)) : (e.consume(U), U === 92 ? x : p);
  }
  function x(U) {
    return U === 92 || U === 124 ? (e.consume(U), p) : p(U);
  }
  function y(U) {
    return r.interrupt = !1, r.parser.lazy[r.now().line] ? n(U) : (e.enter("tableDelimiterRow"), l = !1, Ct(U) ? Mt(e, w, "linePrefix", r.parser.constructs.disable.null.includes("codeIndented") ? void 0 : 4)(U) : w(U));
  }
  function w(U) {
    return U === 45 || U === 58 ? k(U) : U === 124 ? (l = !0, e.enter("tableCellDivider"), e.consume(U), e.exit("tableCellDivider"), E) : D(U);
  }
  function E(U) {
    return Ct(U) ? Mt(e, k, "whitespace")(U) : k(U);
  }
  function k(U) {
    return U === 58 ? (o += 1, l = !0, e.enter("tableDelimiterMarker"), e.consume(U), e.exit("tableDelimiterMarker"), C) : U === 45 ? (o += 1, C(U)) : U === null || ut(U) ? A(U) : D(U);
  }
  function C(U) {
    return U === 45 ? (e.enter("tableDelimiterFiller"), T(U)) : D(U);
  }
  function T(U) {
    return U === 45 ? (e.consume(U), T) : U === 58 ? (l = !0, e.exit("tableDelimiterFiller"), e.enter("tableDelimiterMarker"), e.consume(U), e.exit("tableDelimiterMarker"), N) : (e.exit("tableDelimiterFiller"), N(U));
  }
  function N(U) {
    return Ct(U) ? Mt(e, A, "whitespace")(U) : A(U);
  }
  function A(U) {
    return U === 124 ? w(U) : U === null || ut(U) ? !l || a !== o ? D(U) : (e.exit("tableDelimiterRow"), e.exit("tableHead"), t(U)) : D(U);
  }
  function D(U) {
    return n(U);
  }
  function M(U) {
    return e.enter("tableRow"), O(U);
  }
  function O(U) {
    return U === 124 ? (e.enter("tableCellDivider"), e.consume(U), e.exit("tableCellDivider"), O) : U === null || ut(U) ? (e.exit("tableRow"), t(U)) : Ct(U) ? Mt(e, O, "whitespace")(U) : (e.enter("data"), Y(U));
  }
  function Y(U) {
    return U === null || U === 124 || Wt(U) ? (e.exit("data"), O(U)) : (e.consume(U), U === 92 ? X : Y);
  }
  function X(U) {
    return U === 92 || U === 124 ? (e.consume(U), Y) : Y(U);
  }
}
function u$(e, t) {
  let n = -1, r = !0, a = 0, o = [0, 0, 0, 0], l = [0, 0, 0, 0], u = !1, f = 0, d, m, p;
  const x = new i$();
  for (; ++n < e.length; ) {
    const y = e[n], w = y[1];
    y[0] === "enter" ? w.type === "tableHead" ? (u = !1, f !== 0 && (rS(x, t, f, d, m), m = void 0, f = 0), d = {
      type: "table",
      start: Object.assign({}, w.start),
      // Note: correct end is set later.
      end: Object.assign({}, w.end)
    }, x.add(n, 0, [["enter", d, t]])) : w.type === "tableRow" || w.type === "tableDelimiterRow" ? (r = !0, p = void 0, o = [0, 0, 0, 0], l = [0, n + 1, 0, 0], u && (u = !1, m = {
      type: "tableBody",
      start: Object.assign({}, w.start),
      // Note: correct end is set later.
      end: Object.assign({}, w.end)
    }, x.add(n, 0, [["enter", m, t]])), a = w.type === "tableDelimiterRow" ? 2 : m ? 3 : 1) : a && (w.type === "data" || w.type === "tableDelimiterMarker" || w.type === "tableDelimiterFiller") ? (r = !1, l[2] === 0 && (o[1] !== 0 && (l[0] = l[1], p = qf(x, t, o, a, void 0, p), o = [0, 0, 0, 0]), l[2] = n)) : w.type === "tableCellDivider" && (r ? r = !1 : (o[1] !== 0 && (l[0] = l[1], p = qf(x, t, o, a, void 0, p)), o = l, l = [o[1], n, 0, 0])) : w.type === "tableHead" ? (u = !0, f = n) : w.type === "tableRow" || w.type === "tableDelimiterRow" ? (f = n, o[1] !== 0 ? (l[0] = l[1], p = qf(x, t, o, a, n, p)) : l[1] !== 0 && (p = qf(x, t, l, a, n, p)), a = 0) : a && (w.type === "data" || w.type === "tableDelimiterMarker" || w.type === "tableDelimiterFiller") && (l[3] = n);
  }
  for (f !== 0 && rS(x, t, f, d, m), x.consume(t.events), n = -1; ++n < t.events.length; ) {
    const y = t.events[n];
    y[0] === "enter" && y[1].type === "table" && (y[1]._align = s$(t.events, n));
  }
  return e;
}
function qf(e, t, n, r, a, o) {
  const l = r === 1 ? "tableHeader" : r === 2 ? "tableDelimiter" : "tableData", u = "tableContent";
  n[0] !== 0 && (o.end = Object.assign({}, Vl(t.events, n[0])), e.add(n[0], 0, [["exit", o, t]]));
  const f = Vl(t.events, n[1]);
  if (o = {
    type: l,
    start: Object.assign({}, f),
    // Note: correct end is set later.
    end: Object.assign({}, f)
  }, e.add(n[1], 0, [["enter", o, t]]), n[2] !== 0) {
    const d = Vl(t.events, n[2]), m = Vl(t.events, n[3]), p = {
      type: u,
      start: Object.assign({}, d),
      end: Object.assign({}, m)
    };
    if (e.add(n[2], 0, [["enter", p, t]]), r !== 2) {
      const x = t.events[n[2]], y = t.events[n[3]];
      if (x[1].end = Object.assign({}, y[1].end), x[1].type = "chunkText", x[1].contentType = "text", n[3] > n[2] + 1) {
        const w = n[2] + 1, E = n[3] - n[2] - 1;
        e.add(w, E, []);
      }
    }
    e.add(n[3] + 1, 0, [["exit", p, t]]);
  }
  return a !== void 0 && (o.end = Object.assign({}, Vl(t.events, a)), e.add(a, 0, [["exit", o, t]]), o = void 0), o;
}
function rS(e, t, n, r, a) {
  const o = [], l = Vl(t.events, n);
  a && (a.end = Object.assign({}, l), o.push(["exit", a, t])), r.end = Object.assign({}, l), o.push(["exit", r, t]), e.add(n + 1, 0, o);
}
function Vl(e, t) {
  const n = e[t], r = n[0] === "enter" ? "start" : "end";
  return n[1][r];
}
const c$ = {
  name: "tasklistCheck",
  tokenize: f$
};
function d$() {
  return {
    text: {
      91: c$
    }
  };
}
function f$(e, t, n) {
  const r = this;
  return a;
  function a(f) {
    return (
      // Exit if theres stuff before.
      r.previous !== null || // Exit if not in the first content that is the first child of a list
      // item.
      !r._gfmTasklistFirstContentOfListItem ? n(f) : (e.enter("taskListCheck"), e.enter("taskListCheckMarker"), e.consume(f), e.exit("taskListCheckMarker"), o)
    );
  }
  function o(f) {
    return Wt(f) ? (e.enter("taskListCheckValueUnchecked"), e.consume(f), e.exit("taskListCheckValueUnchecked"), l) : f === 88 || f === 120 ? (e.enter("taskListCheckValueChecked"), e.consume(f), e.exit("taskListCheckValueChecked"), l) : n(f);
  }
  function l(f) {
    return f === 93 ? (e.enter("taskListCheckMarker"), e.consume(f), e.exit("taskListCheckMarker"), e.exit("taskListCheck"), u) : n(f);
  }
  function u(f) {
    return ut(f) ? t(f) : Ct(f) ? e.check({
      tokenize: h$
    }, t, n)(f) : n(f);
  }
}
function h$(e, t, n) {
  return Mt(e, r, "whitespace");
  function r(a) {
    return a === null ? n(a) : t(a);
  }
}
function m$(e) {
  return Xj([
    PF(),
    XF(),
    r$(e),
    o$(),
    d$()
  ]);
}
const p$ = {};
function g$(e) {
  const t = (
    /** @type {Processor<Root>} */
    this
  ), n = e || p$, r = t.data(), a = r.micromarkExtensions || (r.micromarkExtensions = []), o = r.fromMarkdownExtensions || (r.fromMarkdownExtensions = []), l = r.toMarkdownExtensions || (r.toMarkdownExtensions = []);
  a.push(m$(n)), o.push(DF()), l.push(IF(n));
}
const y$ = "Engram_project";
function x$() {
  var e, t;
  try {
    if (typeof window.getRequestHeaders == "function")
      return window.getRequestHeaders();
    const n = (t = (e = window.SillyTavern) == null ? void 0 : e.getContext) == null ? void 0 : t.call(e);
    if (n != null && n.getRequestHeaders)
      return n.getRequestHeaders();
  } catch (n) {
    console.warn("[Engram] ", n);
  }
  return {
    "Content-Type": "application/json"
  };
}
async function v$() {
  try {
    const e = x$(), t = await fetch("/api/extensions/update", {
      method: "POST",
      headers: {
        ...e,
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        extensionName: y$,
        global: !1
        // Engram 
      })
    });
    if (!t.ok)
      return { success: !1, message: await t.text() || t.statusText };
    const n = await t.json();
    return n.isUpToDate ? { success: !0, message: "", isUpToDate: !0 } : {
      success: !0,
      message: `: ${n.shortCommitHash || "latest"}`,
      isUpToDate: !1
    };
  } catch (e) {
    return console.error("[Engram] :", e), { success: !1, message: String(e) };
  }
}
const b$ = ({ isOpen: e, onClose: t }) => {
  const [n, r] = P.useState(!0), [a, o] = P.useState(null), [l, u] = P.useState(null), [f, d] = P.useState(!1), [m, p] = P.useState(!1), [x, y] = P.useState(!1), [w, E] = P.useState(null), k = Is.getCurrentVersion();
  P.useEffect(() => {
    e && (C(), E(null));
  }, [e]);
  const C = async () => {
    r(!0);
    try {
      const [D, M, O] = await Promise.all([
        Is.getLatestVersion(),
        Is.getChangelog(),
        Is.hasUpdate()
      ]);
      o(D), u(M), d(O);
    } catch (D) {
      console.error("[Engram] ", D);
    } finally {
      r(!1);
    }
  }, T = async () => {
    p(!0);
    try {
      const D = a || k;
      console.debug("[Engram] Marking update as read:", D), await Is.markAsRead(D), t();
    } finally {
      p(!1);
    }
  }, N = async () => {
    y(!0), E(null);
    try {
      const D = await v$();
      D.success && !D.isUpToDate ? (E(" 2 ..."), a && await Is.markAsRead(a), setTimeout(() => {
        window.location.reload();
      }, 2e3)) : D.isUpToDate ? (E(""), d(!1)) : E(`: ${D.message}`);
    } catch (D) {
      E(`: ${String(D)}`);
    } finally {
      y(!1);
    }
  }, A = () => {
    Is.clearCache(), C();
  };
  return e ? /* @__PURE__ */ h.jsxs("div", { className: "fixed inset-0 z-[100] flex items-center justify-center p-4", children: [
    /* @__PURE__ */ h.jsx(
      "div",
      {
        className: "absolute inset-0 bg-black/60 backdrop-blur-sm",
        onClick: t
      }
    ),
    /* @__PURE__ */ h.jsxs("div", { className: "relative bg-card border border-border rounded-xl shadow-2xl w-full max-w-lg max-h-[80vh] flex flex-col overflow-hidden animate-in zoom-in-95 duration-200", children: [
      /* @__PURE__ */ h.jsxs("div", { className: "flex items-center justify-between px-5 py-4 border-b border-border/50", children: [
        /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-3", children: [
          /* @__PURE__ */ h.jsx("div", { className: "w-8 h-8 rounded-lg bg-primary/10 flex items-center justify-center", children: /* @__PURE__ */ h.jsx(Dc, { size: 16, className: "text-primary" }) }),
          /* @__PURE__ */ h.jsxs("div", { children: [
            /* @__PURE__ */ h.jsx("h2", { className: "text-base font-semibold text-foreground", children: "" }),
            /* @__PURE__ */ h.jsxs("p", { className: "text-xs text-muted-foreground", children: [
              ": v",
              k
            ] })
          ] })
        ] }),
        /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-2", children: [
          /* @__PURE__ */ h.jsx(
            "button",
            {
              onClick: A,
              className: "p-2 rounded-lg hover:bg-muted/50 text-muted-foreground hover:text-foreground transition-colors",
              title: "",
              children: /* @__PURE__ */ h.jsx(zn, { size: 16, className: n ? "animate-spin" : "" })
            }
          ),
          /* @__PURE__ */ h.jsx(
            "button",
            {
              onClick: t,
              className: "p-2 rounded-lg hover:bg-muted/50 text-muted-foreground hover:text-foreground transition-colors",
              children: /* @__PURE__ */ h.jsx(cu, { size: 16 })
            }
          )
        ] })
      ] }),
      /* @__PURE__ */ h.jsx("div", { className: "flex-1 overflow-y-auto p-5", children: n ? /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col items-center justify-center py-12 text-muted-foreground", children: [
        /* @__PURE__ */ h.jsx(zn, { size: 24, className: "animate-spin mb-3" }),
        /* @__PURE__ */ h.jsx("p", { className: "text-sm", children: "..." })
      ] }) : /* @__PURE__ */ h.jsxs("div", { className: "space-y-4", children: [
        /* @__PURE__ */ h.jsx("div", { className: `
                                p-4 rounded-lg border
                                ${f ? "bg-primary/5 border-primary/20" : "bg-green-500/5 border-green-500/20"}
                            `, children: /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-3", children: [
          f ? /* @__PURE__ */ h.jsx(Dc, { size: 20, className: "text-primary" }) : /* @__PURE__ */ h.jsx(g2, { size: 20, className: "text-green-500" }),
          /* @__PURE__ */ h.jsxs("div", { className: "flex-1", children: [
            /* @__PURE__ */ h.jsx("p", { className: "font-medium text-foreground", children: f ? `: v${a}` : "" }),
            /* @__PURE__ */ h.jsx("p", { className: "text-xs text-muted-foreground mt-0.5", children: f ? "" : "" })
          ] })
        ] }) }),
        w && /* @__PURE__ */ h.jsx("div", { className: `
                                    p-3 rounded-lg text-sm
                                    ${w.includes("") ? "bg-green-500/10 text-green-600 border border-green-500/20" : w.includes("") || w.includes("") ? "bg-red-500/10 text-red-600 border border-red-500/20" : "bg-muted/30 text-muted-foreground"}
                                `, children: w }),
        l && /* @__PURE__ */ h.jsxs("div", { className: "space-y-2", children: [
          /* @__PURE__ */ h.jsx("h3", { className: "text-xs font-medium text-muted-foreground uppercase tracking-wider", children: "" }),
          /* @__PURE__ */ h.jsx("div", { className: "bg-muted/20 rounded-lg p-4 max-h-64 overflow-y-auto engram-changelog-content text-sm", children: /* @__PURE__ */ h.jsx(rB, { remarkPlugins: [g$], children: l }) })
        ] }),
        !l && !n && /* @__PURE__ */ h.jsx("div", { className: "text-center py-8 text-muted-foreground", children: /* @__PURE__ */ h.jsx("p", { className: "text-sm", children: "" }) })
      ] }) }),
      /* @__PURE__ */ h.jsxs("div", { className: "px-5 py-4 border-t border-border/50 flex justify-end gap-3", children: [
        /* @__PURE__ */ h.jsx(
          "button",
          {
            onClick: t,
            className: "px-4 py-2 text-sm text-muted-foreground hover:text-foreground transition-colors",
            children: ""
          }
        ),
        f && /* @__PURE__ */ h.jsxs(h.Fragment, { children: [
          /* @__PURE__ */ h.jsx(
            "button",
            {
              onClick: T,
              disabled: m || x,
              className: "px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg transition-colors disabled:opacity-50",
              children: ""
            }
          ),
          /* @__PURE__ */ h.jsx(
            "button",
            {
              onClick: N,
              disabled: x || m,
              className: "px-4 py-2 text-sm bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50 flex items-center gap-2",
              children: x ? /* @__PURE__ */ h.jsxs(h.Fragment, { children: [
                /* @__PURE__ */ h.jsx(Ka, { size: 14, className: "animate-spin" }),
                "..."
              ] }) : /* @__PURE__ */ h.jsxs(h.Fragment, { children: [
                /* @__PURE__ */ h.jsx(Dc, { size: 14 }),
                ""
              ] })
            }
          )
        ] })
      ] })
    ] })
  ] }) : null;
}, w$ = ({ children: e, activeTab: t, setActiveTab: n, onClose: r }) => {
  const [a, o] = P.useState(!1), [l, u] = P.useState(!1), [f, d] = P.useState(!1);
  P.useEffect(() => {
    (async () => {
      try {
        const y = await Is.hasUnreadUpdate();
        d(y);
      } catch (y) {
        console.debug("[Engram] ", y);
      }
    })();
  }, []);
  const m = () => {
    u(!0);
  }, p = () => {
    u(!1), d(!1);
  };
  return /* @__PURE__ */ h.jsxs("div", { className: "flex absolute inset-0 w-full h-full bg-background text-foreground overflow-hidden font-sans selection:bg-primary/30 selection:text-primary animate-in fade-in duration-300", id: "engram-layout-root", children: [
    /* @__PURE__ */ h.jsx(_R, {}),
    /* @__PURE__ */ h.jsx(
      b$,
      {
        isOpen: l,
        onClose: p
      }
    ),
    /* @__PURE__ */ h.jsx(
      m_,
      {
        activeTab: t,
        onNavigate: n,
        isMobile: !1,
        onShowUpdateNotice: m,
        hasUnreadUpdate: f
      }
    ),
    /* @__PURE__ */ h.jsx(
      m_,
      {
        activeTab: t,
        onNavigate: n,
        isMobile: !0,
        isOpen: a,
        onClose: () => o(!1),
        onShowUpdateNotice: m,
        hasUnreadUpdate: f
      }
    ),
    /* @__PURE__ */ h.jsxs("div", { className: "flex flex-1 flex-col overflow-hidden", children: [
      /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col flex-shrink-0 border-b border-border bg-sidebar/95 backdrop-blur z-50 transition-all duration-300", children: [
        /* @__PURE__ */ h.jsx(
          HD,
          {
            onToggleSidebar: () => o(!a),
            isMobile: !1,
            onClose: r,
            onNavigate: (x) => n(x.replace("/", ""))
          }
        ),
        /* @__PURE__ */ h.jsx("div", { id: "engram-header-extension", className: "z-40 flex-shrink-0 bg-transparent transition-all empty:hidden" })
      ] }),
      /* @__PURE__ */ h.jsx("main", { className: "flex-1 flex flex-col relative w-full overflow-hidden bg-background", children: /* @__PURE__ */ h.jsx("div", { className: "flex-1 overflow-y-auto overflow-x-hidden pt-0 px-4 pb-4 md:px-8 md:pb-8 lg:px-12 lg:pb-12 scroll-smooth animate-blur-in fill-mode-both", style: { animationDelay: "200ms", animationFillMode: "both" }, children: /* @__PURE__ */ h.jsx("div", { className: "max-w-6xl mx-auto min-h-full pb-20", children: e }) }) })
    ] }),
    "  "
  ] });
}, Vi = {
  primary: "#FFFFFF",
  grid: "#111111"
}, _$ = ({ onComplete: e }) => {
  const t = P.useRef(null), n = P.useRef(null), r = P.useRef(null), a = P.useRef(null), [o, l] = P.useState(!1);
  P.useEffect(() => {
    if (window.gsap) {
      l(!0);
      return;
    }
    const f = document.createElement("script");
    f.src = "https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js", f.async = !0, f.onload = () => l(!0), document.body.appendChild(f);
  }, []);
  const u = () => {
    var y;
    if (!o || !n.current) return;
    const f = window.gsap, d = n.current, m = d.getTotalLength();
    f.set(d, {
      strokeDasharray: m,
      strokeDashoffset: m,
      stroke: Vi.primary,
      fillOpacity: 0,
      opacity: 1,
      strokeWidth: 2
    });
    const p = (y = r.current) == null ? void 0 : y.querySelectorAll("path");
    p && f.set(p, { opacity: 0, y: 10 }), f.set(a.current, { scale: 1, opacity: 1 }), f.set(t.current, { opacity: 1 });
    const x = f.timeline({
      onComplete: () => {
        f.to(t.current, {
          opacity: 0,
          duration: 0.8,
          ease: "power2.out",
          onComplete: e
        });
      }
    });
    x.to(d, {
      strokeDashoffset: 0,
      duration: 2.5,
      ease: "power2.inOut"
    }), p && x.to(p, {
      opacity: 1,
      y: 0,
      duration: 1.2,
      stagger: 0.08,
      ease: "power3.out"
    }, "-=0.8"), x.to({}, { duration: 1 });
  };
  return P.useEffect(() => {
    if (o) {
      const f = setTimeout(u, 800);
      return () => clearTimeout(f);
    }
  }, [o]), /* @__PURE__ */ h.jsxs(
    "div",
    {
      ref: t,
      className: "fixed inset-0 z-[200] flex flex-col items-center justify-center bg-black overflow-hidden",
      style: { touchAction: "none" },
      children: [
        /* @__PURE__ */ h.jsx(
          "div",
          {
            className: "absolute inset-0 pointer-events-none",
            style: {
              backgroundImage: `
                        linear-gradient(to right, ${Vi.grid} 1px, transparent 1px),
                        linear-gradient(to bottom, ${Vi.grid} 1px, transparent 1px)
                    `,
              backgroundSize: "40px 40px",
              opacity: 0.3
            }
          }
        ),
        /* @__PURE__ */ h.jsx(
          "div",
          {
            className: "absolute inset-0 pointer-events-none",
            style: { background: "radial-gradient(circle at center, transparent 0%, black 100%)", opacity: 0.9 }
          }
        ),
        /* @__PURE__ */ h.jsxs("div", { className: "z-10 relative flex flex-col items-center justify-center w-full h-full p-4", children: [
          /* @__PURE__ */ h.jsx("div", { className: "w-full max-w-[600px] md:max-w-[800px] aspect-[4/3]", children: /* @__PURE__ */ h.jsx(
            "svg",
            {
              version: "1.1",
              xmlns: "http://www.w3.org/2000/svg",
              viewBox: "250 0 550 600",
              className: "w-full h-full overflow-visible",
              children: /* @__PURE__ */ h.jsxs("g", { ref: a, className: "origin-center", children: [
                /* @__PURE__ */ h.jsx(
                  "path",
                  {
                    ref: n,
                    fill: "none",
                    stroke: Vi.primary,
                    strokeWidth: "2",
                    strokeLinecap: "round",
                    strokeLinejoin: "round",
                    d: "M463.360840,364.455627 C437.246704,381.338409 406.466644,366.209045 404.026672,335.650848 C402.910156,321.667206 412.549713,306.544678 426.813293,300.633850 C430.474335,299.116699 431.826355,297.290924 431.760071,293.302460 C431.519287,278.808716 431.584564,264.307892 431.718292,249.811417 C431.748169,246.574463 430.886292,244.713684 427.681274,243.389038 C412.366425,237.059357 404.237366,225.144638 404.208862,208.867447 C404.179871,192.298615 412.621979,180.486938 428.224701,174.293686 C430.850494,173.251419 431.710938,171.751862 431.696136,169.060089 C431.613586,154.062912 431.568054,139.064117 431.723419,124.068092 C431.759430,120.590492 430.119568,119.052467 427.243103,117.790627 C413.349915,111.695946 405.841095,101.009903 404.195740,85.916542 C402.099884,66.690948 418.566650,47.364159 437.884277,46.682220 C456.888519,46.011345 468.064789,52.989845 476.252197,70.840332 C477.174438,72.851059 478.313995,73.541710 480.422974,73.516098 C499.569031,73.283493 518.722961,73.393646 537.862915,73.456795 C545.529785,73.482086 549.225952,71.767975 552.791809,64.663139 C559.898376,50.503635 576.618042,43.921410 592.447876,47.234680 C608.699890,50.636322 619.276489,62.116261 621.438904,78.701805 C623.839478,97.113228 612.679382,114.371338 595.357910,119.034004 C577.219604,123.916542 558.125427,115.204048 550.887390,98.365906 C549.251465,94.560234 547.316284,93.116508 543.150696,93.160004 C522.989380,93.370483 502.824707,93.284561 482.661285,93.261726 C479.716156,93.258385 477.395905,93.379341 475.956635,96.902077 C474.571899,100.291283 475.702576,102.070137 477.892181,104.225159 C501.524139,127.483910 525.127991,150.771423 548.653259,174.137985 C550.803162,176.273376 552.520325,176.380997 555.207153,175.171799 C569.642334,168.675354 583.205750,171.177368 594.759277,181.252563 C606.783813,191.738449 610.379395,205.504944 605.248840,220.725037 C600.321167,235.343246 589.568848,243.345337 574.305420,245.467117 C567.655396,246.391541 561.334045,245.373352 555.347839,242.591797 C552.373169,241.209595 550.274536,241.303284 547.832886,243.728531 C524.197693,267.205322 500.499634,290.619415 476.704651,313.934174 C474.165771,316.421844 475.106598,318.487793 476.015411,321.059723 C476.869354,323.476318 478.159149,324.356232 480.796143,324.332367 C501.456360,324.145294 522.118530,324.019531 542.778870,324.122131 C546.987793,324.143005 549.216675,322.931549 551.044983,318.871887 C558.230042,302.918091 576.073181,294.652069 593.497131,298.684143 C610.451355,302.607544 622.335205,317.668091 622.119812,334.958160 C621.900024,352.608002 609.316650,367.564362 591.822144,370.969543 C574.585754,374.324463 557.004028,364.861755 550.521484,348.456757 C549.268677,345.286346 547.631836,344.200745 544.294861,344.220337 C523.465576,344.342865 502.634888,344.322540 481.805359,344.218109 C478.697174,344.202545 476.993927,345.152252 475.888916,348.205902 C473.513214,354.771179 469.417969,360.183167 463.360840,364.455627 M472.733368,188.880936 C473.545441,190.333145 474.799072,191.702774 475.088898,193.252655 C476.058929,198.439468 479.434326,198.919983 483.888489,198.861130 C499.042145,198.660889 514.201233,198.707901 529.355957,198.872879 C532.819580,198.910583 534.700989,197.913788 536.177185,194.588806 C537.657104,191.255417 536.060120,189.735016 534.097900,187.805573 C510.706268,164.804840 487.354065,141.764008 463.949341,118.776604 C462.445251,117.299316 461.277863,114.441566 458.282349,116.423027 C455.343719,118.366882 451.028107,118.406143 451.180542,123.994591 C451.584534,138.807007 451.429443,153.638779 451.250458,168.459885 C451.208984,171.894135 452.474548,173.487930 455.559784,174.673798 C462.566864,177.367126 468.343140,181.758774 472.733368,188.880936 M457.308807,300.958954 C460.540070,302.823181 462.218414,300.310028 464.063263,298.488586 C487.164032,275.681519 510.248199,252.857559 533.326538,230.027756 C535.300171,228.075378 537.458679,226.516449 535.970032,222.843750 C534.495117,219.205124 532.067688,218.878906 528.898010,218.890778 C513.414001,218.948746 497.929138,219.002151 482.445862,218.887329 C478.998230,218.861771 477.090668,219.941055 475.670502,223.284790 C471.742218,232.533905 465.159332,239.474701 455.665497,243.103836 C452.239746,244.413376 451.216278,246.302231 451.253540,249.781387 C451.406891,264.098541 451.489380,278.421356 451.223358,292.735107 C451.142975,297.059998 452.224640,299.783386 457.308807,300.958954 z"
                  }
                ),
                /* @__PURE__ */ h.jsxs("g", { ref: r, children: [
                  /* @__PURE__ */ h.jsx("path", { fill: Vi.primary, d: "M732.215698,483.876190 C732.750061,488.775055 731.110779,490.523590 726.372742,490.479736 C713.642639,490.361908 713.645874,490.566711 713.641113,477.834442 C713.638428,470.668732 713.788818,463.497284 713.552246,456.338928 C713.318970,449.278015 710.633911,445.451111 705.788818,444.403778 C698.667542,442.864441 692.689270,447.076904 692.324463,454.647736 C691.851685,464.458313 691.862549,474.305084 692.048706,484.128967 C692.137085,488.792786 690.778625,490.578705 685.827454,490.500549 C672.843933,490.295532 672.845886,490.510315 672.820435,477.502625 C672.805786,470.003754 672.887146,462.502136 672.708618,455.006927 C672.557556,448.666412 669.519653,444.981689 664.341858,444.320343 C658.234436,443.540314 653.997803,446.541077 652.162415,452.864807 C651.503052,455.136719 651.331299,457.435608 651.335754,459.781158 C651.352234,468.446747 651.306274,477.112488 651.338745,485.777985 C651.348389,488.341766 651.062439,490.138977 647.717529,490.447815 C632.733521,491.831421 632.748596,491.913239 632.764404,477.031830 C632.778870,463.366852 632.738831,449.701782 632.731445,436.036774 C632.727478,428.732941 632.735718,428.732544 640.257812,428.707031 C641.591003,428.702484 642.924194,428.695312 644.257324,428.701721 C647.429321,428.717010 651.058289,427.916016 650.925598,433.229431 C655.308960,431.486603 658.595154,429.192383 662.595154,428.377930 C670.453491,426.777832 677.619019,428.117981 683.735718,433.181641 C686.512207,435.480164 688.239807,435.373474 690.953918,433.250153 C697.176208,428.382202 704.485840,426.832367 712.194946,428.080414 C725.100098,430.169739 731.944641,439.074829 732.175659,453.896454 C732.328857,463.726379 732.212036,473.560547 732.215698,483.876190 z" }),
                  /* @__PURE__ */ h.jsx("path", { fill: Vi.primary, d: "M487.575867,485.935303 C487.614716,484.616028 487.614716,483.640503 487.614716,481.796417 C479.116760,488.238525 470.153107,489.257660 460.718079,486.787720 C454.401794,485.134186 449.163879,481.675842 445.200134,476.457642 C436.960876,465.610748 437.295532,448.722229 445.889771,438.315796 C455.451538,426.737823 470.295227,425.042450 488.444458,433.733826 C487.913239,428.612457 491.194366,428.604004 494.772766,428.684540 C508.272736,428.988373 506.179840,426.849945 506.294434,440.421967 C506.411133,454.245575 506.366882,468.071228 506.299957,481.895538 C506.205750,501.359833 494.742065,512.847900 475.259460,513.370544 C465.272614,513.638489 455.717651,512.255005 446.682343,507.725311 C443.034790,505.896667 441.336151,503.847290 444.229065,500.105438 C444.329590,499.975464 444.390869,499.814941 444.469086,499.667908 C448.861603,491.411743 448.894196,491.340729 457.207886,495.157196 C463.352356,497.977905 469.817169,498.376801 476.285126,497.456818 C482.543640,496.566620 486.238434,492.476532 487.575867,485.935303 M469.264740,471.577881 C471.084900,471.642700 472.915710,471.865356 474.723328,471.743805 C481.074341,471.316620 486.258820,466.628052 487.489288,460.346558 C488.669373,454.322296 485.713593,448.118378 480.288971,445.234039 C472.426056,441.053253 462.868591,443.867035 459.399658,451.384033 C455.705688,459.388580 459.382996,467.492737 469.264740,471.577881 z" }),
                  /* @__PURE__ */ h.jsx("path", { fill: Vi.primary, d: "M350.790619,410.644409 C354.007477,410.561554 355.147522,411.945587 355.144592,414.620361 C355.128937,428.846375 356.152588,426.165161 344.558044,426.338898 C335.900940,426.468628 327.237854,426.493591 318.582581,426.315826 C314.804382,426.238220 313.157715,427.376373 313.262451,431.424896 C313.571655,443.375275 312.019470,441.570435 323.204529,441.691742 C330.530579,441.771271 337.860626,441.831665 345.183899,441.671692 C348.853607,441.591553 350.203705,443.056824 350.190338,446.675842 C350.143219,459.433014 350.725433,457.207275 340.024445,457.368561 C332.865692,457.476471 325.700195,457.536346 318.545349,457.339996 C314.731018,457.235291 313.250702,458.478516 313.234222,462.478668 C313.185364,474.308960 313.038177,474.321259 324.813477,474.130890 C334.298523,473.977539 343.772430,475.169159 353.264343,474.338776 C354.864075,474.198792 356.466827,474.576569 356.702301,476.439850 C357.203217,480.403656 357.364838,484.405273 356.646729,488.365631 C356.297211,490.293060 354.652405,490.369568 353.118927,490.370575 C334.801880,490.382568 316.484711,490.350647 298.167847,490.412506 C295.104187,490.422852 294.024323,488.921082 294.024200,486.130402 C294.023224,462.484924 294.047699,438.839325 293.967896,415.194092 C293.954620,411.261261 296.028046,410.593658 299.359711,410.610138 C316.344330,410.694275 333.329620,410.638672 350.790619,410.644409 z" }),
                  /* @__PURE__ */ h.jsx("path", { fill: Vi.primary, d: "M620.003906,453.402435 C620.062195,464.023071 619.882812,474.188721 620.189575,484.339661 C620.338318,489.262421 618.431458,490.973572 613.757507,490.452362 C611.783386,490.232208 609.754700,490.291412 607.767883,490.444916 C604.889648,490.667267 602.478821,490.168823 601.296570,486.513000 C594.831909,490.991821 587.888184,491.843719 580.600464,491.328247 C565.916626,490.289642 557.201233,476.053131 563.502625,463.374390 C565.502930,459.349640 568.872803,457.136932 572.794861,455.506927 C578.118103,453.294647 583.702881,452.709900 589.425354,452.731232 C592.879822,452.744110 596.387085,453.235260 599.791443,452.317169 C599.855774,446.843750 597.260681,443.903503 591.552673,443.177338 C585.446533,442.400513 579.495911,443.228607 574.179382,446.386688 C570.948853,448.305603 569.535645,447.214966 568.011658,444.340485 C563.043945,434.970917 563.058899,434.663818 573.199219,430.800537 C582.143921,427.392792 591.347961,426.734100 600.678101,428.904358 C613.358643,431.853943 619.173157,440.405762 620.003906,453.402435 M582.869263,466.083313 C579.496887,469.605530 579.013306,473.431427 581.947998,475.906952 C585.513611,478.914764 589.714966,478.291107 593.721985,477.031647 C597.412354,475.871704 599.990784,473.365112 600.658081,469.369629 C601.070496,466.900665 600.409729,465.044220 597.411255,465.098297 C592.800171,465.181488 588.157471,464.530182 582.869263,466.083313 z" }),
                  /* @__PURE__ */ h.jsx("path", { fill: Vi.primary, d: "M410.915314,457.280090 C410.311127,447.930115 406.925934,444.198608 399.452026,444.194855 C391.667114,444.190948 386.727997,448.953094 386.409271,457.536652 C386.075653,466.521088 386.068634,475.532593 386.350006,484.518738 C386.494904,489.147247 384.896912,490.532959 380.337830,490.481964 C367.440552,490.337616 367.627808,490.513641 367.533173,477.713593 C367.426025,463.226135 368.160004,448.728760 367.168365,434.251617 C366.898468,430.311462 368.239288,428.249725 372.529694,428.668640 C374.840057,428.894196 377.203857,428.868896 379.519684,428.673553 C383.194244,428.363556 385.817352,429.188293 385.487488,434.182526 C390.858826,430.844635 395.856995,428.304504 401.601257,427.794434 C418.292908,426.312286 429.386810,436.518799 429.975342,454.379517 C430.315308,464.696716 429.971527,475.035126 430.046204,485.363190 C430.071198,488.817627 428.985992,490.534210 425.145325,490.442291 C408.307220,490.039520 411.204895,492.848450 410.942963,476.734924 C410.840088,470.406036 410.927368,464.074036 410.915314,457.280090 z" }),
                  /* @__PURE__ */ h.jsx("path", { fill: Vi.primary, d: "M556.799500,444.921539 C554.214233,445.227783 552.026184,445.174683 549.913574,445.548401 C542.544189,446.852142 538.560974,452.210632 538.387756,461.266998 C538.231995,469.411011 538.239258,477.561676 538.377136,485.705963 C538.433838,489.055634 537.355591,490.537964 533.812988,490.447296 C516.656677,490.008148 519.942505,492.939087 519.712585,476.823181 C519.510925,462.693848 519.801025,448.557343 519.590698,434.428253 C519.527222,430.165985 520.732788,428.169983 525.216187,428.665833 C527.350830,428.901917 529.549255,428.854156 531.692566,428.654297 C535.487610,428.300446 537.940002,429.350586 537.432373,434.447845 C542.475464,431.817810 546.689819,428.862549 551.859985,428.147003 C557.409912,427.378845 558.504028,428.019318 558.285950,433.612213 C558.141113,437.327057 559.514648,441.236115 556.799500,444.921539 z" })
                ] })
              ] })
            }
          ) }),
          /* @__PURE__ */ h.jsx("p", { className: "mt-6 md:mt-8 text-white/30 text-xs md:text-sm tracking-widest uppercase", children: "Where memories leave their trace" })
        ] })
      ]
    }
  );
}, Jn = ({
  checked: e,
  onChange: t,
  disabled: n = !1,
  className: r = "",
  id: a
}) => {
  const o = (l) => {
    n || (l.stopPropagation(), t(!e));
  };
  return /* @__PURE__ */ h.jsx(
    "button",
    {
      type: "button",
      role: "switch",
      id: a,
      "aria-checked": e,
      onClick: o,
      disabled: n,
      className: `
                relative inline-flex h-3.5 w-9 shrink-0 cursor-pointer items-center rounded-full border transition-all duration-300 focus:outline-none
                ${e ? "bg-primary/20 border-primary/50 shadow-[0_0_10px_rgba(var(--primary),0.2)]" : "bg-black/20 border-border shadow-inner"}
                ${n ? "opacity-50 cursor-not-allowed" : ""}
                ${r}
            `,
      children: /* @__PURE__ */ h.jsx(
        "span",
        {
          className: `
                    pointer-events-none inline-block h-2.5 w-2.5 transform rounded-full shadow-sm ring-0 transition-all duration-300 cubic-bezier(0.34, 1.56, 0.64, 1)
                    ${e ? "bg-primary shadow-[0_0_8px_rgba(var(--primary),0.8)] border border-primary-foreground/20" : "bg-muted-foreground border border-transparent opacity-60"}
                `,
          style: { transform: e ? "translateX(24px)" : "translateX(2px)" }
        }
      )
    }
  );
}, S$ = {
  none: "",
  sm: "my-2",
  md: "my-4",
  lg: "my-6"
}, Fn = ({
  orientation: e = "horizontal",
  length: t = 100,
  className: n = "",
  responsive: r = !1,
  spacing: a = "none"
}) => {
  const o = S$[a];
  return r ? /* @__PURE__ */ h.jsxs(h.Fragment, { children: [
    /* @__PURE__ */ h.jsx(
      "div",
      {
        className: `hidden lg:block absolute left-0 top-1/2 -translate-y-1/2 border-l border-border ${n}`,
        style: { height: `${t}%` }
      }
    ),
    /* @__PURE__ */ h.jsx(
      "div",
      {
        className: `lg:hidden border-t border-border/30 mx-auto ${o} ${n}`,
        style: { width: `${t}%` }
      }
    )
  ] }) : e === "vertical" ? /* @__PURE__ */ h.jsx(
    "div",
    {
      className: `border-l border-border/30 mx-auto ${n}`,
      style: { height: `${t}%` }
    }
  ) : /* @__PURE__ */ h.jsx(
    "div",
    {
      className: `border-t border-border/30 ${o} ${n}`,
      style: { width: `${t}%` }
    }
  );
};
var bo = /* @__PURE__ */ ((e) => (e.Character = "char", e.Location = "loc", e.Item = "item", e.Concept = "concept", e.Unknown = "unknown", e))(bo || {});
const Cc = {
  last_summarized_floor: 0,
  token_usage_accumulated: 0,
  last_compressed_at: 0,
  active_summary_order: 9e3,
  last_extracted_floor: 0
}, Hg = "scope_state", iS = "character_name";
class P7 {
  constructor() {
    nt(this, "currentChatId", null);
    nt(this, "currentDb", null);
  }
  /**
   * 
   *  ST  chatId
   */
  getCurrentDb() {
    const t = or();
    return t ? (t !== this.currentChatId && (this.currentChatId = t, this.currentDb = jo(t), console.debug(`[ChatManager] Switched to database: Engram_${t}`)), this.currentDb) : (console.warn("[ChatManager] No chat_id available"), null);
  }
  /**
   *  chatId
   */
  getCurrentChatId() {
    return or();
  }
  /**
   * 
   */
  getCharacterName() {
    var t;
    return ((t = Hc()) == null ? void 0 : t.name) || "Unknown";
  }
  /**
   * 
   */
  async getState() {
    const t = this.getCurrentDb();
    if (!t) return Cc;
    try {
      const n = await t.meta.get(Hg);
      return n != null && n.value ? { ...Cc, ...n.value } : Cc;
    } catch (n) {
      return console.error("[ChatManager] Failed to get state:", n), Cc;
    }
  }
  /**
   * 
   */
  async updateState(t) {
    const n = this.getCurrentDb();
    if (n)
      try {
        const a = { ...await this.getState(), ...t };
        await n.meta.put({ key: Hg, value: a });
      } catch (r) {
        console.error("[ChatManager] Failed to update state:", r);
      }
  }
  /**
   *  UI 
   */
  async saveCharacterName() {
    const t = this.getCurrentDb();
    if (!t) return;
    const n = this.getCharacterName();
    await t.meta.put({ key: iS, value: n });
  }
  /**
   * 
   */
  async getSavedCharacterName() {
    const t = this.getCurrentDb();
    if (!t) return "Unknown";
    const n = await t.meta.get(iS);
    return (n == null ? void 0 : n.value) || "Unknown";
  }
  /**
   * Debug/Dev only
   */
  async resetState() {
    const t = this.getCurrentDb();
    t && await t.meta.put({ key: Hg, value: Cc });
  }
}
const To = new P7(), C$ = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  ChatManager: P7,
  chatManager: To
}, Symbol.toStringTag, { value: "Module" })), Ni = {
  // 
  MESSAGE_SENT: "message_sent",
  MESSAGE_RECEIVED: "message_received",
  MESSAGE_EDITED: "message_edited",
  MESSAGE_DELETED: "message_deleted",
  MESSAGE_UPDATED: "message_updated",
  MESSAGE_SWIPED: "message_swiped",
  USER_MESSAGE_RENDERED: "user_message_rendered",
  CHARACTER_MESSAGE_RENDERED: "character_message_rendered",
  // 
  CHAT_CHANGED: "chat_id_changed",
  CHAT_CREATED: "chat_created",
  CHAT_DELETED: "chat_deleted",
  // 
  GENERATION_STARTED: "generation_started",
  GENERATION_STOPPED: "generation_stopped",
  GENERATION_ENDED: "generation_ended",
  GENERATION_AFTER_COMMANDS: "GENERATION_AFTER_COMMANDS",
  STREAM_TOKEN_RECEIVED: "stream_token_received",
  // V0.7: RAG  -  prompt await  handler 
  GENERATE_BEFORE_COMBINE_PROMPTS: "generate_before_combine_prompts",
  GENERATE_AFTER_COMBINE_PROMPTS: "generate_after_combine_prompts",
  GENERATE_AFTER_DATA: "generate_after_data",
  // V0.8: Chat Completion  ()
  CHAT_COMPLETION_PROMPT_READY: "chat_completion_prompt_ready",
  CHAT_COMPLETION_SETTINGS_READY: "chat_completion_settings_ready",
  // 
  WORLDINFO_UPDATED: "worldinfo_updated",
  WORLDINFO_SETTINGS_UPDATED: "worldinfo_settings_updated",
  WORLDINFO_ENTRIES_LOADED: "worldinfo_entries_loaded",
  WORLD_INFO_ACTIVATED: "world_info_activated",
  // 
  APP_READY: "app_ready",
  SETTINGS_LOADED: "settings_loaded",
  SETTINGS_LOADED_AFTER: "settings_loaded_after",
  EXTENSION_SETTINGS_LOADED: "extension_settings_loaded",
  // 
  CHARACTER_EDITED: "character_edited",
  CHARACTER_DELETED: "characterDeleted",
  // 
  ENGRAM_REQUEST_REVISION: "engram:request_revision"
};
function Pl() {
  try {
    const e = window.SillyTavern;
    if (e != null && e.getContext) {
      const t = e.getContext();
      return (t == null ? void 0 : t.eventSource) || null;
    }
    return null;
  } catch {
    return console.warn("[Engram] EventBus:  SillyTavern eventSource"), null;
  }
}
class di {
  /**
   * 
   * @param event 
   * @param callback 
   * @returns 
   */
  static on(t, n) {
    const r = Pl();
    return r && r.on(t, n), this.listeners.has(t) || this.listeners.set(t, /* @__PURE__ */ new Set()), this.listeners.get(t).add(n), () => {
      this.off(t, n);
    };
  }
  /**
   * 
   * @param event 
   * @param callback 
   */
  static once(t, n) {
    const r = Pl();
    if (r)
      r.once(t, n);
    else {
      const a = (...o) => {
        this.off(t, a), n(...o);
      };
      this.on(t, a);
    }
  }
  /**
   * 
   * @param event 
   * @param callback 
   */
  static off(t, n) {
    var a;
    const r = Pl();
    r && r.removeListener(t, n), (a = this.listeners.get(t)) == null || a.delete(n);
  }
  /**
   * 
   * @param event 
   * @param args 
   */
  static async emit(t, ...n) {
    const r = Pl();
    if (r)
      return r.emit(t, ...n);
  }
  /**
   * 
   * 
   */
  static clearAll() {
    const t = Pl();
    for (const [n, r] of this.listeners)
      for (const a of r)
        t && t.removeListener(n, a);
    this.listeners.clear();
  }
  /**
   *  EventBus 
   */
  static isAvailable() {
    return Pl() !== null;
  }
}
nt(di, "listeners", /* @__PURE__ */ new Map());
const E$ = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  EventBus: di,
  TavernEventType: Ni
}, Symbol.toStringTag, { value: "Module" }));
function k$(e, t) {
  let n = "assistant";
  return e.is_user ? n = "user" : e.is_system && (n = "system"), {
    id: t,
    role: n,
    content: e.mes || "",
    name: e.name || "",
    isHidden: e.is_hidden ?? !1,
    raw: e
  };
}
class B7 {
  /**
   * 
   * @param options 
   */
  static getAllMessages(t = {}) {
    const n = Ga();
    if (!(n != null && n.chat))
      return [];
    let r = n.chat.map((a, o) => k$(a, o));
    if (t.includeHidden || (r = r.filter((a) => !a.isHidden)), t.role) {
      const a = Array.isArray(t.role) ? t.role : [t.role];
      r = r.filter((o) => a.includes(o.role));
    }
    return r;
  }
  /**
   *  N 
   * @param count 
   * @param options 
   */
  static getRecentMessages(t, n = {}) {
    return this.getAllMessages(n).slice(-t);
  }
  /**
   * 
   * @param start 
   * @param end 
   * @param options 
   */
  static getMessages(t, n, r = {}) {
    return this.getAllMessages(r).slice(t, n);
  }
  /**
   * 
   * @param options 
   */
  static getFloorCount(t = {}) {
    return this.getAllMessages(t).length;
  }
  /**
   * 
   * @param options 
   */
  static getLastMessage(t = {}) {
    const n = this.getAllMessages(t);
    return n.length > 0 ? n[n.length - 1] : null;
  }
  /**
   * 
   */
  static getCurrentCharacterName() {
    var n;
    const t = Ga();
    return !(t != null && t.characters) || t.characterId < 0 ? null : ((n = t.characters[t.characterId]) == null ? void 0 : n.name) || null;
  }
  /**
   *  LLM
   * @param messages 
   * @param format 
   */
  static formatMessagesAsText(t, n = "simple") {
    return n === "simple" ? t.map((r) => `${r.name}: ${r.content}`).join(`

`) : t.map((r) => `[${r.role.toUpperCase()}] ${r.name}:
${r.content}`).join(`

---

`);
  }
  /**
   *  MessageService 
   */
  static isAvailable() {
    return zD();
  }
}
const N$ = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  MessageService: B7
}, Symbol.toStringTag, { value: "Module" }));
async function aS(e) {
  try {
    const t = window.SillyTavern;
    if (t != null && t.getContext) {
      const n = t.getContext();
      if (n != null && n.getTokenCountAsync)
        return await n.getTokenCountAsync(e);
    }
    return Math.ceil(e.length / 4);
  } catch {
    return console.warn("[Engram] WorldInfoService:  Token "), Math.ceil(e.length / 4);
  }
}
function Ar() {
  try {
    return window.TavernHelper || null;
  } catch {
    return null;
  }
}
const Bc = "engram";
class zt {
  /**
   *  Token 
   * @param text 
   */
  static async countTokens(t) {
    return aS(t);
  }
  /**
   *  Engram  Token 
   * 
   * @param worldbookName 
   */
  static async countSummaryTokens(t) {
    const r = (await this.getEntries(t)).filter(
      (l) => l.enabled && l.keys.includes(Bc)
    );
    if (r.length === 0) return 0;
    const a = r.map((l) => l.content);
    return (await Promise.all(a.map((l) => this.countTokens(l)))).reduce((l, u) => l + u, 0);
  }
  /**
   *  Engram  {{engramSummaries}} 
   * 
   */
  static async getEngramSummariesContent() {
    const t = this.findExistingWorldbook();
    if (!t)
      return "";
    const r = (await this.getEntries(t)).filter((o) => o.keys.includes(Bc));
    return r.length === 0 ? "" : (r.sort((o, l) => o.order - l.order), r.map((o) => {
      const l = o.content.replace(/\{\{\/\/.*?\}\}/gs, "").trim();
      return `${o.name}
${l}`;
    }).join(`

---

`));
  }
  /**
   *  Token 
   * @param texts 
   */
  static async countTokensBatch(t) {
    return Promise.all(t.map((n) => aS(n)));
  }
  /**
   *  Engram 
   * 
   */
  static findExistingWorldbook() {
    try {
      const t = Ar();
      if (!(t != null && t.getCharWorldbookNames))
        return null;
      const n = t.getCharWorldbookNames("current");
      return n && [...n.additional || [], n.primary].filter(Boolean).find((o) => o == null ? void 0 : o.startsWith("[Engram]")) || null;
    } catch {
      return null;
    }
  }
  /**
   *  Engram 
   * 
   * ****
   * 
   *  the_world 
   * 1. TavernHelper.createWorldbook() 
   * 2. TavernHelper.getCharWorldbookNames() 
   * 3. TavernHelper.rebindCharWorldbooks() 
   */
  static async getOrCreateWorldbook() {
    var t, n;
    try {
      const r = this.findExistingWorldbook();
      if (r)
        return console.debug("[Engram] WorldInfoService: ", r), r;
      const a = Ar();
      if (!a)
        return console.warn("[Engram] WorldInfoService: TavernHelper "), null;
      const o = (n = (t = window.SillyTavern) == null ? void 0 : t.getContext) == null ? void 0 : n.call(t);
      if (!(o != null && o.name2) || o.name2 === "SillyTavern System")
        return console.warn("[Engram] WorldInfoService: "), null;
      const l = o.name2, u = `[Engram] ${l}`;
      if (console.debug("[Engram] WorldInfoService: ", u), a.createWorldbook)
        await a.createWorldbook(u);
      else
        return console.error("[Engram] WorldInfoService: TavernHelper.createWorldbook "), null;
      if (a.getCharWorldbookNames && a.rebindCharWorldbooks) {
        const f = a.getCharWorldbookNames("current");
        f && (f.additional.push(u), await a.rebindCharWorldbooks("current", f), console.info("[Engram] WorldInfoService: ", {
          character: l,
          worldbook: u
        }));
      }
      return u;
    } catch (r) {
      return console.error("[Engram] WorldInfoService: /", r), null;
    }
  }
  /**
   * @deprecated  getOrCreateWorldbook() 
   */
  static async getChatWorldbook() {
    return this.getOrCreateWorldbook();
  }
  /**
   * 
   * @param worldbookName 
   */
  static async getEntries(t) {
    const n = Ar();
    if (!(n != null && n.getWorldbook))
      return console.warn("[Engram] WorldInfoService: TavernHelper "), [];
    try {
      return (await n.getWorldbook(t)).map((a) => {
        const o = a, l = o.strategy, u = o.position, f = o.recursion, d = [];
        if (l != null && l.keys && Array.isArray(l.keys))
          for (const m of l.keys)
            typeof m == "string" ? d.push(m) : m && typeof m == "object" && "source" in m && d.push(m.source);
        return {
          uid: o.uid || 0,
          name: o.name || "",
          content: o.content || "",
          enabled: o.enabled ?? !0,
          constant: (l == null ? void 0 : l.type) === "constant",
          keys: d,
          position: (u == null ? void 0 : u.type) || "before_character_definition",
          depth: (u == null ? void 0 : u.depth) || 0,
          order: (u == null ? void 0 : u.order) || 100,
          recursion: f ? {
            prevent_incoming: f.prevent_incoming,
            prevent_outgoing: f.prevent_outgoing
          } : void 0,
          comment: o.comment || "",
          extra: o.extra || void 0
        };
      });
    } catch (r) {
      return console.error("[Engram] WorldInfoService: ", r), [];
    }
  }
  /**
   * 
   */
  static async getWorldbookNames() {
    const t = Ar();
    try {
      return t != null && t.getWorldbookNames ? t.getWorldbookNames() : [];
    } catch (n) {
      return console.error("[Engram] WorldInfoService: ", n), [];
    }
  }
  /**
   * 
   * @param worldbookName 
   */
  static async deleteWorldbook(t) {
    const n = Ar();
    if (!(n != null && n.deleteWorldbook))
      return console.warn("[Engram] WorldInfoService: TavernHelper.deleteWorldbook "), !1;
    try {
      const r = await n.deleteWorldbook(t);
      return r && console.info("[Engram] WorldInfoService: ", t), r;
    } catch (r) {
      return console.error("[Engram] WorldInfoService: ", r), !1;
    }
  }
  /**
   * 
   *  TavernHelper API the_world 
   * @param worldbookName 
   * @param params 
   */
  static async createEntry(t, n) {
    try {
      const r = Ar();
      if (!(r != null && r.createWorldbookEntries))
        return console.error("[Engram] WorldInfoService: TavernHelper.createWorldbookEntries "), !1;
      const a = {
        name: n.name,
        content: n.content,
        comment: n.name,
        // 
        disable: !(n.enabled ?? !0),
        // TavernHelper  disable 
        strategy: {
          type: n.constant ? "constant" : "selective",
          keys: n.keys || []
        },
        position: {
          type: n.position || "before_character_definition",
          order: n.order ?? 100,
          depth: n.depth ?? 4
        },
        recursion: n.recursion,
        //  Engram 
        extra: {
          engram: !0
        }
      };
      return console.debug("[Engram] WorldInfoService: ", {
        worldbook: t,
        name: n.name,
        contentLength: n.content.length
      }), await r.createWorldbookEntries(t, [a]), console.info("[Engram] WorldInfoService: ", t), !0;
    } catch (r) {
      return console.error("[Engram] WorldInfoService: ", r), !1;
    }
  }
  /**
   * 
   * @param worldbookName 
   * @param uid  UID
   * @param updates 
   */
  /**
   * 
   *  updateWorldbookWith 
   * @param worldbookName 
   * @param uid  UID
   * @param updates 
   */
  static async updateEntry(t, n, r) {
    const a = Ar();
    if (!(a != null && a.updateWorldbookWith))
      return console.warn("[Engram] WorldInfoService: TavernHelper.updateWorldbookWith "), !1;
    try {
      return await a.updateWorldbookWith(t, (o) => {
        var u;
        const l = o.findIndex((f) => f.uid === n);
        if (l !== -1) {
          const f = o[l];
          let d = f.disable;
          "enabled" in r && (d = !r.enabled);
          let m = f.strategy || { type: "selective", keys: [] };
          if ("constant" in r || "keys" in r) {
            const y = r.constant !== void 0 ? r.constant : m.type === "constant", w = r.keys !== void 0 ? r.keys : m.keys || [];
            m = {
              ...m,
              type: y ? "constant" : "selective",
              keys: w
            };
          }
          let p = f.position || { type: "before_character_definition", order: 0, depth: 0 };
          (r.position || typeof r.order == "number" || typeof r.depth == "number") && (p = {
            ...p,
            type: (typeof r.position == "string" ? r.position : (u = r.position) == null ? void 0 : u.type) || p.type,
            order: r.order ?? p.order,
            depth: r.depth ?? p.depth
          });
          let x = f.recursion;
          r.recursion && (x = r.recursion), o[l] = {
            ...f,
            name: r.name ?? f.name,
            content: r.content ?? f.content,
            comment: r.name ?? f.comment,
            // 
            disable: d,
            strategy: m,
            position: p,
            recursion: x
          }, console.debug("[Engram] WorldInfoService:  (In-Place)", { uid: n, name: o[l].name });
        } else
          console.warn("[Engram] WorldInfoService: updateEntry ", n);
        return o;
      }), !0;
    } catch (o) {
      return console.error("[Engram] WorldInfoService: ", o), !1;
    }
  }
  /**
   * 
   * @param worldbookName 
   * @param uid  UID
   */
  static async deleteEntry(t, n) {
    const r = Ar();
    if (!(r != null && r.deleteWorldbookEntries))
      return console.warn("[Engram] WorldInfoService: TavernHelper.deleteWorldbookEntries "), !1;
    try {
      return await r.deleteWorldbookEntries(t, (a) => a.uid === n), console.debug("[Engram] WorldInfoService: ", { worldbook: t, uid: n }), !0;
    } catch (a) {
      return console.error("[Engram] WorldInfoService: ", a), !1;
    }
  }
  /**
   * 
   * @param worldbookName 
   * @param uids  UID 
   */
  static async deleteEntries(t, n) {
    const r = Ar();
    if (!(r != null && r.deleteWorldbookEntries))
      return console.warn("[Engram] WorldInfoService: TavernHelper.deleteWorldbookEntries "), !1;
    try {
      const a = new Set(n);
      return await r.deleteWorldbookEntries(t, (o) => a.has(o.uid)), console.debug("[Engram] WorldInfoService: ", { worldbook: t, count: n.length }), !0;
    } catch (a) {
      return console.error("[Engram] WorldInfoService: ", a), !1;
    }
  }
  /**
   *  Engram  order 
   * 
   * @param worldbookName 
   */
  static async getSummaryEntries(t) {
    const r = (await this.getEntries(t)).filter((a) => a.keys.includes(Bc));
    return r.sort((a, o) => a.order - o.order), r;
  }
  /**
   * 
   * @param entryName  "_1-10"
   * @returns [startFloor, endFloor]  null
   */
  static parseFloorRangeFromName(t) {
    const n = t.match(/_(\d+)-(\d+)/);
    return n ? [parseInt(n[1], 10), parseInt(n[2], 10)] : null;
  }
  /**
   * 
   * 8999:  <summary>
   * 10000:  </summary>
   */
  static async ensureSeparatorEntries(t) {
    await this.findEntryByKey(t, "") || await this.createEntry(t, {
      name: "",
      content: "<summary>",
      keys: [""],
      constant: !0,
      order: 8999,
      enabled: !0,
      position: "before_character_definition"
    }), await this.findEntryByKey(t, "") || await this.createEntry(t, {
      name: "",
      content: "</summary>",
      keys: [""],
      constant: !0,
      order: 1e4,
      enabled: !0,
      position: "before_character_definition"
    });
  }
  /**
   * 
   *  9000
   */
  static async getNextSummaryOrder(t) {
    const r = (await this.getEntries(t)).map((o) => o.order).filter((o) => o >= 9e3 && o < 1e4);
    return r.length === 0 ? 9e3 : Math.max(...r) + 1;
  }
  /**
   *  Key 
   * @param worldbookName 
   * @param key 
   */
  static async findEntryByKey(t, n) {
    const r = await this.getEntries(t);
    let a = r.find((o) => o.keys.includes(n));
    return a || (a = r.find((o) => o.name === n || n === "__ENGRAM_STATE__" && o.name === "Engram System State")), a || null;
  }
  /**
   *  Token 
   * @param worldbookName 
   */
  static async getWorldbookTokenStats(t) {
    const n = await this.getEntries(t), r = await Promise.all(
      n.map(async (o) => ({
        name: o.name,
        tokens: await this.countTokens(o.content)
      }))
    );
    return {
      totalTokens: r.reduce((o, l) => o + l.tokens, 0),
      entryCount: n.length,
      entries: r
    };
  }
  /**
   *  WorldInfoService 
   */
  static isAvailable() {
    return Ar() !== null;
  }
  /**
   *  Token  API
   */
  static async isNativeTokenCountAvailable() {
    try {
      const t = window.SillyTavern;
      if (t != null && t.getContext) {
        const n = t.getContext();
        return typeof (n == null ? void 0 : n.getTokenCountAsync) == "function";
      }
      return !1;
    } catch {
      return !1;
    }
  }
  /**
   * 
   *  getWorldInfoPrompt 
   * + 
   * 
   * @param chatMessages 
   * @returns 
   */
  static async getActivatedWorldInfo(t) {
    var r, a, o;
    const { Logger: n } = await Promise.resolve().then(() => E2);
    try {
      const u = await new Function("path", "return import(path)")("/scripts/world-info.js"), f = u == null ? void 0 : u.getWorldInfoPrompt, d = u == null ? void 0 : u.getSortedEntries;
      if (typeof d == "function") {
        const O = await d(), Y = [...new Set((O == null ? void 0 : O.map((U) => U.world)) || [])], X = ((r = O == null ? void 0 : O.filter((U) => U.constant)) == null ? void 0 : r.length) || 0;
        n.info("WorldInfo", "getSortedEntries ", {
          totalEntries: (O == null ? void 0 : O.length) || 0,
          worlds: Y,
          constantCount: X,
          sampleEntry: O != null && O[0] ? {
            name: O[0].name,
            world: O[0].world,
            constant: O[0].constant
          } : null
        });
      }
      if (typeof f != "function")
        return n.warn("WorldInfo", "getWorldInfoPrompt "), this.getConstantWorldInfo();
      let m = t;
      if (!m || m.length === 0) {
        const O = (o = (a = window.SillyTavern) == null ? void 0 : a.getContext) == null ? void 0 : o.call(a);
        O != null && O.chat && Array.isArray(O.chat) && (m = O.chat.map((Y) => Y.mes || "").reverse());
      }
      if (!m || m.length === 0)
        return n.warn("WorldInfo", ""), this.getConstantWorldInfo();
      n.debug("WorldInfo", " getWorldInfoPrompt", {
        messageCount: m.length
      });
      const p = 1e6, x = u == null ? void 0 : u.checkWorldInfo;
      if (typeof x != "function")
        return n.error("WorldInfo", "checkWorldInfo "), this.getConstantWorldInfo();
      const y = await x(m, p, !0, {
        trigger: "normal"
      }), w = y == null ? void 0 : y.allActivatedEntries, E = w ? Array.from(w.values()) : [];
      n.info("WorldInfo", ` ${E.length} `);
      const k = await this.loadFilteringState(), { disabledGlobalBooks: C, disabledEntries: T, globalWorldbooks: N, config: A } = k, D = E.filter(
        (O) => this.shouldIncludeEntry(O, N, C, T, A)
      );
      return n.info("WorldInfo", "", {
        total: E.length,
        kept: D.length,
        filteredOut: E.length - D.length,
        keptWorlds: [...new Set(D.map((O) => O.world))]
      }), D.sort((O, Y) => (O.order || 0) - (Y.order || 0)), D.map((O) => O.content).filter(Boolean).join(`

`);
    } catch (l) {
      return n.error("WorldInfo", "", l), this.getConstantWorldInfo();
    }
  }
  /**
   * 
   * @private
   */
  static async loadFilteringState() {
    var m, p, x;
    const t = Ar(), n = ((m = t == null ? void 0 : t.getGlobalWorldbookNames) == null ? void 0 : m.call(t)) || [], { SettingsManager: r } = await Promise.resolve().then(() => Aj), o = (p = r.getSettings().apiSettings) == null ? void 0 : p.worldbookConfig, l = (o == null ? void 0 : o.disabledWorldbooks) || [], { WorldBookStateService: u } = await Promise.resolve().then(() => aU), f = (x = t == null ? void 0 : t.getCharWorldbookNames) == null ? void 0 : x.call(t, "current");
    let d = {};
    return f != null && f.primary && (d = (await u.loadState(f.primary)).disabledEntries || {}), {
      globalWorldbooks: n,
      disabledGlobalBooks: l,
      disabledEntries: d,
      config: o
    };
  }
  /**
   * 
   * @private
   */
  static shouldIncludeEntry(t, n, r, a, o) {
    var l, u, f, d;
    if (((l = t.extra) == null ? void 0 : l.engram) === !0 || (u = t.world) != null && u.startsWith("[Engram]")) return !0;
    if (t.world && n.includes(t.world) && ((o == null ? void 0 : o.includeGlobal) === !1 || r.includes(t.world)))
      return !1;
    if (t.world && t.uid) {
      const m = a[t.world];
      if (m && m.includes(t.uid))
        return !1;
    }
    return !((f = t.world) != null && f.startsWith("") || (d = t.world) != null && d.startsWith("---"));
  }
  /**
   *  UI 
   * 
   */
  static async getWorldbookStructure() {
    var l;
    const t = Ar();
    if (!t) return {};
    const n = ((l = t.getGlobalWorldbookNames) == null ? void 0 : l.call(t)) || [];
    let r = [];
    if (t.getCharWorldbookNames) {
      const u = t.getCharWorldbookNames("current");
      u && (r = [...u.additional || [], u.primary].filter(Boolean));
    }
    const a = Array.from(/* @__PURE__ */ new Set([...n, ...r])).sort(), o = {};
    for (const u of a)
      try {
        const f = await this.getEntries(u);
        o[u] = f.map((d) => {
          var m;
          return {
            uid: d.uid,
            name: d.name,
            // 
            keys: d.keys,
            constant: d.constant,
            // 
            comment: d.comment || "",
            content: ((m = d.content) == null ? void 0 : m.substring(0, 50)) + "..."
            // 
          };
        });
      } catch (f) {
        console.warn(`[Engram] WorldInfoService:  ${u} `, f), o[u] = [];
      }
    return o;
  }
  /**
   * 
   *  getActivatedWorldInfo 
   */
  static async getConstantWorldInfo() {
    try {
      const n = await new Function("path", "return import(path)")("/scripts/world-info.js"), r = n == null ? void 0 : n.getSortedEntries;
      if (typeof r != "function")
        return "";
      const a = await r();
      if (!a || !Array.isArray(a))
        return "";
      const o = a.filter((l) => l.constant === !0 && l.disable !== !0 && l.content);
      return o.length === 0 ? "" : (console.debug(`[Engram] WorldInfoService:  ${o.length} `), o.map((l) => l.content).join(`

`));
    } catch {
      return "";
    }
  }
}
const j$ = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  SUMMARY_ENTRY_KEY: Bc,
  WorldInfoService: zt,
  getTavernHelper: Ar
}, Symbol.toStringTag, { value: "Module" }));
async function T$() {
  const { EventBus: e } = await Promise.resolve().then(() => E$), { MessageService: t } = await Promise.resolve().then(() => N$), { WorldInfoService: n } = await Promise.resolve().then(() => j$);
  return {
    eventBus: e.isAvailable(),
    messageService: t.isAvailable(),
    worldInfoService: n.isAvailable(),
    nativeTokenCount: await n.isNativeTokenCountAvailable(),
    floorCount: t.isAvailable() ? t.getFloorCount() : null,
    characterName: t.isAvailable() ? t.getCurrentCharacterName() : null
  };
}
const F7 = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  EventBus: di,
  MessageService: B7,
  TavernEventType: Ni,
  WorldInfoService: zt,
  checkTavernIntegration: T$
}, Symbol.toStringTag, { value: "Module" }));
function sS() {
  return typeof crypto < "u" && typeof crypto.randomUUID == "function" ? crypto.randomUUID() : "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, (e) => {
    const t = Math.random() * 16 | 0;
    return (e === "x" ? t : t & 3 | 8).toString(16);
  });
}
function Ur() {
  const e = or();
  return e ? jo(e) : null;
}
function oS() {
  const e = or();
  return e ? Ps(e) : null;
}
const yr = xj((e, t) => ({
  currentChatId: null,
  lastSummarizedFloor: 0,
  isProcessing: !1,
  recentEvents: [],
  // V0.6 
  currentScope: null,
  resolveScope: async (n, r) => {
    e({ currentChatId: n, currentScope: { id: 1 } });
    const a = await To.getState();
    return e({ lastSummarizedFloor: a.last_summarized_floor }), { id: 1 };
  },
  initChat: async () => {
    const n = or();
    if (!n)
      return console.warn("[MemoryStore] No chat_id available"), null;
    if (n !== t().currentChatId) {
      console.debug(`[MemoryStore] Switching to chat: ${n}`);
      const r = await To.getState();
      e({
        currentChatId: n,
        currentScope: { id: 1 },
        // 
        lastSummarizedFloor: r.last_summarized_floor,
        recentEvents: []
      });
    }
    return jo(n);
  },
  saveEvent: async (n) => {
    const r = Ur();
    if (!r)
      throw new Error("[MemoryStore] No current chat");
    const a = {
      ...n,
      id: sS(),
      timestamp: Date.now(),
      is_embedded: n.is_embedded ?? !1,
      // V0.7: 
      is_archived: n.is_archived ?? !1
      // V0.7: 
    };
    return await r.events.add(a), e((o) => ({
      recentEvents: [...o.recentEvents, a].slice(-10)
    })), a;
  },
  getEventSummaries: async (n) => {
    const r = oS();
    if (!r) return "";
    try {
      const a = await r.events.toArray();
      if (a.length === 0) return "";
      const o = n ? new Set(n) : null, l = a.filter(
        (f) => f.level >= 1 || // 
        !f.is_archived || // 
        (o == null ? void 0 : o.has(f.id))
        //  RAG 
      );
      return l.length === 0 ? "" : (l.sort((f, d) => {
        var w, E, k, C;
        const m = ((w = f.source_range) == null ? void 0 : w.start_index) ?? 0, p = ((E = d.source_range) == null ? void 0 : E.start_index) ?? 0;
        if (m !== p) return m - p;
        const x = ((k = f.source_range) == null ? void 0 : k.end_index) ?? 0, y = ((C = d.source_range) == null ? void 0 : C.end_index) ?? 0;
        return x !== y ? x - y : f.timestamp - d.timestamp;
      }), `<summary>
${l.map((f) => f.summary).join(`

`)}
</summary>`);
    } catch (a) {
      return console.error("[MemoryStore] Failed to get event summaries:", a), "";
    }
  },
  countEventTokens: async () => {
    const n = Ur();
    if (!n) return { totalTokens: 0, eventCount: 0, activeEventCount: 0 };
    try {
      const r = await n.events.toArray();
      if (r.length === 0) return { totalTokens: 0, eventCount: 0, activeEventCount: 0 };
      const a = r.filter((u) => !u.is_archived), o = a.map((u) => u.summary).join(`

`);
      return {
        totalTokens: await zt.countTokens(o),
        eventCount: r.length,
        activeEventCount: a.length
        // 
      };
    } catch (r) {
      return console.error("[MemoryStore] Failed to count event tokens:", r), { totalTokens: 0, eventCount: 0, activeEventCount: 0 };
    }
  },
  setLastSummarizedFloor: async (n) => {
    await To.updateState({ last_summarized_floor: n }), e({ lastSummarizedFloor: n });
  },
  setProcessing: (n) => e({ isProcessing: n }),
  reset: () => e({
    currentChatId: null,
    currentScope: null,
    lastSummarizedFloor: 0,
    isProcessing: !1,
    recentEvents: []
  }),
  // ==================== Trim  ====================
  /**
   * 
   */
  archiveEvents: async (n) => {
    if (n.length === 0) return;
    const r = Ur();
    if (r)
      try {
        await r.events.where("id").anyOf(n).modify({ is_archived: !0 }), console.log(`[MemoryStore] Archived ${n.length} events`);
      } catch (a) {
        console.error("[MemoryStore] Failed to archive events:", a);
      }
  },
  /**
   * 
   */
  markEventsAsEmbedded: async (n) => {
    if (n.length === 0) return;
    const r = Ur();
    if (r)
      try {
        await r.events.where("id").anyOf(n).modify({ is_embedded: !0 }), console.log(`[MemoryStore] Marked ${n.length} events as embedded`);
      } catch (a) {
        console.error("[MemoryStore] Failed to mark events as embedded:", a);
      }
  },
  getEventsToMerge: async (n = 3) => {
    const r = Ur();
    if (!r) return [];
    try {
      const a = await r.events.orderBy("timestamp").toArray();
      return a.length <= n ? [] : a.slice(0, a.length - n);
    } catch (a) {
      return console.error("[MemoryStore] Failed to get events to merge:", a), [];
    }
  },
  deleteEvents: async (n) => {
    if (n.length === 0) return;
    const r = Ur();
    if (r)
      try {
        await r.events.bulkDelete(n), console.log(`[MemoryStore] Deleted ${n.length} events`);
      } catch (a) {
        throw console.error("[MemoryStore] Failed to delete events:", a), a;
      }
  },
  /**
   * 
   */
  updateEvent: async (n, r) => {
    if (!n) return;
    const a = Ur();
    if (a)
      try {
        const { id: o, timestamp: l, ...u } = r;
        await a.events.update(n, u), console.log(`[MemoryStore] Updated event: ${n}`, u);
      } catch (o) {
        throw console.error("[MemoryStore] Failed to update event:", o), o;
      }
  },
  getAllEvents: async () => {
    const n = Ur();
    if (!n) return [];
    try {
      return await n.events.orderBy("timestamp").toArray();
    } catch (r) {
      return console.error("[MemoryStore] Failed to get all events:", r), [];
    }
  },
  // ==================== V0.9  ====================
  getAllEntities: async () => {
    const n = Ur();
    if (!n) return [];
    try {
      return await n.entities.toArray();
    } catch (r) {
      return console.error("[MemoryStore] Failed to get all entities:", r), [];
    }
  },
  saveEntity: async (n) => {
    const r = Ur();
    if (!r)
      throw new Error("[MemoryStore] No current chat");
    const a = {
      ...n,
      id: sS(),
      last_updated_at: Date.now(),
      aliases: n.aliases || [],
      profile: n.profile || {}
    };
    return await r.entities.add(a), console.log(`[MemoryStore] Saved entity: ${a.name}`), a;
  },
  updateEntity: async (n, r) => {
    if (!n) return;
    const a = Ur();
    if (a)
      try {
        const { id: o, ...l } = r;
        await a.entities.update(n, {
          ...l,
          last_updated_at: Date.now()
        }), console.log(`[MemoryStore] Updated entity: ${n}`);
      } catch (o) {
        throw console.error("[MemoryStore] Failed to update entity:", o), o;
      }
  },
  deleteEntity: async (n) => {
    if (!n) return;
    const r = Ur();
    if (r)
      try {
        await r.entities.delete(n), console.log(`[MemoryStore] Deleted entity: ${n}`);
      } catch (a) {
        throw console.error("[MemoryStore] Failed to delete entity:", a), a;
      }
  },
  findEntityByName: async (n) => {
    const r = Ur();
    if (!r) return null;
    try {
      const a = await r.entities.where("name").equals(n).first();
      return a || await r.entities.where("aliases").equals(n).first() || null;
    } catch (a) {
      return console.error("[MemoryStore] Failed to find entity by name:", a), null;
    }
  },
  /**
   * V0.9.2:  ()
   *  is_archived=true 
   */
  getArchivedEventSummaries: async () => {
    const n = oS();
    if (!n) return "";
    try {
      const a = (await n.events.toArray()).filter((l) => l.is_archived === !0);
      return a.length === 0 ? "" : (a.sort((l, u) => {
        var m, p;
        const f = ((m = l.source_range) == null ? void 0 : m.start_index) ?? 0, d = ((p = u.source_range) == null ? void 0 : p.start_index) ?? 0;
        return f !== d ? f - d : l.timestamp - u.timestamp;
      }), `<archived_summary>
${a.map((l) => l.summary).join(`

`)}
</archived_summary>`);
    } catch (r) {
      return console.error("[MemoryStore] Failed to get archived event summaries:", r), "";
    }
  }
})), $7 = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  useMemoryStore: yr
}, Symbol.toStringTag, { value: "Module" })), Ub = [
  { value: "input", label: "", description: " LLM " },
  { value: "output", label: "", description: " LLM /" },
  { value: "both", label: "", description: "" }
], eu = [
  {
    id: "remove-think",
    name: "",
    pattern: "<think(?:\\s+[^>]*)?>[\\s\\S]*?<\\/think\\s*>",
    replacement: "",
    enabled: !0,
    flags: "gi",
    scope: "both",
    description: " LLM  <think>...</think> "
  },
  {
    id: "remove-headless-think",
    name: "",
    pattern: "[\\s\\S]*?<\\/think\\s*>",
    replacement: "",
    enabled: !0,
    flags: "gi",
    scope: "both",
    description: " </think> "
  },
  {
    id: "remove-update-variable",
    name: " UpdateVariable",
    pattern: "<UpdateVariable(?:\\s+[^>]*)?>[\\s\\S]*?<\\/UpdateVariable\\s*>",
    replacement: "",
    enabled: !0,
    flags: "gi",
    scope: "both",
    description: " MVU "
  },
  {
    id: "remove-status-placeholder",
    name: " StatusPlaceHolder",
    pattern: "<StatusPlaceHolderImpl(?:\\s+[^>]*)?\\s*\\/>",
    replacement: "",
    enabled: !0,
    flags: "gi",
    scope: "both",
    description: ""
  }
];
class Vh {
  constructor(t) {
    nt(this, "rules", []);
    this.rules = t || [...eu];
  }
  /**
   * 
   * @param text 
   * @param scope 
   */
  process(t, n) {
    let r = t;
    for (const a of this.rules)
      if (a.enabled && !(n && a.scope !== n && a.scope !== "both"))
        try {
          const o = new RegExp(a.pattern, a.flags);
          r = r.replace(o, a.replacement);
        } catch (o) {
          console.warn(`[RegexProcessor]  "${a.name}" :`, o);
        }
    return r;
  }
  /**
   * 
   */
  processWithRule(t, n) {
    try {
      const r = new RegExp(n.pattern, n.flags);
      return t.replace(r, n.replacement);
    } catch (r) {
      return console.warn("[RegexProcessor] :", r), t;
    }
  }
  /**
   * 
   */
  validatePattern(t, n) {
    try {
      return new RegExp(t, n), { valid: !0 };
    } catch (r) {
      return {
        valid: !1,
        error: r instanceof Error ? r.message : ""
      };
    }
  }
  /**
   * 
   */
  getRules() {
    return [...this.rules];
  }
  /**
   * 
   */
  setRules(t) {
    this.rules = [...t];
  }
  /**
   * 
   */
  addRule(t) {
    this.rules.push(t);
  }
  /**
   * 
   */
  updateRule(t, n) {
    const r = this.rules.findIndex((a) => a.id === t);
    r >= 0 && (this.rules[r] = { ...this.rules[r], ...n });
  }
  /**
   * 
   */
  deleteRule(t) {
    this.rules = this.rules.filter((n) => n.id !== t);
  }
  /**
   * /
   */
  toggleRule(t) {
    const n = this.rules.find((r) => r.id === t);
    n && (n.enabled = !n.enabled);
  }
  /**
   * 
   */
  resetToDefaults() {
    this.rules = [...eu];
  }
  /**
   * 
   */
  getEnabledCount() {
    return this.rules.filter((t) => t.enabled).length;
  }
  // ========== V0.8:  ==========
  /**
   * 
   * @param text 
   * @param tagName  ( 'output', 'query')
   * @returns  null
   */
  captureTag(t, n) {
    var r;
    try {
      const a = new RegExp(`<${n}(?:\\s+[^>]*)?>([\\s\\S]*?)<\\/${n}\\s*>`, "i"), o = t.match(a);
      return ((r = o == null ? void 0 : o[1]) == null ? void 0 : r.trim()) || null;
    } catch (a) {
      return console.warn(`[RegexProcessor] : ${n}`, a), null;
    }
  }
  /**
   * 
   * @param text 
   * @param tagName 
   */
  removeTag(t, n) {
    try {
      const r = new RegExp(`<${n}(?:\\s+[^>]*)?>[\\s\\S]*?<\\/${n}\\s*>`, "gi");
      return t.replace(r, "").trim();
    } catch (r) {
      return console.warn(`[RegexProcessor] : ${n}`, r), t;
    }
  }
  /**
   * 
   * @param text 
   * @param tagNames 
   * @returns 
   */
  captureTags(t, n) {
    const r = {};
    for (const a of n)
      r[a] = this.captureTag(t, a);
    return r;
  }
}
const fi = new Vh(), A$ = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  DEFAULT_REGEX_RULES: eu,
  REGEX_SCOPE_OPTIONS: Ub,
  RegexProcessor: Vh,
  regexProcessor: fi
}, Symbol.toStringTag, { value: "Module" })), Pn = class Pn {
  /**
   *  Engram 
   */
  static async init() {
    var t, n;
    if (!this.isInitialized)
      try {
        const r = (n = (t = window.SillyTavern) == null ? void 0 : t.getContext) == null ? void 0 : n.call(t);
        if (!(r != null && r.registerMacro)) {
          le.warn("MacroService", "SillyTavern registerMacro API ");
          return;
        }
        r.registerMacro(
          "engramSummaries",
          () => Pn.cachedSummaries,
          "Engram:  ( IndexedDB)"
        ), r.registerMacro(
          "worldbookContext",
          () => Pn.cachedWorldbookContext,
          "Engram: "
        ), r.registerMacro(
          "userInput",
          () => Pn.cachedUserInput,
          "Engram: "
        ), r.registerMacro(
          "chatHistory",
          (o) => Pn.getChatHistory(o),
          "Engram:  (: , 20)"
        ), r.registerMacro(
          "context",
          () => Pn.cachedCharDescription,
          "Engram: "
        ), r.registerMacro(
          "engramGraph",
          () => Pn.cachedGraphData,
          "Engram:  JSON ()"
        ), r.registerMacro(
          "engramArchivedSummaries",
          () => Pn.cachedArchivedSummaries,
          "Engram:  ()"
        ), r.registerMacro(
          "userPersona",
          () => Pn.cachedUserPersona,
          "Engram:  ( Persona Description)"
        ), this.isInitialized = !0, le.success("MacroService", "", {
          macros: ["{{engramSummaries}}", "{{worldbookContext}}", "{{userInput}}", "{{chatHistory}}", "{{context}}", "{{engramGraph}}", "{{engramArchivedSummaries}}", "{{userPersona}}"]
        }), await this.refreshCache();
        const a = r.eventSource;
        a && a.on("chat_id_changed", () => {
          this.refreshCache().catch((o) => le.warn("MacroService", "", o));
        });
      } catch (r) {
        le.error("MacroService", "", r);
      }
  }
  /**
   * 
   */
  static setUserInput(t) {
    this.cachedUserInput = t;
  }
  /**
   *  -  IndexedDB 
   * @param recalledIds RAG  ID 
   */
  static async refreshCache(t) {
    try {
      const n = yr.getState();
      this.cachedSummaries = await n.getEventSummaries(t);
      try {
        const r = await zt.getActivatedWorldInfo(), a = await this.processEJSMacros([r]);
        this.cachedWorldbookContext = a[0] || "";
      } catch (r) {
        le.debug("MacroService", "", r), this.cachedWorldbookContext = "";
      }
      this.refreshCharDescription(), await this.refreshArchivedSummaries(), this.refreshUserPersona(), this.refreshCustomMacros(), le.debug("MacroService", "", {
        summariesLength: this.cachedSummaries.length,
        worldbookLength: this.cachedWorldbookContext.length,
        recalledCount: (t == null ? void 0 : t.length) ?? 0,
        customMacrosCount: this.cachedCustomMacros.size
      });
    } catch (n) {
      le.warn("MacroService", "", n);
    }
  }
  /**
   * V0.9: 
   *  EventNode JSON embedding 
   */
  static async refreshGraphCache() {
    try {
      const t = yr.getState(), n = await t.getAllEvents(), r = await t.getAllEntities(), a = n.map((l) => ({
        id: l.id,
        summary: l.summary,
        structured_kv: l.structured_kv,
        significance_score: l.significance_score,
        level: l.level,
        source_range: l.source_range
      })), o = r.map((l) => ({
        id: l.id,
        name: l.name,
        type: l.type,
        aliases: l.aliases || [],
        description: l.description
      }));
      this.cachedGraphData = JSON.stringify({
        events: a,
        existingEntities: o
      }, null, 2), le.debug("MacroService", "", {
        eventCount: n.length,
        entityCount: r.length
      });
    } catch (t) {
      le.warn("MacroService", "", t), this.cachedGraphData = JSON.stringify({ events: [], existingEntities: [] });
    }
  }
  /**
   * V0.8.5:  RAG 
   * 
   * @param nodes RAG 
   */
  static async refreshCacheWithNodes(t) {
    try {
      this.cachedSummaries = t.map((n) => n.summary).join(`

---

`);
      try {
        const n = await zt.getActivatedWorldInfo(), r = await this.processEJSMacros([n]);
        this.cachedWorldbookContext = r[0] || "";
      } catch (n) {
        le.debug("MacroService", "", n), this.cachedWorldbookContext = "";
      }
      this.refreshCharDescription(), le.debug("MacroService", "RAG ", {
        summariesLength: this.cachedSummaries.length,
        nodeCount: t.length
      });
    } catch (n) {
      le.warn("MacroService", " RAG ", n);
    }
  }
  /**
   *  ST-Prompt-Template ()  EJS 
   * V0.8.6:  window.EjsTemplate API ( test/.js)
   */
  static async processEJSMacros(t) {
    if (t.length === 0) return t;
    if (!window.EjsTemplate || typeof window.EjsTemplate.evalTemplate != "function")
      return le.debug("MacroService", "ST-Prompt-Template  EJS "), t;
    try {
      const n = await window.EjsTemplate.prepareContext();
      if (typeof window.Mvu < "u" && window.Mvu.getMvuData)
        try {
          const a = window.Mvu.getMvuData({ type: "message", message_id: "latest" });
          a && a.stat_data && (n.mvu = a.stat_data);
        } catch (a) {
          le.warn("MacroService", " MVU ", a);
        }
      return await Promise.all(t.map(async (a) => {
        try {
          return await window.EjsTemplate.evalTemplate(a, n);
        } catch (o) {
          return le.warn("MacroService", "EJS ", o), a;
        }
      }));
    } catch (n) {
      return le.warn("MacroService", "EJS ", n), t;
    }
  }
  /**
   *  ()
   * @param depthStr  ( 20)
   */
  static getChatHistory(t) {
    var n, r;
    try {
      let a = 20;
      if (t) {
        const u = parseInt(t, 10);
        isNaN(u) || (u < 0 ? a = 1 / 0 : u > 0 ? a = u : a = this.getDynamicChatHistoryLimit());
      } else
        a = this.getDynamicChatHistoryLimit();
      le.debug("MacroService", "getChatHistory called", { depthStr: t, limit: a });
      const o = (r = (n = window.SillyTavern) == null ? void 0 : n.getContext) == null ? void 0 : r.call(n), l = window.TavernHelper;
      if (o != null && o.chat && Array.isArray(o.chat)) {
        const u = o.chat.slice(-a);
        return le.debug("MacroService", "Got recent messages", { count: u.length }), u.map((f, d) => {
          let m = f.mes || "";
          const p = m;
          if (l && typeof l.formatAsTavernRegexedString == "function")
            try {
              m = l.formatAsTavernRegexedString(m, "ai_output", { isPrompt: !0 });
            } catch (x) {
              le.warn("MacroService", "", x);
            }
          return m = fi.process(m, "both"), (d === 0 || d === u.length - 1) && le.debug("MacroService", "Message processed", {
            index: d,
            original: p.substring(0, 50),
            processed: m.substring(0, 50)
          }), m;
        }).join(`
`);
      }
      return le.warn("MacroService", "Context chat is empty or invalid"), "";
    } catch (a) {
      return le.debug("MacroService", "", a), "";
    }
  }
  /**
   * 
   */
  static refreshCharDescription() {
    var t, n;
    try {
      const r = (n = (t = window.SillyTavern) == null ? void 0 : t.getContext) == null ? void 0 : n.call(t);
      if (r != null && r.characters && r.characterId >= 0) {
        const a = r.characters[r.characterId];
        this.cachedCharDescription = (a == null ? void 0 : a.description) || "";
      }
    } catch (r) {
      le.debug("MacroService", "", r);
    }
  }
  /**
   * V0.9.2:  chatHistory 
   * : floorInterval - bufferSize
   *  {{chatHistory}} 
   */
  static getDynamicChatHistoryLimit() {
    try {
      const t = We.get("summarizerConfig"), n = (t == null ? void 0 : t.floorInterval) ?? 20, r = (t == null ? void 0 : t.bufferSize) ?? 3, a = Math.max(1, n - r);
      return le.debug("MacroService", " chatHistory limit", { floorInterval: n, bufferSize: r, limit: a }), a;
    } catch (t) {
      return le.warn("MacroService", " limit  17", t), 17;
    }
  }
  /**
   * V0.9.2: 
   *  is_archived=true 
   */
  static async refreshArchivedSummaries() {
    try {
      const t = yr.getState();
      this.cachedArchivedSummaries = await t.getArchivedEventSummaries(), le.debug("MacroService", "", {
        length: this.cachedArchivedSummaries.length
      });
    } catch (t) {
      le.warn("MacroService", "", t), this.cachedArchivedSummaries = "";
    }
  }
  /**
   * V0.9.2: 
   *  power_user.persona_description 
   */
  static refreshUserPersona() {
    try {
      const t = window.power_user;
      this.cachedUserPersona = (t == null ? void 0 : t.persona_description) || "", le.debug("MacroService", "", {
        length: this.cachedUserPersona.length
      });
    } catch (t) {
      le.debug("MacroService", "", t), this.cachedUserPersona = "";
    }
  }
  /**
   * V0.9.2: 
   *  apiSettings.customMacros 
   */
  static refreshCustomMacros() {
    var t, n;
    try {
      const r = (n = (t = window.SillyTavern) == null ? void 0 : t.getContext) == null ? void 0 : n.call(t);
      if (!(r != null && r.registerMacro)) {
        le.debug("MacroService", " registerMacro ");
        return;
      }
      const a = We.get("apiSettings"), o = (a == null ? void 0 : a.customMacros) || [];
      this.cachedCustomMacros.clear();
      for (const l of o) {
        if (!l.enabled || !l.name) continue;
        this.cachedCustomMacros.set(l.name, l.content);
        const u = l.name;
        r.registerMacro(
          u,
          () => this.cachedCustomMacros.get(u) ?? "",
          `Engram : {{${u}}}`
        );
      }
      le.debug("MacroService", "", {
        count: this.cachedCustomMacros.size,
        names: Array.from(this.cachedCustomMacros.keys())
      });
    } catch (r) {
      le.warn("MacroService", "", r);
    }
  }
};
nt(Pn, "isInitialized", !1), // ---  ---
nt(Pn, "cachedSummaries", ""), nt(Pn, "cachedWorldbookContext", ""), nt(Pn, "cachedUserInput", ""), nt(Pn, "cachedCharDescription", ""), // V0.9: 
nt(Pn, "cachedGraphData", ""), // V0.9.2: 
nt(Pn, "cachedArchivedSummaries", ""), nt(Pn, "cachedUserPersona", ""), // V0.9.2: 
nt(Pn, "cachedCustomMacros", /* @__PURE__ */ new Map());
let ji = Pn;
const U7 = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  MacroService: ji
}, Symbol.toStringTag, { value: "Module" })), M$ = [
  // 
  { pattern: /\n{3,}/g, replacement: `

`, description: "" },
  // 
  { pattern: /^[ \t]+|[ \t]+$/gm, replacement: "", description: "" },
  //  Markdown 
  { pattern: /```\w*\n?/g, replacement: "", description: "Markdown" },
  // 
  { pattern: /[""]/g, replacement: '"', description: "" },
  { pattern: /['']/g, replacement: "'", description: "" }
];
class H7 {
  constructor(t) {
    nt(this, "rules");
    this.rules = t || M$;
  }
  /**
   *  LLM 
   * @param text 
   * @returns 
   */
  clean(t) {
    let n = t;
    for (const r of this.rules)
      n = n.replace(r.pattern, r.replacement);
    return n.trim();
  }
  /**
   * 
   * @param summary 
   * @param metadata 
   */
  formatAsWorldEntry(t, n) {
    let a = `  [${`${n.floorRange[0]}-${n.floorRange[1]}`}]
`;
    return a += t, a;
  }
  /**
   * 
   * @param text 
   */
  extractPlainText(t) {
    return t.replace(/```[\s\S]*?```/g, "").replace(/\[([^\]]+)\]\([^)]+\)/g, "$1").replace(/[*_~`#]/g, "").replace(/\n{2,}/g, `
`).trim();
  }
  /**
   * 
   * @param text 
   * @param maxLength 
   * @param suffix 
   */
  truncate(t, n, r = "...") {
    return t.length <= n ? t : t.slice(0, n - r.length) + r;
  }
  /**
   * 
   */
  addRule(t) {
    this.rules.push(t);
  }
  /**
   * 
   */
  getRules() {
    return [...this.rules];
  }
}
const G7 = new H7();
function lS() {
  try {
    return window.TavernHelper || null;
  } catch {
    return null;
  }
}
function R$() {
  var e, t, n, r;
  try {
    const a = (t = (e = window.SillyTavern) == null ? void 0 : e.getContext) == null ? void 0 : t.call(e);
    return ((r = (n = a == null ? void 0 : a.extensionSettings) == null ? void 0 : n.connectionManager) == null ? void 0 : r.profiles) || [];
  } catch {
    return [];
  }
}
class V7 {
  /**
   *  LLM 
   * @param request 
   */
  async generate(t) {
    var r, a, o, l;
    const n = lS();
    if (!(n != null && n.generateRaw) && !(n != null && n.generate))
      return {
        success: !1,
        content: "",
        error: "TavernHelper "
      };
    try {
      let u;
      const f = We.getSettings();
      let d;
      t.presetId && (d = (a = (r = f.apiSettings) == null ? void 0 : r.llmPresets) == null ? void 0 : a.find((N) => N.id === t.presetId)), !d && ((o = f.apiSettings) != null && o.selectedPresetId) && (d = (l = f.apiSettings.llmPresets) == null ? void 0 : l.find((N) => N.id === f.apiSettings.selectedPresetId));
      let m;
      if (d && d.source !== "tavern") {
        if (m = {}, le.info("LLMAdapter", `: ${d.name} (${d.source})`), d.parameters && (m = {
          ...m,
          //  ST API 
          temperature: d.parameters.temperature,
          max_tokens: d.parameters.maxTokens,
          // ST API  max_tokens
          top_p: d.parameters.topP,
          frequency_penalty: d.parameters.frequencyPenalty,
          presence_penalty: d.parameters.presencePenalty
          //  rep_pen  frequency_penalty 
          // rep_pen: preset.parameters.frequencyPenalty,
        }), d.source === "custom" && d.custom)
          m.apiurl = d.custom.apiUrl, m.key = d.custom.apiKey, m.model = d.custom.model, m.source = d.custom.apiSource || "openai";
        else if (d.source === "tavern_profile" && d.tavernProfileId) {
          const A = R$().find((D) => D.id === d.tavernProfileId);
          A ? (le.info("LLMAdapter", ` Profile: ${A.name}`), m.model = A.model, m.source = A.api, A["api-url"] ? m.apiurl = A["api-url"] : A.request_url ? m.apiurl = A.request_url : A.openai_url && (m.apiurl = A.openai_url), A.key ? m.key = A.key : A.request_apikey ? m.key = A.request_apikey : A.openai_key && (m.key = A.openai_key)) : (le.warn("LLMAdapter", ` ID  ${d.tavernProfileId} `), m = void 0);
        }
      }
      const p = t.systemPrompt ? `${t.systemPrompt}

${t.userPrompt}` : t.userPrompt, x = {
        prompt: p,
        // 
        body: {
          messages: [
            { role: "system", content: t.systemPrompt },
            { role: "user", content: t.userPrompt }
          ]
        },
        // 
        is_engram: !0
        //  ()
      }, { EventBus: y, TavernEventType: w } = await Promise.resolve().then(() => F7);
      await y.emit(w.GENERATION_AFTER_COMMANDS, "engram", {}, !1), await y.emit(w.GENERATE_AFTER_DATA, x);
      const E = typeof x.prompt == "string" ? x.prompt : p;
      let k = t.systemPrompt, C = t.userPrompt;
      E !== p && (k = "", C = E);
      const { regexProcessor: T } = await Promise.resolve().then(() => A$);
      if (C = T.process(C, "input"), n.generateRaw) {
        const N = [];
        k && N.push({ role: "system", content: k }), N.push({ role: "user", content: C }), u = await n.generateRaw({
          ordered_prompts: N,
          custom_api: m
          // V0.8.6 Fix
        });
      } else if (n.generate)
        u = await n.generate({
          user_input: C,
          system_prompt: k,
          should_stream: !1,
          max_chat_history: 0,
          custom_api: m
          // V0.8.6 Fix
        });
      else
        throw new Error(" API");
      return {
        success: !0,
        content: u || ""
      };
    } catch (u) {
      const f = u instanceof Error ? u.message : String(u);
      return console.error("[Engram] LLMAdapter :", u), {
        success: !1,
        content: "",
        error: f
      };
    }
  }
  /**
   *  LLM API 
   */
  isAvailable() {
    const t = lS();
    return !!(t != null && t.generate || t != null && t.generateRaw);
  }
  /**
   *  Token 
   * @param text 
   */
  estimateTokens(t) {
    return Math.ceil(t.length / 3);
  }
}
const Oo = new V7(), So = class So {
  constructor() {
    nt(this, "unsubscribers", []);
    nt(this, "callbacks", /* @__PURE__ */ new Map());
  }
  /**
   * 
   */
  static getInstance() {
    return So.instance || (So.instance = new So()), So.instance;
  }
  /**
   * 
   * 
   */
  start() {
    if (this.unsubscribers.length > 0) {
      console.log("[EventWatcher] Already started.");
      return;
    }
    this.unsubscribers.push(
      di.on(Ni.MESSAGE_RECEIVED, () => this.emit("messageReceived")),
      di.on(Ni.CHAT_CHANGED, () => this.emit("chatChanged")),
      di.on(Ni.GENERATION_STARTED, () => this.emit("generationStarted")),
      di.on(Ni.GENERATION_ENDED, () => this.emit("generationEnded"))
    ), console.log("[EventWatcher] Started, listening to core events.");
  }
  /**
   * 
   */
  stop() {
    this.unsubscribers.forEach((t) => t()), this.unsubscribers = [], console.log("[EventWatcher] Stopped.");
  }
  /**
   * 
   * @param event 
   * @param callback 
   * @returns 
   */
  on(t, n) {
    const r = this.mapEventKey(t);
    return this.callbacks.has(r) || this.callbacks.set(r, /* @__PURE__ */ new Set()), this.callbacks.get(r).add(n), () => {
      var a;
      (a = this.callbacks.get(r)) == null || a.delete(n);
    };
  }
  /**
   * 
   */
  emit(t) {
    const n = this.callbacks.get(t);
    n && n.forEach((r) => {
      try {
        r();
      } catch (a) {
        console.error(`[EventWatcher] Callback error for ${t}:`, a);
      }
    });
  }
  /**
   * 
   */
  mapEventKey(t) {
    return {
      onMessageReceived: "messageReceived",
      onChatChanged: "chatChanged",
      onGenerationStarted: "generationStarted",
      onGenerationEnded: "generationEnded"
    }[t];
  }
};
nt(So, "instance", null);
let Hb = So;
const Gg = Hb.getInstance();
class K2 {
  /**
   * Clean and parse JSON from a string.
   * @param input Raw string from LLM
   * @returns Parsed object or null if failed
   */
  static parse(t) {
    const n = fi.process(t, "output"), r = this.extractJsonBlock(n);
    if (!r)
      return console.warn("[RobustJsonParser] No JSON block found."), null;
    try {
      return JSON.parse(r);
    } catch {
      const o = this.simpleRepair(r);
      try {
        return JSON.parse(o);
      } catch (l) {
        return console.error("[RobustJsonParser] Parse failed:", l), console.debug("[RobustJsonParser] Failed string:", r), null;
      }
    }
  }
  /**
   * Extracts the likely JSON part from a string.
   * Prioritizes ```json ... ``` blocks, then looks for outer { ... }.
   */
  static extractJsonBlock(t) {
    const n = t.match(/```(?:json)?\s*([\s\S]*?)```/i);
    if (n && n[1])
      return n[1].trim();
    const r = t.indexOf("{"), a = t.lastIndexOf("}");
    return r !== -1 && a !== -1 && a > r ? t.substring(r, a + 1) : null;
  }
  /**
   * Simple JSON repair logic
   * Fixes common LLM JSON errors:
   * - Trailing commas
   * - Unquoted keys (simple cases)
   * - Single quotes
   */
  static simpleRepair(t) {
    let n = t;
    return n = n.replace(/,\s*([}\]])/g, "$1"), n;
  }
}
class z$ {
  /**
   *  Pipeline
   * V0.6:  JSON Extractor LLM
   */
  async run(t) {
    const n = yr.getState(), r = Date.now();
    try {
      if (console.log("[Pipeline] Starting..."), n.setProcessing(!0), !await n.initChat())
        return { success: !1, error: "No chat context available" };
      console.log(`[Pipeline] Chat database initialized (${Date.now() - r}ms)`);
      const o = K2.parse(t.jsonContent);
      if (!o || !o.events || o.events.length === 0)
        return console.warn("[Pipeline] No events found in JSON"), { success: !1, error: "No events in JSON content" };
      console.log(`[Pipeline] Parsed ${o.events.length} events from JSON (${Date.now() - r}ms)`);
      const l = [];
      for (const f of o.events) {
        const d = f.meta, m = [];
        d.time_anchor && m.push(d.time_anchor), d.location && m.push(d.location), d.role && d.role.length > 0 && m.push(d.role.join(", "));
        const p = m.length > 0 ? `(${m.join(" | ")}) ` : "", x = d.event ? `${d.event}:
` : "", y = [];
        d.logic && d.logic.length > 0 && y.push(`[: ${d.logic.join(", ")}]`), d.causality && y.push(`[: ${d.causality}]`);
        const w = y.length > 0 ? `
${y.join(" ")}` : "", E = `${x}${p}${f.summary}${w}`, k = await n.saveEvent({
          summary: E,
          structured_kv: {
            time_anchor: d.time_anchor || "",
            role: d.role || [],
            location: d.location || "",
            event: d.event || "",
            logic: d.logic || [],
            causality: d.causality || ""
          },
          significance_score: f.significance_score,
          level: 0,
          is_embedded: !1,
          // V0.7: 
          is_archived: !1,
          // V0.7: 
          source_range: {
            start_index: t.sourceRange.start,
            end_index: t.sourceRange.end
          }
        });
        l.push(k);
      }
      console.log(`[Pipeline] Saved ${l.length} events to DB (${Date.now() - r}ms)`);
      const { MacroService: u } = await Promise.resolve().then(() => U7);
      return await u.refreshCache(), console.log(`[Pipeline] Macro cache refreshed (${Date.now() - r}ms)`), await n.setLastSummarizedFloor(t.sourceRange.end), console.log(`[Pipeline] Completed successfully in ${Date.now() - r}ms`), { success: !0, events: l };
    } catch (a) {
      return console.error("[Pipeline] Failed:", a), { success: !1, error: String(a) };
    } finally {
      n.setProcessing(!1);
    }
  }
}
const O$ = new z$();
async function uS() {
  const { Logger: e } = await Promise.resolve().then(() => E2);
  await e.init(), e.info("STBridge", "Engram ...");
  const { SettingsManager: t } = await Promise.resolve().then(() => Aj);
  t.initSettings(), e.info("STBridge", "SettingsManager initialized");
  try {
    const { checkTavernIntegration: r } = await Promise.resolve().then(() => F7), a = await r();
    e.info("TavernAPI", "", a);
  } catch (r) {
    e.warn("TavernAPI", "", { error: String(r) });
  }
  try {
    const { summarizerService: r } = await Promise.resolve().then(() => Ki);
    r.start();
    const a = r.getStatus();
    e.info("Summarizer", "", a);
  } catch (r) {
    e.warn("Summarizer", "", { error: String(r) });
  }
  D$();
  const { ThemeManager: n } = await Promise.resolve().then(() => Qf);
  n.init();
  try {
    const { injector: r } = await Promise.resolve().then(() => bU);
    r.init(), e.info("Injector", "Service initialized");
  } catch (r) {
    e.warn("Injector", "Failed to initialize Injector", { error: String(r) });
  }
  try {
    const { MacroService: r } = await Promise.resolve().then(() => U7);
    await r.init();
  } catch (r) {
    e.warn("MacroService", "Failed to initialize MacroService", { error: String(r) });
  }
  try {
    const { initQuickPanelButton: r } = await Promise.resolve().then(() => uU);
    r(), e.info("QuickPanelButton", "QR ");
  } catch (r) {
    e.warn("QuickPanelButton", "Failed to initialize QuickPanelButton", { error: String(r) });
  }
  P$();
  try {
    const { CharacterDeleteService: r } = await Promise.resolve().then(() => wU);
    r.init(), e.info("STBridge", "CharacterDeleteService initialized");
  } catch (r) {
    e.warn("STBridge", "Failed to initialize CharacterDeleteService", { error: String(r) });
  }
  e.success("STBridge", "Engram  - Where memories leave their trace.");
}
const K7 = '<svg viewBox="0 0 400 592" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M103.875908,522.166260 C75.225380,521.276611 55.289425,503.229828 52.249313,475.852142 C49.879883,454.514191 63.027035,433.000366 83.930901,424.858398 C88.449257,423.098541 89.857674,420.860199 89.801926,416.150269 C89.555420,395.322357 89.621246,374.489380 89.762306,353.659515 C89.787170,349.987000 88.728760,348.057556 85.120293,346.642609 C64.672897,338.625031 52.338894,320.951630 52.085896,299.869415 C51.832878,278.785156 63.730618,260.903198 84.118019,252.449951 C88.288918,250.720566 89.867378,248.680847 89.807304,244.052597 C89.539139,223.391968 89.589142,202.724701 89.796356,182.062561 C89.836380,178.071609 88.518524,176.326385 84.841705,174.787247 C57.730556,163.438416 45.530682,135.966721 55.436111,109.194000 C62.627293,89.757439 81.922821,76.710289 103.282494,76.841476 C124.355003,76.970901 143.082275,89.740875 149.993118,109.121849 C151.315979,112.831749 153.184799,113.869263 156.863403,113.853104 C186.192612,113.724319 215.522736,113.698357 244.851929,113.811600 C248.773117,113.826736 250.677307,112.652130 252.052902,108.765602 C259.013885,89.098465 278.589447,76.365829 300.503601,76.811897 C322.171844,77.252960 341.040283,91.132324 347.255371,111.201912 C356.569763,141.279358 340.344788,170.373184 309.893127,176.623123 C283.359375,182.068970 260.376740,167.450562 251.980011,145.670181 C250.492157,141.810806 248.818085,140.240295 244.552948,140.266785 C215.390915,140.447968 186.227219,140.357330 157.064072,140.375076 C154.628784,140.376556 151.855545,139.805771 151.141357,143.359161 C150.400787,147.043839 146.628937,150.064713 151.136917,154.478546 C184.592346,187.235229 217.778336,220.267349 250.982285,253.280014 C253.021469,255.307434 254.527191,255.254166 257.033264,254.047714 C276.199188,244.820953 294.752930,247.045853 310.978485,259.993408 C328.011017,273.584869 333.936798,292.106659 327.764038,313.282837 C321.779785,333.812378 307.254517,345.637268 286.367889,349.037231 C276.405396,350.658997 266.352570,349.443024 257.275055,344.363342 C254.265045,342.678986 252.301132,343.049744 249.903275,345.441406 C230.205368,365.088531 210.395386,384.623230 190.631638,404.204376 C177.732651,416.984222 164.859726,429.790344 151.962982,442.572388 C148.257980,446.244415 148.113403,452.901764 151.629196,456.671387 C152.707138,457.827148 154.029282,457.681976 155.328629,457.681946 C185.658203,457.681458 215.987854,457.631042 246.317261,457.695557 C249.355972,457.702026 250.687012,456.399414 251.717636,453.698944 C259.314423,433.793579 278.324493,420.868317 299.341309,421.146240 C320.526215,421.426361 339.575745,434.206421 346.686249,452.909271 C354.337341,473.034058 348.794159,495.642761 332.699371,509.956390 C307.061371,532.757202 263.380280,521.715210 251.978027,489.436371 C250.838303,486.209961 249.371201,484.953583 245.964813,484.962799 C216.302094,485.043304 186.639008,484.985840 156.976028,484.969330 C154.436981,484.967896 152.081528,484.923981 150.916916,488.054077 C142.892441,509.621246 126.842339,520.325989 103.875908,522.166260 M141.430466,266.110352 C145.394760,270.906738 148.503693,276.196198 150.388428,282.139069 C151.211502,284.734314 152.692291,285.770782 155.494156,285.760895 C179.139755,285.677429 202.787949,285.547394 226.430206,285.843811 C232.373352,285.918304 231.388184,281.058533 233.335602,278.254700 C235.007233,275.847992 233.916855,274.189880 232.000244,272.304352 C199.956863,240.780380 167.866821,209.301468 136.133682,177.467056 C131.183243,172.500824 127.483856,170.729507 121.013550,174.621368 C117.660522,176.638214 116.183739,178.155136 116.217278,182.042480 C116.398239,203.022598 116.444160,224.006012 116.243645,244.985474 C116.204666,249.064667 117.676285,250.918961 121.328865,252.228989 C128.972488,254.970444 135.505173,259.524170 141.430466,266.110352 M116.349434,377.499908 C116.351860,390.663696 116.870338,403.855377 116.161102,416.980713 C115.742699,424.723846 121.926743,423.801880 125.649162,426.262665 C129.080231,428.530792 130.798965,425.706268 132.741440,423.784821 C165.551407,391.329803 198.234940,358.745361 231.274231,326.525696 C235.764252,322.147095 232.377243,319.155212 231.599960,315.493317 C230.884583,312.123138 228.193359,312.382568 225.670288,312.382812 C202.675171,312.384949 179.679749,312.445435 156.685303,312.323212 C153.331955,312.305389 151.624329,313.386505 150.456299,316.584381 C145.119888,331.194611 135.004120,341.287384 120.496223,346.769958 C117.238434,348.001068 116.190170,349.706024 116.267418,353.006317 C116.450615,360.833862 116.340004,368.668243 116.349434,377.499908z"/></svg>';
function D$() {
  const e = document.querySelector("#top-settings-holder"), t = document.querySelector("#WI-SP-button");
  if (!e) {
    console.warn("[Engram] #top-settings-holder not found, fallback to floating orb"), I$();
    return;
  }
  const n = document.createElement("div");
  n.id = "engram-drawer", n.className = "drawer";
  const r = document.createElement("div");
  r.className = "drawer-toggle drawer-header";
  const a = document.createElement("div");
  a.id = "engram-drawer-icon", a.className = "drawer-icon fa-fw closedIcon", a.title = "Engram - ", a.setAttribute("data-i18n", "[title]Engram - Memory OS"), a.innerHTML = K7, a.addEventListener("click", xh), r.appendChild(a), n.appendChild(r), t ? (e.insertBefore(n, t), console.log("[Engram] Top bar button injected before WI-SP-button")) : (e.appendChild(n), console.log("[Engram] Top bar button injected at end (WI-SP-button not found)"));
}
function I$() {
  const e = document.createElement("div");
  e.className = "fixed bottom-5 right-5 w-12 h-12 rounded-full cursor-pointer z-[9999] flex items-center justify-center transition-transform duration-200 bg-gradient-to-br from-orange-500 to-pink-500 shadow-[0_0_20px_rgba(249,115,22,0.5)] hover:scale-110 hover:shadow-[0_0_30px_rgba(249,115,22,0.7)] text-white", e.title = "Engram - ", e.innerHTML = K7, e.addEventListener("click", xh), document.body.appendChild(e);
}
let yh = null;
function L$(e) {
  yh = e, yh = e;
}
let Gb = null, cS = null;
function q$(e) {
  Gb = e;
}
function P$() {
  if (!Gb) {
    console.warn("[Engram] Global renderer not ready");
    return;
  }
  const e = "engram-global-overlay";
  let t = document.getElementById(e);
  t || (t = document.createElement("div"), t.id = e, t.className = "pointer-events-none fixed inset-0 z-[11000]", document.body.appendChild(t)), cS || (cS = Gb(t, () => {
  }), console.log("[Engram] Global overlay mounted"));
}
let Vg = !1, Ec = null, eh = null;
function xh() {
  Vg && Ec ? (eh && (eh.unmount(), eh = null), Ec.remove(), Ec = null, Vg = !1) : (Ec = B$(), document.body.appendChild(Ec), Vg = !0);
}
function B$() {
  var t;
  const e = document.createElement("div");
  return e.className = "fixed inset-0 w-full h-full z-[10000] flex flex-col bg-background text-foreground overflow-hidden", e.style.backgroundColor = "var(--background)", e.style.color = "var(--foreground)", e.style.height = "100dvh", e.style.width = "100vw", e.style.top = "0", e.style.left = "0", e.id = "engram-panel-root", yh ? eh = yh(e, xh) : (e.innerHTML = `
            <div class="flex items-center justify-between p-4 border-b border-slate-400/20">
                <h2 class="m-0 text-lg text-slate-200 flex items-center gap-2"> Engram</h2>
                <button class="bg-transparent border-none text-slate-400 text-2xl cursor-pointer p-1 hover:text-slate-200">&times;</button>
            </div>
            <div class="flex-1 overflow-auto p-5">
                <p style="color: #94a3b8;">React </p>
            </div>
        `, (t = e.querySelector("button")) == null || t.addEventListener("click", xh)), e;
}
async function F$(e, t) {
  try {
    const r = await new Function("path", "return import(path)")("/scripts/chats.js");
    r && typeof r.hideChatMessageRange == "function" ? (await r.hideChatMessageRange(e, t, !1), console.log(`[Engram] Hidden messages range: ${e}-${t}`)) : console.warn("[Engram] hideChatMessageRange not found in chats.js");
  } catch (n) {
    console.error("[Engram] Failed to hide messages:", n);
  }
}
async function $$(e, t = "text", n = "") {
  return window.callPopup ? window.callPopup(e, t, n) : (console.warn("[Engram] callPopup not available"), Promise.resolve(t === "confirm" ? !0 : null));
}
class U$ {
  /**
   * 
   * @returns Promise<string> 
   * @throws Error 
   */
  async requestRevision(t, n, r) {
    return new Promise((a, o) => {
      di.emit(Ni.ENGRAM_REQUEST_REVISION, {
        title: t,
        description: n,
        content: r,
        onConfirm: (l) => a(l),
        onCancel: () => o(new Error("User cancelled revision"))
      });
    });
  }
}
const Y2 = new U$(), Y7 = {
  enabled: !0,
  triggerMode: "auto",
  floorInterval: 10,
  worldbookMode: "chat",
  previewEnabled: !0,
  promptTemplateId: null,
  // 
  llmPresetId: null,
  // 
  bufferSize: 3,
  //  3 
  autoHide: !1
  // 
}, Bl = "engram";
function dS() {
  var e, t;
  try {
    return ((t = (e = window.SillyTavern) == null ? void 0 : e.getContext) == null ? void 0 : t.call(e)) || null;
  } catch {
    return null;
  }
}
function fS() {
  var e, t;
  try {
    const n = (t = (e = window.SillyTavern) == null ? void 0 : e.getContext) == null ? void 0 : t.call(e);
    return n != null && n.chat_metadata ? n.chat_metadata : window.chat_metadata || null;
  } catch {
    return null;
  }
}
function H$() {
  var e;
  try {
    (e = window.saveChatDebounced) == null || e.call(window);
  } catch {
    console.warn("[Engram] saveChatDebounced ");
  }
}
class X7 {
  constructor(t, n, r) {
    nt(this, "config");
    nt(this, "textProcessor");
    nt(this, "llmAdapter");
    nt(this, "currentChatId", null);
    nt(this, "isRunning", !1);
    nt(this, "isSummarizing", !1);
    nt(this, "cancelRequested", !1);
    // 
    nt(this, "unsubscribeMessage", null);
    nt(this, "unsubscribeChat", null);
    nt(this, "summaryHistory", []);
    // 
    nt(this, "_lastSummarizedFloor", 0);
    const a = We.get("summarizerConfig");
    this.config = { ...Y7, ...a, ...t }, this.textProcessor = n || G7, this.llmAdapter = r || Oo;
  }
  // ====================  ====================
  // getInfoFromChatMetadata  saveToChatMetadata 
  //  WorldBookStateService
  /**
   * 
   */
  getFromChatMetadata(t) {
    const n = fS();
    if (n)
      return n.extensions || (n.extensions = {}), n.extensions[Bl] || (n.extensions[Bl] = {}), n.extensions[Bl][t];
  }
  /**
   * 
   */
  saveToChatMetadata(t, n) {
    const r = fS();
    r && (r.extensions || (r.extensions = {}), r.extensions[Bl] || (r.extensions[Bl] = {}), r.extensions[Bl][t] = n, this.log("debug", ` chat_metadata: ${t} = ${n}`), H$());
  }
  /**
   * 
   * V0.5:  memoryStore 
   * V0.8:  chatManager.getState() 
   */
  async getLastSummarizedFloor() {
    if (this._lastSummarizedFloor > 0) return this._lastSummarizedFloor;
    try {
      const { chatManager: t } = await Promise.resolve().then(() => C$), n = await t.getState();
      return this._lastSummarizedFloor = n.last_summarized_floor, this.log("debug", " DB  lastSummarizedFloor", { value: this._lastSummarizedFloor }), this._lastSummarizedFloor;
    } catch (t) {
      return this.log("warn", " lastSummarizedFloor  0", t), 0;
    }
  }
  /**
   * 
   * V0.5:  memoryStore (IndexedDB)
   */
  async setLastSummarizedFloor(t) {
    this._lastSummarizedFloor = t, await yr.getState().setLastSummarizedFloor(t);
  }
  // ====================  ====================
  /**
   * 
   */
  getCurrentFloor() {
    const t = dS();
    return t != null && t.chat ? t.chat.length : 0;
  }
  /**
   *  ID
   */
  getCurrentChatId() {
    const t = dS();
    return (t == null ? void 0 : t.chatId) || null;
  }
  // ====================  ====================
  /**
   * 
   * V0.5:  EventWatcher 
   */
  start() {
    if (this.isRunning) {
      this.log("warn", "");
      return;
    }
    this.initializeForCurrentChat(), Gg.start(), this.config.triggerMode === "auto" && (this.unsubscribeMessage = Gg.on(
      "onMessageReceived",
      this.handleMessageReceived.bind(this)
    ), this.log("debug", " EventWatcher ")), this.unsubscribeChat = Gg.on(
      "onChatChanged",
      this.handleChatChanged.bind(this)
    ), this.log("debug", " EventWatcher "), this.isRunning = !0;
    const t = this.getStatus();
    this.log("info", "", t);
  }
  /**
   *  ( 0)
   */
  async resetProgress() {
    await this.setLastSummarizedFloor(0), this.log("info", "");
  }
  /**
   * 
   */
  stop() {
    this.unsubscribeMessage && (this.unsubscribeMessage(), this.unsubscribeMessage = null), this.unsubscribeChat && (this.unsubscribeChat(), this.unsubscribeChat = null), this.isRunning = !1, this.log("info", "");
  }
  /**
   * 
   */
  async initializeForCurrentChat() {
    const t = this.getCurrentChatId(), n = this.getCurrentFloor();
    this.currentChatId = t, this.summaryHistory = [], this._lastSummarizedFloor = 0;
    const r = await this.getLastSummarizedFloor();
    this.log("info", "", {
      chatId: t,
      currentFloor: n,
      lastSummarizedFloor: r,
      pendingFloors: n - r
    });
  }
  // ====================  ====================
  /**
   * 
   * V0.9.1:  Summary 
   */
  async handleMessageReceived() {
    const t = this.getCurrentFloor(), n = await this.getLastSummarizedFloor(), r = t - n;
    this.log("debug", "", {
      currentFloor: t,
      lastSummarized: n,
      pendingFloors: r,
      triggerAt: this.config.floorInterval
    }), await this.checkEntityExtraction(t), r >= this.config.floorInterval && (this.log("info", "", {
      pendingFloors: r,
      interval: this.config.floorInterval
    }), await this.triggerSummary());
  }
  /**
   * V0.9.1: 
   *  Summary 
   */
  async checkEntityExtraction(t) {
    try {
      const { entityBuilder: n } = await Promise.resolve().then(() => _U);
      if (n.shouldTriggerOnFloor(t)) {
        this.log("info", "", { floor: t });
        const r = await ji.getChatHistory("50");
        n.extractFromChat(r, t, !1).catch((a) => {
          this.log("warn", "", { error: a });
        });
      }
    } catch (n) {
      this.log("warn", "", { error: n });
    }
  }
  /**
   * 
   */
  handleChatChanged() {
    const t = this.getCurrentChatId();
    this.log("info", "", {
      from: this.currentChatId,
      to: t
    }), this.initializeForCurrentChat();
  }
  // ====================  ====================
  /**
   * /
   */
  async triggerSummary(t = !1) {
    var o, l, u;
    if (this.isSummarizing)
      return this.log("warn", ""), null;
    if (!this.config.enabled && !t)
      return this.log("debug", ""), null;
    const n = this.getCurrentFloor(), r = await this.getLastSummarizedFloor();
    this.isSummarizing = !0, this.cancelRequested = !1, this.log("info", "", {
      floorRange: [r + 1, n],
      manual: t
    });
    const a = St.running("...", "Engram", () => {
      var f, d, m, p;
      this.cancelRequested = !0, this.log("info", "");
      try {
        (p = (m = (d = (f = window.SillyTavern) == null ? void 0 : f.getContext) == null ? void 0 : d.call(f)) == null ? void 0 : m.stopGeneration) == null || p.call(m), this.log("info", " stopGeneration");
      } catch (x) {
        this.log("warn", " stopGeneration ", x);
      }
      St.warning("...", "Engram");
    });
    try {
      const { WorldBookSlotService: f } = await Promise.resolve().then(() => SU);
      await f.init();
      const d = this._lastSummarizedFloor + 1, m = this.config.bufferSize || 0, p = n - m;
      if (d > p)
        return t && St.info(" ()", "Engram"), null;
      const x = this.config.floorInterval || 10, y = d + x - 1, w = Math.min(p, y);
      if (d > w)
        return null;
      const E = [d, w];
      this.log("info", "", { startFloor: d, endFloor: w, currentFloor: n, buffer: m });
      const C = RD().slice(d - 1, w);
      if (this.log("info", "", {
        range: E,
        msgCount: C.length,
        firstMsg: (((o = C[0]) == null ? void 0 : o.mes) || "").substring(0, 20)
      }), C.length === 0)
        return this.log("warn", "", { floorRange: E }), null;
      const T = {
        messages: C.map((L) => {
          const J = L.mes || L.content || L.message || "";
          return J || console.warn("[Engram] Message content is empty/undefined:", L), {
            role: L.is_user ? "user" : "assistant",
            content: J,
            name: L.name
          };
        }),
        floorRange: E,
        templateId: this.config.promptTemplateId || void 0
      }, N = C.map((L) => L.mes || L.content || L.message || "").join(`

`), A = fi.process(N, "input");
      this.log("debug", "", {
        originalLength: N.length,
        cleanedLength: A.length
      });
      let D = "";
      try {
        const L = await zt.getActivatedWorldInfo();
        L && (D = `
` + L + `

`, this.log("debug", "", { length: L.length }));
      } catch (L) {
        this.log("warn", "", { error: String(L) });
      }
      const M = We.getEnabledPromptTemplate("summary"), O = N2("summary"), Y = (M == null ? void 0 : M.systemPrompt) || (O == null ? void 0 : O.systemPrompt) || "", X = (M == null ? void 0 : M.userPromptTemplate) || (O == null ? void 0 : O.userPromptTemplate) || "";
      let U = "";
      try {
        U = await zt.getEngramSummariesContent(), U && this.log("debug", " Engram ", { length: U.length });
      } catch (L) {
        this.log("warn", " Engram ", { error: String(L) });
      }
      const B = X.replace("{{worldbookContext}}", D).replace("{{chatHistory}}", A).replace("{{context}}", D).replace("{{engramSummaries}}", U);
      this.log("debug", "", {
        source: M ? "APIPresets" : "fallback",
        templateName: (M == null ? void 0 : M.name) || "default"
      });
      const G = Vr.logSend({
        type: "summarize",
        systemPrompt: Y,
        userPrompt: B,
        floorRange: T.floorRange,
        model: j2(),
        character: (l = Hc()) == null ? void 0 : l.name
      }), re = Date.now(), q = await this.llmAdapter.generate({
        systemPrompt: Y,
        userPrompt: B
      });
      if (Vr.logReceive(G, {
        response: q.content,
        status: q.success ? "success" : "error",
        error: q.error,
        duration: Date.now() - re
      }), !q.success)
        return this.log("error", "LLM ", { error: q.error }), St.error(`: ${q.error}`, "Engram "), null;
      if (this.cancelRequested)
        return this.log("info", ""), St.info("", "Engram"), null;
      const W = this.textProcessor.clean(q.content), V = fi.process(W, "output"), ee = await zt.countTokens(V), te = {
        id: Date.now().toString(),
        content: V,
        sourceFloors: T.floorRange,
        timestamp: Date.now(),
        tokenCount: ee,
        writtenToWorldbook: !1
      };
      if (this.config.previewEnabled) {
        this.log("info", "", { result: te });
        try {
          const L = await Y2.requestRevision(
            "",
            `: ${T.floorRange[0]} - ${T.floorRange[1]}  | Token: ${ee}`,
            te.content
          );
          te.content = L, te.tokenCount = await zt.countTokens(L), this.log("info", "");
        } catch {
          return this.log("warn", ""), St.info("", ""), null;
        }
      }
      const ie = or(), H = Hc();
      if (ie && H)
        try {
          const L = await O$.run({
            jsonContent: te.content,
            //  JSON
            sourceRange: {
              start: T.floorRange[0],
              end: T.floorRange[1]
            }
          });
          L.success ? this.log("info", "Pipeline ", {
            eventsCount: ((u = L.events) == null ? void 0 : u.length) || 0
          }) : this.log("warn", "Pipeline ", { error: L.error });
        } catch (L) {
          this.log("error", "Pipeline ", { error: String(L) });
        }
      if (te.writtenToWorldbook = !0, await this.setLastSummarizedFloor(T.floorRange[1]), this.summaryHistory.push(te), St.success(` ${T.floorRange[0]}-${T.floorRange[1]} `, "Engram"), this.config.autoHide) {
        const L = T.floorRange[0] - 1, J = T.floorRange[1] - 1;
        this.log("info", "", { startIndex: L, endIndex: J }), F$(L, J).catch((F) => {
          this.log("error", "", F);
        });
      }
      return te;
    } catch (f) {
      const d = f instanceof Error ? f.message : String(f);
      return this.log("error", "", { error: d }), St.error(`: ${d}`, "Engram "), null;
    } finally {
      St.remove(a), this.isSummarizing = !1;
    }
  }
  // ====================  ====================
  /**
   * 
   */
  getStatus() {
    const t = this.getCurrentFloor(), n = this._lastSummarizedFloor;
    return {
      running: this.isRunning,
      currentFloor: t,
      lastSummarizedFloor: n,
      pendingFloors: Math.max(0, t - n),
      historyCount: this.summaryHistory.length,
      isSummarizing: this.isSummarizing
    };
  }
  /**
   * 
   */
  refreshStatus() {
    return this.initializeForCurrentChat(), this.getStatus();
  }
  /**
   * 
   */
  getConfig() {
    return { ...this.config };
  }
  /**
   * 
   */
  updateConfig(t) {
    this.config = { ...this.config, ...t }, We.set("summarizerConfig", this.config), this.log("debug", "", this.config);
  }
  /**
   * 
   */
  getHistory() {
    return [...this.summaryHistory];
  }
  /**
   * 
   */
  async resetBaseFloor() {
    const t = this.getCurrentFloor();
    await this.setLastSummarizedFloor(t), this.log("info", "", { currentFloor: t });
  }
  // ====================  ====================
  /**
   * 
   */
  async log(t, n, r) {
    try {
      const { Logger: a } = await Promise.resolve().then(() => E2);
      a[t]("Summarizer", n, r);
    } catch {
      console.log(`[Summarizer] ${t}: ${n}`, r);
    }
  }
}
const Wi = new X7(), W7 = {
  ...ND,
  keepRecentCount: 3,
  preserveOriginal: !1,
  previewEnabled: !0
};
class Q7 {
  constructor(t, n) {
    nt(this, "config");
    nt(this, "llmAdapter");
    nt(this, "isTrimming", !1);
    const r = We.get("trimmerConfig") || {};
    this.config = { ...W7, ...r, ...t }, this.llmAdapter = n || Oo;
  }
  // ====================  ====================
  /**
   * 
   */
  getConfig() {
    return { ...this.config };
  }
  /**
   * 
   */
  updateConfig(t) {
    this.config = { ...this.config, ...t };
    const n = We.get("summarizerConfig") || {};
    We.set("summarizerConfig", {
      ...n,
      trimmer: this.config
    }), this.log("debug", "", this.config);
  }
  // ====================  ====================
  /**
   * 
   */
  async getStatus() {
    const t = zt.findExistingWorldbook();
    if (!t)
      return {
        triggered: !1,
        triggerType: this.config.trigger,
        currentValue: 0,
        threshold: this.getThreshold(),
        pendingEntryCount: 0,
        isTrimming: this.isTrimming
      };
    const n = await zt.getSummaryEntries(t), r = Math.max(0, n.length - this.config.keepRecentCount), a = await this.getCurrentTriggerValue(t, n), o = this.getThreshold();
    return {
      triggered: this.config.enabled && a >= o,
      triggerType: this.config.trigger,
      currentValue: a,
      threshold: o,
      pendingEntryCount: r,
      isTrimming: this.isTrimming
    };
  }
  /**
   * 
   */
  getThreshold() {
    switch (this.config.trigger) {
      case "token":
        return this.config.tokenLimit;
      case "count":
        return this.config.countLimit;
      default:
        return 0;
    }
  }
  /**
   * 
   */
  async getCurrentTriggerValue(t, n) {
    switch (this.config.trigger) {
      case "token":
        return await zt.countSummaryTokens(t);
      case "count":
        return n.length;
      default:
        return 0;
    }
  }
  /**
   * 
   */
  async checkTrigger() {
    return (await this.getStatus()).triggered;
  }
  // ====================  ====================
  /**
   * 
   *  N 
   */
  async getEntriesToMerge() {
    const t = zt.findExistingWorldbook();
    if (!t) return [];
    const n = await zt.getSummaryEntries(t), r = this.config.keepRecentCount;
    return n.length <= r ? [] : n.slice(0, n.length - r);
  }
  /**
   * /
   */
  async triggerTrim(t = !1) {
    var a;
    if (this.isTrimming)
      return this.log("warn", ""), null;
    if (!this.config.enabled && !t)
      return this.log("debug", ""), null;
    const n = zt.findExistingWorldbook();
    if (!n)
      return this.log("warn", ""), St.warning(" Engram ", "Engram"), null;
    const r = await this.getEntriesToMerge();
    if (r.length < 2)
      return t && St.info(" ( 2 )", "Engram"), null;
    this.isTrimming = !0, this.log("info", "", {
      entryCount: r.length,
      manual: t
    });
    try {
      const o = r.map((O) => zt.parseFloorRangeFromName(O.name)).filter((O) => O !== null);
      if (o.length === 0)
        return this.log("error", ""), null;
      const l = Math.min(...o.map((O) => O[0])), u = Math.max(...o.map((O) => O[1])), f = [l, u], d = r.map((O) => {
        const Y = zt.parseFloorRangeFromName(O.name), X = Y ? `${Y[0]}-${Y[1]}` : `${O.name}`, U = O.content.replace(/\{\{\/\/.*?\}\}/gs, "").trim();
        return `${X}
${U}`;
      }).join(`

---

`), m = We.getEnabledPromptTemplate("trim"), p = N2("trim"), x = (m == null ? void 0 : m.systemPrompt) || (p == null ? void 0 : p.systemPrompt) || "", w = ((m == null ? void 0 : m.userPromptTemplate) || (p == null ? void 0 : p.userPromptTemplate) || "").replace("{{engramSummaries}}", d).replace("{{context}}", d);
      this.log("debug", "", {
        source: m ? "APIPresets" : "fallback",
        templateName: (m == null ? void 0 : m.name) || "default",
        inputLength: d.length
      });
      const E = Vr.logSend({
        type: "trim",
        systemPrompt: x,
        userPrompt: w,
        floorRange: f,
        model: j2(),
        character: (a = Hc()) == null ? void 0 : a.name
      }), k = Date.now(), C = await this.llmAdapter.generate({
        systemPrompt: x,
        userPrompt: w
      });
      if (Vr.logReceive(E, {
        response: C.content,
        status: C.success ? "success" : "error",
        error: C.error,
        duration: Date.now() - k
      }), !C.success)
        return this.log("error", "LLM ", { error: C.error }), St.error(`: ${C.error}`, "Engram "), null;
      const T = fi.process(C.content, "output"), N = await zt.countTokens(T), A = Math.min(...r.map((O) => O.order)), D = {
        content: T,
        tokenCount: N,
        sourceEntryIds: r.map((O) => O.uid),
        newFloorRange: f,
        newOrder: A
      };
      if (this.config.previewEnabled) {
        this.log("info", "", { result: D });
        try {
          const O = await Y2.requestRevision(
            "",
            ` ${r.length}  | : ${f[0]}-${f[1]}  | Token: ${N}`,
            D.content
          );
          D.content = O, D.tokenCount = await zt.countTokens(O), this.log("info", "");
        } catch {
          return this.log("warn", ""), St.info("", ""), null;
        }
      }
      return await this.writeCompactedEntry(n, D) ? (await this.removeOriginalEntries(n, D.sourceEntryIds), St.success(
        ` ${r.length}  1  (${f[0]}-${f[1]} )`,
        "Engram"
      ), D) : (this.log("error", ""), null);
    } catch (o) {
      const l = o instanceof Error ? o.message : String(o);
      return this.log("error", "", { error: l }), St.error(`: ${l}`, "Engram "), null;
    } finally {
      this.isTrimming = !1;
    }
  }
  /**
   * 
   */
  async writeCompactedEntry(t, n) {
    try {
      const r = `{{// ${JSON.stringify({
        floors: n.newFloorRange,
        tokens: n.tokenCount,
        timestamp: Date.now(),
        layer: 2,
        // 
        mergedFrom: n.sourceEntryIds.length
      })} }}`, a = `${n.content}

${r}`, o = await zt.createEntry(t, {
        name: `_${n.newFloorRange[0]}-${n.newFloorRange[1]}`,
        content: a,
        keys: [Bc],
        // 
        enabled: !0,
        constant: !0,
        order: n.newOrder
      });
      return o && this.log("success", "", {
        worldbook: t,
        floorRange: n.newFloorRange,
        order: n.newOrder
      }), o;
    } catch (r) {
      return this.log("error", "", { error: String(r) }), !1;
    }
  }
  /**
   * /
   */
  async removeOriginalEntries(t, n) {
    if (this.config.preserveOriginal) {
      for (const r of n)
        await zt.updateEntry(t, r, { enabled: !1 });
      this.log("info", "", { count: n.length });
    } else
      await zt.deleteEntries(t, n) && this.log("info", "", { count: n.length });
  }
  // ====================  ====================
  /**
   * 
   */
  log(t, n, r) {
    le[t]("Trimmer", n, r);
  }
}
new Q7();
const Ki = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  DEFAULT_REGEX_RULES: eu,
  DEFAULT_SUMMARIZER_CONFIG: Y7,
  DEFAULT_TRIMMER_CONFIG: W7,
  LLMAdapter: V7,
  RegexProcessor: Vh,
  SummarizerService: X7,
  TextProcessor: H7,
  TrimmerService: Q7,
  llmAdapter: Oo,
  regexProcessor: fi,
  summarizerService: Wi,
  textProcessor: G7
}, Symbol.toStringTag, { value: "Module" }));
function G$(e = 2e3) {
  const [t, n] = P.useState(!0), [r, a] = P.useState({
    isConnected: !1,
    characterName: "Unknown",
    currentFloor: 0,
    lastSummarizedFloor: 0,
    pendingFloors: 0,
    floorInterval: 10,
    isSummarizing: !1
  }), [o, l] = P.useState({
    eventCount: 0,
    entityCount: 0,
    entityByType: {},
    archivedCount: 0,
    activeCount: 0,
    estimatedTokens: 0
  }), [u, f] = P.useState({
    summarizer: !0,
    entity: !1,
    embedding: !1,
    recall: !0,
    preprocessing: !1
  }), d = yr((y) => y.getAllEvents), m = yr((y) => y.getAllEntities), p = P.useCallback(async () => {
    try {
      const y = Ga(), w = Wi.getStatus(), E = We.get("summarizerConfig") || {};
      a({
        isConnected: !!y,
        characterName: (y == null ? void 0 : y.name2) || "Unknown",
        currentFloor: w.currentFloor,
        lastSummarizedFloor: w.lastSummarizedFloor,
        pendingFloors: w.pendingFloors,
        floorInterval: E.floorInterval || 10,
        isSummarizing: w.isSummarizing
      });
      const k = await d(), C = await m(), T = {};
      C.forEach((U) => {
        T[U.type] = (T[U.type] || 0) + 1;
      });
      const N = k.filter((U) => U.is_archived), A = k.reduce((U, B) => {
        var G;
        return U + Math.ceil((((G = B.summary) == null ? void 0 : G.length) || 0) / 4);
      }, 0);
      l({
        eventCount: k.length,
        entityCount: C.length,
        entityByType: T,
        archivedCount: N.length,
        activeCount: k.length - N.length,
        estimatedTokens: A
      });
      const D = We.get("apiSettings"), M = D == null ? void 0 : D.entityExtractConfig, O = D == null ? void 0 : D.embeddingConfig, Y = D == null ? void 0 : D.recallConfig, X = We.get("preprocessingConfig");
      f({
        summarizer: E.enabled !== !1,
        entity: (M == null ? void 0 : M.enabled) || !1,
        embedding: (O == null ? void 0 : O.enabled) || !1,
        recall: (Y == null ? void 0 : Y.enabled) !== !1,
        preprocessing: (X == null ? void 0 : X.enabled) || !1
      }), n(!1);
    } catch (y) {
      console.error("[useDashboardData] Error refreshing data:", y), n(!1);
    }
  }, [d, m]), x = P.useCallback((y) => {
    const w = We.get("apiSettings") || {}, E = We.get("summarizerConfig") || {};
    switch (y) {
      case "summarizer":
        const k = !u.summarizer;
        We.set("summarizerConfig", {
          ...E,
          enabled: k
        }), Wi.updateConfig({ enabled: k });
        break;
      case "entity":
        const C = (w == null ? void 0 : w.entityExtractConfig) || {};
        We.set("apiSettings", {
          ...w,
          entityExtractConfig: {
            ...C,
            enabled: !u.entity
          }
        });
        break;
      case "embedding":
        const T = (w == null ? void 0 : w.embeddingConfig) || {};
        We.set("apiSettings", {
          ...w,
          embeddingConfig: {
            ...T,
            enabled: !u.embedding
          }
        });
        break;
      case "recall":
        const N = (w == null ? void 0 : w.recallConfig) || {};
        We.set("apiSettings", {
          ...w,
          recallConfig: {
            ...N,
            enabled: !u.recall
          }
        });
        break;
      case "preprocessing":
        const A = We.get("preprocessingConfig") || {};
        We.set("preprocessingConfig", {
          ...A,
          enabled: !u.preprocessing
        });
        break;
    }
    p();
  }, [u, p]);
  return P.useEffect(() => {
    p();
    const y = setInterval(p, e);
    return () => clearInterval(y);
  }, [p, e]), {
    system: r,
    memory: o,
    features: u,
    isLoading: t,
    toggleFeature: x,
    refresh: p
  };
}
const V$ = (e) => {
  switch (e) {
    case 0:
      return "text-muted-foreground";
    case 1:
      return "text-primary";
    case 2:
      return "text-green-400";
    case 3:
      return "text-yellow-400";
    case 4:
      return "text-red-400";
    default:
      return "text-primary";
  }
}, K$ = [
  { key: "summarizer", label: "", desc: "", icon: ij },
  { key: "entity", label: "", desc: "/", icon: uj },
  { key: "embedding", label: "", desc: "", icon: hi },
  { key: "recall", label: "RAG ", desc: "", icon: hi },
  { key: "preprocessing", label: "", desc: "Query /", icon: hj }
], Y$ = ch.filter((e) => e.id !== "dashboard"), hS = ({ onNavigate: e }) => {
  const [t, n] = P.useState([]), [r, a] = P.useState(0), { system: o, memory: l, features: u, toggleFeature: f } = G$(2e3);
  P.useEffect(() => (n(le.getLogs().slice(0, 4)), le.subscribe((w) => {
    n((E) => [w, ...E].slice(0, 4));
  })), []), P.useEffect(() => {
    const y = setInterval(() => a((w) => w + 1), 1e3);
    return () => clearInterval(y);
  }, []);
  const d = (y) => {
    const w = Math.floor(y / 3600), E = Math.floor(y % 3600 / 60), k = y % 60;
    return `${w.toString().padStart(2, "0")}:${E.toString().padStart(2, "0")}:${k.toString().padStart(2, "0")}`;
  }, m = (y) => e == null ? void 0 : e(y), p = o.floorInterval > 0 ? Math.min(100, o.pendingFloors / o.floorInterval * 100) : 0, x = l.eventCount > 0 ? Math.round(l.archivedCount / l.eventCount * 100) : 0;
  return /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col h-full", children: [
    /* @__PURE__ */ h.jsxs("div", { className: "mb-6", children: [
      /* @__PURE__ */ h.jsx("h1", { className: "text-2xl font-light text-foreground tracking-tight mb-2", children: "" }),
      /* @__PURE__ */ h.jsx("p", { className: "text-sm text-muted-foreground", children: "" })
    ] }),
    /* @__PURE__ */ h.jsx(Fn, { className: "mb-6" }),
    /* @__PURE__ */ h.jsx("div", { className: "flex-1 overflow-y-auto no-scrollbar", children: /* @__PURE__ */ h.jsxs("div", { className: "grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-12", children: [
      /* @__PURE__ */ h.jsxs("section", { className: "space-y-8", children: [
        /* @__PURE__ */ h.jsxs("div", { children: [
          /* @__PURE__ */ h.jsx("h2", { className: "text-xs font-medium text-muted-foreground uppercase tracking-wider mb-4", children: "" }),
          /* @__PURE__ */ h.jsxs("div", { className: "grid grid-cols-2 gap-6", children: [
            /* @__PURE__ */ h.jsxs("div", { children: [
              /* @__PURE__ */ h.jsx("span", { className: "text-xs text-muted-foreground block mb-1", children: "" }),
              /* @__PURE__ */ h.jsxs("div", { className: `flex items-center gap-2 text-lg font-medium ${o.isConnected ? "text-green-500" : "text-muted-foreground"}`, children: [
                o.isConnected ? /* @__PURE__ */ h.jsx(Oh, { size: 18 }) : /* @__PURE__ */ h.jsx(Fs, { size: 18 }),
                o.isConnected ? o.characterName : ""
              ] })
            ] }),
            /* @__PURE__ */ h.jsxs("div", { children: [
              /* @__PURE__ */ h.jsx("span", { className: "text-xs text-muted-foreground block mb-1", children: "" }),
              /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-2", children: [
                /* @__PURE__ */ h.jsx("span", { className: "text-3xl font-light text-amber-500 font-mono", children: o.pendingFloors }),
                /* @__PURE__ */ h.jsxs("span", { className: "text-muted-foreground", children: [
                  "/ ",
                  o.floorInterval
                ] }),
                o.isSummarizing && /* @__PURE__ */ h.jsx(Ka, { size: 14, className: "animate-spin text-primary ml-1" })
              ] }),
              /* @__PURE__ */ h.jsx("div", { className: "mt-2 h-1 bg-border rounded-full overflow-hidden", children: /* @__PURE__ */ h.jsx(
                "div",
                {
                  className: `h-full transition-all duration-300 ${p >= 80 ? "bg-amber-500" : "bg-primary"}`,
                  style: { width: `${p}%` }
                }
              ) })
            ] })
          ] })
        ] }),
        /* @__PURE__ */ h.jsx(Fn, { length: 100, spacing: "md" }),
        /* @__PURE__ */ h.jsxs("div", { children: [
          /* @__PURE__ */ h.jsx("h2", { className: "text-xs font-medium text-muted-foreground uppercase tracking-wider mb-4", children: "" }),
          /* @__PURE__ */ h.jsxs("div", { className: "grid grid-cols-2 gap-6", children: [
            /* @__PURE__ */ h.jsxs("div", { children: [
              /* @__PURE__ */ h.jsx("span", { className: "text-[10px] text-muted-foreground/70 uppercase tracking-wider block mb-1", children: "" }),
              /* @__PURE__ */ h.jsxs("div", { className: "flex items-baseline gap-2", children: [
                /* @__PURE__ */ h.jsx("span", { className: "text-xl font-mono text-foreground/80", children: l.eventCount }),
                /* @__PURE__ */ h.jsxs("span", { className: "text-xs text-muted-foreground", children: [
                  "~",
                  l.estimatedTokens.toLocaleString(),
                  " tok"
                ] })
              ] }),
              /* @__PURE__ */ h.jsxs("div", { className: "mt-2 flex items-center gap-2 text-[10px] text-muted-foreground", children: [
                /* @__PURE__ */ h.jsxs("span", { children: [
                  " ",
                  l.activeCount
                ] }),
                /* @__PURE__ */ h.jsx("div", { className: "flex-1 h-1 bg-border rounded-full overflow-hidden", children: /* @__PURE__ */ h.jsx("div", { className: "h-full bg-primary", style: { width: `${100 - x}%` } }) }),
                /* @__PURE__ */ h.jsxs("span", { children: [
                  " ",
                  l.archivedCount
                ] })
              ] })
            ] }),
            /* @__PURE__ */ h.jsxs("div", { children: [
              /* @__PURE__ */ h.jsx("span", { className: "text-[10px] text-muted-foreground/70 uppercase tracking-wider block mb-1", children: "" }),
              /* @__PURE__ */ h.jsx("div", { className: "text-xl font-mono text-foreground/80", children: l.entityCount }),
              l.entityCount > 0 && /* @__PURE__ */ h.jsx("div", { className: "flex gap-2 mt-2", children: Object.entries(l.entityByType).slice(0, 3).map(([y, w]) => /* @__PURE__ */ h.jsxs("span", { className: "text-[10px] text-muted-foreground", children: [
                y,
                ": ",
                w
              ] }, y)) })
            ] })
          ] })
        ] }),
        /* @__PURE__ */ h.jsx(Fn, { length: 30, spacing: "md" }),
        /* @__PURE__ */ h.jsxs("div", { children: [
          /* @__PURE__ */ h.jsx("span", { className: "text-[10px] text-muted-foreground/60 uppercase tracking-wider block mb-1", children: "" }),
          /* @__PURE__ */ h.jsx("div", { className: "text-sm font-mono text-primary/80", children: d(r) })
        ] }),
        /* @__PURE__ */ h.jsx(Fn, { length: 100 }),
        /* @__PURE__ */ h.jsxs("div", { children: [
          /* @__PURE__ */ h.jsx("h2", { className: "text-xs font-medium text-muted-foreground uppercase tracking-wider mb-4", children: "" }),
          /* @__PURE__ */ h.jsx("div", { className: "grid grid-cols-5 gap-3", children: Y$.map(({ id: y, label: w, icon: E, path: k }) => /* @__PURE__ */ h.jsxs(
            "button",
            {
              onClick: () => m(k.replace("/", "")),
              className: "flex flex-col items-center gap-2 p-3 rounded-lg text-muted-foreground hover:text-foreground hover:bg-accent/50 transition-all group",
              children: [
                /* @__PURE__ */ h.jsx(E, { size: 20, className: "text-primary group-hover:scale-110 transition-transform" }),
                /* @__PURE__ */ h.jsx("span", { className: "text-xs", children: w })
              ]
            },
            y
          )) })
        ] })
      ] }),
      /* @__PURE__ */ h.jsxs("section", { className: "space-y-6 lg:pl-8 relative", children: [
        /* @__PURE__ */ h.jsx(Fn, { responsive: !0, length: 30 }),
        /* @__PURE__ */ h.jsxs("div", { children: [
          /* @__PURE__ */ h.jsx("h2", { className: "text-xs font-medium text-muted-foreground uppercase tracking-wider mb-4", children: "" }),
          /* @__PURE__ */ h.jsx("div", { className: "space-y-4", children: K$.map(({ key: y, label: w, desc: E, icon: k }) => {
            const C = u[y];
            return /* @__PURE__ */ h.jsxs("div", { className: "flex items-center justify-between", children: [
              /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-3 min-w-0 flex-1", children: [
                /* @__PURE__ */ h.jsx("div", { className: `p-1.5 rounded-lg ${C ? "bg-primary/10 text-primary" : "bg-muted text-muted-foreground"}`, children: /* @__PURE__ */ h.jsx(k, { size: 14 }) }),
                /* @__PURE__ */ h.jsxs("div", { className: "min-w-0 flex-1", children: [
                  /* @__PURE__ */ h.jsx("span", { className: `text-sm ${C ? "text-foreground" : "text-muted-foreground"}`, children: w }),
                  /* @__PURE__ */ h.jsx("p", { className: "text-[10px] text-muted-foreground truncate", children: E })
                ] })
              ] }),
              /* @__PURE__ */ h.jsx(Jn, { checked: C, onChange: () => f(y) })
            ] }, y);
          }) })
        ] }),
        /* @__PURE__ */ h.jsx(Fn, { length: 100, spacing: "md" }),
        /* @__PURE__ */ h.jsxs("div", { children: [
          /* @__PURE__ */ h.jsxs("div", { className: "flex items-center justify-between mb-4", children: [
            /* @__PURE__ */ h.jsx("h2", { className: "text-xs font-medium text-muted-foreground uppercase tracking-wider", children: "" }),
            /* @__PURE__ */ h.jsxs(
              "button",
              {
                onClick: () => m("devlog"),
                className: "text-[10px] text-primary hover:underline flex items-center gap-0.5",
                children: [
                  " ",
                  /* @__PURE__ */ h.jsx(lu, { size: 12 })
                ]
              }
            )
          ] }),
          /* @__PURE__ */ h.jsx("div", { className: "font-mono text-[11px] space-y-1.5", children: t.length === 0 ? /* @__PURE__ */ h.jsx("div", { className: "text-muted-foreground text-center py-4 italic", children: "" }) : t.map((y) => /* @__PURE__ */ h.jsxs("div", { className: `flex gap-2 opacity-80 ${V$(y.level)}`, children: [
            /* @__PURE__ */ h.jsxs("span", { className: "text-muted-foreground shrink-0", children: [
              "[",
              new Date(y.timestamp).toLocaleTimeString([], { hour12: !1 }),
              "]"
            ] }),
            /* @__PURE__ */ h.jsx("span", { className: "text-foreground truncate", children: y.message })
          ] }, y.id)) })
        ] })
      ] })
    ] }) })
  ] });
}, X$ = P.lazy(() => Promise.resolve().then(() => PU).then((e) => ({ default: e.DevLog }))), W$ = P.lazy(() => Promise.resolve().then(() => lH).then((e) => ({ default: e.APIPresets }))), Q$ = P.lazy(() => Promise.resolve().then(() => dH).then((e) => ({ default: e.Settings }))), Z$ = P.lazy(() => Promise.resolve().then(() => qee).then((e) => ({ default: e.MemoryStream }))), J$ = P.lazy(() => Promise.resolve().then(() => ete).then((e) => ({ default: e.ProcessingView }))), eU = () => /* @__PURE__ */ h.jsx("div", { className: "flex items-center justify-center h-full", children: /* @__PURE__ */ h.jsx("div", { className: "animate-spin h-8 w-8 border-2 border-primary border-t-transparent rounded-full" }) }), tU = ({ onClose: e }) => {
  const [t, n] = P.useState("dashboard"), [r, a] = P.useState(!1), [o, l] = P.useState(!1), u = (m) => {
    const p = m.replace(/^\//, "");
    console.debug("[Engram] Navigating to:", p), n(p);
  };
  P.useEffect(() => {
    const m = setTimeout(() => {
      const p = We.get("hasSeenWelcome");
      console.debug("[Engram] hasSeenWelcome:", p), p || a(!0), l(!0);
    }, 1e3);
    return () => clearTimeout(m);
  }, []);
  const f = () => {
    We.set("hasSeenWelcome", !0), console.debug("[Engram] hasSeenWelcome saved"), a(!1);
  };
  if (!o)
    return null;
  const d = () => {
    const [m, p] = t.split(":");
    switch (m) {
      case "dashboard":
        return /* @__PURE__ */ h.jsx(hS, { onNavigate: n });
      case "presets":
        return /* @__PURE__ */ h.jsx(W$, { initialTab: p });
      case "devlog":
        return /* @__PURE__ */ h.jsx(X$, { initialTab: p });
      case "settings":
        return /* @__PURE__ */ h.jsx(Q$, {});
      case "memory":
        return /* @__PURE__ */ h.jsx(Z$, {});
      case "processing":
        return /* @__PURE__ */ h.jsx(J$, { onNavigate: n });
      default:
        return /* @__PURE__ */ h.jsx(hS, {});
    }
  };
  return (
    /*  */
    /* @__PURE__ */ h.jsxs(h.Fragment, { children: [
      r && /* @__PURE__ */ h.jsx(_$, { onComplete: f }),
      /* @__PURE__ */ h.jsx(w$, { activeTab: t, setActiveTab: u, onClose: e, children: /* @__PURE__ */ h.jsx(P.Suspense, { fallback: /* @__PURE__ */ h.jsx(eU, {}), children: d() }) })
    ] })
  );
}, nU = () => {
  const [e, t] = P.useState(!1), [n, r] = P.useState(null), [a, o] = P.useState(""), [l, u] = P.useState(!1);
  P.useEffect(() => {
    const p = di.on(
      Ni.ENGRAM_REQUEST_REVISION,
      (x) => {
        const y = x;
        r(y), o(y.content), t(!0);
      }
    );
    return () => {
      p();
    };
  }, []);
  const f = () => {
    n && (n.onConfirm(a), t(!1), r(null));
  }, d = () => {
    n && n.onCancel(), t(!1), r(null);
  }, m = async () => {
    if (n != null && n.onReroll) {
      u(!0);
      try {
        const p = await n.onReroll();
        o(p);
      } catch (p) {
        console.error("[RevisionModal] Reroll failed:", p);
      } finally {
        u(!1);
      }
    }
  };
  return e ? _2.createPortal(
    /* @__PURE__ */ h.jsxs(
      "div",
      {
        className: "fixed inset-0 z-[11000] flex items-center justify-center p-4",
        style: { height: "100dvh", width: "100vw" },
        children: [
          /* @__PURE__ */ h.jsx(
            "div",
            {
              className: "absolute inset-0 bg-background/80 backdrop-blur-sm animate-in fade-in duration-200",
              onClick: d
            }
          ),
          /* @__PURE__ */ h.jsxs("div", { className: "relative w-full max-w-2xl bg-popover border border-border rounded-lg shadow-2xl flex flex-col max-h-[85vh] animate-in zoom-in-95 slide-in-from-bottom-2 duration-200", children: [
            /* @__PURE__ */ h.jsxs("div", { className: "flex items-start justify-between p-5 border-b border-border", children: [
              /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col gap-1", children: [
                /* @__PURE__ */ h.jsx("h3", { className: "text-lg font-medium text-foreground tracking-tight", children: (n == null ? void 0 : n.title) || "" }),
                (n == null ? void 0 : n.description) && /* @__PURE__ */ h.jsx("p", { className: "text-sm text-muted-foreground", children: n.description })
              ] }),
              /* @__PURE__ */ h.jsx(
                "button",
                {
                  onClick: d,
                  className: "p-2 -m-2 text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors",
                  "aria-label": "",
                  children: /* @__PURE__ */ h.jsx(cu, { size: 18 })
                }
              )
            ] }),
            /* @__PURE__ */ h.jsxs("div", { className: "flex-1 p-5 overflow-hidden flex flex-col gap-4", children: [
              /* @__PURE__ */ h.jsxs("div", { className: "flex items-start gap-3 p-3 bg-primary/10 border border-primary/20 rounded-md", children: [
                /* @__PURE__ */ h.jsx(dj, { size: 16, className: "text-primary shrink-0 mt-0.5" }),
                /* @__PURE__ */ h.jsx("p", { className: "text-sm text-foreground/80 leading-relaxed", children: "" })
              ] }),
              /* @__PURE__ */ h.jsx(
                "textarea",
                {
                  value: a,
                  onChange: (p) => o(p.target.value),
                  className: "flex-1 w-full min-h-[200px] p-4 bg-muted border border-border rounded-md font-mono text-sm text-foreground leading-relaxed placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring resize-none",
                  spellCheck: !1,
                  placeholder: "..."
                }
              ),
              /* @__PURE__ */ h.jsxs("div", { className: "text-xs text-muted-foreground text-right font-mono", children: [
                a.length,
                " "
              ] })
            ] }),
            /* @__PURE__ */ h.jsxs("div", { className: "flex items-center justify-between px-5 py-4 border-t border-border bg-muted/30", children: [
              /* @__PURE__ */ h.jsx("div", { children: (n == null ? void 0 : n.onReroll) && /* @__PURE__ */ h.jsxs(
                "button",
                {
                  onClick: m,
                  disabled: l,
                  className: "inline-flex items-center gap-2 px-4 py-2 text-sm font-medium rounded-lg transition-all duration-200 text-muted-foreground border border-border hover:bg-accent hover:text-foreground disabled:opacity-50 disabled:cursor-not-allowed",
                  children: [
                    l ? /* @__PURE__ */ h.jsx(Ka, { size: 16, className: "animate-spin" }) : /* @__PURE__ */ h.jsx(zn, { size: 16 }),
                    ""
                  ]
                }
              ) }),
              /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-3", children: [
                /* @__PURE__ */ h.jsx(
                  "button",
                  {
                    onClick: d,
                    disabled: l,
                    className: "px-4 py-2 text-sm font-medium text-muted-foreground hover:text-foreground border border-border rounded-lg hover:bg-accent transition-colors disabled:opacity-50",
                    children: ""
                  }
                ),
                /* @__PURE__ */ h.jsxs(
                  "button",
                  {
                    onClick: f,
                    disabled: l,
                    className: "inline-flex items-center gap-2 px-4 py-2 text-sm font-medium rounded-lg transition-all duration-200 bg-primary/20 text-primary border border-primary/50 shadow-[0_0_10px_rgba(var(--primary),0.2)] hover:bg-primary/30 hover:shadow-[0_0_15px_rgba(var(--primary),0.4)] focus:outline-none focus:ring-2 focus:ring-primary/50 disabled:opacity-50",
                    children: [
                      /* @__PURE__ */ h.jsx(zh, { size: 16 }),
                      ""
                    ]
                  }
                )
              ] })
            ] })
          ] })
        ]
      }
    ),
    document.body
  ) : null;
}, rU = ({
  isOpen: e,
  onClose: t,
  title: n,
  children: r,
  initialPosition: a,
  width: o = 320,
  minWidth: l = 280,
  maxWidth: u = 600,
  minHeight: f = 150,
  resizable: d = !0
}) => {
  const m = P.useRef(null), [p, x] = P.useState(a || { x: 100, y: 100 }), [y, w] = P.useState({ width: o, height: "auto" }), [E, k] = P.useState(!1), [C, T] = P.useState(!1), N = P.useRef({ x: 0, y: 0 }), A = P.useRef({ width: 0, height: 0, x: 0, y: 0 });
  P.useEffect(() => {
    e && !a && x({
      x: Math.max(50, (window.innerWidth - o) / 2),
      y: Math.max(50, window.innerHeight - 450)
    });
  }, [e, a, o]);
  const D = P.useCallback((X) => {
    if (!m.current) return;
    const U = m.current.getBoundingClientRect();
    N.current = {
      x: X.clientX - U.left,
      y: X.clientY - U.top
    }, k(!0);
  }, []), M = P.useCallback((X) => {
    if (E) {
      const U = Math.max(0, Math.min(window.innerWidth - (typeof y.width == "number" ? y.width : 300), X.clientX - N.current.x)), B = Math.max(0, Math.min(window.innerHeight - 100, X.clientY - N.current.y));
      x({ x: U, y: B });
    } else if (C && m.current) {
      const U = X.clientX - A.current.x, B = X.clientY - A.current.y, G = Math.max(l, Math.min(u, A.current.width + U)), re = Math.max(f, A.current.height + B);
      w({ width: G, height: re });
    }
  }, [E, C, y.width, l, u, f]), O = P.useCallback(() => {
    k(!1), T(!1);
  }, []), Y = P.useCallback((X) => {
    if (X.preventDefault(), X.stopPropagation(), !m.current) return;
    const U = m.current.getBoundingClientRect();
    A.current = {
      width: U.width,
      height: U.height,
      x: X.clientX,
      y: X.clientY
    }, T(!0);
  }, []);
  return P.useEffect(() => {
    if (E || C)
      return window.addEventListener("mousemove", M), window.addEventListener("mouseup", O), () => {
        window.removeEventListener("mousemove", M), window.removeEventListener("mouseup", O);
      };
  }, [E, C, M, O]), e ? _2.createPortal(
    /* @__PURE__ */ h.jsxs(
      "div",
      {
        ref: m,
        className: "fixed z-[11000] flex flex-col rounded-lg shadow-2xl border border-border overflow-hidden",
        style: {
          left: p.x,
          top: p.y,
          width: y.width,
          height: y.height === "auto" ? "auto" : y.height,
          minHeight: f,
          backgroundColor: "var(--popover, #1a1a2e)",
          backdropFilter: "blur(20px)",
          WebkitBackdropFilter: "blur(20px)"
        },
        children: [
          /* @__PURE__ */ h.jsxs(
            "div",
            {
              className: "flex items-center justify-between px-3 py-2 border-b border-border select-none",
              onMouseDown: D,
              style: {
                cursor: E ? "grabbing" : "grab",
                backgroundColor: "var(--surface, rgba(255,255,255,0.05))"
              },
              children: [
                /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-2", children: [
                  /* @__PURE__ */ h.jsx(bz, { size: 14, className: "text-muted-foreground" }),
                  /* @__PURE__ */ h.jsx("span", { className: "text-sm font-medium text-foreground", children: n })
                ] }),
                /* @__PURE__ */ h.jsx(
                  "button",
                  {
                    onClick: t,
                    className: "p-1 text-muted-foreground hover:text-foreground rounded transition-colors",
                    style: { backgroundColor: "transparent" },
                    "aria-label": "",
                    onMouseDown: (X) => X.stopPropagation(),
                    children: /* @__PURE__ */ h.jsx(cu, { size: 14 })
                  }
                )
              ]
            }
          ),
          /* @__PURE__ */ h.jsx("div", { className: "flex-1 overflow-auto p-3", children: r }),
          d && /* @__PURE__ */ h.jsx(
            "div",
            {
              className: "absolute bottom-0 right-0 w-4 h-4 cursor-se-resize",
              onMouseDown: Y,
              style: {
                background: "linear-gradient(135deg, transparent 50%, var(--border, #333) 50%)"
              }
            }
          )
        ]
      }
    ),
    document.body
  ) : null;
}, vh = {
  enabled: !1,
  templateId: "query_enhance",
  autoTrigger: !0,
  preview: !0
  // 
};
function mS(e) {
  var t, n;
  try {
    const r = (n = (t = window.SillyTavern) == null ? void 0 : t.getContext) == null ? void 0 : n.call(t);
    return r != null && r.substituteParams ? r.substituteParams(e) : (le.warn("Preprocessor", "substituteParams "), e);
  } catch (r) {
    return le.warn("Preprocessor", "substituteParams ", r), e;
  }
}
async function iU() {
  var e, t;
  try {
    const n = (t = (e = window.SillyTavern) == null ? void 0 : e.getContext) == null ? void 0 : t.call(e);
    n != null && n.stopGeneration && (n.stopGeneration(), le.info("Preprocessor", " stopGeneration"));
  } catch (n) {
    le.warn("Preprocessor", " stopGeneration ", n);
  }
}
function pS() {
  try {
    const e = Hc();
    return e == null ? void 0 : e.name;
  } catch {
  }
}
function gS() {
  try {
    return j2();
  } catch {
  }
}
const Co = class Co {
  constructor() {
    nt(this, "cancelRequested", !1);
  }
  // ... (rest of class)
  static getInstance() {
    return Co.instance || (Co.instance = new Co()), Co.instance;
  }
  /**
   * 
   */
  requestStopGeneration() {
    iU();
  }
  /**
   * 
   * @param userInput 
   * @returns 
   */
  async process(t) {
    var o;
    const n = Date.now(), r = this.getConfig();
    if (le.info("Preprocessor", "", {
      enabled: r.enabled,
      templateId: r.templateId,
      inputLength: t.length
    }), !r.enabled)
      return le.debug("Preprocessor", ""), {
        success: !0,
        output: null,
        query: null,
        rawOutput: "",
        processingTime: 0
      };
    this.cancelRequested = !1;
    const a = St.running("...", "Engram", () => {
      this.cancelRequested = !0, le.info("Preprocessor", ""), this.requestStopGeneration(), St.warning("...", "Engram");
    });
    try {
      const l = We.getPromptTemplateById(r.templateId);
      if (le.debug("Preprocessor", "", {
        templateId: r.templateId,
        found: !!l,
        templateName: l == null ? void 0 : l.name
      }), !l) {
        const w = ` ${r.templateId}  API `;
        return le.warn("Preprocessor", w), {
          success: !1,
          output: null,
          query: null,
          rawOutput: "",
          processingTime: Date.now() - n,
          error: w
        };
      }
      if (this.cancelRequested)
        return {
          success: !1,
          output: null,
          query: null,
          rawOutput: "",
          processingTime: Date.now() - n,
          error: ""
        };
      let u = l.systemPrompt.replace(/\{\{input\}\}/gi, t), f = l.userPromptTemplate.replace(/\{\{input\}\}/gi, t);
      u = mS(u), f = mS(f), le.debug("Preprocessor", "", {
        systemPromptLength: u.length,
        userPromptLength: f.length,
        userPromptPreview: f.substring(0, 100) + "..."
      });
      const d = Vr.logSend({
        type: "query",
        systemPrompt: u,
        userPrompt: f,
        model: gS() || "Unknown",
        character: pS() || "System"
      }), m = await Oo.generate({
        systemPrompt: u,
        userPrompt: f
      });
      if (Vr.logReceive(d, {
        response: m.content,
        status: m.success ? "success" : "error",
        error: m.error,
        duration: Date.now() - n
      }), this.cancelRequested)
        return le.info("Preprocessor", ""), {
          success: !1,
          output: null,
          query: null,
          rawOutput: "",
          processingTime: Date.now() - n,
          error: ""
        };
      if (!m.success || !m.content) {
        const w = m.error || "LLM ";
        return le.error("Preprocessor", "LLM ", { error: w }), {
          success: !1,
          output: null,
          query: null,
          rawOutput: "",
          processingTime: Date.now() - n,
          error: w
        };
      }
      const p = fi.process(m.content, "output"), x = fi.captureTags(p, ["output", "query"]);
      if (r.preview && x.output) {
        le.info("Preprocessor", "");
        try {
          const w = async () => {
            const k = Vr.logSend({
              type: "query",
              systemPrompt: u,
              userPrompt: f,
              model: gS() || "Unknown",
              character: pS() || "System"
            }), C = await Oo.generate({
              systemPrompt: u,
              userPrompt: f
            });
            if (Vr.logReceive(k, {
              response: C.content,
              status: C.success ? "success" : "error",
              error: C.error,
              duration: 0
            }), !C.success || !C.content)
              throw new Error(C.error || "LLM ");
            const T = fi.process(C.content, "output");
            return fi.captureTags(T, ["output", "query"]).output || T;
          }, E = await new Promise((k) => {
            di.emit(Ni.ENGRAM_REQUEST_REVISION, {
              title: "",
              content: x.output,
              description: "",
              onConfirm: (C) => k(C),
              onCancel: () => k(null),
              // V0.9.2:  Roll 
              onReroll: w
            });
          });
          if (E !== null)
            x.output = E, le.info("Preprocessor", "");
          else
            return le.info("Preprocessor", ""), {
              success: !1,
              output: null,
              query: null,
              rawOutput: "",
              processingTime: Date.now() - n,
              error: ""
            };
        } catch (w) {
          le.warn("Preprocessor", "", w);
        }
      }
      const y = Date.now() - n;
      return le.info("Preprocessor", "", {
        hasOutput: !!x.output,
        hasQuery: !!x.query,
        outputLength: ((o = x.output) == null ? void 0 : o.length) || 0,
        processingTime: y
      }), St.success("", "Engram"), {
        success: !0,
        output: x.output,
        query: x.query,
        rawOutput: p,
        processingTime: y
      };
    } catch (l) {
      const u = l instanceof Error ? l.message : "";
      return le.error("Preprocessor", "", { error: u, stack: l.stack }), St.error(`: ${u}`, "Engram"), {
        success: !1,
        output: null,
        query: null,
        rawOutput: "",
        processingTime: Date.now() - n,
        error: u
      };
    } finally {
      St.remove(a);
    }
  }
  /**
   * 
   */
  getConfig() {
    return We.get("preprocessingConfig") || vh;
  }
  /**
   * 
   */
  saveConfig(t) {
    le.debug("Preprocessor", "", t), We.set("preprocessingConfig", t);
  }
  /**
   * /
   */
  toggle() {
    const t = this.getConfig();
    return t.enabled = !t.enabled, this.saveConfig(t), le.info("Preprocessor", `${t.enabled ? "" : ""}`), t.enabled;
  }
};
nt(Co, "instance");
let Vb = Co;
const Qi = Vb.getInstance(), Fl = "__ENGRAM_STATE__", Pf = {
  lastSummarizedFloor: 0,
  totalSummaries: 0,
  totalTokens: 0,
  updatedAt: Date.now()
};
class Kb {
  /**
   * 
   */
  static async loadState(t) {
    try {
      const n = await zt.findEntryByKey(t, Fl);
      if (!n)
        return { ...Pf };
      try {
        const r = JSON.parse(n.content);
        return { ...Pf, ...r };
      } catch (r) {
        return le.warn("WorldBookStateService", "", r), { ...Pf };
      }
    } catch (n) {
      return le.error("WorldBookStateService", "", n), { ...Pf };
    }
  }
  /**
   * 
   */
  static async saveState(t, n) {
    try {
      const a = {
        ...await this.loadState(t),
        ...n,
        updatedAt: Date.now()
      }, o = JSON.stringify(a, null, 2), u = (await zt.getEntries(t)).filter(
        (f) => f.name === "Engram System State" || f.keys.includes(Fl)
      );
      if (u.length > 0) {
        u.sort((p, x) => {
          const y = p.keys.includes(Fl) ? 1 : 0;
          return (x.keys.includes(Fl) ? 1 : 0) - y;
        });
        const [f, ...d] = u;
        if (d.length > 0) {
          le.warn("WorldBookStateService", ` ${d.length} ...`);
          for (const p of d)
            await zt.deleteEntry(t, p.uid);
        }
        le.debug("WorldBookStateService", "", { uid: f.uid, state: a });
        const m = {
          content: o,
          name: "Engram System State",
          enabled: !1,
          constant: !1,
          keys: [Fl],
          recursion: {
            prevent_incoming: !0,
            prevent_outgoing: !0
          },
          position: "before_character_definition",
          order: 0
        };
        return await zt.updateEntry(t, f.uid, m);
      } else {
        le.debug("WorldBookStateService", "", { state: a });
        const f = {
          name: "Engram System State",
          content: o,
          keys: [Fl],
          enabled: !1,
          constant: !1,
          position: "before_character_definition",
          role: "system",
          order: 0,
          recursion: {
            prevent_incoming: !0,
            prevent_outgoing: !0
          }
        };
        return await zt.createEntry(t, f);
      }
    } catch (r) {
      return le.error("WorldBookStateService", "", r), !1;
    }
  }
}
const aU = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  WorldBookStateService: Kb
}, Symbol.toStringTag, { value: "Module" }));
function sU(e, t) {
  const n = [];
  for (const a of e.filter((o) => o.isBuiltIn)) {
    let o = t.find((l) => l.id === a.id);
    o || (o = t.find(
      (l) => l.isBuiltIn && l.category === a.category && l.name === a.name
    )), o ? n.push({
      ...o,
      id: a.id
    }) : n.push(a);
  }
  const r = t.filter((a) => !a.isBuiltIn);
  return n.push(...r), n;
}
function Z7() {
  const [e, t] = P.useState(d_), [n, r] = P.useState(null), [a, o] = P.useState(null), [l, u] = P.useState(!1), [f, d] = P.useState([...eu]), [m, p] = P.useState(null), [x, y] = P.useState({}), [w, E] = P.useState({}), [k, C] = P.useState(null), T = P.useCallback(async () => {
    var Pe;
    const ke = await zt.getWorldbookStructure();
    y(ke);
    const _e = Ar(), Ae = (Pe = _e == null ? void 0 : _e.getCharWorldbookNames) == null ? void 0 : Pe.call(_e, "current");
    if (Ae != null && Ae.primary) {
      C(Ae.primary);
      const Qe = await Kb.loadState(Ae.primary);
      Qe.disabledEntries && E(Qe.disabledEntries);
    }
  }, []);
  P.useEffect(() => {
    T();
  }, [T]), P.useEffect(() => {
    var Ae;
    const ke = We.get("apiSettings");
    if (ke) {
      const Pe = d_(), Qe = {
        ...Pe,
        ...ke,
        // 
        llmPresets: ((Ae = ke.llmPresets) == null ? void 0 : Ae.length) > 0 ? ke.llmPresets : Pe.llmPresets,
        // 
        promptTemplates: sU(
          Pe.promptTemplates,
          ke.promptTemplates || []
        )
      };
      t(Qe);
    }
    const _e = We.getRegexRules();
    _e && _e.length > 0 && d(_e);
  }, []);
  const N = P.useCallback((ke) => {
    t((_e) => ({ ..._e, selectedPresetId: ke.id })), r(ke);
  }, []), A = P.useCallback(() => {
    const ke = jj(` ${e.llmPresets.length + 1}`);
    ke.isDefault = !1, t((_e) => ({
      ..._e,
      llmPresets: [..._e.llmPresets, ke],
      selectedPresetId: ke.id
    })), r(ke), u(!0);
  }, [e.llmPresets.length]), D = P.useCallback((ke) => {
    t((_e) => ({
      ..._e,
      llmPresets: _e.llmPresets.map((Ae) => Ae.id === ke.id ? ke : Ae)
    })), r(ke), u(!0);
  }, []), M = P.useCallback((ke) => {
    const _e = {
      ...ke,
      id: `preset_${Date.now()}`,
      name: `${ke.name} ()`,
      isDefault: !1,
      createdAt: Date.now(),
      updatedAt: Date.now()
    };
    t((Ae) => ({ ...Ae, llmPresets: [...Ae.llmPresets, _e] })), u(!0);
  }, []), O = P.useCallback((ke) => {
    ke.isDefault || (t((_e) => ({
      ..._e,
      llmPresets: _e.llmPresets.filter((Ae) => Ae.id !== ke.id),
      selectedPresetId: _e.selectedPresetId === ke.id ? null : _e.selectedPresetId
    })), r((_e) => (_e == null ? void 0 : _e.id) === ke.id ? null : _e), u(!0));
  }, []), Y = P.useCallback((ke) => {
    o(ke);
  }, []), X = P.useCallback((ke) => {
    t((_e) => ({
      ..._e,
      promptTemplates: [..._e.promptTemplates, ke]
    })), u(!0);
  }, []), U = P.useCallback((ke) => {
    t((_e) => ({
      ..._e,
      promptTemplates: _e.promptTemplates.map((Ae) => Ae.id === ke.id ? ke : Ae)
    })), o(ke), u(!0);
  }, []), B = P.useCallback((ke) => {
    ke.isBuiltIn || (t((_e) => ({
      ..._e,
      promptTemplates: _e.promptTemplates.filter((Ae) => Ae.id !== ke.id)
    })), o((_e) => (_e == null ? void 0 : _e.id) === ke.id ? null : _e), u(!0));
  }, []), G = P.useCallback((ke) => {
    t((_e) => ({ ..._e, vectorConfig: ke })), u(!0);
  }, []), re = P.useCallback((ke) => {
    t((_e) => ({ ..._e, rerankConfig: ke })), u(!0);
  }, []), q = P.useCallback((ke) => {
    t((_e) => ({ ..._e, worldbookConfig: ke })), u(!0);
  }, []), W = P.useCallback((ke) => {
    t((_e) => ({ ..._e, regexConfig: ke })), u(!0);
  }, []), V = P.useCallback((ke, _e) => {
    t((Ae) => {
      const Pe = Ae.worldbookConfig.disabledWorldbooks || [];
      let Qe;
      return _e ? Qe = [.../* @__PURE__ */ new Set([...Pe, ke])] : Qe = Pe.filter((qe) => qe !== ke), {
        ...Ae,
        worldbookConfig: {
          ...Ae.worldbookConfig,
          disabledWorldbooks: Qe
        }
      };
    }), u(!0);
  }, []), ee = P.useCallback((ke, _e, Ae) => {
    E((Pe) => {
      const Qe = Pe[ke] || [];
      let qe;
      return Ae ? qe = [.../* @__PURE__ */ new Set([...Qe, _e])] : qe = Qe.filter((at) => at !== _e), {
        ...Pe,
        [ke]: qe
      };
    }), u(!0);
  }, []), te = P.useCallback((ke) => {
    const _e = f.find((Ae) => Ae.id === ke);
    p(_e || null);
  }, [f]), ie = P.useCallback(() => {
    const ke = {
      id: `rule_${Date.now()}`,
      name: "",
      pattern: "",
      replacement: "",
      enabled: !0,
      flags: "gi",
      scope: "both",
      description: ""
    };
    d((_e) => [..._e, ke]), p(ke), u(!0);
  }, []), H = P.useCallback((ke) => {
    if (!m) return;
    const _e = { ...m, ...ke };
    p(_e), d((Ae) => Ae.map((Pe) => Pe.id === _e.id ? _e : Pe)), u(!0);
  }, [m]), L = P.useCallback((ke) => {
    d((_e) => _e.map(
      (Ae) => Ae.id === ke ? { ...Ae, enabled: !Ae.enabled } : Ae
    )), u(!0);
  }, []), J = P.useCallback((ke) => {
    d((_e) => _e.filter((Ae) => Ae.id !== ke)), p((_e) => (_e == null ? void 0 : _e.id) === ke ? null : _e), u(!0);
  }, []), F = P.useCallback(() => {
    d([...eu]), p(null), u(!0);
  }, []), Z = P.useCallback(async () => {
    We.set("apiSettings", e), We.setRegexRules(f), k && await Kb.saveState(k, {
      disabledEntries: w
    }), console.log("[Engram] :", e, f, w), u(!1);
  }, [e, f, k, w]), oe = P.useCallback((ke) => {
    t((_e) => ({
      ..._e,
      recallConfig: ke
    })), u(!0);
  }, []), fe = P.useCallback(() => {
    const ke = {
      id: `custom_${Date.now()}`,
      name: "",
      content: "",
      enabled: !0,
      createdAt: Date.now()
    };
    t((_e) => ({
      ..._e,
      customMacros: [..._e.customMacros || [], ke]
    })), u(!0);
  }, []), Se = P.useCallback((ke, _e) => {
    t((Ae) => ({
      ...Ae,
      customMacros: (Ae.customMacros || []).map(
        (Pe) => Pe.id === ke ? { ...Pe, ..._e } : Pe
      )
    })), u(!0);
  }, []), Te = P.useCallback((ke) => {
    t((_e) => ({
      ..._e,
      customMacros: (_e.customMacros || []).filter((Ae) => Ae.id !== ke)
    })), u(!0);
  }, []), we = P.useCallback((ke) => {
    t((_e) => ({
      ..._e,
      customMacros: (_e.customMacros || []).map(
        (Ae) => Ae.id === ke ? { ...Ae, enabled: !Ae.enabled } : Ae
      )
    })), u(!0);
  }, []);
  return {
    settings: e,
    editingPreset: n,
    editingTemplate: a,
    hasChanges: l,
    regexRules: f,
    editingRule: m,
    selectPreset: N,
    addPreset: A,
    updatePreset: D,
    copyPreset: M,
    deletePreset: O,
    selectTemplate: Y,
    addTemplate: X,
    updateTemplate: U,
    deleteTemplate: B,
    updateVectorConfig: G,
    updateRerankConfig: re,
    updateWorldbookConfig: q,
    updateRegexConfig: W,
    toggleWorldbook: V,
    toggleEntry: ee,
    refreshWorldbooks: T,
    worldbookStructure: x,
    disabledEntries: w,
    currentCharWorldbook: k,
    updateRecallConfig: oe,
    selectRule: te,
    addRule: ie,
    updateRule: H,
    toggleRule: L,
    deleteRule: J,
    resetRules: F,
    // V0.9.2: 
    addCustomMacro: fe,
    updateCustomMacro: Se,
    deleteCustomMacro: Te,
    toggleCustomMacro: we,
    save: Z
  };
}
function oU({ isOpen: e, onClose: t }) {
  var p, x;
  const [n, r] = P.useState(
    Qi.getConfig() || vh
  ), { settings: a, updateRecallConfig: o, save: l } = Z7(), u = a.recallConfig;
  n.enabled && (u == null || u.usePreprocessing);
  const f = P.useMemo(() => a.promptTemplates.filter((y) => y.category === "preprocessing").map((y) => ({
    id: y.id,
    name: y.name,
    description: y.userPromptTemplate.slice(0, 30).replace(/\n/g, " ") + "...",
    // 
    icon: hj
    // 
  })), [a.promptTemplates]);
  P.useEffect(() => {
    e && r(Qi.getConfig() || vh);
  }, [e]);
  const d = P.useCallback(() => {
    const y = (u == null ? void 0 : u.usePreprocessing) ?? !1, w = !y;
    le.debug("QuickPanel", "", { from: y, to: w }), u && o({ ...u, usePreprocessing: w });
    const E = { ...n, enabled: w };
    r(E), Qi.saveConfig(E), l();
  }, [n, u, o, l]), m = P.useCallback((y) => {
    le.debug("QuickPanel", "", { templateId: y });
    const w = { ...n, templateId: y, enabled: !0 };
    r(w), Qi.saveConfig(w), u && !u.usePreprocessing && o({ ...u, usePreprocessing: !0 }), l();
  }, [n, u, o, l]);
  return !n.templateId || f.some((y) => y.id === n.templateId), /* @__PURE__ */ h.jsx(
    rU,
    {
      isOpen: e,
      onClose: t,
      title: "Engram ",
      width: 300,
      children: /* @__PURE__ */ h.jsxs("div", { className: "space-y-3", children: [
        /* @__PURE__ */ h.jsxs(
          "div",
          {
            className: "flex items-center justify-between p-2 rounded-md",
            style: {
              backgroundColor: "var(--surface, rgba(255,255,255,0.05))",
              border: "1px solid var(--border, rgba(255,255,255,0.1))"
            },
            children: [
              /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-2", children: [
                /* @__PURE__ */ h.jsx(hi, { size: 14, style: { color: "var(--primary, #ef7357)" } }),
                /* @__PURE__ */ h.jsx("span", { className: "text-sm font-medium", children: "" })
              ] }),
              /* @__PURE__ */ h.jsx(
                Jn,
                {
                  checked: (u == null ? void 0 : u.usePreprocessing) ?? n.enabled,
                  onChange: d
                }
              )
            ]
          }
        ),
        ((u == null ? void 0 : u.usePreprocessing) ?? n.enabled) && /* @__PURE__ */ h.jsxs(
          "div",
          {
            className: "flex items-center justify-between p-2 rounded-md",
            style: {
              backgroundColor: "var(--surface, rgba(255,255,255,0.05))",
              border: "1px solid var(--border, rgba(255,255,255,0.1))"
            },
            children: [
              /* @__PURE__ */ h.jsx("div", { className: "flex items-center gap-2 pl-2", children: /* @__PURE__ */ h.jsx("span", { className: "text-xs text-muted-foreground", children: "" }) }),
              /* @__PURE__ */ h.jsx(
                Jn,
                {
                  checked: n.preview,
                  onChange: () => {
                    const y = { ...n, preview: !n.preview };
                    r(y), Qi.saveConfig(y);
                  }
                }
              )
            ]
          }
        ),
        ((u == null ? void 0 : u.usePreprocessing) ?? n.enabled) && /* @__PURE__ */ h.jsxs("div", { className: "space-y-2", children: [
          /* @__PURE__ */ h.jsx("div", { className: "text-xs px-1", style: { color: "var(--muted-foreground, #888)" }, children: "" }),
          f.length === 0 ? /* @__PURE__ */ h.jsxs(
            "div",
            {
              className: "flex items-start gap-2 p-2 rounded-md text-xs mt-2",
              style: {
                backgroundColor: "rgba(var(--primary-rgb, 239,115,87), 0.1)",
                border: "1px solid rgba(var(--primary-rgb, 239,115,87), 0.3)",
                color: "var(--muted-foreground, #888)"
              },
              children: [
                /* @__PURE__ */ h.jsx(Fs, { size: 14, style: { color: "var(--primary, #ef7357)", flexShrink: 0, marginTop: 2 } }),
                /* @__PURE__ */ h.jsx("span", { children: " API    'preprocessing' " })
              ]
            }
          ) : /* @__PURE__ */ h.jsx("div", { className: "space-y-1", children: f.map((y) => {
            const w = y.icon, E = n.templateId === y.id;
            return /* @__PURE__ */ h.jsxs(
              "button",
              {
                onClick: () => m(y.id),
                className: "w-full flex items-center gap-3 p-2 rounded-md transition-all text-left",
                style: {
                  backgroundColor: E ? "rgba(var(--primary-rgb, 239,115,87), 0.15)" : "var(--surface, rgba(255,255,255,0.05))",
                  border: E ? "1px solid var(--primary, #ef7357)" : "1px solid var(--border, rgba(255,255,255,0.1))",
                  color: "var(--foreground, #fff)"
                },
                children: [
                  /* @__PURE__ */ h.jsx(
                    w,
                    {
                      size: 16,
                      style: {
                        color: E ? "var(--primary, #ef7357)" : "var(--muted-foreground, #888)"
                      }
                    }
                  ),
                  /* @__PURE__ */ h.jsxs("div", { className: "flex-1 min-w-0", children: [
                    /* @__PURE__ */ h.jsx("div", { className: "text-sm font-medium truncate", children: y.name }),
                    /* @__PURE__ */ h.jsx(
                      "div",
                      {
                        className: "text-xs truncate",
                        style: { color: "var(--muted-foreground, #888)" },
                        children: y.description
                      }
                    )
                  ] })
                ]
              },
              y.id
            );
          }) })
        ] }),
        /* @__PURE__ */ h.jsx(
          "div",
          {
            className: "text-xs text-center pt-2",
            style: {
              borderTop: "1px solid var(--border, rgba(255,255,255,0.1))",
              color: "var(--muted-foreground, #888)"
            },
            children: (u == null ? void 0 : u.usePreprocessing) ?? n.enabled ? (p = f.find((y) => y.id === n.templateId)) != null && p.name ? `  ${(x = f.find((y) => y.id === n.templateId)) == null ? void 0 : x.name}` : "  " : ""
          }
        )
      ] })
    }
  );
}
let Yb = !1, Xb = null;
function J7(e) {
  Xb = e;
}
function Wb() {
  if (Yb)
    return le.debug("QuickPanelButton", ""), !0;
  const e = document.querySelector("#send_form");
  if (!e)
    return le.warn("QuickPanelButton", "#send_form "), !1;
  window.getComputedStyle(e).position === "static" && (e.style.position = "relative");
  const n = document.createElement("div");
  n.id = "engram-quick-panel-trigger", n.className = "fa-solid fa-brain", n.title = "Engram ", n.style.cssText = `
        position: absolute;
        top: 0.5em;
        left: 0.5em;
        width: 1.5em;
        height: 1.5em;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.9em;
        cursor: pointer;
        color: var(--SmartThemeBodyColor, #ccc);
        opacity: 0.6;
        transition: all 0.2s ease;
        z-index: 1000;
    `;
  const r = window.getComputedStyle(e).paddingLeft, a = parseFloat(r) < 30 ? "30px" : r;
  return e.style.paddingLeft = a, n.addEventListener("mouseenter", () => {
    n.style.opacity = "1", n.style.color = "var(--SmartThemeEmColor, #fff)";
  }), n.addEventListener("mouseleave", () => {
    n.style.opacity = "0.7", n.style.color = "var(--SmartThemeBodyColor, #ccc)";
  }), n.addEventListener("click", (o) => {
    o.preventDefault(), o.stopPropagation(), le.debug("QuickPanelButton", ""), Xb ? Xb() : le.warn("QuickPanelButton", "");
  }), e.appendChild(n), Yb = !0, le.info("QuickPanelButton", " ()"), !0;
}
function lU() {
  if (Wb())
    return;
  const e = new MutationObserver((t, n) => {
    Wb() && n.disconnect();
  });
  e.observe(document.body, {
    childList: !0,
    subtree: !0
  }), setTimeout(() => {
    e.disconnect(), Yb || le.warn("QuickPanelButton", " #send_form ");
  }, 1e4);
}
const uU = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  initQuickPanelButton: lU,
  injectQuickPanelButton: Wb,
  setQuickPanelCallback: J7
}, Symbol.toStringTag, { value: "Module" }));
let cU = !1, bh = null;
L$((e, t) => {
  const n = ej.createRoot(e);
  return n.render(m2.createElement(tU, { onClose: t })), n;
});
function dU() {
  const [e, t] = P.useState(cU);
  return P.useEffect(() => (bh = t, () => {
    bh = null;
  }), []), /* @__PURE__ */ h.jsxs("div", { className: "pointer-events-auto", children: [
    /* @__PURE__ */ h.jsx(nU, {}),
    /* @__PURE__ */ h.jsx(
      oU,
      {
        isOpen: e,
        onClose: () => t(!1)
      }
    )
  ] });
}
q$((e) => {
  const t = ej.createRoot(e);
  return t.render(/* @__PURE__ */ h.jsx(dU, {})), t;
});
J7(() => {
  bh && bh(!0);
});
document.readyState === "loading" ? document.addEventListener("DOMContentLoaded", uS) : uS();
const Kg = {
  openai: "https://api.openai.com/v1/embeddings",
  ollama: "http://localhost:11434/api/embeddings",
  vllm: "http://localhost:8000/v1/embeddings",
  cohere: "https://api.cohere.ai/v1/embed",
  jina: "https://api.jina.ai/v1/embeddings",
  voyage: "https://api.voyageai.com/v1/embeddings"
}, fU = 5;
class hU {
  constructor() {
    nt(this, "config", null);
    nt(this, "concurrency", fU);
    nt(this, "stopSignal", !1);
  }
  /**
   * 
   */
  setConfig(t) {
    this.config = t;
  }
  /**
   * 
   */
  setConcurrency(t) {
    this.concurrency = Math.max(1, Math.min(20, t));
  }
  /**
   * 
   */
  stop() {
    this.stopSignal = !0;
  }
  /**
   * 
   */
  reset() {
    this.stopSignal = !1;
  }
  // ====================  ====================
  /**
   * 
   */
  async embed(t) {
    if (!this.config)
      throw new Error("EmbeddingService: config not set");
    const n = await this.embedBatch([{ id: "single", text: t }]);
    if (n[0].error)
      throw new Error(n[0].error);
    return n[0].embedding;
  }
  /**
   *  ()
   */
  async embedBatch(t, n) {
    if (!this.config)
      throw new Error("EmbeddingService: config not set");
    this.stopSignal = !1;
    const r = new Array(t.length);
    let a = 0, o = 0;
    const l = async (u) => {
      if (u >= t.length || this.stopSignal) return;
      const f = t[u];
      try {
        const d = await this.callEmbeddingAPI(f.text);
        r[u] = { id: f.id, embedding: d };
      } catch (d) {
        o++, r[u] = { id: f.id, embedding: [], error: d.message }, le.warn("EmbeddingService", `: ${f.id}`, { error: d.message });
      } finally {
        a++, n == null || n(a, t.length, o);
      }
    };
    for (let u = 0; u < t.length && !this.stopSignal; u += this.concurrency) {
      const f = Array.from(
        { length: Math.min(this.concurrency, t.length - u) },
        (d, m) => l(u + m)
      );
      await Promise.all(f);
    }
    return r;
  }
  /**
   *  API
   */
  async callEmbeddingAPI(t) {
    const n = this.config;
    switch (n.source) {
      case "openai":
      case "custom":
      case "vllm":
      case "jina":
      case "voyage":
        return this.callOpenAICompatible(t, n);
      case "ollama":
        return this.callOllama(t, n);
      case "cohere":
        return this.callCohere(t, n);
      case "transformers":
        return this.callTransformers(t, n);
      default:
        throw new Error(`Unsupported vector source: ${n.source}`);
    }
  }
  /**
   * OpenAI  API 
   */
  async callOpenAICompatible(t, n) {
    let r = n.apiUrl || Kg[n.source] || "";
    if ((n.source === "custom" || n.source === "openai") && r) {
      const l = r.replace(/\/+$/, "");
      !l.endsWith("embeddings") && !l.endsWith("embed") && (l.endsWith("/v1") ? r = `${l}/embeddings` : r = `${l}/v1/embeddings`, le.debug("EmbeddingService", ` API URL: ${n.apiUrl} -> ${r}`));
    }
    if (!r)
      throw new Error("API endpoint not configured");
    const a = {
      "Content-Type": "application/json"
    };
    n.apiKey && (a.Authorization = `Bearer ${n.apiKey}`);
    const o = {
      model: n.model || "text-embedding-3-small",
      input: t
    };
    n.dimensions && (o.dimensions = n.dimensions);
    try {
      const l = await fetch(r, {
        method: "POST",
        headers: a,
        body: JSON.stringify(o)
      });
      if (!l.ok) {
        const f = await l.text();
        throw new Error(`API error ${l.status} at ${r}: ${f}`);
      }
      const u = await l.json();
      if (!u.data || u.data.length === 0)
        throw new Error("No embedding data returned");
      return u.data[0].embedding;
    } catch (l) {
      throw l.message.includes("at http") ? l : new Error(`Request to ${r} failed: ${l.message}`);
    }
  }
  /**
   * Ollama API 
   */
  async callOllama(t, n) {
    const r = n.apiUrl || Kg.ollama, a = r.includes("/api/embed") && !r.includes("/api/embeddings"), o = {
      model: n.model || "nomic-embed-text"
    };
    a ? o.input = t : o.prompt = t;
    const l = await fetch(r, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(o)
    });
    if (!l.ok) {
      const f = await l.text();
      throw new Error(`Ollama error ${l.status}: ${f}`);
    }
    const u = await l.json();
    if (u.embedding)
      return u.embedding;
    if (u.embeddings && u.embeddings.length > 0)
      return u.embeddings[0];
    throw new Error(`No embedding data returned in Ollama response. Keys: ${Object.keys(u).join(", ")}`);
  }
  /**
   * Cohere API 
   */
  async callCohere(t, n) {
    const r = Kg.cohere, a = await fetch(r, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        Authorization: `Bearer ${n.apiKey}`
      },
      body: JSON.stringify({
        model: n.model || "embed-multilingual-v3.0",
        texts: [t],
        input_type: "search_document"
      })
    });
    if (!a.ok) {
      const l = await a.text();
      throw new Error(`Cohere error ${a.status}: ${l}`);
    }
    const o = await a.json();
    if (!o.embeddings || o.embeddings.length === 0)
      throw new Error("No embedding data returned");
    return o.embeddings[0];
  }
  /**
   *  Transformers  ()
   */
  async callTransformers(t, n) {
    throw new Error("Transformers embedding not yet implemented");
  }
  // ==================== EventNode  ====================
  /**
   *  EventNode 
   * @param onProgress 
   * @returns 
   */
  async embedUnprocessedEvents(t) {
    const n = or();
    if (!n)
      throw new Error("No current chat");
    const r = jo(n), a = await r.events.filter((d) => !d.is_embedded && !d.embedding).toArray();
    if (a.length === 0)
      return { success: 0, failed: 0 };
    le.info("EmbeddingService", ` ${a.length} `);
    const o = a.map((d) => ({
      id: d.id,
      text: d.summary
    })), l = await this.embedBatch(o, t);
    let u = 0, f = 0;
    for (const d of l) {
      if (d.error || d.embedding.length === 0) {
        f++;
        continue;
      }
      await r.events.update(d.id, {
        embedding: d.embedding,
        is_embedded: !0
      }), u++;
    }
    return le.info("EmbeddingService", `: ${u} , ${f} `), { success: u, failed: f };
  }
  /**
   * 
   */
  async embedEvents(t, n) {
    if (t.length === 0)
      return { success: 0, failed: 0 };
    const r = or();
    if (!r) throw new Error("No current chat");
    const a = jo(r), o = t.map((d) => ({
      id: d.id,
      text: d.summary
    })), l = await this.embedBatch(o, n);
    let u = 0, f = 0;
    for (const d of l) {
      if (d.error || d.embedding.length === 0) {
        f++;
        continue;
      }
      await a.events.update(d.id, {
        embedding: d.embedding,
        is_embedded: !0
      }), u++;
    }
    return { success: u, failed: f };
  }
  /**
   *  EventNode 
   */
  async embedEvent(t) {
    const n = await this.embed(t.summary), r = or();
    if (r) {
      const a = Ps(r);
      a && await a.events.update(t.id, {
        embedding: n,
        is_embedded: !0
      });
    }
    return n;
  }
  /**
   *  ()
   */
  async reembedAllEvents(t) {
    const n = or();
    if (!n)
      throw new Error("No current chat");
    const r = jo(n), a = await r.events.toArray();
    if (a.length === 0)
      return { success: 0, failed: 0 };
    le.info("EmbeddingService", ` ${a.length} `);
    for (const o of a)
      await r.events.update(o.id, {
        embedding: void 0,
        is_embedded: !1
      });
    return this.embedUnprocessedEvents(t);
  }
  // ====================  ====================
  /**
   * 
   */
  cosineSimilarity(t, n) {
    if (!t || !n || t.length !== n.length) return 0;
    let r = 0, a = 0, o = 0;
    for (let u = 0; u < t.length; u++)
      r += t[u] * n[u], a += t[u] * t[u], o += n[u] * n[u];
    const l = Math.sqrt(a) * Math.sqrt(o);
    return l === 0 ? 0 : r / l;
  }
  /**
   * 
   */
  async getEmbeddingStats() {
    const t = or();
    if (!t)
      return { total: 0, embedded: 0, pending: 0 };
    const n = Ps(t);
    if (!n)
      return { total: 0, embedded: 0, pending: 0 };
    const r = await n.events.toArray(), a = r.filter((o) => o.is_embedded).length;
    return {
      total: r.length,
      embedded: a,
      pending: r.length - a
    };
  }
}
const Bn = new hU(), Eo = class Eo {
  constructor() {
  }
  static getInstance() {
    return Eo.instance || (Eo.instance = new Eo()), Eo.instance;
  }
  /**
   *  Rerank 
   */
  getConfig() {
    const t = We.get("apiSettings");
    return (t == null ? void 0 : t.rerankConfig) || null;
  }
  /**
   *  Rerank 
   */
  isEnabled() {
    const t = this.getConfig();
    return !!(t != null && t.enabled && t.url && t.model);
  }
  /**
   *  Rerank API 
   *
   * @param query 
   * @param documents 
   * @returns 
   */
  async rerank(t, n) {
    var a;
    const r = this.getConfig();
    if (!(r != null && r.enabled))
      return le.debug("RerankService", "Rerank "), n.map((o, l) => ({ index: l, relevance_score: 0 }));
    if (!r.url || !r.model)
      return le.warn("RerankService", "Rerank ", { url: r.url, model: r.model }), n.map((o, l) => ({ index: l, relevance_score: 0 }));
    if (n.length === 0)
      return [];
    try {
      const o = r.url.endsWith("/rerank") ? r.url : `${r.url.replace(/\/$/, "")}/rerank`;
      le.debug("RerankService", " Rerank API", {
        endpoint: o,
        model: r.model,
        queryLength: t.length,
        documentCount: n.length
      });
      const l = await fetch(o, {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          ...r.apiKey && {
            Authorization: `Bearer ${r.apiKey}`
          }
        },
        body: JSON.stringify({
          model: r.model,
          query: t,
          documents: n,
          top_n: r.topN || 5
        })
      });
      if (!l.ok) {
        const d = await l.text();
        throw new Error(`Rerank API  (${l.status}): ${d}`);
      }
      const u = await l.json(), f = u.results || u.data || [];
      return le.info("RerankService", "Rerank ", {
        resultCount: f.length,
        topScore: (a = f[0]) == null ? void 0 : a.relevance_score
      }), f.sort((d, m) => m.relevance_score - d.relevance_score);
    } catch (o) {
      const l = o instanceof Error ? o.message : "";
      return le.error("RerankService", "Rerank ", { error: l }), n.map((u, f) => ({ index: f, relevance_score: 0 }));
    }
  }
  /**
   *  (alpha)
   * 0 = 1 =  Rerank 
   */
  getHybridAlpha() {
    const t = this.getConfig();
    return (t == null ? void 0 : t.hybridAlpha) ?? 0.5;
  }
};
nt(Eo, "instance");
let Qb = Eo;
const Yg = Qb.getInstance();
function mU(e, t, n) {
  return e == null && t == null ? 0 : e == null ? t ?? 0 : t == null ? e : (1 - n) * e + n * t;
}
function Zb(e, t) {
  var r;
  const n = e.map((a) => ({
    ...a,
    hybridScore: mU(
      a.embeddingScore,
      a.rerankScore,
      t
    )
  }));
  return n.sort((a, o) => (o.hybridScore ?? 0) - (a.hybridScore ?? 0)), le.debug("HybridScorer", "", {
    candidateCount: n.length,
    topScore: (r = n[0]) == null ? void 0 : r.hybridScore,
    alpha: t
  }), n;
}
function pU(e, t, n, r) {
  for (const o of t) {
    const l = n[o.index];
    if (l && e.has(l.id)) {
      const u = e.get(l.id);
      u.rerankScore = o.relevance_score;
    }
  }
  const a = Array.from(e.values());
  return Zb(a, r);
}
function gU(e, t, n) {
  if (!n.enabled)
    return e;
  const r = e.map((a) => {
    const o = t.getStickyPenalty(a.id, n), u = (a.hybridScore ?? a.embeddingScore ?? 0) * (1 - o);
    return {
      ...a,
      hybridScore: u,
      stickyPenalty: o,
      isSticky: o > 0
    };
  });
  return r.sort((a, o) => (o.hybridScore ?? 0) - (a.hybridScore ?? 0)), le.debug("HybridScorer", "", {
    totalCandidates: e.length,
    stickyCount: r.filter((a) => a.isSticky).length,
    maxPenalty: Math.max(...r.map((a) => a.stickyPenalty ?? 0))
  }), r;
}
class yU {
  constructor() {
    nt(this, "logs", []);
    nt(this, "maxLogs", 50);
    nt(this, "subscribers", /* @__PURE__ */ new Set());
  }
  /**
   * 
   */
  log(t) {
    const n = {
      id: `recall-${Date.now()}-${Math.random().toString(36).slice(2, 8)}`,
      timestamp: Date.now(),
      ...t
    };
    this.logs.unshift(n), this.logs.length > this.maxLogs && (this.logs = this.logs.slice(0, this.maxLogs)), le.debug("RecallLogService", "", {
      query: t.query.substring(0, 50),
      resultCount: t.results.length
    }), this.notifySubscribers();
  }
  /**
   * 
   */
  getLogs() {
    return [...this.logs];
  }
  /**
   * 
   */
  clear() {
    this.logs = [], this.notifySubscribers();
  }
  /**
   * 
   */
  subscribe(t) {
    return this.subscribers.add(t), () => this.subscribers.delete(t);
  }
  /**
   * 
   */
  notifySubscribers() {
    const t = this.getLogs();
    this.subscribers.forEach((n) => n(t));
  }
  /**
   *  JSON 
   */
  exportLogs() {
    const { VERSION: t } = require("@/constants"), n = {
      version: t,
      exportedAt: Date.now(),
      logs: this.getLogs()
    }, r = new Blob([JSON.stringify(n, null, 2)], { type: "application/json" }), a = URL.createObjectURL(r), o = document.createElement("a");
    o.href = a, o.download = `engram_debug_log_${(/* @__PURE__ */ new Date()).toISOString().replace(/[:.]/g, "-")}.json`, document.body.appendChild(o), o.click(), document.body.removeChild(o), URL.revokeObjectURL(a);
  }
}
const th = new yU();
class xU {
  /**
   * 
   */
  getRecallConfig() {
    const t = We.get("apiSettings");
    return (t == null ? void 0 : t.recallConfig) || Bh;
  }
  /**
   * 
   * 
   */
  async hasVectorizedNodes() {
    const t = or();
    if (!t) return !1;
    const n = Ps(t);
    return n ? await n.events.filter((a) => !!a.embedding && a.embedding.length > 0).limit(1).count() > 0 : !1;
  }
  /**
   * 
   */
  getVectorConfig() {
    const t = We.get("apiSettings");
    return t == null ? void 0 : t.vectorConfig;
  }
  /**
   *  Rerank 
   */
  getRerankConfig() {
    const t = We.get("apiSettings");
    return (t == null ? void 0 : t.rerankConfig) || null;
  }
  /**
   * 
   *
   * @param userInput 
   * @param unifiedQueries  ()
   * @returns 
   */
  async search(t, n) {
    const r = this.getRecallConfig(), a = this.getVectorConfig();
    if (r.useEmbedding && a && Bn.setConfig(a), yc.nextRound(), !r.enabled) {
      le.debug("Retriever", "");
      const o = (a == null ? void 0 : a.topK) || 20;
      return this.rollingSearch(o);
    }
    if (r.useBruteForce) {
      le.debug("Retriever", " ()");
      const o = (a == null ? void 0 : a.topK) || 20;
      return this.rollingSearch(o);
    }
    return r.useEmbedding ? this.hybridSearch(t, n, r) : this.rollingSearch(config.embedding.topK);
  }
  /**
   * Embedding + Rerank
   */
  async hybridSearch(t, n, r) {
    const a = Date.now(), o = Date.now(), l = await this.doEmbeddingSearch(
      t,
      n,
      r
    ), u = Date.now() - o;
    if (l.length === 0)
      return le.debug("Retriever", "Embedding "), { entries: [], nodes: [] };
    let f = l, d = 0;
    if (r.useRerank && Yg.isEnabled()) {
      const E = Date.now(), k = (n == null ? void 0 : n[0]) || t, C = l.map((D) => D.summary), T = await Yg.rerank(k, C);
      d = Date.now() - E;
      const N = new Map(l.map((D) => [D.id, D])), A = Yg.getHybridAlpha();
      f = pU(
        N,
        T,
        l,
        A
      ), le.info("Retriever", "", {
        embeddingCount: l.length,
        rerankCount: T.length,
        finalCount: f.length,
        embeddingTime: u,
        rerankTime: d
      });
    } else
      f = Zb(l, 0);
    const m = r.sticky || kj;
    m.enabled && (f = gU(f, yc, m), le.debug("Retriever", "", {
      candidatesWithPenalty: f.filter((E) => (E.stickyPenalty || 0) > 0).length
    }));
    const p = Date.now() - a;
    th.log({
      query: t,
      preprocessedQuery: n == null ? void 0 : n[0],
      mode: "hybrid",
      results: f.map((E) => {
        var k, C, T, N;
        return {
          eventId: E.id,
          summary: E.summary,
          category: ((C = (k = E.node) == null ? void 0 : k.structured_kv) == null ? void 0 : C.event) || "unknown",
          embeddingScore: E.embeddingScore || 0,
          rerankScore: E.rerankScore,
          hybridScore: E.hybridScore,
          isTopK: !0,
          isReranked: E.rerankScore != null,
          sourceFloor: (N = (T = E.node) == null ? void 0 : T.source_range) == null ? void 0 : N.start_index
        };
      }),
      stats: {
        totalCandidates: l.length,
        topKCount: l.length,
        rerankCount: f.length,
        latencyMs: p
      }
    });
    const x = f.map((E) => E.id);
    yc.markRecalledBatch(x), yc.cleanup(10);
    const y = f.filter((E) => E.node).map((E) => E.node), w = f.map((E) => E.summary);
    return le.info("Retriever", "", {
      useEmbedding: r.useEmbedding,
      useRerank: r.useRerank,
      totalTime: p,
      resultCount: y.length,
      stickyRound: yc.getCurrentRound()
    }), { entries: w, nodes: y };
  }
  /**
   *  Embedding  ()
   */
  async embeddingOnlySearch(t, n, r) {
    const a = await this.doEmbeddingSearch(t, n, r), o = Zb(a, 0), l = o.filter((f) => f.node).map((f) => f.node);
    return { entries: o.map((f) => f.summary), nodes: l };
  }
  /**
   *  Embedding 
   */
  async doEmbeddingSearch(t, n, r) {
    var p, x;
    const a = or();
    if (!a)
      return [];
    const o = Ps(a);
    if (!o)
      return [];
    const l = await o.events.filter((y) => !!y.embedding && y.embedding.length > 0).toArray();
    if (l.length === 0)
      return le.debug("Retriever", ""), [];
    const u = n && n.length > 0 ? n : [t];
    le.debug("Retriever", "", {
      queryCount: u.length,
      eventCount: l.length
    });
    const f = /* @__PURE__ */ new Map();
    for (const y of u)
      try {
        const w = await Bn.embed(y);
        for (const E of l) {
          if (!E.embedding) continue;
          const k = Bn.cosineSimilarity(
            w,
            E.embedding
          ), C = ((p = r.embedding) == null ? void 0 : p.minScoreThreshold) ?? 0.3;
          if (k < C) continue;
          const T = f.get(E.id);
          (!T || k > (T.embeddingScore || 0)) && f.set(E.id, {
            id: E.id,
            summary: E.summary,
            embeddingScore: k,
            node: E
          });
        }
      } catch (w) {
        le.error("Retriever", `Query : ${y}`, {
          message: (w == null ? void 0 : w.message) || w,
          stack: w == null ? void 0 : w.stack
        });
      }
    const d = this.getVectorConfig(), m = Array.from(f.values()).sort((y, w) => (w.embeddingScore || 0) - (y.embeddingScore || 0)).slice(0, (d == null ? void 0 : d.topK) || 20);
    return le.debug("Retriever", "Embedding ", {
      totalMatched: f.size,
      topK: m.length,
      topScore: (x = m[0]) == null ? void 0 : x.embeddingScore
    }), m;
  }
  /**
   *  ()
   * 
   */
  async rollingSearch(t) {
    const n = or();
    if (!n)
      return { entries: [], nodes: [] };
    const r = Ps(n);
    if (!r)
      return { entries: [], nodes: [] };
    const a = await r.events.filter((f) => f.level === 0).reverse().limit(t).toArray(), o = await r.events.filter((f) => f.level === 1).reverse().first(), l = [...a];
    return o && l.unshift(o), { entries: l.map((f) => f.summary), nodes: l };
  }
  /**
   * @deprecated  search() 
   */
  async vectorSearch(t, n) {
    return this.search(t);
  }
}
const yS = new xU();
class e9 {
  constructor() {
    nt(this, "isInitialized", !1);
    nt(this, "isProcessing", !1);
  }
  // 
  /**
   * Initialize the Injector
   */
  init() {
    this.isInitialized || (le.info("Injector", " V0.8 ..."), console.log("[Injector] Starting initialization..."), di.on(
      Ni.GENERATION_AFTER_COMMANDS,
      async (t, n, r) => {
        console.log("[Injector]  GENERATION_AFTER_COMMANDS triggered", { type: t, dryRun: r }), le.info("Injector", "  GENERATION_AFTER_COMMANDS ", { type: t, dryRun: r }), await this.handleGenerationAfterCommands(t, n, r);
      }
    ), di.on(Ni.CHAT_CHANGED, () => {
      le.debug("Injector", " CHAT_CHANGED "), this.isProcessing = !1, ji.refreshCache().catch((t) => {
        le.warn("Injector", "", t);
      });
    }), this.isInitialized = !0, le.success("Injector", "V0.8 Injector "), console.log("[Injector]  V0.8 Initialized - Listening for GENERATION_AFTER_COMMANDS"));
  }
  /**
   *  GENERATION_AFTER_COMMANDS 
   *  async  await
   */
  async handleGenerationAfterCommands(t, n, r) {
    try {
      if (r) {
        le.debug("Injector", "dryRun ");
        return;
      }
      if (t === "regenerate" || t === "swipe" || t === "quiet" || t === "impersonate") {
        le.debug("Injector", ` ${t} `);
        return;
      }
      if (n._engram_processed) {
        le.debug("Injector", "");
        return;
      }
      if (this.isProcessing) {
        le.debug("Injector", "");
        return;
      }
      const a = or();
      if (!a) {
        le.warn("Injector", " ID");
        return;
      }
      const o = Ga();
      if (!o || !o.chat || o.chat.length === 0) {
        le.warn("Injector", "");
        return;
      }
      const l = o.chat, u = l.length - 1, f = l[u];
      let d = "", m = "chat";
      if (f && f.is_user)
        d = f.mes;
      else {
        const k = document.getElementById("send_textarea");
        if (k && k.value && k.value.trim().length > 0)
          d = k.value, m = "textarea", le.info("Injector", " Textarea  (Strategy 2)", {
            preview: d.substring(0, 50)
          });
        else {
          le.debug("Injector", "", {
            index: u,
            isUser: f == null ? void 0 : f.is_user
          });
          return;
        }
      }
      if (!d || d.trim().length === 0) {
        le.debug("Injector", "");
        return;
      }
      le.debug("Injector", "...");
      let p, x, y;
      try {
        if (p = We.get("apiSettings"), le.debug("Injector", " apiSettings"), x = (p == null ? void 0 : p.recallConfig) || Bh, le.debug("Injector", " recallConfig", x), !Qi)
          throw new Error("Preprocessor service is undefined");
        y = Qi.getConfig(), le.debug("Injector", " preprocessorConfig", y);
      } catch (k) {
        throw le.error("Injector", "", k), k;
      }
      if (le.info("Injector", "", {
        chatId: a,
        userInputLength: d.length,
        userInputPreview: d.substring(0, 50) + "...",
        recallEnabled: x.enabled,
        preprocessingEnabled: x.usePreprocessing && y.enabled,
        autoTrigger: y.autoTrigger,
        templateId: y.templateId
      }), x.usePreprocessing && y.enabled && !y.autoTrigger && (le.debug("Injector", " autoTrigger "), !x.enabled))
        return;
      this.isProcessing = !0, n._engram_processed = !0, f && (f._engram_processed = !0), le.info("Injector", " ...");
      let w = d, E = [];
      try {
        if (x.usePreprocessing && y.enabled && y.autoTrigger)
          try {
            ji.setUserInput(d), await ji.refreshCache();
            const k = await Qi.process(d);
            if (k.success && k.output) {
              le.success("Injector", " ", {
                outputLength: k.output.length,
                hasQuery: !!k.query
              });
              const C = We.getPromptTemplateById(y.templateId), T = (C == null ? void 0 : C.injectionMode) || "replace";
              T === "append" ? w = `${d}

${k.output}` : T === "prepend" ? w = `${k.output}

${d}` : w = k.output, k.query && E.push(k.query);
            } else
              le.warn("Injector", "");
          } catch (k) {
            le.warn("Injector", " ", k);
          }
        if (x.enabled)
          try {
            if (!await yS.hasVectorizedNodes())
              le.info("Injector", " RAG ");
            else {
              le.info("Injector", "  RAG ", {
                queryCount: E.length,
                firstQuery: E[0] || d.substring(0, 50)
              });
              const C = await yS.search(
                d,
                E.length > 0 ? E : void 0
              );
              C.nodes.length > 0 ? (le.info("Injector", " RAG ", {
                nodeCount: C.nodes.length,
                entries: C.entries.length
              }), await ji.refreshCacheWithNodes(C.nodes)) : le.debug("Injector", "RAG ");
            }
          } catch (k) {
            le.error("Injector", "RAG ", k);
          }
        if (w = fi.process(w, "output"), w !== d) {
          if (m === "chat") {
            f.mes = w;
            try {
              const k = o.eventSource, C = o.event_types;
              k && (C != null && C.MESSAGE_UPDATED) && (k.emit(C.MESSAGE_UPDATED, u), le.debug("Injector", " MESSAGE_UPDATED "));
            } catch (k) {
              le.warn("Injector", " MESSAGE_UPDATED ", k);
            }
            try {
              const k = document.getElementById("send_textarea");
              k && k.value === d && (k.value = "", k.dispatchEvent(new Event("input", { bubbles: !0 })));
            } catch {
            }
          } else if (m === "textarea") {
            le.info("Injector", " Textarea (Strategy 2)");
            try {
              const k = document.getElementById("send_textarea");
              k && (k.value = w, k.dispatchEvent(new Event("input", { bubbles: !0 }))), n && (n.prompt = w);
            } catch (k) {
              le.warn("Injector", " Textarea ", k);
            }
          }
        }
      } finally {
        setTimeout(() => {
          this.isProcessing = !1;
        }, 1e3);
      }
    } catch (a) {
      this.isProcessing = !1, le.error("Injector", "handleGenerationAfterCommands ", {
        message: (a == null ? void 0 : a.message) || a,
        stack: a == null ? void 0 : a.stack
      }), console.error("[Injector] Error:", a);
    }
  }
}
const vU = new e9(), bU = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  Injector: e9,
  injector: vU
}, Symbol.toStringTag, { value: "Module" }));
class t9 {
  static init() {
    if (!this.isInitialized)
      try {
        const t = Ga();
        if (!(t != null && t.eventSource) || !(t != null && t.event_types)) {
          le.warn("CharacterDeleteService", "");
          return;
        }
        t.event_types.CHARACTER_DELETED && (t.eventSource.on(t.event_types.CHARACTER_DELETED, this.onCharacterDeleted.bind(this)), le.info("CharacterDeleteService", " CHARACTER_DELETED ")), t.event_types.CHAT_DELETED && (t.eventSource.on(t.event_types.CHAT_DELETED, this.onChatDeleted.bind(this)), le.info("CharacterDeleteService", " CHAT_DELETED ")), t.event_types.GROUP_CHAT_DELETED && (t.eventSource.on(t.event_types.GROUP_CHAT_DELETED, this.onChatDeleted.bind(this)), le.info("CharacterDeleteService", " GROUP_CHAT_DELETED ")), this.isInitialized = !0;
      } catch (t) {
        le.error("CharacterDeleteService", "", t);
      }
  }
  /**
   * 
   */
  static async onCharacterDeleted(t) {
    var o;
    const n = We.getSettings().linkedDeletion;
    if (!(n != null && n.enabled) || !(n != null && n.deleteWorldbook)) return;
    le.debug("CharacterDeleteService", "", t);
    const r = t.character, a = (r == null ? void 0 : r.name) || (r == null ? void 0 : r.avatar) || (r == null ? void 0 : r.ch_name) || ((o = r == null ? void 0 : r.data) == null ? void 0 : o.name);
    if (!a) {
      le.warn("CharacterDeleteService", "");
      return;
    }
    await this.deleteEngramWorldbooks(a, "", n.showConfirmation);
  }
  /**
   * 
   * @param chatId  ID "CharName - 2024-1-1@12h30m" 
   */
  static async onChatDeleted(t) {
    const n = We.getSettings().linkedDeletion;
    if (!(n != null && n.enabled)) return;
    le.debug("CharacterDeleteService", "", t);
    try {
      const { deleteDatabase: a, hasDbForChat: o } = await Promise.resolve().then(() => PD);
      o(t) && (await a(t), le.info("CharacterDeleteService", ` IndexedDB: Engram_${t}`), St.info(" Engram ", "Engram"));
    } catch (a) {
      le.error("CharacterDeleteService", `: Engram_${t}`, a);
    }
    if (!n.deleteChatWorldbook) return;
    const r = this.extractCharacterNameFromChatId(t);
    if (!r) {
      le.debug("CharacterDeleteService", ` chatId : ${t}`);
      return;
    }
    await this.deleteEngramWorldbooks(r, "", n.showConfirmation);
  }
  /**
   *  chatId 
   */
  static extractCharacterNameFromChatId(t) {
    if (!t) return null;
    let n = t.match(/^(.+?)\s*-\s*\d{4}/);
    return n || (n = t.match(/^(.+?)_\d{4}/), n) ? n[1].trim() : null;
  }
  /**
   *  Engram 
   */
  static async deleteEngramWorldbooks(t, n, r) {
    const a = /* @__PURE__ */ new Set();
    a.add(`[Engram] ${t}`), a.add(`Engram_${t}`);
    const o = await zt.getWorldbookNames(), l = new Set(o), u = Array.from(a).filter((m) => {
      if (!l.has(m)) return !1;
      const p = m.toLowerCase().includes("engram");
      return p || le.info("CharacterDeleteService", ` Engram : ${m}`), p;
    });
    if (u.length === 0) {
      le.debug("CharacterDeleteService", ` "${t}"  Engram `);
      return;
    }
    if (le.info("CharacterDeleteService", `: ${u.join(", ")}`), r) {
      const m = `
                <div style="font-size: 0.9em;">
                    <h3> Engram </h3>
                    <p>${n} <b>${t}</b> </p>
                    <p> Engram </p>
                    <ul style="max-height: 100px; overflow-y: auto; background: var(--black50a); padding: 5px; border-radius: 4px; list-style: none; margin: 10px 0;">
                        ${u.map((x) => `<li style="padding: 2px 0;"> ${x}</li>`).join("")}
                    </ul>
                    <p></p>
                    <small style="opacity: 0.7;"></small>
                </div>
            `;
      if (!await $$(m, "confirm")) {
        le.info("CharacterDeleteService", "");
        return;
      }
    }
    let f = 0;
    const d = [];
    St.info(" Engram ...", "Engram");
    for (const m of u)
      try {
        await zt.deleteWorldbook(m) ? (f++, le.info("CharacterDeleteService", `: ${m}`)) : d.push(m);
      } catch (p) {
        le.error("CharacterDeleteService", ` ${m} `, p), d.push(m);
      }
    f > 0 && St.success(` ${f} `, "Engram"), d.length > 0 && St.warning(`: ${d.join(", ")}`, "Engram");
  }
}
nt(t9, "isInitialized", !1);
const wU = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  CharacterDeleteService: t9
}, Symbol.toStringTag, { value: "Module" }));
class n9 {
  constructor(t) {
    nt(this, "config");
    nt(this, "isExtracting", !1);
    this.config = { ...Nj, ...t };
  }
  /**
   * 
   */
  updateConfig(t) {
    this.config = { ...this.config, ...t };
  }
  /**
   * 
   */
  getConfig() {
    return { ...this.config };
  }
  /**
   * 
   * V0.9.1:  SummarizerService 
   */
  shouldTriggerOnFloor(t) {
    return !this.config.enabled || this.config.trigger !== "floor" ? !1 : t > 0 && t % this.config.floorInterval === 0;
  }
  /**
   * 
   * V0.9.1:  chatHistory  engramGraph
   *
   * @param chatHistory 
   * @param floor 
   * @param manual 
   */
  async extractFromChat(t, n, r = !1) {
    var o;
    if (this.isExtracting)
      return le.warn("EntityBuilder", ""), null;
    this.isExtracting = !0;
    const a = Date.now();
    le.info("EntityBuilder", ` ( ${n})`);
    try {
      const u = await yr.getState().getAllEntities(), f = u.map((C) => ({
        name: C.name,
        type: C.type,
        aliases: C.aliases || []
      })), m = (((o = We.get("apiSettings")) == null ? void 0 : o.promptTemplates) || []).find((C) => C.category === "entity_extraction" && C.enabled), p = (m == null ? void 0 : m.systemPrompt) || Ej, y = ((m == null ? void 0 : m.userPromptTemplate) || `

****:
{{chatHistory}}

****:
{{existingEntities}}

---
 JSON `).replace("{{chatHistory}}", t).replace("{{existingEntities}}", JSON.stringify(f, null, 2)).replace("{{worldbookContext}}", ji.cachedWorldbookContext || ""), w = await Oo.generate({
        systemPrompt: p,
        userPrompt: y
      });
      if (!w.success || !w.content)
        return le.error("EntityBuilder", "LLM ", { error: w.error }), r && St.error("LLM ", "Engram"), { success: !1, newEntities: [], updatedEntities: [], error: w.error };
      const E = K2.parse(w.content);
      if (!E || !E.entities)
        return le.error("EntityBuilder", "JSON "), r && St.error("", "Engram"), { success: !1, newEntities: [], updatedEntities: [], error: "JSON parse failed" };
      const k = await this.saveEntities(E, u);
      return await To.updateState({ last_extracted_floor: n }), le.success("EntityBuilder", "", {
        floor: n,
        newCount: k.newEntities.length,
        updatedCount: k.updatedEntities.length,
        duration: Date.now() - a
      }), r && St.success(
        ` ${k.newEntities.length} `,
        "Engram"
      ), k;
    } catch (l) {
      const u = l instanceof Error ? l.message : String(l);
      return le.error("EntityBuilder", "", { error: u }), r && St.error(`: ${u}`, "Engram "), { success: !1, newEntities: [], updatedEntities: [], error: u };
    } finally {
      this.isExtracting = !1;
    }
  }
  /**
   * 
   */
  async extractManual() {
    const t = await ji.getChatHistory("50"), n = await To.getState();
    return this.extractFromChat(t, n.last_summarized_floor, !0);
  }
  /**
   * 
   * V0.9.4:  profile 
   */
  async saveEntities(t, n) {
    var l, u;
    const r = yr.getState(), a = [], o = [];
    for (const f of t.entities) {
      const d = this.resolveEntity(f.name, f.aliases, n), m = this.profileToYaml(f.name, f.type, f.profile);
      if (d) {
        const p = {
          ...d.profile,
          ...f.profile
        };
        if (Array.isArray((l = f.profile) == null ? void 0 : l.relations)) {
          const w = ((u = d.profile) == null ? void 0 : u.relations) || [], E = f.profile.relations, k = new Map(w.map((C) => [C.target, C]));
          for (const C of E)
            k.set(C.target, C);
          p.relations = Array.from(k.values());
        }
        const x = {
          description: this.profileToYaml(d.name, d.type, p),
          profile: p
        }, y = /* @__PURE__ */ new Set([...d.aliases || [], ...f.aliases]);
        x.aliases = Array.from(y), await r.updateEntity(d.id, x), o.push({ ...d, ...x });
      } else {
        const p = {
          char: bo.Character,
          loc: bo.Location,
          item: bo.Item,
          concept: bo.Concept,
          unknown: bo.Unknown
        }, x = await r.saveEntity({
          name: f.name,
          type: p[f.type] || bo.Unknown,
          description: m,
          aliases: f.aliases || [],
          profile: f.profile || {}
        });
        a.push(x);
      }
    }
    return {
      success: !0,
      newEntities: a,
      updatedEntities: o
    };
  }
  /**
   *  profile  YAML  (For Model)
   * V0.9.4: 
   */
  profileToYaml(t, n, r) {
    const a = [`${t} (${n})`];
    for (const [o, l] of Object.entries(r))
      if (o === "relations" && Array.isArray(l)) {
        a.push(":");
        for (const u of l) {
          const f = u.description ? ` - ${u.description}` : "";
          a.push(`  - ${u.target}: ${u.type}${f}`);
        }
      } else typeof l == "string" ? a.push(`${o}: ${l}`) : Array.isArray(l) && a.push(`${o}: ${l.join(", ")}`);
    return a.join(`
`);
  }
  /**
   * 
   */
  resolveEntity(t, n, r) {
    const a = r.find((l) => l.name === t);
    if (a) return a;
    const o = r.find((l) => {
      var u;
      return (u = l.aliases) == null ? void 0 : u.includes(t);
    });
    if (o) return o;
    for (const l of n) {
      const u = r.find(
        (f) => {
          var d;
          return f.name === l || ((d = f.aliases) == null ? void 0 : d.includes(l));
        }
      );
      if (u) return u;
    }
    return null;
  }
  /**
   *  (UI )
   * V0.9.1: 
   */
  async getStatus() {
    const n = await yr.getState().getAllEntities(), r = await To.getState();
    return {
      enabled: this.config.enabled,
      trigger: this.config.trigger,
      floorInterval: this.config.floorInterval,
      lastExtractedFloor: r.last_extracted_floor,
      entityCount: n.length,
      isExtracting: this.isExtracting
    };
  }
}
const $a = new n9(), _U = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  EntityBuilder: n9,
  entityBuilder: $a
}, Symbol.toStringTag, { value: "Module" })), xS = "engram_macro_slot", vS = "Engram Memory Context";
class r9 {
  /**
   *  WorldBook 
   * 
   */
  static async init() {
    if (!this.isInitialized)
      try {
        const t = await zt.getOrCreateWorldbook();
        if (!t) {
          le.warn("WorldBookSlotService", "");
          return;
        }
        const n = await zt.findEntryByKey(t, xS);
        if (n) {
          le.debug("WorldBookSlotService", "", {
            uid: n.uid,
            name: n.name
          }), this.isInitialized = !0;
          return;
        }
        await zt.createEntry(t, {
          name: vS,
          content: "{{engramSummaries}}",
          keys: [xS],
          constant: !0,
          enabled: !0,
          position: "at_depth",
          role: "system",
          depth: 999,
          order: 9e3
          //  order
        }) ? (le.success("WorldBookSlotService", "", {
          worldbook: t,
          name: vS
        }), this.isInitialized = !0) : le.error("WorldBookSlotService", "");
      } catch (t) {
        le.error("WorldBookSlotService", "", t);
      }
  }
  /**
   * 
   */
  static isReady() {
    return this.isInitialized;
  }
  /**
   * 
   */
  static reset() {
    this.isInitialized = !1;
  }
}
nt(r9, "isInitialized", !1);
const SU = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  WorldBookSlotService: r9
}, Symbol.toStringTag, { value: "Module" }));
function CU(e) {
  return new Date(e).toTimeString().slice(0, 8);
}
const EU = {
  [Zt.DEBUG]: { text: "text-zinc-500", bg: "bg-zinc-500/10" },
  [Zt.INFO]: { text: "text-blue-400", bg: "bg-blue-500/10" },
  [Zt.SUCCESS]: { text: "text-emerald-400", bg: "bg-emerald-500/10" },
  [Zt.WARN]: { text: "text-amber-400", bg: "bg-amber-500/10" },
  [Zt.ERROR]: { text: "text-red-400", bg: "bg-red-500/10" }
}, kU = ({ entry: e }) => {
  const [t, n] = P.useState(!1), r = e.data !== void 0, a = dh[e.level], o = EU[e.level];
  return /* @__PURE__ */ h.jsxs("div", { className: "group", children: [
    /* @__PURE__ */ h.jsxs(
      "div",
      {
        className: `
                    flex items-start gap-3 px-2 py-1 rounded-sm transition-colors
                    hover:bg-white/[0.02]
                    ${r ? "cursor-pointer" : ""}
                `,
        onClick: () => r && n(!t),
        children: [
          /* @__PURE__ */ h.jsx("span", { className: "flex items-center text-zinc-600 shrink-0 mt-0.5 w-3", children: r ? t ? /* @__PURE__ */ h.jsx(Ro, { size: 12 }) : /* @__PURE__ */ h.jsx(lu, { size: 12 }) : null }),
          /* @__PURE__ */ h.jsx("span", { className: "text-zinc-600 shrink-0 tabular-nums text-[11px]", children: CU(e.timestamp) }),
          /* @__PURE__ */ h.jsx("span", { className: `
                    shrink-0 text-[10px] font-medium px-1.5 py-0.5 rounded
                    ${o.text} ${o.bg}
                `, children: a.label }),
          /* @__PURE__ */ h.jsx("span", { className: "text-zinc-500 shrink-0 text-[11px]", children: e.module }),
          /* @__PURE__ */ h.jsx("span", { className: "text-zinc-300 text-[11px] break-words flex-1 leading-relaxed", children: e.message })
        ]
      }
    ),
    t && r && /* @__PURE__ */ h.jsx("div", { className: "ml-10 mr-2 mb-1 px-3 py-2 bg-zinc-900/50 border-l-2 border-zinc-700 rounded-r text-[10px]", children: /* @__PURE__ */ h.jsx("pre", { className: "m-0 text-zinc-400 whitespace-pre-wrap break-words font-mono", children: JSON.stringify(e.data, null, 2) }) })
  ] });
}, NU = {
  summarize: { label: "", color: "bg-blue-500/20 text-blue-400" },
  trim: { label: "", color: "bg-yellow-500/20 text-yellow-500" },
  vectorize: { label: "", color: "bg-purple-500/20 text-purple-400" },
  query: { label: "", color: "bg-green-500/20 text-green-400" },
  other: { label: "", color: "bg-gray-500/20 text-gray-400" }
}, jU = ({ status: e }) => {
  switch (e) {
    case "pending":
      return /* @__PURE__ */ h.jsx(Ka, { size: 14, className: "animate-spin text-yellow-400" });
    case "success":
      return /* @__PURE__ */ h.jsx(g2, { size: 14, className: "text-green-400" });
    case "error":
      return /* @__PURE__ */ h.jsx(Fs, { size: 14, className: "text-red-400" });
  }
}, TU = (e) => new Date(e).toLocaleTimeString("zh-CN", {
  hour12: !1,
  hour: "2-digit",
  minute: "2-digit",
  second: "2-digit"
}), AU = (e) => e === void 0 ? "-" : e < 1e3 ? `${e}ms` : `${(e / 1e3).toFixed(1)}s`, MU = ({ sent: e, received: t }) => {
  const [n, r] = P.useState(!1), a = NU[e.type];
  return /* @__PURE__ */ h.jsxs("div", { className: "border border-border rounded-lg overflow-hidden bg-card", children: [
    /* @__PURE__ */ h.jsxs(
      "div",
      {
        className: "flex items-center gap-2 px-3 py-2 bg-muted-20 cursor-pointer hover:bg-muted-30",
        onClick: () => r(!n),
        children: [
          n ? /* @__PURE__ */ h.jsx(Ro, { size: 14 }) : /* @__PURE__ */ h.jsx(lu, { size: 14 }),
          /* @__PURE__ */ h.jsx("span", { className: `px-2 py-0.5 rounded text-xs font-medium ${a.color}`, children: a.label }),
          e.model && /* @__PURE__ */ h.jsx("span", { className: "px-1.5 py-0.5 rounded text-[10px] font-medium bg-indigo-500/10 text-indigo-400 border border-indigo-500/20 truncate max-w-[150px]", title: `: ${e.model}`, children: e.model }),
          e.character && /* @__PURE__ */ h.jsx("span", { className: "px-1.5 py-0.5 rounded text-[10px] font-medium bg-orange-500/10 text-orange-400 border border-orange-500/20 truncate max-w-[120px]", title: `: ${e.character}`, children: e.character }),
          /* @__PURE__ */ h.jsx("span", { className: "text-xs text-muted-foreground", children: TU(e.timestamp) }),
          /* @__PURE__ */ h.jsx(jU, { status: (t == null ? void 0 : t.status) || e.status }),
          e.floorRange && /* @__PURE__ */ h.jsxs("span", { className: "text-xs text-muted-foreground", children: [
            " #",
            e.floorRange[0],
            "-",
            e.floorRange[1]
          ] }),
          /* @__PURE__ */ h.jsxs("span", { className: "ml-auto text-xs text-muted-foreground flex items-center gap-1", children: [
            /* @__PURE__ */ h.jsx(lh, { size: 12 }),
            AU((t == null ? void 0 : t.duration) || e.duration)
          ] })
        ]
      }
    ),
    n && /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col md:flex-row", children: [
      /* @__PURE__ */ h.jsxs("div", { className: "flex-1 border-r border-border p-3", children: [
        /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-2 mb-2 text-sm font-medium text-blue-400", children: [
          /* @__PURE__ */ h.jsx(oO, { size: 14 }),
          "",
          e.tokensSent && /* @__PURE__ */ h.jsxs("span", { className: "text-xs text-muted-foreground ml-auto", children: [
            "~",
            e.tokensSent,
            " tokens"
          ] })
        ] }),
        e.systemPrompt && /* @__PURE__ */ h.jsxs("div", { className: "mb-3", children: [
          /* @__PURE__ */ h.jsx("div", { className: "text-xs text-muted-foreground mb-1", children: "System" }),
          /* @__PURE__ */ h.jsx("div", { className: "text-sm p-2 bg-muted-20 rounded max-h-[500px] overflow-y-auto whitespace-pre-wrap", children: e.systemPrompt })
        ] }),
        e.userPrompt && /* @__PURE__ */ h.jsxs("div", { children: [
          /* @__PURE__ */ h.jsx("div", { className: "text-xs text-muted-foreground mb-1", children: "User" }),
          /* @__PURE__ */ h.jsx("div", { className: "text-sm p-2 bg-muted-20 rounded max-h-[500px] overflow-y-auto whitespace-pre-wrap", children: e.userPrompt })
        ] })
      ] }),
      /* @__PURE__ */ h.jsxs("div", { className: "flex-1 p-3", children: [
        /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-2 mb-2 text-sm font-medium text-green-400", children: [
          /* @__PURE__ */ h.jsx(nj, { size: 14 }),
          "",
          (t == null ? void 0 : t.tokensReceived) && /* @__PURE__ */ h.jsxs("span", { className: "text-xs text-muted-foreground ml-auto", children: [
            "~",
            t.tokensReceived,
            " tokens"
          ] })
        ] }),
        (t == null ? void 0 : t.status) === "error" && t.error && /* @__PURE__ */ h.jsx("div", { className: "p-2 bg-red-500/10 border border-red-500/30 rounded text-sm text-red-400", children: t.error }),
        (t == null ? void 0 : t.response) && /* @__PURE__ */ h.jsx("div", { className: "text-sm p-2 bg-muted-20 rounded max-h-[500px] overflow-y-auto whitespace-pre-wrap", children: t.response }),
        !t && e.status === "pending" && /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-2 text-sm text-muted-foreground", children: [
          /* @__PURE__ */ h.jsx(Ka, { size: 14, className: "animate-spin" }),
          "..."
        ] })
      ] })
    ] })
  ] });
}, RU = () => {
  const [e, t] = P.useState(Vr.getPaired());
  return P.useEffect(() => Vr.subscribe(() => {
    t(Vr.getPaired());
  }), []), /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col h-full", children: [
    /* @__PURE__ */ h.jsxs("div", { className: "flex items-center justify-between px-4 py-3 border-b border-border shrink-0", children: [
      /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-2", children: [
        /* @__PURE__ */ h.jsx(Po, { size: 16, className: "text-primary" }),
        /* @__PURE__ */ h.jsx("span", { className: "font-medium text-foreground", children: "" }),
        /* @__PURE__ */ h.jsxs("span", { className: "text-xs text-muted-foreground", children: [
          "(",
          e.length,
          ")"
        ] })
      ] }),
      /* @__PURE__ */ h.jsx(
        "button",
        {
          className: "p-1.5 rounded-md hover:bg-destructive hover:text-destructive-foreground transition-colors text-muted-foreground",
          onClick: () => Vr.clear(),
          title: "",
          children: /* @__PURE__ */ h.jsx(Ri, { size: 14 })
        }
      )
    ] }),
    /* @__PURE__ */ h.jsx("div", { className: "flex-1 overflow-y-auto p-4", children: e.length === 0 ? /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col items-center justify-center h-full text-muted-foreground gap-3", children: [
      /* @__PURE__ */ h.jsx(nj, { size: 48, className: "opacity-30" }),
      /* @__PURE__ */ h.jsx("p", { className: "text-sm", children: "" }),
      /* @__PURE__ */ h.jsx("p", { className: "text-xs", children: "" })
    ] }) : /* @__PURE__ */ h.jsx("div", { className: "flex flex-col gap-3", children: e.map(({ sent: n, received: r }) => /* @__PURE__ */ h.jsx(MU, { sent: n, received: r }, n.id)) }) })
  ] });
}, bS = 768, i9 = (e) => new Date(e).toLocaleTimeString("zh-CN", {
  hour12: !1,
  hour: "2-digit",
  minute: "2-digit",
  second: "2-digit"
}), a9 = (e) => e === void 0 ? "-" : e < 1e3 ? `${e}ms` : `${(e / 1e3).toFixed(1)}s`, zU = ({ entry: e, isSelected: t, onSelect: n }) => /* @__PURE__ */ h.jsxs(
  "div",
  {
    className: `
                px-3 py-2 cursor-pointer border-b border-border/30 transition-colors
                ${t ? "bg-primary/10 border-l-2 border-l-primary" : "hover:bg-muted/30"}
            `,
    onClick: n,
    children: [
      /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-2 mb-1", children: [
        /* @__PURE__ */ h.jsx("span", { className: `px-1.5 py-0.5 rounded text-[10px] font-medium ${e.mode === "hybrid" ? "bg-purple-500/20 text-purple-400" : "bg-blue-500/20 text-blue-400"}`, children: e.mode === "hybrid" ? "" : "Embed" }),
        /* @__PURE__ */ h.jsxs("span", { className: "text-[10px] text-muted-foreground", children: [
          e.stats.rerankCount,
          "/",
          e.stats.topKCount,
          " "
        ] }),
        /* @__PURE__ */ h.jsxs("span", { className: "text-[10px] text-muted-foreground ml-auto flex items-center gap-1", children: [
          /* @__PURE__ */ h.jsx(lh, { size: 10 }),
          i9(e.timestamp)
        ] })
      ] }),
      /* @__PURE__ */ h.jsx("p", { className: "text-sm text-foreground line-clamp-2", children: e.query }),
      /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-2 mt-1 text-[10px] text-muted-foreground", children: [
        /* @__PURE__ */ h.jsx(Po, { size: 10 }),
        a9(e.stats.latencyMs)
      ] })
    ]
  }
), Xg = ({ label: e, score: t, color: n }) => {
  const r = Math.min(100, t * 100);
  return /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-2 text-xs", children: [
    /* @__PURE__ */ h.jsx("span", { className: "text-muted-foreground w-16 shrink-0", children: e }),
    /* @__PURE__ */ h.jsx("div", { className: "flex-1 h-1.5 bg-muted/30 rounded-full overflow-hidden", children: /* @__PURE__ */ h.jsx(
      "div",
      {
        className: `h-full ${n} rounded-full transition-all duration-300`,
        style: { width: `${r}%` }
      }
    ) }),
    /* @__PURE__ */ h.jsx("span", { className: "text-muted-foreground w-14 text-right font-mono shrink-0", children: t.toFixed(3) })
  ] });
}, OU = ({ item: e }) => {
  const [t, n] = P.useState(!1);
  return /* @__PURE__ */ h.jsxs(
    "div",
    {
      className: `
                border-b border-border/30 py-3 px-4 cursor-pointer
                hover:bg-muted/10 transition-colors
                ${e.isReranked ? "bg-purple-500/5" : e.isTopK ? "bg-blue-500/5" : ""}
            `,
      onClick: () => n(!t),
      children: [
        /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-2 mb-1.5", children: [
          e.isReranked && /* @__PURE__ */ h.jsx("span", { className: "px-1.5 py-0.5 text-[10px] bg-purple-500/20 text-purple-400 rounded", children: "Rerank" }),
          e.isTopK && !e.isReranked && /* @__PURE__ */ h.jsx("span", { className: "px-1.5 py-0.5 text-[10px] bg-blue-500/20 text-blue-400 rounded", children: "TopK" }),
          /* @__PURE__ */ h.jsx("span", { className: "text-[10px] text-muted-foreground truncate max-w-[150px]", children: e.category }),
          e.sourceFloor && /* @__PURE__ */ h.jsxs("span", { className: "text-[10px] text-muted-foreground", children: [
            " #",
            e.sourceFloor
          ] }),
          /* @__PURE__ */ h.jsx(lu, { size: 12, className: `ml-auto text-muted-foreground transition-transform ${t ? "rotate-90" : ""}` })
        ] }),
        /* @__PURE__ */ h.jsx("p", { className: `text-sm text-foreground ${t ? "" : "line-clamp-2"}`, children: e.summary }),
        t && /* @__PURE__ */ h.jsxs("div", { className: "mt-3 space-y-1.5 pt-2 border-t border-border/20", children: [
          /* @__PURE__ */ h.jsx(Xg, { label: "Embedding", score: e.embeddingScore, color: "bg-blue-500" }),
          e.rerankScore != null && /* @__PURE__ */ h.jsx(Xg, { label: "Rerank", score: e.rerankScore, color: "bg-orange-500" }),
          e.hybridScore != null && /* @__PURE__ */ h.jsx(Xg, { label: "Hybrid", score: e.hybridScore, color: "bg-purple-500" })
        ] })
      ]
    }
  );
}, wS = ({ entry: e, isFullScreen: t, onClose: n }) => {
  const [r, a] = P.useState("all"), [o, l] = P.useState("hybrid"), [u, f] = P.useState(""), d = P.useMemo(() => {
    if (!e) return [];
    let m = [...e.results];
    if (u.trim()) {
      const p = u.toLowerCase();
      m = m.filter((x) => x.summary.toLowerCase().includes(p));
    }
    return r === "topK" ? m = m.filter((p) => p.isTopK) : r === "reranked" && (m = m.filter((p) => p.isReranked)), m.sort((p, x) => {
      const y = (w) => {
        switch (o) {
          case "embedding":
            return w.embeddingScore;
          case "rerank":
            return w.rerankScore ?? 0;
          case "hybrid":
            return w.hybridScore ?? (w.rerankScore != null ? (w.embeddingScore + w.rerankScore) / 2 : w.embeddingScore);
        }
      };
      return y(x) - y(p);
    }), m;
  }, [e, r, o, u]);
  return e ? /* @__PURE__ */ h.jsxs("div", { className: `flex flex-col h-full ${t ? "p-4" : ""}`, children: [
    t && n && /* @__PURE__ */ h.jsxs(
      "button",
      {
        onClick: n,
        className: "flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground mb-4",
        children: [
          /* @__PURE__ */ h.jsx(p2, { size: 16 }),
          ""
        ]
      }
    ),
    /* @__PURE__ */ h.jsxs("div", { className: "mb-4 pb-4 border-b border-border shrink-0", children: [
      /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-2 mb-2", children: [
        /* @__PURE__ */ h.jsx("span", { className: `px-2 py-0.5 rounded text-xs font-medium ${e.mode === "hybrid" ? "bg-purple-500/20 text-purple-400" : "bg-blue-500/20 text-blue-400"}`, children: e.mode === "hybrid" ? "" : "" }),
        /* @__PURE__ */ h.jsx("span", { className: "text-xs text-muted-foreground", children: i9(e.timestamp) })
      ] }),
      /* @__PURE__ */ h.jsx("p", { className: "text-sm text-foreground mb-2", children: e.query }),
      e.preprocessedQuery && e.preprocessedQuery !== e.query && /* @__PURE__ */ h.jsxs("p", { className: "text-xs text-muted-foreground", children: [
        " : ",
        e.preprocessedQuery
      ] }),
      /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-4 mt-3 text-xs text-muted-foreground", children: [
        /* @__PURE__ */ h.jsxs("span", { children: [
          ": ",
          e.stats.totalCandidates
        ] }),
        /* @__PURE__ */ h.jsxs("span", { children: [
          "TopK: ",
          e.stats.topKCount
        ] }),
        /* @__PURE__ */ h.jsxs("span", { children: [
          "Rerank: ",
          e.stats.rerankCount
        ] }),
        /* @__PURE__ */ h.jsxs("span", { className: "flex items-center gap-1", children: [
          /* @__PURE__ */ h.jsx(Po, { size: 10 }),
          a9(e.stats.latencyMs)
        ] })
      ] })
    ] }),
    /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-3 flex-wrap mb-3 shrink-0", children: [
      /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-1 text-xs", children: [
        /* @__PURE__ */ h.jsx(mz, { size: 12, className: "text-muted-foreground" }),
        ["all", "topK", "reranked"].map((m) => /* @__PURE__ */ h.jsx(
          "button",
          {
            className: `px-2 py-1 rounded transition-colors ${r === m ? "bg-primary/20 text-primary" : "text-muted-foreground hover:text-foreground"}`,
            onClick: () => a(m),
            children: m === "all" ? "" : m === "topK" ? "TopK" : "Reranked"
          },
          m
        ))
      ] }),
      /* @__PURE__ */ h.jsx("div", { className: "w-px h-4 bg-border" }),
      /* @__PURE__ */ h.jsx("div", { className: "flex items-center gap-1 text-xs", children: ["embedding", "rerank", "hybrid"].map((m) => /* @__PURE__ */ h.jsx(
        "button",
        {
          className: `px-2 py-1 rounded transition-colors ${o === m ? "bg-primary/20 text-primary" : "text-muted-foreground hover:text-foreground"}`,
          onClick: () => l(m),
          children: m.charAt(0).toUpperCase() + m.slice(1)
        },
        m
      )) }),
      /* @__PURE__ */ h.jsx("div", { className: "w-px h-4 bg-border" }),
      /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-1.5 text-muted-foreground", children: [
        /* @__PURE__ */ h.jsx(hi, { size: 12 }),
        /* @__PURE__ */ h.jsx(
          "input",
          {
            type: "text",
            placeholder: "...",
            value: u,
            onChange: (m) => f(m.target.value),
            className: "bg-transparent border-none outline-none text-xs text-foreground placeholder:text-muted-foreground w-24"
          }
        )
      ] })
    ] }),
    /* @__PURE__ */ h.jsx("div", { className: "flex-1 overflow-y-auto -mx-4 md:mx-0", children: d.length === 0 ? /* @__PURE__ */ h.jsx("div", { className: "py-8 text-center text-muted-foreground text-sm", children: "" }) : d.map((m, p) => /* @__PURE__ */ h.jsx(OU, { item: m }, p)) }),
    /* @__PURE__ */ h.jsxs("div", { className: "text-[10px] text-muted-foreground py-2 border-t border-border mt-2 shrink-0", children: [
      " ",
      d.length,
      " / ",
      e.results.length,
      " "
    ] })
  ] }) : /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col items-center justify-center h-full text-muted-foreground gap-3", children: [
    /* @__PURE__ */ h.jsx(w2, { size: 32, className: "opacity-30" }),
    /* @__PURE__ */ h.jsx("p", { className: "text-sm font-light", children: "" })
  ] });
}, DU = () => {
  const [e, t] = P.useState(th.getLogs()), [n, r] = P.useState(null), [a, o] = P.useState(window.innerWidth < bS), [l, u] = P.useState(!1);
  P.useEffect(() => {
    const p = () => {
      o(window.innerWidth < bS);
    };
    return window.addEventListener("resize", p), () => window.removeEventListener("resize", p);
  }, []), P.useEffect(() => th.subscribe((x) => {
    t(x);
  }), []);
  const f = P.useMemo(() => e.find((p) => p.id === n) || null, [e, n]), d = (p) => {
    r(p), a && u(!0);
  }, m = () => {
    u(!1), a && r(null);
  };
  return a && l && f ? /* @__PURE__ */ h.jsx(
    wS,
    {
      entry: f,
      isFullScreen: !0,
      onClose: m
    }
  ) : /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col h-full", children: [
    /* @__PURE__ */ h.jsxs("div", { className: "flex items-center justify-between px-4 py-3 border-b border-border shrink-0", children: [
      /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-2", children: [
        /* @__PURE__ */ h.jsx(w2, { size: 16, className: "text-primary" }),
        /* @__PURE__ */ h.jsx("span", { className: "font-medium text-foreground", children: "" }),
        /* @__PURE__ */ h.jsxs("span", { className: "text-xs text-muted-foreground", children: [
          "(",
          e.length,
          ")"
        ] })
      ] }),
      /* @__PURE__ */ h.jsx(
        "button",
        {
          className: "p-1.5 rounded-md hover:bg-destructive hover:text-destructive-foreground transition-colors text-muted-foreground",
          onClick: () => th.clear(),
          title: "",
          children: /* @__PURE__ */ h.jsx(Ri, { size: 14 })
        }
      )
    ] }),
    /* @__PURE__ */ h.jsxs("div", { className: "flex-1 flex min-h-0", children: [
      /* @__PURE__ */ h.jsx("div", { className: `
                    ${a ? "w-full" : "w-[30%] min-w-[240px]"}
                    overflow-y-auto
                    ${a ? "" : "border-r border-border/50"}
                `, children: e.length === 0 ? /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col items-center justify-center h-full text-muted-foreground gap-3 p-4", children: [
        /* @__PURE__ */ h.jsx(Dh, { size: 32, className: "opacity-30" }),
        /* @__PURE__ */ h.jsx("p", { className: "text-sm font-light", children: "" }),
        /* @__PURE__ */ h.jsx("p", { className: "text-xs opacity-70", children: " RAG " })
      ] }) : e.map((p) => /* @__PURE__ */ h.jsx(
        zU,
        {
          entry: p,
          isSelected: p.id === n,
          onSelect: () => d(p.id)
        },
        p.id
      )) }),
      !a && /* @__PURE__ */ h.jsx("div", { className: "flex-1 overflow-y-auto p-4", children: /* @__PURE__ */ h.jsx(wS, { entry: f }) })
    ] })
  ] });
}, s9 = ({ tabs: e, activeTab: t, onChange: n, sticky: r = !0, top: a = 0, className: o = "", actions: l }) => /* @__PURE__ */ h.jsxs(
  "div",
  {
    className: `
            flex items-center justify-between gap-4 mb-6 border-b border-border
            ${r ? "glass-sticky sticky z-20 pt-4 pb-0 -mt-4 -mx-4 px-4 md:-mx-8 md:px-8 lg:-mx-12 lg:px-12" : "px-0"}
            ${o}
        `,
    style: r ? {
      top: a
    } : void 0,
    children: [
      /* @__PURE__ */ h.jsx("div", { className: "flex overflow-x-auto gap-2 pb-1 no-scrollbar", children: e.map((u) => /* @__PURE__ */ h.jsxs(
        "button",
        {
          onClick: () => n(u.id),
          className: `flex items-center gap-2 whitespace-nowrap px-4 py-1.5 text-sm transition-all relative ${t === u.id ? "text-foreground" : "text-muted-foreground hover:text-foreground"}`,
          children: [
            u.icon && /* @__PURE__ */ h.jsx("span", { className: "w-4 h-4", children: u.icon }),
            u.label,
            t === u.id && /* @__PURE__ */ h.jsx("div", { className: "absolute -bottom-[1px] left-0 right-0 h-[2px] bg-primary shadow-[0_0_8px_var(--primary)] z-10 transition-all duration-300" })
          ]
        },
        u.id
      )) }),
      l && /* @__PURE__ */ h.jsx("div", { className: "flex items-center gap-2 pb-1 shrink-0", children: l })
    ]
  }
), Kh = (e) => {
  const [t, n] = P.useState(!1);
  P.useEffect(() => (n(!0), () => n(!1)), []);
  const r = document.getElementById("engram-header-extension");
  if (!t || !r)
    return null;
  const a = {
    ...e,
    sticky: !1,
    className: `!mb-0 !border-0 !bg-transparent px-4 md:px-8 lg:px-12 ${e.className || ""}`
  };
  return mj.createPortal(
    /* @__PURE__ */ h.jsx(s9, { ...a }),
    r
  );
}, IU = [
  { id: "runtime", label: "", icon: /* @__PURE__ */ h.jsx(qh, { size: 14 }) },
  { id: "model", label: "", icon: /* @__PURE__ */ h.jsx(Po, { size: 14 }) },
  { id: "recall", label: "", icon: /* @__PURE__ */ h.jsx(w2, { size: 14 }) }
], LU = [
  "ALL",
  "Logger",
  "EventBus",
  "Summarizer",
  "CORE/Pipeline",
  "CORE/RAG",
  "CORE/Memory",
  "UI/GraphView",
  "UI/MemoryStream"
], qU = ({ initialTab: e }) => {
  const [t, n] = P.useState(e || "runtime"), [r, a] = P.useState([]), [o, l] = P.useState([]), [u, f] = P.useState(""), [d, m] = P.useState(-1), [p, x] = P.useState("ALL"), [y, w] = P.useState(!0), [E, k] = P.useState(!1), [C, T] = P.useState(!1), N = P.useRef(null);
  P.useEffect(() => {
    a(le.getLogs());
    const M = le.subscribe((O) => {
      a((Y) => [...Y, O]);
    });
    return () => M();
  }, []), P.useEffect(() => {
    let M = r;
    if (d !== -1 && (M = M.filter((O) => O.level >= d)), p !== "ALL" && (M = M.filter((O) => O.module.startsWith(p))), u.trim()) {
      const O = u.toLowerCase();
      M = M.filter(
        (Y) => Y.message.toLowerCase().includes(O) || Y.module.toLowerCase().includes(O)
      );
    }
    l(M);
  }, [r, d, p, u]), P.useEffect(() => {
    y && N.current && N.current.scrollIntoView({ behavior: "smooth", block: "nearest" });
  }, [o, y]);
  const A = P.useCallback(async () => {
    await le.clear(), a([]);
  }, []), D = P.useCallback(() => {
    const M = le.exportToMarkdown(), O = le.getExportFilename(), Y = new Blob([M], { type: "text/markdown" }), X = URL.createObjectURL(Y), U = document.createElement("a");
    U.href = X, U.download = O, U.click(), URL.revokeObjectURL(X), le.success("DevLog", `: ${O}`);
  }, []);
  return /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col h-full", children: [
    /* @__PURE__ */ h.jsxs("div", { className: "mb-2", children: [
      /* @__PURE__ */ h.jsx("h1", { className: "text-2xl font-light text-foreground tracking-tight mb-2", children: "" }),
      /* @__PURE__ */ h.jsx("p", { className: "text-sm text-muted-foreground", children: "" })
    ] }),
    /* @__PURE__ */ h.jsx(
      Kh,
      {
        tabs: IU,
        activeTab: t,
        onChange: (M) => n(M)
      }
    ),
    t === "runtime" && /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col flex-1 min-h-0", children: [
      /* @__PURE__ */ h.jsx("div", { className: "sticky top-0 z-10 bg-background/95 backdrop-blur-sm py-3 -mx-4 px-4 md:-mx-8 md:px-8 lg:-mx-12 lg:px-12 border-b border-border", children: /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-2 flex-wrap", children: [
        /* @__PURE__ */ h.jsxs("div", { className: "relative", children: [
          /* @__PURE__ */ h.jsxs(
            "button",
            {
              className: "inline-flex items-center gap-1.5 px-2.5 py-1.5 text-xs text-muted-foreground hover:text-foreground transition-colors",
              onClick: () => k(!E),
              children: [
                d === -1 ? "" : dh[d].label,
                /* @__PURE__ */ h.jsx(Ro, { size: 12 })
              ]
            }
          ),
          E && /* @__PURE__ */ h.jsxs("div", { className: "absolute top-full left-0 mt-1 bg-popover border border-border rounded-md shadow-lg z-20 min-w-[100px] py-1 flex flex-col", children: [
            /* @__PURE__ */ h.jsx(
              "button",
              {
                className: "block w-full text-left px-3 py-1.5 text-xs hover:bg-accent transition-colors",
                onClick: () => {
                  m(-1), k(!1);
                },
                children: ""
              }
            ),
            Object.entries(dh).map(([M, O]) => /* @__PURE__ */ h.jsxs(
              "button",
              {
                className: "block w-full text-left px-3 py-1.5 text-xs hover:bg-accent transition-colors",
                onClick: () => {
                  m(Number(M)), k(!1);
                },
                children: [
                  O.icon,
                  " ",
                  O.label
                ]
              },
              M
            ))
          ] })
        ] }),
        /* @__PURE__ */ h.jsx("div", { className: "w-px h-4 bg-border" }),
        /* @__PURE__ */ h.jsxs("div", { className: "relative", children: [
          /* @__PURE__ */ h.jsxs(
            "button",
            {
              className: "inline-flex items-center gap-1.5 px-2.5 py-1.5 text-xs text-muted-foreground hover:text-foreground transition-colors",
              onClick: () => T(!C),
              children: [
                p,
                /* @__PURE__ */ h.jsx(Ro, { size: 12 })
              ]
            }
          ),
          C && /* @__PURE__ */ h.jsx("div", { className: "absolute top-full left-0 mt-1 bg-popover border border-border rounded-md shadow-lg z-20 min-w-[120px] py-1 max-h-48 overflow-y-auto flex flex-col", children: LU.map((M) => /* @__PURE__ */ h.jsx(
            "button",
            {
              className: "block w-full text-left px-3 py-1.5 text-xs hover:bg-accent transition-colors",
              onClick: () => {
                x(M), T(!1);
              },
              children: M
            },
            M
          )) })
        ] }),
        /* @__PURE__ */ h.jsx("div", { className: "w-px h-4 bg-border" }),
        /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-1.5 text-muted-foreground", children: [
          /* @__PURE__ */ h.jsx(hi, { size: 12 }),
          /* @__PURE__ */ h.jsx(
            "input",
            {
              type: "text",
              placeholder: "...",
              value: u,
              onChange: (M) => f(M.target.value),
              className: "bg-transparent border-none outline-none text-xs text-foreground placeholder:text-muted-foreground w-24 md:w-40"
            }
          )
        ] }),
        /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-1 ml-auto", children: [
          /* @__PURE__ */ h.jsx(
            "button",
            {
              className: `p-1.5 rounded transition-colors ${y ? "text-primary" : "text-muted-foreground hover:text-foreground"}`,
              onClick: () => w(!y),
              title: "",
              children: /* @__PURE__ */ h.jsx(TR, { size: 14 })
            }
          ),
          /* @__PURE__ */ h.jsx(
            "button",
            {
              className: "p-1.5 rounded text-muted-foreground hover:text-foreground transition-colors",
              onClick: A,
              title: "",
              children: /* @__PURE__ */ h.jsx(Ri, { size: 14 })
            }
          ),
          /* @__PURE__ */ h.jsxs(
            "button",
            {
              className: "inline-flex items-center gap-1 px-2 py-1 text-xs text-muted-foreground hover:text-foreground transition-colors",
              onClick: D,
              children: [
                /* @__PURE__ */ h.jsx(Dc, { size: 12 }),
                ""
              ]
            }
          )
        ] })
      ] }) }),
      /* @__PURE__ */ h.jsx("div", { className: "flex-1 overflow-y-auto font-mono text-xs leading-relaxed py-2", children: o.length === 0 ? /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col items-center justify-center h-full gap-3 text-muted-foreground", children: [
        /* @__PURE__ */ h.jsx(qh, { size: 32, strokeWidth: 1, className: "opacity-30" }),
        /* @__PURE__ */ h.jsx("p", { className: "text-sm font-light", children: "" })
      ] }) : /* @__PURE__ */ h.jsxs(h.Fragment, { children: [
        o.map((M) => /* @__PURE__ */ h.jsx(kU, { entry: M }, M.id)),
        /* @__PURE__ */ h.jsx("div", { ref: N })
      ] }) }),
      /* @__PURE__ */ h.jsxs("div", { className: "text-[10px] text-muted-foreground py-2 border-t border-border", children: [
        r.length,
        " ",
        o.length !== r.length && `  ${o.length} `
      ] })
    ] }),
    t === "model" && /* @__PURE__ */ h.jsx("div", { className: "flex-1 overflow-hidden", children: /* @__PURE__ */ h.jsx(RU, {}) }),
    t === "recall" && /* @__PURE__ */ h.jsx("div", { className: "flex-1 overflow-hidden", children: /* @__PURE__ */ h.jsx(DU, {}) })
  ] });
}, PU = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  DevLog: qU
}, Symbol.toStringTag, { value: "Module" })), BU = {
  default: "text-muted-foreground bg-muted/50",
  primary: "text-primary bg-primary/10",
  blue: "text-blue-500 bg-blue-500/10",
  purple: "text-purple-500 bg-purple-500/10",
  orange: "text-orange-500 bg-orange-500/10",
  emerald: "text-emerald-500 bg-emerald-500/10"
}, FU = ({
  icon: e,
  title: t,
  subtitle: n,
  meta: r,
  badges: a = [],
  selected: o = !1,
  disabled: l = !1,
  toggle: u,
  onClick: f,
  actions: d = [],
  className: m = "",
  compact: p = !1
}) => {
  const x = d.filter((w) => !w.hidden), y = !!u;
  return /* @__PURE__ */ h.jsxs(
    "div",
    {
      className: `
                group relative flex items-center gap-3 
                ${p ? "py-2 px-2" : "py-3 px-3"}
                rounded-lg cursor-pointer transition-all duration-150
                ${o ? "bg-accent/60" : "hover:bg-muted/40"}
                ${l ? "opacity-50 pointer-events-none" : ""}
                ${m}
            `,
      onClick: f,
      children: [
        (e || y) && /* @__PURE__ */ h.jsx("div", { className: "flex-shrink-0", children: y ? /* @__PURE__ */ h.jsx(
          "button",
          {
            className: `
                                w-7 h-7 flex items-center justify-center rounded-md transition-colors
                                ${u.checked ? "text-primary" : "text-muted-foreground hover:text-foreground"}
                            `,
            onClick: (w) => {
              w.stopPropagation(), u.onChange(!u.checked);
            },
            children: /* @__PURE__ */ h.jsx(Lh, { size: 14 })
          }
        ) : /* @__PURE__ */ h.jsx("div", { className: `
                            w-7 h-7 flex items-center justify-center rounded-md transition-colors
                            ${o ? "text-primary" : "text-muted-foreground group-hover:text-foreground"}
                        `, children: e }) }),
        /* @__PURE__ */ h.jsxs("div", { className: "flex-1 min-w-0", children: [
          /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-2", children: [
            /* @__PURE__ */ h.jsx("span", { className: `
                        text-sm font-medium truncate transition-colors
                        ${o ? "text-foreground" : "text-muted-foreground group-hover:text-foreground"}
                        ${u && !u.checked ? "line-through opacity-60" : ""}
                    `, children: t }),
            a.map((w, E) => /* @__PURE__ */ h.jsx(
              "span",
              {
                className: `
                                text-[10px] px-1.5 py-0.5 rounded-sm font-medium flex-shrink-0
                                ${BU[w.color || "default"]}
                            `,
                children: w.text
              },
              E
            ))
          ] }),
          (n || r) && /* @__PURE__ */ h.jsxs("div", { className: "flex items-center justify-between mt-0.5 text-[11px] text-muted-foreground/70", children: [
            n && /* @__PURE__ */ h.jsx("span", { className: "truncate", children: n }),
            r && /* @__PURE__ */ h.jsx("span", { className: "flex-shrink-0 font-mono", children: r })
          ] })
        ] }),
        o && !x.length && /* @__PURE__ */ h.jsx(zh, { size: 14, className: "text-primary flex-shrink-0" }),
        x.length > 0 && /* @__PURE__ */ h.jsx("div", { className: `
                    flex items-center gap-0.5 flex-shrink-0
                    ${o ? "opacity-100" : "opacity-0 group-hover:opacity-100"}
                    transition-opacity
                `, children: x.map((w, E) => /* @__PURE__ */ h.jsx(
          "button",
          {
            className: `
                                p-1.5 rounded transition-colors
                                ${w.danger ? "text-muted-foreground hover:text-destructive hover:bg-destructive/10" : "text-muted-foreground hover:text-foreground hover:bg-muted"}
                            `,
            onClick: (k) => {
              k.stopPropagation(), w.onClick(k);
            },
            title: w.title,
            children: w.icon
          },
          E
        )) })
      ]
    }
  );
}, $U = ({
  preset: e,
  isSelected: t,
  onSelect: n,
  onEdit: r,
  onCopy: a,
  onDelete: o
}) => {
  var f;
  const l = e.source === "tavern" || e.source === "tavern_profile" ? uO : nz, u = e.source === "custom" ? ((f = e.custom) == null ? void 0 : f.model) || "" : "";
  return /* @__PURE__ */ h.jsx(
    FU,
    {
      icon: /* @__PURE__ */ h.jsx(l, { size: 14 }),
      title: e.name,
      subtitle: u,
      meta: `T:${e.parameters.temperature}`,
      badges: e.isDefault ? [{ text: "DEFAULT", color: "primary" }] : [],
      selected: t,
      onClick: n,
      actions: [
        { icon: /* @__PURE__ */ h.jsx(Kz, { size: 12 }), onClick: () => r(), title: "" },
        { icon: /* @__PURE__ */ h.jsx(y2, { size: 12 }), onClick: () => a(), title: "" },
        { icon: /* @__PURE__ */ h.jsx(Ri, { size: 12 }), onClick: () => o(), title: "", danger: !0, hidden: e.isDefault }
      ]
    }
  );
}, gr = ({ title: e, description: t, children: n, className: r = "" }) => /* @__PURE__ */ h.jsxs("div", { className: `mb-8 ${r}`, children: [
  /* @__PURE__ */ h.jsxs("div", { className: "mb-4", children: [
    /* @__PURE__ */ h.jsx("h3", { className: "text-sm font-medium text-primary", children: e }),
    t && /* @__PURE__ */ h.jsx("p", { className: "text-xs text-muted-foreground mt-1 break-words", children: t })
  ] }),
  /* @__PURE__ */ h.jsx("div", { className: "space-y-4", children: n })
] }), ur = ({
  label: e,
  description: t,
  error: n,
  required: r,
  className: a = "",
  value: o,
  onChange: l,
  placeholder: u,
  type: f = "text",
  disabled: d,
  multiline: m,
  rows: p = 3
}) => {
  const x = {
    background: "transparent",
    backgroundColor: "transparent",
    border: "none",
    borderBottom: "1px solid var(--border)",
    borderRadius: 0,
    boxShadow: "none",
    outline: "none",
    padding: "8px 0",
    fontSize: "14px",
    width: "100%",
    color: "var(--foreground, inherit)"
  };
  return /* @__PURE__ */ h.jsxs("div", { className: `flex flex-col gap-1 ${a}`, children: [
    /* @__PURE__ */ h.jsxs("label", { className: "text-xs text-muted-foreground flex items-center gap-1", children: [
      e,
      r && /* @__PURE__ */ h.jsx("span", { className: "text-destructive", children: "*" })
    ] }),
    m ? /* @__PURE__ */ h.jsx(
      "textarea",
      {
        value: o,
        onChange: (y) => l(y.target.value),
        placeholder: u,
        disabled: d,
        rows: p,
        style: x,
        className: "font-mono resize-y min-h-[80px] placeholder:text-muted-foreground/40 disabled:opacity-50 focus:border-primary transition-colors"
      }
    ) : /* @__PURE__ */ h.jsx(
      "input",
      {
        type: f,
        value: o,
        onChange: (y) => l(y.target.value),
        placeholder: u,
        disabled: d,
        style: x,
        className: "placeholder:text-muted-foreground/40 disabled:opacity-50 focus:border-primary transition-colors"
      }
    ),
    t && /* @__PURE__ */ h.jsx("p", { className: "text-[10px] text-muted-foreground/70 break-words", children: t }),
    n && /* @__PURE__ */ h.jsx("p", { className: "text-[10px] text-destructive", children: n })
  ] });
}, er = ({
  label: e,
  description: t,
  error: n,
  required: r,
  className: a = "",
  value: o,
  onChange: l,
  min: u,
  max: f,
  step: d = 1,
  showSlider: m = !0,
  suffix: p
}) => {
  const x = {
    background: "transparent",
    backgroundColor: "transparent",
    border: "none",
    borderRadius: 0,
    boxShadow: "none",
    outline: "none",
    padding: "0",
    fontSize: "12px",
    width: "auto",
    minWidth: "40px",
    textAlign: "right",
    fontFamily: "monospace",
    color: "var(--foreground, inherit)"
  }, y = u !== void 0 && f !== void 0 ? Math.min(100, Math.max(0, (o - u) / (f - u) * 100)) : 0;
  return /* @__PURE__ */ h.jsxs("div", { className: `flex flex-col gap-2 ${a}`, children: [
    /* @__PURE__ */ h.jsxs("div", { className: "flex justify-between items-center", children: [
      /* @__PURE__ */ h.jsxs("label", { className: "text-xs text-muted-foreground flex items-center gap-1", children: [
        e,
        r && /* @__PURE__ */ h.jsx("span", { className: "text-destructive", children: "*" })
      ] }),
      /* @__PURE__ */ h.jsx(
        "input",
        {
          type: "number",
          min: u,
          max: f,
          step: d,
          value: o,
          onChange: (w) => l(Number(w.target.value)),
          style: x,
          className: "focus:text-primary transition-colors [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"
        }
      )
    ] }),
    /* @__PURE__ */ h.jsx("div", { className: "flex items-center gap-3 pt-1", children: m && u !== void 0 && f !== void 0 && /* @__PURE__ */ h.jsxs("div", { className: "flex-1 relative h-4 flex items-center group cursor-pointer", children: [
      /* @__PURE__ */ h.jsx(
        "div",
        {
          className: "absolute inset-x-0 h-[1px]",
          style: { backgroundColor: "var(--border)" }
        }
      ),
      /* @__PURE__ */ h.jsx(
        "div",
        {
          className: "absolute top-1/2 -translate-y-1/2 w-2.5 h-2.5 bg-muted-foreground/80 rounded-full shadow-sm pointer-events-none transition-transform duration-75 ease-out group-hover:scale-125 group-hover:bg-foreground",
          style: { left: `${y}%`, transform: "translate(-50%, -50%)" }
        }
      ),
      /* @__PURE__ */ h.jsx(
        "input",
        {
          type: "range",
          min: u,
          max: f,
          step: d,
          value: o,
          onChange: (w) => l(Number(w.target.value)),
          className: "absolute inset-x-0 w-full h-full opacity-0 cursor-pointer z-10 m-0",
          style: { appearance: "none", WebkitAppearance: "none" }
        }
      )
    ] }) }),
    t && /* @__PURE__ */ h.jsx("p", { className: "text-[10px] text-muted-foreground/70 break-words", children: t }),
    n && /* @__PURE__ */ h.jsx("p", { className: "text-[10px] text-destructive", children: n })
  ] });
}, Ua = ({
  label: e,
  description: t,
  error: n,
  required: r,
  className: a = "",
  value: o,
  onChange: l,
  options: u,
  placeholder: f = "...",
  disabled: d
}) => {
  const m = {
    background: "transparent",
    backgroundColor: "transparent",
    border: "none",
    borderBottom: "1px solid var(--border)",
    borderRadius: 0,
    boxShadow: "none",
    outline: "none",
    padding: "8px 24px 8px 0",
    fontSize: "14px",
    width: "100%",
    cursor: "pointer",
    color: "var(--foreground, inherit)",
    appearance: "none",
    WebkitAppearance: "none"
  };
  return /* @__PURE__ */ h.jsxs("div", { className: `flex flex-col gap-1 ${a}`, children: [
    /* @__PURE__ */ h.jsxs("label", { className: "text-xs text-muted-foreground flex items-center gap-1", children: [
      e,
      r && /* @__PURE__ */ h.jsx("span", { className: "text-destructive", children: "*" })
    ] }),
    /* @__PURE__ */ h.jsxs("div", { className: "relative", children: [
      /* @__PURE__ */ h.jsxs(
        "select",
        {
          value: o,
          onChange: (p) => l(p.target.value),
          disabled: d,
          style: m,
          className: "disabled:opacity-50 disabled:cursor-not-allowed focus:border-primary transition-colors",
          children: [
            /* @__PURE__ */ h.jsx("option", { value: "", disabled: !0, className: "bg-popover text-muted-foreground", children: f }),
            u.map((p) => /* @__PURE__ */ h.jsx("option", { value: p.value, className: "bg-popover text-foreground", children: p.label }, p.value))
          ]
        }
      ),
      /* @__PURE__ */ h.jsx(Ro, { size: 14, className: "absolute right-0 top-1/2 -translate-y-1/2 text-muted-foreground/50 pointer-events-none" })
    ] }),
    t && /* @__PURE__ */ h.jsx("p", { className: "text-[10px] text-muted-foreground/70 break-words", children: t }),
    n && /* @__PURE__ */ h.jsx("p", { className: "text-[10px] text-destructive", children: n })
  ] });
}, Ei = ({
  label: e,
  description: t,
  error: n,
  className: r = "",
  checked: a,
  onChange: o,
  disabled: l,
  compact: u
}) => /* @__PURE__ */ h.jsxs("div", { className: `flex items-start justify-between gap-4 ${u ? "py-0" : "py-1"} ${r} ${l ? "opacity-50 pointer-events-none" : ""}`, children: [
  e && /* @__PURE__ */ h.jsxs("div", { className: "flex-1 min-w-0", children: [
    /* @__PURE__ */ h.jsx(
      "label",
      {
        className: "text-xs text-foreground cursor-pointer block truncate",
        onClick: () => !l && o(!a),
        children: e
      }
    ),
    t && /* @__PURE__ */ h.jsx("p", { className: "text-[10px] text-muted-foreground/70 mt-0.5 break-words", children: t }),
    n && /* @__PURE__ */ h.jsx("p", { className: "text-[10px] text-destructive mt-0.5", children: n })
  ] }),
  /* @__PURE__ */ h.jsx(
    Jn,
    {
      checked: a,
      onChange: o,
      disabled: l
    }
  )
] }), o9 = ({
  label: e,
  description: t,
  error: n,
  required: r,
  className: a = "",
  value: o,
  onChange: l,
  options: u,
  placeholder: f = "...",
  disabled: d,
  emptyText: m = ""
}) => {
  var A;
  const [p, x] = P.useState(!1), [y, w] = P.useState(""), E = P.useRef(null), k = P.useRef(null), C = u.filter(
    (D) => D.label.toLowerCase().includes(y.toLowerCase()) || D.value.toLowerCase().includes(y.toLowerCase())
  ), T = ((A = u.find((D) => D.value === o)) == null ? void 0 : A.label) || o || f;
  P.useEffect(() => {
    const D = (M) => {
      E.current && !E.current.contains(M.target) && (x(!1), w(""));
    };
    return document.addEventListener("mousedown", D), () => document.removeEventListener("mousedown", D);
  }, []), P.useEffect(() => {
    p && k.current && k.current.focus();
  }, [p]);
  const N = (D) => {
    l(D), x(!1), w("");
  };
  return /* @__PURE__ */ h.jsxs("div", { className: `flex flex-col gap-1 ${a}`, ref: E, children: [
    /* @__PURE__ */ h.jsxs("label", { className: "text-xs text-muted-foreground flex items-center gap-1", children: [
      e,
      r && /* @__PURE__ */ h.jsx("span", { className: "text-destructive", children: "*" })
    ] }),
    /* @__PURE__ */ h.jsxs(
      "button",
      {
        type: "button",
        onClick: () => !d && x(!p),
        disabled: d,
        className: "relative w-full text-left py-2 pr-6 border-0 border-b border-border bg-transparent text-sm text-foreground cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed focus:border-primary transition-colors",
        children: [
          /* @__PURE__ */ h.jsx("span", { className: o ? "" : "text-muted-foreground", children: T }),
          /* @__PURE__ */ h.jsx(
            Ro,
            {
              size: 14,
              className: `absolute right-0 top-1/2 -translate-y-1/2 text-muted-foreground/50 transition-transform ${p ? "rotate-180" : ""}`
            }
          )
        ]
      }
    ),
    p && /* @__PURE__ */ h.jsxs(
      "div",
      {
        className: "glass-panel absolute z-50 mt-1 w-full max-h-64 border border-border rounded-lg shadow-xl overflow-hidden flex flex-col animate-in fade-in slide-in-from-top-1 duration-150",
        style: { top: "100%", left: 0, right: 0 },
        children: [
          /* @__PURE__ */ h.jsxs("div", { className: "p-2 border-b border-border flex items-center gap-2", children: [
            /* @__PURE__ */ h.jsx(hi, { size: 14, className: "text-muted-foreground flex-shrink-0" }),
            /* @__PURE__ */ h.jsx(
              "input",
              {
                ref: k,
                type: "text",
                value: y,
                onChange: (D) => w(D.target.value),
                placeholder: "...",
                className: "flex-1 bg-transparent border-none outline-none text-sm text-foreground placeholder:text-muted-foreground/50"
              }
            ),
            y && /* @__PURE__ */ h.jsx(
              "button",
              {
                type: "button",
                onClick: () => w(""),
                className: "p-0.5 hover:bg-muted rounded",
                children: /* @__PURE__ */ h.jsx(cu, { size: 12, className: "text-muted-foreground" })
              }
            )
          ] }),
          /* @__PURE__ */ h.jsx("div", { className: "overflow-y-auto max-h-48", children: C.length > 0 ? C.map((D) => /* @__PURE__ */ h.jsx(
            "div",
            {
              onClick: () => N(D.value),
              className: `px-3 py-2 cursor-pointer text-sm truncate transition-colors ${D.value === o ? "bg-primary/15 text-primary" : "hover:bg-muted text-foreground"}`,
              title: D.label,
              children: D.label
            },
            D.value
          )) : /* @__PURE__ */ h.jsx("div", { className: "px-3 py-4 text-center text-sm text-muted-foreground", children: y ? "" : m }) }),
          u.length > 10 && /* @__PURE__ */ h.jsxs("div", { className: "px-3 py-1 border-t border-border text-xs text-muted-foreground/70", children: [
            C.length,
            " / ",
            u.length,
            " "
          ] })
        ]
      }
    ),
    t && /* @__PURE__ */ h.jsx("p", { className: "text-[10px] text-muted-foreground/70 break-words", children: t }),
    n && /* @__PURE__ */ h.jsx("p", { className: "text-[10px] text-destructive", children: n })
  ] });
};
class Zi {
  // 10
  /**
   *  API 
   */
  static async fetchModels(t, n) {
    switch (t) {
      case "openai":
        return this.fetchOpenAIModels(n);
      case "ollama":
        return this.fetchOllamaModels(n);
      case "vllm":
        return this.fetchVLLMModels(n);
      case "cohere":
        return this.fetchCohereModels(n);
      case "jina":
      case "voyage":
        return this.getPresetModels(t);
      default:
        return le.warn("ModelService", `Unknown API type: ${t}`), [];
    }
  }
  /**
   *  OpenAI  API 
   * : OpenAI, Azure,  OpenAI 
   */
  static async fetchOpenAIModels(t) {
    const { apiUrl: n, apiKey: r, timeout: a = this.DEFAULT_TIMEOUT } = t, o = n.replace(/\/+$/, ""), l = o.endsWith("/v1") ? `${o}/models` : `${o}/v1/models`;
    try {
      const u = new AbortController(), f = setTimeout(() => u.abort(), a), d = {
        "Content-Type": "application/json"
      };
      r && (d.Authorization = `Bearer ${r}`);
      const m = await fetch(l, {
        method: "GET",
        headers: d,
        signal: u.signal
      });
      if (clearTimeout(f), !m.ok)
        throw new Error(`HTTP ${m.status}: ${m.statusText}`);
      const p = await m.json(), x = (p.data || p || []).map((y) => ({
        id: y.id || y.model,
        name: y.name || y.id || y.model,
        owned_by: y.owned_by
      }));
      return le.info("ModelService", `Fetched ${x.length} models from OpenAI API`), x.sort((y, w) => y.id.localeCompare(w.id));
    } catch (u) {
      throw u.name === "AbortError" ? le.error("ModelService", "OpenAI API request timeout") : le.error("ModelService", `OpenAI API error: ${u.message}`), u;
    }
  }
  /**
   *  Ollama 
   */
  static async fetchOllamaModels(t) {
    const { apiUrl: n, timeout: r = this.DEFAULT_TIMEOUT } = t, o = `${n.replace(/\/+$/, "")}/api/tags`;
    try {
      const l = new AbortController(), u = setTimeout(() => l.abort(), r), f = await fetch(o, {
        method: "GET",
        signal: l.signal
      });
      if (clearTimeout(u), !f.ok)
        throw new Error(`HTTP ${f.status}: ${f.statusText}`);
      const m = ((await f.json()).models || []).map((p) => ({
        id: p.name || p.model,
        name: p.name || p.model
      }));
      return le.info("ModelService", `Fetched ${m.length} models from Ollama`), m;
    } catch (l) {
      throw le.error("ModelService", `Ollama API error: ${l.message}`), l;
    }
  }
  /**
   *  vLLM 
   * vLLM  OpenAI  API
   */
  static async fetchVLLMModels(t) {
    return this.fetchOpenAIModels(t);
  }
  /**
   *  Cohere 
   */
  static async fetchCohereModels(t) {
    const { apiKey: n, timeout: r = this.DEFAULT_TIMEOUT } = t;
    if (!n)
      return le.warn("ModelService", "Cohere API key required"), this.getPresetModels("cohere");
    try {
      const a = new AbortController(), o = setTimeout(() => a.abort(), r), l = await fetch("https://api.cohere.ai/v1/models", {
        method: "GET",
        headers: {
          Authorization: `Bearer ${n}`,
          "Content-Type": "application/json"
        },
        signal: a.signal
      });
      if (clearTimeout(o), !l.ok)
        throw new Error(`HTTP ${l.status}: ${l.statusText}`);
      const f = ((await l.json()).models || []).filter((d) => {
        var m;
        return (m = d.endpoints) == null ? void 0 : m.includes("embed");
      }).map((d) => ({
        id: d.name,
        name: d.name,
        contextLength: d.context_length
      }));
      return le.info("ModelService", `Fetched ${f.length} embed models from Cohere`), f;
    } catch (a) {
      return le.error("ModelService", `Cohere API error: ${a.message}`), this.getPresetModels("cohere");
    }
  }
  /**
   * 
   */
  static getPresetModels(t) {
    return {
      cohere: [
        { id: "embed-multilingual-v3.0", name: "Embed Multilingual v3.0" },
        { id: "embed-english-v3.0", name: "Embed English v3.0" },
        { id: "embed-multilingual-light-v3.0", name: "Embed Multilingual Light v3.0" },
        { id: "embed-english-light-v3.0", name: "Embed English Light v3.0" }
      ],
      jina: [
        { id: "jina-embeddings-v3", name: "Jina Embeddings v3" },
        { id: "jina-embeddings-v2-base-en", name: "Jina Embeddings v2 Base EN" },
        { id: "jina-embeddings-v2-base-zh", name: "Jina Embeddings v2 Base ZH" },
        { id: "jina-colbert-v2", name: "Jina ColBERT v2" }
      ],
      voyage: [
        { id: "voyage-3", name: "Voyage 3" },
        { id: "voyage-3-lite", name: "Voyage 3 Lite" },
        { id: "voyage-large-2", name: "Voyage Large 2" },
        { id: "voyage-code-2", name: "Voyage Code 2" },
        { id: "voyage-multilingual-2", name: "Voyage Multilingual 2" }
      ],
      openai: [
        { id: "text-embedding-3-large", name: "Text Embedding 3 Large" },
        { id: "text-embedding-3-small", name: "Text Embedding 3 Small" },
        { id: "text-embedding-ada-002", name: "Text Embedding Ada 002" }
      ]
    }[t] || [];
  }
  /**
   *  Rerank 
   */
  static getCommonRerankModels() {
    return [
      { id: "BAAI/bge-reranker-v2-m3", name: "BGE Reranker v2 m3" },
      { id: "BAAI/bge-reranker-large", name: "BGE Reranker Large" },
      { id: "BAAI/bge-reranker-base", name: "BGE Reranker Base" },
      { id: "cross-encoder/ms-marco-MiniLM-L-12-v2", name: "MS MARCO MiniLM L12" },
      { id: "Xenova/ms-marco-MiniLM-L-6-v2", name: "MS MARCO MiniLM L6 (ONNX)" },
      { id: "jinaai/jina-reranker-v2-base-multilingual", name: "Jina Reranker v2 Multilingual" }
    ];
  }
}
nt(Zi, "DEFAULT_TIMEOUT", 1e4);
const UU = [
  { value: "openai", label: "OpenAI" },
  { value: "anthropic", label: "Anthropic" },
  { value: "ollama", label: "Ollama" },
  { value: "vllm", label: "vLLM" },
  { value: "azure", label: "Azure OpenAI" },
  { value: "custom", label: "" }
], HU = [
  { value: "tavern", label: "" },
  { value: "tavern_profile", label: "" },
  { value: "custom", label: " API " }
];
function GU() {
  var e, t, n, r;
  try {
    const a = (n = (t = (e = window.SillyTavern) == null ? void 0 : e.getContext) == null ? void 0 : t.call(e)) == null ? void 0 : n.extensionSettings;
    return ((r = a == null ? void 0 : a.connectionManager) == null ? void 0 : r.profiles) || [];
  } catch (a) {
    return console.warn("[Engram]  connection_profiles:", a), [];
  }
}
const _S = ({
  preset: e,
  onChange: t,
  isNew: n = !1
}) => {
  var D, M, O, Y, X, U;
  const [r, a] = P.useState([]), [o, l] = P.useState(!1), [u, f] = P.useState([]), [d, m] = P.useState(!1), [p, x] = P.useState(null), y = () => {
    l(!0);
    try {
      const B = GU();
      a(B);
    } finally {
      l(!1);
    }
  }, w = async () => {
    const { apiUrl: B, apiKey: G, apiSource: re } = e.custom || {};
    if (!B) {
      x(" API URL");
      return;
    }
    m(!0), x(null);
    try {
      let q = [];
      re === "ollama" ? q = await Zi.fetchOllamaModels({ apiUrl: B }) : q = await Zi.fetchOpenAIModels({ apiUrl: B, apiKey: G }), f(q), q.length === 0 && x("");
    } catch (q) {
      x(q.message || ""), f([]);
    } finally {
      m(!1);
    }
  };
  P.useEffect(() => {
    y();
  }, []);
  const E = (B) => {
    t({ ...e, ...B, updatedAt: Date.now() });
  }, k = (B, G) => {
    E({
      parameters: { ...e.parameters, [B]: G }
    });
  }, C = (B, G) => {
    var re, q, W, V;
    E({
      custom: {
        apiUrl: ((re = e.custom) == null ? void 0 : re.apiUrl) || "",
        apiKey: ((q = e.custom) == null ? void 0 : q.apiKey) || "",
        model: ((W = e.custom) == null ? void 0 : W.model) || "",
        apiSource: ((V = e.custom) == null ? void 0 : V.apiSource) || "openai",
        [B]: G
      }
    });
  }, T = (B) => {
    const G = B;
    E({
      source: G,
      tavernProfileId: G === "tavern_profile" ? e.tavernProfileId : void 0
    }), G === "tavern_profile" && y();
  }, N = r.map((B) => ({
    value: B.id,
    label: `${B.name} (${B.api || "Unknown"} - ${B.model || "Unknown"})`
  })), A = r.find((B) => B.id === e.tavernProfileId);
  return /* @__PURE__ */ h.jsxs("div", { className: "", children: [
    /* @__PURE__ */ h.jsxs(gr, { title: "", children: [
      /* @__PURE__ */ h.jsx(
        ur,
        {
          label: "",
          value: e.name,
          onChange: (B) => E({ name: B }),
          placeholder: "",
          required: !0
        }
      ),
      /* @__PURE__ */ h.jsx(
        Ua,
        {
          label: "",
          value: e.source,
          onChange: T,
          options: HU,
          description: " API "
        }
      )
    ] }),
    e.source === "tavern_profile" && /* @__PURE__ */ h.jsxs(gr, { title: "", description: "", children: [
      /* @__PURE__ */ h.jsxs("div", { className: "flex items-end gap-2", children: [
        /* @__PURE__ */ h.jsx(
          Ua,
          {
            className: "flex-1 !mb-0",
            label: "",
            value: e.tavernProfileId || "",
            onChange: (B) => E({ tavernProfileId: B }),
            options: N,
            placeholder: o ? "..." : "",
            disabled: o || N.length === 0
          }
        ),
        /* @__PURE__ */ h.jsx(
          "button",
          {
            type: "button",
            className: "h-[42px] w-[42px] min-w-[42px] flex items-center justify-center border-none rounded-md bg-muted text-muted-foreground cursor-pointer transition-all hover:bg-accent hover:text-foreground",
            onClick: y,
            disabled: o,
            title: "",
            children: /* @__PURE__ */ h.jsx(zn, { size: 16, className: o ? "animate-spin" : "" })
          }
        )
      ] }),
      N.length === 0 && !o && /* @__PURE__ */ h.jsx("div", { className: "p-3 bg-muted/30 border border-dashed border-border rounded-lg text-muted-foreground text-sm text-center mt-3", children: "" }),
      A && /* @__PURE__ */ h.jsxs("div", { className: "mt-4 p-3 bg-card rounded-lg border border-border", children: [
        /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-2 py-1 text-sm border-b border-border last:border-0", children: [
          /* @__PURE__ */ h.jsx("span", { className: "text-muted-foreground min-w-[60px]", children: "API:" }),
          /* @__PURE__ */ h.jsx("span", { className: "text-foreground font-mono", children: A.api || "-" })
        ] }),
        /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-2 py-1 text-sm border-b border-border last:border-0", children: [
          /* @__PURE__ */ h.jsx("span", { className: "text-muted-foreground min-w-[60px]", children: ":" }),
          /* @__PURE__ */ h.jsx("span", { className: "text-foreground font-mono", children: A.model || "-" })
        ] }),
        /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-2 py-1 text-sm border-b border-border last:border-0", children: [
          /* @__PURE__ */ h.jsx("span", { className: "text-muted-foreground min-w-[60px]", children: ":" }),
          /* @__PURE__ */ h.jsx("span", { className: "text-foreground font-mono", children: A.preset || "-" })
        ] })
      ] })
    ] }),
    e.source === "custom" && /* @__PURE__ */ h.jsxs(gr, { title: "API ", description: " API ", children: [
      /* @__PURE__ */ h.jsx(
        Ua,
        {
          label: "API ",
          value: ((D = e.custom) == null ? void 0 : D.apiSource) || "openai",
          onChange: (B) => C("apiSource", B),
          options: UU
        }
      ),
      /* @__PURE__ */ h.jsx(
        ur,
        {
          label: "API URL",
          type: "url",
          value: ((M = e.custom) == null ? void 0 : M.apiUrl) || "",
          onChange: (B) => C("apiUrl", B),
          placeholder: "https://api.openai.com/v1",
          required: !0
        }
      ),
      /* @__PURE__ */ h.jsx(
        ur,
        {
          label: "API Key",
          type: "password",
          value: ((O = e.custom) == null ? void 0 : O.apiKey) || "",
          onChange: (B) => C("apiKey", B),
          placeholder: "sk-..."
        }
      ),
      /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col gap-2", children: [
        /* @__PURE__ */ h.jsxs("div", { className: "flex items-end gap-2", children: [
          u.length > 0 ? /* @__PURE__ */ h.jsx(
            Ua,
            {
              className: "flex-1 !mb-0",
              label: "",
              value: ((Y = e.custom) == null ? void 0 : Y.model) || "",
              onChange: (B) => C("model", B),
              options: u.map((B) => ({ value: B.id, label: B.name || B.id })),
              placeholder: ""
            }
          ) : /* @__PURE__ */ h.jsx(
            ur,
            {
              className: "flex-1 !mb-0",
              label: "",
              value: ((X = e.custom) == null ? void 0 : X.model) || "",
              onChange: (B) => C("model", B),
              placeholder: "gpt-4o-mini",
              required: !0
            }
          ),
          /* @__PURE__ */ h.jsx(
            "button",
            {
              type: "button",
              className: "h-[42px] w-[42px] min-w-[42px] flex items-center justify-center border-none rounded-md bg-muted text-muted-foreground cursor-pointer transition-all hover:bg-accent hover:text-foreground disabled:opacity-50 disabled:cursor-not-allowed",
              onClick: w,
              disabled: d || !((U = e.custom) != null && U.apiUrl),
              title: "",
              children: d ? /* @__PURE__ */ h.jsx(Ka, { size: 16, className: "animate-spin" }) : /* @__PURE__ */ h.jsx(zn, { size: 16 })
            }
          )
        ] }),
        p && /* @__PURE__ */ h.jsx("p", { className: "text-xs text-destructive", children: p }),
        u.length > 0 && /* @__PURE__ */ h.jsxs("p", { className: "text-xs text-muted-foreground", children: [
          " ",
          u.length,
          " "
        ] })
      ] })
    ] }),
    /* @__PURE__ */ h.jsxs(gr, { title: "", description: "", children: [
      /* @__PURE__ */ h.jsx(
        er,
        {
          label: " (Temperature)",
          value: e.parameters.temperature,
          onChange: (B) => k("temperature", B),
          min: 0,
          max: 2,
          step: 0.1,
          description: ""
        }
      ),
      /* @__PURE__ */ h.jsx(
        er,
        {
          label: "Top-P",
          value: e.parameters.topP,
          onChange: (B) => k("topP", B),
          min: 0,
          max: 1,
          step: 0.05,
          description: " token "
        }
      ),
      /* @__PURE__ */ h.jsx(
        er,
        {
          label: " Tokens",
          value: e.parameters.maxTokens,
          onChange: (B) => k("maxTokens", B),
          min: 64,
          max: 16384,
          step: 64,
          showSlider: !1
        }
      ),
      /* @__PURE__ */ h.jsx(
        er,
        {
          label: "",
          value: e.parameters.frequencyPenalty,
          onChange: (B) => k("frequencyPenalty", B),
          min: -2,
          max: 2,
          step: 0.1,
          description: " token "
        }
      ),
      /* @__PURE__ */ h.jsx(
        er,
        {
          label: "",
          value: e.parameters.presencePenalty,
          onChange: (B) => k("presencePenalty", B),
          min: -2,
          max: 2,
          step: 0.1,
          description: ""
        }
      )
    ] })
  ] });
}, VU = [
  { value: "custom", label: " (OpenAI )" },
  { value: "transformers", label: "Transformers ()" },
  { value: "openai", label: "OpenAI Embeddings" },
  { value: "ollama", label: "Ollama" },
  { value: "vllm", label: "vLLM" },
  { value: "cohere", label: "Cohere" },
  { value: "jina", label: "Jina AI" },
  { value: "voyage", label: "Voyage AI" }
], SS = {
  custom: "text-embedding-3-small",
  transformers: "Xenova/all-MiniLM-L6-v2",
  openai: "text-embedding-3-small",
  ollama: "nomic-embed-text",
  vllm: "BAAI/bge-m3",
  cohere: "embed-multilingual-v3.0",
  jina: "jina-embeddings-v3",
  voyage: "voyage-large-2"
}, CS = ["custom", "ollama", "vllm"], ES = ["custom", "openai", "cohere", "jina", "voyage"], KU = ({
  config: e,
  onChange: t
}) => {
  var y;
  const n = (w) => {
    t({ ...e, ...w });
  }, r = (w) => {
    n({
      source: w,
      model: SS[w],
      apiUrl: CS.includes(w) ? e.apiUrl : void 0,
      apiKey: ES.includes(w) ? e.apiKey : void 0
    });
  }, a = CS.includes(e.source), o = ES.includes(e.source), [l, u] = P.useState([]), [f, d] = P.useState(!1), [m, p] = P.useState(null), x = async () => {
    d(!0), p(null);
    try {
      let w = [];
      const E = { apiUrl: e.apiUrl || "", apiKey: e.apiKey };
      switch (e.source) {
        case "custom":
          if (!e.apiUrl) {
            p(" API URL");
            return;
          }
          w = await Zi.fetchOpenAIModels(E);
          break;
        case "ollama":
          if (!e.apiUrl) {
            p(" API URL");
            return;
          }
          w = await Zi.fetchOllamaModels(E);
          break;
        case "vllm":
          if (!e.apiUrl) {
            p(" API URL");
            return;
          }
          w = await Zi.fetchVLLMModels(E);
          break;
        case "openai":
        case "cohere":
        case "jina":
        case "voyage":
          w = Zi.getPresetModels(e.source);
          break;
        default:
          w = [];
      }
      u(w), w.length === 0 && p("");
    } catch (w) {
      p(w.message || ""), u([]);
    } finally {
      d(!1);
    }
  };
  return /* @__PURE__ */ h.jsxs("div", { className: "", children: [
    /* @__PURE__ */ h.jsxs(gr, { title: "", description: "", children: [
      /* @__PURE__ */ h.jsx(
        Ua,
        {
          label: "",
          value: e.source,
          onChange: (w) => r(w),
          options: VU,
          description: ""
        }
      ),
      a && /* @__PURE__ */ h.jsx(
        ur,
        {
          label: e.source === "ollama" ? "API Endpoint ()" : " API URL",
          type: "url",
          value: e.apiUrl || "",
          onChange: (w) => n({ apiUrl: w }),
          placeholder: e.source === "ollama" ? "http://localhost:11434/api/embeddings" : "https://api.openai.com/v1/embeddings",
          description: e.source === "ollama" ? ": http://localhost:11434/api/embeddings" : " /v1/embeddings"
        }
      ),
      o && /* @__PURE__ */ h.jsx(
        ur,
        {
          label: "API Key",
          type: "password",
          value: e.apiKey || "",
          onChange: (w) => n({ apiKey: w }),
          placeholder: " API "
        }
      ),
      /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col gap-2", children: [
        /* @__PURE__ */ h.jsxs("div", { className: "flex items-end gap-2", children: [
          l.length > 0 ? /* @__PURE__ */ h.jsx("div", { className: "flex-1 relative", children: /* @__PURE__ */ h.jsx(
            o9,
            {
              className: "!mb-0",
              label: "",
              value: e.model || "",
              onChange: (w) => n({ model: w }),
              options: l.map((w) => ({ value: w.id, label: w.name || w.id })),
              placeholder: "",
              emptyText: ""
            }
          ) }) : /* @__PURE__ */ h.jsx(
            ur,
            {
              className: "flex-1 !mb-0",
              label: "",
              value: e.model || "",
              onChange: (w) => n({ model: w }),
              placeholder: SS[e.source],
              description: ""
            }
          ),
          (a || o) && /* @__PURE__ */ h.jsx(
            "button",
            {
              type: "button",
              className: "h-[42px] w-[42px] min-w-[42px] flex items-center justify-center border-none rounded-md bg-muted text-muted-foreground cursor-pointer transition-all hover:bg-accent hover:text-foreground disabled:opacity-50 disabled:cursor-not-allowed",
              onClick: x,
              disabled: f,
              title: "",
              children: f ? /* @__PURE__ */ h.jsx(Ka, { size: 16, className: "animate-spin" }) : /* @__PURE__ */ h.jsx(zn, { size: 16 })
            }
          )
        ] }),
        m && /* @__PURE__ */ h.jsx("p", { className: "text-xs text-destructive", children: m }),
        l.length > 0 && /* @__PURE__ */ h.jsxs("p", { className: "text-xs text-muted-foreground", children: [
          " ",
          l.length,
          " "
        ] })
      ] })
    ] }),
    /* @__PURE__ */ h.jsx(gr, { title: "", collapsible: !0, defaultCollapsed: !0, children: /* @__PURE__ */ h.jsx(
      ur,
      {
        label: "",
        value: ((y = e.dimensions) == null ? void 0 : y.toString()) || "",
        onChange: (w) => {
          const E = parseInt(w, 10);
          n({ dimensions: isNaN(E) ? void 0 : E });
        },
        placeholder: "",
        description: ""
      }
    ) })
  ] });
}, YU = ({
  config: e,
  onChange: t
}) => {
  const n = (m) => {
    t({ ...e, ...m });
  }, [r, a] = P.useState([]), [o, l] = P.useState(!1), [u, f] = P.useState(null), d = async () => {
    if (!e.url) {
      f(" API URL");
      return;
    }
    l(!0), f(null);
    try {
      const m = await Zi.fetchOpenAIModels({
        apiUrl: e.url,
        apiKey: e.apiKey
      });
      m.length > 0 ? a(m) : a(Zi.getCommonRerankModels());
    } catch {
      a(Zi.getCommonRerankModels());
    } finally {
      l(!1);
    }
  };
  return /* @__PURE__ */ h.jsxs("div", { className: "", children: [
    /* @__PURE__ */ h.jsx(gr, { title: "Rerank ", description: "", children: /* @__PURE__ */ h.jsx(
      Ei,
      {
        label: " Rerank",
        checked: e.enabled,
        onChange: (m) => n({ enabled: m }),
        description: " Rerank "
      }
    ) }),
    e.enabled && /* @__PURE__ */ h.jsxs(h.Fragment, { children: [
      /* @__PURE__ */ h.jsxs(gr, { title: "API ", children: [
        /* @__PURE__ */ h.jsx(
          ur,
          {
            label: "API URL",
            type: "url",
            value: e.url,
            onChange: (m) => n({ url: m }),
            placeholder: "http://localhost:8000/rerank",
            description: "Rerank  API ",
            required: !0
          }
        ),
        /* @__PURE__ */ h.jsx(
          ur,
          {
            label: "API Key",
            type: "password",
            value: e.apiKey,
            onChange: (m) => n({ apiKey: m }),
            placeholder: " API "
          }
        ),
        /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col gap-2", children: [
          /* @__PURE__ */ h.jsxs("div", { className: "flex items-end gap-2", children: [
            r.length > 0 ? /* @__PURE__ */ h.jsx("div", { className: "flex-1 relative", children: /* @__PURE__ */ h.jsx(
              o9,
              {
                className: "!mb-0",
                label: "",
                value: e.model,
                onChange: (m) => n({ model: m }),
                options: r.map((m) => ({ value: m.id, label: m.name || m.id })),
                placeholder: "",
                emptyText: ""
              }
            ) }) : /* @__PURE__ */ h.jsx(
              ur,
              {
                className: "flex-1 !mb-0",
                label: "",
                value: e.model,
                onChange: (m) => n({ model: m }),
                placeholder: "BAAI/bge-reranker-v2-m3",
                description: " Rerank ",
                required: !0
              }
            ),
            /* @__PURE__ */ h.jsx(
              "button",
              {
                type: "button",
                className: "h-[42px] w-[42px] min-w-[42px] flex items-center justify-center border-none rounded-md bg-muted text-muted-foreground cursor-pointer transition-all hover:bg-accent hover:text-foreground disabled:opacity-50 disabled:cursor-not-allowed",
                onClick: d,
                disabled: o,
                title: "",
                children: o ? /* @__PURE__ */ h.jsx(Ka, { size: 16, className: "animate-spin" }) : /* @__PURE__ */ h.jsx(zn, { size: 16 })
              }
            )
          ] }),
          u && /* @__PURE__ */ h.jsx("p", { className: "text-xs text-destructive", children: u }),
          r.length > 0 && /* @__PURE__ */ h.jsxs("p", { className: "text-xs text-muted-foreground", children: [
            " ",
            r.length,
            " "
          ] })
        ] })
      ] }),
      /* @__PURE__ */ h.jsxs(gr, { title: "", children: [
        /* @__PURE__ */ h.jsx(
          er,
          {
            label: "Top-N",
            value: e.topN,
            onChange: (m) => n({ topN: m }),
            min: 1,
            max: 50,
            step: 1,
            description: ""
          }
        ),
        /* @__PURE__ */ h.jsx(
          er,
          {
            label: " (Hybrid Alpha)",
            value: e.hybridAlpha,
            onChange: (m) => n({ hybridAlpha: m }),
            min: 0,
            max: 1,
            step: 0.1,
            description: "0 = 1 =  Rerank "
          }
        )
      ] })
    ] })
  ] });
};
function XU(e) {
  switch (e) {
    case "summary":
      return "text-blue-500 bg-blue-500/10 border border-blue-500/20";
    case "trim":
      return "text-orange-500 bg-orange-500/10 border border-orange-500/20";
    case "preprocessing":
      return "text-emerald-500 bg-emerald-500/10 border border-emerald-500/20";
    default:
      return "text-muted-foreground bg-muted border border-border";
  }
}
function WU(e) {
  var t;
  return ((t = fh.find((n) => n.value === e)) == null ? void 0 : t.label) || e;
}
const QU = ({
  template: e,
  isSelected: t = !1,
  onSelect: n,
  onCopy: r,
  onDelete: a,
  onToggleEnabled: o,
  onImport: l,
  onResetToDefault: u
}) => {
  const f = P.useRef(null), d = (y) => {
    y.stopPropagation();
    const w = {
      version: "1.0",
      exportedAt: Date.now(),
      template: {
        name: e.name,
        category: e.category,
        boundPresetId: e.boundPresetId,
        systemPrompt: e.systemPrompt,
        userPromptTemplate: e.userPromptTemplate,
        outputFormat: e.outputFormat,
        availableVariables: e.availableVariables
      }
    }, E = new Blob([JSON.stringify(w, null, 2)], { type: "application/json" }), k = URL.createObjectURL(E), C = document.createElement("a");
    C.href = k, C.download = `engram_template_${e.name.replace(/\s+/g, "_")}.json`, C.click(), URL.revokeObjectURL(k);
  }, m = (y) => {
    var w;
    y.stopPropagation(), (w = f.current) == null || w.click();
  }, p = (y) => {
    var k;
    const w = (k = y.target.files) == null ? void 0 : k[0];
    if (!w || !l) return;
    const E = new FileReader();
    E.onload = (C) => {
      var T;
      try {
        const N = JSON.parse((T = C.target) == null ? void 0 : T.result);
        if (N.version && N.template) {
          const A = Ba(
            N.template.name,
            N.template.category,
            {
              enabled: e.enabled,
              // 
              isBuiltIn: e.isBuiltIn,
              // 
              boundPresetId: N.template.boundPresetId,
              systemPrompt: N.template.systemPrompt,
              userPromptTemplate: N.template.userPromptTemplate,
              outputFormat: N.template.outputFormat,
              availableVariables: N.template.availableVariables
            }
          );
          A.id = e.id, l(A);
        }
      } catch (N) {
        console.error(":", N);
      }
    }, E.readAsText(w), f.current && (f.current.value = "");
  }, x = e.category === "preprocessing";
  return /* @__PURE__ */ h.jsxs(
    "div",
    {
      className: `
                group relative p-3 rounded-lg border cursor-pointer transition-all duration-200
                ${t ? "bg-accent/50 border-input" : "bg-transparent border-transparent hover:bg-muted/50 hover:border-border"}
                ${!e.enabled && !x && "opacity-50"}
            `,
      onClick: n,
      children: [
        /* @__PURE__ */ h.jsxs("div", { className: "flex items-start gap-3", children: [
          x ? (
            // ""
            /* @__PURE__ */ h.jsx(
              "div",
              {
                className: "w-8 h-8 flex items-center justify-center rounded-lg bg-emerald-500/10 text-emerald-500 flex-shrink-0",
                title: " ()",
                children: /* @__PURE__ */ h.jsx(zh, { size: 16 })
              }
            )
          ) : /* @__PURE__ */ h.jsx(
            "button",
            {
              className: `
                            w-8 h-8 flex items-center justify-center rounded-lg transition-colors flex-shrink-0
                            ${e.enabled ? "bg-primary/10 text-primary" : "bg-muted text-muted-foreground hover:bg-muted/80"}
                        `,
              onClick: (y) => {
                y.stopPropagation(), o == null || o(!e.enabled);
              },
              title: e.enabled ? "" : "",
              children: /* @__PURE__ */ h.jsx(Lh, { size: 16 })
            }
          ),
          /* @__PURE__ */ h.jsxs("div", { className: "flex-1 min-w-0", children: [
            /* @__PURE__ */ h.jsxs("div", { className: "flex items-center justify-between gap-2", children: [
              /* @__PURE__ */ h.jsx("h4", { className: `text-sm font-medium truncate ${t ? "text-foreground" : "text-muted-foreground group-hover:text-foreground"} ${!e.enabled && "line-through"}`, children: e.name }),
              /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-1.5 flex-shrink-0", children: [
                /* @__PURE__ */ h.jsx("span", { className: `text-[10px] px-1.5 py-0.5 rounded-sm font-medium ${XU(e.category)}`, children: WU(e.category) }),
                e.isBuiltIn && /* @__PURE__ */ h.jsx("span", { className: "text-[10px] px-1.5 py-0.5 rounded-sm bg-muted text-muted-foreground", children: "BUILTIN" })
              ] })
            ] }),
            /* @__PURE__ */ h.jsxs("div", { className: "mt-1 flex items-center justify-between text-[10px] text-muted-foreground/70 font-mono", children: [
              /* @__PURE__ */ h.jsx("span", { className: "truncate max-w-[120px]", children: e.boundPresetId ? `BOUND: ${e.boundPresetId}` : "DEFAULT PRESET" }),
              /* @__PURE__ */ h.jsx("span", { children: e.outputFormat.toUpperCase() })
            ] })
          ] })
        ] }),
        /* @__PURE__ */ h.jsxs("div", { className: `mt-2 flex justify-end gap-1 ${t || "opacity-0 group-hover:opacity-100"} transition-opacity`, children: [
          /* @__PURE__ */ h.jsx("button", { className: "p-1.5 hover:bg-muted rounded text-muted-foreground hover:text-foreground transition-colors", onClick: m, title: "Import", children: /* @__PURE__ */ h.jsx(fj, { size: 12 }) }),
          /* @__PURE__ */ h.jsx("button", { className: "p-1.5 hover:bg-muted rounded text-muted-foreground hover:text-foreground transition-colors", onClick: d, title: "Export", children: /* @__PURE__ */ h.jsx(Dc, { size: 12 }) }),
          /* @__PURE__ */ h.jsx("button", { className: "p-1.5 hover:bg-muted rounded text-muted-foreground hover:text-foreground transition-colors", onClick: (y) => {
            y.stopPropagation(), r == null || r();
          }, title: "Copy", children: /* @__PURE__ */ h.jsx(y2, { size: 12 }) }),
          e.isBuiltIn && /* @__PURE__ */ h.jsx(
            "button",
            {
              className: "p-1.5 hover:bg-amber-500/10 rounded text-muted-foreground hover:text-amber-500 transition-colors",
              onClick: (y) => {
                y.stopPropagation();
                let w = Tj(e.id);
                w || (w = N2(e.category)), w && u && u({
                  ...w,
                  id: e.id,
                  enabled: e.enabled
                });
              },
              title: "",
              children: /* @__PURE__ */ h.jsx(lj, { size: 12 })
            }
          ),
          !e.isBuiltIn && /* @__PURE__ */ h.jsx("button", { className: "p-1.5 hover:bg-destructive/10 rounded text-muted-foreground hover:text-destructive transition-colors", onClick: (y) => {
            y.stopPropagation(), a == null || a();
          }, title: "Delete", children: /* @__PURE__ */ h.jsx(Ri, { size: 12 }) })
        ] }),
        /* @__PURE__ */ h.jsx(
          "input",
          {
            ref: f,
            type: "file",
            accept: ".json",
            onChange: p,
            className: "hidden"
          }
        )
      ]
    }
  );
}, ZU = ({
  templates: e,
  selectedId: t,
  onSelect: n,
  onAdd: r,
  onUpdate: a,
  onDelete: o
}) => {
  const l = () => {
    const p = Ba(
      ` ${e.length + 1}`,
      "summary"
    );
    r(p), n(p);
  }, u = (p) => {
    const x = Ba(
      `${p.name} ()`,
      p.category,
      {
        enabled: !1,
        // 
        boundPresetId: p.boundPresetId,
        systemPrompt: p.systemPrompt,
        userPromptTemplate: p.userPromptTemplate,
        outputFormat: p.outputFormat,
        availableVariables: [...p.availableVariables]
      }
    );
    r(x);
  }, f = (p, x) => {
    x && e.filter((y) => y.category === p.category && y.id !== p.id && y.enabled).forEach((y) => a({ ...y, enabled: !1 })), a({ ...p, enabled: x });
  }, d = (p) => {
    a(p);
  }, m = fh.map((p) => ({
    ...p,
    templates: e.filter((x) => x.category === p.value)
  })).filter((p) => p.templates.length > 0);
  return /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col gap-4 h-full", children: [
    /* @__PURE__ */ h.jsxs("div", { className: "flex items-center justify-between gap-2", children: [
      /* @__PURE__ */ h.jsx("h3", { className: "text-xs font-bold text-muted-foreground uppercase tracking-wider", children: "" }),
      /* @__PURE__ */ h.jsx(
        "button",
        {
          className: "text-muted-foreground hover:text-foreground transition-colors",
          onClick: l,
          children: /* @__PURE__ */ h.jsx(b2, { size: 16 })
        }
      )
    ] }),
    /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col gap-6 overflow-y-auto flex-1 no-scrollbar", children: [
      m.map((p) => /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col gap-2", children: [
        /* @__PURE__ */ h.jsxs("div", { className: "text-[10px] items-center gap-2 text-muted-foreground font-medium px-1 uppercase tracking-wider flex", children: [
          p.label,
          /* @__PURE__ */ h.jsx("div", { className: "h-px bg-border flex-1" })
        ] }),
        /* @__PURE__ */ h.jsx("div", { className: "flex flex-col gap-1", children: p.templates.map((x) => /* @__PURE__ */ h.jsx(
          QU,
          {
            template: x,
            isSelected: t === x.id,
            onSelect: () => n(x),
            onCopy: () => u(x),
            onDelete: () => o(x),
            onToggleEnabled: (y) => f(x, y),
            onImport: d,
            onResetToDefault: (y) => a(y)
          },
          x.id
        )) })
      ] }, p.value)),
      e.length === 0 && /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col items-center justify-center py-12 text-muted-foreground gap-2 border border-dashed border-border rounded-lg", children: [
        /* @__PURE__ */ h.jsx(uu, { size: 24, className: "opacity-50" }),
        /* @__PURE__ */ h.jsx("p", { className: "text-xs", children: "" })
      ] })
    ] })
  ] });
}, JU = [
  // Context
  { name: "{{userInput}}", desc: "", category: "Context ()" },
  { name: "{{chatHistory}}", desc: ": {{chatHistory:20}}", category: "Context ()" },
  { name: "{{context}}", desc: " (Description/Persona...)", category: "Context ()" },
  { name: "{{worldbookContext}}", desc: "", category: "Context ()" },
  { name: "{{userPersona}}", desc: " (Persona Description)", category: "Context ()" },
  { name: "{{char}}", desc: "", category: "Context ()" },
  { name: "{{user}}", desc: "", category: "Context ()" },
  // Text Generation
  { name: "{{engramSummaries}}", desc: " (, /)", category: "Text Generation ()" },
  { name: "{{engramArchivedSummaries}}", desc: " ()", category: "Text Generation ()" },
  // Data Layer
  { name: "{{engramGraph}}", desc: " JSON (/)", category: "Data Layer ()" }
], eH = ({ macro: e }) => {
  const [t, n] = P.useState(!1), r = () => {
    navigator.clipboard.writeText(e.name), n(!0), setTimeout(() => n(!1), 2e3);
  };
  return /* @__PURE__ */ h.jsxs("div", { className: "flex items-center justify-between gap-2 p-1.5 rounded hover:bg-muted/50 group transition-colors", children: [
    /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col gap-0.5", children: [
      /* @__PURE__ */ h.jsx("code", { className: "text-[11px] text-primary font-mono font-medium", children: e.name }),
      /* @__PURE__ */ h.jsx("span", { className: "text-[10px] text-muted-foreground", children: e.desc })
    ] }),
    /* @__PURE__ */ h.jsx(
      "button",
      {
        onClick: r,
        className: "opacity-0 group-hover:opacity-100 transition-opacity p-1 hover:bg-muted rounded text-muted-foreground hover:text-foreground",
        title: "",
        children: t ? /* @__PURE__ */ h.jsx(zh, { size: 12, className: "text-green-500" }) : /* @__PURE__ */ h.jsx(y2, { size: 12 })
      }
    )
  ] });
}, kS = ({
  template: e,
  llmPresets: t,
  defaultPresetId: n,
  onChange: r
}) => {
  var u, f;
  const a = [
    { value: "", label: "" + (n ? ` (${((u = t.find((d) => d.id === n)) == null ? void 0 : u.name) || n})` : "") },
    ...t.map((d) => ({ value: d.id, label: d.name }))
  ], o = (d) => {
    r({ ...e, ...d, updatedAt: Date.now() });
  }, l = JU.reduce((d, m) => (d[m.category] || (d[m.category] = []), d[m.category].push(m), d), {});
  return /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col gap-4", children: [
    /* @__PURE__ */ h.jsxs(gr, { title: "", children: [
      /* @__PURE__ */ h.jsx(
        ur,
        {
          label: "",
          value: e.name,
          onChange: (d) => o({ name: d }),
          placeholder: "",
          required: !0,
          disabled: e.isBuiltIn
        }
      ),
      /* @__PURE__ */ h.jsx(
        Ua,
        {
          label: "",
          value: e.category,
          onChange: (d) => o({ category: d }),
          options: fh.map((d) => ({ value: d.value, label: d.label })),
          description: (f = fh.find((d) => d.value === e.category)) == null ? void 0 : f.description
        }
      ),
      /* @__PURE__ */ h.jsx(
        Ua,
        {
          label: "",
          value: e.boundPresetId || "",
          onChange: (d) => o({ boundPresetId: d || null }),
          options: a,
          description: " LLM "
        }
      ),
      e.category === "preprocessing" && /* @__PURE__ */ h.jsx(
        Ua,
        {
          label: "",
          value: e.injectionMode || "replace",
          onChange: (d) => o({ injectionMode: d }),
          options: [
            { value: "replace", label: " (Overwrite)" },
            { value: "append", label: " (Append)" },
            { value: "prepend", label: " (Prepend)" }
          ],
          description: ""
        }
      )
    ] }),
    /* @__PURE__ */ h.jsxs(gr, { title: "", children: [
      /* @__PURE__ */ h.jsx(
        ur,
        {
          label: "",
          value: e.systemPrompt,
          onChange: (d) => o({ systemPrompt: d }),
          placeholder: "...",
          multiline: !0,
          rows: 4
        }
      ),
      /* @__PURE__ */ h.jsx(
        ur,
        {
          label: "",
          value: e.userPromptTemplate,
          onChange: (d) => o({ userPromptTemplate: d }),
          placeholder: "...",
          multiline: !0,
          rows: 6
        }
      )
    ] }),
    /* @__PURE__ */ h.jsxs("div", { className: "px-3 py-3 bg-muted/20 rounded-md border border-border/50 space-y-3", children: [
      /* @__PURE__ */ h.jsxs("div", { className: "text-[11px] font-semibold text-muted-foreground uppercase tracking-wider flex items-center gap-2", children: [
        /* @__PURE__ */ h.jsx("span", { children: "" }),
        /* @__PURE__ */ h.jsx("div", { className: "h-px bg-border flex-1" })
      ] }),
      /* @__PURE__ */ h.jsx("div", { className: "flex flex-col gap-4", children: Object.entries(l).map(([d, m]) => /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col gap-1", children: [
        /* @__PURE__ */ h.jsx("div", { className: "text-[10px] text-primary/70 font-medium px-1 mb-0.5", children: d }),
        /* @__PURE__ */ h.jsx("div", { className: "grid grid-cols-1 gap-px bg-border/20 rounded overflow-hidden", children: m.map((p) => /* @__PURE__ */ h.jsx("div", { className: "bg-background/50", children: /* @__PURE__ */ h.jsx(eH, { macro: p }) }, p.name)) })
      ] }, d)) })
    ] })
  ] });
}, tH = ({
  rules: e,
  selectedId: t,
  onSelect: n,
  onToggle: r,
  onDelete: a,
  onAdd: o,
  onReset: l,
  enableNativeRegex: u,
  onToggleNativeRegex: f
}) => /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col gap-4", children: [
  /* @__PURE__ */ h.jsxs("div", { className: "flex items-center justify-between", children: [
    /* @__PURE__ */ h.jsx("h3", { className: "text-xs font-bold text-muted-foreground uppercase tracking-wider", children: "" }),
    /* @__PURE__ */ h.jsxs("div", { className: "flex gap-2", children: [
      /* @__PURE__ */ h.jsx(
        "button",
        {
          className: "text-[10px] text-muted-foreground hover:text-destructive transition-colors",
          onClick: l,
          children: ""
        }
      ),
      /* @__PURE__ */ h.jsx(
        "button",
        {
          className: "text-muted-foreground hover:text-foreground transition-colors",
          onClick: o,
          children: /* @__PURE__ */ h.jsx(oj, { size: 16 })
        }
      )
    ] })
  ] }),
  /* @__PURE__ */ h.jsx("div", { className: "bg-muted/10 border border-border/50 rounded-lg p-3 mb-2", children: /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4", children: [
    /* @__PURE__ */ h.jsxs("div", { className: "flex-1 min-w-0", children: [
      /* @__PURE__ */ h.jsx("h4", { className: "text-sm font-medium", children: " Regex " }),
      /* @__PURE__ */ h.jsx("p", { className: "text-xs text-muted-foreground mt-0.5 break-words", children: " SillyTavern  Regex " })
    ] }),
    /* @__PURE__ */ h.jsx(
      Jn,
      {
        checked: u ?? !0,
        onChange: (d) => f == null ? void 0 : f(d)
      }
    )
  ] }) }),
  /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col gap-1", children: [
    e.map((d) => /* @__PURE__ */ h.jsxs(
      "div",
      {
        className: `
                            group p-3 rounded-lg transition-all duration-200 cursor-pointer border flex items-center gap-3
                            ${t === d.id ? "bg-accent/50 border-input" : "bg-transparent border-transparent hover:bg-muted/50 hover:border-border"}
                            ${!d.enabled && "opacity-50"}
                        `,
        onClick: () => n(d.id),
        children: [
          /* @__PURE__ */ h.jsx(
            "button",
            {
              className: `
                                w-8 h-8 flex items-center justify-center rounded-lg transition-colors
                                ${d.enabled ? t === d.id ? "bg-primary/20 text-primary" : "bg-muted text-primary" : "bg-muted text-muted-foreground"}
                            `,
              onClick: (m) => {
                m.stopPropagation(), r(d.id);
              },
              title: d.enabled ? "" : "",
              children: /* @__PURE__ */ h.jsx(Lh, { size: 14 })
            }
          ),
          /* @__PURE__ */ h.jsxs("div", { className: "flex-1 min-w-0", children: [
            /* @__PURE__ */ h.jsx("div", { className: "flex items-center justify-between", children: /* @__PURE__ */ h.jsx("h4", { className: `text-sm font-medium truncate ${t === d.id ? "text-foreground" : "text-muted-foreground group-hover:text-foreground"} ${!d.enabled && "opacity-50 line-through"}`, children: d.name }) }),
            /* @__PURE__ */ h.jsx("div", { className: "mt-0.5 flex items-center gap-2", children: /* @__PURE__ */ h.jsxs("code", { className: "text-[10px] bg-muted px-1 rounded text-muted-foreground font-mono truncate max-w-[120px]", children: [
              "/",
              d.pattern,
              "/",
              d.flags
            ] }) })
          ] }),
          /* @__PURE__ */ h.jsx("div", { className: `flex items-center ${t === d.id ? "opacity-100" : "opacity-0 group-hover:opacity-100"} transition-opacity`, children: /* @__PURE__ */ h.jsx(
            "button",
            {
              className: "p-1.5 hover:bg-destructive/10 rounded text-muted-foreground hover:text-destructive transition-colors",
              onClick: (m) => {
                m.stopPropagation(), a(d.id);
              },
              children: /* @__PURE__ */ h.jsx(Ri, { size: 12 })
            }
          ) })
        ]
      },
      d.id
    )),
    e.length === 0 && /* @__PURE__ */ h.jsx("div", { className: "text-center p-8 border border-dashed border-border rounded-lg", children: /* @__PURE__ */ h.jsx("p", { className: "text-xs text-muted-foreground", children: "" }) })
  ] })
] }), nH = [
  { value: "g", label: "", description: "" },
  { value: "i", label: "", description: "" },
  { value: "m", label: "", description: "^$ " },
  { value: "s", label: "", description: ". " }
], NS = ({ rule: e, onChange: t }) => {
  var m;
  const [n, r] = P.useState(""), [a, o] = P.useState(""), [l, u] = P.useState({ valid: !0 }), f = new Vh();
  P.useEffect(() => {
    const p = f.validatePattern(e.pattern, e.flags);
    u(p);
  }, [e.pattern, e.flags]), P.useEffect(() => {
    if (n && l.valid) {
      const p = f.processWithRule(n, e);
      o(p);
    } else
      o("");
  }, [n, e, l.valid]);
  const d = (p) => {
    const x = e.flags.split(""), y = x.indexOf(p);
    y >= 0 ? x.splice(y, 1) : x.push(p), t({ flags: x.join("") });
  };
  return /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col gap-4", children: [
    /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col gap-3", children: [
      /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col gap-1.5", children: [
        /* @__PURE__ */ h.jsx("label", { className: "text-sm font-medium text-foreground", children: "" }),
        /* @__PURE__ */ h.jsx(
          "input",
          {
            type: "text",
            className: "w-full px-3 py-2 rounded-md border border-input bg-background text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring",
            value: e.name,
            onChange: (p) => t({ name: p.target.value }),
            placeholder: ""
          }
        )
      ] }),
      /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col gap-1.5", children: [
        /* @__PURE__ */ h.jsx("label", { className: "text-sm font-medium text-foreground", children: "" }),
        /* @__PURE__ */ h.jsx(
          "input",
          {
            type: "text",
            className: "w-full px-3 py-2 rounded-md border border-input bg-background text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring",
            value: e.description || "",
            onChange: (p) => t({ description: p.target.value }),
            placeholder: ""
          }
        )
      ] }),
      /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col gap-1.5", children: [
        /* @__PURE__ */ h.jsx("label", { className: "text-sm font-medium text-foreground", children: "" }),
        /* @__PURE__ */ h.jsx("div", { className: "flex gap-2", children: Ub.map((p) => /* @__PURE__ */ h.jsx(
          "button",
          {
            className: `flex-1 px-3 py-2 text-sm rounded-md border transition-colors ${e.scope === p.value ? "bg-primary-20 border-primary text-primary" : "bg-background border-border text-muted-foreground hover:bg-muted"}`,
            onClick: () => t({ scope: p.value }),
            title: p.description,
            children: p.label
          },
          p.value
        )) }),
        /* @__PURE__ */ h.jsx("p", { className: "text-xs text-muted-foreground", children: (m = Ub.find((p) => p.value === e.scope)) == null ? void 0 : m.description })
      ] })
    ] }),
    /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col gap-3 p-4 bg-card border border-border rounded-lg", children: [
      /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col gap-1.5", children: [
        /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-2", children: [
          /* @__PURE__ */ h.jsx("label", { className: "text-sm font-medium text-foreground", children: "" }),
          l.valid ? /* @__PURE__ */ h.jsx(g2, { size: 14, className: "text-green-500" }) : /* @__PURE__ */ h.jsx(Fs, { size: 14, className: "text-red-500" })
        ] }),
        /* @__PURE__ */ h.jsx(
          "input",
          {
            type: "text",
            className: `w-full px-3 py-2 rounded-md border bg-background text-foreground font-mono text-sm placeholder:text-muted-foreground focus:outline-none focus:ring-2 ${l.valid ? "border-input focus:ring-ring" : "border-red-500 focus:ring-red-500"}`,
            value: e.pattern,
            onChange: (p) => t({ pattern: p.target.value }),
            placeholder: "<think>[\\s\\S]*?</think>"
          }
        ),
        !l.valid && l.error && /* @__PURE__ */ h.jsx("p", { className: "text-xs text-red-500", children: l.error })
      ] }),
      /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col gap-1.5", children: [
        /* @__PURE__ */ h.jsx("label", { className: "text-sm font-medium text-foreground", children: "" }),
        /* @__PURE__ */ h.jsx(
          "input",
          {
            type: "text",
            className: "w-full px-3 py-2 rounded-md border border-input bg-background text-foreground font-mono text-sm placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring",
            value: e.replacement,
            onChange: (p) => t({ replacement: p.target.value }),
            placeholder: ""
          }
        )
      ] }),
      /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col gap-1.5", children: [
        /* @__PURE__ */ h.jsx("label", { className: "text-sm font-medium text-foreground", children: "" }),
        /* @__PURE__ */ h.jsx("div", { className: "flex flex-wrap gap-2", children: nH.map((p) => /* @__PURE__ */ h.jsxs(
          "button",
          {
            className: `px-2 py-1 text-xs rounded-md border transition-colors ${e.flags.includes(p.value) ? "bg-primary-20 border-primary text-primary" : "bg-background border-border text-muted-foreground hover:bg-muted"}`,
            onClick: () => d(p.value),
            title: p.description,
            children: [
              p.label,
              " (",
              p.value,
              ")"
            ]
          },
          p.value
        )) })
      ] })
    ] }),
    /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col gap-3 p-4 bg-muted-20 border border-border rounded-lg", children: [
      /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-2 text-sm font-medium text-foreground", children: [
        /* @__PURE__ */ h.jsx(Uc, { size: 14 }),
        ""
      ] }),
      /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col gap-1.5", children: [
        /* @__PURE__ */ h.jsx("label", { className: "text-xs text-muted-foreground", children: "" }),
        /* @__PURE__ */ h.jsx(
          "textarea",
          {
            className: "w-full min-h-[80px] px-3 py-2 rounded-md border border-input bg-background text-foreground text-sm resize-y focus:outline-none focus:ring-2 focus:ring-ring",
            value: n,
            onChange: (p) => r(p.target.value),
            placeholder: `
<think></think>
`
          }
        )
      ] }),
      n && l.valid && /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col gap-1.5", children: [
        /* @__PURE__ */ h.jsx("label", { className: "text-xs text-muted-foreground", children: "" }),
        /* @__PURE__ */ h.jsx("div", { className: "min-h-[60px] px-3 py-2 rounded-md border border-border bg-background text-sm whitespace-pre-wrap", children: a || /* @__PURE__ */ h.jsx("span", { className: "text-muted-foreground italic", children: "" }) })
      ] })
    ] }),
    /* @__PURE__ */ h.jsxs("div", { className: "flex items-start gap-2 p-3 bg-blue-500/10 border border-blue-500/30 rounded-lg text-sm text-blue-400", children: [
      /* @__PURE__ */ h.jsx(kz, { size: 16, className: "shrink-0 mt-0.5" }),
      /* @__PURE__ */ h.jsxs("div", { children: [
        /* @__PURE__ */ h.jsx("strong", { children: "" }),
        " LLM ",
        /* @__PURE__ */ h.jsx("strong", { children: "" }),
        " LLM  ",
        /* @__PURE__ */ h.jsx("code", { className: "bg-blue-500/20 px-1 rounded", children: "<think>" }),
        ""
      ] })
    ] })
  ] });
}, rH = ({
  config: e,
  onChange: t,
  worldbookStructure: n = {},
  disabledEntries: r = {},
  onToggleWorldbook: a,
  onToggleEntry: o,
  onRefresh: l
}) => {
  const [u, f] = P.useState(/* @__PURE__ */ new Set()), [d, m] = P.useState(""), p = (C) => {
    t({
      ...e,
      [C]: !e[C]
    });
  }, x = (C) => {
    const T = new Set(u);
    T.has(C) ? T.delete(C) : T.add(C), f(T);
  }, y = (C) => {
    var T;
    return ((T = e.disabledWorldbooks) == null ? void 0 : T.includes(C)) || !1;
  }, w = (C, T) => {
    var N;
    return ((N = r[C]) == null ? void 0 : N.includes(T)) || !1;
  }, k = Object.keys(n).sort().filter(
    (C) => C.toLowerCase().includes(d.toLowerCase()) || n[C].some(
      (T) => {
        var N, A;
        return ((N = T.names) == null ? void 0 : N.join(" ").toLowerCase().includes(d.toLowerCase())) || ((A = T.comment) == null ? void 0 : A.toLowerCase().includes(d.toLowerCase()));
      }
    )
  );
  return /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col gap-6", children: [
    /* @__PURE__ */ h.jsxs(gr, { title: "", description: "", children: [
      /* @__PURE__ */ h.jsx(
        Ei,
        {
          label: "",
          description: "",
          checked: e.enabled,
          onChange: () => p("enabled")
        }
      ),
      /* @__PURE__ */ h.jsx(
        Ei,
        {
          label: "",
          description: " / ",
          checked: e.includeGlobal,
          onChange: () => p("includeGlobal"),
          disabled: !e.enabled
        }
      ),
      /* @__PURE__ */ h.jsx(
        Ei,
        {
          label: " EJS  (ST-Prompt-Template)",
          description: "[]  WorldInfo  EJS  ST-Prompt-Template",
          checked: e.enableEJS ?? !0,
          onChange: () => p("enableEJS"),
          disabled: !e.enabled
        }
      )
    ] }),
    e.enabled && /* @__PURE__ */ h.jsxs(gr, { title: "", description: "", children: [
      /* @__PURE__ */ h.jsxs("div", { className: "flex items-center justify-between mb-4 gap-4", children: [
        /* @__PURE__ */ h.jsxs("div", { className: "relative flex-1", children: [
          /* @__PURE__ */ h.jsx(hi, { className: "absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground w-4 h-4" }),
          /* @__PURE__ */ h.jsx(
            "input",
            {
              type: "text",
              placeholder: "...",
              className: "w-full h-9 pl-9 pr-3 rounded-md border border-input bg-transparent text-sm shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring",
              value: d,
              onChange: (C) => m(C.target.value)
            }
          )
        ] }),
        /* @__PURE__ */ h.jsx(
          "button",
          {
            onClick: l,
            className: "inline-flex items-center justify-center rounded-md w-9 h-9 hover:bg-accent hover:text-accent-foreground transition-colors",
            title: "",
            children: /* @__PURE__ */ h.jsx(zn, { size: 16 })
          }
        )
      ] }),
      /* @__PURE__ */ h.jsx("div", { className: "flex flex-col gap-2", children: k.length === 0 ? /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col items-center justify-center py-8 text-muted-foreground gap-2 border border-dashed rounded-lg", children: [
        /* @__PURE__ */ h.jsx(Fs, { size: 24, className: "opacity-50" }),
        /* @__PURE__ */ h.jsx("span", { className: "text-sm", children: "" })
      ] }) : k.map((C) => {
        const T = y(C), N = n[C] || [], A = u.has(C), D = N.filter((M) => !w(C, M.uid)).length;
        return /* @__PURE__ */ h.jsxs("div", { className: `transition-all border-b border-border last:border-0 ${T ? "bg-muted/10 opacity-60 grayscale" : ""}`, children: [
          /* @__PURE__ */ h.jsxs("div", { className: "flex items-center justify-between p-3", children: [
            /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-3 flex-1 overflow-hidden", children: [
              /* @__PURE__ */ h.jsx(
                "button",
                {
                  onClick: () => x(C),
                  className: "p-1 hover:bg-accent rounded-sm transition-colors",
                  children: A ? /* @__PURE__ */ h.jsx(Ro, { size: 16 }) : /* @__PURE__ */ h.jsx(lu, { size: 16 })
                }
              ),
              /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-2 min-w-0", children: [
                /* @__PURE__ */ h.jsx(IR, { size: 16, className: T ? "text-muted-foreground" : "text-primary" }),
                /* @__PURE__ */ h.jsx("span", { className: `font-medium truncate ${T ? "text-muted-foreground line-through" : ""}`, children: C }),
                /* @__PURE__ */ h.jsxs("span", { className: "text-xs text-muted-foreground px-2 py-0.5 bg-muted rounded-full whitespace-nowrap", children: [
                  D,
                  " / ",
                  N.length,
                  " "
                ] })
              ] })
            ] }),
            /* @__PURE__ */ h.jsx("div", { className: "flex items-center gap-4", children: /* @__PURE__ */ h.jsx(
              Ei,
              {
                label: "",
                checked: !T,
                onChange: (M) => a == null ? void 0 : a(C, !M),
                compact: !0
              }
            ) })
          ] }),
          A && !T && /* @__PURE__ */ h.jsx("div", { className: "pl-4 pr-1 py-1 flex flex-col gap-0 animate-in slide-in-from-top-1 duration-200", children: N.length === 0 ? /* @__PURE__ */ h.jsx("div", { className: "text-xs text-muted-foreground text-center py-4", children: "" }) : N.map((M) => {
            const O = w(C, M.uid);
            return /* @__PURE__ */ h.jsxs("div", { className: `flex items-start justify-between py-2 -mx-2 px-2 rounded hover:bg-accent/40 transition-colors group ${O ? "bg-muted/10 opacity-60 grayscale" : ""}`, children: [
              /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col gap-1 min-w-0 flex-1 pr-4", children: [
                /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-2 flex-wrap min-w-0", children: [
                  /* @__PURE__ */ h.jsx(
                    "div",
                    {
                      className: `w-1.5 h-1.5 rounded-full flex-shrink-0 ${M.constant ? "bg-primary" : "bg-emerald-500"}`,
                      title: M.constant ? " (Constant)" : " (Selective)"
                    }
                  ),
                  /* @__PURE__ */ h.jsx("span", { className: `text-sm font-medium truncate max-w-full ${O ? "text-muted-foreground line-through" : "text-foreground"}`, children: M.name || ` #${M.uid}` }),
                  (M.keys || []).length > 0 && /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-1 ml-auto md:ml-2 overflow-hidden max-w-full", children: [
                    M.keys.slice(0, 3).map((Y, X) => /* @__PURE__ */ h.jsx("span", { className: "text-[10px] px-1 py-0.5 rounded border border-border bg-muted/20 text-muted-foreground whitespace-nowrap overflow-hidden text-ellipsis max-w-[80px]", children: Y }, X)),
                    M.keys.length > 3 && /* @__PURE__ */ h.jsxs("span", { className: "text-[10px] text-muted-foreground", children: [
                      "+",
                      M.keys.length - 3
                    ] })
                  ] })
                ] }),
                (M.comment || M.content) && /* @__PURE__ */ h.jsx("p", { className: "text-xs text-muted-foreground/80 pl-3.5 break-words line-clamp-2", children: M.comment || M.content })
              ] }),
              /* @__PURE__ */ h.jsx("div", { className: "flex-shrink-0", children: /* @__PURE__ */ h.jsx(
                Ei,
                {
                  label: "",
                  checked: !O,
                  onChange: (Y) => o == null ? void 0 : o(C, M.uid, !Y),
                  compact: !0
                }
              ) })
            ] }, M.uid);
          }) })
        ] }, C);
      }) })
    ] })
  ] });
}, iH = ({
  macros: e,
  selectedId: t,
  onSelect: n,
  onAdd: r,
  onToggle: a,
  onDelete: o
}) => /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col gap-4 h-full", children: [
  /* @__PURE__ */ h.jsxs("div", { className: "flex items-center justify-between gap-2", children: [
    /* @__PURE__ */ h.jsx("h3", { className: "text-xs font-bold text-muted-foreground uppercase tracking-wider", children: "" }),
    /* @__PURE__ */ h.jsx(
      "button",
      {
        className: "text-muted-foreground hover:text-foreground transition-colors",
        onClick: r,
        title: "",
        children: /* @__PURE__ */ h.jsx(b2, { size: 16 })
      }
    )
  ] }),
  /* @__PURE__ */ h.jsxs("div", { className: "text-xs text-muted-foreground bg-muted/30 rounded px-2 py-1.5 border border-border/50 leading-relaxed", children: [
    " ",
    /* @__PURE__ */ h.jsx("code", { className: "bg-muted px-1 rounded", children: "{{}}" }),
    " "
  ] }),
  /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col gap-1 overflow-y-auto flex-1 no-scrollbar", children: [
    e.map((l) => /* @__PURE__ */ h.jsxs(
      "div",
      {
        className: `
                            group p-3 rounded-lg transition-all duration-200 cursor-pointer border flex items-center gap-3
                            ${t === l.id ? "bg-accent/50 border-input" : "bg-transparent border-transparent hover:bg-muted/50 hover:border-border"}
                            ${!l.enabled && "opacity-50"}
                        `,
        onClick: () => n(l),
        children: [
          /* @__PURE__ */ h.jsx(
            "button",
            {
              className: `
                                w-8 h-8 flex items-center justify-center rounded-lg transition-colors flex-shrink-0
                                ${l.enabled ? t === l.id ? "bg-primary/20 text-primary" : "bg-muted text-primary" : "bg-muted text-muted-foreground"}
                            `,
              onClick: (u) => {
                u.stopPropagation(), a(l.id);
              },
              title: l.enabled ? "" : "",
              children: /* @__PURE__ */ h.jsx(Lh, { size: 14 })
            }
          ),
          /* @__PURE__ */ h.jsxs("div", { className: "flex-1 min-w-0", children: [
            /* @__PURE__ */ h.jsx("div", { className: "flex items-center gap-2", children: /* @__PURE__ */ h.jsx("code", { className: `text-sm font-medium truncate ${t === l.id ? "text-primary" : "text-foreground"}`, children: `{{${l.name}}}` }) }),
            /* @__PURE__ */ h.jsx("p", { className: "mt-0.5 text-[10px] text-muted-foreground truncate", children: l.content ? l.content.slice(0, 50) + (l.content.length > 50 ? "..." : "") : "()" })
          ] }),
          /* @__PURE__ */ h.jsx(
            "button",
            {
              className: `p-1.5 hover:bg-destructive/10 rounded text-muted-foreground hover:text-destructive transition-colors ${t === l.id ? "opacity-100" : "opacity-0 group-hover:opacity-100"}`,
              onClick: (u) => {
                u.stopPropagation(), o(l.id);
              },
              title: "",
              children: /* @__PURE__ */ h.jsx(Ri, { size: 12 })
            }
          )
        ]
      },
      l.id
    )),
    e.length === 0 && /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col items-center justify-center py-12 text-muted-foreground gap-2 border border-dashed border-border rounded-lg", children: [
      /* @__PURE__ */ h.jsx(rj, { size: 24, className: "opacity-50" }),
      /* @__PURE__ */ h.jsx("p", { className: "text-xs", children: "" }),
      /* @__PURE__ */ h.jsx(
        "button",
        {
          className: "text-xs text-primary hover:underline",
          onClick: r,
          children: ""
        }
      )
    ] })
  ] })
] }), aH = ({
  macro: e,
  onChange: t
}) => /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col gap-4", children: [
  /* @__PURE__ */ h.jsx(gr, { title: "", children: /* @__PURE__ */ h.jsx(
    ur,
    {
      label: "",
      value: e.name,
      onChange: (n) => t({ name: n }),
      placeholder: "",
      required: !0,
      description: " {{}} "
    }
  ) }),
  /* @__PURE__ */ h.jsx(gr, { title: "", children: /* @__PURE__ */ h.jsx(
    ur,
    {
      label: "",
      value: e.content,
      onChange: (n) => t({ content: n }),
      placeholder: "",
      multiline: !0,
      rows: 8
    }
  ) }),
  /* @__PURE__ */ h.jsxs("div", { className: "px-3 py-2 bg-muted/30 rounded border border-border", children: [
    /* @__PURE__ */ h.jsx("div", { className: "text-[10px] text-muted-foreground mb-2 font-medium uppercase tracking-wider", children: "" }),
    /* @__PURE__ */ h.jsxs("div", { className: "text-xs text-muted-foreground leading-relaxed", children: [
      /* @__PURE__ */ h.jsxs("p", { children: [
        " ",
        /* @__PURE__ */ h.jsx("code", { className: "px-1 py-0.5 bg-muted rounded text-primary font-mono", children: `{{${e.name || ""}}}` }),
        " "
      ] }),
      /* @__PURE__ */ h.jsx("p", { className: "mt-1", children: " SillyTavern " })
    ] })
  ] })
] }), X2 = ({ title: e, subtitle: t, actions: n, className: r = "" }) => /* @__PURE__ */ h.jsxs("div", { className: `mb-8 px-4 md:px-0 flex justify-between items-start animate-in fade-in slide-in-from-bottom-2 duration-500 ${r}`, children: [
  /* @__PURE__ */ h.jsxs("div", { children: [
    /* @__PURE__ */ h.jsx("h1", { className: "text-3xl font-light tracking-tight text-foreground", children: e }),
    t && /* @__PURE__ */ h.jsx("p", { className: "mt-2 text-muted-foreground text-sm font-light", children: t })
  ] }),
  n && /* @__PURE__ */ h.jsx("div", { className: "flex gap-2", children: n })
] }), Wg = ({
  title: e,
  onClose: t,
  children: n,
  actions: r
}) => /* @__PURE__ */ h.jsxs(
  "div",
  {
    className: "fixed inset-0 bg-background z-50 flex flex-col animate-in slide-in-from-right-4 duration-200",
    style: { height: "100dvh", width: "100vw" },
    children: [
      /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-3 px-4 py-3 border-b border-border shrink-0", children: [
        /* @__PURE__ */ h.jsx(
          "button",
          {
            onClick: t,
            className: "p-1 hover:bg-accent rounded",
            children: /* @__PURE__ */ h.jsx(p2, { size: 20 })
          }
        ),
        /* @__PURE__ */ h.jsx("h2", { className: "text-lg font-light flex-1", children: e }),
        r
      ] }),
      /* @__PURE__ */ h.jsx("div", { className: "flex-1 overflow-y-auto p-4 no-scrollbar", children: n })
    ]
  }
), jS = 768, sH = [
  { id: "llm", label: "LLM ", icon: Ih },
  { id: "vector", label: "", icon: x2 },
  { id: "rerank", label: "Rerank", icon: v2 }
], oH = ({ initialTab: e }) => {
  var Qe;
  const [t, n] = P.useState(e || "model"), [r, a] = P.useState("llm"), [o, l] = P.useState("templates"), [u, f] = P.useState(null), [d, m] = P.useState(window.innerWidth < jS), [p, x] = P.useState(!1);
  P.useEffect(() => {
    const qe = () => {
      const at = window.innerWidth < jS;
      m(at), at || x(!1);
    };
    return window.addEventListener("resize", qe), () => window.removeEventListener("resize", qe);
  }, []);
  const {
    settings: y,
    editingPreset: w,
    editingTemplate: E,
    hasChanges: k,
    regexRules: C,
    editingRule: T,
    selectPreset: N,
    addPreset: A,
    updatePreset: D,
    copyPreset: M,
    deletePreset: O,
    selectTemplate: Y,
    addTemplate: X,
    updateTemplate: U,
    deleteTemplate: B,
    updateVectorConfig: G,
    updateRerankConfig: re,
    updateWorldbookConfig: q,
    updateRegexConfig: W,
    // New!
    selectRule: V,
    addRule: ee,
    updateRule: te,
    toggleRule: ie,
    deleteRule: H,
    resetRules: L,
    save: J,
    toggleWorldbook: F,
    toggleEntry: Z,
    refreshWorldbooks: oe,
    worldbookStructure: fe,
    disabledEntries: Se,
    // V0.9.2: 
    addCustomMacro: Te,
    updateCustomMacro: we,
    deleteCustomMacro: ke,
    toggleCustomMacro: _e
  } = Z7(), Ae = (qe) => {
    qe(), d && x(!0);
  }, Pe = () => {
    x(!1);
  };
  return d && p && r === "llm" && w ? /* @__PURE__ */ h.jsx(
    Wg,
    {
      title: " LLM ",
      onClose: Pe,
      actions: k && /* @__PURE__ */ h.jsx(
        "button",
        {
          className: "p-2 text-primary",
          onClick: J,
          children: /* @__PURE__ */ h.jsx(Tc, { size: 18 })
        }
      ),
      children: /* @__PURE__ */ h.jsx(_S, { preset: w, onChange: D })
    }
  ) : d && p && t === "prompt" && E ? /* @__PURE__ */ h.jsx(
    Wg,
    {
      title: "",
      onClose: Pe,
      actions: k && /* @__PURE__ */ h.jsx(
        "button",
        {
          className: "p-2 text-primary",
          onClick: J,
          children: /* @__PURE__ */ h.jsx(Tc, { size: 18 })
        }
      ),
      children: /* @__PURE__ */ h.jsx(
        kS,
        {
          template: E,
          llmPresets: y.llmPresets,
          defaultPresetId: y.selectedPresetId,
          onChange: U
        }
      )
    }
  ) : d && p && t === "regex" && T ? /* @__PURE__ */ h.jsx(
    Wg,
    {
      title: "",
      onClose: Pe,
      actions: k && /* @__PURE__ */ h.jsx(
        "button",
        {
          className: "p-2 text-primary",
          onClick: J,
          children: /* @__PURE__ */ h.jsx(Tc, { size: 18 })
        }
      ),
      children: /* @__PURE__ */ h.jsx(NS, { rule: T, onChange: te })
    }
  ) : /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col h-full animate-in fade-in", children: [
    /* @__PURE__ */ h.jsx(
      X2,
      {
        title: "API ",
        subtitle: "",
        className: "mb-2"
      }
    ),
    /* @__PURE__ */ h.jsx(
      Kh,
      {
        tabs: [
          { id: "model", label: "" },
          { id: "prompt", label: "" },
          { id: "regex", label: "" },
          { id: "worldbook", label: "" }
        ],
        activeTab: t,
        onChange: (qe) => n(qe),
        actions: k && /* @__PURE__ */ h.jsxs(
          "button",
          {
            className: "inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-primary hover:text-primary-foreground hover:bg-primary border border-primary/50 rounded transition-colors",
            onClick: J,
            children: [
              /* @__PURE__ */ h.jsx(Tc, { size: 12 }),
              ""
            ]
          }
        )
      }
    ),
    /* @__PURE__ */ h.jsxs("div", { className: "flex-1 overflow-y-auto no-scrollbar", children: [
      t === "model" && /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col gap-2", children: [
        /* @__PURE__ */ h.jsx(
          s9,
          {
            tabs: sH.map((qe) => ({ ...qe, icon: /* @__PURE__ */ h.jsx(qe.icon, { size: 14 }) })),
            activeTab: r,
            onChange: (qe) => a(qe),
            sticky: !1,
            top: 0,
            className: "-mx-4 px-4 !mb-4"
          }
        ),
        r === "llm" && /* @__PURE__ */ h.jsxs("div", { className: `flex gap-6 ${d ? "flex-col" : ""}`, children: [
          /* @__PURE__ */ h.jsxs("div", { className: `
                                    flex flex-col gap-4
                                    ${d ? "w-full" : "w-[30%] min-w-[240px] border-r border-border/50 pr-4"}
                                `, children: [
            /* @__PURE__ */ h.jsxs("div", { className: "flex items-center justify-between", children: [
              /* @__PURE__ */ h.jsx("h3", { className: "text-xs font-bold text-muted-foreground uppercase tracking-wider", children: "" }),
              /* @__PURE__ */ h.jsx("button", { className: "text-muted-foreground hover:text-foreground transition-colors", onClick: A, children: /* @__PURE__ */ h.jsx(b2, { size: 16 }) })
            ] }),
            /* @__PURE__ */ h.jsx("div", { className: "flex flex-col gap-1", children: y.llmPresets.map((qe) => /* @__PURE__ */ h.jsx(
              $U,
              {
                preset: qe,
                isSelected: y.selectedPresetId === qe.id,
                onSelect: () => Ae(() => N(qe)),
                onEdit: () => Ae(() => N(qe)),
                onCopy: () => M(qe),
                onDelete: () => O(qe)
              },
              qe.id
            )) })
          ] }),
          !d && /* @__PURE__ */ h.jsx("div", { className: "flex-1", children: w ? /* @__PURE__ */ h.jsx("div", { className: "animate-in fade-in slide-in-from-right-2 duration-300", children: /* @__PURE__ */ h.jsx(_S, { preset: w, onChange: D }) }) : /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col items-center justify-center p-12 text-muted-foreground gap-4", children: [
            /* @__PURE__ */ h.jsx(Ih, { size: 32, className: "opacity-20" }),
            /* @__PURE__ */ h.jsx("p", { className: "text-sm font-light", children: "" })
          ] }) })
        ] }),
        r === "vector" && /* @__PURE__ */ h.jsx(KU, { config: y.vectorConfig, onChange: G }),
        r === "rerank" && /* @__PURE__ */ h.jsx(YU, { config: y.rerankConfig, onChange: re })
      ] }),
      t === "prompt" && /* @__PURE__ */ h.jsxs("div", { className: `flex gap-6 h-full ${d ? "flex-col" : ""}`, children: [
        /* @__PURE__ */ h.jsxs("div", { className: `
                            ${d ? "w-full" : "w-[30%] min-w-[280px] border-r border-border/50 pr-4"}
                        `, children: [
          /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-2 mb-4", children: [
            /* @__PURE__ */ h.jsx(
              "button",
              {
                onClick: () => l("templates"),
                className: `text-xs font-bold uppercase tracking-wider transition-colors ${o === "templates" ? "text-primary" : "text-muted-foreground hover:text-foreground"}`,
                children: ""
              }
            ),
            /* @__PURE__ */ h.jsx("span", { className: "text-muted-foreground/30", children: "|" }),
            /* @__PURE__ */ h.jsx(
              "button",
              {
                onClick: () => l("macros"),
                className: `text-xs font-bold uppercase tracking-wider transition-colors ${o === "macros" ? "text-primary" : "text-muted-foreground hover:text-foreground"}`,
                children: ""
              }
            )
          ] }),
          o === "templates" ? /* @__PURE__ */ h.jsx(
            ZU,
            {
              templates: y.promptTemplates,
              selectedId: (E == null ? void 0 : E.id) || null,
              onSelect: (qe) => Ae(() => Y(qe)),
              onAdd: X,
              onUpdate: U,
              onDelete: B
            }
          ) : /* @__PURE__ */ h.jsx(
            iH,
            {
              macros: y.customMacros || [],
              selectedId: u,
              onSelect: (qe) => Ae(() => f(qe.id)),
              onAdd: Te,
              onToggle: _e,
              onDelete: ke
            }
          )
        ] }),
        !d && o === "templates" && /* @__PURE__ */ h.jsx("div", { className: "flex-1 overflow-y-auto no-scrollbar", children: E ? /* @__PURE__ */ h.jsx(
          kS,
          {
            template: E,
            llmPresets: y.llmPresets,
            defaultPresetId: y.selectedPresetId,
            onChange: U
          }
        ) : /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col items-center justify-center p-12 text-muted-foreground gap-4", children: [
          /* @__PURE__ */ h.jsx(uu, { size: 32, className: "opacity-20" }),
          /* @__PURE__ */ h.jsx("p", { className: "text-sm font-light", children: "" })
        ] }) }),
        !d && o === "macros" && /* @__PURE__ */ h.jsx("div", { className: "flex-1 overflow-y-auto no-scrollbar", children: (() => {
          const qe = (y.customMacros || []).find((at) => at.id === u);
          return qe ? /* @__PURE__ */ h.jsx(
            aH,
            {
              macro: qe,
              onChange: (at) => we(qe.id, at)
            }
          ) : /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col items-center justify-center p-12 text-muted-foreground gap-4", children: [
            /* @__PURE__ */ h.jsx(rj, { size: 32, className: "opacity-20" }),
            /* @__PURE__ */ h.jsx("p", { className: "text-sm font-light", children: "" })
          ] });
        })() })
      ] }),
      t === "regex" && /* @__PURE__ */ h.jsxs("div", { className: `flex gap-6 h-full ${d ? "flex-col" : ""}`, children: [
        /* @__PURE__ */ h.jsx("div", { className: `
                            ${d ? "w-full" : "w-[30%] min-w-[280px] border-r border-border/50 pr-4"}
                        `, children: /* @__PURE__ */ h.jsx(
          tH,
          {
            rules: C,
            selectedId: (T == null ? void 0 : T.id) || null,
            onSelect: (qe) => Ae(() => V(qe)),
            onToggle: ie,
            onDelete: H,
            onAdd: ee,
            onReset: L,
            enableNativeRegex: ((Qe = y.regexConfig) == null ? void 0 : Qe.enableNativeRegex) ?? !0,
            onToggleNativeRegex: (qe) => W({
              ...y.regexConfig,
              enableNativeRegex: qe
            })
          }
        ) }),
        !d && /* @__PURE__ */ h.jsx("div", { className: "flex-1 overflow-y-auto no-scrollbar", children: T ? /* @__PURE__ */ h.jsx(NS, { rule: T, onChange: te }) : /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col items-center justify-center p-12 text-muted-foreground gap-4", children: [
          /* @__PURE__ */ h.jsx(oj, { size: 32, className: "opacity-20" }),
          /* @__PURE__ */ h.jsx("p", { className: "text-sm font-light", children: "" })
        ] }) })
      ] }),
      t === "worldbook" && /* @__PURE__ */ h.jsx("div", { className: "max-w-2xl py-4", children: /* @__PURE__ */ h.jsx(
        rH,
        {
          config: y.worldbookConfig,
          onChange: q,
          worldbookStructure: fe,
          disabledEntries: Se,
          onToggleWorldbook: F,
          onToggleEntry: Z,
          onRefresh: oe
        }
      ) })
    ] })
  ] });
}, lH = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  APIPresets: oH
}, Symbol.toStringTag, { value: "Module" })), uH = () => {
  const [e, t] = P.useState("claudeDark");
  P.useEffect(() => {
    t(qs.getTheme());
  }, []);
  const n = (a) => {
    qs.setTheme(a), We.set("theme", a), t(a);
  }, r = Object.entries(Xf).map(([a, o]) => {
    let l = o.colors.background, u = o.colors.primary;
    return {
      id: a,
      name: o.name,
      background: l,
      sidebar: o.colors.sidebar,
      // Add sidebar color
      primary: u
    };
  });
  return /* @__PURE__ */ h.jsxs("div", { className: "space-y-4", children: [
    /* @__PURE__ */ h.jsx("h3", { className: "text-lg font-medium", children: "" }),
    /* @__PURE__ */ h.jsx("div", { className: "grid grid-cols-2 sm:grid-cols-4 gap-4", children: r.map((a) => /* @__PURE__ */ h.jsxs(
      "button",
      {
        onClick: () => n(a.id),
        className: `
                            relative group flex flex-col items-center gap-2 p-3 rounded-xl border-2 transition-all
                            ${e === a.id ? "border-primary bg-accent/10" : "border-transparent hover:bg-accent/5"}
                        `,
        children: [
          /* @__PURE__ */ h.jsxs("div", { className: "flex items-center justify-center -space-x-3 mb-2", children: [
            /* @__PURE__ */ h.jsx(
              "div",
              {
                className: "w-8 h-8 rounded-full border border-border shadow-sm z-10",
                style: { background: a.background },
                title: "Background"
              }
            ),
            /* @__PURE__ */ h.jsx(
              "div",
              {
                className: "w-8 h-8 rounded-full border border-border shadow-sm z-20",
                style: { background: a.sidebar },
                title: "Sidebar"
              }
            ),
            /* @__PURE__ */ h.jsx(
              "div",
              {
                className: "w-8 h-8 rounded-full border border-border shadow-sm z-30 ring-2 ring-background",
                style: { background: a.primary },
                title: "Primary"
              }
            )
          ] }),
          /* @__PURE__ */ h.jsx("span", { className: `text-sm font-medium ${e === a.id ? "text-primary" : "text-muted-foreground"}`, children: a.name }),
          e === a.id && /* @__PURE__ */ h.jsx("div", { className: "absolute top-2 right-2 w-2 h-2 rounded-full bg-primary" })
        ]
      },
      a.id
    )) })
  ] });
}, cH = () => {
  var u, f, d, m, p, x;
  const [e, t] = P.useState(((u = We.getSettings().summarizerConfig) == null ? void 0 : u.previewEnabled) ?? !0), [n, r] = P.useState(((f = We.getSettings().preprocessingConfig) == null ? void 0 : f.preview) ?? vh.preview), [, a] = P.useState({});
  P.useEffect(() => {
    We.loadSettings();
  }, []);
  const [o, l] = P.useState(We.getSettings().linkedDeletion);
  return /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col h-full animate-in fade-in", children: [
    /* @__PURE__ */ h.jsx(X2, { title: "", subtitle: "" }),
    /* @__PURE__ */ h.jsxs("div", { className: "p-6 space-y-8", children: [
      /* @__PURE__ */ h.jsxs("section", { children: [
        /* @__PURE__ */ h.jsx("h3", { className: "text-sm font-medium text-muted-foreground uppercase tracking-wider mb-4", children: "" }),
        /* @__PURE__ */ h.jsx(uH, {})
      ] }),
      /* @__PURE__ */ h.jsxs("section", { children: [
        /* @__PURE__ */ h.jsx("h3", { className: "text-sm font-medium text-muted-foreground uppercase tracking-wider mb-4", children: " (Glass Effect)" }),
        /* @__PURE__ */ h.jsxs("div", { className: "bg-muted/30 border border-border rounded-lg p-4 space-y-6", children: [
          /* @__PURE__ */ h.jsxs("div", { className: "flex items-center justify-between gap-3", children: [
            /* @__PURE__ */ h.jsx("div", { className: "flex items-center gap-3 min-w-0 flex-1", children: /* @__PURE__ */ h.jsxs("div", { className: "min-w-0 flex-1", children: [
              /* @__PURE__ */ h.jsx("h4", { className: "font-medium text-foreground truncate", children: "" }),
              /* @__PURE__ */ h.jsx("p", { className: "text-sm text-muted-foreground line-clamp-2", children: "" })
            ] }) }),
            /* @__PURE__ */ h.jsx(
              Jn,
              {
                checked: ((d = We.getSettings().glassSettings) == null ? void 0 : d.enabled) ?? !0,
                onChange: (y) => {
                  const E = {
                    ...We.getSettings().glassSettings,
                    enabled: y
                  };
                  We.set("glassSettings", E), Promise.resolve().then(() => Qf).then(({ ThemeManager: k }) => {
                    k.setTheme(k.getTheme());
                  }), a({});
                }
              }
            )
          ] }),
          (((m = We.getSettings().glassSettings) == null ? void 0 : m.enabled) ?? !0) && /* @__PURE__ */ h.jsxs(h.Fragment, { children: [
            /* @__PURE__ */ h.jsx(
              er,
              {
                label: " (Opacity)",
                description: "",
                value: ((p = We.getSettings().glassSettings) == null ? void 0 : p.opacity) ?? 0.8,
                onChange: (y) => {
                  const E = {
                    ...We.getSettings().glassSettings,
                    opacity: y
                  };
                  We.set("glassSettings", E), Promise.resolve().then(() => Qf).then(({ ThemeManager: k }) => {
                    k.setTheme(k.getTheme());
                  }), a({});
                },
                min: 0,
                max: 1,
                step: 0.05,
                showSlider: !0
              }
            ),
            /* @__PURE__ */ h.jsx(
              er,
              {
                label: " (Blur)",
                description: " (px)",
                value: ((x = We.getSettings().glassSettings) == null ? void 0 : x.blur) ?? 10,
                onChange: (y) => {
                  const E = {
                    ...We.getSettings().glassSettings,
                    blur: y
                  };
                  We.set("glassSettings", E), Promise.resolve().then(() => Qf).then(({ ThemeManager: k }) => {
                    k.setTheme(k.getTheme());
                  }), a({});
                },
                min: 0,
                max: 50,
                step: 1,
                showSlider: !0
              }
            )
          ] })
        ] })
      ] }),
      /* @__PURE__ */ h.jsxs("section", { children: [
        /* @__PURE__ */ h.jsx("h3", { className: "text-sm font-medium text-muted-foreground uppercase tracking-wider mb-4", children: "" }),
        /* @__PURE__ */ h.jsx("div", { className: "bg-muted/30 border border-border rounded-lg p-4", children: /* @__PURE__ */ h.jsxs("div", { className: "flex items-center justify-between gap-3", children: [
          /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-3 min-w-0 flex-1", children: [
            /* @__PURE__ */ h.jsx("div", { className: "p-2 rounded-lg bg-primary/10 text-primary flex-shrink-0", children: /* @__PURE__ */ h.jsx(V5, { size: 20 }) }),
            /* @__PURE__ */ h.jsxs("div", { className: "min-w-0 flex-1", children: [
              /* @__PURE__ */ h.jsx("h4", { className: "font-medium text-foreground truncate", children: "" }),
              /* @__PURE__ */ h.jsx("p", { className: "text-sm text-muted-foreground line-clamp-2", children: "" })
            ] })
          ] }),
          /* @__PURE__ */ h.jsx(
            Jn,
            {
              checked: e,
              onChange: (y) => {
                t(y), Wi.updateConfig({ previewEnabled: y });
              }
            }
          )
        ] }) })
      ] }),
      /* @__PURE__ */ h.jsxs("section", { children: [
        /* @__PURE__ */ h.jsx("h3", { className: "text-sm font-medium text-muted-foreground uppercase tracking-wider mb-4", children: "" }),
        /* @__PURE__ */ h.jsx("div", { className: "bg-muted/30 border border-border rounded-lg p-4", children: /* @__PURE__ */ h.jsxs("div", { className: "flex items-center justify-between gap-3", children: [
          /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-3 min-w-0 flex-1", children: [
            /* @__PURE__ */ h.jsx("div", { className: "p-2 rounded-lg bg-primary/10 text-primary flex-shrink-0", children: /* @__PURE__ */ h.jsx(V5, { size: 20 }) }),
            /* @__PURE__ */ h.jsxs("div", { className: "min-w-0 flex-1", children: [
              /* @__PURE__ */ h.jsx("h4", { className: "font-medium text-foreground truncate", children: "" }),
              /* @__PURE__ */ h.jsx("p", { className: "text-sm text-muted-foreground line-clamp-2", children: "" })
            ] })
          ] }),
          /* @__PURE__ */ h.jsx(
            Jn,
            {
              checked: n,
              onChange: (y) => {
                r(y);
                const w = Qi.getConfig();
                Qi.saveConfig({ ...w, preview: y });
              }
            }
          )
        ] }) })
      ] }),
      /* @__PURE__ */ h.jsxs("section", { children: [
        /* @__PURE__ */ h.jsx("h3", { className: "text-sm font-medium text-muted-foreground uppercase tracking-wider mb-4", children: "" }),
        /* @__PURE__ */ h.jsxs("div", { className: "bg-muted/30 border border-border rounded-lg p-4 space-y-4", children: [
          /* @__PURE__ */ h.jsxs("div", { className: "flex items-center justify-between gap-3", children: [
            /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-3 min-w-0 flex-1", children: [
              /* @__PURE__ */ h.jsx("div", { className: "p-2 rounded-lg bg-red-500/10 text-red-500 flex-shrink-0", children: /* @__PURE__ */ h.jsx(Ri, { size: 20 }) }),
              /* @__PURE__ */ h.jsxs("div", { className: "min-w-0 flex-1", children: [
                /* @__PURE__ */ h.jsx("h4", { className: "font-medium text-foreground truncate", children: "" }),
                /* @__PURE__ */ h.jsx("p", { className: "text-sm text-muted-foreground line-clamp-2", children: "/" })
              ] })
            ] }),
            /* @__PURE__ */ h.jsx(
              Jn,
              {
                checked: o.enabled,
                onChange: (y) => {
                  const w = { ...o, enabled: y };
                  l(w), We.set("linkedDeletion", w);
                }
              }
            )
          ] }),
          o.enabled && /* @__PURE__ */ h.jsxs("div", { className: "pl-14 space-y-3 border-t border-border pt-3", children: [
            /* @__PURE__ */ h.jsxs("div", { className: "flex items-center justify-between", children: [
              /* @__PURE__ */ h.jsx("span", { className: "text-sm text-muted-foreground", children: "" }),
              /* @__PURE__ */ h.jsx(
                Jn,
                {
                  checked: o.showConfirmation,
                  onChange: (y) => {
                    const w = { ...o, showConfirmation: y };
                    l(w), We.set("linkedDeletion", w);
                  },
                  className: "scale-90"
                }
              )
            ] }),
            /* @__PURE__ */ h.jsxs("div", { className: "flex items-center justify-between gap-3", children: [
              /* @__PURE__ */ h.jsxs("div", { className: "min-w-0 flex-1", children: [
                /* @__PURE__ */ h.jsx("span", { className: "text-sm text-muted-foreground block truncate", children: " Worldbook" }),
                /* @__PURE__ */ h.jsx("p", { className: "text-xs text-muted-foreground/60 line-clamp-2", children: ":  Worldbook " })
              ] }),
              /* @__PURE__ */ h.jsx(
                Jn,
                {
                  checked: o.deleteChatWorldbook ?? !1,
                  onChange: (y) => {
                    const w = { ...o, deleteChatWorldbook: y };
                    l(w), We.set("linkedDeletion", w);
                  },
                  className: "scale-90"
                }
              )
            ] })
          ] })
        ] })
      ] }),
      /* @__PURE__ */ h.jsx("div", { className: "mt-8 pt-8 border-t border-border", children: /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col items-center justify-center text-muted-foreground gap-2 py-8 opacity-50", children: [
        /* @__PURE__ */ h.jsx(uh, { size: 32 }),
        /* @__PURE__ */ h.jsx("p", { className: "text-sm", children: "..." })
      ] }) })
    ] })
  ] });
}, dH = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  Settings: cH
}, Symbol.toStringTag, { value: "Module" }));
function fH({ score: e }) {
  const t = Math.round(e * 5);
  return /* @__PURE__ */ h.jsx("div", { className: "flex gap-0.5", children: [0, 1, 2, 3, 4].map((n) => /* @__PURE__ */ h.jsx(
    "span",
    {
      className: `w-1.5 h-1.5 rounded-full ${n < t ? "bg-primary" : "bg-muted"}`
    },
    n
  )) });
}
function hH({ isEmbedded: e }) {
  return e ? /* @__PURE__ */ h.jsxs(
    "span",
    {
      className: "inline-flex items-center gap-0.5 px-1.5 py-0.5 bg-primary/10 text-primary rounded text-[10px] font-medium",
      title: "",
      children: [
        /* @__PURE__ */ h.jsx(Po, { size: 10 }),
        /* @__PURE__ */ h.jsx("span", { children: "" })
      ]
    }
  ) : null;
}
function mH({ event: e }) {
  const t = e.structured_kv, n = [];
  return t.time_anchor && n.push(t.time_anchor), t.location && n.push(t.location), t.role && t.role.length > 0 && n.push(t.role.join(", ")), n.length === 0 ? null : /* @__PURE__ */ h.jsxs("p", { className: "text-xs text-muted-foreground truncate", children: [
    "(",
    n.join(" | "),
    ")"
  ] });
}
const pH = ({
  event: e,
  isSelected: t = !1,
  isCompact: n = !1,
  onSelect: r,
  onCheck: a,
  checked: o = !1,
  hasChanges: l = !1
}) => {
  var p;
  const u = e.structured_kv, f = e.summary.split(`
`), d = u.event || ((p = f[0]) == null ? void 0 : p.replace(/:\s*$/, "")) || "", m = f.length > 1 ? f.slice(1).join(" ").trim() : e.summary;
  return n ? /* @__PURE__ */ h.jsxs(
    "div",
    {
      className: `
                    flex items-center gap-3 p-3 cursor-pointer
                    border-b border-border
                    transition-colors duration-150
                    ${t ? "border-l-2 border-l-primary bg-transparent" : "hover:bg-accent/30"}
                `,
      onClick: r,
      children: [
        /* @__PURE__ */ h.jsx(
          "input",
          {
            type: "checkbox",
            checked: o,
            onChange: (x) => {
              x.stopPropagation(), a == null || a(x.target.checked);
            },
            className: "w-4 h-4 rounded border-border accent-primary"
          }
        ),
        /* @__PURE__ */ h.jsxs("div", { className: "flex-1 min-w-0", children: [
          /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-2", children: [
            /* @__PURE__ */ h.jsx("span", { className: "text-xs font-medium text-primary", children: d }),
            e.is_embedded && /* @__PURE__ */ h.jsx(Po, { size: 10, className: "text-primary" }),
            /* @__PURE__ */ h.jsx("span", { className: "text-xs text-muted-foreground", children: e.significance_score.toFixed(1) })
          ] }),
          /* @__PURE__ */ h.jsxs("p", { className: "text-sm text-foreground truncate mt-1", children: [
            m.substring(0, 50),
            "..."
          ] })
        ] }),
        /* @__PURE__ */ h.jsx(lu, { size: 16, className: "text-muted-foreground" })
      ]
    }
  ) : /* @__PURE__ */ h.jsxs(
    "div",
    {
      className: `
                p-4 cursor-pointer rounded-lg
                transition-all duration-150
                ${t ? "border border-primary bg-transparent" : "border border-transparent hover:border-border/50"}
            `,
      onClick: r,
      children: [
        /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-3 mb-2", children: [
          /* @__PURE__ */ h.jsx(
            "input",
            {
              type: "checkbox",
              checked: o,
              onChange: (x) => {
                x.stopPropagation(), a == null || a(x.target.checked);
              },
              className: "w-4 h-4 rounded border-border accent-primary"
            }
          ),
          /* @__PURE__ */ h.jsx("span", { className: "text-xs font-medium text-primary", children: d }),
          /* @__PURE__ */ h.jsx(hH, { isEmbedded: e.is_embedded }),
          l && /* @__PURE__ */ h.jsx("span", { className: "w-2 h-2 rounded-full bg-yellow-500", title: "" }),
          /* @__PURE__ */ h.jsx("div", { className: "flex-1" }),
          /* @__PURE__ */ h.jsx(fH, { score: e.significance_score })
        ] }),
        /* @__PURE__ */ h.jsx(mH, { event: e }),
        /* @__PURE__ */ h.jsx("p", { className: "text-sm text-foreground mt-1 line-clamp-2", children: m }),
        /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-2 mt-2 text-xs text-muted-foreground", children: [
          /* @__PURE__ */ h.jsxs("span", { children: [
            "Level ",
            e.level
          ] }),
          e.source_range && /* @__PURE__ */ h.jsxs(h.Fragment, { children: [
            /* @__PURE__ */ h.jsx("span", { children: "" }),
            /* @__PURE__ */ h.jsxs("span", { children: [
              ": ",
              e.source_range.start_index,
              "-",
              e.source_range.end_index,
              ""
            ] })
          ] })
        ] })
      ]
    }
  );
}, Kl = {
  background: "transparent",
  backgroundColor: "transparent",
  border: "none",
  borderBottom: "1px solid var(--border)",
  borderRadius: 0,
  boxShadow: "none",
  outline: "none",
  padding: "8px 0",
  fontSize: "14px",
  width: "100%",
  color: "var(--foreground, inherit)"
};
({
  ...Kl
});
function TS(e) {
  const t = [];
  return e.time_anchor && e.location ? t.push(`${e.time_anchor}${e.location}`) : e.time_anchor ? t.push(`${e.time_anchor}`) : e.location && t.push(`${e.location}`), e.role && e.role.length > 0 && t.push(e.role.join("")), e.event && t.push(e.event), e.logic && e.logic.length > 0 && t.push(`(${e.logic.join("/")})`), t.join(" ");
}
const Jb = P.forwardRef(({
  event: e,
  isFullScreen: t = !1,
  onSave: n,
  onDelete: r,
  onClose: a
}, o) => {
  const [l, u] = P.useState(""), [f, d] = P.useState(""), [m, p] = P.useState(""), [x, y] = P.useState(""), [w, E] = P.useState(""), [k, C] = P.useState(""), [T, N] = P.useState(0.5), [A, D] = P.useState(!1), [M, O] = P.useState(null);
  P.useEffect(() => {
    var q, W;
    e && e.id !== M && (u(e.summary), d(e.structured_kv.event || ""), p(e.structured_kv.time_anchor || ""), y(e.structured_kv.location || ""), E(((q = e.structured_kv.role) == null ? void 0 : q.join(", ")) || ""), C(((W = e.structured_kv.logic) == null ? void 0 : W.join(", ")) || ""), N(e.significance_score), D(!1), O(e.id));
  }, [e, M]);
  const Y = P.useCallback(() => {
    var V;
    const q = {
      event: f,
      time_anchor: m,
      location: x,
      role: w.split(",").map((ee) => ee.trim()).filter(Boolean),
      logic: k.split(",").map((ee) => ee.trim()).filter(Boolean),
      causality: ((V = e == null ? void 0 : e.structured_kv) == null ? void 0 : V.causality) || ""
    };
    return {
      summary: TS(q) || l,
      structured_kv: {
        ...(e == null ? void 0 : e.structured_kv) || {},
        ...q
      },
      significance_score: T
    };
  }, [e, f, m, x, w, k, T, l]), X = P.useCallback(() => {
    e && (D(!0), setTimeout(() => {
      const q = Y();
      n == null || n(e.id, q);
    }, 0));
  }, [e, Y, n]);
  P.useImperativeHandle(o, () => ({
    save: X,
    isDirty: () => A
  }), [X, A]);
  const U = () => {
    confirm("") && (r == null || r(e.id));
  }, B = (q, W) => {
    q(W), setTimeout(X, 10);
  }, G = (q) => {
    N(q), setTimeout(X, 10);
  };
  if (!e)
    return /* @__PURE__ */ h.jsx("div", { className: "flex flex-col items-center justify-center h-full text-muted-foreground gap-2 p-8", children: /* @__PURE__ */ h.jsx("p", { className: "text-sm font-light", children: "" }) });
  const re = /* @__PURE__ */ h.jsxs(h.Fragment, { children: [
    /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col gap-1", children: [
      /* @__PURE__ */ h.jsx("label", { className: "text-xs text-muted-foreground", children: "" }),
      /* @__PURE__ */ h.jsx(
        "input",
        {
          type: "text",
          value: f,
          onChange: (q) => B(d, q.target.value),
          style: Kl,
          className: "placeholder:text-muted-foreground/40 focus:border-primary transition-colors",
          placeholder: ""
        }
      )
    ] }),
    /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col gap-1", children: [
      /* @__PURE__ */ h.jsx("label", { className: "text-xs text-muted-foreground", children: " ()" }),
      /* @__PURE__ */ h.jsx(
        "div",
        {
          className: "p-2 text-sm text-foreground/80 bg-muted/30 rounded border border-border/50 min-h-[60px]",
          children: TS({
            event: f,
            time_anchor: m,
            location: x,
            role: w.split(",").map((q) => q.trim()).filter(Boolean),
            logic: k.split(",").map((q) => q.trim()).filter(Boolean)
          }) || /* @__PURE__ */ h.jsx("span", { className: "text-muted-foreground/50", children: "..." })
        }
      )
    ] }),
    /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col gap-1", children: [
      /* @__PURE__ */ h.jsx("label", { className: "text-xs text-muted-foreground", children: "" }),
      /* @__PURE__ */ h.jsx(
        "input",
        {
          type: "text",
          value: m,
          onChange: (q) => B(p, q.target.value),
          style: Kl,
          className: "placeholder:text-muted-foreground/40 focus:border-primary transition-colors",
          placeholder: "102344"
        }
      )
    ] }),
    /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col gap-1", children: [
      /* @__PURE__ */ h.jsx("label", { className: "text-xs text-muted-foreground", children: "" }),
      /* @__PURE__ */ h.jsx(
        "input",
        {
          type: "text",
          value: x,
          onChange: (q) => B(y, q.target.value),
          style: Kl,
          className: "placeholder:text-muted-foreground/40 focus:border-primary transition-colors",
          placeholder: ""
        }
      )
    ] }),
    /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col gap-1", children: [
      /* @__PURE__ */ h.jsx("label", { className: "text-xs text-muted-foreground", children: "" }),
      /* @__PURE__ */ h.jsx(
        "input",
        {
          type: "text",
          value: w,
          onChange: (q) => B(E, q.target.value),
          style: Kl,
          className: "placeholder:text-muted-foreground/40 focus:border-primary transition-colors",
          placeholder: "{{user}}, "
        }
      )
    ] }),
    /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col gap-1", children: [
      /* @__PURE__ */ h.jsx("label", { className: "text-xs text-muted-foreground", children: "" }),
      /* @__PURE__ */ h.jsx(
        "input",
        {
          type: "text",
          value: k,
          onChange: (q) => B(C, q.target.value),
          style: Kl,
          className: "placeholder:text-muted-foreground/40 focus:border-primary transition-colors",
          placeholder: ", "
        }
      )
    ] }),
    /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col gap-2", children: [
      /* @__PURE__ */ h.jsxs("div", { className: "flex justify-between items-center", children: [
        /* @__PURE__ */ h.jsx("label", { className: "text-xs text-muted-foreground", children: "" }),
        /* @__PURE__ */ h.jsx("span", { className: "text-xs font-mono text-foreground", children: T.toFixed(2) })
      ] }),
      /* @__PURE__ */ h.jsxs("div", { className: "relative h-4 flex items-center group cursor-pointer", children: [
        /* @__PURE__ */ h.jsx(
          "div",
          {
            className: "absolute inset-x-0 h-[1px]",
            style: { backgroundColor: "var(--border)" }
          }
        ),
        /* @__PURE__ */ h.jsx(
          "div",
          {
            className: "absolute top-1/2 -translate-y-1/2 w-2.5 h-2.5 bg-muted-foreground/80 rounded-full shadow-sm pointer-events-none transition-transform duration-75 ease-out group-hover:scale-125 group-hover:bg-foreground",
            style: { left: `${T * 100}%`, transform: "translate(-50%, -50%)" }
          }
        ),
        /* @__PURE__ */ h.jsx(
          "input",
          {
            type: "range",
            min: "0",
            max: "1",
            step: "0.05",
            value: T,
            onChange: (q) => G(parseFloat(q.target.value)),
            className: "absolute inset-x-0 w-full h-full opacity-0 cursor-pointer z-10 m-0",
            style: { appearance: "none", WebkitAppearance: "none" }
          }
        )
      ] })
    ] }),
    /* @__PURE__ */ h.jsx(Fn, { spacing: "md" }),
    /* @__PURE__ */ h.jsxs("div", { className: "space-y-1 text-xs text-muted-foreground", children: [
      /* @__PURE__ */ h.jsxs("p", { children: [
        "ID: ",
        /* @__PURE__ */ h.jsxs("span", { className: "font-mono", children: [
          e.id.substring(0, 8),
          "..."
        ] })
      ] }),
      /* @__PURE__ */ h.jsxs("p", { children: [
        "Level: ",
        e.level
      ] }),
      e.source_range && /* @__PURE__ */ h.jsxs("p", { children: [
        ": ",
        e.source_range.start_index,
        "-",
        e.source_range.end_index,
        ""
      ] }),
      /* @__PURE__ */ h.jsxs("p", { children: [
        ": ",
        new Date(e.timestamp).toLocaleString()
      ] }),
      /* @__PURE__ */ h.jsxs("p", { children: [
        ":",
        e.is_archived && /* @__PURE__ */ h.jsx("span", { className: "ml-1 text-yellow-500", children: "" }),
        e.is_embedded && /* @__PURE__ */ h.jsx("span", { className: "ml-1 text-green-500", children: "" }),
        !e.is_archived && !e.is_embedded && /* @__PURE__ */ h.jsx("span", { className: "ml-1", children: "" })
      ] })
    ] })
  ] });
  return t ? /* @__PURE__ */ h.jsxs("div", { className: "fixed inset-0 bg-background z-50 flex flex-col", style: { height: "100dvh" }, children: [
    /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-3 px-4 py-3 border-b border-border shrink-0", children: [
      /* @__PURE__ */ h.jsx(
        "button",
        {
          onClick: a,
          className: "p-1 hover:bg-accent rounded",
          children: /* @__PURE__ */ h.jsx(p2, { size: 20 })
        }
      ),
      /* @__PURE__ */ h.jsx("h2", { className: "text-lg font-light flex-1", children: "" }),
      /* @__PURE__ */ h.jsx(
        "button",
        {
          onClick: U,
          className: "p-2 text-destructive hover:bg-destructive/10 rounded",
          children: /* @__PURE__ */ h.jsx(Ri, { size: 18 })
        }
      )
    ] }),
    /* @__PURE__ */ h.jsx("div", { className: "flex-1 overflow-y-auto p-4 space-y-4", children: re }),
    /* @__PURE__ */ h.jsx("div", { className: "p-4 border-t border-border shrink-0", children: /* @__PURE__ */ h.jsx(
      "button",
      {
        onClick: a,
        className: "w-full py-2 text-sm border border-border rounded-md hover:bg-accent",
        children: ""
      }
    ) })
  ] }) : /* @__PURE__ */ h.jsxs("div", { className: "h-full flex flex-col", children: [
    /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-2 pb-4 border-b border-border shrink-0", children: [
      /* @__PURE__ */ h.jsx("h3", { className: "text-sm font-medium text-primary flex-1", children: "" }),
      /* @__PURE__ */ h.jsx(
        "button",
        {
          onClick: U,
          className: "p-1.5 text-destructive hover:bg-destructive/10 rounded",
          title: "",
          children: /* @__PURE__ */ h.jsx(Ri, { size: 16 })
        }
      )
    ] }),
    /* @__PURE__ */ h.jsx("div", { className: "flex-1 overflow-y-auto py-4 space-y-4 no-scrollbar", children: re })
  ] });
});
Jb.displayName = "EventEditor";
function On(e) {
  if (typeof e == "string" || typeof e == "number") return "" + e;
  let t = "";
  if (Array.isArray(e))
    for (let n = 0, r; n < e.length; n++)
      (r = On(e[n])) !== "" && (t += (t && " ") + r);
  else
    for (let n in e)
      e[n] && (t += (t && " ") + n);
  return t;
}
var gH = { value: () => {
} };
function Yh() {
  for (var e = 0, t = arguments.length, n = {}, r; e < t; ++e) {
    if (!(r = arguments[e] + "") || r in n || /[\s.]/.test(r)) throw new Error("illegal type: " + r);
    n[r] = [];
  }
  return new nh(n);
}
function nh(e) {
  this._ = e;
}
function yH(e, t) {
  return e.trim().split(/^|\s+/).map(function(n) {
    var r = "", a = n.indexOf(".");
    if (a >= 0 && (r = n.slice(a + 1), n = n.slice(0, a)), n && !t.hasOwnProperty(n)) throw new Error("unknown type: " + n);
    return { type: n, name: r };
  });
}
nh.prototype = Yh.prototype = {
  constructor: nh,
  on: function(e, t) {
    var n = this._, r = yH(e + "", n), a, o = -1, l = r.length;
    if (arguments.length < 2) {
      for (; ++o < l; ) if ((a = (e = r[o]).type) && (a = xH(n[a], e.name))) return a;
      return;
    }
    if (t != null && typeof t != "function") throw new Error("invalid callback: " + t);
    for (; ++o < l; )
      if (a = (e = r[o]).type) n[a] = AS(n[a], e.name, t);
      else if (t == null) for (a in n) n[a] = AS(n[a], e.name, null);
    return this;
  },
  copy: function() {
    var e = {}, t = this._;
    for (var n in t) e[n] = t[n].slice();
    return new nh(e);
  },
  call: function(e, t) {
    if ((a = arguments.length - 2) > 0) for (var n = new Array(a), r = 0, a, o; r < a; ++r) n[r] = arguments[r + 2];
    if (!this._.hasOwnProperty(e)) throw new Error("unknown type: " + e);
    for (o = this._[e], r = 0, a = o.length; r < a; ++r) o[r].value.apply(t, n);
  },
  apply: function(e, t, n) {
    if (!this._.hasOwnProperty(e)) throw new Error("unknown type: " + e);
    for (var r = this._[e], a = 0, o = r.length; a < o; ++a) r[a].value.apply(t, n);
  }
};
function xH(e, t) {
  for (var n = 0, r = e.length, a; n < r; ++n)
    if ((a = e[n]).name === t)
      return a.value;
}
function AS(e, t, n) {
  for (var r = 0, a = e.length; r < a; ++r)
    if (e[r].name === t) {
      e[r] = gH, e = e.slice(0, r).concat(e.slice(r + 1));
      break;
    }
  return n != null && e.push({ name: t, value: n }), e;
}
var e2 = "http://www.w3.org/1999/xhtml";
const MS = {
  svg: "http://www.w3.org/2000/svg",
  xhtml: e2,
  xlink: "http://www.w3.org/1999/xlink",
  xml: "http://www.w3.org/XML/1998/namespace",
  xmlns: "http://www.w3.org/2000/xmlns/"
};
function Xh(e) {
  var t = e += "", n = t.indexOf(":");
  return n >= 0 && (t = e.slice(0, n)) !== "xmlns" && (e = e.slice(n + 1)), MS.hasOwnProperty(t) ? { space: MS[t], local: e } : e;
}
function vH(e) {
  return function() {
    var t = this.ownerDocument, n = this.namespaceURI;
    return n === e2 && t.documentElement.namespaceURI === e2 ? t.createElement(e) : t.createElementNS(n, e);
  };
}
function bH(e) {
  return function() {
    return this.ownerDocument.createElementNS(e.space, e.local);
  };
}
function l9(e) {
  var t = Xh(e);
  return (t.local ? bH : vH)(t);
}
function wH() {
}
function W2(e) {
  return e == null ? wH : function() {
    return this.querySelector(e);
  };
}
function _H(e) {
  typeof e != "function" && (e = W2(e));
  for (var t = this._groups, n = t.length, r = new Array(n), a = 0; a < n; ++a)
    for (var o = t[a], l = o.length, u = r[a] = new Array(l), f, d, m = 0; m < l; ++m)
      (f = o[m]) && (d = e.call(f, f.__data__, m, o)) && ("__data__" in f && (d.__data__ = f.__data__), u[m] = d);
  return new Yr(r, this._parents);
}
function SH(e) {
  return e == null ? [] : Array.isArray(e) ? e : Array.from(e);
}
function CH() {
  return [];
}
function u9(e) {
  return e == null ? CH : function() {
    return this.querySelectorAll(e);
  };
}
function EH(e) {
  return function() {
    return SH(e.apply(this, arguments));
  };
}
function kH(e) {
  typeof e == "function" ? e = EH(e) : e = u9(e);
  for (var t = this._groups, n = t.length, r = [], a = [], o = 0; o < n; ++o)
    for (var l = t[o], u = l.length, f, d = 0; d < u; ++d)
      (f = l[d]) && (r.push(e.call(f, f.__data__, d, l)), a.push(f));
  return new Yr(r, a);
}
function c9(e) {
  return function() {
    return this.matches(e);
  };
}
function d9(e) {
  return function(t) {
    return t.matches(e);
  };
}
var NH = Array.prototype.find;
function jH(e) {
  return function() {
    return NH.call(this.children, e);
  };
}
function TH() {
  return this.firstElementChild;
}
function AH(e) {
  return this.select(e == null ? TH : jH(typeof e == "function" ? e : d9(e)));
}
var MH = Array.prototype.filter;
function RH() {
  return Array.from(this.children);
}
function zH(e) {
  return function() {
    return MH.call(this.children, e);
  };
}
function OH(e) {
  return this.selectAll(e == null ? RH : zH(typeof e == "function" ? e : d9(e)));
}
function DH(e) {
  typeof e != "function" && (e = c9(e));
  for (var t = this._groups, n = t.length, r = new Array(n), a = 0; a < n; ++a)
    for (var o = t[a], l = o.length, u = r[a] = [], f, d = 0; d < l; ++d)
      (f = o[d]) && e.call(f, f.__data__, d, o) && u.push(f);
  return new Yr(r, this._parents);
}
function f9(e) {
  return new Array(e.length);
}
function IH() {
  return new Yr(this._enter || this._groups.map(f9), this._parents);
}
function wh(e, t) {
  this.ownerDocument = e.ownerDocument, this.namespaceURI = e.namespaceURI, this._next = null, this._parent = e, this.__data__ = t;
}
wh.prototype = {
  constructor: wh,
  appendChild: function(e) {
    return this._parent.insertBefore(e, this._next);
  },
  insertBefore: function(e, t) {
    return this._parent.insertBefore(e, t);
  },
  querySelector: function(e) {
    return this._parent.querySelector(e);
  },
  querySelectorAll: function(e) {
    return this._parent.querySelectorAll(e);
  }
};
function LH(e) {
  return function() {
    return e;
  };
}
function qH(e, t, n, r, a, o) {
  for (var l = 0, u, f = t.length, d = o.length; l < d; ++l)
    (u = t[l]) ? (u.__data__ = o[l], r[l] = u) : n[l] = new wh(e, o[l]);
  for (; l < f; ++l)
    (u = t[l]) && (a[l] = u);
}
function PH(e, t, n, r, a, o, l) {
  var u, f, d = /* @__PURE__ */ new Map(), m = t.length, p = o.length, x = new Array(m), y;
  for (u = 0; u < m; ++u)
    (f = t[u]) && (x[u] = y = l.call(f, f.__data__, u, t) + "", d.has(y) ? a[u] = f : d.set(y, f));
  for (u = 0; u < p; ++u)
    y = l.call(e, o[u], u, o) + "", (f = d.get(y)) ? (r[u] = f, f.__data__ = o[u], d.delete(y)) : n[u] = new wh(e, o[u]);
  for (u = 0; u < m; ++u)
    (f = t[u]) && d.get(x[u]) === f && (a[u] = f);
}
function BH(e) {
  return e.__data__;
}
function FH(e, t) {
  if (!arguments.length) return Array.from(this, BH);
  var n = t ? PH : qH, r = this._parents, a = this._groups;
  typeof e != "function" && (e = LH(e));
  for (var o = a.length, l = new Array(o), u = new Array(o), f = new Array(o), d = 0; d < o; ++d) {
    var m = r[d], p = a[d], x = p.length, y = $H(e.call(m, m && m.__data__, d, r)), w = y.length, E = u[d] = new Array(w), k = l[d] = new Array(w), C = f[d] = new Array(x);
    n(m, p, E, k, C, y, t);
    for (var T = 0, N = 0, A, D; T < w; ++T)
      if (A = E[T]) {
        for (T >= N && (N = T + 1); !(D = k[N]) && ++N < w; ) ;
        A._next = D || null;
      }
  }
  return l = new Yr(l, r), l._enter = u, l._exit = f, l;
}
function $H(e) {
  return typeof e == "object" && "length" in e ? e : Array.from(e);
}
function UH() {
  return new Yr(this._exit || this._groups.map(f9), this._parents);
}
function HH(e, t, n) {
  var r = this.enter(), a = this, o = this.exit();
  return typeof e == "function" ? (r = e(r), r && (r = r.selection())) : r = r.append(e + ""), t != null && (a = t(a), a && (a = a.selection())), n == null ? o.remove() : n(o), r && a ? r.merge(a).order() : a;
}
function GH(e) {
  for (var t = e.selection ? e.selection() : e, n = this._groups, r = t._groups, a = n.length, o = r.length, l = Math.min(a, o), u = new Array(a), f = 0; f < l; ++f)
    for (var d = n[f], m = r[f], p = d.length, x = u[f] = new Array(p), y, w = 0; w < p; ++w)
      (y = d[w] || m[w]) && (x[w] = y);
  for (; f < a; ++f)
    u[f] = n[f];
  return new Yr(u, this._parents);
}
function VH() {
  for (var e = this._groups, t = -1, n = e.length; ++t < n; )
    for (var r = e[t], a = r.length - 1, o = r[a], l; --a >= 0; )
      (l = r[a]) && (o && l.compareDocumentPosition(o) ^ 4 && o.parentNode.insertBefore(l, o), o = l);
  return this;
}
function KH(e) {
  e || (e = YH);
  function t(p, x) {
    return p && x ? e(p.__data__, x.__data__) : !p - !x;
  }
  for (var n = this._groups, r = n.length, a = new Array(r), o = 0; o < r; ++o) {
    for (var l = n[o], u = l.length, f = a[o] = new Array(u), d, m = 0; m < u; ++m)
      (d = l[m]) && (f[m] = d);
    f.sort(t);
  }
  return new Yr(a, this._parents).order();
}
function YH(e, t) {
  return e < t ? -1 : e > t ? 1 : e >= t ? 0 : NaN;
}
function XH() {
  var e = arguments[0];
  return arguments[0] = this, e.apply(null, arguments), this;
}
function WH() {
  return Array.from(this);
}
function QH() {
  for (var e = this._groups, t = 0, n = e.length; t < n; ++t)
    for (var r = e[t], a = 0, o = r.length; a < o; ++a) {
      var l = r[a];
      if (l) return l;
    }
  return null;
}
function ZH() {
  let e = 0;
  for (const t of this) ++e;
  return e;
}
function JH() {
  return !this.node();
}
function eG(e) {
  for (var t = this._groups, n = 0, r = t.length; n < r; ++n)
    for (var a = t[n], o = 0, l = a.length, u; o < l; ++o)
      (u = a[o]) && e.call(u, u.__data__, o, a);
  return this;
}
function tG(e) {
  return function() {
    this.removeAttribute(e);
  };
}
function nG(e) {
  return function() {
    this.removeAttributeNS(e.space, e.local);
  };
}
function rG(e, t) {
  return function() {
    this.setAttribute(e, t);
  };
}
function iG(e, t) {
  return function() {
    this.setAttributeNS(e.space, e.local, t);
  };
}
function aG(e, t) {
  return function() {
    var n = t.apply(this, arguments);
    n == null ? this.removeAttribute(e) : this.setAttribute(e, n);
  };
}
function sG(e, t) {
  return function() {
    var n = t.apply(this, arguments);
    n == null ? this.removeAttributeNS(e.space, e.local) : this.setAttributeNS(e.space, e.local, n);
  };
}
function oG(e, t) {
  var n = Xh(e);
  if (arguments.length < 2) {
    var r = this.node();
    return n.local ? r.getAttributeNS(n.space, n.local) : r.getAttribute(n);
  }
  return this.each((t == null ? n.local ? nG : tG : typeof t == "function" ? n.local ? sG : aG : n.local ? iG : rG)(n, t));
}
function h9(e) {
  return e.ownerDocument && e.ownerDocument.defaultView || e.document && e || e.defaultView;
}
function lG(e) {
  return function() {
    this.style.removeProperty(e);
  };
}
function uG(e, t, n) {
  return function() {
    this.style.setProperty(e, t, n);
  };
}
function cG(e, t, n) {
  return function() {
    var r = t.apply(this, arguments);
    r == null ? this.style.removeProperty(e) : this.style.setProperty(e, r, n);
  };
}
function dG(e, t, n) {
  return arguments.length > 1 ? this.each((t == null ? lG : typeof t == "function" ? cG : uG)(e, t, n ?? "")) : tu(this.node(), e);
}
function tu(e, t) {
  return e.style.getPropertyValue(t) || h9(e).getComputedStyle(e, null).getPropertyValue(t);
}
function fG(e) {
  return function() {
    delete this[e];
  };
}
function hG(e, t) {
  return function() {
    this[e] = t;
  };
}
function mG(e, t) {
  return function() {
    var n = t.apply(this, arguments);
    n == null ? delete this[e] : this[e] = n;
  };
}
function pG(e, t) {
  return arguments.length > 1 ? this.each((t == null ? fG : typeof t == "function" ? mG : hG)(e, t)) : this.node()[e];
}
function m9(e) {
  return e.trim().split(/^|\s+/);
}
function Q2(e) {
  return e.classList || new p9(e);
}
function p9(e) {
  this._node = e, this._names = m9(e.getAttribute("class") || "");
}
p9.prototype = {
  add: function(e) {
    var t = this._names.indexOf(e);
    t < 0 && (this._names.push(e), this._node.setAttribute("class", this._names.join(" ")));
  },
  remove: function(e) {
    var t = this._names.indexOf(e);
    t >= 0 && (this._names.splice(t, 1), this._node.setAttribute("class", this._names.join(" ")));
  },
  contains: function(e) {
    return this._names.indexOf(e) >= 0;
  }
};
function g9(e, t) {
  for (var n = Q2(e), r = -1, a = t.length; ++r < a; ) n.add(t[r]);
}
function y9(e, t) {
  for (var n = Q2(e), r = -1, a = t.length; ++r < a; ) n.remove(t[r]);
}
function gG(e) {
  return function() {
    g9(this, e);
  };
}
function yG(e) {
  return function() {
    y9(this, e);
  };
}
function xG(e, t) {
  return function() {
    (t.apply(this, arguments) ? g9 : y9)(this, e);
  };
}
function vG(e, t) {
  var n = m9(e + "");
  if (arguments.length < 2) {
    for (var r = Q2(this.node()), a = -1, o = n.length; ++a < o; ) if (!r.contains(n[a])) return !1;
    return !0;
  }
  return this.each((typeof t == "function" ? xG : t ? gG : yG)(n, t));
}
function bG() {
  this.textContent = "";
}
function wG(e) {
  return function() {
    this.textContent = e;
  };
}
function _G(e) {
  return function() {
    var t = e.apply(this, arguments);
    this.textContent = t ?? "";
  };
}
function SG(e) {
  return arguments.length ? this.each(e == null ? bG : (typeof e == "function" ? _G : wG)(e)) : this.node().textContent;
}
function CG() {
  this.innerHTML = "";
}
function EG(e) {
  return function() {
    this.innerHTML = e;
  };
}
function kG(e) {
  return function() {
    var t = e.apply(this, arguments);
    this.innerHTML = t ?? "";
  };
}
function NG(e) {
  return arguments.length ? this.each(e == null ? CG : (typeof e == "function" ? kG : EG)(e)) : this.node().innerHTML;
}
function jG() {
  this.nextSibling && this.parentNode.appendChild(this);
}
function TG() {
  return this.each(jG);
}
function AG() {
  this.previousSibling && this.parentNode.insertBefore(this, this.parentNode.firstChild);
}
function MG() {
  return this.each(AG);
}
function RG(e) {
  var t = typeof e == "function" ? e : l9(e);
  return this.select(function() {
    return this.appendChild(t.apply(this, arguments));
  });
}
function zG() {
  return null;
}
function OG(e, t) {
  var n = typeof e == "function" ? e : l9(e), r = t == null ? zG : typeof t == "function" ? t : W2(t);
  return this.select(function() {
    return this.insertBefore(n.apply(this, arguments), r.apply(this, arguments) || null);
  });
}
function DG() {
  var e = this.parentNode;
  e && e.removeChild(this);
}
function IG() {
  return this.each(DG);
}
function LG() {
  var e = this.cloneNode(!1), t = this.parentNode;
  return t ? t.insertBefore(e, this.nextSibling) : e;
}
function qG() {
  var e = this.cloneNode(!0), t = this.parentNode;
  return t ? t.insertBefore(e, this.nextSibling) : e;
}
function PG(e) {
  return this.select(e ? qG : LG);
}
function BG(e) {
  return arguments.length ? this.property("__data__", e) : this.node().__data__;
}
function FG(e) {
  return function(t) {
    e.call(this, t, this.__data__);
  };
}
function $G(e) {
  return e.trim().split(/^|\s+/).map(function(t) {
    var n = "", r = t.indexOf(".");
    return r >= 0 && (n = t.slice(r + 1), t = t.slice(0, r)), { type: t, name: n };
  });
}
function UG(e) {
  return function() {
    var t = this.__on;
    if (t) {
      for (var n = 0, r = -1, a = t.length, o; n < a; ++n)
        o = t[n], (!e.type || o.type === e.type) && o.name === e.name ? this.removeEventListener(o.type, o.listener, o.options) : t[++r] = o;
      ++r ? t.length = r : delete this.__on;
    }
  };
}
function HG(e, t, n) {
  return function() {
    var r = this.__on, a, o = FG(t);
    if (r) {
      for (var l = 0, u = r.length; l < u; ++l)
        if ((a = r[l]).type === e.type && a.name === e.name) {
          this.removeEventListener(a.type, a.listener, a.options), this.addEventListener(a.type, a.listener = o, a.options = n), a.value = t;
          return;
        }
    }
    this.addEventListener(e.type, o, n), a = { type: e.type, name: e.name, value: t, listener: o, options: n }, r ? r.push(a) : this.__on = [a];
  };
}
function GG(e, t, n) {
  var r = $G(e + ""), a, o = r.length, l;
  if (arguments.length < 2) {
    var u = this.node().__on;
    if (u) {
      for (var f = 0, d = u.length, m; f < d; ++f)
        for (a = 0, m = u[f]; a < o; ++a)
          if ((l = r[a]).type === m.type && l.name === m.name)
            return m.value;
    }
    return;
  }
  for (u = t ? HG : UG, a = 0; a < o; ++a) this.each(u(r[a], t, n));
  return this;
}
function x9(e, t, n) {
  var r = h9(e), a = r.CustomEvent;
  typeof a == "function" ? a = new a(t, n) : (a = r.document.createEvent("Event"), n ? (a.initEvent(t, n.bubbles, n.cancelable), a.detail = n.detail) : a.initEvent(t, !1, !1)), e.dispatchEvent(a);
}
function VG(e, t) {
  return function() {
    return x9(this, e, t);
  };
}
function KG(e, t) {
  return function() {
    return x9(this, e, t.apply(this, arguments));
  };
}
function YG(e, t) {
  return this.each((typeof t == "function" ? KG : VG)(e, t));
}
function* XG() {
  for (var e = this._groups, t = 0, n = e.length; t < n; ++t)
    for (var r = e[t], a = 0, o = r.length, l; a < o; ++a)
      (l = r[a]) && (yield l);
}
var v9 = [null];
function Yr(e, t) {
  this._groups = e, this._parents = t;
}
function ud() {
  return new Yr([[document.documentElement]], v9);
}
function WG() {
  return this;
}
Yr.prototype = ud.prototype = {
  constructor: Yr,
  select: _H,
  selectAll: kH,
  selectChild: AH,
  selectChildren: OH,
  filter: DH,
  data: FH,
  enter: IH,
  exit: UH,
  join: HH,
  merge: GH,
  selection: WG,
  order: VH,
  sort: KH,
  call: XH,
  nodes: WH,
  node: QH,
  size: ZH,
  empty: JH,
  each: eG,
  attr: oG,
  style: dG,
  property: pG,
  classed: vG,
  text: SG,
  html: NG,
  raise: TG,
  lower: MG,
  append: RG,
  insert: OG,
  remove: IG,
  clone: PG,
  datum: BG,
  on: GG,
  dispatch: YG,
  [Symbol.iterator]: XG
};
function Gr(e) {
  return typeof e == "string" ? new Yr([[document.querySelector(e)]], [document.documentElement]) : new Yr([[e]], v9);
}
function QG(e) {
  let t;
  for (; t = e.sourceEvent; ) e = t;
  return e;
}
function Ci(e, t) {
  if (e = QG(e), t === void 0 && (t = e.currentTarget), t) {
    var n = t.ownerSVGElement || t;
    if (n.createSVGPoint) {
      var r = n.createSVGPoint();
      return r.x = e.clientX, r.y = e.clientY, r = r.matrixTransform(t.getScreenCTM().inverse()), [r.x, r.y];
    }
    if (t.getBoundingClientRect) {
      var a = t.getBoundingClientRect();
      return [e.clientX - a.left - t.clientLeft, e.clientY - a.top - t.clientTop];
    }
  }
  return [e.pageX, e.pageY];
}
const ZG = { passive: !1 }, Yc = { capture: !0, passive: !1 };
function Qg(e) {
  e.stopImmediatePropagation();
}
function Ql(e) {
  e.preventDefault(), e.stopImmediatePropagation();
}
function b9(e) {
  var t = e.document.documentElement, n = Gr(e).on("dragstart.drag", Ql, Yc);
  "onselectstart" in t ? n.on("selectstart.drag", Ql, Yc) : (t.__noselect = t.style.MozUserSelect, t.style.MozUserSelect = "none");
}
function w9(e, t) {
  var n = e.document.documentElement, r = Gr(e).on("dragstart.drag", null);
  t && (r.on("click.drag", Ql, Yc), setTimeout(function() {
    r.on("click.drag", null);
  }, 0)), "onselectstart" in n ? r.on("selectstart.drag", null) : (n.style.MozUserSelect = n.__noselect, delete n.__noselect);
}
const Bf = (e) => () => e;
function t2(e, {
  sourceEvent: t,
  subject: n,
  target: r,
  identifier: a,
  active: o,
  x: l,
  y: u,
  dx: f,
  dy: d,
  dispatch: m
}) {
  Object.defineProperties(this, {
    type: { value: e, enumerable: !0, configurable: !0 },
    sourceEvent: { value: t, enumerable: !0, configurable: !0 },
    subject: { value: n, enumerable: !0, configurable: !0 },
    target: { value: r, enumerable: !0, configurable: !0 },
    identifier: { value: a, enumerable: !0, configurable: !0 },
    active: { value: o, enumerable: !0, configurable: !0 },
    x: { value: l, enumerable: !0, configurable: !0 },
    y: { value: u, enumerable: !0, configurable: !0 },
    dx: { value: f, enumerable: !0, configurable: !0 },
    dy: { value: d, enumerable: !0, configurable: !0 },
    _: { value: m }
  });
}
t2.prototype.on = function() {
  var e = this._.on.apply(this._, arguments);
  return e === this._ ? this : e;
};
function JG(e) {
  return !e.ctrlKey && !e.button;
}
function eV() {
  return this.parentNode;
}
function tV(e, t) {
  return t ?? { x: e.x, y: e.y };
}
function nV() {
  return navigator.maxTouchPoints || "ontouchstart" in this;
}
function _9() {
  var e = JG, t = eV, n = tV, r = nV, a = {}, o = Yh("start", "drag", "end"), l = 0, u, f, d, m, p = 0;
  function x(A) {
    A.on("mousedown.drag", y).filter(r).on("touchstart.drag", k).on("touchmove.drag", C, ZG).on("touchend.drag touchcancel.drag", T).style("touch-action", "none").style("-webkit-tap-highlight-color", "rgba(0,0,0,0)");
  }
  function y(A, D) {
    if (!(m || !e.call(this, A, D))) {
      var M = N(this, t.call(this, A, D), A, D, "mouse");
      M && (Gr(A.view).on("mousemove.drag", w, Yc).on("mouseup.drag", E, Yc), b9(A.view), Qg(A), d = !1, u = A.clientX, f = A.clientY, M("start", A));
    }
  }
  function w(A) {
    if (Ql(A), !d) {
      var D = A.clientX - u, M = A.clientY - f;
      d = D * D + M * M > p;
    }
    a.mouse("drag", A);
  }
  function E(A) {
    Gr(A.view).on("mousemove.drag mouseup.drag", null), w9(A.view, d), Ql(A), a.mouse("end", A);
  }
  function k(A, D) {
    if (e.call(this, A, D)) {
      var M = A.changedTouches, O = t.call(this, A, D), Y = M.length, X, U;
      for (X = 0; X < Y; ++X)
        (U = N(this, O, A, D, M[X].identifier, M[X])) && (Qg(A), U("start", A, M[X]));
    }
  }
  function C(A) {
    var D = A.changedTouches, M = D.length, O, Y;
    for (O = 0; O < M; ++O)
      (Y = a[D[O].identifier]) && (Ql(A), Y("drag", A, D[O]));
  }
  function T(A) {
    var D = A.changedTouches, M = D.length, O, Y;
    for (m && clearTimeout(m), m = setTimeout(function() {
      m = null;
    }, 500), O = 0; O < M; ++O)
      (Y = a[D[O].identifier]) && (Qg(A), Y("end", A, D[O]));
  }
  function N(A, D, M, O, Y, X) {
    var U = o.copy(), B = Ci(X || M, D), G, re, q;
    if ((q = n.call(A, new t2("beforestart", {
      sourceEvent: M,
      target: x,
      identifier: Y,
      active: l,
      x: B[0],
      y: B[1],
      dx: 0,
      dy: 0,
      dispatch: U
    }), O)) != null)
      return G = q.x - B[0] || 0, re = q.y - B[1] || 0, function W(V, ee, te) {
        var ie = B, H;
        switch (V) {
          case "start":
            a[Y] = W, H = l++;
            break;
          case "end":
            delete a[Y], --l;
          // falls through
          case "drag":
            B = Ci(te || ee, D), H = l;
            break;
        }
        U.call(
          V,
          A,
          new t2(V, {
            sourceEvent: ee,
            subject: q,
            target: x,
            identifier: Y,
            active: H,
            x: B[0] + G,
            y: B[1] + re,
            dx: B[0] - ie[0],
            dy: B[1] - ie[1],
            dispatch: U
          }),
          O
        );
      };
  }
  return x.filter = function(A) {
    return arguments.length ? (e = typeof A == "function" ? A : Bf(!!A), x) : e;
  }, x.container = function(A) {
    return arguments.length ? (t = typeof A == "function" ? A : Bf(A), x) : t;
  }, x.subject = function(A) {
    return arguments.length ? (n = typeof A == "function" ? A : Bf(A), x) : n;
  }, x.touchable = function(A) {
    return arguments.length ? (r = typeof A == "function" ? A : Bf(!!A), x) : r;
  }, x.on = function() {
    var A = o.on.apply(o, arguments);
    return A === o ? x : A;
  }, x.clickDistance = function(A) {
    return arguments.length ? (p = (A = +A) * A, x) : Math.sqrt(p);
  }, x;
}
function Z2(e, t, n) {
  e.prototype = t.prototype = n, n.constructor = e;
}
function S9(e, t) {
  var n = Object.create(e.prototype);
  for (var r in t) n[r] = t[r];
  return n;
}
function cd() {
}
var Xc = 0.7, _h = 1 / Xc, Zl = "\\s*([+-]?\\d+)\\s*", Wc = "\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*", ea = "\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*", rV = /^#([0-9a-f]{3,8})$/, iV = new RegExp(`^rgb\\(${Zl},${Zl},${Zl}\\)$`), aV = new RegExp(`^rgb\\(${ea},${ea},${ea}\\)$`), sV = new RegExp(`^rgba\\(${Zl},${Zl},${Zl},${Wc}\\)$`), oV = new RegExp(`^rgba\\(${ea},${ea},${ea},${Wc}\\)$`), lV = new RegExp(`^hsl\\(${Wc},${ea},${ea}\\)$`), uV = new RegExp(`^hsla\\(${Wc},${ea},${ea},${Wc}\\)$`), RS = {
  aliceblue: 15792383,
  antiquewhite: 16444375,
  aqua: 65535,
  aquamarine: 8388564,
  azure: 15794175,
  beige: 16119260,
  bisque: 16770244,
  black: 0,
  blanchedalmond: 16772045,
  blue: 255,
  blueviolet: 9055202,
  brown: 10824234,
  burlywood: 14596231,
  cadetblue: 6266528,
  chartreuse: 8388352,
  chocolate: 13789470,
  coral: 16744272,
  cornflowerblue: 6591981,
  cornsilk: 16775388,
  crimson: 14423100,
  cyan: 65535,
  darkblue: 139,
  darkcyan: 35723,
  darkgoldenrod: 12092939,
  darkgray: 11119017,
  darkgreen: 25600,
  darkgrey: 11119017,
  darkkhaki: 12433259,
  darkmagenta: 9109643,
  darkolivegreen: 5597999,
  darkorange: 16747520,
  darkorchid: 10040012,
  darkred: 9109504,
  darksalmon: 15308410,
  darkseagreen: 9419919,
  darkslateblue: 4734347,
  darkslategray: 3100495,
  darkslategrey: 3100495,
  darkturquoise: 52945,
  darkviolet: 9699539,
  deeppink: 16716947,
  deepskyblue: 49151,
  dimgray: 6908265,
  dimgrey: 6908265,
  dodgerblue: 2003199,
  firebrick: 11674146,
  floralwhite: 16775920,
  forestgreen: 2263842,
  fuchsia: 16711935,
  gainsboro: 14474460,
  ghostwhite: 16316671,
  gold: 16766720,
  goldenrod: 14329120,
  gray: 8421504,
  green: 32768,
  greenyellow: 11403055,
  grey: 8421504,
  honeydew: 15794160,
  hotpink: 16738740,
  indianred: 13458524,
  indigo: 4915330,
  ivory: 16777200,
  khaki: 15787660,
  lavender: 15132410,
  lavenderblush: 16773365,
  lawngreen: 8190976,
  lemonchiffon: 16775885,
  lightblue: 11393254,
  lightcoral: 15761536,
  lightcyan: 14745599,
  lightgoldenrodyellow: 16448210,
  lightgray: 13882323,
  lightgreen: 9498256,
  lightgrey: 13882323,
  lightpink: 16758465,
  lightsalmon: 16752762,
  lightseagreen: 2142890,
  lightskyblue: 8900346,
  lightslategray: 7833753,
  lightslategrey: 7833753,
  lightsteelblue: 11584734,
  lightyellow: 16777184,
  lime: 65280,
  limegreen: 3329330,
  linen: 16445670,
  magenta: 16711935,
  maroon: 8388608,
  mediumaquamarine: 6737322,
  mediumblue: 205,
  mediumorchid: 12211667,
  mediumpurple: 9662683,
  mediumseagreen: 3978097,
  mediumslateblue: 8087790,
  mediumspringgreen: 64154,
  mediumturquoise: 4772300,
  mediumvioletred: 13047173,
  midnightblue: 1644912,
  mintcream: 16121850,
  mistyrose: 16770273,
  moccasin: 16770229,
  navajowhite: 16768685,
  navy: 128,
  oldlace: 16643558,
  olive: 8421376,
  olivedrab: 7048739,
  orange: 16753920,
  orangered: 16729344,
  orchid: 14315734,
  palegoldenrod: 15657130,
  palegreen: 10025880,
  paleturquoise: 11529966,
  palevioletred: 14381203,
  papayawhip: 16773077,
  peachpuff: 16767673,
  peru: 13468991,
  pink: 16761035,
  plum: 14524637,
  powderblue: 11591910,
  purple: 8388736,
  rebeccapurple: 6697881,
  red: 16711680,
  rosybrown: 12357519,
  royalblue: 4286945,
  saddlebrown: 9127187,
  salmon: 16416882,
  sandybrown: 16032864,
  seagreen: 3050327,
  seashell: 16774638,
  sienna: 10506797,
  silver: 12632256,
  skyblue: 8900331,
  slateblue: 6970061,
  slategray: 7372944,
  slategrey: 7372944,
  snow: 16775930,
  springgreen: 65407,
  steelblue: 4620980,
  tan: 13808780,
  teal: 32896,
  thistle: 14204888,
  tomato: 16737095,
  turquoise: 4251856,
  violet: 15631086,
  wheat: 16113331,
  white: 16777215,
  whitesmoke: 16119285,
  yellow: 16776960,
  yellowgreen: 10145074
};
Z2(cd, Do, {
  copy(e) {
    return Object.assign(new this.constructor(), this, e);
  },
  displayable() {
    return this.rgb().displayable();
  },
  hex: zS,
  // Deprecated! Use color.formatHex.
  formatHex: zS,
  formatHex8: cV,
  formatHsl: dV,
  formatRgb: OS,
  toString: OS
});
function zS() {
  return this.rgb().formatHex();
}
function cV() {
  return this.rgb().formatHex8();
}
function dV() {
  return C9(this).formatHsl();
}
function OS() {
  return this.rgb().formatRgb();
}
function Do(e) {
  var t, n;
  return e = (e + "").trim().toLowerCase(), (t = rV.exec(e)) ? (n = t[1].length, t = parseInt(t[1], 16), n === 6 ? DS(t) : n === 3 ? new Mr(t >> 8 & 15 | t >> 4 & 240, t >> 4 & 15 | t & 240, (t & 15) << 4 | t & 15, 1) : n === 8 ? Ff(t >> 24 & 255, t >> 16 & 255, t >> 8 & 255, (t & 255) / 255) : n === 4 ? Ff(t >> 12 & 15 | t >> 8 & 240, t >> 8 & 15 | t >> 4 & 240, t >> 4 & 15 | t & 240, ((t & 15) << 4 | t & 15) / 255) : null) : (t = iV.exec(e)) ? new Mr(t[1], t[2], t[3], 1) : (t = aV.exec(e)) ? new Mr(t[1] * 255 / 100, t[2] * 255 / 100, t[3] * 255 / 100, 1) : (t = sV.exec(e)) ? Ff(t[1], t[2], t[3], t[4]) : (t = oV.exec(e)) ? Ff(t[1] * 255 / 100, t[2] * 255 / 100, t[3] * 255 / 100, t[4]) : (t = lV.exec(e)) ? qS(t[1], t[2] / 100, t[3] / 100, 1) : (t = uV.exec(e)) ? qS(t[1], t[2] / 100, t[3] / 100, t[4]) : RS.hasOwnProperty(e) ? DS(RS[e]) : e === "transparent" ? new Mr(NaN, NaN, NaN, 0) : null;
}
function DS(e) {
  return new Mr(e >> 16 & 255, e >> 8 & 255, e & 255, 1);
}
function Ff(e, t, n, r) {
  return r <= 0 && (e = t = n = NaN), new Mr(e, t, n, r);
}
function fV(e) {
  return e instanceof cd || (e = Do(e)), e ? (e = e.rgb(), new Mr(e.r, e.g, e.b, e.opacity)) : new Mr();
}
function n2(e, t, n, r) {
  return arguments.length === 1 ? fV(e) : new Mr(e, t, n, r ?? 1);
}
function Mr(e, t, n, r) {
  this.r = +e, this.g = +t, this.b = +n, this.opacity = +r;
}
Z2(Mr, n2, S9(cd, {
  brighter(e) {
    return e = e == null ? _h : Math.pow(_h, e), new Mr(this.r * e, this.g * e, this.b * e, this.opacity);
  },
  darker(e) {
    return e = e == null ? Xc : Math.pow(Xc, e), new Mr(this.r * e, this.g * e, this.b * e, this.opacity);
  },
  rgb() {
    return this;
  },
  clamp() {
    return new Mr(Ao(this.r), Ao(this.g), Ao(this.b), Sh(this.opacity));
  },
  displayable() {
    return -0.5 <= this.r && this.r < 255.5 && -0.5 <= this.g && this.g < 255.5 && -0.5 <= this.b && this.b < 255.5 && 0 <= this.opacity && this.opacity <= 1;
  },
  hex: IS,
  // Deprecated! Use color.formatHex.
  formatHex: IS,
  formatHex8: hV,
  formatRgb: LS,
  toString: LS
}));
function IS() {
  return `#${ko(this.r)}${ko(this.g)}${ko(this.b)}`;
}
function hV() {
  return `#${ko(this.r)}${ko(this.g)}${ko(this.b)}${ko((isNaN(this.opacity) ? 1 : this.opacity) * 255)}`;
}
function LS() {
  const e = Sh(this.opacity);
  return `${e === 1 ? "rgb(" : "rgba("}${Ao(this.r)}, ${Ao(this.g)}, ${Ao(this.b)}${e === 1 ? ")" : `, ${e})`}`;
}
function Sh(e) {
  return isNaN(e) ? 1 : Math.max(0, Math.min(1, e));
}
function Ao(e) {
  return Math.max(0, Math.min(255, Math.round(e) || 0));
}
function ko(e) {
  return e = Ao(e), (e < 16 ? "0" : "") + e.toString(16);
}
function qS(e, t, n, r) {
  return r <= 0 ? e = t = n = NaN : n <= 0 || n >= 1 ? e = t = NaN : t <= 0 && (e = NaN), new ki(e, t, n, r);
}
function C9(e) {
  if (e instanceof ki) return new ki(e.h, e.s, e.l, e.opacity);
  if (e instanceof cd || (e = Do(e)), !e) return new ki();
  if (e instanceof ki) return e;
  e = e.rgb();
  var t = e.r / 255, n = e.g / 255, r = e.b / 255, a = Math.min(t, n, r), o = Math.max(t, n, r), l = NaN, u = o - a, f = (o + a) / 2;
  return u ? (t === o ? l = (n - r) / u + (n < r) * 6 : n === o ? l = (r - t) / u + 2 : l = (t - n) / u + 4, u /= f < 0.5 ? o + a : 2 - o - a, l *= 60) : u = f > 0 && f < 1 ? 0 : l, new ki(l, u, f, e.opacity);
}
function mV(e, t, n, r) {
  return arguments.length === 1 ? C9(e) : new ki(e, t, n, r ?? 1);
}
function ki(e, t, n, r) {
  this.h = +e, this.s = +t, this.l = +n, this.opacity = +r;
}
Z2(ki, mV, S9(cd, {
  brighter(e) {
    return e = e == null ? _h : Math.pow(_h, e), new ki(this.h, this.s, this.l * e, this.opacity);
  },
  darker(e) {
    return e = e == null ? Xc : Math.pow(Xc, e), new ki(this.h, this.s, this.l * e, this.opacity);
  },
  rgb() {
    var e = this.h % 360 + (this.h < 0) * 360, t = isNaN(e) || isNaN(this.s) ? 0 : this.s, n = this.l, r = n + (n < 0.5 ? n : 1 - n) * t, a = 2 * n - r;
    return new Mr(
      Zg(e >= 240 ? e - 240 : e + 120, a, r),
      Zg(e, a, r),
      Zg(e < 120 ? e + 240 : e - 120, a, r),
      this.opacity
    );
  },
  clamp() {
    return new ki(PS(this.h), $f(this.s), $f(this.l), Sh(this.opacity));
  },
  displayable() {
    return (0 <= this.s && this.s <= 1 || isNaN(this.s)) && 0 <= this.l && this.l <= 1 && 0 <= this.opacity && this.opacity <= 1;
  },
  formatHsl() {
    const e = Sh(this.opacity);
    return `${e === 1 ? "hsl(" : "hsla("}${PS(this.h)}, ${$f(this.s) * 100}%, ${$f(this.l) * 100}%${e === 1 ? ")" : `, ${e})`}`;
  }
}));
function PS(e) {
  return e = (e || 0) % 360, e < 0 ? e + 360 : e;
}
function $f(e) {
  return Math.max(0, Math.min(1, e || 0));
}
function Zg(e, t, n) {
  return (e < 60 ? t + (n - t) * e / 60 : e < 180 ? n : e < 240 ? t + (n - t) * (240 - e) / 60 : t) * 255;
}
const J2 = (e) => () => e;
function pV(e, t) {
  return function(n) {
    return e + n * t;
  };
}
function gV(e, t, n) {
  return e = Math.pow(e, n), t = Math.pow(t, n) - e, n = 1 / n, function(r) {
    return Math.pow(e + r * t, n);
  };
}
function yV(e) {
  return (e = +e) == 1 ? E9 : function(t, n) {
    return n - t ? gV(t, n, e) : J2(isNaN(t) ? n : t);
  };
}
function E9(e, t) {
  var n = t - e;
  return n ? pV(e, n) : J2(isNaN(e) ? t : e);
}
const Ch = (function e(t) {
  var n = yV(t);
  function r(a, o) {
    var l = n((a = n2(a)).r, (o = n2(o)).r), u = n(a.g, o.g), f = n(a.b, o.b), d = E9(a.opacity, o.opacity);
    return function(m) {
      return a.r = l(m), a.g = u(m), a.b = f(m), a.opacity = d(m), a + "";
    };
  }
  return r.gamma = e, r;
})(1);
function xV(e, t) {
  t || (t = []);
  var n = e ? Math.min(t.length, e.length) : 0, r = t.slice(), a;
  return function(o) {
    for (a = 0; a < n; ++a) r[a] = e[a] * (1 - o) + t[a] * o;
    return r;
  };
}
function vV(e) {
  return ArrayBuffer.isView(e) && !(e instanceof DataView);
}
function bV(e, t) {
  var n = t ? t.length : 0, r = e ? Math.min(n, e.length) : 0, a = new Array(r), o = new Array(n), l;
  for (l = 0; l < r; ++l) a[l] = Fc(e[l], t[l]);
  for (; l < n; ++l) o[l] = t[l];
  return function(u) {
    for (l = 0; l < r; ++l) o[l] = a[l](u);
    return o;
  };
}
function wV(e, t) {
  var n = /* @__PURE__ */ new Date();
  return e = +e, t = +t, function(r) {
    return n.setTime(e * (1 - r) + t * r), n;
  };
}
function Xi(e, t) {
  return e = +e, t = +t, function(n) {
    return e * (1 - n) + t * n;
  };
}
function _V(e, t) {
  var n = {}, r = {}, a;
  (e === null || typeof e != "object") && (e = {}), (t === null || typeof t != "object") && (t = {});
  for (a in t)
    a in e ? n[a] = Fc(e[a], t[a]) : r[a] = t[a];
  return function(o) {
    for (a in n) r[a] = n[a](o);
    return r;
  };
}
var r2 = /[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g, Jg = new RegExp(r2.source, "g");
function SV(e) {
  return function() {
    return e;
  };
}
function CV(e) {
  return function(t) {
    return e(t) + "";
  };
}
function k9(e, t) {
  var n = r2.lastIndex = Jg.lastIndex = 0, r, a, o, l = -1, u = [], f = [];
  for (e = e + "", t = t + ""; (r = r2.exec(e)) && (a = Jg.exec(t)); )
    (o = a.index) > n && (o = t.slice(n, o), u[l] ? u[l] += o : u[++l] = o), (r = r[0]) === (a = a[0]) ? u[l] ? u[l] += a : u[++l] = a : (u[++l] = null, f.push({ i: l, x: Xi(r, a) })), n = Jg.lastIndex;
  return n < t.length && (o = t.slice(n), u[l] ? u[l] += o : u[++l] = o), u.length < 2 ? f[0] ? CV(f[0].x) : SV(t) : (t = f.length, function(d) {
    for (var m = 0, p; m < t; ++m) u[(p = f[m]).i] = p.x(d);
    return u.join("");
  });
}
function Fc(e, t) {
  var n = typeof t, r;
  return t == null || n === "boolean" ? J2(t) : (n === "number" ? Xi : n === "string" ? (r = Do(t)) ? (t = r, Ch) : k9 : t instanceof Do ? Ch : t instanceof Date ? wV : vV(t) ? xV : Array.isArray(t) ? bV : typeof t.valueOf != "function" && typeof t.toString != "function" || isNaN(t) ? _V : Xi)(e, t);
}
var BS = 180 / Math.PI, i2 = {
  translateX: 0,
  translateY: 0,
  rotate: 0,
  skewX: 0,
  scaleX: 1,
  scaleY: 1
};
function N9(e, t, n, r, a, o) {
  var l, u, f;
  return (l = Math.sqrt(e * e + t * t)) && (e /= l, t /= l), (f = e * n + t * r) && (n -= e * f, r -= t * f), (u = Math.sqrt(n * n + r * r)) && (n /= u, r /= u, f /= u), e * r < t * n && (e = -e, t = -t, f = -f, l = -l), {
    translateX: a,
    translateY: o,
    rotate: Math.atan2(t, e) * BS,
    skewX: Math.atan(f) * BS,
    scaleX: l,
    scaleY: u
  };
}
var Uf;
function EV(e) {
  const t = new (typeof DOMMatrix == "function" ? DOMMatrix : WebKitCSSMatrix)(e + "");
  return t.isIdentity ? i2 : N9(t.a, t.b, t.c, t.d, t.e, t.f);
}
function kV(e) {
  return e == null || (Uf || (Uf = document.createElementNS("http://www.w3.org/2000/svg", "g")), Uf.setAttribute("transform", e), !(e = Uf.transform.baseVal.consolidate())) ? i2 : (e = e.matrix, N9(e.a, e.b, e.c, e.d, e.e, e.f));
}
function j9(e, t, n, r) {
  function a(d) {
    return d.length ? d.pop() + " " : "";
  }
  function o(d, m, p, x, y, w) {
    if (d !== p || m !== x) {
      var E = y.push("translate(", null, t, null, n);
      w.push({ i: E - 4, x: Xi(d, p) }, { i: E - 2, x: Xi(m, x) });
    } else (p || x) && y.push("translate(" + p + t + x + n);
  }
  function l(d, m, p, x) {
    d !== m ? (d - m > 180 ? m += 360 : m - d > 180 && (d += 360), x.push({ i: p.push(a(p) + "rotate(", null, r) - 2, x: Xi(d, m) })) : m && p.push(a(p) + "rotate(" + m + r);
  }
  function u(d, m, p, x) {
    d !== m ? x.push({ i: p.push(a(p) + "skewX(", null, r) - 2, x: Xi(d, m) }) : m && p.push(a(p) + "skewX(" + m + r);
  }
  function f(d, m, p, x, y, w) {
    if (d !== p || m !== x) {
      var E = y.push(a(y) + "scale(", null, ",", null, ")");
      w.push({ i: E - 4, x: Xi(d, p) }, { i: E - 2, x: Xi(m, x) });
    } else (p !== 1 || x !== 1) && y.push(a(y) + "scale(" + p + "," + x + ")");
  }
  return function(d, m) {
    var p = [], x = [];
    return d = e(d), m = e(m), o(d.translateX, d.translateY, m.translateX, m.translateY, p, x), l(d.rotate, m.rotate, p, x), u(d.skewX, m.skewX, p, x), f(d.scaleX, d.scaleY, m.scaleX, m.scaleY, p, x), d = m = null, function(y) {
      for (var w = -1, E = x.length, k; ++w < E; ) p[(k = x[w]).i] = k.x(y);
      return p.join("");
    };
  };
}
var NV = j9(EV, "px, ", "px)", "deg)"), jV = j9(kV, ", ", ")", ")"), TV = 1e-12;
function FS(e) {
  return ((e = Math.exp(e)) + 1 / e) / 2;
}
function AV(e) {
  return ((e = Math.exp(e)) - 1 / e) / 2;
}
function MV(e) {
  return ((e = Math.exp(2 * e)) - 1) / (e + 1);
}
const rh = (function e(t, n, r) {
  function a(o, l) {
    var u = o[0], f = o[1], d = o[2], m = l[0], p = l[1], x = l[2], y = m - u, w = p - f, E = y * y + w * w, k, C;
    if (E < TV)
      C = Math.log(x / d) / t, k = function(O) {
        return [
          u + O * y,
          f + O * w,
          d * Math.exp(t * O * C)
        ];
      };
    else {
      var T = Math.sqrt(E), N = (x * x - d * d + r * E) / (2 * d * n * T), A = (x * x - d * d - r * E) / (2 * x * n * T), D = Math.log(Math.sqrt(N * N + 1) - N), M = Math.log(Math.sqrt(A * A + 1) - A);
      C = (M - D) / t, k = function(O) {
        var Y = O * C, X = FS(D), U = d / (n * T) * (X * MV(t * Y + D) - AV(D));
        return [
          u + U * y,
          f + U * w,
          d * X / FS(t * Y + D)
        ];
      };
    }
    return k.duration = C * 1e3 * t / Math.SQRT2, k;
  }
  return a.rho = function(o) {
    var l = Math.max(1e-3, +o), u = l * l, f = u * u;
    return e(l, u, f);
  }, a;
})(Math.SQRT2, 2, 4);
var nu = 0, Ac = 0, kc = 0, T9 = 1e3, Eh, Mc, kh = 0, Io = 0, Wh = 0, Qc = typeof performance == "object" && performance.now ? performance : Date, A9 = typeof window == "object" && window.requestAnimationFrame ? window.requestAnimationFrame.bind(window) : function(e) {
  setTimeout(e, 17);
};
function ew() {
  return Io || (A9(RV), Io = Qc.now() + Wh);
}
function RV() {
  Io = 0;
}
function Nh() {
  this._call = this._time = this._next = null;
}
Nh.prototype = M9.prototype = {
  constructor: Nh,
  restart: function(e, t, n) {
    if (typeof e != "function") throw new TypeError("callback is not a function");
    n = (n == null ? ew() : +n) + (t == null ? 0 : +t), !this._next && Mc !== this && (Mc ? Mc._next = this : Eh = this, Mc = this), this._call = e, this._time = n, a2();
  },
  stop: function() {
    this._call && (this._call = null, this._time = 1 / 0, a2());
  }
};
function M9(e, t, n) {
  var r = new Nh();
  return r.restart(e, t, n), r;
}
function zV() {
  ew(), ++nu;
  for (var e = Eh, t; e; )
    (t = Io - e._time) >= 0 && e._call.call(void 0, t), e = e._next;
  --nu;
}
function $S() {
  Io = (kh = Qc.now()) + Wh, nu = Ac = 0;
  try {
    zV();
  } finally {
    nu = 0, DV(), Io = 0;
  }
}
function OV() {
  var e = Qc.now(), t = e - kh;
  t > T9 && (Wh -= t, kh = e);
}
function DV() {
  for (var e, t = Eh, n, r = 1 / 0; t; )
    t._call ? (r > t._time && (r = t._time), e = t, t = t._next) : (n = t._next, t._next = null, t = e ? e._next = n : Eh = n);
  Mc = e, a2(r);
}
function a2(e) {
  if (!nu) {
    Ac && (Ac = clearTimeout(Ac));
    var t = e - Io;
    t > 24 ? (e < 1 / 0 && (Ac = setTimeout($S, e - Qc.now() - Wh)), kc && (kc = clearInterval(kc))) : (kc || (kh = Qc.now(), kc = setInterval(OV, T9)), nu = 1, A9($S));
  }
}
function US(e, t, n) {
  var r = new Nh();
  return t = t == null ? 0 : +t, r.restart((a) => {
    r.stop(), e(a + t);
  }, t, n), r;
}
var IV = Yh("start", "end", "cancel", "interrupt"), LV = [], R9 = 0, HS = 1, s2 = 2, ih = 3, GS = 4, o2 = 5, ah = 6;
function Qh(e, t, n, r, a, o) {
  var l = e.__transition;
  if (!l) e.__transition = {};
  else if (n in l) return;
  qV(e, n, {
    name: t,
    index: r,
    // For context during callback.
    group: a,
    // For context during callback.
    on: IV,
    tween: LV,
    time: o.time,
    delay: o.delay,
    duration: o.duration,
    ease: o.ease,
    timer: null,
    state: R9
  });
}
function tw(e, t) {
  var n = Oi(e, t);
  if (n.state > R9) throw new Error("too late; already scheduled");
  return n;
}
function ra(e, t) {
  var n = Oi(e, t);
  if (n.state > ih) throw new Error("too late; already running");
  return n;
}
function Oi(e, t) {
  var n = e.__transition;
  if (!n || !(n = n[t])) throw new Error("transition not found");
  return n;
}
function qV(e, t, n) {
  var r = e.__transition, a;
  r[t] = n, n.timer = M9(o, 0, n.time);
  function o(d) {
    n.state = HS, n.timer.restart(l, n.delay, n.time), n.delay <= d && l(d - n.delay);
  }
  function l(d) {
    var m, p, x, y;
    if (n.state !== HS) return f();
    for (m in r)
      if (y = r[m], y.name === n.name) {
        if (y.state === ih) return US(l);
        y.state === GS ? (y.state = ah, y.timer.stop(), y.on.call("interrupt", e, e.__data__, y.index, y.group), delete r[m]) : +m < t && (y.state = ah, y.timer.stop(), y.on.call("cancel", e, e.__data__, y.index, y.group), delete r[m]);
      }
    if (US(function() {
      n.state === ih && (n.state = GS, n.timer.restart(u, n.delay, n.time), u(d));
    }), n.state = s2, n.on.call("start", e, e.__data__, n.index, n.group), n.state === s2) {
      for (n.state = ih, a = new Array(x = n.tween.length), m = 0, p = -1; m < x; ++m)
        (y = n.tween[m].value.call(e, e.__data__, n.index, n.group)) && (a[++p] = y);
      a.length = p + 1;
    }
  }
  function u(d) {
    for (var m = d < n.duration ? n.ease.call(null, d / n.duration) : (n.timer.restart(f), n.state = o2, 1), p = -1, x = a.length; ++p < x; )
      a[p].call(e, m);
    n.state === o2 && (n.on.call("end", e, e.__data__, n.index, n.group), f());
  }
  function f() {
    n.state = ah, n.timer.stop(), delete r[t];
    for (var d in r) return;
    delete e.__transition;
  }
}
function sh(e, t) {
  var n = e.__transition, r, a, o = !0, l;
  if (n) {
    t = t == null ? null : t + "";
    for (l in n) {
      if ((r = n[l]).name !== t) {
        o = !1;
        continue;
      }
      a = r.state > s2 && r.state < o2, r.state = ah, r.timer.stop(), r.on.call(a ? "interrupt" : "cancel", e, e.__data__, r.index, r.group), delete n[l];
    }
    o && delete e.__transition;
  }
}
function PV(e) {
  return this.each(function() {
    sh(this, e);
  });
}
function BV(e, t) {
  var n, r;
  return function() {
    var a = ra(this, e), o = a.tween;
    if (o !== n) {
      r = n = o;
      for (var l = 0, u = r.length; l < u; ++l)
        if (r[l].name === t) {
          r = r.slice(), r.splice(l, 1);
          break;
        }
    }
    a.tween = r;
  };
}
function FV(e, t, n) {
  var r, a;
  if (typeof n != "function") throw new Error();
  return function() {
    var o = ra(this, e), l = o.tween;
    if (l !== r) {
      a = (r = l).slice();
      for (var u = { name: t, value: n }, f = 0, d = a.length; f < d; ++f)
        if (a[f].name === t) {
          a[f] = u;
          break;
        }
      f === d && a.push(u);
    }
    o.tween = a;
  };
}
function $V(e, t) {
  var n = this._id;
  if (e += "", arguments.length < 2) {
    for (var r = Oi(this.node(), n).tween, a = 0, o = r.length, l; a < o; ++a)
      if ((l = r[a]).name === e)
        return l.value;
    return null;
  }
  return this.each((t == null ? BV : FV)(n, e, t));
}
function nw(e, t, n) {
  var r = e._id;
  return e.each(function() {
    var a = ra(this, r);
    (a.value || (a.value = {}))[t] = n.apply(this, arguments);
  }), function(a) {
    return Oi(a, r).value[t];
  };
}
function z9(e, t) {
  var n;
  return (typeof t == "number" ? Xi : t instanceof Do ? Ch : (n = Do(t)) ? (t = n, Ch) : k9)(e, t);
}
function UV(e) {
  return function() {
    this.removeAttribute(e);
  };
}
function HV(e) {
  return function() {
    this.removeAttributeNS(e.space, e.local);
  };
}
function GV(e, t, n) {
  var r, a = n + "", o;
  return function() {
    var l = this.getAttribute(e);
    return l === a ? null : l === r ? o : o = t(r = l, n);
  };
}
function VV(e, t, n) {
  var r, a = n + "", o;
  return function() {
    var l = this.getAttributeNS(e.space, e.local);
    return l === a ? null : l === r ? o : o = t(r = l, n);
  };
}
function KV(e, t, n) {
  var r, a, o;
  return function() {
    var l, u = n(this), f;
    return u == null ? void this.removeAttribute(e) : (l = this.getAttribute(e), f = u + "", l === f ? null : l === r && f === a ? o : (a = f, o = t(r = l, u)));
  };
}
function YV(e, t, n) {
  var r, a, o;
  return function() {
    var l, u = n(this), f;
    return u == null ? void this.removeAttributeNS(e.space, e.local) : (l = this.getAttributeNS(e.space, e.local), f = u + "", l === f ? null : l === r && f === a ? o : (a = f, o = t(r = l, u)));
  };
}
function XV(e, t) {
  var n = Xh(e), r = n === "transform" ? jV : z9;
  return this.attrTween(e, typeof t == "function" ? (n.local ? YV : KV)(n, r, nw(this, "attr." + e, t)) : t == null ? (n.local ? HV : UV)(n) : (n.local ? VV : GV)(n, r, t));
}
function WV(e, t) {
  return function(n) {
    this.setAttribute(e, t.call(this, n));
  };
}
function QV(e, t) {
  return function(n) {
    this.setAttributeNS(e.space, e.local, t.call(this, n));
  };
}
function ZV(e, t) {
  var n, r;
  function a() {
    var o = t.apply(this, arguments);
    return o !== r && (n = (r = o) && QV(e, o)), n;
  }
  return a._value = t, a;
}
function JV(e, t) {
  var n, r;
  function a() {
    var o = t.apply(this, arguments);
    return o !== r && (n = (r = o) && WV(e, o)), n;
  }
  return a._value = t, a;
}
function eK(e, t) {
  var n = "attr." + e;
  if (arguments.length < 2) return (n = this.tween(n)) && n._value;
  if (t == null) return this.tween(n, null);
  if (typeof t != "function") throw new Error();
  var r = Xh(e);
  return this.tween(n, (r.local ? ZV : JV)(r, t));
}
function tK(e, t) {
  return function() {
    tw(this, e).delay = +t.apply(this, arguments);
  };
}
function nK(e, t) {
  return t = +t, function() {
    tw(this, e).delay = t;
  };
}
function rK(e) {
  var t = this._id;
  return arguments.length ? this.each((typeof e == "function" ? tK : nK)(t, e)) : Oi(this.node(), t).delay;
}
function iK(e, t) {
  return function() {
    ra(this, e).duration = +t.apply(this, arguments);
  };
}
function aK(e, t) {
  return t = +t, function() {
    ra(this, e).duration = t;
  };
}
function sK(e) {
  var t = this._id;
  return arguments.length ? this.each((typeof e == "function" ? iK : aK)(t, e)) : Oi(this.node(), t).duration;
}
function oK(e, t) {
  if (typeof t != "function") throw new Error();
  return function() {
    ra(this, e).ease = t;
  };
}
function lK(e) {
  var t = this._id;
  return arguments.length ? this.each(oK(t, e)) : Oi(this.node(), t).ease;
}
function uK(e, t) {
  return function() {
    var n = t.apply(this, arguments);
    if (typeof n != "function") throw new Error();
    ra(this, e).ease = n;
  };
}
function cK(e) {
  if (typeof e != "function") throw new Error();
  return this.each(uK(this._id, e));
}
function dK(e) {
  typeof e != "function" && (e = c9(e));
  for (var t = this._groups, n = t.length, r = new Array(n), a = 0; a < n; ++a)
    for (var o = t[a], l = o.length, u = r[a] = [], f, d = 0; d < l; ++d)
      (f = o[d]) && e.call(f, f.__data__, d, o) && u.push(f);
  return new Va(r, this._parents, this._name, this._id);
}
function fK(e) {
  if (e._id !== this._id) throw new Error();
  for (var t = this._groups, n = e._groups, r = t.length, a = n.length, o = Math.min(r, a), l = new Array(r), u = 0; u < o; ++u)
    for (var f = t[u], d = n[u], m = f.length, p = l[u] = new Array(m), x, y = 0; y < m; ++y)
      (x = f[y] || d[y]) && (p[y] = x);
  for (; u < r; ++u)
    l[u] = t[u];
  return new Va(l, this._parents, this._name, this._id);
}
function hK(e) {
  return (e + "").trim().split(/^|\s+/).every(function(t) {
    var n = t.indexOf(".");
    return n >= 0 && (t = t.slice(0, n)), !t || t === "start";
  });
}
function mK(e, t, n) {
  var r, a, o = hK(t) ? tw : ra;
  return function() {
    var l = o(this, e), u = l.on;
    u !== r && (a = (r = u).copy()).on(t, n), l.on = a;
  };
}
function pK(e, t) {
  var n = this._id;
  return arguments.length < 2 ? Oi(this.node(), n).on.on(e) : this.each(mK(n, e, t));
}
function gK(e) {
  return function() {
    var t = this.parentNode;
    for (var n in this.__transition) if (+n !== e) return;
    t && t.removeChild(this);
  };
}
function yK() {
  return this.on("end.remove", gK(this._id));
}
function xK(e) {
  var t = this._name, n = this._id;
  typeof e != "function" && (e = W2(e));
  for (var r = this._groups, a = r.length, o = new Array(a), l = 0; l < a; ++l)
    for (var u = r[l], f = u.length, d = o[l] = new Array(f), m, p, x = 0; x < f; ++x)
      (m = u[x]) && (p = e.call(m, m.__data__, x, u)) && ("__data__" in m && (p.__data__ = m.__data__), d[x] = p, Qh(d[x], t, n, x, d, Oi(m, n)));
  return new Va(o, this._parents, t, n);
}
function vK(e) {
  var t = this._name, n = this._id;
  typeof e != "function" && (e = u9(e));
  for (var r = this._groups, a = r.length, o = [], l = [], u = 0; u < a; ++u)
    for (var f = r[u], d = f.length, m, p = 0; p < d; ++p)
      if (m = f[p]) {
        for (var x = e.call(m, m.__data__, p, f), y, w = Oi(m, n), E = 0, k = x.length; E < k; ++E)
          (y = x[E]) && Qh(y, t, n, E, x, w);
        o.push(x), l.push(m);
      }
  return new Va(o, l, t, n);
}
var bK = ud.prototype.constructor;
function wK() {
  return new bK(this._groups, this._parents);
}
function _K(e, t) {
  var n, r, a;
  return function() {
    var o = tu(this, e), l = (this.style.removeProperty(e), tu(this, e));
    return o === l ? null : o === n && l === r ? a : a = t(n = o, r = l);
  };
}
function O9(e) {
  return function() {
    this.style.removeProperty(e);
  };
}
function SK(e, t, n) {
  var r, a = n + "", o;
  return function() {
    var l = tu(this, e);
    return l === a ? null : l === r ? o : o = t(r = l, n);
  };
}
function CK(e, t, n) {
  var r, a, o;
  return function() {
    var l = tu(this, e), u = n(this), f = u + "";
    return u == null && (f = u = (this.style.removeProperty(e), tu(this, e))), l === f ? null : l === r && f === a ? o : (a = f, o = t(r = l, u));
  };
}
function EK(e, t) {
  var n, r, a, o = "style." + t, l = "end." + o, u;
  return function() {
    var f = ra(this, e), d = f.on, m = f.value[o] == null ? u || (u = O9(t)) : void 0;
    (d !== n || a !== m) && (r = (n = d).copy()).on(l, a = m), f.on = r;
  };
}
function kK(e, t, n) {
  var r = (e += "") == "transform" ? NV : z9;
  return t == null ? this.styleTween(e, _K(e, r)).on("end.style." + e, O9(e)) : typeof t == "function" ? this.styleTween(e, CK(e, r, nw(this, "style." + e, t))).each(EK(this._id, e)) : this.styleTween(e, SK(e, r, t), n).on("end.style." + e, null);
}
function NK(e, t, n) {
  return function(r) {
    this.style.setProperty(e, t.call(this, r), n);
  };
}
function jK(e, t, n) {
  var r, a;
  function o() {
    var l = t.apply(this, arguments);
    return l !== a && (r = (a = l) && NK(e, l, n)), r;
  }
  return o._value = t, o;
}
function TK(e, t, n) {
  var r = "style." + (e += "");
  if (arguments.length < 2) return (r = this.tween(r)) && r._value;
  if (t == null) return this.tween(r, null);
  if (typeof t != "function") throw new Error();
  return this.tween(r, jK(e, t, n ?? ""));
}
function AK(e) {
  return function() {
    this.textContent = e;
  };
}
function MK(e) {
  return function() {
    var t = e(this);
    this.textContent = t ?? "";
  };
}
function RK(e) {
  return this.tween("text", typeof e == "function" ? MK(nw(this, "text", e)) : AK(e == null ? "" : e + ""));
}
function zK(e) {
  return function(t) {
    this.textContent = e.call(this, t);
  };
}
function OK(e) {
  var t, n;
  function r() {
    var a = e.apply(this, arguments);
    return a !== n && (t = (n = a) && zK(a)), t;
  }
  return r._value = e, r;
}
function DK(e) {
  var t = "text";
  if (arguments.length < 1) return (t = this.tween(t)) && t._value;
  if (e == null) return this.tween(t, null);
  if (typeof e != "function") throw new Error();
  return this.tween(t, OK(e));
}
function IK() {
  for (var e = this._name, t = this._id, n = D9(), r = this._groups, a = r.length, o = 0; o < a; ++o)
    for (var l = r[o], u = l.length, f, d = 0; d < u; ++d)
      if (f = l[d]) {
        var m = Oi(f, t);
        Qh(f, e, n, d, l, {
          time: m.time + m.delay + m.duration,
          delay: 0,
          duration: m.duration,
          ease: m.ease
        });
      }
  return new Va(r, this._parents, e, n);
}
function LK() {
  var e, t, n = this, r = n._id, a = n.size();
  return new Promise(function(o, l) {
    var u = { value: l }, f = { value: function() {
      --a === 0 && o();
    } };
    n.each(function() {
      var d = ra(this, r), m = d.on;
      m !== e && (t = (e = m).copy(), t._.cancel.push(u), t._.interrupt.push(u), t._.end.push(f)), d.on = t;
    }), a === 0 && o();
  });
}
var qK = 0;
function Va(e, t, n, r) {
  this._groups = e, this._parents = t, this._name = n, this._id = r;
}
function D9() {
  return ++qK;
}
var Pa = ud.prototype;
Va.prototype = {
  constructor: Va,
  select: xK,
  selectAll: vK,
  selectChild: Pa.selectChild,
  selectChildren: Pa.selectChildren,
  filter: dK,
  merge: fK,
  selection: wK,
  transition: IK,
  call: Pa.call,
  nodes: Pa.nodes,
  node: Pa.node,
  size: Pa.size,
  empty: Pa.empty,
  each: Pa.each,
  on: pK,
  attr: XV,
  attrTween: eK,
  style: kK,
  styleTween: TK,
  text: RK,
  textTween: DK,
  remove: yK,
  tween: $V,
  delay: rK,
  duration: sK,
  ease: lK,
  easeVarying: cK,
  end: LK,
  [Symbol.iterator]: Pa[Symbol.iterator]
};
function PK(e) {
  return ((e *= 2) <= 1 ? e * e * e : (e -= 2) * e * e + 2) / 2;
}
var BK = {
  time: null,
  // Set on use.
  delay: 0,
  duration: 250,
  ease: PK
};
function FK(e, t) {
  for (var n; !(n = e.__transition) || !(n = n[t]); )
    if (!(e = e.parentNode))
      throw new Error(`transition ${t} not found`);
  return n;
}
function $K(e) {
  var t, n;
  e instanceof Va ? (t = e._id, e = e._name) : (t = D9(), (n = BK).time = ew(), e = e == null ? null : e + "");
  for (var r = this._groups, a = r.length, o = 0; o < a; ++o)
    for (var l = r[o], u = l.length, f, d = 0; d < u; ++d)
      (f = l[d]) && Qh(f, e, t, d, l, n || FK(f, t));
  return new Va(r, this._parents, e, t);
}
ud.prototype.interrupt = PV;
ud.prototype.transition = $K;
const Hf = (e) => () => e;
function UK(e, {
  sourceEvent: t,
  target: n,
  transform: r,
  dispatch: a
}) {
  Object.defineProperties(this, {
    type: { value: e, enumerable: !0, configurable: !0 },
    sourceEvent: { value: t, enumerable: !0, configurable: !0 },
    target: { value: n, enumerable: !0, configurable: !0 },
    transform: { value: r, enumerable: !0, configurable: !0 },
    _: { value: a }
  });
}
function Ha(e, t, n) {
  this.k = e, this.x = t, this.y = n;
}
Ha.prototype = {
  constructor: Ha,
  scale: function(e) {
    return e === 1 ? this : new Ha(this.k * e, this.x, this.y);
  },
  translate: function(e, t) {
    return e === 0 & t === 0 ? this : new Ha(this.k, this.x + this.k * e, this.y + this.k * t);
  },
  apply: function(e) {
    return [e[0] * this.k + this.x, e[1] * this.k + this.y];
  },
  applyX: function(e) {
    return e * this.k + this.x;
  },
  applyY: function(e) {
    return e * this.k + this.y;
  },
  invert: function(e) {
    return [(e[0] - this.x) / this.k, (e[1] - this.y) / this.k];
  },
  invertX: function(e) {
    return (e - this.x) / this.k;
  },
  invertY: function(e) {
    return (e - this.y) / this.k;
  },
  rescaleX: function(e) {
    return e.copy().domain(e.range().map(this.invertX, this).map(e.invert, e));
  },
  rescaleY: function(e) {
    return e.copy().domain(e.range().map(this.invertY, this).map(e.invert, e));
  },
  toString: function() {
    return "translate(" + this.x + "," + this.y + ") scale(" + this.k + ")";
  }
};
var Zh = new Ha(1, 0, 0);
I9.prototype = Ha.prototype;
function I9(e) {
  for (; !e.__zoom; ) if (!(e = e.parentNode)) return Zh;
  return e.__zoom;
}
function e0(e) {
  e.stopImmediatePropagation();
}
function Nc(e) {
  e.preventDefault(), e.stopImmediatePropagation();
}
function HK(e) {
  return (!e.ctrlKey || e.type === "wheel") && !e.button;
}
function GK() {
  var e = this;
  return e instanceof SVGElement ? (e = e.ownerSVGElement || e, e.hasAttribute("viewBox") ? (e = e.viewBox.baseVal, [[e.x, e.y], [e.x + e.width, e.y + e.height]]) : [[0, 0], [e.width.baseVal.value, e.height.baseVal.value]]) : [[0, 0], [e.clientWidth, e.clientHeight]];
}
function VS() {
  return this.__zoom || Zh;
}
function VK(e) {
  return -e.deltaY * (e.deltaMode === 1 ? 0.05 : e.deltaMode ? 1 : 2e-3) * (e.ctrlKey ? 10 : 1);
}
function KK() {
  return navigator.maxTouchPoints || "ontouchstart" in this;
}
function YK(e, t, n) {
  var r = e.invertX(t[0][0]) - n[0][0], a = e.invertX(t[1][0]) - n[1][0], o = e.invertY(t[0][1]) - n[0][1], l = e.invertY(t[1][1]) - n[1][1];
  return e.translate(
    a > r ? (r + a) / 2 : Math.min(0, r) || Math.max(0, a),
    l > o ? (o + l) / 2 : Math.min(0, o) || Math.max(0, l)
  );
}
function L9() {
  var e = HK, t = GK, n = YK, r = VK, a = KK, o = [0, 1 / 0], l = [[-1 / 0, -1 / 0], [1 / 0, 1 / 0]], u = 250, f = rh, d = Yh("start", "zoom", "end"), m, p, x, y = 500, w = 150, E = 0, k = 10;
  function C(q) {
    q.property("__zoom", VS).on("wheel.zoom", Y, { passive: !1 }).on("mousedown.zoom", X).on("dblclick.zoom", U).filter(a).on("touchstart.zoom", B).on("touchmove.zoom", G).on("touchend.zoom touchcancel.zoom", re).style("-webkit-tap-highlight-color", "rgba(0,0,0,0)");
  }
  C.transform = function(q, W, V, ee) {
    var te = q.selection ? q.selection() : q;
    te.property("__zoom", VS), q !== te ? D(q, W, V, ee) : te.interrupt().each(function() {
      M(this, arguments).event(ee).start().zoom(null, typeof W == "function" ? W.apply(this, arguments) : W).end();
    });
  }, C.scaleBy = function(q, W, V, ee) {
    C.scaleTo(q, function() {
      var te = this.__zoom.k, ie = typeof W == "function" ? W.apply(this, arguments) : W;
      return te * ie;
    }, V, ee);
  }, C.scaleTo = function(q, W, V, ee) {
    C.transform(q, function() {
      var te = t.apply(this, arguments), ie = this.__zoom, H = V == null ? A(te) : typeof V == "function" ? V.apply(this, arguments) : V, L = ie.invert(H), J = typeof W == "function" ? W.apply(this, arguments) : W;
      return n(N(T(ie, J), H, L), te, l);
    }, V, ee);
  }, C.translateBy = function(q, W, V, ee) {
    C.transform(q, function() {
      return n(this.__zoom.translate(
        typeof W == "function" ? W.apply(this, arguments) : W,
        typeof V == "function" ? V.apply(this, arguments) : V
      ), t.apply(this, arguments), l);
    }, null, ee);
  }, C.translateTo = function(q, W, V, ee, te) {
    C.transform(q, function() {
      var ie = t.apply(this, arguments), H = this.__zoom, L = ee == null ? A(ie) : typeof ee == "function" ? ee.apply(this, arguments) : ee;
      return n(Zh.translate(L[0], L[1]).scale(H.k).translate(
        typeof W == "function" ? -W.apply(this, arguments) : -W,
        typeof V == "function" ? -V.apply(this, arguments) : -V
      ), ie, l);
    }, ee, te);
  };
  function T(q, W) {
    return W = Math.max(o[0], Math.min(o[1], W)), W === q.k ? q : new Ha(W, q.x, q.y);
  }
  function N(q, W, V) {
    var ee = W[0] - V[0] * q.k, te = W[1] - V[1] * q.k;
    return ee === q.x && te === q.y ? q : new Ha(q.k, ee, te);
  }
  function A(q) {
    return [(+q[0][0] + +q[1][0]) / 2, (+q[0][1] + +q[1][1]) / 2];
  }
  function D(q, W, V, ee) {
    q.on("start.zoom", function() {
      M(this, arguments).event(ee).start();
    }).on("interrupt.zoom end.zoom", function() {
      M(this, arguments).event(ee).end();
    }).tween("zoom", function() {
      var te = this, ie = arguments, H = M(te, ie).event(ee), L = t.apply(te, ie), J = V == null ? A(L) : typeof V == "function" ? V.apply(te, ie) : V, F = Math.max(L[1][0] - L[0][0], L[1][1] - L[0][1]), Z = te.__zoom, oe = typeof W == "function" ? W.apply(te, ie) : W, fe = f(Z.invert(J).concat(F / Z.k), oe.invert(J).concat(F / oe.k));
      return function(Se) {
        if (Se === 1) Se = oe;
        else {
          var Te = fe(Se), we = F / Te[2];
          Se = new Ha(we, J[0] - Te[0] * we, J[1] - Te[1] * we);
        }
        H.zoom(null, Se);
      };
    });
  }
  function M(q, W, V) {
    return !V && q.__zooming || new O(q, W);
  }
  function O(q, W) {
    this.that = q, this.args = W, this.active = 0, this.sourceEvent = null, this.extent = t.apply(q, W), this.taps = 0;
  }
  O.prototype = {
    event: function(q) {
      return q && (this.sourceEvent = q), this;
    },
    start: function() {
      return ++this.active === 1 && (this.that.__zooming = this, this.emit("start")), this;
    },
    zoom: function(q, W) {
      return this.mouse && q !== "mouse" && (this.mouse[1] = W.invert(this.mouse[0])), this.touch0 && q !== "touch" && (this.touch0[1] = W.invert(this.touch0[0])), this.touch1 && q !== "touch" && (this.touch1[1] = W.invert(this.touch1[0])), this.that.__zoom = W, this.emit("zoom"), this;
    },
    end: function() {
      return --this.active === 0 && (delete this.that.__zooming, this.emit("end")), this;
    },
    emit: function(q) {
      var W = Gr(this.that).datum();
      d.call(
        q,
        this.that,
        new UK(q, {
          sourceEvent: this.sourceEvent,
          target: C,
          transform: this.that.__zoom,
          dispatch: d
        }),
        W
      );
    }
  };
  function Y(q, ...W) {
    if (!e.apply(this, arguments)) return;
    var V = M(this, W).event(q), ee = this.__zoom, te = Math.max(o[0], Math.min(o[1], ee.k * Math.pow(2, r.apply(this, arguments)))), ie = Ci(q);
    if (V.wheel)
      (V.mouse[0][0] !== ie[0] || V.mouse[0][1] !== ie[1]) && (V.mouse[1] = ee.invert(V.mouse[0] = ie)), clearTimeout(V.wheel);
    else {
      if (ee.k === te) return;
      V.mouse = [ie, ee.invert(ie)], sh(this), V.start();
    }
    Nc(q), V.wheel = setTimeout(H, w), V.zoom("mouse", n(N(T(ee, te), V.mouse[0], V.mouse[1]), V.extent, l));
    function H() {
      V.wheel = null, V.end();
    }
  }
  function X(q, ...W) {
    if (x || !e.apply(this, arguments)) return;
    var V = q.currentTarget, ee = M(this, W, !0).event(q), te = Gr(q.view).on("mousemove.zoom", J, !0).on("mouseup.zoom", F, !0), ie = Ci(q, V), H = q.clientX, L = q.clientY;
    b9(q.view), e0(q), ee.mouse = [ie, this.__zoom.invert(ie)], sh(this), ee.start();
    function J(Z) {
      if (Nc(Z), !ee.moved) {
        var oe = Z.clientX - H, fe = Z.clientY - L;
        ee.moved = oe * oe + fe * fe > E;
      }
      ee.event(Z).zoom("mouse", n(N(ee.that.__zoom, ee.mouse[0] = Ci(Z, V), ee.mouse[1]), ee.extent, l));
    }
    function F(Z) {
      te.on("mousemove.zoom mouseup.zoom", null), w9(Z.view, ee.moved), Nc(Z), ee.event(Z).end();
    }
  }
  function U(q, ...W) {
    if (e.apply(this, arguments)) {
      var V = this.__zoom, ee = Ci(q.changedTouches ? q.changedTouches[0] : q, this), te = V.invert(ee), ie = V.k * (q.shiftKey ? 0.5 : 2), H = n(N(T(V, ie), ee, te), t.apply(this, W), l);
      Nc(q), u > 0 ? Gr(this).transition().duration(u).call(D, H, ee, q) : Gr(this).call(C.transform, H, ee, q);
    }
  }
  function B(q, ...W) {
    if (e.apply(this, arguments)) {
      var V = q.touches, ee = V.length, te = M(this, W, q.changedTouches.length === ee).event(q), ie, H, L, J;
      for (e0(q), H = 0; H < ee; ++H)
        L = V[H], J = Ci(L, this), J = [J, this.__zoom.invert(J), L.identifier], te.touch0 ? !te.touch1 && te.touch0[2] !== J[2] && (te.touch1 = J, te.taps = 0) : (te.touch0 = J, ie = !0, te.taps = 1 + !!m);
      m && (m = clearTimeout(m)), ie && (te.taps < 2 && (p = J[0], m = setTimeout(function() {
        m = null;
      }, y)), sh(this), te.start());
    }
  }
  function G(q, ...W) {
    if (this.__zooming) {
      var V = M(this, W).event(q), ee = q.changedTouches, te = ee.length, ie, H, L, J;
      for (Nc(q), ie = 0; ie < te; ++ie)
        H = ee[ie], L = Ci(H, this), V.touch0 && V.touch0[2] === H.identifier ? V.touch0[0] = L : V.touch1 && V.touch1[2] === H.identifier && (V.touch1[0] = L);
      if (H = V.that.__zoom, V.touch1) {
        var F = V.touch0[0], Z = V.touch0[1], oe = V.touch1[0], fe = V.touch1[1], Se = (Se = oe[0] - F[0]) * Se + (Se = oe[1] - F[1]) * Se, Te = (Te = fe[0] - Z[0]) * Te + (Te = fe[1] - Z[1]) * Te;
        H = T(H, Math.sqrt(Se / Te)), L = [(F[0] + oe[0]) / 2, (F[1] + oe[1]) / 2], J = [(Z[0] + fe[0]) / 2, (Z[1] + fe[1]) / 2];
      } else if (V.touch0) L = V.touch0[0], J = V.touch0[1];
      else return;
      V.zoom("touch", n(N(H, L, J), V.extent, l));
    }
  }
  function re(q, ...W) {
    if (this.__zooming) {
      var V = M(this, W).event(q), ee = q.changedTouches, te = ee.length, ie, H;
      for (e0(q), x && clearTimeout(x), x = setTimeout(function() {
        x = null;
      }, y), ie = 0; ie < te; ++ie)
        H = ee[ie], V.touch0 && V.touch0[2] === H.identifier ? delete V.touch0 : V.touch1 && V.touch1[2] === H.identifier && delete V.touch1;
      if (V.touch1 && !V.touch0 && (V.touch0 = V.touch1, delete V.touch1), V.touch0) V.touch0[1] = this.__zoom.invert(V.touch0[0]);
      else if (V.end(), V.taps === 2 && (H = Ci(H, this), Math.hypot(p[0] - H[0], p[1] - H[1]) < k)) {
        var L = Gr(this).on("dblclick.zoom");
        L && L.apply(this, arguments);
      }
    }
  }
  return C.wheelDelta = function(q) {
    return arguments.length ? (r = typeof q == "function" ? q : Hf(+q), C) : r;
  }, C.filter = function(q) {
    return arguments.length ? (e = typeof q == "function" ? q : Hf(!!q), C) : e;
  }, C.touchable = function(q) {
    return arguments.length ? (a = typeof q == "function" ? q : Hf(!!q), C) : a;
  }, C.extent = function(q) {
    return arguments.length ? (t = typeof q == "function" ? q : Hf([[+q[0][0], +q[0][1]], [+q[1][0], +q[1][1]]]), C) : t;
  }, C.scaleExtent = function(q) {
    return arguments.length ? (o[0] = +q[0], o[1] = +q[1], C) : [o[0], o[1]];
  }, C.translateExtent = function(q) {
    return arguments.length ? (l[0][0] = +q[0][0], l[1][0] = +q[1][0], l[0][1] = +q[0][1], l[1][1] = +q[1][1], C) : [[l[0][0], l[0][1]], [l[1][0], l[1][1]]];
  }, C.constrain = function(q) {
    return arguments.length ? (n = q, C) : n;
  }, C.duration = function(q) {
    return arguments.length ? (u = +q, C) : u;
  }, C.interpolate = function(q) {
    return arguments.length ? (f = q, C) : f;
  }, C.on = function() {
    var q = d.on.apply(d, arguments);
    return q === d ? C : q;
  }, C.clickDistance = function(q) {
    return arguments.length ? (E = (q = +q) * q, C) : Math.sqrt(E);
  }, C.tapDistance = function(q) {
    return arguments.length ? (k = +q, C) : k;
  }, C;
}
const ta = {
  error001: () => "[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",
  error002: () => "It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",
  error003: (e) => `Node type "${e}" not found. Using fallback type "default".`,
  error004: () => "The React Flow parent container needs a width and a height to render the graph.",
  error005: () => "Only child nodes can use a parent extent.",
  error006: () => "Can't create edge. An edge needs a source and a target.",
  error007: (e) => `The old edge with id=${e} does not exist.`,
  error009: (e) => `Marker type "${e}" doesn't exist.`,
  error008: (e, { id: t, sourceHandle: n, targetHandle: r }) => `Couldn't create edge for ${e} handle id: "${e === "source" ? n : r}", edge id: ${t}.`,
  error010: () => "Handle: No node id found. Make sure to only use a Handle inside a custom Node.",
  error011: (e) => `Edge type "${e}" not found. Using fallback type "default".`,
  error012: (e) => `Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,
  error013: (e = "react") => `It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,
  error014: () => "useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",
  error015: () => "It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."
}, Zc = [
  [Number.NEGATIVE_INFINITY, Number.NEGATIVE_INFINITY],
  [Number.POSITIVE_INFINITY, Number.POSITIVE_INFINITY]
], q9 = ["Enter", " ", "Escape"], P9 = {
  "node.a11yDescription.default": "Press enter or space to select a node. Press delete to remove it and escape to cancel.",
  "node.a11yDescription.keyboardDisabled": "Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.",
  "node.a11yDescription.ariaLiveMessage": ({ direction: e, x: t, y: n }) => `Moved selected node ${e}. New position, x: ${t}, y: ${n}`,
  "edge.a11yDescription.default": "Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.",
  // Control elements
  "controls.ariaLabel": "Control Panel",
  "controls.zoomIn.ariaLabel": "Zoom In",
  "controls.zoomOut.ariaLabel": "Zoom Out",
  "controls.fitView.ariaLabel": "Fit View",
  "controls.interactive.ariaLabel": "Toggle Interactivity",
  // Mini map
  "minimap.ariaLabel": "Mini Map",
  // Handle
  "handle.ariaLabel": "Handle"
};
var ru;
(function(e) {
  e.Strict = "strict", e.Loose = "loose";
})(ru || (ru = {}));
var Mo;
(function(e) {
  e.Free = "free", e.Vertical = "vertical", e.Horizontal = "horizontal";
})(Mo || (Mo = {}));
var Jc;
(function(e) {
  e.Partial = "partial", e.Full = "full";
})(Jc || (Jc = {}));
const B9 = {
  inProgress: !1,
  isValid: null,
  from: null,
  fromHandle: null,
  fromPosition: null,
  fromNode: null,
  to: null,
  toHandle: null,
  toPosition: null,
  toNode: null,
  pointer: null
};
var Ls;
(function(e) {
  e.Bezier = "default", e.Straight = "straight", e.Step = "step", e.SmoothStep = "smoothstep", e.SimpleBezier = "simplebezier";
})(Ls || (Ls = {}));
var ed;
(function(e) {
  e.Arrow = "arrow", e.ArrowClosed = "arrowclosed";
})(ed || (ed = {}));
var et;
(function(e) {
  e.Left = "left", e.Top = "top", e.Right = "right", e.Bottom = "bottom";
})(et || (et = {}));
const KS = {
  [et.Left]: et.Right,
  [et.Right]: et.Left,
  [et.Top]: et.Bottom,
  [et.Bottom]: et.Top
};
function F9(e) {
  return e === null ? null : e ? "valid" : "invalid";
}
const $9 = (e) => "id" in e && "source" in e && "target" in e, XK = (e) => "id" in e && "position" in e && !("source" in e) && !("target" in e), rw = (e) => "id" in e && "internals" in e && !("source" in e) && !("target" in e), dd = (e, t = [0, 0]) => {
  const { width: n, height: r } = Xa(e), a = e.origin ?? t, o = n * a[0], l = r * a[1];
  return {
    x: e.position.x - o,
    y: e.position.y - l
  };
}, WK = (e, t = { nodeOrigin: [0, 0] }) => {
  if (e.length === 0)
    return { x: 0, y: 0, width: 0, height: 0 };
  const n = e.reduce((r, a) => {
    const o = typeof a == "string";
    let l = !t.nodeLookup && !o ? a : void 0;
    t.nodeLookup && (l = o ? t.nodeLookup.get(a) : rw(a) ? a : t.nodeLookup.get(a.id));
    const u = l ? jh(l, t.nodeOrigin) : { x: 0, y: 0, x2: 0, y2: 0 };
    return Jh(r, u);
  }, { x: 1 / 0, y: 1 / 0, x2: -1 / 0, y2: -1 / 0 });
  return em(n);
}, fd = (e, t = {}) => {
  let n = { x: 1 / 0, y: 1 / 0, x2: -1 / 0, y2: -1 / 0 }, r = !1;
  return e.forEach((a) => {
    (t.filter === void 0 || t.filter(a)) && (n = Jh(n, jh(a)), r = !0);
  }), r ? em(n) : { x: 0, y: 0, width: 0, height: 0 };
}, iw = (e, t, [n, r, a] = [0, 0, 1], o = !1, l = !1) => {
  const u = {
    ...md(t, [n, r, a]),
    width: t.width / a,
    height: t.height / a
  }, f = [];
  for (const d of e.values()) {
    const { measured: m, selectable: p = !0, hidden: x = !1 } = d;
    if (l && !p || x)
      continue;
    const y = m.width ?? d.width ?? d.initialWidth ?? null, w = m.height ?? d.height ?? d.initialHeight ?? null, E = td(u, au(d)), k = (y ?? 0) * (w ?? 0), C = o && E > 0;
    (!d.internals.handleBounds || C || E >= k || d.dragging) && f.push(d);
  }
  return f;
}, QK = (e, t) => {
  const n = /* @__PURE__ */ new Set();
  return e.forEach((r) => {
    n.add(r.id);
  }), t.filter((r) => n.has(r.source) || n.has(r.target));
};
function ZK(e, t) {
  const n = /* @__PURE__ */ new Map(), r = t != null && t.nodes ? new Set(t.nodes.map((a) => a.id)) : null;
  return e.forEach((a) => {
    a.measured.width && a.measured.height && ((t == null ? void 0 : t.includeHiddenNodes) || !a.hidden) && (!r || r.has(a.id)) && n.set(a.id, a);
  }), n;
}
async function JK({ nodes: e, width: t, height: n, panZoom: r, minZoom: a, maxZoom: o }, l) {
  if (e.size === 0)
    return Promise.resolve(!0);
  const u = ZK(e, l), f = fd(u), d = aw(f, t, n, (l == null ? void 0 : l.minZoom) ?? a, (l == null ? void 0 : l.maxZoom) ?? o, (l == null ? void 0 : l.padding) ?? 0.1);
  return await r.setViewport(d, {
    duration: l == null ? void 0 : l.duration,
    ease: l == null ? void 0 : l.ease,
    interpolate: l == null ? void 0 : l.interpolate
  }), Promise.resolve(!0);
}
function U9({ nodeId: e, nextPosition: t, nodeLookup: n, nodeOrigin: r = [0, 0], nodeExtent: a, onError: o }) {
  const l = n.get(e), u = l.parentId ? n.get(l.parentId) : void 0, { x: f, y: d } = u ? u.internals.positionAbsolute : { x: 0, y: 0 }, m = l.origin ?? r;
  let p = l.extent || a;
  if (l.extent === "parent" && !l.expandParent)
    if (!u)
      o == null || o("005", ta.error005());
    else {
      const y = u.measured.width, w = u.measured.height;
      y && w && (p = [
        [f, d],
        [f + y, d + w]
      ]);
    }
  else u && su(l.extent) && (p = [
    [l.extent[0][0] + f, l.extent[0][1] + d],
    [l.extent[1][0] + f, l.extent[1][1] + d]
  ]);
  const x = su(p) ? Lo(t, p, l.measured) : t;
  return (l.measured.width === void 0 || l.measured.height === void 0) && (o == null || o("015", ta.error015())), {
    position: {
      x: x.x - f + (l.measured.width ?? 0) * m[0],
      y: x.y - d + (l.measured.height ?? 0) * m[1]
    },
    positionAbsolute: x
  };
}
async function eY({ nodesToRemove: e = [], edgesToRemove: t = [], nodes: n, edges: r, onBeforeDelete: a }) {
  const o = new Set(e.map((x) => x.id)), l = [];
  for (const x of n) {
    if (x.deletable === !1)
      continue;
    const y = o.has(x.id), w = !y && x.parentId && l.find((E) => E.id === x.parentId);
    (y || w) && l.push(x);
  }
  const u = new Set(t.map((x) => x.id)), f = r.filter((x) => x.deletable !== !1), m = QK(l, f);
  for (const x of f)
    u.has(x.id) && !m.find((w) => w.id === x.id) && m.push(x);
  if (!a)
    return {
      edges: m,
      nodes: l
    };
  const p = await a({
    nodes: l,
    edges: m
  });
  return typeof p == "boolean" ? p ? { edges: m, nodes: l } : { edges: [], nodes: [] } : p;
}
const iu = (e, t = 0, n = 1) => Math.min(Math.max(e, t), n), Lo = (e = { x: 0, y: 0 }, t, n) => ({
  x: iu(e.x, t[0][0], t[1][0] - ((n == null ? void 0 : n.width) ?? 0)),
  y: iu(e.y, t[0][1], t[1][1] - ((n == null ? void 0 : n.height) ?? 0))
});
function H9(e, t, n) {
  const { width: r, height: a } = Xa(n), { x: o, y: l } = n.internals.positionAbsolute;
  return Lo(e, [
    [o, l],
    [o + r, l + a]
  ], t);
}
const YS = (e, t, n) => e < t ? iu(Math.abs(e - t), 1, t) / t : e > n ? -iu(Math.abs(e - n), 1, t) / t : 0, G9 = (e, t, n = 15, r = 40) => {
  const a = YS(e.x, r, t.width - r) * n, o = YS(e.y, r, t.height - r) * n;
  return [a, o];
}, Jh = (e, t) => ({
  x: Math.min(e.x, t.x),
  y: Math.min(e.y, t.y),
  x2: Math.max(e.x2, t.x2),
  y2: Math.max(e.y2, t.y2)
}), l2 = ({ x: e, y: t, width: n, height: r }) => ({
  x: e,
  y: t,
  x2: e + n,
  y2: t + r
}), em = ({ x: e, y: t, x2: n, y2: r }) => ({
  x: e,
  y: t,
  width: n - e,
  height: r - t
}), au = (e, t = [0, 0]) => {
  var a, o;
  const { x: n, y: r } = rw(e) ? e.internals.positionAbsolute : dd(e, t);
  return {
    x: n,
    y: r,
    width: ((a = e.measured) == null ? void 0 : a.width) ?? e.width ?? e.initialWidth ?? 0,
    height: ((o = e.measured) == null ? void 0 : o.height) ?? e.height ?? e.initialHeight ?? 0
  };
}, jh = (e, t = [0, 0]) => {
  var a, o;
  const { x: n, y: r } = rw(e) ? e.internals.positionAbsolute : dd(e, t);
  return {
    x: n,
    y: r,
    x2: n + (((a = e.measured) == null ? void 0 : a.width) ?? e.width ?? e.initialWidth ?? 0),
    y2: r + (((o = e.measured) == null ? void 0 : o.height) ?? e.height ?? e.initialHeight ?? 0)
  };
}, V9 = (e, t) => em(Jh(l2(e), l2(t))), td = (e, t) => {
  const n = Math.max(0, Math.min(e.x + e.width, t.x + t.width) - Math.max(e.x, t.x)), r = Math.max(0, Math.min(e.y + e.height, t.y + t.height) - Math.max(e.y, t.y));
  return Math.ceil(n * r);
}, XS = (e) => Ti(e.width) && Ti(e.height) && Ti(e.x) && Ti(e.y), Ti = (e) => !isNaN(e) && isFinite(e), tY = (e, t) => {
}, hd = (e, t = [1, 1]) => ({
  x: t[0] * Math.round(e.x / t[0]),
  y: t[1] * Math.round(e.y / t[1])
}), md = ({ x: e, y: t }, [n, r, a], o = !1, l = [1, 1]) => {
  const u = {
    x: (e - n) / a,
    y: (t - r) / a
  };
  return o ? hd(u, l) : u;
}, Th = ({ x: e, y: t }, [n, r, a]) => ({
  x: e * a + n,
  y: t * a + r
});
function $l(e, t) {
  if (typeof e == "number")
    return Math.floor((t - t / (1 + e)) * 0.5);
  if (typeof e == "string" && e.endsWith("px")) {
    const n = parseFloat(e);
    if (!Number.isNaN(n))
      return Math.floor(n);
  }
  if (typeof e == "string" && e.endsWith("%")) {
    const n = parseFloat(e);
    if (!Number.isNaN(n))
      return Math.floor(t * n * 0.01);
  }
  return console.error(`[React Flow] The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`), 0;
}
function nY(e, t, n) {
  if (typeof e == "string" || typeof e == "number") {
    const r = $l(e, n), a = $l(e, t);
    return {
      top: r,
      right: a,
      bottom: r,
      left: a,
      x: a * 2,
      y: r * 2
    };
  }
  if (typeof e == "object") {
    const r = $l(e.top ?? e.y ?? 0, n), a = $l(e.bottom ?? e.y ?? 0, n), o = $l(e.left ?? e.x ?? 0, t), l = $l(e.right ?? e.x ?? 0, t);
    return { top: r, right: l, bottom: a, left: o, x: o + l, y: r + a };
  }
  return { top: 0, right: 0, bottom: 0, left: 0, x: 0, y: 0 };
}
function rY(e, t, n, r, a, o) {
  const { x: l, y: u } = Th(e, [t, n, r]), { x: f, y: d } = Th({ x: e.x + e.width, y: e.y + e.height }, [t, n, r]), m = a - f, p = o - d;
  return {
    left: Math.floor(l),
    top: Math.floor(u),
    right: Math.floor(m),
    bottom: Math.floor(p)
  };
}
const aw = (e, t, n, r, a, o) => {
  const l = nY(o, t, n), u = (t - l.x) / e.width, f = (n - l.y) / e.height, d = Math.min(u, f), m = iu(d, r, a), p = e.x + e.width / 2, x = e.y + e.height / 2, y = t / 2 - p * m, w = n / 2 - x * m, E = rY(e, y, w, m, t, n), k = {
    left: Math.min(E.left - l.left, 0),
    top: Math.min(E.top - l.top, 0),
    right: Math.min(E.right - l.right, 0),
    bottom: Math.min(E.bottom - l.bottom, 0)
  };
  return {
    x: y - k.left + k.right,
    y: w - k.top + k.bottom,
    zoom: m
  };
}, nd = () => {
  var e;
  return typeof navigator < "u" && ((e = navigator == null ? void 0 : navigator.userAgent) == null ? void 0 : e.indexOf("Mac")) >= 0;
};
function su(e) {
  return e != null && e !== "parent";
}
function Xa(e) {
  var t, n;
  return {
    width: ((t = e.measured) == null ? void 0 : t.width) ?? e.width ?? e.initialWidth ?? 0,
    height: ((n = e.measured) == null ? void 0 : n.height) ?? e.height ?? e.initialHeight ?? 0
  };
}
function K9(e) {
  var t, n;
  return (((t = e.measured) == null ? void 0 : t.width) ?? e.width ?? e.initialWidth) !== void 0 && (((n = e.measured) == null ? void 0 : n.height) ?? e.height ?? e.initialHeight) !== void 0;
}
function Y9(e, t = { width: 0, height: 0 }, n, r, a) {
  const o = { ...e }, l = r.get(n);
  if (l) {
    const u = l.origin || a;
    o.x += l.internals.positionAbsolute.x - (t.width ?? 0) * u[0], o.y += l.internals.positionAbsolute.y - (t.height ?? 0) * u[1];
  }
  return o;
}
function WS(e, t) {
  if (e.size !== t.size)
    return !1;
  for (const n of e)
    if (!t.has(n))
      return !1;
  return !0;
}
function iY() {
  let e, t;
  return { promise: new Promise((r, a) => {
    e = r, t = a;
  }), resolve: e, reject: t };
}
function aY(e) {
  return { ...P9, ...e || {} };
}
function $c(e, { snapGrid: t = [0, 0], snapToGrid: n = !1, transform: r, containerBounds: a }) {
  const { x: o, y: l } = Ai(e), u = md({ x: o - ((a == null ? void 0 : a.left) ?? 0), y: l - ((a == null ? void 0 : a.top) ?? 0) }, r), { x: f, y: d } = n ? hd(u, t) : u;
  return {
    xSnapped: f,
    ySnapped: d,
    ...u
  };
}
const sw = (e) => ({
  width: e.offsetWidth,
  height: e.offsetHeight
}), X9 = (e) => {
  var t;
  return ((t = e == null ? void 0 : e.getRootNode) == null ? void 0 : t.call(e)) || (window == null ? void 0 : window.document);
}, sY = ["INPUT", "SELECT", "TEXTAREA"];
function W9(e) {
  var r, a;
  const t = ((a = (r = e.composedPath) == null ? void 0 : r.call(e)) == null ? void 0 : a[0]) || e.target;
  return (t == null ? void 0 : t.nodeType) !== 1 ? !1 : sY.includes(t.nodeName) || t.hasAttribute("contenteditable") || !!t.closest(".nokey");
}
const Q9 = (e) => "clientX" in e, Ai = (e, t) => {
  var o, l;
  const n = Q9(e), r = n ? e.clientX : (o = e.touches) == null ? void 0 : o[0].clientX, a = n ? e.clientY : (l = e.touches) == null ? void 0 : l[0].clientY;
  return {
    x: r - ((t == null ? void 0 : t.left) ?? 0),
    y: a - ((t == null ? void 0 : t.top) ?? 0)
  };
}, QS = (e, t, n, r, a) => {
  const o = t.querySelectorAll(`.${e}`);
  return !o || !o.length ? null : Array.from(o).map((l) => {
    const u = l.getBoundingClientRect();
    return {
      id: l.getAttribute("data-handleid"),
      type: e,
      nodeId: a,
      position: l.getAttribute("data-handlepos"),
      x: (u.left - n.left) / r,
      y: (u.top - n.top) / r,
      ...sw(l)
    };
  });
};
function Z9({ sourceX: e, sourceY: t, targetX: n, targetY: r, sourceControlX: a, sourceControlY: o, targetControlX: l, targetControlY: u }) {
  const f = e * 0.125 + a * 0.375 + l * 0.375 + n * 0.125, d = t * 0.125 + o * 0.375 + u * 0.375 + r * 0.125, m = Math.abs(f - e), p = Math.abs(d - t);
  return [f, d, m, p];
}
function Gf(e, t) {
  return e >= 0 ? 0.5 * e : t * 25 * Math.sqrt(-e);
}
function ZS({ pos: e, x1: t, y1: n, x2: r, y2: a, c: o }) {
  switch (e) {
    case et.Left:
      return [t - Gf(t - r, o), n];
    case et.Right:
      return [t + Gf(r - t, o), n];
    case et.Top:
      return [t, n - Gf(n - a, o)];
    case et.Bottom:
      return [t, n + Gf(a - n, o)];
  }
}
function J9({ sourceX: e, sourceY: t, sourcePosition: n = et.Bottom, targetX: r, targetY: a, targetPosition: o = et.Top, curvature: l = 0.25 }) {
  const [u, f] = ZS({
    pos: n,
    x1: e,
    y1: t,
    x2: r,
    y2: a,
    c: l
  }), [d, m] = ZS({
    pos: o,
    x1: r,
    y1: a,
    x2: e,
    y2: t,
    c: l
  }), [p, x, y, w] = Z9({
    sourceX: e,
    sourceY: t,
    targetX: r,
    targetY: a,
    sourceControlX: u,
    sourceControlY: f,
    targetControlX: d,
    targetControlY: m
  });
  return [
    `M${e},${t} C${u},${f} ${d},${m} ${r},${a}`,
    p,
    x,
    y,
    w
  ];
}
function eT({ sourceX: e, sourceY: t, targetX: n, targetY: r }) {
  const a = Math.abs(n - e) / 2, o = n < e ? n + a : n - a, l = Math.abs(r - t) / 2, u = r < t ? r + l : r - l;
  return [o, u, a, l];
}
function oY({ sourceNode: e, targetNode: t, selected: n = !1, zIndex: r = 0, elevateOnSelect: a = !1, zIndexMode: o = "basic" }) {
  if (o === "manual")
    return r;
  const l = a && n ? r + 1e3 : r, u = Math.max(e.parentId || a && e.selected ? e.internals.z : 0, t.parentId || a && t.selected ? t.internals.z : 0);
  return l + u;
}
function lY({ sourceNode: e, targetNode: t, width: n, height: r, transform: a }) {
  const o = Jh(jh(e), jh(t));
  o.x === o.x2 && (o.x2 += 1), o.y === o.y2 && (o.y2 += 1);
  const l = {
    x: -a[0] / a[2],
    y: -a[1] / a[2],
    width: n / a[2],
    height: r / a[2]
  };
  return td(l, em(o)) > 0;
}
const uY = ({ source: e, sourceHandle: t, target: n, targetHandle: r }) => `xy-edge__${e}${t || ""}-${n}${r || ""}`, cY = (e, t) => t.some((n) => n.source === e.source && n.target === e.target && (n.sourceHandle === e.sourceHandle || !n.sourceHandle && !e.sourceHandle) && (n.targetHandle === e.targetHandle || !n.targetHandle && !e.targetHandle)), dY = (e, t, n = {}) => {
  if (!e.source || !e.target)
    return t;
  const r = n.getEdgeId || uY;
  let a;
  return $9(e) ? a = { ...e } : a = {
    ...e,
    id: r(e)
  }, cY(a, t) ? t : (a.sourceHandle === null && delete a.sourceHandle, a.targetHandle === null && delete a.targetHandle, t.concat(a));
};
function tT({ sourceX: e, sourceY: t, targetX: n, targetY: r }) {
  const [a, o, l, u] = eT({
    sourceX: e,
    sourceY: t,
    targetX: n,
    targetY: r
  });
  return [`M ${e},${t}L ${n},${r}`, a, o, l, u];
}
const JS = {
  [et.Left]: { x: -1, y: 0 },
  [et.Right]: { x: 1, y: 0 },
  [et.Top]: { x: 0, y: -1 },
  [et.Bottom]: { x: 0, y: 1 }
}, fY = ({ source: e, sourcePosition: t = et.Bottom, target: n }) => t === et.Left || t === et.Right ? e.x < n.x ? { x: 1, y: 0 } : { x: -1, y: 0 } : e.y < n.y ? { x: 0, y: 1 } : { x: 0, y: -1 }, eC = (e, t) => Math.sqrt(Math.pow(t.x - e.x, 2) + Math.pow(t.y - e.y, 2));
function hY({ source: e, sourcePosition: t = et.Bottom, target: n, targetPosition: r = et.Top, center: a, offset: o, stepPosition: l }) {
  const u = JS[t], f = JS[r], d = { x: e.x + u.x * o, y: e.y + u.y * o }, m = { x: n.x + f.x * o, y: n.y + f.y * o }, p = fY({
    source: d,
    sourcePosition: t,
    target: m
  }), x = p.x !== 0 ? "x" : "y", y = p[x];
  let w = [], E, k;
  const C = { x: 0, y: 0 }, T = { x: 0, y: 0 }, [, , N, A] = eT({
    sourceX: e.x,
    sourceY: e.y,
    targetX: n.x,
    targetY: n.y
  });
  if (u[x] * f[x] === -1) {
    x === "x" ? (E = a.x ?? d.x + (m.x - d.x) * l, k = a.y ?? (d.y + m.y) / 2) : (E = a.x ?? (d.x + m.x) / 2, k = a.y ?? d.y + (m.y - d.y) * l);
    const M = [
      { x: E, y: d.y },
      { x: E, y: m.y }
    ], O = [
      { x: d.x, y: k },
      { x: m.x, y: k }
    ];
    u[x] === y ? w = x === "x" ? M : O : w = x === "x" ? O : M;
  } else {
    const M = [{ x: d.x, y: m.y }], O = [{ x: m.x, y: d.y }];
    if (x === "x" ? w = u.x === y ? O : M : w = u.y === y ? M : O, t === r) {
      const G = Math.abs(e[x] - n[x]);
      if (G <= o) {
        const re = Math.min(o - 1, o - G);
        u[x] === y ? C[x] = (d[x] > e[x] ? -1 : 1) * re : T[x] = (m[x] > n[x] ? -1 : 1) * re;
      }
    }
    if (t !== r) {
      const G = x === "x" ? "y" : "x", re = u[x] === f[G], q = d[G] > m[G], W = d[G] < m[G];
      (u[x] === 1 && (!re && q || re && W) || u[x] !== 1 && (!re && W || re && q)) && (w = x === "x" ? M : O);
    }
    const Y = { x: d.x + C.x, y: d.y + C.y }, X = { x: m.x + T.x, y: m.y + T.y }, U = Math.max(Math.abs(Y.x - w[0].x), Math.abs(X.x - w[0].x)), B = Math.max(Math.abs(Y.y - w[0].y), Math.abs(X.y - w[0].y));
    U >= B ? (E = (Y.x + X.x) / 2, k = w[0].y) : (E = w[0].x, k = (Y.y + X.y) / 2);
  }
  return [[
    e,
    { x: d.x + C.x, y: d.y + C.y },
    ...w,
    { x: m.x + T.x, y: m.y + T.y },
    n
  ], E, k, N, A];
}
function mY(e, t, n, r) {
  const a = Math.min(eC(e, t) / 2, eC(t, n) / 2, r), { x: o, y: l } = t;
  if (e.x === o && o === n.x || e.y === l && l === n.y)
    return `L${o} ${l}`;
  if (e.y === l) {
    const d = e.x < n.x ? -1 : 1, m = e.y < n.y ? 1 : -1;
    return `L ${o + a * d},${l}Q ${o},${l} ${o},${l + a * m}`;
  }
  const u = e.x < n.x ? 1 : -1, f = e.y < n.y ? -1 : 1;
  return `L ${o},${l + a * f}Q ${o},${l} ${o + a * u},${l}`;
}
function u2({ sourceX: e, sourceY: t, sourcePosition: n = et.Bottom, targetX: r, targetY: a, targetPosition: o = et.Top, borderRadius: l = 5, centerX: u, centerY: f, offset: d = 20, stepPosition: m = 0.5 }) {
  const [p, x, y, w, E] = hY({
    source: { x: e, y: t },
    sourcePosition: n,
    target: { x: r, y: a },
    targetPosition: o,
    center: { x: u, y: f },
    offset: d,
    stepPosition: m
  });
  return [p.reduce((C, T, N) => {
    let A = "";
    return N > 0 && N < p.length - 1 ? A = mY(p[N - 1], T, p[N + 1], l) : A = `${N === 0 ? "M" : "L"}${T.x} ${T.y}`, C += A, C;
  }, ""), x, y, w, E];
}
function tC(e) {
  var t;
  return e && !!(e.internals.handleBounds || (t = e.handles) != null && t.length) && !!(e.measured.width || e.width || e.initialWidth);
}
function pY(e) {
  var p;
  const { sourceNode: t, targetNode: n } = e;
  if (!tC(t) || !tC(n))
    return null;
  const r = t.internals.handleBounds || nC(t.handles), a = n.internals.handleBounds || nC(n.handles), o = rC((r == null ? void 0 : r.source) ?? [], e.sourceHandle), l = rC(
    // when connection type is loose we can define all handles as sources and connect source -> source
    e.connectionMode === ru.Strict ? (a == null ? void 0 : a.target) ?? [] : ((a == null ? void 0 : a.target) ?? []).concat((a == null ? void 0 : a.source) ?? []),
    e.targetHandle
  );
  if (!o || !l)
    return (p = e.onError) == null || p.call(e, "008", ta.error008(o ? "target" : "source", {
      id: e.id,
      sourceHandle: e.sourceHandle,
      targetHandle: e.targetHandle
    })), null;
  const u = (o == null ? void 0 : o.position) || et.Bottom, f = (l == null ? void 0 : l.position) || et.Top, d = qo(t, o, u), m = qo(n, l, f);
  return {
    sourceX: d.x,
    sourceY: d.y,
    targetX: m.x,
    targetY: m.y,
    sourcePosition: u,
    targetPosition: f
  };
}
function nC(e) {
  if (!e)
    return null;
  const t = [], n = [];
  for (const r of e)
    r.width = r.width ?? 1, r.height = r.height ?? 1, r.type === "source" ? t.push(r) : r.type === "target" && n.push(r);
  return {
    source: t,
    target: n
  };
}
function qo(e, t, n = et.Left, r = !1) {
  const a = ((t == null ? void 0 : t.x) ?? 0) + e.internals.positionAbsolute.x, o = ((t == null ? void 0 : t.y) ?? 0) + e.internals.positionAbsolute.y, { width: l, height: u } = t ?? Xa(e);
  if (r)
    return { x: a + l / 2, y: o + u / 2 };
  switch ((t == null ? void 0 : t.position) ?? n) {
    case et.Top:
      return { x: a + l / 2, y: o };
    case et.Right:
      return { x: a + l, y: o + u / 2 };
    case et.Bottom:
      return { x: a + l / 2, y: o + u };
    case et.Left:
      return { x: a, y: o + u / 2 };
  }
}
function rC(e, t) {
  return e && (t ? e.find((n) => n.id === t) : e[0]) || null;
}
function c2(e, t) {
  return e ? typeof e == "string" ? e : `${t ? `${t}__` : ""}${Object.keys(e).sort().map((r) => `${r}=${e[r]}`).join("&")}` : "";
}
function gY(e, { id: t, defaultColor: n, defaultMarkerStart: r, defaultMarkerEnd: a }) {
  const o = /* @__PURE__ */ new Set();
  return e.reduce((l, u) => ([u.markerStart || r, u.markerEnd || a].forEach((f) => {
    if (f && typeof f == "object") {
      const d = c2(f, t);
      o.has(d) || (l.push({ id: d, color: f.color || n, ...f }), o.add(d));
    }
  }), l), []).sort((l, u) => l.id.localeCompare(u.id));
}
const nT = 1e3, yY = 10, ow = {
  nodeOrigin: [0, 0],
  nodeExtent: Zc,
  elevateNodesOnSelect: !0,
  zIndexMode: "basic",
  defaults: {}
}, xY = {
  ...ow,
  checkEquality: !0
};
function lw(e, t) {
  const n = { ...e };
  for (const r in t)
    t[r] !== void 0 && (n[r] = t[r]);
  return n;
}
function vY(e, t, n) {
  const r = lw(ow, n);
  for (const a of e.values())
    if (a.parentId)
      cw(a, e, t, r);
    else {
      const o = dd(a, r.nodeOrigin), l = su(a.extent) ? a.extent : r.nodeExtent, u = Lo(o, l, Xa(a));
      a.internals.positionAbsolute = u;
    }
}
function bY(e, t) {
  if (!e.handles)
    return e.measured ? t == null ? void 0 : t.internals.handleBounds : void 0;
  const n = [], r = [];
  for (const a of e.handles) {
    const o = {
      id: a.id,
      width: a.width ?? 1,
      height: a.height ?? 1,
      nodeId: e.id,
      x: a.x,
      y: a.y,
      position: a.position,
      type: a.type
    };
    a.type === "source" ? n.push(o) : a.type === "target" && r.push(o);
  }
  return {
    source: n,
    target: r
  };
}
function uw(e) {
  return e === "manual";
}
function d2(e, t, n, r = {}) {
  var d, m;
  const a = lw(xY, r), o = { i: 0 }, l = new Map(t), u = a != null && a.elevateNodesOnSelect && !uw(a.zIndexMode) ? nT : 0;
  let f = e.length > 0;
  t.clear(), n.clear();
  for (const p of e) {
    let x = l.get(p.id);
    if (a.checkEquality && p === (x == null ? void 0 : x.internals.userNode))
      t.set(p.id, x);
    else {
      const y = dd(p, a.nodeOrigin), w = su(p.extent) ? p.extent : a.nodeExtent, E = Lo(y, w, Xa(p));
      x = {
        ...a.defaults,
        ...p,
        measured: {
          width: (d = p.measured) == null ? void 0 : d.width,
          height: (m = p.measured) == null ? void 0 : m.height
        },
        internals: {
          positionAbsolute: E,
          // if user re-initializes the node or removes `measured` for whatever reason, we reset the handleBounds so that the node gets re-measured
          handleBounds: bY(p, x),
          z: rT(p, u, a.zIndexMode),
          userNode: p
        }
      }, t.set(p.id, x);
    }
    (x.measured === void 0 || x.measured.width === void 0 || x.measured.height === void 0) && !x.hidden && (f = !1), p.parentId && cw(x, t, n, r, o);
  }
  return f;
}
function wY(e, t) {
  if (!e.parentId)
    return;
  const n = t.get(e.parentId);
  n ? n.set(e.id, e) : t.set(e.parentId, /* @__PURE__ */ new Map([[e.id, e]]));
}
function cw(e, t, n, r, a) {
  const { elevateNodesOnSelect: o, nodeOrigin: l, nodeExtent: u, zIndexMode: f } = lw(ow, r), d = e.parentId, m = t.get(d);
  if (!m) {
    console.warn(`Parent node ${d} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);
    return;
  }
  wY(e, n), a && !m.parentId && m.internals.rootParentIndex === void 0 && f === "auto" && (m.internals.rootParentIndex = ++a.i, m.internals.z = m.internals.z + a.i * yY), a && m.internals.rootParentIndex !== void 0 && (a.i = m.internals.rootParentIndex);
  const p = o && !uw(f) ? nT : 0, { x, y, z: w } = _Y(e, m, l, u, p, f), { positionAbsolute: E } = e.internals, k = x !== E.x || y !== E.y;
  (k || w !== e.internals.z) && t.set(e.id, {
    ...e,
    internals: {
      ...e.internals,
      positionAbsolute: k ? { x, y } : E,
      z: w
    }
  });
}
function rT(e, t, n) {
  const r = Ti(e.zIndex) ? e.zIndex : 0;
  return uw(n) ? r : r + (e.selected ? t : 0);
}
function _Y(e, t, n, r, a, o) {
  const { x: l, y: u } = t.internals.positionAbsolute, f = Xa(e), d = dd(e, n), m = su(e.extent) ? Lo(d, e.extent, f) : d;
  let p = Lo({ x: l + m.x, y: u + m.y }, r, f);
  e.extent === "parent" && (p = H9(p, f, t));
  const x = rT(e, a, o), y = t.internals.z ?? 0;
  return {
    x: p.x,
    y: p.y,
    z: y >= x ? y + 1 : x
  };
}
function dw(e, t, n, r = [0, 0]) {
  var l;
  const a = [], o = /* @__PURE__ */ new Map();
  for (const u of e) {
    const f = t.get(u.parentId);
    if (!f)
      continue;
    const d = ((l = o.get(u.parentId)) == null ? void 0 : l.expandedRect) ?? au(f), m = V9(d, u.rect);
    o.set(u.parentId, { expandedRect: m, parent: f });
  }
  return o.size > 0 && o.forEach(({ expandedRect: u, parent: f }, d) => {
    var N;
    const m = f.internals.positionAbsolute, p = Xa(f), x = f.origin ?? r, y = u.x < m.x ? Math.round(Math.abs(m.x - u.x)) : 0, w = u.y < m.y ? Math.round(Math.abs(m.y - u.y)) : 0, E = Math.max(p.width, Math.round(u.width)), k = Math.max(p.height, Math.round(u.height)), C = (E - p.width) * x[0], T = (k - p.height) * x[1];
    (y > 0 || w > 0 || C || T) && (a.push({
      id: d,
      type: "position",
      position: {
        x: f.position.x - y + C,
        y: f.position.y - w + T
      }
    }), (N = n.get(d)) == null || N.forEach((A) => {
      e.some((D) => D.id === A.id) || a.push({
        id: A.id,
        type: "position",
        position: {
          x: A.position.x + y,
          y: A.position.y + w
        }
      });
    })), (p.width < u.width || p.height < u.height || y || w) && a.push({
      id: d,
      type: "dimensions",
      setAttributes: !0,
      dimensions: {
        width: E + (y ? x[0] * y - C : 0),
        height: k + (w ? x[1] * w - T : 0)
      }
    });
  }), a;
}
function SY(e, t, n, r, a, o, l) {
  const u = r == null ? void 0 : r.querySelector(".xyflow__viewport");
  let f = !1;
  if (!u)
    return { changes: [], updatedInternals: f };
  const d = [], m = window.getComputedStyle(u), { m22: p } = new window.DOMMatrixReadOnly(m.transform), x = [];
  for (const y of e.values()) {
    const w = t.get(y.id);
    if (!w)
      continue;
    if (w.hidden) {
      t.set(w.id, {
        ...w,
        internals: {
          ...w.internals,
          handleBounds: void 0
        }
      }), f = !0;
      continue;
    }
    const E = sw(y.nodeElement), k = w.measured.width !== E.width || w.measured.height !== E.height;
    if (!!(E.width && E.height && (k || !w.internals.handleBounds || y.force))) {
      const T = y.nodeElement.getBoundingClientRect(), N = su(w.extent) ? w.extent : o;
      let { positionAbsolute: A } = w.internals;
      w.parentId && w.extent === "parent" ? A = H9(A, E, t.get(w.parentId)) : N && (A = Lo(A, N, E));
      const D = {
        ...w,
        measured: E,
        internals: {
          ...w.internals,
          positionAbsolute: A,
          handleBounds: {
            source: QS("source", y.nodeElement, T, p, w.id),
            target: QS("target", y.nodeElement, T, p, w.id)
          }
        }
      };
      t.set(w.id, D), w.parentId && cw(D, t, n, { nodeOrigin: a, zIndexMode: l }), f = !0, k && (d.push({
        id: w.id,
        type: "dimensions",
        dimensions: E
      }), w.expandParent && w.parentId && x.push({
        id: w.id,
        parentId: w.parentId,
        rect: au(D, a)
      }));
    }
  }
  if (x.length > 0) {
    const y = dw(x, t, n, a);
    d.push(...y);
  }
  return { changes: d, updatedInternals: f };
}
async function CY({ delta: e, panZoom: t, transform: n, translateExtent: r, width: a, height: o }) {
  if (!t || !e.x && !e.y)
    return Promise.resolve(!1);
  const l = await t.setViewportConstrained({
    x: n[0] + e.x,
    y: n[1] + e.y,
    zoom: n[2]
  }, [
    [0, 0],
    [a, o]
  ], r), u = !!l && (l.x !== n[0] || l.y !== n[1] || l.k !== n[2]);
  return Promise.resolve(u);
}
function iC(e, t, n, r, a, o) {
  let l = a;
  const u = r.get(l) || /* @__PURE__ */ new Map();
  r.set(l, u.set(n, t)), l = `${a}-${e}`;
  const f = r.get(l) || /* @__PURE__ */ new Map();
  if (r.set(l, f.set(n, t)), o) {
    l = `${a}-${e}-${o}`;
    const d = r.get(l) || /* @__PURE__ */ new Map();
    r.set(l, d.set(n, t));
  }
}
function iT(e, t, n) {
  e.clear(), t.clear();
  for (const r of n) {
    const { source: a, target: o, sourceHandle: l = null, targetHandle: u = null } = r, f = { edgeId: r.id, source: a, target: o, sourceHandle: l, targetHandle: u }, d = `${a}-${l}--${o}-${u}`, m = `${o}-${u}--${a}-${l}`;
    iC("source", f, m, e, a, l), iC("target", f, d, e, o, u), t.set(r.id, r);
  }
}
function aT(e, t) {
  if (!e.parentId)
    return !1;
  const n = t.get(e.parentId);
  return n ? n.selected ? !0 : aT(n, t) : !1;
}
function aC(e, t, n) {
  var a;
  let r = e;
  do {
    if ((a = r == null ? void 0 : r.matches) != null && a.call(r, t))
      return !0;
    if (r === n)
      return !1;
    r = r == null ? void 0 : r.parentElement;
  } while (r);
  return !1;
}
function EY(e, t, n, r) {
  const a = /* @__PURE__ */ new Map();
  for (const [o, l] of e)
    if ((l.selected || l.id === r) && (!l.parentId || !aT(l, e)) && (l.draggable || t && typeof l.draggable > "u")) {
      const u = e.get(o);
      u && a.set(o, {
        id: o,
        position: u.position || { x: 0, y: 0 },
        distance: {
          x: n.x - u.internals.positionAbsolute.x,
          y: n.y - u.internals.positionAbsolute.y
        },
        extent: u.extent,
        parentId: u.parentId,
        origin: u.origin,
        expandParent: u.expandParent,
        internals: {
          positionAbsolute: u.internals.positionAbsolute || { x: 0, y: 0 }
        },
        measured: {
          width: u.measured.width ?? 0,
          height: u.measured.height ?? 0
        }
      });
    }
  return a;
}
function t0({ nodeId: e, dragItems: t, nodeLookup: n, dragging: r = !0 }) {
  var l, u, f;
  const a = [];
  for (const [d, m] of t) {
    const p = (l = n.get(d)) == null ? void 0 : l.internals.userNode;
    p && a.push({
      ...p,
      position: m.position,
      dragging: r
    });
  }
  if (!e)
    return [a[0], a];
  const o = (u = n.get(e)) == null ? void 0 : u.internals.userNode;
  return [
    o ? {
      ...o,
      position: ((f = t.get(e)) == null ? void 0 : f.position) || o.position,
      dragging: r
    } : a[0],
    a
  ];
}
function kY({ dragItems: e, snapGrid: t, x: n, y: r }) {
  const a = e.values().next().value;
  if (!a)
    return null;
  const o = {
    x: n - a.distance.x,
    y: r - a.distance.y
  }, l = hd(o, t);
  return {
    x: l.x - o.x,
    y: l.y - o.y
  };
}
function NY({ onNodeMouseDown: e, getStoreItems: t, onDragStart: n, onDrag: r, onDragStop: a }) {
  let o = { x: null, y: null }, l = 0, u = /* @__PURE__ */ new Map(), f = !1, d = { x: 0, y: 0 }, m = null, p = !1, x = null, y = !1, w = !1, E = null;
  function k({ noDragClassName: T, handleSelector: N, domNode: A, isSelectable: D, nodeId: M, nodeClickDistance: O = 0 }) {
    x = Gr(A);
    function Y({ x: G, y: re }) {
      const { nodeLookup: q, nodeExtent: W, snapGrid: V, snapToGrid: ee, nodeOrigin: te, onNodeDrag: ie, onSelectionDrag: H, onError: L, updateNodePositions: J } = t();
      o = { x: G, y: re };
      let F = !1;
      const Z = u.size > 1, oe = Z && W ? l2(fd(u)) : null, fe = Z && ee ? kY({
        dragItems: u,
        snapGrid: V,
        x: G,
        y: re
      }) : null;
      for (const [Se, Te] of u) {
        if (!q.has(Se))
          continue;
        let we = { x: G - Te.distance.x, y: re - Te.distance.y };
        ee && (we = fe ? {
          x: Math.round(we.x + fe.x),
          y: Math.round(we.y + fe.y)
        } : hd(we, V));
        let ke = null;
        if (Z && W && !Te.extent && oe) {
          const { positionAbsolute: Pe } = Te.internals, Qe = Pe.x - oe.x + W[0][0], qe = Pe.x + Te.measured.width - oe.x2 + W[1][0], at = Pe.y - oe.y + W[0][1], st = Pe.y + Te.measured.height - oe.y2 + W[1][1];
          ke = [
            [Qe, at],
            [qe, st]
          ];
        }
        const { position: _e, positionAbsolute: Ae } = U9({
          nodeId: Se,
          nextPosition: we,
          nodeLookup: q,
          nodeExtent: ke || W,
          nodeOrigin: te,
          onError: L
        });
        F = F || Te.position.x !== _e.x || Te.position.y !== _e.y, Te.position = _e, Te.internals.positionAbsolute = Ae;
      }
      if (w = w || F, !!F && (J(u, !0), E && (r || ie || !M && H))) {
        const [Se, Te] = t0({
          nodeId: M,
          dragItems: u,
          nodeLookup: q
        });
        r == null || r(E, u, Se, Te), ie == null || ie(E, Se, Te), M || H == null || H(E, Te);
      }
    }
    async function X() {
      if (!m)
        return;
      const { transform: G, panBy: re, autoPanSpeed: q, autoPanOnNodeDrag: W } = t();
      if (!W) {
        f = !1, cancelAnimationFrame(l);
        return;
      }
      const [V, ee] = G9(d, m, q);
      (V !== 0 || ee !== 0) && (o.x = (o.x ?? 0) - V / G[2], o.y = (o.y ?? 0) - ee / G[2], await re({ x: V, y: ee }) && Y(o)), l = requestAnimationFrame(X);
    }
    function U(G) {
      var Z;
      const { nodeLookup: re, multiSelectionActive: q, nodesDraggable: W, transform: V, snapGrid: ee, snapToGrid: te, selectNodesOnDrag: ie, onNodeDragStart: H, onSelectionDragStart: L, unselectNodesAndEdges: J } = t();
      p = !0, (!ie || !D) && !q && M && ((Z = re.get(M)) != null && Z.selected || J()), D && ie && M && (e == null || e(M));
      const F = $c(G.sourceEvent, { transform: V, snapGrid: ee, snapToGrid: te, containerBounds: m });
      if (o = F, u = EY(re, W, F, M), u.size > 0 && (n || H || !M && L)) {
        const [oe, fe] = t0({
          nodeId: M,
          dragItems: u,
          nodeLookup: re
        });
        n == null || n(G.sourceEvent, u, oe, fe), H == null || H(G.sourceEvent, oe, fe), M || L == null || L(G.sourceEvent, fe);
      }
    }
    const B = _9().clickDistance(O).on("start", (G) => {
      const { domNode: re, nodeDragThreshold: q, transform: W, snapGrid: V, snapToGrid: ee } = t();
      m = (re == null ? void 0 : re.getBoundingClientRect()) || null, y = !1, w = !1, E = G.sourceEvent, q === 0 && U(G), o = $c(G.sourceEvent, { transform: W, snapGrid: V, snapToGrid: ee, containerBounds: m }), d = Ai(G.sourceEvent, m);
    }).on("drag", (G) => {
      const { autoPanOnNodeDrag: re, transform: q, snapGrid: W, snapToGrid: V, nodeDragThreshold: ee, nodeLookup: te } = t(), ie = $c(G.sourceEvent, { transform: q, snapGrid: W, snapToGrid: V, containerBounds: m });
      if (E = G.sourceEvent, (G.sourceEvent.type === "touchmove" && G.sourceEvent.touches.length > 1 || // if user deletes a node while dragging, we need to abort the drag to prevent errors
      M && !te.has(M)) && (y = !0), !y) {
        if (!f && re && p && (f = !0, X()), !p) {
          const H = Ai(G.sourceEvent, m), L = H.x - d.x, J = H.y - d.y;
          Math.sqrt(L * L + J * J) > ee && U(G);
        }
        (o.x !== ie.xSnapped || o.y !== ie.ySnapped) && u && p && (d = Ai(G.sourceEvent, m), Y(ie));
      }
    }).on("end", (G) => {
      if (!(!p || y) && (f = !1, p = !1, cancelAnimationFrame(l), u.size > 0)) {
        const { nodeLookup: re, updateNodePositions: q, onNodeDragStop: W, onSelectionDragStop: V } = t();
        if (w && (q(u, !1), w = !1), a || W || !M && V) {
          const [ee, te] = t0({
            nodeId: M,
            dragItems: u,
            nodeLookup: re,
            dragging: !1
          });
          a == null || a(G.sourceEvent, u, ee, te), W == null || W(G.sourceEvent, ee, te), M || V == null || V(G.sourceEvent, te);
        }
      }
    }).filter((G) => {
      const re = G.target;
      return !G.button && (!T || !aC(re, `.${T}`, A)) && (!N || aC(re, N, A));
    });
    x.call(B);
  }
  function C() {
    x == null || x.on(".drag", null);
  }
  return {
    update: k,
    destroy: C
  };
}
function jY(e, t, n) {
  const r = [], a = {
    x: e.x - n,
    y: e.y - n,
    width: n * 2,
    height: n * 2
  };
  for (const o of t.values())
    td(a, au(o)) > 0 && r.push(o);
  return r;
}
const TY = 250;
function AY(e, t, n, r) {
  var u, f;
  let a = [], o = 1 / 0;
  const l = jY(e, n, t + TY);
  for (const d of l) {
    const m = [...((u = d.internals.handleBounds) == null ? void 0 : u.source) ?? [], ...((f = d.internals.handleBounds) == null ? void 0 : f.target) ?? []];
    for (const p of m) {
      if (r.nodeId === p.nodeId && r.type === p.type && r.id === p.id)
        continue;
      const { x, y } = qo(d, p, p.position, !0), w = Math.sqrt(Math.pow(x - e.x, 2) + Math.pow(y - e.y, 2));
      w > t || (w < o ? (a = [{ ...p, x, y }], o = w) : w === o && a.push({ ...p, x, y }));
    }
  }
  if (!a.length)
    return null;
  if (a.length > 1) {
    const d = r.type === "source" ? "target" : "source";
    return a.find((m) => m.type === d) ?? a[0];
  }
  return a[0];
}
function sT(e, t, n, r, a, o = !1) {
  var d, m, p;
  const l = r.get(e);
  if (!l)
    return null;
  const u = a === "strict" ? (d = l.internals.handleBounds) == null ? void 0 : d[t] : [...((m = l.internals.handleBounds) == null ? void 0 : m.source) ?? [], ...((p = l.internals.handleBounds) == null ? void 0 : p.target) ?? []], f = (n ? u == null ? void 0 : u.find((x) => x.id === n) : u == null ? void 0 : u[0]) ?? null;
  return f && o ? { ...f, ...qo(l, f, f.position, !0) } : f;
}
function oT(e, t) {
  return e || (t != null && t.classList.contains("target") ? "target" : t != null && t.classList.contains("source") ? "source" : null);
}
function MY(e, t) {
  let n = null;
  return t ? n = !0 : e && !t && (n = !1), n;
}
const lT = () => !0;
function RY(e, { connectionMode: t, connectionRadius: n, handleId: r, nodeId: a, edgeUpdaterType: o, isTarget: l, domNode: u, nodeLookup: f, lib: d, autoPanOnConnect: m, flowId: p, panBy: x, cancelConnection: y, onConnectStart: w, onConnect: E, onConnectEnd: k, isValidConnection: C = lT, onReconnectEnd: T, updateConnection: N, getTransform: A, getFromHandle: D, autoPanSpeed: M, dragThreshold: O = 1, handleDomNode: Y }) {
  const X = X9(e.target);
  let U = 0, B;
  const { x: G, y: re } = Ai(e), q = oT(o, Y), W = u == null ? void 0 : u.getBoundingClientRect();
  let V = !1;
  if (!W || !q)
    return;
  const ee = sT(a, q, r, f, t);
  if (!ee)
    return;
  let te = Ai(e, W), ie = !1, H = null, L = !1, J = null;
  function F() {
    if (!m || !W)
      return;
    const [_e, Ae] = G9(te, W, M);
    x({ x: _e, y: Ae }), U = requestAnimationFrame(F);
  }
  const Z = {
    ...ee,
    nodeId: a,
    type: q,
    position: ee.position
  }, oe = f.get(a);
  let Se = {
    inProgress: !0,
    isValid: null,
    from: qo(oe, Z, et.Left, !0),
    fromHandle: Z,
    fromPosition: Z.position,
    fromNode: oe,
    to: te,
    toHandle: null,
    toPosition: KS[Z.position],
    toNode: null,
    pointer: te
  };
  function Te() {
    V = !0, N(Se), w == null || w(e, { nodeId: a, handleId: r, handleType: q });
  }
  O === 0 && Te();
  function we(_e) {
    if (!V) {
      const { x: st, y: mn } = Ai(_e), Jt = st - G, Sn = mn - re;
      if (!(Jt * Jt + Sn * Sn > O * O))
        return;
      Te();
    }
    if (!D() || !Z) {
      ke(_e);
      return;
    }
    const Ae = A();
    te = Ai(_e, W), B = AY(md(te, Ae, !1, [1, 1]), n, f, Z), ie || (F(), ie = !0);
    const Pe = uT(_e, {
      handle: B,
      connectionMode: t,
      fromNodeId: a,
      fromHandleId: r,
      fromType: l ? "target" : "source",
      isValidConnection: C,
      doc: X,
      lib: d,
      flowId: p,
      nodeLookup: f
    });
    J = Pe.handleDomNode, H = Pe.connection, L = MY(!!B, Pe.isValid);
    const Qe = f.get(a), qe = Qe ? qo(Qe, Z, et.Left, !0) : Se.from, at = {
      ...Se,
      from: qe,
      isValid: L,
      to: Pe.toHandle && L ? Th({ x: Pe.toHandle.x, y: Pe.toHandle.y }, Ae) : te,
      toHandle: Pe.toHandle,
      toPosition: L && Pe.toHandle ? Pe.toHandle.position : KS[Z.position],
      toNode: Pe.toHandle ? f.get(Pe.toHandle.nodeId) : null,
      pointer: te
    };
    N(at), Se = at;
  }
  function ke(_e) {
    if (!("touches" in _e && _e.touches.length > 0)) {
      if (V) {
        (B || J) && H && L && (E == null || E(H));
        const { inProgress: Ae, ...Pe } = Se, Qe = {
          ...Pe,
          toPosition: Se.toHandle ? Se.toPosition : null
        };
        k == null || k(_e, Qe), o && (T == null || T(_e, Qe));
      }
      y(), cancelAnimationFrame(U), ie = !1, L = !1, H = null, J = null, X.removeEventListener("mousemove", we), X.removeEventListener("mouseup", ke), X.removeEventListener("touchmove", we), X.removeEventListener("touchend", ke);
    }
  }
  X.addEventListener("mousemove", we), X.addEventListener("mouseup", ke), X.addEventListener("touchmove", we), X.addEventListener("touchend", ke);
}
function uT(e, { handle: t, connectionMode: n, fromNodeId: r, fromHandleId: a, fromType: o, doc: l, lib: u, flowId: f, isValidConnection: d = lT, nodeLookup: m }) {
  const p = o === "target", x = t ? l.querySelector(`.${u}-flow__handle[data-id="${f}-${t == null ? void 0 : t.nodeId}-${t == null ? void 0 : t.id}-${t == null ? void 0 : t.type}"]`) : null, { x: y, y: w } = Ai(e), E = l.elementFromPoint(y, w), k = E != null && E.classList.contains(`${u}-flow__handle`) ? E : x, C = {
    handleDomNode: k,
    isValid: !1,
    connection: null,
    toHandle: null
  };
  if (k) {
    const T = oT(void 0, k), N = k.getAttribute("data-nodeid"), A = k.getAttribute("data-handleid"), D = k.classList.contains("connectable"), M = k.classList.contains("connectableend");
    if (!N || !T)
      return C;
    const O = {
      source: p ? N : r,
      sourceHandle: p ? A : a,
      target: p ? r : N,
      targetHandle: p ? a : A
    };
    C.connection = O;
    const X = D && M && (n === ru.Strict ? p && T === "source" || !p && T === "target" : N !== r || A !== a);
    C.isValid = X && d(O), C.toHandle = sT(N, T, A, m, n, !0);
  }
  return C;
}
const f2 = {
  onPointerDown: RY,
  isValid: uT
};
function zY({ domNode: e, panZoom: t, getTransform: n, getViewScale: r }) {
  const a = Gr(e);
  function o({ translateExtent: u, width: f, height: d, zoomStep: m = 1, pannable: p = !0, zoomable: x = !0, inversePan: y = !1 }) {
    const w = (N) => {
      if (N.sourceEvent.type !== "wheel" || !t)
        return;
      const A = n(), D = N.sourceEvent.ctrlKey && nd() ? 10 : 1, M = -N.sourceEvent.deltaY * (N.sourceEvent.deltaMode === 1 ? 0.05 : N.sourceEvent.deltaMode ? 1 : 2e-3) * m, O = A[2] * Math.pow(2, M * D);
      t.scaleTo(O);
    };
    let E = [0, 0];
    const k = (N) => {
      (N.sourceEvent.type === "mousedown" || N.sourceEvent.type === "touchstart") && (E = [
        N.sourceEvent.clientX ?? N.sourceEvent.touches[0].clientX,
        N.sourceEvent.clientY ?? N.sourceEvent.touches[0].clientY
      ]);
    }, C = (N) => {
      const A = n();
      if (N.sourceEvent.type !== "mousemove" && N.sourceEvent.type !== "touchmove" || !t)
        return;
      const D = [
        N.sourceEvent.clientX ?? N.sourceEvent.touches[0].clientX,
        N.sourceEvent.clientY ?? N.sourceEvent.touches[0].clientY
      ], M = [D[0] - E[0], D[1] - E[1]];
      E = D;
      const O = r() * Math.max(A[2], Math.log(A[2])) * (y ? -1 : 1), Y = {
        x: A[0] - M[0] * O,
        y: A[1] - M[1] * O
      }, X = [
        [0, 0],
        [f, d]
      ];
      t.setViewportConstrained({
        x: Y.x,
        y: Y.y,
        zoom: A[2]
      }, X, u);
    }, T = L9().on("start", k).on("zoom", p ? C : null).on("zoom.wheel", x ? w : null);
    a.call(T, {});
  }
  function l() {
    a.on("zoom", null);
  }
  return {
    update: o,
    destroy: l,
    pointer: Ci
  };
}
const tm = (e) => ({
  x: e.x,
  y: e.y,
  zoom: e.k
}), n0 = ({ x: e, y: t, zoom: n }) => Zh.translate(e, t).scale(n), Yl = (e, t) => e.target.closest(`.${t}`), cT = (e, t) => t === 2 && Array.isArray(e) && e.includes(2), OY = (e) => ((e *= 2) <= 1 ? e * e * e : (e -= 2) * e * e + 2) / 2, r0 = (e, t = 0, n = OY, r = () => {
}) => {
  const a = typeof t == "number" && t > 0;
  return a || r(), a ? e.transition().duration(t).ease(n).on("end", r) : e;
}, dT = (e) => {
  const t = e.ctrlKey && nd() ? 10 : 1;
  return -e.deltaY * (e.deltaMode === 1 ? 0.05 : e.deltaMode ? 1 : 2e-3) * t;
};
function DY({ zoomPanValues: e, noWheelClassName: t, d3Selection: n, d3Zoom: r, panOnScrollMode: a, panOnScrollSpeed: o, zoomOnPinch: l, onPanZoomStart: u, onPanZoom: f, onPanZoomEnd: d }) {
  return (m) => {
    if (Yl(m, t))
      return m.ctrlKey && m.preventDefault(), !1;
    m.preventDefault(), m.stopImmediatePropagation();
    const p = n.property("__zoom").k || 1;
    if (m.ctrlKey && l) {
      const k = Ci(m), C = dT(m), T = p * Math.pow(2, C);
      r.scaleTo(n, T, k, m);
      return;
    }
    const x = m.deltaMode === 1 ? 20 : 1;
    let y = a === Mo.Vertical ? 0 : m.deltaX * x, w = a === Mo.Horizontal ? 0 : m.deltaY * x;
    !nd() && m.shiftKey && a !== Mo.Vertical && (y = m.deltaY * x, w = 0), r.translateBy(
      n,
      -(y / p) * o,
      -(w / p) * o,
      // @ts-ignore
      { internal: !0 }
    );
    const E = tm(n.property("__zoom"));
    clearTimeout(e.panScrollTimeout), e.isPanScrolling ? (f == null || f(m, E), e.panScrollTimeout = setTimeout(() => {
      d == null || d(m, E), e.isPanScrolling = !1;
    }, 150)) : (e.isPanScrolling = !0, u == null || u(m, E));
  };
}
function IY({ noWheelClassName: e, preventScrolling: t, d3ZoomHandler: n }) {
  return function(r, a) {
    const o = r.type === "wheel", l = !t && o && !r.ctrlKey, u = Yl(r, e);
    if (r.ctrlKey && o && u && r.preventDefault(), l || u)
      return null;
    r.preventDefault(), n.call(this, r, a);
  };
}
function LY({ zoomPanValues: e, onDraggingChange: t, onPanZoomStart: n }) {
  return (r) => {
    var o, l, u;
    if ((o = r.sourceEvent) != null && o.internal)
      return;
    const a = tm(r.transform);
    e.mouseButton = ((l = r.sourceEvent) == null ? void 0 : l.button) || 0, e.isZoomingOrPanning = !0, e.prevViewport = a, ((u = r.sourceEvent) == null ? void 0 : u.type) === "mousedown" && t(!0), n && (n == null || n(r.sourceEvent, a));
  };
}
function qY({ zoomPanValues: e, panOnDrag: t, onPaneContextMenu: n, onTransformChange: r, onPanZoom: a }) {
  return (o) => {
    var l, u;
    e.usedRightMouseButton = !!(n && cT(t, e.mouseButton ?? 0)), (l = o.sourceEvent) != null && l.sync || r([o.transform.x, o.transform.y, o.transform.k]), a && !((u = o.sourceEvent) != null && u.internal) && (a == null || a(o.sourceEvent, tm(o.transform)));
  };
}
function PY({ zoomPanValues: e, panOnDrag: t, panOnScroll: n, onDraggingChange: r, onPanZoomEnd: a, onPaneContextMenu: o }) {
  return (l) => {
    var u;
    if (!((u = l.sourceEvent) != null && u.internal) && (e.isZoomingOrPanning = !1, o && cT(t, e.mouseButton ?? 0) && !e.usedRightMouseButton && l.sourceEvent && o(l.sourceEvent), e.usedRightMouseButton = !1, r(!1), a)) {
      const f = tm(l.transform);
      e.prevViewport = f, clearTimeout(e.timerId), e.timerId = setTimeout(
        () => {
          a == null || a(l.sourceEvent, f);
        },
        // we need a setTimeout for panOnScroll to supress multiple end events fired during scroll
        n ? 150 : 0
      );
    }
  };
}
function BY({ zoomActivationKeyPressed: e, zoomOnScroll: t, zoomOnPinch: n, panOnDrag: r, panOnScroll: a, zoomOnDoubleClick: o, userSelectionActive: l, noWheelClassName: u, noPanClassName: f, lib: d, connectionInProgress: m }) {
  return (p) => {
    var k;
    const x = e || t, y = n && p.ctrlKey, w = p.type === "wheel";
    if (p.button === 1 && p.type === "mousedown" && (Yl(p, `${d}-flow__node`) || Yl(p, `${d}-flow__edge`)))
      return !0;
    if (!r && !x && !a && !o && !n || l || m && !w || Yl(p, u) && w || Yl(p, f) && (!w || a && w && !e) || !n && p.ctrlKey && w)
      return !1;
    if (!n && p.type === "touchstart" && ((k = p.touches) == null ? void 0 : k.length) > 1)
      return p.preventDefault(), !1;
    if (!x && !a && !y && w || !r && (p.type === "mousedown" || p.type === "touchstart") || Array.isArray(r) && !r.includes(p.button) && p.type === "mousedown")
      return !1;
    const E = Array.isArray(r) && r.includes(p.button) || !p.button || p.button <= 1;
    return (!p.ctrlKey || w) && E;
  };
}
function FY({ domNode: e, minZoom: t, maxZoom: n, translateExtent: r, viewport: a, onPanZoom: o, onPanZoomStart: l, onPanZoomEnd: u, onDraggingChange: f }) {
  const d = {
    isZoomingOrPanning: !1,
    usedRightMouseButton: !1,
    prevViewport: {},
    mouseButton: 0,
    timerId: void 0,
    panScrollTimeout: void 0,
    isPanScrolling: !1
  }, m = e.getBoundingClientRect(), p = L9().scaleExtent([t, n]).translateExtent(r), x = Gr(e).call(p);
  T({
    x: a.x,
    y: a.y,
    zoom: iu(a.zoom, t, n)
  }, [
    [0, 0],
    [m.width, m.height]
  ], r);
  const y = x.on("wheel.zoom"), w = x.on("dblclick.zoom");
  p.wheelDelta(dT);
  function E(B, G) {
    return x ? new Promise((re) => {
      p == null || p.interpolate((G == null ? void 0 : G.interpolate) === "linear" ? Fc : rh).transform(r0(x, G == null ? void 0 : G.duration, G == null ? void 0 : G.ease, () => re(!0)), B);
    }) : Promise.resolve(!1);
  }
  function k({ noWheelClassName: B, noPanClassName: G, onPaneContextMenu: re, userSelectionActive: q, panOnScroll: W, panOnDrag: V, panOnScrollMode: ee, panOnScrollSpeed: te, preventScrolling: ie, zoomOnPinch: H, zoomOnScroll: L, zoomOnDoubleClick: J, zoomActivationKeyPressed: F, lib: Z, onTransformChange: oe, connectionInProgress: fe, paneClickDistance: Se, selectionOnDrag: Te }) {
    q && !d.isZoomingOrPanning && C();
    const we = W && !F && !q;
    p.clickDistance(Te ? 1 / 0 : !Ti(Se) || Se < 0 ? 0 : Se);
    const ke = we ? DY({
      zoomPanValues: d,
      noWheelClassName: B,
      d3Selection: x,
      d3Zoom: p,
      panOnScrollMode: ee,
      panOnScrollSpeed: te,
      zoomOnPinch: H,
      onPanZoomStart: l,
      onPanZoom: o,
      onPanZoomEnd: u
    }) : IY({
      noWheelClassName: B,
      preventScrolling: ie,
      d3ZoomHandler: y
    });
    if (x.on("wheel.zoom", ke, { passive: !1 }), !q) {
      const Ae = LY({
        zoomPanValues: d,
        onDraggingChange: f,
        onPanZoomStart: l
      });
      p.on("start", Ae);
      const Pe = qY({
        zoomPanValues: d,
        panOnDrag: V,
        onPaneContextMenu: !!re,
        onPanZoom: o,
        onTransformChange: oe
      });
      p.on("zoom", Pe);
      const Qe = PY({
        zoomPanValues: d,
        panOnDrag: V,
        panOnScroll: W,
        onPaneContextMenu: re,
        onPanZoomEnd: u,
        onDraggingChange: f
      });
      p.on("end", Qe);
    }
    const _e = BY({
      zoomActivationKeyPressed: F,
      panOnDrag: V,
      zoomOnScroll: L,
      panOnScroll: W,
      zoomOnDoubleClick: J,
      zoomOnPinch: H,
      userSelectionActive: q,
      noPanClassName: G,
      noWheelClassName: B,
      lib: Z,
      connectionInProgress: fe
    });
    p.filter(_e), J ? x.on("dblclick.zoom", w) : x.on("dblclick.zoom", null);
  }
  function C() {
    p.on("zoom", null);
  }
  async function T(B, G, re) {
    const q = n0(B), W = p == null ? void 0 : p.constrain()(q, G, re);
    return W && await E(W), new Promise((V) => V(W));
  }
  async function N(B, G) {
    const re = n0(B);
    return await E(re, G), new Promise((q) => q(re));
  }
  function A(B) {
    if (x) {
      const G = n0(B), re = x.property("__zoom");
      (re.k !== B.zoom || re.x !== B.x || re.y !== B.y) && (p == null || p.transform(x, G, null, { sync: !0 }));
    }
  }
  function D() {
    const B = x ? I9(x.node()) : { x: 0, y: 0, k: 1 };
    return { x: B.x, y: B.y, zoom: B.k };
  }
  function M(B, G) {
    return x ? new Promise((re) => {
      p == null || p.interpolate((G == null ? void 0 : G.interpolate) === "linear" ? Fc : rh).scaleTo(r0(x, G == null ? void 0 : G.duration, G == null ? void 0 : G.ease, () => re(!0)), B);
    }) : Promise.resolve(!1);
  }
  function O(B, G) {
    return x ? new Promise((re) => {
      p == null || p.interpolate((G == null ? void 0 : G.interpolate) === "linear" ? Fc : rh).scaleBy(r0(x, G == null ? void 0 : G.duration, G == null ? void 0 : G.ease, () => re(!0)), B);
    }) : Promise.resolve(!1);
  }
  function Y(B) {
    p == null || p.scaleExtent(B);
  }
  function X(B) {
    p == null || p.translateExtent(B);
  }
  function U(B) {
    const G = !Ti(B) || B < 0 ? 0 : B;
    p == null || p.clickDistance(G);
  }
  return {
    update: k,
    destroy: C,
    setViewport: N,
    setViewportConstrained: T,
    getViewport: D,
    scaleTo: M,
    scaleBy: O,
    setScaleExtent: Y,
    setTranslateExtent: X,
    syncViewport: A,
    setClickDistance: U
  };
}
var ou;
(function(e) {
  e.Line = "line", e.Handle = "handle";
})(ou || (ou = {}));
function $Y({ width: e, prevWidth: t, height: n, prevHeight: r, affectsX: a, affectsY: o }) {
  const l = e - t, u = n - r, f = [l > 0 ? 1 : l < 0 ? -1 : 0, u > 0 ? 1 : u < 0 ? -1 : 0];
  return l && a && (f[0] = f[0] * -1), u && o && (f[1] = f[1] * -1), f;
}
function sC(e) {
  const t = e.includes("right") || e.includes("left"), n = e.includes("bottom") || e.includes("top"), r = e.includes("left"), a = e.includes("top");
  return {
    isHorizontal: t,
    isVertical: n,
    affectsX: r,
    affectsY: a
  };
}
function Os(e, t) {
  return Math.max(0, t - e);
}
function Ds(e, t) {
  return Math.max(0, e - t);
}
function Vf(e, t, n) {
  return Math.max(0, t - e, e - n);
}
function oC(e, t) {
  return e ? !t : t;
}
function UY(e, t, n, r, a, o, l, u) {
  let { affectsX: f, affectsY: d } = t;
  const { isHorizontal: m, isVertical: p } = t, x = m && p, { xSnapped: y, ySnapped: w } = n, { minWidth: E, maxWidth: k, minHeight: C, maxHeight: T } = r, { x: N, y: A, width: D, height: M, aspectRatio: O } = e;
  let Y = Math.floor(m ? y - e.pointerX : 0), X = Math.floor(p ? w - e.pointerY : 0);
  const U = D + (f ? -Y : Y), B = M + (d ? -X : X), G = -o[0] * D, re = -o[1] * M;
  let q = Vf(U, E, k), W = Vf(B, C, T);
  if (l) {
    let te = 0, ie = 0;
    f && Y < 0 ? te = Os(N + Y + G, l[0][0]) : !f && Y > 0 && (te = Ds(N + U + G, l[1][0])), d && X < 0 ? ie = Os(A + X + re, l[0][1]) : !d && X > 0 && (ie = Ds(A + B + re, l[1][1])), q = Math.max(q, te), W = Math.max(W, ie);
  }
  if (u) {
    let te = 0, ie = 0;
    f && Y > 0 ? te = Ds(N + Y, u[0][0]) : !f && Y < 0 && (te = Os(N + U, u[1][0])), d && X > 0 ? ie = Ds(A + X, u[0][1]) : !d && X < 0 && (ie = Os(A + B, u[1][1])), q = Math.max(q, te), W = Math.max(W, ie);
  }
  if (a) {
    if (m) {
      const te = Vf(U / O, C, T) * O;
      if (q = Math.max(q, te), l) {
        let ie = 0;
        !f && !d || f && !d && x ? ie = Ds(A + re + U / O, l[1][1]) * O : ie = Os(A + re + (f ? Y : -Y) / O, l[0][1]) * O, q = Math.max(q, ie);
      }
      if (u) {
        let ie = 0;
        !f && !d || f && !d && x ? ie = Os(A + U / O, u[1][1]) * O : ie = Ds(A + (f ? Y : -Y) / O, u[0][1]) * O, q = Math.max(q, ie);
      }
    }
    if (p) {
      const te = Vf(B * O, E, k) / O;
      if (W = Math.max(W, te), l) {
        let ie = 0;
        !f && !d || d && !f && x ? ie = Ds(N + B * O + G, l[1][0]) / O : ie = Os(N + (d ? X : -X) * O + G, l[0][0]) / O, W = Math.max(W, ie);
      }
      if (u) {
        let ie = 0;
        !f && !d || d && !f && x ? ie = Os(N + B * O, u[1][0]) / O : ie = Ds(N + (d ? X : -X) * O, u[0][0]) / O, W = Math.max(W, ie);
      }
    }
  }
  X = X + (X < 0 ? W : -W), Y = Y + (Y < 0 ? q : -q), a && (x ? U > B * O ? X = (oC(f, d) ? -Y : Y) / O : Y = (oC(f, d) ? -X : X) * O : m ? (X = Y / O, d = f) : (Y = X * O, f = d));
  const V = f ? N + Y : N, ee = d ? A + X : A;
  return {
    width: D + (f ? -Y : Y),
    height: M + (d ? -X : X),
    x: o[0] * Y * (f ? -1 : 1) + V,
    y: o[1] * X * (d ? -1 : 1) + ee
  };
}
const fT = { width: 0, height: 0, x: 0, y: 0 }, HY = {
  ...fT,
  pointerX: 0,
  pointerY: 0,
  aspectRatio: 1
};
function GY(e) {
  return [
    [0, 0],
    [e.measured.width, e.measured.height]
  ];
}
function VY(e, t, n) {
  const r = t.position.x + e.position.x, a = t.position.y + e.position.y, o = e.measured.width ?? 0, l = e.measured.height ?? 0, u = n[0] * o, f = n[1] * l;
  return [
    [r - u, a - f],
    [r + o - u, a + l - f]
  ];
}
function KY({ domNode: e, nodeId: t, getStoreItems: n, onChange: r, onEnd: a }) {
  const o = Gr(e);
  let l = {
    controlDirection: sC("bottom-right"),
    boundaries: {
      minWidth: 0,
      minHeight: 0,
      maxWidth: Number.MAX_VALUE,
      maxHeight: Number.MAX_VALUE
    },
    resizeDirection: void 0,
    keepAspectRatio: !1
  };
  function u({ controlPosition: d, boundaries: m, keepAspectRatio: p, resizeDirection: x, onResizeStart: y, onResize: w, onResizeEnd: E, shouldResize: k }) {
    let C = { ...fT }, T = { ...HY };
    l = {
      boundaries: m,
      resizeDirection: x,
      keepAspectRatio: p,
      controlDirection: sC(d)
    };
    let N, A = null, D = [], M, O, Y, X = !1;
    const U = _9().on("start", (B) => {
      const { nodeLookup: G, transform: re, snapGrid: q, snapToGrid: W, nodeOrigin: V, paneDomNode: ee } = n();
      if (N = G.get(t), !N)
        return;
      A = (ee == null ? void 0 : ee.getBoundingClientRect()) ?? null;
      const { xSnapped: te, ySnapped: ie } = $c(B.sourceEvent, {
        transform: re,
        snapGrid: q,
        snapToGrid: W,
        containerBounds: A
      });
      C = {
        width: N.measured.width ?? 0,
        height: N.measured.height ?? 0,
        x: N.position.x ?? 0,
        y: N.position.y ?? 0
      }, T = {
        ...C,
        pointerX: te,
        pointerY: ie,
        aspectRatio: C.width / C.height
      }, M = void 0, N.parentId && (N.extent === "parent" || N.expandParent) && (M = G.get(N.parentId), O = M && N.extent === "parent" ? GY(M) : void 0), D = [], Y = void 0;
      for (const [H, L] of G)
        if (L.parentId === t && (D.push({
          id: H,
          position: { ...L.position },
          extent: L.extent
        }), L.extent === "parent" || L.expandParent)) {
          const J = VY(L, N, L.origin ?? V);
          Y ? Y = [
            [Math.min(J[0][0], Y[0][0]), Math.min(J[0][1], Y[0][1])],
            [Math.max(J[1][0], Y[1][0]), Math.max(J[1][1], Y[1][1])]
          ] : Y = J;
        }
      y == null || y(B, { ...C });
    }).on("drag", (B) => {
      const { transform: G, snapGrid: re, snapToGrid: q, nodeOrigin: W } = n(), V = $c(B.sourceEvent, {
        transform: G,
        snapGrid: re,
        snapToGrid: q,
        containerBounds: A
      }), ee = [];
      if (!N)
        return;
      const { x: te, y: ie, width: H, height: L } = C, J = {}, F = N.origin ?? W, { width: Z, height: oe, x: fe, y: Se } = UY(T, l.controlDirection, V, l.boundaries, l.keepAspectRatio, F, O, Y), Te = Z !== H, we = oe !== L, ke = fe !== te && Te, _e = Se !== ie && we;
      if (!ke && !_e && !Te && !we)
        return;
      if ((ke || _e || F[0] === 1 || F[1] === 1) && (J.x = ke ? fe : C.x, J.y = _e ? Se : C.y, C.x = J.x, C.y = J.y, D.length > 0)) {
        const qe = fe - te, at = Se - ie;
        for (const st of D)
          st.position = {
            x: st.position.x - qe + F[0] * (Z - H),
            y: st.position.y - at + F[1] * (oe - L)
          }, ee.push(st);
      }
      if ((Te || we) && (J.width = Te && (!l.resizeDirection || l.resizeDirection === "horizontal") ? Z : C.width, J.height = we && (!l.resizeDirection || l.resizeDirection === "vertical") ? oe : C.height, C.width = J.width, C.height = J.height), M && N.expandParent) {
        const qe = F[0] * (J.width ?? 0);
        J.x && J.x < qe && (C.x = qe, T.x = T.x - (J.x - qe));
        const at = F[1] * (J.height ?? 0);
        J.y && J.y < at && (C.y = at, T.y = T.y - (J.y - at));
      }
      const Ae = $Y({
        width: C.width,
        prevWidth: H,
        height: C.height,
        prevHeight: L,
        affectsX: l.controlDirection.affectsX,
        affectsY: l.controlDirection.affectsY
      }), Pe = { ...C, direction: Ae };
      (k == null ? void 0 : k(B, Pe)) !== !1 && (X = !0, w == null || w(B, Pe), r(J, ee));
    }).on("end", (B) => {
      X && (E == null || E(B, { ...C }), a == null || a({ ...C }), X = !1);
    });
    o.call(U);
  }
  function f() {
    o.on(".drag", null);
  }
  return {
    update: u,
    destroy: f
  };
}
const { useDebugValue: YY } = m2, { useSyncExternalStoreWithSelector: XY } = gj, WY = (e) => e;
function hT(e, t = WY, n) {
  const r = XY(
    e.subscribe,
    e.getState,
    e.getServerState || e.getInitialState,
    t,
    n
  );
  return YY(r), r;
}
const lC = (e, t) => {
  const n = pj(e), r = (a, o = t) => hT(n, a, o);
  return Object.assign(r, n), r;
}, QY = (e, t) => e ? lC(e, t) : lC;
function ln(e, t) {
  if (Object.is(e, t))
    return !0;
  if (typeof e != "object" || e === null || typeof t != "object" || t === null)
    return !1;
  if (e instanceof Map && t instanceof Map) {
    if (e.size !== t.size) return !1;
    for (const [r, a] of e)
      if (!Object.is(a, t.get(r)))
        return !1;
    return !0;
  }
  if (e instanceof Set && t instanceof Set) {
    if (e.size !== t.size) return !1;
    for (const r of e)
      if (!t.has(r))
        return !1;
    return !0;
  }
  const n = Object.keys(e);
  if (n.length !== Object.keys(t).length)
    return !1;
  for (const r of n)
    if (!Object.prototype.hasOwnProperty.call(t, r) || !Object.is(e[r], t[r]))
      return !1;
  return !0;
}
const nm = P.createContext(null), ZY = nm.Provider, mT = ta.error001();
function Nt(e, t) {
  const n = P.useContext(nm);
  if (n === null)
    throw new Error(mT);
  return hT(n, e, t);
}
function un() {
  const e = P.useContext(nm);
  if (e === null)
    throw new Error(mT);
  return P.useMemo(() => ({
    getState: e.getState,
    setState: e.setState,
    subscribe: e.subscribe
  }), [e]);
}
const uC = { display: "none" }, JY = {
  position: "absolute",
  width: 1,
  height: 1,
  margin: -1,
  border: 0,
  padding: 0,
  overflow: "hidden",
  clip: "rect(0px, 0px, 0px, 0px)",
  clipPath: "inset(100%)"
}, pT = "react-flow__node-desc", gT = "react-flow__edge-desc", eX = "react-flow__aria-live", tX = (e) => e.ariaLiveMessage, nX = (e) => e.ariaLabelConfig;
function rX({ rfId: e }) {
  const t = Nt(tX);
  return h.jsx("div", { id: `${eX}-${e}`, "aria-live": "assertive", "aria-atomic": "true", style: JY, children: t });
}
function iX({ rfId: e, disableKeyboardA11y: t }) {
  const n = Nt(nX);
  return h.jsxs(h.Fragment, { children: [h.jsx("div", { id: `${pT}-${e}`, style: uC, children: t ? n["node.a11yDescription.default"] : n["node.a11yDescription.keyboardDisabled"] }), h.jsx("div", { id: `${gT}-${e}`, style: uC, children: n["edge.a11yDescription.default"] }), !t && h.jsx(rX, { rfId: e })] });
}
const rm = P.forwardRef(({ position: e = "top-left", children: t, className: n, style: r, ...a }, o) => {
  const l = `${e}`.split("-");
  return h.jsx("div", { className: On(["react-flow__panel", n, ...l]), style: r, ref: o, ...a, children: t });
});
rm.displayName = "Panel";
function aX({ proOptions: e, position: t = "bottom-right" }) {
  return e != null && e.hideAttribution ? null : h.jsx(rm, { position: t, className: "react-flow__attribution", "data-message": "Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev", children: h.jsx("a", { href: "https://reactflow.dev", target: "_blank", rel: "noopener noreferrer", "aria-label": "React Flow attribution", children: "React Flow" }) });
}
const sX = (e) => {
  const t = [], n = [];
  for (const [, r] of e.nodeLookup)
    r.selected && t.push(r.internals.userNode);
  for (const [, r] of e.edgeLookup)
    r.selected && n.push(r);
  return { selectedNodes: t, selectedEdges: n };
}, Kf = (e) => e.id;
function oX(e, t) {
  return ln(e.selectedNodes.map(Kf), t.selectedNodes.map(Kf)) && ln(e.selectedEdges.map(Kf), t.selectedEdges.map(Kf));
}
function lX({ onSelectionChange: e }) {
  const t = un(), { selectedNodes: n, selectedEdges: r } = Nt(sX, oX);
  return P.useEffect(() => {
    const a = { nodes: n, edges: r };
    e == null || e(a), t.getState().onSelectionChangeHandlers.forEach((o) => o(a));
  }, [n, r, e]), null;
}
const uX = (e) => !!e.onSelectionChangeHandlers;
function cX({ onSelectionChange: e }) {
  const t = Nt(uX);
  return e || t ? h.jsx(lX, { onSelectionChange: e }) : null;
}
const yT = [0, 0], dX = { x: 0, y: 0, zoom: 1 }, fX = [
  "nodes",
  "edges",
  "defaultNodes",
  "defaultEdges",
  "onConnect",
  "onConnectStart",
  "onConnectEnd",
  "onClickConnectStart",
  "onClickConnectEnd",
  "nodesDraggable",
  "autoPanOnNodeFocus",
  "nodesConnectable",
  "nodesFocusable",
  "edgesFocusable",
  "edgesReconnectable",
  "elevateNodesOnSelect",
  "elevateEdgesOnSelect",
  "minZoom",
  "maxZoom",
  "nodeExtent",
  "onNodesChange",
  "onEdgesChange",
  "elementsSelectable",
  "connectionMode",
  "snapGrid",
  "snapToGrid",
  "translateExtent",
  "connectOnClick",
  "defaultEdgeOptions",
  "fitView",
  "fitViewOptions",
  "onNodesDelete",
  "onEdgesDelete",
  "onDelete",
  "onNodeDrag",
  "onNodeDragStart",
  "onNodeDragStop",
  "onSelectionDrag",
  "onSelectionDragStart",
  "onSelectionDragStop",
  "onMoveStart",
  "onMove",
  "onMoveEnd",
  "noPanClassName",
  "nodeOrigin",
  "autoPanOnConnect",
  "autoPanOnNodeDrag",
  "onError",
  "connectionRadius",
  "isValidConnection",
  "selectNodesOnDrag",
  "nodeDragThreshold",
  "connectionDragThreshold",
  "onBeforeDelete",
  "debug",
  "autoPanSpeed",
  "ariaLabelConfig",
  "zIndexMode"
], cC = [...fX, "rfId"], hX = (e) => ({
  setNodes: e.setNodes,
  setEdges: e.setEdges,
  setMinZoom: e.setMinZoom,
  setMaxZoom: e.setMaxZoom,
  setTranslateExtent: e.setTranslateExtent,
  setNodeExtent: e.setNodeExtent,
  reset: e.reset,
  setDefaultNodesAndEdges: e.setDefaultNodesAndEdges
}), dC = {
  /*
   * these are values that are also passed directly to other components
   * than the StoreUpdater. We can reduce the number of setStore calls
   * by setting the same values here as prev fields.
   */
  translateExtent: Zc,
  nodeOrigin: yT,
  minZoom: 0.5,
  maxZoom: 2,
  elementsSelectable: !0,
  noPanClassName: "nopan",
  rfId: "1"
};
function mX(e) {
  const { setNodes: t, setEdges: n, setMinZoom: r, setMaxZoom: a, setTranslateExtent: o, setNodeExtent: l, reset: u, setDefaultNodesAndEdges: f } = Nt(hX, ln), d = un();
  P.useEffect(() => (f(e.defaultNodes, e.defaultEdges), () => {
    m.current = dC, u();
  }), []);
  const m = P.useRef(dC);
  return P.useEffect(
    () => {
      for (const p of cC) {
        const x = e[p], y = m.current[p];
        x !== y && (typeof e[p] > "u" || (p === "nodes" ? t(x) : p === "edges" ? n(x) : p === "minZoom" ? r(x) : p === "maxZoom" ? a(x) : p === "translateExtent" ? o(x) : p === "nodeExtent" ? l(x) : p === "ariaLabelConfig" ? d.setState({ ariaLabelConfig: aY(x) }) : p === "fitView" ? d.setState({ fitViewQueued: x }) : p === "fitViewOptions" ? d.setState({ fitViewOptions: x }) : d.setState({ [p]: x })));
      }
      m.current = e;
    },
    // Only re-run the effect if one of the fields we track changes
    cC.map((p) => e[p])
  ), null;
}
function fC() {
  return typeof window > "u" || !window.matchMedia ? null : window.matchMedia("(prefers-color-scheme: dark)");
}
function pX(e) {
  var r;
  const [t, n] = P.useState(e === "system" ? null : e);
  return P.useEffect(() => {
    if (e !== "system") {
      n(e);
      return;
    }
    const a = fC(), o = () => n(a != null && a.matches ? "dark" : "light");
    return o(), a == null || a.addEventListener("change", o), () => {
      a == null || a.removeEventListener("change", o);
    };
  }, [e]), t !== null ? t : (r = fC()) != null && r.matches ? "dark" : "light";
}
const hC = typeof document < "u" ? document : null;
function rd(e = null, t = { target: hC, actInsideInputWithModifier: !0 }) {
  const [n, r] = P.useState(!1), a = P.useRef(!1), o = P.useRef(/* @__PURE__ */ new Set([])), [l, u] = P.useMemo(() => {
    if (e !== null) {
      const d = (Array.isArray(e) ? e : [e]).filter((p) => typeof p == "string").map((p) => p.replace("+", `
`).replace(`

`, `
+`).split(`
`)), m = d.reduce((p, x) => p.concat(...x), []);
      return [d, m];
    }
    return [[], []];
  }, [e]);
  return P.useEffect(() => {
    const f = (t == null ? void 0 : t.target) ?? hC, d = (t == null ? void 0 : t.actInsideInputWithModifier) ?? !0;
    if (e !== null) {
      const m = (y) => {
        var k, C;
        if (a.current = y.ctrlKey || y.metaKey || y.shiftKey || y.altKey, (!a.current || a.current && !d) && W9(y))
          return !1;
        const E = pC(y.code, u);
        if (o.current.add(y[E]), mC(l, o.current, !1)) {
          const T = ((C = (k = y.composedPath) == null ? void 0 : k.call(y)) == null ? void 0 : C[0]) || y.target, N = (T == null ? void 0 : T.nodeName) === "BUTTON" || (T == null ? void 0 : T.nodeName) === "A";
          t.preventDefault !== !1 && (a.current || !N) && y.preventDefault(), r(!0);
        }
      }, p = (y) => {
        const w = pC(y.code, u);
        mC(l, o.current, !0) ? (r(!1), o.current.clear()) : o.current.delete(y[w]), y.key === "Meta" && o.current.clear(), a.current = !1;
      }, x = () => {
        o.current.clear(), r(!1);
      };
      return f == null || f.addEventListener("keydown", m), f == null || f.addEventListener("keyup", p), window.addEventListener("blur", x), window.addEventListener("contextmenu", x), () => {
        f == null || f.removeEventListener("keydown", m), f == null || f.removeEventListener("keyup", p), window.removeEventListener("blur", x), window.removeEventListener("contextmenu", x);
      };
    }
  }, [e, r]), n;
}
function mC(e, t, n) {
  return e.filter((r) => n || r.length === t.size).some((r) => r.every((a) => t.has(a)));
}
function pC(e, t) {
  return t.includes(e) ? "code" : "key";
}
const gX = () => {
  const e = un();
  return P.useMemo(() => ({
    zoomIn: (t) => {
      const { panZoom: n } = e.getState();
      return n ? n.scaleBy(1.2, { duration: t == null ? void 0 : t.duration }) : Promise.resolve(!1);
    },
    zoomOut: (t) => {
      const { panZoom: n } = e.getState();
      return n ? n.scaleBy(1 / 1.2, { duration: t == null ? void 0 : t.duration }) : Promise.resolve(!1);
    },
    zoomTo: (t, n) => {
      const { panZoom: r } = e.getState();
      return r ? r.scaleTo(t, { duration: n == null ? void 0 : n.duration }) : Promise.resolve(!1);
    },
    getZoom: () => e.getState().transform[2],
    setViewport: async (t, n) => {
      const { transform: [r, a, o], panZoom: l } = e.getState();
      return l ? (await l.setViewport({
        x: t.x ?? r,
        y: t.y ?? a,
        zoom: t.zoom ?? o
      }, n), Promise.resolve(!0)) : Promise.resolve(!1);
    },
    getViewport: () => {
      const [t, n, r] = e.getState().transform;
      return { x: t, y: n, zoom: r };
    },
    setCenter: async (t, n, r) => e.getState().setCenter(t, n, r),
    fitBounds: async (t, n) => {
      const { width: r, height: a, minZoom: o, maxZoom: l, panZoom: u } = e.getState(), f = aw(t, r, a, o, l, (n == null ? void 0 : n.padding) ?? 0.1);
      return u ? (await u.setViewport(f, {
        duration: n == null ? void 0 : n.duration,
        ease: n == null ? void 0 : n.ease,
        interpolate: n == null ? void 0 : n.interpolate
      }), Promise.resolve(!0)) : Promise.resolve(!1);
    },
    screenToFlowPosition: (t, n = {}) => {
      const { transform: r, snapGrid: a, snapToGrid: o, domNode: l } = e.getState();
      if (!l)
        return t;
      const { x: u, y: f } = l.getBoundingClientRect(), d = {
        x: t.x - u,
        y: t.y - f
      }, m = n.snapGrid ?? a, p = n.snapToGrid ?? o;
      return md(d, r, p, m);
    },
    flowToScreenPosition: (t) => {
      const { transform: n, domNode: r } = e.getState();
      if (!r)
        return t;
      const { x: a, y: o } = r.getBoundingClientRect(), l = Th(t, n);
      return {
        x: l.x + a,
        y: l.y + o
      };
    }
  }), []);
};
function xT(e, t) {
  const n = [], r = /* @__PURE__ */ new Map(), a = [];
  for (const o of e)
    if (o.type === "add") {
      a.push(o);
      continue;
    } else if (o.type === "remove" || o.type === "replace")
      r.set(o.id, [o]);
    else {
      const l = r.get(o.id);
      l ? l.push(o) : r.set(o.id, [o]);
    }
  for (const o of t) {
    const l = r.get(o.id);
    if (!l) {
      n.push(o);
      continue;
    }
    if (l[0].type === "remove")
      continue;
    if (l[0].type === "replace") {
      n.push({ ...l[0].item });
      continue;
    }
    const u = { ...o };
    for (const f of l)
      yX(f, u);
    n.push(u);
  }
  return a.length && a.forEach((o) => {
    o.index !== void 0 ? n.splice(o.index, 0, { ...o.item }) : n.push({ ...o.item });
  }), n;
}
function yX(e, t) {
  switch (e.type) {
    case "select": {
      t.selected = e.selected;
      break;
    }
    case "position": {
      typeof e.position < "u" && (t.position = e.position), typeof e.dragging < "u" && (t.dragging = e.dragging);
      break;
    }
    case "dimensions": {
      typeof e.dimensions < "u" && (t.measured = {
        ...e.dimensions
      }, e.setAttributes && ((e.setAttributes === !0 || e.setAttributes === "width") && (t.width = e.dimensions.width), (e.setAttributes === !0 || e.setAttributes === "height") && (t.height = e.dimensions.height))), typeof e.resizing == "boolean" && (t.resizing = e.resizing);
      break;
    }
  }
}
function vT(e, t) {
  return xT(e, t);
}
function bT(e, t) {
  return xT(e, t);
}
function wo(e, t) {
  return {
    id: e,
    type: "select",
    selected: t
  };
}
function Xl(e, t = /* @__PURE__ */ new Set(), n = !1) {
  const r = [];
  for (const [a, o] of e) {
    const l = t.has(a);
    !(o.selected === void 0 && !l) && o.selected !== l && (n && (o.selected = l), r.push(wo(o.id, l)));
  }
  return r;
}
function gC({ items: e = [], lookup: t }) {
  var a;
  const n = [], r = new Map(e.map((o) => [o.id, o]));
  for (const [o, l] of e.entries()) {
    const u = t.get(l.id), f = ((a = u == null ? void 0 : u.internals) == null ? void 0 : a.userNode) ?? u;
    f !== void 0 && f !== l && n.push({ id: l.id, item: l, type: "replace" }), f === void 0 && n.push({ item: l, type: "add", index: o });
  }
  for (const [o] of t)
    r.get(o) === void 0 && n.push({ id: o, type: "remove" });
  return n;
}
function yC(e) {
  return {
    id: e.id,
    type: "remove"
  };
}
const xC = (e) => XK(e), xX = (e) => $9(e);
function wT(e) {
  return P.forwardRef(e);
}
const vX = typeof window < "u" ? P.useLayoutEffect : P.useEffect;
function vC(e) {
  const [t, n] = P.useState(BigInt(0)), [r] = P.useState(() => bX(() => n((a) => a + BigInt(1))));
  return vX(() => {
    const a = r.get();
    a.length && (e(a), r.reset());
  }, [t]), r;
}
function bX(e) {
  let t = [];
  return {
    get: () => t,
    reset: () => {
      t = [];
    },
    push: (n) => {
      t.push(n), e();
    }
  };
}
const _T = P.createContext(null);
function wX({ children: e }) {
  const t = un(), n = P.useCallback((u) => {
    const { nodes: f = [], setNodes: d, hasDefaultNodes: m, onNodesChange: p, nodeLookup: x, fitViewQueued: y, onNodesChangeMiddlewareMap: w } = t.getState();
    let E = f;
    for (const C of u)
      E = typeof C == "function" ? C(E) : C;
    let k = gC({
      items: E,
      lookup: x
    });
    for (const C of w.values())
      k = C(k);
    m && d(E), k.length > 0 ? p == null || p(k) : y && window.requestAnimationFrame(() => {
      const { fitViewQueued: C, nodes: T, setNodes: N } = t.getState();
      C && N(T);
    });
  }, []), r = vC(n), a = P.useCallback((u) => {
    const { edges: f = [], setEdges: d, hasDefaultEdges: m, onEdgesChange: p, edgeLookup: x } = t.getState();
    let y = f;
    for (const w of u)
      y = typeof w == "function" ? w(y) : w;
    m ? d(y) : p && p(gC({
      items: y,
      lookup: x
    }));
  }, []), o = vC(a), l = P.useMemo(() => ({ nodeQueue: r, edgeQueue: o }), []);
  return h.jsx(_T.Provider, { value: l, children: e });
}
function _X() {
  const e = P.useContext(_T);
  if (!e)
    throw new Error("useBatchContext must be used within a BatchProvider");
  return e;
}
const SX = (e) => !!e.panZoom;
function fw() {
  const e = gX(), t = un(), n = _X(), r = Nt(SX), a = P.useMemo(() => {
    const o = (p) => t.getState().nodeLookup.get(p), l = (p) => {
      n.nodeQueue.push(p);
    }, u = (p) => {
      n.edgeQueue.push(p);
    }, f = (p) => {
      var C, T;
      const { nodeLookup: x, nodeOrigin: y } = t.getState(), w = xC(p) ? p : x.get(p.id), E = w.parentId ? Y9(w.position, w.measured, w.parentId, x, y) : w.position, k = {
        ...w,
        position: E,
        width: ((C = w.measured) == null ? void 0 : C.width) ?? w.width,
        height: ((T = w.measured) == null ? void 0 : T.height) ?? w.height
      };
      return au(k);
    }, d = (p, x, y = { replace: !1 }) => {
      l((w) => w.map((E) => {
        if (E.id === p) {
          const k = typeof x == "function" ? x(E) : x;
          return y.replace && xC(k) ? k : { ...E, ...k };
        }
        return E;
      }));
    }, m = (p, x, y = { replace: !1 }) => {
      u((w) => w.map((E) => {
        if (E.id === p) {
          const k = typeof x == "function" ? x(E) : x;
          return y.replace && xX(k) ? k : { ...E, ...k };
        }
        return E;
      }));
    };
    return {
      getNodes: () => t.getState().nodes.map((p) => ({ ...p })),
      getNode: (p) => {
        var x;
        return (x = o(p)) == null ? void 0 : x.internals.userNode;
      },
      getInternalNode: o,
      getEdges: () => {
        const { edges: p = [] } = t.getState();
        return p.map((x) => ({ ...x }));
      },
      getEdge: (p) => t.getState().edgeLookup.get(p),
      setNodes: l,
      setEdges: u,
      addNodes: (p) => {
        const x = Array.isArray(p) ? p : [p];
        n.nodeQueue.push((y) => [...y, ...x]);
      },
      addEdges: (p) => {
        const x = Array.isArray(p) ? p : [p];
        n.edgeQueue.push((y) => [...y, ...x]);
      },
      toObject: () => {
        const { nodes: p = [], edges: x = [], transform: y } = t.getState(), [w, E, k] = y;
        return {
          nodes: p.map((C) => ({ ...C })),
          edges: x.map((C) => ({ ...C })),
          viewport: {
            x: w,
            y: E,
            zoom: k
          }
        };
      },
      deleteElements: async ({ nodes: p = [], edges: x = [] }) => {
        const { nodes: y, edges: w, onNodesDelete: E, onEdgesDelete: k, triggerNodeChanges: C, triggerEdgeChanges: T, onDelete: N, onBeforeDelete: A } = t.getState(), { nodes: D, edges: M } = await eY({
          nodesToRemove: p,
          edgesToRemove: x,
          nodes: y,
          edges: w,
          onBeforeDelete: A
        }), O = M.length > 0, Y = D.length > 0;
        if (O) {
          const X = M.map(yC);
          k == null || k(M), T(X);
        }
        if (Y) {
          const X = D.map(yC);
          E == null || E(D), C(X);
        }
        return (Y || O) && (N == null || N({ nodes: D, edges: M })), { deletedNodes: D, deletedEdges: M };
      },
      /**
       * Partial is defined as "the 2 nodes/areas are intersecting partially".
       * If a is contained in b or b is contained in a, they are both
       * considered fully intersecting.
       */
      getIntersectingNodes: (p, x = !0, y) => {
        const w = XS(p), E = w ? p : f(p), k = y !== void 0;
        return E ? (y || t.getState().nodes).filter((C) => {
          const T = t.getState().nodeLookup.get(C.id);
          if (T && !w && (C.id === p.id || !T.internals.positionAbsolute))
            return !1;
          const N = au(k ? C : T), A = td(N, E);
          return x && A > 0 || A >= N.width * N.height || A >= E.width * E.height;
        }) : [];
      },
      isNodeIntersecting: (p, x, y = !0) => {
        const E = XS(p) ? p : f(p);
        if (!E)
          return !1;
        const k = td(E, x);
        return y && k > 0 || k >= x.width * x.height || k >= E.width * E.height;
      },
      updateNode: d,
      updateNodeData: (p, x, y = { replace: !1 }) => {
        d(p, (w) => {
          const E = typeof x == "function" ? x(w) : x;
          return y.replace ? { ...w, data: E } : { ...w, data: { ...w.data, ...E } };
        }, y);
      },
      updateEdge: m,
      updateEdgeData: (p, x, y = { replace: !1 }) => {
        m(p, (w) => {
          const E = typeof x == "function" ? x(w) : x;
          return y.replace ? { ...w, data: E } : { ...w, data: { ...w.data, ...E } };
        }, y);
      },
      getNodesBounds: (p) => {
        const { nodeLookup: x, nodeOrigin: y } = t.getState();
        return WK(p, { nodeLookup: x, nodeOrigin: y });
      },
      getHandleConnections: ({ type: p, id: x, nodeId: y }) => {
        var w;
        return Array.from(((w = t.getState().connectionLookup.get(`${y}-${p}${x ? `-${x}` : ""}`)) == null ? void 0 : w.values()) ?? []);
      },
      getNodeConnections: ({ type: p, handleId: x, nodeId: y }) => {
        var w;
        return Array.from(((w = t.getState().connectionLookup.get(`${y}${p ? x ? `-${p}-${x}` : `-${p}` : ""}`)) == null ? void 0 : w.values()) ?? []);
      },
      fitView: async (p) => {
        const x = t.getState().fitViewResolver ?? iY();
        return t.setState({ fitViewQueued: !0, fitViewOptions: p, fitViewResolver: x }), n.nodeQueue.push((y) => [...y]), x.promise;
      }
    };
  }, []);
  return P.useMemo(() => ({
    ...a,
    ...e,
    viewportInitialized: r
  }), [r]);
}
const bC = (e) => e.selected, CX = typeof window < "u" ? window : void 0;
function EX({ deleteKeyCode: e, multiSelectionKeyCode: t }) {
  const n = un(), { deleteElements: r } = fw(), a = rd(e, { actInsideInputWithModifier: !1 }), o = rd(t, { target: CX });
  P.useEffect(() => {
    if (a) {
      const { edges: l, nodes: u } = n.getState();
      r({ nodes: u.filter(bC), edges: l.filter(bC) }), n.setState({ nodesSelectionActive: !1 });
    }
  }, [a]), P.useEffect(() => {
    n.setState({ multiSelectionActive: o });
  }, [o]);
}
function kX(e) {
  const t = un();
  P.useEffect(() => {
    const n = () => {
      var a, o, l, u;
      if (!e.current || !(((o = (a = e.current).checkVisibility) == null ? void 0 : o.call(a)) ?? !0))
        return !1;
      const r = sw(e.current);
      (r.height === 0 || r.width === 0) && ((u = (l = t.getState()).onError) == null || u.call(l, "004", ta.error004())), t.setState({ width: r.width || 500, height: r.height || 500 });
    };
    if (e.current) {
      n(), window.addEventListener("resize", n);
      const r = new ResizeObserver(() => n());
      return r.observe(e.current), () => {
        window.removeEventListener("resize", n), r && e.current && r.unobserve(e.current);
      };
    }
  }, []);
}
const im = {
  position: "absolute",
  width: "100%",
  height: "100%",
  top: 0,
  left: 0
}, NX = (e) => ({
  userSelectionActive: e.userSelectionActive,
  lib: e.lib,
  connectionInProgress: e.connection.inProgress
});
function jX({ onPaneContextMenu: e, zoomOnScroll: t = !0, zoomOnPinch: n = !0, panOnScroll: r = !1, panOnScrollSpeed: a = 0.5, panOnScrollMode: o = Mo.Free, zoomOnDoubleClick: l = !0, panOnDrag: u = !0, defaultViewport: f, translateExtent: d, minZoom: m, maxZoom: p, zoomActivationKeyCode: x, preventScrolling: y = !0, children: w, noWheelClassName: E, noPanClassName: k, onViewportChange: C, isControlledViewport: T, paneClickDistance: N, selectionOnDrag: A }) {
  const D = un(), M = P.useRef(null), { userSelectionActive: O, lib: Y, connectionInProgress: X } = Nt(NX, ln), U = rd(x), B = P.useRef();
  kX(M);
  const G = P.useCallback((re) => {
    C == null || C({ x: re[0], y: re[1], zoom: re[2] }), T || D.setState({ transform: re });
  }, [C, T]);
  return P.useEffect(() => {
    if (M.current) {
      B.current = FY({
        domNode: M.current,
        minZoom: m,
        maxZoom: p,
        translateExtent: d,
        viewport: f,
        onDraggingChange: (V) => D.setState({ paneDragging: V }),
        onPanZoomStart: (V, ee) => {
          const { onViewportChangeStart: te, onMoveStart: ie } = D.getState();
          ie == null || ie(V, ee), te == null || te(ee);
        },
        onPanZoom: (V, ee) => {
          const { onViewportChange: te, onMove: ie } = D.getState();
          ie == null || ie(V, ee), te == null || te(ee);
        },
        onPanZoomEnd: (V, ee) => {
          const { onViewportChangeEnd: te, onMoveEnd: ie } = D.getState();
          ie == null || ie(V, ee), te == null || te(ee);
        }
      });
      const { x: re, y: q, zoom: W } = B.current.getViewport();
      return D.setState({
        panZoom: B.current,
        transform: [re, q, W],
        domNode: M.current.closest(".react-flow")
      }), () => {
        var V;
        (V = B.current) == null || V.destroy();
      };
    }
  }, []), P.useEffect(() => {
    var re;
    (re = B.current) == null || re.update({
      onPaneContextMenu: e,
      zoomOnScroll: t,
      zoomOnPinch: n,
      panOnScroll: r,
      panOnScrollSpeed: a,
      panOnScrollMode: o,
      zoomOnDoubleClick: l,
      panOnDrag: u,
      zoomActivationKeyPressed: U,
      preventScrolling: y,
      noPanClassName: k,
      userSelectionActive: O,
      noWheelClassName: E,
      lib: Y,
      onTransformChange: G,
      connectionInProgress: X,
      selectionOnDrag: A,
      paneClickDistance: N
    });
  }, [
    e,
    t,
    n,
    r,
    a,
    o,
    l,
    u,
    U,
    y,
    k,
    O,
    E,
    Y,
    G,
    X,
    A,
    N
  ]), h.jsx("div", { className: "react-flow__renderer", ref: M, style: im, children: w });
}
const TX = (e) => ({
  userSelectionActive: e.userSelectionActive,
  userSelectionRect: e.userSelectionRect
});
function AX() {
  const { userSelectionActive: e, userSelectionRect: t } = Nt(TX, ln);
  return e && t ? h.jsx("div", { className: "react-flow__selection react-flow__container", style: {
    width: t.width,
    height: t.height,
    transform: `translate(${t.x}px, ${t.y}px)`
  } }) : null;
}
const i0 = (e, t) => (n) => {
  n.target === t.current && (e == null || e(n));
}, MX = (e) => ({
  userSelectionActive: e.userSelectionActive,
  elementsSelectable: e.elementsSelectable,
  connectionInProgress: e.connection.inProgress,
  dragging: e.paneDragging
});
function RX({ isSelecting: e, selectionKeyPressed: t, selectionMode: n = Jc.Full, panOnDrag: r, paneClickDistance: a, selectionOnDrag: o, onSelectionStart: l, onSelectionEnd: u, onPaneClick: f, onPaneContextMenu: d, onPaneScroll: m, onPaneMouseEnter: p, onPaneMouseMove: x, onPaneMouseLeave: y, children: w }) {
  const E = un(), { userSelectionActive: k, elementsSelectable: C, dragging: T, connectionInProgress: N } = Nt(MX, ln), A = C && (e || k), D = P.useRef(null), M = P.useRef(), O = P.useRef(/* @__PURE__ */ new Set()), Y = P.useRef(/* @__PURE__ */ new Set()), X = P.useRef(!1), U = (te) => {
    if (X.current || N) {
      X.current = !1;
      return;
    }
    f == null || f(te), E.getState().resetSelectedElements(), E.setState({ nodesSelectionActive: !1 });
  }, B = (te) => {
    if (Array.isArray(r) && (r != null && r.includes(2))) {
      te.preventDefault();
      return;
    }
    d == null || d(te);
  }, G = m ? (te) => m(te) : void 0, re = (te) => {
    X.current && (te.stopPropagation(), X.current = !1);
  }, q = (te) => {
    var oe, fe;
    const { domNode: ie } = E.getState();
    if (M.current = ie == null ? void 0 : ie.getBoundingClientRect(), !M.current)
      return;
    const H = te.target === D.current;
    if (!H && !!te.target.closest(".nokey") || !e || !(o && H || t) || te.button !== 0 || !te.isPrimary)
      return;
    (fe = (oe = te.target) == null ? void 0 : oe.setPointerCapture) == null || fe.call(oe, te.pointerId), X.current = !1;
    const { x: F, y: Z } = Ai(te.nativeEvent, M.current);
    E.setState({
      userSelectionRect: {
        width: 0,
        height: 0,
        startX: F,
        startY: Z,
        x: F,
        y: Z
      }
    }), H || (te.stopPropagation(), te.preventDefault());
  }, W = (te) => {
    const { userSelectionRect: ie, transform: H, nodeLookup: L, edgeLookup: J, connectionLookup: F, triggerNodeChanges: Z, triggerEdgeChanges: oe, defaultEdgeOptions: fe, resetSelectedElements: Se } = E.getState();
    if (!M.current || !ie)
      return;
    const { x: Te, y: we } = Ai(te.nativeEvent, M.current), { startX: ke, startY: _e } = ie;
    if (!X.current) {
      const at = t ? 0 : a;
      if (Math.hypot(Te - ke, we - _e) <= at)
        return;
      Se(), l == null || l(te);
    }
    X.current = !0;
    const Ae = {
      startX: ke,
      startY: _e,
      x: Te < ke ? Te : ke,
      y: we < _e ? we : _e,
      width: Math.abs(Te - ke),
      height: Math.abs(we - _e)
    }, Pe = O.current, Qe = Y.current;
    O.current = new Set(iw(L, Ae, H, n === Jc.Partial, !0).map((at) => at.id)), Y.current = /* @__PURE__ */ new Set();
    const qe = (fe == null ? void 0 : fe.selectable) ?? !0;
    for (const at of O.current) {
      const st = F.get(at);
      if (st)
        for (const { edgeId: mn } of st.values()) {
          const Jt = J.get(mn);
          Jt && (Jt.selectable ?? qe) && Y.current.add(mn);
        }
    }
    if (!WS(Pe, O.current)) {
      const at = Xl(L, O.current, !0);
      Z(at);
    }
    if (!WS(Qe, Y.current)) {
      const at = Xl(J, Y.current);
      oe(at);
    }
    E.setState({
      userSelectionRect: Ae,
      userSelectionActive: !0,
      nodesSelectionActive: !1
    });
  }, V = (te) => {
    var ie, H;
    te.button === 0 && ((H = (ie = te.target) == null ? void 0 : ie.releasePointerCapture) == null || H.call(ie, te.pointerId), !k && te.target === D.current && E.getState().userSelectionRect && (U == null || U(te)), E.setState({
      userSelectionActive: !1,
      userSelectionRect: null
    }), X.current && (u == null || u(te), E.setState({
      nodesSelectionActive: O.current.size > 0
    })));
  }, ee = r === !0 || Array.isArray(r) && r.includes(0);
  return h.jsxs("div", { className: On(["react-flow__pane", { draggable: ee, dragging: T, selection: e }]), onClick: A ? void 0 : i0(U, D), onContextMenu: i0(B, D), onWheel: i0(G, D), onPointerEnter: A ? void 0 : p, onPointerMove: A ? W : x, onPointerUp: A ? V : void 0, onPointerDownCapture: A ? q : void 0, onClickCapture: A ? re : void 0, onPointerLeave: y, ref: D, style: im, children: [w, h.jsx(AX, {})] });
}
function h2({ id: e, store: t, unselect: n = !1, nodeRef: r }) {
  const { addSelectedNodes: a, unselectNodesAndEdges: o, multiSelectionActive: l, nodeLookup: u, onError: f } = t.getState(), d = u.get(e);
  if (!d) {
    f == null || f("012", ta.error012(e));
    return;
  }
  t.setState({ nodesSelectionActive: !1 }), d.selected ? (n || d.selected && l) && (o({ nodes: [d], edges: [] }), requestAnimationFrame(() => {
    var m;
    return (m = r == null ? void 0 : r.current) == null ? void 0 : m.blur();
  })) : a([e]);
}
function ST({ nodeRef: e, disabled: t = !1, noDragClassName: n, handleSelector: r, nodeId: a, isSelectable: o, nodeClickDistance: l }) {
  const u = un(), [f, d] = P.useState(!1), m = P.useRef();
  return P.useEffect(() => {
    m.current = NY({
      getStoreItems: () => u.getState(),
      onNodeMouseDown: (p) => {
        h2({
          id: p,
          store: u,
          nodeRef: e
        });
      },
      onDragStart: () => {
        d(!0);
      },
      onDragStop: () => {
        d(!1);
      }
    });
  }, []), P.useEffect(() => {
    var p, x;
    if (t)
      (p = m.current) == null || p.destroy();
    else if (e.current)
      return (x = m.current) == null || x.update({
        noDragClassName: n,
        handleSelector: r,
        domNode: e.current,
        isSelectable: o,
        nodeId: a,
        nodeClickDistance: l
      }), () => {
        var y;
        (y = m.current) == null || y.destroy();
      };
  }, [n, r, t, o, e, a]), f;
}
const zX = (e) => (t) => t.selected && (t.draggable || e && typeof t.draggable > "u");
function CT() {
  const e = un();
  return P.useCallback((n) => {
    const { nodeExtent: r, snapToGrid: a, snapGrid: o, nodesDraggable: l, onError: u, updateNodePositions: f, nodeLookup: d, nodeOrigin: m } = e.getState(), p = /* @__PURE__ */ new Map(), x = zX(l), y = a ? o[0] : 5, w = a ? o[1] : 5, E = n.direction.x * y * n.factor, k = n.direction.y * w * n.factor;
    for (const [, C] of d) {
      if (!x(C))
        continue;
      let T = {
        x: C.internals.positionAbsolute.x + E,
        y: C.internals.positionAbsolute.y + k
      };
      a && (T = hd(T, o));
      const { position: N, positionAbsolute: A } = U9({
        nodeId: C.id,
        nextPosition: T,
        nodeLookup: d,
        nodeExtent: r,
        nodeOrigin: m,
        onError: u
      });
      C.position = N, C.internals.positionAbsolute = A, p.set(C.id, C);
    }
    f(p);
  }, []);
}
const hw = P.createContext(null), OX = hw.Provider;
hw.Consumer;
const ET = () => P.useContext(hw), DX = (e) => ({
  connectOnClick: e.connectOnClick,
  noPanClassName: e.noPanClassName,
  rfId: e.rfId
}), IX = (e, t, n) => (r) => {
  const { connectionClickStartHandle: a, connectionMode: o, connection: l } = r, { fromHandle: u, toHandle: f, isValid: d } = l, m = (f == null ? void 0 : f.nodeId) === e && (f == null ? void 0 : f.id) === t && (f == null ? void 0 : f.type) === n;
  return {
    connectingFrom: (u == null ? void 0 : u.nodeId) === e && (u == null ? void 0 : u.id) === t && (u == null ? void 0 : u.type) === n,
    connectingTo: m,
    clickConnecting: (a == null ? void 0 : a.nodeId) === e && (a == null ? void 0 : a.id) === t && (a == null ? void 0 : a.type) === n,
    isPossibleEndHandle: o === ru.Strict ? (u == null ? void 0 : u.type) !== n : e !== (u == null ? void 0 : u.nodeId) || t !== (u == null ? void 0 : u.id),
    connectionInProcess: !!u,
    clickConnectionInProcess: !!a,
    valid: m && d
  };
};
function LX({ type: e = "source", position: t = et.Top, isValidConnection: n, isConnectable: r = !0, isConnectableStart: a = !0, isConnectableEnd: o = !0, id: l, onConnect: u, children: f, className: d, onMouseDown: m, onTouchStart: p, ...x }, y) {
  var W, V;
  const w = l || null, E = e === "target", k = un(), C = ET(), { connectOnClick: T, noPanClassName: N, rfId: A } = Nt(DX, ln), { connectingFrom: D, connectingTo: M, clickConnecting: O, isPossibleEndHandle: Y, connectionInProcess: X, clickConnectionInProcess: U, valid: B } = Nt(IX(C, w, e), ln);
  C || (V = (W = k.getState()).onError) == null || V.call(W, "010", ta.error010());
  const G = (ee) => {
    const { defaultEdgeOptions: te, onConnect: ie, hasDefaultEdges: H } = k.getState(), L = {
      ...te,
      ...ee
    };
    if (H) {
      const { edges: J, setEdges: F } = k.getState();
      F(dY(L, J));
    }
    ie == null || ie(L), u == null || u(L);
  }, re = (ee) => {
    if (!C)
      return;
    const te = Q9(ee.nativeEvent);
    if (a && (te && ee.button === 0 || !te)) {
      const ie = k.getState();
      f2.onPointerDown(ee.nativeEvent, {
        handleDomNode: ee.currentTarget,
        autoPanOnConnect: ie.autoPanOnConnect,
        connectionMode: ie.connectionMode,
        connectionRadius: ie.connectionRadius,
        domNode: ie.domNode,
        nodeLookup: ie.nodeLookup,
        lib: ie.lib,
        isTarget: E,
        handleId: w,
        nodeId: C,
        flowId: ie.rfId,
        panBy: ie.panBy,
        cancelConnection: ie.cancelConnection,
        onConnectStart: ie.onConnectStart,
        onConnectEnd: ie.onConnectEnd,
        updateConnection: ie.updateConnection,
        onConnect: G,
        isValidConnection: n || ie.isValidConnection,
        getTransform: () => k.getState().transform,
        getFromHandle: () => k.getState().connection.fromHandle,
        autoPanSpeed: ie.autoPanSpeed,
        dragThreshold: ie.connectionDragThreshold
      });
    }
    te ? m == null || m(ee) : p == null || p(ee);
  }, q = (ee) => {
    const { onClickConnectStart: te, onClickConnectEnd: ie, connectionClickStartHandle: H, connectionMode: L, isValidConnection: J, lib: F, rfId: Z, nodeLookup: oe, connection: fe } = k.getState();
    if (!C || !H && !a)
      return;
    if (!H) {
      te == null || te(ee.nativeEvent, { nodeId: C, handleId: w, handleType: e }), k.setState({ connectionClickStartHandle: { nodeId: C, type: e, id: w } });
      return;
    }
    const Se = X9(ee.target), Te = n || J, { connection: we, isValid: ke } = f2.isValid(ee.nativeEvent, {
      handle: {
        nodeId: C,
        id: w,
        type: e
      },
      connectionMode: L,
      fromNodeId: H.nodeId,
      fromHandleId: H.id || null,
      fromType: H.type,
      isValidConnection: Te,
      flowId: Z,
      doc: Se,
      lib: F,
      nodeLookup: oe
    });
    ke && we && G(we);
    const _e = structuredClone(fe);
    delete _e.inProgress, _e.toPosition = _e.toHandle ? _e.toHandle.position : null, ie == null || ie(ee, _e), k.setState({ connectionClickStartHandle: null });
  };
  return h.jsx("div", { "data-handleid": w, "data-nodeid": C, "data-handlepos": t, "data-id": `${A}-${C}-${w}-${e}`, className: On([
    "react-flow__handle",
    `react-flow__handle-${t}`,
    "nodrag",
    N,
    d,
    {
      source: !E,
      target: E,
      connectable: r,
      connectablestart: a,
      connectableend: o,
      clickconnecting: O,
      connectingfrom: D,
      connectingto: M,
      valid: B,
      /*
       * shows where you can start a connection from
       * and where you can end it while connecting
       */
      connectionindicator: r && (!X || Y) && (X || U ? o : a)
    }
  ]), onMouseDown: re, onTouchStart: re, onClick: T ? q : void 0, ref: y, ...x, children: f });
}
const sr = P.memo(wT(LX));
function qX({ data: e, isConnectable: t, sourcePosition: n = et.Bottom }) {
  return h.jsxs(h.Fragment, { children: [e == null ? void 0 : e.label, h.jsx(sr, { type: "source", position: n, isConnectable: t })] });
}
function PX({ data: e, isConnectable: t, targetPosition: n = et.Top, sourcePosition: r = et.Bottom }) {
  return h.jsxs(h.Fragment, { children: [h.jsx(sr, { type: "target", position: n, isConnectable: t }), e == null ? void 0 : e.label, h.jsx(sr, { type: "source", position: r, isConnectable: t })] });
}
function BX() {
  return null;
}
function FX({ data: e, isConnectable: t, targetPosition: n = et.Top }) {
  return h.jsxs(h.Fragment, { children: [h.jsx(sr, { type: "target", position: n, isConnectable: t }), e == null ? void 0 : e.label] });
}
const Ah = {
  ArrowUp: { x: 0, y: -1 },
  ArrowDown: { x: 0, y: 1 },
  ArrowLeft: { x: -1, y: 0 },
  ArrowRight: { x: 1, y: 0 }
}, wC = {
  input: qX,
  default: PX,
  output: FX,
  group: BX
};
function $X(e) {
  var t, n, r, a;
  return e.internals.handleBounds === void 0 ? {
    width: e.width ?? e.initialWidth ?? ((t = e.style) == null ? void 0 : t.width),
    height: e.height ?? e.initialHeight ?? ((n = e.style) == null ? void 0 : n.height)
  } : {
    width: e.width ?? ((r = e.style) == null ? void 0 : r.width),
    height: e.height ?? ((a = e.style) == null ? void 0 : a.height)
  };
}
const UX = (e) => {
  const { width: t, height: n, x: r, y: a } = fd(e.nodeLookup, {
    filter: (o) => !!o.selected
  });
  return {
    width: Ti(t) ? t : null,
    height: Ti(n) ? n : null,
    userSelectionActive: e.userSelectionActive,
    transformString: `translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${r}px,${a}px)`
  };
};
function HX({ onSelectionContextMenu: e, noPanClassName: t, disableKeyboardA11y: n }) {
  const r = un(), { width: a, height: o, transformString: l, userSelectionActive: u } = Nt(UX, ln), f = CT(), d = P.useRef(null);
  if (P.useEffect(() => {
    var x;
    n || (x = d.current) == null || x.focus({
      preventScroll: !0
    });
  }, [n]), ST({
    nodeRef: d
  }), u || !a || !o)
    return null;
  const m = e ? (x) => {
    const y = r.getState().nodes.filter((w) => w.selected);
    e(x, y);
  } : void 0, p = (x) => {
    Object.prototype.hasOwnProperty.call(Ah, x.key) && (x.preventDefault(), f({
      direction: Ah[x.key],
      factor: x.shiftKey ? 4 : 1
    }));
  };
  return h.jsx("div", { className: On(["react-flow__nodesselection", "react-flow__container", t]), style: {
    transform: l
  }, children: h.jsx("div", { ref: d, className: "react-flow__nodesselection-rect", onContextMenu: m, tabIndex: n ? void 0 : -1, onKeyDown: n ? void 0 : p, style: {
    width: a,
    height: o
  } }) });
}
const _C = typeof window < "u" ? window : void 0, GX = (e) => ({ nodesSelectionActive: e.nodesSelectionActive, userSelectionActive: e.userSelectionActive });
function kT({ children: e, onPaneClick: t, onPaneMouseEnter: n, onPaneMouseMove: r, onPaneMouseLeave: a, onPaneContextMenu: o, onPaneScroll: l, paneClickDistance: u, deleteKeyCode: f, selectionKeyCode: d, selectionOnDrag: m, selectionMode: p, onSelectionStart: x, onSelectionEnd: y, multiSelectionKeyCode: w, panActivationKeyCode: E, zoomActivationKeyCode: k, elementsSelectable: C, zoomOnScroll: T, zoomOnPinch: N, panOnScroll: A, panOnScrollSpeed: D, panOnScrollMode: M, zoomOnDoubleClick: O, panOnDrag: Y, defaultViewport: X, translateExtent: U, minZoom: B, maxZoom: G, preventScrolling: re, onSelectionContextMenu: q, noWheelClassName: W, noPanClassName: V, disableKeyboardA11y: ee, onViewportChange: te, isControlledViewport: ie }) {
  const { nodesSelectionActive: H, userSelectionActive: L } = Nt(GX, ln), J = rd(d, { target: _C }), F = rd(E, { target: _C }), Z = F || Y, oe = F || A, fe = m && Z !== !0, Se = J || L || fe;
  return EX({ deleteKeyCode: f, multiSelectionKeyCode: w }), h.jsx(jX, { onPaneContextMenu: o, elementsSelectable: C, zoomOnScroll: T, zoomOnPinch: N, panOnScroll: oe, panOnScrollSpeed: D, panOnScrollMode: M, zoomOnDoubleClick: O, panOnDrag: !J && Z, defaultViewport: X, translateExtent: U, minZoom: B, maxZoom: G, zoomActivationKeyCode: k, preventScrolling: re, noWheelClassName: W, noPanClassName: V, onViewportChange: te, isControlledViewport: ie, paneClickDistance: u, selectionOnDrag: fe, children: h.jsxs(RX, { onSelectionStart: x, onSelectionEnd: y, onPaneClick: t, onPaneMouseEnter: n, onPaneMouseMove: r, onPaneMouseLeave: a, onPaneContextMenu: o, onPaneScroll: l, panOnDrag: Z, isSelecting: !!Se, selectionMode: p, selectionKeyPressed: J, paneClickDistance: u, selectionOnDrag: fe, children: [e, H && h.jsx(HX, { onSelectionContextMenu: q, noPanClassName: V, disableKeyboardA11y: ee })] }) });
}
kT.displayName = "FlowRenderer";
const VX = P.memo(kT), KX = (e) => (t) => e ? iw(t.nodeLookup, { x: 0, y: 0, width: t.width, height: t.height }, t.transform, !0).map((n) => n.id) : Array.from(t.nodeLookup.keys());
function YX(e) {
  return Nt(P.useCallback(KX(e), [e]), ln);
}
const XX = (e) => e.updateNodeInternals;
function WX() {
  const e = Nt(XX), [t] = P.useState(() => typeof ResizeObserver > "u" ? null : new ResizeObserver((n) => {
    const r = /* @__PURE__ */ new Map();
    n.forEach((a) => {
      const o = a.target.getAttribute("data-id");
      r.set(o, {
        id: o,
        nodeElement: a.target,
        force: !0
      });
    }), e(r);
  }));
  return P.useEffect(() => () => {
    t == null || t.disconnect();
  }, [t]), t;
}
function QX({ node: e, nodeType: t, hasDimensions: n, resizeObserver: r }) {
  const a = un(), o = P.useRef(null), l = P.useRef(null), u = P.useRef(e.sourcePosition), f = P.useRef(e.targetPosition), d = P.useRef(t), m = n && !!e.internals.handleBounds;
  return P.useEffect(() => {
    o.current && !e.hidden && (!m || l.current !== o.current) && (l.current && (r == null || r.unobserve(l.current)), r == null || r.observe(o.current), l.current = o.current);
  }, [m, e.hidden]), P.useEffect(() => () => {
    l.current && (r == null || r.unobserve(l.current), l.current = null);
  }, []), P.useEffect(() => {
    if (o.current) {
      const p = d.current !== t, x = u.current !== e.sourcePosition, y = f.current !== e.targetPosition;
      (p || x || y) && (d.current = t, u.current = e.sourcePosition, f.current = e.targetPosition, a.getState().updateNodeInternals(/* @__PURE__ */ new Map([[e.id, { id: e.id, nodeElement: o.current, force: !0 }]])));
    }
  }, [e.id, t, e.sourcePosition, e.targetPosition]), o;
}
function ZX({ id: e, onClick: t, onMouseEnter: n, onMouseMove: r, onMouseLeave: a, onContextMenu: o, onDoubleClick: l, nodesDraggable: u, elementsSelectable: f, nodesConnectable: d, nodesFocusable: m, resizeObserver: p, noDragClassName: x, noPanClassName: y, disableKeyboardA11y: w, rfId: E, nodeTypes: k, nodeClickDistance: C, onError: T }) {
  const { node: N, internals: A, isParent: D } = Nt((Te) => {
    const we = Te.nodeLookup.get(e), ke = Te.parentLookup.has(e);
    return {
      node: we,
      internals: we.internals,
      isParent: ke
    };
  }, ln);
  let M = N.type || "default", O = (k == null ? void 0 : k[M]) || wC[M];
  O === void 0 && (T == null || T("003", ta.error003(M)), M = "default", O = (k == null ? void 0 : k.default) || wC.default);
  const Y = !!(N.draggable || u && typeof N.draggable > "u"), X = !!(N.selectable || f && typeof N.selectable > "u"), U = !!(N.connectable || d && typeof N.connectable > "u"), B = !!(N.focusable || m && typeof N.focusable > "u"), G = un(), re = K9(N), q = QX({ node: N, nodeType: M, hasDimensions: re, resizeObserver: p }), W = ST({
    nodeRef: q,
    disabled: N.hidden || !Y,
    noDragClassName: x,
    handleSelector: N.dragHandle,
    nodeId: e,
    isSelectable: X,
    nodeClickDistance: C
  }), V = CT();
  if (N.hidden)
    return null;
  const ee = Xa(N), te = $X(N), ie = X || Y || t || n || r || a, H = n ? (Te) => n(Te, { ...A.userNode }) : void 0, L = r ? (Te) => r(Te, { ...A.userNode }) : void 0, J = a ? (Te) => a(Te, { ...A.userNode }) : void 0, F = o ? (Te) => o(Te, { ...A.userNode }) : void 0, Z = l ? (Te) => l(Te, { ...A.userNode }) : void 0, oe = (Te) => {
    const { selectNodesOnDrag: we, nodeDragThreshold: ke } = G.getState();
    X && (!we || !Y || ke > 0) && h2({
      id: e,
      store: G,
      nodeRef: q
    }), t && t(Te, { ...A.userNode });
  }, fe = (Te) => {
    if (!(W9(Te.nativeEvent) || w)) {
      if (q9.includes(Te.key) && X) {
        const we = Te.key === "Escape";
        h2({
          id: e,
          store: G,
          unselect: we,
          nodeRef: q
        });
      } else if (Y && N.selected && Object.prototype.hasOwnProperty.call(Ah, Te.key)) {
        Te.preventDefault();
        const { ariaLabelConfig: we } = G.getState();
        G.setState({
          ariaLiveMessage: we["node.a11yDescription.ariaLiveMessage"]({
            direction: Te.key.replace("Arrow", "").toLowerCase(),
            x: ~~A.positionAbsolute.x,
            y: ~~A.positionAbsolute.y
          })
        }), V({
          direction: Ah[Te.key],
          factor: Te.shiftKey ? 4 : 1
        });
      }
    }
  }, Se = () => {
    var Qe;
    if (w || !((Qe = q.current) != null && Qe.matches(":focus-visible")))
      return;
    const { transform: Te, width: we, height: ke, autoPanOnNodeFocus: _e, setCenter: Ae } = G.getState();
    if (!_e)
      return;
    iw(/* @__PURE__ */ new Map([[e, N]]), { x: 0, y: 0, width: we, height: ke }, Te, !0).length > 0 || Ae(N.position.x + ee.width / 2, N.position.y + ee.height / 2, {
      zoom: Te[2]
    });
  };
  return h.jsx("div", { className: On([
    "react-flow__node",
    `react-flow__node-${M}`,
    {
      // this is overwritable by passing `nopan` as a class name
      [y]: Y
    },
    N.className,
    {
      selected: N.selected,
      selectable: X,
      parent: D,
      draggable: Y,
      dragging: W
    }
  ]), ref: q, style: {
    zIndex: A.z,
    transform: `translate(${A.positionAbsolute.x}px,${A.positionAbsolute.y}px)`,
    pointerEvents: ie ? "all" : "none",
    visibility: re ? "visible" : "hidden",
    ...N.style,
    ...te
  }, "data-id": e, "data-testid": `rf__node-${e}`, onMouseEnter: H, onMouseMove: L, onMouseLeave: J, onContextMenu: F, onClick: oe, onDoubleClick: Z, onKeyDown: B ? fe : void 0, tabIndex: B ? 0 : void 0, onFocus: B ? Se : void 0, role: N.ariaRole ?? (B ? "group" : void 0), "aria-roledescription": "node", "aria-describedby": w ? void 0 : `${pT}-${E}`, "aria-label": N.ariaLabel, ...N.domAttributes, children: h.jsx(OX, { value: e, children: h.jsx(O, { id: e, data: N.data, type: M, positionAbsoluteX: A.positionAbsolute.x, positionAbsoluteY: A.positionAbsolute.y, selected: N.selected ?? !1, selectable: X, draggable: Y, deletable: N.deletable ?? !0, isConnectable: U, sourcePosition: N.sourcePosition, targetPosition: N.targetPosition, dragging: W, dragHandle: N.dragHandle, zIndex: A.z, parentId: N.parentId, ...ee }) }) });
}
var JX = P.memo(ZX);
const eW = (e) => ({
  nodesDraggable: e.nodesDraggable,
  nodesConnectable: e.nodesConnectable,
  nodesFocusable: e.nodesFocusable,
  elementsSelectable: e.elementsSelectable,
  onError: e.onError
});
function NT(e) {
  const { nodesDraggable: t, nodesConnectable: n, nodesFocusable: r, elementsSelectable: a, onError: o } = Nt(eW, ln), l = YX(e.onlyRenderVisibleElements), u = WX();
  return h.jsx("div", { className: "react-flow__nodes", style: im, children: l.map((f) => (
    /*
     * The split of responsibilities between NodeRenderer and
     * NodeComponentWrapper may appear weird. However, its designed to
     * minimize the cost of updates when individual nodes change.
     *
     * For example, when youre dragging a single node, that node gets
     * updated multiple times per second. If `NodeRenderer` were to update
     * every time, it would have to re-run the `nodes.map()` loop every
     * time. This gets pricey with hundreds of nodes, especially if every
     * loop cycle does more than just rendering a JSX element!
     *
     * As a result of this choice, we took the following implementation
     * decisions:
     * - NodeRenderer subscribes *only* to node IDs  and therefore
     *   rerender *only* when visible nodes are added or removed.
     * - NodeRenderer performs all operations the result of which can be
     *   shared between nodes (such as creating the `ResizeObserver`
     *   instance, or subscribing to `selector`). This means extra prop
     *   drilling into `NodeComponentWrapper`, but it means we need to run
     *   these operations only once  instead of once per node.
     * - Any operations that youd normally write inside `nodes.map` are
     *   moved into `NodeComponentWrapper`. This ensures they are
     *   memorized  so if `NodeRenderer` *has* to rerender, it only
     *   needs to regenerate the list of nodes, nothing else.
     */
    h.jsx(JX, { id: f, nodeTypes: e.nodeTypes, nodeExtent: e.nodeExtent, onClick: e.onNodeClick, onMouseEnter: e.onNodeMouseEnter, onMouseMove: e.onNodeMouseMove, onMouseLeave: e.onNodeMouseLeave, onContextMenu: e.onNodeContextMenu, onDoubleClick: e.onNodeDoubleClick, noDragClassName: e.noDragClassName, noPanClassName: e.noPanClassName, rfId: e.rfId, disableKeyboardA11y: e.disableKeyboardA11y, resizeObserver: u, nodesDraggable: t, nodesConnectable: n, nodesFocusable: r, elementsSelectable: a, nodeClickDistance: e.nodeClickDistance, onError: o }, f)
  )) });
}
NT.displayName = "NodeRenderer";
const tW = P.memo(NT);
function nW(e) {
  return Nt(P.useCallback((n) => {
    if (!e)
      return n.edges.map((a) => a.id);
    const r = [];
    if (n.width && n.height)
      for (const a of n.edges) {
        const o = n.nodeLookup.get(a.source), l = n.nodeLookup.get(a.target);
        o && l && lY({
          sourceNode: o,
          targetNode: l,
          width: n.width,
          height: n.height,
          transform: n.transform
        }) && r.push(a.id);
      }
    return r;
  }, [e]), ln);
}
const rW = ({ color: e = "none", strokeWidth: t = 1 }) => {
  const n = {
    strokeWidth: t,
    ...e && { stroke: e }
  };
  return h.jsx("polyline", { className: "arrow", style: n, strokeLinecap: "round", fill: "none", strokeLinejoin: "round", points: "-5,-4 0,0 -5,4" });
}, iW = ({ color: e = "none", strokeWidth: t = 1 }) => {
  const n = {
    strokeWidth: t,
    ...e && { stroke: e, fill: e }
  };
  return h.jsx("polyline", { className: "arrowclosed", style: n, strokeLinecap: "round", strokeLinejoin: "round", points: "-5,-4 0,0 -5,4 -5,-4" });
}, SC = {
  [ed.Arrow]: rW,
  [ed.ArrowClosed]: iW
};
function aW(e) {
  const t = un();
  return P.useMemo(() => {
    var a, o;
    return Object.prototype.hasOwnProperty.call(SC, e) ? SC[e] : ((o = (a = t.getState()).onError) == null || o.call(a, "009", ta.error009(e)), null);
  }, [e]);
}
const sW = ({ id: e, type: t, color: n, width: r = 12.5, height: a = 12.5, markerUnits: o = "strokeWidth", strokeWidth: l, orient: u = "auto-start-reverse" }) => {
  const f = aW(t);
  return f ? h.jsx("marker", { className: "react-flow__arrowhead", id: e, markerWidth: `${r}`, markerHeight: `${a}`, viewBox: "-10 -10 20 20", markerUnits: o, orient: u, refX: "0", refY: "0", children: h.jsx(f, { color: n, strokeWidth: l }) }) : null;
}, jT = ({ defaultColor: e, rfId: t }) => {
  const n = Nt((o) => o.edges), r = Nt((o) => o.defaultEdgeOptions), a = P.useMemo(() => gY(n, {
    id: t,
    defaultColor: e,
    defaultMarkerStart: r == null ? void 0 : r.markerStart,
    defaultMarkerEnd: r == null ? void 0 : r.markerEnd
  }), [n, r, t, e]);
  return a.length ? h.jsx("svg", { className: "react-flow__marker", "aria-hidden": "true", children: h.jsx("defs", { children: a.map((o) => h.jsx(sW, { id: o.id, type: o.type, color: o.color, width: o.width, height: o.height, markerUnits: o.markerUnits, strokeWidth: o.strokeWidth, orient: o.orient }, o.id)) }) }) : null;
};
jT.displayName = "MarkerDefinitions";
var oW = P.memo(jT);
function TT({ x: e, y: t, label: n, labelStyle: r, labelShowBg: a = !0, labelBgStyle: o, labelBgPadding: l = [2, 4], labelBgBorderRadius: u = 2, children: f, className: d, ...m }) {
  const [p, x] = P.useState({ x: 1, y: 0, width: 0, height: 0 }), y = On(["react-flow__edge-textwrapper", d]), w = P.useRef(null);
  return P.useEffect(() => {
    if (w.current) {
      const E = w.current.getBBox();
      x({
        x: E.x,
        y: E.y,
        width: E.width,
        height: E.height
      });
    }
  }, [n]), n ? h.jsxs("g", { transform: `translate(${e - p.width / 2} ${t - p.height / 2})`, className: y, visibility: p.width ? "visible" : "hidden", ...m, children: [a && h.jsx("rect", { width: p.width + 2 * l[0], x: -l[0], y: -l[1], height: p.height + 2 * l[1], className: "react-flow__edge-textbg", style: o, rx: u, ry: u }), h.jsx("text", { className: "react-flow__edge-text", y: p.height / 2, dy: "0.3em", ref: w, style: r, children: n }), f] }) : null;
}
TT.displayName = "EdgeText";
const lW = P.memo(TT);
function am({ path: e, labelX: t, labelY: n, label: r, labelStyle: a, labelShowBg: o, labelBgStyle: l, labelBgPadding: u, labelBgBorderRadius: f, interactionWidth: d = 20, ...m }) {
  return h.jsxs(h.Fragment, { children: [h.jsx("path", { ...m, d: e, fill: "none", className: On(["react-flow__edge-path", m.className]) }), d ? h.jsx("path", { d: e, fill: "none", strokeOpacity: 0, strokeWidth: d, className: "react-flow__edge-interaction" }) : null, r && Ti(t) && Ti(n) ? h.jsx(lW, { x: t, y: n, label: r, labelStyle: a, labelShowBg: o, labelBgStyle: l, labelBgPadding: u, labelBgBorderRadius: f }) : null] });
}
function CC({ pos: e, x1: t, y1: n, x2: r, y2: a }) {
  return e === et.Left || e === et.Right ? [0.5 * (t + r), n] : [t, 0.5 * (n + a)];
}
function AT({ sourceX: e, sourceY: t, sourcePosition: n = et.Bottom, targetX: r, targetY: a, targetPosition: o = et.Top }) {
  const [l, u] = CC({
    pos: n,
    x1: e,
    y1: t,
    x2: r,
    y2: a
  }), [f, d] = CC({
    pos: o,
    x1: r,
    y1: a,
    x2: e,
    y2: t
  }), [m, p, x, y] = Z9({
    sourceX: e,
    sourceY: t,
    targetX: r,
    targetY: a,
    sourceControlX: l,
    sourceControlY: u,
    targetControlX: f,
    targetControlY: d
  });
  return [
    `M${e},${t} C${l},${u} ${f},${d} ${r},${a}`,
    m,
    p,
    x,
    y
  ];
}
function MT(e) {
  return P.memo(({ id: t, sourceX: n, sourceY: r, targetX: a, targetY: o, sourcePosition: l, targetPosition: u, label: f, labelStyle: d, labelShowBg: m, labelBgStyle: p, labelBgPadding: x, labelBgBorderRadius: y, style: w, markerEnd: E, markerStart: k, interactionWidth: C }) => {
    const [T, N, A] = AT({
      sourceX: n,
      sourceY: r,
      sourcePosition: l,
      targetX: a,
      targetY: o,
      targetPosition: u
    }), D = e.isInternal ? void 0 : t;
    return h.jsx(am, { id: D, path: T, labelX: N, labelY: A, label: f, labelStyle: d, labelShowBg: m, labelBgStyle: p, labelBgPadding: x, labelBgBorderRadius: y, style: w, markerEnd: E, markerStart: k, interactionWidth: C });
  });
}
const uW = MT({ isInternal: !1 }), RT = MT({ isInternal: !0 });
uW.displayName = "SimpleBezierEdge";
RT.displayName = "SimpleBezierEdgeInternal";
function zT(e) {
  return P.memo(({ id: t, sourceX: n, sourceY: r, targetX: a, targetY: o, label: l, labelStyle: u, labelShowBg: f, labelBgStyle: d, labelBgPadding: m, labelBgBorderRadius: p, style: x, sourcePosition: y = et.Bottom, targetPosition: w = et.Top, markerEnd: E, markerStart: k, pathOptions: C, interactionWidth: T }) => {
    const [N, A, D] = u2({
      sourceX: n,
      sourceY: r,
      sourcePosition: y,
      targetX: a,
      targetY: o,
      targetPosition: w,
      borderRadius: C == null ? void 0 : C.borderRadius,
      offset: C == null ? void 0 : C.offset,
      stepPosition: C == null ? void 0 : C.stepPosition
    }), M = e.isInternal ? void 0 : t;
    return h.jsx(am, { id: M, path: N, labelX: A, labelY: D, label: l, labelStyle: u, labelShowBg: f, labelBgStyle: d, labelBgPadding: m, labelBgBorderRadius: p, style: x, markerEnd: E, markerStart: k, interactionWidth: T });
  });
}
const OT = zT({ isInternal: !1 }), DT = zT({ isInternal: !0 });
OT.displayName = "SmoothStepEdge";
DT.displayName = "SmoothStepEdgeInternal";
function IT(e) {
  return P.memo(({ id: t, ...n }) => {
    var a;
    const r = e.isInternal ? void 0 : t;
    return h.jsx(OT, { ...n, id: r, pathOptions: P.useMemo(() => {
      var o;
      return { borderRadius: 0, offset: (o = n.pathOptions) == null ? void 0 : o.offset };
    }, [(a = n.pathOptions) == null ? void 0 : a.offset]) });
  });
}
const cW = IT({ isInternal: !1 }), LT = IT({ isInternal: !0 });
cW.displayName = "StepEdge";
LT.displayName = "StepEdgeInternal";
function qT(e) {
  return P.memo(({ id: t, sourceX: n, sourceY: r, targetX: a, targetY: o, label: l, labelStyle: u, labelShowBg: f, labelBgStyle: d, labelBgPadding: m, labelBgBorderRadius: p, style: x, markerEnd: y, markerStart: w, interactionWidth: E }) => {
    const [k, C, T] = tT({ sourceX: n, sourceY: r, targetX: a, targetY: o }), N = e.isInternal ? void 0 : t;
    return h.jsx(am, { id: N, path: k, labelX: C, labelY: T, label: l, labelStyle: u, labelShowBg: f, labelBgStyle: d, labelBgPadding: m, labelBgBorderRadius: p, style: x, markerEnd: y, markerStart: w, interactionWidth: E });
  });
}
const dW = qT({ isInternal: !1 }), PT = qT({ isInternal: !0 });
dW.displayName = "StraightEdge";
PT.displayName = "StraightEdgeInternal";
function BT(e) {
  return P.memo(({ id: t, sourceX: n, sourceY: r, targetX: a, targetY: o, sourcePosition: l = et.Bottom, targetPosition: u = et.Top, label: f, labelStyle: d, labelShowBg: m, labelBgStyle: p, labelBgPadding: x, labelBgBorderRadius: y, style: w, markerEnd: E, markerStart: k, pathOptions: C, interactionWidth: T }) => {
    const [N, A, D] = J9({
      sourceX: n,
      sourceY: r,
      sourcePosition: l,
      targetX: a,
      targetY: o,
      targetPosition: u,
      curvature: C == null ? void 0 : C.curvature
    }), M = e.isInternal ? void 0 : t;
    return h.jsx(am, { id: M, path: N, labelX: A, labelY: D, label: f, labelStyle: d, labelShowBg: m, labelBgStyle: p, labelBgPadding: x, labelBgBorderRadius: y, style: w, markerEnd: E, markerStart: k, interactionWidth: T });
  });
}
const fW = BT({ isInternal: !1 }), FT = BT({ isInternal: !0 });
fW.displayName = "BezierEdge";
FT.displayName = "BezierEdgeInternal";
const EC = {
  default: FT,
  straight: PT,
  step: LT,
  smoothstep: DT,
  simplebezier: RT
}, kC = {
  sourceX: null,
  sourceY: null,
  targetX: null,
  targetY: null,
  sourcePosition: null,
  targetPosition: null
}, hW = (e, t, n) => n === et.Left ? e - t : n === et.Right ? e + t : e, mW = (e, t, n) => n === et.Top ? e - t : n === et.Bottom ? e + t : e, NC = "react-flow__edgeupdater";
function jC({ position: e, centerX: t, centerY: n, radius: r = 10, onMouseDown: a, onMouseEnter: o, onMouseOut: l, type: u }) {
  return h.jsx("circle", { onMouseDown: a, onMouseEnter: o, onMouseOut: l, className: On([NC, `${NC}-${u}`]), cx: hW(t, r, e), cy: mW(n, r, e), r, stroke: "transparent", fill: "transparent" });
}
function pW({ isReconnectable: e, reconnectRadius: t, edge: n, sourceX: r, sourceY: a, targetX: o, targetY: l, sourcePosition: u, targetPosition: f, onReconnect: d, onReconnectStart: m, onReconnectEnd: p, setReconnecting: x, setUpdateHover: y }) {
  const w = un(), E = (A, D) => {
    if (A.button !== 0)
      return;
    const { autoPanOnConnect: M, domNode: O, isValidConnection: Y, connectionMode: X, connectionRadius: U, lib: B, onConnectStart: G, onConnectEnd: re, cancelConnection: q, nodeLookup: W, rfId: V, panBy: ee, updateConnection: te } = w.getState(), ie = D.type === "target", H = (F, Z) => {
      x(!1), p == null || p(F, n, D.type, Z);
    }, L = (F) => d == null ? void 0 : d(n, F), J = (F, Z) => {
      x(!0), m == null || m(A, n, D.type), G == null || G(F, Z);
    };
    f2.onPointerDown(A.nativeEvent, {
      autoPanOnConnect: M,
      connectionMode: X,
      connectionRadius: U,
      domNode: O,
      handleId: D.id,
      nodeId: D.nodeId,
      nodeLookup: W,
      isTarget: ie,
      edgeUpdaterType: D.type,
      lib: B,
      flowId: V,
      cancelConnection: q,
      panBy: ee,
      isValidConnection: Y,
      onConnect: L,
      onConnectStart: J,
      onConnectEnd: re,
      onReconnectEnd: H,
      updateConnection: te,
      getTransform: () => w.getState().transform,
      getFromHandle: () => w.getState().connection.fromHandle,
      dragThreshold: w.getState().connectionDragThreshold,
      handleDomNode: A.currentTarget
    });
  }, k = (A) => E(A, { nodeId: n.target, id: n.targetHandle ?? null, type: "target" }), C = (A) => E(A, { nodeId: n.source, id: n.sourceHandle ?? null, type: "source" }), T = () => y(!0), N = () => y(!1);
  return h.jsxs(h.Fragment, { children: [(e === !0 || e === "source") && h.jsx(jC, { position: u, centerX: r, centerY: a, radius: t, onMouseDown: k, onMouseEnter: T, onMouseOut: N, type: "source" }), (e === !0 || e === "target") && h.jsx(jC, { position: f, centerX: o, centerY: l, radius: t, onMouseDown: C, onMouseEnter: T, onMouseOut: N, type: "target" })] });
}
function gW({ id: e, edgesFocusable: t, edgesReconnectable: n, elementsSelectable: r, onClick: a, onDoubleClick: o, onContextMenu: l, onMouseEnter: u, onMouseMove: f, onMouseLeave: d, reconnectRadius: m, onReconnect: p, onReconnectStart: x, onReconnectEnd: y, rfId: w, edgeTypes: E, noPanClassName: k, onError: C, disableKeyboardA11y: T }) {
  let N = Nt((Ae) => Ae.edgeLookup.get(e));
  const A = Nt((Ae) => Ae.defaultEdgeOptions);
  N = A ? { ...A, ...N } : N;
  let D = N.type || "default", M = (E == null ? void 0 : E[D]) || EC[D];
  M === void 0 && (C == null || C("011", ta.error011(D)), D = "default", M = (E == null ? void 0 : E.default) || EC.default);
  const O = !!(N.focusable || t && typeof N.focusable > "u"), Y = typeof p < "u" && (N.reconnectable || n && typeof N.reconnectable > "u"), X = !!(N.selectable || r && typeof N.selectable > "u"), U = P.useRef(null), [B, G] = P.useState(!1), [re, q] = P.useState(!1), W = un(), { zIndex: V, sourceX: ee, sourceY: te, targetX: ie, targetY: H, sourcePosition: L, targetPosition: J } = Nt(P.useCallback((Ae) => {
    const Pe = Ae.nodeLookup.get(N.source), Qe = Ae.nodeLookup.get(N.target);
    if (!Pe || !Qe)
      return {
        zIndex: N.zIndex,
        ...kC
      };
    const qe = pY({
      id: e,
      sourceNode: Pe,
      targetNode: Qe,
      sourceHandle: N.sourceHandle || null,
      targetHandle: N.targetHandle || null,
      connectionMode: Ae.connectionMode,
      onError: C
    });
    return {
      zIndex: oY({
        selected: N.selected,
        zIndex: N.zIndex,
        sourceNode: Pe,
        targetNode: Qe,
        elevateOnSelect: Ae.elevateEdgesOnSelect,
        zIndexMode: Ae.zIndexMode
      }),
      ...qe || kC
    };
  }, [N.source, N.target, N.sourceHandle, N.targetHandle, N.selected, N.zIndex]), ln), F = P.useMemo(() => N.markerStart ? `url('#${c2(N.markerStart, w)}')` : void 0, [N.markerStart, w]), Z = P.useMemo(() => N.markerEnd ? `url('#${c2(N.markerEnd, w)}')` : void 0, [N.markerEnd, w]);
  if (N.hidden || ee === null || te === null || ie === null || H === null)
    return null;
  const oe = (Ae) => {
    var at;
    const { addSelectedEdges: Pe, unselectNodesAndEdges: Qe, multiSelectionActive: qe } = W.getState();
    X && (W.setState({ nodesSelectionActive: !1 }), N.selected && qe ? (Qe({ nodes: [], edges: [N] }), (at = U.current) == null || at.blur()) : Pe([e])), a && a(Ae, N);
  }, fe = o ? (Ae) => {
    o(Ae, { ...N });
  } : void 0, Se = l ? (Ae) => {
    l(Ae, { ...N });
  } : void 0, Te = u ? (Ae) => {
    u(Ae, { ...N });
  } : void 0, we = f ? (Ae) => {
    f(Ae, { ...N });
  } : void 0, ke = d ? (Ae) => {
    d(Ae, { ...N });
  } : void 0, _e = (Ae) => {
    var Pe;
    if (!T && q9.includes(Ae.key) && X) {
      const { unselectNodesAndEdges: Qe, addSelectedEdges: qe } = W.getState();
      Ae.key === "Escape" ? ((Pe = U.current) == null || Pe.blur(), Qe({ edges: [N] })) : qe([e]);
    }
  };
  return h.jsx("svg", { style: { zIndex: V }, children: h.jsxs("g", { className: On([
    "react-flow__edge",
    `react-flow__edge-${D}`,
    N.className,
    k,
    {
      selected: N.selected,
      animated: N.animated,
      inactive: !X && !a,
      updating: B,
      selectable: X
    }
  ]), onClick: oe, onDoubleClick: fe, onContextMenu: Se, onMouseEnter: Te, onMouseMove: we, onMouseLeave: ke, onKeyDown: O ? _e : void 0, tabIndex: O ? 0 : void 0, role: N.ariaRole ?? (O ? "group" : "img"), "aria-roledescription": "edge", "data-id": e, "data-testid": `rf__edge-${e}`, "aria-label": N.ariaLabel === null ? void 0 : N.ariaLabel || `Edge from ${N.source} to ${N.target}`, "aria-describedby": O ? `${gT}-${w}` : void 0, ref: U, ...N.domAttributes, children: [!re && h.jsx(M, { id: e, source: N.source, target: N.target, type: N.type, selected: N.selected, animated: N.animated, selectable: X, deletable: N.deletable ?? !0, label: N.label, labelStyle: N.labelStyle, labelShowBg: N.labelShowBg, labelBgStyle: N.labelBgStyle, labelBgPadding: N.labelBgPadding, labelBgBorderRadius: N.labelBgBorderRadius, sourceX: ee, sourceY: te, targetX: ie, targetY: H, sourcePosition: L, targetPosition: J, data: N.data, style: N.style, sourceHandleId: N.sourceHandle, targetHandleId: N.targetHandle, markerStart: F, markerEnd: Z, pathOptions: "pathOptions" in N ? N.pathOptions : void 0, interactionWidth: N.interactionWidth }), Y && h.jsx(pW, { edge: N, isReconnectable: Y, reconnectRadius: m, onReconnect: p, onReconnectStart: x, onReconnectEnd: y, sourceX: ee, sourceY: te, targetX: ie, targetY: H, sourcePosition: L, targetPosition: J, setUpdateHover: G, setReconnecting: q })] }) });
}
var yW = P.memo(gW);
const xW = (e) => ({
  edgesFocusable: e.edgesFocusable,
  edgesReconnectable: e.edgesReconnectable,
  elementsSelectable: e.elementsSelectable,
  connectionMode: e.connectionMode,
  onError: e.onError
});
function $T({ defaultMarkerColor: e, onlyRenderVisibleElements: t, rfId: n, edgeTypes: r, noPanClassName: a, onReconnect: o, onEdgeContextMenu: l, onEdgeMouseEnter: u, onEdgeMouseMove: f, onEdgeMouseLeave: d, onEdgeClick: m, reconnectRadius: p, onEdgeDoubleClick: x, onReconnectStart: y, onReconnectEnd: w, disableKeyboardA11y: E }) {
  const { edgesFocusable: k, edgesReconnectable: C, elementsSelectable: T, onError: N } = Nt(xW, ln), A = nW(t);
  return h.jsxs("div", { className: "react-flow__edges", children: [h.jsx(oW, { defaultColor: e, rfId: n }), A.map((D) => h.jsx(yW, { id: D, edgesFocusable: k, edgesReconnectable: C, elementsSelectable: T, noPanClassName: a, onReconnect: o, onContextMenu: l, onMouseEnter: u, onMouseMove: f, onMouseLeave: d, onClick: m, reconnectRadius: p, onDoubleClick: x, onReconnectStart: y, onReconnectEnd: w, rfId: n, onError: N, edgeTypes: r, disableKeyboardA11y: E }, D))] });
}
$T.displayName = "EdgeRenderer";
const vW = P.memo($T), bW = (e) => `translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;
function wW({ children: e }) {
  const t = Nt(bW);
  return h.jsx("div", { className: "react-flow__viewport xyflow__viewport react-flow__container", style: { transform: t }, children: e });
}
function _W(e) {
  const t = fw(), n = P.useRef(!1);
  P.useEffect(() => {
    !n.current && t.viewportInitialized && e && (setTimeout(() => e(t), 1), n.current = !0);
  }, [e, t.viewportInitialized]);
}
const SW = (e) => {
  var t;
  return (t = e.panZoom) == null ? void 0 : t.syncViewport;
};
function CW(e) {
  const t = Nt(SW), n = un();
  return P.useEffect(() => {
    e && (t == null || t(e), n.setState({ transform: [e.x, e.y, e.zoom] }));
  }, [e, t]), null;
}
function EW(e) {
  return e.connection.inProgress ? { ...e.connection, to: md(e.connection.to, e.transform) } : { ...e.connection };
}
function kW(e) {
  return EW;
}
function NW(e) {
  const t = kW();
  return Nt(t, ln);
}
const jW = (e) => ({
  nodesConnectable: e.nodesConnectable,
  isValid: e.connection.isValid,
  inProgress: e.connection.inProgress,
  width: e.width,
  height: e.height
});
function TW({ containerStyle: e, style: t, type: n, component: r }) {
  const { nodesConnectable: a, width: o, height: l, isValid: u, inProgress: f } = Nt(jW, ln);
  return !(o && a && f) ? null : h.jsx("svg", { style: e, width: o, height: l, className: "react-flow__connectionline react-flow__container", children: h.jsx("g", { className: On(["react-flow__connection", F9(u)]), children: h.jsx(UT, { style: t, type: n, CustomComponent: r, isValid: u }) }) });
}
const UT = ({ style: e, type: t = Ls.Bezier, CustomComponent: n, isValid: r }) => {
  const { inProgress: a, from: o, fromNode: l, fromHandle: u, fromPosition: f, to: d, toNode: m, toHandle: p, toPosition: x, pointer: y } = NW();
  if (!a)
    return;
  if (n)
    return h.jsx(n, { connectionLineType: t, connectionLineStyle: e, fromNode: l, fromHandle: u, fromX: o.x, fromY: o.y, toX: d.x, toY: d.y, fromPosition: f, toPosition: x, connectionStatus: F9(r), toNode: m, toHandle: p, pointer: y });
  let w = "";
  const E = {
    sourceX: o.x,
    sourceY: o.y,
    sourcePosition: f,
    targetX: d.x,
    targetY: d.y,
    targetPosition: x
  };
  switch (t) {
    case Ls.Bezier:
      [w] = J9(E);
      break;
    case Ls.SimpleBezier:
      [w] = AT(E);
      break;
    case Ls.Step:
      [w] = u2({
        ...E,
        borderRadius: 0
      });
      break;
    case Ls.SmoothStep:
      [w] = u2(E);
      break;
    default:
      [w] = tT(E);
  }
  return h.jsx("path", { d: w, fill: "none", className: "react-flow__connection-path", style: e });
};
UT.displayName = "ConnectionLine";
const AW = {};
function TC(e = AW) {
  P.useRef(e), un(), P.useEffect(() => {
  }, [e]);
}
function MW() {
  un(), P.useRef(!1), P.useEffect(() => {
  }, []);
}
function HT({ nodeTypes: e, edgeTypes: t, onInit: n, onNodeClick: r, onEdgeClick: a, onNodeDoubleClick: o, onEdgeDoubleClick: l, onNodeMouseEnter: u, onNodeMouseMove: f, onNodeMouseLeave: d, onNodeContextMenu: m, onSelectionContextMenu: p, onSelectionStart: x, onSelectionEnd: y, connectionLineType: w, connectionLineStyle: E, connectionLineComponent: k, connectionLineContainerStyle: C, selectionKeyCode: T, selectionOnDrag: N, selectionMode: A, multiSelectionKeyCode: D, panActivationKeyCode: M, zoomActivationKeyCode: O, deleteKeyCode: Y, onlyRenderVisibleElements: X, elementsSelectable: U, defaultViewport: B, translateExtent: G, minZoom: re, maxZoom: q, preventScrolling: W, defaultMarkerColor: V, zoomOnScroll: ee, zoomOnPinch: te, panOnScroll: ie, panOnScrollSpeed: H, panOnScrollMode: L, zoomOnDoubleClick: J, panOnDrag: F, onPaneClick: Z, onPaneMouseEnter: oe, onPaneMouseMove: fe, onPaneMouseLeave: Se, onPaneScroll: Te, onPaneContextMenu: we, paneClickDistance: ke, nodeClickDistance: _e, onEdgeContextMenu: Ae, onEdgeMouseEnter: Pe, onEdgeMouseMove: Qe, onEdgeMouseLeave: qe, reconnectRadius: at, onReconnect: st, onReconnectStart: mn, onReconnectEnd: Jt, noDragClassName: Sn, noWheelClassName: Kt, noPanClassName: vn, disableKeyboardA11y: qt, nodeExtent: Yt, rfId: In, viewport: Re, onViewportChange: Be }) {
  return TC(e), TC(t), MW(), _W(n), CW(Re), h.jsx(VX, { onPaneClick: Z, onPaneMouseEnter: oe, onPaneMouseMove: fe, onPaneMouseLeave: Se, onPaneContextMenu: we, onPaneScroll: Te, paneClickDistance: ke, deleteKeyCode: Y, selectionKeyCode: T, selectionOnDrag: N, selectionMode: A, onSelectionStart: x, onSelectionEnd: y, multiSelectionKeyCode: D, panActivationKeyCode: M, zoomActivationKeyCode: O, elementsSelectable: U, zoomOnScroll: ee, zoomOnPinch: te, zoomOnDoubleClick: J, panOnScroll: ie, panOnScrollSpeed: H, panOnScrollMode: L, panOnDrag: F, defaultViewport: B, translateExtent: G, minZoom: re, maxZoom: q, onSelectionContextMenu: p, preventScrolling: W, noDragClassName: Sn, noWheelClassName: Kt, noPanClassName: vn, disableKeyboardA11y: qt, onViewportChange: Be, isControlledViewport: !!Re, children: h.jsxs(wW, { children: [h.jsx(vW, { edgeTypes: t, onEdgeClick: a, onEdgeDoubleClick: l, onReconnect: st, onReconnectStart: mn, onReconnectEnd: Jt, onlyRenderVisibleElements: X, onEdgeContextMenu: Ae, onEdgeMouseEnter: Pe, onEdgeMouseMove: Qe, onEdgeMouseLeave: qe, reconnectRadius: at, defaultMarkerColor: V, noPanClassName: vn, disableKeyboardA11y: qt, rfId: In }), h.jsx(TW, { style: E, type: w, component: k, containerStyle: C }), h.jsx("div", { className: "react-flow__edgelabel-renderer" }), h.jsx(tW, { nodeTypes: e, onNodeClick: r, onNodeDoubleClick: o, onNodeMouseEnter: u, onNodeMouseMove: f, onNodeMouseLeave: d, onNodeContextMenu: m, nodeClickDistance: _e, onlyRenderVisibleElements: X, noPanClassName: vn, noDragClassName: Sn, disableKeyboardA11y: qt, nodeExtent: Yt, rfId: In }), h.jsx("div", { className: "react-flow__viewport-portal" })] }) });
}
HT.displayName = "GraphView";
const RW = P.memo(HT), AC = ({ nodes: e, edges: t, defaultNodes: n, defaultEdges: r, width: a, height: o, fitView: l, fitViewOptions: u, minZoom: f = 0.5, maxZoom: d = 2, nodeOrigin: m, nodeExtent: p, zIndexMode: x = "basic" } = {}) => {
  const y = /* @__PURE__ */ new Map(), w = /* @__PURE__ */ new Map(), E = /* @__PURE__ */ new Map(), k = /* @__PURE__ */ new Map(), C = r ?? t ?? [], T = n ?? e ?? [], N = m ?? [0, 0], A = p ?? Zc;
  iT(E, k, C);
  const D = d2(T, y, w, {
    nodeOrigin: N,
    nodeExtent: A,
    zIndexMode: x
  });
  let M = [0, 0, 1];
  if (l && a && o) {
    const O = fd(y, {
      filter: (B) => !!((B.width || B.initialWidth) && (B.height || B.initialHeight))
    }), { x: Y, y: X, zoom: U } = aw(O, a, o, f, d, (u == null ? void 0 : u.padding) ?? 0.1);
    M = [Y, X, U];
  }
  return {
    rfId: "1",
    width: a ?? 0,
    height: o ?? 0,
    transform: M,
    nodes: T,
    nodesInitialized: D,
    nodeLookup: y,
    parentLookup: w,
    edges: C,
    edgeLookup: k,
    connectionLookup: E,
    onNodesChange: null,
    onEdgesChange: null,
    hasDefaultNodes: n !== void 0,
    hasDefaultEdges: r !== void 0,
    panZoom: null,
    minZoom: f,
    maxZoom: d,
    translateExtent: Zc,
    nodeExtent: A,
    nodesSelectionActive: !1,
    userSelectionActive: !1,
    userSelectionRect: null,
    connectionMode: ru.Strict,
    domNode: null,
    paneDragging: !1,
    noPanClassName: "nopan",
    nodeOrigin: N,
    nodeDragThreshold: 1,
    connectionDragThreshold: 1,
    snapGrid: [15, 15],
    snapToGrid: !1,
    nodesDraggable: !0,
    nodesConnectable: !0,
    nodesFocusable: !0,
    edgesFocusable: !0,
    edgesReconnectable: !0,
    elementsSelectable: !0,
    elevateNodesOnSelect: !0,
    elevateEdgesOnSelect: !0,
    selectNodesOnDrag: !0,
    multiSelectionActive: !1,
    fitViewQueued: l ?? !1,
    fitViewOptions: u,
    fitViewResolver: null,
    connection: { ...B9 },
    connectionClickStartHandle: null,
    connectOnClick: !0,
    ariaLiveMessage: "",
    autoPanOnConnect: !0,
    autoPanOnNodeDrag: !0,
    autoPanOnNodeFocus: !0,
    autoPanSpeed: 15,
    connectionRadius: 20,
    onError: tY,
    isValidConnection: void 0,
    onSelectionChangeHandlers: [],
    lib: "react",
    debug: !1,
    ariaLabelConfig: P9,
    zIndexMode: x,
    onNodesChangeMiddlewareMap: /* @__PURE__ */ new Map(),
    onEdgesChangeMiddlewareMap: /* @__PURE__ */ new Map()
  };
}, zW = ({ nodes: e, edges: t, defaultNodes: n, defaultEdges: r, width: a, height: o, fitView: l, fitViewOptions: u, minZoom: f, maxZoom: d, nodeOrigin: m, nodeExtent: p, zIndexMode: x }) => QY((y, w) => {
  async function E() {
    const { nodeLookup: k, panZoom: C, fitViewOptions: T, fitViewResolver: N, width: A, height: D, minZoom: M, maxZoom: O } = w();
    C && (await JK({
      nodes: k,
      width: A,
      height: D,
      panZoom: C,
      minZoom: M,
      maxZoom: O
    }, T), N == null || N.resolve(!0), y({ fitViewResolver: null }));
  }
  return {
    ...AC({
      nodes: e,
      edges: t,
      width: a,
      height: o,
      fitView: l,
      fitViewOptions: u,
      minZoom: f,
      maxZoom: d,
      nodeOrigin: m,
      nodeExtent: p,
      defaultNodes: n,
      defaultEdges: r,
      zIndexMode: x
    }),
    setNodes: (k) => {
      const { nodeLookup: C, parentLookup: T, nodeOrigin: N, elevateNodesOnSelect: A, fitViewQueued: D, zIndexMode: M } = w(), O = d2(k, C, T, {
        nodeOrigin: N,
        nodeExtent: p,
        elevateNodesOnSelect: A,
        checkEquality: !0,
        zIndexMode: M
      });
      D && O ? (E(), y({ nodes: k, nodesInitialized: O, fitViewQueued: !1, fitViewOptions: void 0 })) : y({ nodes: k, nodesInitialized: O });
    },
    setEdges: (k) => {
      const { connectionLookup: C, edgeLookup: T } = w();
      iT(C, T, k), y({ edges: k });
    },
    setDefaultNodesAndEdges: (k, C) => {
      if (k) {
        const { setNodes: T } = w();
        T(k), y({ hasDefaultNodes: !0 });
      }
      if (C) {
        const { setEdges: T } = w();
        T(C), y({ hasDefaultEdges: !0 });
      }
    },
    /*
     * Every node gets registerd at a ResizeObserver. Whenever a node
     * changes its dimensions, this function is called to measure the
     * new dimensions and update the nodes.
     */
    updateNodeInternals: (k) => {
      const { triggerNodeChanges: C, nodeLookup: T, parentLookup: N, domNode: A, nodeOrigin: D, nodeExtent: M, debug: O, fitViewQueued: Y, zIndexMode: X } = w(), { changes: U, updatedInternals: B } = SY(k, T, N, A, D, M, X);
      B && (vY(T, N, { nodeOrigin: D, nodeExtent: M, zIndexMode: X }), Y ? (E(), y({ fitViewQueued: !1, fitViewOptions: void 0 })) : y({}), (U == null ? void 0 : U.length) > 0 && (O && console.log("React Flow: trigger node changes", U), C == null || C(U)));
    },
    updateNodePositions: (k, C = !1) => {
      const T = [];
      let N = [];
      const { nodeLookup: A, triggerNodeChanges: D, connection: M, updateConnection: O, onNodesChangeMiddlewareMap: Y } = w();
      for (const [X, U] of k) {
        const B = A.get(X), G = !!(B != null && B.expandParent && (B != null && B.parentId) && (U != null && U.position)), re = {
          id: X,
          type: "position",
          position: G ? {
            x: Math.max(0, U.position.x),
            y: Math.max(0, U.position.y)
          } : U.position,
          dragging: C
        };
        if (B && M.inProgress && M.fromNode.id === B.id) {
          const q = qo(B, M.fromHandle, et.Left, !0);
          O({ ...M, from: q });
        }
        G && B.parentId && T.push({
          id: X,
          parentId: B.parentId,
          rect: {
            ...U.internals.positionAbsolute,
            width: U.measured.width ?? 0,
            height: U.measured.height ?? 0
          }
        }), N.push(re);
      }
      if (T.length > 0) {
        const { parentLookup: X, nodeOrigin: U } = w(), B = dw(T, A, X, U);
        N.push(...B);
      }
      for (const X of Y.values())
        N = X(N);
      D(N);
    },
    triggerNodeChanges: (k) => {
      const { onNodesChange: C, setNodes: T, nodes: N, hasDefaultNodes: A, debug: D } = w();
      if (k != null && k.length) {
        if (A) {
          const M = vT(k, N);
          T(M);
        }
        D && console.log("React Flow: trigger node changes", k), C == null || C(k);
      }
    },
    triggerEdgeChanges: (k) => {
      const { onEdgesChange: C, setEdges: T, edges: N, hasDefaultEdges: A, debug: D } = w();
      if (k != null && k.length) {
        if (A) {
          const M = bT(k, N);
          T(M);
        }
        D && console.log("React Flow: trigger edge changes", k), C == null || C(k);
      }
    },
    addSelectedNodes: (k) => {
      const { multiSelectionActive: C, edgeLookup: T, nodeLookup: N, triggerNodeChanges: A, triggerEdgeChanges: D } = w();
      if (C) {
        const M = k.map((O) => wo(O, !0));
        A(M);
        return;
      }
      A(Xl(N, /* @__PURE__ */ new Set([...k]), !0)), D(Xl(T));
    },
    addSelectedEdges: (k) => {
      const { multiSelectionActive: C, edgeLookup: T, nodeLookup: N, triggerNodeChanges: A, triggerEdgeChanges: D } = w();
      if (C) {
        const M = k.map((O) => wo(O, !0));
        D(M);
        return;
      }
      D(Xl(T, /* @__PURE__ */ new Set([...k]))), A(Xl(N, /* @__PURE__ */ new Set(), !0));
    },
    unselectNodesAndEdges: ({ nodes: k, edges: C } = {}) => {
      const { edges: T, nodes: N, nodeLookup: A, triggerNodeChanges: D, triggerEdgeChanges: M } = w(), O = k || N, Y = C || T, X = O.map((B) => {
        const G = A.get(B.id);
        return G && (G.selected = !1), wo(B.id, !1);
      }), U = Y.map((B) => wo(B.id, !1));
      D(X), M(U);
    },
    setMinZoom: (k) => {
      const { panZoom: C, maxZoom: T } = w();
      C == null || C.setScaleExtent([k, T]), y({ minZoom: k });
    },
    setMaxZoom: (k) => {
      const { panZoom: C, minZoom: T } = w();
      C == null || C.setScaleExtent([T, k]), y({ maxZoom: k });
    },
    setTranslateExtent: (k) => {
      var C;
      (C = w().panZoom) == null || C.setTranslateExtent(k), y({ translateExtent: k });
    },
    resetSelectedElements: () => {
      const { edges: k, nodes: C, triggerNodeChanges: T, triggerEdgeChanges: N, elementsSelectable: A } = w();
      if (!A)
        return;
      const D = C.reduce((O, Y) => Y.selected ? [...O, wo(Y.id, !1)] : O, []), M = k.reduce((O, Y) => Y.selected ? [...O, wo(Y.id, !1)] : O, []);
      T(D), N(M);
    },
    setNodeExtent: (k) => {
      const { nodes: C, nodeLookup: T, parentLookup: N, nodeOrigin: A, elevateNodesOnSelect: D, nodeExtent: M, zIndexMode: O } = w();
      k[0][0] === M[0][0] && k[0][1] === M[0][1] && k[1][0] === M[1][0] && k[1][1] === M[1][1] || (d2(C, T, N, {
        nodeOrigin: A,
        nodeExtent: k,
        elevateNodesOnSelect: D,
        checkEquality: !1,
        zIndexMode: O
      }), y({ nodeExtent: k }));
    },
    panBy: (k) => {
      const { transform: C, width: T, height: N, panZoom: A, translateExtent: D } = w();
      return CY({ delta: k, panZoom: A, transform: C, translateExtent: D, width: T, height: N });
    },
    setCenter: async (k, C, T) => {
      const { width: N, height: A, maxZoom: D, panZoom: M } = w();
      if (!M)
        return Promise.resolve(!1);
      const O = typeof (T == null ? void 0 : T.zoom) < "u" ? T.zoom : D;
      return await M.setViewport({
        x: N / 2 - k * O,
        y: A / 2 - C * O,
        zoom: O
      }, { duration: T == null ? void 0 : T.duration, ease: T == null ? void 0 : T.ease, interpolate: T == null ? void 0 : T.interpolate }), Promise.resolve(!0);
    },
    cancelConnection: () => {
      y({
        connection: { ...B9 }
      });
    },
    updateConnection: (k) => {
      y({ connection: k });
    },
    reset: () => y({ ...AC() })
  };
}, Object.is);
function OW({ initialNodes: e, initialEdges: t, defaultNodes: n, defaultEdges: r, initialWidth: a, initialHeight: o, initialMinZoom: l, initialMaxZoom: u, initialFitViewOptions: f, fitView: d, nodeOrigin: m, nodeExtent: p, zIndexMode: x, children: y }) {
  const [w] = P.useState(() => zW({
    nodes: e,
    edges: t,
    defaultNodes: n,
    defaultEdges: r,
    width: a,
    height: o,
    fitView: d,
    minZoom: l,
    maxZoom: u,
    fitViewOptions: f,
    nodeOrigin: m,
    nodeExtent: p,
    zIndexMode: x
  }));
  return h.jsx(ZY, { value: w, children: h.jsx(wX, { children: y }) });
}
function DW({ children: e, nodes: t, edges: n, defaultNodes: r, defaultEdges: a, width: o, height: l, fitView: u, fitViewOptions: f, minZoom: d, maxZoom: m, nodeOrigin: p, nodeExtent: x, zIndexMode: y }) {
  return P.useContext(nm) ? h.jsx(h.Fragment, { children: e }) : h.jsx(OW, { initialNodes: t, initialEdges: n, defaultNodes: r, defaultEdges: a, initialWidth: o, initialHeight: l, fitView: u, initialFitViewOptions: f, initialMinZoom: d, initialMaxZoom: m, nodeOrigin: p, nodeExtent: x, zIndexMode: y, children: e });
}
const IW = {
  width: "100%",
  height: "100%",
  overflow: "hidden",
  position: "relative",
  zIndex: 0
};
function LW({ nodes: e, edges: t, defaultNodes: n, defaultEdges: r, className: a, nodeTypes: o, edgeTypes: l, onNodeClick: u, onEdgeClick: f, onInit: d, onMove: m, onMoveStart: p, onMoveEnd: x, onConnect: y, onConnectStart: w, onConnectEnd: E, onClickConnectStart: k, onClickConnectEnd: C, onNodeMouseEnter: T, onNodeMouseMove: N, onNodeMouseLeave: A, onNodeContextMenu: D, onNodeDoubleClick: M, onNodeDragStart: O, onNodeDrag: Y, onNodeDragStop: X, onNodesDelete: U, onEdgesDelete: B, onDelete: G, onSelectionChange: re, onSelectionDragStart: q, onSelectionDrag: W, onSelectionDragStop: V, onSelectionContextMenu: ee, onSelectionStart: te, onSelectionEnd: ie, onBeforeDelete: H, connectionMode: L, connectionLineType: J = Ls.Bezier, connectionLineStyle: F, connectionLineComponent: Z, connectionLineContainerStyle: oe, deleteKeyCode: fe = "Backspace", selectionKeyCode: Se = "Shift", selectionOnDrag: Te = !1, selectionMode: we = Jc.Full, panActivationKeyCode: ke = "Space", multiSelectionKeyCode: _e = nd() ? "Meta" : "Control", zoomActivationKeyCode: Ae = nd() ? "Meta" : "Control", snapToGrid: Pe, snapGrid: Qe, onlyRenderVisibleElements: qe = !1, selectNodesOnDrag: at, nodesDraggable: st, autoPanOnNodeFocus: mn, nodesConnectable: Jt, nodesFocusable: Sn, nodeOrigin: Kt = yT, edgesFocusable: vn, edgesReconnectable: qt, elementsSelectable: Yt = !0, defaultViewport: In = dX, minZoom: Re = 0.5, maxZoom: Be = 2, translateExtent: rt = Zc, preventScrolling: dt = !0, nodeExtent: xt, defaultMarkerColor: pn = "#b1b1b7", zoomOnScroll: gn = !0, zoomOnPinch: It = !0, panOnScroll: Rt = !1, panOnScrollSpeed: en = 0.5, panOnScrollMode: Ge = Mo.Free, zoomOnDoubleClick: tr = !0, panOnDrag: bn = !0, onPaneClick: Za, onPaneMouseEnter: Ye, onPaneMouseMove: Ii, onPaneMouseLeave: aa, onPaneScroll: Or, onPaneContextMenu: sa, paneClickDistance: gi = 1, nodeClickDistance: xu = 0, children: Go, onReconnect: Xr, onReconnectStart: xr, onReconnectEnd: Gs, onEdgeContextMenu: oa, onEdgeDoubleClick: Bt, onEdgeMouseEnter: dn, onEdgeMouseMove: Vs, onEdgeMouseLeave: Li, reconnectRadius: la = 10, onNodesChange: ua, onEdgesChange: Wr, noDragClassName: Ut = "nodrag", noWheelClassName: fn = "nowheel", noPanClassName: $n = "nopan", fitView: yi, fitViewOptions: Vo, connectOnClick: Qr, attributionPosition: Ks, proOptions: dr, defaultEdgeOptions: Ja, elevateNodesOnSelect: Zr = !0, elevateEdgesOnSelect: Pt = !1, disableKeyboardA11y: nr = !1, autoPanOnConnect: Un, autoPanOnNodeDrag: hn, autoPanSpeed: xi, connectionRadius: ca, isValidConnection: Dr, onError: Jr, style: vi, id: es, nodeDragThreshold: da, connectionDragThreshold: Ko, viewport: pt, onViewportChange: fa, width: vr, height: Ln, colorMode: qi = "light", debug: Yo, onScroll: bi, ariaLabelConfig: Ys, zIndexMode: At = "basic", ...ha }, Cn) {
  const br = es || "1", ts = pX(qi), ma = P.useCallback((wr) => {
    wr.currentTarget.scrollTo({ top: 0, left: 0, behavior: "instant" }), bi == null || bi(wr);
  }, [bi]);
  return h.jsx("div", { "data-testid": "rf__wrapper", ...ha, onScroll: ma, style: { ...vi, ...IW }, ref: Cn, className: On(["react-flow", a, ts]), id: es, role: "application", children: h.jsxs(DW, { nodes: e, edges: t, width: vr, height: Ln, fitView: yi, fitViewOptions: Vo, minZoom: Re, maxZoom: Be, nodeOrigin: Kt, nodeExtent: xt, zIndexMode: At, children: [h.jsx(RW, { onInit: d, onNodeClick: u, onEdgeClick: f, onNodeMouseEnter: T, onNodeMouseMove: N, onNodeMouseLeave: A, onNodeContextMenu: D, onNodeDoubleClick: M, nodeTypes: o, edgeTypes: l, connectionLineType: J, connectionLineStyle: F, connectionLineComponent: Z, connectionLineContainerStyle: oe, selectionKeyCode: Se, selectionOnDrag: Te, selectionMode: we, deleteKeyCode: fe, multiSelectionKeyCode: _e, panActivationKeyCode: ke, zoomActivationKeyCode: Ae, onlyRenderVisibleElements: qe, defaultViewport: In, translateExtent: rt, minZoom: Re, maxZoom: Be, preventScrolling: dt, zoomOnScroll: gn, zoomOnPinch: It, zoomOnDoubleClick: tr, panOnScroll: Rt, panOnScrollSpeed: en, panOnScrollMode: Ge, panOnDrag: bn, onPaneClick: Za, onPaneMouseEnter: Ye, onPaneMouseMove: Ii, onPaneMouseLeave: aa, onPaneScroll: Or, onPaneContextMenu: sa, paneClickDistance: gi, nodeClickDistance: xu, onSelectionContextMenu: ee, onSelectionStart: te, onSelectionEnd: ie, onReconnect: Xr, onReconnectStart: xr, onReconnectEnd: Gs, onEdgeContextMenu: oa, onEdgeDoubleClick: Bt, onEdgeMouseEnter: dn, onEdgeMouseMove: Vs, onEdgeMouseLeave: Li, reconnectRadius: la, defaultMarkerColor: pn, noDragClassName: Ut, noWheelClassName: fn, noPanClassName: $n, rfId: br, disableKeyboardA11y: nr, nodeExtent: xt, viewport: pt, onViewportChange: fa }), h.jsx(mX, { nodes: e, edges: t, defaultNodes: n, defaultEdges: r, onConnect: y, onConnectStart: w, onConnectEnd: E, onClickConnectStart: k, onClickConnectEnd: C, nodesDraggable: st, autoPanOnNodeFocus: mn, nodesConnectable: Jt, nodesFocusable: Sn, edgesFocusable: vn, edgesReconnectable: qt, elementsSelectable: Yt, elevateNodesOnSelect: Zr, elevateEdgesOnSelect: Pt, minZoom: Re, maxZoom: Be, nodeExtent: xt, onNodesChange: ua, onEdgesChange: Wr, snapToGrid: Pe, snapGrid: Qe, connectionMode: L, translateExtent: rt, connectOnClick: Qr, defaultEdgeOptions: Ja, fitView: yi, fitViewOptions: Vo, onNodesDelete: U, onEdgesDelete: B, onDelete: G, onNodeDragStart: O, onNodeDrag: Y, onNodeDragStop: X, onSelectionDrag: W, onSelectionDragStart: q, onSelectionDragStop: V, onMove: m, onMoveStart: p, onMoveEnd: x, noPanClassName: $n, nodeOrigin: Kt, rfId: br, autoPanOnConnect: Un, autoPanOnNodeDrag: hn, autoPanSpeed: xi, onError: Jr, connectionRadius: ca, isValidConnection: Dr, selectNodesOnDrag: at, nodeDragThreshold: da, connectionDragThreshold: Ko, onBeforeDelete: H, debug: Yo, ariaLabelConfig: Ys, zIndexMode: At }), h.jsx(cX, { onSelectionChange: re }), Go, h.jsx(aX, { proOptions: dr, position: Ks }), h.jsx(iX, { rfId: br, disableKeyboardA11y: nr })] }) });
}
var qW = wT(LW);
function PW(e) {
  const [t, n] = P.useState(e), r = P.useCallback((a) => n((o) => vT(a, o)), []);
  return [t, n, r];
}
function BW(e) {
  const [t, n] = P.useState(e), r = P.useCallback((a) => n((o) => bT(a, o)), []);
  return [t, n, r];
}
function FW({ dimensions: e, lineWidth: t, variant: n, className: r }) {
  return h.jsx("path", { strokeWidth: t, d: `M${e[0] / 2} 0 V${e[1]} M0 ${e[1] / 2} H${e[0]}`, className: On(["react-flow__background-pattern", n, r]) });
}
function $W({ radius: e, className: t }) {
  return h.jsx("circle", { cx: e, cy: e, r: e, className: On(["react-flow__background-pattern", "dots", t]) });
}
var Bs;
(function(e) {
  e.Lines = "lines", e.Dots = "dots", e.Cross = "cross";
})(Bs || (Bs = {}));
const UW = {
  [Bs.Dots]: 1,
  [Bs.Lines]: 1,
  [Bs.Cross]: 6
}, HW = (e) => ({ transform: e.transform, patternId: `pattern-${e.rfId}` });
function GT({
  id: e,
  variant: t = Bs.Dots,
  // only used for dots and cross
  gap: n = 20,
  // only used for lines and cross
  size: r,
  lineWidth: a = 1,
  offset: o = 0,
  color: l,
  bgColor: u,
  style: f,
  className: d,
  patternClassName: m
}) {
  const p = P.useRef(null), { transform: x, patternId: y } = Nt(HW, ln), w = r || UW[t], E = t === Bs.Dots, k = t === Bs.Cross, C = Array.isArray(n) ? n : [n, n], T = [C[0] * x[2] || 1, C[1] * x[2] || 1], N = w * x[2], A = Array.isArray(o) ? o : [o, o], D = k ? [N, N] : T, M = [
    A[0] * x[2] || 1 + D[0] / 2,
    A[1] * x[2] || 1 + D[1] / 2
  ], O = `${y}${e || ""}`;
  return h.jsxs("svg", { className: On(["react-flow__background", d]), style: {
    ...f,
    ...im,
    "--xy-background-color-props": u,
    "--xy-background-pattern-color-props": l
  }, ref: p, "data-testid": "rf__background", children: [h.jsx("pattern", { id: O, x: x[0] % T[0], y: x[1] % T[1], width: T[0], height: T[1], patternUnits: "userSpaceOnUse", patternTransform: `translate(-${M[0]},-${M[1]})`, children: E ? h.jsx($W, { radius: N / 2, className: m }) : h.jsx(FW, { dimensions: D, lineWidth: a, variant: t, className: m }) }), h.jsx("rect", { x: "0", y: "0", width: "100%", height: "100%", fill: `url(#${O})` })] });
}
GT.displayName = "Background";
const GW = P.memo(GT);
function VW() {
  return h.jsx("svg", { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 32 32", children: h.jsx("path", { d: "M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z" }) });
}
function KW() {
  return h.jsx("svg", { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 32 5", children: h.jsx("path", { d: "M0 0h32v4.2H0z" }) });
}
function YW() {
  return h.jsx("svg", { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 32 30", children: h.jsx("path", { d: "M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z" }) });
}
function XW() {
  return h.jsx("svg", { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 25 32", children: h.jsx("path", { d: "M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z" }) });
}
function WW() {
  return h.jsx("svg", { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 25 32", children: h.jsx("path", { d: "M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z" }) });
}
function Yf({ children: e, className: t, ...n }) {
  return h.jsx("button", { type: "button", className: On(["react-flow__controls-button", t]), ...n, children: e });
}
const QW = (e) => ({
  isInteractive: e.nodesDraggable || e.nodesConnectable || e.elementsSelectable,
  minZoomReached: e.transform[2] <= e.minZoom,
  maxZoomReached: e.transform[2] >= e.maxZoom,
  ariaLabelConfig: e.ariaLabelConfig
});
function VT({ style: e, showZoom: t = !0, showFitView: n = !0, showInteractive: r = !0, fitViewOptions: a, onZoomIn: o, onZoomOut: l, onFitView: u, onInteractiveChange: f, className: d, children: m, position: p = "bottom-left", orientation: x = "vertical", "aria-label": y }) {
  const w = un(), { isInteractive: E, minZoomReached: k, maxZoomReached: C, ariaLabelConfig: T } = Nt(QW, ln), { zoomIn: N, zoomOut: A, fitView: D } = fw(), M = () => {
    N(), o == null || o();
  }, O = () => {
    A(), l == null || l();
  }, Y = () => {
    D(a), u == null || u();
  }, X = () => {
    w.setState({
      nodesDraggable: !E,
      nodesConnectable: !E,
      elementsSelectable: !E
    }), f == null || f(!E);
  }, U = x === "horizontal" ? "horizontal" : "vertical";
  return h.jsxs(rm, { className: On(["react-flow__controls", U, d]), position: p, style: e, "data-testid": "rf__controls", "aria-label": y ?? T["controls.ariaLabel"], children: [t && h.jsxs(h.Fragment, { children: [h.jsx(Yf, { onClick: M, className: "react-flow__controls-zoomin", title: T["controls.zoomIn.ariaLabel"], "aria-label": T["controls.zoomIn.ariaLabel"], disabled: C, children: h.jsx(VW, {}) }), h.jsx(Yf, { onClick: O, className: "react-flow__controls-zoomout", title: T["controls.zoomOut.ariaLabel"], "aria-label": T["controls.zoomOut.ariaLabel"], disabled: k, children: h.jsx(KW, {}) })] }), n && h.jsx(Yf, { className: "react-flow__controls-fitview", onClick: Y, title: T["controls.fitView.ariaLabel"], "aria-label": T["controls.fitView.ariaLabel"], children: h.jsx(YW, {}) }), r && h.jsx(Yf, { className: "react-flow__controls-interactive", onClick: X, title: T["controls.interactive.ariaLabel"], "aria-label": T["controls.interactive.ariaLabel"], children: E ? h.jsx(WW, {}) : h.jsx(XW, {}) }), m] });
}
VT.displayName = "Controls";
const ZW = P.memo(VT);
function JW({ id: e, x: t, y: n, width: r, height: a, style: o, color: l, strokeColor: u, strokeWidth: f, className: d, borderRadius: m, shapeRendering: p, selected: x, onClick: y }) {
  const { background: w, backgroundColor: E } = o || {}, k = l || w || E;
  return h.jsx("rect", { className: On(["react-flow__minimap-node", { selected: x }, d]), x: t, y: n, rx: m, ry: m, width: r, height: a, style: {
    fill: k,
    stroke: u,
    strokeWidth: f
  }, shapeRendering: p, onClick: y ? (C) => y(C, e) : void 0 });
}
const eQ = P.memo(JW), tQ = (e) => e.nodes.map((t) => t.id), a0 = (e) => e instanceof Function ? e : () => e;
function nQ({
  nodeStrokeColor: e,
  nodeColor: t,
  nodeClassName: n = "",
  nodeBorderRadius: r = 5,
  nodeStrokeWidth: a,
  /*
   * We need to rename the prop to be `CapitalCase` so that JSX will render it as
   * a component properly.
   */
  nodeComponent: o = eQ,
  onClick: l
}) {
  const u = Nt(tQ, ln), f = a0(t), d = a0(e), m = a0(n), p = typeof window > "u" || window.chrome ? "crispEdges" : "geometricPrecision";
  return h.jsx(h.Fragment, { children: u.map((x) => (
    /*
     * The split of responsibilities between MiniMapNodes and
     * NodeComponentWrapper may appear weird. However, its designed to
     * minimize the cost of updates when individual nodes change.
     *
     * For more details, see a similar commit in `NodeRenderer/index.tsx`.
     */
    h.jsx(iQ, { id: x, nodeColorFunc: f, nodeStrokeColorFunc: d, nodeClassNameFunc: m, nodeBorderRadius: r, nodeStrokeWidth: a, NodeComponent: o, onClick: l, shapeRendering: p }, x)
  )) });
}
function rQ({ id: e, nodeColorFunc: t, nodeStrokeColorFunc: n, nodeClassNameFunc: r, nodeBorderRadius: a, nodeStrokeWidth: o, shapeRendering: l, NodeComponent: u, onClick: f }) {
  const { node: d, x: m, y: p, width: x, height: y } = Nt((w) => {
    const { internals: E } = w.nodeLookup.get(e), k = E.userNode, { x: C, y: T } = E.positionAbsolute, { width: N, height: A } = Xa(k);
    return {
      node: k,
      x: C,
      y: T,
      width: N,
      height: A
    };
  }, ln);
  return !d || d.hidden || !K9(d) ? null : h.jsx(u, { x: m, y: p, width: x, height: y, style: d.style, selected: !!d.selected, className: r(d), color: t(d), borderRadius: a, strokeColor: n(d), strokeWidth: o, shapeRendering: l, onClick: f, id: d.id });
}
const iQ = P.memo(rQ);
var aQ = P.memo(nQ);
const sQ = 200, oQ = 150, lQ = (e) => !e.hidden, uQ = (e) => {
  const t = {
    x: -e.transform[0] / e.transform[2],
    y: -e.transform[1] / e.transform[2],
    width: e.width / e.transform[2],
    height: e.height / e.transform[2]
  };
  return {
    viewBB: t,
    boundingRect: e.nodeLookup.size > 0 ? V9(fd(e.nodeLookup, { filter: lQ }), t) : t,
    rfId: e.rfId,
    panZoom: e.panZoom,
    translateExtent: e.translateExtent,
    flowWidth: e.width,
    flowHeight: e.height,
    ariaLabelConfig: e.ariaLabelConfig
  };
}, cQ = "react-flow__minimap-desc";
function KT({
  style: e,
  className: t,
  nodeStrokeColor: n,
  nodeColor: r,
  nodeClassName: a = "",
  nodeBorderRadius: o = 5,
  nodeStrokeWidth: l,
  /*
   * We need to rename the prop to be `CapitalCase` so that JSX will render it as
   * a component properly.
   */
  nodeComponent: u,
  bgColor: f,
  maskColor: d,
  maskStrokeColor: m,
  maskStrokeWidth: p,
  position: x = "bottom-right",
  onClick: y,
  onNodeClick: w,
  pannable: E = !1,
  zoomable: k = !1,
  ariaLabel: C,
  inversePan: T,
  zoomStep: N = 1,
  offsetScale: A = 5
}) {
  const D = un(), M = P.useRef(null), { boundingRect: O, viewBB: Y, rfId: X, panZoom: U, translateExtent: B, flowWidth: G, flowHeight: re, ariaLabelConfig: q } = Nt(uQ, ln), W = (e == null ? void 0 : e.width) ?? sQ, V = (e == null ? void 0 : e.height) ?? oQ, ee = O.width / W, te = O.height / V, ie = Math.max(ee, te), H = ie * W, L = ie * V, J = A * ie, F = O.x - (H - O.width) / 2 - J, Z = O.y - (L - O.height) / 2 - J, oe = H + J * 2, fe = L + J * 2, Se = `${cQ}-${X}`, Te = P.useRef(0), we = P.useRef();
  Te.current = ie, P.useEffect(() => {
    if (M.current && U)
      return we.current = zY({
        domNode: M.current,
        panZoom: U,
        getTransform: () => D.getState().transform,
        getViewScale: () => Te.current
      }), () => {
        var Pe;
        (Pe = we.current) == null || Pe.destroy();
      };
  }, [U]), P.useEffect(() => {
    var Pe;
    (Pe = we.current) == null || Pe.update({
      translateExtent: B,
      width: G,
      height: re,
      inversePan: T,
      pannable: E,
      zoomStep: N,
      zoomable: k
    });
  }, [E, k, T, N, B, G, re]);
  const ke = y ? (Pe) => {
    var at;
    const [Qe, qe] = ((at = we.current) == null ? void 0 : at.pointer(Pe)) || [0, 0];
    y(Pe, { x: Qe, y: qe });
  } : void 0, _e = w ? P.useCallback((Pe, Qe) => {
    const qe = D.getState().nodeLookup.get(Qe).internals.userNode;
    w(Pe, qe);
  }, []) : void 0, Ae = C ?? q["minimap.ariaLabel"];
  return h.jsx(rm, { position: x, style: {
    ...e,
    "--xy-minimap-background-color-props": typeof f == "string" ? f : void 0,
    "--xy-minimap-mask-background-color-props": typeof d == "string" ? d : void 0,
    "--xy-minimap-mask-stroke-color-props": typeof m == "string" ? m : void 0,
    "--xy-minimap-mask-stroke-width-props": typeof p == "number" ? p * ie : void 0,
    "--xy-minimap-node-background-color-props": typeof r == "string" ? r : void 0,
    "--xy-minimap-node-stroke-color-props": typeof n == "string" ? n : void 0,
    "--xy-minimap-node-stroke-width-props": typeof l == "number" ? l : void 0
  }, className: On(["react-flow__minimap", t]), "data-testid": "rf__minimap", children: h.jsxs("svg", { width: W, height: V, viewBox: `${F} ${Z} ${oe} ${fe}`, className: "react-flow__minimap-svg", role: "img", "aria-labelledby": Se, ref: M, onClick: ke, children: [Ae && h.jsx("title", { id: Se, children: Ae }), h.jsx(aQ, { onClick: _e, nodeColor: r, nodeStrokeColor: n, nodeBorderRadius: o, nodeClassName: a, nodeStrokeWidth: l, nodeComponent: u }), h.jsx("path", { className: "react-flow__minimap-mask", d: `M${F - J},${Z - J}h${oe + J * 2}v${fe + J * 2}h${-oe - J * 2}z
        M${Y.x},${Y.y}h${Y.width}v${Y.height}h${-Y.width}z`, fillRule: "evenodd", pointerEvents: "none" })] }) });
}
KT.displayName = "MiniMap";
const dQ = P.memo(KT), fQ = (e) => (t) => e ? `${Math.max(1 / t.transform[2], 1)}` : void 0, hQ = {
  [ou.Line]: "right",
  [ou.Handle]: "bottom-right"
};
function mQ({ nodeId: e, position: t, variant: n = ou.Handle, className: r, style: a = void 0, children: o, color: l, minWidth: u = 10, minHeight: f = 10, maxWidth: d = Number.MAX_VALUE, maxHeight: m = Number.MAX_VALUE, keepAspectRatio: p = !1, resizeDirection: x, autoScale: y = !0, shouldResize: w, onResizeStart: E, onResize: k, onResizeEnd: C }) {
  const T = ET(), N = typeof e == "string" ? e : T, A = un(), D = P.useRef(null), M = n === ou.Handle, O = Nt(P.useCallback(fQ(M && y), [M, y]), ln), Y = P.useRef(null), X = t ?? hQ[n];
  P.useEffect(() => {
    if (!(!D.current || !N))
      return Y.current || (Y.current = KY({
        domNode: D.current,
        nodeId: N,
        getStoreItems: () => {
          const { nodeLookup: B, transform: G, snapGrid: re, snapToGrid: q, nodeOrigin: W, domNode: V } = A.getState();
          return {
            nodeLookup: B,
            transform: G,
            snapGrid: re,
            snapToGrid: q,
            nodeOrigin: W,
            paneDomNode: V
          };
        },
        onChange: (B, G) => {
          const { triggerNodeChanges: re, nodeLookup: q, parentLookup: W, nodeOrigin: V } = A.getState(), ee = [], te = { x: B.x, y: B.y }, ie = q.get(N);
          if (ie && ie.expandParent && ie.parentId) {
            const H = ie.origin ?? V, L = B.width ?? ie.measured.width ?? 0, J = B.height ?? ie.measured.height ?? 0, F = {
              id: ie.id,
              parentId: ie.parentId,
              rect: {
                width: L,
                height: J,
                ...Y9({
                  x: B.x ?? ie.position.x,
                  y: B.y ?? ie.position.y
                }, { width: L, height: J }, ie.parentId, q, H)
              }
            }, Z = dw([F], q, W, V);
            ee.push(...Z), te.x = B.x ? Math.max(H[0] * L, B.x) : void 0, te.y = B.y ? Math.max(H[1] * J, B.y) : void 0;
          }
          if (te.x !== void 0 && te.y !== void 0) {
            const H = {
              id: N,
              type: "position",
              position: { ...te }
            };
            ee.push(H);
          }
          if (B.width !== void 0 && B.height !== void 0) {
            const L = {
              id: N,
              type: "dimensions",
              resizing: !0,
              setAttributes: x ? x === "horizontal" ? "width" : "height" : !0,
              dimensions: {
                width: B.width,
                height: B.height
              }
            };
            ee.push(L);
          }
          for (const H of G) {
            const L = {
              ...H,
              type: "position"
            };
            ee.push(L);
          }
          re(ee);
        },
        onEnd: ({ width: B, height: G }) => {
          const re = {
            id: N,
            type: "dimensions",
            resizing: !1,
            dimensions: {
              width: B,
              height: G
            }
          };
          A.getState().triggerNodeChanges([re]);
        }
      })), Y.current.update({
        controlPosition: X,
        boundaries: {
          minWidth: u,
          minHeight: f,
          maxWidth: d,
          maxHeight: m
        },
        keepAspectRatio: p,
        resizeDirection: x,
        onResizeStart: E,
        onResize: k,
        onResizeEnd: C,
        shouldResize: w
      }), () => {
        var B;
        (B = Y.current) == null || B.destroy();
      };
  }, [
    X,
    u,
    f,
    d,
    m,
    p,
    E,
    k,
    C,
    w
  ]);
  const U = X.split("-");
  return h.jsx("div", { className: On(["react-flow__resize-control", "nodrag", ...U, n, r]), ref: D, style: {
    ...a,
    scale: O,
    ...l && { [M ? "backgroundColor" : "borderColor"]: l }
  }, children: o });
}
P.memo(mQ);
function mw(e) {
  throw new Error('Could not dynamically require "' + e + '". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.');
}
var s0, MC;
function pQ() {
  if (MC) return s0;
  MC = 1;
  function e() {
    this.__data__ = [], this.size = 0;
  }
  return s0 = e, s0;
}
var o0, RC;
function hu() {
  if (RC) return o0;
  RC = 1;
  function e(t, n) {
    return t === n || t !== t && n !== n;
  }
  return o0 = e, o0;
}
var l0, zC;
function sm() {
  if (zC) return l0;
  zC = 1;
  var e = hu();
  function t(n, r) {
    for (var a = n.length; a--; )
      if (e(n[a][0], r))
        return a;
    return -1;
  }
  return l0 = t, l0;
}
var u0, OC;
function gQ() {
  if (OC) return u0;
  OC = 1;
  var e = sm(), t = Array.prototype, n = t.splice;
  function r(a) {
    var o = this.__data__, l = e(o, a);
    if (l < 0)
      return !1;
    var u = o.length - 1;
    return l == u ? o.pop() : n.call(o, l, 1), --this.size, !0;
  }
  return u0 = r, u0;
}
var c0, DC;
function yQ() {
  if (DC) return c0;
  DC = 1;
  var e = sm();
  function t(n) {
    var r = this.__data__, a = e(r, n);
    return a < 0 ? void 0 : r[a][1];
  }
  return c0 = t, c0;
}
var d0, IC;
function xQ() {
  if (IC) return d0;
  IC = 1;
  var e = sm();
  function t(n) {
    return e(this.__data__, n) > -1;
  }
  return d0 = t, d0;
}
var f0, LC;
function vQ() {
  if (LC) return f0;
  LC = 1;
  var e = sm();
  function t(n, r) {
    var a = this.__data__, o = e(a, n);
    return o < 0 ? (++this.size, a.push([n, r])) : a[o][1] = r, this;
  }
  return f0 = t, f0;
}
var h0, qC;
function om() {
  if (qC) return h0;
  qC = 1;
  var e = pQ(), t = gQ(), n = yQ(), r = xQ(), a = vQ();
  function o(l) {
    var u = -1, f = l == null ? 0 : l.length;
    for (this.clear(); ++u < f; ) {
      var d = l[u];
      this.set(d[0], d[1]);
    }
  }
  return o.prototype.clear = e, o.prototype.delete = t, o.prototype.get = n, o.prototype.has = r, o.prototype.set = a, h0 = o, h0;
}
var m0, PC;
function bQ() {
  if (PC) return m0;
  PC = 1;
  var e = om();
  function t() {
    this.__data__ = new e(), this.size = 0;
  }
  return m0 = t, m0;
}
var p0, BC;
function wQ() {
  if (BC) return p0;
  BC = 1;
  function e(t) {
    var n = this.__data__, r = n.delete(t);
    return this.size = n.size, r;
  }
  return p0 = e, p0;
}
var g0, FC;
function _Q() {
  if (FC) return g0;
  FC = 1;
  function e(t) {
    return this.__data__.get(t);
  }
  return g0 = e, g0;
}
var y0, $C;
function SQ() {
  if ($C) return y0;
  $C = 1;
  function e(t) {
    return this.__data__.has(t);
  }
  return y0 = e, y0;
}
var x0, UC;
function YT() {
  if (UC) return x0;
  UC = 1;
  var e = typeof jc == "object" && jc && jc.Object === Object && jc;
  return x0 = e, x0;
}
var v0, HC;
function Di() {
  if (HC) return v0;
  HC = 1;
  var e = YT(), t = typeof self == "object" && self && self.Object === Object && self, n = e || t || Function("return this")();
  return v0 = n, v0;
}
var b0, GC;
function mu() {
  if (GC) return b0;
  GC = 1;
  var e = Di(), t = e.Symbol;
  return b0 = t, b0;
}
var w0, VC;
function CQ() {
  if (VC) return w0;
  VC = 1;
  var e = mu(), t = Object.prototype, n = t.hasOwnProperty, r = t.toString, a = e ? e.toStringTag : void 0;
  function o(l) {
    var u = n.call(l, a), f = l[a];
    try {
      l[a] = void 0;
      var d = !0;
    } catch {
    }
    var m = r.call(l);
    return d && (u ? l[a] = f : delete l[a]), m;
  }
  return w0 = o, w0;
}
var _0, KC;
function EQ() {
  if (KC) return _0;
  KC = 1;
  var e = Object.prototype, t = e.toString;
  function n(r) {
    return t.call(r);
  }
  return _0 = n, _0;
}
var S0, YC;
function Fo() {
  if (YC) return S0;
  YC = 1;
  var e = mu(), t = CQ(), n = EQ(), r = "[object Null]", a = "[object Undefined]", o = e ? e.toStringTag : void 0;
  function l(u) {
    return u == null ? u === void 0 ? a : r : o && o in Object(u) ? t(u) : n(u);
  }
  return S0 = l, S0;
}
var C0, XC;
function mi() {
  if (XC) return C0;
  XC = 1;
  function e(t) {
    var n = typeof t;
    return t != null && (n == "object" || n == "function");
  }
  return C0 = e, C0;
}
var E0, WC;
function pd() {
  if (WC) return E0;
  WC = 1;
  var e = Fo(), t = mi(), n = "[object AsyncFunction]", r = "[object Function]", a = "[object GeneratorFunction]", o = "[object Proxy]";
  function l(u) {
    if (!t(u))
      return !1;
    var f = e(u);
    return f == r || f == a || f == n || f == o;
  }
  return E0 = l, E0;
}
var k0, QC;
function kQ() {
  if (QC) return k0;
  QC = 1;
  var e = Di(), t = e["__core-js_shared__"];
  return k0 = t, k0;
}
var N0, ZC;
function NQ() {
  if (ZC) return N0;
  ZC = 1;
  var e = kQ(), t = (function() {
    var r = /[^.]+$/.exec(e && e.keys && e.keys.IE_PROTO || "");
    return r ? "Symbol(src)_1." + r : "";
  })();
  function n(r) {
    return !!t && t in r;
  }
  return N0 = n, N0;
}
var j0, JC;
function XT() {
  if (JC) return j0;
  JC = 1;
  var e = Function.prototype, t = e.toString;
  function n(r) {
    if (r != null) {
      try {
        return t.call(r);
      } catch {
      }
      try {
        return r + "";
      } catch {
      }
    }
    return "";
  }
  return j0 = n, j0;
}
var T0, eE;
function jQ() {
  if (eE) return T0;
  eE = 1;
  var e = pd(), t = NQ(), n = mi(), r = XT(), a = /[\\^$.*+?()[\]{}|]/g, o = /^\[object .+?Constructor\]$/, l = Function.prototype, u = Object.prototype, f = l.toString, d = u.hasOwnProperty, m = RegExp(
    "^" + f.call(d).replace(a, "\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g, "$1.*?") + "$"
  );
  function p(x) {
    if (!n(x) || t(x))
      return !1;
    var y = e(x) ? m : o;
    return y.test(r(x));
  }
  return T0 = p, T0;
}
var A0, tE;
function TQ() {
  if (tE) return A0;
  tE = 1;
  function e(t, n) {
    return t == null ? void 0 : t[n];
  }
  return A0 = e, A0;
}
var M0, nE;
function $o() {
  if (nE) return M0;
  nE = 1;
  var e = jQ(), t = TQ();
  function n(r, a) {
    var o = t(r, a);
    return e(o) ? o : void 0;
  }
  return M0 = n, M0;
}
var R0, rE;
function pw() {
  if (rE) return R0;
  rE = 1;
  var e = $o(), t = Di(), n = e(t, "Map");
  return R0 = n, R0;
}
var z0, iE;
function lm() {
  if (iE) return z0;
  iE = 1;
  var e = $o(), t = e(Object, "create");
  return z0 = t, z0;
}
var O0, aE;
function AQ() {
  if (aE) return O0;
  aE = 1;
  var e = lm();
  function t() {
    this.__data__ = e ? e(null) : {}, this.size = 0;
  }
  return O0 = t, O0;
}
var D0, sE;
function MQ() {
  if (sE) return D0;
  sE = 1;
  function e(t) {
    var n = this.has(t) && delete this.__data__[t];
    return this.size -= n ? 1 : 0, n;
  }
  return D0 = e, D0;
}
var I0, oE;
function RQ() {
  if (oE) return I0;
  oE = 1;
  var e = lm(), t = "__lodash_hash_undefined__", n = Object.prototype, r = n.hasOwnProperty;
  function a(o) {
    var l = this.__data__;
    if (e) {
      var u = l[o];
      return u === t ? void 0 : u;
    }
    return r.call(l, o) ? l[o] : void 0;
  }
  return I0 = a, I0;
}
var L0, lE;
function zQ() {
  if (lE) return L0;
  lE = 1;
  var e = lm(), t = Object.prototype, n = t.hasOwnProperty;
  function r(a) {
    var o = this.__data__;
    return e ? o[a] !== void 0 : n.call(o, a);
  }
  return L0 = r, L0;
}
var q0, uE;
function OQ() {
  if (uE) return q0;
  uE = 1;
  var e = lm(), t = "__lodash_hash_undefined__";
  function n(r, a) {
    var o = this.__data__;
    return this.size += this.has(r) ? 0 : 1, o[r] = e && a === void 0 ? t : a, this;
  }
  return q0 = n, q0;
}
var P0, cE;
function DQ() {
  if (cE) return P0;
  cE = 1;
  var e = AQ(), t = MQ(), n = RQ(), r = zQ(), a = OQ();
  function o(l) {
    var u = -1, f = l == null ? 0 : l.length;
    for (this.clear(); ++u < f; ) {
      var d = l[u];
      this.set(d[0], d[1]);
    }
  }
  return o.prototype.clear = e, o.prototype.delete = t, o.prototype.get = n, o.prototype.has = r, o.prototype.set = a, P0 = o, P0;
}
var B0, dE;
function IQ() {
  if (dE) return B0;
  dE = 1;
  var e = DQ(), t = om(), n = pw();
  function r() {
    this.size = 0, this.__data__ = {
      hash: new e(),
      map: new (n || t)(),
      string: new e()
    };
  }
  return B0 = r, B0;
}
var F0, fE;
function LQ() {
  if (fE) return F0;
  fE = 1;
  function e(t) {
    var n = typeof t;
    return n == "string" || n == "number" || n == "symbol" || n == "boolean" ? t !== "__proto__" : t === null;
  }
  return F0 = e, F0;
}
var $0, hE;
function um() {
  if (hE) return $0;
  hE = 1;
  var e = LQ();
  function t(n, r) {
    var a = n.__data__;
    return e(r) ? a[typeof r == "string" ? "string" : "hash"] : a.map;
  }
  return $0 = t, $0;
}
var U0, mE;
function qQ() {
  if (mE) return U0;
  mE = 1;
  var e = um();
  function t(n) {
    var r = e(this, n).delete(n);
    return this.size -= r ? 1 : 0, r;
  }
  return U0 = t, U0;
}
var H0, pE;
function PQ() {
  if (pE) return H0;
  pE = 1;
  var e = um();
  function t(n) {
    return e(this, n).get(n);
  }
  return H0 = t, H0;
}
var G0, gE;
function BQ() {
  if (gE) return G0;
  gE = 1;
  var e = um();
  function t(n) {
    return e(this, n).has(n);
  }
  return G0 = t, G0;
}
var V0, yE;
function FQ() {
  if (yE) return V0;
  yE = 1;
  var e = um();
  function t(n, r) {
    var a = e(this, n), o = a.size;
    return a.set(n, r), this.size += a.size == o ? 0 : 1, this;
  }
  return V0 = t, V0;
}
var K0, xE;
function gw() {
  if (xE) return K0;
  xE = 1;
  var e = IQ(), t = qQ(), n = PQ(), r = BQ(), a = FQ();
  function o(l) {
    var u = -1, f = l == null ? 0 : l.length;
    for (this.clear(); ++u < f; ) {
      var d = l[u];
      this.set(d[0], d[1]);
    }
  }
  return o.prototype.clear = e, o.prototype.delete = t, o.prototype.get = n, o.prototype.has = r, o.prototype.set = a, K0 = o, K0;
}
var Y0, vE;
function $Q() {
  if (vE) return Y0;
  vE = 1;
  var e = om(), t = pw(), n = gw(), r = 200;
  function a(o, l) {
    var u = this.__data__;
    if (u instanceof e) {
      var f = u.__data__;
      if (!t || f.length < r - 1)
        return f.push([o, l]), this.size = ++u.size, this;
      u = this.__data__ = new n(f);
    }
    return u.set(o, l), this.size = u.size, this;
  }
  return Y0 = a, Y0;
}
var X0, bE;
function cm() {
  if (bE) return X0;
  bE = 1;
  var e = om(), t = bQ(), n = wQ(), r = _Q(), a = SQ(), o = $Q();
  function l(u) {
    var f = this.__data__ = new e(u);
    this.size = f.size;
  }
  return l.prototype.clear = t, l.prototype.delete = n, l.prototype.get = r, l.prototype.has = a, l.prototype.set = o, X0 = l, X0;
}
var W0, wE;
function yw() {
  if (wE) return W0;
  wE = 1;
  function e(t, n) {
    for (var r = -1, a = t == null ? 0 : t.length; ++r < a && n(t[r], r, t) !== !1; )
      ;
    return t;
  }
  return W0 = e, W0;
}
var Q0, _E;
function WT() {
  if (_E) return Q0;
  _E = 1;
  var e = $o(), t = (function() {
    try {
      var n = e(Object, "defineProperty");
      return n({}, "", {}), n;
    } catch {
    }
  })();
  return Q0 = t, Q0;
}
var Z0, SE;
function dm() {
  if (SE) return Z0;
  SE = 1;
  var e = WT();
  function t(n, r, a) {
    r == "__proto__" && e ? e(n, r, {
      configurable: !0,
      enumerable: !0,
      value: a,
      writable: !0
    }) : n[r] = a;
  }
  return Z0 = t, Z0;
}
var J0, CE;
function fm() {
  if (CE) return J0;
  CE = 1;
  var e = dm(), t = hu(), n = Object.prototype, r = n.hasOwnProperty;
  function a(o, l, u) {
    var f = o[l];
    (!(r.call(o, l) && t(f, u)) || u === void 0 && !(l in o)) && e(o, l, u);
  }
  return J0 = a, J0;
}
var ey, EE;
function gd() {
  if (EE) return ey;
  EE = 1;
  var e = fm(), t = dm();
  function n(r, a, o, l) {
    var u = !o;
    o || (o = {});
    for (var f = -1, d = a.length; ++f < d; ) {
      var m = a[f], p = l ? l(o[m], r[m], m, o, r) : void 0;
      p === void 0 && (p = r[m]), u ? t(o, m, p) : e(o, m, p);
    }
    return o;
  }
  return ey = n, ey;
}
var ty, kE;
function UQ() {
  if (kE) return ty;
  kE = 1;
  function e(t, n) {
    for (var r = -1, a = Array(t); ++r < t; )
      a[r] = n(r);
    return a;
  }
  return ty = e, ty;
}
var ny, NE;
function ia() {
  if (NE) return ny;
  NE = 1;
  function e(t) {
    return t != null && typeof t == "object";
  }
  return ny = e, ny;
}
var ry, jE;
function HQ() {
  if (jE) return ry;
  jE = 1;
  var e = Fo(), t = ia(), n = "[object Arguments]";
  function r(a) {
    return t(a) && e(a) == n;
  }
  return ry = r, ry;
}
var iy, TE;
function yd() {
  if (TE) return iy;
  TE = 1;
  var e = HQ(), t = ia(), n = Object.prototype, r = n.hasOwnProperty, a = n.propertyIsEnumerable, o = e(/* @__PURE__ */ (function() {
    return arguments;
  })()) ? e : function(l) {
    return t(l) && r.call(l, "callee") && !a.call(l, "callee");
  };
  return iy = o, iy;
}
var ay, AE;
function Dn() {
  if (AE) return ay;
  AE = 1;
  var e = Array.isArray;
  return ay = e, ay;
}
var Rc = { exports: {} }, sy, ME;
function GQ() {
  if (ME) return sy;
  ME = 1;
  function e() {
    return !1;
  }
  return sy = e, sy;
}
Rc.exports;
var RE;
function pu() {
  return RE || (RE = 1, (function(e, t) {
    var n = Di(), r = GQ(), a = t && !t.nodeType && t, o = a && !0 && e && !e.nodeType && e, l = o && o.exports === a, u = l ? n.Buffer : void 0, f = u ? u.isBuffer : void 0, d = f || r;
    e.exports = d;
  })(Rc, Rc.exports)), Rc.exports;
}
var oy, zE;
function hm() {
  if (zE) return oy;
  zE = 1;
  var e = 9007199254740991, t = /^(?:0|[1-9]\d*)$/;
  function n(r, a) {
    var o = typeof r;
    return a = a ?? e, !!a && (o == "number" || o != "symbol" && t.test(r)) && r > -1 && r % 1 == 0 && r < a;
  }
  return oy = n, oy;
}
var ly, OE;
function xw() {
  if (OE) return ly;
  OE = 1;
  var e = 9007199254740991;
  function t(n) {
    return typeof n == "number" && n > -1 && n % 1 == 0 && n <= e;
  }
  return ly = t, ly;
}
var uy, DE;
function VQ() {
  if (DE) return uy;
  DE = 1;
  var e = Fo(), t = xw(), n = ia(), r = "[object Arguments]", a = "[object Array]", o = "[object Boolean]", l = "[object Date]", u = "[object Error]", f = "[object Function]", d = "[object Map]", m = "[object Number]", p = "[object Object]", x = "[object RegExp]", y = "[object Set]", w = "[object String]", E = "[object WeakMap]", k = "[object ArrayBuffer]", C = "[object DataView]", T = "[object Float32Array]", N = "[object Float64Array]", A = "[object Int8Array]", D = "[object Int16Array]", M = "[object Int32Array]", O = "[object Uint8Array]", Y = "[object Uint8ClampedArray]", X = "[object Uint16Array]", U = "[object Uint32Array]", B = {};
  B[T] = B[N] = B[A] = B[D] = B[M] = B[O] = B[Y] = B[X] = B[U] = !0, B[r] = B[a] = B[k] = B[o] = B[C] = B[l] = B[u] = B[f] = B[d] = B[m] = B[p] = B[x] = B[y] = B[w] = B[E] = !1;
  function G(re) {
    return n(re) && t(re.length) && !!B[e(re)];
  }
  return uy = G, uy;
}
var cy, IE;
function mm() {
  if (IE) return cy;
  IE = 1;
  function e(t) {
    return function(n) {
      return t(n);
    };
  }
  return cy = e, cy;
}
var zc = { exports: {} };
zc.exports;
var LE;
function vw() {
  return LE || (LE = 1, (function(e, t) {
    var n = YT(), r = t && !t.nodeType && t, a = r && !0 && e && !e.nodeType && e, o = a && a.exports === r, l = o && n.process, u = (function() {
      try {
        var f = a && a.require && a.require("util").types;
        return f || l && l.binding && l.binding("util");
      } catch {
      }
    })();
    e.exports = u;
  })(zc, zc.exports)), zc.exports;
}
var dy, qE;
function xd() {
  if (qE) return dy;
  qE = 1;
  var e = VQ(), t = mm(), n = vw(), r = n && n.isTypedArray, a = r ? t(r) : e;
  return dy = a, dy;
}
var fy, PE;
function QT() {
  if (PE) return fy;
  PE = 1;
  var e = UQ(), t = yd(), n = Dn(), r = pu(), a = hm(), o = xd(), l = Object.prototype, u = l.hasOwnProperty;
  function f(d, m) {
    var p = n(d), x = !p && t(d), y = !p && !x && r(d), w = !p && !x && !y && o(d), E = p || x || y || w, k = E ? e(d.length, String) : [], C = k.length;
    for (var T in d)
      (m || u.call(d, T)) && !(E && // Safari 9 has enumerable `arguments.length` in strict mode.
      (T == "length" || // Node.js 0.10 has enumerable non-index properties on buffers.
      y && (T == "offset" || T == "parent") || // PhantomJS 2 has enumerable non-index properties on typed arrays.
      w && (T == "buffer" || T == "byteLength" || T == "byteOffset") || // Skip index properties.
      a(T, C))) && k.push(T);
    return k;
  }
  return fy = f, fy;
}
var hy, BE;
function pm() {
  if (BE) return hy;
  BE = 1;
  var e = Object.prototype;
  function t(n) {
    var r = n && n.constructor, a = typeof r == "function" && r.prototype || e;
    return n === a;
  }
  return hy = t, hy;
}
var my, FE;
function ZT() {
  if (FE) return my;
  FE = 1;
  function e(t, n) {
    return function(r) {
      return t(n(r));
    };
  }
  return my = e, my;
}
var py, $E;
function KQ() {
  if ($E) return py;
  $E = 1;
  var e = ZT(), t = e(Object.keys, Object);
  return py = t, py;
}
var gy, UE;
function bw() {
  if (UE) return gy;
  UE = 1;
  var e = pm(), t = KQ(), n = Object.prototype, r = n.hasOwnProperty;
  function a(o) {
    if (!e(o))
      return t(o);
    var l = [];
    for (var u in Object(o))
      r.call(o, u) && u != "constructor" && l.push(u);
    return l;
  }
  return gy = a, gy;
}
var yy, HE;
function Wa() {
  if (HE) return yy;
  HE = 1;
  var e = pd(), t = xw();
  function n(r) {
    return r != null && t(r.length) && !e(r);
  }
  return yy = n, yy;
}
var xy, GE;
function Hs() {
  if (GE) return xy;
  GE = 1;
  var e = QT(), t = bw(), n = Wa();
  function r(a) {
    return n(a) ? e(a) : t(a);
  }
  return xy = r, xy;
}
var vy, VE;
function YQ() {
  if (VE) return vy;
  VE = 1;
  var e = gd(), t = Hs();
  function n(r, a) {
    return r && e(a, t(a), r);
  }
  return vy = n, vy;
}
var by, KE;
function XQ() {
  if (KE) return by;
  KE = 1;
  function e(t) {
    var n = [];
    if (t != null)
      for (var r in Object(t))
        n.push(r);
    return n;
  }
  return by = e, by;
}
var wy, YE;
function WQ() {
  if (YE) return wy;
  YE = 1;
  var e = mi(), t = pm(), n = XQ(), r = Object.prototype, a = r.hasOwnProperty;
  function o(l) {
    if (!e(l))
      return n(l);
    var u = t(l), f = [];
    for (var d in l)
      d == "constructor" && (u || !a.call(l, d)) || f.push(d);
    return f;
  }
  return wy = o, wy;
}
var _y, XE;
function Uo() {
  if (XE) return _y;
  XE = 1;
  var e = QT(), t = WQ(), n = Wa();
  function r(a) {
    return n(a) ? e(a, !0) : t(a);
  }
  return _y = r, _y;
}
var Sy, WE;
function QQ() {
  if (WE) return Sy;
  WE = 1;
  var e = gd(), t = Uo();
  function n(r, a) {
    return r && e(a, t(a), r);
  }
  return Sy = n, Sy;
}
var Oc = { exports: {} };
Oc.exports;
var QE;
function JT() {
  return QE || (QE = 1, (function(e, t) {
    var n = Di(), r = t && !t.nodeType && t, a = r && !0 && e && !e.nodeType && e, o = a && a.exports === r, l = o ? n.Buffer : void 0, u = l ? l.allocUnsafe : void 0;
    function f(d, m) {
      if (m)
        return d.slice();
      var p = d.length, x = u ? u(p) : new d.constructor(p);
      return d.copy(x), x;
    }
    e.exports = f;
  })(Oc, Oc.exports)), Oc.exports;
}
var Cy, ZE;
function eA() {
  if (ZE) return Cy;
  ZE = 1;
  function e(t, n) {
    var r = -1, a = t.length;
    for (n || (n = Array(a)); ++r < a; )
      n[r] = t[r];
    return n;
  }
  return Cy = e, Cy;
}
var Ey, JE;
function tA() {
  if (JE) return Ey;
  JE = 1;
  function e(t, n) {
    for (var r = -1, a = t == null ? 0 : t.length, o = 0, l = []; ++r < a; ) {
      var u = t[r];
      n(u, r, t) && (l[o++] = u);
    }
    return l;
  }
  return Ey = e, Ey;
}
var ky, ek;
function nA() {
  if (ek) return ky;
  ek = 1;
  function e() {
    return [];
  }
  return ky = e, ky;
}
var Ny, tk;
function ww() {
  if (tk) return Ny;
  tk = 1;
  var e = tA(), t = nA(), n = Object.prototype, r = n.propertyIsEnumerable, a = Object.getOwnPropertySymbols, o = a ? function(l) {
    return l == null ? [] : (l = Object(l), e(a(l), function(u) {
      return r.call(l, u);
    }));
  } : t;
  return Ny = o, Ny;
}
var jy, nk;
function ZQ() {
  if (nk) return jy;
  nk = 1;
  var e = gd(), t = ww();
  function n(r, a) {
    return e(r, t(r), a);
  }
  return jy = n, jy;
}
var Ty, rk;
function _w() {
  if (rk) return Ty;
  rk = 1;
  function e(t, n) {
    for (var r = -1, a = n.length, o = t.length; ++r < a; )
      t[o + r] = n[r];
    return t;
  }
  return Ty = e, Ty;
}
var Ay, ik;
function gm() {
  if (ik) return Ay;
  ik = 1;
  var e = ZT(), t = e(Object.getPrototypeOf, Object);
  return Ay = t, Ay;
}
var My, ak;
function rA() {
  if (ak) return My;
  ak = 1;
  var e = _w(), t = gm(), n = ww(), r = nA(), a = Object.getOwnPropertySymbols, o = a ? function(l) {
    for (var u = []; l; )
      e(u, n(l)), l = t(l);
    return u;
  } : r;
  return My = o, My;
}
var Ry, sk;
function JQ() {
  if (sk) return Ry;
  sk = 1;
  var e = gd(), t = rA();
  function n(r, a) {
    return e(r, t(r), a);
  }
  return Ry = n, Ry;
}
var zy, ok;
function iA() {
  if (ok) return zy;
  ok = 1;
  var e = _w(), t = Dn();
  function n(r, a, o) {
    var l = a(r);
    return t(r) ? l : e(l, o(r));
  }
  return zy = n, zy;
}
var Oy, lk;
function aA() {
  if (lk) return Oy;
  lk = 1;
  var e = iA(), t = ww(), n = Hs();
  function r(a) {
    return e(a, n, t);
  }
  return Oy = r, Oy;
}
var Dy, uk;
function eZ() {
  if (uk) return Dy;
  uk = 1;
  var e = iA(), t = rA(), n = Uo();
  function r(a) {
    return e(a, n, t);
  }
  return Dy = r, Dy;
}
var Iy, ck;
function tZ() {
  if (ck) return Iy;
  ck = 1;
  var e = $o(), t = Di(), n = e(t, "DataView");
  return Iy = n, Iy;
}
var Ly, dk;
function nZ() {
  if (dk) return Ly;
  dk = 1;
  var e = $o(), t = Di(), n = e(t, "Promise");
  return Ly = n, Ly;
}
var qy, fk;
function sA() {
  if (fk) return qy;
  fk = 1;
  var e = $o(), t = Di(), n = e(t, "Set");
  return qy = n, qy;
}
var Py, hk;
function rZ() {
  if (hk) return Py;
  hk = 1;
  var e = $o(), t = Di(), n = e(t, "WeakMap");
  return Py = n, Py;
}
var By, mk;
function gu() {
  if (mk) return By;
  mk = 1;
  var e = tZ(), t = pw(), n = nZ(), r = sA(), a = rZ(), o = Fo(), l = XT(), u = "[object Map]", f = "[object Object]", d = "[object Promise]", m = "[object Set]", p = "[object WeakMap]", x = "[object DataView]", y = l(e), w = l(t), E = l(n), k = l(r), C = l(a), T = o;
  return (e && T(new e(new ArrayBuffer(1))) != x || t && T(new t()) != u || n && T(n.resolve()) != d || r && T(new r()) != m || a && T(new a()) != p) && (T = function(N) {
    var A = o(N), D = A == f ? N.constructor : void 0, M = D ? l(D) : "";
    if (M)
      switch (M) {
        case y:
          return x;
        case w:
          return u;
        case E:
          return d;
        case k:
          return m;
        case C:
          return p;
      }
    return A;
  }), By = T, By;
}
var Fy, pk;
function iZ() {
  if (pk) return Fy;
  pk = 1;
  var e = Object.prototype, t = e.hasOwnProperty;
  function n(r) {
    var a = r.length, o = new r.constructor(a);
    return a && typeof r[0] == "string" && t.call(r, "index") && (o.index = r.index, o.input = r.input), o;
  }
  return Fy = n, Fy;
}
var $y, gk;
function oA() {
  if (gk) return $y;
  gk = 1;
  var e = Di(), t = e.Uint8Array;
  return $y = t, $y;
}
var Uy, yk;
function Sw() {
  if (yk) return Uy;
  yk = 1;
  var e = oA();
  function t(n) {
    var r = new n.constructor(n.byteLength);
    return new e(r).set(new e(n)), r;
  }
  return Uy = t, Uy;
}
var Hy, xk;
function aZ() {
  if (xk) return Hy;
  xk = 1;
  var e = Sw();
  function t(n, r) {
    var a = r ? e(n.buffer) : n.buffer;
    return new n.constructor(a, n.byteOffset, n.byteLength);
  }
  return Hy = t, Hy;
}
var Gy, vk;
function sZ() {
  if (vk) return Gy;
  vk = 1;
  var e = /\w*$/;
  function t(n) {
    var r = new n.constructor(n.source, e.exec(n));
    return r.lastIndex = n.lastIndex, r;
  }
  return Gy = t, Gy;
}
var Vy, bk;
function oZ() {
  if (bk) return Vy;
  bk = 1;
  var e = mu(), t = e ? e.prototype : void 0, n = t ? t.valueOf : void 0;
  function r(a) {
    return n ? Object(n.call(a)) : {};
  }
  return Vy = r, Vy;
}
var Ky, wk;
function lA() {
  if (wk) return Ky;
  wk = 1;
  var e = Sw();
  function t(n, r) {
    var a = r ? e(n.buffer) : n.buffer;
    return new n.constructor(a, n.byteOffset, n.length);
  }
  return Ky = t, Ky;
}
var Yy, _k;
function lZ() {
  if (_k) return Yy;
  _k = 1;
  var e = Sw(), t = aZ(), n = sZ(), r = oZ(), a = lA(), o = "[object Boolean]", l = "[object Date]", u = "[object Map]", f = "[object Number]", d = "[object RegExp]", m = "[object Set]", p = "[object String]", x = "[object Symbol]", y = "[object ArrayBuffer]", w = "[object DataView]", E = "[object Float32Array]", k = "[object Float64Array]", C = "[object Int8Array]", T = "[object Int16Array]", N = "[object Int32Array]", A = "[object Uint8Array]", D = "[object Uint8ClampedArray]", M = "[object Uint16Array]", O = "[object Uint32Array]";
  function Y(X, U, B) {
    var G = X.constructor;
    switch (U) {
      case y:
        return e(X);
      case o:
      case l:
        return new G(+X);
      case w:
        return t(X, B);
      case E:
      case k:
      case C:
      case T:
      case N:
      case A:
      case D:
      case M:
      case O:
        return a(X, B);
      case u:
        return new G();
      case f:
      case p:
        return new G(X);
      case d:
        return n(X);
      case m:
        return new G();
      case x:
        return r(X);
    }
  }
  return Yy = Y, Yy;
}
var Xy, Sk;
function uA() {
  if (Sk) return Xy;
  Sk = 1;
  var e = mi(), t = Object.create, n = /* @__PURE__ */ (function() {
    function r() {
    }
    return function(a) {
      if (!e(a))
        return {};
      if (t)
        return t(a);
      r.prototype = a;
      var o = new r();
      return r.prototype = void 0, o;
    };
  })();
  return Xy = n, Xy;
}
var Wy, Ck;
function cA() {
  if (Ck) return Wy;
  Ck = 1;
  var e = uA(), t = gm(), n = pm();
  function r(a) {
    return typeof a.constructor == "function" && !n(a) ? e(t(a)) : {};
  }
  return Wy = r, Wy;
}
var Qy, Ek;
function uZ() {
  if (Ek) return Qy;
  Ek = 1;
  var e = gu(), t = ia(), n = "[object Map]";
  function r(a) {
    return t(a) && e(a) == n;
  }
  return Qy = r, Qy;
}
var Zy, kk;
function cZ() {
  if (kk) return Zy;
  kk = 1;
  var e = uZ(), t = mm(), n = vw(), r = n && n.isMap, a = r ? t(r) : e;
  return Zy = a, Zy;
}
var Jy, Nk;
function dZ() {
  if (Nk) return Jy;
  Nk = 1;
  var e = gu(), t = ia(), n = "[object Set]";
  function r(a) {
    return t(a) && e(a) == n;
  }
  return Jy = r, Jy;
}
var e1, jk;
function fZ() {
  if (jk) return e1;
  jk = 1;
  var e = dZ(), t = mm(), n = vw(), r = n && n.isSet, a = r ? t(r) : e;
  return e1 = a, e1;
}
var t1, Tk;
function dA() {
  if (Tk) return t1;
  Tk = 1;
  var e = cm(), t = yw(), n = fm(), r = YQ(), a = QQ(), o = JT(), l = eA(), u = ZQ(), f = JQ(), d = aA(), m = eZ(), p = gu(), x = iZ(), y = lZ(), w = cA(), E = Dn(), k = pu(), C = cZ(), T = mi(), N = fZ(), A = Hs(), D = Uo(), M = 1, O = 2, Y = 4, X = "[object Arguments]", U = "[object Array]", B = "[object Boolean]", G = "[object Date]", re = "[object Error]", q = "[object Function]", W = "[object GeneratorFunction]", V = "[object Map]", ee = "[object Number]", te = "[object Object]", ie = "[object RegExp]", H = "[object Set]", L = "[object String]", J = "[object Symbol]", F = "[object WeakMap]", Z = "[object ArrayBuffer]", oe = "[object DataView]", fe = "[object Float32Array]", Se = "[object Float64Array]", Te = "[object Int8Array]", we = "[object Int16Array]", ke = "[object Int32Array]", _e = "[object Uint8Array]", Ae = "[object Uint8ClampedArray]", Pe = "[object Uint16Array]", Qe = "[object Uint32Array]", qe = {};
  qe[X] = qe[U] = qe[Z] = qe[oe] = qe[B] = qe[G] = qe[fe] = qe[Se] = qe[Te] = qe[we] = qe[ke] = qe[V] = qe[ee] = qe[te] = qe[ie] = qe[H] = qe[L] = qe[J] = qe[_e] = qe[Ae] = qe[Pe] = qe[Qe] = !0, qe[re] = qe[q] = qe[F] = !1;
  function at(st, mn, Jt, Sn, Kt, vn) {
    var qt, Yt = mn & M, In = mn & O, Re = mn & Y;
    if (Jt && (qt = Kt ? Jt(st, Sn, Kt, vn) : Jt(st)), qt !== void 0)
      return qt;
    if (!T(st))
      return st;
    var Be = E(st);
    if (Be) {
      if (qt = x(st), !Yt)
        return l(st, qt);
    } else {
      var rt = p(st), dt = rt == q || rt == W;
      if (k(st))
        return o(st, Yt);
      if (rt == te || rt == X || dt && !Kt) {
        if (qt = In || dt ? {} : w(st), !Yt)
          return In ? f(st, a(qt, st)) : u(st, r(qt, st));
      } else {
        if (!qe[rt])
          return Kt ? st : {};
        qt = y(st, rt, Yt);
      }
    }
    vn || (vn = new e());
    var xt = vn.get(st);
    if (xt)
      return xt;
    vn.set(st, qt), N(st) ? st.forEach(function(It) {
      qt.add(at(It, mn, Jt, It, st, vn));
    }) : C(st) && st.forEach(function(It, Rt) {
      qt.set(Rt, at(It, mn, Jt, Rt, st, vn));
    });
    var pn = Re ? In ? m : d : In ? D : A, gn = Be ? void 0 : pn(st);
    return t(gn || st, function(It, Rt) {
      gn && (Rt = It, It = st[Rt]), n(qt, Rt, at(It, mn, Jt, Rt, st, vn));
    }), qt;
  }
  return t1 = at, t1;
}
var n1, Ak;
function hZ() {
  if (Ak) return n1;
  Ak = 1;
  var e = dA(), t = 4;
  function n(r) {
    return e(r, t);
  }
  return n1 = n, n1;
}
var r1, Mk;
function Cw() {
  if (Mk) return r1;
  Mk = 1;
  function e(t) {
    return function() {
      return t;
    };
  }
  return r1 = e, r1;
}
var i1, Rk;
function mZ() {
  if (Rk) return i1;
  Rk = 1;
  function e(t) {
    return function(n, r, a) {
      for (var o = -1, l = Object(n), u = a(n), f = u.length; f--; ) {
        var d = u[t ? f : ++o];
        if (r(l[d], d, l) === !1)
          break;
      }
      return n;
    };
  }
  return i1 = e, i1;
}
var a1, zk;
function Ew() {
  if (zk) return a1;
  zk = 1;
  var e = mZ(), t = e();
  return a1 = t, a1;
}
var s1, Ok;
function kw() {
  if (Ok) return s1;
  Ok = 1;
  var e = Ew(), t = Hs();
  function n(r, a) {
    return r && e(r, a, t);
  }
  return s1 = n, s1;
}
var o1, Dk;
function pZ() {
  if (Dk) return o1;
  Dk = 1;
  var e = Wa();
  function t(n, r) {
    return function(a, o) {
      if (a == null)
        return a;
      if (!e(a))
        return n(a, o);
      for (var l = a.length, u = r ? l : -1, f = Object(a); (r ? u-- : ++u < l) && o(f[u], u, f) !== !1; )
        ;
      return a;
    };
  }
  return o1 = t, o1;
}
var l1, Ik;
function ym() {
  if (Ik) return l1;
  Ik = 1;
  var e = kw(), t = pZ(), n = t(e);
  return l1 = n, l1;
}
var u1, Lk;
function Ho() {
  if (Lk) return u1;
  Lk = 1;
  function e(t) {
    return t;
  }
  return u1 = e, u1;
}
var c1, qk;
function fA() {
  if (qk) return c1;
  qk = 1;
  var e = Ho();
  function t(n) {
    return typeof n == "function" ? n : e;
  }
  return c1 = t, c1;
}
var d1, Pk;
function hA() {
  if (Pk) return d1;
  Pk = 1;
  var e = yw(), t = ym(), n = fA(), r = Dn();
  function a(o, l) {
    var u = r(o) ? e : t;
    return u(o, n(l));
  }
  return d1 = a, d1;
}
var f1, Bk;
function mA() {
  return Bk || (Bk = 1, f1 = hA()), f1;
}
var h1, Fk;
function gZ() {
  if (Fk) return h1;
  Fk = 1;
  var e = ym();
  function t(n, r) {
    var a = [];
    return e(n, function(o, l, u) {
      r(o, l, u) && a.push(o);
    }), a;
  }
  return h1 = t, h1;
}
var m1, $k;
function yZ() {
  if ($k) return m1;
  $k = 1;
  var e = "__lodash_hash_undefined__";
  function t(n) {
    return this.__data__.set(n, e), this;
  }
  return m1 = t, m1;
}
var p1, Uk;
function xZ() {
  if (Uk) return p1;
  Uk = 1;
  function e(t) {
    return this.__data__.has(t);
  }
  return p1 = e, p1;
}
var g1, Hk;
function pA() {
  if (Hk) return g1;
  Hk = 1;
  var e = gw(), t = yZ(), n = xZ();
  function r(a) {
    var o = -1, l = a == null ? 0 : a.length;
    for (this.__data__ = new e(); ++o < l; )
      this.add(a[o]);
  }
  return r.prototype.add = r.prototype.push = t, r.prototype.has = n, g1 = r, g1;
}
var y1, Gk;
function vZ() {
  if (Gk) return y1;
  Gk = 1;
  function e(t, n) {
    for (var r = -1, a = t == null ? 0 : t.length; ++r < a; )
      if (n(t[r], r, t))
        return !0;
    return !1;
  }
  return y1 = e, y1;
}
var x1, Vk;
function gA() {
  if (Vk) return x1;
  Vk = 1;
  function e(t, n) {
    return t.has(n);
  }
  return x1 = e, x1;
}
var v1, Kk;
function yA() {
  if (Kk) return v1;
  Kk = 1;
  var e = pA(), t = vZ(), n = gA(), r = 1, a = 2;
  function o(l, u, f, d, m, p) {
    var x = f & r, y = l.length, w = u.length;
    if (y != w && !(x && w > y))
      return !1;
    var E = p.get(l), k = p.get(u);
    if (E && k)
      return E == u && k == l;
    var C = -1, T = !0, N = f & a ? new e() : void 0;
    for (p.set(l, u), p.set(u, l); ++C < y; ) {
      var A = l[C], D = u[C];
      if (d)
        var M = x ? d(D, A, C, u, l, p) : d(A, D, C, l, u, p);
      if (M !== void 0) {
        if (M)
          continue;
        T = !1;
        break;
      }
      if (N) {
        if (!t(u, function(O, Y) {
          if (!n(N, Y) && (A === O || m(A, O, f, d, p)))
            return N.push(Y);
        })) {
          T = !1;
          break;
        }
      } else if (!(A === D || m(A, D, f, d, p))) {
        T = !1;
        break;
      }
    }
    return p.delete(l), p.delete(u), T;
  }
  return v1 = o, v1;
}
var b1, Yk;
function bZ() {
  if (Yk) return b1;
  Yk = 1;
  function e(t) {
    var n = -1, r = Array(t.size);
    return t.forEach(function(a, o) {
      r[++n] = [o, a];
    }), r;
  }
  return b1 = e, b1;
}
var w1, Xk;
function Nw() {
  if (Xk) return w1;
  Xk = 1;
  function e(t) {
    var n = -1, r = Array(t.size);
    return t.forEach(function(a) {
      r[++n] = a;
    }), r;
  }
  return w1 = e, w1;
}
var _1, Wk;
function wZ() {
  if (Wk) return _1;
  Wk = 1;
  var e = mu(), t = oA(), n = hu(), r = yA(), a = bZ(), o = Nw(), l = 1, u = 2, f = "[object Boolean]", d = "[object Date]", m = "[object Error]", p = "[object Map]", x = "[object Number]", y = "[object RegExp]", w = "[object Set]", E = "[object String]", k = "[object Symbol]", C = "[object ArrayBuffer]", T = "[object DataView]", N = e ? e.prototype : void 0, A = N ? N.valueOf : void 0;
  function D(M, O, Y, X, U, B, G) {
    switch (Y) {
      case T:
        if (M.byteLength != O.byteLength || M.byteOffset != O.byteOffset)
          return !1;
        M = M.buffer, O = O.buffer;
      case C:
        return !(M.byteLength != O.byteLength || !B(new t(M), new t(O)));
      case f:
      case d:
      case x:
        return n(+M, +O);
      case m:
        return M.name == O.name && M.message == O.message;
      case y:
      case E:
        return M == O + "";
      case p:
        var re = a;
      case w:
        var q = X & l;
        if (re || (re = o), M.size != O.size && !q)
          return !1;
        var W = G.get(M);
        if (W)
          return W == O;
        X |= u, G.set(M, O);
        var V = r(re(M), re(O), X, U, B, G);
        return G.delete(M), V;
      case k:
        if (A)
          return A.call(M) == A.call(O);
    }
    return !1;
  }
  return _1 = D, _1;
}
var S1, Qk;
function _Z() {
  if (Qk) return S1;
  Qk = 1;
  var e = aA(), t = 1, n = Object.prototype, r = n.hasOwnProperty;
  function a(o, l, u, f, d, m) {
    var p = u & t, x = e(o), y = x.length, w = e(l), E = w.length;
    if (y != E && !p)
      return !1;
    for (var k = y; k--; ) {
      var C = x[k];
      if (!(p ? C in l : r.call(l, C)))
        return !1;
    }
    var T = m.get(o), N = m.get(l);
    if (T && N)
      return T == l && N == o;
    var A = !0;
    m.set(o, l), m.set(l, o);
    for (var D = p; ++k < y; ) {
      C = x[k];
      var M = o[C], O = l[C];
      if (f)
        var Y = p ? f(O, M, C, l, o, m) : f(M, O, C, o, l, m);
      if (!(Y === void 0 ? M === O || d(M, O, u, f, m) : Y)) {
        A = !1;
        break;
      }
      D || (D = C == "constructor");
    }
    if (A && !D) {
      var X = o.constructor, U = l.constructor;
      X != U && "constructor" in o && "constructor" in l && !(typeof X == "function" && X instanceof X && typeof U == "function" && U instanceof U) && (A = !1);
    }
    return m.delete(o), m.delete(l), A;
  }
  return S1 = a, S1;
}
var C1, Zk;
function SZ() {
  if (Zk) return C1;
  Zk = 1;
  var e = cm(), t = yA(), n = wZ(), r = _Z(), a = gu(), o = Dn(), l = pu(), u = xd(), f = 1, d = "[object Arguments]", m = "[object Array]", p = "[object Object]", x = Object.prototype, y = x.hasOwnProperty;
  function w(E, k, C, T, N, A) {
    var D = o(E), M = o(k), O = D ? m : a(E), Y = M ? m : a(k);
    O = O == d ? p : O, Y = Y == d ? p : Y;
    var X = O == p, U = Y == p, B = O == Y;
    if (B && l(E)) {
      if (!l(k))
        return !1;
      D = !0, X = !1;
    }
    if (B && !X)
      return A || (A = new e()), D || u(E) ? t(E, k, C, T, N, A) : n(E, k, O, C, T, N, A);
    if (!(C & f)) {
      var G = X && y.call(E, "__wrapped__"), re = U && y.call(k, "__wrapped__");
      if (G || re) {
        var q = G ? E.value() : E, W = re ? k.value() : k;
        return A || (A = new e()), N(q, W, C, T, A);
      }
    }
    return B ? (A || (A = new e()), r(E, k, C, T, N, A)) : !1;
  }
  return C1 = w, C1;
}
var E1, Jk;
function xA() {
  if (Jk) return E1;
  Jk = 1;
  var e = SZ(), t = ia();
  function n(r, a, o, l, u) {
    return r === a ? !0 : r == null || a == null || !t(r) && !t(a) ? r !== r && a !== a : e(r, a, o, l, n, u);
  }
  return E1 = n, E1;
}
var k1, e6;
function CZ() {
  if (e6) return k1;
  e6 = 1;
  var e = cm(), t = xA(), n = 1, r = 2;
  function a(o, l, u, f) {
    var d = u.length, m = d, p = !f;
    if (o == null)
      return !m;
    for (o = Object(o); d--; ) {
      var x = u[d];
      if (p && x[2] ? x[1] !== o[x[0]] : !(x[0] in o))
        return !1;
    }
    for (; ++d < m; ) {
      x = u[d];
      var y = x[0], w = o[y], E = x[1];
      if (p && x[2]) {
        if (w === void 0 && !(y in o))
          return !1;
      } else {
        var k = new e();
        if (f)
          var C = f(w, E, y, o, l, k);
        if (!(C === void 0 ? t(E, w, n | r, f, k) : C))
          return !1;
      }
    }
    return !0;
  }
  return k1 = a, k1;
}
var N1, t6;
function vA() {
  if (t6) return N1;
  t6 = 1;
  var e = mi();
  function t(n) {
    return n === n && !e(n);
  }
  return N1 = t, N1;
}
var j1, n6;
function EZ() {
  if (n6) return j1;
  n6 = 1;
  var e = vA(), t = Hs();
  function n(r) {
    for (var a = t(r), o = a.length; o--; ) {
      var l = a[o], u = r[l];
      a[o] = [l, u, e(u)];
    }
    return a;
  }
  return j1 = n, j1;
}
var T1, r6;
function bA() {
  if (r6) return T1;
  r6 = 1;
  function e(t, n) {
    return function(r) {
      return r == null ? !1 : r[t] === n && (n !== void 0 || t in Object(r));
    };
  }
  return T1 = e, T1;
}
var A1, i6;
function kZ() {
  if (i6) return A1;
  i6 = 1;
  var e = CZ(), t = EZ(), n = bA();
  function r(a) {
    var o = t(a);
    return o.length == 1 && o[0][2] ? n(o[0][0], o[0][1]) : function(l) {
      return l === a || e(l, a, o);
    };
  }
  return A1 = r, A1;
}
var M1, a6;
function yu() {
  if (a6) return M1;
  a6 = 1;
  var e = Fo(), t = ia(), n = "[object Symbol]";
  function r(a) {
    return typeof a == "symbol" || t(a) && e(a) == n;
  }
  return M1 = r, M1;
}
var R1, s6;
function jw() {
  if (s6) return R1;
  s6 = 1;
  var e = Dn(), t = yu(), n = /\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/, r = /^\w*$/;
  function a(o, l) {
    if (e(o))
      return !1;
    var u = typeof o;
    return u == "number" || u == "symbol" || u == "boolean" || o == null || t(o) ? !0 : r.test(o) || !n.test(o) || l != null && o in Object(l);
  }
  return R1 = a, R1;
}
var z1, o6;
function NZ() {
  if (o6) return z1;
  o6 = 1;
  var e = gw(), t = "Expected a function";
  function n(r, a) {
    if (typeof r != "function" || a != null && typeof a != "function")
      throw new TypeError(t);
    var o = function() {
      var l = arguments, u = a ? a.apply(this, l) : l[0], f = o.cache;
      if (f.has(u))
        return f.get(u);
      var d = r.apply(this, l);
      return o.cache = f.set(u, d) || f, d;
    };
    return o.cache = new (n.Cache || e)(), o;
  }
  return n.Cache = e, z1 = n, z1;
}
var O1, l6;
function jZ() {
  if (l6) return O1;
  l6 = 1;
  var e = NZ(), t = 500;
  function n(r) {
    var a = e(r, function(l) {
      return o.size === t && o.clear(), l;
    }), o = a.cache;
    return a;
  }
  return O1 = n, O1;
}
var D1, u6;
function TZ() {
  if (u6) return D1;
  u6 = 1;
  var e = jZ(), t = /[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g, n = /\\(\\)?/g, r = e(function(a) {
    var o = [];
    return a.charCodeAt(0) === 46 && o.push(""), a.replace(t, function(l, u, f, d) {
      o.push(f ? d.replace(n, "$1") : u || l);
    }), o;
  });
  return D1 = r, D1;
}
var I1, c6;
function xm() {
  if (c6) return I1;
  c6 = 1;
  function e(t, n) {
    for (var r = -1, a = t == null ? 0 : t.length, o = Array(a); ++r < a; )
      o[r] = n(t[r], r, t);
    return o;
  }
  return I1 = e, I1;
}
var L1, d6;
function AZ() {
  if (d6) return L1;
  d6 = 1;
  var e = mu(), t = xm(), n = Dn(), r = yu(), a = e ? e.prototype : void 0, o = a ? a.toString : void 0;
  function l(u) {
    if (typeof u == "string")
      return u;
    if (n(u))
      return t(u, l) + "";
    if (r(u))
      return o ? o.call(u) : "";
    var f = u + "";
    return f == "0" && 1 / u == -1 / 0 ? "-0" : f;
  }
  return L1 = l, L1;
}
var q1, f6;
function wA() {
  if (f6) return q1;
  f6 = 1;
  var e = AZ();
  function t(n) {
    return n == null ? "" : e(n);
  }
  return q1 = t, q1;
}
var P1, h6;
function vm() {
  if (h6) return P1;
  h6 = 1;
  var e = Dn(), t = jw(), n = TZ(), r = wA();
  function a(o, l) {
    return e(o) ? o : t(o, l) ? [o] : n(r(o));
  }
  return P1 = a, P1;
}
var B1, m6;
function vd() {
  if (m6) return B1;
  m6 = 1;
  var e = yu();
  function t(n) {
    if (typeof n == "string" || e(n))
      return n;
    var r = n + "";
    return r == "0" && 1 / n == -1 / 0 ? "-0" : r;
  }
  return B1 = t, B1;
}
var F1, p6;
function bm() {
  if (p6) return F1;
  p6 = 1;
  var e = vm(), t = vd();
  function n(r, a) {
    a = e(a, r);
    for (var o = 0, l = a.length; r != null && o < l; )
      r = r[t(a[o++])];
    return o && o == l ? r : void 0;
  }
  return F1 = n, F1;
}
var $1, g6;
function MZ() {
  if (g6) return $1;
  g6 = 1;
  var e = bm();
  function t(n, r, a) {
    var o = n == null ? void 0 : e(n, r);
    return o === void 0 ? a : o;
  }
  return $1 = t, $1;
}
var U1, y6;
function RZ() {
  if (y6) return U1;
  y6 = 1;
  function e(t, n) {
    return t != null && n in Object(t);
  }
  return U1 = e, U1;
}
var H1, x6;
function _A() {
  if (x6) return H1;
  x6 = 1;
  var e = vm(), t = yd(), n = Dn(), r = hm(), a = xw(), o = vd();
  function l(u, f, d) {
    f = e(f, u);
    for (var m = -1, p = f.length, x = !1; ++m < p; ) {
      var y = o(f[m]);
      if (!(x = u != null && d(u, y)))
        break;
      u = u[y];
    }
    return x || ++m != p ? x : (p = u == null ? 0 : u.length, !!p && a(p) && r(y, p) && (n(u) || t(u)));
  }
  return H1 = l, H1;
}
var G1, v6;
function SA() {
  if (v6) return G1;
  v6 = 1;
  var e = RZ(), t = _A();
  function n(r, a) {
    return r != null && t(r, a, e);
  }
  return G1 = n, G1;
}
var V1, b6;
function zZ() {
  if (b6) return V1;
  b6 = 1;
  var e = xA(), t = MZ(), n = SA(), r = jw(), a = vA(), o = bA(), l = vd(), u = 1, f = 2;
  function d(m, p) {
    return r(m) && a(p) ? o(l(m), p) : function(x) {
      var y = t(x, m);
      return y === void 0 && y === p ? n(x, m) : e(p, y, u | f);
    };
  }
  return V1 = d, V1;
}
var K1, w6;
function CA() {
  if (w6) return K1;
  w6 = 1;
  function e(t) {
    return function(n) {
      return n == null ? void 0 : n[t];
    };
  }
  return K1 = e, K1;
}
var Y1, _6;
function OZ() {
  if (_6) return Y1;
  _6 = 1;
  var e = bm();
  function t(n) {
    return function(r) {
      return e(r, n);
    };
  }
  return Y1 = t, Y1;
}
var X1, S6;
function DZ() {
  if (S6) return X1;
  S6 = 1;
  var e = CA(), t = OZ(), n = jw(), r = vd();
  function a(o) {
    return n(o) ? e(r(o)) : t(o);
  }
  return X1 = a, X1;
}
var W1, C6;
function Qa() {
  if (C6) return W1;
  C6 = 1;
  var e = kZ(), t = zZ(), n = Ho(), r = Dn(), a = DZ();
  function o(l) {
    return typeof l == "function" ? l : l == null ? n : typeof l == "object" ? r(l) ? t(l[0], l[1]) : e(l) : a(l);
  }
  return W1 = o, W1;
}
var Q1, E6;
function EA() {
  if (E6) return Q1;
  E6 = 1;
  var e = tA(), t = gZ(), n = Qa(), r = Dn();
  function a(o, l) {
    var u = r(o) ? e : t;
    return u(o, n(l, 3));
  }
  return Q1 = a, Q1;
}
var Z1, k6;
function IZ() {
  if (k6) return Z1;
  k6 = 1;
  var e = Object.prototype, t = e.hasOwnProperty;
  function n(r, a) {
    return r != null && t.call(r, a);
  }
  return Z1 = n, Z1;
}
var J1, N6;
function kA() {
  if (N6) return J1;
  N6 = 1;
  var e = IZ(), t = _A();
  function n(r, a) {
    return r != null && t(r, a, e);
  }
  return J1 = n, J1;
}
var ex, j6;
function LZ() {
  if (j6) return ex;
  j6 = 1;
  var e = bw(), t = gu(), n = yd(), r = Dn(), a = Wa(), o = pu(), l = pm(), u = xd(), f = "[object Map]", d = "[object Set]", m = Object.prototype, p = m.hasOwnProperty;
  function x(y) {
    if (y == null)
      return !0;
    if (a(y) && (r(y) || typeof y == "string" || typeof y.splice == "function" || o(y) || u(y) || n(y)))
      return !y.length;
    var w = t(y);
    if (w == f || w == d)
      return !y.size;
    if (l(y))
      return !e(y).length;
    for (var E in y)
      if (p.call(y, E))
        return !1;
    return !0;
  }
  return ex = x, ex;
}
var tx, T6;
function NA() {
  if (T6) return tx;
  T6 = 1;
  function e(t) {
    return t === void 0;
  }
  return tx = e, tx;
}
var nx, A6;
function jA() {
  if (A6) return nx;
  A6 = 1;
  var e = ym(), t = Wa();
  function n(r, a) {
    var o = -1, l = t(r) ? Array(r.length) : [];
    return e(r, function(u, f, d) {
      l[++o] = a(u, f, d);
    }), l;
  }
  return nx = n, nx;
}
var rx, M6;
function TA() {
  if (M6) return rx;
  M6 = 1;
  var e = xm(), t = Qa(), n = jA(), r = Dn();
  function a(o, l) {
    var u = r(o) ? e : n;
    return u(o, t(l, 3));
  }
  return rx = a, rx;
}
var ix, R6;
function qZ() {
  if (R6) return ix;
  R6 = 1;
  function e(t, n, r, a) {
    var o = -1, l = t == null ? 0 : t.length;
    for (a && l && (r = t[++o]); ++o < l; )
      r = n(r, t[o], o, t);
    return r;
  }
  return ix = e, ix;
}
var ax, z6;
function PZ() {
  if (z6) return ax;
  z6 = 1;
  function e(t, n, r, a, o) {
    return o(t, function(l, u, f) {
      r = a ? (a = !1, l) : n(r, l, u, f);
    }), r;
  }
  return ax = e, ax;
}
var sx, O6;
function AA() {
  if (O6) return sx;
  O6 = 1;
  var e = qZ(), t = ym(), n = Qa(), r = PZ(), a = Dn();
  function o(l, u, f) {
    var d = a(l) ? e : r, m = arguments.length < 3;
    return d(l, n(u, 4), f, m, t);
  }
  return sx = o, sx;
}
var ox, D6;
function BZ() {
  if (D6) return ox;
  D6 = 1;
  var e = Fo(), t = Dn(), n = ia(), r = "[object String]";
  function a(o) {
    return typeof o == "string" || !t(o) && n(o) && e(o) == r;
  }
  return ox = a, ox;
}
var lx, I6;
function FZ() {
  if (I6) return lx;
  I6 = 1;
  var e = CA(), t = e("length");
  return lx = t, lx;
}
var ux, L6;
function $Z() {
  if (L6) return ux;
  L6 = 1;
  var e = "\\ud800-\\udfff", t = "\\u0300-\\u036f", n = "\\ufe20-\\ufe2f", r = "\\u20d0-\\u20ff", a = t + n + r, o = "\\ufe0e\\ufe0f", l = "\\u200d", u = RegExp("[" + l + e + a + o + "]");
  function f(d) {
    return u.test(d);
  }
  return ux = f, ux;
}
var cx, q6;
function UZ() {
  if (q6) return cx;
  q6 = 1;
  var e = "\\ud800-\\udfff", t = "\\u0300-\\u036f", n = "\\ufe20-\\ufe2f", r = "\\u20d0-\\u20ff", a = t + n + r, o = "\\ufe0e\\ufe0f", l = "[" + e + "]", u = "[" + a + "]", f = "\\ud83c[\\udffb-\\udfff]", d = "(?:" + u + "|" + f + ")", m = "[^" + e + "]", p = "(?:\\ud83c[\\udde6-\\uddff]){2}", x = "[\\ud800-\\udbff][\\udc00-\\udfff]", y = "\\u200d", w = d + "?", E = "[" + o + "]?", k = "(?:" + y + "(?:" + [m, p, x].join("|") + ")" + E + w + ")*", C = E + w + k, T = "(?:" + [m + u + "?", u, p, x, l].join("|") + ")", N = RegExp(f + "(?=" + f + ")|" + T + C, "g");
  function A(D) {
    for (var M = N.lastIndex = 0; N.test(D); )
      ++M;
    return M;
  }
  return cx = A, cx;
}
var dx, P6;
function HZ() {
  if (P6) return dx;
  P6 = 1;
  var e = FZ(), t = $Z(), n = UZ();
  function r(a) {
    return t(a) ? n(a) : e(a);
  }
  return dx = r, dx;
}
var fx, B6;
function GZ() {
  if (B6) return fx;
  B6 = 1;
  var e = bw(), t = gu(), n = Wa(), r = BZ(), a = HZ(), o = "[object Map]", l = "[object Set]";
  function u(f) {
    if (f == null)
      return 0;
    if (n(f))
      return r(f) ? a(f) : f.length;
    var d = t(f);
    return d == o || d == l ? f.size : e(f).length;
  }
  return fx = u, fx;
}
var hx, F6;
function VZ() {
  if (F6) return hx;
  F6 = 1;
  var e = yw(), t = uA(), n = kw(), r = Qa(), a = gm(), o = Dn(), l = pu(), u = pd(), f = mi(), d = xd();
  function m(p, x, y) {
    var w = o(p), E = w || l(p) || d(p);
    if (x = r(x, 4), y == null) {
      var k = p && p.constructor;
      E ? y = w ? new k() : [] : f(p) ? y = u(k) ? t(a(p)) : {} : y = {};
    }
    return (E ? e : n)(p, function(C, T, N) {
      return x(y, C, T, N);
    }), y;
  }
  return hx = m, hx;
}
var mx, $6;
function KZ() {
  if ($6) return mx;
  $6 = 1;
  var e = mu(), t = yd(), n = Dn(), r = e ? e.isConcatSpreadable : void 0;
  function a(o) {
    return n(o) || t(o) || !!(r && o && o[r]);
  }
  return mx = a, mx;
}
var px, U6;
function Tw() {
  if (U6) return px;
  U6 = 1;
  var e = _w(), t = KZ();
  function n(r, a, o, l, u) {
    var f = -1, d = r.length;
    for (o || (o = t), u || (u = []); ++f < d; ) {
      var m = r[f];
      a > 0 && o(m) ? a > 1 ? n(m, a - 1, o, l, u) : e(u, m) : l || (u[u.length] = m);
    }
    return u;
  }
  return px = n, px;
}
var gx, H6;
function YZ() {
  if (H6) return gx;
  H6 = 1;
  function e(t, n, r) {
    switch (r.length) {
      case 0:
        return t.call(n);
      case 1:
        return t.call(n, r[0]);
      case 2:
        return t.call(n, r[0], r[1]);
      case 3:
        return t.call(n, r[0], r[1], r[2]);
    }
    return t.apply(n, r);
  }
  return gx = e, gx;
}
var yx, G6;
function MA() {
  if (G6) return yx;
  G6 = 1;
  var e = YZ(), t = Math.max;
  function n(r, a, o) {
    return a = t(a === void 0 ? r.length - 1 : a, 0), function() {
      for (var l = arguments, u = -1, f = t(l.length - a, 0), d = Array(f); ++u < f; )
        d[u] = l[a + u];
      u = -1;
      for (var m = Array(a + 1); ++u < a; )
        m[u] = l[u];
      return m[a] = o(d), e(r, this, m);
    };
  }
  return yx = n, yx;
}
var xx, V6;
function XZ() {
  if (V6) return xx;
  V6 = 1;
  var e = Cw(), t = WT(), n = Ho(), r = t ? function(a, o) {
    return t(a, "toString", {
      configurable: !0,
      enumerable: !1,
      value: e(o),
      writable: !0
    });
  } : n;
  return xx = r, xx;
}
var vx, K6;
function WZ() {
  if (K6) return vx;
  K6 = 1;
  var e = 800, t = 16, n = Date.now;
  function r(a) {
    var o = 0, l = 0;
    return function() {
      var u = n(), f = t - (u - l);
      if (l = u, f > 0) {
        if (++o >= e)
          return arguments[0];
      } else
        o = 0;
      return a.apply(void 0, arguments);
    };
  }
  return vx = r, vx;
}
var bx, Y6;
function RA() {
  if (Y6) return bx;
  Y6 = 1;
  var e = XZ(), t = WZ(), n = t(e);
  return bx = n, bx;
}
var wx, X6;
function wm() {
  if (X6) return wx;
  X6 = 1;
  var e = Ho(), t = MA(), n = RA();
  function r(a, o) {
    return n(t(a, o, e), a + "");
  }
  return wx = r, wx;
}
var _x, W6;
function zA() {
  if (W6) return _x;
  W6 = 1;
  function e(t, n, r, a) {
    for (var o = t.length, l = r + (a ? 1 : -1); a ? l-- : ++l < o; )
      if (n(t[l], l, t))
        return l;
    return -1;
  }
  return _x = e, _x;
}
var Sx, Q6;
function QZ() {
  if (Q6) return Sx;
  Q6 = 1;
  function e(t) {
    return t !== t;
  }
  return Sx = e, Sx;
}
var Cx, Z6;
function ZZ() {
  if (Z6) return Cx;
  Z6 = 1;
  function e(t, n, r) {
    for (var a = r - 1, o = t.length; ++a < o; )
      if (t[a] === n)
        return a;
    return -1;
  }
  return Cx = e, Cx;
}
var Ex, J6;
function JZ() {
  if (J6) return Ex;
  J6 = 1;
  var e = zA(), t = QZ(), n = ZZ();
  function r(a, o, l) {
    return o === o ? n(a, o, l) : e(a, t, l);
  }
  return Ex = r, Ex;
}
var kx, e8;
function eJ() {
  if (e8) return kx;
  e8 = 1;
  var e = JZ();
  function t(n, r) {
    var a = n == null ? 0 : n.length;
    return !!a && e(n, r, 0) > -1;
  }
  return kx = t, kx;
}
var Nx, t8;
function tJ() {
  if (t8) return Nx;
  t8 = 1;
  function e(t, n, r) {
    for (var a = -1, o = t == null ? 0 : t.length; ++a < o; )
      if (r(n, t[a]))
        return !0;
    return !1;
  }
  return Nx = e, Nx;
}
var jx, n8;
function nJ() {
  if (n8) return jx;
  n8 = 1;
  function e() {
  }
  return jx = e, jx;
}
var Tx, r8;
function rJ() {
  if (r8) return Tx;
  r8 = 1;
  var e = sA(), t = nJ(), n = Nw(), r = 1 / 0, a = e && 1 / n(new e([, -0]))[1] == r ? function(o) {
    return new e(o);
  } : t;
  return Tx = a, Tx;
}
var Ax, i8;
function iJ() {
  if (i8) return Ax;
  i8 = 1;
  var e = pA(), t = eJ(), n = tJ(), r = gA(), a = rJ(), o = Nw(), l = 200;
  function u(f, d, m) {
    var p = -1, x = t, y = f.length, w = !0, E = [], k = E;
    if (m)
      w = !1, x = n;
    else if (y >= l) {
      var C = d ? null : a(f);
      if (C)
        return o(C);
      w = !1, x = r, k = new e();
    } else
      k = d ? [] : E;
    e:
      for (; ++p < y; ) {
        var T = f[p], N = d ? d(T) : T;
        if (T = m || T !== 0 ? T : 0, w && N === N) {
          for (var A = k.length; A--; )
            if (k[A] === N)
              continue e;
          d && k.push(N), E.push(T);
        } else x(k, N, m) || (k !== E && k.push(N), E.push(T));
      }
    return E;
  }
  return Ax = u, Ax;
}
var Mx, a8;
function OA() {
  if (a8) return Mx;
  a8 = 1;
  var e = Wa(), t = ia();
  function n(r) {
    return t(r) && e(r);
  }
  return Mx = n, Mx;
}
var Rx, s8;
function aJ() {
  if (s8) return Rx;
  s8 = 1;
  var e = Tw(), t = wm(), n = iJ(), r = OA(), a = t(function(o) {
    return n(e(o, 1, r, !0));
  });
  return Rx = a, Rx;
}
var zx, o8;
function sJ() {
  if (o8) return zx;
  o8 = 1;
  var e = xm();
  function t(n, r) {
    return e(r, function(a) {
      return n[a];
    });
  }
  return zx = t, zx;
}
var Ox, l8;
function DA() {
  if (l8) return Ox;
  l8 = 1;
  var e = sJ(), t = Hs();
  function n(r) {
    return r == null ? [] : e(r, t(r));
  }
  return Ox = n, Ox;
}
var Dx, u8;
function pi() {
  if (u8) return Dx;
  u8 = 1;
  var e;
  if (typeof mw == "function")
    try {
      e = {
        clone: hZ(),
        constant: Cw(),
        each: mA(),
        filter: EA(),
        has: kA(),
        isArray: Dn(),
        isEmpty: LZ(),
        isFunction: pd(),
        isUndefined: NA(),
        keys: Hs(),
        map: TA(),
        reduce: AA(),
        size: GZ(),
        transform: VZ(),
        union: aJ(),
        values: DA()
      };
    } catch {
    }
  return e || (e = window._), Dx = e, Dx;
}
var Ix, c8;
function Aw() {
  if (c8) return Ix;
  c8 = 1;
  var e = pi();
  Ix = a;
  var t = "\0", n = "\0", r = "";
  function a(m) {
    this._isDirected = e.has(m, "directed") ? m.directed : !0, this._isMultigraph = e.has(m, "multigraph") ? m.multigraph : !1, this._isCompound = e.has(m, "compound") ? m.compound : !1, this._label = void 0, this._defaultNodeLabelFn = e.constant(void 0), this._defaultEdgeLabelFn = e.constant(void 0), this._nodes = {}, this._isCompound && (this._parent = {}, this._children = {}, this._children[n] = {}), this._in = {}, this._preds = {}, this._out = {}, this._sucs = {}, this._edgeObjs = {}, this._edgeLabels = {};
  }
  a.prototype._nodeCount = 0, a.prototype._edgeCount = 0, a.prototype.isDirected = function() {
    return this._isDirected;
  }, a.prototype.isMultigraph = function() {
    return this._isMultigraph;
  }, a.prototype.isCompound = function() {
    return this._isCompound;
  }, a.prototype.setGraph = function(m) {
    return this._label = m, this;
  }, a.prototype.graph = function() {
    return this._label;
  }, a.prototype.setDefaultNodeLabel = function(m) {
    return e.isFunction(m) || (m = e.constant(m)), this._defaultNodeLabelFn = m, this;
  }, a.prototype.nodeCount = function() {
    return this._nodeCount;
  }, a.prototype.nodes = function() {
    return e.keys(this._nodes);
  }, a.prototype.sources = function() {
    var m = this;
    return e.filter(this.nodes(), function(p) {
      return e.isEmpty(m._in[p]);
    });
  }, a.prototype.sinks = function() {
    var m = this;
    return e.filter(this.nodes(), function(p) {
      return e.isEmpty(m._out[p]);
    });
  }, a.prototype.setNodes = function(m, p) {
    var x = arguments, y = this;
    return e.each(m, function(w) {
      x.length > 1 ? y.setNode(w, p) : y.setNode(w);
    }), this;
  }, a.prototype.setNode = function(m, p) {
    return e.has(this._nodes, m) ? (arguments.length > 1 && (this._nodes[m] = p), this) : (this._nodes[m] = arguments.length > 1 ? p : this._defaultNodeLabelFn(m), this._isCompound && (this._parent[m] = n, this._children[m] = {}, this._children[n][m] = !0), this._in[m] = {}, this._preds[m] = {}, this._out[m] = {}, this._sucs[m] = {}, ++this._nodeCount, this);
  }, a.prototype.node = function(m) {
    return this._nodes[m];
  }, a.prototype.hasNode = function(m) {
    return e.has(this._nodes, m);
  }, a.prototype.removeNode = function(m) {
    var p = this;
    if (e.has(this._nodes, m)) {
      var x = function(y) {
        p.removeEdge(p._edgeObjs[y]);
      };
      delete this._nodes[m], this._isCompound && (this._removeFromParentsChildList(m), delete this._parent[m], e.each(this.children(m), function(y) {
        p.setParent(y);
      }), delete this._children[m]), e.each(e.keys(this._in[m]), x), delete this._in[m], delete this._preds[m], e.each(e.keys(this._out[m]), x), delete this._out[m], delete this._sucs[m], --this._nodeCount;
    }
    return this;
  }, a.prototype.setParent = function(m, p) {
    if (!this._isCompound)
      throw new Error("Cannot set parent in a non-compound graph");
    if (e.isUndefined(p))
      p = n;
    else {
      p += "";
      for (var x = p; !e.isUndefined(x); x = this.parent(x))
        if (x === m)
          throw new Error("Setting " + p + " as parent of " + m + " would create a cycle");
      this.setNode(p);
    }
    return this.setNode(m), this._removeFromParentsChildList(m), this._parent[m] = p, this._children[p][m] = !0, this;
  }, a.prototype._removeFromParentsChildList = function(m) {
    delete this._children[this._parent[m]][m];
  }, a.prototype.parent = function(m) {
    if (this._isCompound) {
      var p = this._parent[m];
      if (p !== n)
        return p;
    }
  }, a.prototype.children = function(m) {
    if (e.isUndefined(m) && (m = n), this._isCompound) {
      var p = this._children[m];
      if (p)
        return e.keys(p);
    } else {
      if (m === n)
        return this.nodes();
      if (this.hasNode(m))
        return [];
    }
  }, a.prototype.predecessors = function(m) {
    var p = this._preds[m];
    if (p)
      return e.keys(p);
  }, a.prototype.successors = function(m) {
    var p = this._sucs[m];
    if (p)
      return e.keys(p);
  }, a.prototype.neighbors = function(m) {
    var p = this.predecessors(m);
    if (p)
      return e.union(p, this.successors(m));
  }, a.prototype.isLeaf = function(m) {
    var p;
    return this.isDirected() ? p = this.successors(m) : p = this.neighbors(m), p.length === 0;
  }, a.prototype.filterNodes = function(m) {
    var p = new this.constructor({
      directed: this._isDirected,
      multigraph: this._isMultigraph,
      compound: this._isCompound
    });
    p.setGraph(this.graph());
    var x = this;
    e.each(this._nodes, function(E, k) {
      m(k) && p.setNode(k, E);
    }), e.each(this._edgeObjs, function(E) {
      p.hasNode(E.v) && p.hasNode(E.w) && p.setEdge(E, x.edge(E));
    });
    var y = {};
    function w(E) {
      var k = x.parent(E);
      return k === void 0 || p.hasNode(k) ? (y[E] = k, k) : k in y ? y[k] : w(k);
    }
    return this._isCompound && e.each(p.nodes(), function(E) {
      p.setParent(E, w(E));
    }), p;
  }, a.prototype.setDefaultEdgeLabel = function(m) {
    return e.isFunction(m) || (m = e.constant(m)), this._defaultEdgeLabelFn = m, this;
  }, a.prototype.edgeCount = function() {
    return this._edgeCount;
  }, a.prototype.edges = function() {
    return e.values(this._edgeObjs);
  }, a.prototype.setPath = function(m, p) {
    var x = this, y = arguments;
    return e.reduce(m, function(w, E) {
      return y.length > 1 ? x.setEdge(w, E, p) : x.setEdge(w, E), E;
    }), this;
  }, a.prototype.setEdge = function() {
    var m, p, x, y, w = !1, E = arguments[0];
    typeof E == "object" && E !== null && "v" in E ? (m = E.v, p = E.w, x = E.name, arguments.length === 2 && (y = arguments[1], w = !0)) : (m = E, p = arguments[1], x = arguments[3], arguments.length > 2 && (y = arguments[2], w = !0)), m = "" + m, p = "" + p, e.isUndefined(x) || (x = "" + x);
    var k = u(this._isDirected, m, p, x);
    if (e.has(this._edgeLabels, k))
      return w && (this._edgeLabels[k] = y), this;
    if (!e.isUndefined(x) && !this._isMultigraph)
      throw new Error("Cannot set a named edge when isMultigraph = false");
    this.setNode(m), this.setNode(p), this._edgeLabels[k] = w ? y : this._defaultEdgeLabelFn(m, p, x);
    var C = f(this._isDirected, m, p, x);
    return m = C.v, p = C.w, Object.freeze(C), this._edgeObjs[k] = C, o(this._preds[p], m), o(this._sucs[m], p), this._in[p][k] = C, this._out[m][k] = C, this._edgeCount++, this;
  }, a.prototype.edge = function(m, p, x) {
    var y = arguments.length === 1 ? d(this._isDirected, arguments[0]) : u(this._isDirected, m, p, x);
    return this._edgeLabels[y];
  }, a.prototype.hasEdge = function(m, p, x) {
    var y = arguments.length === 1 ? d(this._isDirected, arguments[0]) : u(this._isDirected, m, p, x);
    return e.has(this._edgeLabels, y);
  }, a.prototype.removeEdge = function(m, p, x) {
    var y = arguments.length === 1 ? d(this._isDirected, arguments[0]) : u(this._isDirected, m, p, x), w = this._edgeObjs[y];
    return w && (m = w.v, p = w.w, delete this._edgeLabels[y], delete this._edgeObjs[y], l(this._preds[p], m), l(this._sucs[m], p), delete this._in[p][y], delete this._out[m][y], this._edgeCount--), this;
  }, a.prototype.inEdges = function(m, p) {
    var x = this._in[m];
    if (x) {
      var y = e.values(x);
      return p ? e.filter(y, function(w) {
        return w.v === p;
      }) : y;
    }
  }, a.prototype.outEdges = function(m, p) {
    var x = this._out[m];
    if (x) {
      var y = e.values(x);
      return p ? e.filter(y, function(w) {
        return w.w === p;
      }) : y;
    }
  }, a.prototype.nodeEdges = function(m, p) {
    var x = this.inEdges(m, p);
    if (x)
      return x.concat(this.outEdges(m, p));
  };
  function o(m, p) {
    m[p] ? m[p]++ : m[p] = 1;
  }
  function l(m, p) {
    --m[p] || delete m[p];
  }
  function u(m, p, x, y) {
    var w = "" + p, E = "" + x;
    if (!m && w > E) {
      var k = w;
      w = E, E = k;
    }
    return w + r + E + r + (e.isUndefined(y) ? t : y);
  }
  function f(m, p, x, y) {
    var w = "" + p, E = "" + x;
    if (!m && w > E) {
      var k = w;
      w = E, E = k;
    }
    var C = { v: w, w: E };
    return y && (C.name = y), C;
  }
  function d(m, p) {
    return u(m, p.v, p.w, p.name);
  }
  return Ix;
}
var Lx, d8;
function oJ() {
  return d8 || (d8 = 1, Lx = "2.1.8"), Lx;
}
var qx, f8;
function lJ() {
  return f8 || (f8 = 1, qx = {
    Graph: Aw(),
    version: oJ()
  }), qx;
}
var Px, h8;
function uJ() {
  if (h8) return Px;
  h8 = 1;
  var e = pi(), t = Aw();
  Px = {
    write: n,
    read: o
  };
  function n(l) {
    var u = {
      options: {
        directed: l.isDirected(),
        multigraph: l.isMultigraph(),
        compound: l.isCompound()
      },
      nodes: r(l),
      edges: a(l)
    };
    return e.isUndefined(l.graph()) || (u.value = e.clone(l.graph())), u;
  }
  function r(l) {
    return e.map(l.nodes(), function(u) {
      var f = l.node(u), d = l.parent(u), m = { v: u };
      return e.isUndefined(f) || (m.value = f), e.isUndefined(d) || (m.parent = d), m;
    });
  }
  function a(l) {
    return e.map(l.edges(), function(u) {
      var f = l.edge(u), d = { v: u.v, w: u.w };
      return e.isUndefined(u.name) || (d.name = u.name), e.isUndefined(f) || (d.value = f), d;
    });
  }
  function o(l) {
    var u = new t(l.options).setGraph(l.value);
    return e.each(l.nodes, function(f) {
      u.setNode(f.v, f.value), f.parent && u.setParent(f.v, f.parent);
    }), e.each(l.edges, function(f) {
      u.setEdge({ v: f.v, w: f.w, name: f.name }, f.value);
    }), u;
  }
  return Px;
}
var Bx, m8;
function cJ() {
  if (m8) return Bx;
  m8 = 1;
  var e = pi();
  Bx = t;
  function t(n) {
    var r = {}, a = [], o;
    function l(u) {
      e.has(r, u) || (r[u] = !0, o.push(u), e.each(n.successors(u), l), e.each(n.predecessors(u), l));
    }
    return e.each(n.nodes(), function(u) {
      o = [], l(u), o.length && a.push(o);
    }), a;
  }
  return Bx;
}
var Fx, p8;
function IA() {
  if (p8) return Fx;
  p8 = 1;
  var e = pi();
  Fx = t;
  function t() {
    this._arr = [], this._keyIndices = {};
  }
  return t.prototype.size = function() {
    return this._arr.length;
  }, t.prototype.keys = function() {
    return this._arr.map(function(n) {
      return n.key;
    });
  }, t.prototype.has = function(n) {
    return e.has(this._keyIndices, n);
  }, t.prototype.priority = function(n) {
    var r = this._keyIndices[n];
    if (r !== void 0)
      return this._arr[r].priority;
  }, t.prototype.min = function() {
    if (this.size() === 0)
      throw new Error("Queue underflow");
    return this._arr[0].key;
  }, t.prototype.add = function(n, r) {
    var a = this._keyIndices;
    if (n = String(n), !e.has(a, n)) {
      var o = this._arr, l = o.length;
      return a[n] = l, o.push({ key: n, priority: r }), this._decrease(l), !0;
    }
    return !1;
  }, t.prototype.removeMin = function() {
    this._swap(0, this._arr.length - 1);
    var n = this._arr.pop();
    return delete this._keyIndices[n.key], this._heapify(0), n.key;
  }, t.prototype.decrease = function(n, r) {
    var a = this._keyIndices[n];
    if (r > this._arr[a].priority)
      throw new Error("New priority is greater than current priority. Key: " + n + " Old: " + this._arr[a].priority + " New: " + r);
    this._arr[a].priority = r, this._decrease(a);
  }, t.prototype._heapify = function(n) {
    var r = this._arr, a = 2 * n, o = a + 1, l = n;
    a < r.length && (l = r[a].priority < r[l].priority ? a : l, o < r.length && (l = r[o].priority < r[l].priority ? o : l), l !== n && (this._swap(n, l), this._heapify(l)));
  }, t.prototype._decrease = function(n) {
    for (var r = this._arr, a = r[n].priority, o; n !== 0 && (o = n >> 1, !(r[o].priority < a)); )
      this._swap(n, o), n = o;
  }, t.prototype._swap = function(n, r) {
    var a = this._arr, o = this._keyIndices, l = a[n], u = a[r];
    a[n] = u, a[r] = l, o[u.key] = n, o[l.key] = r;
  }, Fx;
}
var $x, g8;
function LA() {
  if (g8) return $x;
  g8 = 1;
  var e = pi(), t = IA();
  $x = r;
  var n = e.constant(1);
  function r(o, l, u, f) {
    return a(
      o,
      String(l),
      u || n,
      f || function(d) {
        return o.outEdges(d);
      }
    );
  }
  function a(o, l, u, f) {
    var d = {}, m = new t(), p, x, y = function(w) {
      var E = w.v !== p ? w.v : w.w, k = d[E], C = u(w), T = x.distance + C;
      if (C < 0)
        throw new Error("dijkstra does not allow negative edge weights. Bad edge: " + w + " Weight: " + C);
      T < k.distance && (k.distance = T, k.predecessor = p, m.decrease(E, T));
    };
    for (o.nodes().forEach(function(w) {
      var E = w === l ? 0 : Number.POSITIVE_INFINITY;
      d[w] = { distance: E }, m.add(w, E);
    }); m.size() > 0 && (p = m.removeMin(), x = d[p], x.distance !== Number.POSITIVE_INFINITY); )
      f(p).forEach(y);
    return d;
  }
  return $x;
}
var Ux, y8;
function dJ() {
  if (y8) return Ux;
  y8 = 1;
  var e = LA(), t = pi();
  Ux = n;
  function n(r, a, o) {
    return t.transform(r.nodes(), function(l, u) {
      l[u] = e(r, u, a, o);
    }, {});
  }
  return Ux;
}
var Hx, x8;
function qA() {
  if (x8) return Hx;
  x8 = 1;
  var e = pi();
  Hx = t;
  function t(n) {
    var r = 0, a = [], o = {}, l = [];
    function u(f) {
      var d = o[f] = {
        onStack: !0,
        lowlink: r,
        index: r++
      };
      if (a.push(f), n.successors(f).forEach(function(x) {
        e.has(o, x) ? o[x].onStack && (d.lowlink = Math.min(d.lowlink, o[x].index)) : (u(x), d.lowlink = Math.min(d.lowlink, o[x].lowlink));
      }), d.lowlink === d.index) {
        var m = [], p;
        do
          p = a.pop(), o[p].onStack = !1, m.push(p);
        while (f !== p);
        l.push(m);
      }
    }
    return n.nodes().forEach(function(f) {
      e.has(o, f) || u(f);
    }), l;
  }
  return Hx;
}
var Gx, v8;
function fJ() {
  if (v8) return Gx;
  v8 = 1;
  var e = pi(), t = qA();
  Gx = n;
  function n(r) {
    return e.filter(t(r), function(a) {
      return a.length > 1 || a.length === 1 && r.hasEdge(a[0], a[0]);
    });
  }
  return Gx;
}
var Vx, b8;
function hJ() {
  if (b8) return Vx;
  b8 = 1;
  var e = pi();
  Vx = n;
  var t = e.constant(1);
  function n(a, o, l) {
    return r(
      a,
      o || t,
      l || function(u) {
        return a.outEdges(u);
      }
    );
  }
  function r(a, o, l) {
    var u = {}, f = a.nodes();
    return f.forEach(function(d) {
      u[d] = {}, u[d][d] = { distance: 0 }, f.forEach(function(m) {
        d !== m && (u[d][m] = { distance: Number.POSITIVE_INFINITY });
      }), l(d).forEach(function(m) {
        var p = m.v === d ? m.w : m.v, x = o(m);
        u[d][p] = { distance: x, predecessor: d };
      });
    }), f.forEach(function(d) {
      var m = u[d];
      f.forEach(function(p) {
        var x = u[p];
        f.forEach(function(y) {
          var w = x[d], E = m[y], k = x[y], C = w.distance + E.distance;
          C < k.distance && (k.distance = C, k.predecessor = E.predecessor);
        });
      });
    }), u;
  }
  return Vx;
}
var Kx, w8;
function PA() {
  if (w8) return Kx;
  w8 = 1;
  var e = pi();
  Kx = t, t.CycleException = n;
  function t(r) {
    var a = {}, o = {}, l = [];
    function u(f) {
      if (e.has(o, f))
        throw new n();
      e.has(a, f) || (o[f] = !0, a[f] = !0, e.each(r.predecessors(f), u), delete o[f], l.push(f));
    }
    if (e.each(r.sinks(), u), e.size(a) !== r.nodeCount())
      throw new n();
    return l;
  }
  function n() {
  }
  return n.prototype = new Error(), Kx;
}
var Yx, _8;
function mJ() {
  if (_8) return Yx;
  _8 = 1;
  var e = PA();
  Yx = t;
  function t(n) {
    try {
      e(n);
    } catch (r) {
      if (r instanceof e.CycleException)
        return !1;
      throw r;
    }
    return !0;
  }
  return Yx;
}
var Xx, S8;
function BA() {
  if (S8) return Xx;
  S8 = 1;
  var e = pi();
  Xx = t;
  function t(r, a, o) {
    e.isArray(a) || (a = [a]);
    var l = (r.isDirected() ? r.successors : r.neighbors).bind(r), u = [], f = {};
    return e.each(a, function(d) {
      if (!r.hasNode(d))
        throw new Error("Graph does not have node: " + d);
      n(r, d, o === "post", f, l, u);
    }), u;
  }
  function n(r, a, o, l, u, f) {
    e.has(l, a) || (l[a] = !0, o || f.push(a), e.each(u(a), function(d) {
      n(r, d, o, l, u, f);
    }), o && f.push(a));
  }
  return Xx;
}
var Wx, C8;
function pJ() {
  if (C8) return Wx;
  C8 = 1;
  var e = BA();
  Wx = t;
  function t(n, r) {
    return e(n, r, "post");
  }
  return Wx;
}
var Qx, E8;
function gJ() {
  if (E8) return Qx;
  E8 = 1;
  var e = BA();
  Qx = t;
  function t(n, r) {
    return e(n, r, "pre");
  }
  return Qx;
}
var Zx, k8;
function yJ() {
  if (k8) return Zx;
  k8 = 1;
  var e = pi(), t = Aw(), n = IA();
  Zx = r;
  function r(a, o) {
    var l = new t(), u = {}, f = new n(), d;
    function m(x) {
      var y = x.v === d ? x.w : x.v, w = f.priority(y);
      if (w !== void 0) {
        var E = o(x);
        E < w && (u[y] = d, f.decrease(y, E));
      }
    }
    if (a.nodeCount() === 0)
      return l;
    e.each(a.nodes(), function(x) {
      f.add(x, Number.POSITIVE_INFINITY), l.setNode(x);
    }), f.decrease(a.nodes()[0], 0);
    for (var p = !1; f.size() > 0; ) {
      if (d = f.removeMin(), e.has(u, d))
        l.setEdge(d, u[d]);
      else {
        if (p)
          throw new Error("Input graph is not connected: " + a);
        p = !0;
      }
      a.nodeEdges(d).forEach(m);
    }
    return l;
  }
  return Zx;
}
var Jx, N8;
function xJ() {
  return N8 || (N8 = 1, Jx = {
    components: cJ(),
    dijkstra: LA(),
    dijkstraAll: dJ(),
    findCycles: fJ(),
    floydWarshall: hJ(),
    isAcyclic: mJ(),
    postorder: pJ(),
    preorder: gJ(),
    prim: yJ(),
    tarjan: qA(),
    topsort: PA()
  }), Jx;
}
var ev, j8;
function vJ() {
  if (j8) return ev;
  j8 = 1;
  var e = lJ();
  return ev = {
    Graph: e.Graph,
    json: uJ(),
    alg: xJ(),
    version: e.version
  }, ev;
}
var tv, T8;
function zi() {
  if (T8) return tv;
  T8 = 1;
  var e;
  if (typeof mw == "function")
    try {
      e = vJ();
    } catch {
    }
  return e || (e = window.graphlib), tv = e, tv;
}
var nv, A8;
function bJ() {
  if (A8) return nv;
  A8 = 1;
  var e = dA(), t = 1, n = 4;
  function r(a) {
    return e(a, t | n);
  }
  return nv = r, nv;
}
var rv, M8;
function _m() {
  if (M8) return rv;
  M8 = 1;
  var e = hu(), t = Wa(), n = hm(), r = mi();
  function a(o, l, u) {
    if (!r(u))
      return !1;
    var f = typeof l;
    return (f == "number" ? t(u) && n(l, u.length) : f == "string" && l in u) ? e(u[l], o) : !1;
  }
  return rv = a, rv;
}
var iv, R8;
function wJ() {
  if (R8) return iv;
  R8 = 1;
  var e = wm(), t = hu(), n = _m(), r = Uo(), a = Object.prototype, o = a.hasOwnProperty, l = e(function(u, f) {
    u = Object(u);
    var d = -1, m = f.length, p = m > 2 ? f[2] : void 0;
    for (p && n(f[0], f[1], p) && (m = 1); ++d < m; )
      for (var x = f[d], y = r(x), w = -1, E = y.length; ++w < E; ) {
        var k = y[w], C = u[k];
        (C === void 0 || t(C, a[k]) && !o.call(u, k)) && (u[k] = x[k]);
      }
    return u;
  });
  return iv = l, iv;
}
var av, z8;
function _J() {
  if (z8) return av;
  z8 = 1;
  var e = Qa(), t = Wa(), n = Hs();
  function r(a) {
    return function(o, l, u) {
      var f = Object(o);
      if (!t(o)) {
        var d = e(l, 3);
        o = n(o), l = function(p) {
          return d(f[p], p, f);
        };
      }
      var m = a(o, l, u);
      return m > -1 ? f[d ? o[m] : m] : void 0;
    };
  }
  return av = r, av;
}
var sv, O8;
function SJ() {
  if (O8) return sv;
  O8 = 1;
  var e = /\s/;
  function t(n) {
    for (var r = n.length; r-- && e.test(n.charAt(r)); )
      ;
    return r;
  }
  return sv = t, sv;
}
var ov, D8;
function CJ() {
  if (D8) return ov;
  D8 = 1;
  var e = SJ(), t = /^\s+/;
  function n(r) {
    return r && r.slice(0, e(r) + 1).replace(t, "");
  }
  return ov = n, ov;
}
var lv, I8;
function EJ() {
  if (I8) return lv;
  I8 = 1;
  var e = CJ(), t = mi(), n = yu(), r = NaN, a = /^[-+]0x[0-9a-f]+$/i, o = /^0b[01]+$/i, l = /^0o[0-7]+$/i, u = parseInt;
  function f(d) {
    if (typeof d == "number")
      return d;
    if (n(d))
      return r;
    if (t(d)) {
      var m = typeof d.valueOf == "function" ? d.valueOf() : d;
      d = t(m) ? m + "" : m;
    }
    if (typeof d != "string")
      return d === 0 ? d : +d;
    d = e(d);
    var p = o.test(d);
    return p || l.test(d) ? u(d.slice(2), p ? 2 : 8) : a.test(d) ? r : +d;
  }
  return lv = f, lv;
}
var uv, L8;
function FA() {
  if (L8) return uv;
  L8 = 1;
  var e = EJ(), t = 1 / 0, n = 17976931348623157e292;
  function r(a) {
    if (!a)
      return a === 0 ? a : 0;
    if (a = e(a), a === t || a === -t) {
      var o = a < 0 ? -1 : 1;
      return o * n;
    }
    return a === a ? a : 0;
  }
  return uv = r, uv;
}
var cv, q8;
function kJ() {
  if (q8) return cv;
  q8 = 1;
  var e = FA();
  function t(n) {
    var r = e(n), a = r % 1;
    return r === r ? a ? r - a : r : 0;
  }
  return cv = t, cv;
}
var dv, P8;
function NJ() {
  if (P8) return dv;
  P8 = 1;
  var e = zA(), t = Qa(), n = kJ(), r = Math.max;
  function a(o, l, u) {
    var f = o == null ? 0 : o.length;
    if (!f)
      return -1;
    var d = u == null ? 0 : n(u);
    return d < 0 && (d = r(f + d, 0)), e(o, t(l, 3), d);
  }
  return dv = a, dv;
}
var fv, B8;
function jJ() {
  if (B8) return fv;
  B8 = 1;
  var e = _J(), t = NJ(), n = e(t);
  return fv = n, fv;
}
var hv, F8;
function $A() {
  if (F8) return hv;
  F8 = 1;
  var e = Tw();
  function t(n) {
    var r = n == null ? 0 : n.length;
    return r ? e(n, 1) : [];
  }
  return hv = t, hv;
}
var mv, $8;
function TJ() {
  if ($8) return mv;
  $8 = 1;
  var e = Ew(), t = fA(), n = Uo();
  function r(a, o) {
    return a == null ? a : e(a, t(o), n);
  }
  return mv = r, mv;
}
var pv, U8;
function AJ() {
  if (U8) return pv;
  U8 = 1;
  function e(t) {
    var n = t == null ? 0 : t.length;
    return n ? t[n - 1] : void 0;
  }
  return pv = e, pv;
}
var gv, H8;
function MJ() {
  if (H8) return gv;
  H8 = 1;
  var e = dm(), t = kw(), n = Qa();
  function r(a, o) {
    var l = {};
    return o = n(o, 3), t(a, function(u, f, d) {
      e(l, f, o(u, f, d));
    }), l;
  }
  return gv = r, gv;
}
var yv, G8;
function Mw() {
  if (G8) return yv;
  G8 = 1;
  var e = yu();
  function t(n, r, a) {
    for (var o = -1, l = n.length; ++o < l; ) {
      var u = n[o], f = r(u);
      if (f != null && (d === void 0 ? f === f && !e(f) : a(f, d)))
        var d = f, m = u;
    }
    return m;
  }
  return yv = t, yv;
}
var xv, V8;
function RJ() {
  if (V8) return xv;
  V8 = 1;
  function e(t, n) {
    return t > n;
  }
  return xv = e, xv;
}
var vv, K8;
function zJ() {
  if (K8) return vv;
  K8 = 1;
  var e = Mw(), t = RJ(), n = Ho();
  function r(a) {
    return a && a.length ? e(a, n, t) : void 0;
  }
  return vv = r, vv;
}
var bv, Y8;
function UA() {
  if (Y8) return bv;
  Y8 = 1;
  var e = dm(), t = hu();
  function n(r, a, o) {
    (o !== void 0 && !t(r[a], o) || o === void 0 && !(a in r)) && e(r, a, o);
  }
  return bv = n, bv;
}
var wv, X8;
function OJ() {
  if (X8) return wv;
  X8 = 1;
  var e = Fo(), t = gm(), n = ia(), r = "[object Object]", a = Function.prototype, o = Object.prototype, l = a.toString, u = o.hasOwnProperty, f = l.call(Object);
  function d(m) {
    if (!n(m) || e(m) != r)
      return !1;
    var p = t(m);
    if (p === null)
      return !0;
    var x = u.call(p, "constructor") && p.constructor;
    return typeof x == "function" && x instanceof x && l.call(x) == f;
  }
  return wv = d, wv;
}
var _v, W8;
function HA() {
  if (W8) return _v;
  W8 = 1;
  function e(t, n) {
    if (!(n === "constructor" && typeof t[n] == "function") && n != "__proto__")
      return t[n];
  }
  return _v = e, _v;
}
var Sv, Q8;
function DJ() {
  if (Q8) return Sv;
  Q8 = 1;
  var e = gd(), t = Uo();
  function n(r) {
    return e(r, t(r));
  }
  return Sv = n, Sv;
}
var Cv, Z8;
function IJ() {
  if (Z8) return Cv;
  Z8 = 1;
  var e = UA(), t = JT(), n = lA(), r = eA(), a = cA(), o = yd(), l = Dn(), u = OA(), f = pu(), d = pd(), m = mi(), p = OJ(), x = xd(), y = HA(), w = DJ();
  function E(k, C, T, N, A, D, M) {
    var O = y(k, T), Y = y(C, T), X = M.get(Y);
    if (X) {
      e(k, T, X);
      return;
    }
    var U = D ? D(O, Y, T + "", k, C, M) : void 0, B = U === void 0;
    if (B) {
      var G = l(Y), re = !G && f(Y), q = !G && !re && x(Y);
      U = Y, G || re || q ? l(O) ? U = O : u(O) ? U = r(O) : re ? (B = !1, U = t(Y, !0)) : q ? (B = !1, U = n(Y, !0)) : U = [] : p(Y) || o(Y) ? (U = O, o(O) ? U = w(O) : (!m(O) || d(O)) && (U = a(Y))) : B = !1;
    }
    B && (M.set(Y, U), A(U, Y, N, D, M), M.delete(Y)), e(k, T, U);
  }
  return Cv = E, Cv;
}
var Ev, J8;
function LJ() {
  if (J8) return Ev;
  J8 = 1;
  var e = cm(), t = UA(), n = Ew(), r = IJ(), a = mi(), o = Uo(), l = HA();
  function u(f, d, m, p, x) {
    f !== d && n(d, function(y, w) {
      if (x || (x = new e()), a(y))
        r(f, d, w, m, u, p, x);
      else {
        var E = p ? p(l(f, w), y, w + "", f, d, x) : void 0;
        E === void 0 && (E = y), t(f, w, E);
      }
    }, o);
  }
  return Ev = u, Ev;
}
var kv, eN;
function qJ() {
  if (eN) return kv;
  eN = 1;
  var e = wm(), t = _m();
  function n(r) {
    return e(function(a, o) {
      var l = -1, u = o.length, f = u > 1 ? o[u - 1] : void 0, d = u > 2 ? o[2] : void 0;
      for (f = r.length > 3 && typeof f == "function" ? (u--, f) : void 0, d && t(o[0], o[1], d) && (f = u < 3 ? void 0 : f, u = 1), a = Object(a); ++l < u; ) {
        var m = o[l];
        m && r(a, m, l, f);
      }
      return a;
    });
  }
  return kv = n, kv;
}
var Nv, tN;
function PJ() {
  if (tN) return Nv;
  tN = 1;
  var e = LJ(), t = qJ(), n = t(function(r, a, o) {
    e(r, a, o);
  });
  return Nv = n, Nv;
}
var jv, nN;
function GA() {
  if (nN) return jv;
  nN = 1;
  function e(t, n) {
    return t < n;
  }
  return jv = e, jv;
}
var Tv, rN;
function BJ() {
  if (rN) return Tv;
  rN = 1;
  var e = Mw(), t = GA(), n = Ho();
  function r(a) {
    return a && a.length ? e(a, n, t) : void 0;
  }
  return Tv = r, Tv;
}
var Av, iN;
function FJ() {
  if (iN) return Av;
  iN = 1;
  var e = Mw(), t = Qa(), n = GA();
  function r(a, o) {
    return a && a.length ? e(a, t(o, 2), n) : void 0;
  }
  return Av = r, Av;
}
var Mv, aN;
function $J() {
  if (aN) return Mv;
  aN = 1;
  var e = Di(), t = function() {
    return e.Date.now();
  };
  return Mv = t, Mv;
}
var Rv, sN;
function UJ() {
  if (sN) return Rv;
  sN = 1;
  var e = fm(), t = vm(), n = hm(), r = mi(), a = vd();
  function o(l, u, f, d) {
    if (!r(l))
      return l;
    u = t(u, l);
    for (var m = -1, p = u.length, x = p - 1, y = l; y != null && ++m < p; ) {
      var w = a(u[m]), E = f;
      if (w === "__proto__" || w === "constructor" || w === "prototype")
        return l;
      if (m != x) {
        var k = y[w];
        E = d ? d(k, w, y) : void 0, E === void 0 && (E = r(k) ? k : n(u[m + 1]) ? [] : {});
      }
      e(y, w, E), y = y[w];
    }
    return l;
  }
  return Rv = o, Rv;
}
var zv, oN;
function HJ() {
  if (oN) return zv;
  oN = 1;
  var e = bm(), t = UJ(), n = vm();
  function r(a, o, l) {
    for (var u = -1, f = o.length, d = {}; ++u < f; ) {
      var m = o[u], p = e(a, m);
      l(p, m) && t(d, n(m, a), p);
    }
    return d;
  }
  return zv = r, zv;
}
var Ov, lN;
function GJ() {
  if (lN) return Ov;
  lN = 1;
  var e = HJ(), t = SA();
  function n(r, a) {
    return e(r, a, function(o, l) {
      return t(r, l);
    });
  }
  return Ov = n, Ov;
}
var Dv, uN;
function VJ() {
  if (uN) return Dv;
  uN = 1;
  var e = $A(), t = MA(), n = RA();
  function r(a) {
    return n(t(a, void 0, e), a + "");
  }
  return Dv = r, Dv;
}
var Iv, cN;
function KJ() {
  if (cN) return Iv;
  cN = 1;
  var e = GJ(), t = VJ(), n = t(function(r, a) {
    return r == null ? {} : e(r, a);
  });
  return Iv = n, Iv;
}
var Lv, dN;
function YJ() {
  if (dN) return Lv;
  dN = 1;
  var e = Math.ceil, t = Math.max;
  function n(r, a, o, l) {
    for (var u = -1, f = t(e((a - r) / (o || 1)), 0), d = Array(f); f--; )
      d[l ? f : ++u] = r, r += o;
    return d;
  }
  return Lv = n, Lv;
}
var qv, fN;
function XJ() {
  if (fN) return qv;
  fN = 1;
  var e = YJ(), t = _m(), n = FA();
  function r(a) {
    return function(o, l, u) {
      return u && typeof u != "number" && t(o, l, u) && (l = u = void 0), o = n(o), l === void 0 ? (l = o, o = 0) : l = n(l), u = u === void 0 ? o < l ? 1 : -1 : n(u), e(o, l, u, a);
    };
  }
  return qv = r, qv;
}
var Pv, hN;
function WJ() {
  if (hN) return Pv;
  hN = 1;
  var e = XJ(), t = e();
  return Pv = t, Pv;
}
var Bv, mN;
function QJ() {
  if (mN) return Bv;
  mN = 1;
  function e(t, n) {
    var r = t.length;
    for (t.sort(n); r--; )
      t[r] = t[r].value;
    return t;
  }
  return Bv = e, Bv;
}
var Fv, pN;
function ZJ() {
  if (pN) return Fv;
  pN = 1;
  var e = yu();
  function t(n, r) {
    if (n !== r) {
      var a = n !== void 0, o = n === null, l = n === n, u = e(n), f = r !== void 0, d = r === null, m = r === r, p = e(r);
      if (!d && !p && !u && n > r || u && f && m && !d && !p || o && f && m || !a && m || !l)
        return 1;
      if (!o && !u && !p && n < r || p && a && l && !o && !u || d && a && l || !f && l || !m)
        return -1;
    }
    return 0;
  }
  return Fv = t, Fv;
}
var $v, gN;
function JJ() {
  if (gN) return $v;
  gN = 1;
  var e = ZJ();
  function t(n, r, a) {
    for (var o = -1, l = n.criteria, u = r.criteria, f = l.length, d = a.length; ++o < f; ) {
      var m = e(l[o], u[o]);
      if (m) {
        if (o >= d)
          return m;
        var p = a[o];
        return m * (p == "desc" ? -1 : 1);
      }
    }
    return n.index - r.index;
  }
  return $v = t, $v;
}
var Uv, yN;
function eee() {
  if (yN) return Uv;
  yN = 1;
  var e = xm(), t = bm(), n = Qa(), r = jA(), a = QJ(), o = mm(), l = JJ(), u = Ho(), f = Dn();
  function d(m, p, x) {
    p.length ? p = e(p, function(E) {
      return f(E) ? function(k) {
        return t(k, E.length === 1 ? E[0] : E);
      } : E;
    }) : p = [u];
    var y = -1;
    p = e(p, o(n));
    var w = r(m, function(E, k, C) {
      var T = e(p, function(N) {
        return N(E);
      });
      return { criteria: T, index: ++y, value: E };
    });
    return a(w, function(E, k) {
      return l(E, k, x);
    });
  }
  return Uv = d, Uv;
}
var Hv, xN;
function tee() {
  if (xN) return Hv;
  xN = 1;
  var e = Tw(), t = eee(), n = wm(), r = _m(), a = n(function(o, l) {
    if (o == null)
      return [];
    var u = l.length;
    return u > 1 && r(o, l[0], l[1]) ? l = [] : u > 2 && r(l[0], l[1], l[2]) && (l = [l[0]]), t(o, e(l, 1), []);
  });
  return Hv = a, Hv;
}
var Gv, vN;
function nee() {
  if (vN) return Gv;
  vN = 1;
  var e = wA(), t = 0;
  function n(r) {
    var a = ++t;
    return e(r) + a;
  }
  return Gv = n, Gv;
}
var Vv, bN;
function ree() {
  if (bN) return Vv;
  bN = 1;
  function e(t, n, r) {
    for (var a = -1, o = t.length, l = n.length, u = {}; ++a < o; ) {
      var f = a < l ? n[a] : void 0;
      r(u, t[a], f);
    }
    return u;
  }
  return Vv = e, Vv;
}
var Kv, wN;
function iee() {
  if (wN) return Kv;
  wN = 1;
  var e = fm(), t = ree();
  function n(r, a) {
    return t(r || [], a || [], e);
  }
  return Kv = n, Kv;
}
var Yv, _N;
function cn() {
  if (_N) return Yv;
  _N = 1;
  var e;
  if (typeof mw == "function")
    try {
      e = {
        cloneDeep: bJ(),
        constant: Cw(),
        defaults: wJ(),
        each: mA(),
        filter: EA(),
        find: jJ(),
        flatten: $A(),
        forEach: hA(),
        forIn: TJ(),
        has: kA(),
        isUndefined: NA(),
        last: AJ(),
        map: TA(),
        mapValues: MJ(),
        max: zJ(),
        merge: PJ(),
        min: BJ(),
        minBy: FJ(),
        now: $J(),
        pick: KJ(),
        range: WJ(),
        reduce: AA(),
        sortBy: tee(),
        uniqueId: nee(),
        values: DA(),
        zipObject: iee()
      };
    } catch {
    }
  return e || (e = window._), Yv = e, Yv;
}
var Xv, SN;
function aee() {
  if (SN) return Xv;
  SN = 1, Xv = e;
  function e() {
    var r = {};
    r._next = r._prev = r, this._sentinel = r;
  }
  e.prototype.dequeue = function() {
    var r = this._sentinel, a = r._prev;
    if (a !== r)
      return t(a), a;
  }, e.prototype.enqueue = function(r) {
    var a = this._sentinel;
    r._prev && r._next && t(r), r._next = a._next, a._next._prev = r, a._next = r, r._prev = a;
  }, e.prototype.toString = function() {
    for (var r = [], a = this._sentinel, o = a._prev; o !== a; )
      r.push(JSON.stringify(o, n)), o = o._prev;
    return "[" + r.join(", ") + "]";
  };
  function t(r) {
    r._prev._next = r._next, r._next._prev = r._prev, delete r._next, delete r._prev;
  }
  function n(r, a) {
    if (r !== "_next" && r !== "_prev")
      return a;
  }
  return Xv;
}
var Wv, CN;
function see() {
  if (CN) return Wv;
  CN = 1;
  var e = cn(), t = zi().Graph, n = aee();
  Wv = a;
  var r = e.constant(1);
  function a(d, m) {
    if (d.nodeCount() <= 1)
      return [];
    var p = u(d, m || r), x = o(p.graph, p.buckets, p.zeroIdx);
    return e.flatten(e.map(x, function(y) {
      return d.outEdges(y.v, y.w);
    }), !0);
  }
  function o(d, m, p) {
    for (var x = [], y = m[m.length - 1], w = m[0], E; d.nodeCount(); ) {
      for (; E = w.dequeue(); )
        l(d, m, p, E);
      for (; E = y.dequeue(); )
        l(d, m, p, E);
      if (d.nodeCount()) {
        for (var k = m.length - 2; k > 0; --k)
          if (E = m[k].dequeue(), E) {
            x = x.concat(l(d, m, p, E, !0));
            break;
          }
      }
    }
    return x;
  }
  function l(d, m, p, x, y) {
    var w = y ? [] : void 0;
    return e.forEach(d.inEdges(x.v), function(E) {
      var k = d.edge(E), C = d.node(E.v);
      y && w.push({ v: E.v, w: E.w }), C.out -= k, f(m, p, C);
    }), e.forEach(d.outEdges(x.v), function(E) {
      var k = d.edge(E), C = E.w, T = d.node(C);
      T.in -= k, f(m, p, T);
    }), d.removeNode(x.v), w;
  }
  function u(d, m) {
    var p = new t(), x = 0, y = 0;
    e.forEach(d.nodes(), function(k) {
      p.setNode(k, { v: k, in: 0, out: 0 });
    }), e.forEach(d.edges(), function(k) {
      var C = p.edge(k.v, k.w) || 0, T = m(k), N = C + T;
      p.setEdge(k.v, k.w, N), y = Math.max(y, p.node(k.v).out += T), x = Math.max(x, p.node(k.w).in += T);
    });
    var w = e.range(y + x + 3).map(function() {
      return new n();
    }), E = x + 1;
    return e.forEach(p.nodes(), function(k) {
      f(w, E, p.node(k));
    }), { graph: p, buckets: w, zeroIdx: E };
  }
  function f(d, m, p) {
    p.out ? p.in ? d[p.out - p.in + m].enqueue(p) : d[d.length - 1].enqueue(p) : d[0].enqueue(p);
  }
  return Wv;
}
var Qv, EN;
function oee() {
  if (EN) return Qv;
  EN = 1;
  var e = cn(), t = see();
  Qv = {
    run: n,
    undo: a
  };
  function n(o) {
    var l = o.graph().acyclicer === "greedy" ? t(o, u(o)) : r(o);
    e.forEach(l, function(f) {
      var d = o.edge(f);
      o.removeEdge(f), d.forwardName = f.name, d.reversed = !0, o.setEdge(f.w, f.v, d, e.uniqueId("rev"));
    });
    function u(f) {
      return function(d) {
        return f.edge(d).weight;
      };
    }
  }
  function r(o) {
    var l = [], u = {}, f = {};
    function d(m) {
      e.has(f, m) || (f[m] = !0, u[m] = !0, e.forEach(o.outEdges(m), function(p) {
        e.has(u, p.w) ? l.push(p) : d(p.w);
      }), delete u[m]);
    }
    return e.forEach(o.nodes(), d), l;
  }
  function a(o) {
    e.forEach(o.edges(), function(l) {
      var u = o.edge(l);
      if (u.reversed) {
        o.removeEdge(l);
        var f = u.forwardName;
        delete u.reversed, delete u.forwardName, o.setEdge(l.w, l.v, u, f);
      }
    });
  }
  return Qv;
}
var Zv, kN;
function Rr() {
  if (kN) return Zv;
  kN = 1;
  var e = cn(), t = zi().Graph;
  Zv = {
    addDummyNode: n,
    simplify: r,
    asNonCompoundGraph: a,
    successorWeights: o,
    predecessorWeights: l,
    intersectRect: u,
    buildLayerMatrix: f,
    normalizeRanks: d,
    removeEmptyRanks: m,
    addBorderNode: p,
    maxRank: x,
    partition: y,
    time: w,
    notime: E
  };
  function n(k, C, T, N) {
    var A;
    do
      A = e.uniqueId(N);
    while (k.hasNode(A));
    return T.dummy = C, k.setNode(A, T), A;
  }
  function r(k) {
    var C = new t().setGraph(k.graph());
    return e.forEach(k.nodes(), function(T) {
      C.setNode(T, k.node(T));
    }), e.forEach(k.edges(), function(T) {
      var N = C.edge(T.v, T.w) || { weight: 0, minlen: 1 }, A = k.edge(T);
      C.setEdge(T.v, T.w, {
        weight: N.weight + A.weight,
        minlen: Math.max(N.minlen, A.minlen)
      });
    }), C;
  }
  function a(k) {
    var C = new t({ multigraph: k.isMultigraph() }).setGraph(k.graph());
    return e.forEach(k.nodes(), function(T) {
      k.children(T).length || C.setNode(T, k.node(T));
    }), e.forEach(k.edges(), function(T) {
      C.setEdge(T, k.edge(T));
    }), C;
  }
  function o(k) {
    var C = e.map(k.nodes(), function(T) {
      var N = {};
      return e.forEach(k.outEdges(T), function(A) {
        N[A.w] = (N[A.w] || 0) + k.edge(A).weight;
      }), N;
    });
    return e.zipObject(k.nodes(), C);
  }
  function l(k) {
    var C = e.map(k.nodes(), function(T) {
      var N = {};
      return e.forEach(k.inEdges(T), function(A) {
        N[A.v] = (N[A.v] || 0) + k.edge(A).weight;
      }), N;
    });
    return e.zipObject(k.nodes(), C);
  }
  function u(k, C) {
    var T = k.x, N = k.y, A = C.x - T, D = C.y - N, M = k.width / 2, O = k.height / 2;
    if (!A && !D)
      throw new Error("Not possible to find intersection inside of the rectangle");
    var Y, X;
    return Math.abs(D) * M > Math.abs(A) * O ? (D < 0 && (O = -O), Y = O * A / D, X = O) : (A < 0 && (M = -M), Y = M, X = M * D / A), { x: T + Y, y: N + X };
  }
  function f(k) {
    var C = e.map(e.range(x(k) + 1), function() {
      return [];
    });
    return e.forEach(k.nodes(), function(T) {
      var N = k.node(T), A = N.rank;
      e.isUndefined(A) || (C[A][N.order] = T);
    }), C;
  }
  function d(k) {
    var C = e.min(e.map(k.nodes(), function(T) {
      return k.node(T).rank;
    }));
    e.forEach(k.nodes(), function(T) {
      var N = k.node(T);
      e.has(N, "rank") && (N.rank -= C);
    });
  }
  function m(k) {
    var C = e.min(e.map(k.nodes(), function(D) {
      return k.node(D).rank;
    })), T = [];
    e.forEach(k.nodes(), function(D) {
      var M = k.node(D).rank - C;
      T[M] || (T[M] = []), T[M].push(D);
    });
    var N = 0, A = k.graph().nodeRankFactor;
    e.forEach(T, function(D, M) {
      e.isUndefined(D) && M % A !== 0 ? --N : N && e.forEach(D, function(O) {
        k.node(O).rank += N;
      });
    });
  }
  function p(k, C, T, N) {
    var A = {
      width: 0,
      height: 0
    };
    return arguments.length >= 4 && (A.rank = T, A.order = N), n(k, "border", A, C);
  }
  function x(k) {
    return e.max(e.map(k.nodes(), function(C) {
      var T = k.node(C).rank;
      if (!e.isUndefined(T))
        return T;
    }));
  }
  function y(k, C) {
    var T = { lhs: [], rhs: [] };
    return e.forEach(k, function(N) {
      C(N) ? T.lhs.push(N) : T.rhs.push(N);
    }), T;
  }
  function w(k, C) {
    var T = e.now();
    try {
      return C();
    } finally {
      console.log(k + " time: " + (e.now() - T) + "ms");
    }
  }
  function E(k, C) {
    return C();
  }
  return Zv;
}
var Jv, NN;
function lee() {
  if (NN) return Jv;
  NN = 1;
  var e = cn(), t = Rr();
  Jv = {
    run: n,
    undo: a
  };
  function n(o) {
    o.graph().dummyChains = [], e.forEach(o.edges(), function(l) {
      r(o, l);
    });
  }
  function r(o, l) {
    var u = l.v, f = o.node(u).rank, d = l.w, m = o.node(d).rank, p = l.name, x = o.edge(l), y = x.labelRank;
    if (m !== f + 1) {
      o.removeEdge(l);
      var w, E, k;
      for (k = 0, ++f; f < m; ++k, ++f)
        x.points = [], E = {
          width: 0,
          height: 0,
          edgeLabel: x,
          edgeObj: l,
          rank: f
        }, w = t.addDummyNode(o, "edge", E, "_d"), f === y && (E.width = x.width, E.height = x.height, E.dummy = "edge-label", E.labelpos = x.labelpos), o.setEdge(u, w, { weight: x.weight }, p), k === 0 && o.graph().dummyChains.push(w), u = w;
      o.setEdge(u, d, { weight: x.weight }, p);
    }
  }
  function a(o) {
    e.forEach(o.graph().dummyChains, function(l) {
      var u = o.node(l), f = u.edgeLabel, d;
      for (o.setEdge(u.edgeObj, f); u.dummy; )
        d = o.successors(l)[0], o.removeNode(l), f.points.push({ x: u.x, y: u.y }), u.dummy === "edge-label" && (f.x = u.x, f.y = u.y, f.width = u.width, f.height = u.height), l = d, u = o.node(l);
    });
  }
  return Jv;
}
var eb, jN;
function Mh() {
  if (jN) return eb;
  jN = 1;
  var e = cn();
  eb = {
    longestPath: t,
    slack: n
  };
  function t(r) {
    var a = {};
    function o(l) {
      var u = r.node(l);
      if (e.has(a, l))
        return u.rank;
      a[l] = !0;
      var f = e.min(e.map(r.outEdges(l), function(d) {
        return o(d.w) - r.edge(d).minlen;
      }));
      return (f === Number.POSITIVE_INFINITY || // return value of _.map([]) for Lodash 3
      f === void 0 || // return value of _.map([]) for Lodash 4
      f === null) && (f = 0), u.rank = f;
    }
    e.forEach(r.sources(), o);
  }
  function n(r, a) {
    return r.node(a.w).rank - r.node(a.v).rank - r.edge(a).minlen;
  }
  return eb;
}
var tb, TN;
function VA() {
  if (TN) return tb;
  TN = 1;
  var e = cn(), t = zi().Graph, n = Mh().slack;
  tb = r;
  function r(u) {
    var f = new t({ directed: !1 }), d = u.nodes()[0], m = u.nodeCount();
    f.setNode(d, {});
    for (var p, x; a(f, u) < m; )
      p = o(f, u), x = f.hasNode(p.v) ? n(u, p) : -n(u, p), l(f, u, x);
    return f;
  }
  function a(u, f) {
    function d(m) {
      e.forEach(f.nodeEdges(m), function(p) {
        var x = p.v, y = m === x ? p.w : x;
        !u.hasNode(y) && !n(f, p) && (u.setNode(y, {}), u.setEdge(m, y, {}), d(y));
      });
    }
    return e.forEach(u.nodes(), d), u.nodeCount();
  }
  function o(u, f) {
    return e.minBy(f.edges(), function(d) {
      if (u.hasNode(d.v) !== u.hasNode(d.w))
        return n(f, d);
    });
  }
  function l(u, f, d) {
    e.forEach(u.nodes(), function(m) {
      f.node(m).rank += d;
    });
  }
  return tb;
}
var nb, AN;
function uee() {
  if (AN) return nb;
  AN = 1;
  var e = cn(), t = VA(), n = Mh().slack, r = Mh().longestPath, a = zi().alg.preorder, o = zi().alg.postorder, l = Rr().simplify;
  nb = u, u.initLowLimValues = p, u.initCutValues = f, u.calcCutValue = m, u.leaveEdge = y, u.enterEdge = w, u.exchangeEdges = E;
  function u(N) {
    N = l(N), r(N);
    var A = t(N);
    p(A), f(A, N);
    for (var D, M; D = y(A); )
      M = w(A, N, D), E(A, N, D, M);
  }
  function f(N, A) {
    var D = o(N, N.nodes());
    D = D.slice(0, D.length - 1), e.forEach(D, function(M) {
      d(N, A, M);
    });
  }
  function d(N, A, D) {
    var M = N.node(D), O = M.parent;
    N.edge(D, O).cutvalue = m(N, A, D);
  }
  function m(N, A, D) {
    var M = N.node(D), O = M.parent, Y = !0, X = A.edge(D, O), U = 0;
    return X || (Y = !1, X = A.edge(O, D)), U = X.weight, e.forEach(A.nodeEdges(D), function(B) {
      var G = B.v === D, re = G ? B.w : B.v;
      if (re !== O) {
        var q = G === Y, W = A.edge(B).weight;
        if (U += q ? W : -W, C(N, D, re)) {
          var V = N.edge(D, re).cutvalue;
          U += q ? -V : V;
        }
      }
    }), U;
  }
  function p(N, A) {
    arguments.length < 2 && (A = N.nodes()[0]), x(N, {}, 1, A);
  }
  function x(N, A, D, M, O) {
    var Y = D, X = N.node(M);
    return A[M] = !0, e.forEach(N.neighbors(M), function(U) {
      e.has(A, U) || (D = x(N, A, D, U, M));
    }), X.low = Y, X.lim = D++, O ? X.parent = O : delete X.parent, D;
  }
  function y(N) {
    return e.find(N.edges(), function(A) {
      return N.edge(A).cutvalue < 0;
    });
  }
  function w(N, A, D) {
    var M = D.v, O = D.w;
    A.hasEdge(M, O) || (M = D.w, O = D.v);
    var Y = N.node(M), X = N.node(O), U = Y, B = !1;
    Y.lim > X.lim && (U = X, B = !0);
    var G = e.filter(A.edges(), function(re) {
      return B === T(N, N.node(re.v), U) && B !== T(N, N.node(re.w), U);
    });
    return e.minBy(G, function(re) {
      return n(A, re);
    });
  }
  function E(N, A, D, M) {
    var O = D.v, Y = D.w;
    N.removeEdge(O, Y), N.setEdge(M.v, M.w, {}), p(N), f(N, A), k(N, A);
  }
  function k(N, A) {
    var D = e.find(N.nodes(), function(O) {
      return !A.node(O).parent;
    }), M = a(N, D);
    M = M.slice(1), e.forEach(M, function(O) {
      var Y = N.node(O).parent, X = A.edge(O, Y), U = !1;
      X || (X = A.edge(Y, O), U = !0), A.node(O).rank = A.node(Y).rank + (U ? X.minlen : -X.minlen);
    });
  }
  function C(N, A, D) {
    return N.hasEdge(A, D);
  }
  function T(N, A, D) {
    return D.low <= A.lim && A.lim <= D.lim;
  }
  return nb;
}
var rb, MN;
function cee() {
  if (MN) return rb;
  MN = 1;
  var e = Mh(), t = e.longestPath, n = VA(), r = uee();
  rb = a;
  function a(f) {
    switch (f.graph().ranker) {
      case "network-simplex":
        u(f);
        break;
      case "tight-tree":
        l(f);
        break;
      case "longest-path":
        o(f);
        break;
      default:
        u(f);
    }
  }
  var o = t;
  function l(f) {
    t(f), n(f);
  }
  function u(f) {
    r(f);
  }
  return rb;
}
var ib, RN;
function dee() {
  if (RN) return ib;
  RN = 1;
  var e = cn();
  ib = t;
  function t(a) {
    var o = r(a);
    e.forEach(a.graph().dummyChains, function(l) {
      for (var u = a.node(l), f = u.edgeObj, d = n(a, o, f.v, f.w), m = d.path, p = d.lca, x = 0, y = m[x], w = !0; l !== f.w; ) {
        if (u = a.node(l), w) {
          for (; (y = m[x]) !== p && a.node(y).maxRank < u.rank; )
            x++;
          y === p && (w = !1);
        }
        if (!w) {
          for (; x < m.length - 1 && a.node(y = m[x + 1]).minRank <= u.rank; )
            x++;
          y = m[x];
        }
        a.setParent(l, y), l = a.successors(l)[0];
      }
    });
  }
  function n(a, o, l, u) {
    var f = [], d = [], m = Math.min(o[l].low, o[u].low), p = Math.max(o[l].lim, o[u].lim), x, y;
    x = l;
    do
      x = a.parent(x), f.push(x);
    while (x && (o[x].low > m || p > o[x].lim));
    for (y = x, x = u; (x = a.parent(x)) !== y; )
      d.push(x);
    return { path: f.concat(d.reverse()), lca: y };
  }
  function r(a) {
    var o = {}, l = 0;
    function u(f) {
      var d = l;
      e.forEach(a.children(f), u), o[f] = { low: d, lim: l++ };
    }
    return e.forEach(a.children(), u), o;
  }
  return ib;
}
var ab, zN;
function fee() {
  if (zN) return ab;
  zN = 1;
  var e = cn(), t = Rr();
  ab = {
    run: n,
    cleanup: l
  };
  function n(u) {
    var f = t.addDummyNode(u, "root", {}, "_root"), d = a(u), m = e.max(e.values(d)) - 1, p = 2 * m + 1;
    u.graph().nestingRoot = f, e.forEach(u.edges(), function(y) {
      u.edge(y).minlen *= p;
    });
    var x = o(u) + 1;
    e.forEach(u.children(), function(y) {
      r(u, f, p, x, m, d, y);
    }), u.graph().nodeRankFactor = p;
  }
  function r(u, f, d, m, p, x, y) {
    var w = u.children(y);
    if (!w.length) {
      y !== f && u.setEdge(f, y, { weight: 0, minlen: d });
      return;
    }
    var E = t.addBorderNode(u, "_bt"), k = t.addBorderNode(u, "_bb"), C = u.node(y);
    u.setParent(E, y), C.borderTop = E, u.setParent(k, y), C.borderBottom = k, e.forEach(w, function(T) {
      r(u, f, d, m, p, x, T);
      var N = u.node(T), A = N.borderTop ? N.borderTop : T, D = N.borderBottom ? N.borderBottom : T, M = N.borderTop ? m : 2 * m, O = A !== D ? 1 : p - x[y] + 1;
      u.setEdge(E, A, {
        weight: M,
        minlen: O,
        nestingEdge: !0
      }), u.setEdge(D, k, {
        weight: M,
        minlen: O,
        nestingEdge: !0
      });
    }), u.parent(y) || u.setEdge(f, E, { weight: 0, minlen: p + x[y] });
  }
  function a(u) {
    var f = {};
    function d(m, p) {
      var x = u.children(m);
      x && x.length && e.forEach(x, function(y) {
        d(y, p + 1);
      }), f[m] = p;
    }
    return e.forEach(u.children(), function(m) {
      d(m, 1);
    }), f;
  }
  function o(u) {
    return e.reduce(u.edges(), function(f, d) {
      return f + u.edge(d).weight;
    }, 0);
  }
  function l(u) {
    var f = u.graph();
    u.removeNode(f.nestingRoot), delete f.nestingRoot, e.forEach(u.edges(), function(d) {
      var m = u.edge(d);
      m.nestingEdge && u.removeEdge(d);
    });
  }
  return ab;
}
var sb, ON;
function hee() {
  if (ON) return sb;
  ON = 1;
  var e = cn(), t = Rr();
  sb = n;
  function n(a) {
    function o(l) {
      var u = a.children(l), f = a.node(l);
      if (u.length && e.forEach(u, o), e.has(f, "minRank")) {
        f.borderLeft = [], f.borderRight = [];
        for (var d = f.minRank, m = f.maxRank + 1; d < m; ++d)
          r(a, "borderLeft", "_bl", l, f, d), r(a, "borderRight", "_br", l, f, d);
      }
    }
    e.forEach(a.children(), o);
  }
  function r(a, o, l, u, f, d) {
    var m = { width: 0, height: 0, rank: d, borderType: o }, p = f[o][d - 1], x = t.addDummyNode(a, "border", m, l);
    f[o][d] = x, a.setParent(x, u), p && a.setEdge(p, x, { weight: 1 });
  }
  return sb;
}
var ob, DN;
function mee() {
  if (DN) return ob;
  DN = 1;
  var e = cn();
  ob = {
    adjust: t,
    undo: n
  };
  function t(d) {
    var m = d.graph().rankdir.toLowerCase();
    (m === "lr" || m === "rl") && r(d);
  }
  function n(d) {
    var m = d.graph().rankdir.toLowerCase();
    (m === "bt" || m === "rl") && o(d), (m === "lr" || m === "rl") && (u(d), r(d));
  }
  function r(d) {
    e.forEach(d.nodes(), function(m) {
      a(d.node(m));
    }), e.forEach(d.edges(), function(m) {
      a(d.edge(m));
    });
  }
  function a(d) {
    var m = d.width;
    d.width = d.height, d.height = m;
  }
  function o(d) {
    e.forEach(d.nodes(), function(m) {
      l(d.node(m));
    }), e.forEach(d.edges(), function(m) {
      var p = d.edge(m);
      e.forEach(p.points, l), e.has(p, "y") && l(p);
    });
  }
  function l(d) {
    d.y = -d.y;
  }
  function u(d) {
    e.forEach(d.nodes(), function(m) {
      f(d.node(m));
    }), e.forEach(d.edges(), function(m) {
      var p = d.edge(m);
      e.forEach(p.points, f), e.has(p, "x") && f(p);
    });
  }
  function f(d) {
    var m = d.x;
    d.x = d.y, d.y = m;
  }
  return ob;
}
var lb, IN;
function pee() {
  if (IN) return lb;
  IN = 1;
  var e = cn();
  lb = t;
  function t(n) {
    var r = {}, a = e.filter(n.nodes(), function(d) {
      return !n.children(d).length;
    }), o = e.max(e.map(a, function(d) {
      return n.node(d).rank;
    })), l = e.map(e.range(o + 1), function() {
      return [];
    });
    function u(d) {
      if (!e.has(r, d)) {
        r[d] = !0;
        var m = n.node(d);
        l[m.rank].push(d), e.forEach(n.successors(d), u);
      }
    }
    var f = e.sortBy(a, function(d) {
      return n.node(d).rank;
    });
    return e.forEach(f, u), l;
  }
  return lb;
}
var ub, LN;
function gee() {
  if (LN) return ub;
  LN = 1;
  var e = cn();
  ub = t;
  function t(r, a) {
    for (var o = 0, l = 1; l < a.length; ++l)
      o += n(r, a[l - 1], a[l]);
    return o;
  }
  function n(r, a, o) {
    for (var l = e.zipObject(
      o,
      e.map(o, function(x, y) {
        return y;
      })
    ), u = e.flatten(e.map(a, function(x) {
      return e.sortBy(e.map(r.outEdges(x), function(y) {
        return { pos: l[y.w], weight: r.edge(y).weight };
      }), "pos");
    }), !0), f = 1; f < o.length; ) f <<= 1;
    var d = 2 * f - 1;
    f -= 1;
    var m = e.map(new Array(d), function() {
      return 0;
    }), p = 0;
    return e.forEach(u.forEach(function(x) {
      var y = x.pos + f;
      m[y] += x.weight;
      for (var w = 0; y > 0; )
        y % 2 && (w += m[y + 1]), y = y - 1 >> 1, m[y] += x.weight;
      p += x.weight * w;
    })), p;
  }
  return ub;
}
var cb, qN;
function yee() {
  if (qN) return cb;
  qN = 1;
  var e = cn();
  cb = t;
  function t(n, r) {
    return e.map(r, function(a) {
      var o = n.inEdges(a);
      if (o.length) {
        var l = e.reduce(o, function(u, f) {
          var d = n.edge(f), m = n.node(f.v);
          return {
            sum: u.sum + d.weight * m.order,
            weight: u.weight + d.weight
          };
        }, { sum: 0, weight: 0 });
        return {
          v: a,
          barycenter: l.sum / l.weight,
          weight: l.weight
        };
      } else
        return { v: a };
    });
  }
  return cb;
}
var db, PN;
function xee() {
  if (PN) return db;
  PN = 1;
  var e = cn();
  db = t;
  function t(a, o) {
    var l = {};
    e.forEach(a, function(f, d) {
      var m = l[f.v] = {
        indegree: 0,
        in: [],
        out: [],
        vs: [f.v],
        i: d
      };
      e.isUndefined(f.barycenter) || (m.barycenter = f.barycenter, m.weight = f.weight);
    }), e.forEach(o.edges(), function(f) {
      var d = l[f.v], m = l[f.w];
      !e.isUndefined(d) && !e.isUndefined(m) && (m.indegree++, d.out.push(l[f.w]));
    });
    var u = e.filter(l, function(f) {
      return !f.indegree;
    });
    return n(u);
  }
  function n(a) {
    var o = [];
    function l(d) {
      return function(m) {
        m.merged || (e.isUndefined(m.barycenter) || e.isUndefined(d.barycenter) || m.barycenter >= d.barycenter) && r(d, m);
      };
    }
    function u(d) {
      return function(m) {
        m.in.push(d), --m.indegree === 0 && a.push(m);
      };
    }
    for (; a.length; ) {
      var f = a.pop();
      o.push(f), e.forEach(f.in.reverse(), l(f)), e.forEach(f.out, u(f));
    }
    return e.map(
      e.filter(o, function(d) {
        return !d.merged;
      }),
      function(d) {
        return e.pick(d, ["vs", "i", "barycenter", "weight"]);
      }
    );
  }
  function r(a, o) {
    var l = 0, u = 0;
    a.weight && (l += a.barycenter * a.weight, u += a.weight), o.weight && (l += o.barycenter * o.weight, u += o.weight), a.vs = o.vs.concat(a.vs), a.barycenter = l / u, a.weight = u, a.i = Math.min(o.i, a.i), o.merged = !0;
  }
  return db;
}
var fb, BN;
function vee() {
  if (BN) return fb;
  BN = 1;
  var e = cn(), t = Rr();
  fb = n;
  function n(o, l) {
    var u = t.partition(o, function(E) {
      return e.has(E, "barycenter");
    }), f = u.lhs, d = e.sortBy(u.rhs, function(E) {
      return -E.i;
    }), m = [], p = 0, x = 0, y = 0;
    f.sort(a(!!l)), y = r(m, d, y), e.forEach(f, function(E) {
      y += E.vs.length, m.push(E.vs), p += E.barycenter * E.weight, x += E.weight, y = r(m, d, y);
    });
    var w = { vs: e.flatten(m, !0) };
    return x && (w.barycenter = p / x, w.weight = x), w;
  }
  function r(o, l, u) {
    for (var f; l.length && (f = e.last(l)).i <= u; )
      l.pop(), o.push(f.vs), u++;
    return u;
  }
  function a(o) {
    return function(l, u) {
      return l.barycenter < u.barycenter ? -1 : l.barycenter > u.barycenter ? 1 : o ? u.i - l.i : l.i - u.i;
    };
  }
  return fb;
}
var hb, FN;
function bee() {
  if (FN) return hb;
  FN = 1;
  var e = cn(), t = yee(), n = xee(), r = vee();
  hb = a;
  function a(u, f, d, m) {
    var p = u.children(f), x = u.node(f), y = x ? x.borderLeft : void 0, w = x ? x.borderRight : void 0, E = {};
    y && (p = e.filter(p, function(D) {
      return D !== y && D !== w;
    }));
    var k = t(u, p);
    e.forEach(k, function(D) {
      if (u.children(D.v).length) {
        var M = a(u, D.v, d, m);
        E[D.v] = M, e.has(M, "barycenter") && l(D, M);
      }
    });
    var C = n(k, d);
    o(C, E);
    var T = r(C, m);
    if (y && (T.vs = e.flatten([y, T.vs, w], !0), u.predecessors(y).length)) {
      var N = u.node(u.predecessors(y)[0]), A = u.node(u.predecessors(w)[0]);
      e.has(T, "barycenter") || (T.barycenter = 0, T.weight = 0), T.barycenter = (T.barycenter * T.weight + N.order + A.order) / (T.weight + 2), T.weight += 2;
    }
    return T;
  }
  function o(u, f) {
    e.forEach(u, function(d) {
      d.vs = e.flatten(d.vs.map(function(m) {
        return f[m] ? f[m].vs : m;
      }), !0);
    });
  }
  function l(u, f) {
    e.isUndefined(u.barycenter) ? (u.barycenter = f.barycenter, u.weight = f.weight) : (u.barycenter = (u.barycenter * u.weight + f.barycenter * f.weight) / (u.weight + f.weight), u.weight += f.weight);
  }
  return hb;
}
var mb, $N;
function wee() {
  if ($N) return mb;
  $N = 1;
  var e = cn(), t = zi().Graph;
  mb = n;
  function n(a, o, l) {
    var u = r(a), f = new t({ compound: !0 }).setGraph({ root: u }).setDefaultNodeLabel(function(d) {
      return a.node(d);
    });
    return e.forEach(a.nodes(), function(d) {
      var m = a.node(d), p = a.parent(d);
      (m.rank === o || m.minRank <= o && o <= m.maxRank) && (f.setNode(d), f.setParent(d, p || u), e.forEach(a[l](d), function(x) {
        var y = x.v === d ? x.w : x.v, w = f.edge(y, d), E = e.isUndefined(w) ? 0 : w.weight;
        f.setEdge(y, d, { weight: a.edge(x).weight + E });
      }), e.has(m, "minRank") && f.setNode(d, {
        borderLeft: m.borderLeft[o],
        borderRight: m.borderRight[o]
      }));
    }), f;
  }
  function r(a) {
    for (var o; a.hasNode(o = e.uniqueId("_root")); ) ;
    return o;
  }
  return mb;
}
var pb, UN;
function _ee() {
  if (UN) return pb;
  UN = 1;
  var e = cn();
  pb = t;
  function t(n, r, a) {
    var o = {}, l;
    e.forEach(a, function(u) {
      for (var f = n.parent(u), d, m; f; ) {
        if (d = n.parent(f), d ? (m = o[d], o[d] = f) : (m = l, l = f), m && m !== f) {
          r.setEdge(m, f);
          return;
        }
        f = d;
      }
    });
  }
  return pb;
}
var gb, HN;
function See() {
  if (HN) return gb;
  HN = 1;
  var e = cn(), t = pee(), n = gee(), r = bee(), a = wee(), o = _ee(), l = zi().Graph, u = Rr();
  gb = f;
  function f(x) {
    var y = u.maxRank(x), w = d(x, e.range(1, y + 1), "inEdges"), E = d(x, e.range(y - 1, -1, -1), "outEdges"), k = t(x);
    p(x, k);
    for (var C = Number.POSITIVE_INFINITY, T, N = 0, A = 0; A < 4; ++N, ++A) {
      m(N % 2 ? w : E, N % 4 >= 2), k = u.buildLayerMatrix(x);
      var D = n(x, k);
      D < C && (A = 0, T = e.cloneDeep(k), C = D);
    }
    p(x, T);
  }
  function d(x, y, w) {
    return e.map(y, function(E) {
      return a(x, E, w);
    });
  }
  function m(x, y) {
    var w = new l();
    e.forEach(x, function(E) {
      var k = E.graph().root, C = r(E, k, w, y);
      e.forEach(C.vs, function(T, N) {
        E.node(T).order = N;
      }), o(E, w, C.vs);
    });
  }
  function p(x, y) {
    e.forEach(y, function(w) {
      e.forEach(w, function(E, k) {
        x.node(E).order = k;
      });
    });
  }
  return gb;
}
var yb, GN;
function Cee() {
  if (GN) return yb;
  GN = 1;
  var e = cn(), t = zi().Graph, n = Rr();
  yb = {
    positionX: w,
    findType1Conflicts: r,
    findType2Conflicts: a,
    addConflict: l,
    hasConflict: u,
    verticalAlignment: f,
    horizontalCompaction: d,
    alignCoordinates: x,
    findSmallestWidthAlignment: p,
    balance: y
  };
  function r(C, T) {
    var N = {};
    function A(D, M) {
      var O = 0, Y = 0, X = D.length, U = e.last(M);
      return e.forEach(M, function(B, G) {
        var re = o(C, B), q = re ? C.node(re).order : X;
        (re || B === U) && (e.forEach(M.slice(Y, G + 1), function(W) {
          e.forEach(C.predecessors(W), function(V) {
            var ee = C.node(V), te = ee.order;
            (te < O || q < te) && !(ee.dummy && C.node(W).dummy) && l(N, V, W);
          });
        }), Y = G + 1, O = q);
      }), M;
    }
    return e.reduce(T, A), N;
  }
  function a(C, T) {
    var N = {};
    function A(M, O, Y, X, U) {
      var B;
      e.forEach(e.range(O, Y), function(G) {
        B = M[G], C.node(B).dummy && e.forEach(C.predecessors(B), function(re) {
          var q = C.node(re);
          q.dummy && (q.order < X || q.order > U) && l(N, re, B);
        });
      });
    }
    function D(M, O) {
      var Y = -1, X, U = 0;
      return e.forEach(O, function(B, G) {
        if (C.node(B).dummy === "border") {
          var re = C.predecessors(B);
          re.length && (X = C.node(re[0]).order, A(O, U, G, Y, X), U = G, Y = X);
        }
        A(O, U, O.length, X, M.length);
      }), O;
    }
    return e.reduce(T, D), N;
  }
  function o(C, T) {
    if (C.node(T).dummy)
      return e.find(C.predecessors(T), function(N) {
        return C.node(N).dummy;
      });
  }
  function l(C, T, N) {
    if (T > N) {
      var A = T;
      T = N, N = A;
    }
    var D = C[T];
    D || (C[T] = D = {}), D[N] = !0;
  }
  function u(C, T, N) {
    if (T > N) {
      var A = T;
      T = N, N = A;
    }
    return e.has(C[T], N);
  }
  function f(C, T, N, A) {
    var D = {}, M = {}, O = {};
    return e.forEach(T, function(Y) {
      e.forEach(Y, function(X, U) {
        D[X] = X, M[X] = X, O[X] = U;
      });
    }), e.forEach(T, function(Y) {
      var X = -1;
      e.forEach(Y, function(U) {
        var B = A(U);
        if (B.length) {
          B = e.sortBy(B, function(V) {
            return O[V];
          });
          for (var G = (B.length - 1) / 2, re = Math.floor(G), q = Math.ceil(G); re <= q; ++re) {
            var W = B[re];
            M[U] === U && X < O[W] && !u(N, U, W) && (M[W] = U, M[U] = D[U] = D[W], X = O[W]);
          }
        }
      });
    }), { root: D, align: M };
  }
  function d(C, T, N, A, D) {
    var M = {}, O = m(C, T, N, D), Y = D ? "borderLeft" : "borderRight";
    function X(G, re) {
      for (var q = O.nodes(), W = q.pop(), V = {}; W; )
        V[W] ? G(W) : (V[W] = !0, q.push(W), q = q.concat(re(W))), W = q.pop();
    }
    function U(G) {
      M[G] = O.inEdges(G).reduce(function(re, q) {
        return Math.max(re, M[q.v] + O.edge(q));
      }, 0);
    }
    function B(G) {
      var re = O.outEdges(G).reduce(function(W, V) {
        return Math.min(W, M[V.w] - O.edge(V));
      }, Number.POSITIVE_INFINITY), q = C.node(G);
      re !== Number.POSITIVE_INFINITY && q.borderType !== Y && (M[G] = Math.max(M[G], re));
    }
    return X(U, O.predecessors.bind(O)), X(B, O.successors.bind(O)), e.forEach(A, function(G) {
      M[G] = M[N[G]];
    }), M;
  }
  function m(C, T, N, A) {
    var D = new t(), M = C.graph(), O = E(M.nodesep, M.edgesep, A);
    return e.forEach(T, function(Y) {
      var X;
      e.forEach(Y, function(U) {
        var B = N[U];
        if (D.setNode(B), X) {
          var G = N[X], re = D.edge(G, B);
          D.setEdge(G, B, Math.max(O(C, U, X), re || 0));
        }
        X = U;
      });
    }), D;
  }
  function p(C, T) {
    return e.minBy(e.values(T), function(N) {
      var A = Number.NEGATIVE_INFINITY, D = Number.POSITIVE_INFINITY;
      return e.forIn(N, function(M, O) {
        var Y = k(C, O) / 2;
        A = Math.max(M + Y, A), D = Math.min(M - Y, D);
      }), A - D;
    });
  }
  function x(C, T) {
    var N = e.values(T), A = e.min(N), D = e.max(N);
    e.forEach(["u", "d"], function(M) {
      e.forEach(["l", "r"], function(O) {
        var Y = M + O, X = C[Y], U;
        if (X !== T) {
          var B = e.values(X);
          U = O === "l" ? A - e.min(B) : D - e.max(B), U && (C[Y] = e.mapValues(X, function(G) {
            return G + U;
          }));
        }
      });
    });
  }
  function y(C, T) {
    return e.mapValues(C.ul, function(N, A) {
      if (T)
        return C[T.toLowerCase()][A];
      var D = e.sortBy(e.map(C, A));
      return (D[1] + D[2]) / 2;
    });
  }
  function w(C) {
    var T = n.buildLayerMatrix(C), N = e.merge(
      r(C, T),
      a(C, T)
    ), A = {}, D;
    e.forEach(["u", "d"], function(O) {
      D = O === "u" ? T : e.values(T).reverse(), e.forEach(["l", "r"], function(Y) {
        Y === "r" && (D = e.map(D, function(G) {
          return e.values(G).reverse();
        }));
        var X = (O === "u" ? C.predecessors : C.successors).bind(C), U = f(C, D, N, X), B = d(
          C,
          D,
          U.root,
          U.align,
          Y === "r"
        );
        Y === "r" && (B = e.mapValues(B, function(G) {
          return -G;
        })), A[O + Y] = B;
      });
    });
    var M = p(C, A);
    return x(A, M), y(A, C.graph().align);
  }
  function E(C, T, N) {
    return function(A, D, M) {
      var O = A.node(D), Y = A.node(M), X = 0, U;
      if (X += O.width / 2, e.has(O, "labelpos"))
        switch (O.labelpos.toLowerCase()) {
          case "l":
            U = -O.width / 2;
            break;
          case "r":
            U = O.width / 2;
            break;
        }
      if (U && (X += N ? U : -U), U = 0, X += (O.dummy ? T : C) / 2, X += (Y.dummy ? T : C) / 2, X += Y.width / 2, e.has(Y, "labelpos"))
        switch (Y.labelpos.toLowerCase()) {
          case "l":
            U = Y.width / 2;
            break;
          case "r":
            U = -Y.width / 2;
            break;
        }
      return U && (X += N ? U : -U), U = 0, X;
    };
  }
  function k(C, T) {
    return C.node(T).width;
  }
  return yb;
}
var xb, VN;
function Eee() {
  if (VN) return xb;
  VN = 1;
  var e = cn(), t = Rr(), n = Cee().positionX;
  xb = r;
  function r(o) {
    o = t.asNonCompoundGraph(o), a(o), e.forEach(n(o), function(l, u) {
      o.node(u).x = l;
    });
  }
  function a(o) {
    var l = t.buildLayerMatrix(o), u = o.graph().ranksep, f = 0;
    e.forEach(l, function(d) {
      var m = e.max(e.map(d, function(p) {
        return o.node(p).height;
      }));
      e.forEach(d, function(p) {
        o.node(p).y = f + m / 2;
      }), f += m + u;
    });
  }
  return xb;
}
var vb, KN;
function kee() {
  if (KN) return vb;
  KN = 1;
  var e = cn(), t = oee(), n = lee(), r = cee(), a = Rr().normalizeRanks, o = dee(), l = Rr().removeEmptyRanks, u = fee(), f = hee(), d = mee(), m = See(), p = Eee(), x = Rr(), y = zi().Graph;
  vb = w;
  function w(Z, oe) {
    var fe = oe && oe.debugTiming ? x.time : x.notime;
    fe("layout", function() {
      var Se = fe("  buildLayoutGraph", function() {
        return X(Z);
      });
      fe("  runLayout", function() {
        E(Se, fe);
      }), fe("  updateInputGraph", function() {
        k(Z, Se);
      });
    });
  }
  function E(Z, oe) {
    oe("    makeSpaceForEdgeLabels", function() {
      U(Z);
    }), oe("    removeSelfEdges", function() {
      ie(Z);
    }), oe("    acyclic", function() {
      t.run(Z);
    }), oe("    nestingGraph.run", function() {
      u.run(Z);
    }), oe("    rank", function() {
      r(x.asNonCompoundGraph(Z));
    }), oe("    injectEdgeLabelProxies", function() {
      B(Z);
    }), oe("    removeEmptyRanks", function() {
      l(Z);
    }), oe("    nestingGraph.cleanup", function() {
      u.cleanup(Z);
    }), oe("    normalizeRanks", function() {
      a(Z);
    }), oe("    assignRankMinMax", function() {
      G(Z);
    }), oe("    removeEdgeLabelProxies", function() {
      re(Z);
    }), oe("    normalize.run", function() {
      n.run(Z);
    }), oe("    parentDummyChains", function() {
      o(Z);
    }), oe("    addBorderSegments", function() {
      f(Z);
    }), oe("    order", function() {
      m(Z);
    }), oe("    insertSelfEdges", function() {
      H(Z);
    }), oe("    adjustCoordinateSystem", function() {
      d.adjust(Z);
    }), oe("    position", function() {
      p(Z);
    }), oe("    positionSelfEdges", function() {
      L(Z);
    }), oe("    removeBorderNodes", function() {
      te(Z);
    }), oe("    normalize.undo", function() {
      n.undo(Z);
    }), oe("    fixupEdgeLabelCoords", function() {
      V(Z);
    }), oe("    undoCoordinateSystem", function() {
      d.undo(Z);
    }), oe("    translateGraph", function() {
      q(Z);
    }), oe("    assignNodeIntersects", function() {
      W(Z);
    }), oe("    reversePoints", function() {
      ee(Z);
    }), oe("    acyclic.undo", function() {
      t.undo(Z);
    });
  }
  function k(Z, oe) {
    e.forEach(Z.nodes(), function(fe) {
      var Se = Z.node(fe), Te = oe.node(fe);
      Se && (Se.x = Te.x, Se.y = Te.y, oe.children(fe).length && (Se.width = Te.width, Se.height = Te.height));
    }), e.forEach(Z.edges(), function(fe) {
      var Se = Z.edge(fe), Te = oe.edge(fe);
      Se.points = Te.points, e.has(Te, "x") && (Se.x = Te.x, Se.y = Te.y);
    }), Z.graph().width = oe.graph().width, Z.graph().height = oe.graph().height;
  }
  var C = ["nodesep", "edgesep", "ranksep", "marginx", "marginy"], T = { ranksep: 50, edgesep: 20, nodesep: 50, rankdir: "tb" }, N = ["acyclicer", "ranker", "rankdir", "align"], A = ["width", "height"], D = { width: 0, height: 0 }, M = ["minlen", "weight", "width", "height", "labeloffset"], O = {
    minlen: 1,
    weight: 1,
    width: 0,
    height: 0,
    labeloffset: 10,
    labelpos: "r"
  }, Y = ["labelpos"];
  function X(Z) {
    var oe = new y({ multigraph: !0, compound: !0 }), fe = F(Z.graph());
    return oe.setGraph(e.merge(
      {},
      T,
      J(fe, C),
      e.pick(fe, N)
    )), e.forEach(Z.nodes(), function(Se) {
      var Te = F(Z.node(Se));
      oe.setNode(Se, e.defaults(J(Te, A), D)), oe.setParent(Se, Z.parent(Se));
    }), e.forEach(Z.edges(), function(Se) {
      var Te = F(Z.edge(Se));
      oe.setEdge(Se, e.merge(
        {},
        O,
        J(Te, M),
        e.pick(Te, Y)
      ));
    }), oe;
  }
  function U(Z) {
    var oe = Z.graph();
    oe.ranksep /= 2, e.forEach(Z.edges(), function(fe) {
      var Se = Z.edge(fe);
      Se.minlen *= 2, Se.labelpos.toLowerCase() !== "c" && (oe.rankdir === "TB" || oe.rankdir === "BT" ? Se.width += Se.labeloffset : Se.height += Se.labeloffset);
    });
  }
  function B(Z) {
    e.forEach(Z.edges(), function(oe) {
      var fe = Z.edge(oe);
      if (fe.width && fe.height) {
        var Se = Z.node(oe.v), Te = Z.node(oe.w), we = { rank: (Te.rank - Se.rank) / 2 + Se.rank, e: oe };
        x.addDummyNode(Z, "edge-proxy", we, "_ep");
      }
    });
  }
  function G(Z) {
    var oe = 0;
    e.forEach(Z.nodes(), function(fe) {
      var Se = Z.node(fe);
      Se.borderTop && (Se.minRank = Z.node(Se.borderTop).rank, Se.maxRank = Z.node(Se.borderBottom).rank, oe = e.max(oe, Se.maxRank));
    }), Z.graph().maxRank = oe;
  }
  function re(Z) {
    e.forEach(Z.nodes(), function(oe) {
      var fe = Z.node(oe);
      fe.dummy === "edge-proxy" && (Z.edge(fe.e).labelRank = fe.rank, Z.removeNode(oe));
    });
  }
  function q(Z) {
    var oe = Number.POSITIVE_INFINITY, fe = 0, Se = Number.POSITIVE_INFINITY, Te = 0, we = Z.graph(), ke = we.marginx || 0, _e = we.marginy || 0;
    function Ae(Pe) {
      var Qe = Pe.x, qe = Pe.y, at = Pe.width, st = Pe.height;
      oe = Math.min(oe, Qe - at / 2), fe = Math.max(fe, Qe + at / 2), Se = Math.min(Se, qe - st / 2), Te = Math.max(Te, qe + st / 2);
    }
    e.forEach(Z.nodes(), function(Pe) {
      Ae(Z.node(Pe));
    }), e.forEach(Z.edges(), function(Pe) {
      var Qe = Z.edge(Pe);
      e.has(Qe, "x") && Ae(Qe);
    }), oe -= ke, Se -= _e, e.forEach(Z.nodes(), function(Pe) {
      var Qe = Z.node(Pe);
      Qe.x -= oe, Qe.y -= Se;
    }), e.forEach(Z.edges(), function(Pe) {
      var Qe = Z.edge(Pe);
      e.forEach(Qe.points, function(qe) {
        qe.x -= oe, qe.y -= Se;
      }), e.has(Qe, "x") && (Qe.x -= oe), e.has(Qe, "y") && (Qe.y -= Se);
    }), we.width = fe - oe + ke, we.height = Te - Se + _e;
  }
  function W(Z) {
    e.forEach(Z.edges(), function(oe) {
      var fe = Z.edge(oe), Se = Z.node(oe.v), Te = Z.node(oe.w), we, ke;
      fe.points ? (we = fe.points[0], ke = fe.points[fe.points.length - 1]) : (fe.points = [], we = Te, ke = Se), fe.points.unshift(x.intersectRect(Se, we)), fe.points.push(x.intersectRect(Te, ke));
    });
  }
  function V(Z) {
    e.forEach(Z.edges(), function(oe) {
      var fe = Z.edge(oe);
      if (e.has(fe, "x"))
        switch ((fe.labelpos === "l" || fe.labelpos === "r") && (fe.width -= fe.labeloffset), fe.labelpos) {
          case "l":
            fe.x -= fe.width / 2 + fe.labeloffset;
            break;
          case "r":
            fe.x += fe.width / 2 + fe.labeloffset;
            break;
        }
    });
  }
  function ee(Z) {
    e.forEach(Z.edges(), function(oe) {
      var fe = Z.edge(oe);
      fe.reversed && fe.points.reverse();
    });
  }
  function te(Z) {
    e.forEach(Z.nodes(), function(oe) {
      if (Z.children(oe).length) {
        var fe = Z.node(oe), Se = Z.node(fe.borderTop), Te = Z.node(fe.borderBottom), we = Z.node(e.last(fe.borderLeft)), ke = Z.node(e.last(fe.borderRight));
        fe.width = Math.abs(ke.x - we.x), fe.height = Math.abs(Te.y - Se.y), fe.x = we.x + fe.width / 2, fe.y = Se.y + fe.height / 2;
      }
    }), e.forEach(Z.nodes(), function(oe) {
      Z.node(oe).dummy === "border" && Z.removeNode(oe);
    });
  }
  function ie(Z) {
    e.forEach(Z.edges(), function(oe) {
      if (oe.v === oe.w) {
        var fe = Z.node(oe.v);
        fe.selfEdges || (fe.selfEdges = []), fe.selfEdges.push({ e: oe, label: Z.edge(oe) }), Z.removeEdge(oe);
      }
    });
  }
  function H(Z) {
    var oe = x.buildLayerMatrix(Z);
    e.forEach(oe, function(fe) {
      var Se = 0;
      e.forEach(fe, function(Te, we) {
        var ke = Z.node(Te);
        ke.order = we + Se, e.forEach(ke.selfEdges, function(_e) {
          x.addDummyNode(Z, "selfedge", {
            width: _e.label.width,
            height: _e.label.height,
            rank: ke.rank,
            order: we + ++Se,
            e: _e.e,
            label: _e.label
          }, "_se");
        }), delete ke.selfEdges;
      });
    });
  }
  function L(Z) {
    e.forEach(Z.nodes(), function(oe) {
      var fe = Z.node(oe);
      if (fe.dummy === "selfedge") {
        var Se = Z.node(fe.e.v), Te = Se.x + Se.width / 2, we = Se.y, ke = fe.x - Te, _e = Se.height / 2;
        Z.setEdge(fe.e, fe.label), Z.removeNode(oe), fe.label.points = [
          { x: Te + 2 * ke / 3, y: we - _e },
          { x: Te + 5 * ke / 6, y: we - _e },
          { x: Te + ke, y: we },
          { x: Te + 5 * ke / 6, y: we + _e },
          { x: Te + 2 * ke / 3, y: we + _e }
        ], fe.label.x = fe.x, fe.label.y = fe.y;
      }
    });
  }
  function J(Z, oe) {
    return e.mapValues(e.pick(Z, oe), Number);
  }
  function F(Z) {
    var oe = {};
    return e.forEach(Z, function(fe, Se) {
      oe[Se.toLowerCase()] = fe;
    }), oe;
  }
  return vb;
}
var bb, YN;
function Nee() {
  if (YN) return bb;
  YN = 1;
  var e = cn(), t = Rr(), n = zi().Graph;
  bb = {
    debugOrdering: r
  };
  function r(a) {
    var o = t.buildLayerMatrix(a), l = new n({ compound: !0, multigraph: !0 }).setGraph({});
    return e.forEach(a.nodes(), function(u) {
      l.setNode(u, { label: u }), l.setParent(u, "layer" + a.node(u).rank);
    }), e.forEach(a.edges(), function(u) {
      l.setEdge(u.v, u.w, {}, u.name);
    }), e.forEach(o, function(u, f) {
      var d = "layer" + f;
      l.setNode(d, { rank: "same" }), e.reduce(u, function(m, p) {
        return l.setEdge(m, p, { style: "invis" }), p;
      });
    }), l;
  }
  return bb;
}
var wb, XN;
function jee() {
  return XN || (XN = 1, wb = "0.8.5"), wb;
}
var _b, WN;
function Tee() {
  return WN || (WN = 1, _b = {
    graphlib: zi(),
    layout: kee(),
    debug: Nee(),
    util: {
      time: Rr().time,
      notime: Rr().notime
    },
    version: jee()
  }), _b;
}
var Aee = Tee();
const QN = /* @__PURE__ */ $s(Aee);
function Mee(e, t, n = "TB") {
  const r = new QN.graphlib.Graph();
  r.setDefaultEdgeLabel(() => ({}));
  const a = n === "LR";
  return r.setGraph({
    rankdir: n,
    nodesep: 50,
    // 
    ranksep: 80,
    // 
    marginx: 20,
    marginy: 20
  }), e.forEach((l) => {
    const u = l.type === "event" ? 250 : 150, f = l.type === "event" ? 100 : 60;
    r.setNode(l.id, { width: u, height: f });
  }), t.forEach((l) => {
    r.setEdge(l.source, l.target);
  }), QN.layout(r), { nodes: e.map((l) => {
    const u = r.node(l.id);
    if (!u) return l;
    const f = l.type === "event" ? 250 : 150, d = l.type === "event" ? 100 : 60;
    return {
      ...l,
      targetPosition: a ? et.Left : et.Top,
      sourcePosition: a ? et.Right : et.Bottom,
      position: {
        x: u.x - f / 2,
        y: u.y - d / 2
      }
    };
  }), edges: t };
}
const Ree = ({ data: e }) => {
  var n;
  const t = Nt((r) => r.transform[2]);
  return t < 0.15 ? /* @__PURE__ */ h.jsxs("div", { style: { width: 32, height: 32, borderRadius: "50%", backgroundColor: "#e07850", border: "2px solid #e07850", display: "flex", alignItems: "center", justifyContent: "center" }, children: [
    /* @__PURE__ */ h.jsx(sr, { type: "target", position: et.Top, style: { backgroundColor: "#e07850" } }),
    /* @__PURE__ */ h.jsx(sr, { type: "source", position: et.Bottom, style: { backgroundColor: "#e07850" } })
  ] }) : t > 1 ? /* @__PURE__ */ h.jsxs("div", { className: "w-[280px] p-3 rounded-lg border border-border bg-card shadow-md", children: [
    /* @__PURE__ */ h.jsx(sr, { type: "target", position: et.Top, className: "!bg-primary" }),
    /* @__PURE__ */ h.jsx("div", { className: "text-xs text-muted-foreground mb-1", children: e.time_anchor || "" }),
    /* @__PURE__ */ h.jsx("div", { className: "text-sm font-medium text-foreground mb-2 line-clamp-3", children: e.summary }),
    /* @__PURE__ */ h.jsx("div", { className: "flex flex-wrap gap-1", children: (n = e.roles) == null ? void 0 : n.map((r, a) => /* @__PURE__ */ h.jsx("span", { className: "px-1.5 py-0.5 text-xs bg-primary/10 text-primary rounded", children: r }, a)) }),
    /* @__PURE__ */ h.jsx(sr, { type: "source", position: et.Bottom, className: "!bg-primary" })
  ] }) : /* @__PURE__ */ h.jsxs("div", { style: { width: 220, padding: 8, borderRadius: 8, border: "1px solid #444", backgroundColor: "#2a2a2a", boxShadow: "0 1px 3px rgba(0,0,0,0.3)" }, children: [
    /* @__PURE__ */ h.jsx(sr, { type: "target", position: et.Top, style: { backgroundColor: "#e07850" } }),
    /* @__PURE__ */ h.jsx("div", { style: { fontSize: 11, color: "#888", marginBottom: 4, overflow: "hidden", textOverflow: "ellipsis", whiteSpace: "nowrap" }, children: e.time_anchor || "" }),
    /* @__PURE__ */ h.jsx("div", { style: { fontSize: 13, color: "#eee", display: "-webkit-box", WebkitLineClamp: 2, WebkitBoxOrient: "vertical", overflow: "hidden" }, children: e.label }),
    /* @__PURE__ */ h.jsx(sr, { type: "source", position: et.Bottom, style: { backgroundColor: "#e07850" } })
  ] });
}, zee = ({ data: e }) => {
  const t = Nt((n) => n.transform[2]);
  return t < 0.15 ? /* @__PURE__ */ h.jsxs("div", { style: { width: 24, height: 24, borderRadius: "50%", backgroundColor: "#555", border: "1px solid #666", display: "flex", alignItems: "center", justifyContent: "center" }, children: [
    /* @__PURE__ */ h.jsx(sr, { type: "target", position: et.Top, style: { backgroundColor: "#888" } }),
    /* @__PURE__ */ h.jsx(sr, { type: "source", position: et.Bottom, style: { backgroundColor: "#888" } })
  ] }) : t > 1 ? /* @__PURE__ */ h.jsxs("div", { className: "w-[160px] p-2 rounded-lg border border-border bg-muted/50", children: [
    /* @__PURE__ */ h.jsx(sr, { type: "target", position: et.Top, className: "!bg-muted-foreground" }),
    /* @__PURE__ */ h.jsx("div", { className: "text-xs text-muted-foreground uppercase", children: e.type }),
    /* @__PURE__ */ h.jsx("div", { className: "text-sm font-medium text-foreground", children: e.label }),
    /* @__PURE__ */ h.jsx("div", { className: "text-xs text-muted-foreground mt-1 line-clamp-2", children: e.description }),
    /* @__PURE__ */ h.jsx(sr, { type: "source", position: et.Bottom, className: "!bg-muted-foreground" })
  ] }) : /* @__PURE__ */ h.jsxs("div", { style: { width: 120, padding: 6, borderRadius: 6, border: "1px solid #555", backgroundColor: "#333" }, children: [
    /* @__PURE__ */ h.jsx(sr, { type: "target", position: et.Top, style: { backgroundColor: "#888" } }),
    /* @__PURE__ */ h.jsx("div", { style: { fontSize: 12, color: "#ddd", overflow: "hidden", textOverflow: "ellipsis", whiteSpace: "nowrap" }, children: e.label }),
    /* @__PURE__ */ h.jsx(sr, { type: "source", position: et.Bottom, style: { backgroundColor: "#888" } })
  ] });
}, Oee = {
  event: Ree,
  entity: zee
}, Dee = ({ events: e, entities: t }) => {
  const [n, r, a] = PW([]), [o, l, u] = BW([]), [f, d] = P.useState(!1), m = P.useRef(null), p = P.useCallback(() => {
    const y = [], w = [];
    return e.forEach((E, k) => {
      var C, T;
      y.push({
        id: E.id,
        type: "event",
        position: { x: 0, y: k * 120 },
        data: {
          label: E.summary.substring(0, 50) + (E.summary.length > 50 ? "..." : ""),
          summary: E.summary,
          time_anchor: (C = E.structured_kv) == null ? void 0 : C.time_anchor,
          roles: (T = E.structured_kv) == null ? void 0 : T.role,
          significance: E.significance_score
        }
      }), k > 0 && w.push({
        id: `e-${e[k - 1].id}-${E.id}`,
        source: e[k - 1].id,
        target: E.id,
        type: "smoothstep",
        animated: !1,
        style: { stroke: "var(--primary)", strokeWidth: 2 },
        markerEnd: { type: ed.ArrowClosed, color: "var(--primary)" }
      });
    }), t.forEach((E, k) => {
      y.push({
        id: E.id,
        type: "entity",
        position: { x: 300 + k % 3 * 100, y: Math.floor(k / 3) * 80 },
        data: {
          label: E.name,
          type: E.type,
          description: E.description,
          profile: E.profile
        }
      });
    }), t.forEach((E) => {
      var C;
      const k = (C = E.profile) == null ? void 0 : C.relations;
      k && Array.isArray(k) && k.forEach((T) => {
        const N = t.find((A) => A.name === T.target);
        N && w.push({
          id: `rel-${E.id}-${N.id}`,
          source: E.id,
          target: N.id,
          type: "smoothstep",
          animated: !1,
          label: T.type,
          style: { stroke: "#888", strokeWidth: 1 },
          labelStyle: { fontSize: 10, fill: "#aaa" }
        });
      });
    }), e.forEach((E) => {
      var T;
      const k = ((T = E.structured_kv) == null ? void 0 : T.role) || [];
      t.filter(
        (N) => {
          var A;
          return k.includes(N.name) || ((A = N.aliases) == null ? void 0 : A.some((D) => k.includes(D)));
        }
      ).forEach((N) => {
        w.push({
          id: `co-${N.id}-${E.id}`,
          source: N.id,
          target: E.id,
          type: "smoothstep",
          animated: !1,
          style: { stroke: "var(--muted-foreground)", strokeWidth: 1, strokeDasharray: "4 2" }
        });
      });
    }), { nodes: y, edges: w };
  }, [e, t]), x = P.useCallback(() => {
    d(!0);
    const { nodes: y, edges: w } = p(), { nodes: E, edges: k } = Mee(y, w, "TB");
    r(E), l(k), d(!1), setTimeout(() => {
      var C;
      (C = m.current) == null || C.fitView({ padding: 0.2 });
    }, 50);
  }, [p, r, l]);
  return P.useEffect(() => {
    (e.length > 0 || t.length > 0) && x();
  }, [e.length, t.length]), e.length === 0 && t.length === 0 ? /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col items-center justify-center h-full text-muted-foreground gap-4", children: [
    /* @__PURE__ */ h.jsx(Rz, { size: 48, className: "opacity-20" }),
    /* @__PURE__ */ h.jsx("p", { className: "text-sm", children: "" }),
    /* @__PURE__ */ h.jsx("p", { className: "text-xs", children: "" })
  ] }) : /* @__PURE__ */ h.jsxs("div", { style: { position: "relative", width: "100%", height: "400px" }, children: [
    /* @__PURE__ */ h.jsx("div", { className: "absolute top-2 left-2 z-10 flex gap-2", children: /* @__PURE__ */ h.jsxs(
      "button",
      {
        onClick: x,
        disabled: f,
        className: "flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-md bg-card border border-border text-foreground hover:bg-accent transition-colors disabled:opacity-50",
        children: [
          /* @__PURE__ */ h.jsx(zn, { size: 12, className: f ? "animate-spin" : "" }),
          ""
        ]
      }
    ) }),
    /* @__PURE__ */ h.jsxs(
      qW,
      {
        nodes: n,
        edges: o,
        onNodesChange: a,
        onEdgesChange: u,
        onInit: (y) => {
          m.current = y;
        },
        nodeTypes: Oee,
        fitView: !0,
        minZoom: 0.1,
        maxZoom: 2,
        colorMode: "dark",
        defaultEdgeOptions: {
          type: "smoothstep"
        },
        proOptions: { hideAttribution: !0 },
        children: [
          /* @__PURE__ */ h.jsx(GW, { color: "#333", gap: 20 }),
          /* @__PURE__ */ h.jsx(ZW, { className: "!bg-card !border-border" }),
          /* @__PURE__ */ h.jsx(
            dQ,
            {
              nodeColor: (y) => y.type === "event" ? "#e07850" : "#888",
              className: "!bg-card !border-border"
            }
          )
        ]
      }
    )
  ] });
}, ZN = 768, Iee = [
  { id: "list", label: "", icon: /* @__PURE__ */ h.jsx(Iz, { size: 14 }) },
  { id: "graph", label: "", icon: /* @__PURE__ */ h.jsx(gz, { size: 14 }) }
], Lee = () => {
  const [e, t] = P.useState([]), [n, r] = P.useState(null), [a, o] = P.useState(/* @__PURE__ */ new Set()), [l, u] = P.useState(""), [f, d] = P.useState(!0), [m, p] = P.useState(window.innerWidth < ZN), [x, y] = P.useState(!1), [w, E] = P.useState("list"), [k, C] = P.useState([]), [T, N] = P.useState(/* @__PURE__ */ new Map()), A = T.size > 0, [D, M] = P.useState(!1), O = yr.getState(), Y = P.useRef(null);
  P.useEffect(() => {
    const L = () => {
      p(window.innerWidth < ZN);
    };
    return window.addEventListener("resize", L), () => window.removeEventListener("resize", L);
  }, []);
  const X = async () => {
    d(!0);
    try {
      const L = await O.getAllEvents();
      t(L.sort((J, F) => F.timestamp - J.timestamp));
    } catch (L) {
      console.error("[MemoryStream] Failed to load events:", L);
    } finally {
      d(!1);
    }
  };
  P.useEffect(() => {
    X(), U();
  }, []);
  const U = async () => {
    try {
      const L = await O.getAllEntities();
      C(L);
    } catch (L) {
      console.error("[MemoryStream] Failed to load entities:", L);
    }
  }, B = P.useMemo(() => {
    if (!l.trim()) return e;
    const L = l.toLowerCase();
    return e.filter(
      (J) => {
        var F, Z;
        return J.summary.toLowerCase().includes(L) || ((F = J.structured_kv.event) == null ? void 0 : F.toLowerCase().includes(L)) || ((Z = J.structured_kv.role) == null ? void 0 : Z.some((oe) => oe.toLowerCase().includes(L)));
      }
    );
  }, [e, l]), G = P.useMemo(() => {
    const L = e.find((F) => F.id === n);
    if (!L) return null;
    const J = T.get(L.id);
    return J ? { ...L, ...J } : L;
  }, [e, n, T]), re = (L) => {
    r(L), m && y(!0);
  }, q = (L, J) => {
    const F = new Set(a);
    J ? F.add(L) : F.delete(L), o(F);
  }, W = P.useCallback((L, J) => {
    N((F) => {
      const Z = new Map(F), oe = Z.get(L) || {};
      return Z.set(L, { ...oe, ...J }), Z;
    }), t((F) => F.map(
      (Z) => Z.id === L ? { ...Z, ...J } : Z
    ));
  }, []), V = async () => {
    if (T.size !== 0)
      try {
        const L = Array.from(T.entries()).map(
          ([J, F]) => O.updateEvent(J, F)
        );
        await Promise.all(L), console.log(`[MemoryStream] Batch saved ${T.size} events`), N(/* @__PURE__ */ new Map());
      } catch (L) {
        console.error("[MemoryStream] Batch save failed:", L);
      }
  }, ee = async () => {
    const L = We.get("apiSettings"), J = L == null ? void 0 : L.vectorConfig;
    if (!J) {
      alert(" API ");
      return;
    }
    if (confirm("")) {
      M(!0);
      try {
        Bn.setConfig(J);
        const F = L == null ? void 0 : L.embeddingConfig;
        F != null && F.concurrency && Bn.setConcurrency(F.concurrency), await Bn.reembedAllEvents((Z, oe, fe) => {
          console.log(`[MemoryStream] Reembedding: ${Z}/${oe}, errors: ${fe}`);
        }), await X(), alert("");
      } catch (F) {
        console.error("[MemoryStream] Reembed failed:", F), alert(": " + (F.message || ""));
      } finally {
        M(!1);
      }
    }
  }, te = async (L) => {
    await O.deleteEvents([L]), t((J) => J.filter((F) => F.id !== L)), r(null), y(!1), N((J) => {
      const F = new Map(J);
      return F.delete(L), F;
    });
  }, ie = async () => {
    a.size !== 0 && confirm(` ${a.size} `) && (await O.deleteEvents(Array.from(a)), t((L) => L.filter((J) => !a.has(J.id))), o(/* @__PURE__ */ new Set()), N((L) => {
      const J = new Map(L);
      return a.forEach((F) => J.delete(F)), J;
    }));
  }, H = () => {
    y(!1), m && r(null);
  };
  return m && x && G ? /* @__PURE__ */ h.jsx(
    Jb,
    {
      ref: Y,
      event: G,
      isFullScreen: !0,
      onSave: W,
      onDelete: te,
      onClose: H
    }
  ) : /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col h-full animate-in fade-in overflow-hidden", children: [
    /* @__PURE__ */ h.jsx(X2, { title: "", subtitle: "" }),
    /* @__PURE__ */ h.jsx(Fn, { className: "mb-6" }),
    /* @__PURE__ */ h.jsx(
      Kh,
      {
        tabs: Iee,
        activeTab: w,
        onChange: (L) => E(L),
        actions: /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-2", children: [
          A && /* @__PURE__ */ h.jsxs(
            "button",
            {
              className: "inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-primary hover:text-primary-foreground hover:bg-primary border border-primary/50 rounded transition-colors",
              onClick: V,
              children: [
                /* @__PURE__ */ h.jsx(Tc, { size: 12 }),
                " (",
                T.size,
                ")"
              ]
            }
          ),
          /* @__PURE__ */ h.jsxs(
            "button",
            {
              onClick: ee,
              disabled: D,
              className: "inline-flex items-center gap-1.5 px-2 py-1.5 text-xs text-muted-foreground hover:text-foreground hover:bg-accent rounded transition-colors disabled:opacity-50",
              title: "",
              children: [
                /* @__PURE__ */ h.jsx(uj, { size: 12, className: D ? "animate-pulse" : "" }),
                D ? "..." : ""
              ]
            }
          ),
          /* @__PURE__ */ h.jsx(
            "button",
            {
              onClick: X,
              className: "p-1.5 hover:bg-accent rounded-md text-muted-foreground hover:text-foreground transition-colors",
              title: "",
              children: /* @__PURE__ */ h.jsx(zn, { size: 14, className: f ? "animate-spin" : "" })
            }
          ),
          a.size > 0 && /* @__PURE__ */ h.jsxs(
            "button",
            {
              onClick: ie,
              className: "flex items-center gap-1 px-2 py-1 text-xs text-destructive hover:bg-destructive/10 rounded-md",
              children: [
                /* @__PURE__ */ h.jsx(Ri, { size: 12 }),
                " (",
                a.size,
                ")"
              ]
            }
          )
        ] })
      }
    ),
    w === "list" && /* @__PURE__ */ h.jsxs(
      "div",
      {
        className: "flex flex-col overflow-hidden",
        style: {
          //  - header(~50px) - tabs(~80px) - title(~60px) - (~80px)
          height: "calc(100vh - 100px)",
          minHeight: "300px"
        },
        children: [
          /* @__PURE__ */ h.jsxs("div", { className: "relative mb-4 shrink-0", children: [
            /* @__PURE__ */ h.jsx(hi, { size: 14, className: "absolute left-0 top-1/2 -translate-y-1/2 text-muted-foreground" }),
            /* @__PURE__ */ h.jsx(
              "input",
              {
                type: "text",
                value: l,
                onChange: (L) => u(L.target.value),
                placeholder: "...",
                style: {
                  background: "transparent",
                  border: "none",
                  borderBottom: "1px solid var(--border)",
                  borderRadius: 0,
                  outline: "none",
                  padding: "8px 0 8px 24px",
                  fontSize: "14px",
                  width: "100%",
                  color: "var(--foreground)"
                },
                className: "placeholder:text-muted-foreground/40 focus:border-primary transition-colors"
              }
            )
          ] }),
          /* @__PURE__ */ h.jsxs("div", { className: "flex-1 flex gap-6 min-h-0", children: [
            /* @__PURE__ */ h.jsx("div", { className: `
                            ${m ? "w-full" : "w-[30%] min-w-[240px]"}
                            overflow-y-auto no-scrollbar
                            ${m ? "" : "border-r border-border/50 pr-4"}
                        `, children: f ? /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col items-center justify-center h-48 text-muted-foreground gap-2", children: [
              /* @__PURE__ */ h.jsx(zn, { size: 24, className: "animate-spin" }),
              /* @__PURE__ */ h.jsx("p", { className: "text-sm font-light", children: "..." })
            ] }) : B.length === 0 ? /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col items-center justify-center h-48 text-muted-foreground gap-4", children: [
              /* @__PURE__ */ h.jsx(ij, { size: 48, className: "opacity-20" }),
              /* @__PURE__ */ h.jsx("p", { className: "text-sm font-light", children: l ? "" : "" })
            ] }) : /* @__PURE__ */ h.jsx("div", { className: m ? "" : "space-y-1 pb-4", children: B.map((L) => /* @__PURE__ */ h.jsx(
              pH,
              {
                event: L,
                isSelected: L.id === n,
                isCompact: m,
                checked: a.has(L.id),
                hasChanges: T.has(L.id),
                onSelect: () => re(L.id),
                onCheck: (J) => q(L.id, J)
              },
              L.id
            )) }) }),
            !m && /* @__PURE__ */ h.jsx("div", { className: "flex-1 overflow-y-auto no-scrollbar", children: /* @__PURE__ */ h.jsx(
              Jb,
              {
                ref: Y,
                event: G,
                isFullScreen: !1,
                onSave: W,
                onDelete: te,
                onClose: () => r(null)
              }
            ) })
          ] })
        ]
      }
    ),
    w === "graph" && /* @__PURE__ */ h.jsx(
      "div",
      {
        className: "flex-1 min-h-0",
        style: {
          // 
          height: "calc(100vh - 270px)",
          minHeight: "400px"
        },
        children: /* @__PURE__ */ h.jsx(Dee, { events: e, entities: k })
      }
    )
  ] });
}, qee = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  MemoryStream: Lee
}, Symbol.toStringTag, { value: "Module" })), Pee = ({ links: e, onNavigate: t, className: n = "" }) => e.length === 0 ? null : /* @__PURE__ */ h.jsx("div", { className: `flex items-center gap-4 ${n}`, children: e.map((r) => {
  const a = r.icon || cz;
  return /* @__PURE__ */ h.jsxs(
    "button",
    {
      className: "inline-flex items-center gap-1.5 text-xs text-muted-foreground hover:text-foreground transition-colors",
      onClick: () => t(r.linkTo),
      title: r.label,
      children: [
        /* @__PURE__ */ h.jsx(a, { size: 12 }),
        /* @__PURE__ */ h.jsx("span", { children: r.label })
      ]
    },
    r.id
  );
}) }), Rh = {
  keepRecentCount: 3,
  previewEnabled: !0
};
class KA {
  constructor(t) {
    nt(this, "config");
    nt(this, "isTrimming", !1);
    this.config = { ...Rh, ...t };
  }
  /**
   * 
   */
  updateConfig(t) {
    this.config = { ...this.config, ...t };
  }
  /**
   * 
   */
  async canTrim() {
    const n = await yr.getState().getAllEvents(), r = Math.max(0, n.length - this.config.keepRecentCount);
    return {
      canTrim: r >= 2,
      //  2 
      eventCount: n.length,
      pendingCount: r
    };
  }
  /**
   * 
   *  1 
   */
  async trim(t = !1) {
    if (this.isTrimming)
      return le.warn("EventTrimmer", ""), null;
    const n = yr.getState(), r = await n.getEventsToMerge(this.config.keepRecentCount);
    if (r.length < 2)
      return t && St.info(" ( 2 )", "Engram"), null;
    this.isTrimming = !0, le.info("EventTrimmer", "", { eventCount: r.length });
    try {
      const a = this.formatEventsForTrim(r), o = await Oo.generate({
        systemPrompt: Cj,
        userPrompt: `

${a}`
      });
      if (!o.success || !o.content)
        return le.error("EventTrimmer", "LLM ", { error: o.error }), St.error("LLM ", "Engram"), null;
      const l = K2.parse(o.content);
      if (!l || !l.events || l.events.length === 0)
        return le.error("EventTrimmer", "JSON "), St.error("", "Engram"), null;
      let u = l.events.map((y) => y.summary).join(`

`);
      if (this.config.previewEnabled)
        try {
          u = await Y2.requestRevision(
            "",
            ` ${r.length} `,
            u
          );
        } catch {
          return le.warn("EventTrimmer", ""), St.info("", ""), null;
        }
      const f = l.events[0], d = await n.saveEvent({
        summary: u,
        structured_kv: {
          time_anchor: f.meta.time_anchor || "",
          role: this.mergeArrays(r.map((y) => y.structured_kv.role)),
          location: f.meta.location || "",
          event: "",
          logic: this.mergeArrays(r.map((y) => y.structured_kv.logic)),
          causality: "Chain"
        },
        significance_score: Math.max(...r.map((y) => y.significance_score)),
        level: 1,
        // 
        is_embedded: !1,
        //  ( Trim )
        is_archived: !1,
        // 
        source_range: {
          start_index: Math.min(...r.map((y) => {
            var w;
            return ((w = y.source_range) == null ? void 0 : w.start_index) ?? 0;
          })),
          end_index: Math.max(...r.map((y) => {
            var w;
            return ((w = y.source_range) == null ? void 0 : w.end_index) ?? 0;
          }))
        }
      }), m = r.map((y) => y.id), p = We.get("apiSettings"), x = p == null ? void 0 : p.embeddingConfig;
      if (x != null && x.enabled && x.trigger === "with_trim") {
        le.info("EventTrimmer", "", { count: r.length });
        try {
          await Bn.embedEvents(r), await n.markEventsAsEmbedded(m);
        } catch (y) {
          le.error("EventTrimmer", "", { error: y }), St.warning("", "Engram");
        }
      }
      return await n.archiveEvents(m), await ji.refreshCache(), le.success("EventTrimmer", "", {
        merged: r.length,
        newEventId: d.id
      }), St.success(
        ` ${r.length}  1 `,
        "Engram"
      ), {
        newEvent: d,
        deletedCount: 0,
        // V0.7: 
        sourceEventIds: m
      };
    } catch (a) {
      const o = a instanceof Error ? a.message : String(a);
      return le.error("EventTrimmer", "", { error: o }), St.error(`: ${o}`, "Engram "), null;
    } finally {
      this.isTrimming = !1;
    }
  }
  /**
   *  ()
   */
  formatEventsForTrim(t) {
    return t.map((n) => {
      const r = n.structured_kv;
      return `${n.summary}
Role: [${r.role.join(", ")}]
Loc: ${r.location}
Event: ${r.event}
Logic: [${r.logic.join(", ")}]
Causality: ${r.causality}
Significance: ${n.significance_score}`;
    }).join(`

---

`);
  }
  /**
   * 
   */
  mergeArrays(t) {
    const n = /* @__PURE__ */ new Set();
    for (const r of t)
      for (const a of r)
        n.add(a);
    return Array.from(n);
  }
  /**
   * 
   */
  getConfig() {
    return { ...this.config };
  }
  /**
   *  (UI )
   */
  async getStatus() {
    var E;
    const { useMemoryStore: t } = await Promise.resolve().then(() => $7), n = t.getState(), { totalTokens: r, eventCount: a } = await n.countEventTokens();
    let o = !1, l = 0, u = 0;
    const d = ((E = We.getSummarizerSettings()) == null ? void 0 : E.trimConfig) || this.config, m = d.trigger || "token", p = d.tokenLimit || 10240, x = d.countLimit || 5;
    m === "token" ? (l = r, u = p) : (l = a, u = x), o = l >= u;
    const y = d.keepRecentCount || 3, w = Math.max(0, a - y);
    return {
      triggered: o,
      triggerType: m,
      currentValue: l,
      threshold: u,
      pendingEntryCount: w,
      isTrimming: this.isTrimming
    };
  }
}
const oh = new KA(), Sb = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  DEFAULT_TRIM_CONFIG: Rh,
  EventTrimmer: KA,
  eventTrimmer: oh
}, Symbol.toStringTag, { value: "Module" })), Bee = [
  { id: "token", label: "Token ", icon: GR },
  { id: "count", label: "", icon: _z }
], Fee = () => {
  const [e, t] = P.useState(null), [n, r] = P.useState(!1), [a, o] = P.useState(!1), [l, u] = P.useState({
    autoEnabled: !0,
    floorInterval: 10,
    bufferSize: 3,
    autoHide: !1
  }), [f, d] = P.useState({ ...Rh, keepRecentCount: 3 }), [m, p] = P.useState(null), [x, y] = P.useState(0), [w, E] = P.useState(0);
  P.useEffect(() => {
    k();
  }, []);
  const k = async () => {
    var G;
    try {
      const { summarizerService: re } = await Promise.resolve().then(() => Ki);
      await re.initializeForCurrentChat();
      const q = re.getStatus();
      t(q);
      const W = re.getConfig();
      u({
        autoEnabled: W.enabled,
        floorInterval: W.floorInterval,
        bufferSize: W.bufferSize || 3,
        autoHide: W.autoHide || !1
      });
      const V = (G = We.getSummarizerSettings()) == null ? void 0 : G.trimConfig;
      V && d({ ...Rh, ...V });
      const { eventTrimmer: ee } = await Promise.resolve().then(() => Sb), te = await ee.getStatus();
      p(te);
      const { useMemoryStore: ie } = await Promise.resolve().then(() => $7), H = ie.getState(), { totalTokens: L, activeEventCount: J } = await H.countEventTokens();
      y(L), E(J);
    } catch (re) {
      console.error(" Summarizer :", re);
    }
  }, C = async () => {
    try {
      const { summarizerService: G } = await Promise.resolve().then(() => Ki);
      G.start(), await k();
    } catch (G) {
      console.error(":", G);
    }
  }, T = async () => {
    try {
      const { summarizerService: G } = await Promise.resolve().then(() => Ki);
      G.stop(), await k();
    } catch (G) {
      console.error(":", G);
    }
  }, N = async () => {
    r(!0);
    try {
      const { summarizerService: G } = await Promise.resolve().then(() => Ki);
      await G.triggerSummary(!0), await k();
    } catch (G) {
      console.error(":", G);
    } finally {
      r(!1);
    }
  }, A = async () => {
    if (confirm("")) {
      r(!0);
      try {
        const { summarizerService: G } = await Promise.resolve().then(() => Ki);
        await G.setLastSummarizedFloor(0), await k();
      } catch (G) {
        console.error(":", G);
      } finally {
        r(!1);
      }
    }
  }, D = (G) => {
    const re = { ...f, trigger: G };
    d(re), O(re);
  }, M = (G, re) => {
    const q = { ...f, [G]: re };
    d(q), O(q);
  }, O = (G) => {
    We.setSummarizerSettings({ trimConfig: G });
  }, Y = async () => {
    const G = { ...f, enabled: !f.enabled };
    d(G), O(G);
    const { eventTrimmer: re } = await Promise.resolve().then(() => Sb);
    re.updateConfig({ enabled: G.enabled });
  }, X = async () => {
    o(!0);
    try {
      const { eventTrimmer: G } = await Promise.resolve().then(() => Sb);
      await G.trim(!0), await k();
    } catch (G) {
      console.error(":", G);
    } finally {
      o(!1);
    }
  }, B = (() => {
    switch (f.trigger) {
      case "token":
        return { value: f.tokenLimit ?? 10240, min: 1024, max: 1e5, step: 1024, label: "Token " };
      case "count":
        return { value: f.countLimit ?? 5, min: 2, max: 20, step: 1, label: "" };
      default:
        return { value: 10240, min: 1024, max: 1e5, step: 1024, label: "Token " };
    }
  })();
  return /* @__PURE__ */ h.jsxs("div", { className: "grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-12", children: [
    /* @__PURE__ */ h.jsxs("section", { className: "space-y-8", children: [
      /* @__PURE__ */ h.jsxs("div", { children: [
        /* @__PURE__ */ h.jsxs("div", { className: "flex items-center justify-between mb-6", children: [
          /* @__PURE__ */ h.jsx("h2", { className: "text-xs font-medium text-muted-foreground uppercase tracking-wider", children: "" }),
          /* @__PURE__ */ h.jsx(
            "button",
            {
              className: "p-1 rounded text-muted-foreground hover:text-foreground transition-colors",
              onClick: k,
              title: "",
              children: /* @__PURE__ */ h.jsx(zn, { size: 14 })
            }
          )
        ] }),
        e ? /* @__PURE__ */ h.jsxs("div", { className: "space-y-6", children: [
          /* @__PURE__ */ h.jsxs("div", { className: "grid grid-cols-2 gap-6", children: [
            /* @__PURE__ */ h.jsxs("div", { children: [
              /* @__PURE__ */ h.jsx("span", { className: "text-xs text-muted-foreground block mb-1", children: "" }),
              /* @__PURE__ */ h.jsxs("div", { className: `flex items-center gap-2 text-lg font-medium ${e.running ? "text-green-500" : "text-muted-foreground"}`, children: [
                e.running ? /* @__PURE__ */ h.jsx(Oh, { size: 18 }) : /* @__PURE__ */ h.jsx(Fs, { size: 18 }),
                e.running ? "" : ""
              ] })
            ] }),
            /* @__PURE__ */ h.jsxs("div", { children: [
              /* @__PURE__ */ h.jsx("span", { className: "text-xs text-muted-foreground block mb-1", children: "" }),
              /* @__PURE__ */ h.jsx("div", { className: "text-3xl font-light text-amber-500 font-mono", children: e.pendingFloors })
            ] })
          ] }),
          /* @__PURE__ */ h.jsx(Fn, { length: 100, spacing: "md" }),
          /* @__PURE__ */ h.jsxs("div", { className: "grid grid-cols-2 gap-6", children: [
            /* @__PURE__ */ h.jsxs("div", { children: [
              /* @__PURE__ */ h.jsx("span", { className: "text-[10px] text-muted-foreground/70 uppercase tracking-wider block mb-1", children: "" }),
              /* @__PURE__ */ h.jsx("div", { className: "text-xl font-mono text-foreground/80", children: e.currentFloor })
            ] }),
            /* @__PURE__ */ h.jsxs("div", { children: [
              /* @__PURE__ */ h.jsx("span", { className: "text-[10px] text-muted-foreground/70 uppercase tracking-wider block mb-1", children: " ()" }),
              /* @__PURE__ */ h.jsx("div", { className: "text-xl font-mono text-foreground/80", children: w })
            ] })
          ] }),
          /* @__PURE__ */ h.jsx(Fn, { length: 30, spacing: "md" }),
          /* @__PURE__ */ h.jsxs("div", { children: [
            /* @__PURE__ */ h.jsx("span", { className: "text-[10px] text-muted-foreground/60 uppercase tracking-wider block mb-1", children: " Token (Engram)" }),
            /* @__PURE__ */ h.jsx("div", { className: "text-sm font-mono text-primary/80", children: x.toLocaleString() })
          ] })
        ] }) : /* @__PURE__ */ h.jsx("p", { className: "text-sm text-muted-foreground", children: "..." })
      ] }),
      /* @__PURE__ */ h.jsxs("div", { className: "flex gap-3", children: [
        e != null && e.running ? /* @__PURE__ */ h.jsxs(
          "button",
          {
            className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg transition-colors",
            onClick: T,
            children: [
              /* @__PURE__ */ h.jsx(sj, { size: 14 }),
              ""
            ]
          }
        ) : /* @__PURE__ */ h.jsxs(
          "button",
          {
            className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg transition-colors hover:bg-accent",
            onClick: C,
            children: [
              /* @__PURE__ */ h.jsx(Uc, { size: 14 }),
              ""
            ]
          }
        ),
        /* @__PURE__ */ h.jsxs(
          "button",
          {
            className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg transition-colors disabled:opacity-50",
            onClick: N,
            disabled: n || (e == null ? void 0 : e.isSummarizing),
            children: [
              /* @__PURE__ */ h.jsx(zn, { size: 14, className: n ? "animate-spin" : "" }),
              n ? "..." : ""
            ]
          }
        )
      ] }),
      /* @__PURE__ */ h.jsxs("div", { className: "pt-6 space-y-6", children: [
        /* @__PURE__ */ h.jsx(Fn, { length: 100 }),
        /* @__PURE__ */ h.jsxs("div", { className: "grid grid-cols-2 gap-4", children: [
          /* @__PURE__ */ h.jsxs("div", { className: "flex items-center justify-between", children: [
            /* @__PURE__ */ h.jsx("span", { className: "text-sm text-foreground", children: "" }),
            /* @__PURE__ */ h.jsx(
              Ei,
              {
                label: "",
                checked: l.autoEnabled,
                onChange: async (G) => {
                  u((q) => ({ ...q, autoEnabled: G }));
                  const { summarizerService: re } = await Promise.resolve().then(() => Ki);
                  re.updateConfig({ enabled: G });
                }
              }
            )
          ] }),
          /* @__PURE__ */ h.jsxs("div", { className: "flex items-center justify-between", children: [
            /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col", children: [
              /* @__PURE__ */ h.jsx("span", { className: "text-sm text-foreground", children: "" }),
              /* @__PURE__ */ h.jsx("span", { className: "text-[10px] text-muted-foreground", children: "" })
            ] }),
            /* @__PURE__ */ h.jsx(
              Ei,
              {
                label: "",
                checked: l.autoHide,
                onChange: (G) => {
                  u((re) => ({ ...re, autoHide: G })), Promise.resolve().then(() => Ki).then(({ summarizerService: re }) => {
                    re.updateConfig({ autoHide: G });
                  });
                }
              }
            )
          ] })
        ] }),
        l.autoEnabled && /* @__PURE__ */ h.jsx(h.Fragment, { children: /* @__PURE__ */ h.jsxs("div", { className: "grid grid-cols-2 gap-6", children: [
          /* @__PURE__ */ h.jsxs("div", { className: "space-y-3", children: [
            /* @__PURE__ */ h.jsxs("div", { className: "text-xs text-muted-foreground", children: [
              " ",
              /* @__PURE__ */ h.jsx("span", { className: "text-base font-medium text-foreground mx-0.5", children: l.floorInterval }),
              " "
            ] }),
            /* @__PURE__ */ h.jsxs("div", { className: "relative h-4 flex items-center group cursor-pointer", children: [
              /* @__PURE__ */ h.jsx("div", { className: "absolute inset-x-0 h-[1px]", style: { backgroundColor: "var(--border)" } }),
              /* @__PURE__ */ h.jsx(
                "div",
                {
                  className: "absolute top-1/2 -translate-y-1/2 w-2.5 h-2.5 bg-muted-foreground/80 rounded-full shadow-sm pointer-events-none transition-transform duration-75 ease-out group-hover:scale-125 group-hover:bg-foreground",
                  style: { left: `${(l.floorInterval - 5) / 95 * 100}%`, transform: "translate(-50%, -50%)" }
                }
              ),
              /* @__PURE__ */ h.jsx(
                "input",
                {
                  type: "range",
                  min: 5,
                  max: 100,
                  step: 5,
                  value: l.floorInterval,
                  onChange: async (G) => {
                    const re = Number(G.target.value);
                    u((W) => ({ ...W, floorInterval: re }));
                    const { summarizerService: q } = await Promise.resolve().then(() => Ki);
                    q.updateConfig({ floorInterval: re });
                  },
                  className: "absolute inset-x-0 w-full h-full opacity-0 cursor-pointer z-10 m-0",
                  style: { appearance: "none", WebkitAppearance: "none" }
                }
              )
            ] })
          ] }),
          /* @__PURE__ */ h.jsxs("div", { className: "space-y-3", children: [
            /* @__PURE__ */ h.jsxs("div", { className: "text-xs text-muted-foreground", children: [
              " ",
              /* @__PURE__ */ h.jsx("span", { className: "text-base font-medium text-foreground mx-0.5", children: l.bufferSize }),
              " "
            ] }),
            /* @__PURE__ */ h.jsxs("div", { className: "relative h-4 flex items-center group cursor-pointer", children: [
              /* @__PURE__ */ h.jsx("div", { className: "absolute inset-x-0 h-[1px]", style: { backgroundColor: "var(--border)" } }),
              /* @__PURE__ */ h.jsx(
                "div",
                {
                  className: "absolute top-1/2 -translate-y-1/2 w-2.5 h-2.5 bg-muted-foreground/80 rounded-full shadow-sm pointer-events-none transition-transform duration-75 ease-out group-hover:scale-125 group-hover:bg-foreground",
                  style: { left: `${l.bufferSize / 20 * 100}%`, transform: "translate(-50%, -50%)" }
                }
              ),
              /* @__PURE__ */ h.jsx(
                "input",
                {
                  type: "range",
                  min: 0,
                  max: 20,
                  step: 1,
                  value: l.bufferSize,
                  onChange: (G) => {
                    const re = Number(G.target.value);
                    u((q) => ({ ...q, bufferSize: re })), Promise.resolve().then(() => Ki).then(({ summarizerService: q }) => {
                      q.updateConfig({ bufferSize: re });
                    });
                  },
                  className: "absolute inset-x-0 w-full h-full opacity-0 cursor-pointer z-10 m-0",
                  style: { appearance: "none", WebkitAppearance: "none" }
                }
              )
            ] })
          ] })
        ] }) })
      ] }),
      /* @__PURE__ */ h.jsx("div", { className: "flex justify-end", children: /* @__PURE__ */ h.jsxs(
        "button",
        {
          className: "inline-flex items-center gap-2 px-3 py-1.5 text-xs text-red-500 hover:text-red-400 border border-red-500/30 hover:border-red-500/50 hover:bg-red-500/10 rounded transition-colors",
          onClick: A,
          disabled: n,
          title: " ()",
          children: [
            /* @__PURE__ */ h.jsx(zn, { size: 12, className: n ? "animate-spin" : "" }),
            ""
          ]
        }
      ) })
    ] }),
    /* @__PURE__ */ h.jsxs("section", { className: "space-y-6 lg:pl-8 relative", children: [
      /* @__PURE__ */ h.jsx(Fn, { responsive: !0, length: 30 }),
      /* @__PURE__ */ h.jsxs("div", { className: "flex items-center justify-between", children: [
        /* @__PURE__ */ h.jsxs("div", { children: [
          /* @__PURE__ */ h.jsx("h2", { className: "text-sm font-medium text-foreground", children: "" }),
          /* @__PURE__ */ h.jsx("p", { className: "text-xs text-muted-foreground mt-0.5", children: "" })
        ] }),
        /* @__PURE__ */ h.jsx(
          Ei,
          {
            label: "",
            checked: f.enabled ?? !1,
            onChange: Y
          }
        )
      ] }),
      /* @__PURE__ */ h.jsxs("div", { className: `space-y-6 transition-opacity ${f.enabled ? "opacity-100" : "opacity-40 pointer-events-none"}`, children: [
        /* @__PURE__ */ h.jsxs("div", { className: "space-y-3", children: [
          /* @__PURE__ */ h.jsx("span", { className: "text-xs text-muted-foreground", children: "" }),
          /* @__PURE__ */ h.jsx("div", { className: "flex gap-6", children: Bee.map((G) => /* @__PURE__ */ h.jsxs(
            "label",
            {
              className: "flex items-center gap-2 cursor-pointer group",
              onClick: () => D(G.id),
              children: [
                /* @__PURE__ */ h.jsx(
                  "span",
                  {
                    className: `w-4 h-4 rounded-full border-2 flex items-center justify-center transition-colors
                                        ${f.trigger === G.id ? "border-primary bg-primary" : "border-border group-hover:border-muted-foreground"}`,
                    children: f.trigger === G.id && /* @__PURE__ */ h.jsx("span", { className: "w-1.5 h-1.5 rounded-full bg-primary-foreground" })
                  }
                ),
                /* @__PURE__ */ h.jsx("span", { className: `text-sm transition-colors ${f.trigger === G.id ? "text-foreground" : "text-muted-foreground"}`, children: G.label })
              ]
            },
            G.id
          )) })
        ] }),
        /* @__PURE__ */ h.jsxs("div", { className: "space-y-3", children: [
          /* @__PURE__ */ h.jsx("div", { className: "text-xs text-muted-foreground", children: B.label === "Token " ? /* @__PURE__ */ h.jsxs(h.Fragment, { children: [
            " Token  ",
            /* @__PURE__ */ h.jsx("span", { className: "text-base font-medium text-foreground mx-0.5", children: B.value }),
            " "
          ] }) : /* @__PURE__ */ h.jsxs(h.Fragment, { children: [
            " ",
            /* @__PURE__ */ h.jsx("span", { className: "text-base font-medium text-foreground mx-0.5", children: B.value }),
            " "
          ] }) }),
          /* @__PURE__ */ h.jsxs("div", { className: "relative h-4 flex items-center group cursor-pointer", children: [
            /* @__PURE__ */ h.jsx("div", { className: "absolute inset-x-0 h-[1px]", style: { backgroundColor: "var(--border)" } }),
            /* @__PURE__ */ h.jsx(
              "div",
              {
                className: "absolute top-1/2 -translate-y-1/2 w-2.5 h-2.5 bg-muted-foreground/80 rounded-full shadow-sm pointer-events-none transition-transform duration-75 ease-out group-hover:scale-125 group-hover:bg-foreground",
                style: { left: `${(B.value - B.min) / (B.max - B.min) * 100}%`, transform: "translate(-50%, -50%)" }
              }
            ),
            /* @__PURE__ */ h.jsx(
              "input",
              {
                type: "range",
                min: B.min,
                max: B.max,
                step: B.step,
                value: B.value,
                onChange: (G) => {
                  const re = Number(G.target.value), q = f.trigger === "token" ? "tokenLimit" : "countLimit";
                  M(q, re);
                },
                className: "absolute inset-x-0 w-full h-full opacity-0 cursor-pointer z-10 m-0",
                style: { appearance: "none", WebkitAppearance: "none" }
              }
            )
          ] })
        ] }),
        /* @__PURE__ */ h.jsxs("div", { className: "space-y-3", children: [
          /* @__PURE__ */ h.jsxs("div", { className: "text-xs text-muted-foreground", children: [
            " ",
            /* @__PURE__ */ h.jsx("span", { className: "text-base font-medium text-foreground mx-0.5", children: f.keepRecentCount ?? 3 }),
            " "
          ] }),
          /* @__PURE__ */ h.jsxs("div", { className: "relative h-4 flex items-center group cursor-pointer", children: [
            /* @__PURE__ */ h.jsx("div", { className: "absolute inset-x-0 h-[1px]", style: { backgroundColor: "var(--border)" } }),
            /* @__PURE__ */ h.jsx(
              "div",
              {
                className: "absolute top-1/2 -translate-y-1/2 w-2.5 h-2.5 bg-muted-foreground/80 rounded-full shadow-sm pointer-events-none transition-transform duration-75 ease-out group-hover:scale-125 group-hover:bg-foreground",
                style: { left: `${(f.keepRecentCount ?? 3) / 10 * 100}%`, transform: "translate(-50%, -50%)" }
              }
            ),
            /* @__PURE__ */ h.jsx(
              "input",
              {
                type: "range",
                min: 0,
                max: 10,
                step: 1,
                value: f.keepRecentCount ?? 3,
                onChange: (G) => M("keepRecentCount", Number(G.target.value)),
                className: "absolute inset-x-0 w-full h-full opacity-0 cursor-pointer z-10 m-0",
                style: { appearance: "none", WebkitAppearance: "none" }
              }
            )
          ] })
        ] }),
        m && /* @__PURE__ */ h.jsxs("div", { className: "text-xs text-muted-foreground space-y-1", children: [
          /* @__PURE__ */ h.jsxs("div", { className: "flex justify-between", children: [
            /* @__PURE__ */ h.jsx("span", { children: ":" }),
            /* @__PURE__ */ h.jsx("span", { className: "font-mono", children: m.pendingEntryCount })
          ] }),
          /* @__PURE__ */ h.jsxs("div", { className: "flex justify-between", children: [
            /* @__PURE__ */ h.jsxs("span", { children: [
              "",
              f.trigger === "token" ? "Token" : "",
              ":"
            ] }),
            /* @__PURE__ */ h.jsxs("span", { className: `font-mono ${m.triggered ? "text-amber-500" : ""}`, children: [
              m.currentValue,
              " / ",
              B.value
            ] })
          ] })
        ] }),
        /* @__PURE__ */ h.jsxs(
          "button",
          {
            type: "button",
            className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg hover:bg-accent transition-colors disabled:opacity-50",
            onClick: X,
            disabled: a || ((m == null ? void 0 : m.pendingEntryCount) ?? 0) < 2,
            children: [
              /* @__PURE__ */ h.jsx(nO, { size: 14, className: a ? "animate-pulse" : "" }),
              a ? "..." : ""
            ]
          }
        ),
        /* @__PURE__ */ h.jsx("p", { className: "text-xs text-muted-foreground/70 leading-relaxed", children: " Token " })
      ] })
    ] })
  ] });
}, $ee = () => {
  const [e, t] = P.useState({ total: 0, embedded: 0, pending: 0 }), [n, r] = P.useState(null), [a, o] = P.useState(!1), [l, u] = P.useState(!0), [f, d] = P.useState(null), [m, p] = P.useState(null), [x, y] = P.useState({ ...c_ }), [w, E] = P.useState(null);
  P.useEffect(() => {
    k();
  }, []);
  const k = async () => {
    u(!0), d(null);
    try {
      const Y = We.get("apiSettings");
      Y != null && Y.vectorConfig && (E(Y.vectorConfig), Bn.setConfig(Y.vectorConfig)), Y != null && Y.embeddingConfig && y({ ...c_, ...Y.embeddingConfig });
      const X = await Bn.getEmbeddingStats();
      t(X);
    } catch (Y) {
      d(Y.message || "");
    } finally {
      u(!1);
    }
  }, C = P.useCallback(async () => {
    const Y = await Bn.getEmbeddingStats();
    t(Y);
  }, []), T = async () => {
    if (!w) {
      d("");
      return;
    }
    o(!0), r({ current: 0, total: e.pending, errors: 0 }), d(null), p(null);
    try {
      Bn.setConfig(w), Bn.setConcurrency(x.concurrency);
      const Y = await Bn.embedUnprocessedEvents((X, U, B) => {
        r({ current: X, total: U, errors: B });
      });
      p(Y), await C();
    } catch (Y) {
      d(Y.message || "");
    } finally {
      o(!1), r(null);
    }
  }, N = () => {
    Bn.stop();
  }, A = async () => {
    if (!w) {
      d("");
      return;
    }
    if (confirm("")) {
      o(!0), r({ current: 0, total: e.total, errors: 0 }), d(null), p(null);
      try {
        Bn.setConfig(w), Bn.setConcurrency(x.concurrency);
        const Y = await Bn.reembedAllEvents((X, U, B) => {
          r({ current: X, total: U, errors: B });
        });
        p(Y), await C();
      } catch (Y) {
        d(Y.message || "");
      } finally {
        o(!1), r(null);
      }
    }
  }, D = (Y) => {
    const X = { ...x, ...Y };
    y(X);
    const U = We.get("apiSettings");
    U && We.set("apiSettings", {
      ...U,
      embeddingConfig: X
    });
  }, M = n && n.total > 0 ? Math.round(n.current / n.total * 100) : 0, O = w && (w.source === "transformers" || w.model);
  return l ? /* @__PURE__ */ h.jsxs("div", { className: "flex items-center justify-center h-48 text-muted-foreground gap-2", children: [
    /* @__PURE__ */ h.jsx(Ka, { size: 20, className: "animate-spin" }),
    /* @__PURE__ */ h.jsx("span", { className: "text-sm font-light", children: "..." })
  ] }) : /* @__PURE__ */ h.jsxs("div", { className: "py-4", children: [
    /* @__PURE__ */ h.jsxs("div", { className: "grid grid-cols-3 gap-4 mb-6", children: [
      /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col gap-1", children: [
        /* @__PURE__ */ h.jsx("span", { className: "text-xs text-muted-foreground uppercase tracking-wider", children: "" }),
        /* @__PURE__ */ h.jsx("span", { className: "text-2xl font-light", children: e.total })
      ] }),
      /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col gap-1", children: [
        /* @__PURE__ */ h.jsx("span", { className: "text-xs text-muted-foreground uppercase tracking-wider", children: "" }),
        /* @__PURE__ */ h.jsx("span", { className: "text-2xl font-light text-primary", children: e.embedded })
      ] }),
      /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col gap-1", children: [
        /* @__PURE__ */ h.jsx("span", { className: "text-xs text-muted-foreground uppercase tracking-wider", children: "" }),
        /* @__PURE__ */ h.jsx("span", { className: "text-2xl font-light text-warning", children: e.pending })
      ] })
    ] }),
    n && /* @__PURE__ */ h.jsxs("div", { className: "mb-6 p-4 bg-muted/30 rounded-lg", children: [
      /* @__PURE__ */ h.jsxs("div", { className: "flex items-center justify-between mb-2", children: [
        /* @__PURE__ */ h.jsxs("span", { className: "text-sm text-muted-foreground", children: [
          " ",
          n.current,
          "/",
          n.total
        ] }),
        /* @__PURE__ */ h.jsxs("span", { className: "text-sm font-medium", children: [
          M,
          "%"
        ] })
      ] }),
      /* @__PURE__ */ h.jsx("div", { className: "h-2 bg-muted rounded-full overflow-hidden", children: /* @__PURE__ */ h.jsx(
        "div",
        {
          className: "h-full bg-primary transition-all duration-300",
          style: { width: `${M}%` }
        }
      ) }),
      n.errors > 0 && /* @__PURE__ */ h.jsxs("p", { className: "text-xs text-destructive mt-2", children: [
        n.errors,
        " "
      ] })
    ] }),
    m && /* @__PURE__ */ h.jsxs("div", { className: `mb-6 p-3 rounded-lg flex items-center gap-2 ${m.failed > 0 ? "bg-warning/10 text-warning" : "bg-primary/10 text-primary"}`, children: [
      m.failed > 0 ? /* @__PURE__ */ h.jsx(Fs, { size: 16 }) : /* @__PURE__ */ h.jsx(Oh, { size: 16 }),
      /* @__PURE__ */ h.jsxs("span", { className: "text-sm", children: [
        "",
        m.success,
        " ",
        m.failed > 0 && `${m.failed} `
      ] })
    ] }),
    f && /* @__PURE__ */ h.jsxs("div", { className: "mb-6 p-3 bg-destructive/10 text-destructive rounded-lg flex items-center gap-2", children: [
      /* @__PURE__ */ h.jsx(Fs, { size: 16 }),
      /* @__PURE__ */ h.jsx("span", { className: "text-sm", children: f })
    ] }),
    !O && /* @__PURE__ */ h.jsx("div", { className: "mb-6 p-3 bg-muted/50 rounded-lg", children: /* @__PURE__ */ h.jsxs("p", { className: "text-sm text-muted-foreground", children: [
      "",
      /* @__PURE__ */ h.jsx("span", { className: "text-primary mx-1", children: "API     " }),
      ""
    ] }) }),
    /* @__PURE__ */ h.jsx("div", { className: "flex flex-wrap gap-3 mb-6", children: a ? /* @__PURE__ */ h.jsxs(
      "button",
      {
        onClick: N,
        className: "inline-flex items-center gap-2 px-4 py-2 bg-destructive text-destructive-foreground rounded-md hover:bg-destructive/90 transition-colors",
        children: [
          /* @__PURE__ */ h.jsx(cj, { size: 16 }),
          ""
        ]
      }
    ) : /* @__PURE__ */ h.jsxs(h.Fragment, { children: [
      /* @__PURE__ */ h.jsxs(
        "button",
        {
          onClick: T,
          disabled: e.pending === 0 || !O,
          className: "inline-flex items-center gap-2 px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",
          children: [
            /* @__PURE__ */ h.jsx(Uc, { size: 16 }),
            " (",
            e.pending,
            ")"
          ]
        }
      ),
      /* @__PURE__ */ h.jsxs(
        "button",
        {
          onClick: A,
          disabled: e.total === 0 || !O,
          className: "inline-flex items-center gap-2 px-4 py-2 border border-border text-foreground rounded-md hover:bg-muted transition-colors disabled:opacity-50 disabled:cursor-not-allowed",
          children: [
            /* @__PURE__ */ h.jsx(zn, { size: 16 }),
            ""
          ]
        }
      ),
      /* @__PURE__ */ h.jsx(
        "button",
        {
          onClick: C,
          className: "inline-flex items-center gap-2 px-3 py-2 text-muted-foreground hover:text-foreground transition-colors",
          children: /* @__PURE__ */ h.jsx(zn, { size: 16 })
        }
      )
    ] }) }),
    /* @__PURE__ */ h.jsx(Fn, { className: "my-6" }),
    /* @__PURE__ */ h.jsxs("div", { className: "space-y-4", children: [
      /* @__PURE__ */ h.jsx("h3", { className: "text-sm font-medium text-muted-foreground uppercase tracking-wider", children: "" }),
      /* @__PURE__ */ h.jsx(
        Ei,
        {
          label: "",
          checked: x.enabled,
          onChange: (Y) => D({ enabled: Y }),
          description: ""
        }
      ),
      /* @__PURE__ */ h.jsx(
        Ua,
        {
          label: "",
          value: x.trigger,
          onChange: (Y) => D({ trigger: Y }),
          options: [
            { value: "with_trim", label: " Trim " },
            { value: "standalone", label: "" },
            { value: "manual", label: "" }
          ],
          description: "with_trim: Trim  | standalone: "
        }
      ),
      /* @__PURE__ */ h.jsx(
        er,
        {
          label: "",
          value: x.concurrency,
          onChange: (Y) => D({ concurrency: Math.max(1, Math.min(20, Y)) }),
          min: 1,
          max: 20,
          description: " (1-20)"
        }
      ),
      w && /* @__PURE__ */ h.jsxs("div", { className: "p-3 bg-muted/30 rounded-lg", children: [
        /* @__PURE__ */ h.jsx("p", { className: "text-xs text-muted-foreground mb-1", children: "" }),
        /* @__PURE__ */ h.jsxs("p", { className: "text-sm", children: [
          /* @__PURE__ */ h.jsx("span", { className: "text-primary", children: w.source }),
          w.model && /* @__PURE__ */ h.jsxs("span", { className: "text-muted-foreground ml-2", children: [
            "/ ",
            w.model
          ] })
        ] })
      ] })
    ] })
  ] });
}, Uee = ({ config: e, onChange: t }) => {
  var r, a, o, l;
  const n = (u) => {
    const f = { ...e, ...u };
    t(f);
  };
  return /* @__PURE__ */ h.jsxs("div", { className: "space-y-6 animate-in fade-in slide-in-from-right-4 duration-500", children: [
    /* @__PURE__ */ h.jsx("div", { className: "bg-secondary/20 p-4 rounded-lg border border-border/50", children: /* @__PURE__ */ h.jsxs("div", { className: "flex items-center justify-between", children: [
      /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-3", children: [
        /* @__PURE__ */ h.jsx("div", { className: `p-2 rounded-md ${e.enabled ? "bg-primary/20 text-primary" : "bg-muted text-muted-foreground"}`, children: /* @__PURE__ */ h.jsx(aj, { size: 20 }) }),
        /* @__PURE__ */ h.jsxs("div", { children: [
          /* @__PURE__ */ h.jsx("div", { className: "font-medium", children: " RAG " }),
          /* @__PURE__ */ h.jsx("div", { className: "text-xs text-muted-foreground", children: "" })
        ] })
      ] }),
      /* @__PURE__ */ h.jsx(
        Jn,
        {
          checked: e.enabled,
          onChange: (u) => n({ enabled: u })
        }
      )
    ] }) }),
    /* @__PURE__ */ h.jsxs("div", { className: "space-y-4", children: [
      /* @__PURE__ */ h.jsx("h3", { className: "text-sm font-medium text-muted-foreground uppercase tracking-wider px-1", children: "" }),
      /* @__PURE__ */ h.jsxs("div", { className: "grid grid-cols-1 md:grid-cols-2 gap-4", children: [
        /* @__PURE__ */ h.jsxs("div", { className: `p-4 rounded-lg border transition-all ${e.useBruteForce ? "bg-primary/5 border-primary/30" : "bg-card border-border/50 hover:border-border"}`, children: [
          /* @__PURE__ */ h.jsxs("div", { className: "flex items-start justify-between mb-2", children: [
            /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-2 text-sm font-medium", children: [
              /* @__PURE__ */ h.jsx(Po, { size: 16, className: e.useBruteForce ? "text-primary" : "text-muted-foreground" }),
              " (Brute Force)"
            ] }),
            /* @__PURE__ */ h.jsx(
              Jn,
              {
                checked: e.useBruteForce,
                onChange: (u) => n({ useBruteForce: u })
              }
            )
          ] }),
          /* @__PURE__ */ h.jsx("p", { className: "text-xs text-muted-foreground leading-relaxed", children: "" })
        ] }),
        /* @__PURE__ */ h.jsxs("div", { className: `p-4 rounded-lg border transition-all ${e.useEmbedding ? "bg-primary/5 border-primary/30" : "bg-card border-border/50 hover:border-border"}`, children: [
          /* @__PURE__ */ h.jsxs("div", { className: "flex items-start justify-between mb-2", children: [
            /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-2 text-sm font-medium", children: [
              /* @__PURE__ */ h.jsx(Dh, { size: 16, className: e.useEmbedding ? "text-primary" : "text-muted-foreground" }),
              " (Embedding)"
            ] }),
            /* @__PURE__ */ h.jsx(
              Jn,
              {
                checked: e.useEmbedding,
                onChange: (u) => n({ useEmbedding: u })
              }
            )
          ] }),
          /* @__PURE__ */ h.jsx("p", { className: "text-xs text-muted-foreground leading-relaxed", children: "RAG " })
        ] }),
        /* @__PURE__ */ h.jsxs("div", { className: `p-4 rounded-lg border transition-all ${e.usePreprocessing ? "bg-primary/5 border-primary/30" : "bg-card border-border/50 hover:border-border"}`, children: [
          /* @__PURE__ */ h.jsxs("div", { className: "flex items-start justify-between mb-2", children: [
            /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-2 text-sm font-medium", children: [
              /* @__PURE__ */ h.jsx(BR, { size: 16, className: e.usePreprocessing ? "text-primary" : "text-muted-foreground" }),
              "LLM "
            ] }),
            /* @__PURE__ */ h.jsx(
              Jn,
              {
                checked: e.usePreprocessing,
                onChange: (u) => n({ usePreprocessing: u })
              }
            )
          ] }),
          /* @__PURE__ */ h.jsx("p", { className: "text-xs text-muted-foreground leading-relaxed", children: " LLM " })
        ] }),
        /* @__PURE__ */ h.jsxs("div", { className: `p-4 rounded-lg border transition-all ${e.useRerank ? "bg-primary/5 border-primary/30" : "bg-card border-border/50 hover:border-border"}`, children: [
          /* @__PURE__ */ h.jsxs("div", { className: "flex items-start justify-between mb-2", children: [
            /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-2 text-sm font-medium", children: [
              /* @__PURE__ */ h.jsx(v2, { size: 16, className: e.useRerank ? "text-primary" : "text-muted-foreground" }),
              "Rerank "
            ] }),
            /* @__PURE__ */ h.jsx(
              Jn,
              {
                checked: e.useRerank,
                disabled: !e.useEmbedding,
                onChange: (u) => n({ useRerank: u })
              }
            )
          ] }),
          /* @__PURE__ */ h.jsxs("p", { className: "text-xs text-muted-foreground leading-relaxed", children: [
            " Rerank ",
            !e.useEmbedding && /* @__PURE__ */ h.jsxs("span", { className: "text-yellow-500 block mt-1 text-[10px] flex items-center gap-1", children: [
              /* @__PURE__ */ h.jsx(dj, { size: 10 }),
              " "
            ] })
          ] })
        ] })
      ] })
    ] }),
    /* @__PURE__ */ h.jsxs("div", { className: "grid grid-cols-1 md:grid-cols-2 gap-6 pt-4 border-t border-border/30", children: [
      /* @__PURE__ */ h.jsx(
        er,
        {
          label: " (Top-K)",
          description: "",
          min: 1,
          max: 100,
          value: ((r = e.embedding) == null ? void 0 : r.topK) ?? 20,
          onChange: (u) => {
            var f;
            return n({
              embedding: {
                topK: u,
                minScoreThreshold: ((f = e.embedding) == null ? void 0 : f.minScoreThreshold) ?? 0.3
              }
            });
          }
        }
      ),
      /* @__PURE__ */ h.jsx(
        er,
        {
          label: "",
          description: " (0.0 - 1.0)",
          min: 0,
          max: 1,
          step: 0.05,
          value: ((a = e.embedding) == null ? void 0 : a.minScoreThreshold) ?? 0.3,
          onChange: (u) => {
            var f;
            return n({
              embedding: {
                topK: ((f = e.embedding) == null ? void 0 : f.topK) ?? 20,
                minScoreThreshold: u
              }
            });
          }
        }
      )
    ] }),
    /* @__PURE__ */ h.jsxs("div", { className: "space-y-4 pt-4 border-t border-border/30", children: [
      /* @__PURE__ */ h.jsxs("div", { className: "flex items-center justify-between", children: [
        /* @__PURE__ */ h.jsx("h3", { className: "text-sm font-medium text-muted-foreground uppercase tracking-wider", children: " (Sticky)" }),
        /* @__PURE__ */ h.jsx(
          Jn,
          {
            checked: ((o = e.sticky) == null ? void 0 : o.enabled) ?? !0,
            onChange: (u) => n({
              sticky: {
                ...e.sticky || { decayFactor: 0.15, maxStickRounds: 3 },
                enabled: u
              }
            })
          }
        )
      ] }),
      ((l = e.sticky) == null ? void 0 : l.enabled) && /* @__PURE__ */ h.jsx("div", { className: "grid grid-cols-1 md:grid-cols-2 gap-6", children: /* @__PURE__ */ h.jsx(
        er,
        {
          label: "",
          description: " (0-1)",
          min: 0,
          max: 1,
          step: 0.05,
          value: e.sticky.decayFactor,
          onChange: (u) => n({
            sticky: { ...e.sticky, decayFactor: u }
          })
        }
      ) })
    ] })
  ] });
}, Hee = () => {
  const [e, t] = P.useState(Bh);
  P.useEffect(() => {
    const r = We.get("apiSettings");
    r != null && r.recallConfig && t(r.recallConfig);
  }, []);
  const n = (r) => {
    t(r);
    const a = We.get("apiSettings");
    a && (We.set("apiSettings", {
      ...a,
      recallConfig: r
    }), le.debug("RecallPanel", "", r));
  };
  return /* @__PURE__ */ h.jsx("div", { className: "p-1", children: /* @__PURE__ */ h.jsx(Uee, { config: e, onChange: n }) });
}, Gee = () => {
  const [e, t] = P.useState({ ...Nj, enabled: !1 }), [n, r] = P.useState(null), [a, o] = P.useState(!1), l = async () => {
    try {
      const m = await $a.getStatus();
      r(m), t($a.getConfig());
    } catch (m) {
      console.error("[EntityConfigPanel] Failed to load status:", m);
    }
  };
  P.useEffect(() => {
    l();
  }, []);
  const u = () => {
    const m = { ...e, enabled: !e.enabled };
    $a.updateConfig(m), t(m);
  }, f = (m) => {
    const p = { ...e, floorInterval: Math.max(10, m) };
    $a.updateConfig(p), t(p);
  }, d = async () => {
    o(!0);
    try {
      await $a.extractManual(), await l();
    } catch (m) {
      console.error("[EntityConfigPanel] Manual extraction failed:", m);
    } finally {
      o(!1);
    }
  };
  return /* @__PURE__ */ h.jsxs("div", { className: "grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-12", children: [
    /* @__PURE__ */ h.jsxs("section", { className: "space-y-8", children: [
      /* @__PURE__ */ h.jsxs("div", { children: [
        /* @__PURE__ */ h.jsxs("div", { className: "flex items-center justify-between mb-6", children: [
          /* @__PURE__ */ h.jsx("h2", { className: "text-xs font-medium text-muted-foreground uppercase tracking-wider", children: "" }),
          /* @__PURE__ */ h.jsx(
            "button",
            {
              className: "p-1 rounded text-muted-foreground hover:text-foreground transition-colors",
              onClick: l,
              title: "",
              children: /* @__PURE__ */ h.jsx(zn, { size: 14 })
            }
          )
        ] }),
        n ? /* @__PURE__ */ h.jsxs("div", { className: "space-y-6", children: [
          /* @__PURE__ */ h.jsxs("div", { className: "grid grid-cols-2 gap-6", children: [
            /* @__PURE__ */ h.jsxs("div", { children: [
              /* @__PURE__ */ h.jsx("span", { className: "text-xs text-muted-foreground block mb-1", children: "" }),
              /* @__PURE__ */ h.jsx("div", { className: `text-lg font-medium ${e.enabled ? "text-green-500" : "text-muted-foreground"}`, children: e.enabled ? "" : "" })
            ] }),
            /* @__PURE__ */ h.jsxs("div", { children: [
              /* @__PURE__ */ h.jsx("span", { className: "text-xs text-muted-foreground block mb-1", children: "" }),
              /* @__PURE__ */ h.jsx("div", { className: "text-3xl font-light text-primary font-mono", children: n.entityCount })
            ] })
          ] }),
          /* @__PURE__ */ h.jsx(Fn, { length: 100, spacing: "md" }),
          /* @__PURE__ */ h.jsxs("div", { className: "grid grid-cols-2 gap-6", children: [
            /* @__PURE__ */ h.jsxs("div", { children: [
              /* @__PURE__ */ h.jsx("span", { className: "text-[10px] text-muted-foreground/70 uppercase tracking-wider block mb-1", children: "" }),
              /* @__PURE__ */ h.jsx("div", { className: "text-xl font-mono text-foreground/80", children: n.floorInterval })
            ] }),
            /* @__PURE__ */ h.jsxs("div", { children: [
              /* @__PURE__ */ h.jsx("span", { className: "text-[10px] text-muted-foreground/70 uppercase tracking-wider block mb-1", children: "" }),
              /* @__PURE__ */ h.jsx("div", { className: "text-xl font-mono text-foreground/80", children: n.lastExtractedFloor })
            ] })
          ] })
        ] }) : /* @__PURE__ */ h.jsx("p", { className: "text-sm text-muted-foreground", children: "..." })
      ] }),
      /* @__PURE__ */ h.jsx("div", { className: "flex gap-3", children: /* @__PURE__ */ h.jsxs(
        "button",
        {
          onClick: d,
          disabled: a || (n == null ? void 0 : n.isExtracting) || !e.enabled,
          className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",
          children: [
            /* @__PURE__ */ h.jsx(zn, { size: 14, className: a ? "animate-spin" : "" }),
            a ? "..." : ""
          ]
        }
      ) })
    ] }),
    /* @__PURE__ */ h.jsxs("section", { className: "space-y-6 lg:pl-8 relative", children: [
      /* @__PURE__ */ h.jsx(Fn, { responsive: !0, length: 30 }),
      /* @__PURE__ */ h.jsxs("div", { className: "flex items-center justify-between", children: [
        /* @__PURE__ */ h.jsxs("div", { children: [
          /* @__PURE__ */ h.jsx("h2", { className: "text-sm font-medium text-foreground", children: "" }),
          /* @__PURE__ */ h.jsx("p", { className: "text-xs text-muted-foreground mt-0.5", children: "" })
        ] }),
        /* @__PURE__ */ h.jsx(
          Ei,
          {
            label: "",
            checked: e.enabled,
            onChange: u
          }
        )
      ] }),
      /* @__PURE__ */ h.jsxs("div", { className: `space-y-6 transition-opacity ${e.enabled ? "opacity-100" : "opacity-40 pointer-events-none"}`, children: [
        /* @__PURE__ */ h.jsxs("div", { className: "space-y-3", children: [
          /* @__PURE__ */ h.jsxs("div", { className: "text-xs text-muted-foreground", children: [
            " ",
            /* @__PURE__ */ h.jsx("span", { className: "text-base font-medium text-foreground mx-0.5", children: e.floorInterval }),
            " "
          ] }),
          /* @__PURE__ */ h.jsxs("div", { className: "relative h-4 flex items-center group cursor-pointer", children: [
            /* @__PURE__ */ h.jsx("div", { className: "absolute inset-x-0 h-[1px]", style: { backgroundColor: "var(--border)" } }),
            /* @__PURE__ */ h.jsx(
              "div",
              {
                className: "absolute top-1/2 -translate-y-1/2 w-2.5 h-2.5 bg-muted-foreground/80 rounded-full shadow-sm pointer-events-none transition-transform duration-75 ease-out group-hover:scale-125 group-hover:bg-foreground",
                style: { left: `${(e.floorInterval - 10) / 90 * 100}%`, transform: "translate(-50%, -50%)" }
              }
            ),
            /* @__PURE__ */ h.jsx(
              "input",
              {
                type: "range",
                min: 10,
                max: 100,
                step: 5,
                value: e.floorInterval,
                onChange: (m) => f(parseInt(m.target.value)),
                className: "absolute inset-x-0 w-full h-full opacity-0 cursor-pointer z-10 m-0",
                style: { appearance: "none", WebkitAppearance: "none" }
              }
            )
          ] })
        ] }),
        /* @__PURE__ */ h.jsx("p", { className: "text-xs text-muted-foreground/70 leading-relaxed", children: "" })
      ] })
    ] })
  ] });
}, Vee = {
  mode: "detailed",
  chunkSize: 2e3,
  overlapSize: 200
};
class Kee {
  constructor() {
    nt(this, "queue", {
      tasks: [],
      isRunning: !1,
      isPaused: !1,
      currentTaskIndex: 0,
      overallProgress: { current: 0, total: 0 }
    });
    nt(this, "onProgress");
    nt(this, "stopSignal", !1);
  }
  /**  */
  async analyzeHistory(t = 0, n) {
    const a = Wi.getStatus().currentFloor, o = n ?? a, l = Wi.getConfig(), u = $a.getConfig(), f = oh.getConfig(), d = o - t, m = l.floorInterval || 10, p = u.floorInterval || 50, x = Math.ceil(d / m), y = u.enabled ? Math.ceil(d / p) : 0, w = f.countLimit || 5, E = f.enabled ? Math.floor(x / w) : 0, k = x * 2, C = x * 2e3 + y * 2e3 + E * 2e3 + k * 200;
    return {
      currentFloor: a,
      startFloor: t,
      endFloor: o,
      summaryTasks: x,
      entityTasks: y,
      trimTasks: E,
      embedTasks: k,
      estimatedTokens: C
    };
  }
  /**  */
  buildQueue(t) {
    const n = [], { startFloor: r, endFloor: a, summaryTasks: o, entityTasks: l, trimTasks: u, embedTasks: f } = t, d = Wi.getConfig().floorInterval || 10, m = $a.getConfig().floorInterval || 50;
    for (let p = 0; p < o; p++) {
      const x = r + p * d, y = Math.min(x + d, a);
      n.push({
        id: Hl(),
        type: "summary",
        status: "pending",
        progress: { current: 0, total: 1 },
        floorRange: { start: x, end: y }
      });
    }
    for (let p = 0; p < l; p++) {
      const x = r + p * m, y = Math.min(x + m, a);
      n.push({
        id: Hl(),
        type: "entity",
        status: "pending",
        progress: { current: 0, total: 1 },
        floorRange: { start: x, end: y }
      });
    }
    for (let p = 0; p < u; p++)
      n.push({
        id: Hl(),
        type: "trim",
        status: "pending",
        progress: { current: 0, total: 1 }
      });
    return n.push({
      id: Hl(),
      type: "embed",
      status: "pending",
      progress: { current: 0, total: f }
    }), n;
  }
  /**  */
  async start(t = 0, n, r) {
    if (this.queue.isRunning) {
      le.warn("BatchProcessor", "Already running");
      return;
    }
    this.onProgress = r, this.stopSignal = !1;
    const a = await this.analyzeHistory(t, n);
    this.queue.tasks = this.buildQueue(a), this.queue.isRunning = !0, this.queue.isPaused = !1, this.queue.currentTaskIndex = 0, this.queue.overallProgress = { current: 0, total: this.queue.tasks.length }, le.info("BatchProcessor", `Starting: ${this.queue.tasks.length} tasks`), this.notifyProgress(), await this.runQueue();
  }
  /**  */
  async runQueue() {
    for (; this.queue.currentTaskIndex < this.queue.tasks.length; ) {
      if (this.stopSignal) {
        le.info("BatchProcessor", "Stopped by user");
        break;
      }
      if (this.queue.isPaused) {
        await new Promise((n) => setTimeout(n, 500));
        continue;
      }
      const t = this.queue.tasks[this.queue.currentTaskIndex];
      t.status = "running", this.notifyProgress();
      try {
        await this.executeTask(t), t.status = "done", t.progress.current = t.progress.total;
      } catch (n) {
        t.status = "error", t.error = String(n), le.error("BatchProcessor", `Task ${t.type} failed: ${String(n)}`);
      }
      this.queue.currentTaskIndex++, this.queue.overallProgress.current = this.queue.currentTaskIndex, this.notifyProgress();
    }
    this.queue.isRunning = !1, le.info("BatchProcessor", "Completed"), this.notifyProgress();
  }
  /**  */
  async executeTask(t) {
    switch (t.type) {
      case "summary":
        await this.executeSummaryTask(t);
        break;
      case "entity":
        await this.executeEntityTask(t);
        break;
      case "trim":
        await this.executeTrimTask(t);
        break;
      case "embed":
        await this.executeEmbedTask(t);
        break;
    }
  }
  async executeSummaryTask(t) {
    if (!t.floorRange) return;
    await Wi.setLastSummarizedFloor(t.floorRange.start), await Wi.triggerSummary(!0) || (t.status = "skipped");
  }
  async executeEntityTask(t) {
    if (!t.floorRange) return;
    await $a.extractManual() || (t.status = "skipped");
  }
  async executeTrimTask(t) {
    const { canTrim: n } = await oh.canTrim();
    n ? await oh.trim(!0) : t.status = "skipped";
  }
  async executeEmbedTask(t) {
    const n = await Bn.embedUnprocessedEvents((r, a) => {
      t.progress.current = r, t.progress.total = a, this.notifyProgress();
    });
    t.progress.current = n.success;
  }
  pause() {
    this.queue.isPaused = !0, le.info("BatchProcessor", "Paused"), this.notifyProgress();
  }
  resume() {
    this.queue.isPaused = !1, le.info("BatchProcessor", "Resumed"), this.notifyProgress();
  }
  stop() {
    this.stopSignal = !0, this.queue.isPaused = !1, le.info("BatchProcessor", "Stopping...");
  }
  reset() {
    this.stopSignal = !0, this.queue = {
      tasks: [],
      isRunning: !1,
      isPaused: !1,
      currentTaskIndex: 0,
      overallProgress: { current: 0, total: 0 }
    }, this.notifyProgress();
  }
  getQueue() {
    return { ...this.queue };
  }
  notifyProgress() {
    this.onProgress && this.onProgress({ ...this.queue });
  }
  // ====================  txt  ====================
  chunkText(t, n, r) {
    const a = [];
    let o = 0;
    for (; o < t.length; ) {
      const l = Math.min(o + n, t.length);
      if (a.push(t.slice(o, l)), o = l - r, o >= t.length - r) break;
    }
    return a;
  }
  async importText(t, n = Vee, r) {
    const a = this.chunkText(t, n.chunkSize, n.overlapSize), o = yr.getState();
    await o.initChat();
    let l = 0, u = 0;
    this.queue = {
      tasks: [{
        id: Hl(),
        type: "embed",
        status: "running",
        progress: { current: 0, total: a.length }
      }],
      isRunning: !0,
      isPaused: !1,
      currentTaskIndex: 0,
      overallProgress: { current: 0, total: a.length }
    }, this.onProgress = r, this.stopSignal = !1, this.notifyProgress();
    for (let f = 0; f < a.length && !this.stopSignal; f++) {
      const d = a[f];
      try {
        let m = d;
        n.mode === "detailed" && (m = d);
        const p = await o.saveEvent({
          summary: m,
          structured_kv: {
            time_anchor: "",
            role: [],
            location: "",
            event: ` #${f + 1}`,
            logic: [],
            causality: ""
          },
          significance_score: 5,
          level: 0,
          is_embedded: !1,
          is_archived: !1,
          source_range: { start_index: f, end_index: f }
        });
        await Bn.embedEvent(p), l++;
      } catch (m) {
        le.error("BatchProcessor", `Import chunk ${f} failed: ${String(m)}`), u++;
      }
      this.queue.tasks[0].progress.current = f + 1, this.queue.overallProgress.current = f + 1, this.notifyProgress();
    }
    return this.queue.isRunning = !1, this.queue.tasks[0].status = "done", this.notifyProgress(), le.info("BatchProcessor", `Import completed: ${l} success, ${u} failed`), { success: l, failed: u };
  }
}
const vo = new Kee(), Yee = ({ status: e }) => {
  switch (e) {
    case "done":
      return /* @__PURE__ */ h.jsx(Oh, { size: 14, className: "text-green-500" });
    case "error":
      return /* @__PURE__ */ h.jsx(JR, { size: 14, className: "text-red-500" });
    case "running":
      return /* @__PURE__ */ h.jsx(zn, { size: 14, className: "text-primary animate-spin" });
    case "skipped":
      return /* @__PURE__ */ h.jsx(lh, { size: 14, className: "text-muted-foreground" });
    default:
      return /* @__PURE__ */ h.jsx(lh, { size: 14, className: "text-muted-foreground/50" });
  }
}, Xee = {
  summary: "",
  entity: "",
  trim: "",
  embed: ""
}, Wee = () => {
  const e = P.useRef(null), [t, n] = P.useState(null), [r, a] = P.useState(null), [o, l] = P.useState(!1), [u, f] = P.useState(0), [d, m] = P.useState(Wi.getStatus().currentFloor), [p, x] = P.useState("detailed"), [y, w] = P.useState(2e3), [E, k] = P.useState(200), [C, T] = P.useState(""), [N, A] = P.useState(null), D = P.useCallback(async () => {
    l(!0);
    try {
      const q = await vo.analyzeHistory(u, d);
      n(q), m(q.endFloor);
    } catch (q) {
      console.error("[BatchPanel] Analyze failed:", q);
    } finally {
      l(!1);
    }
  }, [u, d]), M = P.useCallback(async () => {
    t && await vo.start(t.startFloor, t.endFloor, (q) => a({ ...q }));
  }, [t]), O = P.useCallback(() => {
    r != null && r.isPaused ? vo.resume() : vo.pause();
  }, [r]), Y = P.useCallback(() => vo.stop(), []), X = P.useCallback(() => {
    vo.reset(), a(null), n(null);
  }, []), U = P.useCallback(async () => {
    if (!C.trim()) return;
    const q = await vo.importText(
      C,
      { mode: p, chunkSize: y, overlapSize: E },
      (W) => {
        W.tasks[0] && A(W.tasks[0].progress);
      }
    );
    A(null), alert(`${q.success} ${q.failed} `);
  }, [C, p, y, E]), B = P.useCallback((q) => {
    var ee;
    const W = (ee = q.target.files) == null ? void 0 : ee[0];
    if (!W) return;
    const V = new FileReader();
    V.onload = (te) => {
      var ie;
      return T(((ie = te.target) == null ? void 0 : ie.result) || "");
    }, V.readAsText(W);
  }, []), G = P.useCallback(() => {
    var q;
    (q = e.current) == null || q.click();
  }, []), re = r != null && r.overallProgress ? Math.round(r.overallProgress.current / r.overallProgress.total * 100) : 0;
  return /* @__PURE__ */ h.jsxs("div", { className: "grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-12", children: [
    /* @__PURE__ */ h.jsxs("section", { className: "space-y-6", children: [
      /* @__PURE__ */ h.jsxs("div", { children: [
        /* @__PURE__ */ h.jsx("h2", { className: "text-sm font-medium text-foreground mb-1", children: "" }),
        /* @__PURE__ */ h.jsx("p", { className: "text-xs text-muted-foreground", children: "" })
      ] }),
      /* @__PURE__ */ h.jsxs("div", { className: "grid grid-cols-2 gap-6", children: [
        /* @__PURE__ */ h.jsx(
          er,
          {
            label: "",
            value: u,
            onChange: f,
            min: 0,
            max: d,
            step: 1,
            showSlider: !1
          }
        ),
        /* @__PURE__ */ h.jsx(
          er,
          {
            label: "",
            value: d,
            onChange: m,
            min: u,
            step: 1,
            showSlider: !1
          }
        )
      ] }),
      /* @__PURE__ */ h.jsxs(
        "button",
        {
          className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg transition-colors disabled:opacity-50",
          onClick: D,
          disabled: o || (r == null ? void 0 : r.isRunning),
          children: [
            /* @__PURE__ */ h.jsx(zn, { size: 14, className: o ? "animate-spin" : "" }),
            o ? "..." : ""
          ]
        }
      ),
      t && /* @__PURE__ */ h.jsxs(h.Fragment, { children: [
        /* @__PURE__ */ h.jsx(Fn, { length: 100, spacing: "md" }),
        /* @__PURE__ */ h.jsxs("div", { className: "space-y-4", children: [
          /* @__PURE__ */ h.jsx("h3", { className: "text-xs font-medium text-muted-foreground uppercase tracking-wider", children: "" }),
          /* @__PURE__ */ h.jsxs("div", { className: "space-y-2 text-sm", children: [
            /* @__PURE__ */ h.jsxs("div", { className: "flex justify-between", children: [
              /* @__PURE__ */ h.jsx("span", { className: "text-muted-foreground", children: " " }),
              /* @__PURE__ */ h.jsxs("span", { className: "font-mono text-foreground", children: [
                t.summaryTasks,
                " "
              ] })
            ] }),
            /* @__PURE__ */ h.jsxs("div", { className: "flex justify-between", children: [
              /* @__PURE__ */ h.jsx("span", { className: "text-muted-foreground", children: " " }),
              /* @__PURE__ */ h.jsxs("span", { className: "font-mono text-foreground", children: [
                t.entityTasks,
                " "
              ] })
            ] }),
            /* @__PURE__ */ h.jsxs("div", { className: "flex justify-between", children: [
              /* @__PURE__ */ h.jsx("span", { className: "text-muted-foreground", children: " " }),
              /* @__PURE__ */ h.jsxs("span", { className: "font-mono text-foreground", children: [
                "~",
                t.trimTasks,
                " "
              ] })
            ] }),
            /* @__PURE__ */ h.jsxs("div", { className: "flex justify-between", children: [
              /* @__PURE__ */ h.jsx("span", { className: "text-muted-foreground", children: " " }),
              /* @__PURE__ */ h.jsxs("span", { className: "font-mono text-foreground", children: [
                "~",
                t.embedTasks,
                " "
              ] })
            ] }),
            /* @__PURE__ */ h.jsx(Fn, { length: 30, spacing: "sm" }),
            /* @__PURE__ */ h.jsxs("div", { className: "flex justify-between", children: [
              /* @__PURE__ */ h.jsx("span", { className: "text-muted-foreground", children: " Token" }),
              /* @__PURE__ */ h.jsxs("span", { className: "font-mono text-primary", children: [
                "~",
                (t.estimatedTokens / 1e3).toFixed(0),
                "k"
              ] })
            ] })
          ] })
        ] }),
        /* @__PURE__ */ h.jsxs("div", { className: "flex gap-3 flex-wrap", children: [
          r != null && r.isRunning ? /* @__PURE__ */ h.jsxs(h.Fragment, { children: [
            /* @__PURE__ */ h.jsxs(
              "button",
              {
                className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg transition-colors",
                onClick: O,
                children: [
                  r.isPaused ? /* @__PURE__ */ h.jsx(Uc, { size: 14 }) : /* @__PURE__ */ h.jsx(sj, { size: 14 }),
                  r.isPaused ? "" : ""
                ]
              }
            ),
            /* @__PURE__ */ h.jsxs(
              "button",
              {
                className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-red-400 hover:text-red-300 border border-red-500/30 rounded-lg transition-colors",
                onClick: Y,
                children: [
                  /* @__PURE__ */ h.jsx(cj, { size: 14 }),
                  ""
                ]
              }
            )
          ] }) : /* @__PURE__ */ h.jsxs(
            "button",
            {
              className: "inline-flex items-center gap-2 px-4 py-2 text-sm bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors",
              onClick: M,
              children: [
                /* @__PURE__ */ h.jsx(Uc, { size: 14 }),
                ""
              ]
            }
          ),
          r && !r.isRunning && /* @__PURE__ */ h.jsxs(
            "button",
            {
              className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg transition-colors",
              onClick: X,
              children: [
                /* @__PURE__ */ h.jsx(lj, { size: 14 }),
                ""
              ]
            }
          )
        ] }),
        r && /* @__PURE__ */ h.jsxs("div", { className: "space-y-3", children: [
          /* @__PURE__ */ h.jsx("div", { className: "h-1.5 bg-muted rounded-full overflow-hidden", children: /* @__PURE__ */ h.jsx(
            "div",
            {
              className: "h-full bg-primary transition-all duration-300",
              style: { width: `${re}%` }
            }
          ) }),
          /* @__PURE__ */ h.jsxs("div", { className: "text-xs text-muted-foreground text-center", children: [
            re,
            "% - ",
            r.currentTaskIndex,
            "/",
            r.overallProgress.total,
            " "
          ] }),
          /* @__PURE__ */ h.jsxs("div", { className: "space-y-1 max-h-40 overflow-y-auto", children: [
            r.tasks.slice(0, 10).map((q) => /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-2 text-xs", children: [
              /* @__PURE__ */ h.jsx(Yee, { status: q.status }),
              /* @__PURE__ */ h.jsx("span", { className: q.status === "running" ? "text-foreground" : "text-muted-foreground", children: Xee[q.type] || q.type }),
              q.floorRange && /* @__PURE__ */ h.jsxs("span", { className: "text-muted-foreground/50 font-mono", children: [
                "#",
                q.floorRange.start,
                "-",
                q.floorRange.end
              ] })
            ] }, q.id)),
            r.tasks.length > 10 && /* @__PURE__ */ h.jsxs("div", { className: "text-xs text-muted-foreground/50", children: [
              "... ",
              r.tasks.length - 10,
              " "
            ] })
          ] })
        ] })
      ] })
    ] }),
    /* @__PURE__ */ h.jsxs("section", { className: "space-y-6 lg:pl-8 relative", children: [
      /* @__PURE__ */ h.jsx(Fn, { responsive: !0, length: 30 }),
      /* @__PURE__ */ h.jsxs("div", { children: [
        /* @__PURE__ */ h.jsx("h2", { className: "text-sm font-medium text-foreground mb-1", children: "" }),
        /* @__PURE__ */ h.jsx("p", { className: "text-xs text-muted-foreground", children: "" })
      ] }),
      /* @__PURE__ */ h.jsxs("div", { className: "flex items-center gap-3", children: [
        /* @__PURE__ */ h.jsx(
          "input",
          {
            ref: e,
            type: "file",
            accept: ".txt,.md",
            onChange: B,
            className: "hidden"
          }
        ),
        /* @__PURE__ */ h.jsxs(
          "button",
          {
            className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg transition-colors",
            onClick: G,
            children: [
              /* @__PURE__ */ h.jsx(fj, { size: 14 }),
              ""
            ]
          }
        ),
        C && /* @__PURE__ */ h.jsxs("span", { className: "text-xs text-muted-foreground", children: [
          " ",
          (C.length / 1024).toFixed(1),
          " KB"
        ] })
      ] }),
      /* @__PURE__ */ h.jsxs("div", { className: "space-y-3", children: [
        /* @__PURE__ */ h.jsx("span", { className: "text-xs text-muted-foreground", children: "" }),
        /* @__PURE__ */ h.jsxs("div", { className: "space-y-2", children: [
          /* @__PURE__ */ h.jsxs("label", { className: "flex items-start gap-3 cursor-pointer group", onClick: () => x("fast"), children: [
            /* @__PURE__ */ h.jsx("span", { className: `mt-0.5 w-4 h-4 rounded-full border-2 flex items-center justify-center transition-colors ${p === "fast" ? "border-primary bg-primary" : "border-border group-hover:border-muted-foreground"}`, children: p === "fast" && /* @__PURE__ */ h.jsx("span", { className: "w-1.5 h-1.5 rounded-full bg-primary-foreground" }) }),
            /* @__PURE__ */ h.jsxs("div", { children: [
              /* @__PURE__ */ h.jsx("span", { className: `text-sm ${p === "fast" ? "text-foreground" : "text-muted-foreground"}`, children: "" }),
              /* @__PURE__ */ h.jsx("p", { className: "text-[10px] text-muted-foreground", children: "   LLM" })
            ] })
          ] }),
          /* @__PURE__ */ h.jsxs("label", { className: "flex items-start gap-3 cursor-pointer group", onClick: () => x("detailed"), children: [
            /* @__PURE__ */ h.jsx("span", { className: `mt-0.5 w-4 h-4 rounded-full border-2 flex items-center justify-center transition-colors ${p === "detailed" ? "border-primary bg-primary" : "border-border group-hover:border-muted-foreground"}`, children: p === "detailed" && /* @__PURE__ */ h.jsx("span", { className: "w-1.5 h-1.5 rounded-full bg-primary-foreground" }) }),
            /* @__PURE__ */ h.jsxs("div", { children: [
              /* @__PURE__ */ h.jsx("span", { className: `text-sm ${p === "detailed" ? "text-foreground" : "text-muted-foreground"}`, children: "" }),
              /* @__PURE__ */ h.jsx("p", { className: "text-[10px] text-muted-foreground", children: "  LLM   " })
            ] })
          ] })
        ] })
      ] }),
      /* @__PURE__ */ h.jsxs("div", { className: "grid grid-cols-2 gap-6", children: [
        /* @__PURE__ */ h.jsx(
          er,
          {
            label: "",
            value: y,
            onChange: w,
            min: 100,
            max: 1e4,
            step: 100,
            showSlider: !1
          }
        ),
        /* @__PURE__ */ h.jsx(
          er,
          {
            label: "",
            value: E,
            onChange: k,
            min: 0,
            max: y / 2,
            step: 50,
            showSlider: !1
          }
        )
      ] }),
      C && /* @__PURE__ */ h.jsxs("div", { children: [
        /* @__PURE__ */ h.jsx("span", { className: "text-xs text-muted-foreground block mb-2", children: "" }),
        /* @__PURE__ */ h.jsxs("div", { className: "bg-muted/20 border border-border rounded-lg p-3 max-h-32 overflow-y-auto text-xs text-muted-foreground font-mono", children: [
          C.slice(0, 500),
          "..."
        ] }),
        /* @__PURE__ */ h.jsxs("div", { className: "text-[10px] text-muted-foreground mt-1", children: [
          " ",
          Math.ceil((C.length - E) / (y - E)),
          " "
        ] })
      ] }),
      /* @__PURE__ */ h.jsxs(
        "button",
        {
          className: "inline-flex items-center gap-2 px-4 py-2 text-sm bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50",
          onClick: U,
          disabled: !C || N !== null,
          children: [
            /* @__PURE__ */ h.jsx(uu, { size: 14 }),
            N ? ` ${N.current}/${N.total}` : ""
          ]
        }
      ),
      N && /* @__PURE__ */ h.jsx("div", { className: "h-1.5 bg-muted rounded-full overflow-hidden", children: /* @__PURE__ */ h.jsx(
        "div",
        {
          className: "h-full bg-primary transition-all duration-300",
          style: { width: `${N.current / N.total * 100}%` }
        }
      ) })
    ] })
  ] });
}, Qee = [
  { id: "summary", label: "", icon: /* @__PURE__ */ h.jsx(uu, { size: 16 }) },
  { id: "entity", label: "", icon: /* @__PURE__ */ h.jsx(aj, { size: 16 }) },
  { id: "vectorization", label: "", icon: /* @__PURE__ */ h.jsx(Dh, { size: 16 }) },
  { id: "recall", label: "", icon: /* @__PURE__ */ h.jsx(hi, { size: 16 }) },
  { id: "batch", label: "", icon: /* @__PURE__ */ h.jsx(v2, { size: 16 }) }
], Zee = [
  { id: "devlog", label: "", icon: iO, linkTo: "devlog:model" },
  { id: "presets", label: "", icon: OR, linkTo: "presets:prompt" }
], Jee = ({ onNavigate: e }) => {
  const [t, n] = P.useState("summary");
  return /* @__PURE__ */ h.jsxs("div", { className: "flex flex-col h-full", children: [
    /* @__PURE__ */ h.jsxs("div", { className: "mb-6", children: [
      /* @__PURE__ */ h.jsx("h1", { className: "text-2xl font-light text-foreground tracking-tight mb-2", children: "" }),
      /* @__PURE__ */ h.jsx("p", { className: "text-sm text-muted-foreground", children: " RAG " })
    ] }),
    /* @__PURE__ */ h.jsx(Fn, { className: "mb-6" }),
    /* @__PURE__ */ h.jsx(
      Kh,
      {
        tabs: Qee,
        activeTab: t,
        onChange: (r) => n(r),
        actions: /* @__PURE__ */ h.jsx(
          Pee,
          {
            links: Zee,
            onNavigate: (r) => e == null ? void 0 : e(r)
          }
        )
      }
    ),
    /* @__PURE__ */ h.jsxs("div", { className: "flex-1 overflow-y-auto no-scrollbar", children: [
      t === "summary" && /* @__PURE__ */ h.jsx(Fee, {}),
      t === "vectorization" && /* @__PURE__ */ h.jsx($ee, {}),
      t === "recall" && /* @__PURE__ */ h.jsx(Hee, {}),
      t === "entity" && /* @__PURE__ */ h.jsx(Gee, {}),
      t === "batch" && /* @__PURE__ */ h.jsx(Wee, {})
    ] })
  ] });
}, ete = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  ProcessingView: Jee
}, Symbol.toStringTag, { value: "Module" }));
//# sourceMappingURL=index.js.map
