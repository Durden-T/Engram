var qL = Object.defineProperty;
var FL = (e, t, n) => t in e ? qL(e, t, { enumerable: !0, configurable: !0, writable: !0, value: n }) : e[t] = n;
var vt = (e, t, n) => FL(e, typeof t != "symbol" ? t + "" : t, n);
var vu = typeof globalThis < "u" ? globalThis : typeof window < "u" ? window : typeof global < "u" ? global : typeof self < "u" ? self : {};
function Uc(e) {
  return e && e.__esModule && Object.prototype.hasOwnProperty.call(e, "default") ? e.default : e;
}
var jb = { exports: {} }, Cg = {};
/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var gk;
function UL() {
  if (gk) return Cg;
  gk = 1;
  var e = Symbol.for("react.transitional.element"), t = Symbol.for("react.fragment");
  function n(r, i, s) {
    var o = null;
    if (s !== void 0 && (o = "" + s), i.key !== void 0 && (o = "" + i.key), "key" in i) {
      s = {};
      for (var u in i)
        u !== "key" && (s[u] = i[u]);
    } else s = i;
    return i = s.ref, {
      $$typeof: e,
      type: r,
      key: o,
      ref: i !== void 0 ? i : null,
      props: s
    };
  }
  return Cg.Fragment = t, Cg.jsx = n, Cg.jsxs = n, Cg;
}
var yk;
function $L() {
  return yk || (yk = 1, jb.exports = UL()), jb.exports;
}
var g = $L(), Mb = { exports: {} }, Ft = {};
/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var vk;
function VL() {
  if (vk) return Ft;
  vk = 1;
  var e = Symbol.for("react.transitional.element"), t = Symbol.for("react.portal"), n = Symbol.for("react.fragment"), r = Symbol.for("react.strict_mode"), i = Symbol.for("react.profiler"), s = Symbol.for("react.consumer"), o = Symbol.for("react.context"), u = Symbol.for("react.forward_ref"), c = Symbol.for("react.suspense"), d = Symbol.for("react.memo"), m = Symbol.for("react.lazy"), p = Symbol.for("react.activity"), x = Symbol.iterator;
  function b($) {
    return $ === null || typeof $ != "object" ? null : ($ = x && $[x] || $["@@iterator"], typeof $ == "function" ? $ : null);
  }
  var S = {
    isMounted: function() {
      return !1;
    },
    enqueueForceUpdate: function() {
    },
    enqueueReplaceState: function() {
    },
    enqueueSetState: function() {
    }
  }, k = Object.assign, A = {};
  function T($, fe, G) {
    this.props = $, this.context = fe, this.refs = A, this.updater = G || S;
  }
  T.prototype.isReactComponent = {}, T.prototype.setState = function($, fe) {
    if (typeof $ != "object" && typeof $ != "function" && $ != null)
      throw Error(
        "takes an object of state variables to update or a function which returns an object of state variables."
      );
    this.updater.enqueueSetState(this, $, fe, "setState");
  }, T.prototype.forceUpdate = function($) {
    this.updater.enqueueForceUpdate(this, $, "forceUpdate");
  };
  function M() {
  }
  M.prototype = T.prototype;
  function j($, fe, G) {
    this.props = $, this.context = fe, this.refs = A, this.updater = G || S;
  }
  var D = j.prototype = new M();
  D.constructor = j, k(D, T.prototype), D.isPureReactComponent = !0;
  var z = Array.isArray;
  function I() {
  }
  var L = { H: null, A: null, T: null, S: null }, K = Object.prototype.hasOwnProperty;
  function ne($, fe, G) {
    var le = G.ref;
    return {
      $$typeof: e,
      type: $,
      key: fe,
      ref: le !== void 0 ? le : null,
      props: G
    };
  }
  function Y($, fe) {
    return ne($.type, fe, $.props);
  }
  function H($) {
    return typeof $ == "object" && $ !== null && $.$$typeof === e;
  }
  function Z($) {
    var fe = { "=": "=0", ":": "=2" };
    return "$" + $.replace(/[=:]/g, function(G) {
      return fe[G];
    });
  }
  var me = /\/+/g;
  function Q($, fe) {
    return typeof $ == "object" && $ !== null && $.key != null ? Z("" + $.key) : fe.toString(36);
  }
  function se($) {
    switch ($.status) {
      case "fulfilled":
        return $.value;
      case "rejected":
        throw $.reason;
      default:
        switch (typeof $.status == "string" ? $.then(I, I) : ($.status = "pending", $.then(
          function(fe) {
            $.status === "pending" && ($.status = "fulfilled", $.value = fe);
          },
          function(fe) {
            $.status === "pending" && ($.status = "rejected", $.reason = fe);
          }
        )), $.status) {
          case "fulfilled":
            return $.value;
          case "rejected":
            throw $.reason;
        }
    }
    throw $;
  }
  function J($, fe, G, le, xe) {
    var Se = typeof $;
    (Se === "undefined" || Se === "boolean") && ($ = null);
    var Oe = !1;
    if ($ === null) Oe = !0;
    else
      switch (Se) {
        case "bigint":
        case "string":
        case "number":
          Oe = !0;
          break;
        case "object":
          switch ($.$$typeof) {
            case e:
            case t:
              Oe = !0;
              break;
            case m:
              return Oe = $._init, J(
                Oe($._payload),
                fe,
                G,
                le,
                xe
              );
          }
      }
    if (Oe)
      return xe = xe($), Oe = le === "" ? "." + Q($, 0) : le, z(xe) ? (G = "", Oe != null && (G = Oe.replace(me, "$&/") + "/"), J(xe, fe, G, "", function(ft) {
        return ft;
      })) : xe != null && (H(xe) && (xe = Y(
        xe,
        G + (xe.key == null || $ && $.key === xe.key ? "" : ("" + xe.key).replace(
          me,
          "$&/"
        ) + "/") + Oe
      )), fe.push(xe)), 1;
    Oe = 0;
    var Be = le === "" ? "." : le + ":";
    if (z($))
      for (var Re = 0; Re < $.length; Re++)
        le = $[Re], Se = Be + Q(le, Re), Oe += J(
          le,
          fe,
          G,
          Se,
          xe
        );
    else if (Re = b($), typeof Re == "function")
      for ($ = Re.call($), Re = 0; !(le = $.next()).done; )
        le = le.value, Se = Be + Q(le, Re++), Oe += J(
          le,
          fe,
          G,
          Se,
          xe
        );
    else if (Se === "object") {
      if (typeof $.then == "function")
        return J(
          se($),
          fe,
          G,
          le,
          xe
        );
      throw fe = String($), Error(
        "Objects are not valid as a React child (found: " + (fe === "[object Object]" ? "object with keys {" + Object.keys($).join(", ") + "}" : fe) + "). If you meant to render a collection of children, use an array instead."
      );
    }
    return Oe;
  }
  function ue($, fe, G) {
    if ($ == null) return $;
    var le = [], xe = 0;
    return J($, le, "", "", function(Se) {
      return fe.call(G, Se, xe++);
    }), le;
  }
  function de($) {
    if ($._status === -1) {
      var fe = $._result;
      fe = fe(), fe.then(
        function(G) {
          ($._status === 0 || $._status === -1) && ($._status = 1, $._result = G);
        },
        function(G) {
          ($._status === 0 || $._status === -1) && ($._status = 2, $._result = G);
        }
      ), $._status === -1 && ($._status = 0, $._result = fe);
    }
    if ($._status === 1) return $._result.default;
    throw $._result;
  }
  var ce = typeof reportError == "function" ? reportError : function($) {
    if (typeof window == "object" && typeof window.ErrorEvent == "function") {
      var fe = new window.ErrorEvent("error", {
        bubbles: !0,
        cancelable: !0,
        message: typeof $ == "object" && $ !== null && typeof $.message == "string" ? String($.message) : String($),
        error: $
      });
      if (!window.dispatchEvent(fe)) return;
    } else if (typeof process == "object" && typeof process.emit == "function") {
      process.emit("uncaughtException", $);
      return;
    }
    console.error($);
  }, W = {
    map: ue,
    forEach: function($, fe, G) {
      ue(
        $,
        function() {
          fe.apply(this, arguments);
        },
        G
      );
    },
    count: function($) {
      var fe = 0;
      return ue($, function() {
        fe++;
      }), fe;
    },
    toArray: function($) {
      return ue($, function(fe) {
        return fe;
      }) || [];
    },
    only: function($) {
      if (!H($))
        throw Error(
          "React.Children.only expected to receive a single React element child."
        );
      return $;
    }
  };
  return Ft.Activity = p, Ft.Children = W, Ft.Component = T, Ft.Fragment = n, Ft.Profiler = i, Ft.PureComponent = j, Ft.StrictMode = r, Ft.Suspense = c, Ft.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE = L, Ft.__COMPILER_RUNTIME = {
    __proto__: null,
    c: function($) {
      return L.H.useMemoCache($);
    }
  }, Ft.cache = function($) {
    return function() {
      return $.apply(null, arguments);
    };
  }, Ft.cacheSignal = function() {
    return null;
  }, Ft.cloneElement = function($, fe, G) {
    if ($ == null)
      throw Error(
        "The argument must be a React element, but you passed " + $ + "."
      );
    var le = k({}, $.props), xe = $.key;
    if (fe != null)
      for (Se in fe.key !== void 0 && (xe = "" + fe.key), fe)
        !K.call(fe, Se) || Se === "key" || Se === "__self" || Se === "__source" || Se === "ref" && fe.ref === void 0 || (le[Se] = fe[Se]);
    var Se = arguments.length - 2;
    if (Se === 1) le.children = G;
    else if (1 < Se) {
      for (var Oe = Array(Se), Be = 0; Be < Se; Be++)
        Oe[Be] = arguments[Be + 2];
      le.children = Oe;
    }
    return ne($.type, xe, le);
  }, Ft.createContext = function($) {
    return $ = {
      $$typeof: o,
      _currentValue: $,
      _currentValue2: $,
      _threadCount: 0,
      Provider: null,
      Consumer: null
    }, $.Provider = $, $.Consumer = {
      $$typeof: s,
      _context: $
    }, $;
  }, Ft.createElement = function($, fe, G) {
    var le, xe = {}, Se = null;
    if (fe != null)
      for (le in fe.key !== void 0 && (Se = "" + fe.key), fe)
        K.call(fe, le) && le !== "key" && le !== "__self" && le !== "__source" && (xe[le] = fe[le]);
    var Oe = arguments.length - 2;
    if (Oe === 1) xe.children = G;
    else if (1 < Oe) {
      for (var Be = Array(Oe), Re = 0; Re < Oe; Re++)
        Be[Re] = arguments[Re + 2];
      xe.children = Be;
    }
    if ($ && $.defaultProps)
      for (le in Oe = $.defaultProps, Oe)
        xe[le] === void 0 && (xe[le] = Oe[le]);
    return ne($, Se, xe);
  }, Ft.createRef = function() {
    return { current: null };
  }, Ft.forwardRef = function($) {
    return { $$typeof: u, render: $ };
  }, Ft.isValidElement = H, Ft.lazy = function($) {
    return {
      $$typeof: m,
      _payload: { _status: -1, _result: $ },
      _init: de
    };
  }, Ft.memo = function($, fe) {
    return {
      $$typeof: d,
      type: $,
      compare: fe === void 0 ? null : fe
    };
  }, Ft.startTransition = function($) {
    var fe = L.T, G = {};
    L.T = G;
    try {
      var le = $(), xe = L.S;
      xe !== null && xe(G, le), typeof le == "object" && le !== null && typeof le.then == "function" && le.then(I, ce);
    } catch (Se) {
      ce(Se);
    } finally {
      fe !== null && G.types !== null && (fe.types = G.types), L.T = fe;
    }
  }, Ft.unstable_useCacheRefresh = function() {
    return L.H.useCacheRefresh();
  }, Ft.use = function($) {
    return L.H.use($);
  }, Ft.useActionState = function($, fe, G) {
    return L.H.useActionState($, fe, G);
  }, Ft.useCallback = function($, fe) {
    return L.H.useCallback($, fe);
  }, Ft.useContext = function($) {
    return L.H.useContext($);
  }, Ft.useDebugValue = function() {
  }, Ft.useDeferredValue = function($, fe) {
    return L.H.useDeferredValue($, fe);
  }, Ft.useEffect = function($, fe) {
    return L.H.useEffect($, fe);
  }, Ft.useEffectEvent = function($) {
    return L.H.useEffectEvent($);
  }, Ft.useId = function() {
    return L.H.useId();
  }, Ft.useImperativeHandle = function($, fe, G) {
    return L.H.useImperativeHandle($, fe, G);
  }, Ft.useInsertionEffect = function($, fe) {
    return L.H.useInsertionEffect($, fe);
  }, Ft.useLayoutEffect = function($, fe) {
    return L.H.useLayoutEffect($, fe);
  }, Ft.useMemo = function($, fe) {
    return L.H.useMemo($, fe);
  }, Ft.useOptimistic = function($, fe) {
    return L.H.useOptimistic($, fe);
  }, Ft.useReducer = function($, fe, G) {
    return L.H.useReducer($, fe, G);
  }, Ft.useRef = function($) {
    return L.H.useRef($);
  }, Ft.useState = function($) {
    return L.H.useState($);
  }, Ft.useSyncExternalStore = function($, fe, G) {
    return L.H.useSyncExternalStore(
      $,
      fe,
      G
    );
  }, Ft.useTransition = function() {
    return L.H.useTransition();
  }, Ft.version = "19.2.3", Ft;
}
var xk;
function T0() {
  return xk || (xk = 1, Mb.exports = VL()), Mb.exports;
}
var F = T0();
const yC = /* @__PURE__ */ Uc(F);
var Rb = { exports: {} }, Eg = {}, Ob = { exports: {} }, Db = {};
/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var bk;
function HL() {
  return bk || (bk = 1, (function(e) {
    function t(J, ue) {
      var de = J.length;
      J.push(ue);
      e: for (; 0 < de; ) {
        var ce = de - 1 >>> 1, W = J[ce];
        if (0 < i(W, ue))
          J[ce] = ue, J[de] = W, de = ce;
        else break e;
      }
    }
    function n(J) {
      return J.length === 0 ? null : J[0];
    }
    function r(J) {
      if (J.length === 0) return null;
      var ue = J[0], de = J.pop();
      if (de !== ue) {
        J[0] = de;
        e: for (var ce = 0, W = J.length, $ = W >>> 1; ce < $; ) {
          var fe = 2 * (ce + 1) - 1, G = J[fe], le = fe + 1, xe = J[le];
          if (0 > i(G, de))
            le < W && 0 > i(xe, G) ? (J[ce] = xe, J[le] = de, ce = le) : (J[ce] = G, J[fe] = de, ce = fe);
          else if (le < W && 0 > i(xe, de))
            J[ce] = xe, J[le] = de, ce = le;
          else break e;
        }
      }
      return ue;
    }
    function i(J, ue) {
      var de = J.sortIndex - ue.sortIndex;
      return de !== 0 ? de : J.id - ue.id;
    }
    if (e.unstable_now = void 0, typeof performance == "object" && typeof performance.now == "function") {
      var s = performance;
      e.unstable_now = function() {
        return s.now();
      };
    } else {
      var o = Date, u = o.now();
      e.unstable_now = function() {
        return o.now() - u;
      };
    }
    var c = [], d = [], m = 1, p = null, x = 3, b = !1, S = !1, k = !1, A = !1, T = typeof setTimeout == "function" ? setTimeout : null, M = typeof clearTimeout == "function" ? clearTimeout : null, j = typeof setImmediate < "u" ? setImmediate : null;
    function D(J) {
      for (var ue = n(d); ue !== null; ) {
        if (ue.callback === null) r(d);
        else if (ue.startTime <= J)
          r(d), ue.sortIndex = ue.expirationTime, t(c, ue);
        else break;
        ue = n(d);
      }
    }
    function z(J) {
      if (k = !1, D(J), !S)
        if (n(c) !== null)
          S = !0, I || (I = !0, Z());
        else {
          var ue = n(d);
          ue !== null && se(z, ue.startTime - J);
        }
    }
    var I = !1, L = -1, K = 5, ne = -1;
    function Y() {
      return A ? !0 : !(e.unstable_now() - ne < K);
    }
    function H() {
      if (A = !1, I) {
        var J = e.unstable_now();
        ne = J;
        var ue = !0;
        try {
          e: {
            S = !1, k && (k = !1, M(L), L = -1), b = !0;
            var de = x;
            try {
              t: {
                for (D(J), p = n(c); p !== null && !(p.expirationTime > J && Y()); ) {
                  var ce = p.callback;
                  if (typeof ce == "function") {
                    p.callback = null, x = p.priorityLevel;
                    var W = ce(
                      p.expirationTime <= J
                    );
                    if (J = e.unstable_now(), typeof W == "function") {
                      p.callback = W, D(J), ue = !0;
                      break t;
                    }
                    p === n(c) && r(c), D(J);
                  } else r(c);
                  p = n(c);
                }
                if (p !== null) ue = !0;
                else {
                  var $ = n(d);
                  $ !== null && se(
                    z,
                    $.startTime - J
                  ), ue = !1;
                }
              }
              break e;
            } finally {
              p = null, x = de, b = !1;
            }
            ue = void 0;
          }
        } finally {
          ue ? Z() : I = !1;
        }
      }
    }
    var Z;
    if (typeof j == "function")
      Z = function() {
        j(H);
      };
    else if (typeof MessageChannel < "u") {
      var me = new MessageChannel(), Q = me.port2;
      me.port1.onmessage = H, Z = function() {
        Q.postMessage(null);
      };
    } else
      Z = function() {
        T(H, 0);
      };
    function se(J, ue) {
      L = T(function() {
        J(e.unstable_now());
      }, ue);
    }
    e.unstable_IdlePriority = 5, e.unstable_ImmediatePriority = 1, e.unstable_LowPriority = 4, e.unstable_NormalPriority = 3, e.unstable_Profiling = null, e.unstable_UserBlockingPriority = 2, e.unstable_cancelCallback = function(J) {
      J.callback = null;
    }, e.unstable_forceFrameRate = function(J) {
      0 > J || 125 < J ? console.error(
        "forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"
      ) : K = 0 < J ? Math.floor(1e3 / J) : 5;
    }, e.unstable_getCurrentPriorityLevel = function() {
      return x;
    }, e.unstable_next = function(J) {
      switch (x) {
        case 1:
        case 2:
        case 3:
          var ue = 3;
          break;
        default:
          ue = x;
      }
      var de = x;
      x = ue;
      try {
        return J();
      } finally {
        x = de;
      }
    }, e.unstable_requestPaint = function() {
      A = !0;
    }, e.unstable_runWithPriority = function(J, ue) {
      switch (J) {
        case 1:
        case 2:
        case 3:
        case 4:
        case 5:
          break;
        default:
          J = 3;
      }
      var de = x;
      x = J;
      try {
        return ue();
      } finally {
        x = de;
      }
    }, e.unstable_scheduleCallback = function(J, ue, de) {
      var ce = e.unstable_now();
      switch (typeof de == "object" && de !== null ? (de = de.delay, de = typeof de == "number" && 0 < de ? ce + de : ce) : de = ce, J) {
        case 1:
          var W = -1;
          break;
        case 2:
          W = 250;
          break;
        case 5:
          W = 1073741823;
          break;
        case 4:
          W = 1e4;
          break;
        default:
          W = 5e3;
      }
      return W = de + W, J = {
        id: m++,
        callback: ue,
        priorityLevel: J,
        startTime: de,
        expirationTime: W,
        sortIndex: -1
      }, de > ce ? (J.sortIndex = de, t(d, J), n(c) === null && J === n(d) && (k ? (M(L), L = -1) : k = !0, se(z, de - ce))) : (J.sortIndex = W, t(c, J), S || b || (S = !0, I || (I = !0, Z()))), J;
    }, e.unstable_shouldYield = Y, e.unstable_wrapCallback = function(J) {
      var ue = x;
      return function() {
        var de = x;
        x = ue;
        try {
          return J.apply(this, arguments);
        } finally {
          x = de;
        }
      };
    };
  })(Db)), Db;
}
var wk;
function GL() {
  return wk || (wk = 1, Ob.exports = HL()), Ob.exports;
}
var Ib = { exports: {} }, Li = {};
/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var _k;
function KL() {
  if (_k) return Li;
  _k = 1;
  var e = T0();
  function t(c) {
    var d = "https://react.dev/errors/" + c;
    if (1 < arguments.length) {
      d += "?args[]=" + encodeURIComponent(arguments[1]);
      for (var m = 2; m < arguments.length; m++)
        d += "&args[]=" + encodeURIComponent(arguments[m]);
    }
    return "Minified React error #" + c + "; visit " + d + " for the full message or use the non-minified dev environment for full errors and additional helpful warnings.";
  }
  function n() {
  }
  var r = {
    d: {
      f: n,
      r: function() {
        throw Error(t(522));
      },
      D: n,
      C: n,
      L: n,
      m: n,
      X: n,
      S: n,
      M: n
    },
    p: 0,
    findDOMNode: null
  }, i = Symbol.for("react.portal");
  function s(c, d, m) {
    var p = 3 < arguments.length && arguments[3] !== void 0 ? arguments[3] : null;
    return {
      $$typeof: i,
      key: p == null ? null : "" + p,
      children: c,
      containerInfo: d,
      implementation: m
    };
  }
  var o = e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;
  function u(c, d) {
    if (c === "font") return "";
    if (typeof d == "string")
      return d === "use-credentials" ? d : "";
  }
  return Li.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE = r, Li.createPortal = function(c, d) {
    var m = 2 < arguments.length && arguments[2] !== void 0 ? arguments[2] : null;
    if (!d || d.nodeType !== 1 && d.nodeType !== 9 && d.nodeType !== 11)
      throw Error(t(299));
    return s(c, d, null, m);
  }, Li.flushSync = function(c) {
    var d = o.T, m = r.p;
    try {
      if (o.T = null, r.p = 2, c) return c();
    } finally {
      o.T = d, r.p = m, r.d.f();
    }
  }, Li.preconnect = function(c, d) {
    typeof c == "string" && (d ? (d = d.crossOrigin, d = typeof d == "string" ? d === "use-credentials" ? d : "" : void 0) : d = null, r.d.C(c, d));
  }, Li.prefetchDNS = function(c) {
    typeof c == "string" && r.d.D(c);
  }, Li.preinit = function(c, d) {
    if (typeof c == "string" && d && typeof d.as == "string") {
      var m = d.as, p = u(m, d.crossOrigin), x = typeof d.integrity == "string" ? d.integrity : void 0, b = typeof d.fetchPriority == "string" ? d.fetchPriority : void 0;
      m === "style" ? r.d.S(
        c,
        typeof d.precedence == "string" ? d.precedence : void 0,
        {
          crossOrigin: p,
          integrity: x,
          fetchPriority: b
        }
      ) : m === "script" && r.d.X(c, {
        crossOrigin: p,
        integrity: x,
        fetchPriority: b,
        nonce: typeof d.nonce == "string" ? d.nonce : void 0
      });
    }
  }, Li.preinitModule = function(c, d) {
    if (typeof c == "string")
      if (typeof d == "object" && d !== null) {
        if (d.as == null || d.as === "script") {
          var m = u(
            d.as,
            d.crossOrigin
          );
          r.d.M(c, {
            crossOrigin: m,
            integrity: typeof d.integrity == "string" ? d.integrity : void 0,
            nonce: typeof d.nonce == "string" ? d.nonce : void 0
          });
        }
      } else d == null && r.d.M(c);
  }, Li.preload = function(c, d) {
    if (typeof c == "string" && typeof d == "object" && d !== null && typeof d.as == "string") {
      var m = d.as, p = u(m, d.crossOrigin);
      r.d.L(c, m, {
        crossOrigin: p,
        integrity: typeof d.integrity == "string" ? d.integrity : void 0,
        nonce: typeof d.nonce == "string" ? d.nonce : void 0,
        type: typeof d.type == "string" ? d.type : void 0,
        fetchPriority: typeof d.fetchPriority == "string" ? d.fetchPriority : void 0,
        referrerPolicy: typeof d.referrerPolicy == "string" ? d.referrerPolicy : void 0,
        imageSrcSet: typeof d.imageSrcSet == "string" ? d.imageSrcSet : void 0,
        imageSizes: typeof d.imageSizes == "string" ? d.imageSizes : void 0,
        media: typeof d.media == "string" ? d.media : void 0
      });
    }
  }, Li.preloadModule = function(c, d) {
    if (typeof c == "string")
      if (d) {
        var m = u(d.as, d.crossOrigin);
        r.d.m(c, {
          as: typeof d.as == "string" && d.as !== "script" ? d.as : void 0,
          crossOrigin: m,
          integrity: typeof d.integrity == "string" ? d.integrity : void 0
        });
      } else r.d.m(c);
  }, Li.requestFormReset = function(c) {
    r.d.r(c);
  }, Li.unstable_batchedUpdates = function(c, d) {
    return c(d);
  }, Li.useFormState = function(c, d, m) {
    return o.H.useFormState(c, d, m);
  }, Li.useFormStatus = function() {
    return o.H.useHostTransitionStatus();
  }, Li.version = "19.2.3", Li;
}
var Sk;
function YM() {
  if (Sk) return Ib.exports;
  Sk = 1;
  function e() {
    if (!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ > "u" || typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE != "function"))
      try {
        __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e);
      } catch (t) {
        console.error(t);
      }
  }
  return e(), Ib.exports = KL(), Ib.exports;
}
/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var Ck;
function YL() {
  if (Ck) return Eg;
  Ck = 1;
  var e = GL(), t = T0(), n = YM();
  function r(a) {
    var l = "https://react.dev/errors/" + a;
    if (1 < arguments.length) {
      l += "?args[]=" + encodeURIComponent(arguments[1]);
      for (var f = 2; f < arguments.length; f++)
        l += "&args[]=" + encodeURIComponent(arguments[f]);
    }
    return "Minified React error #" + a + "; visit " + l + " for the full message or use the non-minified dev environment for full errors and additional helpful warnings.";
  }
  function i(a) {
    return !(!a || a.nodeType !== 1 && a.nodeType !== 9 && a.nodeType !== 11);
  }
  function s(a) {
    var l = a, f = a;
    if (a.alternate) for (; l.return; ) l = l.return;
    else {
      a = l;
      do
        l = a, (l.flags & 4098) !== 0 && (f = l.return), a = l.return;
      while (a);
    }
    return l.tag === 3 ? f : null;
  }
  function o(a) {
    if (a.tag === 13) {
      var l = a.memoizedState;
      if (l === null && (a = a.alternate, a !== null && (l = a.memoizedState)), l !== null) return l.dehydrated;
    }
    return null;
  }
  function u(a) {
    if (a.tag === 31) {
      var l = a.memoizedState;
      if (l === null && (a = a.alternate, a !== null && (l = a.memoizedState)), l !== null) return l.dehydrated;
    }
    return null;
  }
  function c(a) {
    if (s(a) !== a)
      throw Error(r(188));
  }
  function d(a) {
    var l = a.alternate;
    if (!l) {
      if (l = s(a), l === null) throw Error(r(188));
      return l !== a ? null : a;
    }
    for (var f = a, y = l; ; ) {
      var _ = f.return;
      if (_ === null) break;
      var N = _.alternate;
      if (N === null) {
        if (y = _.return, y !== null) {
          f = y;
          continue;
        }
        break;
      }
      if (_.child === N.child) {
        for (N = _.child; N; ) {
          if (N === f) return c(_), a;
          if (N === y) return c(_), l;
          N = N.sibling;
        }
        throw Error(r(188));
      }
      if (f.return !== y.return) f = _, y = N;
      else {
        for (var B = !1, ee = _.child; ee; ) {
          if (ee === f) {
            B = !0, f = _, y = N;
            break;
          }
          if (ee === y) {
            B = !0, y = _, f = N;
            break;
          }
          ee = ee.sibling;
        }
        if (!B) {
          for (ee = N.child; ee; ) {
            if (ee === f) {
              B = !0, f = N, y = _;
              break;
            }
            if (ee === y) {
              B = !0, y = N, f = _;
              break;
            }
            ee = ee.sibling;
          }
          if (!B) throw Error(r(189));
        }
      }
      if (f.alternate !== y) throw Error(r(190));
    }
    if (f.tag !== 3) throw Error(r(188));
    return f.stateNode.current === f ? a : l;
  }
  function m(a) {
    var l = a.tag;
    if (l === 5 || l === 26 || l === 27 || l === 6) return a;
    for (a = a.child; a !== null; ) {
      if (l = m(a), l !== null) return l;
      a = a.sibling;
    }
    return null;
  }
  var p = Object.assign, x = Symbol.for("react.element"), b = Symbol.for("react.transitional.element"), S = Symbol.for("react.portal"), k = Symbol.for("react.fragment"), A = Symbol.for("react.strict_mode"), T = Symbol.for("react.profiler"), M = Symbol.for("react.consumer"), j = Symbol.for("react.context"), D = Symbol.for("react.forward_ref"), z = Symbol.for("react.suspense"), I = Symbol.for("react.suspense_list"), L = Symbol.for("react.memo"), K = Symbol.for("react.lazy"), ne = Symbol.for("react.activity"), Y = Symbol.for("react.memo_cache_sentinel"), H = Symbol.iterator;
  function Z(a) {
    return a === null || typeof a != "object" ? null : (a = H && a[H] || a["@@iterator"], typeof a == "function" ? a : null);
  }
  var me = Symbol.for("react.client.reference");
  function Q(a) {
    if (a == null) return null;
    if (typeof a == "function")
      return a.$$typeof === me ? null : a.displayName || a.name || null;
    if (typeof a == "string") return a;
    switch (a) {
      case k:
        return "Fragment";
      case T:
        return "Profiler";
      case A:
        return "StrictMode";
      case z:
        return "Suspense";
      case I:
        return "SuspenseList";
      case ne:
        return "Activity";
    }
    if (typeof a == "object")
      switch (a.$$typeof) {
        case S:
          return "Portal";
        case j:
          return a.displayName || "Context";
        case M:
          return (a._context.displayName || "Context") + ".Consumer";
        case D:
          var l = a.render;
          return a = a.displayName, a || (a = l.displayName || l.name || "", a = a !== "" ? "ForwardRef(" + a + ")" : "ForwardRef"), a;
        case L:
          return l = a.displayName || null, l !== null ? l : Q(a.type) || "Memo";
        case K:
          l = a._payload, a = a._init;
          try {
            return Q(a(l));
          } catch {
          }
      }
    return null;
  }
  var se = Array.isArray, J = t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE, ue = n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE, de = {
    pending: !1,
    data: null,
    method: null,
    action: null
  }, ce = [], W = -1;
  function $(a) {
    return { current: a };
  }
  function fe(a) {
    0 > W || (a.current = ce[W], ce[W] = null, W--);
  }
  function G(a, l) {
    W++, ce[W] = a.current, a.current = l;
  }
  var le = $(null), xe = $(null), Se = $(null), Oe = $(null);
  function Be(a, l) {
    switch (G(Se, l), G(xe, a), G(le, null), l.nodeType) {
      case 9:
      case 11:
        a = (a = l.documentElement) && (a = a.namespaceURI) ? ed(a) : 0;
        break;
      default:
        if (a = l.tagName, l = l.namespaceURI)
          l = ed(l), a = Pi(l, a);
        else
          switch (a) {
            case "svg":
              a = 1;
              break;
            case "math":
              a = 2;
              break;
            default:
              a = 0;
          }
    }
    fe(le), G(le, a);
  }
  function Re() {
    fe(le), fe(xe), fe(Se);
  }
  function ft(a) {
    a.memoizedState !== null && G(Oe, a);
    var l = le.current, f = Pi(l, a.type);
    l !== f && (G(xe, a), G(le, f));
  }
  function Ie(a) {
    xe.current === a && (fe(le), fe(xe)), Oe.current === a && (fe(Oe), Nc._currentValue = de);
  }
  var Ne, Ue;
  function et(a) {
    if (Ne === void 0)
      try {
        throw Error();
      } catch (f) {
        var l = f.stack.trim().match(/\n( *(at )?)/);
        Ne = l && l[1] || "", Ue = -1 < f.stack.indexOf(`
    at`) ? " (<anonymous>)" : -1 < f.stack.indexOf("@") ? "@unknown:0:0" : "";
      }
    return `
` + Ne + a + Ue;
  }
  var tt = !1;
  function st(a, l) {
    if (!a || tt) return "";
    tt = !0;
    var f = Error.prepareStackTrace;
    Error.prepareStackTrace = void 0;
    try {
      var y = {
        DetermineComponentFrameRoot: function() {
          try {
            if (l) {
              var Ye = function() {
                throw Error();
              };
              if (Object.defineProperty(Ye.prototype, "props", {
                set: function() {
                  throw Error();
                }
              }), typeof Reflect == "object" && Reflect.construct) {
                try {
                  Reflect.construct(Ye, []);
                } catch (qe) {
                  var Le = qe;
                }
                Reflect.construct(a, [], Ye);
              } else {
                try {
                  Ye.call();
                } catch (qe) {
                  Le = qe;
                }
                a.call(Ye.prototype);
              }
            } else {
              try {
                throw Error();
              } catch (qe) {
                Le = qe;
              }
              (Ye = a()) && typeof Ye.catch == "function" && Ye.catch(function() {
              });
            }
          } catch (qe) {
            if (qe && Le && typeof qe.stack == "string")
              return [qe.stack, Le.stack];
          }
          return [null, null];
        }
      };
      y.DetermineComponentFrameRoot.displayName = "DetermineComponentFrameRoot";
      var _ = Object.getOwnPropertyDescriptor(
        y.DetermineComponentFrameRoot,
        "name"
      );
      _ && _.configurable && Object.defineProperty(
        y.DetermineComponentFrameRoot,
        "name",
        { value: "DetermineComponentFrameRoot" }
      );
      var N = y.DetermineComponentFrameRoot(), B = N[0], ee = N[1];
      if (B && ee) {
        var ye = B.split(`
`), Pe = ee.split(`
`);
        for (_ = y = 0; y < ye.length && !ye[y].includes("DetermineComponentFrameRoot"); )
          y++;
        for (; _ < Pe.length && !Pe[_].includes(
          "DetermineComponentFrameRoot"
        ); )
          _++;
        if (y === ye.length || _ === Pe.length)
          for (y = ye.length - 1, _ = Pe.length - 1; 1 <= y && 0 <= _ && ye[y] !== Pe[_]; )
            _--;
        for (; 1 <= y && 0 <= _; y--, _--)
          if (ye[y] !== Pe[_]) {
            if (y !== 1 || _ !== 1)
              do
                if (y--, _--, 0 > _ || ye[y] !== Pe[_]) {
                  var Ve = `
` + ye[y].replace(" at new ", " at ");
                  return a.displayName && Ve.includes("<anonymous>") && (Ve = Ve.replace("<anonymous>", a.displayName)), Ve;
                }
              while (1 <= y && 0 <= _);
            break;
          }
      }
    } finally {
      tt = !1, Error.prepareStackTrace = f;
    }
    return (f = a ? a.displayName || a.name : "") ? et(f) : "";
  }
  function dt(a, l) {
    switch (a.tag) {
      case 26:
      case 27:
      case 5:
        return et(a.type);
      case 16:
        return et("Lazy");
      case 13:
        return a.child !== l && l !== null ? et("Suspense Fallback") : et("Suspense");
      case 19:
        return et("SuspenseList");
      case 0:
      case 15:
        return st(a.type, !1);
      case 11:
        return st(a.type.render, !1);
      case 1:
        return st(a.type, !0);
      case 31:
        return et("Activity");
      default:
        return "";
    }
  }
  function Wn(a) {
    try {
      var l = "", f = null;
      do
        l += dt(a, f), f = a, a = a.return;
      while (a);
      return l;
    } catch (y) {
      return `
Error generating stack: ` + y.message + `
` + y.stack;
    }
  }
  var Rn = Object.prototype.hasOwnProperty, Un = e.unstable_scheduleCallback, Ht = e.unstable_cancelCallback, On = e.unstable_shouldYield, an = e.unstable_requestPaint, En = e.unstable_now, Xn = e.unstable_getCurrentPriorityLevel, Fe = e.unstable_ImmediatePriority, Qe = e.unstable_UserBlockingPriority, yt = e.unstable_NormalPriority, Tt = e.unstable_LowPriority, Pt = e.unstable_IdlePriority, $n = e.log, Vn = e.unstable_setDisableYieldValue, sn = null, Qt = null;
  function kn(a) {
    if (typeof $n == "function" && Vn(a), Qt && typeof Qt.setStrictMode == "function")
      try {
        Qt.setStrictMode(sn, a);
      } catch {
      }
  }
  var it = Math.clz32 ? Math.clz32 : Io, jr = Math.log, fr = Math.LN2;
  function Io(a) {
    return a >>>= 0, a === 0 ? 32 : 31 - (jr(a) / fr | 0) | 0;
  }
  var ct = 256, Va = 262144, gs = 4194304;
  function Ui(a) {
    var l = a & 42;
    if (l !== 0) return l;
    switch (a & -a) {
      case 1:
        return 1;
      case 2:
        return 2;
      case 4:
        return 4;
      case 8:
        return 8;
      case 16:
        return 16;
      case 32:
        return 32;
      case 64:
        return 64;
      case 128:
        return 128;
      case 256:
      case 512:
      case 1024:
      case 2048:
      case 4096:
      case 8192:
      case 16384:
      case 32768:
      case 65536:
      case 131072:
        return a & 261888;
      case 262144:
      case 524288:
      case 1048576:
      case 2097152:
        return a & 3932160;
      case 4194304:
      case 8388608:
      case 16777216:
      case 33554432:
        return a & 62914560;
      case 67108864:
        return 67108864;
      case 134217728:
        return 134217728;
      case 268435456:
        return 268435456;
      case 536870912:
        return 536870912;
      case 1073741824:
        return 0;
      default:
        return a;
    }
  }
  function Us(a, l, f) {
    var y = a.pendingLanes;
    if (y === 0) return 0;
    var _ = 0, N = a.suspendedLanes, B = a.pingedLanes;
    a = a.warmLanes;
    var ee = y & 134217727;
    return ee !== 0 ? (y = ee & ~N, y !== 0 ? _ = Ui(y) : (B &= ee, B !== 0 ? _ = Ui(B) : f || (f = ee & ~a, f !== 0 && (_ = Ui(f))))) : (ee = y & ~N, ee !== 0 ? _ = Ui(ee) : B !== 0 ? _ = Ui(B) : f || (f = y & ~a, f !== 0 && (_ = Ui(f)))), _ === 0 ? 0 : l !== 0 && l !== _ && (l & N) === 0 && (N = _ & -_, f = l & -l, N >= f || N === 32 && (f & 4194048) !== 0) ? l : _;
  }
  function Ha(a, l) {
    return (a.pendingLanes & ~(a.suspendedLanes & ~a.pingedLanes) & l) === 0;
  }
  function Gc(a, l) {
    switch (a) {
      case 1:
      case 2:
      case 4:
      case 8:
      case 64:
        return l + 250;
      case 16:
      case 32:
      case 128:
      case 256:
      case 512:
      case 1024:
      case 2048:
      case 4096:
      case 8192:
      case 16384:
      case 32768:
      case 65536:
      case 131072:
      case 262144:
      case 524288:
      case 1048576:
      case 2097152:
        return l + 5e3;
      case 4194304:
      case 8388608:
      case 16777216:
      case 33554432:
        return -1;
      case 67108864:
      case 134217728:
      case 268435456:
      case 536870912:
      case 1073741824:
        return -1;
      default:
        return -1;
    }
  }
  function zl() {
    var a = gs;
    return gs <<= 1, (gs & 62914560) === 0 && (gs = 4194304), a;
  }
  function ha(a) {
    for (var l = [], f = 0; 31 > f; f++) l.push(a);
    return l;
  }
  function Si(a, l) {
    a.pendingLanes |= l, l !== 268435456 && (a.suspendedLanes = 0, a.pingedLanes = 0, a.warmLanes = 0);
  }
  function Ll(a, l, f, y, _, N) {
    var B = a.pendingLanes;
    a.pendingLanes = f, a.suspendedLanes = 0, a.pingedLanes = 0, a.warmLanes = 0, a.expiredLanes &= f, a.entangledLanes &= f, a.errorRecoveryDisabledLanes &= f, a.shellSuspendCounter = 0;
    var ee = a.entanglements, ye = a.expirationTimes, Pe = a.hiddenUpdates;
    for (f = B & ~f; 0 < f; ) {
      var Ve = 31 - it(f), Ye = 1 << Ve;
      ee[Ve] = 0, ye[Ve] = -1;
      var Le = Pe[Ve];
      if (Le !== null)
        for (Pe[Ve] = null, Ve = 0; Ve < Le.length; Ve++) {
          var qe = Le[Ve];
          qe !== null && (qe.lane &= -536870913);
        }
      f &= ~Ye;
    }
    y !== 0 && Ga(a, y, 0), N !== 0 && _ === 0 && a.tag !== 0 && (a.suspendedLanes |= N & ~(B & ~l));
  }
  function Ga(a, l, f) {
    a.pendingLanes |= l, a.suspendedLanes &= ~l;
    var y = 31 - it(l);
    a.entangledLanes |= l, a.entanglements[y] = a.entanglements[y] | 1073741824 | f & 261930;
  }
  function vn(a, l) {
    var f = a.entangledLanes |= l;
    for (a = a.entanglements; f; ) {
      var y = 31 - it(f), _ = 1 << y;
      _ & l | a[y] & l && (a[y] |= l), f &= ~_;
    }
  }
  function Dn(a, l) {
    var f = l & -l;
    return f = (f & 42) !== 0 ? 1 : Bl(f), (f & (a.suspendedLanes | l)) !== 0 ? 0 : f;
  }
  function Bl(a) {
    switch (a) {
      case 2:
        a = 1;
        break;
      case 8:
        a = 4;
        break;
      case 32:
        a = 16;
        break;
      case 256:
      case 512:
      case 1024:
      case 2048:
      case 4096:
      case 8192:
      case 16384:
      case 32768:
      case 65536:
      case 131072:
      case 262144:
      case 524288:
      case 1048576:
      case 2097152:
      case 4194304:
      case 8388608:
      case 16777216:
      case 33554432:
        a = 128;
        break;
      case 268435456:
        a = 134217728;
        break;
      default:
        a = 0;
    }
    return a;
  }
  function ys(a) {
    return a &= -a, 2 < a ? 8 < a ? (a & 134217727) !== 0 ? 32 : 268435456 : 8 : 2;
  }
  function $s() {
    var a = ue.p;
    return a !== 0 ? a : (a = window.event, a === void 0 ? 32 : T1(a.type));
  }
  function Vs(a, l) {
    var f = ue.p;
    try {
      return ue.p = a, l();
    } finally {
      ue.p = f;
    }
  }
  var ma = Math.random().toString(36).slice(2), wn = "__reactFiber$" + ma, Qn = "__reactProps$" + ma, Mr = "__reactContainer$" + ma, pa = "__reactEvents$" + ma, ju = "__reactListeners$" + ma, ga = "__reactHandles$" + ma, ql = "__reactResources$" + ma, li = "__reactMarker$" + ma;
  function Po(a) {
    delete a[wn], delete a[Qn], delete a[pa], delete a[ju], delete a[ga];
  }
  function ya(a) {
    var l = a[wn];
    if (l) return l;
    for (var f = a.parentNode; f; ) {
      if (l = f[Mr] || f[wn]) {
        if (f = l.alternate, l.child !== null || f !== null && f.child !== null)
          for (a = c1(a); a !== null; ) {
            if (f = a[wn]) return f;
            a = c1(a);
          }
        return l;
      }
      a = f, f = a.parentNode;
    }
    return null;
  }
  function on(a) {
    if (a = a[wn] || a[Mr]) {
      var l = a.tag;
      if (l === 5 || l === 6 || l === 13 || l === 31 || l === 26 || l === 27 || l === 3)
        return a;
    }
    return null;
  }
  function ei(a) {
    var l = a.tag;
    if (l === 5 || l === 26 || l === 27 || l === 6) return a.stateNode;
    throw Error(r(33));
  }
  function dr(a) {
    var l = a[ql];
    return l || (l = a[ql] = { hoistableStyles: /* @__PURE__ */ new Map(), hoistableScripts: /* @__PURE__ */ new Map() }), l;
  }
  function Zn(a) {
    a[li] = !0;
  }
  var Ka = /* @__PURE__ */ new Set(), Hs = {};
  function Ci(a, l) {
    $i(a, l), $i(a + "Capture", l);
  }
  function $i(a, l) {
    for (Hs[a] = l, a = 0; a < l.length; a++)
      Ka.add(l[a]);
  }
  var va = RegExp(
    "^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"
  ), zo = {}, Gs = {};
  function Mu(a) {
    return Rn.call(Gs, a) ? !0 : Rn.call(zo, a) ? !1 : va.test(a) ? Gs[a] = !0 : (zo[a] = !0, !1);
  }
  function zt(a, l, f) {
    if (Mu(l))
      if (f === null) a.removeAttribute(l);
      else {
        switch (typeof f) {
          case "undefined":
          case "function":
          case "symbol":
            a.removeAttribute(l);
            return;
          case "boolean":
            var y = l.toLowerCase().slice(0, 5);
            if (y !== "data-" && y !== "aria-") {
              a.removeAttribute(l);
              return;
            }
        }
        a.setAttribute(l, "" + f);
      }
  }
  function vs(a, l, f) {
    if (f === null) a.removeAttribute(l);
    else {
      switch (typeof f) {
        case "undefined":
        case "function":
        case "symbol":
        case "boolean":
          a.removeAttribute(l);
          return;
      }
      a.setAttribute(l, "" + f);
    }
  }
  function ui(a, l, f, y) {
    if (y === null) a.removeAttribute(f);
    else {
      switch (typeof y) {
        case "undefined":
        case "function":
        case "symbol":
        case "boolean":
          a.removeAttribute(f);
          return;
      }
      a.setAttributeNS(l, f, "" + y);
    }
  }
  function xr(a) {
    switch (typeof a) {
      case "bigint":
      case "boolean":
      case "number":
      case "string":
      case "undefined":
        return a;
      case "object":
        return a;
      default:
        return "";
    }
  }
  function xa(a) {
    var l = a.type;
    return (a = a.nodeName) && a.toLowerCase() === "input" && (l === "checkbox" || l === "radio");
  }
  function Ru(a, l, f) {
    var y = Object.getOwnPropertyDescriptor(
      a.constructor.prototype,
      l
    );
    if (!a.hasOwnProperty(l) && typeof y < "u" && typeof y.get == "function" && typeof y.set == "function") {
      var _ = y.get, N = y.set;
      return Object.defineProperty(a, l, {
        configurable: !0,
        get: function() {
          return _.call(this);
        },
        set: function(B) {
          f = "" + B, N.call(this, B);
        }
      }), Object.defineProperty(a, l, {
        enumerable: y.enumerable
      }), {
        getValue: function() {
          return f;
        },
        setValue: function(B) {
          f = "" + B;
        },
        stopTracking: function() {
          a._valueTracker = null, delete a[l];
        }
      };
    }
  }
  function ba(a) {
    if (!a._valueTracker) {
      var l = xa(a) ? "checked" : "value";
      a._valueTracker = Ru(
        a,
        l,
        "" + a[l]
      );
    }
  }
  function xs(a) {
    if (!a) return !1;
    var l = a._valueTracker;
    if (!l) return !0;
    var f = l.getValue(), y = "";
    return a && (y = xa(a) ? a.checked ? "true" : "false" : a.value), a = y, a !== f ? (l.setValue(a), !0) : !1;
  }
  function Zt(a) {
    if (a = a || (typeof document < "u" ? document : void 0), typeof a > "u") return null;
    try {
      return a.activeElement || a.body;
    } catch {
      return a.body;
    }
  }
  var Ks = /[\n"\\]/g;
  function hr(a) {
    return a.replace(
      Ks,
      function(l) {
        return "\\" + l.charCodeAt(0).toString(16) + " ";
      }
    );
  }
  function ci(a, l, f, y, _, N, B, ee) {
    a.name = "", B != null && typeof B != "function" && typeof B != "symbol" && typeof B != "boolean" ? a.type = B : a.removeAttribute("type"), l != null ? B === "number" ? (l === 0 && a.value === "" || a.value != l) && (a.value = "" + xr(l)) : a.value !== "" + xr(l) && (a.value = "" + xr(l)) : B !== "submit" && B !== "reset" || a.removeAttribute("value"), l != null ? Ys(a, B, xr(l)) : f != null ? Ys(a, B, xr(f)) : y != null && a.removeAttribute("value"), _ == null && N != null && (a.defaultChecked = !!N), _ != null && (a.checked = _ && typeof _ != "function" && typeof _ != "symbol"), ee != null && typeof ee != "function" && typeof ee != "symbol" && typeof ee != "boolean" ? a.name = "" + xr(ee) : a.removeAttribute("name");
  }
  function bs(a, l, f, y, _, N, B, ee) {
    if (N != null && typeof N != "function" && typeof N != "symbol" && typeof N != "boolean" && (a.type = N), l != null || f != null) {
      if (!(N !== "submit" && N !== "reset" || l != null)) {
        ba(a);
        return;
      }
      f = f != null ? "" + xr(f) : "", l = l != null ? "" + xr(l) : f, ee || l === a.value || (a.value = l), a.defaultValue = l;
    }
    y = y ?? _, y = typeof y != "function" && typeof y != "symbol" && !!y, a.checked = ee ? a.checked : !!y, a.defaultChecked = !!y, B != null && typeof B != "function" && typeof B != "symbol" && typeof B != "boolean" && (a.name = B), ba(a);
  }
  function Ys(a, l, f) {
    l === "number" && Zt(a.ownerDocument) === a || a.defaultValue === "" + f || (a.defaultValue = "" + f);
  }
  function fi(a, l, f, y) {
    if (a = a.options, l) {
      l = {};
      for (var _ = 0; _ < f.length; _++)
        l["$" + f[_]] = !0;
      for (f = 0; f < a.length; f++)
        _ = l.hasOwnProperty("$" + a[f].value), a[f].selected !== _ && (a[f].selected = _), _ && y && (a[f].defaultSelected = !0);
    } else {
      for (f = "" + xr(f), l = null, _ = 0; _ < a.length; _++) {
        if (a[_].value === f) {
          a[_].selected = !0, y && (a[_].defaultSelected = !0);
          return;
        }
        l !== null || a[_].disabled || (l = a[_]);
      }
      l !== null && (l.selected = !0);
    }
  }
  function Fl(a, l, f) {
    if (l != null && (l = "" + xr(l), l !== a.value && (a.value = l), f == null)) {
      a.defaultValue !== l && (a.defaultValue = l);
      return;
    }
    a.defaultValue = f != null ? "" + xr(f) : "";
  }
  function Ws(a, l, f, y) {
    if (l == null) {
      if (y != null) {
        if (f != null) throw Error(r(92));
        if (se(y)) {
          if (1 < y.length) throw Error(r(93));
          y = y[0];
        }
        f = y;
      }
      f == null && (f = ""), l = f;
    }
    f = xr(l), a.defaultValue = f, y = a.textContent, y === f && y !== "" && y !== null && (a.value = y), ba(a);
  }
  function Ei(a, l) {
    if (l) {
      var f = a.firstChild;
      if (f && f === a.lastChild && f.nodeType === 3) {
        f.nodeValue = l;
        return;
      }
    }
    a.textContent = l;
  }
  var Vd = new Set(
    "animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(
      " "
    )
  );
  function Yt(a, l, f) {
    var y = l.indexOf("--") === 0;
    f == null || typeof f == "boolean" || f === "" ? y ? a.setProperty(l, "") : l === "float" ? a.cssFloat = "" : a[l] = "" : y ? a.setProperty(l, f) : typeof f != "number" || f === 0 || Vd.has(l) ? l === "float" ? a.cssFloat = f : a[l] = ("" + f).trim() : a[l] = f + "px";
  }
  function Kc(a, l, f) {
    if (l != null && typeof l != "object")
      throw Error(r(62));
    if (a = a.style, f != null) {
      for (var y in f)
        !f.hasOwnProperty(y) || l != null && l.hasOwnProperty(y) || (y.indexOf("--") === 0 ? a.setProperty(y, "") : y === "float" ? a.cssFloat = "" : a[y] = "");
      for (var _ in l)
        y = l[_], l.hasOwnProperty(_) && f[_] !== y && Yt(a, _, y);
    } else
      for (var N in l)
        l.hasOwnProperty(N) && Yt(a, N, l[N]);
  }
  function Ou(a) {
    if (a.indexOf("-") === -1) return !1;
    switch (a) {
      case "annotation-xml":
      case "color-profile":
      case "font-face":
      case "font-face-src":
      case "font-face-uri":
      case "font-face-format":
      case "font-face-name":
      case "missing-glyph":
        return !1;
      default:
        return !0;
    }
  }
  var Hd = /* @__PURE__ */ new Map([
    ["acceptCharset", "accept-charset"],
    ["htmlFor", "for"],
    ["httpEquiv", "http-equiv"],
    ["crossOrigin", "crossorigin"],
    ["accentHeight", "accent-height"],
    ["alignmentBaseline", "alignment-baseline"],
    ["arabicForm", "arabic-form"],
    ["baselineShift", "baseline-shift"],
    ["capHeight", "cap-height"],
    ["clipPath", "clip-path"],
    ["clipRule", "clip-rule"],
    ["colorInterpolation", "color-interpolation"],
    ["colorInterpolationFilters", "color-interpolation-filters"],
    ["colorProfile", "color-profile"],
    ["colorRendering", "color-rendering"],
    ["dominantBaseline", "dominant-baseline"],
    ["enableBackground", "enable-background"],
    ["fillOpacity", "fill-opacity"],
    ["fillRule", "fill-rule"],
    ["floodColor", "flood-color"],
    ["floodOpacity", "flood-opacity"],
    ["fontFamily", "font-family"],
    ["fontSize", "font-size"],
    ["fontSizeAdjust", "font-size-adjust"],
    ["fontStretch", "font-stretch"],
    ["fontStyle", "font-style"],
    ["fontVariant", "font-variant"],
    ["fontWeight", "font-weight"],
    ["glyphName", "glyph-name"],
    ["glyphOrientationHorizontal", "glyph-orientation-horizontal"],
    ["glyphOrientationVertical", "glyph-orientation-vertical"],
    ["horizAdvX", "horiz-adv-x"],
    ["horizOriginX", "horiz-origin-x"],
    ["imageRendering", "image-rendering"],
    ["letterSpacing", "letter-spacing"],
    ["lightingColor", "lighting-color"],
    ["markerEnd", "marker-end"],
    ["markerMid", "marker-mid"],
    ["markerStart", "marker-start"],
    ["overlinePosition", "overline-position"],
    ["overlineThickness", "overline-thickness"],
    ["paintOrder", "paint-order"],
    ["panose-1", "panose-1"],
    ["pointerEvents", "pointer-events"],
    ["renderingIntent", "rendering-intent"],
    ["shapeRendering", "shape-rendering"],
    ["stopColor", "stop-color"],
    ["stopOpacity", "stop-opacity"],
    ["strikethroughPosition", "strikethrough-position"],
    ["strikethroughThickness", "strikethrough-thickness"],
    ["strokeDasharray", "stroke-dasharray"],
    ["strokeDashoffset", "stroke-dashoffset"],
    ["strokeLinecap", "stroke-linecap"],
    ["strokeLinejoin", "stroke-linejoin"],
    ["strokeMiterlimit", "stroke-miterlimit"],
    ["strokeOpacity", "stroke-opacity"],
    ["strokeWidth", "stroke-width"],
    ["textAnchor", "text-anchor"],
    ["textDecoration", "text-decoration"],
    ["textRendering", "text-rendering"],
    ["transformOrigin", "transform-origin"],
    ["underlinePosition", "underline-position"],
    ["underlineThickness", "underline-thickness"],
    ["unicodeBidi", "unicode-bidi"],
    ["unicodeRange", "unicode-range"],
    ["unitsPerEm", "units-per-em"],
    ["vAlphabetic", "v-alphabetic"],
    ["vHanging", "v-hanging"],
    ["vIdeographic", "v-ideographic"],
    ["vMathematical", "v-mathematical"],
    ["vectorEffect", "vector-effect"],
    ["vertAdvY", "vert-adv-y"],
    ["vertOriginX", "vert-origin-x"],
    ["vertOriginY", "vert-origin-y"],
    ["wordSpacing", "word-spacing"],
    ["writingMode", "writing-mode"],
    ["xmlnsXlink", "xmlns:xlink"],
    ["xHeight", "x-height"]
  ]), ti = /^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;
  function wa(a) {
    return ti.test("" + a) ? "javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')" : a;
  }
  function ki() {
  }
  var _a = null;
  function Du(a) {
    return a = a.target || a.srcElement || window, a.correspondingUseElement && (a = a.correspondingUseElement), a.nodeType === 3 ? a.parentNode : a;
  }
  var ws = null, In = null;
  function Vi(a) {
    var l = on(a);
    if (l && (a = l.stateNode)) {
      var f = a[Qn] || null;
      e: switch (a = l.stateNode, l.type) {
        case "input":
          if (ci(
            a,
            f.value,
            f.defaultValue,
            f.defaultValue,
            f.checked,
            f.defaultChecked,
            f.type,
            f.name
          ), l = f.name, f.type === "radio" && l != null) {
            for (f = a; f.parentNode; ) f = f.parentNode;
            for (f = f.querySelectorAll(
              'input[name="' + hr(
                "" + l
              ) + '"][type="radio"]'
            ), l = 0; l < f.length; l++) {
              var y = f[l];
              if (y !== a && y.form === a.form) {
                var _ = y[Qn] || null;
                if (!_) throw Error(r(90));
                ci(
                  y,
                  _.value,
                  _.defaultValue,
                  _.defaultValue,
                  _.checked,
                  _.defaultChecked,
                  _.type,
                  _.name
                );
              }
            }
            for (l = 0; l < f.length; l++)
              y = f[l], y.form === a.form && xs(y);
          }
          break e;
        case "textarea":
          Fl(a, f.value, f.defaultValue);
          break e;
        case "select":
          l = f.value, l != null && fi(a, !!f.multiple, l, !1);
      }
    }
  }
  var Xs = !1;
  function Lo(a, l, f) {
    if (Xs) return a(l, f);
    Xs = !0;
    try {
      var y = a(l);
      return y;
    } finally {
      if (Xs = !1, (ws !== null || In !== null) && (Dh(), ws && (l = ws, a = In, In = ws = null, Vi(l), a)))
        for (l = 0; l < a.length; l++) Vi(a[l]);
    }
  }
  function Ya(a, l) {
    var f = a.stateNode;
    if (f === null) return null;
    var y = f[Qn] || null;
    if (y === null) return null;
    f = y[l];
    e: switch (l) {
      case "onClick":
      case "onClickCapture":
      case "onDoubleClick":
      case "onDoubleClickCapture":
      case "onMouseDown":
      case "onMouseDownCapture":
      case "onMouseMove":
      case "onMouseMoveCapture":
      case "onMouseUp":
      case "onMouseUpCapture":
      case "onMouseEnter":
        (y = !y.disabled) || (a = a.type, y = !(a === "button" || a === "input" || a === "select" || a === "textarea")), a = !y;
        break e;
      default:
        a = !1;
    }
    if (a) return null;
    if (f && typeof f != "function")
      throw Error(
        r(231, l, typeof f)
      );
    return f;
  }
  var Rr = !(typeof window > "u" || typeof window.document > "u" || typeof window.document.createElement > "u"), Yc = !1;
  if (Rr)
    try {
      var ni = {};
      Object.defineProperty(ni, "passive", {
        get: function() {
          Yc = !0;
        }
      }), window.addEventListener("test", ni, ni), window.removeEventListener("test", ni, ni);
    } catch {
      Yc = !1;
    }
  var Sa = null, Iu = null, cn = null;
  function ln() {
    if (cn) return cn;
    var a, l = Iu, f = l.length, y, _ = "value" in Sa ? Sa.value : Sa.textContent, N = _.length;
    for (a = 0; a < f && l[a] === _[a]; a++) ;
    var B = f - a;
    for (y = 1; y <= B && l[f - y] === _[N - y]; y++) ;
    return cn = _.slice(a, 1 < y ? 1 - y : void 0);
  }
  function Bo(a) {
    var l = a.keyCode;
    return "charCode" in a ? (a = a.charCode, a === 0 && l === 13 && (a = 13)) : a = l, a === 10 && (a = 13), 32 <= a || a === 13 ? a : 0;
  }
  function Ul() {
    return !0;
  }
  function Gd() {
    return !1;
  }
  function br(a) {
    function l(f, y, _, N, B) {
      this._reactName = f, this._targetInst = _, this.type = y, this.nativeEvent = N, this.target = B, this.currentTarget = null;
      for (var ee in a)
        a.hasOwnProperty(ee) && (f = a[ee], this[ee] = f ? f(N) : N[ee]);
      return this.isDefaultPrevented = (N.defaultPrevented != null ? N.defaultPrevented : N.returnValue === !1) ? Ul : Gd, this.isPropagationStopped = Gd, this;
    }
    return p(l.prototype, {
      preventDefault: function() {
        this.defaultPrevented = !0;
        var f = this.nativeEvent;
        f && (f.preventDefault ? f.preventDefault() : typeof f.returnValue != "unknown" && (f.returnValue = !1), this.isDefaultPrevented = Ul);
      },
      stopPropagation: function() {
        var f = this.nativeEvent;
        f && (f.stopPropagation ? f.stopPropagation() : typeof f.cancelBubble != "unknown" && (f.cancelBubble = !0), this.isPropagationStopped = Ul);
      },
      persist: function() {
      },
      isPersistent: Ul
    }), l;
  }
  var Qs = {
    eventPhase: 0,
    bubbles: 0,
    cancelable: 0,
    timeStamp: function(a) {
      return a.timeStamp || Date.now();
    },
    defaultPrevented: 0,
    isTrusted: 0
  }, Pu = br(Qs), Wa = p({}, Qs, { view: 0, detail: 0 }), zu = br(Wa), Jn, $l, Hi, Vl = p({}, Wa, {
    screenX: 0,
    screenY: 0,
    clientX: 0,
    clientY: 0,
    pageX: 0,
    pageY: 0,
    ctrlKey: 0,
    shiftKey: 0,
    altKey: 0,
    metaKey: 0,
    getModifierState: Xa,
    button: 0,
    buttons: 0,
    relatedTarget: function(a) {
      return a.relatedTarget === void 0 ? a.fromElement === a.srcElement ? a.toElement : a.fromElement : a.relatedTarget;
    },
    movementX: function(a) {
      return "movementX" in a ? a.movementX : (a !== Hi && (Hi && a.type === "mousemove" ? (Jn = a.screenX - Hi.screenX, $l = a.screenY - Hi.screenY) : $l = Jn = 0, Hi = a), Jn);
    },
    movementY: function(a) {
      return "movementY" in a ? a.movementY : $l;
    }
  }), qo = br(Vl), ri = p({}, Vl, { dataTransfer: 0 }), Wc = br(ri), Hl = p({}, Wa, { relatedTarget: 0 }), Zs = br(Hl), Gl = p({}, Qs, {
    animationName: 0,
    elapsedTime: 0,
    pseudoElement: 0
  }), Xc = br(Gl), Kd = p({}, Qs, {
    clipboardData: function(a) {
      return "clipboardData" in a ? a.clipboardData : window.clipboardData;
    }
  }), wr = br(Kd), Qc = p({}, Qs, { data: 0 }), qr = br(Qc), Zc = {
    Esc: "Escape",
    Spacebar: " ",
    Left: "ArrowLeft",
    Up: "ArrowUp",
    Right: "ArrowRight",
    Down: "ArrowDown",
    Del: "Delete",
    Win: "OS",
    Menu: "ContextMenu",
    Apps: "ContextMenu",
    Scroll: "ScrollLock",
    MozPrintableKey: "Unidentified"
  }, Lu = {
    8: "Backspace",
    9: "Tab",
    12: "Clear",
    13: "Enter",
    16: "Shift",
    17: "Control",
    18: "Alt",
    19: "Pause",
    20: "CapsLock",
    27: "Escape",
    32: " ",
    33: "PageUp",
    34: "PageDown",
    35: "End",
    36: "Home",
    37: "ArrowLeft",
    38: "ArrowUp",
    39: "ArrowRight",
    40: "ArrowDown",
    45: "Insert",
    46: "Delete",
    112: "F1",
    113: "F2",
    114: "F3",
    115: "F4",
    116: "F5",
    117: "F6",
    118: "F7",
    119: "F8",
    120: "F9",
    121: "F10",
    122: "F11",
    123: "F12",
    144: "NumLock",
    145: "ScrollLock",
    224: "Meta"
  }, Pn = {
    Alt: "altKey",
    Control: "ctrlKey",
    Meta: "metaKey",
    Shift: "shiftKey"
  };
  function _s(a) {
    var l = this.nativeEvent;
    return l.getModifierState ? l.getModifierState(a) : (a = Pn[a]) ? !!l[a] : !1;
  }
  function Xa() {
    return _s;
  }
  var Tn = p({}, Wa, {
    key: function(a) {
      if (a.key) {
        var l = Zc[a.key] || a.key;
        if (l !== "Unidentified") return l;
      }
      return a.type === "keypress" ? (a = Bo(a), a === 13 ? "Enter" : String.fromCharCode(a)) : a.type === "keydown" || a.type === "keyup" ? Lu[a.keyCode] || "Unidentified" : "";
    },
    code: 0,
    location: 0,
    ctrlKey: 0,
    shiftKey: 0,
    altKey: 0,
    metaKey: 0,
    repeat: 0,
    locale: 0,
    getModifierState: Xa,
    charCode: function(a) {
      return a.type === "keypress" ? Bo(a) : 0;
    },
    keyCode: function(a) {
      return a.type === "keydown" || a.type === "keyup" ? a.keyCode : 0;
    },
    which: function(a) {
      return a.type === "keypress" ? Bo(a) : a.type === "keydown" || a.type === "keyup" ? a.keyCode : 0;
    }
  }), Gi = br(Tn), Bu = p({}, Vl, {
    pointerId: 0,
    width: 0,
    height: 0,
    pressure: 0,
    tangentialPressure: 0,
    tiltX: 0,
    tiltY: 0,
    twist: 0,
    pointerType: 0,
    isPrimary: 0
  }), Jc = br(Bu), Fo = p({}, Wa, {
    touches: 0,
    targetTouches: 0,
    changedTouches: 0,
    altKey: 0,
    metaKey: 0,
    ctrlKey: 0,
    shiftKey: 0,
    getModifierState: Xa
  }), ef = br(Fo), Js = p({}, Qs, {
    propertyName: 0,
    elapsedTime: 0,
    pseudoElement: 0
  }), tf = br(Js), qu = p({}, Vl, {
    deltaX: function(a) {
      return "deltaX" in a ? a.deltaX : "wheelDeltaX" in a ? -a.wheelDeltaX : 0;
    },
    deltaY: function(a) {
      return "deltaY" in a ? a.deltaY : "wheelDeltaY" in a ? -a.wheelDeltaY : "wheelDelta" in a ? -a.wheelDelta : 0;
    },
    deltaZ: 0,
    deltaMode: 0
  }), eo = br(qu), Ss = p({}, Qs, {
    newState: 0,
    oldState: 0
  }), Yd = br(Ss), Wd = [9, 13, 27, 32], Uo = Rr && "CompositionEvent" in window, Ca = null;
  Rr && "documentMode" in document && (Ca = document.documentMode);
  var nf = Rr && "TextEvent" in window && !Ca, Kl = Rr && (!Uo || Ca && 8 < Ca && 11 >= Ca), Fu = " ", Uu = !1;
  function Yl(a, l) {
    switch (a) {
      case "keyup":
        return Wd.indexOf(l.keyCode) !== -1;
      case "keydown":
        return l.keyCode !== 229;
      case "keypress":
      case "mousedown":
      case "focusout":
        return !0;
      default:
        return !1;
    }
  }
  function Xd(a) {
    return a = a.detail, typeof a == "object" && "data" in a ? a.data : null;
  }
  var Cs = !1;
  function ii(a, l) {
    switch (a) {
      case "compositionend":
        return Xd(l);
      case "keypress":
        return l.which !== 32 ? null : (Uu = !0, Fu);
      case "textInput":
        return a = l.data, a === Fu && Uu ? null : a;
      default:
        return null;
    }
  }
  function rf(a, l) {
    if (Cs)
      return a === "compositionend" || !Uo && Yl(a, l) ? (a = ln(), cn = Iu = Sa = null, Cs = !1, a) : null;
    switch (a) {
      case "paste":
        return null;
      case "keypress":
        if (!(l.ctrlKey || l.altKey || l.metaKey) || l.ctrlKey && l.altKey) {
          if (l.char && 1 < l.char.length)
            return l.char;
          if (l.which) return String.fromCharCode(l.which);
        }
        return null;
      case "compositionend":
        return Kl && l.locale !== "ko" ? null : l.data;
      default:
        return null;
    }
  }
  var $o = {
    color: !0,
    date: !0,
    datetime: !0,
    "datetime-local": !0,
    email: !0,
    month: !0,
    number: !0,
    password: !0,
    range: !0,
    search: !0,
    tel: !0,
    text: !0,
    time: !0,
    url: !0,
    week: !0
  };
  function Wl(a) {
    var l = a && a.nodeName && a.nodeName.toLowerCase();
    return l === "input" ? !!$o[a.type] : l === "textarea";
  }
  function $u(a, l, f, y) {
    ws ? In ? In.push(y) : In = [y] : ws = y, l = Xf(l, "onChange"), 0 < l.length && (f = new Pu(
      "onChange",
      "change",
      null,
      f,
      y
    ), a.push({ event: f, listeners: l }));
  }
  var Vo = null, Xl = null;
  function Wm(a) {
    t1(a, 0);
  }
  function Vu(a) {
    var l = ei(a);
    if (xs(l)) return a;
  }
  function Ql(a, l) {
    if (a === "change") return l;
  }
  var Fr = !1;
  if (Rr) {
    var zn;
    if (Rr) {
      var Ho = "oninput" in document;
      if (!Ho) {
        var Ur = document.createElement("div");
        Ur.setAttribute("oninput", "return;"), Ho = typeof Ur.oninput == "function";
      }
      zn = Ho;
    } else zn = !1;
    Fr = zn && (!document.documentMode || 9 < document.documentMode);
  }
  function af() {
    Vo && (Vo.detachEvent("onpropertychange", Ki), Xl = Vo = null);
  }
  function Ki(a) {
    if (a.propertyName === "value" && Vu(Xl)) {
      var l = [];
      $u(
        l,
        Xl,
        a,
        Du(a)
      ), Lo(Wm, l);
    }
  }
  function Zl(a, l, f) {
    a === "focusin" ? (af(), Vo = l, Xl = f, Vo.attachEvent("onpropertychange", Ki)) : a === "focusout" && af();
  }
  function to(a) {
    if (a === "selectionchange" || a === "keyup" || a === "keydown")
      return Vu(Xl);
  }
  function sf(a, l) {
    if (a === "click") return Vu(l);
  }
  function Go(a, l) {
    if (a === "input" || a === "change")
      return Vu(l);
  }
  function di(a, l) {
    return a === l && (a !== 0 || 1 / a === 1 / l) || a !== a && l !== l;
  }
  var Mn = typeof Object.is == "function" ? Object.is : di;
  function w(a, l) {
    if (Mn(a, l)) return !0;
    if (typeof a != "object" || a === null || typeof l != "object" || l === null)
      return !1;
    var f = Object.keys(a), y = Object.keys(l);
    if (f.length !== y.length) return !1;
    for (y = 0; y < f.length; y++) {
      var _ = f[y];
      if (!Rn.call(l, _) || !Mn(a[_], l[_]))
        return !1;
    }
    return !0;
  }
  function E(a) {
    for (; a && a.firstChild; ) a = a.firstChild;
    return a;
  }
  function R(a, l) {
    var f = E(a);
    a = 0;
    for (var y; f; ) {
      if (f.nodeType === 3) {
        if (y = a + f.textContent.length, a <= l && y >= l)
          return { node: f, offset: l - a };
        a = y;
      }
      e: {
        for (; f; ) {
          if (f.nextSibling) {
            f = f.nextSibling;
            break e;
          }
          f = f.parentNode;
        }
        f = void 0;
      }
      f = E(f);
    }
  }
  function P(a, l) {
    return a && l ? a === l ? !0 : a && a.nodeType === 3 ? !1 : l && l.nodeType === 3 ? P(a, l.parentNode) : "contains" in a ? a.contains(l) : a.compareDocumentPosition ? !!(a.compareDocumentPosition(l) & 16) : !1 : !1;
  }
  function q(a) {
    a = a != null && a.ownerDocument != null && a.ownerDocument.defaultView != null ? a.ownerDocument.defaultView : window;
    for (var l = Zt(a.document); l instanceof a.HTMLIFrameElement; ) {
      try {
        var f = typeof l.contentWindow.location.href == "string";
      } catch {
        f = !1;
      }
      if (f) a = l.contentWindow;
      else break;
      l = Zt(a.document);
    }
    return l;
  }
  function X(a) {
    var l = a && a.nodeName && a.nodeName.toLowerCase();
    return l && (l === "input" && (a.type === "text" || a.type === "search" || a.type === "tel" || a.type === "url" || a.type === "password") || l === "textarea" || a.contentEditable === "true");
  }
  var oe = Rr && "documentMode" in document && 11 >= document.documentMode, U = null, ie = null, re = null, pe = !1;
  function he(a, l, f) {
    var y = f.window === f ? f.document : f.nodeType === 9 ? f : f.ownerDocument;
    pe || U == null || U !== Zt(y) || (y = U, "selectionStart" in y && X(y) ? y = { start: y.selectionStart, end: y.selectionEnd } : (y = (y.ownerDocument && y.ownerDocument.defaultView || window).getSelection(), y = {
      anchorNode: y.anchorNode,
      anchorOffset: y.anchorOffset,
      focusNode: y.focusNode,
      focusOffset: y.focusOffset
    }), re && w(re, y) || (re = y, y = Xf(ie, "onSelect"), 0 < y.length && (l = new Pu(
      "onSelect",
      "select",
      null,
      l,
      f
    ), a.push({ event: l, listeners: y }), l.target = U)));
  }
  function _e(a, l) {
    var f = {};
    return f[a.toLowerCase()] = l.toLowerCase(), f["Webkit" + a] = "webkit" + l, f["Moz" + a] = "moz" + l, f;
  }
  var be = {
    animationend: _e("Animation", "AnimationEnd"),
    animationiteration: _e("Animation", "AnimationIteration"),
    animationstart: _e("Animation", "AnimationStart"),
    transitionrun: _e("Transition", "TransitionRun"),
    transitionstart: _e("Transition", "TransitionStart"),
    transitioncancel: _e("Transition", "TransitionCancel"),
    transitionend: _e("Transition", "TransitionEnd")
  }, we = {}, ke = {};
  Rr && (ke = document.createElement("div").style, "AnimationEvent" in window || (delete be.animationend.animation, delete be.animationiteration.animation, delete be.animationstart.animation), "TransitionEvent" in window || delete be.transitionend.transition);
  function Te(a) {
    if (we[a]) return we[a];
    if (!be[a]) return a;
    var l = be[a], f;
    for (f in l)
      if (l.hasOwnProperty(f) && f in ke)
        return we[a] = l[f];
    return a;
  }
  var je = Te("animationend"), ze = Te("animationiteration"), $e = Te("animationstart"), Ge = Te("transitionrun"), nt = Te("transitionstart"), lt = Te("transitioncancel"), He = Te("transitionend"), ot = /* @__PURE__ */ new Map(), ut = "abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(
    " "
  );
  ut.push("scrollEnd");
  function Je(a, l) {
    ot.set(a, l), Ci(l, [a]);
  }
  var pt = typeof reportError == "function" ? reportError : function(a) {
    if (typeof window == "object" && typeof window.ErrorEvent == "function") {
      var l = new window.ErrorEvent("error", {
        bubbles: !0,
        cancelable: !0,
        message: typeof a == "object" && a !== null && typeof a.message == "string" ? String(a.message) : String(a),
        error: a
      });
      if (!window.dispatchEvent(l)) return;
    } else if (typeof process == "object" && typeof process.emit == "function") {
      process.emit("uncaughtException", a);
      return;
    }
    console.error(a);
  }, _t = [], Rt = 0, Dt = 0;
  function Ln() {
    for (var a = Rt, l = Dt = Rt = 0; l < a; ) {
      var f = _t[l];
      _t[l++] = null;
      var y = _t[l];
      _t[l++] = null;
      var _ = _t[l];
      _t[l++] = null;
      var N = _t[l];
      if (_t[l++] = null, y !== null && _ !== null) {
        var B = y.pending;
        B === null ? _.next = _ : (_.next = B.next, B.next = _), y.pending = _;
      }
      N !== 0 && Ko(f, _, N);
    }
  }
  function Et(a, l, f, y) {
    _t[Rt++] = a, _t[Rt++] = l, _t[Rt++] = f, _t[Rt++] = y, Dt |= y, a.lanes |= y, a = a.alternate, a !== null && (a.lanes |= y);
  }
  function mr(a, l, f, y) {
    return Et(a, l, f, y), pr(a);
  }
  function Nn(a, l) {
    return Et(a, null, null, l), pr(a);
  }
  function Ko(a, l, f) {
    a.lanes |= f;
    var y = a.alternate;
    y !== null && (y.lanes |= f);
    for (var _ = !1, N = a.return; N !== null; )
      N.childLanes |= f, y = N.alternate, y !== null && (y.childLanes |= f), N.tag === 22 && (a = N.stateNode, a === null || a._visibility & 1 || (_ = !0)), a = N, N = N.return;
    return a.tag === 3 ? (N = a.stateNode, _ && l !== null && (_ = 31 - it(f), a = N.hiddenUpdates, y = a[_], y === null ? a[_] = [l] : y.push(l), l.lane = f | 536870912), N) : null;
  }
  function pr(a) {
    if (50 < $f)
      throw $f = 0, Yp = null, Error(r(185));
    for (var l = a.return; l !== null; )
      a = l, l = a.return;
    return a.tag === 3 ? a.stateNode : null;
  }
  var $r = {};
  function Hu(a, l, f, y) {
    this.tag = a, this.key = f, this.sibling = this.child = this.return = this.stateNode = this.type = this.elementType = null, this.index = 0, this.refCleanup = this.ref = null, this.pendingProps = l, this.dependencies = this.memoizedState = this.updateQueue = this.memoizedProps = null, this.mode = y, this.subtreeFlags = this.flags = 0, this.deletions = null, this.childLanes = this.lanes = 0, this.alternate = null;
  }
  function Vr(a, l, f, y) {
    return new Hu(a, l, f, y);
  }
  function no(a) {
    return a = a.prototype, !(!a || !a.isReactComponent);
  }
  function Ea(a, l) {
    var f = a.alternate;
    return f === null ? (f = Vr(
      a.tag,
      l,
      a.key,
      a.mode
    ), f.elementType = a.elementType, f.type = a.type, f.stateNode = a.stateNode, f.alternate = a, a.alternate = f) : (f.pendingProps = l, f.type = a.type, f.flags = 0, f.subtreeFlags = 0, f.deletions = null), f.flags = a.flags & 65011712, f.childLanes = a.childLanes, f.lanes = a.lanes, f.child = a.child, f.memoizedProps = a.memoizedProps, f.memoizedState = a.memoizedState, f.updateQueue = a.updateQueue, l = a.dependencies, f.dependencies = l === null ? null : { lanes: l.lanes, firstContext: l.firstContext }, f.sibling = a.sibling, f.index = a.index, f.ref = a.ref, f.refCleanup = a.refCleanup, f;
  }
  function X0(a, l) {
    a.flags &= 65011714;
    var f = a.alternate;
    return f === null ? (a.childLanes = 0, a.lanes = l, a.child = null, a.subtreeFlags = 0, a.memoizedProps = null, a.memoizedState = null, a.updateQueue = null, a.dependencies = null, a.stateNode = null) : (a.childLanes = f.childLanes, a.lanes = f.lanes, a.child = f.child, a.subtreeFlags = 0, a.deletions = null, a.memoizedProps = f.memoizedProps, a.memoizedState = f.memoizedState, a.updateQueue = f.updateQueue, a.type = f.type, l = f.dependencies, a.dependencies = l === null ? null : {
      lanes: l.lanes,
      firstContext: l.firstContext
    }), a;
  }
  function Qd(a, l, f, y, _, N) {
    var B = 0;
    if (y = a, typeof a == "function") no(a) && (B = 1);
    else if (typeof a == "string")
      B = wb(
        a,
        f,
        le.current
      ) ? 26 : a === "html" || a === "head" || a === "body" ? 27 : 5;
    else
      e: switch (a) {
        case ne:
          return a = Vr(31, f, l, _), a.elementType = ne, a.lanes = N, a;
        case k:
          return Jl(f.children, _, N, l);
        case A:
          B = 8, _ |= 24;
          break;
        case T:
          return a = Vr(12, f, l, _ | 2), a.elementType = T, a.lanes = N, a;
        case z:
          return a = Vr(13, f, l, _), a.elementType = z, a.lanes = N, a;
        case I:
          return a = Vr(19, f, l, _), a.elementType = I, a.lanes = N, a;
        default:
          if (typeof a == "object" && a !== null)
            switch (a.$$typeof) {
              case j:
                B = 10;
                break e;
              case M:
                B = 9;
                break e;
              case D:
                B = 11;
                break e;
              case L:
                B = 14;
                break e;
              case K:
                B = 16, y = null;
                break e;
            }
          B = 29, f = Error(
            r(130, a === null ? "null" : typeof a, "")
          ), y = null;
      }
    return l = Vr(B, f, l, _), l.elementType = a, l.type = y, l.lanes = N, l;
  }
  function Jl(a, l, f, y) {
    return a = Vr(7, a, y, l), a.lanes = f, a;
  }
  function Gu(a, l, f) {
    return a = Vr(6, a, null, l), a.lanes = f, a;
  }
  function of(a) {
    var l = Vr(18, null, null, 0);
    return l.stateNode = a, l;
  }
  function lf(a, l, f) {
    return l = Vr(
      4,
      a.children !== null ? a.children : [],
      a.key,
      l
    ), l.lanes = f, l.stateNode = {
      containerInfo: a.containerInfo,
      pendingChildren: null,
      implementation: a.implementation
    }, l;
  }
  var Q0 = /* @__PURE__ */ new WeakMap();
  function Yi(a, l) {
    if (typeof a == "object" && a !== null) {
      var f = Q0.get(a);
      return f !== void 0 ? f : (l = {
        value: a,
        source: l,
        stack: Wn(l)
      }, Q0.set(a, l), l);
    }
    return {
      value: a,
      source: l,
      stack: Wn(l)
    };
  }
  var Ku = [], Yu = 0, rr = null, _r = 0, ka = [], Ta = 0, ro = null, Es = 1, Na = "";
  function Wi(a, l) {
    Ku[Yu++] = _r, Ku[Yu++] = rr, rr = a, _r = l;
  }
  function Zd(a, l, f) {
    ka[Ta++] = Es, ka[Ta++] = Na, ka[Ta++] = ro, ro = a;
    var y = Es;
    a = Na;
    var _ = 32 - it(y) - 1;
    y &= ~(1 << _), f += 1;
    var N = 32 - it(l) + _;
    if (30 < N) {
      var B = _ - _ % 5;
      N = (y & (1 << B) - 1).toString(32), y >>= B, _ -= B, Es = 1 << 32 - it(l) + _ | f << _ | y, Na = N + a;
    } else
      Es = 1 << N | f << _ | y, Na = a;
  }
  function Yo(a) {
    a.return !== null && (Wi(a, 1), Zd(a, 1, 0));
  }
  function eu(a) {
    for (; a === rr; )
      rr = Ku[--Yu], Ku[Yu] = null, _r = Ku[--Yu], Ku[Yu] = null;
    for (; a === ro; )
      ro = ka[--Ta], ka[Ta] = null, Na = ka[--Ta], ka[Ta] = null, Es = ka[--Ta], ka[Ta] = null;
  }
  function Wu(a, l) {
    ka[Ta++] = Es, ka[Ta++] = Na, ka[Ta++] = ro, Es = l.id, Na = l.overflow, ro = a;
  }
  var Sr = null, gn = null, Jt = !1, Wo = null, Aa = !1, Xm = Error(r(519));
  function Xo(a) {
    var l = Error(
      r(
        418,
        1 < arguments.length && arguments[1] !== void 0 && arguments[1] ? "text" : "HTML",
        ""
      )
    );
    throw Zo(Yi(l, a)), Xm;
  }
  function uf(a) {
    var l = a.stateNode, f = a.type, y = a.memoizedProps;
    switch (l[wn] = a, l[Qn] = y, f) {
      case "dialog":
        Kt("cancel", l), Kt("close", l);
        break;
      case "iframe":
      case "object":
      case "embed":
        Kt("load", l);
        break;
      case "video":
      case "audio":
        for (f = 0; f < Wf.length; f++)
          Kt(Wf[f], l);
        break;
      case "source":
        Kt("error", l);
        break;
      case "img":
      case "image":
      case "link":
        Kt("error", l), Kt("load", l);
        break;
      case "details":
        Kt("toggle", l);
        break;
      case "input":
        Kt("invalid", l), bs(
          l,
          y.value,
          y.defaultValue,
          y.checked,
          y.defaultChecked,
          y.type,
          y.name,
          !0
        );
        break;
      case "select":
        Kt("invalid", l);
        break;
      case "textarea":
        Kt("invalid", l), Ws(l, y.value, y.defaultValue, y.children);
    }
    f = y.children, typeof f != "string" && typeof f != "number" && typeof f != "bigint" || l.textContent === "" + f || y.suppressHydrationWarning === !0 || i1(l.textContent, f) ? (y.popover != null && (Kt("beforetoggle", l), Kt("toggle", l)), y.onScroll != null && Kt("scroll", l), y.onScrollEnd != null && Kt("scrollend", l), y.onClick != null && (l.onclick = ki), l = !0) : l = !1, l || Xo(a, !0);
  }
  function Xu(a) {
    for (Sr = a.return; Sr; )
      switch (Sr.tag) {
        case 5:
        case 31:
        case 13:
          Aa = !1;
          return;
        case 27:
        case 3:
          Aa = !0;
          return;
        default:
          Sr = Sr.return;
      }
  }
  function tu(a) {
    if (a !== Sr) return !1;
    if (!Jt) return Xu(a), Jt = !0, !1;
    var l = a.tag, f;
    if ((f = l !== 3 && l !== 27) && ((f = l === 5) && (f = a.type, f = !(f !== "form" && f !== "button") || ml(a.type, a.memoizedProps)), f = !f), f && gn && Xo(a), Xu(a), l === 13) {
      if (a = a.memoizedState, a = a !== null ? a.dehydrated : null, !a) throw Error(r(317));
      gn = u1(a);
    } else if (l === 31) {
      if (a = a.memoizedState, a = a !== null ? a.dehydrated : null, !a) throw Error(r(317));
      gn = u1(a);
    } else
      l === 27 ? (l = gn, At(a.type) ? (a = mg, mg = null, gn = a) : gn = l) : gn = Sr ? Pa(a.stateNode.nextSibling) : null;
    return !0;
  }
  function te() {
    gn = Sr = null, Jt = !1;
  }
  function Qo() {
    var a = Wo;
    return a !== null && (Oi === null ? Oi = a : Oi.push.apply(
      Oi,
      a
    ), Wo = null), a;
  }
  function Zo(a) {
    Wo === null ? Wo = [a] : Wo.push(a);
  }
  var Ti = $(null), Lt = null, io = null;
  function Jo(a, l, f) {
    G(Ti, l._currentValue), l._currentValue = f;
  }
  function ao(a) {
    a._currentValue = Ti.current, fe(Ti);
  }
  function so(a, l, f) {
    for (; a !== null; ) {
      var y = a.alternate;
      if ((a.childLanes & l) !== l ? (a.childLanes |= l, y !== null && (y.childLanes |= l)) : y !== null && (y.childLanes & l) !== l && (y.childLanes |= l), a === f) break;
      a = a.return;
    }
  }
  function Qm(a, l, f, y) {
    var _ = a.child;
    for (_ !== null && (_.return = a); _ !== null; ) {
      var N = _.dependencies;
      if (N !== null) {
        var B = _.child;
        N = N.firstContext;
        e: for (; N !== null; ) {
          var ee = N;
          N = _;
          for (var ye = 0; ye < l.length; ye++)
            if (ee.context === l[ye]) {
              N.lanes |= f, ee = N.alternate, ee !== null && (ee.lanes |= f), so(
                N.return,
                f,
                a
              ), y || (B = null);
              break e;
            }
          N = ee.next;
        }
      } else if (_.tag === 18) {
        if (B = _.return, B === null) throw Error(r(341));
        B.lanes |= f, N = B.alternate, N !== null && (N.lanes |= f), so(B, f, a), B = null;
      } else B = _.child;
      if (B !== null) B.return = _;
      else
        for (B = _; B !== null; ) {
          if (B === a) {
            B = null;
            break;
          }
          if (_ = B.sibling, _ !== null) {
            _.return = B.return, B = _;
            break;
          }
          B = B.return;
        }
      _ = B;
    }
  }
  function Qu(a, l, f, y) {
    a = null;
    for (var _ = l, N = !1; _ !== null; ) {
      if (!N) {
        if ((_.flags & 524288) !== 0) N = !0;
        else if ((_.flags & 262144) !== 0) break;
      }
      if (_.tag === 10) {
        var B = _.alternate;
        if (B === null) throw Error(r(387));
        if (B = B.memoizedProps, B !== null) {
          var ee = _.type;
          Mn(_.pendingProps.value, B.value) || (a !== null ? a.push(ee) : a = [ee]);
        }
      } else if (_ === Oe.current) {
        if (B = _.alternate, B === null) throw Error(r(387));
        B.memoizedState.memoizedState !== _.memoizedState.memoizedState && (a !== null ? a.push(Nc) : a = [Nc]);
      }
      _ = _.return;
    }
    a !== null && Qm(
      l,
      a,
      f,
      y
    ), l.flags |= 262144;
  }
  function Jd(a) {
    for (a = a.firstContext; a !== null; ) {
      if (!Mn(
        a.context._currentValue,
        a.memoizedValue
      ))
        return !0;
      a = a.next;
    }
    return !1;
  }
  function nu(a) {
    Lt = a, io = null, a = a.dependencies, a !== null && (a.firstContext = null);
  }
  function Hr(a) {
    return Z0(Lt, a);
  }
  function ja(a, l) {
    return Lt === null && nu(a), Z0(a, l);
  }
  function Z0(a, l) {
    var f = l._currentValue;
    if (l = { context: l, memoizedValue: f, next: null }, io === null) {
      if (a === null) throw Error(r(308));
      io = l, a.dependencies = { lanes: 0, firstContext: l }, a.flags |= 524288;
    } else io = io.next = l;
    return f;
  }
  var Fx = typeof AbortController < "u" ? AbortController : function() {
    var a = [], l = this.signal = {
      aborted: !1,
      addEventListener: function(f, y) {
        a.push(y);
      }
    };
    this.abort = function() {
      l.aborted = !0, a.forEach(function(f) {
        return f();
      });
    };
  }, Ux = e.unstable_scheduleCallback, $x = e.unstable_NormalPriority, Cr = {
    $$typeof: j,
    Consumer: null,
    Provider: null,
    _currentValue: null,
    _currentValue2: null,
    _threadCount: 0
  };
  function Qa() {
    return {
      controller: new Fx(),
      data: /* @__PURE__ */ new Map(),
      refCount: 0
    };
  }
  function cf(a) {
    a.refCount--, a.refCount === 0 && Ux($x, function() {
      a.controller.abort();
    });
  }
  var ff = null, Zm = 0, Zu = 0, Ju = null;
  function ru(a, l) {
    if (ff === null) {
      var f = ff = [];
      Zm = 0, Zu = ia(), Ju = {
        status: "pending",
        value: void 0,
        then: function(y) {
          f.push(y);
        }
      };
    }
    return Zm++, l.then(J0, J0), l;
  }
  function J0() {
    if (--Zm === 0 && ff !== null) {
      Ju !== null && (Ju.status = "fulfilled");
      var a = ff;
      ff = null, Zu = 0, Ju = null;
      for (var l = 0; l < a.length; l++) (0, a[l])();
    }
  }
  function Vx(a, l) {
    var f = [], y = {
      status: "pending",
      value: null,
      reason: null,
      then: function(_) {
        f.push(_);
      }
    };
    return a.then(
      function() {
        y.status = "fulfilled", y.value = l;
        for (var _ = 0; _ < f.length; _++) (0, f[_])(l);
      },
      function(_) {
        for (y.status = "rejected", y.reason = _, _ = 0; _ < f.length; _++)
          (0, f[_])(void 0);
      }
    ), y;
  }
  var Ma = J.S;
  J.S = function(a, l) {
    zy = En(), typeof l == "object" && l !== null && typeof l.then == "function" && ru(a, l), Ma !== null && Ma(a, l);
  };
  var iu = $(null);
  function Jm() {
    var a = iu.current;
    return a !== null ? a : jn.pooledCache;
  }
  function eh(a, l) {
    l === null ? G(iu, iu.current) : G(iu, l.pool);
  }
  function ey() {
    var a = Jm();
    return a === null ? null : { parent: Cr._currentValue, pool: a };
  }
  var ec = Error(r(460)), th = Error(r(474)), df = Error(r(542)), nh = { then: function() {
  } };
  function ty(a) {
    return a = a.status, a === "fulfilled" || a === "rejected";
  }
  function rh(a, l, f) {
    switch (f = a[f], f === void 0 ? a.push(l) : f !== l && (l.then(ki, ki), l = f), l.status) {
      case "fulfilled":
        return l.value;
      case "rejected":
        throw a = l.reason, ep(a), a;
      default:
        if (typeof l.status == "string") l.then(ki, ki);
        else {
          if (a = jn, a !== null && 100 < a.shellSuspendCounter)
            throw Error(r(482));
          a = l, a.status = "pending", a.then(
            function(y) {
              if (l.status === "pending") {
                var _ = l;
                _.status = "fulfilled", _.value = y;
              }
            },
            function(y) {
              if (l.status === "pending") {
                var _ = l;
                _.status = "rejected", _.reason = y;
              }
            }
          );
        }
        switch (l.status) {
          case "fulfilled":
            return l.value;
          case "rejected":
            throw a = l.reason, ep(a), a;
        }
        throw ks = l, ec;
    }
  }
  function Za(a) {
    try {
      var l = a._init;
      return l(a._payload);
    } catch (f) {
      throw f !== null && typeof f == "object" && typeof f.then == "function" ? (ks = f, ec) : f;
    }
  }
  var ks = null;
  function ny() {
    if (ks === null) throw Error(r(459));
    var a = ks;
    return ks = null, a;
  }
  function ep(a) {
    if (a === ec || a === df)
      throw Error(r(483));
  }
  var tc = null, Xi = 0;
  function nc(a) {
    var l = Xi;
    return Xi += 1, tc === null && (tc = []), rh(tc, a, l);
  }
  function Ja(a, l) {
    l = l.props.ref, a.ref = l !== void 0 ? l : null;
  }
  function hi(a, l) {
    throw l.$$typeof === x ? Error(r(525)) : (a = Object.prototype.toString.call(l), Error(
      r(
        31,
        a === "[object Object]" ? "object with keys {" + Object.keys(l).join(", ") + "}" : a
      )
    ));
  }
  function ry(a) {
    function l(Ae, Ee) {
      if (a) {
        var De = Ae.deletions;
        De === null ? (Ae.deletions = [Ee], Ae.flags |= 16) : De.push(Ee);
      }
    }
    function f(Ae, Ee) {
      if (!a) return null;
      for (; Ee !== null; )
        l(Ae, Ee), Ee = Ee.sibling;
      return null;
    }
    function y(Ae) {
      for (var Ee = /* @__PURE__ */ new Map(); Ae !== null; )
        Ae.key !== null ? Ee.set(Ae.key, Ae) : Ee.set(Ae.index, Ae), Ae = Ae.sibling;
      return Ee;
    }
    function _(Ae, Ee) {
      return Ae = Ea(Ae, Ee), Ae.index = 0, Ae.sibling = null, Ae;
    }
    function N(Ae, Ee, De) {
      return Ae.index = De, a ? (De = Ae.alternate, De !== null ? (De = De.index, De < Ee ? (Ae.flags |= 67108866, Ee) : De) : (Ae.flags |= 67108866, Ee)) : (Ae.flags |= 1048576, Ee);
    }
    function B(Ae) {
      return a && Ae.alternate === null && (Ae.flags |= 67108866), Ae;
    }
    function ee(Ae, Ee, De, Ke) {
      return Ee === null || Ee.tag !== 6 ? (Ee = Gu(De, Ae.mode, Ke), Ee.return = Ae, Ee) : (Ee = _(Ee, De), Ee.return = Ae, Ee);
    }
    function ye(Ae, Ee, De, Ke) {
      var St = De.type;
      return St === k ? Ve(
        Ae,
        Ee,
        De.props.children,
        Ke,
        De.key
      ) : Ee !== null && (Ee.elementType === St || typeof St == "object" && St !== null && St.$$typeof === K && Za(St) === Ee.type) ? (Ee = _(Ee, De.props), Ja(Ee, De), Ee.return = Ae, Ee) : (Ee = Qd(
        De.type,
        De.key,
        De.props,
        null,
        Ae.mode,
        Ke
      ), Ja(Ee, De), Ee.return = Ae, Ee);
    }
    function Pe(Ae, Ee, De, Ke) {
      return Ee === null || Ee.tag !== 4 || Ee.stateNode.containerInfo !== De.containerInfo || Ee.stateNode.implementation !== De.implementation ? (Ee = lf(De, Ae.mode, Ke), Ee.return = Ae, Ee) : (Ee = _(Ee, De.children || []), Ee.return = Ae, Ee);
    }
    function Ve(Ae, Ee, De, Ke, St) {
      return Ee === null || Ee.tag !== 7 ? (Ee = Jl(
        De,
        Ae.mode,
        Ke,
        St
      ), Ee.return = Ae, Ee) : (Ee = _(Ee, De), Ee.return = Ae, Ee);
    }
    function Ye(Ae, Ee, De) {
      if (typeof Ee == "string" && Ee !== "" || typeof Ee == "number" || typeof Ee == "bigint")
        return Ee = Gu(
          "" + Ee,
          Ae.mode,
          De
        ), Ee.return = Ae, Ee;
      if (typeof Ee == "object" && Ee !== null) {
        switch (Ee.$$typeof) {
          case b:
            return De = Qd(
              Ee.type,
              Ee.key,
              Ee.props,
              null,
              Ae.mode,
              De
            ), Ja(De, Ee), De.return = Ae, De;
          case S:
            return Ee = lf(
              Ee,
              Ae.mode,
              De
            ), Ee.return = Ae, Ee;
          case K:
            return Ee = Za(Ee), Ye(Ae, Ee, De);
        }
        if (se(Ee) || Z(Ee))
          return Ee = Jl(
            Ee,
            Ae.mode,
            De,
            null
          ), Ee.return = Ae, Ee;
        if (typeof Ee.then == "function")
          return Ye(Ae, nc(Ee), De);
        if (Ee.$$typeof === j)
          return Ye(
            Ae,
            ja(Ae, Ee),
            De
          );
        hi(Ae, Ee);
      }
      return null;
    }
    function Le(Ae, Ee, De, Ke) {
      var St = Ee !== null ? Ee.key : null;
      if (typeof De == "string" && De !== "" || typeof De == "number" || typeof De == "bigint")
        return St !== null ? null : ee(Ae, Ee, "" + De, Ke);
      if (typeof De == "object" && De !== null) {
        switch (De.$$typeof) {
          case b:
            return De.key === St ? ye(Ae, Ee, De, Ke) : null;
          case S:
            return De.key === St ? Pe(Ae, Ee, De, Ke) : null;
          case K:
            return De = Za(De), Le(Ae, Ee, De, Ke);
        }
        if (se(De) || Z(De))
          return St !== null ? null : Ve(Ae, Ee, De, Ke, null);
        if (typeof De.then == "function")
          return Le(
            Ae,
            Ee,
            nc(De),
            Ke
          );
        if (De.$$typeof === j)
          return Le(
            Ae,
            Ee,
            ja(Ae, De),
            Ke
          );
        hi(Ae, De);
      }
      return null;
    }
    function qe(Ae, Ee, De, Ke, St) {
      if (typeof Ke == "string" && Ke !== "" || typeof Ke == "number" || typeof Ke == "bigint")
        return Ae = Ae.get(De) || null, ee(Ee, Ae, "" + Ke, St);
      if (typeof Ke == "object" && Ke !== null) {
        switch (Ke.$$typeof) {
          case b:
            return Ae = Ae.get(
              Ke.key === null ? De : Ke.key
            ) || null, ye(Ee, Ae, Ke, St);
          case S:
            return Ae = Ae.get(
              Ke.key === null ? De : Ke.key
            ) || null, Pe(Ee, Ae, Ke, St);
          case K:
            return Ke = Za(Ke), qe(
              Ae,
              Ee,
              De,
              Ke,
              St
            );
        }
        if (se(Ke) || Z(Ke))
          return Ae = Ae.get(De) || null, Ve(Ee, Ae, Ke, St, null);
        if (typeof Ke.then == "function")
          return qe(
            Ae,
            Ee,
            De,
            nc(Ke),
            St
          );
        if (Ke.$$typeof === j)
          return qe(
            Ae,
            Ee,
            De,
            ja(Ee, Ke),
            St
          );
        hi(Ee, Ke);
      }
      return null;
    }
    function xt(Ae, Ee, De, Ke) {
      for (var St = null, fn = null, bt = Ee, Ut = Ee = 0, Xt = null; bt !== null && Ut < De.length; Ut++) {
        bt.index > Ut ? (Xt = bt, bt = null) : Xt = bt.sibling;
        var dn = Le(
          Ae,
          bt,
          De[Ut],
          Ke
        );
        if (dn === null) {
          bt === null && (bt = Xt);
          break;
        }
        a && bt && dn.alternate === null && l(Ae, bt), Ee = N(dn, Ee, Ut), fn === null ? St = dn : fn.sibling = dn, fn = dn, bt = Xt;
      }
      if (Ut === De.length)
        return f(Ae, bt), Jt && Wi(Ae, Ut), St;
      if (bt === null) {
        for (; Ut < De.length; Ut++)
          bt = Ye(Ae, De[Ut], Ke), bt !== null && (Ee = N(
            bt,
            Ee,
            Ut
          ), fn === null ? St = bt : fn.sibling = bt, fn = bt);
        return Jt && Wi(Ae, Ut), St;
      }
      for (bt = y(bt); Ut < De.length; Ut++)
        Xt = qe(
          bt,
          Ae,
          Ut,
          De[Ut],
          Ke
        ), Xt !== null && (a && Xt.alternate !== null && bt.delete(
          Xt.key === null ? Ut : Xt.key
        ), Ee = N(
          Xt,
          Ee,
          Ut
        ), fn === null ? St = Xt : fn.sibling = Xt, fn = Xt);
      return a && bt.forEach(function(bl) {
        return l(Ae, bl);
      }), Jt && Wi(Ae, Ut), St;
    }
    function kt(Ae, Ee, De, Ke) {
      if (De == null) throw Error(r(151));
      for (var St = null, fn = null, bt = Ee, Ut = Ee = 0, Xt = null, dn = De.next(); bt !== null && !dn.done; Ut++, dn = De.next()) {
        bt.index > Ut ? (Xt = bt, bt = null) : Xt = bt.sibling;
        var bl = Le(Ae, bt, dn.value, Ke);
        if (bl === null) {
          bt === null && (bt = Xt);
          break;
        }
        a && bt && bl.alternate === null && l(Ae, bt), Ee = N(bl, Ee, Ut), fn === null ? St = bl : fn.sibling = bl, fn = bl, bt = Xt;
      }
      if (dn.done)
        return f(Ae, bt), Jt && Wi(Ae, Ut), St;
      if (bt === null) {
        for (; !dn.done; Ut++, dn = De.next())
          dn = Ye(Ae, dn.value, Ke), dn !== null && (Ee = N(dn, Ee, Ut), fn === null ? St = dn : fn.sibling = dn, fn = dn);
        return Jt && Wi(Ae, Ut), St;
      }
      for (bt = y(bt); !dn.done; Ut++, dn = De.next())
        dn = qe(bt, Ae, Ut, dn.value, Ke), dn !== null && (a && dn.alternate !== null && bt.delete(dn.key === null ? Ut : dn.key), Ee = N(dn, Ee, Ut), fn === null ? St = dn : fn.sibling = dn, fn = dn);
      return a && bt.forEach(function(Ab) {
        return l(Ae, Ab);
      }), Jt && Wi(Ae, Ut), St;
    }
    function Cn(Ae, Ee, De, Ke) {
      if (typeof De == "object" && De !== null && De.type === k && De.key === null && (De = De.props.children), typeof De == "object" && De !== null) {
        switch (De.$$typeof) {
          case b:
            e: {
              for (var St = De.key; Ee !== null; ) {
                if (Ee.key === St) {
                  if (St = De.type, St === k) {
                    if (Ee.tag === 7) {
                      f(
                        Ae,
                        Ee.sibling
                      ), Ke = _(
                        Ee,
                        De.props.children
                      ), Ke.return = Ae, Ae = Ke;
                      break e;
                    }
                  } else if (Ee.elementType === St || typeof St == "object" && St !== null && St.$$typeof === K && Za(St) === Ee.type) {
                    f(
                      Ae,
                      Ee.sibling
                    ), Ke = _(Ee, De.props), Ja(Ke, De), Ke.return = Ae, Ae = Ke;
                    break e;
                  }
                  f(Ae, Ee);
                  break;
                } else l(Ae, Ee);
                Ee = Ee.sibling;
              }
              De.type === k ? (Ke = Jl(
                De.props.children,
                Ae.mode,
                Ke,
                De.key
              ), Ke.return = Ae, Ae = Ke) : (Ke = Qd(
                De.type,
                De.key,
                De.props,
                null,
                Ae.mode,
                Ke
              ), Ja(Ke, De), Ke.return = Ae, Ae = Ke);
            }
            return B(Ae);
          case S:
            e: {
              for (St = De.key; Ee !== null; ) {
                if (Ee.key === St)
                  if (Ee.tag === 4 && Ee.stateNode.containerInfo === De.containerInfo && Ee.stateNode.implementation === De.implementation) {
                    f(
                      Ae,
                      Ee.sibling
                    ), Ke = _(Ee, De.children || []), Ke.return = Ae, Ae = Ke;
                    break e;
                  } else {
                    f(Ae, Ee);
                    break;
                  }
                else l(Ae, Ee);
                Ee = Ee.sibling;
              }
              Ke = lf(De, Ae.mode, Ke), Ke.return = Ae, Ae = Ke;
            }
            return B(Ae);
          case K:
            return De = Za(De), Cn(
              Ae,
              Ee,
              De,
              Ke
            );
        }
        if (se(De))
          return xt(
            Ae,
            Ee,
            De,
            Ke
          );
        if (Z(De)) {
          if (St = Z(De), typeof St != "function") throw Error(r(150));
          return De = St.call(De), kt(
            Ae,
            Ee,
            De,
            Ke
          );
        }
        if (typeof De.then == "function")
          return Cn(
            Ae,
            Ee,
            nc(De),
            Ke
          );
        if (De.$$typeof === j)
          return Cn(
            Ae,
            Ee,
            ja(Ae, De),
            Ke
          );
        hi(Ae, De);
      }
      return typeof De == "string" && De !== "" || typeof De == "number" || typeof De == "bigint" ? (De = "" + De, Ee !== null && Ee.tag === 6 ? (f(Ae, Ee.sibling), Ke = _(Ee, De), Ke.return = Ae, Ae = Ke) : (f(Ae, Ee), Ke = Gu(De, Ae.mode, Ke), Ke.return = Ae, Ae = Ke), B(Ae)) : f(Ae, Ee);
    }
    return function(Ae, Ee, De, Ke) {
      try {
        Xi = 0;
        var St = Cn(
          Ae,
          Ee,
          De,
          Ke
        );
        return tc = null, St;
      } catch (bt) {
        if (bt === ec || bt === df) throw bt;
        var fn = Vr(29, bt, null, Ae.mode);
        return fn.lanes = Ke, fn.return = Ae, fn;
      } finally {
      }
    };
  }
  var el = ry(!0), tp = ry(!1), Ra = !1;
  function Ts(a) {
    a.updateQueue = {
      baseState: a.memoizedState,
      firstBaseUpdate: null,
      lastBaseUpdate: null,
      shared: { pending: null, lanes: 0, hiddenCallbacks: null },
      callbacks: null
    };
  }
  function ih(a, l) {
    a = a.updateQueue, l.updateQueue === a && (l.updateQueue = {
      baseState: a.baseState,
      firstBaseUpdate: a.firstBaseUpdate,
      lastBaseUpdate: a.lastBaseUpdate,
      shared: a.shared,
      callbacks: null
    });
  }
  function tl(a) {
    return { lane: a, tag: 0, payload: null, callback: null, next: null };
  }
  function es(a, l, f) {
    var y = a.updateQueue;
    if (y === null) return null;
    if (y = y.shared, (mn & 2) !== 0) {
      var _ = y.pending;
      return _ === null ? l.next = l : (l.next = _.next, _.next = l), y.pending = l, l = pr(a), Ko(a, null, f), l;
    }
    return Et(a, y, l, f), pr(a);
  }
  function hf(a, l, f) {
    if (l = l.updateQueue, l !== null && (l = l.shared, (f & 4194048) !== 0)) {
      var y = l.lanes;
      y &= a.pendingLanes, f |= y, l.lanes = f, vn(a, f);
    }
  }
  function ah(a, l) {
    var f = a.updateQueue, y = a.alternate;
    if (y !== null && (y = y.updateQueue, f === y)) {
      var _ = null, N = null;
      if (f = f.firstBaseUpdate, f !== null) {
        do {
          var B = {
            lane: f.lane,
            tag: f.tag,
            payload: f.payload,
            callback: null,
            next: null
          };
          N === null ? _ = N = B : N = N.next = B, f = f.next;
        } while (f !== null);
        N === null ? _ = N = l : N = N.next = l;
      } else _ = N = l;
      f = {
        baseState: y.baseState,
        firstBaseUpdate: _,
        lastBaseUpdate: N,
        shared: y.shared,
        callbacks: y.callbacks
      }, a.updateQueue = f;
      return;
    }
    a = f.lastBaseUpdate, a === null ? f.firstBaseUpdate = l : a.next = l, f.lastBaseUpdate = l;
  }
  var Tr = !1;
  function au() {
    if (Tr) {
      var a = Ju;
      if (a !== null) throw a;
    }
  }
  function rc(a, l, f, y) {
    Tr = !1;
    var _ = a.updateQueue;
    Ra = !1;
    var N = _.firstBaseUpdate, B = _.lastBaseUpdate, ee = _.shared.pending;
    if (ee !== null) {
      _.shared.pending = null;
      var ye = ee, Pe = ye.next;
      ye.next = null, B === null ? N = Pe : B.next = Pe, B = ye;
      var Ve = a.alternate;
      Ve !== null && (Ve = Ve.updateQueue, ee = Ve.lastBaseUpdate, ee !== B && (ee === null ? Ve.firstBaseUpdate = Pe : ee.next = Pe, Ve.lastBaseUpdate = ye));
    }
    if (N !== null) {
      var Ye = _.baseState;
      B = 0, Ve = Pe = ye = null, ee = N;
      do {
        var Le = ee.lane & -536870913, qe = Le !== ee.lane;
        if (qe ? (Wt & Le) === Le : (y & Le) === Le) {
          Le !== 0 && Le === Zu && (Tr = !0), Ve !== null && (Ve = Ve.next = {
            lane: 0,
            tag: ee.tag,
            payload: ee.payload,
            callback: null,
            next: null
          });
          e: {
            var xt = a, kt = ee;
            Le = l;
            var Cn = f;
            switch (kt.tag) {
              case 1:
                if (xt = kt.payload, typeof xt == "function") {
                  Ye = xt.call(Cn, Ye, Le);
                  break e;
                }
                Ye = xt;
                break e;
              case 3:
                xt.flags = xt.flags & -65537 | 128;
              case 0:
                if (xt = kt.payload, Le = typeof xt == "function" ? xt.call(Cn, Ye, Le) : xt, Le == null) break e;
                Ye = p({}, Ye, Le);
                break e;
              case 2:
                Ra = !0;
            }
          }
          Le = ee.callback, Le !== null && (a.flags |= 64, qe && (a.flags |= 8192), qe = _.callbacks, qe === null ? _.callbacks = [Le] : qe.push(Le));
        } else
          qe = {
            lane: Le,
            tag: ee.tag,
            payload: ee.payload,
            callback: ee.callback,
            next: null
          }, Ve === null ? (Pe = Ve = qe, ye = Ye) : Ve = Ve.next = qe, B |= Le;
        if (ee = ee.next, ee === null) {
          if (ee = _.shared.pending, ee === null)
            break;
          qe = ee, ee = qe.next, qe.next = null, _.lastBaseUpdate = qe, _.shared.pending = null;
        }
      } while (!0);
      Ve === null && (ye = Ye), _.baseState = ye, _.firstBaseUpdate = Pe, _.lastBaseUpdate = Ve, N === null && (_.shared.lanes = 0), ul |= B, a.lanes = B, a.memoizedState = Ye;
    }
  }
  function ts(a, l) {
    if (typeof a != "function")
      throw Error(r(191, a));
    a.call(l);
  }
  function sh(a, l) {
    var f = a.callbacks;
    if (f !== null)
      for (a.callbacks = null, a = 0; a < f.length; a++)
        ts(f[a], l);
  }
  var oo = $(null), Ns = $(0);
  function np(a, l) {
    a = os, G(Ns, a), G(oo, l), os = a | l.baseLanes;
  }
  function Gr() {
    G(Ns, os), G(oo, oo.current);
  }
  function mf() {
    os = Ns.current, fe(oo), fe(Ns);
  }
  var Qi = $(null), Oa = null;
  function nl(a) {
    var l = a.alternate;
    G(gr, gr.current & 1), G(Qi, a), Oa === null && (l === null || oo.current !== null || l.memoizedState !== null) && (Oa = a);
  }
  function pf(a) {
    G(gr, gr.current), G(Qi, a), Oa === null && (Oa = a);
  }
  function iy(a) {
    a.tag === 22 ? (G(gr, gr.current), G(Qi, a), Oa === null && (Oa = a)) : Da();
  }
  function Da() {
    G(gr, gr.current), G(Qi, Qi.current);
  }
  function Ni(a) {
    fe(Qi), Oa === a && (Oa = null), fe(gr);
  }
  var gr = $(0);
  function oh(a) {
    for (var l = a; l !== null; ) {
      if (l.tag === 13) {
        var f = l.memoizedState;
        if (f !== null && (f = f.dehydrated, f === null || Vh(f) || _c(f)))
          return l;
      } else if (l.tag === 19 && (l.memoizedProps.revealOrder === "forwards" || l.memoizedProps.revealOrder === "backwards" || l.memoizedProps.revealOrder === "unstable_legacy-backwards" || l.memoizedProps.revealOrder === "together")) {
        if ((l.flags & 128) !== 0) return l;
      } else if (l.child !== null) {
        l.child.return = l, l = l.child;
        continue;
      }
      if (l === a) break;
      for (; l.sibling === null; ) {
        if (l.return === null || l.return === a) return null;
        l = l.return;
      }
      l.sibling.return = l.return, l = l.sibling;
    }
    return null;
  }
  var Zi = 0, Bt = null, _n = null, ir = null, gf = !1, ic = !1, su = !1, lh = 0, ac = 0, rl = null, Hx = 0;
  function Hn() {
    throw Error(r(321));
  }
  function uh(a, l) {
    if (l === null) return !1;
    for (var f = 0; f < l.length && f < a.length; f++)
      if (!Mn(a[f], l[f])) return !1;
    return !0;
  }
  function ch(a, l, f, y, _, N) {
    return Zi = N, Bt = l, l.memoizedState = null, l.updateQueue = null, l.lanes = 0, J.H = a === null || a.memoizedState === null ? py : xh, su = !1, N = f(y, _), su = !1, ic && (N = yf(
      l,
      f,
      y,
      _
    )), rp(a), N;
  }
  function rp(a) {
    J.H = al;
    var l = _n !== null && _n.next !== null;
    if (Zi = 0, ir = _n = Bt = null, gf = !1, ac = 0, rl = null, l) throw Error(r(300));
    a === null || er || (a = a.dependencies, a !== null && Jd(a) && (er = !0));
  }
  function yf(a, l, f, y) {
    Bt = a;
    var _ = 0;
    do {
      if (ic && (rl = null), ac = 0, ic = !1, 25 <= _) throw Error(r(301));
      if (_ += 1, ir = _n = null, a.updateQueue != null) {
        var N = a.updateQueue;
        N.lastEffect = null, N.events = null, N.stores = null, N.memoCache != null && (N.memoCache.index = 0);
      }
      J.H = Ef, N = l(f, y);
    } while (ic);
    return N;
  }
  function Gx() {
    var a = J.H, l = a.useState()[0];
    return l = typeof l.then == "function" ? oc(l) : l, a = a.useState()[0], (_n !== null ? _n.memoizedState : null) !== a && (Bt.flags |= 1024), l;
  }
  function fh() {
    var a = lh !== 0;
    return lh = 0, a;
  }
  function dh(a, l, f) {
    l.updateQueue = a.updateQueue, l.flags &= -2053, a.lanes &= ~f;
  }
  function ip(a) {
    if (gf) {
      for (a = a.memoizedState; a !== null; ) {
        var l = a.queue;
        l !== null && (l.pending = null), a = a.next;
      }
      gf = !1;
    }
    Zi = 0, ir = _n = Bt = null, ic = !1, ac = lh = 0, rl = null;
  }
  function ai() {
    var a = {
      memoizedState: null,
      baseState: null,
      baseQueue: null,
      queue: null,
      next: null
    };
    return ir === null ? Bt.memoizedState = ir = a : ir = ir.next = a, ir;
  }
  function yr() {
    if (_n === null) {
      var a = Bt.alternate;
      a = a !== null ? a.memoizedState : null;
    } else a = _n.next;
    var l = ir === null ? Bt.memoizedState : ir.next;
    if (l !== null)
      ir = l, _n = a;
    else {
      if (a === null)
        throw Bt.alternate === null ? Error(r(467)) : Error(r(310));
      _n = a, a = {
        memoizedState: _n.memoizedState,
        baseState: _n.baseState,
        baseQueue: _n.baseQueue,
        queue: _n.queue,
        next: null
      }, ir === null ? Bt.memoizedState = ir = a : ir = ir.next = a;
    }
    return ir;
  }
  function sc() {
    return { lastEffect: null, events: null, stores: null, memoCache: null };
  }
  function oc(a) {
    var l = ac;
    return ac += 1, rl === null && (rl = []), a = rh(rl, a, l), l = Bt, (ir === null ? l.memoizedState : ir.next) === null && (l = l.alternate, J.H = l === null || l.memoizedState === null ? py : xh), a;
  }
  function lc(a) {
    if (a !== null && typeof a == "object") {
      if (typeof a.then == "function") return oc(a);
      if (a.$$typeof === j) return Hr(a);
    }
    throw Error(r(438, String(a)));
  }
  function ap(a) {
    var l = null, f = Bt.updateQueue;
    if (f !== null && (l = f.memoCache), l == null) {
      var y = Bt.alternate;
      y !== null && (y = y.updateQueue, y !== null && (y = y.memoCache, y != null && (l = {
        data: y.data.map(function(_) {
          return _.slice();
        }),
        index: 0
      })));
    }
    if (l == null && (l = { data: [], index: 0 }), f === null && (f = sc(), Bt.updateQueue = f), f.memoCache = l, f = l.data[l.index], f === void 0)
      for (f = l.data[l.index] = Array(a), y = 0; y < a; y++)
        f[y] = Y;
    return l.index++, f;
  }
  function ns(a, l) {
    return typeof l == "function" ? l(a) : l;
  }
  function qt(a) {
    var l = yr();
    return sp(l, _n, a);
  }
  function sp(a, l, f) {
    var y = a.queue;
    if (y === null) throw Error(r(311));
    y.lastRenderedReducer = f;
    var _ = a.baseQueue, N = y.pending;
    if (N !== null) {
      if (_ !== null) {
        var B = _.next;
        _.next = N.next, N.next = B;
      }
      l.baseQueue = _ = N, y.pending = null;
    }
    if (N = a.baseState, _ === null) a.memoizedState = N;
    else {
      l = _.next;
      var ee = B = null, ye = null, Pe = l, Ve = !1;
      do {
        var Ye = Pe.lane & -536870913;
        if (Ye !== Pe.lane ? (Wt & Ye) === Ye : (Zi & Ye) === Ye) {
          var Le = Pe.revertLane;
          if (Le === 0)
            ye !== null && (ye = ye.next = {
              lane: 0,
              revertLane: 0,
              gesture: null,
              action: Pe.action,
              hasEagerState: Pe.hasEagerState,
              eagerState: Pe.eagerState,
              next: null
            }), Ye === Zu && (Ve = !0);
          else if ((Zi & Le) === Le) {
            Pe = Pe.next, Le === Zu && (Ve = !0);
            continue;
          } else
            Ye = {
              lane: 0,
              revertLane: Pe.revertLane,
              gesture: null,
              action: Pe.action,
              hasEagerState: Pe.hasEagerState,
              eagerState: Pe.eagerState,
              next: null
            }, ye === null ? (ee = ye = Ye, B = N) : ye = ye.next = Ye, Bt.lanes |= Le, ul |= Le;
          Ye = Pe.action, su && f(N, Ye), N = Pe.hasEagerState ? Pe.eagerState : f(N, Ye);
        } else
          Le = {
            lane: Ye,
            revertLane: Pe.revertLane,
            gesture: Pe.gesture,
            action: Pe.action,
            hasEagerState: Pe.hasEagerState,
            eagerState: Pe.eagerState,
            next: null
          }, ye === null ? (ee = ye = Le, B = N) : ye = ye.next = Le, Bt.lanes |= Ye, ul |= Ye;
        Pe = Pe.next;
      } while (Pe !== null && Pe !== l);
      if (ye === null ? B = N : ye.next = ee, !Mn(N, a.memoizedState) && (er = !0, Ve && (f = Ju, f !== null)))
        throw f;
      a.memoizedState = N, a.baseState = B, a.baseQueue = ye, y.lastRenderedState = N;
    }
    return _ === null && (y.lanes = 0), [a.memoizedState, y.dispatch];
  }
  function op(a) {
    var l = yr(), f = l.queue;
    if (f === null) throw Error(r(311));
    f.lastRenderedReducer = a;
    var y = f.dispatch, _ = f.pending, N = l.memoizedState;
    if (_ !== null) {
      f.pending = null;
      var B = _ = _.next;
      do
        N = a(N, B.action), B = B.next;
      while (B !== _);
      Mn(N, l.memoizedState) || (er = !0), l.memoizedState = N, l.baseQueue === null && (l.baseState = N), f.lastRenderedState = N;
    }
    return [N, y];
  }
  function uc(a, l, f) {
    var y = Bt, _ = yr(), N = Jt;
    if (N) {
      if (f === void 0) throw Error(r(407));
      f = f();
    } else f = l();
    var B = !Mn(
      (_n || _).memoizedState,
      f
    );
    if (B && (_.memoizedState = f, er = !0), _ = _.queue, wf(sy.bind(null, y, _, a), [
      a
    ]), _.getSnapshot !== l || B || ir !== null && ir.memoizedState.tag & 1) {
      if (y.flags |= 2048, ea(
        9,
        { destroy: void 0 },
        ay.bind(
          null,
          y,
          _,
          f,
          l
        ),
        null
      ), jn === null) throw Error(r(349));
      N || (Zi & 127) !== 0 || lp(y, l, f);
    }
    return f;
  }
  function lp(a, l, f) {
    a.flags |= 16384, a = { getSnapshot: l, value: f }, l = Bt.updateQueue, l === null ? (l = sc(), Bt.updateQueue = l, l.stores = [a]) : (f = l.stores, f === null ? l.stores = [a] : f.push(a));
  }
  function ay(a, l, f, y) {
    l.value = f, l.getSnapshot = y, Ji(l) && oy(a);
  }
  function sy(a, l, f) {
    return f(function() {
      Ji(l) && oy(a);
    });
  }
  function Ji(a) {
    var l = a.getSnapshot;
    a = a.value;
    try {
      var f = l();
      return !Mn(a, f);
    } catch {
      return !0;
    }
  }
  function oy(a) {
    var l = Nn(a, 2);
    l !== null && Di(l, a, 2);
  }
  function cc(a) {
    var l = ai();
    if (typeof a == "function") {
      var f = a;
      if (a = f(), su) {
        kn(!0);
        try {
          f();
        } finally {
          kn(!1);
        }
      }
    }
    return l.memoizedState = l.baseState = a, l.queue = {
      pending: null,
      lanes: 0,
      dispatch: null,
      lastRenderedReducer: ns,
      lastRenderedState: a
    }, l;
  }
  function hh(a, l, f, y) {
    return a.baseState = f, sp(
      a,
      _n,
      typeof y == "function" ? y : ns
    );
  }
  function ly(a, l, f, y, _) {
    if (Sf(a)) throw Error(r(485));
    if (a = l.action, a !== null) {
      var N = {
        payload: _,
        action: a,
        next: null,
        isTransition: !0,
        status: "pending",
        value: null,
        reason: null,
        listeners: [],
        then: function(B) {
          N.listeners.push(B);
        }
      };
      J.T !== null ? f(!0) : N.isTransition = !1, y(N), f = l.pending, f === null ? (N.next = l.pending = N, up(l, N)) : (N.next = f.next, l.pending = f.next = N);
    }
  }
  function up(a, l) {
    var f = l.action, y = l.payload, _ = a.state;
    if (l.isTransition) {
      var N = J.T, B = {};
      J.T = B;
      try {
        var ee = f(_, y), ye = J.S;
        ye !== null && ye(B, ee), Ai(a, l, ee);
      } catch (Pe) {
        vf(a, l, Pe);
      } finally {
        N !== null && B.types !== null && (N.types = B.types), J.T = N;
      }
    } else
      try {
        N = f(_, y), Ai(a, l, N);
      } catch (Pe) {
        vf(a, l, Pe);
      }
  }
  function Ai(a, l, f) {
    f !== null && typeof f == "object" && typeof f.then == "function" ? f.then(
      function(y) {
        lo(a, l, y);
      },
      function(y) {
        return vf(a, l, y);
      }
    ) : lo(a, l, f);
  }
  function lo(a, l, f) {
    l.status = "fulfilled", l.value = f, cp(l), a.state = f, l = a.pending, l !== null && (f = l.next, f === l ? a.pending = null : (f = f.next, l.next = f, up(a, f)));
  }
  function vf(a, l, f) {
    var y = a.pending;
    if (a.pending = null, y !== null) {
      y = y.next;
      do
        l.status = "rejected", l.reason = f, cp(l), l = l.next;
      while (l !== y);
    }
    a.action = null;
  }
  function cp(a) {
    a = a.listeners;
    for (var l = 0; l < a.length; l++) (0, a[l])();
  }
  function xf(a, l) {
    return l;
  }
  function fp(a, l) {
    if (Jt) {
      var f = jn.formState;
      if (f !== null) {
        e: {
          var y = Bt;
          if (Jt) {
            if (gn) {
              t: {
                for (var _ = gn, N = Aa; _.nodeType !== 8; ) {
                  if (!N) {
                    _ = null;
                    break t;
                  }
                  if (_ = Pa(
                    _.nextSibling
                  ), _ === null) {
                    _ = null;
                    break t;
                  }
                }
                N = _.data, _ = N === "F!" || N === "F" ? _ : null;
              }
              if (_) {
                gn = Pa(
                  _.nextSibling
                ), y = _.data === "F!";
                break e;
              }
            }
            Xo(y);
          }
          y = !1;
        }
        y && (l = f[0]);
      }
    }
    return f = ai(), f.memoizedState = f.baseState = l, y = {
      pending: null,
      lanes: 0,
      dispatch: null,
      lastRenderedReducer: xf,
      lastRenderedState: l
    }, f.queue = y, f = _p.bind(
      null,
      Bt,
      y
    ), y.dispatch = f, y = cc(!1), N = dc.bind(
      null,
      Bt,
      !1,
      y.queue
    ), y = ai(), _ = {
      state: l,
      dispatch: null,
      action: a,
      pending: null
    }, y.queue = _, f = ly.bind(
      null,
      Bt,
      _,
      N,
      f
    ), _.dispatch = f, y.memoizedState = a, [l, f, !1];
  }
  function mh(a) {
    var l = yr();
    return dp(l, _n, a);
  }
  function dp(a, l, f) {
    if (l = sp(
      a,
      l,
      xf
    )[0], a = qt(ns)[0], typeof l == "object" && l !== null && typeof l.then == "function")
      try {
        var y = oc(l);
      } catch (B) {
        throw B === ec ? df : B;
      }
    else y = l;
    l = yr();
    var _ = l.queue, N = _.dispatch;
    return f !== l.memoizedState && (Bt.flags |= 2048, ea(
      9,
      { destroy: void 0 },
      hp.bind(null, _, f),
      null
    )), [y, N, a];
  }
  function hp(a, l) {
    a.action = l;
  }
  function ph(a) {
    var l = yr(), f = _n;
    if (f !== null)
      return dp(l, f, a);
    yr(), l = l.memoizedState, f = yr();
    var y = f.queue.dispatch;
    return f.memoizedState = a, [l, y, !1];
  }
  function ea(a, l, f, y) {
    return a = { tag: a, create: f, deps: y, inst: l, next: null }, l = Bt.updateQueue, l === null && (l = sc(), Bt.updateQueue = l), f = l.lastEffect, f === null ? l.lastEffect = a.next = a : (y = f.next, f.next = a, a.next = y, l.lastEffect = a), a;
  }
  function uy() {
    return yr().memoizedState;
  }
  function rs(a, l, f, y) {
    var _ = ai();
    Bt.flags |= a, _.memoizedState = ea(
      1 | l,
      { destroy: void 0 },
      f,
      y === void 0 ? null : y
    );
  }
  function bf(a, l, f, y) {
    var _ = yr();
    y = y === void 0 ? null : y;
    var N = _.memoizedState.inst;
    _n !== null && y !== null && uh(y, _n.memoizedState.deps) ? _.memoizedState = ea(l, N, f, y) : (Bt.flags |= a, _.memoizedState = ea(
      1 | l,
      N,
      f,
      y
    ));
  }
  function mp(a, l) {
    rs(8390656, 8, a, l);
  }
  function wf(a, l) {
    bf(2048, 8, a, l);
  }
  function Kx(a) {
    Bt.flags |= 4;
    var l = Bt.updateQueue;
    if (l === null)
      l = sc(), Bt.updateQueue = l, l.events = [a];
    else {
      var f = l.events;
      f === null ? l.events = [a] : f.push(a);
    }
  }
  function cy(a) {
    var l = yr().memoizedState;
    return Kx({ ref: l, nextImpl: a }), function() {
      if ((mn & 2) !== 0) throw Error(r(440));
      return l.impl.apply(void 0, arguments);
    };
  }
  function fy(a, l) {
    return bf(4, 2, a, l);
  }
  function pp(a, l) {
    return bf(4, 4, a, l);
  }
  function gp(a, l) {
    if (typeof l == "function") {
      a = a();
      var f = l(a);
      return function() {
        typeof f == "function" ? f() : l(null);
      };
    }
    if (l != null)
      return a = a(), l.current = a, function() {
        l.current = null;
      };
  }
  function dy(a, l, f) {
    f = f != null ? f.concat([a]) : null, bf(4, 4, gp.bind(null, l, a), f);
  }
  function gh() {
  }
  function yp(a, l) {
    var f = yr();
    l = l === void 0 ? null : l;
    var y = f.memoizedState;
    return l !== null && uh(l, y[1]) ? y[0] : (f.memoizedState = [a, l], a);
  }
  function mi(a, l) {
    var f = yr();
    l = l === void 0 ? null : l;
    var y = f.memoizedState;
    if (l !== null && uh(l, y[1]))
      return y[0];
    if (y = a(), su) {
      kn(!0);
      try {
        a();
      } finally {
        kn(!1);
      }
    }
    return f.memoizedState = [y, l], y;
  }
  function Ia(a, l, f) {
    return f === void 0 || (Zi & 1073741824) !== 0 && (Wt & 261930) === 0 ? a.memoizedState = l : (a.memoizedState = f, a = By(), Bt.lanes |= a, ul |= a, f);
  }
  function hy(a, l, f, y) {
    return Mn(f, l) ? f : oo.current !== null ? (a = Ia(a, f, y), Mn(a, l) || (er = !0), a) : (Zi & 42) === 0 || (Zi & 1073741824) !== 0 && (Wt & 261930) === 0 ? (er = !0, a.memoizedState = f) : (a = By(), Bt.lanes |= a, ul |= a, l);
  }
  function my(a, l, f, y, _) {
    var N = ue.p;
    ue.p = N !== 0 && 8 > N ? N : 8;
    var B = J.T, ee = {};
    J.T = ee, dc(a, !1, l, f);
    try {
      var ye = _(), Pe = J.S;
      if (Pe !== null && Pe(ee, ye), ye !== null && typeof ye == "object" && typeof ye.then == "function") {
        var Ve = Vx(
          ye,
          y
        );
        fc(
          a,
          l,
          Ve,
          ra(a)
        );
      } else
        fc(
          a,
          l,
          y,
          ra(a)
        );
    } catch (Ye) {
      fc(
        a,
        l,
        { then: function() {
        }, status: "rejected", reason: Ye },
        ra()
      );
    } finally {
      ue.p = N, B !== null && ee.types !== null && (B.types = ee.types), J.T = B;
    }
  }
  function yh() {
  }
  function il(a, l, f, y) {
    if (a.tag !== 5) throw Error(r(476));
    var _ = vp(a).queue;
    my(
      a,
      _,
      l,
      de,
      f === null ? yh : function() {
        return xp(a), f(y);
      }
    );
  }
  function vp(a) {
    var l = a.memoizedState;
    if (l !== null) return l;
    l = {
      memoizedState: de,
      baseState: de,
      baseQueue: null,
      queue: {
        pending: null,
        lanes: 0,
        dispatch: null,
        lastRenderedReducer: ns,
        lastRenderedState: de
      },
      next: null
    };
    var f = {};
    return l.next = {
      memoizedState: f,
      baseState: f,
      baseQueue: null,
      queue: {
        pending: null,
        lanes: 0,
        dispatch: null,
        lastRenderedReducer: ns,
        lastRenderedState: f
      },
      next: null
    }, a.memoizedState = l, a = a.alternate, a !== null && (a.memoizedState = l), l;
  }
  function xp(a) {
    var l = vp(a);
    l.next === null && (l = a.alternate.memoizedState), fc(
      a,
      l.next.queue,
      {},
      ra()
    );
  }
  function bp() {
    return Hr(Nc);
  }
  function wp() {
    return yr().memoizedState;
  }
  function ou() {
    return yr().memoizedState;
  }
  function _f(a) {
    for (var l = a.return; l !== null; ) {
      switch (l.tag) {
        case 24:
        case 3:
          var f = ra();
          a = tl(f);
          var y = es(l, a, f);
          y !== null && (Di(y, l, f), hf(y, l, f)), l = { cache: Qa() }, a.payload = l;
          return;
      }
      l = l.return;
    }
  }
  function Yx(a, l, f) {
    var y = ra();
    f = {
      lane: y,
      revertLane: 0,
      gesture: null,
      action: f,
      hasEagerState: !1,
      eagerState: null,
      next: null
    }, Sf(a) ? Cf(l, f) : (f = mr(a, l, f, y), f !== null && (Di(f, a, y), vh(f, l, y)));
  }
  function _p(a, l, f) {
    var y = ra();
    fc(a, l, f, y);
  }
  function fc(a, l, f, y) {
    var _ = {
      lane: y,
      revertLane: 0,
      gesture: null,
      action: f,
      hasEagerState: !1,
      eagerState: null,
      next: null
    };
    if (Sf(a)) Cf(l, _);
    else {
      var N = a.alternate;
      if (a.lanes === 0 && (N === null || N.lanes === 0) && (N = l.lastRenderedReducer, N !== null))
        try {
          var B = l.lastRenderedState, ee = N(B, f);
          if (_.hasEagerState = !0, _.eagerState = ee, Mn(ee, B))
            return Et(a, l, _, 0), jn === null && Ln(), !1;
        } catch {
        } finally {
        }
      if (f = mr(a, l, _, y), f !== null)
        return Di(f, a, y), vh(f, l, y), !0;
    }
    return !1;
  }
  function dc(a, l, f, y) {
    if (y = {
      lane: 2,
      revertLane: ia(),
      gesture: null,
      action: y,
      hasEagerState: !1,
      eagerState: null,
      next: null
    }, Sf(a)) {
      if (l) throw Error(r(479));
    } else
      l = mr(
        a,
        f,
        y,
        2
      ), l !== null && Di(l, a, 2);
  }
  function Sf(a) {
    var l = a.alternate;
    return a === Bt || l !== null && l === Bt;
  }
  function Cf(a, l) {
    ic = gf = !0;
    var f = a.pending;
    f === null ? l.next = l : (l.next = f.next, f.next = l), a.pending = l;
  }
  function vh(a, l, f) {
    if ((f & 4194048) !== 0) {
      var y = l.lanes;
      y &= a.pendingLanes, f |= y, l.lanes = f, vn(a, f);
    }
  }
  var al = {
    readContext: Hr,
    use: lc,
    useCallback: Hn,
    useContext: Hn,
    useEffect: Hn,
    useImperativeHandle: Hn,
    useLayoutEffect: Hn,
    useInsertionEffect: Hn,
    useMemo: Hn,
    useReducer: Hn,
    useRef: Hn,
    useState: Hn,
    useDebugValue: Hn,
    useDeferredValue: Hn,
    useTransition: Hn,
    useSyncExternalStore: Hn,
    useId: Hn,
    useHostTransitionStatus: Hn,
    useFormState: Hn,
    useActionState: Hn,
    useOptimistic: Hn,
    useMemoCache: Hn,
    useCacheRefresh: Hn
  };
  al.useEffectEvent = Hn;
  var py = {
    readContext: Hr,
    use: lc,
    useCallback: function(a, l) {
      return ai().memoizedState = [
        a,
        l === void 0 ? null : l
      ], a;
    },
    useContext: Hr,
    useEffect: mp,
    useImperativeHandle: function(a, l, f) {
      f = f != null ? f.concat([a]) : null, rs(
        4194308,
        4,
        gp.bind(null, l, a),
        f
      );
    },
    useLayoutEffect: function(a, l) {
      return rs(4194308, 4, a, l);
    },
    useInsertionEffect: function(a, l) {
      rs(4, 2, a, l);
    },
    useMemo: function(a, l) {
      var f = ai();
      l = l === void 0 ? null : l;
      var y = a();
      if (su) {
        kn(!0);
        try {
          a();
        } finally {
          kn(!1);
        }
      }
      return f.memoizedState = [y, l], y;
    },
    useReducer: function(a, l, f) {
      var y = ai();
      if (f !== void 0) {
        var _ = f(l);
        if (su) {
          kn(!0);
          try {
            f(l);
          } finally {
            kn(!1);
          }
        }
      } else _ = l;
      return y.memoizedState = y.baseState = _, a = {
        pending: null,
        lanes: 0,
        dispatch: null,
        lastRenderedReducer: a,
        lastRenderedState: _
      }, y.queue = a, a = a.dispatch = Yx.bind(
        null,
        Bt,
        a
      ), [y.memoizedState, a];
    },
    useRef: function(a) {
      var l = ai();
      return a = { current: a }, l.memoizedState = a;
    },
    useState: function(a) {
      a = cc(a);
      var l = a.queue, f = _p.bind(null, Bt, l);
      return l.dispatch = f, [a.memoizedState, f];
    },
    useDebugValue: gh,
    useDeferredValue: function(a, l) {
      var f = ai();
      return Ia(f, a, l);
    },
    useTransition: function() {
      var a = cc(!1);
      return a = my.bind(
        null,
        Bt,
        a.queue,
        !0,
        !1
      ), ai().memoizedState = a, [!1, a];
    },
    useSyncExternalStore: function(a, l, f) {
      var y = Bt, _ = ai();
      if (Jt) {
        if (f === void 0)
          throw Error(r(407));
        f = f();
      } else {
        if (f = l(), jn === null)
          throw Error(r(349));
        (Wt & 127) !== 0 || lp(y, l, f);
      }
      _.memoizedState = f;
      var N = { value: f, getSnapshot: l };
      return _.queue = N, mp(sy.bind(null, y, N, a), [
        a
      ]), y.flags |= 2048, ea(
        9,
        { destroy: void 0 },
        ay.bind(
          null,
          y,
          N,
          f,
          l
        ),
        null
      ), f;
    },
    useId: function() {
      var a = ai(), l = jn.identifierPrefix;
      if (Jt) {
        var f = Na, y = Es;
        f = (y & ~(1 << 32 - it(y) - 1)).toString(32) + f, l = "_" + l + "R_" + f, f = lh++, 0 < f && (l += "H" + f.toString(32)), l += "_";
      } else
        f = Hx++, l = "_" + l + "r_" + f.toString(32) + "_";
      return a.memoizedState = l;
    },
    useHostTransitionStatus: bp,
    useFormState: fp,
    useActionState: fp,
    useOptimistic: function(a) {
      var l = ai();
      l.memoizedState = l.baseState = a;
      var f = {
        pending: null,
        lanes: 0,
        dispatch: null,
        lastRenderedReducer: null,
        lastRenderedState: null
      };
      return l.queue = f, l = dc.bind(
        null,
        Bt,
        !0,
        f
      ), f.dispatch = l, [a, l];
    },
    useMemoCache: ap,
    useCacheRefresh: function() {
      return ai().memoizedState = _f.bind(
        null,
        Bt
      );
    },
    useEffectEvent: function(a) {
      var l = ai(), f = { impl: a };
      return l.memoizedState = f, function() {
        if ((mn & 2) !== 0)
          throw Error(r(440));
        return f.impl.apply(void 0, arguments);
      };
    }
  }, xh = {
    readContext: Hr,
    use: lc,
    useCallback: yp,
    useContext: Hr,
    useEffect: wf,
    useImperativeHandle: dy,
    useInsertionEffect: fy,
    useLayoutEffect: pp,
    useMemo: mi,
    useReducer: qt,
    useRef: uy,
    useState: function() {
      return qt(ns);
    },
    useDebugValue: gh,
    useDeferredValue: function(a, l) {
      var f = yr();
      return hy(
        f,
        _n.memoizedState,
        a,
        l
      );
    },
    useTransition: function() {
      var a = qt(ns)[0], l = yr().memoizedState;
      return [
        typeof a == "boolean" ? a : oc(a),
        l
      ];
    },
    useSyncExternalStore: uc,
    useId: wp,
    useHostTransitionStatus: bp,
    useFormState: mh,
    useActionState: mh,
    useOptimistic: function(a, l) {
      var f = yr();
      return hh(f, _n, a, l);
    },
    useMemoCache: ap,
    useCacheRefresh: ou
  };
  xh.useEffectEvent = cy;
  var Ef = {
    readContext: Hr,
    use: lc,
    useCallback: yp,
    useContext: Hr,
    useEffect: wf,
    useImperativeHandle: dy,
    useInsertionEffect: fy,
    useLayoutEffect: pp,
    useMemo: mi,
    useReducer: op,
    useRef: uy,
    useState: function() {
      return op(ns);
    },
    useDebugValue: gh,
    useDeferredValue: function(a, l) {
      var f = yr();
      return _n === null ? Ia(f, a, l) : hy(
        f,
        _n.memoizedState,
        a,
        l
      );
    },
    useTransition: function() {
      var a = op(ns)[0], l = yr().memoizedState;
      return [
        typeof a == "boolean" ? a : oc(a),
        l
      ];
    },
    useSyncExternalStore: uc,
    useId: wp,
    useHostTransitionStatus: bp,
    useFormState: ph,
    useActionState: ph,
    useOptimistic: function(a, l) {
      var f = yr();
      return _n !== null ? hh(f, _n, a, l) : (f.baseState = a, [a, f.queue.dispatch]);
    },
    useMemoCache: ap,
    useCacheRefresh: ou
  };
  Ef.useEffectEvent = cy;
  function bh(a, l, f, y) {
    l = a.memoizedState, f = f(y, l), f = f == null ? l : p({}, l, f), a.memoizedState = f, a.lanes === 0 && (a.updateQueue.baseState = f);
  }
  var kf = {
    enqueueSetState: function(a, l, f) {
      a = a._reactInternals;
      var y = ra(), _ = tl(y);
      _.payload = l, f != null && (_.callback = f), l = es(a, _, y), l !== null && (Di(l, a, y), hf(l, a, y));
    },
    enqueueReplaceState: function(a, l, f) {
      a = a._reactInternals;
      var y = ra(), _ = tl(y);
      _.tag = 1, _.payload = l, f != null && (_.callback = f), l = es(a, _, y), l !== null && (Di(l, a, y), hf(l, a, y));
    },
    enqueueForceUpdate: function(a, l) {
      a = a._reactInternals;
      var f = ra(), y = tl(f);
      y.tag = 2, l != null && (y.callback = l), l = es(a, y, f), l !== null && (Di(l, a, f), hf(l, a, f));
    }
  };
  function gy(a, l, f, y, _, N, B) {
    return a = a.stateNode, typeof a.shouldComponentUpdate == "function" ? a.shouldComponentUpdate(y, N, B) : l.prototype && l.prototype.isPureReactComponent ? !w(f, y) || !w(_, N) : !0;
  }
  function Sp(a, l, f, y) {
    a = l.state, typeof l.componentWillReceiveProps == "function" && l.componentWillReceiveProps(f, y), typeof l.UNSAFE_componentWillReceiveProps == "function" && l.UNSAFE_componentWillReceiveProps(f, y), l.state !== a && kf.enqueueReplaceState(l, l.state, null);
  }
  function pi(a, l) {
    var f = l;
    if ("ref" in l) {
      f = {};
      for (var y in l)
        y !== "ref" && (f[y] = l[y]);
    }
    if (a = a.defaultProps) {
      f === l && (f = p({}, f));
      for (var _ in a)
        f[_] === void 0 && (f[_] = a[_]);
    }
    return f;
  }
  function Cp(a) {
    pt(a);
  }
  function Ep(a) {
    console.error(a);
  }
  function yy(a) {
    pt(a);
  }
  function Tf(a, l) {
    try {
      var f = a.onUncaughtError;
      f(l.value, { componentStack: l.stack });
    } catch (y) {
      setTimeout(function() {
        throw y;
      });
    }
  }
  function vy(a, l, f) {
    try {
      var y = a.onCaughtError;
      y(f.value, {
        componentStack: f.stack,
        errorBoundary: l.tag === 1 ? l.stateNode : null
      });
    } catch (_) {
      setTimeout(function() {
        throw _;
      });
    }
  }
  function kp(a, l, f) {
    return f = tl(f), f.tag = 3, f.payload = { element: null }, f.callback = function() {
      Tf(a, l);
    }, f;
  }
  function As(a) {
    return a = tl(a), a.tag = 3, a;
  }
  function wh(a, l, f, y) {
    var _ = f.type.getDerivedStateFromError;
    if (typeof _ == "function") {
      var N = y.value;
      a.payload = function() {
        return _(N);
      }, a.callback = function() {
        vy(l, f, y);
      };
    }
    var B = f.stateNode;
    B !== null && typeof B.componentDidCatch == "function" && (a.callback = function() {
      vy(l, f, y), typeof _ != "function" && (cl === null ? cl = /* @__PURE__ */ new Set([this]) : cl.add(this));
      var ee = y.stack;
      this.componentDidCatch(y.value, {
        componentStack: ee !== null ? ee : ""
      });
    });
  }
  function Tp(a, l, f, y, _) {
    if (f.flags |= 32768, y !== null && typeof y == "object" && typeof y.then == "function") {
      if (l = f.alternate, l !== null && Qu(
        l,
        f,
        _,
        !0
      ), f = Qi.current, f !== null) {
        switch (f.tag) {
          case 31:
          case 13:
            return Oa === null ? Ih() : f.alternate === null && tr === 0 && (tr = 3), f.flags &= -257, f.flags |= 65536, f.lanes = _, y === nh ? f.flags |= 16384 : (l = f.updateQueue, l === null ? f.updateQueue = /* @__PURE__ */ new Set([y]) : l.add(y), ng(a, y, _)), !1;
          case 22:
            return f.flags |= 65536, y === nh ? f.flags |= 16384 : (l = f.updateQueue, l === null ? (l = {
              transitions: null,
              markerInstances: null,
              retryQueue: /* @__PURE__ */ new Set([y])
            }, f.updateQueue = l) : (f = l.retryQueue, f === null ? l.retryQueue = /* @__PURE__ */ new Set([y]) : f.add(y)), ng(a, y, _)), !1;
        }
        throw Error(r(435, f.tag));
      }
      return ng(a, y, _), Ih(), !1;
    }
    if (Jt)
      return l = Qi.current, l !== null ? ((l.flags & 65536) === 0 && (l.flags |= 256), l.flags |= 65536, l.lanes = _, y !== Xm && (a = Error(r(422), { cause: y }), Zo(Yi(a, f)))) : (y !== Xm && (l = Error(r(423), {
        cause: y
      }), Zo(
        Yi(l, f)
      )), a = a.current.alternate, a.flags |= 65536, _ &= -_, a.lanes |= _, y = Yi(y, f), _ = kp(
        a.stateNode,
        y,
        _
      ), ah(a, _), tr !== 4 && (tr = 2)), !1;
    var N = Error(r(520), { cause: y });
    if (N = Yi(N, f), Ff === null ? Ff = [N] : Ff.push(N), tr !== 4 && (tr = 2), l === null) return !0;
    y = Yi(y, f), f = l;
    do {
      switch (f.tag) {
        case 3:
          return f.flags |= 65536, a = _ & -_, f.lanes |= a, a = kp(f.stateNode, y, a), ah(f, a), !1;
        case 1:
          if (l = f.type, N = f.stateNode, (f.flags & 128) === 0 && (typeof l.getDerivedStateFromError == "function" || N !== null && typeof N.componentDidCatch == "function" && (cl === null || !cl.has(N))))
            return f.flags |= 65536, _ &= -_, f.lanes |= _, _ = As(_), wh(
              _,
              a,
              f,
              y
            ), ah(f, _), !1;
      }
      f = f.return;
    } while (f !== null);
    return !1;
  }
  var Nf = Error(r(461)), er = !1;
  function ar(a, l, f, y) {
    l.child = a === null ? tp(l, null, f, y) : el(
      l,
      a.child,
      f,
      y
    );
  }
  function Ct(a, l, f, y, _) {
    f = f.render;
    var N = l.ref;
    if ("ref" in y) {
      var B = {};
      for (var ee in y)
        ee !== "ref" && (B[ee] = y[ee]);
    } else B = y;
    return nu(l), y = ch(
      a,
      l,
      f,
      B,
      N,
      _
    ), ee = fh(), a !== null && !er ? (dh(a, l, _), js(a, l, _)) : (Jt && ee && Yo(l), l.flags |= 1, ar(a, l, y, _), l.child);
  }
  function Af(a, l, f, y, _) {
    if (a === null) {
      var N = f.type;
      return typeof N == "function" && !no(N) && N.defaultProps === void 0 && f.compare === null ? (l.tag = 15, l.type = N, _h(
        a,
        l,
        N,
        y,
        _
      )) : (a = Qd(
        f.type,
        null,
        y,
        l,
        l.mode,
        _
      ), a.ref = l.ref, a.return = l, l.child = a);
    }
    if (N = a.child, !Th(a, _)) {
      var B = N.memoizedProps;
      if (f = f.compare, f = f !== null ? f : w, f(B, y) && a.ref === l.ref)
        return js(a, l, _);
    }
    return l.flags |= 1, a = Ea(N, y), a.ref = l.ref, a.return = l, l.child = a;
  }
  function _h(a, l, f, y, _) {
    if (a !== null) {
      var N = a.memoizedProps;
      if (w(N, y) && a.ref === l.ref)
        if (er = !1, l.pendingProps = y = N, Th(a, _))
          (a.flags & 131072) !== 0 && (er = !0);
        else
          return l.lanes = a.lanes, js(a, l, _);
    }
    return Eh(
      a,
      l,
      f,
      y,
      _
    );
  }
  function sl(a, l, f, y) {
    var _ = y.children, N = a !== null ? a.memoizedState : null;
    if (a === null && l.stateNode === null && (l.stateNode = {
      _visibility: 1,
      _pendingMarkers: null,
      _retryCache: null,
      _transitions: null
    }), y.mode === "hidden") {
      if ((l.flags & 128) !== 0) {
        if (N = N !== null ? N.baseLanes | f : f, a !== null) {
          for (y = l.child = a.child, _ = 0; y !== null; )
            _ = _ | y.lanes | y.childLanes, y = y.sibling;
          y = _ & ~N;
        } else y = 0, l.child = null;
        return Sh(
          a,
          l,
          N,
          f,
          y
        );
      }
      if ((f & 536870912) !== 0)
        l.memoizedState = { baseLanes: 0, cachePool: null }, a !== null && eh(
          l,
          N !== null ? N.cachePool : null
        ), N !== null ? np(l, N) : Gr(), iy(l);
      else
        return y = l.lanes = 536870912, Sh(
          a,
          l,
          N !== null ? N.baseLanes | f : f,
          f,
          y
        );
    } else
      N !== null ? (eh(l, N.cachePool), np(l, N), Da(), l.memoizedState = null) : (a !== null && eh(l, null), Gr(), Da());
    return ar(a, l, _, f), l.child;
  }
  function jf(a, l) {
    return a !== null && a.tag === 22 || l.stateNode !== null || (l.stateNode = {
      _visibility: 1,
      _pendingMarkers: null,
      _retryCache: null,
      _transitions: null
    }), l.sibling;
  }
  function Sh(a, l, f, y, _) {
    var N = Jm();
    return N = N === null ? null : { parent: Cr._currentValue, pool: N }, l.memoizedState = {
      baseLanes: f,
      cachePool: N
    }, a !== null && eh(l, null), Gr(), iy(l), a !== null && Qu(a, l, y, !0), l.childLanes = _, null;
  }
  function Mf(a, l) {
    return l = kh(
      { mode: l.mode, children: l.children },
      a.mode
    ), l.ref = a.ref, a.child = l, l.return = a, l;
  }
  function Kr(a, l, f) {
    return el(l, a.child, null, f), a = Mf(l, l.pendingProps), a.flags |= 2, Ni(l), l.memoizedState = null, a;
  }
  function Wx(a, l, f) {
    var y = l.pendingProps, _ = (l.flags & 128) !== 0;
    if (l.flags &= -129, a === null) {
      if (Jt) {
        if (y.mode === "hidden")
          return a = Mf(l, y), l.lanes = 536870912, jf(null, a);
        if (pf(l), (a = gn) ? (a = l1(
          a,
          Aa
        ), a = a !== null && a.data === "&" ? a : null, a !== null && (l.memoizedState = {
          dehydrated: a,
          treeContext: ro !== null ? { id: Es, overflow: Na } : null,
          retryLane: 536870912,
          hydrationErrors: null
        }, f = of(a), f.return = l, l.child = f, Sr = l, gn = null)) : a = null, a === null) throw Xo(l);
        return l.lanes = 536870912, null;
      }
      return Mf(l, y);
    }
    var N = a.memoizedState;
    if (N !== null) {
      var B = N.dehydrated;
      if (pf(l), _)
        if (l.flags & 256)
          l.flags &= -257, l = Kr(
            a,
            l,
            f
          );
        else if (l.memoizedState !== null)
          l.child = a.child, l.flags |= 128, l = null;
        else throw Error(r(558));
      else if (er || Qu(a, l, f, !1), _ = (f & a.childLanes) !== 0, er || _) {
        if (y = jn, y !== null && (B = Dn(y, f), B !== 0 && B !== N.retryLane))
          throw N.retryLane = B, Nn(a, B), Di(y, a, B), Nf;
        Ih(), l = Kr(
          a,
          l,
          f
        );
      } else
        a = N.treeContext, gn = Pa(B.nextSibling), Sr = l, Jt = !0, Wo = null, Aa = !1, a !== null && Wu(l, a), l = Mf(l, y), l.flags |= 4096;
      return l;
    }
    return a = Ea(a.child, {
      mode: y.mode,
      children: y.children
    }), a.ref = l.ref, l.child = a, a.return = l, a;
  }
  function Ch(a, l) {
    var f = l.ref;
    if (f === null)
      a !== null && a.ref !== null && (l.flags |= 4194816);
    else {
      if (typeof f != "function" && typeof f != "object")
        throw Error(r(284));
      (a === null || a.ref !== f) && (l.flags |= 4194816);
    }
  }
  function Eh(a, l, f, y, _) {
    return nu(l), f = ch(
      a,
      l,
      f,
      y,
      void 0,
      _
    ), y = fh(), a !== null && !er ? (dh(a, l, _), js(a, l, _)) : (Jt && y && Yo(l), l.flags |= 1, ar(a, l, f, _), l.child);
  }
  function xy(a, l, f, y, _, N) {
    return nu(l), l.updateQueue = null, f = yf(
      l,
      y,
      f,
      _
    ), rp(a), y = fh(), a !== null && !er ? (dh(a, l, N), js(a, l, N)) : (Jt && y && Yo(l), l.flags |= 1, ar(a, l, f, N), l.child);
  }
  function Np(a, l, f, y, _) {
    if (nu(l), l.stateNode === null) {
      var N = $r, B = f.contextType;
      typeof B == "object" && B !== null && (N = Hr(B)), N = new f(y, N), l.memoizedState = N.state !== null && N.state !== void 0 ? N.state : null, N.updater = kf, l.stateNode = N, N._reactInternals = l, N = l.stateNode, N.props = y, N.state = l.memoizedState, N.refs = {}, Ts(l), B = f.contextType, N.context = typeof B == "object" && B !== null ? Hr(B) : $r, N.state = l.memoizedState, B = f.getDerivedStateFromProps, typeof B == "function" && (bh(
        l,
        f,
        B,
        y
      ), N.state = l.memoizedState), typeof f.getDerivedStateFromProps == "function" || typeof N.getSnapshotBeforeUpdate == "function" || typeof N.UNSAFE_componentWillMount != "function" && typeof N.componentWillMount != "function" || (B = N.state, typeof N.componentWillMount == "function" && N.componentWillMount(), typeof N.UNSAFE_componentWillMount == "function" && N.UNSAFE_componentWillMount(), B !== N.state && kf.enqueueReplaceState(N, N.state, null), rc(l, y, N, _), au(), N.state = l.memoizedState), typeof N.componentDidMount == "function" && (l.flags |= 4194308), y = !0;
    } else if (a === null) {
      N = l.stateNode;
      var ee = l.memoizedProps, ye = pi(f, ee);
      N.props = ye;
      var Pe = N.context, Ve = f.contextType;
      B = $r, typeof Ve == "object" && Ve !== null && (B = Hr(Ve));
      var Ye = f.getDerivedStateFromProps;
      Ve = typeof Ye == "function" || typeof N.getSnapshotBeforeUpdate == "function", ee = l.pendingProps !== ee, Ve || typeof N.UNSAFE_componentWillReceiveProps != "function" && typeof N.componentWillReceiveProps != "function" || (ee || Pe !== B) && Sp(
        l,
        N,
        y,
        B
      ), Ra = !1;
      var Le = l.memoizedState;
      N.state = Le, rc(l, y, N, _), au(), Pe = l.memoizedState, ee || Le !== Pe || Ra ? (typeof Ye == "function" && (bh(
        l,
        f,
        Ye,
        y
      ), Pe = l.memoizedState), (ye = Ra || gy(
        l,
        f,
        ye,
        y,
        Le,
        Pe,
        B
      )) ? (Ve || typeof N.UNSAFE_componentWillMount != "function" && typeof N.componentWillMount != "function" || (typeof N.componentWillMount == "function" && N.componentWillMount(), typeof N.UNSAFE_componentWillMount == "function" && N.UNSAFE_componentWillMount()), typeof N.componentDidMount == "function" && (l.flags |= 4194308)) : (typeof N.componentDidMount == "function" && (l.flags |= 4194308), l.memoizedProps = y, l.memoizedState = Pe), N.props = y, N.state = Pe, N.context = B, y = ye) : (typeof N.componentDidMount == "function" && (l.flags |= 4194308), y = !1);
    } else {
      N = l.stateNode, ih(a, l), B = l.memoizedProps, Ve = pi(f, B), N.props = Ve, Ye = l.pendingProps, Le = N.context, Pe = f.contextType, ye = $r, typeof Pe == "object" && Pe !== null && (ye = Hr(Pe)), ee = f.getDerivedStateFromProps, (Pe = typeof ee == "function" || typeof N.getSnapshotBeforeUpdate == "function") || typeof N.UNSAFE_componentWillReceiveProps != "function" && typeof N.componentWillReceiveProps != "function" || (B !== Ye || Le !== ye) && Sp(
        l,
        N,
        y,
        ye
      ), Ra = !1, Le = l.memoizedState, N.state = Le, rc(l, y, N, _), au();
      var qe = l.memoizedState;
      B !== Ye || Le !== qe || Ra || a !== null && a.dependencies !== null && Jd(a.dependencies) ? (typeof ee == "function" && (bh(
        l,
        f,
        ee,
        y
      ), qe = l.memoizedState), (Ve = Ra || gy(
        l,
        f,
        Ve,
        y,
        Le,
        qe,
        ye
      ) || a !== null && a.dependencies !== null && Jd(a.dependencies)) ? (Pe || typeof N.UNSAFE_componentWillUpdate != "function" && typeof N.componentWillUpdate != "function" || (typeof N.componentWillUpdate == "function" && N.componentWillUpdate(y, qe, ye), typeof N.UNSAFE_componentWillUpdate == "function" && N.UNSAFE_componentWillUpdate(
        y,
        qe,
        ye
      )), typeof N.componentDidUpdate == "function" && (l.flags |= 4), typeof N.getSnapshotBeforeUpdate == "function" && (l.flags |= 1024)) : (typeof N.componentDidUpdate != "function" || B === a.memoizedProps && Le === a.memoizedState || (l.flags |= 4), typeof N.getSnapshotBeforeUpdate != "function" || B === a.memoizedProps && Le === a.memoizedState || (l.flags |= 1024), l.memoizedProps = y, l.memoizedState = qe), N.props = y, N.state = qe, N.context = ye, y = Ve) : (typeof N.componentDidUpdate != "function" || B === a.memoizedProps && Le === a.memoizedState || (l.flags |= 4), typeof N.getSnapshotBeforeUpdate != "function" || B === a.memoizedProps && Le === a.memoizedState || (l.flags |= 1024), y = !1);
    }
    return N = y, Ch(a, l), y = (l.flags & 128) !== 0, N || y ? (N = l.stateNode, f = y && typeof f.getDerivedStateFromError != "function" ? null : N.render(), l.flags |= 1, a !== null && y ? (l.child = el(
      l,
      a.child,
      null,
      _
    ), l.child = el(
      l,
      null,
      f,
      _
    )) : ar(a, l, f, _), l.memoizedState = N.state, a = l.child) : a = js(
      a,
      l,
      _
    ), a;
  }
  function by(a, l, f, y) {
    return te(), l.flags |= 256, ar(a, l, f, y), l.child;
  }
  var Ap = {
    dehydrated: null,
    treeContext: null,
    retryLane: 0,
    hydrationErrors: null
  };
  function jp(a) {
    return { baseLanes: a, cachePool: ey() };
  }
  function is(a, l, f) {
    return a = a !== null ? a.childLanes & ~f : 0, l && (a |= na), a;
  }
  function si(a, l, f) {
    var y = l.pendingProps, _ = !1, N = (l.flags & 128) !== 0, B;
    if ((B = N) || (B = a !== null && a.memoizedState === null ? !1 : (gr.current & 2) !== 0), B && (_ = !0, l.flags &= -129), B = (l.flags & 32) !== 0, l.flags &= -33, a === null) {
      if (Jt) {
        if (_ ? nl(l) : Da(), (a = gn) ? (a = l1(
          a,
          Aa
        ), a = a !== null && a.data !== "&" ? a : null, a !== null && (l.memoizedState = {
          dehydrated: a,
          treeContext: ro !== null ? { id: Es, overflow: Na } : null,
          retryLane: 536870912,
          hydrationErrors: null
        }, f = of(a), f.return = l, l.child = f, Sr = l, gn = null)) : a = null, a === null) throw Xo(l);
        return _c(a) ? l.lanes = 32 : l.lanes = 536870912, null;
      }
      var ee = y.children;
      return y = y.fallback, _ ? (Da(), _ = l.mode, ee = kh(
        { mode: "hidden", children: ee },
        _
      ), y = Jl(
        y,
        _,
        f,
        null
      ), ee.return = l, y.return = l, ee.sibling = y, l.child = ee, y = l.child, y.memoizedState = jp(f), y.childLanes = is(
        a,
        B,
        f
      ), l.memoizedState = Ap, jf(null, y)) : (nl(l), Rf(l, ee));
    }
    var ye = a.memoizedState;
    if (ye !== null && (ee = ye.dehydrated, ee !== null)) {
      if (N)
        l.flags & 256 ? (nl(l), l.flags &= -257, l = Of(
          a,
          l,
          f
        )) : l.memoizedState !== null ? (Da(), l.child = a.child, l.flags |= 128, l = null) : (Da(), ee = y.fallback, _ = l.mode, y = kh(
          { mode: "visible", children: y.children },
          _
        ), ee = Jl(
          ee,
          _,
          f,
          null
        ), ee.flags |= 2, y.return = l, ee.return = l, y.sibling = ee, l.child = y, el(
          l,
          a.child,
          null,
          f
        ), y = l.child, y.memoizedState = jp(f), y.childLanes = is(
          a,
          B,
          f
        ), l.memoizedState = Ap, l = jf(null, y));
      else if (nl(l), _c(ee)) {
        if (B = ee.nextSibling && ee.nextSibling.dataset, B) var Pe = B.dgst;
        B = Pe, y = Error(r(419)), y.stack = "", y.digest = B, Zo({ value: y, source: null, stack: null }), l = Of(
          a,
          l,
          f
        );
      } else if (er || Qu(a, l, f, !1), B = (f & a.childLanes) !== 0, er || B) {
        if (B = jn, B !== null && (y = Dn(B, f), y !== 0 && y !== ye.retryLane))
          throw ye.retryLane = y, Nn(a, y), Di(B, a, y), Nf;
        Vh(ee) || Ih(), l = Of(
          a,
          l,
          f
        );
      } else
        Vh(ee) ? (l.flags |= 192, l.child = a.child, l = null) : (a = ye.treeContext, gn = Pa(
          ee.nextSibling
        ), Sr = l, Jt = !0, Wo = null, Aa = !1, a !== null && Wu(l, a), l = Rf(
          l,
          y.children
        ), l.flags |= 4096);
      return l;
    }
    return _ ? (Da(), ee = y.fallback, _ = l.mode, ye = a.child, Pe = ye.sibling, y = Ea(ye, {
      mode: "hidden",
      children: y.children
    }), y.subtreeFlags = ye.subtreeFlags & 65011712, Pe !== null ? ee = Ea(
      Pe,
      ee
    ) : (ee = Jl(
      ee,
      _,
      f,
      null
    ), ee.flags |= 2), ee.return = l, y.return = l, y.sibling = ee, l.child = y, jf(null, y), y = l.child, ee = a.child.memoizedState, ee === null ? ee = jp(f) : (_ = ee.cachePool, _ !== null ? (ye = Cr._currentValue, _ = _.parent !== ye ? { parent: ye, pool: ye } : _) : _ = ey(), ee = {
      baseLanes: ee.baseLanes | f,
      cachePool: _
    }), y.memoizedState = ee, y.childLanes = is(
      a,
      B,
      f
    ), l.memoizedState = Ap, jf(a.child, y)) : (nl(l), f = a.child, a = f.sibling, f = Ea(f, {
      mode: "visible",
      children: y.children
    }), f.return = l, f.sibling = null, a !== null && (B = l.deletions, B === null ? (l.deletions = [a], l.flags |= 16) : B.push(a)), l.child = f, l.memoizedState = null, f);
  }
  function Rf(a, l) {
    return l = kh(
      { mode: "visible", children: l },
      a.mode
    ), l.return = a, a.child = l;
  }
  function kh(a, l) {
    return a = Vr(22, a, null, l), a.lanes = 0, a;
  }
  function Of(a, l, f) {
    return el(l, a.child, null, f), a = Rf(
      l,
      l.pendingProps.children
    ), a.flags |= 2, l.memoizedState = null, a;
  }
  function wy(a, l, f) {
    a.lanes |= l;
    var y = a.alternate;
    y !== null && (y.lanes |= l), so(a.return, l, f);
  }
  function Mp(a, l, f, y, _, N) {
    var B = a.memoizedState;
    B === null ? a.memoizedState = {
      isBackwards: l,
      rendering: null,
      renderingStartTime: 0,
      last: y,
      tail: f,
      tailMode: _,
      treeForkCount: N
    } : (B.isBackwards = l, B.rendering = null, B.renderingStartTime = 0, B.last = y, B.tail = f, B.tailMode = _, B.treeForkCount = N);
  }
  function hc(a, l, f) {
    var y = l.pendingProps, _ = y.revealOrder, N = y.tail;
    y = y.children;
    var B = gr.current, ee = (B & 2) !== 0;
    if (ee ? (B = B & 1 | 2, l.flags |= 128) : B &= 1, G(gr, B), ar(a, l, y, f), y = Jt ? _r : 0, !ee && a !== null && (a.flags & 128) !== 0)
      e: for (a = l.child; a !== null; ) {
        if (a.tag === 13)
          a.memoizedState !== null && wy(a, f, l);
        else if (a.tag === 19)
          wy(a, f, l);
        else if (a.child !== null) {
          a.child.return = a, a = a.child;
          continue;
        }
        if (a === l) break e;
        for (; a.sibling === null; ) {
          if (a.return === null || a.return === l)
            break e;
          a = a.return;
        }
        a.sibling.return = a.return, a = a.sibling;
      }
    switch (_) {
      case "forwards":
        for (f = l.child, _ = null; f !== null; )
          a = f.alternate, a !== null && oh(a) === null && (_ = f), f = f.sibling;
        f = _, f === null ? (_ = l.child, l.child = null) : (_ = f.sibling, f.sibling = null), Mp(
          l,
          !1,
          _,
          f,
          N,
          y
        );
        break;
      case "backwards":
      case "unstable_legacy-backwards":
        for (f = null, _ = l.child, l.child = null; _ !== null; ) {
          if (a = _.alternate, a !== null && oh(a) === null) {
            l.child = _;
            break;
          }
          a = _.sibling, _.sibling = f, f = _, _ = a;
        }
        Mp(
          l,
          !0,
          f,
          null,
          N,
          y
        );
        break;
      case "together":
        Mp(
          l,
          !1,
          null,
          null,
          void 0,
          y
        );
        break;
      default:
        l.memoizedState = null;
    }
    return l.child;
  }
  function js(a, l, f) {
    if (a !== null && (l.dependencies = a.dependencies), ul |= l.lanes, (f & l.childLanes) === 0)
      if (a !== null) {
        if (Qu(
          a,
          l,
          f,
          !1
        ), (f & l.childLanes) === 0)
          return null;
      } else return null;
    if (a !== null && l.child !== a.child)
      throw Error(r(153));
    if (l.child !== null) {
      for (a = l.child, f = Ea(a, a.pendingProps), l.child = f, f.return = l; a.sibling !== null; )
        a = a.sibling, f = f.sibling = Ea(a, a.pendingProps), f.return = l;
      f.sibling = null;
    }
    return l.child;
  }
  function Th(a, l) {
    return (a.lanes & l) !== 0 ? !0 : (a = a.dependencies, !!(a !== null && Jd(a)));
  }
  function Xx(a, l, f) {
    switch (l.tag) {
      case 3:
        Be(l, l.stateNode.containerInfo), Jo(l, Cr, a.memoizedState.cache), te();
        break;
      case 27:
      case 5:
        ft(l);
        break;
      case 4:
        Be(l, l.stateNode.containerInfo);
        break;
      case 10:
        Jo(
          l,
          l.type,
          l.memoizedProps.value
        );
        break;
      case 31:
        if (l.memoizedState !== null)
          return l.flags |= 128, pf(l), null;
        break;
      case 13:
        var y = l.memoizedState;
        if (y !== null)
          return y.dehydrated !== null ? (nl(l), l.flags |= 128, null) : (f & l.child.childLanes) !== 0 ? si(a, l, f) : (nl(l), a = js(
            a,
            l,
            f
          ), a !== null ? a.sibling : null);
        nl(l);
        break;
      case 19:
        var _ = (a.flags & 128) !== 0;
        if (y = (f & l.childLanes) !== 0, y || (Qu(
          a,
          l,
          f,
          !1
        ), y = (f & l.childLanes) !== 0), _) {
          if (y)
            return hc(
              a,
              l,
              f
            );
          l.flags |= 128;
        }
        if (_ = l.memoizedState, _ !== null && (_.rendering = null, _.tail = null, _.lastEffect = null), G(gr, gr.current), y) break;
        return null;
      case 22:
        return l.lanes = 0, sl(
          a,
          l,
          f,
          l.pendingProps
        );
      case 24:
        Jo(l, Cr, a.memoizedState.cache);
    }
    return js(a, l, f);
  }
  function _y(a, l, f) {
    if (a !== null)
      if (a.memoizedProps !== l.pendingProps)
        er = !0;
      else {
        if (!Th(a, f) && (l.flags & 128) === 0)
          return er = !1, Xx(
            a,
            l,
            f
          );
        er = (a.flags & 131072) !== 0;
      }
    else
      er = !1, Jt && (l.flags & 1048576) !== 0 && Zd(l, _r, l.index);
    switch (l.lanes = 0, l.tag) {
      case 16:
        e: {
          var y = l.pendingProps;
          if (a = Za(l.elementType), l.type = a, typeof a == "function")
            no(a) ? (y = pi(a, y), l.tag = 1, l = Np(
              null,
              l,
              a,
              y,
              f
            )) : (l.tag = 0, l = Eh(
              null,
              l,
              a,
              y,
              f
            ));
          else {
            if (a != null) {
              var _ = a.$$typeof;
              if (_ === D) {
                l.tag = 11, l = Ct(
                  null,
                  l,
                  a,
                  y,
                  f
                );
                break e;
              } else if (_ === L) {
                l.tag = 14, l = Af(
                  null,
                  l,
                  a,
                  y,
                  f
                );
                break e;
              }
            }
            throw l = Q(a) || a, Error(r(306, l, ""));
          }
        }
        return l;
      case 0:
        return Eh(
          a,
          l,
          l.type,
          l.pendingProps,
          f
        );
      case 1:
        return y = l.type, _ = pi(
          y,
          l.pendingProps
        ), Np(
          a,
          l,
          y,
          _,
          f
        );
      case 3:
        e: {
          if (Be(
            l,
            l.stateNode.containerInfo
          ), a === null) throw Error(r(387));
          y = l.pendingProps;
          var N = l.memoizedState;
          _ = N.element, ih(a, l), rc(l, y, null, f);
          var B = l.memoizedState;
          if (y = B.cache, Jo(l, Cr, y), y !== N.cache && Qm(
            l,
            [Cr],
            f,
            !0
          ), au(), y = B.element, N.isDehydrated)
            if (N = {
              element: y,
              isDehydrated: !1,
              cache: B.cache
            }, l.updateQueue.baseState = N, l.memoizedState = N, l.flags & 256) {
              l = by(
                a,
                l,
                y,
                f
              );
              break e;
            } else if (y !== _) {
              _ = Yi(
                Error(r(424)),
                l
              ), Zo(_), l = by(
                a,
                l,
                y,
                f
              );
              break e;
            } else {
              switch (a = l.stateNode.containerInfo, a.nodeType) {
                case 9:
                  a = a.body;
                  break;
                default:
                  a = a.nodeName === "HTML" ? a.ownerDocument.body : a;
              }
              for (gn = Pa(a.firstChild), Sr = l, Jt = !0, Wo = null, Aa = !0, f = tp(
                l,
                null,
                y,
                f
              ), l.child = f; f; )
                f.flags = f.flags & -3 | 4096, f = f.sibling;
            }
          else {
            if (te(), y === _) {
              l = js(
                a,
                l,
                f
              );
              break e;
            }
            ar(a, l, y, f);
          }
          l = l.child;
        }
        return l;
      case 26:
        return Ch(a, l), a === null ? (f = m1(
          l.type,
          null,
          l.pendingProps,
          null
        )) ? l.memoizedState = f : Jt || (f = l.type, a = l.pendingProps, y = Jf(
          Se.current
        ).createElement(f), y[wn] = l, y[Qn] = a, Yr(y, f, a), Zn(y), l.stateNode = y) : l.memoizedState = m1(
          l.type,
          a.memoizedProps,
          l.pendingProps,
          a.memoizedState
        ), null;
      case 27:
        return ft(l), a === null && Jt && (y = l.stateNode = f1(
          l.type,
          l.pendingProps,
          Se.current
        ), Sr = l, Aa = !0, _ = gn, At(l.type) ? (mg = _, gn = Pa(y.firstChild)) : gn = _), ar(
          a,
          l,
          l.pendingProps.children,
          f
        ), Ch(a, l), a === null && (l.flags |= 4194304), l.child;
      case 5:
        return a === null && Jt && ((_ = y = gn) && (y = db(
          y,
          l.type,
          l.pendingProps,
          Aa
        ), y !== null ? (l.stateNode = y, Sr = l, gn = Pa(y.firstChild), Aa = !1, _ = !0) : _ = !1), _ || Xo(l)), ft(l), _ = l.type, N = l.pendingProps, B = a !== null ? a.memoizedProps : null, y = N.children, ml(_, N) ? y = null : B !== null && ml(_, B) && (l.flags |= 32), l.memoizedState !== null && (_ = ch(
          a,
          l,
          Gx,
          null,
          null,
          f
        ), Nc._currentValue = _), Ch(a, l), ar(a, l, y, f), l.child;
      case 6:
        return a === null && Jt && ((a = f = gn) && (f = yn(
          f,
          l.pendingProps,
          Aa
        ), f !== null ? (l.stateNode = f, Sr = l, gn = null, a = !0) : a = !1), a || Xo(l)), null;
      case 13:
        return si(a, l, f);
      case 4:
        return Be(
          l,
          l.stateNode.containerInfo
        ), y = l.pendingProps, a === null ? l.child = el(
          l,
          null,
          y,
          f
        ) : ar(a, l, y, f), l.child;
      case 11:
        return Ct(
          a,
          l,
          l.type,
          l.pendingProps,
          f
        );
      case 7:
        return ar(
          a,
          l,
          l.pendingProps,
          f
        ), l.child;
      case 8:
        return ar(
          a,
          l,
          l.pendingProps.children,
          f
        ), l.child;
      case 12:
        return ar(
          a,
          l,
          l.pendingProps.children,
          f
        ), l.child;
      case 10:
        return y = l.pendingProps, Jo(l, l.type, y.value), ar(a, l, y.children, f), l.child;
      case 9:
        return _ = l.type._context, y = l.pendingProps.children, nu(l), _ = Hr(_), y = y(_), l.flags |= 1, ar(a, l, y, f), l.child;
      case 14:
        return Af(
          a,
          l,
          l.type,
          l.pendingProps,
          f
        );
      case 15:
        return _h(
          a,
          l,
          l.type,
          l.pendingProps,
          f
        );
      case 19:
        return hc(a, l, f);
      case 31:
        return Wx(a, l, f);
      case 22:
        return sl(
          a,
          l,
          f,
          l.pendingProps
        );
      case 24:
        return nu(l), y = Hr(Cr), a === null ? (_ = Jm(), _ === null && (_ = jn, N = Qa(), _.pooledCache = N, N.refCount++, N !== null && (_.pooledCacheLanes |= f), _ = N), l.memoizedState = { parent: y, cache: _ }, Ts(l), Jo(l, Cr, _)) : ((a.lanes & f) !== 0 && (ih(a, l), rc(l, null, null, f), au()), _ = a.memoizedState, N = l.memoizedState, _.parent !== y ? (_ = { parent: y, cache: y }, l.memoizedState = _, l.lanes === 0 && (l.memoizedState = l.updateQueue.baseState = _), Jo(l, Cr, y)) : (y = N.cache, Jo(l, Cr, y), y !== _.cache && Qm(
          l,
          [Cr],
          f,
          !0
        ))), ar(
          a,
          l,
          l.pendingProps.children,
          f
        ), l.child;
      case 29:
        throw l.pendingProps;
    }
    throw Error(r(156, l.tag));
  }
  function uo(a) {
    a.flags |= 4;
  }
  function Rp(a, l, f, y, _) {
    if ((l = (a.mode & 32) !== 0) && (l = !1), l) {
      if (a.flags |= 16777216, (_ & 335544128) === _)
        if (a.stateNode.complete) a.flags |= 8192;
        else if (Vf()) a.flags |= 8192;
        else
          throw ks = nh, th;
    } else a.flags &= -16777217;
  }
  function Op(a, l) {
    if (l.type !== "stylesheet" || (l.state.loading & 4) !== 0)
      a.flags &= -16777217;
    else if (a.flags |= 16777216, !x1(l))
      if (Vf()) a.flags |= 8192;
      else
        throw ks = nh, th;
  }
  function Df(a, l) {
    l !== null && (a.flags |= 4), a.flags & 16384 && (l = a.tag !== 22 ? zl() : 536870912, a.lanes |= l, yc |= l);
  }
  function If(a, l) {
    if (!Jt)
      switch (a.tailMode) {
        case "hidden":
          l = a.tail;
          for (var f = null; l !== null; )
            l.alternate !== null && (f = l), l = l.sibling;
          f === null ? a.tail = null : f.sibling = null;
          break;
        case "collapsed":
          f = a.tail;
          for (var y = null; f !== null; )
            f.alternate !== null && (y = f), f = f.sibling;
          y === null ? l || a.tail === null ? a.tail = null : a.tail.sibling = null : y.sibling = null;
      }
  }
  function An(a) {
    var l = a.alternate !== null && a.alternate.child === a.child, f = 0, y = 0;
    if (l)
      for (var _ = a.child; _ !== null; )
        f |= _.lanes | _.childLanes, y |= _.subtreeFlags & 65011712, y |= _.flags & 65011712, _.return = a, _ = _.sibling;
    else
      for (_ = a.child; _ !== null; )
        f |= _.lanes | _.childLanes, y |= _.subtreeFlags, y |= _.flags, _.return = a, _ = _.sibling;
    return a.subtreeFlags |= y, a.childLanes = f, l;
  }
  function Sy(a, l, f) {
    var y = l.pendingProps;
    switch (eu(l), l.tag) {
      case 16:
      case 15:
      case 0:
      case 11:
      case 7:
      case 8:
      case 12:
      case 9:
      case 14:
        return An(l), null;
      case 1:
        return An(l), null;
      case 3:
        return f = l.stateNode, y = null, a !== null && (y = a.memoizedState.cache), l.memoizedState.cache !== y && (l.flags |= 2048), ao(Cr), Re(), f.pendingContext && (f.context = f.pendingContext, f.pendingContext = null), (a === null || a.child === null) && (tu(l) ? uo(l) : a === null || a.memoizedState.isDehydrated && (l.flags & 256) === 0 || (l.flags |= 1024, Qo())), An(l), null;
      case 26:
        var _ = l.type, N = l.memoizedState;
        return a === null ? (uo(l), N !== null ? (An(l), Op(l, N)) : (An(l), Rp(
          l,
          _,
          null,
          y,
          f
        ))) : N ? N !== a.memoizedState ? (uo(l), An(l), Op(l, N)) : (An(l), l.flags &= -16777217) : (a = a.memoizedProps, a !== y && uo(l), An(l), Rp(
          l,
          _,
          a,
          y,
          f
        )), null;
      case 27:
        if (Ie(l), f = Se.current, _ = l.type, a !== null && l.stateNode != null)
          a.memoizedProps !== y && uo(l);
        else {
          if (!y) {
            if (l.stateNode === null)
              throw Error(r(166));
            return An(l), null;
          }
          a = le.current, tu(l) ? uf(l) : (a = f1(_, y, f), l.stateNode = a, uo(l));
        }
        return An(l), null;
      case 5:
        if (Ie(l), _ = l.type, a !== null && l.stateNode != null)
          a.memoizedProps !== y && uo(l);
        else {
          if (!y) {
            if (l.stateNode === null)
              throw Error(r(166));
            return An(l), null;
          }
          if (N = le.current, tu(l))
            uf(l);
          else {
            var B = Jf(
              Se.current
            );
            switch (N) {
              case 1:
                N = B.createElementNS(
                  "http://www.w3.org/2000/svg",
                  _
                );
                break;
              case 2:
                N = B.createElementNS(
                  "http://www.w3.org/1998/Math/MathML",
                  _
                );
                break;
              default:
                switch (_) {
                  case "svg":
                    N = B.createElementNS(
                      "http://www.w3.org/2000/svg",
                      _
                    );
                    break;
                  case "math":
                    N = B.createElementNS(
                      "http://www.w3.org/1998/Math/MathML",
                      _
                    );
                    break;
                  case "script":
                    N = B.createElement("div"), N.innerHTML = "<script><\/script>", N = N.removeChild(
                      N.firstChild
                    );
                    break;
                  case "select":
                    N = typeof y.is == "string" ? B.createElement("select", {
                      is: y.is
                    }) : B.createElement("select"), y.multiple ? N.multiple = !0 : y.size && (N.size = y.size);
                    break;
                  default:
                    N = typeof y.is == "string" ? B.createElement(_, { is: y.is }) : B.createElement(_);
                }
            }
            N[wn] = l, N[Qn] = y;
            e: for (B = l.child; B !== null; ) {
              if (B.tag === 5 || B.tag === 6)
                N.appendChild(B.stateNode);
              else if (B.tag !== 4 && B.tag !== 27 && B.child !== null) {
                B.child.return = B, B = B.child;
                continue;
              }
              if (B === l) break e;
              for (; B.sibling === null; ) {
                if (B.return === null || B.return === l)
                  break e;
                B = B.return;
              }
              B.sibling.return = B.return, B = B.sibling;
            }
            l.stateNode = N;
            e: switch (Yr(N, _, y), _) {
              case "button":
              case "input":
              case "select":
              case "textarea":
                y = !!y.autoFocus;
                break e;
              case "img":
                y = !0;
                break e;
              default:
                y = !1;
            }
            y && uo(l);
          }
        }
        return An(l), Rp(
          l,
          l.type,
          a === null ? null : a.memoizedProps,
          l.pendingProps,
          f
        ), null;
      case 6:
        if (a && l.stateNode != null)
          a.memoizedProps !== y && uo(l);
        else {
          if (typeof y != "string" && l.stateNode === null)
            throw Error(r(166));
          if (a = Se.current, tu(l)) {
            if (a = l.stateNode, f = l.memoizedProps, y = null, _ = Sr, _ !== null)
              switch (_.tag) {
                case 27:
                case 5:
                  y = _.memoizedProps;
              }
            a[wn] = l, a = !!(a.nodeValue === f || y !== null && y.suppressHydrationWarning === !0 || i1(a.nodeValue, f)), a || Xo(l, !0);
          } else
            a = Jf(a).createTextNode(
              y
            ), a[wn] = l, l.stateNode = a;
        }
        return An(l), null;
      case 31:
        if (f = l.memoizedState, a === null || a.memoizedState !== null) {
          if (y = tu(l), f !== null) {
            if (a === null) {
              if (!y) throw Error(r(318));
              if (a = l.memoizedState, a = a !== null ? a.dehydrated : null, !a) throw Error(r(557));
              a[wn] = l;
            } else
              te(), (l.flags & 128) === 0 && (l.memoizedState = null), l.flags |= 4;
            An(l), a = !1;
          } else
            f = Qo(), a !== null && a.memoizedState !== null && (a.memoizedState.hydrationErrors = f), a = !0;
          if (!a)
            return l.flags & 256 ? (Ni(l), l) : (Ni(l), null);
          if ((l.flags & 128) !== 0)
            throw Error(r(558));
        }
        return An(l), null;
      case 13:
        if (y = l.memoizedState, a === null || a.memoizedState !== null && a.memoizedState.dehydrated !== null) {
          if (_ = tu(l), y !== null && y.dehydrated !== null) {
            if (a === null) {
              if (!_) throw Error(r(318));
              if (_ = l.memoizedState, _ = _ !== null ? _.dehydrated : null, !_) throw Error(r(317));
              _[wn] = l;
            } else
              te(), (l.flags & 128) === 0 && (l.memoizedState = null), l.flags |= 4;
            An(l), _ = !1;
          } else
            _ = Qo(), a !== null && a.memoizedState !== null && (a.memoizedState.hydrationErrors = _), _ = !0;
          if (!_)
            return l.flags & 256 ? (Ni(l), l) : (Ni(l), null);
        }
        return Ni(l), (l.flags & 128) !== 0 ? (l.lanes = f, l) : (f = y !== null, a = a !== null && a.memoizedState !== null, f && (y = l.child, _ = null, y.alternate !== null && y.alternate.memoizedState !== null && y.alternate.memoizedState.cachePool !== null && (_ = y.alternate.memoizedState.cachePool.pool), N = null, y.memoizedState !== null && y.memoizedState.cachePool !== null && (N = y.memoizedState.cachePool.pool), N !== _ && (y.flags |= 2048)), f !== a && f && (l.child.flags |= 8192), Df(l, l.updateQueue), An(l), null);
      case 4:
        return Re(), a === null && og(l.stateNode.containerInfo), An(l), null;
      case 10:
        return ao(l.type), An(l), null;
      case 19:
        if (fe(gr), y = l.memoizedState, y === null) return An(l), null;
        if (_ = (l.flags & 128) !== 0, N = y.rendering, N === null)
          if (_) If(y, !1);
          else {
            if (tr !== 0 || a !== null && (a.flags & 128) !== 0)
              for (a = l.child; a !== null; ) {
                if (N = oh(a), N !== null) {
                  for (l.flags |= 128, If(y, !1), a = N.updateQueue, l.updateQueue = a, Df(l, a), l.subtreeFlags = 0, a = f, f = l.child; f !== null; )
                    X0(f, a), f = f.sibling;
                  return G(
                    gr,
                    gr.current & 1 | 2
                  ), Jt && Wi(l, y.treeForkCount), l.child;
                }
                a = a.sibling;
              }
            y.tail !== null && En() > cu && (l.flags |= 128, _ = !0, If(y, !1), l.lanes = 4194304);
          }
        else {
          if (!_)
            if (a = oh(N), a !== null) {
              if (l.flags |= 128, _ = !0, a = a.updateQueue, l.updateQueue = a, Df(l, a), If(y, !0), y.tail === null && y.tailMode === "hidden" && !N.alternate && !Jt)
                return An(l), null;
            } else
              2 * En() - y.renderingStartTime > cu && f !== 536870912 && (l.flags |= 128, _ = !0, If(y, !1), l.lanes = 4194304);
          y.isBackwards ? (N.sibling = l.child, l.child = N) : (a = y.last, a !== null ? a.sibling = N : l.child = N, y.last = N);
        }
        return y.tail !== null ? (a = y.tail, y.rendering = a, y.tail = a.sibling, y.renderingStartTime = En(), a.sibling = null, f = gr.current, G(
          gr,
          _ ? f & 1 | 2 : f & 1
        ), Jt && Wi(l, y.treeForkCount), a) : (An(l), null);
      case 22:
      case 23:
        return Ni(l), mf(), y = l.memoizedState !== null, a !== null ? a.memoizedState !== null !== y && (l.flags |= 8192) : y && (l.flags |= 8192), y ? (f & 536870912) !== 0 && (l.flags & 128) === 0 && (An(l), l.subtreeFlags & 6 && (l.flags |= 8192)) : An(l), f = l.updateQueue, f !== null && Df(l, f.retryQueue), f = null, a !== null && a.memoizedState !== null && a.memoizedState.cachePool !== null && (f = a.memoizedState.cachePool.pool), y = null, l.memoizedState !== null && l.memoizedState.cachePool !== null && (y = l.memoizedState.cachePool.pool), y !== f && (l.flags |= 2048), a !== null && fe(iu), null;
      case 24:
        return f = null, a !== null && (f = a.memoizedState.cache), l.memoizedState.cache !== f && (l.flags |= 2048), ao(Cr), An(l), null;
      case 25:
        return null;
      case 30:
        return null;
    }
    throw Error(r(156, l.tag));
  }
  function Pf(a, l) {
    switch (eu(l), l.tag) {
      case 1:
        return a = l.flags, a & 65536 ? (l.flags = a & -65537 | 128, l) : null;
      case 3:
        return ao(Cr), Re(), a = l.flags, (a & 65536) !== 0 && (a & 128) === 0 ? (l.flags = a & -65537 | 128, l) : null;
      case 26:
      case 27:
      case 5:
        return Ie(l), null;
      case 31:
        if (l.memoizedState !== null) {
          if (Ni(l), l.alternate === null)
            throw Error(r(340));
          te();
        }
        return a = l.flags, a & 65536 ? (l.flags = a & -65537 | 128, l) : null;
      case 13:
        if (Ni(l), a = l.memoizedState, a !== null && a.dehydrated !== null) {
          if (l.alternate === null)
            throw Error(r(340));
          te();
        }
        return a = l.flags, a & 65536 ? (l.flags = a & -65537 | 128, l) : null;
      case 19:
        return fe(gr), null;
      case 4:
        return Re(), null;
      case 10:
        return ao(l.type), null;
      case 22:
      case 23:
        return Ni(l), mf(), a !== null && fe(iu), a = l.flags, a & 65536 ? (l.flags = a & -65537 | 128, l) : null;
      case 24:
        return ao(Cr), null;
      case 25:
        return null;
      default:
        return null;
    }
  }
  function Nh(a, l) {
    switch (eu(l), l.tag) {
      case 3:
        ao(Cr), Re();
        break;
      case 26:
      case 27:
      case 5:
        Ie(l);
        break;
      case 4:
        Re();
        break;
      case 31:
        l.memoizedState !== null && Ni(l);
        break;
      case 13:
        Ni(l);
        break;
      case 19:
        fe(gr);
        break;
      case 10:
        ao(l.type);
        break;
      case 22:
      case 23:
        Ni(l), mf(), a !== null && fe(iu);
        break;
      case 24:
        ao(Cr);
    }
  }
  function mc(a, l) {
    try {
      var f = l.updateQueue, y = f !== null ? f.lastEffect : null;
      if (y !== null) {
        var _ = y.next;
        f = _;
        do {
          if ((f.tag & a) === a) {
            y = void 0;
            var N = f.create, B = f.inst;
            y = N(), B.destroy = y;
          }
          f = f.next;
        } while (f !== _);
      }
    } catch (ee) {
      bn(l, l.return, ee);
    }
  }
  function co(a, l, f) {
    try {
      var y = l.updateQueue, _ = y !== null ? y.lastEffect : null;
      if (_ !== null) {
        var N = _.next;
        y = N;
        do {
          if ((y.tag & a) === a) {
            var B = y.inst, ee = B.destroy;
            if (ee !== void 0) {
              B.destroy = void 0, _ = l;
              var ye = f, Pe = ee;
              try {
                Pe();
              } catch (Ve) {
                bn(
                  _,
                  ye,
                  Ve
                );
              }
            }
          }
          y = y.next;
        } while (y !== N);
      }
    } catch (Ve) {
      bn(l, l.return, Ve);
    }
  }
  function zf(a) {
    var l = a.updateQueue;
    if (l !== null) {
      var f = a.stateNode;
      try {
        sh(l, f);
      } catch (y) {
        bn(a, a.return, y);
      }
    }
  }
  function Dp(a, l, f) {
    f.props = pi(
      a.type,
      a.memoizedProps
    ), f.state = a.memoizedState;
    try {
      f.componentWillUnmount();
    } catch (y) {
      bn(a, l, y);
    }
  }
  function ji(a, l) {
    try {
      var f = a.ref;
      if (f !== null) {
        switch (a.tag) {
          case 26:
          case 27:
          case 5:
            var y = a.stateNode;
            break;
          case 30:
            y = a.stateNode;
            break;
          default:
            y = a.stateNode;
        }
        typeof f == "function" ? a.refCleanup = f(y) : f.current = y;
      }
    } catch (_) {
      bn(a, l, _);
    }
  }
  function oi(a, l) {
    var f = a.ref, y = a.refCleanup;
    if (f !== null)
      if (typeof y == "function")
        try {
          y();
        } catch (_) {
          bn(a, l, _);
        } finally {
          a.refCleanup = null, a = a.alternate, a != null && (a.refCleanup = null);
        }
      else if (typeof f == "function")
        try {
          f(null);
        } catch (_) {
          bn(a, l, _);
        }
      else f.current = null;
  }
  function Cy(a) {
    var l = a.type, f = a.memoizedProps, y = a.stateNode;
    try {
      e: switch (l) {
        case "button":
        case "input":
        case "select":
        case "textarea":
          f.autoFocus && y.focus();
          break e;
        case "img":
          f.src ? y.src = f.src : f.srcSet && (y.srcset = f.srcSet);
      }
    } catch (_) {
      bn(a, a.return, _);
    }
  }
  function Ah(a, l, f) {
    try {
      var y = a.stateNode;
      ub(y, a.type, f, l), y[Qn] = l;
    } catch (_) {
      bn(a, a.return, _);
    }
  }
  function Ey(a) {
    return a.tag === 5 || a.tag === 3 || a.tag === 26 || a.tag === 27 && At(a.type) || a.tag === 4;
  }
  function Ip(a) {
    e: for (; ; ) {
      for (; a.sibling === null; ) {
        if (a.return === null || Ey(a.return)) return null;
        a = a.return;
      }
      for (a.sibling.return = a.return, a = a.sibling; a.tag !== 5 && a.tag !== 6 && a.tag !== 18; ) {
        if (a.tag === 27 && At(a.type) || a.flags & 2 || a.child === null || a.tag === 4) continue e;
        a.child.return = a, a = a.child;
      }
      if (!(a.flags & 2)) return a.stateNode;
    }
  }
  function Pp(a, l, f) {
    var y = a.tag;
    if (y === 5 || y === 6)
      a = a.stateNode, l ? (f.nodeType === 9 ? f.body : f.nodeName === "HTML" ? f.ownerDocument.body : f).insertBefore(a, l) : (l = f.nodeType === 9 ? f.body : f.nodeName === "HTML" ? f.ownerDocument.body : f, l.appendChild(a), f = f._reactRootContainer, f != null || l.onclick !== null || (l.onclick = ki));
    else if (y !== 4 && (y === 27 && At(a.type) && (f = a.stateNode, l = null), a = a.child, a !== null))
      for (Pp(a, l, f), a = a.sibling; a !== null; )
        Pp(a, l, f), a = a.sibling;
  }
  function jh(a, l, f) {
    var y = a.tag;
    if (y === 5 || y === 6)
      a = a.stateNode, l ? f.insertBefore(a, l) : f.appendChild(a);
    else if (y !== 4 && (y === 27 && At(a.type) && (f = a.stateNode), a = a.child, a !== null))
      for (jh(a, l, f), a = a.sibling; a !== null; )
        jh(a, l, f), a = a.sibling;
  }
  function ky(a) {
    var l = a.stateNode, f = a.memoizedProps;
    try {
      for (var y = a.type, _ = l.attributes; _.length; )
        l.removeAttributeNode(_[0]);
      Yr(l, y, f), l[wn] = a, l[Qn] = f;
    } catch (N) {
      bn(a, a.return, N);
    }
  }
  var fo = !1, Er = !1, zp = !1, Ty = typeof WeakSet == "function" ? WeakSet : Set, Or = null;
  function Qx(a, l) {
    if (a = a.containerInfo, Zf = Qh, a = q(a), X(a)) {
      if ("selectionStart" in a)
        var f = {
          start: a.selectionStart,
          end: a.selectionEnd
        };
      else
        e: {
          f = (f = a.ownerDocument) && f.defaultView || window;
          var y = f.getSelection && f.getSelection();
          if (y && y.rangeCount !== 0) {
            f = y.anchorNode;
            var _ = y.anchorOffset, N = y.focusNode;
            y = y.focusOffset;
            try {
              f.nodeType, N.nodeType;
            } catch {
              f = null;
              break e;
            }
            var B = 0, ee = -1, ye = -1, Pe = 0, Ve = 0, Ye = a, Le = null;
            t: for (; ; ) {
              for (var qe; Ye !== f || _ !== 0 && Ye.nodeType !== 3 || (ee = B + _), Ye !== N || y !== 0 && Ye.nodeType !== 3 || (ye = B + y), Ye.nodeType === 3 && (B += Ye.nodeValue.length), (qe = Ye.firstChild) !== null; )
                Le = Ye, Ye = qe;
              for (; ; ) {
                if (Ye === a) break t;
                if (Le === f && ++Pe === _ && (ee = B), Le === N && ++Ve === y && (ye = B), (qe = Ye.nextSibling) !== null) break;
                Ye = Le, Le = Ye.parentNode;
              }
              Ye = qe;
            }
            f = ee === -1 || ye === -1 ? null : { start: ee, end: ye };
          } else f = null;
        }
      f = f || { start: 0, end: 0 };
    } else f = null;
    for (fg = { focusedElem: a, selectionRange: f }, Qh = !1, Or = l; Or !== null; )
      if (l = Or, a = l.child, (l.subtreeFlags & 1028) !== 0 && a !== null)
        a.return = l, Or = a;
      else
        for (; Or !== null; ) {
          switch (l = Or, N = l.alternate, a = l.flags, l.tag) {
            case 0:
              if ((a & 4) !== 0 && (a = l.updateQueue, a = a !== null ? a.events : null, a !== null))
                for (f = 0; f < a.length; f++)
                  _ = a[f], _.ref.impl = _.nextImpl;
              break;
            case 11:
            case 15:
              break;
            case 1:
              if ((a & 1024) !== 0 && N !== null) {
                a = void 0, f = l, _ = N.memoizedProps, N = N.memoizedState, y = f.stateNode;
                try {
                  var xt = pi(
                    f.type,
                    _
                  );
                  a = y.getSnapshotBeforeUpdate(
                    xt,
                    N
                  ), y.__reactInternalSnapshotBeforeUpdate = a;
                } catch (kt) {
                  bn(
                    f,
                    f.return,
                    kt
                  );
                }
              }
              break;
            case 3:
              if ((a & 1024) !== 0) {
                if (a = l.stateNode.containerInfo, f = a.nodeType, f === 9)
                  $h(a);
                else if (f === 1)
                  switch (a.nodeName) {
                    case "HEAD":
                    case "HTML":
                    case "BODY":
                      $h(a);
                      break;
                    default:
                      a.textContent = "";
                  }
              }
              break;
            case 5:
            case 26:
            case 27:
            case 6:
            case 4:
            case 17:
              break;
            default:
              if ((a & 1024) !== 0) throw Error(r(163));
          }
          if (a = l.sibling, a !== null) {
            a.return = l.return, Or = a;
            break;
          }
          Or = l.return;
        }
  }
  function Lp(a, l, f) {
    var y = f.flags;
    switch (f.tag) {
      case 0:
      case 11:
      case 15:
        mo(a, f), y & 4 && mc(5, f);
        break;
      case 1:
        if (mo(a, f), y & 4)
          if (a = f.stateNode, l === null)
            try {
              a.componentDidMount();
            } catch (B) {
              bn(f, f.return, B);
            }
          else {
            var _ = pi(
              f.type,
              l.memoizedProps
            );
            l = l.memoizedState;
            try {
              a.componentDidUpdate(
                _,
                l,
                a.__reactInternalSnapshotBeforeUpdate
              );
            } catch (B) {
              bn(
                f,
                f.return,
                B
              );
            }
          }
        y & 64 && zf(f), y & 512 && ji(f, f.return);
        break;
      case 3:
        if (mo(a, f), y & 64 && (a = f.updateQueue, a !== null)) {
          if (l = null, f.child !== null)
            switch (f.child.tag) {
              case 27:
              case 5:
                l = f.child.stateNode;
                break;
              case 1:
                l = f.child.stateNode;
            }
          try {
            sh(a, l);
          } catch (B) {
            bn(f, f.return, B);
          }
        }
        break;
      case 27:
        l === null && y & 4 && ky(f);
      case 26:
      case 5:
        mo(a, f), l === null && y & 4 && Cy(f), y & 512 && ji(f, f.return);
        break;
      case 12:
        mo(a, f);
        break;
      case 31:
        mo(a, f), y & 4 && qp(a, f);
        break;
      case 13:
        mo(a, f), y & 4 && Ay(a, f), y & 64 && (a = f.memoizedState, a !== null && (a = a.dehydrated, a !== null && (f = Lh.bind(
          null,
          f
        ), hb(a, f))));
        break;
      case 22:
        if (y = f.memoizedState !== null || fo, !y) {
          l = l !== null && l.memoizedState !== null || Er, _ = fo;
          var N = Er;
          fo = y, (Er = l) && !N ? Ms(
            a,
            f,
            (f.subtreeFlags & 8772) !== 0
          ) : mo(a, f), fo = _, Er = N;
        }
        break;
      case 30:
        break;
      default:
        mo(a, f);
    }
  }
  function Bp(a) {
    var l = a.alternate;
    l !== null && (a.alternate = null, Bp(l)), a.child = null, a.deletions = null, a.sibling = null, a.tag === 5 && (l = a.stateNode, l !== null && Po(l)), a.stateNode = null, a.return = null, a.dependencies = null, a.memoizedProps = null, a.memoizedState = null, a.pendingProps = null, a.stateNode = null, a.updateQueue = null;
  }
  var Bn = null, Mi = !1;
  function ho(a, l, f) {
    for (f = f.child; f !== null; )
      Ny(a, l, f), f = f.sibling;
  }
  function Ny(a, l, f) {
    if (Qt && typeof Qt.onCommitFiberUnmount == "function")
      try {
        Qt.onCommitFiberUnmount(sn, f);
      } catch {
      }
    switch (f.tag) {
      case 26:
        Er || oi(f, l), ho(
          a,
          l,
          f
        ), f.memoizedState ? f.memoizedState.count-- : f.stateNode && (f = f.stateNode, f.parentNode.removeChild(f));
        break;
      case 27:
        Er || oi(f, l);
        var y = Bn, _ = Mi;
        At(f.type) && (Bn = f.stateNode, Mi = !1), ho(
          a,
          l,
          f
        ), td(f.stateNode), Bn = y, Mi = _;
        break;
      case 5:
        Er || oi(f, l);
      case 6:
        if (y = Bn, _ = Mi, Bn = null, ho(
          a,
          l,
          f
        ), Bn = y, Mi = _, Bn !== null)
          if (Mi)
            try {
              (Bn.nodeType === 9 ? Bn.body : Bn.nodeName === "HTML" ? Bn.ownerDocument.body : Bn).removeChild(f.stateNode);
            } catch (N) {
              bn(
                f,
                l,
                N
              );
            }
          else
            try {
              Bn.removeChild(f.stateNode);
            } catch (N) {
              bn(
                f,
                l,
                N
              );
            }
        break;
      case 18:
        Bn !== null && (Mi ? (a = Bn, hg(
          a.nodeType === 9 ? a.body : a.nodeName === "HTML" ? a.ownerDocument.body : a,
          f.stateNode
        ), jc(a)) : hg(Bn, f.stateNode));
        break;
      case 4:
        y = Bn, _ = Mi, Bn = f.stateNode.containerInfo, Mi = !0, ho(
          a,
          l,
          f
        ), Bn = y, Mi = _;
        break;
      case 0:
      case 11:
      case 14:
      case 15:
        co(2, f, l), Er || co(4, f, l), ho(
          a,
          l,
          f
        );
        break;
      case 1:
        Er || (oi(f, l), y = f.stateNode, typeof y.componentWillUnmount == "function" && Dp(
          f,
          l,
          y
        )), ho(
          a,
          l,
          f
        );
        break;
      case 21:
        ho(
          a,
          l,
          f
        );
        break;
      case 22:
        Er = (y = Er) || f.memoizedState !== null, ho(
          a,
          l,
          f
        ), Er = y;
        break;
      default:
        ho(
          a,
          l,
          f
        );
    }
  }
  function qp(a, l) {
    if (l.memoizedState === null && (a = l.alternate, a !== null && (a = a.memoizedState, a !== null))) {
      a = a.dehydrated;
      try {
        jc(a);
      } catch (f) {
        bn(l, l.return, f);
      }
    }
  }
  function Ay(a, l) {
    if (l.memoizedState === null && (a = l.alternate, a !== null && (a = a.memoizedState, a !== null && (a = a.dehydrated, a !== null))))
      try {
        jc(a);
      } catch (f) {
        bn(l, l.return, f);
      }
  }
  function Zx(a) {
    switch (a.tag) {
      case 31:
      case 13:
      case 19:
        var l = a.stateNode;
        return l === null && (l = a.stateNode = new Ty()), l;
      case 22:
        return a = a.stateNode, l = a._retryCache, l === null && (l = a._retryCache = new Ty()), l;
      default:
        throw Error(r(435, a.tag));
    }
  }
  function Mh(a, l) {
    var f = Zx(a);
    l.forEach(function(y) {
      if (!f.has(y)) {
        f.add(y);
        var _ = ab.bind(null, a, y);
        y.then(_, _);
      }
    });
  }
  function Ri(a, l) {
    var f = l.deletions;
    if (f !== null)
      for (var y = 0; y < f.length; y++) {
        var _ = f[y], N = a, B = l, ee = B;
        e: for (; ee !== null; ) {
          switch (ee.tag) {
            case 27:
              if (At(ee.type)) {
                Bn = ee.stateNode, Mi = !1;
                break e;
              }
              break;
            case 5:
              Bn = ee.stateNode, Mi = !1;
              break e;
            case 3:
            case 4:
              Bn = ee.stateNode.containerInfo, Mi = !0;
              break e;
          }
          ee = ee.return;
        }
        if (Bn === null) throw Error(r(160));
        Ny(N, B, _), Bn = null, Mi = !1, N = _.alternate, N !== null && (N.return = null), _.return = null;
      }
    if (l.subtreeFlags & 13886)
      for (l = l.child; l !== null; )
        jy(l, a), l = l.sibling;
  }
  var as = null;
  function jy(a, l) {
    var f = a.alternate, y = a.flags;
    switch (a.tag) {
      case 0:
      case 11:
      case 14:
      case 15:
        Ri(l, a), qn(a), y & 4 && (co(3, a, a.return), mc(3, a), co(5, a, a.return));
        break;
      case 1:
        Ri(l, a), qn(a), y & 512 && (Er || f === null || oi(f, f.return)), y & 64 && fo && (a = a.updateQueue, a !== null && (y = a.callbacks, y !== null && (f = a.shared.hiddenCallbacks, a.shared.hiddenCallbacks = f === null ? y : f.concat(y))));
        break;
      case 26:
        var _ = as;
        if (Ri(l, a), qn(a), y & 512 && (Er || f === null || oi(f, f.return)), y & 4) {
          var N = f !== null ? f.memoizedState : null;
          if (y = a.memoizedState, f === null)
            if (y === null)
              if (a.stateNode === null) {
                e: {
                  y = a.type, f = a.memoizedProps, _ = _.ownerDocument || _;
                  t: switch (y) {
                    case "title":
                      N = _.getElementsByTagName("title")[0], (!N || N[li] || N[wn] || N.namespaceURI === "http://www.w3.org/2000/svg" || N.hasAttribute("itemprop")) && (N = _.createElement(y), _.head.insertBefore(
                        N,
                        _.querySelector("head > title")
                      )), Yr(N, y, f), N[wn] = a, Zn(N), y = N;
                      break e;
                    case "link":
                      var B = y1(
                        "link",
                        "href",
                        _
                      ).get(y + (f.href || ""));
                      if (B) {
                        for (var ee = 0; ee < B.length; ee++)
                          if (N = B[ee], N.getAttribute("href") === (f.href == null || f.href === "" ? null : f.href) && N.getAttribute("rel") === (f.rel == null ? null : f.rel) && N.getAttribute("title") === (f.title == null ? null : f.title) && N.getAttribute("crossorigin") === (f.crossOrigin == null ? null : f.crossOrigin)) {
                            B.splice(ee, 1);
                            break t;
                          }
                      }
                      N = _.createElement(y), Yr(N, y, f), _.head.appendChild(N);
                      break;
                    case "meta":
                      if (B = y1(
                        "meta",
                        "content",
                        _
                      ).get(y + (f.content || ""))) {
                        for (ee = 0; ee < B.length; ee++)
                          if (N = B[ee], N.getAttribute("content") === (f.content == null ? null : "" + f.content) && N.getAttribute("name") === (f.name == null ? null : f.name) && N.getAttribute("property") === (f.property == null ? null : f.property) && N.getAttribute("http-equiv") === (f.httpEquiv == null ? null : f.httpEquiv) && N.getAttribute("charset") === (f.charSet == null ? null : f.charSet)) {
                            B.splice(ee, 1);
                            break t;
                          }
                      }
                      N = _.createElement(y), Yr(N, y, f), _.head.appendChild(N);
                      break;
                    default:
                      throw Error(r(468, y));
                  }
                  N[wn] = a, Zn(N), y = N;
                }
                a.stateNode = y;
              } else
                v1(
                  _,
                  a.type,
                  a.stateNode
                );
            else
              a.stateNode = g1(
                _,
                y,
                a.memoizedProps
              );
          else
            N !== y ? (N === null ? f.stateNode !== null && (f = f.stateNode, f.parentNode.removeChild(f)) : N.count--, y === null ? v1(
              _,
              a.type,
              a.stateNode
            ) : g1(
              _,
              y,
              a.memoizedProps
            )) : y === null && a.stateNode !== null && Ah(
              a,
              a.memoizedProps,
              f.memoizedProps
            );
        }
        break;
      case 27:
        Ri(l, a), qn(a), y & 512 && (Er || f === null || oi(f, f.return)), f !== null && y & 4 && Ah(
          a,
          a.memoizedProps,
          f.memoizedProps
        );
        break;
      case 5:
        if (Ri(l, a), qn(a), y & 512 && (Er || f === null || oi(f, f.return)), a.flags & 32) {
          _ = a.stateNode;
          try {
            Ei(_, "");
          } catch (xt) {
            bn(a, a.return, xt);
          }
        }
        y & 4 && a.stateNode != null && (_ = a.memoizedProps, Ah(
          a,
          _,
          f !== null ? f.memoizedProps : _
        )), y & 1024 && (zp = !0);
        break;
      case 6:
        if (Ri(l, a), qn(a), y & 4) {
          if (a.stateNode === null)
            throw Error(r(162));
          y = a.memoizedProps, f = a.stateNode;
          try {
            f.nodeValue = y;
          } catch (xt) {
            bn(a, a.return, xt);
          }
        }
        break;
      case 3:
        if (nd = null, _ = as, as = Hh(l.containerInfo), Ri(l, a), as = _, qn(a), y & 4 && f !== null && f.memoizedState.isDehydrated)
          try {
            jc(l.containerInfo);
          } catch (xt) {
            bn(a, a.return, xt);
          }
        zp && (zp = !1, My(a));
        break;
      case 4:
        y = as, as = Hh(
          a.stateNode.containerInfo
        ), Ri(l, a), qn(a), as = y;
        break;
      case 12:
        Ri(l, a), qn(a);
        break;
      case 31:
        Ri(l, a), qn(a), y & 4 && (y = a.updateQueue, y !== null && (a.updateQueue = null, Mh(a, y)));
        break;
      case 13:
        Ri(l, a), qn(a), a.child.flags & 8192 && a.memoizedState !== null != (f !== null && f.memoizedState !== null) && (Uf = En()), y & 4 && (y = a.updateQueue, y !== null && (a.updateQueue = null, Mh(a, y)));
        break;
      case 22:
        _ = a.memoizedState !== null;
        var ye = f !== null && f.memoizedState !== null, Pe = fo, Ve = Er;
        if (fo = Pe || _, Er = Ve || ye, Ri(l, a), Er = Ve, fo = Pe, qn(a), y & 8192)
          e: for (l = a.stateNode, l._visibility = _ ? l._visibility & -2 : l._visibility | 1, _ && (f === null || ye || fo || Er || lu(a)), f = null, l = a; ; ) {
            if (l.tag === 5 || l.tag === 26) {
              if (f === null) {
                ye = f = l;
                try {
                  if (N = ye.stateNode, _)
                    B = N.style, typeof B.setProperty == "function" ? B.setProperty("display", "none", "important") : B.display = "none";
                  else {
                    ee = ye.stateNode;
                    var Ye = ye.memoizedProps.style, Le = Ye != null && Ye.hasOwnProperty("display") ? Ye.display : null;
                    ee.style.display = Le == null || typeof Le == "boolean" ? "" : ("" + Le).trim();
                  }
                } catch (xt) {
                  bn(ye, ye.return, xt);
                }
              }
            } else if (l.tag === 6) {
              if (f === null) {
                ye = l;
                try {
                  ye.stateNode.nodeValue = _ ? "" : ye.memoizedProps;
                } catch (xt) {
                  bn(ye, ye.return, xt);
                }
              }
            } else if (l.tag === 18) {
              if (f === null) {
                ye = l;
                try {
                  var qe = ye.stateNode;
                  _ ? sa(qe, !0) : sa(ye.stateNode, !1);
                } catch (xt) {
                  bn(ye, ye.return, xt);
                }
              }
            } else if ((l.tag !== 22 && l.tag !== 23 || l.memoizedState === null || l === a) && l.child !== null) {
              l.child.return = l, l = l.child;
              continue;
            }
            if (l === a) break e;
            for (; l.sibling === null; ) {
              if (l.return === null || l.return === a) break e;
              f === l && (f = null), l = l.return;
            }
            f === l && (f = null), l.sibling.return = l.return, l = l.sibling;
          }
        y & 4 && (y = a.updateQueue, y !== null && (f = y.retryQueue, f !== null && (y.retryQueue = null, Mh(a, f))));
        break;
      case 19:
        Ri(l, a), qn(a), y & 4 && (y = a.updateQueue, y !== null && (a.updateQueue = null, Mh(a, y)));
        break;
      case 30:
        break;
      case 21:
        break;
      default:
        Ri(l, a), qn(a);
    }
  }
  function qn(a) {
    var l = a.flags;
    if (l & 2) {
      try {
        for (var f, y = a.return; y !== null; ) {
          if (Ey(y)) {
            f = y;
            break;
          }
          y = y.return;
        }
        if (f == null) throw Error(r(160));
        switch (f.tag) {
          case 27:
            var _ = f.stateNode, N = Ip(a);
            jh(a, N, _);
            break;
          case 5:
            var B = f.stateNode;
            f.flags & 32 && (Ei(B, ""), f.flags &= -33);
            var ee = Ip(a);
            jh(a, ee, B);
            break;
          case 3:
          case 4:
            var ye = f.stateNode.containerInfo, Pe = Ip(a);
            Pp(
              a,
              Pe,
              ye
            );
            break;
          default:
            throw Error(r(161));
        }
      } catch (Ve) {
        bn(a, a.return, Ve);
      }
      a.flags &= -3;
    }
    l & 4096 && (a.flags &= -4097);
  }
  function My(a) {
    if (a.subtreeFlags & 1024)
      for (a = a.child; a !== null; ) {
        var l = a;
        My(l), l.tag === 5 && l.flags & 1024 && l.stateNode.reset(), a = a.sibling;
      }
  }
  function mo(a, l) {
    if (l.subtreeFlags & 8772)
      for (l = l.child; l !== null; )
        Lp(a, l.alternate, l), l = l.sibling;
  }
  function lu(a) {
    for (a = a.child; a !== null; ) {
      var l = a;
      switch (l.tag) {
        case 0:
        case 11:
        case 14:
        case 15:
          co(4, l, l.return), lu(l);
          break;
        case 1:
          oi(l, l.return);
          var f = l.stateNode;
          typeof f.componentWillUnmount == "function" && Dp(
            l,
            l.return,
            f
          ), lu(l);
          break;
        case 27:
          td(l.stateNode);
        case 26:
        case 5:
          oi(l, l.return), lu(l);
          break;
        case 22:
          l.memoizedState === null && lu(l);
          break;
        case 30:
          lu(l);
          break;
        default:
          lu(l);
      }
      a = a.sibling;
    }
  }
  function Ms(a, l, f) {
    for (f = f && (l.subtreeFlags & 8772) !== 0, l = l.child; l !== null; ) {
      var y = l.alternate, _ = a, N = l, B = N.flags;
      switch (N.tag) {
        case 0:
        case 11:
        case 15:
          Ms(
            _,
            N,
            f
          ), mc(4, N);
          break;
        case 1:
          if (Ms(
            _,
            N,
            f
          ), y = N, _ = y.stateNode, typeof _.componentDidMount == "function")
            try {
              _.componentDidMount();
            } catch (Pe) {
              bn(y, y.return, Pe);
            }
          if (y = N, _ = y.updateQueue, _ !== null) {
            var ee = y.stateNode;
            try {
              var ye = _.shared.hiddenCallbacks;
              if (ye !== null)
                for (_.shared.hiddenCallbacks = null, _ = 0; _ < ye.length; _++)
                  ts(ye[_], ee);
            } catch (Pe) {
              bn(y, y.return, Pe);
            }
          }
          f && B & 64 && zf(N), ji(N, N.return);
          break;
        case 27:
          ky(N);
        case 26:
        case 5:
          Ms(
            _,
            N,
            f
          ), f && y === null && B & 4 && Cy(N), ji(N, N.return);
          break;
        case 12:
          Ms(
            _,
            N,
            f
          );
          break;
        case 31:
          Ms(
            _,
            N,
            f
          ), f && B & 4 && qp(_, N);
          break;
        case 13:
          Ms(
            _,
            N,
            f
          ), f && B & 4 && Ay(_, N);
          break;
        case 22:
          N.memoizedState === null && Ms(
            _,
            N,
            f
          ), ji(N, N.return);
          break;
        case 30:
          break;
        default:
          Ms(
            _,
            N,
            f
          );
      }
      l = l.sibling;
    }
  }
  function Fp(a, l) {
    var f = null;
    a !== null && a.memoizedState !== null && a.memoizedState.cachePool !== null && (f = a.memoizedState.cachePool.pool), a = null, l.memoizedState !== null && l.memoizedState.cachePool !== null && (a = l.memoizedState.cachePool.pool), a !== f && (a != null && a.refCount++, f != null && cf(f));
  }
  function Up(a, l) {
    a = null, l.alternate !== null && (a = l.alternate.memoizedState.cache), l = l.memoizedState.cache, l !== a && (l.refCount++, a != null && cf(a));
  }
  function ss(a, l, f, y) {
    if (l.subtreeFlags & 10256)
      for (l = l.child; l !== null; )
        Ry(
          a,
          l,
          f,
          y
        ), l = l.sibling;
  }
  function Ry(a, l, f, y) {
    var _ = l.flags;
    switch (l.tag) {
      case 0:
      case 11:
      case 15:
        ss(
          a,
          l,
          f,
          y
        ), _ & 2048 && mc(9, l);
        break;
      case 1:
        ss(
          a,
          l,
          f,
          y
        );
        break;
      case 3:
        ss(
          a,
          l,
          f,
          y
        ), _ & 2048 && (a = null, l.alternate !== null && (a = l.alternate.memoizedState.cache), l = l.memoizedState.cache, l !== a && (l.refCount++, a != null && cf(a)));
        break;
      case 12:
        if (_ & 2048) {
          ss(
            a,
            l,
            f,
            y
          ), a = l.stateNode;
          try {
            var N = l.memoizedProps, B = N.id, ee = N.onPostCommit;
            typeof ee == "function" && ee(
              B,
              l.alternate === null ? "mount" : "update",
              a.passiveEffectDuration,
              -0
            );
          } catch (ye) {
            bn(l, l.return, ye);
          }
        } else
          ss(
            a,
            l,
            f,
            y
          );
        break;
      case 31:
        ss(
          a,
          l,
          f,
          y
        );
        break;
      case 13:
        ss(
          a,
          l,
          f,
          y
        );
        break;
      case 23:
        break;
      case 22:
        N = l.stateNode, B = l.alternate, l.memoizedState !== null ? N._visibility & 2 ? ss(
          a,
          l,
          f,
          y
        ) : Lf(a, l) : N._visibility & 2 ? ss(
          a,
          l,
          f,
          y
        ) : (N._visibility |= 2, ol(
          a,
          l,
          f,
          y,
          (l.subtreeFlags & 10256) !== 0 || !1
        )), _ & 2048 && Fp(B, l);
        break;
      case 24:
        ss(
          a,
          l,
          f,
          y
        ), _ & 2048 && Up(l.alternate, l);
        break;
      default:
        ss(
          a,
          l,
          f,
          y
        );
    }
  }
  function ol(a, l, f, y, _) {
    for (_ = _ && ((l.subtreeFlags & 10256) !== 0 || !1), l = l.child; l !== null; ) {
      var N = a, B = l, ee = f, ye = y, Pe = B.flags;
      switch (B.tag) {
        case 0:
        case 11:
        case 15:
          ol(
            N,
            B,
            ee,
            ye,
            _
          ), mc(8, B);
          break;
        case 23:
          break;
        case 22:
          var Ve = B.stateNode;
          B.memoizedState !== null ? Ve._visibility & 2 ? ol(
            N,
            B,
            ee,
            ye,
            _
          ) : Lf(
            N,
            B
          ) : (Ve._visibility |= 2, ol(
            N,
            B,
            ee,
            ye,
            _
          )), _ && Pe & 2048 && Fp(
            B.alternate,
            B
          );
          break;
        case 24:
          ol(
            N,
            B,
            ee,
            ye,
            _
          ), _ && Pe & 2048 && Up(B.alternate, B);
          break;
        default:
          ol(
            N,
            B,
            ee,
            ye,
            _
          );
      }
      l = l.sibling;
    }
  }
  function Lf(a, l) {
    if (l.subtreeFlags & 10256)
      for (l = l.child; l !== null; ) {
        var f = a, y = l, _ = y.flags;
        switch (y.tag) {
          case 22:
            Lf(f, y), _ & 2048 && Fp(
              y.alternate,
              y
            );
            break;
          case 24:
            Lf(f, y), _ & 2048 && Up(y.alternate, y);
            break;
          default:
            Lf(f, y);
        }
        l = l.sibling;
      }
  }
  var Bf = 8192;
  function pc(a, l, f) {
    if (a.subtreeFlags & Bf)
      for (a = a.child; a !== null; )
        Oy(
          a,
          l,
          f
        ), a = a.sibling;
  }
  function Oy(a, l, f) {
    switch (a.tag) {
      case 26:
        pc(
          a,
          l,
          f
        ), a.flags & Bf && a.memoizedState !== null && Tc(
          f,
          as,
          a.memoizedState,
          a.memoizedProps
        );
        break;
      case 5:
        pc(
          a,
          l,
          f
        );
        break;
      case 3:
      case 4:
        var y = as;
        as = Hh(a.stateNode.containerInfo), pc(
          a,
          l,
          f
        ), as = y;
        break;
      case 22:
        a.memoizedState === null && (y = a.alternate, y !== null && y.memoizedState !== null ? (y = Bf, Bf = 16777216, pc(
          a,
          l,
          f
        ), Bf = y) : pc(
          a,
          l,
          f
        ));
        break;
      default:
        pc(
          a,
          l,
          f
        );
    }
  }
  function Dy(a) {
    var l = a.alternate;
    if (l !== null && (a = l.child, a !== null)) {
      l.child = null;
      do
        l = a.sibling, a.sibling = null, a = l;
      while (a !== null);
    }
  }
  function qf(a) {
    var l = a.deletions;
    if ((a.flags & 16) !== 0) {
      if (l !== null)
        for (var f = 0; f < l.length; f++) {
          var y = l[f];
          Or = y, Py(
            y,
            a
          );
        }
      Dy(a);
    }
    if (a.subtreeFlags & 10256)
      for (a = a.child; a !== null; )
        Iy(a), a = a.sibling;
  }
  function Iy(a) {
    switch (a.tag) {
      case 0:
      case 11:
      case 15:
        qf(a), a.flags & 2048 && co(9, a, a.return);
        break;
      case 3:
        qf(a);
        break;
      case 12:
        qf(a);
        break;
      case 22:
        var l = a.stateNode;
        a.memoizedState !== null && l._visibility & 2 && (a.return === null || a.return.tag !== 13) ? (l._visibility &= -3, Rh(a)) : qf(a);
        break;
      default:
        qf(a);
    }
  }
  function Rh(a) {
    var l = a.deletions;
    if ((a.flags & 16) !== 0) {
      if (l !== null)
        for (var f = 0; f < l.length; f++) {
          var y = l[f];
          Or = y, Py(
            y,
            a
          );
        }
      Dy(a);
    }
    for (a = a.child; a !== null; ) {
      switch (l = a, l.tag) {
        case 0:
        case 11:
        case 15:
          co(8, l, l.return), Rh(l);
          break;
        case 22:
          f = l.stateNode, f._visibility & 2 && (f._visibility &= -3, Rh(l));
          break;
        default:
          Rh(l);
      }
      a = a.sibling;
    }
  }
  function Py(a, l) {
    for (; Or !== null; ) {
      var f = Or;
      switch (f.tag) {
        case 0:
        case 11:
        case 15:
          co(8, f, l);
          break;
        case 23:
        case 22:
          if (f.memoizedState !== null && f.memoizedState.cachePool !== null) {
            var y = f.memoizedState.cachePool.pool;
            y != null && y.refCount++;
          }
          break;
        case 24:
          cf(f.memoizedState.cache);
      }
      if (y = f.child, y !== null) y.return = f, Or = y;
      else
        e: for (f = a; Or !== null; ) {
          y = Or;
          var _ = y.sibling, N = y.return;
          if (Bp(y), y === f) {
            Or = null;
            break e;
          }
          if (_ !== null) {
            _.return = N, Or = _;
            break e;
          }
          Or = N;
        }
    }
  }
  var Jx = {
    getCacheForType: function(a) {
      var l = Hr(Cr), f = l.data.get(a);
      return f === void 0 && (f = a(), l.data.set(a, f)), f;
    },
    cacheSignal: function() {
      return Hr(Cr).controller.signal;
    }
  }, eb = typeof WeakMap == "function" ? WeakMap : Map, mn = 0, jn = null, Gt = null, Wt = 0, xn = 0, ta = null, ll = !1, gc = !1, $p = !1, os = 0, tr = 0, ul = 0, uu = 0, Vp = 0, na = 0, yc = 0, Ff = null, Oi = null, Hp = !1, Uf = 0, zy = 0, cu = 1 / 0, Oh = null, cl = null, Nr = 0, fl = null, vc = null, po = 0, Gp = 0, Kp = null, Ly = null, $f = 0, Yp = null;
  function ra() {
    return (mn & 2) !== 0 && Wt !== 0 ? Wt & -Wt : J.T !== null ? ia() : $s();
  }
  function By() {
    if (na === 0)
      if ((Wt & 536870912) === 0 || Jt) {
        var a = Va;
        Va <<= 1, (Va & 3932160) === 0 && (Va = 262144), na = a;
      } else na = 536870912;
    return a = Qi.current, a !== null && (a.flags |= 32), na;
  }
  function Di(a, l, f) {
    (a === jn && (xn === 2 || xn === 9) || a.cancelPendingCommit !== null) && (xc(a, 0), go(
      a,
      Wt,
      na,
      !1
    )), Si(a, f), ((mn & 2) === 0 || a !== jn) && (a === jn && ((mn & 2) === 0 && (uu |= f), tr === 4 && go(
      a,
      Wt,
      na,
      !1
    )), Rs(a));
  }
  function qy(a, l, f) {
    if ((mn & 6) !== 0) throw Error(r(327));
    var y = !f && (l & 127) === 0 && (l & a.expiredLanes) === 0 || Ha(a, l), _ = y ? nb(a, l) : Xp(a, l, !0), N = y;
    do {
      if (_ === 0) {
        gc && !y && go(a, l, 0, !1);
        break;
      } else {
        if (f = a.current.alternate, N && !Uy(f)) {
          _ = Xp(a, l, !1), N = !1;
          continue;
        }
        if (_ === 2) {
          if (N = l, a.errorRecoveryDisabledLanes & N)
            var B = 0;
          else
            B = a.pendingLanes & -536870913, B = B !== 0 ? B : B & 536870912 ? 536870912 : 0;
          if (B !== 0) {
            l = B;
            e: {
              var ee = a;
              _ = Ff;
              var ye = ee.current.memoizedState.isDehydrated;
              if (ye && (xc(ee, B).flags |= 256), B = Xp(
                ee,
                B,
                !1
              ), B !== 2) {
                if ($p && !ye) {
                  ee.errorRecoveryDisabledLanes |= N, uu |= N, _ = 4;
                  break e;
                }
                N = Oi, Oi = _, N !== null && (Oi === null ? Oi = N : Oi.push.apply(
                  Oi,
                  N
                ));
              }
              _ = B;
            }
            if (N = !1, _ !== 2) continue;
          }
        }
        if (_ === 1) {
          xc(a, 0), go(a, l, 0, !0);
          break;
        }
        e: {
          switch (y = a, N = _, N) {
            case 0:
            case 1:
              throw Error(r(345));
            case 4:
              if ((l & 4194048) !== l) break;
            case 6:
              go(
                y,
                l,
                na,
                !ll
              );
              break e;
            case 2:
              Oi = null;
              break;
            case 3:
            case 5:
              break;
            default:
              throw Error(r(329));
          }
          if ((l & 62914560) === l && (_ = Uf + 300 - En(), 10 < _)) {
            if (go(
              y,
              l,
              na,
              !ll
            ), Us(y, 0, !0) !== 0) break e;
            po = l, y.timeoutHandle = a1(
              Fy.bind(
                null,
                y,
                f,
                Oi,
                Oh,
                Hp,
                l,
                na,
                uu,
                yc,
                ll,
                N,
                "Throttled",
                -0,
                0
              ),
              _
            );
            break e;
          }
          Fy(
            y,
            f,
            Oi,
            Oh,
            Hp,
            l,
            na,
            uu,
            yc,
            ll,
            N,
            null,
            -0,
            0
          );
        }
      }
      break;
    } while (!0);
    Rs(a);
  }
  function Fy(a, l, f, y, _, N, B, ee, ye, Pe, Ve, Ye, Le, qe) {
    if (a.timeoutHandle = -1, Ye = l.subtreeFlags, Ye & 8192 || (Ye & 16785408) === 16785408) {
      Ye = {
        stylesheets: null,
        count: 0,
        imgCount: 0,
        imgBytes: 0,
        suspenseyImages: [],
        waitingForImages: !0,
        waitingForViewTransition: !1,
        unsuspend: ki
      }, Oy(
        l,
        N,
        Ye
      );
      var xt = (N & 62914560) === N ? Uf - En() : (N & 4194048) === N ? zy - En() : 0;
      if (xt = _b(
        Ye,
        xt
      ), xt !== null) {
        po = N, a.cancelPendingCommit = xt(
          Yy.bind(
            null,
            a,
            l,
            N,
            f,
            y,
            _,
            B,
            ee,
            ye,
            Ve,
            Ye,
            null,
            Le,
            qe
          )
        ), go(a, N, B, !Pe);
        return;
      }
    }
    Yy(
      a,
      l,
      N,
      f,
      y,
      _,
      B,
      ee,
      ye
    );
  }
  function Uy(a) {
    for (var l = a; ; ) {
      var f = l.tag;
      if ((f === 0 || f === 11 || f === 15) && l.flags & 16384 && (f = l.updateQueue, f !== null && (f = f.stores, f !== null)))
        for (var y = 0; y < f.length; y++) {
          var _ = f[y], N = _.getSnapshot;
          _ = _.value;
          try {
            if (!Mn(N(), _)) return !1;
          } catch {
            return !1;
          }
        }
      if (f = l.child, l.subtreeFlags & 16384 && f !== null)
        f.return = l, l = f;
      else {
        if (l === a) break;
        for (; l.sibling === null; ) {
          if (l.return === null || l.return === a) return !0;
          l = l.return;
        }
        l.sibling.return = l.return, l = l.sibling;
      }
    }
    return !0;
  }
  function go(a, l, f, y) {
    l &= ~Vp, l &= ~uu, a.suspendedLanes |= l, a.pingedLanes &= ~l, y && (a.warmLanes |= l), y = a.expirationTimes;
    for (var _ = l; 0 < _; ) {
      var N = 31 - it(_), B = 1 << N;
      y[N] = -1, _ &= ~B;
    }
    f !== 0 && Ga(a, f, l);
  }
  function Dh() {
    return (mn & 6) === 0 ? (Yf(0), !1) : !0;
  }
  function Wp() {
    if (Gt !== null) {
      if (xn === 0)
        var a = Gt.return;
      else
        a = Gt, io = Lt = null, ip(a), tc = null, Xi = 0, a = Gt;
      for (; a !== null; )
        Nh(a.alternate, a), a = a.return;
      Gt = null;
    }
  }
  function xc(a, l) {
    var f = a.timeoutHandle;
    f !== -1 && (a.timeoutHandle = -1, fb(f)), f = a.cancelPendingCommit, f !== null && (a.cancelPendingCommit = null, f()), po = 0, Wp(), jn = a, Gt = f = Ea(a.current, null), Wt = l, xn = 0, ta = null, ll = !1, gc = Ha(a, l), $p = !1, yc = na = Vp = uu = ul = tr = 0, Oi = Ff = null, Hp = !1, (l & 8) !== 0 && (l |= l & 32);
    var y = a.entangledLanes;
    if (y !== 0)
      for (a = a.entanglements, y &= l; 0 < y; ) {
        var _ = 31 - it(y), N = 1 << _;
        l |= a[_], y &= ~N;
      }
    return os = l, Ln(), f;
  }
  function $y(a, l) {
    Bt = null, J.H = al, l === ec || l === df ? (l = ny(), xn = 3) : l === th ? (l = ny(), xn = 4) : xn = l === Nf ? 8 : l !== null && typeof l == "object" && typeof l.then == "function" ? 6 : 1, ta = l, Gt === null && (tr = 1, Tf(
      a,
      Yi(l, a.current)
    ));
  }
  function Vf() {
    var a = Qi.current;
    return a === null ? !0 : (Wt & 4194048) === Wt ? Oa === null : (Wt & 62914560) === Wt || (Wt & 536870912) !== 0 ? a === Oa : !1;
  }
  function Vy() {
    var a = J.H;
    return J.H = al, a === null ? al : a;
  }
  function Hy() {
    var a = J.A;
    return J.A = Jx, a;
  }
  function Ih() {
    tr = 4, ll || (Wt & 4194048) !== Wt && Qi.current !== null || (gc = !0), (ul & 134217727) === 0 && (uu & 134217727) === 0 || jn === null || go(
      jn,
      Wt,
      na,
      !1
    );
  }
  function Xp(a, l, f) {
    var y = mn;
    mn |= 2;
    var _ = Vy(), N = Hy();
    (jn !== a || Wt !== l) && (Oh = null, xc(a, l)), l = !1;
    var B = tr;
    e: do
      try {
        if (xn !== 0 && Gt !== null) {
          var ee = Gt, ye = ta;
          switch (xn) {
            case 8:
              Wp(), B = 6;
              break e;
            case 3:
            case 2:
            case 9:
            case 6:
              Qi.current === null && (l = !0);
              var Pe = xn;
              if (xn = 0, ta = null, bc(a, ee, ye, Pe), f && gc) {
                B = 0;
                break e;
              }
              break;
            default:
              Pe = xn, xn = 0, ta = null, bc(a, ee, ye, Pe);
          }
        }
        tb(), B = tr;
        break;
      } catch (Ve) {
        $y(a, Ve);
      }
    while (!0);
    return l && a.shellSuspendCounter++, io = Lt = null, mn = y, J.H = _, J.A = N, Gt === null && (jn = null, Wt = 0, Ln()), B;
  }
  function tb() {
    for (; Gt !== null; ) Gy(Gt);
  }
  function nb(a, l) {
    var f = mn;
    mn |= 2;
    var y = Vy(), _ = Hy();
    jn !== a || Wt !== l ? (Oh = null, cu = En() + 500, xc(a, l)) : gc = Ha(
      a,
      l
    );
    e: do
      try {
        if (xn !== 0 && Gt !== null) {
          l = Gt;
          var N = ta;
          t: switch (xn) {
            case 1:
              xn = 0, ta = null, bc(a, l, N, 1);
              break;
            case 2:
            case 9:
              if (ty(N)) {
                xn = 0, ta = null, Ky(l);
                break;
              }
              l = function() {
                xn !== 2 && xn !== 9 || jn !== a || (xn = 7), Rs(a);
              }, N.then(l, l);
              break e;
            case 3:
              xn = 7;
              break e;
            case 4:
              xn = 5;
              break e;
            case 7:
              ty(N) ? (xn = 0, ta = null, Ky(l)) : (xn = 0, ta = null, bc(a, l, N, 7));
              break;
            case 5:
              var B = null;
              switch (Gt.tag) {
                case 26:
                  B = Gt.memoizedState;
                case 5:
                case 27:
                  var ee = Gt;
                  if (B ? x1(B) : ee.stateNode.complete) {
                    xn = 0, ta = null;
                    var ye = ee.sibling;
                    if (ye !== null) Gt = ye;
                    else {
                      var Pe = ee.return;
                      Pe !== null ? (Gt = Pe, Ph(Pe)) : Gt = null;
                    }
                    break t;
                  }
              }
              xn = 0, ta = null, bc(a, l, N, 5);
              break;
            case 6:
              xn = 0, ta = null, bc(a, l, N, 6);
              break;
            case 8:
              Wp(), tr = 6;
              break e;
            default:
              throw Error(r(462));
          }
        }
        rb();
        break;
      } catch (Ve) {
        $y(a, Ve);
      }
    while (!0);
    return io = Lt = null, J.H = y, J.A = _, mn = f, Gt !== null ? 0 : (jn = null, Wt = 0, Ln(), tr);
  }
  function rb() {
    for (; Gt !== null && !On(); )
      Gy(Gt);
  }
  function Gy(a) {
    var l = _y(a.alternate, a, os);
    a.memoizedProps = a.pendingProps, l === null ? Ph(a) : Gt = l;
  }
  function Ky(a) {
    var l = a, f = l.alternate;
    switch (l.tag) {
      case 15:
      case 0:
        l = xy(
          f,
          l,
          l.pendingProps,
          l.type,
          void 0,
          Wt
        );
        break;
      case 11:
        l = xy(
          f,
          l,
          l.pendingProps,
          l.type.render,
          l.ref,
          Wt
        );
        break;
      case 5:
        ip(l);
      default:
        Nh(f, l), l = Gt = X0(l, os), l = _y(f, l, os);
    }
    a.memoizedProps = a.pendingProps, l === null ? Ph(a) : Gt = l;
  }
  function bc(a, l, f, y) {
    io = Lt = null, ip(l), tc = null, Xi = 0;
    var _ = l.return;
    try {
      if (Tp(
        a,
        _,
        l,
        f,
        Wt
      )) {
        tr = 1, Tf(
          a,
          Yi(f, a.current)
        ), Gt = null;
        return;
      }
    } catch (N) {
      if (_ !== null) throw Gt = _, N;
      tr = 1, Tf(
        a,
        Yi(f, a.current)
      ), Gt = null;
      return;
    }
    l.flags & 32768 ? (Jt || y === 1 ? a = !0 : gc || (Wt & 536870912) !== 0 ? a = !1 : (ll = a = !0, (y === 2 || y === 9 || y === 3 || y === 6) && (y = Qi.current, y !== null && y.tag === 13 && (y.flags |= 16384))), Hf(l, a)) : Ph(l);
  }
  function Ph(a) {
    var l = a;
    do {
      if ((l.flags & 32768) !== 0) {
        Hf(
          l,
          ll
        );
        return;
      }
      a = l.return;
      var f = Sy(
        l.alternate,
        l,
        os
      );
      if (f !== null) {
        Gt = f;
        return;
      }
      if (l = l.sibling, l !== null) {
        Gt = l;
        return;
      }
      Gt = l = a;
    } while (l !== null);
    tr === 0 && (tr = 5);
  }
  function Hf(a, l) {
    do {
      var f = Pf(a.alternate, a);
      if (f !== null) {
        f.flags &= 32767, Gt = f;
        return;
      }
      if (f = a.return, f !== null && (f.flags |= 32768, f.subtreeFlags = 0, f.deletions = null), !l && (a = a.sibling, a !== null)) {
        Gt = a;
        return;
      }
      Gt = a = f;
    } while (a !== null);
    tr = 6, Gt = null;
  }
  function Yy(a, l, f, y, _, N, B, ee, ye) {
    a.cancelPendingCommit = null;
    do
      Gf();
    while (Nr !== 0);
    if ((mn & 6) !== 0) throw Error(r(327));
    if (l !== null) {
      if (l === a.current) throw Error(r(177));
      if (N = l.lanes | l.childLanes, N |= Dt, Ll(
        a,
        f,
        N,
        B,
        ee,
        ye
      ), a === jn && (Gt = jn = null, Wt = 0), vc = l, fl = a, po = f, Gp = N, Kp = _, Ly = y, (l.subtreeFlags & 10256) !== 0 || (l.flags & 10256) !== 0 ? (a.callbackNode = null, a.callbackPriority = 0, sb(yt, function() {
        return eg(), null;
      })) : (a.callbackNode = null, a.callbackPriority = 0), y = (l.flags & 13878) !== 0, (l.subtreeFlags & 13878) !== 0 || y) {
        y = J.T, J.T = null, _ = ue.p, ue.p = 2, B = mn, mn |= 4;
        try {
          Qx(a, l, f);
        } finally {
          mn = B, ue.p = _, J.T = y;
        }
      }
      Nr = 1, Qp(), Zp(), zh();
    }
  }
  function Qp() {
    if (Nr === 1) {
      Nr = 0;
      var a = fl, l = vc, f = (l.flags & 13878) !== 0;
      if ((l.subtreeFlags & 13878) !== 0 || f) {
        f = J.T, J.T = null;
        var y = ue.p;
        ue.p = 2;
        var _ = mn;
        mn |= 4;
        try {
          jy(l, a);
          var N = fg, B = q(a.containerInfo), ee = N.focusedElem, ye = N.selectionRange;
          if (B !== ee && ee && ee.ownerDocument && P(
            ee.ownerDocument.documentElement,
            ee
          )) {
            if (ye !== null && X(ee)) {
              var Pe = ye.start, Ve = ye.end;
              if (Ve === void 0 && (Ve = Pe), "selectionStart" in ee)
                ee.selectionStart = Pe, ee.selectionEnd = Math.min(
                  Ve,
                  ee.value.length
                );
              else {
                var Ye = ee.ownerDocument || document, Le = Ye && Ye.defaultView || window;
                if (Le.getSelection) {
                  var qe = Le.getSelection(), xt = ee.textContent.length, kt = Math.min(ye.start, xt), Cn = ye.end === void 0 ? kt : Math.min(ye.end, xt);
                  !qe.extend && kt > Cn && (B = Cn, Cn = kt, kt = B);
                  var Ae = R(
                    ee,
                    kt
                  ), Ee = R(
                    ee,
                    Cn
                  );
                  if (Ae && Ee && (qe.rangeCount !== 1 || qe.anchorNode !== Ae.node || qe.anchorOffset !== Ae.offset || qe.focusNode !== Ee.node || qe.focusOffset !== Ee.offset)) {
                    var De = Ye.createRange();
                    De.setStart(Ae.node, Ae.offset), qe.removeAllRanges(), kt > Cn ? (qe.addRange(De), qe.extend(Ee.node, Ee.offset)) : (De.setEnd(Ee.node, Ee.offset), qe.addRange(De));
                  }
                }
              }
            }
            for (Ye = [], qe = ee; qe = qe.parentNode; )
              qe.nodeType === 1 && Ye.push({
                element: qe,
                left: qe.scrollLeft,
                top: qe.scrollTop
              });
            for (typeof ee.focus == "function" && ee.focus(), ee = 0; ee < Ye.length; ee++) {
              var Ke = Ye[ee];
              Ke.element.scrollLeft = Ke.left, Ke.element.scrollTop = Ke.top;
            }
          }
          Qh = !!Zf, fg = Zf = null;
        } finally {
          mn = _, ue.p = y, J.T = f;
        }
      }
      a.current = l, Nr = 2;
    }
  }
  function Zp() {
    if (Nr === 2) {
      Nr = 0;
      var a = fl, l = vc, f = (l.flags & 8772) !== 0;
      if ((l.subtreeFlags & 8772) !== 0 || f) {
        f = J.T, J.T = null;
        var y = ue.p;
        ue.p = 2;
        var _ = mn;
        mn |= 4;
        try {
          Lp(a, l.alternate, l);
        } finally {
          mn = _, ue.p = y, J.T = f;
        }
      }
      Nr = 3;
    }
  }
  function zh() {
    if (Nr === 4 || Nr === 3) {
      Nr = 0, an();
      var a = fl, l = vc, f = po, y = Ly;
      (l.subtreeFlags & 10256) !== 0 || (l.flags & 10256) !== 0 ? Nr = 5 : (Nr = 0, vc = fl = null, Jp(a, a.pendingLanes));
      var _ = a.pendingLanes;
      if (_ === 0 && (cl = null), ys(f), l = l.stateNode, Qt && typeof Qt.onCommitFiberRoot == "function")
        try {
          Qt.onCommitFiberRoot(
            sn,
            l,
            void 0,
            (l.current.flags & 128) === 128
          );
        } catch {
        }
      if (y !== null) {
        l = J.T, _ = ue.p, ue.p = 2, J.T = null;
        try {
          for (var N = a.onRecoverableError, B = 0; B < y.length; B++) {
            var ee = y[B];
            N(ee.value, {
              componentStack: ee.stack
            });
          }
        } finally {
          J.T = l, ue.p = _;
        }
      }
      (po & 3) !== 0 && Gf(), Rs(a), _ = a.pendingLanes, (f & 261930) !== 0 && (_ & 42) !== 0 ? a === Yp ? $f++ : ($f = 0, Yp = a) : $f = 0, Yf(0);
    }
  }
  function Jp(a, l) {
    (a.pooledCacheLanes &= l) === 0 && (l = a.pooledCache, l != null && (a.pooledCache = null, cf(l)));
  }
  function Gf() {
    return Qp(), Zp(), zh(), eg();
  }
  function eg() {
    if (Nr !== 5) return !1;
    var a = fl, l = Gp;
    Gp = 0;
    var f = ys(po), y = J.T, _ = ue.p;
    try {
      ue.p = 32 > f ? 32 : f, J.T = null, f = Kp, Kp = null;
      var N = fl, B = po;
      if (Nr = 0, vc = fl = null, po = 0, (mn & 6) !== 0) throw Error(r(331));
      var ee = mn;
      if (mn |= 4, Iy(N.current), Ry(
        N,
        N.current,
        B,
        f
      ), mn = ee, Yf(0, !1), Qt && typeof Qt.onPostCommitFiberRoot == "function")
        try {
          Qt.onPostCommitFiberRoot(sn, N);
        } catch {
        }
      return !0;
    } finally {
      ue.p = _, J.T = y, Jp(a, l);
    }
  }
  function tg(a, l, f) {
    l = Yi(f, l), l = kp(a.stateNode, l, 2), a = es(a, l, 2), a !== null && (Si(a, 2), Rs(a));
  }
  function bn(a, l, f) {
    if (a.tag === 3)
      tg(a, a, f);
    else
      for (; l !== null; ) {
        if (l.tag === 3) {
          tg(
            l,
            a,
            f
          );
          break;
        } else if (l.tag === 1) {
          var y = l.stateNode;
          if (typeof l.type.getDerivedStateFromError == "function" || typeof y.componentDidCatch == "function" && (cl === null || !cl.has(y))) {
            a = Yi(f, a), f = As(2), y = es(l, f, 2), y !== null && (wh(
              f,
              y,
              l,
              a
            ), Si(y, 2), Rs(y));
            break;
          }
        }
        l = l.return;
      }
  }
  function ng(a, l, f) {
    var y = a.pingCache;
    if (y === null) {
      y = a.pingCache = new eb();
      var _ = /* @__PURE__ */ new Set();
      y.set(l, _);
    } else
      _ = y.get(l), _ === void 0 && (_ = /* @__PURE__ */ new Set(), y.set(l, _));
    _.has(f) || ($p = !0, _.add(f), a = ib.bind(null, a, l, f), l.then(a, a));
  }
  function ib(a, l, f) {
    var y = a.pingCache;
    y !== null && y.delete(l), a.pingedLanes |= a.suspendedLanes & f, a.warmLanes &= ~f, jn === a && (Wt & f) === f && (tr === 4 || tr === 3 && (Wt & 62914560) === Wt && 300 > En() - Uf ? (mn & 2) === 0 && xc(a, 0) : Vp |= f, yc === Wt && (yc = 0)), Rs(a);
  }
  function Kf(a, l) {
    l === 0 && (l = zl()), a = Nn(a, l), a !== null && (Si(a, l), Rs(a));
  }
  function Lh(a) {
    var l = a.memoizedState, f = 0;
    l !== null && (f = l.retryLane), Kf(a, f);
  }
  function ab(a, l) {
    var f = 0;
    switch (a.tag) {
      case 31:
      case 13:
        var y = a.stateNode, _ = a.memoizedState;
        _ !== null && (f = _.retryLane);
        break;
      case 19:
        y = a.stateNode;
        break;
      case 22:
        y = a.stateNode._retryCache;
        break;
      default:
        throw Error(r(314));
    }
    y !== null && y.delete(l), Kf(a, f);
  }
  function sb(a, l) {
    return Un(a, l);
  }
  var wc = null, fu = null, rg = !1, Bh = !1, ig = !1, dl = 0;
  function Rs(a) {
    a !== fu && a.next === null && (fu === null ? wc = fu = a : fu = fu.next = a), Bh = !0, rg || (rg = !0, lb());
  }
  function Yf(a, l) {
    if (!ig && Bh) {
      ig = !0;
      do
        for (var f = !1, y = wc; y !== null; ) {
          if (a !== 0) {
            var _ = y.pendingLanes;
            if (_ === 0) var N = 0;
            else {
              var B = y.suspendedLanes, ee = y.pingedLanes;
              N = (1 << 31 - it(42 | a) + 1) - 1, N &= _ & ~(B & ~ee), N = N & 201326741 ? N & 201326741 | 1 : N ? N | 2 : 0;
            }
            N !== 0 && (f = !0, Zy(y, N));
          } else
            N = Wt, N = Us(
              y,
              y === jn ? N : 0,
              y.cancelPendingCommit !== null || y.timeoutHandle !== -1
            ), (N & 3) === 0 || Ha(y, N) || (f = !0, Zy(y, N));
          y = y.next;
        }
      while (f);
      ig = !1;
    }
  }
  function ob() {
    Wy();
  }
  function Wy() {
    Bh = rg = !1;
    var a = 0;
    dl !== 0 && cb() && (a = dl);
    for (var l = En(), f = null, y = wc; y !== null; ) {
      var _ = y.next, N = Xy(y, l);
      N === 0 ? (y.next = null, f === null ? wc = _ : f.next = _, _ === null && (fu = f)) : (f = y, (a !== 0 || (N & 3) !== 0) && (Bh = !0)), y = _;
    }
    Nr !== 0 && Nr !== 5 || Yf(a), dl !== 0 && (dl = 0);
  }
  function Xy(a, l) {
    for (var f = a.suspendedLanes, y = a.pingedLanes, _ = a.expirationTimes, N = a.pendingLanes & -62914561; 0 < N; ) {
      var B = 31 - it(N), ee = 1 << B, ye = _[B];
      ye === -1 ? ((ee & f) === 0 || (ee & y) !== 0) && (_[B] = Gc(ee, l)) : ye <= l && (a.expiredLanes |= ee), N &= ~ee;
    }
    if (l = jn, f = Wt, f = Us(
      a,
      a === l ? f : 0,
      a.cancelPendingCommit !== null || a.timeoutHandle !== -1
    ), y = a.callbackNode, f === 0 || a === l && (xn === 2 || xn === 9) || a.cancelPendingCommit !== null)
      return y !== null && y !== null && Ht(y), a.callbackNode = null, a.callbackPriority = 0;
    if ((f & 3) === 0 || Ha(a, f)) {
      if (l = f & -f, l === a.callbackPriority) return l;
      switch (y !== null && Ht(y), ys(f)) {
        case 2:
        case 8:
          f = Qe;
          break;
        case 32:
          f = yt;
          break;
        case 268435456:
          f = Pt;
          break;
        default:
          f = yt;
      }
      return y = Qy.bind(null, a), f = Un(f, y), a.callbackPriority = l, a.callbackNode = f, l;
    }
    return y !== null && y !== null && Ht(y), a.callbackPriority = 2, a.callbackNode = null, 2;
  }
  function Qy(a, l) {
    if (Nr !== 0 && Nr !== 5)
      return a.callbackNode = null, a.callbackPriority = 0, null;
    var f = a.callbackNode;
    if (Gf() && a.callbackNode !== f)
      return null;
    var y = Wt;
    return y = Us(
      a,
      a === jn ? y : 0,
      a.cancelPendingCommit !== null || a.timeoutHandle !== -1
    ), y === 0 ? null : (qy(a, y, l), Xy(a, En()), a.callbackNode != null && a.callbackNode === f ? Qy.bind(null, a) : null);
  }
  function Zy(a, l) {
    if (Gf()) return null;
    qy(a, l, !0);
  }
  function lb() {
    o1(function() {
      (mn & 6) !== 0 ? Un(
        Fe,
        ob
      ) : Wy();
    });
  }
  function ia() {
    if (dl === 0) {
      var a = Zu;
      a === 0 && (a = ct, ct <<= 1, (ct & 261888) === 0 && (ct = 256)), dl = a;
    }
    return dl;
  }
  function Jy(a) {
    return a == null || typeof a == "symbol" || typeof a == "boolean" ? null : typeof a == "function" ? a : wa("" + a);
  }
  function e1(a, l) {
    var f = l.ownerDocument.createElement("input");
    return f.name = l.name, f.value = l.value, a.id && f.setAttribute("form", a.id), l.parentNode.insertBefore(f, l), a = new FormData(a), f.parentNode.removeChild(f), a;
  }
  function du(a, l, f, y, _) {
    if (l === "submit" && f && f.stateNode === _) {
      var N = Jy(
        (_[Qn] || null).action
      ), B = y.submitter;
      B && (l = (l = B[Qn] || null) ? Jy(l.formAction) : B.getAttribute("formAction"), l !== null && (N = l, B = null));
      var ee = new Pu(
        "action",
        "action",
        null,
        y,
        _
      );
      a.push({
        event: ee,
        listeners: [
          {
            instance: null,
            listener: function() {
              if (y.defaultPrevented) {
                if (dl !== 0) {
                  var ye = B ? e1(_, B) : new FormData(_);
                  il(
                    f,
                    {
                      pending: !0,
                      data: ye,
                      method: _.method,
                      action: N
                    },
                    null,
                    ye
                  );
                }
              } else
                typeof N == "function" && (ee.preventDefault(), ye = B ? e1(_, B) : new FormData(_), il(
                  f,
                  {
                    pending: !0,
                    data: ye,
                    method: _.method,
                    action: N
                  },
                  N,
                  ye
                ));
            },
            currentTarget: _
          }
        ]
      });
    }
  }
  for (var It = 0; It < ut.length; It++) {
    var ag = ut[It], Ii = ag.toLowerCase(), vr = ag[0].toUpperCase() + ag.slice(1);
    Je(
      Ii,
      "on" + vr
    );
  }
  Je(je, "onAnimationEnd"), Je(ze, "onAnimationIteration"), Je($e, "onAnimationStart"), Je("dblclick", "onDoubleClick"), Je("focusin", "onFocus"), Je("focusout", "onBlur"), Je(Ge, "onTransitionRun"), Je(nt, "onTransitionStart"), Je(lt, "onTransitionCancel"), Je(He, "onTransitionEnd"), $i("onMouseEnter", ["mouseout", "mouseover"]), $i("onMouseLeave", ["mouseout", "mouseover"]), $i("onPointerEnter", ["pointerout", "pointerover"]), $i("onPointerLeave", ["pointerout", "pointerover"]), Ci(
    "onChange",
    "change click focusin focusout input keydown keyup selectionchange".split(" ")
  ), Ci(
    "onSelect",
    "focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(
      " "
    )
  ), Ci("onBeforeInput", [
    "compositionend",
    "keypress",
    "textInput",
    "paste"
  ]), Ci(
    "onCompositionEnd",
    "compositionend focusout keydown keypress keyup mousedown".split(" ")
  ), Ci(
    "onCompositionStart",
    "compositionstart focusout keydown keypress keyup mousedown".split(" ")
  ), Ci(
    "onCompositionUpdate",
    "compositionupdate focusout keydown keypress keyup mousedown".split(" ")
  );
  var Wf = "abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(
    " "
  ), hl = new Set(
    "beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Wf)
  );
  function t1(a, l) {
    l = (l & 4) !== 0;
    for (var f = 0; f < a.length; f++) {
      var y = a[f], _ = y.event;
      y = y.listeners;
      e: {
        var N = void 0;
        if (l)
          for (var B = y.length - 1; 0 <= B; B--) {
            var ee = y[B], ye = ee.instance, Pe = ee.currentTarget;
            if (ee = ee.listener, ye !== N && _.isPropagationStopped())
              break e;
            N = ee, _.currentTarget = Pe;
            try {
              N(_);
            } catch (Ve) {
              pt(Ve);
            }
            _.currentTarget = null, N = ye;
          }
        else
          for (B = 0; B < y.length; B++) {
            if (ee = y[B], ye = ee.instance, Pe = ee.currentTarget, ee = ee.listener, ye !== N && _.isPropagationStopped())
              break e;
            N = ee, _.currentTarget = Pe;
            try {
              N(_);
            } catch (Ve) {
              pt(Ve);
            }
            _.currentTarget = null, N = ye;
          }
      }
    }
  }
  function Kt(a, l) {
    var f = l[pa];
    f === void 0 && (f = l[pa] = /* @__PURE__ */ new Set());
    var y = a + "__bubble";
    f.has(y) || (Fh(l, a, 2, !1), f.add(y));
  }
  function sg(a, l, f) {
    var y = 0;
    l && (y |= 4), Fh(
      f,
      a,
      y,
      l
    );
  }
  var qh = "_reactListening" + Math.random().toString(36).slice(2);
  function og(a) {
    if (!a[qh]) {
      a[qh] = !0, Ka.forEach(function(f) {
        f !== "selectionchange" && (hl.has(f) || sg(f, !1, a), sg(f, !0, a));
      });
      var l = a.nodeType === 9 ? a : a.ownerDocument;
      l === null || l[qh] || (l[qh] = !0, sg("selectionchange", !1, l));
    }
  }
  function Fh(a, l, f, y) {
    switch (T1(l)) {
      case 2:
        var _ = Cb;
        break;
      case 8:
        _ = Eb;
        break;
      default:
        _ = xg;
    }
    f = _.bind(
      null,
      l,
      f,
      a
    ), _ = void 0, !Yc || l !== "touchstart" && l !== "touchmove" && l !== "wheel" || (_ = !0), y ? _ !== void 0 ? a.addEventListener(l, f, {
      capture: !0,
      passive: _
    }) : a.addEventListener(l, f, !0) : _ !== void 0 ? a.addEventListener(l, f, {
      passive: _
    }) : a.addEventListener(l, f, !1);
  }
  function lg(a, l, f, y, _) {
    var N = y;
    if ((l & 1) === 0 && (l & 2) === 0 && y !== null)
      e: for (; ; ) {
        if (y === null) return;
        var B = y.tag;
        if (B === 3 || B === 4) {
          var ee = y.stateNode.containerInfo;
          if (ee === _) break;
          if (B === 4)
            for (B = y.return; B !== null; ) {
              var ye = B.tag;
              if ((ye === 3 || ye === 4) && B.stateNode.containerInfo === _)
                return;
              B = B.return;
            }
          for (; ee !== null; ) {
            if (B = ya(ee), B === null) return;
            if (ye = B.tag, ye === 5 || ye === 6 || ye === 26 || ye === 27) {
              y = N = B;
              continue e;
            }
            ee = ee.parentNode;
          }
        }
        y = y.return;
      }
    Lo(function() {
      var Pe = N, Ve = Du(f), Ye = [];
      e: {
        var Le = ot.get(a);
        if (Le !== void 0) {
          var qe = Pu, xt = a;
          switch (a) {
            case "keypress":
              if (Bo(f) === 0) break e;
            case "keydown":
            case "keyup":
              qe = Gi;
              break;
            case "focusin":
              xt = "focus", qe = Zs;
              break;
            case "focusout":
              xt = "blur", qe = Zs;
              break;
            case "beforeblur":
            case "afterblur":
              qe = Zs;
              break;
            case "click":
              if (f.button === 2) break e;
            case "auxclick":
            case "dblclick":
            case "mousedown":
            case "mousemove":
            case "mouseup":
            case "mouseout":
            case "mouseover":
            case "contextmenu":
              qe = qo;
              break;
            case "drag":
            case "dragend":
            case "dragenter":
            case "dragexit":
            case "dragleave":
            case "dragover":
            case "dragstart":
            case "drop":
              qe = Wc;
              break;
            case "touchcancel":
            case "touchend":
            case "touchmove":
            case "touchstart":
              qe = ef;
              break;
            case je:
            case ze:
            case $e:
              qe = Xc;
              break;
            case He:
              qe = tf;
              break;
            case "scroll":
            case "scrollend":
              qe = zu;
              break;
            case "wheel":
              qe = eo;
              break;
            case "copy":
            case "cut":
            case "paste":
              qe = wr;
              break;
            case "gotpointercapture":
            case "lostpointercapture":
            case "pointercancel":
            case "pointerdown":
            case "pointermove":
            case "pointerout":
            case "pointerover":
            case "pointerup":
              qe = Jc;
              break;
            case "toggle":
            case "beforetoggle":
              qe = Yd;
          }
          var kt = (l & 4) !== 0, Cn = !kt && (a === "scroll" || a === "scrollend"), Ae = kt ? Le !== null ? Le + "Capture" : null : Le;
          kt = [];
          for (var Ee = Pe, De; Ee !== null; ) {
            var Ke = Ee;
            if (De = Ke.stateNode, Ke = Ke.tag, Ke !== 5 && Ke !== 26 && Ke !== 27 || De === null || Ae === null || (Ke = Ya(Ee, Ae), Ke != null && kt.push(
              aa(Ee, Ke, De)
            )), Cn) break;
            Ee = Ee.return;
          }
          0 < kt.length && (Le = new qe(
            Le,
            xt,
            null,
            f,
            Ve
          ), Ye.push({ event: Le, listeners: kt }));
        }
      }
      if ((l & 7) === 0) {
        e: {
          if (Le = a === "mouseover" || a === "pointerover", qe = a === "mouseout" || a === "pointerout", Le && f !== _a && (xt = f.relatedTarget || f.fromElement) && (ya(xt) || xt[Mr]))
            break e;
          if ((qe || Le) && (Le = Ve.window === Ve ? Ve : (Le = Ve.ownerDocument) ? Le.defaultView || Le.parentWindow : window, qe ? (xt = f.relatedTarget || f.toElement, qe = Pe, xt = xt ? ya(xt) : null, xt !== null && (Cn = s(xt), kt = xt.tag, xt !== Cn || kt !== 5 && kt !== 27 && kt !== 6) && (xt = null)) : (qe = null, xt = Pe), qe !== xt)) {
            if (kt = qo, Ke = "onMouseLeave", Ae = "onMouseEnter", Ee = "mouse", (a === "pointerout" || a === "pointerover") && (kt = Jc, Ke = "onPointerLeave", Ae = "onPointerEnter", Ee = "pointer"), Cn = qe == null ? Le : ei(qe), De = xt == null ? Le : ei(xt), Le = new kt(
              Ke,
              Ee + "leave",
              qe,
              f,
              Ve
            ), Le.target = Cn, Le.relatedTarget = De, Ke = null, ya(Ve) === Pe && (kt = new kt(
              Ae,
              Ee + "enter",
              xt,
              f,
              Ve
            ), kt.target = De, kt.relatedTarget = Cn, Ke = kt), Cn = Ke, qe && xt)
              t: {
                for (kt = Uh, Ae = qe, Ee = xt, De = 0, Ke = Ae; Ke; Ke = kt(Ke))
                  De++;
                Ke = 0;
                for (var St = Ee; St; St = kt(St))
                  Ke++;
                for (; 0 < De - Ke; )
                  Ae = kt(Ae), De--;
                for (; 0 < Ke - De; )
                  Ee = kt(Ee), Ke--;
                for (; De--; ) {
                  if (Ae === Ee || Ee !== null && Ae === Ee.alternate) {
                    kt = Ae;
                    break t;
                  }
                  Ae = kt(Ae), Ee = kt(Ee);
                }
                kt = null;
              }
            else kt = null;
            qe !== null && Gn(
              Ye,
              Le,
              qe,
              kt,
              !1
            ), xt !== null && Cn !== null && Gn(
              Ye,
              Cn,
              xt,
              kt,
              !0
            );
          }
        }
        e: {
          if (Le = Pe ? ei(Pe) : window, qe = Le.nodeName && Le.nodeName.toLowerCase(), qe === "select" || qe === "input" && Le.type === "file")
            var fn = Ql;
          else if (Wl(Le))
            if (Fr)
              fn = Go;
            else {
              fn = to;
              var bt = Zl;
            }
          else
            qe = Le.nodeName, !qe || qe.toLowerCase() !== "input" || Le.type !== "checkbox" && Le.type !== "radio" ? Pe && Ou(Pe.elementType) && (fn = Ql) : fn = sf;
          if (fn && (fn = fn(a, Pe))) {
            $u(
              Ye,
              fn,
              f,
              Ve
            );
            break e;
          }
          bt && bt(a, Le, Pe), a === "focusout" && Pe && Le.type === "number" && Pe.memoizedProps.value != null && Ys(Le, "number", Le.value);
        }
        switch (bt = Pe ? ei(Pe) : window, a) {
          case "focusin":
            (Wl(bt) || bt.contentEditable === "true") && (U = bt, ie = Pe, re = null);
            break;
          case "focusout":
            re = ie = U = null;
            break;
          case "mousedown":
            pe = !0;
            break;
          case "contextmenu":
          case "mouseup":
          case "dragend":
            pe = !1, he(Ye, f, Ve);
            break;
          case "selectionchange":
            if (oe) break;
          case "keydown":
          case "keyup":
            he(Ye, f, Ve);
        }
        var Ut;
        if (Uo)
          e: {
            switch (a) {
              case "compositionstart":
                var Xt = "onCompositionStart";
                break e;
              case "compositionend":
                Xt = "onCompositionEnd";
                break e;
              case "compositionupdate":
                Xt = "onCompositionUpdate";
                break e;
            }
            Xt = void 0;
          }
        else
          Cs ? Yl(a, f) && (Xt = "onCompositionEnd") : a === "keydown" && f.keyCode === 229 && (Xt = "onCompositionStart");
        Xt && (Kl && f.locale !== "ko" && (Cs || Xt !== "onCompositionStart" ? Xt === "onCompositionEnd" && Cs && (Ut = ln()) : (Sa = Ve, Iu = "value" in Sa ? Sa.value : Sa.textContent, Cs = !0)), bt = Xf(Pe, Xt), 0 < bt.length && (Xt = new qr(
          Xt,
          a,
          null,
          f,
          Ve
        ), Ye.push({ event: Xt, listeners: bt }), Ut ? Xt.data = Ut : (Ut = Xd(f), Ut !== null && (Xt.data = Ut)))), (Ut = nf ? ii(a, f) : rf(a, f)) && (Xt = Xf(Pe, "onBeforeInput"), 0 < Xt.length && (bt = new qr(
          "onBeforeInput",
          "beforeinput",
          null,
          f,
          Ve
        ), Ye.push({
          event: bt,
          listeners: Xt
        }), bt.data = Ut)), du(
          Ye,
          a,
          Pe,
          f,
          Ve
        );
      }
      t1(Ye, l);
    });
  }
  function aa(a, l, f) {
    return {
      instance: a,
      listener: l,
      currentTarget: f
    };
  }
  function Xf(a, l) {
    for (var f = l + "Capture", y = []; a !== null; ) {
      var _ = a, N = _.stateNode;
      if (_ = _.tag, _ !== 5 && _ !== 26 && _ !== 27 || N === null || (_ = Ya(a, f), _ != null && y.unshift(
        aa(a, _, N)
      ), _ = Ya(a, l), _ != null && y.push(
        aa(a, _, N)
      )), a.tag === 3) return y;
      a = a.return;
    }
    return [];
  }
  function Uh(a) {
    if (a === null) return null;
    do
      a = a.return;
    while (a && a.tag !== 5 && a.tag !== 27);
    return a || null;
  }
  function Gn(a, l, f, y, _) {
    for (var N = l._reactName, B = []; f !== null && f !== y; ) {
      var ee = f, ye = ee.alternate, Pe = ee.stateNode;
      if (ee = ee.tag, ye !== null && ye === y) break;
      ee !== 5 && ee !== 26 && ee !== 27 || Pe === null || (ye = Pe, _ ? (Pe = Ya(f, N), Pe != null && B.unshift(
        aa(f, Pe, ye)
      )) : _ || (Pe = Ya(f, N), Pe != null && B.push(
        aa(f, Pe, ye)
      ))), f = f.return;
    }
    B.length !== 0 && a.push({ event: l, listeners: B });
  }
  var sr = /\r\n?/g, n1 = /\u0000|\uFFFD/g;
  function r1(a) {
    return (typeof a == "string" ? a : "" + a).replace(sr, `
`).replace(n1, "");
  }
  function i1(a, l) {
    return l = r1(l), r1(a) === l;
  }
  function Sn(a, l, f, y, _, N) {
    switch (f) {
      case "children":
        typeof y == "string" ? l === "body" || l === "textarea" && y === "" || Ei(a, y) : (typeof y == "number" || typeof y == "bigint") && l !== "body" && Ei(a, "" + y);
        break;
      case "className":
        vs(a, "class", y);
        break;
      case "tabIndex":
        vs(a, "tabindex", y);
        break;
      case "dir":
      case "role":
      case "viewBox":
      case "width":
      case "height":
        vs(a, f, y);
        break;
      case "style":
        Kc(a, y, N);
        break;
      case "data":
        if (l !== "object") {
          vs(a, "data", y);
          break;
        }
      case "src":
      case "href":
        if (y === "" && (l !== "a" || f !== "href")) {
          a.removeAttribute(f);
          break;
        }
        if (y == null || typeof y == "function" || typeof y == "symbol" || typeof y == "boolean") {
          a.removeAttribute(f);
          break;
        }
        y = wa("" + y), a.setAttribute(f, y);
        break;
      case "action":
      case "formAction":
        if (typeof y == "function") {
          a.setAttribute(
            f,
            "javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')"
          );
          break;
        } else
          typeof N == "function" && (f === "formAction" ? (l !== "input" && Sn(a, l, "name", _.name, _, null), Sn(
            a,
            l,
            "formEncType",
            _.formEncType,
            _,
            null
          ), Sn(
            a,
            l,
            "formMethod",
            _.formMethod,
            _,
            null
          ), Sn(
            a,
            l,
            "formTarget",
            _.formTarget,
            _,
            null
          )) : (Sn(a, l, "encType", _.encType, _, null), Sn(a, l, "method", _.method, _, null), Sn(a, l, "target", _.target, _, null)));
        if (y == null || typeof y == "symbol" || typeof y == "boolean") {
          a.removeAttribute(f);
          break;
        }
        y = wa("" + y), a.setAttribute(f, y);
        break;
      case "onClick":
        y != null && (a.onclick = ki);
        break;
      case "onScroll":
        y != null && Kt("scroll", a);
        break;
      case "onScrollEnd":
        y != null && Kt("scrollend", a);
        break;
      case "dangerouslySetInnerHTML":
        if (y != null) {
          if (typeof y != "object" || !("__html" in y))
            throw Error(r(61));
          if (f = y.__html, f != null) {
            if (_.children != null) throw Error(r(60));
            a.innerHTML = f;
          }
        }
        break;
      case "multiple":
        a.multiple = y && typeof y != "function" && typeof y != "symbol";
        break;
      case "muted":
        a.muted = y && typeof y != "function" && typeof y != "symbol";
        break;
      case "suppressContentEditableWarning":
      case "suppressHydrationWarning":
      case "defaultValue":
      case "defaultChecked":
      case "innerHTML":
      case "ref":
        break;
      case "autoFocus":
        break;
      case "xlinkHref":
        if (y == null || typeof y == "function" || typeof y == "boolean" || typeof y == "symbol") {
          a.removeAttribute("xlink:href");
          break;
        }
        f = wa("" + y), a.setAttributeNS(
          "http://www.w3.org/1999/xlink",
          "xlink:href",
          f
        );
        break;
      case "contentEditable":
      case "spellCheck":
      case "draggable":
      case "value":
      case "autoReverse":
      case "externalResourcesRequired":
      case "focusable":
      case "preserveAlpha":
        y != null && typeof y != "function" && typeof y != "symbol" ? a.setAttribute(f, "" + y) : a.removeAttribute(f);
        break;
      case "inert":
      case "allowFullScreen":
      case "async":
      case "autoPlay":
      case "controls":
      case "default":
      case "defer":
      case "disabled":
      case "disablePictureInPicture":
      case "disableRemotePlayback":
      case "formNoValidate":
      case "hidden":
      case "loop":
      case "noModule":
      case "noValidate":
      case "open":
      case "playsInline":
      case "readOnly":
      case "required":
      case "reversed":
      case "scoped":
      case "seamless":
      case "itemScope":
        y && typeof y != "function" && typeof y != "symbol" ? a.setAttribute(f, "") : a.removeAttribute(f);
        break;
      case "capture":
      case "download":
        y === !0 ? a.setAttribute(f, "") : y !== !1 && y != null && typeof y != "function" && typeof y != "symbol" ? a.setAttribute(f, y) : a.removeAttribute(f);
        break;
      case "cols":
      case "rows":
      case "size":
      case "span":
        y != null && typeof y != "function" && typeof y != "symbol" && !isNaN(y) && 1 <= y ? a.setAttribute(f, y) : a.removeAttribute(f);
        break;
      case "rowSpan":
      case "start":
        y == null || typeof y == "function" || typeof y == "symbol" || isNaN(y) ? a.removeAttribute(f) : a.setAttribute(f, y);
        break;
      case "popover":
        Kt("beforetoggle", a), Kt("toggle", a), zt(a, "popover", y);
        break;
      case "xlinkActuate":
        ui(
          a,
          "http://www.w3.org/1999/xlink",
          "xlink:actuate",
          y
        );
        break;
      case "xlinkArcrole":
        ui(
          a,
          "http://www.w3.org/1999/xlink",
          "xlink:arcrole",
          y
        );
        break;
      case "xlinkRole":
        ui(
          a,
          "http://www.w3.org/1999/xlink",
          "xlink:role",
          y
        );
        break;
      case "xlinkShow":
        ui(
          a,
          "http://www.w3.org/1999/xlink",
          "xlink:show",
          y
        );
        break;
      case "xlinkTitle":
        ui(
          a,
          "http://www.w3.org/1999/xlink",
          "xlink:title",
          y
        );
        break;
      case "xlinkType":
        ui(
          a,
          "http://www.w3.org/1999/xlink",
          "xlink:type",
          y
        );
        break;
      case "xmlBase":
        ui(
          a,
          "http://www.w3.org/XML/1998/namespace",
          "xml:base",
          y
        );
        break;
      case "xmlLang":
        ui(
          a,
          "http://www.w3.org/XML/1998/namespace",
          "xml:lang",
          y
        );
        break;
      case "xmlSpace":
        ui(
          a,
          "http://www.w3.org/XML/1998/namespace",
          "xml:space",
          y
        );
        break;
      case "is":
        zt(a, "is", y);
        break;
      case "innerText":
      case "textContent":
        break;
      default:
        (!(2 < f.length) || f[0] !== "o" && f[0] !== "O" || f[1] !== "n" && f[1] !== "N") && (f = Hd.get(f) || f, zt(a, f, y));
    }
  }
  function ug(a, l, f, y, _, N) {
    switch (f) {
      case "style":
        Kc(a, y, N);
        break;
      case "dangerouslySetInnerHTML":
        if (y != null) {
          if (typeof y != "object" || !("__html" in y))
            throw Error(r(61));
          if (f = y.__html, f != null) {
            if (_.children != null) throw Error(r(60));
            a.innerHTML = f;
          }
        }
        break;
      case "children":
        typeof y == "string" ? Ei(a, y) : (typeof y == "number" || typeof y == "bigint") && Ei(a, "" + y);
        break;
      case "onScroll":
        y != null && Kt("scroll", a);
        break;
      case "onScrollEnd":
        y != null && Kt("scrollend", a);
        break;
      case "onClick":
        y != null && (a.onclick = ki);
        break;
      case "suppressContentEditableWarning":
      case "suppressHydrationWarning":
      case "innerHTML":
      case "ref":
        break;
      case "innerText":
      case "textContent":
        break;
      default:
        if (!Hs.hasOwnProperty(f))
          e: {
            if (f[0] === "o" && f[1] === "n" && (_ = f.endsWith("Capture"), l = f.slice(2, _ ? f.length - 7 : void 0), N = a[Qn] || null, N = N != null ? N[f] : null, typeof N == "function" && a.removeEventListener(l, N, _), typeof y == "function")) {
              typeof N != "function" && N !== null && (f in a ? a[f] = null : a.hasAttribute(f) && a.removeAttribute(f)), a.addEventListener(l, y, _);
              break e;
            }
            f in a ? a[f] = y : y === !0 ? a.setAttribute(f, "") : zt(a, f, y);
          }
    }
  }
  function Yr(a, l, f) {
    switch (l) {
      case "div":
      case "span":
      case "svg":
      case "path":
      case "a":
      case "g":
      case "p":
      case "li":
        break;
      case "img":
        Kt("error", a), Kt("load", a);
        var y = !1, _ = !1, N;
        for (N in f)
          if (f.hasOwnProperty(N)) {
            var B = f[N];
            if (B != null)
              switch (N) {
                case "src":
                  y = !0;
                  break;
                case "srcSet":
                  _ = !0;
                  break;
                case "children":
                case "dangerouslySetInnerHTML":
                  throw Error(r(137, l));
                default:
                  Sn(a, l, N, B, f, null);
              }
          }
        _ && Sn(a, l, "srcSet", f.srcSet, f, null), y && Sn(a, l, "src", f.src, f, null);
        return;
      case "input":
        Kt("invalid", a);
        var ee = N = B = _ = null, ye = null, Pe = null;
        for (y in f)
          if (f.hasOwnProperty(y)) {
            var Ve = f[y];
            if (Ve != null)
              switch (y) {
                case "name":
                  _ = Ve;
                  break;
                case "type":
                  B = Ve;
                  break;
                case "checked":
                  ye = Ve;
                  break;
                case "defaultChecked":
                  Pe = Ve;
                  break;
                case "value":
                  N = Ve;
                  break;
                case "defaultValue":
                  ee = Ve;
                  break;
                case "children":
                case "dangerouslySetInnerHTML":
                  if (Ve != null)
                    throw Error(r(137, l));
                  break;
                default:
                  Sn(a, l, y, Ve, f, null);
              }
          }
        bs(
          a,
          N,
          ee,
          ye,
          Pe,
          B,
          _,
          !1
        );
        return;
      case "select":
        Kt("invalid", a), y = B = N = null;
        for (_ in f)
          if (f.hasOwnProperty(_) && (ee = f[_], ee != null))
            switch (_) {
              case "value":
                N = ee;
                break;
              case "defaultValue":
                B = ee;
                break;
              case "multiple":
                y = ee;
              default:
                Sn(a, l, _, ee, f, null);
            }
        l = N, f = B, a.multiple = !!y, l != null ? fi(a, !!y, l, !1) : f != null && fi(a, !!y, f, !0);
        return;
      case "textarea":
        Kt("invalid", a), N = _ = y = null;
        for (B in f)
          if (f.hasOwnProperty(B) && (ee = f[B], ee != null))
            switch (B) {
              case "value":
                y = ee;
                break;
              case "defaultValue":
                _ = ee;
                break;
              case "children":
                N = ee;
                break;
              case "dangerouslySetInnerHTML":
                if (ee != null) throw Error(r(91));
                break;
              default:
                Sn(a, l, B, ee, f, null);
            }
        Ws(a, y, _, N);
        return;
      case "option":
        for (ye in f)
          if (f.hasOwnProperty(ye) && (y = f[ye], y != null))
            switch (ye) {
              case "selected":
                a.selected = y && typeof y != "function" && typeof y != "symbol";
                break;
              default:
                Sn(a, l, ye, y, f, null);
            }
        return;
      case "dialog":
        Kt("beforetoggle", a), Kt("toggle", a), Kt("cancel", a), Kt("close", a);
        break;
      case "iframe":
      case "object":
        Kt("load", a);
        break;
      case "video":
      case "audio":
        for (y = 0; y < Wf.length; y++)
          Kt(Wf[y], a);
        break;
      case "image":
        Kt("error", a), Kt("load", a);
        break;
      case "details":
        Kt("toggle", a);
        break;
      case "embed":
      case "source":
      case "link":
        Kt("error", a), Kt("load", a);
      case "area":
      case "base":
      case "br":
      case "col":
      case "hr":
      case "keygen":
      case "meta":
      case "param":
      case "track":
      case "wbr":
      case "menuitem":
        for (Pe in f)
          if (f.hasOwnProperty(Pe) && (y = f[Pe], y != null))
            switch (Pe) {
              case "children":
              case "dangerouslySetInnerHTML":
                throw Error(r(137, l));
              default:
                Sn(a, l, Pe, y, f, null);
            }
        return;
      default:
        if (Ou(l)) {
          for (Ve in f)
            f.hasOwnProperty(Ve) && (y = f[Ve], y !== void 0 && ug(
              a,
              l,
              Ve,
              y,
              f,
              void 0
            ));
          return;
        }
    }
    for (ee in f)
      f.hasOwnProperty(ee) && (y = f[ee], y != null && Sn(a, l, ee, y, f, null));
  }
  function ub(a, l, f, y) {
    switch (l) {
      case "div":
      case "span":
      case "svg":
      case "path":
      case "a":
      case "g":
      case "p":
      case "li":
        break;
      case "input":
        var _ = null, N = null, B = null, ee = null, ye = null, Pe = null, Ve = null;
        for (qe in f) {
          var Ye = f[qe];
          if (f.hasOwnProperty(qe) && Ye != null)
            switch (qe) {
              case "checked":
                break;
              case "value":
                break;
              case "defaultValue":
                ye = Ye;
              default:
                y.hasOwnProperty(qe) || Sn(a, l, qe, null, y, Ye);
            }
        }
        for (var Le in y) {
          var qe = y[Le];
          if (Ye = f[Le], y.hasOwnProperty(Le) && (qe != null || Ye != null))
            switch (Le) {
              case "type":
                N = qe;
                break;
              case "name":
                _ = qe;
                break;
              case "checked":
                Pe = qe;
                break;
              case "defaultChecked":
                Ve = qe;
                break;
              case "value":
                B = qe;
                break;
              case "defaultValue":
                ee = qe;
                break;
              case "children":
              case "dangerouslySetInnerHTML":
                if (qe != null)
                  throw Error(r(137, l));
                break;
              default:
                qe !== Ye && Sn(
                  a,
                  l,
                  Le,
                  qe,
                  y,
                  Ye
                );
            }
        }
        ci(
          a,
          B,
          ee,
          ye,
          Pe,
          Ve,
          N,
          _
        );
        return;
      case "select":
        qe = B = ee = Le = null;
        for (N in f)
          if (ye = f[N], f.hasOwnProperty(N) && ye != null)
            switch (N) {
              case "value":
                break;
              case "multiple":
                qe = ye;
              default:
                y.hasOwnProperty(N) || Sn(
                  a,
                  l,
                  N,
                  null,
                  y,
                  ye
                );
            }
        for (_ in y)
          if (N = y[_], ye = f[_], y.hasOwnProperty(_) && (N != null || ye != null))
            switch (_) {
              case "value":
                Le = N;
                break;
              case "defaultValue":
                ee = N;
                break;
              case "multiple":
                B = N;
              default:
                N !== ye && Sn(
                  a,
                  l,
                  _,
                  N,
                  y,
                  ye
                );
            }
        l = ee, f = B, y = qe, Le != null ? fi(a, !!f, Le, !1) : !!y != !!f && (l != null ? fi(a, !!f, l, !0) : fi(a, !!f, f ? [] : "", !1));
        return;
      case "textarea":
        qe = Le = null;
        for (ee in f)
          if (_ = f[ee], f.hasOwnProperty(ee) && _ != null && !y.hasOwnProperty(ee))
            switch (ee) {
              case "value":
                break;
              case "children":
                break;
              default:
                Sn(a, l, ee, null, y, _);
            }
        for (B in y)
          if (_ = y[B], N = f[B], y.hasOwnProperty(B) && (_ != null || N != null))
            switch (B) {
              case "value":
                Le = _;
                break;
              case "defaultValue":
                qe = _;
                break;
              case "children":
                break;
              case "dangerouslySetInnerHTML":
                if (_ != null) throw Error(r(91));
                break;
              default:
                _ !== N && Sn(a, l, B, _, y, N);
            }
        Fl(a, Le, qe);
        return;
      case "option":
        for (var xt in f)
          if (Le = f[xt], f.hasOwnProperty(xt) && Le != null && !y.hasOwnProperty(xt))
            switch (xt) {
              case "selected":
                a.selected = !1;
                break;
              default:
                Sn(
                  a,
                  l,
                  xt,
                  null,
                  y,
                  Le
                );
            }
        for (ye in y)
          if (Le = y[ye], qe = f[ye], y.hasOwnProperty(ye) && Le !== qe && (Le != null || qe != null))
            switch (ye) {
              case "selected":
                a.selected = Le && typeof Le != "function" && typeof Le != "symbol";
                break;
              default:
                Sn(
                  a,
                  l,
                  ye,
                  Le,
                  y,
                  qe
                );
            }
        return;
      case "img":
      case "link":
      case "area":
      case "base":
      case "br":
      case "col":
      case "embed":
      case "hr":
      case "keygen":
      case "meta":
      case "param":
      case "source":
      case "track":
      case "wbr":
      case "menuitem":
        for (var kt in f)
          Le = f[kt], f.hasOwnProperty(kt) && Le != null && !y.hasOwnProperty(kt) && Sn(a, l, kt, null, y, Le);
        for (Pe in y)
          if (Le = y[Pe], qe = f[Pe], y.hasOwnProperty(Pe) && Le !== qe && (Le != null || qe != null))
            switch (Pe) {
              case "children":
              case "dangerouslySetInnerHTML":
                if (Le != null)
                  throw Error(r(137, l));
                break;
              default:
                Sn(
                  a,
                  l,
                  Pe,
                  Le,
                  y,
                  qe
                );
            }
        return;
      default:
        if (Ou(l)) {
          for (var Cn in f)
            Le = f[Cn], f.hasOwnProperty(Cn) && Le !== void 0 && !y.hasOwnProperty(Cn) && ug(
              a,
              l,
              Cn,
              void 0,
              y,
              Le
            );
          for (Ve in y)
            Le = y[Ve], qe = f[Ve], !y.hasOwnProperty(Ve) || Le === qe || Le === void 0 && qe === void 0 || ug(
              a,
              l,
              Ve,
              Le,
              y,
              qe
            );
          return;
        }
    }
    for (var Ae in f)
      Le = f[Ae], f.hasOwnProperty(Ae) && Le != null && !y.hasOwnProperty(Ae) && Sn(a, l, Ae, null, y, Le);
    for (Ye in y)
      Le = y[Ye], qe = f[Ye], !y.hasOwnProperty(Ye) || Le === qe || Le == null && qe == null || Sn(a, l, Ye, Le, y, qe);
  }
  function cg(a) {
    switch (a) {
      case "css":
      case "script":
      case "font":
      case "img":
      case "image":
      case "input":
      case "link":
        return !0;
      default:
        return !1;
    }
  }
  function Qf() {
    if (typeof performance.getEntriesByType == "function") {
      for (var a = 0, l = 0, f = performance.getEntriesByType("resource"), y = 0; y < f.length; y++) {
        var _ = f[y], N = _.transferSize, B = _.initiatorType, ee = _.duration;
        if (N && ee && cg(B)) {
          for (B = 0, ee = _.responseEnd, y += 1; y < f.length; y++) {
            var ye = f[y], Pe = ye.startTime;
            if (Pe > ee) break;
            var Ve = ye.transferSize, Ye = ye.initiatorType;
            Ve && cg(Ye) && (ye = ye.responseEnd, B += Ve * (ye < ee ? 1 : (ee - Pe) / (ye - Pe)));
          }
          if (--y, l += 8 * (N + B) / (_.duration / 1e3), a++, 10 < a) break;
        }
      }
      if (0 < a) return l / a / 1e6;
    }
    return navigator.connection && (a = navigator.connection.downlink, typeof a == "number") ? a : 5;
  }
  var Zf = null, fg = null;
  function Jf(a) {
    return a.nodeType === 9 ? a : a.ownerDocument;
  }
  function ed(a) {
    switch (a) {
      case "http://www.w3.org/2000/svg":
        return 1;
      case "http://www.w3.org/1998/Math/MathML":
        return 2;
      default:
        return 0;
    }
  }
  function Pi(a, l) {
    if (a === 0)
      switch (l) {
        case "svg":
          return 1;
        case "math":
          return 2;
        default:
          return 0;
      }
    return a === 1 && l === "foreignObject" ? 0 : a;
  }
  function ml(a, l) {
    return a === "textarea" || a === "noscript" || typeof l.children == "string" || typeof l.children == "number" || typeof l.children == "bigint" || typeof l.dangerouslySetInnerHTML == "object" && l.dangerouslySetInnerHTML !== null && l.dangerouslySetInnerHTML.__html != null;
  }
  var dg = null;
  function cb() {
    var a = window.event;
    return a && a.type === "popstate" ? a === dg ? !1 : (dg = a, !0) : (dg = null, !1);
  }
  var a1 = typeof setTimeout == "function" ? setTimeout : void 0, fb = typeof clearTimeout == "function" ? clearTimeout : void 0, s1 = typeof Promise == "function" ? Promise : void 0, o1 = typeof queueMicrotask == "function" ? queueMicrotask : typeof s1 < "u" ? function(a) {
    return s1.resolve(null).then(a).catch(yo);
  } : a1;
  function yo(a) {
    setTimeout(function() {
      throw a;
    });
  }
  function At(a) {
    return a === "head";
  }
  function hg(a, l) {
    var f = l, y = 0;
    do {
      var _ = f.nextSibling;
      if (a.removeChild(f), _ && _.nodeType === 8)
        if (f = _.data, f === "/$" || f === "/&") {
          if (y === 0) {
            a.removeChild(_), jc(l);
            return;
          }
          y--;
        } else if (f === "$" || f === "$?" || f === "$~" || f === "$!" || f === "&")
          y++;
        else if (f === "html")
          td(a.ownerDocument.documentElement);
        else if (f === "head") {
          f = a.ownerDocument.head, td(f);
          for (var N = f.firstChild; N; ) {
            var B = N.nextSibling, ee = N.nodeName;
            N[li] || ee === "SCRIPT" || ee === "STYLE" || ee === "LINK" && N.rel.toLowerCase() === "stylesheet" || f.removeChild(N), N = B;
          }
        } else
          f === "body" && td(a.ownerDocument.body);
      f = _;
    } while (f);
    jc(l);
  }
  function sa(a, l) {
    var f = a;
    a = 0;
    do {
      var y = f.nextSibling;
      if (f.nodeType === 1 ? l ? (f._stashedDisplay = f.style.display, f.style.display = "none") : (f.style.display = f._stashedDisplay || "", f.getAttribute("style") === "" && f.removeAttribute("style")) : f.nodeType === 3 && (l ? (f._stashedText = f.nodeValue, f.nodeValue = "") : f.nodeValue = f._stashedText || ""), y && y.nodeType === 8)
        if (f = y.data, f === "/$") {
          if (a === 0) break;
          a--;
        } else
          f !== "$" && f !== "$?" && f !== "$~" && f !== "$!" || a++;
      f = y;
    } while (f);
  }
  function $h(a) {
    var l = a.firstChild;
    for (l && l.nodeType === 10 && (l = l.nextSibling); l; ) {
      var f = l;
      switch (l = l.nextSibling, f.nodeName) {
        case "HTML":
        case "HEAD":
        case "BODY":
          $h(f), Po(f);
          continue;
        case "SCRIPT":
        case "STYLE":
          continue;
        case "LINK":
          if (f.rel.toLowerCase() === "stylesheet") continue;
      }
      a.removeChild(f);
    }
  }
  function db(a, l, f, y) {
    for (; a.nodeType === 1; ) {
      var _ = f;
      if (a.nodeName.toLowerCase() !== l.toLowerCase()) {
        if (!y && (a.nodeName !== "INPUT" || a.type !== "hidden"))
          break;
      } else if (y) {
        if (!a[li])
          switch (l) {
            case "meta":
              if (!a.hasAttribute("itemprop")) break;
              return a;
            case "link":
              if (N = a.getAttribute("rel"), N === "stylesheet" && a.hasAttribute("data-precedence"))
                break;
              if (N !== _.rel || a.getAttribute("href") !== (_.href == null || _.href === "" ? null : _.href) || a.getAttribute("crossorigin") !== (_.crossOrigin == null ? null : _.crossOrigin) || a.getAttribute("title") !== (_.title == null ? null : _.title))
                break;
              return a;
            case "style":
              if (a.hasAttribute("data-precedence")) break;
              return a;
            case "script":
              if (N = a.getAttribute("src"), (N !== (_.src == null ? null : _.src) || a.getAttribute("type") !== (_.type == null ? null : _.type) || a.getAttribute("crossorigin") !== (_.crossOrigin == null ? null : _.crossOrigin)) && N && a.hasAttribute("async") && !a.hasAttribute("itemprop"))
                break;
              return a;
            default:
              return a;
          }
      } else if (l === "input" && a.type === "hidden") {
        var N = _.name == null ? null : "" + _.name;
        if (_.type === "hidden" && a.getAttribute("name") === N)
          return a;
      } else return a;
      if (a = Pa(a.nextSibling), a === null) break;
    }
    return null;
  }
  function yn(a, l, f) {
    if (l === "") return null;
    for (; a.nodeType !== 3; )
      if ((a.nodeType !== 1 || a.nodeName !== "INPUT" || a.type !== "hidden") && !f || (a = Pa(a.nextSibling), a === null)) return null;
    return a;
  }
  function l1(a, l) {
    for (; a.nodeType !== 8; )
      if ((a.nodeType !== 1 || a.nodeName !== "INPUT" || a.type !== "hidden") && !l || (a = Pa(a.nextSibling), a === null)) return null;
    return a;
  }
  function Vh(a) {
    return a.data === "$?" || a.data === "$~";
  }
  function _c(a) {
    return a.data === "$!" || a.data === "$?" && a.ownerDocument.readyState !== "loading";
  }
  function hb(a, l) {
    var f = a.ownerDocument;
    if (a.data === "$~") a._reactRetry = l;
    else if (a.data !== "$?" || f.readyState !== "loading")
      l();
    else {
      var y = function() {
        l(), f.removeEventListener("DOMContentLoaded", y);
      };
      f.addEventListener("DOMContentLoaded", y), a._reactRetry = y;
    }
  }
  function Pa(a) {
    for (; a != null; a = a.nextSibling) {
      var l = a.nodeType;
      if (l === 1 || l === 3) break;
      if (l === 8) {
        if (l = a.data, l === "$" || l === "$!" || l === "$?" || l === "$~" || l === "&" || l === "F!" || l === "F")
          break;
        if (l === "/$" || l === "/&") return null;
      }
    }
    return a;
  }
  var mg = null;
  function u1(a) {
    a = a.nextSibling;
    for (var l = 0; a; ) {
      if (a.nodeType === 8) {
        var f = a.data;
        if (f === "/$" || f === "/&") {
          if (l === 0)
            return Pa(a.nextSibling);
          l--;
        } else
          f !== "$" && f !== "$!" && f !== "$?" && f !== "$~" && f !== "&" || l++;
      }
      a = a.nextSibling;
    }
    return null;
  }
  function c1(a) {
    a = a.previousSibling;
    for (var l = 0; a; ) {
      if (a.nodeType === 8) {
        var f = a.data;
        if (f === "$" || f === "$!" || f === "$?" || f === "$~" || f === "&") {
          if (l === 0) return a;
          l--;
        } else f !== "/$" && f !== "/&" || l++;
      }
      a = a.previousSibling;
    }
    return null;
  }
  function f1(a, l, f) {
    switch (l = Jf(f), a) {
      case "html":
        if (a = l.documentElement, !a) throw Error(r(452));
        return a;
      case "head":
        if (a = l.head, !a) throw Error(r(453));
        return a;
      case "body":
        if (a = l.body, !a) throw Error(r(454));
        return a;
      default:
        throw Error(r(451));
    }
  }
  function td(a) {
    for (var l = a.attributes; l.length; )
      a.removeAttributeNode(l[0]);
    Po(a);
  }
  var za = /* @__PURE__ */ new Map(), d1 = /* @__PURE__ */ new Set();
  function Hh(a) {
    return typeof a.getRootNode == "function" ? a.getRootNode() : a.nodeType === 9 ? a : a.ownerDocument;
  }
  var vo = ue.d;
  ue.d = {
    f: mb,
    r: pb,
    D: pg,
    C: gb,
    L: yb,
    m: vb,
    X: zi,
    S: Dr,
    M: xb
  };
  function mb() {
    var a = vo.f(), l = Dh();
    return a || l;
  }
  function pb(a) {
    var l = on(a);
    l !== null && l.tag === 5 && l.type === "form" ? xp(l) : vo.r(a);
  }
  var pl = typeof document > "u" ? null : document;
  function h1(a, l, f) {
    var y = pl;
    if (y && typeof l == "string" && l) {
      var _ = hr(l);
      _ = 'link[rel="' + a + '"][href="' + _ + '"]', typeof f == "string" && (_ += '[crossorigin="' + f + '"]'), d1.has(_) || (d1.add(_), a = { rel: a, crossOrigin: f, href: l }, y.querySelector(_) === null && (l = y.createElement("link"), Yr(l, "link", a), Zn(l), y.head.appendChild(l)));
    }
  }
  function pg(a) {
    vo.D(a), h1("dns-prefetch", a, null);
  }
  function gb(a, l) {
    vo.C(a, l), h1("preconnect", a, l);
  }
  function yb(a, l, f) {
    vo.L(a, l, f);
    var y = pl;
    if (y && a && l) {
      var _ = 'link[rel="preload"][as="' + hr(l) + '"]';
      l === "image" && f && f.imageSrcSet ? (_ += '[imagesrcset="' + hr(
        f.imageSrcSet
      ) + '"]', typeof f.imageSizes == "string" && (_ += '[imagesizes="' + hr(
        f.imageSizes
      ) + '"]')) : _ += '[href="' + hr(a) + '"]';
      var N = _;
      switch (l) {
        case "style":
          N = Sc(a);
          break;
        case "script":
          N = Ec(a);
      }
      za.has(N) || (a = p(
        {
          rel: "preload",
          href: l === "image" && f && f.imageSrcSet ? void 0 : a,
          as: l
        },
        f
      ), za.set(N, a), y.querySelector(_) !== null || l === "style" && y.querySelector(Cc(N)) || l === "script" && y.querySelector(kc(N)) || (l = y.createElement("link"), Yr(l, "link", a), Zn(l), y.head.appendChild(l)));
    }
  }
  function vb(a, l) {
    vo.m(a, l);
    var f = pl;
    if (f && a) {
      var y = l && typeof l.as == "string" ? l.as : "script", _ = 'link[rel="modulepreload"][as="' + hr(y) + '"][href="' + hr(a) + '"]', N = _;
      switch (y) {
        case "audioworklet":
        case "paintworklet":
        case "serviceworker":
        case "sharedworker":
        case "worker":
        case "script":
          N = Ec(a);
      }
      if (!za.has(N) && (a = p({ rel: "modulepreload", href: a }, l), za.set(N, a), f.querySelector(_) === null)) {
        switch (y) {
          case "audioworklet":
          case "paintworklet":
          case "serviceworker":
          case "sharedworker":
          case "worker":
          case "script":
            if (f.querySelector(kc(N)))
              return;
        }
        y = f.createElement("link"), Yr(y, "link", a), Zn(y), f.head.appendChild(y);
      }
    }
  }
  function Dr(a, l, f) {
    vo.S(a, l, f);
    var y = pl;
    if (y && a) {
      var _ = dr(y).hoistableStyles, N = Sc(a);
      l = l || "default";
      var B = _.get(N);
      if (!B) {
        var ee = { loading: 0, preload: null };
        if (B = y.querySelector(
          Cc(N)
        ))
          ee.loading = 5;
        else {
          a = p(
            { rel: "stylesheet", href: a, "data-precedence": l },
            f
          ), (f = za.get(N)) && gg(a, f);
          var ye = B = y.createElement("link");
          Zn(ye), Yr(ye, "link", a), ye._p = new Promise(function(Pe, Ve) {
            ye.onload = Pe, ye.onerror = Ve;
          }), ye.addEventListener("load", function() {
            ee.loading |= 1;
          }), ye.addEventListener("error", function() {
            ee.loading |= 2;
          }), ee.loading |= 4, Gh(B, l, y);
        }
        B = {
          type: "stylesheet",
          instance: B,
          count: 1,
          state: ee
        }, _.set(N, B);
      }
    }
  }
  function zi(a, l) {
    vo.X(a, l);
    var f = pl;
    if (f && a) {
      var y = dr(f).hoistableScripts, _ = Ec(a), N = y.get(_);
      N || (N = f.querySelector(kc(_)), N || (a = p({ src: a, async: !0 }, l), (l = za.get(_)) && Kh(a, l), N = f.createElement("script"), Zn(N), Yr(N, "link", a), f.head.appendChild(N)), N = {
        type: "script",
        instance: N,
        count: 1,
        state: null
      }, y.set(_, N));
    }
  }
  function xb(a, l) {
    vo.M(a, l);
    var f = pl;
    if (f && a) {
      var y = dr(f).hoistableScripts, _ = Ec(a), N = y.get(_);
      N || (N = f.querySelector(kc(_)), N || (a = p({ src: a, async: !0, type: "module" }, l), (l = za.get(_)) && Kh(a, l), N = f.createElement("script"), Zn(N), Yr(N, "link", a), f.head.appendChild(N)), N = {
        type: "script",
        instance: N,
        count: 1,
        state: null
      }, y.set(_, N));
    }
  }
  function m1(a, l, f, y) {
    var _ = (_ = Se.current) ? Hh(_) : null;
    if (!_) throw Error(r(446));
    switch (a) {
      case "meta":
      case "title":
        return null;
      case "style":
        return typeof f.precedence == "string" && typeof f.href == "string" ? (l = Sc(f.href), f = dr(
          _
        ).hoistableStyles, y = f.get(l), y || (y = {
          type: "style",
          instance: null,
          count: 0,
          state: null
        }, f.set(l, y)), y) : { type: "void", instance: null, count: 0, state: null };
      case "link":
        if (f.rel === "stylesheet" && typeof f.href == "string" && typeof f.precedence == "string") {
          a = Sc(f.href);
          var N = dr(
            _
          ).hoistableStyles, B = N.get(a);
          if (B || (_ = _.ownerDocument || _, B = {
            type: "stylesheet",
            instance: null,
            count: 0,
            state: { loading: 0, preload: null }
          }, N.set(a, B), (N = _.querySelector(
            Cc(a)
          )) && !N._p && (B.instance = N, B.state.loading = 5), za.has(a) || (f = {
            rel: "preload",
            as: "style",
            href: f.href,
            crossOrigin: f.crossOrigin,
            integrity: f.integrity,
            media: f.media,
            hrefLang: f.hrefLang,
            referrerPolicy: f.referrerPolicy
          }, za.set(a, f), N || bb(
            _,
            a,
            f,
            B.state
          ))), l && y === null)
            throw Error(r(528, ""));
          return B;
        }
        if (l && y !== null)
          throw Error(r(529, ""));
        return null;
      case "script":
        return l = f.async, f = f.src, typeof f == "string" && l && typeof l != "function" && typeof l != "symbol" ? (l = Ec(f), f = dr(
          _
        ).hoistableScripts, y = f.get(l), y || (y = {
          type: "script",
          instance: null,
          count: 0,
          state: null
        }, f.set(l, y)), y) : { type: "void", instance: null, count: 0, state: null };
      default:
        throw Error(r(444, a));
    }
  }
  function Sc(a) {
    return 'href="' + hr(a) + '"';
  }
  function Cc(a) {
    return 'link[rel="stylesheet"][' + a + "]";
  }
  function p1(a) {
    return p({}, a, {
      "data-precedence": a.precedence,
      precedence: null
    });
  }
  function bb(a, l, f, y) {
    a.querySelector('link[rel="preload"][as="style"][' + l + "]") ? y.loading = 1 : (l = a.createElement("link"), y.preload = l, l.addEventListener("load", function() {
      return y.loading |= 1;
    }), l.addEventListener("error", function() {
      return y.loading |= 2;
    }), Yr(l, "link", f), Zn(l), a.head.appendChild(l));
  }
  function Ec(a) {
    return '[src="' + hr(a) + '"]';
  }
  function kc(a) {
    return "script[async]" + a;
  }
  function g1(a, l, f) {
    if (l.count++, l.instance === null)
      switch (l.type) {
        case "style":
          var y = a.querySelector(
            'style[data-href~="' + hr(f.href) + '"]'
          );
          if (y)
            return l.instance = y, Zn(y), y;
          var _ = p({}, f, {
            "data-href": f.href,
            "data-precedence": f.precedence,
            href: null,
            precedence: null
          });
          return y = (a.ownerDocument || a).createElement(
            "style"
          ), Zn(y), Yr(y, "style", _), Gh(y, f.precedence, a), l.instance = y;
        case "stylesheet":
          _ = Sc(f.href);
          var N = a.querySelector(
            Cc(_)
          );
          if (N)
            return l.state.loading |= 4, l.instance = N, Zn(N), N;
          y = p1(f), (_ = za.get(_)) && gg(y, _), N = (a.ownerDocument || a).createElement("link"), Zn(N);
          var B = N;
          return B._p = new Promise(function(ee, ye) {
            B.onload = ee, B.onerror = ye;
          }), Yr(N, "link", y), l.state.loading |= 4, Gh(N, f.precedence, a), l.instance = N;
        case "script":
          return N = Ec(f.src), (_ = a.querySelector(
            kc(N)
          )) ? (l.instance = _, Zn(_), _) : (y = f, (_ = za.get(N)) && (y = p({}, f), Kh(y, _)), a = a.ownerDocument || a, _ = a.createElement("script"), Zn(_), Yr(_, "link", y), a.head.appendChild(_), l.instance = _);
        case "void":
          return null;
        default:
          throw Error(r(443, l.type));
      }
    else
      l.type === "stylesheet" && (l.state.loading & 4) === 0 && (y = l.instance, l.state.loading |= 4, Gh(y, f.precedence, a));
    return l.instance;
  }
  function Gh(a, l, f) {
    for (var y = f.querySelectorAll(
      'link[rel="stylesheet"][data-precedence],style[data-precedence]'
    ), _ = y.length ? y[y.length - 1] : null, N = _, B = 0; B < y.length; B++) {
      var ee = y[B];
      if (ee.dataset.precedence === l) N = ee;
      else if (N !== _) break;
    }
    N ? N.parentNode.insertBefore(a, N.nextSibling) : (l = f.nodeType === 9 ? f.head : f, l.insertBefore(a, l.firstChild));
  }
  function gg(a, l) {
    a.crossOrigin == null && (a.crossOrigin = l.crossOrigin), a.referrerPolicy == null && (a.referrerPolicy = l.referrerPolicy), a.title == null && (a.title = l.title);
  }
  function Kh(a, l) {
    a.crossOrigin == null && (a.crossOrigin = l.crossOrigin), a.referrerPolicy == null && (a.referrerPolicy = l.referrerPolicy), a.integrity == null && (a.integrity = l.integrity);
  }
  var nd = null;
  function y1(a, l, f) {
    if (nd === null) {
      var y = /* @__PURE__ */ new Map(), _ = nd = /* @__PURE__ */ new Map();
      _.set(f, y);
    } else
      _ = nd, y = _.get(f), y || (y = /* @__PURE__ */ new Map(), _.set(f, y));
    if (y.has(a)) return y;
    for (y.set(a, null), f = f.getElementsByTagName(a), _ = 0; _ < f.length; _++) {
      var N = f[_];
      if (!(N[li] || N[wn] || a === "link" && N.getAttribute("rel") === "stylesheet") && N.namespaceURI !== "http://www.w3.org/2000/svg") {
        var B = N.getAttribute(l) || "";
        B = a + B;
        var ee = y.get(B);
        ee ? ee.push(N) : y.set(B, [N]);
      }
    }
    return y;
  }
  function v1(a, l, f) {
    a = a.ownerDocument || a, a.head.insertBefore(
      f,
      l === "title" ? a.querySelector("head > title") : null
    );
  }
  function wb(a, l, f) {
    if (f === 1 || l.itemProp != null) return !1;
    switch (a) {
      case "meta":
      case "title":
        return !0;
      case "style":
        if (typeof l.precedence != "string" || typeof l.href != "string" || l.href === "")
          break;
        return !0;
      case "link":
        if (typeof l.rel != "string" || typeof l.href != "string" || l.href === "" || l.onLoad || l.onError)
          break;
        switch (l.rel) {
          case "stylesheet":
            return a = l.disabled, typeof l.precedence == "string" && a == null;
          default:
            return !0;
        }
      case "script":
        if (l.async && typeof l.async != "function" && typeof l.async != "symbol" && !l.onLoad && !l.onError && l.src && typeof l.src == "string")
          return !0;
    }
    return !1;
  }
  function x1(a) {
    return !(a.type === "stylesheet" && (a.state.loading & 3) === 0);
  }
  function Tc(a, l, f, y) {
    if (f.type === "stylesheet" && (typeof y.media != "string" || matchMedia(y.media).matches !== !1) && (f.state.loading & 4) === 0) {
      if (f.instance === null) {
        var _ = Sc(y.href), N = l.querySelector(
          Cc(_)
        );
        if (N) {
          l = N._p, l !== null && typeof l == "object" && typeof l.then == "function" && (a.count++, a = Yh.bind(a), l.then(a, a)), f.state.loading |= 4, f.instance = N, Zn(N);
          return;
        }
        N = l.ownerDocument || l, y = p1(y), (_ = za.get(_)) && gg(y, _), N = N.createElement("link"), Zn(N);
        var B = N;
        B._p = new Promise(function(ee, ye) {
          B.onload = ee, B.onerror = ye;
        }), Yr(N, "link", y), f.instance = N;
      }
      a.stylesheets === null && (a.stylesheets = /* @__PURE__ */ new Map()), a.stylesheets.set(f, l), (l = f.state.preload) && (f.state.loading & 3) === 0 && (a.count++, f = Yh.bind(a), l.addEventListener("load", f), l.addEventListener("error", f));
    }
  }
  var yg = 0;
  function _b(a, l) {
    return a.stylesheets && a.count === 0 && Xh(a, a.stylesheets), 0 < a.count || 0 < a.imgCount ? function(f) {
      var y = setTimeout(function() {
        if (a.stylesheets && Xh(a, a.stylesheets), a.unsuspend) {
          var N = a.unsuspend;
          a.unsuspend = null, N();
        }
      }, 6e4 + l);
      0 < a.imgBytes && yg === 0 && (yg = 62500 * Qf());
      var _ = setTimeout(
        function() {
          if (a.waitingForImages = !1, a.count === 0 && (a.stylesheets && Xh(a, a.stylesheets), a.unsuspend)) {
            var N = a.unsuspend;
            a.unsuspend = null, N();
          }
        },
        (a.imgBytes > yg ? 50 : 800) + l
      );
      return a.unsuspend = f, function() {
        a.unsuspend = null, clearTimeout(y), clearTimeout(_);
      };
    } : null;
  }
  function Yh() {
    if (this.count--, this.count === 0 && (this.imgCount === 0 || !this.waitingForImages)) {
      if (this.stylesheets) Xh(this, this.stylesheets);
      else if (this.unsuspend) {
        var a = this.unsuspend;
        this.unsuspend = null, a();
      }
    }
  }
  var Wh = null;
  function Xh(a, l) {
    a.stylesheets = null, a.unsuspend !== null && (a.count++, Wh = /* @__PURE__ */ new Map(), l.forEach(b1, a), Wh = null, Yh.call(a));
  }
  function b1(a, l) {
    if (!(l.state.loading & 4)) {
      var f = Wh.get(a);
      if (f) var y = f.get(null);
      else {
        f = /* @__PURE__ */ new Map(), Wh.set(a, f);
        for (var _ = a.querySelectorAll(
          "link[data-precedence],style[data-precedence]"
        ), N = 0; N < _.length; N++) {
          var B = _[N];
          (B.nodeName === "LINK" || B.getAttribute("media") !== "not all") && (f.set(B.dataset.precedence, B), y = B);
        }
        y && f.set(null, y);
      }
      _ = l.instance, B = _.getAttribute("data-precedence"), N = f.get(B) || y, N === y && f.set(null, _), f.set(B, _), this.count++, y = Yh.bind(this), _.addEventListener("load", y), _.addEventListener("error", y), N ? N.parentNode.insertBefore(_, N.nextSibling) : (a = a.nodeType === 9 ? a.head : a, a.insertBefore(_, a.firstChild)), l.state.loading |= 4;
    }
  }
  var Nc = {
    $$typeof: j,
    Provider: null,
    Consumer: null,
    _currentValue: de,
    _currentValue2: de,
    _threadCount: 0
  };
  function Sb(a, l, f, y, _, N, B, ee, ye) {
    this.tag = 1, this.containerInfo = a, this.pingCache = this.current = this.pendingChildren = null, this.timeoutHandle = -1, this.callbackNode = this.next = this.pendingContext = this.context = this.cancelPendingCommit = null, this.callbackPriority = 0, this.expirationTimes = ha(-1), this.entangledLanes = this.shellSuspendCounter = this.errorRecoveryDisabledLanes = this.expiredLanes = this.warmLanes = this.pingedLanes = this.suspendedLanes = this.pendingLanes = 0, this.entanglements = ha(0), this.hiddenUpdates = ha(null), this.identifierPrefix = y, this.onUncaughtError = _, this.onCaughtError = N, this.onRecoverableError = B, this.pooledCache = null, this.pooledCacheLanes = 0, this.formState = ye, this.incompleteTransitions = /* @__PURE__ */ new Map();
  }
  function w1(a, l, f, y, _, N, B, ee, ye, Pe, Ve, Ye) {
    return a = new Sb(
      a,
      l,
      f,
      B,
      ye,
      Pe,
      Ve,
      Ye,
      ee
    ), l = 1, N === !0 && (l |= 24), N = Vr(3, null, null, l), a.current = N, N.stateNode = a, l = Qa(), l.refCount++, a.pooledCache = l, l.refCount++, N.memoizedState = {
      element: y,
      isDehydrated: f,
      cache: l
    }, Ts(N), a;
  }
  function _1(a) {
    return a ? (a = $r, a) : $r;
  }
  function S1(a, l, f, y, _, N) {
    _ = _1(_), y.context === null ? y.context = _ : y.pendingContext = _, y = tl(l), y.payload = { element: f }, N = N === void 0 ? null : N, N !== null && (y.callback = N), f = es(a, y, l), f !== null && (Di(f, a, l), hf(f, a, l));
  }
  function C1(a, l) {
    if (a = a.memoizedState, a !== null && a.dehydrated !== null) {
      var f = a.retryLane;
      a.retryLane = f !== 0 && f < l ? f : l;
    }
  }
  function vg(a, l) {
    C1(a, l), (a = a.alternate) && C1(a, l);
  }
  function E1(a) {
    if (a.tag === 13 || a.tag === 31) {
      var l = Nn(a, 67108864);
      l !== null && Di(l, a, 67108864), vg(a, 67108864);
    }
  }
  function k1(a) {
    if (a.tag === 13 || a.tag === 31) {
      var l = ra();
      l = Bl(l);
      var f = Nn(a, l);
      f !== null && Di(f, a, l), vg(a, l);
    }
  }
  var Qh = !0;
  function Cb(a, l, f, y) {
    var _ = J.T;
    J.T = null;
    var N = ue.p;
    try {
      ue.p = 2, xg(a, l, f, y);
    } finally {
      ue.p = N, J.T = _;
    }
  }
  function Eb(a, l, f, y) {
    var _ = J.T;
    J.T = null;
    var N = ue.p;
    try {
      ue.p = 8, xg(a, l, f, y);
    } finally {
      ue.p = N, J.T = _;
    }
  }
  function xg(a, l, f, y) {
    if (Qh) {
      var _ = bg(y);
      if (_ === null)
        lg(
          a,
          l,
          y,
          Zh,
          f
        ), N1(a, y);
      else if (A1(
        _,
        a,
        l,
        f,
        y
      ))
        y.stopPropagation();
      else if (N1(a, y), l & 4 && -1 < kb.indexOf(a)) {
        for (; _ !== null; ) {
          var N = on(_);
          if (N !== null)
            switch (N.tag) {
              case 3:
                if (N = N.stateNode, N.current.memoizedState.isDehydrated) {
                  var B = Ui(N.pendingLanes);
                  if (B !== 0) {
                    var ee = N;
                    for (ee.pendingLanes |= 2, ee.entangledLanes |= 2; B; ) {
                      var ye = 1 << 31 - it(B);
                      ee.entanglements[1] |= ye, B &= ~ye;
                    }
                    Rs(N), (mn & 6) === 0 && (cu = En() + 500, Yf(0));
                  }
                }
                break;
              case 31:
              case 13:
                ee = Nn(N, 2), ee !== null && Di(ee, N, 2), Dh(), vg(N, 2);
            }
          if (N = bg(y), N === null && lg(
            a,
            l,
            y,
            Zh,
            f
          ), N === _) break;
          _ = N;
        }
        _ !== null && y.stopPropagation();
      } else
        lg(
          a,
          l,
          y,
          null,
          f
        );
    }
  }
  function bg(a) {
    return a = Du(a), wg(a);
  }
  var Zh = null;
  function wg(a) {
    if (Zh = null, a = ya(a), a !== null) {
      var l = s(a);
      if (l === null) a = null;
      else {
        var f = l.tag;
        if (f === 13) {
          if (a = o(l), a !== null) return a;
          a = null;
        } else if (f === 31) {
          if (a = u(l), a !== null) return a;
          a = null;
        } else if (f === 3) {
          if (l.stateNode.current.memoizedState.isDehydrated)
            return l.tag === 3 ? l.stateNode.containerInfo : null;
          a = null;
        } else l !== a && (a = null);
      }
    }
    return Zh = a, null;
  }
  function T1(a) {
    switch (a) {
      case "beforetoggle":
      case "cancel":
      case "click":
      case "close":
      case "contextmenu":
      case "copy":
      case "cut":
      case "auxclick":
      case "dblclick":
      case "dragend":
      case "dragstart":
      case "drop":
      case "focusin":
      case "focusout":
      case "input":
      case "invalid":
      case "keydown":
      case "keypress":
      case "keyup":
      case "mousedown":
      case "mouseup":
      case "paste":
      case "pause":
      case "play":
      case "pointercancel":
      case "pointerdown":
      case "pointerup":
      case "ratechange":
      case "reset":
      case "resize":
      case "seeked":
      case "submit":
      case "toggle":
      case "touchcancel":
      case "touchend":
      case "touchstart":
      case "volumechange":
      case "change":
      case "selectionchange":
      case "textInput":
      case "compositionstart":
      case "compositionend":
      case "compositionupdate":
      case "beforeblur":
      case "afterblur":
      case "beforeinput":
      case "blur":
      case "fullscreenchange":
      case "focus":
      case "hashchange":
      case "popstate":
      case "select":
      case "selectstart":
        return 2;
      case "drag":
      case "dragenter":
      case "dragexit":
      case "dragleave":
      case "dragover":
      case "mousemove":
      case "mouseout":
      case "mouseover":
      case "pointermove":
      case "pointerout":
      case "pointerover":
      case "scroll":
      case "touchmove":
      case "wheel":
      case "mouseenter":
      case "mouseleave":
      case "pointerenter":
      case "pointerleave":
        return 8;
      case "message":
        switch (Xn()) {
          case Fe:
            return 2;
          case Qe:
            return 8;
          case yt:
          case Tt:
            return 32;
          case Pt:
            return 268435456;
          default:
            return 32;
        }
      default:
        return 32;
    }
  }
  var _g = !1, gl = null, yl = null, vl = null, rd = /* @__PURE__ */ new Map(), id = /* @__PURE__ */ new Map(), xl = [], kb = "mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(
    " "
  );
  function N1(a, l) {
    switch (a) {
      case "focusin":
      case "focusout":
        gl = null;
        break;
      case "dragenter":
      case "dragleave":
        yl = null;
        break;
      case "mouseover":
      case "mouseout":
        vl = null;
        break;
      case "pointerover":
      case "pointerout":
        rd.delete(l.pointerId);
        break;
      case "gotpointercapture":
      case "lostpointercapture":
        id.delete(l.pointerId);
    }
  }
  function hu(a, l, f, y, _, N) {
    return a === null || a.nativeEvent !== N ? (a = {
      blockedOn: l,
      domEventName: f,
      eventSystemFlags: y,
      nativeEvent: N,
      targetContainers: [_]
    }, l !== null && (l = on(l), l !== null && E1(l)), a) : (a.eventSystemFlags |= y, l = a.targetContainers, _ !== null && l.indexOf(_) === -1 && l.push(_), a);
  }
  function A1(a, l, f, y, _) {
    switch (l) {
      case "focusin":
        return gl = hu(
          gl,
          a,
          l,
          f,
          y,
          _
        ), !0;
      case "dragenter":
        return yl = hu(
          yl,
          a,
          l,
          f,
          y,
          _
        ), !0;
      case "mouseover":
        return vl = hu(
          vl,
          a,
          l,
          f,
          y,
          _
        ), !0;
      case "pointerover":
        var N = _.pointerId;
        return rd.set(
          N,
          hu(
            rd.get(N) || null,
            a,
            l,
            f,
            y,
            _
          )
        ), !0;
      case "gotpointercapture":
        return N = _.pointerId, id.set(
          N,
          hu(
            id.get(N) || null,
            a,
            l,
            f,
            y,
            _
          )
        ), !0;
    }
    return !1;
  }
  function Sg(a) {
    var l = ya(a.target);
    if (l !== null) {
      var f = s(l);
      if (f !== null) {
        if (l = f.tag, l === 13) {
          if (l = o(f), l !== null) {
            a.blockedOn = l, Vs(a.priority, function() {
              k1(f);
            });
            return;
          }
        } else if (l === 31) {
          if (l = u(f), l !== null) {
            a.blockedOn = l, Vs(a.priority, function() {
              k1(f);
            });
            return;
          }
        } else if (l === 3 && f.stateNode.current.memoizedState.isDehydrated) {
          a.blockedOn = f.tag === 3 ? f.stateNode.containerInfo : null;
          return;
        }
      }
    }
    a.blockedOn = null;
  }
  function Jh(a) {
    if (a.blockedOn !== null) return !1;
    for (var l = a.targetContainers; 0 < l.length; ) {
      var f = bg(a.nativeEvent);
      if (f === null) {
        f = a.nativeEvent;
        var y = new f.constructor(
          f.type,
          f
        );
        _a = y, f.target.dispatchEvent(y), _a = null;
      } else
        return l = on(f), l !== null && E1(l), a.blockedOn = f, !1;
      l.shift();
    }
    return !0;
  }
  function j1(a, l, f) {
    Jh(a) && f.delete(l);
  }
  function Tb() {
    _g = !1, gl !== null && Jh(gl) && (gl = null), yl !== null && Jh(yl) && (yl = null), vl !== null && Jh(vl) && (vl = null), rd.forEach(j1), id.forEach(j1);
  }
  function Ac(a, l) {
    a.blockedOn === l && (a.blockedOn = null, _g || (_g = !0, e.unstable_scheduleCallback(
      e.unstable_NormalPriority,
      Tb
    )));
  }
  var em = null;
  function M1(a) {
    em !== a && (em = a, e.unstable_scheduleCallback(
      e.unstable_NormalPriority,
      function() {
        em === a && (em = null);
        for (var l = 0; l < a.length; l += 3) {
          var f = a[l], y = a[l + 1], _ = a[l + 2];
          if (typeof y != "function") {
            if (wg(y || f) === null)
              continue;
            break;
          }
          var N = on(f);
          N !== null && (a.splice(l, 3), l -= 3, il(
            N,
            {
              pending: !0,
              data: _,
              method: f.method,
              action: y
            },
            y,
            _
          ));
        }
      }
    ));
  }
  function jc(a) {
    function l(ye) {
      return Ac(ye, a);
    }
    gl !== null && Ac(gl, a), yl !== null && Ac(yl, a), vl !== null && Ac(vl, a), rd.forEach(l), id.forEach(l);
    for (var f = 0; f < xl.length; f++) {
      var y = xl[f];
      y.blockedOn === a && (y.blockedOn = null);
    }
    for (; 0 < xl.length && (f = xl[0], f.blockedOn === null); )
      Sg(f), f.blockedOn === null && xl.shift();
    if (f = (a.ownerDocument || a).$$reactFormReplay, f != null)
      for (y = 0; y < f.length; y += 3) {
        var _ = f[y], N = f[y + 1], B = _[Qn] || null;
        if (typeof N == "function")
          B || M1(f);
        else if (B) {
          var ee = null;
          if (N && N.hasAttribute("formAction")) {
            if (_ = N, B = N[Qn] || null)
              ee = B.formAction;
            else if (wg(_) !== null) continue;
          } else ee = B.action;
          typeof ee == "function" ? f[y + 1] = ee : (f.splice(y, 3), y -= 3), M1(f);
        }
      }
  }
  function gi() {
    function a(N) {
      N.canIntercept && N.info === "react-transition" && N.intercept({
        handler: function() {
          return new Promise(function(B) {
            return _ = B;
          });
        },
        focusReset: "manual",
        scroll: "manual"
      });
    }
    function l() {
      _ !== null && (_(), _ = null), y || setTimeout(f, 20);
    }
    function f() {
      if (!y && !navigation.transition) {
        var N = navigation.currentEntry;
        N && N.url != null && navigation.navigate(N.url, {
          state: N.getState(),
          info: "react-transition",
          history: "replace"
        });
      }
    }
    if (typeof navigation == "object") {
      var y = !1, _ = null;
      return navigation.addEventListener("navigate", a), navigation.addEventListener("navigatesuccess", l), navigation.addEventListener("navigateerror", l), setTimeout(f, 100), function() {
        y = !0, navigation.removeEventListener("navigate", a), navigation.removeEventListener("navigatesuccess", l), navigation.removeEventListener("navigateerror", l), _ !== null && (_(), _ = null);
      };
    }
  }
  function ad(a) {
    this._internalRoot = a;
  }
  tm.prototype.render = ad.prototype.render = function(a) {
    var l = this._internalRoot;
    if (l === null) throw Error(r(409));
    var f = l.current, y = ra();
    S1(f, y, a, l, null, null);
  }, tm.prototype.unmount = ad.prototype.unmount = function() {
    var a = this._internalRoot;
    if (a !== null) {
      this._internalRoot = null;
      var l = a.containerInfo;
      S1(a.current, 2, null, a, null, null), Dh(), l[Mr] = null;
    }
  };
  function tm(a) {
    this._internalRoot = a;
  }
  tm.prototype.unstable_scheduleHydration = function(a) {
    if (a) {
      var l = $s();
      a = { blockedOn: null, target: a, priority: l };
      for (var f = 0; f < xl.length && l !== 0 && l < xl[f].priority; f++) ;
      xl.splice(f, 0, a), f === 0 && Sg(a);
    }
  };
  var R1 = t.version;
  if (R1 !== "19.2.3")
    throw Error(
      r(
        527,
        R1,
        "19.2.3"
      )
    );
  ue.findDOMNode = function(a) {
    var l = a._reactInternals;
    if (l === void 0)
      throw typeof a.render == "function" ? Error(r(188)) : (a = Object.keys(a).join(","), Error(r(268, a)));
    return a = d(l), a = a !== null ? m(a) : null, a = a === null ? null : a.stateNode, a;
  };
  var Nb = {
    bundleType: 0,
    version: "19.2.3",
    rendererPackageName: "react-dom",
    currentDispatcherRef: J,
    reconcilerVersion: "19.2.3"
  };
  if (typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ < "u") {
    var nm = __REACT_DEVTOOLS_GLOBAL_HOOK__;
    if (!nm.isDisabled && nm.supportsFiber)
      try {
        sn = nm.inject(
          Nb
        ), Qt = nm;
      } catch {
      }
  }
  return Eg.createRoot = function(a, l) {
    if (!i(a)) throw Error(r(299));
    var f = !1, y = "", _ = Cp, N = Ep, B = yy;
    return l != null && (l.unstable_strictMode === !0 && (f = !0), l.identifierPrefix !== void 0 && (y = l.identifierPrefix), l.onUncaughtError !== void 0 && (_ = l.onUncaughtError), l.onCaughtError !== void 0 && (N = l.onCaughtError), l.onRecoverableError !== void 0 && (B = l.onRecoverableError)), l = w1(
      a,
      1,
      !1,
      null,
      null,
      f,
      y,
      null,
      _,
      N,
      B,
      gi
    ), a[Mr] = l.current, og(a), new ad(l);
  }, Eg.hydrateRoot = function(a, l, f) {
    if (!i(a)) throw Error(r(299));
    var y = !1, _ = "", N = Cp, B = Ep, ee = yy, ye = null;
    return f != null && (f.unstable_strictMode === !0 && (y = !0), f.identifierPrefix !== void 0 && (_ = f.identifierPrefix), f.onUncaughtError !== void 0 && (N = f.onUncaughtError), f.onCaughtError !== void 0 && (B = f.onCaughtError), f.onRecoverableError !== void 0 && (ee = f.onRecoverableError), f.formState !== void 0 && (ye = f.formState)), l = w1(
      a,
      1,
      !0,
      l,
      f ?? null,
      y,
      _,
      ye,
      N,
      B,
      ee,
      gi
    ), l.context = _1(null), f = l.current, y = ra(), y = Bl(y), _ = tl(y), _.callback = null, es(f, _, y), f = y, l.current.lanes = f, Si(l, f), Rs(l), a[Mr] = l.current, og(a), new tm(l);
  }, Eg.version = "19.2.3", Eg;
}
var Ek;
function WL() {
  if (Ek) return Rb.exports;
  Ek = 1;
  function e() {
    if (!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ > "u" || typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE != "function"))
      try {
        __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e);
      } catch (t) {
        console.error(t);
      }
  }
  return e(), Rb.exports = YL(), Rb.exports;
}
var XL = WL();
const WM = /* @__PURE__ */ Uc(XL), QL = () => {
  if (document.getElementById("engram-font-preload")) return;
  [
    "https://fonts.googleapis.com/css2?family=Inter:wght@200;300;400;500;600&display=swap",
    "https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500&display=swap"
  ].forEach((t, n) => {
    const r = document.createElement("link");
    r.rel = "preload", r.as = "style", r.href = t, n === 0 && (r.id = "engram-font-preload"), document.head.appendChild(r);
    const i = document.createElement("link");
    i.rel = "stylesheet", i.href = t, document.head.appendChild(i);
  });
}, ZL = () => (F.useEffect(() => {
  QL();
}, []), /* @__PURE__ */ g.jsx("style", { children: `
    :root {
      --font-sans: 'Inter', system-ui, -apple-system, sans-serif;
      --font-mono: 'JetBrains Mono', monospace;
    }

    body {
      font-family: var(--font-sans);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    
    .font-mono {
      font-family: var(--font-mono);
    }
    
    /* Custom Scrollbar for dark theme - Minimalist */
    ::-webkit-scrollbar {
      width: 6px;
      height: 6px;
    }
    ::-webkit-scrollbar-track {
      background: transparent;
    }
    ::-webkit-scrollbar-thumb {
      background: rgba(63, 63, 70, 0.4); /* zinc-700 with opacity */
      border-radius: 3px;
    }
    ::-webkit-scrollbar-thumb:hover {
      background: rgba(82, 82, 91, 0.6); /* zinc-600 with opacity */
    }

    /* Animation Utilities */
    .animate-float {
      animation: float 6s ease-in-out infinite;
    }
    .animate-in {
      animation: fadeIn 0.3s ease-out forwards;
    }
    .fade-in {
      opacity: 0;
      animation: fadeIn 0.3s ease-out forwards;
    }
    
    @keyframes float {
      0% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
      100% { transform: translateY(0px); }
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(5px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Utility to hide scrollbar but keep functionality */
    .no-scrollbar::-webkit-scrollbar {
      display: none;
    }
    .no-scrollbar {
      -ms-overflow-style: none;
      scrollbar-width: none;
    }
  ` }));
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const JL = (e) => e.replace(/([a-z0-9])([A-Z])/g, "$1-$2").toLowerCase(), eB = (e) => e.replace(
  /^([A-Z])|[\s-_]+(\w)/g,
  (t, n, r) => r ? r.toUpperCase() : n.toLowerCase()
), kk = (e) => {
  const t = eB(e);
  return t.charAt(0).toUpperCase() + t.slice(1);
}, XM = (...e) => e.filter((t, n, r) => !!t && t.trim() !== "" && r.indexOf(t) === n).join(" ").trim(), tB = (e) => {
  for (const t in e)
    if (t.startsWith("aria-") || t === "role" || t === "title")
      return !0;
};
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
var nB = {
  xmlns: "http://www.w3.org/2000/svg",
  width: 24,
  height: 24,
  viewBox: "0 0 24 24",
  fill: "none",
  stroke: "currentColor",
  strokeWidth: 2,
  strokeLinecap: "round",
  strokeLinejoin: "round"
};
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const rB = F.forwardRef(
  ({
    color: e = "currentColor",
    size: t = 24,
    strokeWidth: n = 2,
    absoluteStrokeWidth: r,
    className: i = "",
    children: s,
    iconNode: o,
    ...u
  }, c) => F.createElement(
    "svg",
    {
      ref: c,
      ...nB,
      width: t,
      height: t,
      stroke: e,
      strokeWidth: r ? Number(n) * 24 / Number(t) : n,
      className: XM("lucide", i),
      ...!s && !tB(u) && { "aria-hidden": "true" },
      ...u
    },
    [
      ...o.map(([d, m]) => F.createElement(d, m)),
      ...Array.isArray(s) ? s : [s]
    ]
  )
);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const mt = (e, t) => {
  const n = F.forwardRef(
    ({ className: r, ...i }, s) => F.createElement(rB, {
      ref: s,
      iconNode: t,
      className: XM(
        `lucide-${JL(kk(e))}`,
        `lucide-${e}`,
        r
      ),
      ...i
    })
  );
  return n.displayName = kk(e), n;
};
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const iB = [
  ["path", { d: "M12 17V3", key: "1cwfxf" }],
  ["path", { d: "m6 11 6 6 6-6", key: "12ii2o" }],
  ["path", { d: "M19 21H5", key: "150jfl" }]
], aB = mt("arrow-down-to-line", iB);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const sB = [
  ["path", { d: "m12 19-7-7 7-7", key: "1l729n" }],
  ["path", { d: "M19 12H5", key: "x3x0zl" }]
], vC = mt("arrow-left", sB);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const oB = [
  ["path", { d: "M10.268 21a2 2 0 0 0 3.464 0", key: "vwvbt9" }],
  [
    "path",
    {
      d: "M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",
      key: "11g9vi"
    }
  ]
], lB = mt("bell", oB);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const uB = [
  ["path", { d: "M12 7v14", key: "1akyts" }],
  [
    "path",
    {
      d: "M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",
      key: "ruj8y"
    }
  ]
], cB = mt("book-open", uB);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const fB = [
  [
    "path",
    {
      d: "M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",
      key: "k3hazp"
    }
  ]
], dB = mt("book", fB);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const hB = [
  ["path", { d: "M12 8V4H8", key: "hb8ula" }],
  ["rect", { width: "16", height: "12", x: "4", y: "8", rx: "2", key: "enze0r" }],
  ["path", { d: "M2 14h2", key: "vft8re" }],
  ["path", { d: "M20 14h2", key: "4cs60a" }],
  ["path", { d: "M15 13v2", key: "1xurst" }],
  ["path", { d: "M9 13v2", key: "rq6x2g" }]
], QM = mt("bot", hB);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const mB = [
  [
    "path",
    { d: "M8 3H7a2 2 0 0 0-2 2v5a2 2 0 0 1-2 2 2 2 0 0 1 2 2v5c0 1.1.9 2 2 2h1", key: "ezmyqa" }
  ],
  [
    "path",
    {
      d: "M16 21h1a2 2 0 0 0 2-2v-5c0-1.1.9-2 2-2a2 2 0 0 1-2-2V5a2 2 0 0 0-2-2h-1",
      key: "e1hn23"
    }
  ]
], ZM = mt("braces", mB);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const pB = [
  [
    "path",
    {
      d: "M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",
      key: "l5xja"
    }
  ],
  ["path", { d: "M9 13a4.5 4.5 0 0 0 3-4", key: "10igwf" }],
  ["path", { d: "M6.003 5.125A3 3 0 0 0 6.401 6.5", key: "105sqy" }],
  ["path", { d: "M3.477 10.896a4 4 0 0 1 .585-.396", key: "ql3yin" }],
  ["path", { d: "M6 18a4 4 0 0 1-1.967-.516", key: "2e4loj" }],
  ["path", { d: "M12 13h4", key: "1ku699" }],
  ["path", { d: "M12 18h6a2 2 0 0 1 2 2v1", key: "105ag5" }],
  ["path", { d: "M12 8h8", key: "1lhi5i" }],
  ["path", { d: "M16 8V5a2 2 0 0 1 2-2", key: "u6izg6" }],
  ["circle", { cx: "16", cy: "13", r: ".5", key: "ry7gng" }],
  ["circle", { cx: "18", cy: "3", r: ".5", key: "1aiba7" }],
  ["circle", { cx: "20", cy: "21", r: ".5", key: "yhc1fs" }],
  ["circle", { cx: "20", cy: "8", r: ".5", key: "1e43v0" }]
], gB = mt("brain-circuit", pB);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const yB = [
  ["path", { d: "M12 18V5", key: "adv99a" }],
  ["path", { d: "M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4", key: "1e3is1" }],
  ["path", { d: "M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5", key: "1gqd8o" }],
  ["path", { d: "M17.997 5.125a4 4 0 0 1 2.526 5.77", key: "iwvgf7" }],
  ["path", { d: "M18 18a4 4 0 0 0 2-7.464", key: "efp6ie" }],
  ["path", { d: "M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517", key: "1gq6am" }],
  ["path", { d: "M6 18a4 4 0 0 1-2-7.464", key: "k1g0md" }],
  ["path", { d: "M6.003 5.125a4 4 0 0 0-2.526 5.77", key: "q97ue3" }]
], JM = mt("brain", yB);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const vB = [
  ["path", { d: "M12 20v-9", key: "1qisl0" }],
  ["path", { d: "M14 7a4 4 0 0 1 4 4v3a6 6 0 0 1-12 0v-3a4 4 0 0 1 4-4z", key: "uouzyp" }],
  ["path", { d: "M14.12 3.88 16 2", key: "qol33r" }],
  ["path", { d: "M21 21a4 4 0 0 0-3.81-4", key: "1b0z45" }],
  ["path", { d: "M21 5a4 4 0 0 1-3.55 3.97", key: "5cxbf6" }],
  ["path", { d: "M22 13h-4", key: "1jl80f" }],
  ["path", { d: "M3 21a4 4 0 0 1 3.81-4", key: "1fjd4g" }],
  ["path", { d: "M3 5a4 4 0 0 0 3.55 3.97", key: "1d7oge" }],
  ["path", { d: "M6 13H2", key: "82j7cp" }],
  ["path", { d: "m8 2 1.88 1.88", key: "fmnt4t" }],
  ["path", { d: "M9 7.13V6a3 3 0 1 1 6 0v1.13", key: "1vgav8" }]
], xB = mt("bug", vB);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const bB = [
  ["rect", { width: "16", height: "20", x: "4", y: "2", rx: "2", key: "1nb95v" }],
  ["line", { x1: "8", x2: "16", y1: "6", y2: "6", key: "x4nwl0" }],
  ["line", { x1: "16", x2: "16", y1: "14", y2: "18", key: "wjye3r" }],
  ["path", { d: "M16 10h.01", key: "1m94wz" }],
  ["path", { d: "M12 10h.01", key: "1nrarc" }],
  ["path", { d: "M8 10h.01", key: "19clt8" }],
  ["path", { d: "M12 14h.01", key: "1etili" }],
  ["path", { d: "M8 14h.01", key: "6423bh" }],
  ["path", { d: "M12 18h.01", key: "mhygvu" }],
  ["path", { d: "M8 18h.01", key: "lrp35t" }]
], wB = mt("calculator", bB);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const _B = [["path", { d: "M20 6 9 17l-5-5", key: "1gmf2c" }]], Kv = mt("check", _B);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const SB = [["path", { d: "m6 9 6 6 6-6", key: "qrunsl" }]], Ad = mt("chevron-down", SB);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const CB = [["path", { d: "m9 18 6-6-6-6", key: "mthhwq" }]], Pm = mt("chevron-right", CB);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const EB = [
  ["circle", { cx: "12", cy: "12", r: "10", key: "1mglay" }],
  ["line", { x1: "12", x2: "12", y1: "8", y2: "12", key: "1pkeuh" }],
  ["line", { x1: "12", x2: "12.01", y1: "16", y2: "16", key: "4dfq90" }]
], qc = mt("circle-alert", EB);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const kB = [
  ["path", { d: "M21.801 10A10 10 0 1 1 17 3.335", key: "yps3ct" }],
  ["path", { d: "m9 11 3 3L22 4", key: "1pflzl" }]
], xC = mt("circle-check-big", kB);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const TB = [
  ["circle", { cx: "12", cy: "12", r: "10", key: "1mglay" }],
  ["path", { d: "m9 12 2 2 4-4", key: "dzmm74" }]
], Yv = mt("circle-check", TB);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const NB = [
  ["circle", { cx: "12", cy: "12", r: "10", key: "1mglay" }],
  ["path", { d: "m15 9-6 6", key: "1uzhvr" }],
  ["path", { d: "m9 9 6 6", key: "z0biqf" }]
], AB = mt("circle-x", NB);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const jB = [
  ["path", { d: "M12 6v6l4 2", key: "mmk7yg" }],
  ["circle", { cx: "12", cy: "12", r: "10", key: "1mglay" }]
], yv = mt("clock", jB);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const MB = [
  ["path", { d: "M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z", key: "p7xjir" }]
], RB = mt("cloud", MB);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const OB = [
  [
    "path",
    { d: "M15 6v12a3 3 0 1 0 3-3H6a3 3 0 1 0 3 3V6a3 3 0 1 0-3 3h12a3 3 0 1 0-3-3", key: "11bfej" }
  ]
], Tk = mt("command", OB);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const DB = [
  ["rect", { width: "14", height: "14", x: "8", y: "8", rx: "2", ry: "2", key: "17jyea" }],
  ["path", { d: "M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2", key: "zix9uf" }]
], bC = mt("copy", DB);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const IB = [
  ["path", { d: "M20 4v7a4 4 0 0 1-4 4H4", key: "6o5b7l" }],
  ["path", { d: "m9 10-5 5 5 5", key: "1kshq7" }]
], Nk = mt("corner-down-left", IB);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const PB = [
  ["path", { d: "M12 20v2", key: "1lh1kg" }],
  ["path", { d: "M12 2v2", key: "tus03m" }],
  ["path", { d: "M17 20v2", key: "1rnc9c" }],
  ["path", { d: "M17 2v2", key: "11trls" }],
  ["path", { d: "M2 12h2", key: "1t8f8n" }],
  ["path", { d: "M2 17h2", key: "7oei6x" }],
  ["path", { d: "M2 7h2", key: "asdhe0" }],
  ["path", { d: "M20 12h2", key: "1q8mjw" }],
  ["path", { d: "M20 17h2", key: "1fpfkl" }],
  ["path", { d: "M20 7h2", key: "1o8tra" }],
  ["path", { d: "M7 20v2", key: "4gnj0m" }],
  ["path", { d: "M7 2v2", key: "1i4yhu" }],
  ["rect", { x: "4", y: "4", width: "16", height: "16", rx: "2", key: "1vbyd7" }],
  ["rect", { x: "8", y: "8", width: "8", height: "8", rx: "1", key: "z9xiuo" }]
], wC = mt("cpu", PB);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const zB = [
  ["ellipse", { cx: "12", cy: "5", rx: "9", ry: "3", key: "msslwz" }],
  ["path", { d: "M3 5V19A9 3 0 0 0 21 19V5", key: "1wlel7" }],
  ["path", { d: "M3 12A9 3 0 0 0 21 12", key: "mv7ke4" }]
], Wv = mt("database", zB);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const LB = [
  ["path", { d: "M12 15V3", key: "m9g1x1" }],
  ["path", { d: "M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4", key: "ih7n3h" }],
  ["path", { d: "m7 10 5 5 5-5", key: "brsn70" }]
], Kg = mt("download", LB);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const BB = [
  ["path", { d: "M15 3h6v6", key: "1q9fwt" }],
  ["path", { d: "M10 14 21 3", key: "gplh6r" }],
  ["path", { d: "M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6", key: "a6xqqp" }]
], qB = mt("external-link", BB);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const FB = [
  [
    "path",
    {
      d: "M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",
      key: "1nclc0"
    }
  ],
  ["circle", { cx: "12", cy: "12", r: "3", key: "1v7zrd" }]
], Ak = mt("eye", FB);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const UB = [
  [
    "path",
    {
      d: "M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",
      key: "1oefj6"
    }
  ],
  ["path", { d: "M14 2v5a1 1 0 0 0 1 1h5", key: "wfsgrz" }],
  ["path", { d: "M10 9H8", key: "b1mrlr" }],
  ["path", { d: "M16 13H8", key: "t4e002" }],
  ["path", { d: "M16 17H8", key: "z1uh3a" }]
], zm = mt("file-text", UB);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const $B = [
  [
    "path",
    {
      d: "M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",
      key: "sc7q7i"
    }
  ]
], VB = mt("funnel", $B);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const HB = [
  ["line", { x1: "6", x2: "6", y1: "3", y2: "15", key: "17qcm7" }],
  ["circle", { cx: "18", cy: "6", r: "3", key: "1h7g24" }],
  ["circle", { cx: "6", cy: "18", r: "3", key: "fqmcym" }],
  ["path", { d: "M18 9a9 9 0 0 1-9 9", key: "n2h4wq" }]
], GB = mt("git-branch", HB);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const KB = [
  [
    "path",
    {
      d: "M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",
      key: "tonef"
    }
  ],
  ["path", { d: "M9 18c-4.51 2-5-2-7-2", key: "9comsn" }]
], YB = mt("github", KB);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const WB = [
  ["circle", { cx: "9", cy: "12", r: "1", key: "1vctgf" }],
  ["circle", { cx: "9", cy: "5", r: "1", key: "hp0tcf" }],
  ["circle", { cx: "9", cy: "19", r: "1", key: "fkjjf6" }],
  ["circle", { cx: "15", cy: "12", r: "1", key: "1tmaij" }],
  ["circle", { cx: "15", cy: "5", r: "1", key: "19l28e" }],
  ["circle", { cx: "15", cy: "19", r: "1", key: "f4zoj3" }]
], eR = mt("grip-vertical", WB);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const XB = [
  ["line", { x1: "4", x2: "20", y1: "9", y2: "9", key: "4lhtct" }],
  ["line", { x1: "4", x2: "20", y1: "15", y2: "15", key: "vyu0kd" }],
  ["line", { x1: "10", x2: "8", y1: "3", y2: "21", key: "1ggp8o" }],
  ["line", { x1: "16", x2: "14", y1: "3", y2: "21", key: "weycgp" }]
], QB = mt("hash", XB);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const ZB = [
  ["path", { d: "M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8", key: "5wwlr5" }],
  [
    "path",
    {
      d: "M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",
      key: "r6nss1"
    }
  ]
], JB = mt("house", ZB);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const eq = [
  ["circle", { cx: "12", cy: "12", r: "10", key: "1mglay" }],
  ["path", { d: "M12 16v-4", key: "1dtifu" }],
  ["path", { d: "M12 8h.01", key: "e9boi3" }]
], tq = mt("info", eq);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const nq = [
  ["path", { d: "m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4", key: "g0fldk" }],
  ["path", { d: "m21 2-9.6 9.6", key: "1j0ho8" }],
  ["circle", { cx: "7.5", cy: "15.5", r: "5.5", key: "yqb3hr" }]
], Xv = mt("key", nq);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const rq = [
  [
    "path",
    {
      d: "M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",
      key: "zw3jo"
    }
  ],
  [
    "path",
    {
      d: "M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",
      key: "1wduqc"
    }
  ],
  [
    "path",
    {
      d: "M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",
      key: "kqbvx6"
    }
  ]
], _C = mt("layers", rq);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const iq = [
  ["rect", { width: "7", height: "9", x: "3", y: "3", rx: "1", key: "10lvy0" }],
  ["rect", { width: "7", height: "5", x: "14", y: "3", rx: "1", key: "16une8" }],
  ["rect", { width: "7", height: "9", x: "14", y: "12", rx: "1", key: "1hutg5" }],
  ["rect", { width: "7", height: "5", x: "3", y: "16", rx: "1", key: "ldoo1y" }]
], aq = mt("layout-dashboard", iq);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const sq = [
  ["rect", { width: "7", height: "7", x: "3", y: "3", rx: "1", key: "1g98yp" }],
  ["rect", { width: "7", height: "7", x: "14", y: "3", rx: "1", key: "6d4xhi" }],
  ["rect", { width: "7", height: "7", x: "14", y: "14", rx: "1", key: "nxv5o0" }],
  ["rect", { width: "7", height: "7", x: "3", y: "14", rx: "1", key: "1bb6yr" }]
], oq = mt("layout-grid", sq);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const lq = [
  ["path", { d: "M8 5h13", key: "1pao27" }],
  ["path", { d: "M13 12h8", key: "h98zly" }],
  ["path", { d: "M13 19h8", key: "c3s6r1" }],
  ["path", { d: "M3 10a2 2 0 0 0 2 2h3", key: "1npucw" }],
  ["path", { d: "M3 5v12a2 2 0 0 0 2 2h3", key: "x1gjn2" }]
], uq = mt("list-tree", lq);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const cq = [
  ["path", { d: "M3 5h.01", key: "18ugdj" }],
  ["path", { d: "M3 12h.01", key: "nlz23k" }],
  ["path", { d: "M3 19h.01", key: "noohij" }],
  ["path", { d: "M8 5h13", key: "1pao27" }],
  ["path", { d: "M8 12h13", key: "1za7za" }],
  ["path", { d: "M8 19h13", key: "m83p4d" }]
], fq = mt("list", cq);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const dq = [["path", { d: "M21 12a9 9 0 1 1-6.219-8.56", key: "13zald" }]], Eu = mt("loader-circle", dq);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const hq = [
  ["path", { d: "M4 5h16", key: "1tepv9" }],
  ["path", { d: "M4 12h16", key: "1lakjw" }],
  ["path", { d: "M4 19h16", key: "1djgab" }]
], mq = mt("menu", hq);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const pq = [
  [
    "path",
    {
      d: "M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",
      key: "18887p"
    }
  ]
], gq = mt("message-square", pq);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const yq = [
  [
    "path",
    {
      d: "M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",
      key: "kfwtm"
    }
  ]
], jk = mt("moon", yq);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const vq = [
  ["rect", { x: "16", y: "16", width: "6", height: "6", rx: "1", key: "4q2zg0" }],
  ["rect", { x: "2", y: "16", width: "6", height: "6", rx: "1", key: "8cvhb9" }],
  ["rect", { x: "9", y: "2", width: "6", height: "6", rx: "1", key: "1egb70" }],
  ["path", { d: "M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3", key: "1jsf9p" }],
  ["path", { d: "M12 12V8", key: "2874zd" }]
], tR = mt("network", vq);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const xq = [
  [
    "path",
    {
      d: "M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",
      key: "e79jfc"
    }
  ],
  ["circle", { cx: "13.5", cy: "6.5", r: ".5", fill: "currentColor", key: "1okk4w" }],
  ["circle", { cx: "17.5", cy: "10.5", r: ".5", fill: "currentColor", key: "f64h9f" }],
  ["circle", { cx: "6.5", cy: "12.5", r: ".5", fill: "currentColor", key: "qy21gx" }],
  ["circle", { cx: "8.5", cy: "7.5", r: ".5", fill: "currentColor", key: "fotxhn" }]
], Mk = mt("palette", xq);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const bq = [
  ["rect", { x: "14", y: "3", width: "5", height: "18", rx: "1", key: "kaeet6" }],
  ["rect", { x: "5", y: "3", width: "5", height: "18", rx: "1", key: "1wsw3u" }]
], nR = mt("pause", bq);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const wq = [
  [
    "path",
    {
      d: "M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",
      key: "1a8usu"
    }
  ]
], _q = mt("pen", wq);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Sq = [
  [
    "path",
    {
      d: "M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",
      key: "10ikf1"
    }
  ]
], s0 = mt("play", Sq);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Cq = [
  ["path", { d: "M5 12h14", key: "1ays0h" }],
  ["path", { d: "M12 5v14", key: "s699le" }]
], SC = mt("plus", Cq);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Eq = [
  ["path", { d: "M12 2v10", key: "mnfbl" }],
  ["path", { d: "M18.4 6.6a9 9 0 1 1-12.77.04", key: "obofu9" }]
], Qv = mt("power", Eq);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const kq = [
  ["path", { d: "M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8", key: "v9h5vc" }],
  ["path", { d: "M21 3v5h-5", key: "1q7to0" }],
  ["path", { d: "M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16", key: "3uifl3" }],
  ["path", { d: "M8 16H3v5", key: "1cv678" }]
], zr = mt("refresh-cw", kq);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Tq = [
  ["path", { d: "M17 3v10", key: "15fgeh" }],
  ["path", { d: "m12.67 5.5 8.66 5", key: "1gpheq" }],
  ["path", { d: "m12.67 10.5 8.66-5", key: "1dkfa6" }],
  [
    "path",
    { d: "M9 17a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h2a2 2 0 0 0 2-2v-2z", key: "swwfx4" }
  ]
], rR = mt("regex", Tq);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Nq = [
  ["path", { d: "M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8", key: "1357e3" }],
  ["path", { d: "M3 3v5h5", key: "1xhq8a" }]
], iR = mt("rotate-ccw", Nq);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Aq = [
  [
    "path",
    {
      d: "M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",
      key: "1c8476"
    }
  ],
  ["path", { d: "M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7", key: "1ydtos" }],
  ["path", { d: "M7 3v4a1 1 0 0 0 1 1h7", key: "t51u73" }]
], Lg = mt("save", Aq);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const jq = [
  ["circle", { cx: "6", cy: "6", r: "3", key: "1lh9wr" }],
  ["path", { d: "M8.12 8.12 12 12", key: "1alkpv" }],
  ["path", { d: "M20 4 8.12 15.88", key: "xgtan2" }],
  ["circle", { cx: "6", cy: "18", r: "3", key: "fqmcym" }],
  ["path", { d: "M14.8 14.8 20 20", key: "ptml3r" }]
], Mq = mt("scissors", jq);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Rq = [
  ["path", { d: "M15 12h-5", key: "r7krc0" }],
  ["path", { d: "M15 8h-5", key: "1khuty" }],
  ["path", { d: "M19 17V5a2 2 0 0 0-2-2H4", key: "zz82l3" }],
  [
    "path",
    {
      d: "M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",
      key: "1ph1d7"
    }
  ]
], Oq = mt("scroll-text", Rq);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Dq = [
  ["path", { d: "m21 21-4.34-4.34", key: "14j7rj" }],
  ["circle", { cx: "11", cy: "11", r: "8", key: "4ej97u" }]
], Ls = mt("search", Dq);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Iq = [
  [
    "path",
    {
      d: "M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",
      key: "1ffxy3"
    }
  ],
  ["path", { d: "m21.854 2.147-10.94 10.939", key: "12cjpa" }]
], Pq = mt("send", Iq);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const zq = [
  ["rect", { width: "20", height: "8", x: "2", y: "2", rx: "2", ry: "2", key: "ngkwjq" }],
  ["rect", { width: "20", height: "8", x: "2", y: "14", rx: "2", ry: "2", key: "iecqi9" }],
  ["line", { x1: "6", x2: "6.01", y1: "6", y2: "6", key: "16zg32" }],
  ["line", { x1: "6", x2: "6.01", y1: "18", y2: "18", key: "nzw8ys" }]
], Lq = mt("server", zq);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Bq = [
  [
    "path",
    {
      d: "M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",
      key: "1i5ecw"
    }
  ],
  ["circle", { cx: "12", cy: "12", r: "3", key: "1v7zrd" }]
], vv = mt("settings", Bq);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const qq = [
  ["path", { d: "M10 8h4", key: "1sr2af" }],
  ["path", { d: "M12 21v-9", key: "17s77i" }],
  ["path", { d: "M12 8V3", key: "13r4qs" }],
  ["path", { d: "M17 16h4", key: "h1uq16" }],
  ["path", { d: "M19 12V3", key: "o1uvq1" }],
  ["path", { d: "M19 21v-5", key: "qua636" }],
  ["path", { d: "M3 14h4", key: "bcjad9" }],
  ["path", { d: "M5 10V3", key: "cb8scm" }],
  ["path", { d: "M5 21v-7", key: "1w1uti" }]
], Rk = mt("sliders-vertical", qq);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Fq = [
  [
    "path",
    {
      d: "M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",
      key: "1s2grr"
    }
  ],
  ["path", { d: "M20 2v4", key: "1rf3ol" }],
  ["path", { d: "M22 4h-4", key: "gwowj6" }],
  ["circle", { cx: "4", cy: "20", r: "2", key: "6kqj1y" }]
], aR = mt("sparkles", Fq);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Uq = [
  ["rect", { width: "18", height: "18", x: "3", y: "3", rx: "2", key: "afitv7" }]
], sR = mt("square", Uq);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const $q = [
  ["circle", { cx: "12", cy: "12", r: "4", key: "4exip2" }],
  ["path", { d: "M12 2v2", key: "tus03m" }],
  ["path", { d: "M12 20v2", key: "1lh1kg" }],
  ["path", { d: "m4.93 4.93 1.41 1.41", key: "149t6j" }],
  ["path", { d: "m17.66 17.66 1.41 1.41", key: "ptbguv" }],
  ["path", { d: "M2 12h2", key: "1t8f8n" }],
  ["path", { d: "M20 12h2", key: "1q8mjw" }],
  ["path", { d: "m6.34 17.66-1.41 1.41", key: "1m8zz5" }],
  ["path", { d: "m19.07 4.93-1.41 1.41", key: "1shlcs" }]
], Vq = mt("sun", $q);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Hq = [
  ["circle", { cx: "12", cy: "12", r: "10", key: "1mglay" }],
  ["circle", { cx: "12", cy: "12", r: "6", key: "1vlfrh" }],
  ["circle", { cx: "12", cy: "12", r: "2", key: "1c9p78" }]
], CC = mt("target", Hq);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Gq = [
  ["path", { d: "M12 19h8", key: "baeox8" }],
  ["path", { d: "m4 17 6-6-6-6", key: "1yngyt" }]
], Zv = mt("terminal", Gq);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Kq = [
  ["path", { d: "M10 11v6", key: "nco0om" }],
  ["path", { d: "M14 11v6", key: "outv1u" }],
  ["path", { d: "M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6", key: "miytrc" }],
  ["path", { d: "M3 6h18", key: "d0wm0j" }],
  ["path", { d: "M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2", key: "e791ji" }]
], jo = mt("trash-2", Kq);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Yq = [
  [
    "path",
    {
      d: "m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",
      key: "wmoenq"
    }
  ],
  ["path", { d: "M12 9v4", key: "juzpu7" }],
  ["path", { d: "M12 17h.01", key: "p32p05" }]
], oR = mt("triangle-alert", Yq);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Wq = [
  ["path", { d: "M12 3v12", key: "1x0j5s" }],
  ["path", { d: "m17 8-5-5-5 5", key: "7q97r8" }],
  ["path", { d: "M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4", key: "ih7n3h" }]
], lR = mt("upload", Wq);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Xq = [
  [
    "path",
    {
      d: "m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",
      key: "ul74o6"
    }
  ],
  ["path", { d: "m14 7 3 3", key: "1r5n42" }],
  ["path", { d: "M5 6v4", key: "ilb8ba" }],
  ["path", { d: "M19 14v4", key: "blhpug" }],
  ["path", { d: "M10 2v2", key: "7u0qdc" }],
  ["path", { d: "M7 8H3", key: "zfb6yr" }],
  ["path", { d: "M21 16h-4", key: "1cnmox" }],
  ["path", { d: "M11 3H9", key: "1obp7u" }]
], uR = mt("wand-sparkles", Xq);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Qq = [
  ["path", { d: "M18 6 6 18", key: "1bl5f8" }],
  ["path", { d: "m6 6 12 12", key: "d8bk6v" }]
], Lm = mt("x", Qq);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Zq = [
  [
    "path",
    {
      d: "M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",
      key: "1xq2db"
    }
  ]
], Ld = mt("zap", Zq);
var cR = YM();
const EC = /* @__PURE__ */ Uc(cR);
class Jq {
  constructor() {
    vt(this, "adapters", []);
  }
  registerAdapter(t) {
    this.adapters.push(t);
  }
  async search(t) {
    return t.trim() ? (await Promise.all(this.adapters.map((r) => r.search(t)))).flat().sort((r, i) => (i.score || 0) - (r.score || 0)) : [];
  }
}
const cm = new Jq(), eF = [
  // Sub-view Navigation (Deep Links)
  // These are NOT in the main sidebar, so we keep them here.
  {
    id: "nav-prompt",
    icon: vv,
    label: "",
    description: " Prompt ",
    action: (e) => e("presets:prompt"),
    keywords: ["prompt", "template", "", ""],
    type: "navigation"
  },
  {
    id: "nav-regex",
    icon: vv,
    label: "",
    description: " Regex ",
    action: (e) => e("presets:regex"),
    keywords: ["regex", "rule", "", ""],
    type: "navigation"
  },
  {
    id: "nav-worldbook",
    icon: JB,
    label: "",
    description: " World Info  Lorebook",
    action: (e) => e("presets:worldbook"),
    keywords: ["world", "book", "lore", ""],
    type: "navigation"
  }
], xv = [
  { id: "dashboard", icon: aq, label: "", path: "/dashboard" },
  { id: "memory", icon: uq, label: "", path: "/memory" },
  { id: "processing", icon: wC, label: "", path: "/processing" },
  { id: "presets", icon: Xv, label: "API ", path: "/presets" },
  { id: "devlog", icon: Zv, label: "", path: "/devlog" },
  { id: "settings", icon: vv, label: "", path: "/settings" }
], tF = {}, Ok = (e) => {
  let t;
  const n = /* @__PURE__ */ new Set(), r = (m, p) => {
    const x = typeof m == "function" ? m(t) : m;
    if (!Object.is(x, t)) {
      const b = t;
      t = p ?? (typeof x != "object" || x === null) ? x : Object.assign({}, t, x), n.forEach((S) => S(t, b));
    }
  }, i = () => t, c = { setState: r, getState: i, getInitialState: () => d, subscribe: (m) => (n.add(m), () => n.delete(m)), destroy: () => {
    (tF ? "production" : void 0) !== "production" && console.warn(
      "[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."
    ), n.clear();
  } }, d = t = e(r, i, c);
  return c;
}, fR = (e) => e ? Ok(e) : Ok;
var Pb = { exports: {} }, zb = {}, Lb = { exports: {} }, Bb = {};
/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var Dk;
function nF() {
  if (Dk) return Bb;
  Dk = 1;
  var e = T0();
  function t(p, x) {
    return p === x && (p !== 0 || 1 / p === 1 / x) || p !== p && x !== x;
  }
  var n = typeof Object.is == "function" ? Object.is : t, r = e.useState, i = e.useEffect, s = e.useLayoutEffect, o = e.useDebugValue;
  function u(p, x) {
    var b = x(), S = r({ inst: { value: b, getSnapshot: x } }), k = S[0].inst, A = S[1];
    return s(
      function() {
        k.value = b, k.getSnapshot = x, c(k) && A({ inst: k });
      },
      [p, b, x]
    ), i(
      function() {
        return c(k) && A({ inst: k }), p(function() {
          c(k) && A({ inst: k });
        });
      },
      [p]
    ), o(b), b;
  }
  function c(p) {
    var x = p.getSnapshot;
    p = p.value;
    try {
      var b = x();
      return !n(p, b);
    } catch {
      return !0;
    }
  }
  function d(p, x) {
    return x();
  }
  var m = typeof window > "u" || typeof window.document > "u" || typeof window.document.createElement > "u" ? d : u;
  return Bb.useSyncExternalStore = e.useSyncExternalStore !== void 0 ? e.useSyncExternalStore : m, Bb;
}
var Ik;
function rF() {
  return Ik || (Ik = 1, Lb.exports = nF()), Lb.exports;
}
/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var Pk;
function iF() {
  if (Pk) return zb;
  Pk = 1;
  var e = T0(), t = rF();
  function n(d, m) {
    return d === m && (d !== 0 || 1 / d === 1 / m) || d !== d && m !== m;
  }
  var r = typeof Object.is == "function" ? Object.is : n, i = t.useSyncExternalStore, s = e.useRef, o = e.useEffect, u = e.useMemo, c = e.useDebugValue;
  return zb.useSyncExternalStoreWithSelector = function(d, m, p, x, b) {
    var S = s(null);
    if (S.current === null) {
      var k = { hasValue: !1, value: null };
      S.current = k;
    } else k = S.current;
    S = u(
      function() {
        function T(I) {
          if (!M) {
            if (M = !0, j = I, I = x(I), b !== void 0 && k.hasValue) {
              var L = k.value;
              if (b(L, I))
                return D = L;
            }
            return D = I;
          }
          if (L = D, r(j, I)) return L;
          var K = x(I);
          return b !== void 0 && b(L, K) ? (j = I, L) : (j = I, D = K);
        }
        var M = !1, j, D, z = p === void 0 ? null : p;
        return [
          function() {
            return T(m());
          },
          z === null ? void 0 : function() {
            return T(z());
          }
        ];
      },
      [m, p, x, b]
    );
    var A = i(d, S[0], S[1]);
    return o(
      function() {
        k.hasValue = !0, k.value = A;
      },
      [A]
    ), c(A), A;
  }, zb;
}
var zk;
function aF() {
  return zk || (zk = 1, Pb.exports = iF()), Pb.exports;
}
var sF = aF();
const dR = /* @__PURE__ */ Uc(sF), hR = {}, { useDebugValue: oF } = yC, { useSyncExternalStoreWithSelector: lF } = dR;
let Lk = !1;
const uF = (e) => e;
function cF(e, t = uF, n) {
  (hR ? "production" : void 0) !== "production" && n && !Lk && (console.warn(
    "[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"
  ), Lk = !0);
  const r = lF(
    e.subscribe,
    e.getState,
    e.getServerState || e.getInitialState,
    t,
    n
  );
  return oF(r), r;
}
const Bk = (e) => {
  (hR ? "production" : void 0) !== "production" && typeof e != "function" && console.warn(
    "[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`."
  );
  const t = typeof e == "function" ? fR(e) : e, n = (r, i) => cF(t, r, i);
  return Object.assign(n, t), n;
}, mR = (e) => e ? Bk(e) : Bk, fF = {
  name: "Paper (Light)",
  colors: {
    background: "oklch(1.0000 0 0)",
    foreground: "oklch(0.1884 0.0128 248.5103)",
    card: "oklch(0.9784 0.0011 197.1387)",
    cardForeground: "oklch(0.1884 0.0128 248.5103)",
    popover: "oklch(1.0000 0 0)",
    popoverForeground: "oklch(0.1884 0.0128 248.5103)",
    primary: "oklch(0.6723 0.1606 244.9955)",
    primaryForeground: "oklch(1.0000 0 0)",
    secondary: "oklch(0.1884 0.0128 248.5103)",
    secondaryForeground: "oklch(1.0000 0 0)",
    muted: "oklch(0.9222 0.0013 286.3737)",
    mutedForeground: "oklch(0.1884 0.0128 248.5103)",
    accent: "oklch(0.9392 0.0166 250.8453)",
    accentForeground: "oklch(0.6723 0.1606 244.9955)",
    destructive: "oklch(0.6188 0.2376 25.7658)",
    destructiveForeground: "oklch(1.0000 0 0)",
    border: "oklch(0.1884 0.0128 248.5103 / 0.15)",
    // Darker (Foreground based) as requested
    input: "oklch(0.9809 0.0025 228.7836)",
    ring: "oklch(0.6818 0.1584 243.3540)",
    chart1: "oklch(0.6723 0.1606 244.9955)",
    chart2: "oklch(0.6907 0.1554 160.3454)",
    chart3: "oklch(0.8214 0.1600 82.5337)",
    chart4: "oklch(0.7064 0.1822 151.7125)",
    chart5: "oklch(0.5919 0.2186 10.5826)",
    sidebar: "oklch(0.9784 0.0011 197.1387)",
    sidebarForeground: "oklch(0.1884 0.0128 248.5103)",
    sidebarPrimary: "oklch(0.6723 0.1606 244.9955)",
    sidebarPrimaryForeground: "oklch(1.0000 0 0)",
    sidebarAccent: "oklch(0.9392 0.0166 250.8453)",
    sidebarAccentForeground: "oklch(0.6723 0.1606 244.9955)",
    sidebarBorder: "oklch(0.1884 0.0128 248.5103 / 0.1)",
    // Darker (Foreground based)
    sidebarRing: "oklch(0.6818 0.1584 243.3540)"
  },
  variables: {
    radius: "1.3rem"
  }
}, dF = {
  name: "Claude (Dark)",
  colors: {
    background: "oklch(0.2679 0.0036 106.6427)",
    foreground: "oklch(0.8074 0.0142 93.0137)",
    card: "oklch(0.2679 0.0036 106.6427)",
    cardForeground: "oklch(0.8074 0.0142 93.0137)",
    popover: "oklch(0.2357 0.0024 67.7077)",
    popoverForeground: "oklch(0.8074 0.0142 93.0137)",
    primary: "oklch(0.6724 0.1308 38.7559)",
    primaryForeground: "oklch(1.0000 0 0)",
    secondary: "oklch(0.2213 0.0038 106.7070)",
    secondaryForeground: "oklch(0.8074 0.0142 93.0137)",
    muted: "oklch(0.2357 0.0024 67.7077)",
    mutedForeground: "oklch(0.7713 0.0169 99.0657)",
    accent: "oklch(0.6724 0.1308 38.7559)",
    accentForeground: "oklch(1.0000 0 0)",
    destructive: "oklch(0.6368 0.2078 25.3313)",
    destructiveForeground: "oklch(1.0000 0 0)",
    border: "oklch(0.8074 0.0142 93.0137 / 0.15)",
    // Foreground / 0.15
    input: "oklch(0.4336 0.0113 100.2195)",
    ring: "oklch(0.6724 0.1308 38.7559)",
    chart1: "oklch(0.6724 0.1308 38.7559)",
    chart2: "oklch(0.6898 0.1581 290.4107)",
    chart3: "oklch(0.8816 0.0276 93.1280)",
    chart4: "oklch(0.3074 0.0516 289.3230)",
    chart5: "oklch(0.6368 0.2078 25.3313)",
    sidebar: "oklch(0.2357 0.0024 67.7077)",
    sidebarForeground: "oklch(0.7713 0.0169 99.0657)",
    sidebarPrimary: "oklch(0.6724 0.1308 38.7559)",
    sidebarPrimaryForeground: "oklch(1.0000 0 0)",
    sidebarAccent: "oklch(0.2213 0.0038 106.7070)",
    sidebarAccentForeground: "oklch(0.8074 0.0142 93.0137)",
    sidebarBorder: "oklch(0.7713 0.0169 99.0657 / 0.15)",
    // SidebarForeground / 0.15
    sidebarRing: "oklch(0.6724 0.1308 38.7559)"
  },
  variables: {
    radius: "0.4rem"
  }
}, hF = {
  name: "Twitter (Dark)",
  colors: {
    background: "oklch(0 0 0)",
    foreground: "oklch(0.9328 0.0025 228.7857)",
    card: "oklch(0 0 0)",
    // Matching background for seamless look, or slightly lighter
    cardForeground: "oklch(0.9328 0.0025 228.7857)",
    popover: "oklch(0 0 0)",
    popoverForeground: "oklch(0.9328 0.0025 228.7857)",
    primary: "oklch(0.6692 0.1607 245.0110)",
    primaryForeground: "oklch(1.0000 0 0)",
    secondary: "oklch(0.2097 0.0080 274.5332)",
    // Using card color from ref as secondary
    secondaryForeground: "oklch(0.8853 0 0)",
    muted: "oklch(0.2090 0 0)",
    mutedForeground: "oklch(0.5637 0.0078 247.9662)",
    accent: "oklch(0.1928 0.0331 242.5459)",
    accentForeground: "oklch(0.6692 0.1607 245.0110)",
    destructive: "oklch(0.6188 0.2376 25.7658)",
    destructiveForeground: "oklch(1.0000 0 0)",
    border: "oklch(0.9328 0.0025 228.7857 / 0.15)",
    // Foreground / 0.15
    input: "oklch(0.3020 0.0288 244.8244)",
    ring: "oklch(0.6818 0.1584 243.3540)",
    chart1: "oklch(0.6723 0.1606 244.9955)",
    chart2: "oklch(0.6907 0.1554 160.3454)",
    chart3: "oklch(0.8214 0.1600 82.5337)",
    chart4: "oklch(0.7064 0.1822 151.7125)",
    chart5: "oklch(0.5919 0.2186 10.5826)",
    sidebar: "oklch(0 0 0)",
    sidebarForeground: "oklch(0.9328 0.0025 228.7857)",
    sidebarPrimary: "oklch(0.6692 0.1607 245.0110)",
    sidebarPrimaryForeground: "oklch(1.0000 0 0)",
    sidebarAccent: "oklch(0.1928 0.0331 242.5459)",
    sidebarAccentForeground: "oklch(0.6692 0.1607 245.0110)",
    sidebarBorder: "oklch(0.9328 0.0025 228.7857 / 0.15)",
    // SidebarForeground / 0.15
    sidebarRing: "oklch(0.6818 0.1584 243.3540)"
  },
  variables: {
    radius: "1.3rem"
  }
}, mF = {
  name: "Discord (Dark)",
  colors: {
    background: "#313338",
    foreground: "#f2f3f5",
    card: "#2b2d31",
    cardForeground: "#f2f3f5",
    popover: "#313338",
    popoverForeground: "#f2f3f5",
    primary: "#5865f2",
    primaryForeground: "#ffffff",
    secondary: "#2b2d31",
    secondaryForeground: "#f2f3f5",
    muted: "#1e1f22",
    mutedForeground: "#949ba4",
    accent: "#3f4147",
    accentForeground: "#f2f3f5",
    destructive: "#fa777c",
    destructiveForeground: "#313338",
    border: "#f2f3f526",
    // Foreground #f2f3f5 with ~15% alpha
    input: "#1e1f22",
    ring: "#5865f2",
    chart1: "#5865f2",
    chart2: "#23a559",
    chart3: "#f0b232",
    chart4: "#00a8fc",
    chart5: "#eb459e",
    sidebar: "#1e1f22",
    sidebarForeground: "#949ba4",
    sidebarPrimary: "#5865f2",
    sidebarPrimaryForeground: "#ffffff",
    sidebarAccent: "#3f4147",
    sidebarAccentForeground: "#f2f3f5",
    sidebarBorder: "#949ba426",
    // SidebarForeground #949ba4 with ~15% alpha
    sidebarRing: "#5865f2"
  },
  variables: {
    radius: "0.25rem"
  }
}, pF = {
  name: "Catppuccin Mocha",
  colors: {
    background: "#1e1e2e",
    // foreground: '#cdd6f4', // Old Text
    foreground: "#cba6f7",
    // Modified: Mauve as requested
    card: "#313244",
    cardForeground: "#cba6f7",
    // Also match text
    popover: "#1e1e2e",
    popoverForeground: "#cba6f7",
    primary: "#89b4fa",
    primaryForeground: "#1e1e2e",
    secondary: "#45475a",
    secondaryForeground: "#cba6f7",
    muted: "#313244",
    mutedForeground: "#a6adc8",
    accent: "#45475a",
    accentForeground: "#cba6f7",
    destructive: "#f38ba8",
    destructiveForeground: "#1e1e2e",
    border: "#cba6f726",
    // Mauve with ~15% alpha
    input: "#313244",
    ring: "#89b4fa",
    chart1: "#89b4fa",
    chart2: "#a6e3a1",
    chart3: "#f9e2af",
    chart4: "#fab387",
    chart5: "#cba6f7",
    sidebar: "#181825",
    sidebarForeground: "#cba6f7",
    // Mauve
    sidebarPrimary: "#89b4fa",
    sidebarPrimaryForeground: "#1e1e2e",
    sidebarAccent: "#313244",
    sidebarAccentForeground: "#cba6f7",
    sidebarBorder: "#cba6f726",
    // Mauve with ~15% alpha
    sidebarRing: "#89b4fa"
  },
  variables: {
    radius: "0.5rem"
  }
}, gF = {
  name: "SillyTavern ()",
  colors: {
    background: "var(--SmartThemeBlurTintColor)",
    foreground: "var(--SmartThemeBodyColor)",
    card: "var(--SmartThemeBlurTintColor)",
    cardForeground: "var(--SmartThemeBodyColor)",
    popover: "var(--SmartThemeBlurTintColor)",
    popoverForeground: "var(--SmartThemeBodyColor)",
    primary: "var(--SmartThemeQuoteColor)",
    primaryForeground: "var(--SmartThemeBodyColor)",
    secondary: "var(--SmartThemeBorderColor)",
    secondaryForeground: "var(--SmartThemeBodyColor)",
    muted: "rgba(0,0,0,0.2)",
    mutedForeground: "rgba(255,255,255,0.5)",
    accent: "var(--SmartThemeQuoteColor)",
    accentForeground: "var(--SmartThemeBodyColor)",
    destructive: "var(--SmartThemeBorderColor)",
    destructiveForeground: "var(--SmartThemeBodyColor)",
    border: "var(--SmartThemeBorderColor)",
    input: "var(--SmartThemeBorderColor)",
    ring: "var(--SmartThemeQuoteColor)",
    chart1: "var(--SmartThemeQuoteColor)",
    chart2: "var(--SmartThemeQuoteColor)",
    chart3: "var(--SmartThemeQuoteColor)",
    chart4: "var(--SmartThemeQuoteColor)",
    chart5: "var(--SmartThemeQuoteColor)",
    sidebar: "var(--SmartThemeBlurTintColor)",
    sidebarForeground: "var(--SmartThemeBodyColor)",
    sidebarPrimary: "var(--SmartThemeQuoteColor)",
    sidebarPrimaryForeground: "var(--SmartThemeBodyColor)",
    sidebarAccent: "var(--SmartThemeBorderColor)",
    sidebarAccentForeground: "var(--SmartThemeBodyColor)",
    sidebarBorder: "var(--SmartThemeBorderColor)",
    sidebarRing: "var(--SmartThemeQuoteColor)"
  },
  variables: {
    radius: "0.4rem"
  }
}, yF = {
  name: "Glass (Frosted)",
  colors: {
    // 
    background: "rgba(255, 255, 255, var(--glass-opacity, 0.1))",
    foreground: "#0f172a",
    //  (Slate-900) 
    //  - 
    card: "rgba(255, 255, 255, var(--glass-opacity, 0.25))",
    cardForeground: "#0f172a",
    popover: "rgba(255, 255, 255, var(--glass-opacity, 0.4))",
    popoverForeground: "#0f172a",
    primary: "rgba(15, 23, 42, 0.8)",
    // 
    primaryForeground: "#ffffff",
    secondary: "rgba(255, 255, 255, 0.3)",
    secondaryForeground: "#0f172a",
    muted: "rgba(255, 255, 255, 0.3)",
    mutedForeground: "rgba(15, 23, 42, 0.6)",
    accent: "rgba(255, 255, 255, 0.4)",
    accentForeground: "#0f172a",
    destructive: "rgba(239, 68, 68, 0.8)",
    destructiveForeground: "#ffffff",
    border: "rgba(15, 23, 42, 0.15)",
    // Lighter base (will be resistant to fade)
    input: "rgba(255, 255, 255, 0.4)",
    ring: "rgba(15, 23, 42, 0.4)",
    chart1: "#0f172a",
    chart2: "rgba(15, 23, 42, 0.8)",
    chart3: "rgba(15, 23, 42, 0.6)",
    chart4: "rgba(15, 23, 42, 0.4)",
    chart5: "rgba(15, 23, 42, 0.2)",
    sidebar: "rgba(255, 255, 255, var(--glass-opacity, 0.15))",
    sidebarForeground: "#0f172a",
    sidebarPrimary: "rgba(15, 23, 42, 0.8)",
    sidebarPrimaryForeground: "#ffffff",
    sidebarAccent: "rgba(255, 255, 255, 0.3)",
    sidebarAccentForeground: "#0f172a",
    sidebarBorder: "rgba(15, 23, 42, 0.1)",
    // Lighter base
    sidebarRing: "rgba(15, 23, 42, 0.4)"
  },
  variables: {
    radius: "1rem"
  }
}, ev = {
  sillytavern: gF,
  // SillyTavern 
  paperLight: fF,
  twitterDark: hF,
  claudeDark: dF,
  catppuccin: pF,
  discord: mF,
  glass: yF
}, yi = [];
for (let e = 0; e < 256; ++e)
  yi.push((e + 256).toString(16).slice(1));
function vF(e, t = 0) {
  return (yi[e[t + 0]] + yi[e[t + 1]] + yi[e[t + 2]] + yi[e[t + 3]] + "-" + yi[e[t + 4]] + yi[e[t + 5]] + "-" + yi[e[t + 6]] + yi[e[t + 7]] + "-" + yi[e[t + 8]] + yi[e[t + 9]] + "-" + yi[e[t + 10]] + yi[e[t + 11]] + yi[e[t + 12]] + yi[e[t + 13]] + yi[e[t + 14]] + yi[e[t + 15]]).toLowerCase();
}
let qb;
const xF = new Uint8Array(16);
function bF() {
  if (!qb) {
    if (typeof crypto > "u" || !crypto.getRandomValues)
      throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");
    qb = crypto.getRandomValues.bind(crypto);
  }
  return qb(xF);
}
const wF = typeof crypto < "u" && crypto.randomUUID && crypto.randomUUID.bind(crypto), qk = { randomUUID: wF };
function _F(e, t, n) {
  var i;
  e = e || {};
  const r = e.random ?? ((i = e.rng) == null ? void 0 : i.call(e)) ?? bF();
  if (r.length < 16)
    throw new Error("Random bytes length must be >= 16");
  return r[6] = r[6] & 15 | 64, r[8] = r[8] & 63 | 128, vF(r);
}
function fm(e, t, n) {
  return qk.randomUUID && !e ? qk.randomUUID() : _F(e);
}
var r5 = function(e, t) {
  return r5 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(n, r) {
    n.__proto__ = r;
  } || function(n, r) {
    for (var i in r) Object.prototype.hasOwnProperty.call(r, i) && (n[i] = r[i]);
  }, r5(e, t);
};
function N0(e, t) {
  if (typeof t != "function" && t !== null)
    throw new TypeError("Class extends value " + String(t) + " is not a constructor or null");
  r5(e, t);
  function n() {
    this.constructor = e;
  }
  e.prototype = t === null ? Object.create(t) : (n.prototype = t.prototype, new n());
}
function i5(e) {
  var t = typeof Symbol == "function" && Symbol.iterator, n = t && e[t], r = 0;
  if (n) return n.call(e);
  if (e && typeof e.length == "number") return {
    next: function() {
      return e && r >= e.length && (e = void 0), { value: e && e[r++], done: !e };
    }
  };
  throw new TypeError(t ? "Object is not iterable." : "Symbol.iterator is not defined.");
}
function a5(e, t) {
  var n = typeof Symbol == "function" && e[Symbol.iterator];
  if (!n) return e;
  var r = n.call(e), i, s = [], o;
  try {
    for (; (t === void 0 || t-- > 0) && !(i = r.next()).done; ) s.push(i.value);
  } catch (u) {
    o = { error: u };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (o) throw o.error;
    }
  }
  return s;
}
function s5(e, t, n) {
  if (n || arguments.length === 2) for (var r = 0, i = t.length, s; r < i; r++)
    (s || !(r in t)) && (s || (s = Array.prototype.slice.call(t, 0, r)), s[r] = t[r]);
  return e.concat(s || Array.prototype.slice.call(t));
}
function Nl(e) {
  return typeof e == "function";
}
function pR(e) {
  var t = function(r) {
    Error.call(r), r.stack = new Error().stack;
  }, n = e(t);
  return n.prototype = Object.create(Error.prototype), n.prototype.constructor = n, n;
}
var Fb = pR(function(e) {
  return function(n) {
    e(this), this.message = n ? n.length + ` errors occurred during unsubscription:
` + n.map(function(r, i) {
      return i + 1 + ") " + r.toString();
    }).join(`
  `) : "", this.name = "UnsubscriptionError", this.errors = n;
  };
});
function o5(e, t) {
  if (e) {
    var n = e.indexOf(t);
    0 <= n && e.splice(n, 1);
  }
}
var Jv = (function() {
  function e(t) {
    this.initialTeardown = t, this.closed = !1, this._parentage = null, this._finalizers = null;
  }
  return e.prototype.unsubscribe = function() {
    var t, n, r, i, s;
    if (!this.closed) {
      this.closed = !0;
      var o = this._parentage;
      if (o)
        if (this._parentage = null, Array.isArray(o))
          try {
            for (var u = i5(o), c = u.next(); !c.done; c = u.next()) {
              var d = c.value;
              d.remove(this);
            }
          } catch (k) {
            t = { error: k };
          } finally {
            try {
              c && !c.done && (n = u.return) && n.call(u);
            } finally {
              if (t) throw t.error;
            }
          }
        else
          o.remove(this);
      var m = this.initialTeardown;
      if (Nl(m))
        try {
          m();
        } catch (k) {
          s = k instanceof Fb ? k.errors : [k];
        }
      var p = this._finalizers;
      if (p) {
        this._finalizers = null;
        try {
          for (var x = i5(p), b = x.next(); !b.done; b = x.next()) {
            var S = b.value;
            try {
              Fk(S);
            } catch (k) {
              s = s ?? [], k instanceof Fb ? s = s5(s5([], a5(s)), a5(k.errors)) : s.push(k);
            }
          }
        } catch (k) {
          r = { error: k };
        } finally {
          try {
            b && !b.done && (i = x.return) && i.call(x);
          } finally {
            if (r) throw r.error;
          }
        }
      }
      if (s)
        throw new Fb(s);
    }
  }, e.prototype.add = function(t) {
    var n;
    if (t && t !== this)
      if (this.closed)
        Fk(t);
      else {
        if (t instanceof e) {
          if (t.closed || t._hasParent(this))
            return;
          t._addParent(this);
        }
        (this._finalizers = (n = this._finalizers) !== null && n !== void 0 ? n : []).push(t);
      }
  }, e.prototype._hasParent = function(t) {
    var n = this._parentage;
    return n === t || Array.isArray(n) && n.includes(t);
  }, e.prototype._addParent = function(t) {
    var n = this._parentage;
    this._parentage = Array.isArray(n) ? (n.push(t), n) : n ? [n, t] : t;
  }, e.prototype._removeParent = function(t) {
    var n = this._parentage;
    n === t ? this._parentage = null : Array.isArray(n) && o5(n, t);
  }, e.prototype.remove = function(t) {
    var n = this._finalizers;
    n && o5(n, t), t instanceof e && t._removeParent(this);
  }, e.EMPTY = (function() {
    var t = new e();
    return t.closed = !0, t;
  })(), e;
})(), gR = Jv.EMPTY;
function yR(e) {
  return e instanceof Jv || e && "closed" in e && Nl(e.remove) && Nl(e.add) && Nl(e.unsubscribe);
}
function Fk(e) {
  Nl(e) ? e() : e.unsubscribe();
}
var SF = {
  Promise: void 0
}, CF = {
  setTimeout: function(e, t) {
    for (var n = [], r = 2; r < arguments.length; r++)
      n[r - 2] = arguments[r];
    return setTimeout.apply(void 0, s5([e, t], a5(n)));
  },
  clearTimeout: function(e) {
    return clearTimeout(e);
  },
  delegate: void 0
};
function EF(e) {
  CF.setTimeout(function() {
    throw e;
  });
}
function Uk() {
}
function tv(e) {
  e();
}
var kC = (function(e) {
  N0(t, e);
  function t(n) {
    var r = e.call(this) || this;
    return r.isStopped = !1, n ? (r.destination = n, yR(n) && n.add(r)) : r.destination = NF, r;
  }
  return t.create = function(n, r, i) {
    return new l5(n, r, i);
  }, t.prototype.next = function(n) {
    this.isStopped || this._next(n);
  }, t.prototype.error = function(n) {
    this.isStopped || (this.isStopped = !0, this._error(n));
  }, t.prototype.complete = function() {
    this.isStopped || (this.isStopped = !0, this._complete());
  }, t.prototype.unsubscribe = function() {
    this.closed || (this.isStopped = !0, e.prototype.unsubscribe.call(this), this.destination = null);
  }, t.prototype._next = function(n) {
    this.destination.next(n);
  }, t.prototype._error = function(n) {
    try {
      this.destination.error(n);
    } finally {
      this.unsubscribe();
    }
  }, t.prototype._complete = function() {
    try {
      this.destination.complete();
    } finally {
      this.unsubscribe();
    }
  }, t;
})(Jv), kF = (function() {
  function e(t) {
    this.partialObserver = t;
  }
  return e.prototype.next = function(t) {
    var n = this.partialObserver;
    if (n.next)
      try {
        n.next(t);
      } catch (r) {
        O1(r);
      }
  }, e.prototype.error = function(t) {
    var n = this.partialObserver;
    if (n.error)
      try {
        n.error(t);
      } catch (r) {
        O1(r);
      }
    else
      O1(t);
  }, e.prototype.complete = function() {
    var t = this.partialObserver;
    if (t.complete)
      try {
        t.complete();
      } catch (n) {
        O1(n);
      }
  }, e;
})(), l5 = (function(e) {
  N0(t, e);
  function t(n, r, i) {
    var s = e.call(this) || this, o;
    return Nl(n) || !n ? o = {
      next: n ?? void 0,
      error: r ?? void 0,
      complete: i ?? void 0
    } : o = n, s.destination = new kF(o), s;
  }
  return t;
})(kC);
function O1(e) {
  EF(e);
}
function TF(e) {
  throw e;
}
var NF = {
  closed: !0,
  next: Uk,
  error: TF,
  complete: Uk
}, AF = (function() {
  return typeof Symbol == "function" && Symbol.observable || "@@observable";
})();
function jF(e) {
  return e;
}
function MF(e) {
  return e.length === 0 ? jF : e.length === 1 ? e[0] : function(n) {
    return e.reduce(function(r, i) {
      return i(r);
    }, n);
  };
}
var $k = (function() {
  function e(t) {
    t && (this._subscribe = t);
  }
  return e.prototype.lift = function(t) {
    var n = new e();
    return n.source = this, n.operator = t, n;
  }, e.prototype.subscribe = function(t, n, r) {
    var i = this, s = OF(t) ? t : new l5(t, n, r);
    return tv(function() {
      var o = i, u = o.operator, c = o.source;
      s.add(u ? u.call(s, c) : c ? i._subscribe(s) : i._trySubscribe(s));
    }), s;
  }, e.prototype._trySubscribe = function(t) {
    try {
      return this._subscribe(t);
    } catch (n) {
      t.error(n);
    }
  }, e.prototype.forEach = function(t, n) {
    var r = this;
    return n = Vk(n), new n(function(i, s) {
      var o = new l5({
        next: function(u) {
          try {
            t(u);
          } catch (c) {
            s(c), o.unsubscribe();
          }
        },
        error: s,
        complete: i
      });
      r.subscribe(o);
    });
  }, e.prototype._subscribe = function(t) {
    var n;
    return (n = this.source) === null || n === void 0 ? void 0 : n.subscribe(t);
  }, e.prototype[AF] = function() {
    return this;
  }, e.prototype.pipe = function() {
    for (var t = [], n = 0; n < arguments.length; n++)
      t[n] = arguments[n];
    return MF(t)(this);
  }, e.prototype.toPromise = function(t) {
    var n = this;
    return t = Vk(t), new t(function(r, i) {
      var s;
      n.subscribe(function(o) {
        return s = o;
      }, function(o) {
        return i(o);
      }, function() {
        return r(s);
      });
    });
  }, e.create = function(t) {
    return new e(t);
  }, e;
})();
function Vk(e) {
  var t;
  return (t = e ?? SF.Promise) !== null && t !== void 0 ? t : Promise;
}
function RF(e) {
  return e && Nl(e.next) && Nl(e.error) && Nl(e.complete);
}
function OF(e) {
  return e && e instanceof kC || RF(e) && yR(e);
}
function DF(e) {
  return Nl(e == null ? void 0 : e.lift);
}
function IF(e) {
  return function(t) {
    if (DF(t))
      return t.lift(function(n) {
        try {
          return e(n, this);
        } catch (r) {
          this.error(r);
        }
      });
    throw new TypeError("Unable to lift unknown Observable type");
  };
}
function PF(e, t, n, r, i) {
  return new zF(e, t, n, r, i);
}
var zF = (function(e) {
  N0(t, e);
  function t(n, r, i, s, o, u) {
    var c = e.call(this, n) || this;
    return c.onFinalize = o, c.shouldUnsubscribe = u, c._next = r ? function(d) {
      try {
        r(d);
      } catch (m) {
        n.error(m);
      }
    } : e.prototype._next, c._error = s ? function(d) {
      try {
        s(d);
      } catch (m) {
        n.error(m);
      } finally {
        this.unsubscribe();
      }
    } : e.prototype._error, c._complete = i ? function() {
      try {
        i();
      } catch (d) {
        n.error(d);
      } finally {
        this.unsubscribe();
      }
    } : e.prototype._complete, c;
  }
  return t.prototype.unsubscribe = function() {
    var n;
    if (!this.shouldUnsubscribe || this.shouldUnsubscribe()) {
      var r = this.closed;
      e.prototype.unsubscribe.call(this), !r && ((n = this.onFinalize) === null || n === void 0 || n.call(this));
    }
  }, t;
})(kC), LF = pR(function(e) {
  return function() {
    e(this), this.name = "ObjectUnsubscribedError", this.message = "object unsubscribed";
  };
}), TC = (function(e) {
  N0(t, e);
  function t() {
    var n = e.call(this) || this;
    return n.closed = !1, n.currentObservers = null, n.observers = [], n.isStopped = !1, n.hasError = !1, n.thrownError = null, n;
  }
  return t.prototype.lift = function(n) {
    var r = new Hk(this, this);
    return r.operator = n, r;
  }, t.prototype._throwIfClosed = function() {
    if (this.closed)
      throw new LF();
  }, t.prototype.next = function(n) {
    var r = this;
    tv(function() {
      var i, s;
      if (r._throwIfClosed(), !r.isStopped) {
        r.currentObservers || (r.currentObservers = Array.from(r.observers));
        try {
          for (var o = i5(r.currentObservers), u = o.next(); !u.done; u = o.next()) {
            var c = u.value;
            c.next(n);
          }
        } catch (d) {
          i = { error: d };
        } finally {
          try {
            u && !u.done && (s = o.return) && s.call(o);
          } finally {
            if (i) throw i.error;
          }
        }
      }
    });
  }, t.prototype.error = function(n) {
    var r = this;
    tv(function() {
      if (r._throwIfClosed(), !r.isStopped) {
        r.hasError = r.isStopped = !0, r.thrownError = n;
        for (var i = r.observers; i.length; )
          i.shift().error(n);
      }
    });
  }, t.prototype.complete = function() {
    var n = this;
    tv(function() {
      if (n._throwIfClosed(), !n.isStopped) {
        n.isStopped = !0;
        for (var r = n.observers; r.length; )
          r.shift().complete();
      }
    });
  }, t.prototype.unsubscribe = function() {
    this.isStopped = this.closed = !0, this.observers = this.currentObservers = null;
  }, Object.defineProperty(t.prototype, "observed", {
    get: function() {
      var n;
      return ((n = this.observers) === null || n === void 0 ? void 0 : n.length) > 0;
    },
    enumerable: !1,
    configurable: !0
  }), t.prototype._trySubscribe = function(n) {
    return this._throwIfClosed(), e.prototype._trySubscribe.call(this, n);
  }, t.prototype._subscribe = function(n) {
    return this._throwIfClosed(), this._checkFinalizedStatuses(n), this._innerSubscribe(n);
  }, t.prototype._innerSubscribe = function(n) {
    var r = this, i = this, s = i.hasError, o = i.isStopped, u = i.observers;
    return s || o ? gR : (this.currentObservers = null, u.push(n), new Jv(function() {
      r.currentObservers = null, o5(u, n);
    }));
  }, t.prototype._checkFinalizedStatuses = function(n) {
    var r = this, i = r.hasError, s = r.thrownError, o = r.isStopped;
    i ? n.error(s) : o && n.complete();
  }, t.prototype.asObservable = function() {
    var n = new $k();
    return n.source = this, n;
  }, t.create = function(n, r) {
    return new Hk(n, r);
  }, t;
})($k), Hk = (function(e) {
  N0(t, e);
  function t(n, r) {
    var i = e.call(this) || this;
    return i.destination = n, i.source = r, i;
  }
  return t.prototype.next = function(n) {
    var r, i;
    (i = (r = this.destination) === null || r === void 0 ? void 0 : r.next) === null || i === void 0 || i.call(r, n);
  }, t.prototype.error = function(n) {
    var r, i;
    (i = (r = this.destination) === null || r === void 0 ? void 0 : r.error) === null || i === void 0 || i.call(r, n);
  }, t.prototype.complete = function() {
    var n, r;
    (r = (n = this.destination) === null || n === void 0 ? void 0 : n.complete) === null || r === void 0 || r.call(n);
  }, t.prototype._subscribe = function(n) {
    var r, i;
    return (i = (r = this.source) === null || r === void 0 ? void 0 : r.subscribe(n)) !== null && i !== void 0 ? i : gR;
  }, t;
})(TC);
function BF(e, t) {
  return IF(function(n, r) {
    var i = 0;
    n.subscribe(PF(r, function(s) {
      return e.call(t, s, i++) && r.next(s);
    }));
  });
}
const D1 = new TC(), qF = {
  /**
   * 
   */
  emit(e) {
    D1.next({
      ...e,
      timestamp: Date.now()
    });
  },
  /**
   * 
   */
  subscribe(e) {
    const t = D1.subscribe(e);
    return {
      unsubscribe: () => t.unsubscribe()
    };
  },
  /**
   * 
   */
  on(e, t) {
    const n = D1.pipe(BF((r) => r.type === e)).subscribe((r) => t(r.payload));
    return {
      unsubscribe: () => n.unsubscribe()
    };
  },
  /**
   *  RxJS 
   */
  asObservable() {
    return D1.asObservable();
  }
};
var Yn = /* @__PURE__ */ ((e) => (e[e.DEBUG = 0] = "DEBUG", e[e.INFO = 1] = "INFO", e[e.SUCCESS = 2] = "SUCCESS", e[e.WARN = 3] = "WARN", e[e.ERROR = 4] = "ERROR", e))(Yn || {});
const bv = {
  0: { label: "DEBUG", icon: "", color: "#6c757d" },
  1: { label: "INFO", icon: "", color: "#17a2b8" },
  2: { label: "OK", icon: "", color: "#28a745" },
  3: { label: "WARN", icon: "", color: "#ffc107" },
  4: { label: "ERROR", icon: "", color: "#dc3545" }
}, vR = {
  maxEntries: 5e3,
  minLevel: 0
  /* DEBUG */
}, xR = new TC();
let gu = [], Yg = { ...vR };
function FF(e) {
  return new Date(e).toTimeString().slice(0, 8);
}
function dm(e, t, n, r) {
  if (e < Yg.minLevel) return;
  const i = {
    id: fm(),
    timestamp: Date.now(),
    level: e,
    module: t,
    message: n,
    data: r
  };
  gu.push(i), gu.length > Yg.maxEntries && (gu = gu.slice(-Yg.maxEntries)), xR.next(i);
}
function UF() {
  qF.subscribe((e) => {
    const n = {
      INGESTION_START: Yn.INFO,
      INGESTION_COMPLETE: Yn.SUCCESS,
      ENTITY_CREATED: Yn.INFO,
      MEMORY_STORED: Yn.SUCCESS,
      RETRIEVAL_START: Yn.DEBUG,
      RETRIEVAL_COMPLETE: Yn.SUCCESS,
      CHAT_CHANGED: Yn.INFO,
      MESSAGE_RECEIVED: Yn.DEBUG
    }[e.type] ?? Yn.DEBUG;
    dm(n, "EventBus", `${e.type}`, e.payload);
  });
}
const ve = {
  /**
   *  Logger
   */
  init(e) {
    e && (Yg = { ...Yg, ...e }), gu = [], UF(), ve.info("Logger", "Logger ");
  },
  /**
   * DEBUG 
   */
  debug(e, t, n) {
    dm(Yn.DEBUG, e, t, n);
  },
  /**
   * INFO 
   */
  info(e, t, n) {
    dm(Yn.INFO, e, t, n);
  },
  /**
   * SUCCESS 
   */
  success(e, t, n) {
    dm(Yn.SUCCESS, e, t, n);
  },
  /**
   * WARN 
   */
  warn(e, t, n) {
    dm(Yn.WARN, e, t, n);
  },
  /**
   * ERROR 
   */
  error(e, t, n) {
    dm(Yn.ERROR, e, t, n);
  },
  /**
   * 
   */
  getLogs() {
    return [...gu];
  },
  /**
   * 
   */
  subscribe(e) {
    const t = xR.subscribe(e);
    return () => t.unsubscribe();
  },
  /**
   * 
   */
  clear() {
    gu = [], ve.info("Logger", "");
  },
  /**
   *  Markdown 
   */
  exportToMarkdown() {
    const e = /* @__PURE__ */ new Date();
    e.toISOString().slice(0, 10), e.toTimeString().slice(0, 8).replace(/:/g, "");
    const t = {
      [Yn.DEBUG]: "DEBUG",
      [Yn.INFO]: "INFO",
      [Yn.SUCCESS]: "SUCCESS",
      [Yn.WARN]: "WARN",
      [Yn.ERROR]: "ERROR"
    };
    let n = `# Engram Debug Log

`;
    n += `- ****: ${e.toLocaleString("zh-CN")}
`, n += `- ****: 0.1.0
`, n += `- ****: ${gu.length}

`, n += `---

`, n += `## 

`, n += "```\n";
    for (const r of gu) {
      const i = FF(r.timestamp), s = t[r.level].padEnd(7), o = r.module.padEnd(16);
      if (n += `[${i}] [${o}] ${s} ${r.message}
`, r.data !== void 0) {
        const u = JSON.stringify(r.data, null, 2).split(`
`).map((c) => `    ${c}`).join(`
`);
        n += `${u}
`;
      }
    }
    return n += "```\n", n;
  },
  /**
   * 
   */
  getExportFilename() {
    const e = /* @__PURE__ */ new Date(), t = e.toISOString().slice(0, 10), n = e.toTimeString().slice(0, 8).replace(/:/g, "");
    return `engram_log_${t}_${n}.md`;
  }
}, Gk = 100;
class $F {
  constructor() {
    vt(this, "entries", []);
    vt(this, "listeners", /* @__PURE__ */ new Set());
  }
  /**
   * 
   */
  logSend(t) {
    const n = `log_${Date.now()}_${Math.random().toString(36).slice(2, 8)}`, r = {
      id: n,
      timestamp: Date.now(),
      type: t.type,
      direction: "sent",
      systemPrompt: t.systemPrompt,
      userPrompt: t.userPrompt,
      tokensSent: t.tokensSent,
      model: t.model,
      character: t.character,
      floorRange: t.floorRange,
      status: "pending"
    };
    return this.entries.unshift(r), this.trimEntries(), this.notifyListeners(), n;
  }
  /**
   * 
   */
  logReceive(t, n) {
    const r = this.entries.find((o) => o.id === t);
    if (!r) return;
    const i = {
      id: `${t}_recv`,
      timestamp: Date.now(),
      type: r.type,
      direction: "received",
      response: n.response,
      tokensReceived: n.tokensReceived,
      status: n.status,
      error: n.error,
      duration: n.duration,
      model: r.model,
      character: r.character,
      floorRange: r.floorRange
    };
    r.status = n.status, r.duration = n.duration;
    const s = this.entries.findIndex((o) => o.id === t);
    s >= 0 ? this.entries.splice(s, 0, i) : this.entries.unshift(i), this.trimEntries(), this.notifyListeners();
  }
  /**
   * 
   */
  async logCall(t, n) {
    const r = this.logSend(t), i = Date.now();
    try {
      const s = await n();
      return this.logReceive(r, {
        response: typeof s == "string" ? s : JSON.stringify(s),
        status: "success",
        duration: Date.now() - i
      }), s;
    } catch (s) {
      throw this.logReceive(r, {
        status: "error",
        error: s instanceof Error ? s.message : String(s),
        duration: Date.now() - i
      }), s;
    }
  }
  /**
   * 
   */
  getAll() {
    return [...this.entries];
  }
  /**
   * +
   */
  getPaired() {
    const t = [], n = this.entries.filter((r) => r.direction === "sent");
    for (const r of n) {
      const i = this.entries.find(
        (s) => s.id === `${r.id}_recv` && s.direction === "received"
      );
      t.push({ sent: r, received: i });
    }
    return t;
  }
  /**
   * 
   */
  clear() {
    this.entries = [], this.notifyListeners();
  }
  /**
   * 
   */
  subscribe(t) {
    return this.listeners.add(t), () => this.listeners.delete(t);
  }
  /**
   * 
   */
  getCount() {
    return this.entries.filter((t) => t.direction === "sent").length;
  }
  /**
   * 
   */
  trimEntries() {
    this.entries.length > Gk * 2 && (this.entries = this.entries.slice(0, Gk * 2));
  }
  /**
   * 
   */
  notifyListeners() {
    for (const t of this.listeners)
      t();
  }
}
const ua = new $F(), NC = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  DEFAULT_LOGGER_CONFIG: vR,
  LogLevel: Yn,
  LogLevelConfig: bv,
  Logger: ve,
  ModelLogger: ua
}, Symbol.toStringTag, { value: "Module" })), VF = `<system_configuration>
  <role_definition>
    : 
    : """"""
    
    :
      : 
      : 
      : 
      : 
    
    :
      - 
      -  YAML 
      - 
      - 
  </role_definition>

  <formatting_protocol>
    :  JSON 
    :
      - summary: //
      - meta:  (role, location, event, logic, causality)
      - significance_score: 0.0-1.0 
  </formatting_protocol>

  <logic_protocol>
    :
      : ""
      : """"
    
    :
      : 
      : 
        : "102344"
        : "1""3"""
      : 
        :  HH:MM (14:30)
        :  
        :   

     (Token):
      : 
      : 
       ():
        1: {{user}}
        2: {{user}}
        3: {{user}}...
       ():
        1: [ | {{user}}, , ] {{user}} ( | 0.7)

     ():
      -: "/"
        : {{user}}
        : {{user}}
      : ""
        : {{user}}...
        : {{user}}
      : 
        : {{user}}{{user}}...
        : {{user}}
      : """"
        : {{user}}
        : {{user}}

     ():
      _ (Foundation):
        : 0.1 - 0.4
        : >60%
        : """" 0.3-0.4 ()
      _ (Propulsion):
        : 0.5 - 0.7
        :  <30%
        : 
      _ (Keystone):
        : 0.8 - 0.9
        :  <10%
        : 
        : 
      _ (Turning Point):
        : 1.0
        : "" 1%
        : 
  </logic_protocol>

  <output_template>
    <think>
      :
        : \${}
        : \${}
      
      :
        : \${}
        : \${}
      
      :
        : \${}
        : \${}
      
      :
        : \${}
        : \${}
    </think>

    \`\`\`json
    {
      "events": [
        {
          "summary": "//",
          "meta": {
            "time_anchor": " 102344 ",
            "role": [""],
            "location": "",
            "event": "",
            "logic": [""],
            "causality": "Start|Chain|End"
          },
          "significance_score": 0.7
        }
      ]
    }
    \`\`\`
  </output_template>
  
  <example_demonstration>
    :
      "ABBA
      () AB""A""
      () A""A"""

    AI:
      <think>
        :
          : //
          : 
        
        :
          1: A (//) -> 
          2: B (//) -> 
          3:  +  -> 
          4:  +  -> 
      </think>

      \`\`\`json
      {
        "events": [
          {
            "summary": "ABBA",
            "meta": {
              "time_anchor": "102344 ",
              "role": ["A", "B"],
              "location": "",
              "event": "",
              "logic": ["", "", ""],
              "causality": "Start"
            },
            "significance_score": 0.8
          },
          {
            "summary": "ABA",
            "meta": {
              "role": ["A", "B", ""],
              "location": "",
              "event": "",
              "logic": ["", "", ""],
              "causality": "Chain"
            },
            "significance_score": 0.8
          },
          {
            "summary": "A",
            "meta": {
              "role": ["A", ""],
              "location": "",
              "event": "",
              "logic": ["", "", ""],
              "causality": "Start"
            },
            "significance_score": 0.6
          }
        ]
      }
      \`\`\`
  </example_demonstration>
</system_configuration>
`, bR = `<system_configuration>
  <role_definition>
    : 
    : "" Token 
    
    :
      : 
      : 
      : 
      : 
    
    :
      - 
      - 
      - 
      - 
  </role_definition>

  <compression_protocol>
    _: 
      : 
      :
        - P0 (): //
        - P1 (): /
        - P2 (): 
    
    _:
      : 
      :   
    
    _:
      : 
      :
        : "A " + "A "  "A " ()
        : "A "
  </compression_protocol>

  <merge_strategy>
    _:
      : 
      :
        :
          1. [3 | ] A  ( | 0.2)
          2. [5 | ] A  ( | 0.2)
          3. [7 | ] A  ( | 0.5)
        :
          1. [3-7 | ] A  ( | 0.5)
    
    _:
      : 
      : 
    
    _:
      : 
      :
        : "A " + "A " + "A "
        : "A "
      : ""
  </merge_strategy>

  <output_format>
    :  JSON  text_summary 
    :
      - summary: 
      - meta:  (role, location, event, logic, causality)
      - significance_score: 0.0-1.0  ()
    
    :  30-50%
  </output_format>

  <example_demonstration>
     ():
      \`\`\`
      (102344 ) AB
      Role: [A, B]
      Loc: 
      Event: 
      Logic: []
      Causality: Start
      Significance: 0.8

      (102344 ) BA
      Role: [A, B]
      Loc: 
      Event: 
      Logic: []
      Causality: Chain
      Significance: 0.6

      (1023-1026 ) AB
      Role: [A, ]
      Loc: 
      Event: 
      Logic: []
      Causality: Chain
      Significance: 0.4

      (1026 ) A
      Role: [A, B]
      Loc: B
      Event: 
      Logic: []
      Causality: End
      Significance: 0.8

      (410 ) A
      Role: [A]
      Loc: 
      Event: 
      Logic: []
      Causality: Start
      Significance: 0.3

      (410 14:30) A
      Role: [A, ]
      Loc: 
      Event: 
      Logic: [, ]
      Causality: Chain
      Significance: 0.7
      \`\`\`

     (JSON ):
      \`\`\`json
      {
        "events": [
          {
            "summary": "ABBA",
            "meta": {
              "time_anchor": "102344",
              "role": ["A", "B"],
              "location": "",
              "event": "",
              "logic": ["", "", ""],
              "causality": "Start"
            },
            "significance_score": 0.8
          },
          {
            "summary": "AB",
            "meta": {
              "time_anchor": "1023-1026",
              "role": ["A", "B", ""],
              "location": "",
              "event": "",
              "logic": ["", ""],
              "causality": "Chain"
            },
            "significance_score": 0.8
          },
          {
            "summary": "A",
            "meta": {
              "time_anchor": "410",
              "role": ["A", ""],
              "location": "",
              "event": "",
              "logic": ["", "", ""],
              "causality": "Start"
            },
            "significance_score": 0.7
          }
        ]
      }
      \`\`\`
  </example_demonstration>
</system_configuration>

`, HF = `# Query 

""""

---

## 

****
{{worldbookContext}}

****
{{chatHistory}}

---

## 


1. ****""""""
2. ****
3. ****

---

## 

\`\`\`xml
<think>
[]
</think>

<query>
1, 2, 3, ...
</query>

<output>
[]
</output>
\`\`\`

---

## 

****

****
\`\`\`xml
<think>

- "" Alice  Bob
- ""
</think>

<query>
Alice, Bob, , , , 
</query>

<output>
 Alice  Bob 
</output>
\`\`\`

---

## 

{{userInput}}
`, GF = `<system_configuration>
  <role_definition>
    : 
    : """"
    
    :
      : 
      : 
      : 
      : /

    :
      :
        : {{roll:1d100}} // 
        : {{roll:1d10}} // 
    
    :
      : 
      : 
      : 
    
    :
      - 
      - 
      - 
      - <plot>
      - 
  </role_definition>

  <behavior_guidelines>
    :
      : 
      :  -> <think> -> <output>
      : """"""
  </behavior_guidelines>

  <core_rules>
    A_:
      A1_: NPC
      A2_: 
      A3_: ()()()
      A4_: (++)100
      A5_: 10%
    
    B_ ():
      B0_: []
      B1_:
        - 1:  ()
        - 2-15:  ()
        - 16-81:  ()
        - 82-84:  ()
        - 85-99:  ()
        - 100:  ()
      B2_: 1-2

    C_:
      C1_: >=100[][](/)
      C2_: (/)
  </core_rules>

  <output_template>
    <think>
      :
        : \${}
        : \${}
        : \${ vs }
      :
        : \${}
        : \${}

      :
        // 
        :
          : \${}
        :
          : \${}
          :
            - : \${} vs \${}
            - : \${}
        :
          : \${}
          : \${}

      :
        :
          : \${} // :  * 0.1
          // : (0.5), (1.0), (1.5)
          : \${0-10} + \${}
          
          : \${} + (\${} * 0.5) + \${} = \${}/100
          : \${} + (\${} * 1.0) + \${} = \${}/100
          : \${} + (\${} * 1.5) + \${} = \${}/100
        
        :
          //  >= 80 ()  >= 100 (/)
          : \${}

      :
        // []
        :
          : \${}
          : \${//...}
          : \${}
      
      :
        : \${}
        : \${} ([])
        : \${}
        : \${}
    </think>

    <query>
    \${RAG(///)}
    </query>

    <output>
    <plot>
      <directive>
        <goal>\${}</goal>
        <plot_summary>\${}</plot_summary>
        <key_points>
          <point>\${(): }</point>
          <point>\${: }</point>
          <point>\${: }</point>
          <point>\${: +}</point>
          <point>\${: }</point>
          <point>\${: }</point>
        </key_points>
      </directive>

      :
        : \${}
        : \${}/100 \${}
        : \${}/100
        : \${}/100
        : \${} 
        
        : \${}
        : \${}
        : \${}
        : \${NPC -  ()}
        : \${NPC -  ()}

        :
          // : [] [: X] 
          1: \${1}
          2: \${2}
    </plot>
    </output>
  </output_template>
</system_configuration>
`, KF = `# 



---

## 

****
{{context}}

****
{{chatHistory}}

---

## 


1. ****
2. ****
3. ****
4. ****

---

## 

\`\`\`xml
<think>
[]
</think>

<output>
[]
</output>
\`\`\`

---

## 

****

****
\`\`\`xml
<think>

- 
- 
- 
</think>

<output>

</output>
\`\`\`

---

## 

{{userInput}}
`, wR = `<system_configuration>
  <role_definition>
    : 
    : 
    
    :
      : 
      : 
    
    :
      - 
      - 
      -  existingEntities
      - 
  </role_definition>

  <entity_types>
    char: / ()
    loc:  ()
    item:  ()
    concept: 
    unknown: 
  </entity_types>

  <extraction_rules>
    :
      - 
      -  ("""")
      -  ("""")
      -  ()
    
    :
      -  aliases
      - : ""  """"
    
    :
      -  existingEntities 
      -  name ()
      -  () profile.identity 
  </extraction_rules>

  <profile_structure>
    profile  JSON 
    
     ():
      - relations: EntityRelation[]  
        : target (), type ()
        : description ()
    
     ():
      - identity: string  
      - tags: string[]  
      
     (char) :
      - personality: string  
      - skills: string[]  /
      - affiliation: string  
      
     (loc) :
      - atmosphere: string  
      - features: string[]  
      
     (item) :
      - owner: string  
      - abilities: string[]  
  </profile_structure>

  <output_template>
    <think>
      :
         existingEntities 
        /
      
      :
        
        
      
      :
        
        
    </think>

    \`\`\`json
    {
      "entities": [
        {
          "name": "",
          "type": "char|loc|item|concept",
          "aliases": ["1", "2"],
          "profile": {
            "identity": "",
            "relations": [
              { "target": "", "type": "", "description": "" }
            ],
            "": ""
          }
        }
      ]
    }
    \`\`\`
  </output_template>

  <example_demonstration>
    :
      chatHistory: "ABAB"
      existingEntities: []

    :
      \`\`\`json
      {
        "entities": [
          {
            "name": "A",
            "type": "char",
            "aliases": ["A"],
            "profile": {
              "identity": "",
              "personality": "",
              "relations": [
                { "target": "B", "type": "", "description": "AB" }
              ]
            }
          },
          {
            "name": "B",
            "type": "char",
            "aliases": ["B"],
            "profile": {
              "identity": "A",
              "affiliation": "",
              "relations": [
                { "target": "A", "type": "", "description": "A" }
              ]
            }
          },
          {
            "name": "",
            "type": "loc",
            "aliases": [],
            "profile": {
              "atmosphere": "",
              "features": ["", ""]
            }
          }
        ]
      }
      \`\`\`
  </example_demonstration>
</system_configuration>
`, _R = {
  enabled: !0,
  decayFactor: 0.15,
  maxStickRounds: 3
};
class YF {
  constructor() {
    /** : eventId -> StickyCacheEntry */
    vt(this, "cache", /* @__PURE__ */ new Map());
    /**  */
    vt(this, "currentRound", 0);
  }
  /**
   * 
   */
  nextRound() {
    this.currentRound++, ve.debug("StickyCache", ` ${this.currentRound} `);
  }
  /**
   * 
   */
  getCurrentRound() {
    return this.currentRound;
  }
  /**
   * 
   */
  markRecalled(t) {
    const n = this.cache.get(t);
    n && n.lastRound === this.currentRound - 1 ? this.cache.set(t, {
      lastRound: this.currentRound,
      consecutiveCount: n.consecutiveCount + 1
    }) : this.cache.set(t, {
      lastRound: this.currentRound,
      consecutiveCount: 1
    });
  }
  /**
   * 
   */
  markRecalledBatch(t) {
    t.forEach((n) => this.markRecalled(n));
  }
  /**
   * 
   *
   * @param eventId  ID
   * @param config 
   * @returns  [0, 1]0 = 1 = 
   */
  getStickyPenalty(t, n) {
    if (!n.enabled) return 0;
    const r = this.cache.get(t);
    return !r || this.currentRound - r.lastRound > n.maxStickRounds ? 0 : Math.min(1, r.consecutiveCount * n.decayFactor);
  }
  /**
   * 
   */
  isSticky(t, n) {
    return this.getStickyPenalty(t, n) > 0;
  }
  /**
   * 
   *
   * @param maxAge 
   */
  cleanup(t = 10) {
    let n = 0;
    for (const [r, i] of this.cache)
      this.currentRound - i.lastRound > t && (this.cache.delete(r), n++);
    n > 0 && ve.debug("StickyCache", ` ${n} `);
  }
  /**
   * 
   */
  clear() {
    this.cache.clear(), this.currentRound = 0, ve.debug("StickyCache", "");
  }
  /**
   * 
   */
  getStats() {
    return {
      size: this.cache.size,
      currentRound: this.currentRound
    };
  }
  /**
   * /
   */
  getEventInfo(t) {
    return this.cache.get(t);
  }
}
const kg = new YF(), o0 = [
  { value: "summary", label: "", description: " JSON " },
  { value: "trim", label: "/", description: "" },
  { value: "preprocessing", label: "", description: "Query //" },
  { value: "entity_extraction", label: "", description: "" }
], SR = [
  {
    id: "custom_user_profile",
    name: "",
    content: "",
    // 
    enabled: !0,
    createdAt: Date.now()
  }
], AC = {
  enabled: !1,
  trigger: "floor",
  floorInterval: 50,
  keepRecentCount: 5
}, CR = {
  enableNativeRegex: !0,
  enableEngramRegex: !0
}, A0 = {
  enabled: !0,
  useEmbedding: !0,
  useRerank: !1,
  usePreprocessing: !1,
  useBruteForce: !1,
  //  Embedding 
  embedding: {
    topK: 20,
    minScoreThreshold: 0.3
  },
  sticky: { ..._R, enabled: !0 }
}, ER = {
  temperature: 0.7,
  topP: 0.95,
  maxTokens: 2048,
  frequencyPenalty: 0,
  presencePenalty: 0
}, kR = {
  maxChatHistory: 10
}, TR = {
  source: "transformers"
}, NR = {
  enabled: !1,
  url: "",
  apiKey: "",
  model: "",
  topN: 5,
  hybridAlpha: 0.5
}, u5 = {
  enabled: !1,
  trigger: "with_trim",
  concurrency: 5,
  keepRecentCount: 3
};
function jC(e = "") {
  const t = Date.now();
  return {
    id: `preset_${t}`,
    name: e,
    source: "tavern",
    parameters: { ...ER },
    context: { ...kR },
    isDefault: !0,
    createdAt: t,
    updatedAt: t
  };
}
function Cl(e, t, n = {}) {
  const r = Date.now();
  return {
    id: n.id || `template_${r}_${Math.random().toString(36).slice(2, 8)}`,
    name: e,
    category: t,
    enabled: n.enabled ?? !1,
    isBuiltIn: n.isBuiltIn ?? !1,
    boundPresetId: n.boundPresetId ?? null,
    systemPrompt: n.systemPrompt ?? "",
    userPromptTemplate: n.userPromptTemplate ?? "",
    createdAt: r,
    updatedAt: r
  };
}
function ex() {
  return [
    Cl("", "summary", {
      id: "builtin_summary",
      enabled: !0,
      isBuiltIn: !0,
      systemPrompt: VF,
      userPromptTemplate: `{{worldbookContext}}


{{chatHistory}}

---
 JSON `
    }),
    Cl("", "trim", {
      id: "builtin_trim",
      enabled: !0,
      isBuiltIn: !0,
      systemPrompt: bR,
      userPromptTemplate: `{{worldbookContext}}




{{engramSummaries}}

`
    }),
    Cl("Query ", "preprocessing", {
      id: "builtin_query_enhance",
      enabled: !0,
      isBuiltIn: !0,
      systemPrompt: HF,
      userPromptTemplate: `****:
{{worldbookContext}}

****:
{{chatHistory}}

****:
{{userInput}}

---
`
    }),
    Cl("", "preprocessing", {
      id: "builtin_plot_director",
      enabled: !1,
      // 
      isBuiltIn: !0,
      systemPrompt: GF,
      userPromptTemplate: `****:
{{worldbookContext}}

****:
{{chatHistory}}

****:
{{userInput}}

---
`
    }),
    Cl("", "preprocessing", {
      id: "builtin_description_enhance",
      enabled: !1,
      // 
      isBuiltIn: !0,
      systemPrompt: KF,
      userPromptTemplate: `****:
{{chatHistory}}

****:
{{userInput}}

---
`
    }),
    // V0.9: 
    Cl("", "entity_extraction", {
      id: "builtin_entity_extraction",
      enabled: !1,
      // 
      isBuiltIn: !0,
      systemPrompt: wR,
      userPromptTemplate: `

{{engramGraph}}

---
 JSON `
    })
  ];
}
function MC(e) {
  return ex().find((t) => t.id === e);
}
function tx(e) {
  return ex().find((t) => t.category === e) || null;
}
const AR = {
  enabled: !0,
  includeGlobal: !0,
  disabledWorldbooks: [],
  enableEJS: !0
  // V0.8  EJS
}, jR = {
  enabled: !1,
  trigger: "token",
  tokenLimit: 4096,
  countLimit: 5,
  keepRecentCount: 3,
  preserveOriginal: !1,
  previewEnabled: !0
};
function c5() {
  return {
    llmPresets: [jC()],
    selectedPresetId: null,
    vectorConfig: { ...TR },
    rerankConfig: { ...NR },
    promptTemplates: ex(),
    worldbookConfig: { ...AR },
    regexConfig: { ...CR },
    // V0.8
    recallConfig: { ...A0 },
    // V0.8.5
    customMacros: [...SR]
    // V0.9.2
  };
}
const WF = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  DEFAULT_CONTEXT_SETTINGS: kR,
  DEFAULT_CUSTOM_MACROS: SR,
  DEFAULT_EMBEDDING_CONFIG: u5,
  DEFAULT_ENTITY_CONFIG: AC,
  DEFAULT_RECALL_CONFIG: A0,
  DEFAULT_REGEX_CONFIG: CR,
  DEFAULT_RERANK_CONFIG: NR,
  DEFAULT_SAMPLING_PARAMETERS: ER,
  DEFAULT_TRIM_CONFIG: jR,
  DEFAULT_VECTOR_CONFIG: TR,
  DEFAULT_WORLDBOOK_CONFIG: AR,
  PROMPT_CATEGORIES: o0,
  createDefaultLLMPreset: jC,
  createPromptTemplate: Cl,
  getBuiltInPromptTemplates: ex,
  getBuiltInTemplateByCategory: tx,
  getBuiltInTemplateById: MC,
  getDefaultAPISettings: c5
}, Symbol.toStringTag, { value: "Module" })), sd = Object.freeze({
  theme: "odysseia",
  presets: {},
  templates: {},
  promptTemplates: [],
  hasSeenWelcome: !1,
  lastReadVersion: "0.0.0",
  summarizerConfig: {},
  trimmerConfig: {},
  regexRules: [],
  apiSettings: null,
  preprocessingConfig: null,
  // V0.8: 
  linkedDeletion: {
    enabled: !0,
    deleteWorldbook: !0,
    deleteChatWorldbook: !1,
    // 
    deleteIndexedDB: !1,
    showConfirmation: !0
  },
  glassSettings: {
    enabled: !0,
    opacity: 0.3,
    blur: 10
  },
  syncConfig: {
    enabled: !1,
    // Beta
    autoSync: !0
    // 
  }
});
class rt {
  /**
   *  SillyTavern context
   */
  static getContext() {
    var t, n;
    return (n = (t = window.SillyTavern) == null ? void 0 : t.getContext) == null ? void 0 : n.call(t);
  }
  /**
   * 
   * 
   */
  static getSettings() {
    const t = this.getContext();
    return t != null && t.extensionSettings ? (t.extensionSettings[this.EXTENSION_NAME] || (t.extensionSettings[this.EXTENSION_NAME] = { ...sd }, ve.debug("SettingsManager", "Initialized engram settings with defaults"), this.save()), t.extensionSettings[this.EXTENSION_NAME]) : (ve.warn("SettingsManager", "SillyTavern context.extensionSettings not available"), { ...sd });
  }
  static getExtensionSettings() {
    return this.getSettings();
  }
  /**
   * 
   * 
   */
  static initSettings() {
    const t = this.getContext();
    if (!(t != null && t.extensionSettings)) {
      ve.warn("SettingsManager", "Cannot init settings: context not available");
      return;
    }
    let n = !1;
    t.extensionSettings[this.EXTENSION_NAME] || (t.extensionSettings[this.EXTENSION_NAME] = { ...sd }, n = !0, ve.info("SettingsManager", "Created engram settings"));
    const r = t.extensionSettings[this.EXTENSION_NAME];
    for (const i of Object.keys(sd))
      i in r || (r[i] = sd[i], n = !0, ve.debug("SettingsManager", `Added missing field: ${i}`));
    n && this.save();
  }
  /**
   * Get a specific setting value
   */
  static get(t) {
    const r = this.getExtensionSettings()[t];
    return r !== void 0 ? r : sd[t];
  }
  /**
   * Save a specific setting value
   *  context.extensionSettings 
   */
  static set(t, n) {
    const r = this.getContext();
    if (!(r != null && r.extensionSettings)) {
      ve.warn("SettingsManager", "Cannot set: context.extensionSettings not available");
      return;
    }
    r.extensionSettings[this.EXTENSION_NAME] || (r.extensionSettings[this.EXTENSION_NAME] = { ...sd }), r.extensionSettings[this.EXTENSION_NAME][t] = n, ve.debug("SettingsManager", `Set ${String(t)} = ${JSON.stringify(n)}`), this.save();
  }
  /**
   * 
   */
  static save() {
    const t = this.getContext();
    t != null && t.saveSettingsDebounced ? (t.saveSettingsDebounced(), ve.debug("SettingsManager", "Saved via context.saveSettingsDebounced")) : ve.warn("SettingsManager", "saveSettingsDebounced not available");
  }
  /**
   * Load settings from SillyTavern global state
   * 
   */
  static loadSettings() {
    return this.getExtensionSettings();
  }
  /**
   * 
   * @param category 
   * @returns  null
   */
  static getEnabledPromptTemplate(t) {
    const n = this.get("apiSettings");
    return ((n == null ? void 0 : n.promptTemplates) || []).find((i) => i.category === t && i.enabled) || null;
  }
  /**
   *  ID 
   * @param id  ID
   * @returns  null
   */
  static getPromptTemplateById(t) {
    const n = this.get("apiSettings"), r = (n == null ? void 0 : n.promptTemplates) || [], i = r.find((o) => o.id === t);
    if (i) return i;
    const s = MC(t);
    return s || r.find((o) => o.category === t && o.enabled) || null;
  }
  /**
   * 
   * @returns summarizerConfig 
   */
  static getSummarizerSettings() {
    return this.get("summarizerConfig") || {};
  }
  /**
   * 
   * @param config 
   */
  static setSummarizerSettings(t) {
    const n = this.getSummarizerSettings();
    this.set("summarizerConfig", { ...n, ...t });
  }
  /**
   * 
   * @returns RegexRule[] 
   */
  static getRegexRules() {
    return this.get("regexRules") || [];
  }
  /**
   * 
   * @param rules 
   */
  static setRegexRules(t) {
    this.set("regexRules", t);
  }
}
vt(rt, "EXTENSION_NAME", "engram");
const RC = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  SettingsManager: rt
}, Symbol.toStringTag, { value: "Module" }));
class zc {
  /**
   * 
   */
  static init() {
    this.injectStyles();
    let n = rt.loadSettings().theme;
    n || (n = localStorage.getItem(this.STORAGE_KEY), n && rt.set("theme", n));
    const r = ev[n] ? n : "claudeDark";
    this.setTheme(r), ve.info("ThemeManager", `: ${r}`);
  }
  /**
   * 
   */
  static setTheme(t) {
    ev[t] || (ve.warn("ThemeManager", `: ${t},  claudeDark`), t = "claudeDark"), this.currentTheme = t, rt.set("theme", t), localStorage.setItem(this.STORAGE_KEY, t), this.applyThemeVariables(t);
  }
  /**
   * 
   */
  static getTheme() {
    return this.currentTheme;
  }
  /**
   *  (dist/style.css)
   */
  static injectStyles() {
    const t = "engram-styles";
    if (document.getElementById(t)) return;
    const n = document.createElement("link");
    n.id = t, n.rel = "stylesheet", n.type = "text/css", n.href = `scripts/extensions/Engram_project/dist/style.css?v=${Date.now()}`, document.head.appendChild(n);
  }
  /**
   *  CSS 
   */
  static applyThemeVariables(t) {
    var S, k;
    const n = ev[t];
    if (!n) return;
    const r = document.documentElement, i = (A, T) => {
      r.style.setProperty(A, T);
    }, s = rt.getSettings(), u = ((S = s.glassSettings) == null ? void 0 : S.enabled) ?? !0 ? ((k = s.glassSettings) == null ? void 0 : k.opacity) ?? 1 : 1, d = !(t === "glass") && u < 1, m = Math.round((1 - u) * 100), p = [
      "background",
      "card",
      "popover",
      "sidebar",
      "secondary",
      "muted",
      "input",
      "border",
      "sidebarBorder"
    ];
    Object.entries(n.colors).forEach(([A, T]) => {
      let M = `--${A.replace(/([A-Z])/g, "-$1").toLowerCase()}`;
      M = M.replace(/(\d+)/, "-$1");
      let j = T;
      if (d && p.includes(A)) {
        const z = A.toLowerCase().includes("border") ? Math.round(m * 0.1) : m;
        j = `color-mix(in srgb, ${T}, transparent ${z}%)`;
      }
      i(M, j);
    }), Object.entries(n.variables).forEach(([A, T]) => {
      i(`--${A}`, T);
    }), t !== "paperLight" ? r.classList.add("dark") : r.classList.remove("dark");
    const b = rt.getSettings().glassSettings;
    b && b.enabled ? (i("--glass-opacity", b.opacity.toString()), i("--glass-blur", `${b.blur}px`), b.blur > 0 ? i("--glass-backdrop-filter", `blur(${b.blur}px)`) : i("--glass-backdrop-filter", "none")) : (i("--glass-opacity", "1"), i("--glass-blur", "0px"), i("--glass-backdrop-filter", "none"));
  }
}
vt(zc, "STORAGE_KEY", "engram-theme"), vt(zc, "currentTheme", "claudeDark");
const nv = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  ThemeManager: zc
}, Symbol.toStringTag, { value: "Module" })), XF = mR((e) => ({
  theme: zc.getTheme(),
  isDarkMode: zc.getTheme() !== "paperLight",
  setTheme: (t) => {
    zc.setTheme(t), e({
      theme: t,
      isDarkMode: t !== "paperLight"
    });
  }
}));
class MR {
  async search(t) {
    const n = t.toLowerCase().trim(), r = xv.map((o) => ({
      id: `nav-${o.id}`,
      type: "navigation",
      // Explicitly cast to 'navigation' | 'action' | 'setting' | 'log'
      title: o.label,
      description: `Navigate to ${o.label}`,
      // Auto-generated description
      icon: o.icon,
      action: (u) => u(o.path),
      score: 10
    })).filter(
      (o) => o.title.toLowerCase().includes(n) || o.id.includes(n)
    ), i = eF.filter(
      (o) => {
        var u;
        return o.label.toLowerCase().includes(n) || ((u = o.description) == null ? void 0 : u.toLowerCase().includes(n)) || o.keywords.some((c) => c.toLowerCase().includes(n));
      }
    ).map((o) => ({
      id: o.id,
      type: "command",
      title: o.label,
      description: o.description,
      icon: o.icon,
      action: o.action,
      score: 9
    })), s = this.getThemeCommands().filter(
      (o) => {
        var u;
        return o.title.toLowerCase().includes(n) || ((u = o.keywords) == null ? void 0 : u.some((c) => c.toLowerCase().includes(n)));
      }
    );
    return [...r, ...i, ...s];
  }
  getThemeCommands() {
    const t = XF.getState().setTheme;
    return [
      {
        id: "theme-paper-light",
        type: "command",
        title: ": Paper Light (Twitter)",
        description: "",
        icon: Vq,
        action: () => t("paperLight"),
        keywords: ["theme", "light", "white", "twitter", "paper", ""],
        score: 5
      },
      {
        id: "theme-twitter-dark",
        type: "command",
        title: ": Twitter Dark",
        description: "",
        icon: jk,
        action: () => t("twitterDark"),
        keywords: ["theme", "dark", "black", "twitter", "blue", ""],
        score: 5
      },
      {
        id: "theme-claude-dark",
        type: "command",
        title: ": Claude Dark",
        description: "",
        icon: jk,
        action: () => t("claudeDark"),
        keywords: ["theme", "dark", "claude", "paper", ""],
        score: 5
      },
      {
        id: "theme-catppuccin",
        type: "command",
        title: ": Catppuccin Mocha",
        description: "",
        icon: Mk,
        action: () => t("catppuccin"),
        keywords: ["theme", "dark", "catppuccin", "mocha", ""],
        score: 5
      },
      {
        id: "theme-discord",
        type: "command",
        title: ": Discord Dark",
        description: " Discord ",
        icon: Mk,
        action: () => t("discord"),
        keywords: ["theme", "dark", "discord", "game", ""],
        score: 5
      }
    ];
  }
}
class QF {
  async search(t) {
    const n = t.toLowerCase().trim();
    return this.getAllSettings().filter(
      (r) => {
        var i;
        return r.title.toLowerCase().includes(n) || ((i = r.keywords) == null ? void 0 : i.some((s) => s.toLowerCase().includes(n)));
      }
    );
  }
  getAllSettings() {
    return [
      // API Settings
      {
        id: "setting-api-key",
        type: "setting",
        title: " API Key",
        description: " LLM ",
        icon: Xv,
        action: (t) => t("/api"),
        // Default to API page
        keywords: ["api", "key", "token", "credential"],
        score: 8
      },
      {
        id: "setting-model",
        type: "setting",
        title: " (Model)",
        description: " LLM ",
        icon: wC,
        action: (t) => t("/api"),
        keywords: ["model", "llm", "change", "switch"],
        score: 8
      },
      // Parameters
      {
        id: "setting-temperature",
        type: "setting",
        title: " (Temperature)",
        description: "",
        icon: Rk,
        action: (t) => t("/api"),
        keywords: ["temp", "temperature", "random", "creativity"],
        score: 7
      },
      {
        id: "setting-top-p",
        type: "setting",
        title: " Top P",
        description: "",
        icon: Rk,
        action: (t) => t("/api"),
        keywords: ["top", "p", "nucleus", "sampling"],
        score: 7
      },
      // Vector/RAG
      {
        id: "setting-vector",
        type: "setting",
        title: " (Vectorization)",
        description: "",
        icon: Wv,
        action: (t) => t("/processing"),
        // processing:vectorization ideally
        keywords: ["vector", "embedding", "db", "store"],
        score: 7
      },
      {
        id: "setting-recall",
        type: "setting",
        title: " (Recall)",
        description: " RAG ",
        icon: gq,
        action: (t) => t("/processing"),
        // processing:recall
        keywords: ["recall", "rag", "retrieval", "search"],
        score: 7
      }
    ];
  }
}
class ZF {
  async search(t) {
    const n = t.toLowerCase().trim();
    return ["log", "debug", "error", "warn", "info", "dev"].some((i) => i.includes(n)) || n.includes("log") ? this.getLogActions() : [];
  }
  getLogActions() {
    return [
      {
        id: "log-view-all",
        type: "log",
        title: " (DevLog)",
        description: "",
        icon: Zv,
        action: (t) => t("devlog"),
        score: 9
      },
      {
        id: "log-errors",
        type: "log",
        title: " (Errors)",
        description: "",
        icon: xB,
        action: (t) => t("devlog"),
        // In future: nav('/dev?filter=error')
        score: 8
      }
    ];
  }
}
function Mo() {
  var e, t;
  try {
    return ((t = (e = window.SillyTavern) == null ? void 0 : e.getContext) == null ? void 0 : t.call(e)) || null;
  } catch (n) {
    return console.warn("[Engram] Failed to get ST context:", n), null;
  }
}
function RR() {
  const e = Mo();
  return (e == null ? void 0 : e.chat) || [];
}
function OR() {
  return RR();
}
function xi() {
  const e = Mo();
  return (e == null ? void 0 : e.chatId) || null;
}
function jd() {
  const e = Mo();
  return e ? {
    name: e.name2,
    id: e.characterId
  } : null;
}
function j0() {
  try {
    return window.selected_model || void 0;
  } catch {
    return;
  }
}
function DR() {
  return Mo() !== null;
}
function Bg(e) {
  const t = Mo();
  return t != null && t.getRequestHeaders ? t.getRequestHeaders(e) : { "Content-Type": "application/json" };
}
const JF = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  getChatMessages: OR,
  getCurrentCharacter: jd,
  getCurrentChat: RR,
  getCurrentChatId: xi,
  getCurrentModel: j0,
  getRequestHeaders: Bg,
  getSTContext: Mo,
  isSTAvailable: DR
}, Symbol.toStringTag, { value: "Module" }));
var rv = { exports: {} }, eU = rv.exports, Kk;
function tU() {
  return Kk || (Kk = 1, (function(e, t) {
    (function(n, r) {
      e.exports = r();
    })(eU, function() {
      var n = function(w, E) {
        return (n = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(R, P) {
          R.__proto__ = P;
        } || function(R, P) {
          for (var q in P) Object.prototype.hasOwnProperty.call(P, q) && (R[q] = P[q]);
        })(w, E);
      }, r = function() {
        return (r = Object.assign || function(w) {
          for (var E, R = 1, P = arguments.length; R < P; R++) for (var q in E = arguments[R]) Object.prototype.hasOwnProperty.call(E, q) && (w[q] = E[q]);
          return w;
        }).apply(this, arguments);
      };
      function i(w, E, R) {
        for (var P, q = 0, X = E.length; q < X; q++) !P && q in E || ((P = P || Array.prototype.slice.call(E, 0, q))[q] = E[q]);
        return w.concat(P || Array.prototype.slice.call(E));
      }
      var s = typeof globalThis < "u" ? globalThis : typeof self < "u" ? self : typeof window < "u" ? window : vu, o = Object.keys, u = Array.isArray;
      function c(w, E) {
        return typeof E != "object" || o(E).forEach(function(R) {
          w[R] = E[R];
        }), w;
      }
      typeof Promise > "u" || s.Promise || (s.Promise = Promise);
      var d = Object.getPrototypeOf, m = {}.hasOwnProperty;
      function p(w, E) {
        return m.call(w, E);
      }
      function x(w, E) {
        typeof E == "function" && (E = E(d(w))), (typeof Reflect > "u" ? o : Reflect.ownKeys)(E).forEach(function(R) {
          S(w, R, E[R]);
        });
      }
      var b = Object.defineProperty;
      function S(w, E, R, P) {
        b(w, E, c(R && p(R, "get") && typeof R.get == "function" ? { get: R.get, set: R.set, configurable: !0 } : { value: R, configurable: !0, writable: !0 }, P));
      }
      function k(w) {
        return { from: function(E) {
          return w.prototype = Object.create(E.prototype), S(w.prototype, "constructor", w), { extend: x.bind(null, w.prototype) };
        } };
      }
      var A = Object.getOwnPropertyDescriptor, T = [].slice;
      function M(w, E, R) {
        return T.call(w, E, R);
      }
      function j(w, E) {
        return E(w);
      }
      function D(w) {
        if (!w) throw new Error("Assertion Failed");
      }
      function z(w) {
        s.setImmediate ? setImmediate(w) : setTimeout(w, 0);
      }
      function I(w, E) {
        if (typeof E == "string" && p(w, E)) return w[E];
        if (!E) return w;
        if (typeof E != "string") {
          for (var R = [], P = 0, q = E.length; P < q; ++P) {
            var X = I(w, E[P]);
            R.push(X);
          }
          return R;
        }
        var oe = E.indexOf(".");
        if (oe !== -1) {
          var U = w[E.substr(0, oe)];
          return U == null ? void 0 : I(U, E.substr(oe + 1));
        }
      }
      function L(w, E, R) {
        if (w && E !== void 0 && !("isFrozen" in Object && Object.isFrozen(w))) if (typeof E != "string" && "length" in E) {
          D(typeof R != "string" && "length" in R);
          for (var P = 0, q = E.length; P < q; ++P) L(w, E[P], R[P]);
        } else {
          var X, oe, U = E.indexOf(".");
          U !== -1 ? (X = E.substr(0, U), (oe = E.substr(U + 1)) === "" ? R === void 0 ? u(w) && !isNaN(parseInt(X)) ? w.splice(X, 1) : delete w[X] : w[X] = R : L(U = !(U = w[X]) || !p(w, X) ? w[X] = {} : U, oe, R)) : R === void 0 ? u(w) && !isNaN(parseInt(E)) ? w.splice(E, 1) : delete w[E] : w[E] = R;
        }
      }
      function K(w) {
        var E, R = {};
        for (E in w) p(w, E) && (R[E] = w[E]);
        return R;
      }
      var ne = [].concat;
      function Y(w) {
        return ne.apply([], w);
      }
      var Fe = "BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Y([8, 16, 32, 64].map(function(w) {
        return ["Int", "Uint", "Float"].map(function(E) {
          return E + w + "Array";
        });
      }))).filter(function(w) {
        return s[w];
      }), H = new Set(Fe.map(function(w) {
        return s[w];
      })), Z = null;
      function me(w) {
        return Z = /* @__PURE__ */ new WeakMap(), w = (function E(R) {
          if (!R || typeof R != "object") return R;
          var P = Z.get(R);
          if (P) return P;
          if (u(R)) {
            P = [], Z.set(R, P);
            for (var q = 0, X = R.length; q < X; ++q) P.push(E(R[q]));
          } else if (H.has(R.constructor)) P = R;
          else {
            var oe, U = d(R);
            for (oe in P = U === Object.prototype ? {} : Object.create(U), Z.set(R, P), R) p(R, oe) && (P[oe] = E(R[oe]));
          }
          return P;
        })(w), Z = null, w;
      }
      var Q = {}.toString;
      function se(w) {
        return Q.call(w).slice(8, -1);
      }
      var J = typeof Symbol < "u" ? Symbol.iterator : "@@iterator", ue = typeof J == "symbol" ? function(w) {
        var E;
        return w != null && (E = w[J]) && E.apply(w);
      } : function() {
        return null;
      };
      function de(w, E) {
        return E = w.indexOf(E), 0 <= E && w.splice(E, 1), 0 <= E;
      }
      var ce = {};
      function W(w) {
        var E, R, P, q;
        if (arguments.length === 1) {
          if (u(w)) return w.slice();
          if (this === ce && typeof w == "string") return [w];
          if (q = ue(w)) {
            for (R = []; !(P = q.next()).done; ) R.push(P.value);
            return R;
          }
          if (w == null) return [w];
          if (typeof (E = w.length) != "number") return [w];
          for (R = new Array(E); E--; ) R[E] = w[E];
          return R;
        }
        for (E = arguments.length, R = new Array(E); E--; ) R[E] = arguments[E];
        return R;
      }
      var $ = typeof Symbol < "u" ? function(w) {
        return w[Symbol.toStringTag] === "AsyncFunction";
      } : function() {
        return !1;
      }, Xn = ["Unknown", "Constraint", "Data", "TransactionInactive", "ReadOnly", "Version", "NotFound", "InvalidState", "InvalidAccess", "Abort", "Timeout", "QuotaExceeded", "Syntax", "DataClone"], Ur = ["Modify", "Bulk", "OpenFailed", "VersionChange", "Schema", "Upgrade", "InvalidTable", "MissingAPI", "NoSuchDatabase", "InvalidArgument", "SubTransaction", "Unsupported", "Internal", "DatabaseClosed", "PrematureCommit", "ForeignAwait"].concat(Xn), fe = { VersionChanged: "Database version changed by other database connection", DatabaseClosed: "Database has been closed", Abort: "Transaction aborted", TransactionInactive: "Transaction has already completed or failed", MissingAPI: "IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb" };
      function G(w, E) {
        this.name = w, this.message = E;
      }
      function le(w, E) {
        return w + ". Errors: " + Object.keys(E).map(function(R) {
          return E[R].toString();
        }).filter(function(R, P, q) {
          return q.indexOf(R) === P;
        }).join(`
`);
      }
      function xe(w, E, R, P) {
        this.failures = E, this.failedKeys = P, this.successCount = R, this.message = le(w, E);
      }
      function Se(w, E) {
        this.name = "BulkError", this.failures = Object.keys(E).map(function(R) {
          return E[R];
        }), this.failuresByPos = E, this.message = le(w, this.failures);
      }
      k(G).from(Error).extend({ toString: function() {
        return this.name + ": " + this.message;
      } }), k(xe).from(G), k(Se).from(G);
      var Oe = Ur.reduce(function(w, E) {
        return w[E] = E + "Error", w;
      }, {}), Be = G, Re = Ur.reduce(function(w, E) {
        var R = E + "Error";
        function P(q, X) {
          this.name = R, q ? typeof q == "string" ? (this.message = "".concat(q).concat(X ? `
 ` + X : ""), this.inner = X || null) : typeof q == "object" && (this.message = "".concat(q.name, " ").concat(q.message), this.inner = q) : (this.message = fe[E] || R, this.inner = null);
        }
        return k(P).from(Be), w[E] = P, w;
      }, {});
      Re.Syntax = SyntaxError, Re.Type = TypeError, Re.Range = RangeError;
      var ft = Xn.reduce(function(w, E) {
        return w[E + "Error"] = Re[E], w;
      }, {}), Ie = Ur.reduce(function(w, E) {
        return ["Syntax", "Type", "Range"].indexOf(E) === -1 && (w[E + "Error"] = Re[E]), w;
      }, {});
      function Ne() {
      }
      function Ue(w) {
        return w;
      }
      function et(w, E) {
        return w == null || w === Ue ? E : function(R) {
          return E(w(R));
        };
      }
      function tt(w, E) {
        return function() {
          w.apply(this, arguments), E.apply(this, arguments);
        };
      }
      function st(w, E) {
        return w === Ne ? E : function() {
          var R = w.apply(this, arguments);
          R !== void 0 && (arguments[0] = R);
          var P = this.onsuccess, q = this.onerror;
          this.onsuccess = null, this.onerror = null;
          var X = E.apply(this, arguments);
          return P && (this.onsuccess = this.onsuccess ? tt(P, this.onsuccess) : P), q && (this.onerror = this.onerror ? tt(q, this.onerror) : q), X !== void 0 ? X : R;
        };
      }
      function dt(w, E) {
        return w === Ne ? E : function() {
          w.apply(this, arguments);
          var R = this.onsuccess, P = this.onerror;
          this.onsuccess = this.onerror = null, E.apply(this, arguments), R && (this.onsuccess = this.onsuccess ? tt(R, this.onsuccess) : R), P && (this.onerror = this.onerror ? tt(P, this.onerror) : P);
        };
      }
      function Wn(w, E) {
        return w === Ne ? E : function(R) {
          var P = w.apply(this, arguments);
          c(R, P);
          var q = this.onsuccess, X = this.onerror;
          return this.onsuccess = null, this.onerror = null, R = E.apply(this, arguments), q && (this.onsuccess = this.onsuccess ? tt(q, this.onsuccess) : q), X && (this.onerror = this.onerror ? tt(X, this.onerror) : X), P === void 0 ? R === void 0 ? void 0 : R : c(P, R);
        };
      }
      function Rn(w, E) {
        return w === Ne ? E : function() {
          return E.apply(this, arguments) !== !1 && w.apply(this, arguments);
        };
      }
      function Un(w, E) {
        return w === Ne ? E : function() {
          var R = w.apply(this, arguments);
          if (R && typeof R.then == "function") {
            for (var P = this, q = arguments.length, X = new Array(q); q--; ) X[q] = arguments[q];
            return R.then(function() {
              return E.apply(P, X);
            });
          }
          return E.apply(this, arguments);
        };
      }
      Ie.ModifyError = xe, Ie.DexieError = G, Ie.BulkError = Se;
      var Ht = typeof location < "u" && /^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);
      function On(w) {
        Ht = w;
      }
      var an = {}, En = 100, Fe = typeof Promise > "u" ? [] : (function() {
        var w = Promise.resolve();
        if (typeof crypto > "u" || !crypto.subtle) return [w, d(w), w];
        var E = crypto.subtle.digest("SHA-512", new Uint8Array([0]));
        return [E, d(E), w];
      })(), Xn = Fe[0], Ur = Fe[1], Fe = Fe[2], Ur = Ur && Ur.then, Qe = Xn && Xn.constructor, yt = !!Fe, Tt = function(w, E) {
        jr.push([w, E]), $n && (queueMicrotask(zl), $n = !1);
      }, Pt = !0, $n = !0, Vn = [], sn = [], Qt = Ue, kn = { id: "global", global: !0, ref: 0, unhandleds: [], onunhandled: Ne, pgp: !1, env: {}, finalize: Ne }, it = kn, jr = [], fr = 0, Io = [];
      function ct(w) {
        if (typeof this != "object") throw new TypeError("Promises must be constructed via new");
        this._listeners = [], this._lib = !1;
        var E = this._PSD = it;
        if (typeof w != "function") {
          if (w !== an) throw new TypeError("Not a function");
          return this._state = arguments[1], this._value = arguments[2], void (this._state === !1 && Ui(this, this._value));
        }
        this._state = null, this._value = null, ++E.ref, (function R(P, q) {
          try {
            q(function(X) {
              if (P._state === null) {
                if (X === P) throw new TypeError("A promise cannot be resolved with itself.");
                var oe = P._lib && ha();
                X && typeof X.then == "function" ? R(P, function(U, ie) {
                  X instanceof ct ? X._then(U, ie) : X.then(U, ie);
                }) : (P._state = !0, P._value = X, Us(P)), oe && Si();
              }
            }, Ui.bind(null, P));
          } catch (X) {
            Ui(P, X);
          }
        })(this, w);
      }
      var Va = { get: function() {
        var w = it, E = Vs;
        function R(P, q) {
          var X = this, oe = !w.global && (w !== it || E !== Vs), U = oe && !Mr(), ie = new ct(function(re, pe) {
            Ha(X, new gs(Po(P, w, oe, U), Po(q, w, oe, U), re, pe, w));
          });
          return this._consoleTask && (ie._consoleTask = this._consoleTask), ie;
        }
        return R.prototype = an, R;
      }, set: function(w) {
        S(this, "then", w && w.prototype === an ? Va : { get: function() {
          return w;
        }, set: Va.set });
      } };
      function gs(w, E, R, P, q) {
        this.onFulfilled = typeof w == "function" ? w : null, this.onRejected = typeof E == "function" ? E : null, this.resolve = R, this.reject = P, this.psd = q;
      }
      function Ui(w, E) {
        var R, P;
        sn.push(E), w._state === null && (R = w._lib && ha(), E = Qt(E), w._state = !1, w._value = E, P = w, Vn.some(function(q) {
          return q._value === P._value;
        }) || Vn.push(P), Us(w), R && Si());
      }
      function Us(w) {
        var E = w._listeners;
        w._listeners = [];
        for (var R = 0, P = E.length; R < P; ++R) Ha(w, E[R]);
        var q = w._PSD;
        --q.ref || q.finalize(), fr === 0 && (++fr, Tt(function() {
          --fr == 0 && Ll();
        }, []));
      }
      function Ha(w, E) {
        if (w._state !== null) {
          var R = w._state ? E.onFulfilled : E.onRejected;
          if (R === null) return (w._state ? E.resolve : E.reject)(w._value);
          ++E.psd.ref, ++fr, Tt(Gc, [R, w, E]);
        } else w._listeners.push(E);
      }
      function Gc(w, E, R) {
        try {
          var P, q = E._value;
          !E._state && sn.length && (sn = []), P = Ht && E._consoleTask ? E._consoleTask.run(function() {
            return w(q);
          }) : w(q), E._state || sn.indexOf(q) !== -1 || (function(X) {
            for (var oe = Vn.length; oe; ) if (Vn[--oe]._value === X._value) return Vn.splice(oe, 1);
          })(E), R.resolve(P);
        } catch (X) {
          R.reject(X);
        } finally {
          --fr == 0 && Ll(), --R.psd.ref || R.psd.finalize();
        }
      }
      function zl() {
        li(kn, function() {
          ha() && Si();
        });
      }
      function ha() {
        var w = Pt;
        return $n = Pt = !1, w;
      }
      function Si() {
        var w, E, R;
        do
          for (; 0 < jr.length; ) for (w = jr, jr = [], R = w.length, E = 0; E < R; ++E) {
            var P = w[E];
            P[0].apply(null, P[1]);
          }
        while (0 < jr.length);
        $n = Pt = !0;
      }
      function Ll() {
        var w = Vn;
        Vn = [], w.forEach(function(P) {
          P._PSD.onunhandled.call(null, P._value, P);
        });
        for (var E = Io.slice(0), R = E.length; R; ) E[--R]();
      }
      function Ga(w) {
        return new ct(an, !1, w);
      }
      function vn(w, E) {
        var R = it;
        return function() {
          var P = ha(), q = it;
          try {
            return ga(R, !0), w.apply(this, arguments);
          } catch (X) {
            E && E(X);
          } finally {
            ga(q, !1), P && Si();
          }
        };
      }
      x(ct.prototype, { then: Va, _then: function(w, E) {
        Ha(this, new gs(null, null, w, E, it));
      }, catch: function(w) {
        if (arguments.length === 1) return this.then(null, w);
        var E = w, R = arguments[1];
        return typeof E == "function" ? this.then(null, function(P) {
          return (P instanceof E ? R : Ga)(P);
        }) : this.then(null, function(P) {
          return (P && P.name === E ? R : Ga)(P);
        });
      }, finally: function(w) {
        return this.then(function(E) {
          return ct.resolve(w()).then(function() {
            return E;
          });
        }, function(E) {
          return ct.resolve(w()).then(function() {
            return Ga(E);
          });
        });
      }, timeout: function(w, E) {
        var R = this;
        return w < 1 / 0 ? new ct(function(P, q) {
          var X = setTimeout(function() {
            return q(new Re.Timeout(E));
          }, w);
          R.then(P, q).finally(clearTimeout.bind(null, X));
        }) : this;
      } }), typeof Symbol < "u" && Symbol.toStringTag && S(ct.prototype, Symbol.toStringTag, "Dexie.Promise"), kn.env = ql(), x(ct, { all: function() {
        var w = W.apply(null, arguments).map(pa);
        return new ct(function(E, R) {
          w.length === 0 && E([]);
          var P = w.length;
          w.forEach(function(q, X) {
            return ct.resolve(q).then(function(oe) {
              w[X] = oe, --P || E(w);
            }, R);
          });
        });
      }, resolve: function(w) {
        return w instanceof ct ? w : w && typeof w.then == "function" ? new ct(function(E, R) {
          w.then(E, R);
        }) : new ct(an, !0, w);
      }, reject: Ga, race: function() {
        var w = W.apply(null, arguments).map(pa);
        return new ct(function(E, R) {
          w.map(function(P) {
            return ct.resolve(P).then(E, R);
          });
        });
      }, PSD: { get: function() {
        return it;
      }, set: function(w) {
        return it = w;
      } }, totalEchoes: { get: function() {
        return Vs;
      } }, newPSD: wn, usePSD: li, scheduler: { get: function() {
        return Tt;
      }, set: function(w) {
        Tt = w;
      } }, rejectionMapper: { get: function() {
        return Qt;
      }, set: function(w) {
        Qt = w;
      } }, follow: function(w, E) {
        return new ct(function(R, P) {
          return wn(function(q, X) {
            var oe = it;
            oe.unhandleds = [], oe.onunhandled = X, oe.finalize = tt(function() {
              var U, ie = this;
              U = function() {
                ie.unhandleds.length === 0 ? q() : X(ie.unhandleds[0]);
              }, Io.push(function re() {
                U(), Io.splice(Io.indexOf(re), 1);
              }), ++fr, Tt(function() {
                --fr == 0 && Ll();
              }, []);
            }, oe.finalize), w();
          }, E, R, P);
        });
      } }), Qe && (Qe.allSettled && S(ct, "allSettled", function() {
        var w = W.apply(null, arguments).map(pa);
        return new ct(function(E) {
          w.length === 0 && E([]);
          var R = w.length, P = new Array(R);
          w.forEach(function(q, X) {
            return ct.resolve(q).then(function(oe) {
              return P[X] = { status: "fulfilled", value: oe };
            }, function(oe) {
              return P[X] = { status: "rejected", reason: oe };
            }).then(function() {
              return --R || E(P);
            });
          });
        });
      }), Qe.any && typeof AggregateError < "u" && S(ct, "any", function() {
        var w = W.apply(null, arguments).map(pa);
        return new ct(function(E, R) {
          w.length === 0 && R(new AggregateError([]));
          var P = w.length, q = new Array(P);
          w.forEach(function(X, oe) {
            return ct.resolve(X).then(function(U) {
              return E(U);
            }, function(U) {
              q[oe] = U, --P || R(new AggregateError(q));
            });
          });
        });
      }), Qe.withResolvers && (ct.withResolvers = Qe.withResolvers));
      var Dn = { awaits: 0, echoes: 0, id: 0 }, Bl = 0, ys = [], $s = 0, Vs = 0, ma = 0;
      function wn(w, E, R, P) {
        var q = it, X = Object.create(q);
        return X.parent = q, X.ref = 0, X.global = !1, X.id = ++ma, kn.env, X.env = yt ? { Promise: ct, PromiseProp: { value: ct, configurable: !0, writable: !0 }, all: ct.all, race: ct.race, allSettled: ct.allSettled, any: ct.any, resolve: ct.resolve, reject: ct.reject } : {}, E && c(X, E), ++q.ref, X.finalize = function() {
          --this.parent.ref || this.parent.finalize();
        }, P = li(X, w, R, P), X.ref === 0 && X.finalize(), P;
      }
      function Qn() {
        return Dn.id || (Dn.id = ++Bl), ++Dn.awaits, Dn.echoes += En, Dn.id;
      }
      function Mr() {
        return !!Dn.awaits && (--Dn.awaits == 0 && (Dn.id = 0), Dn.echoes = Dn.awaits * En, !0);
      }
      function pa(w) {
        return Dn.echoes && w && w.constructor === Qe ? (Qn(), w.then(function(E) {
          return Mr(), E;
        }, function(E) {
          return Mr(), on(E);
        })) : w;
      }
      function ju() {
        var w = ys[ys.length - 1];
        ys.pop(), ga(w, !1);
      }
      function ga(w, E) {
        var R, P = it;
        (E ? !Dn.echoes || $s++ && w === it : !$s || --$s && w === it) || queueMicrotask(E ? (function(q) {
          ++Vs, Dn.echoes && --Dn.echoes != 0 || (Dn.echoes = Dn.awaits = Dn.id = 0), ys.push(it), ga(q, !0);
        }).bind(null, w) : ju), w !== it && (it = w, P === kn && (kn.env = ql()), yt && (R = kn.env.Promise, E = w.env, (P.global || w.global) && (Object.defineProperty(s, "Promise", E.PromiseProp), R.all = E.all, R.race = E.race, R.resolve = E.resolve, R.reject = E.reject, E.allSettled && (R.allSettled = E.allSettled), E.any && (R.any = E.any))));
      }
      function ql() {
        var w = s.Promise;
        return yt ? { Promise: w, PromiseProp: Object.getOwnPropertyDescriptor(s, "Promise"), all: w.all, race: w.race, allSettled: w.allSettled, any: w.any, resolve: w.resolve, reject: w.reject } : {};
      }
      function li(w, E, R, P, q) {
        var X = it;
        try {
          return ga(w, !0), E(R, P, q);
        } finally {
          ga(X, !1);
        }
      }
      function Po(w, E, R, P) {
        return typeof w != "function" ? w : function() {
          var q = it;
          R && Qn(), ga(E, !0);
          try {
            return w.apply(this, arguments);
          } finally {
            ga(q, !1), P && queueMicrotask(Mr);
          }
        };
      }
      function ya(w) {
        Promise === Qe && Dn.echoes === 0 ? $s === 0 ? w() : enqueueNativeMicroTask(w) : setTimeout(w, 0);
      }
      ("" + Ur).indexOf("[native code]") === -1 && (Qn = Mr = Ne);
      var on = ct.reject, ei = "", dr = "Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.", Zn = "String expected.", Ka = [], Hs = "__dbnames", Ci = "readonly", $i = "readwrite";
      function va(w, E) {
        return w ? E ? function() {
          return w.apply(this, arguments) && E.apply(this, arguments);
        } : w : E;
      }
      var zo = { type: 3, lower: -1 / 0, lowerOpen: !1, upper: [[]], upperOpen: !1 };
      function Gs(w) {
        return typeof w != "string" || /\./.test(w) ? function(E) {
          return E;
        } : function(E) {
          return E[w] === void 0 && w in E && delete (E = me(E))[w], E;
        };
      }
      function Mu() {
        throw Re.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.");
      }
      function zt(w, E) {
        try {
          var R = vs(w), P = vs(E);
          if (R !== P) return R === "Array" ? 1 : P === "Array" ? -1 : R === "binary" ? 1 : P === "binary" ? -1 : R === "string" ? 1 : P === "string" ? -1 : R === "Date" ? 1 : P !== "Date" ? NaN : -1;
          switch (R) {
            case "number":
            case "Date":
            case "string":
              return E < w ? 1 : w < E ? -1 : 0;
            case "binary":
              return (function(q, X) {
                for (var oe = q.length, U = X.length, ie = oe < U ? oe : U, re = 0; re < ie; ++re) if (q[re] !== X[re]) return q[re] < X[re] ? -1 : 1;
                return oe === U ? 0 : oe < U ? -1 : 1;
              })(ui(w), ui(E));
            case "Array":
              return (function(q, X) {
                for (var oe = q.length, U = X.length, ie = oe < U ? oe : U, re = 0; re < ie; ++re) {
                  var pe = zt(q[re], X[re]);
                  if (pe !== 0) return pe;
                }
                return oe === U ? 0 : oe < U ? -1 : 1;
              })(w, E);
          }
        } catch {
        }
        return NaN;
      }
      function vs(w) {
        var E = typeof w;
        return E != "object" ? E : ArrayBuffer.isView(w) ? "binary" : (w = se(w), w === "ArrayBuffer" ? "binary" : w);
      }
      function ui(w) {
        return w instanceof Uint8Array ? w : ArrayBuffer.isView(w) ? new Uint8Array(w.buffer, w.byteOffset, w.byteLength) : new Uint8Array(w);
      }
      function xr(w, E, R) {
        var P = w.schema.yProps;
        return P ? (E && 0 < R.numFailures && (E = E.filter(function(q, X) {
          return !R.failures[X];
        })), Promise.all(P.map(function(q) {
          return q = q.updatesTable, E ? w.db.table(q).where("k").anyOf(E).delete() : w.db.table(q).clear();
        })).then(function() {
          return R;
        })) : R;
      }
      var xa = (Ru.prototype.execute = function(w) {
        var E = this["@@propmod"];
        if (E.add !== void 0) {
          var R = E.add;
          if (u(R)) return i(i([], u(w) ? w : [], !0), R).sort();
          if (typeof R == "number") return (Number(w) || 0) + R;
          if (typeof R == "bigint") try {
            return BigInt(w) + R;
          } catch {
            return BigInt(0) + R;
          }
          throw new TypeError("Invalid term ".concat(R));
        }
        if (E.remove !== void 0) {
          var P = E.remove;
          if (u(P)) return u(w) ? w.filter(function(q) {
            return !P.includes(q);
          }).sort() : [];
          if (typeof P == "number") return Number(w) - P;
          if (typeof P == "bigint") try {
            return BigInt(w) - P;
          } catch {
            return BigInt(0) - P;
          }
          throw new TypeError("Invalid subtrahend ".concat(P));
        }
        return R = (R = E.replacePrefix) === null || R === void 0 ? void 0 : R[0], R && typeof w == "string" && w.startsWith(R) ? E.replacePrefix[1] + w.substring(R.length) : w;
      }, Ru);
      function Ru(w) {
        this["@@propmod"] = w;
      }
      function ba(w, E) {
        for (var R = o(E), P = R.length, q = !1, X = 0; X < P; ++X) {
          var oe = R[X], U = E[oe], ie = I(w, oe);
          U instanceof xa ? (L(w, oe, U.execute(ie)), q = !0) : ie !== U && (L(w, oe, U), q = !0);
        }
        return q;
      }
      var xs = (Zt.prototype._trans = function(w, E, R) {
        var P = this._tx || it.trans, q = this.name, X = Ht && typeof console < "u" && console.createTask && console.createTask("Dexie: ".concat(w === "readonly" ? "read" : "write", " ").concat(this.name));
        function oe(re, pe, he) {
          if (!he.schema[q]) throw new Re.NotFound("Table " + q + " not part of transaction");
          return E(he.idbtrans, he);
        }
        var U = ha();
        try {
          var ie = P && P.db._novip === this.db._novip ? P === it.trans ? P._promise(w, oe, R) : wn(function() {
            return P._promise(w, oe, R);
          }, { trans: P, transless: it.transless || it }) : (function re(pe, he, _e, be) {
            if (pe.idbdb && (pe._state.openComplete || it.letThrough || pe._vip)) {
              var we = pe._createTransaction(he, _e, pe._dbSchema);
              try {
                we.create(), pe._state.PR1398_maxLoop = 3;
              } catch (ke) {
                return ke.name === Oe.InvalidState && pe.isOpen() && 0 < --pe._state.PR1398_maxLoop ? (console.warn("Dexie: Need to reopen db"), pe.close({ disableAutoOpen: !1 }), pe.open().then(function() {
                  return re(pe, he, _e, be);
                })) : on(ke);
              }
              return we._promise(he, function(ke, Te) {
                return wn(function() {
                  return it.trans = we, be(ke, Te, we);
                });
              }).then(function(ke) {
                if (he === "readwrite") try {
                  we.idbtrans.commit();
                } catch {
                }
                return he === "readonly" ? ke : we._completion.then(function() {
                  return ke;
                });
              });
            }
            if (pe._state.openComplete) return on(new Re.DatabaseClosed(pe._state.dbOpenError));
            if (!pe._state.isBeingOpened) {
              if (!pe._state.autoOpen) return on(new Re.DatabaseClosed());
              pe.open().catch(Ne);
            }
            return pe._state.dbReadyPromise.then(function() {
              return re(pe, he, _e, be);
            });
          })(this.db, w, [this.name], oe);
          return X && (ie._consoleTask = X, ie = ie.catch(function(re) {
            return console.trace(re), on(re);
          })), ie;
        } finally {
          U && Si();
        }
      }, Zt.prototype.get = function(w, E) {
        var R = this;
        return w && w.constructor === Object ? this.where(w).first(E) : w == null ? on(new Re.Type("Invalid argument to Table.get()")) : this._trans("readonly", function(P) {
          return R.core.get({ trans: P, key: w }).then(function(q) {
            return R.hook.reading.fire(q);
          });
        }).then(E);
      }, Zt.prototype.where = function(w) {
        if (typeof w == "string") return new this.db.WhereClause(this, w);
        if (u(w)) return new this.db.WhereClause(this, "[".concat(w.join("+"), "]"));
        var E = o(w);
        if (E.length === 1) return this.where(E[0]).equals(w[E[0]]);
        var R = this.schema.indexes.concat(this.schema.primKey).filter(function(U) {
          if (U.compound && E.every(function(re) {
            return 0 <= U.keyPath.indexOf(re);
          })) {
            for (var ie = 0; ie < E.length; ++ie) if (E.indexOf(U.keyPath[ie]) === -1) return !1;
            return !0;
          }
          return !1;
        }).sort(function(U, ie) {
          return U.keyPath.length - ie.keyPath.length;
        })[0];
        if (R && this.db._maxKey !== ei) {
          var X = R.keyPath.slice(0, E.length);
          return this.where(X).equals(X.map(function(ie) {
            return w[ie];
          }));
        }
        !R && Ht && console.warn("The query ".concat(JSON.stringify(w), " on ").concat(this.name, " would benefit from a ") + "compound index [".concat(E.join("+"), "]"));
        var P = this.schema.idxByName;
        function q(U, ie) {
          return zt(U, ie) === 0;
        }
        var oe = E.reduce(function(he, ie) {
          var re = he[0], pe = he[1], he = P[ie], _e = w[ie];
          return [re || he, re || !he ? va(pe, he && he.multi ? function(be) {
            return be = I(be, ie), u(be) && be.some(function(we) {
              return q(_e, we);
            });
          } : function(be) {
            return q(_e, I(be, ie));
          }) : pe];
        }, [null, null]), X = oe[0], oe = oe[1];
        return X ? this.where(X.name).equals(w[X.keyPath]).filter(oe) : R ? this.filter(oe) : this.where(E).equals("");
      }, Zt.prototype.filter = function(w) {
        return this.toCollection().and(w);
      }, Zt.prototype.count = function(w) {
        return this.toCollection().count(w);
      }, Zt.prototype.offset = function(w) {
        return this.toCollection().offset(w);
      }, Zt.prototype.limit = function(w) {
        return this.toCollection().limit(w);
      }, Zt.prototype.each = function(w) {
        return this.toCollection().each(w);
      }, Zt.prototype.toArray = function(w) {
        return this.toCollection().toArray(w);
      }, Zt.prototype.toCollection = function() {
        return new this.db.Collection(new this.db.WhereClause(this));
      }, Zt.prototype.orderBy = function(w) {
        return new this.db.Collection(new this.db.WhereClause(this, u(w) ? "[".concat(w.join("+"), "]") : w));
      }, Zt.prototype.reverse = function() {
        return this.toCollection().reverse();
      }, Zt.prototype.mapToClass = function(w) {
        var E, R = this.db, P = this.name;
        function q() {
          return E !== null && E.apply(this, arguments) || this;
        }
        (this.schema.mappedClass = w).prototype instanceof Mu && ((function(ie, re) {
          if (typeof re != "function" && re !== null) throw new TypeError("Class extends value " + String(re) + " is not a constructor or null");
          function pe() {
            this.constructor = ie;
          }
          n(ie, re), ie.prototype = re === null ? Object.create(re) : (pe.prototype = re.prototype, new pe());
        })(q, E = w), Object.defineProperty(q.prototype, "db", { get: function() {
          return R;
        }, enumerable: !1, configurable: !0 }), q.prototype.table = function() {
          return P;
        }, w = q);
        for (var X = /* @__PURE__ */ new Set(), oe = w.prototype; oe; oe = d(oe)) Object.getOwnPropertyNames(oe).forEach(function(ie) {
          return X.add(ie);
        });
        function U(ie) {
          if (!ie) return ie;
          var re, pe = Object.create(w.prototype);
          for (re in ie) if (!X.has(re)) try {
            pe[re] = ie[re];
          } catch {
          }
          return pe;
        }
        return this.schema.readHook && this.hook.reading.unsubscribe(this.schema.readHook), this.schema.readHook = U, this.hook("reading", U), w;
      }, Zt.prototype.defineClass = function() {
        return this.mapToClass(function(w) {
          c(this, w);
        });
      }, Zt.prototype.add = function(w, E) {
        var R = this, P = this.schema.primKey, q = P.auto, X = P.keyPath, oe = w;
        return X && q && (oe = Gs(X)(w)), this._trans("readwrite", function(U) {
          return R.core.mutate({ trans: U, type: "add", keys: E != null ? [E] : null, values: [oe] });
        }).then(function(U) {
          return U.numFailures ? ct.reject(U.failures[0]) : U.lastResult;
        }).then(function(U) {
          if (X) try {
            L(w, X, U);
          } catch {
          }
          return U;
        });
      }, Zt.prototype.upsert = function(w, E) {
        var R = this, P = this.schema.primKey.keyPath;
        return this._trans("readwrite", function(q) {
          return R.core.get({ trans: q, key: w }).then(function(X) {
            var oe = X ?? {};
            return ba(oe, E), P && L(oe, P, w), R.core.mutate({ trans: q, type: "put", values: [oe], keys: [w], upsert: !0, updates: { keys: [w], changeSpecs: [E] } }).then(function(U) {
              return U.numFailures ? ct.reject(U.failures[0]) : !!X;
            });
          });
        });
      }, Zt.prototype.update = function(w, E) {
        return typeof w != "object" || u(w) ? this.where(":id").equals(w).modify(E) : (w = I(w, this.schema.primKey.keyPath), w === void 0 ? on(new Re.InvalidArgument("Given object does not contain its primary key")) : this.where(":id").equals(w).modify(E));
      }, Zt.prototype.put = function(w, E) {
        var R = this, P = this.schema.primKey, q = P.auto, X = P.keyPath, oe = w;
        return X && q && (oe = Gs(X)(w)), this._trans("readwrite", function(U) {
          return R.core.mutate({ trans: U, type: "put", values: [oe], keys: E != null ? [E] : null });
        }).then(function(U) {
          return U.numFailures ? ct.reject(U.failures[0]) : U.lastResult;
        }).then(function(U) {
          if (X) try {
            L(w, X, U);
          } catch {
          }
          return U;
        });
      }, Zt.prototype.delete = function(w) {
        var E = this;
        return this._trans("readwrite", function(R) {
          return E.core.mutate({ trans: R, type: "delete", keys: [w] }).then(function(P) {
            return xr(E, [w], P);
          }).then(function(P) {
            return P.numFailures ? ct.reject(P.failures[0]) : void 0;
          });
        });
      }, Zt.prototype.clear = function() {
        var w = this;
        return this._trans("readwrite", function(E) {
          return w.core.mutate({ trans: E, type: "deleteRange", range: zo }).then(function(R) {
            return xr(w, null, R);
          });
        }).then(function(E) {
          return E.numFailures ? ct.reject(E.failures[0]) : void 0;
        });
      }, Zt.prototype.bulkGet = function(w) {
        var E = this;
        return this._trans("readonly", function(R) {
          return E.core.getMany({ keys: w, trans: R }).then(function(P) {
            return P.map(function(q) {
              return E.hook.reading.fire(q);
            });
          });
        });
      }, Zt.prototype.bulkAdd = function(w, E, R) {
        var P = this, q = Array.isArray(E) ? E : void 0, X = (R = R || (q ? void 0 : E)) ? R.allKeys : void 0;
        return this._trans("readwrite", function(oe) {
          var re = P.schema.primKey, U = re.auto, re = re.keyPath;
          if (re && q) throw new Re.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");
          if (q && q.length !== w.length) throw new Re.InvalidArgument("Arguments objects and keys must have the same length");
          var ie = w.length, re = re && U ? w.map(Gs(re)) : w;
          return P.core.mutate({ trans: oe, type: "add", keys: q, values: re, wantResults: X }).then(function(we) {
            var he = we.numFailures, _e = we.results, be = we.lastResult, we = we.failures;
            if (he === 0) return X ? _e : be;
            throw new Se("".concat(P.name, ".bulkAdd(): ").concat(he, " of ").concat(ie, " operations failed"), we);
          });
        });
      }, Zt.prototype.bulkPut = function(w, E, R) {
        var P = this, q = Array.isArray(E) ? E : void 0, X = (R = R || (q ? void 0 : E)) ? R.allKeys : void 0;
        return this._trans("readwrite", function(oe) {
          var re = P.schema.primKey, U = re.auto, re = re.keyPath;
          if (re && q) throw new Re.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");
          if (q && q.length !== w.length) throw new Re.InvalidArgument("Arguments objects and keys must have the same length");
          var ie = w.length, re = re && U ? w.map(Gs(re)) : w;
          return P.core.mutate({ trans: oe, type: "put", keys: q, values: re, wantResults: X }).then(function(we) {
            var he = we.numFailures, _e = we.results, be = we.lastResult, we = we.failures;
            if (he === 0) return X ? _e : be;
            throw new Se("".concat(P.name, ".bulkPut(): ").concat(he, " of ").concat(ie, " operations failed"), we);
          });
        });
      }, Zt.prototype.bulkUpdate = function(w) {
        var E = this, R = this.core, P = w.map(function(oe) {
          return oe.key;
        }), q = w.map(function(oe) {
          return oe.changes;
        }), X = [];
        return this._trans("readwrite", function(oe) {
          return R.getMany({ trans: oe, keys: P, cache: "clone" }).then(function(U) {
            var ie = [], re = [];
            w.forEach(function(he, _e) {
              var be = he.key, we = he.changes, ke = U[_e];
              if (ke) {
                for (var Te = 0, je = Object.keys(we); Te < je.length; Te++) {
                  var ze = je[Te], $e = we[ze];
                  if (ze === E.schema.primKey.keyPath) {
                    if (zt($e, be) !== 0) throw new Re.Constraint("Cannot update primary key in bulkUpdate()");
                  } else L(ke, ze, $e);
                }
                X.push(_e), ie.push(be), re.push(ke);
              }
            });
            var pe = ie.length;
            return R.mutate({ trans: oe, type: "put", keys: ie, values: re, updates: { keys: P, changeSpecs: q } }).then(function(he) {
              var _e = he.numFailures, be = he.failures;
              if (_e === 0) return pe;
              for (var we = 0, ke = Object.keys(be); we < ke.length; we++) {
                var Te, je = ke[we], ze = X[Number(je)];
                ze != null && (Te = be[je], delete be[je], be[ze] = Te);
              }
              throw new Se("".concat(E.name, ".bulkUpdate(): ").concat(_e, " of ").concat(pe, " operations failed"), be);
            });
          });
        });
      }, Zt.prototype.bulkDelete = function(w) {
        var E = this, R = w.length;
        return this._trans("readwrite", function(P) {
          return E.core.mutate({ trans: P, type: "delete", keys: w }).then(function(q) {
            return xr(E, w, q);
          });
        }).then(function(oe) {
          var q = oe.numFailures, X = oe.lastResult, oe = oe.failures;
          if (q === 0) return X;
          throw new Se("".concat(E.name, ".bulkDelete(): ").concat(q, " of ").concat(R, " operations failed"), oe);
        });
      }, Zt);
      function Zt() {
      }
      function Ks(w) {
        function E(oe, U) {
          if (U) {
            for (var ie = arguments.length, re = new Array(ie - 1); --ie; ) re[ie - 1] = arguments[ie];
            return R[oe].subscribe.apply(null, re), w;
          }
          if (typeof oe == "string") return R[oe];
        }
        var R = {};
        E.addEventType = X;
        for (var P = 1, q = arguments.length; P < q; ++P) X(arguments[P]);
        return E;
        function X(oe, U, ie) {
          if (typeof oe != "object") {
            var re;
            U = U || Rn;
            var pe = { subscribers: [], fire: ie = ie || Ne, subscribe: function(he) {
              pe.subscribers.indexOf(he) === -1 && (pe.subscribers.push(he), pe.fire = U(pe.fire, he));
            }, unsubscribe: function(he) {
              pe.subscribers = pe.subscribers.filter(function(_e) {
                return _e !== he;
              }), pe.fire = pe.subscribers.reduce(U, ie);
            } };
            return R[oe] = E[oe] = pe;
          }
          o(re = oe).forEach(function(he) {
            var _e = re[he];
            if (u(_e)) X(he, re[he][0], re[he][1]);
            else {
              if (_e !== "asap") throw new Re.InvalidArgument("Invalid event config");
              var be = X(he, Ue, function() {
                for (var we = arguments.length, ke = new Array(we); we--; ) ke[we] = arguments[we];
                be.subscribers.forEach(function(Te) {
                  z(function() {
                    Te.apply(null, ke);
                  });
                });
              });
            }
          });
        }
      }
      function hr(w, E) {
        return k(E).from({ prototype: w }), E;
      }
      function ci(w, E) {
        return !(w.filter || w.algorithm || w.or) && (E ? w.justLimit : !w.replayFilter);
      }
      function bs(w, E) {
        w.filter = va(w.filter, E);
      }
      function Ys(w, E, R) {
        var P = w.replayFilter;
        w.replayFilter = P ? function() {
          return va(P(), E());
        } : E, w.justLimit = R && !P;
      }
      function fi(w, E) {
        if (w.isPrimKey) return E.primaryKey;
        var R = E.getIndexByKeyPath(w.index);
        if (!R) throw new Re.Schema("KeyPath " + w.index + " on object store " + E.name + " is not indexed");
        return R;
      }
      function Fl(w, E, R) {
        var P = fi(w, E.schema);
        return E.openCursor({ trans: R, values: !w.keysOnly, reverse: w.dir === "prev", unique: !!w.unique, query: { index: P, range: w.range } });
      }
      function Ws(w, E, R, P) {
        var q = w.replayFilter ? va(w.filter, w.replayFilter()) : w.filter;
        if (w.or) {
          var X = {}, oe = function(U, ie, re) {
            var pe, he;
            q && !q(ie, re, function(_e) {
              return ie.stop(_e);
            }, function(_e) {
              return ie.fail(_e);
            }) || ((he = "" + (pe = ie.primaryKey)) == "[object ArrayBuffer]" && (he = "" + new Uint8Array(pe)), p(X, he) || (X[he] = !0, E(U, ie, re)));
          };
          return Promise.all([w.or._iterate(oe, R), Ei(Fl(w, P, R), w.algorithm, oe, !w.keysOnly && w.valueMapper)]);
        }
        return Ei(Fl(w, P, R), va(w.algorithm, q), E, !w.keysOnly && w.valueMapper);
      }
      function Ei(w, E, R, P) {
        var q = vn(P ? function(X, oe, U) {
          return R(P(X), oe, U);
        } : R);
        return w.then(function(X) {
          if (X) return X.start(function() {
            var oe = function() {
              return X.continue();
            };
            E && !E(X, function(U) {
              return oe = U;
            }, function(U) {
              X.stop(U), oe = Ne;
            }, function(U) {
              X.fail(U), oe = Ne;
            }) || q(X.value, X, function(U) {
              return oe = U;
            }), oe();
          });
        });
      }
      var Vd = (Yt.prototype._read = function(w, E) {
        var R = this._ctx;
        return R.error ? R.table._trans(null, on.bind(null, R.error)) : R.table._trans("readonly", w).then(E);
      }, Yt.prototype._write = function(w) {
        var E = this._ctx;
        return E.error ? E.table._trans(null, on.bind(null, E.error)) : E.table._trans("readwrite", w, "locked");
      }, Yt.prototype._addAlgorithm = function(w) {
        var E = this._ctx;
        E.algorithm = va(E.algorithm, w);
      }, Yt.prototype._iterate = function(w, E) {
        return Ws(this._ctx, w, E, this._ctx.table.core);
      }, Yt.prototype.clone = function(w) {
        var E = Object.create(this.constructor.prototype), R = Object.create(this._ctx);
        return w && c(R, w), E._ctx = R, E;
      }, Yt.prototype.raw = function() {
        return this._ctx.valueMapper = null, this;
      }, Yt.prototype.each = function(w) {
        var E = this._ctx;
        return this._read(function(R) {
          return Ws(E, w, R, E.table.core);
        });
      }, Yt.prototype.count = function(w) {
        var E = this;
        return this._read(function(R) {
          var P = E._ctx, q = P.table.core;
          if (ci(P, !0)) return q.count({ trans: R, query: { index: fi(P, q.schema), range: P.range } }).then(function(oe) {
            return Math.min(oe, P.limit);
          });
          var X = 0;
          return Ws(P, function() {
            return ++X, !1;
          }, R, q).then(function() {
            return X;
          });
        }).then(w);
      }, Yt.prototype.sortBy = function(w, E) {
        var R = w.split(".").reverse(), P = R[0], q = R.length - 1;
        function X(ie, re) {
          return re ? X(ie[R[re]], re - 1) : ie[P];
        }
        var oe = this._ctx.dir === "next" ? 1 : -1;
        function U(ie, re) {
          return zt(X(ie, q), X(re, q)) * oe;
        }
        return this.toArray(function(ie) {
          return ie.sort(U);
        }).then(E);
      }, Yt.prototype.toArray = function(w) {
        var E = this;
        return this._read(function(R) {
          var P = E._ctx;
          if (P.dir === "next" && ci(P, !0) && 0 < P.limit) {
            var q = P.valueMapper, X = fi(P, P.table.core.schema);
            return P.table.core.query({ trans: R, limit: P.limit, values: !0, query: { index: X, range: P.range } }).then(function(U) {
              return U = U.result, q ? U.map(q) : U;
            });
          }
          var oe = [];
          return Ws(P, function(U) {
            return oe.push(U);
          }, R, P.table.core).then(function() {
            return oe;
          });
        }, w);
      }, Yt.prototype.offset = function(w) {
        var E = this._ctx;
        return w <= 0 || (E.offset += w, ci(E) ? Ys(E, function() {
          var R = w;
          return function(P, q) {
            return R === 0 || (R === 1 ? --R : q(function() {
              P.advance(R), R = 0;
            }), !1);
          };
        }) : Ys(E, function() {
          var R = w;
          return function() {
            return --R < 0;
          };
        })), this;
      }, Yt.prototype.limit = function(w) {
        return this._ctx.limit = Math.min(this._ctx.limit, w), Ys(this._ctx, function() {
          var E = w;
          return function(R, P, q) {
            return --E <= 0 && P(q), 0 <= E;
          };
        }, !0), this;
      }, Yt.prototype.until = function(w, E) {
        return bs(this._ctx, function(R, P, q) {
          return !w(R.value) || (P(q), E);
        }), this;
      }, Yt.prototype.first = function(w) {
        return this.limit(1).toArray(function(E) {
          return E[0];
        }).then(w);
      }, Yt.prototype.last = function(w) {
        return this.reverse().first(w);
      }, Yt.prototype.filter = function(w) {
        var E;
        return bs(this._ctx, function(R) {
          return w(R.value);
        }), (E = this._ctx).isMatch = va(E.isMatch, w), this;
      }, Yt.prototype.and = function(w) {
        return this.filter(w);
      }, Yt.prototype.or = function(w) {
        return new this.db.WhereClause(this._ctx.table, w, this);
      }, Yt.prototype.reverse = function() {
        return this._ctx.dir = this._ctx.dir === "prev" ? "next" : "prev", this._ondirectionchange && this._ondirectionchange(this._ctx.dir), this;
      }, Yt.prototype.desc = function() {
        return this.reverse();
      }, Yt.prototype.eachKey = function(w) {
        var E = this._ctx;
        return E.keysOnly = !E.isMatch, this.each(function(R, P) {
          w(P.key, P);
        });
      }, Yt.prototype.eachUniqueKey = function(w) {
        return this._ctx.unique = "unique", this.eachKey(w);
      }, Yt.prototype.eachPrimaryKey = function(w) {
        var E = this._ctx;
        return E.keysOnly = !E.isMatch, this.each(function(R, P) {
          w(P.primaryKey, P);
        });
      }, Yt.prototype.keys = function(w) {
        var E = this._ctx;
        E.keysOnly = !E.isMatch;
        var R = [];
        return this.each(function(P, q) {
          R.push(q.key);
        }).then(function() {
          return R;
        }).then(w);
      }, Yt.prototype.primaryKeys = function(w) {
        var E = this._ctx;
        if (E.dir === "next" && ci(E, !0) && 0 < E.limit) return this._read(function(P) {
          var q = fi(E, E.table.core.schema);
          return E.table.core.query({ trans: P, values: !1, limit: E.limit, query: { index: q, range: E.range } });
        }).then(function(P) {
          return P.result;
        }).then(w);
        E.keysOnly = !E.isMatch;
        var R = [];
        return this.each(function(P, q) {
          R.push(q.primaryKey);
        }).then(function() {
          return R;
        }).then(w);
      }, Yt.prototype.uniqueKeys = function(w) {
        return this._ctx.unique = "unique", this.keys(w);
      }, Yt.prototype.firstKey = function(w) {
        return this.limit(1).keys(function(E) {
          return E[0];
        }).then(w);
      }, Yt.prototype.lastKey = function(w) {
        return this.reverse().firstKey(w);
      }, Yt.prototype.distinct = function() {
        var w = this._ctx, w = w.index && w.table.schema.idxByName[w.index];
        if (!w || !w.multi) return this;
        var E = {};
        return bs(this._ctx, function(q) {
          var P = q.primaryKey.toString(), q = p(E, P);
          return E[P] = !0, !q;
        }), this;
      }, Yt.prototype.modify = function(w) {
        var E = this, R = this._ctx;
        return this._write(function(P) {
          var q = typeof w == "function" ? w : function(ke) {
            return ba(ke, w);
          }, X = R.table.core, re = X.schema.primaryKey, oe = re.outbound, U = re.extractKey, ie = 200, re = E.db._options.modifyChunkSize;
          re && (ie = typeof re == "object" ? re[X.name] || re["*"] || 200 : re);
          function pe(ke, ze) {
            var je = ze.failures, ze = ze.numFailures;
            _e += ke - ze;
            for (var $e = 0, Ge = o(je); $e < Ge.length; $e++) {
              var nt = Ge[$e];
              he.push(je[nt]);
            }
          }
          var he = [], _e = 0, be = [], we = w === Kc;
          return E.clone().primaryKeys().then(function(ke) {
            function Te(ze) {
              var $e = Math.min(ie, ke.length - ze), Ge = ke.slice(ze, ze + $e);
              return (we ? Promise.resolve([]) : X.getMany({ trans: P, keys: Ge, cache: "immutable" })).then(function(nt) {
                var lt = [], He = [], ot = oe ? [] : null, ut = we ? Ge : [];
                if (!we) for (var Je = 0; Je < $e; ++Je) {
                  var pt = nt[Je], _t = { value: me(pt), primKey: ke[ze + Je] };
                  q.call(_t, _t.value, _t) !== !1 && (_t.value == null ? ut.push(ke[ze + Je]) : oe || zt(U(pt), U(_t.value)) === 0 ? (He.push(_t.value), oe && ot.push(ke[ze + Je])) : (ut.push(ke[ze + Je]), lt.push(_t.value)));
                }
                return Promise.resolve(0 < lt.length && X.mutate({ trans: P, type: "add", values: lt }).then(function(Rt) {
                  for (var Dt in Rt.failures) ut.splice(parseInt(Dt), 1);
                  pe(lt.length, Rt);
                })).then(function() {
                  return (0 < He.length || je && typeof w == "object") && X.mutate({ trans: P, type: "put", keys: ot, values: He, criteria: je, changeSpec: typeof w != "function" && w, isAdditionalChunk: 0 < ze }).then(function(Rt) {
                    return pe(He.length, Rt);
                  });
                }).then(function() {
                  return (0 < ut.length || je && we) && X.mutate({ trans: P, type: "delete", keys: ut, criteria: je, isAdditionalChunk: 0 < ze }).then(function(Rt) {
                    return xr(R.table, ut, Rt);
                  }).then(function(Rt) {
                    return pe(ut.length, Rt);
                  });
                }).then(function() {
                  return ke.length > ze + $e && Te(ze + ie);
                });
              });
            }
            var je = ci(R) && R.limit === 1 / 0 && (typeof w != "function" || we) && { index: R.index, range: R.range };
            return Te(0).then(function() {
              if (0 < he.length) throw new xe("Error modifying one or more objects", he, _e, be);
              return ke.length;
            });
          });
        });
      }, Yt.prototype.delete = function() {
        var w = this._ctx, E = w.range;
        return !ci(w) || w.table.schema.yProps || !w.isPrimKey && E.type !== 3 ? this.modify(Kc) : this._write(function(R) {
          var P = w.table.core.schema.primaryKey, q = E;
          return w.table.core.count({ trans: R, query: { index: P, range: q } }).then(function(X) {
            return w.table.core.mutate({ trans: R, type: "deleteRange", range: q }).then(function(ie) {
              var U = ie.failures, ie = ie.numFailures;
              if (ie) throw new xe("Could not delete some values", Object.keys(U).map(function(re) {
                return U[re];
              }), X - ie);
              return X - ie;
            });
          });
        });
      }, Yt);
      function Yt() {
      }
      var Kc = function(w, E) {
        return E.value = null;
      };
      function Ou(w, E) {
        return w < E ? -1 : w === E ? 0 : 1;
      }
      function Hd(w, E) {
        return E < w ? -1 : w === E ? 0 : 1;
      }
      function ti(w, E, R) {
        return w = w instanceof ws ? new w.Collection(w) : w, w._ctx.error = new (R || TypeError)(E), w;
      }
      function wa(w) {
        return new w.Collection(w, function() {
          return Du("");
        }).limit(0);
      }
      function ki(w, E, R, P) {
        var q, X, oe, U, ie, re, pe, he = R.length;
        if (!R.every(function(we) {
          return typeof we == "string";
        })) return ti(w, Zn);
        function _e(we) {
          q = we === "next" ? function(Te) {
            return Te.toUpperCase();
          } : function(Te) {
            return Te.toLowerCase();
          }, X = we === "next" ? function(Te) {
            return Te.toLowerCase();
          } : function(Te) {
            return Te.toUpperCase();
          }, oe = we === "next" ? Ou : Hd;
          var ke = R.map(function(Te) {
            return { lower: X(Te), upper: q(Te) };
          }).sort(function(Te, je) {
            return oe(Te.lower, je.lower);
          });
          U = ke.map(function(Te) {
            return Te.upper;
          }), ie = ke.map(function(Te) {
            return Te.lower;
          }), pe = (re = we) === "next" ? "" : P;
        }
        _e("next"), w = new w.Collection(w, function() {
          return _a(U[0], ie[he - 1] + P);
        }), w._ondirectionchange = function(we) {
          _e(we);
        };
        var be = 0;
        return w._addAlgorithm(function(we, ke, Te) {
          var je = we.key;
          if (typeof je != "string") return !1;
          var ze = X(je);
          if (E(ze, ie, be)) return !0;
          for (var $e = null, Ge = be; Ge < he; ++Ge) {
            var nt = (function(lt, He, ot, ut, Je, pt) {
              for (var _t = Math.min(lt.length, ut.length), Rt = -1, Dt = 0; Dt < _t; ++Dt) {
                var Ln = He[Dt];
                if (Ln !== ut[Dt]) return Je(lt[Dt], ot[Dt]) < 0 ? lt.substr(0, Dt) + ot[Dt] + ot.substr(Dt + 1) : Je(lt[Dt], ut[Dt]) < 0 ? lt.substr(0, Dt) + ut[Dt] + ot.substr(Dt + 1) : 0 <= Rt ? lt.substr(0, Rt) + He[Rt] + ot.substr(Rt + 1) : null;
                Je(lt[Dt], Ln) < 0 && (Rt = Dt);
              }
              return _t < ut.length && pt === "next" ? lt + ot.substr(lt.length) : _t < lt.length && pt === "prev" ? lt.substr(0, ot.length) : Rt < 0 ? null : lt.substr(0, Rt) + ut[Rt] + ot.substr(Rt + 1);
            })(je, ze, U[Ge], ie[Ge], oe, re);
            nt === null && $e === null ? be = Ge + 1 : ($e === null || 0 < oe($e, nt)) && ($e = nt);
          }
          return ke($e !== null ? function() {
            we.continue($e + pe);
          } : Te), !1;
        }), w;
      }
      function _a(w, E, R, P) {
        return { type: 2, lower: w, upper: E, lowerOpen: R, upperOpen: P };
      }
      function Du(w) {
        return { type: 1, lower: w, upper: w };
      }
      var ws = (Object.defineProperty(In.prototype, "Collection", { get: function() {
        return this._ctx.table.db.Collection;
      }, enumerable: !1, configurable: !0 }), In.prototype.between = function(w, E, R, P) {
        R = R !== !1, P = P === !0;
        try {
          return 0 < this._cmp(w, E) || this._cmp(w, E) === 0 && (R || P) && (!R || !P) ? wa(this) : new this.Collection(this, function() {
            return _a(w, E, !R, !P);
          });
        } catch {
          return ti(this, dr);
        }
      }, In.prototype.equals = function(w) {
        return w == null ? ti(this, dr) : new this.Collection(this, function() {
          return Du(w);
        });
      }, In.prototype.above = function(w) {
        return w == null ? ti(this, dr) : new this.Collection(this, function() {
          return _a(w, void 0, !0);
        });
      }, In.prototype.aboveOrEqual = function(w) {
        return w == null ? ti(this, dr) : new this.Collection(this, function() {
          return _a(w, void 0, !1);
        });
      }, In.prototype.below = function(w) {
        return w == null ? ti(this, dr) : new this.Collection(this, function() {
          return _a(void 0, w, !1, !0);
        });
      }, In.prototype.belowOrEqual = function(w) {
        return w == null ? ti(this, dr) : new this.Collection(this, function() {
          return _a(void 0, w);
        });
      }, In.prototype.startsWith = function(w) {
        return typeof w != "string" ? ti(this, Zn) : this.between(w, w + ei, !0, !0);
      }, In.prototype.startsWithIgnoreCase = function(w) {
        return w === "" ? this.startsWith(w) : ki(this, function(E, R) {
          return E.indexOf(R[0]) === 0;
        }, [w], ei);
      }, In.prototype.equalsIgnoreCase = function(w) {
        return ki(this, function(E, R) {
          return E === R[0];
        }, [w], "");
      }, In.prototype.anyOfIgnoreCase = function() {
        var w = W.apply(ce, arguments);
        return w.length === 0 ? wa(this) : ki(this, function(E, R) {
          return R.indexOf(E) !== -1;
        }, w, "");
      }, In.prototype.startsWithAnyOfIgnoreCase = function() {
        var w = W.apply(ce, arguments);
        return w.length === 0 ? wa(this) : ki(this, function(E, R) {
          return R.some(function(P) {
            return E.indexOf(P) === 0;
          });
        }, w, ei);
      }, In.prototype.anyOf = function() {
        var w = this, E = W.apply(ce, arguments), R = this._cmp;
        try {
          E.sort(R);
        } catch {
          return ti(this, dr);
        }
        if (E.length === 0) return wa(this);
        var P = new this.Collection(this, function() {
          return _a(E[0], E[E.length - 1]);
        });
        P._ondirectionchange = function(X) {
          R = X === "next" ? w._ascending : w._descending, E.sort(R);
        };
        var q = 0;
        return P._addAlgorithm(function(X, oe, U) {
          for (var ie = X.key; 0 < R(ie, E[q]); ) if (++q === E.length) return oe(U), !1;
          return R(ie, E[q]) === 0 || (oe(function() {
            X.continue(E[q]);
          }), !1);
        }), P;
      }, In.prototype.notEqual = function(w) {
        return this.inAnyRange([[-1 / 0, w], [w, this.db._maxKey]], { includeLowers: !1, includeUppers: !1 });
      }, In.prototype.noneOf = function() {
        var w = W.apply(ce, arguments);
        if (w.length === 0) return new this.Collection(this);
        try {
          w.sort(this._ascending);
        } catch {
          return ti(this, dr);
        }
        var E = w.reduce(function(R, P) {
          return R ? R.concat([[R[R.length - 1][1], P]]) : [[-1 / 0, P]];
        }, null);
        return E.push([w[w.length - 1], this.db._maxKey]), this.inAnyRange(E, { includeLowers: !1, includeUppers: !1 });
      }, In.prototype.inAnyRange = function(je, E) {
        var R = this, P = this._cmp, q = this._ascending, X = this._descending, oe = this._min, U = this._max;
        if (je.length === 0) return wa(this);
        if (!je.every(function(ze) {
          return ze[0] !== void 0 && ze[1] !== void 0 && q(ze[0], ze[1]) <= 0;
        })) return ti(this, "First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower", Re.InvalidArgument);
        var ie = !E || E.includeLowers !== !1, re = E && E.includeUppers === !0, pe, he = q;
        function _e(ze, $e) {
          return he(ze[0], $e[0]);
        }
        try {
          (pe = je.reduce(function(ze, $e) {
            for (var Ge = 0, nt = ze.length; Ge < nt; ++Ge) {
              var lt = ze[Ge];
              if (P($e[0], lt[1]) < 0 && 0 < P($e[1], lt[0])) {
                lt[0] = oe(lt[0], $e[0]), lt[1] = U(lt[1], $e[1]);
                break;
              }
            }
            return Ge === nt && ze.push($e), ze;
          }, [])).sort(_e);
        } catch {
          return ti(this, dr);
        }
        var be = 0, we = re ? function(ze) {
          return 0 < q(ze, pe[be][1]);
        } : function(ze) {
          return 0 <= q(ze, pe[be][1]);
        }, ke = ie ? function(ze) {
          return 0 < X(ze, pe[be][0]);
        } : function(ze) {
          return 0 <= X(ze, pe[be][0]);
        }, Te = we, je = new this.Collection(this, function() {
          return _a(pe[0][0], pe[pe.length - 1][1], !ie, !re);
        });
        return je._ondirectionchange = function(ze) {
          he = ze === "next" ? (Te = we, q) : (Te = ke, X), pe.sort(_e);
        }, je._addAlgorithm(function(ze, $e, Ge) {
          for (var nt, lt = ze.key; Te(lt); ) if (++be === pe.length) return $e(Ge), !1;
          return !we(nt = lt) && !ke(nt) || (R._cmp(lt, pe[be][1]) === 0 || R._cmp(lt, pe[be][0]) === 0 || $e(function() {
            he === q ? ze.continue(pe[be][0]) : ze.continue(pe[be][1]);
          }), !1);
        }), je;
      }, In.prototype.startsWithAnyOf = function() {
        var w = W.apply(ce, arguments);
        return w.every(function(E) {
          return typeof E == "string";
        }) ? w.length === 0 ? wa(this) : this.inAnyRange(w.map(function(E) {
          return [E, E + ei];
        })) : ti(this, "startsWithAnyOf() only works with strings");
      }, In);
      function In() {
      }
      function Vi(w) {
        return vn(function(E) {
          return Xs(E), w(E.target.error), !1;
        });
      }
      function Xs(w) {
        w.stopPropagation && w.stopPropagation(), w.preventDefault && w.preventDefault();
      }
      var Lo = "storagemutated", Ya = "x-storagemutated-1", Rr = Ks(null, Lo), Yc = (ni.prototype._lock = function() {
        return D(!it.global), ++this._reculock, this._reculock !== 1 || it.global || (it.lockOwnerFor = this), this;
      }, ni.prototype._unlock = function() {
        if (D(!it.global), --this._reculock == 0) for (it.global || (it.lockOwnerFor = null); 0 < this._blockedFuncs.length && !this._locked(); ) {
          var w = this._blockedFuncs.shift();
          try {
            li(w[1], w[0]);
          } catch {
          }
        }
        return this;
      }, ni.prototype._locked = function() {
        return this._reculock && it.lockOwnerFor !== this;
      }, ni.prototype.create = function(w) {
        var E = this;
        if (!this.mode) return this;
        var R = this.db.idbdb, P = this.db._state.dbOpenError;
        if (D(!this.idbtrans), !w && !R) switch (P && P.name) {
          case "DatabaseClosedError":
            throw new Re.DatabaseClosed(P);
          case "MissingAPIError":
            throw new Re.MissingAPI(P.message, P);
          default:
            throw new Re.OpenFailed(P);
        }
        if (!this.active) throw new Re.TransactionInactive();
        return D(this._completion._state === null), (w = this.idbtrans = w || (this.db.core || R).transaction(this.storeNames, this.mode, { durability: this.chromeTransactionDurability })).onerror = vn(function(q) {
          Xs(q), E._reject(w.error);
        }), w.onabort = vn(function(q) {
          Xs(q), E.active && E._reject(new Re.Abort(w.error)), E.active = !1, E.on("abort").fire(q);
        }), w.oncomplete = vn(function() {
          E.active = !1, E._resolve(), "mutatedParts" in w && Rr.storagemutated.fire(w.mutatedParts);
        }), this;
      }, ni.prototype._promise = function(w, E, R) {
        var P = this;
        if (w === "readwrite" && this.mode !== "readwrite") return on(new Re.ReadOnly("Transaction is readonly"));
        if (!this.active) return on(new Re.TransactionInactive());
        if (this._locked()) return new ct(function(X, oe) {
          P._blockedFuncs.push([function() {
            P._promise(w, E, R).then(X, oe);
          }, it]);
        });
        if (R) return wn(function() {
          var X = new ct(function(oe, U) {
            P._lock();
            var ie = E(oe, U, P);
            ie && ie.then && ie.then(oe, U);
          });
          return X.finally(function() {
            return P._unlock();
          }), X._lib = !0, X;
        });
        var q = new ct(function(X, oe) {
          var U = E(X, oe, P);
          U && U.then && U.then(X, oe);
        });
        return q._lib = !0, q;
      }, ni.prototype._root = function() {
        return this.parent ? this.parent._root() : this;
      }, ni.prototype.waitFor = function(w) {
        var E, R = this._root(), P = ct.resolve(w);
        R._waitingFor ? R._waitingFor = R._waitingFor.then(function() {
          return P;
        }) : (R._waitingFor = P, R._waitingQueue = [], E = R.idbtrans.objectStore(R.storeNames[0]), (function X() {
          for (++R._spinCount; R._waitingQueue.length; ) R._waitingQueue.shift()();
          R._waitingFor && (E.get(-1 / 0).onsuccess = X);
        })());
        var q = R._waitingFor;
        return new ct(function(X, oe) {
          P.then(function(U) {
            return R._waitingQueue.push(vn(X.bind(null, U)));
          }, function(U) {
            return R._waitingQueue.push(vn(oe.bind(null, U)));
          }).finally(function() {
            R._waitingFor === q && (R._waitingFor = null);
          });
        });
      }, ni.prototype.abort = function() {
        this.active && (this.active = !1, this.idbtrans && this.idbtrans.abort(), this._reject(new Re.Abort()));
      }, ni.prototype.table = function(w) {
        var E = this._memoizedTables || (this._memoizedTables = {});
        if (p(E, w)) return E[w];
        var R = this.schema[w];
        if (!R) throw new Re.NotFound("Table " + w + " not part of transaction");
        return R = new this.db.Table(w, R, this), R.core = this.db.core.table(w), E[w] = R;
      }, ni);
      function ni() {
      }
      function Sa(w, E, R, P, q, X, oe, U) {
        return { name: w, keyPath: E, unique: R, multi: P, auto: q, compound: X, src: (R && !oe ? "&" : "") + (P ? "*" : "") + (q ? "++" : "") + Iu(E), type: U };
      }
      function Iu(w) {
        return typeof w == "string" ? w : w ? "[" + [].join.call(w, "+") + "]" : "";
      }
      function cn(w, E, R) {
        return { name: w, primKey: E, indexes: R, mappedClass: null, idxByName: (P = function(q) {
          return [q.name, q];
        }, R.reduce(function(q, X, oe) {
          return oe = P(X, oe), oe && (q[oe[0]] = oe[1]), q;
        }, {})) };
        var P;
      }
      var ln = function(w) {
        try {
          return w.only([[]]), ln = function() {
            return [[]];
          }, [[]];
        } catch {
          return ln = function() {
            return ei;
          }, ei;
        }
      };
      function Bo(w) {
        return w == null ? function() {
        } : typeof w == "string" ? (E = w).split(".").length === 1 ? function(R) {
          return R[E];
        } : function(R) {
          return I(R, E);
        } : function(R) {
          return I(R, w);
        };
        var E;
      }
      function Ul(w) {
        return [].slice.call(w);
      }
      var Gd = 0;
      function br(w) {
        return w == null ? ":id" : typeof w == "string" ? w : "[".concat(w.join("+"), "]");
      }
      function Qs(w, E, ie) {
        function P(Te) {
          if (Te.type === 3) return null;
          if (Te.type === 4) throw new Error("Cannot convert never type to IDBKeyRange");
          var be = Te.lower, we = Te.upper, ke = Te.lowerOpen, Te = Te.upperOpen;
          return be === void 0 ? we === void 0 ? null : E.upperBound(we, !!Te) : we === void 0 ? E.lowerBound(be, !!ke) : E.bound(be, we, !!ke, !!Te);
        }
        function q(_e) {
          var be, we = _e.name;
          return { name: we, schema: _e, mutate: function(ke) {
            var Te = ke.trans, je = ke.type, ze = ke.keys, $e = ke.values, Ge = ke.range;
            return new Promise(function(nt, lt) {
              nt = vn(nt);
              var He = Te.objectStore(we), ot = He.keyPath == null, ut = je === "put" || je === "add";
              if (!ut && je !== "delete" && je !== "deleteRange") throw new Error("Invalid operation type: " + je);
              var Je, pt = (ze || $e || { length: 1 }).length;
              if (ze && $e && ze.length !== $e.length) throw new Error("Given keys array must have same length as given values array.");
              if (pt === 0) return nt({ numFailures: 0, failures: {}, results: [], lastResult: void 0 });
              function _t(pr) {
                ++Ln, Xs(pr);
              }
              var Rt = [], Dt = [], Ln = 0;
              if (je === "deleteRange") {
                if (Ge.type === 4) return nt({ numFailures: Ln, failures: Dt, results: [], lastResult: void 0 });
                Ge.type === 3 ? Rt.push(Je = He.clear()) : Rt.push(Je = He.delete(P(Ge)));
              } else {
                var ot = ut ? ot ? [$e, ze] : [$e, null] : [ze, null], Et = ot[0], mr = ot[1];
                if (ut) for (var Nn = 0; Nn < pt; ++Nn) Rt.push(Je = mr && mr[Nn] !== void 0 ? He[je](Et[Nn], mr[Nn]) : He[je](Et[Nn])), Je.onerror = _t;
                else for (Nn = 0; Nn < pt; ++Nn) Rt.push(Je = He[je](Et[Nn])), Je.onerror = _t;
              }
              function Ko(pr) {
                pr = pr.target.result, Rt.forEach(function($r, Hu) {
                  return $r.error != null && (Dt[Hu] = $r.error);
                }), nt({ numFailures: Ln, failures: Dt, results: je === "delete" ? ze : Rt.map(function($r) {
                  return $r.result;
                }), lastResult: pr });
              }
              Je.onerror = function(pr) {
                _t(pr), Ko(pr);
              }, Je.onsuccess = Ko;
            });
          }, getMany: function(ke) {
            var Te = ke.trans, je = ke.keys;
            return new Promise(function(ze, $e) {
              ze = vn(ze);
              for (var Ge, nt = Te.objectStore(we), lt = je.length, He = new Array(lt), ot = 0, ut = 0, Je = function(Rt) {
                Rt = Rt.target, He[Rt._pos] = Rt.result, ++ut === ot && ze(He);
              }, pt = Vi($e), _t = 0; _t < lt; ++_t) je[_t] != null && ((Ge = nt.get(je[_t]))._pos = _t, Ge.onsuccess = Je, Ge.onerror = pt, ++ot);
              ot === 0 && ze(He);
            });
          }, get: function(ke) {
            var Te = ke.trans, je = ke.key;
            return new Promise(function(ze, $e) {
              ze = vn(ze);
              var Ge = Te.objectStore(we).get(je);
              Ge.onsuccess = function(nt) {
                return ze(nt.target.result);
              }, Ge.onerror = Vi($e);
            });
          }, query: (be = re, function(ke) {
            return new Promise(function(Te, je) {
              Te = vn(Te);
              var ze, $e, Ge, ot = ke.trans, nt = ke.values, lt = ke.limit, Je = ke.query, He = lt === 1 / 0 ? void 0 : lt, ut = Je.index, Je = Je.range, ot = ot.objectStore(we), ut = ut.isPrimaryKey ? ot : ot.index(ut.name), Je = P(Je);
              if (lt === 0) return Te({ result: [] });
              be ? ((He = nt ? ut.getAll(Je, He) : ut.getAllKeys(Je, He)).onsuccess = function(pt) {
                return Te({ result: pt.target.result });
              }, He.onerror = Vi(je)) : (ze = 0, $e = !nt && "openKeyCursor" in ut ? ut.openKeyCursor(Je) : ut.openCursor(Je), Ge = [], $e.onsuccess = function(pt) {
                var _t = $e.result;
                return _t ? (Ge.push(nt ? _t.value : _t.primaryKey), ++ze === lt ? Te({ result: Ge }) : void _t.continue()) : Te({ result: Ge });
              }, $e.onerror = Vi(je));
            });
          }), openCursor: function(ke) {
            var Te = ke.trans, je = ke.values, ze = ke.query, $e = ke.reverse, Ge = ke.unique;
            return new Promise(function(nt, lt) {
              nt = vn(nt);
              var ut = ze.index, He = ze.range, ot = Te.objectStore(we), ot = ut.isPrimaryKey ? ot : ot.index(ut.name), ut = $e ? Ge ? "prevunique" : "prev" : Ge ? "nextunique" : "next", Je = !je && "openKeyCursor" in ot ? ot.openKeyCursor(P(He), ut) : ot.openCursor(P(He), ut);
              Je.onerror = Vi(lt), Je.onsuccess = vn(function(pt) {
                var _t, Rt, Dt, Ln, Et = Je.result;
                Et ? (Et.___id = ++Gd, Et.done = !1, _t = Et.continue.bind(Et), Rt = (Rt = Et.continuePrimaryKey) && Rt.bind(Et), Dt = Et.advance.bind(Et), Ln = function() {
                  throw new Error("Cursor not stopped");
                }, Et.trans = Te, Et.stop = Et.continue = Et.continuePrimaryKey = Et.advance = function() {
                  throw new Error("Cursor not started");
                }, Et.fail = vn(lt), Et.next = function() {
                  var mr = this, Nn = 1;
                  return this.start(function() {
                    return Nn-- ? mr.continue() : mr.stop();
                  }).then(function() {
                    return mr;
                  });
                }, Et.start = function(mr) {
                  function Nn() {
                    if (Je.result) try {
                      mr();
                    } catch (pr) {
                      Et.fail(pr);
                    }
                    else Et.done = !0, Et.start = function() {
                      throw new Error("Cursor behind last entry");
                    }, Et.stop();
                  }
                  var Ko = new Promise(function(pr, $r) {
                    pr = vn(pr), Je.onerror = Vi($r), Et.fail = $r, Et.stop = function(Hu) {
                      Et.stop = Et.continue = Et.continuePrimaryKey = Et.advance = Ln, pr(Hu);
                    };
                  });
                  return Je.onsuccess = vn(function(pr) {
                    Je.onsuccess = Nn, Nn();
                  }), Et.continue = _t, Et.continuePrimaryKey = Rt, Et.advance = Dt, Nn(), Ko;
                }, nt(Et)) : nt(null);
              }, lt);
            });
          }, count: function(ke) {
            var Te = ke.query, je = ke.trans, ze = Te.index, $e = Te.range;
            return new Promise(function(Ge, nt) {
              var lt = je.objectStore(we), He = ze.isPrimaryKey ? lt : lt.index(ze.name), lt = P($e), He = lt ? He.count(lt) : He.count();
              He.onsuccess = vn(function(ot) {
                return Ge(ot.target.result);
              }), He.onerror = Vi(nt);
            });
          } };
        }
        var X, oe, U, pe = (oe = ie, U = Ul((X = w).objectStoreNames), { schema: { name: X.name, tables: U.map(function(_e) {
          return oe.objectStore(_e);
        }).map(function(_e) {
          var be = _e.keyPath, Te = _e.autoIncrement, we = u(be), ke = {}, Te = { name: _e.name, primaryKey: { name: null, isPrimaryKey: !0, outbound: be == null, compound: we, keyPath: be, autoIncrement: Te, unique: !0, extractKey: Bo(be) }, indexes: Ul(_e.indexNames).map(function(je) {
            return _e.index(je);
          }).map(function(Ge) {
            var ze = Ge.name, $e = Ge.unique, nt = Ge.multiEntry, Ge = Ge.keyPath, nt = { name: ze, compound: u(Ge), keyPath: Ge, unique: $e, multiEntry: nt, extractKey: Bo(Ge) };
            return ke[br(Ge)] = nt;
          }), getIndexByKeyPath: function(je) {
            return ke[br(je)];
          } };
          return ke[":id"] = Te.primaryKey, be != null && (ke[br(be)] = Te.primaryKey), Te;
        }) }, hasGetAll: 0 < U.length && "getAll" in oe.objectStore(U[0]) && !(typeof navigator < "u" && /Safari/.test(navigator.userAgent) && !/(Chrome\/|Edge\/)/.test(navigator.userAgent) && [].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1] < 604) }), ie = pe.schema, re = pe.hasGetAll, pe = ie.tables.map(q), he = {};
        return pe.forEach(function(_e) {
          return he[_e.name] = _e;
        }), { stack: "dbcore", transaction: w.transaction.bind(w), table: function(_e) {
          if (!he[_e]) throw new Error("Table '".concat(_e, "' not found"));
          return he[_e];
        }, MIN_KEY: -1 / 0, MAX_KEY: ln(E), schema: ie };
      }
      function Pu(w, E, R, P) {
        var q = R.IDBKeyRange;
        return R.indexedDB, { dbcore: (P = Qs(E, q, P), w.dbcore.reduce(function(X, oe) {
          return oe = oe.create, r(r({}, X), oe(X));
        }, P)) };
      }
      function Wa(w, P) {
        var R = P.db, P = Pu(w._middlewares, R, w._deps, P);
        w.core = P.dbcore, w.tables.forEach(function(q) {
          var X = q.name;
          w.core.schema.tables.some(function(oe) {
            return oe.name === X;
          }) && (q.core = w.core.table(X), w[X] instanceof w.Table && (w[X].core = q.core));
        });
      }
      function zu(w, E, R, P) {
        R.forEach(function(q) {
          var X = P[q];
          E.forEach(function(oe) {
            var U = (function ie(re, pe) {
              return A(re, pe) || (re = d(re)) && ie(re, pe);
            })(oe, q);
            (!U || "value" in U && U.value === void 0) && (oe === w.Transaction.prototype || oe instanceof w.Transaction ? S(oe, q, { get: function() {
              return this.table(q);
            }, set: function(ie) {
              b(this, q, { value: ie, writable: !0, configurable: !0, enumerable: !0 });
            } }) : oe[q] = new w.Table(q, X));
          });
        });
      }
      function Jn(w, E) {
        E.forEach(function(R) {
          for (var P in R) R[P] instanceof w.Table && delete R[P];
        });
      }
      function $l(w, E) {
        return w._cfg.version - E._cfg.version;
      }
      function Hi(w, E, R, P) {
        var q = w._dbSchema;
        R.objectStoreNames.contains("$meta") && !q.$meta && (q.$meta = cn("$meta", Xc("")[0], []), w._storeNames.push("$meta"));
        var X = w._createTransaction("readwrite", w._storeNames, q);
        X.create(R), X._completion.catch(P);
        var oe = X._reject.bind(X), U = it.transless || it;
        wn(function() {
          return it.trans = X, it.transless = U, E !== 0 ? (Wa(w, R), re = E, ((ie = X).storeNames.includes("$meta") ? ie.table("$meta").get("version").then(function(pe) {
            return pe ?? re;
          }) : ct.resolve(re)).then(function(pe) {
            return _e = pe, be = X, we = R, ke = [], pe = (he = w)._versions, Te = he._dbSchema = Zs(0, he.idbdb, we), (pe = pe.filter(function(je) {
              return je._cfg.version >= _e;
            })).length !== 0 ? (pe.forEach(function(je) {
              ke.push(function() {
                var ze = Te, $e = je._cfg.dbschema;
                Gl(he, ze, we), Gl(he, $e, we), Te = he._dbSchema = $e;
                var Ge = qo(ze, $e);
                Ge.add.forEach(function(ut) {
                  ri(we, ut[0], ut[1].primKey, ut[1].indexes);
                }), Ge.change.forEach(function(ut) {
                  if (ut.recreate) throw new Re.Upgrade("Not yet support for changing primary key");
                  var Je = we.objectStore(ut.name);
                  ut.add.forEach(function(pt) {
                    return Hl(Je, pt);
                  }), ut.change.forEach(function(pt) {
                    Je.deleteIndex(pt.name), Hl(Je, pt);
                  }), ut.del.forEach(function(pt) {
                    return Je.deleteIndex(pt);
                  });
                });
                var nt = je._cfg.contentUpgrade;
                if (nt && je._cfg.version > _e) {
                  Wa(he, we), be._memoizedTables = {};
                  var lt = K($e);
                  Ge.del.forEach(function(ut) {
                    lt[ut] = ze[ut];
                  }), Jn(he, [he.Transaction.prototype]), zu(he, [he.Transaction.prototype], o(lt), lt), be.schema = lt;
                  var He, ot = $(nt);
                  return ot && Qn(), Ge = ct.follow(function() {
                    var ut;
                    (He = nt(be)) && ot && (ut = Mr.bind(null, null), He.then(ut, ut));
                  }), He && typeof He.then == "function" ? ct.resolve(He) : Ge.then(function() {
                    return He;
                  });
                }
              }), ke.push(function(ze) {
                var $e, Ge, nt = je._cfg.dbschema;
                $e = nt, Ge = ze, [].slice.call(Ge.db.objectStoreNames).forEach(function(lt) {
                  return $e[lt] == null && Ge.db.deleteObjectStore(lt);
                }), Jn(he, [he.Transaction.prototype]), zu(he, [he.Transaction.prototype], he._storeNames, he._dbSchema), be.schema = he._dbSchema;
              }), ke.push(function(ze) {
                he.idbdb.objectStoreNames.contains("$meta") && (Math.ceil(he.idbdb.version / 10) === je._cfg.version ? (he.idbdb.deleteObjectStore("$meta"), delete he._dbSchema.$meta, he._storeNames = he._storeNames.filter(function($e) {
                  return $e !== "$meta";
                })) : ze.objectStore("$meta").put(je._cfg.version, "version"));
              });
            }), (function je() {
              return ke.length ? ct.resolve(ke.shift()(be.idbtrans)).then(je) : ct.resolve();
            })().then(function() {
              Wc(Te, we);
            })) : ct.resolve();
            var he, _e, be, we, ke, Te;
          }).catch(oe)) : (o(q).forEach(function(pe) {
            ri(R, pe, q[pe].primKey, q[pe].indexes);
          }), Wa(w, R), void ct.follow(function() {
            return w.on.populate.fire(X);
          }).catch(oe));
          var ie, re;
        });
      }
      function Vl(w, E) {
        Wc(w._dbSchema, E), E.db.version % 10 != 0 || E.objectStoreNames.contains("$meta") || E.db.createObjectStore("$meta").add(Math.ceil(E.db.version / 10 - 1), "version");
        var R = Zs(0, w.idbdb, E);
        Gl(w, w._dbSchema, E);
        for (var P = 0, q = qo(R, w._dbSchema).change; P < q.length; P++) {
          var X = (function(oe) {
            if (oe.change.length || oe.recreate) return console.warn("Unable to patch indexes of table ".concat(oe.name, " because it has changes on the type of index or primary key.")), { value: void 0 };
            var U = E.objectStore(oe.name);
            oe.add.forEach(function(ie) {
              Ht && console.debug("Dexie upgrade patch: Creating missing index ".concat(oe.name, ".").concat(ie.src)), Hl(U, ie);
            });
          })(q[P]);
          if (typeof X == "object") return X.value;
        }
      }
      function qo(w, E) {
        var R, P = { del: [], add: [], change: [] };
        for (R in w) E[R] || P.del.push(R);
        for (R in E) {
          var q = w[R], X = E[R];
          if (q) {
            var oe = { name: R, def: X, recreate: !1, del: [], add: [], change: [] };
            if ("" + (q.primKey.keyPath || "") != "" + (X.primKey.keyPath || "") || q.primKey.auto !== X.primKey.auto) oe.recreate = !0, P.change.push(oe);
            else {
              var U = q.idxByName, ie = X.idxByName, re = void 0;
              for (re in U) ie[re] || oe.del.push(re);
              for (re in ie) {
                var pe = U[re], he = ie[re];
                pe ? pe.src !== he.src && oe.change.push(he) : oe.add.push(he);
              }
              (0 < oe.del.length || 0 < oe.add.length || 0 < oe.change.length) && P.change.push(oe);
            }
          } else P.add.push([R, X]);
        }
        return P;
      }
      function ri(w, E, R, P) {
        var q = w.db.createObjectStore(E, R.keyPath ? { keyPath: R.keyPath, autoIncrement: R.auto } : { autoIncrement: R.auto });
        return P.forEach(function(X) {
          return Hl(q, X);
        }), q;
      }
      function Wc(w, E) {
        o(w).forEach(function(R) {
          E.db.objectStoreNames.contains(R) || (Ht && console.debug("Dexie: Creating missing table", R), ri(E, R, w[R].primKey, w[R].indexes));
        });
      }
      function Hl(w, E) {
        w.createIndex(E.name, E.keyPath, { unique: E.unique, multiEntry: E.multi });
      }
      function Zs(w, E, R) {
        var P = {};
        return M(E.objectStoreNames, 0).forEach(function(q) {
          for (var X = R.objectStore(q), oe = Sa(Iu(re = X.keyPath), re || "", !0, !1, !!X.autoIncrement, re && typeof re != "string", !0), U = [], ie = 0; ie < X.indexNames.length; ++ie) {
            var pe = X.index(X.indexNames[ie]), re = pe.keyPath, pe = Sa(pe.name, re, !!pe.unique, !!pe.multiEntry, !1, re && typeof re != "string", !1);
            U.push(pe);
          }
          P[q] = cn(q, oe, U);
        }), P;
      }
      function Gl(w, E, R) {
        for (var P = R.db.objectStoreNames, q = 0; q < P.length; ++q) {
          var X = P[q], oe = R.objectStore(X);
          w._hasGetAll = "getAll" in oe;
          for (var U = 0; U < oe.indexNames.length; ++U) {
            var ie = oe.indexNames[U], re = oe.index(ie).keyPath, pe = typeof re == "string" ? re : "[" + M(re).join("+") + "]";
            !E[X] || (re = E[X].idxByName[pe]) && (re.name = ie, delete E[X].idxByName[pe], E[X].idxByName[ie] = re);
          }
        }
        typeof navigator < "u" && /Safari/.test(navigator.userAgent) && !/(Chrome\/|Edge\/)/.test(navigator.userAgent) && s.WorkerGlobalScope && s instanceof s.WorkerGlobalScope && [].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1] < 604 && (w._hasGetAll = !1);
      }
      function Xc(w) {
        return w.split(",").map(function(E, R) {
          var X = E.split(":"), P = (q = X[1]) === null || q === void 0 ? void 0 : q.trim(), q = (E = X[0].trim()).replace(/([&*]|\+\+)/g, ""), X = /^\[/.test(q) ? q.match(/^\[(.*)\]$/)[1].split("+") : q;
          return Sa(q, X || null, /\&/.test(E), /\*/.test(E), /\+\+/.test(E), u(X), R === 0, P);
        });
      }
      var Kd = (wr.prototype._createTableSchema = cn, wr.prototype._parseIndexSyntax = Xc, wr.prototype._parseStoresSpec = function(w, E) {
        var R = this;
        o(w).forEach(function(P) {
          if (w[P] !== null) {
            var q = R._parseIndexSyntax(w[P]), X = q.shift();
            if (!X) throw new Re.Schema("Invalid schema for table " + P + ": " + w[P]);
            if (X.unique = !0, X.multi) throw new Re.Schema("Primary key cannot be multiEntry*");
            q.forEach(function(oe) {
              if (oe.auto) throw new Re.Schema("Only primary key can be marked as autoIncrement (++)");
              if (!oe.keyPath) throw new Re.Schema("Index must have a name and cannot be an empty string");
            }), q = R._createTableSchema(P, X, q), E[P] = q;
          }
        });
      }, wr.prototype.stores = function(R) {
        var E = this.db;
        this._cfg.storesSource = this._cfg.storesSource ? c(this._cfg.storesSource, R) : R;
        var R = E._versions, P = {}, q = {};
        return R.forEach(function(X) {
          c(P, X._cfg.storesSource), q = X._cfg.dbschema = {}, X._parseStoresSpec(P, q);
        }), E._dbSchema = q, Jn(E, [E._allTables, E, E.Transaction.prototype]), zu(E, [E._allTables, E, E.Transaction.prototype, this._cfg.tables], o(q), q), E._storeNames = o(q), this;
      }, wr.prototype.upgrade = function(w) {
        return this._cfg.contentUpgrade = Un(this._cfg.contentUpgrade || Ne, w), this;
      }, wr);
      function wr() {
      }
      function Qc(w, E) {
        var R = w._dbNamesDB;
        return R || (R = w._dbNamesDB = new Fr(Hs, { addons: [], indexedDB: w, IDBKeyRange: E })).version(1).stores({ dbnames: "name" }), R.table("dbnames");
      }
      function qr(w) {
        return w && typeof w.databases == "function";
      }
      function Zc(w) {
        return wn(function() {
          return it.letThrough = !0, w();
        });
      }
      function Lu(w) {
        return !("from" in w);
      }
      var Pn = function(w, E) {
        if (!this) {
          var R = new Pn();
          return w && "d" in w && c(R, w), R;
        }
        c(this, arguments.length ? { d: 1, from: w, to: 1 < arguments.length ? E : w } : { d: 0 });
      };
      function _s(w, E, R) {
        var P = zt(E, R);
        if (!isNaN(P)) {
          if (0 < P) throw RangeError();
          if (Lu(w)) return c(w, { from: E, to: R, d: 1 });
          var q = w.l, P = w.r;
          if (zt(R, w.from) < 0) return q ? _s(q, E, R) : w.l = { from: E, to: R, d: 1, l: null, r: null }, Bu(w);
          if (0 < zt(E, w.to)) return P ? _s(P, E, R) : w.r = { from: E, to: R, d: 1, l: null, r: null }, Bu(w);
          zt(E, w.from) < 0 && (w.from = E, w.l = null, w.d = P ? P.d + 1 : 1), 0 < zt(R, w.to) && (w.to = R, w.r = null, w.d = w.l ? w.l.d + 1 : 1), R = !w.r, q && !w.l && Xa(w, q), P && R && Xa(w, P);
        }
      }
      function Xa(w, E) {
        Lu(E) || (function R(P, ie) {
          var X = ie.from, oe = ie.to, U = ie.l, ie = ie.r;
          _s(P, X, oe), U && R(P, U), ie && R(P, ie);
        })(w, E);
      }
      function Tn(w, E) {
        var R = Gi(E), P = R.next();
        if (P.done) return !1;
        for (var q = P.value, X = Gi(w), oe = X.next(q.from), U = oe.value; !P.done && !oe.done; ) {
          if (zt(U.from, q.to) <= 0 && 0 <= zt(U.to, q.from)) return !0;
          zt(q.from, U.from) < 0 ? q = (P = R.next(U.from)).value : U = (oe = X.next(q.from)).value;
        }
        return !1;
      }
      function Gi(w) {
        var E = Lu(w) ? null : { s: 0, n: w };
        return { next: function(R) {
          for (var P = 0 < arguments.length; E; ) switch (E.s) {
            case 0:
              if (E.s = 1, P) for (; E.n.l && zt(R, E.n.from) < 0; ) E = { up: E, n: E.n.l, s: 1 };
              else for (; E.n.l; ) E = { up: E, n: E.n.l, s: 1 };
            case 1:
              if (E.s = 2, !P || zt(R, E.n.to) <= 0) return { value: E.n, done: !1 };
            case 2:
              if (E.n.r) {
                E.s = 3, E = { up: E, n: E.n.r, s: 0 };
                continue;
              }
            case 3:
              E = E.up;
          }
          return { done: !0 };
        } };
      }
      function Bu(w) {
        var E, R, P = (((E = w.r) === null || E === void 0 ? void 0 : E.d) || 0) - (((R = w.l) === null || R === void 0 ? void 0 : R.d) || 0), q = 1 < P ? "r" : P < -1 ? "l" : "";
        q && (E = q == "r" ? "l" : "r", R = r({}, w), P = w[q], w.from = P.from, w.to = P.to, w[q] = P[q], R[q] = P[E], (w[E] = R).d = Jc(R)), w.d = Jc(w);
      }
      function Jc(R) {
        var E = R.r, R = R.l;
        return (E ? R ? Math.max(E.d, R.d) : E.d : R ? R.d : 0) + 1;
      }
      function Fo(w, E) {
        return o(E).forEach(function(R) {
          w[R] ? Xa(w[R], E[R]) : w[R] = (function P(q) {
            var X, oe, U = {};
            for (X in q) p(q, X) && (oe = q[X], U[X] = !oe || typeof oe != "object" || H.has(oe.constructor) ? oe : P(oe));
            return U;
          })(E[R]);
        }), w;
      }
      function ef(w, E) {
        return w.all || E.all || Object.keys(w).some(function(R) {
          return E[R] && Tn(E[R], w[R]);
        });
      }
      x(Pn.prototype, ((Ur = { add: function(w) {
        return Xa(this, w), this;
      }, addKey: function(w) {
        return _s(this, w, w), this;
      }, addKeys: function(w) {
        var E = this;
        return w.forEach(function(R) {
          return _s(E, R, R);
        }), this;
      }, hasKey: function(w) {
        var E = Gi(this).next(w).value;
        return E && zt(E.from, w) <= 0 && 0 <= zt(E.to, w);
      } })[J] = function() {
        return Gi(this);
      }, Ur));
      var Js = {}, tf = {}, qu = !1;
      function eo(w) {
        Fo(tf, w), qu || (qu = !0, setTimeout(function() {
          qu = !1, Ss(tf, !(tf = {}));
        }, 0));
      }
      function Ss(w, E) {
        E === void 0 && (E = !1);
        var R = /* @__PURE__ */ new Set();
        if (w.all) for (var P = 0, q = Object.values(Js); P < q.length; P++) Yd(oe = q[P], w, R, E);
        else for (var X in w) {
          var oe, U = /^idb\:\/\/(.*)\/(.*)\//.exec(X);
          U && (X = U[1], U = U[2], (oe = Js["idb://".concat(X, "/").concat(U)]) && Yd(oe, w, R, E));
        }
        R.forEach(function(ie) {
          return ie();
        });
      }
      function Yd(w, E, R, P) {
        for (var q = [], X = 0, oe = Object.entries(w.queries.query); X < oe.length; X++) {
          for (var U = oe[X], ie = U[0], re = [], pe = 0, he = U[1]; pe < he.length; pe++) {
            var _e = he[pe];
            ef(E, _e.obsSet) ? _e.subscribers.forEach(function(Te) {
              return R.add(Te);
            }) : P && re.push(_e);
          }
          P && q.push([ie, re]);
        }
        if (P) for (var be = 0, we = q; be < we.length; be++) {
          var ke = we[be], ie = ke[0], re = ke[1];
          w.queries.query[ie] = re;
        }
      }
      function Wd(w) {
        var E = w._state, R = w._deps.indexedDB;
        if (E.isBeingOpened || w.idbdb) return E.dbReadyPromise.then(function() {
          return E.dbOpenError ? on(E.dbOpenError) : w;
        });
        E.isBeingOpened = !0, E.dbOpenError = null, E.openComplete = !1;
        var P = E.openCanceller, q = Math.round(10 * w.verno), X = !1;
        function oe() {
          if (E.openCanceller !== P) throw new Re.DatabaseClosed("db.open() was cancelled");
        }
        function U() {
          return new ct(function(_e, be) {
            if (oe(), !R) throw new Re.MissingAPI();
            var we = w.name, ke = E.autoSchema || !q ? R.open(we) : R.open(we, q);
            if (!ke) throw new Re.MissingAPI();
            ke.onerror = Vi(be), ke.onblocked = vn(w._fireOnBlocked), ke.onupgradeneeded = vn(function(Te) {
              var je;
              pe = ke.transaction, E.autoSchema && !w._options.allowEmptyDB ? (ke.onerror = Xs, pe.abort(), ke.result.close(), (je = R.deleteDatabase(we)).onsuccess = je.onerror = vn(function() {
                be(new Re.NoSuchDatabase("Database ".concat(we, " doesnt exist")));
              })) : (pe.onerror = Vi(be), Te = Te.oldVersion > Math.pow(2, 62) ? 0 : Te.oldVersion, he = Te < 1, w.idbdb = ke.result, X && Vl(w, pe), Hi(w, Te / 10, pe, be));
            }, be), ke.onsuccess = vn(function() {
              pe = null;
              var Te, je, ze, $e, Ge, nt = w.idbdb = ke.result, lt = M(nt.objectStoreNames);
              if (0 < lt.length) try {
                var He = nt.transaction(($e = lt).length === 1 ? $e[0] : $e, "readonly");
                if (E.autoSchema) je = nt, ze = He, (Te = w).verno = je.version / 10, ze = Te._dbSchema = Zs(0, je, ze), Te._storeNames = M(je.objectStoreNames, 0), zu(Te, [Te._allTables], o(ze), ze);
                else if (Gl(w, w._dbSchema, He), ((Ge = qo(Zs(0, (Ge = w).idbdb, He), Ge._dbSchema)).add.length || Ge.change.some(function(ot) {
                  return ot.add.length || ot.change.length;
                })) && !X) return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."), nt.close(), q = nt.version + 1, X = !0, _e(U());
                Wa(w, He);
              } catch {
              }
              Ka.push(w), nt.onversionchange = vn(function(ot) {
                E.vcFired = !0, w.on("versionchange").fire(ot);
              }), nt.onclose = vn(function() {
                w.close({ disableAutoOpen: !1 });
              }), he && (Ge = w._deps, He = we, nt = Ge.indexedDB, Ge = Ge.IDBKeyRange, qr(nt) || He === Hs || Qc(nt, Ge).put({ name: He }).catch(Ne)), _e();
            }, be);
          }).catch(function(_e) {
            switch (_e == null ? void 0 : _e.name) {
              case "UnknownError":
                if (0 < E.PR1398_maxLoop) return E.PR1398_maxLoop--, console.warn("Dexie: Workaround for Chrome UnknownError on open()"), U();
                break;
              case "VersionError":
                if (0 < q) return q = 0, U();
            }
            return ct.reject(_e);
          });
        }
        var ie, re = E.dbReadyResolve, pe = null, he = !1;
        return ct.race([P, (typeof navigator > "u" ? ct.resolve() : !navigator.userAgentData && /Safari\//.test(navigator.userAgent) && !/Chrom(e|ium)\//.test(navigator.userAgent) && indexedDB.databases ? new Promise(function(_e) {
          function be() {
            return indexedDB.databases().finally(_e);
          }
          ie = setInterval(be, 100), be();
        }).finally(function() {
          return clearInterval(ie);
        }) : Promise.resolve()).then(U)]).then(function() {
          return oe(), E.onReadyBeingFired = [], ct.resolve(Zc(function() {
            return w.on.ready.fire(w.vip);
          })).then(function _e() {
            if (0 < E.onReadyBeingFired.length) {
              var be = E.onReadyBeingFired.reduce(Un, Ne);
              return E.onReadyBeingFired = [], ct.resolve(Zc(function() {
                return be(w.vip);
              })).then(_e);
            }
          });
        }).finally(function() {
          E.openCanceller === P && (E.onReadyBeingFired = null, E.isBeingOpened = !1);
        }).catch(function(_e) {
          E.dbOpenError = _e;
          try {
            pe && pe.abort();
          } catch {
          }
          return P === E.openCanceller && w._close(), on(_e);
        }).finally(function() {
          E.openComplete = !0, re();
        }).then(function() {
          var _e;
          return he && (_e = {}, w.tables.forEach(function(be) {
            be.schema.indexes.forEach(function(we) {
              we.name && (_e["idb://".concat(w.name, "/").concat(be.name, "/").concat(we.name)] = new Pn(-1 / 0, [[[]]]));
            }), _e["idb://".concat(w.name, "/").concat(be.name, "/")] = _e["idb://".concat(w.name, "/").concat(be.name, "/:dels")] = new Pn(-1 / 0, [[[]]]);
          }), Rr(Lo).fire(_e), Ss(_e, !0)), w;
        });
      }
      function Uo(w) {
        function E(X) {
          return w.next(X);
        }
        var R = q(E), P = q(function(X) {
          return w.throw(X);
        });
        function q(X) {
          return function(ie) {
            var U = X(ie), ie = U.value;
            return U.done ? ie : ie && typeof ie.then == "function" ? ie.then(R, P) : u(ie) ? Promise.all(ie).then(R, P) : R(ie);
          };
        }
        return q(E)();
      }
      function Ca(w, E, R) {
        for (var P = u(w) ? w.slice() : [w], q = 0; q < R; ++q) P.push(E);
        return P;
      }
      var nf = { stack: "dbcore", name: "VirtualIndexMiddleware", level: 1, create: function(w) {
        return r(r({}, w), { table: function(E) {
          var R = w.table(E), P = R.schema, q = {}, X = [];
          function oe(he, _e, be) {
            var we = br(he), ke = q[we] = q[we] || [], Te = he == null ? 0 : typeof he == "string" ? 1 : he.length, je = 0 < _e, je = r(r({}, be), { name: je ? "".concat(we, "(virtual-from:").concat(be.name, ")") : be.name, lowLevelIndex: be, isVirtual: je, keyTail: _e, keyLength: Te, extractKey: Bo(he), unique: !je && be.unique });
            return ke.push(je), je.isPrimaryKey || X.push(je), 1 < Te && oe(Te === 2 ? he[0] : he.slice(0, Te - 1), _e + 1, be), ke.sort(function(ze, $e) {
              return ze.keyTail - $e.keyTail;
            }), je;
          }
          E = oe(P.primaryKey.keyPath, 0, P.primaryKey), q[":id"] = [E];
          for (var U = 0, ie = P.indexes; U < ie.length; U++) {
            var re = ie[U];
            oe(re.keyPath, 0, re);
          }
          function pe(he) {
            var _e, be = he.query.index;
            return be.isVirtual ? r(r({}, he), { query: { index: be.lowLevelIndex, range: (_e = he.query.range, be = be.keyTail, { type: _e.type === 1 ? 2 : _e.type, lower: Ca(_e.lower, _e.lowerOpen ? w.MAX_KEY : w.MIN_KEY, be), lowerOpen: !0, upper: Ca(_e.upper, _e.upperOpen ? w.MIN_KEY : w.MAX_KEY, be), upperOpen: !0 }) } }) : he;
          }
          return r(r({}, R), { schema: r(r({}, P), { primaryKey: E, indexes: X, getIndexByKeyPath: function(he) {
            return (he = q[br(he)]) && he[0];
          } }), count: function(he) {
            return R.count(pe(he));
          }, query: function(he) {
            return R.query(pe(he));
          }, openCursor: function(he) {
            var _e = he.query.index, be = _e.keyTail, we = _e.isVirtual, ke = _e.keyLength;
            return we ? R.openCursor(pe(he)).then(function(je) {
              return je && Te(je);
            }) : R.openCursor(he);
            function Te(je) {
              return Object.create(je, { continue: { value: function(ze) {
                ze != null ? je.continue(Ca(ze, he.reverse ? w.MAX_KEY : w.MIN_KEY, be)) : he.unique ? je.continue(je.key.slice(0, ke).concat(he.reverse ? w.MIN_KEY : w.MAX_KEY, be)) : je.continue();
              } }, continuePrimaryKey: { value: function(ze, $e) {
                je.continuePrimaryKey(Ca(ze, w.MAX_KEY, be), $e);
              } }, primaryKey: { get: function() {
                return je.primaryKey;
              } }, key: { get: function() {
                var ze = je.key;
                return ke === 1 ? ze[0] : ze.slice(0, ke);
              } }, value: { get: function() {
                return je.value;
              } } });
            }
          } });
        } });
      } };
      function Kl(w, E, R, P) {
        return R = R || {}, P = P || "", o(w).forEach(function(q) {
          var X, oe, U;
          p(E, q) ? (X = w[q], oe = E[q], typeof X == "object" && typeof oe == "object" && X && oe ? (U = se(X)) !== se(oe) ? R[P + q] = E[q] : U === "Object" ? Kl(X, oe, R, P + q + ".") : X !== oe && (R[P + q] = E[q]) : X !== oe && (R[P + q] = E[q])) : R[P + q] = void 0;
        }), o(E).forEach(function(q) {
          p(w, q) || (R[P + q] = E[q]);
        }), R;
      }
      function Fu(w, E) {
        return E.type === "delete" ? E.keys : E.keys || E.values.map(w.extractKey);
      }
      var Uu = { stack: "dbcore", name: "HooksMiddleware", level: 2, create: function(w) {
        return r(r({}, w), { table: function(E) {
          var R = w.table(E), P = R.schema.primaryKey;
          return r(r({}, R), { mutate: function(q) {
            var X = it.trans, oe = X.table(E).hook, U = oe.deleting, ie = oe.creating, re = oe.updating;
            switch (q.type) {
              case "add":
                if (ie.fire === Ne) break;
                return X._promise("readwrite", function() {
                  return pe(q);
                }, !0);
              case "put":
                if (ie.fire === Ne && re.fire === Ne) break;
                return X._promise("readwrite", function() {
                  return pe(q);
                }, !0);
              case "delete":
                if (U.fire === Ne) break;
                return X._promise("readwrite", function() {
                  return pe(q);
                }, !0);
              case "deleteRange":
                if (U.fire === Ne) break;
                return X._promise("readwrite", function() {
                  return (function he(_e, be, we) {
                    return R.query({ trans: _e, values: !1, query: { index: P, range: be }, limit: we }).then(function(ke) {
                      var Te = ke.result;
                      return pe({ type: "delete", keys: Te, trans: _e }).then(function(je) {
                        return 0 < je.numFailures ? Promise.reject(je.failures[0]) : Te.length < we ? { failures: [], numFailures: 0, lastResult: void 0 } : he(_e, r(r({}, be), { lower: Te[Te.length - 1], lowerOpen: !0 }), we);
                      });
                    });
                  })(q.trans, q.range, 1e4);
                }, !0);
            }
            return R.mutate(q);
            function pe(he) {
              var _e, be, we, ke = it.trans, Te = he.keys || Fu(P, he);
              if (!Te) throw new Error("Keys missing");
              return (he = he.type === "add" || he.type === "put" ? r(r({}, he), { keys: Te }) : r({}, he)).type !== "delete" && (he.values = i([], he.values)), he.keys && (he.keys = i([], he.keys)), _e = R, we = Te, ((be = he).type === "add" ? Promise.resolve([]) : _e.getMany({ trans: be.trans, keys: we, cache: "immutable" })).then(function(je) {
                var ze = Te.map(function($e, Ge) {
                  var nt, lt, He, ot = je[Ge], ut = { onerror: null, onsuccess: null };
                  return he.type === "delete" ? U.fire.call(ut, $e, ot, ke) : he.type === "add" || ot === void 0 ? (nt = ie.fire.call(ut, $e, he.values[Ge], ke), $e == null && nt != null && (he.keys[Ge] = $e = nt, P.outbound || L(he.values[Ge], P.keyPath, $e))) : (nt = Kl(ot, he.values[Ge]), (lt = re.fire.call(ut, nt, $e, ot, ke)) && (He = he.values[Ge], Object.keys(lt).forEach(function(Je) {
                    p(He, Je) ? He[Je] = lt[Je] : L(He, Je, lt[Je]);
                  }))), ut;
                });
                return R.mutate(he).then(function($e) {
                  for (var Ge = $e.failures, nt = $e.results, lt = $e.numFailures, $e = $e.lastResult, He = 0; He < Te.length; ++He) {
                    var ot = (nt || Te)[He], ut = ze[He];
                    ot == null ? ut.onerror && ut.onerror(Ge[He]) : ut.onsuccess && ut.onsuccess(he.type === "put" && je[He] ? he.values[He] : ot);
                  }
                  return { failures: Ge, results: nt, numFailures: lt, lastResult: $e };
                }).catch(function($e) {
                  return ze.forEach(function(Ge) {
                    return Ge.onerror && Ge.onerror($e);
                  }), Promise.reject($e);
                });
              });
            }
          } });
        } });
      } };
      function Yl(w, E, R) {
        try {
          if (!E || E.keys.length < w.length) return null;
          for (var P = [], q = 0, X = 0; q < E.keys.length && X < w.length; ++q) zt(E.keys[q], w[X]) === 0 && (P.push(R ? me(E.values[q]) : E.values[q]), ++X);
          return P.length === w.length ? P : null;
        } catch {
          return null;
        }
      }
      var Xd = { stack: "dbcore", level: -1, create: function(w) {
        return { table: function(E) {
          var R = w.table(E);
          return r(r({}, R), { getMany: function(P) {
            if (!P.cache) return R.getMany(P);
            var q = Yl(P.keys, P.trans._cache, P.cache === "clone");
            return q ? ct.resolve(q) : R.getMany(P).then(function(X) {
              return P.trans._cache = { keys: P.keys, values: P.cache === "clone" ? me(X) : X }, X;
            });
          }, mutate: function(P) {
            return P.type !== "add" && (P.trans._cache = null), R.mutate(P);
          } });
        } };
      } };
      function Cs(w, E) {
        return w.trans.mode === "readonly" && !!w.subscr && !w.trans.explicit && w.trans.db._options.cache !== "disabled" && !E.schema.primaryKey.outbound;
      }
      function ii(w, E) {
        switch (w) {
          case "query":
            return E.values && !E.unique;
          case "get":
          case "getMany":
          case "count":
          case "openCursor":
            return !1;
        }
      }
      var rf = { stack: "dbcore", level: 0, name: "Observability", create: function(w) {
        var E = w.schema.name, R = new Pn(w.MIN_KEY, w.MAX_KEY);
        return r(r({}, w), { transaction: function(P, q, X) {
          if (it.subscr && q !== "readonly") throw new Re.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(it.querier));
          return w.transaction(P, q, X);
        }, table: function(P) {
          var q = w.table(P), X = q.schema, oe = X.primaryKey, he = X.indexes, U = oe.extractKey, ie = oe.outbound, re = oe.autoIncrement && he.filter(function(be) {
            return be.compound && be.keyPath.includes(oe.keyPath);
          }), pe = r(r({}, q), { mutate: function(be) {
            function we(Je) {
              return Je = "idb://".concat(E, "/").concat(P, "/").concat(Je), $e[Je] || ($e[Je] = new Pn());
            }
            var ke, Te, je, ze = be.trans, $e = be.mutatedParts || (be.mutatedParts = {}), Ge = we(""), nt = we(":dels"), lt = be.type, ut = be.type === "deleteRange" ? [be.range] : be.type === "delete" ? [be.keys] : be.values.length < 50 ? [Fu(oe, be).filter(function(Je) {
              return Je;
            }), be.values] : [], He = ut[0], ot = ut[1], ut = be.trans._cache;
            return u(He) ? (Ge.addKeys(He), (ut = lt === "delete" || He.length === ot.length ? Yl(He, ut) : null) || nt.addKeys(He), (ut || ot) && (ke = we, Te = ut, je = ot, X.indexes.forEach(function(Je) {
              var pt = ke(Je.name || "");
              function _t(Dt) {
                return Dt != null ? Je.extractKey(Dt) : null;
              }
              function Rt(Dt) {
                return Je.multiEntry && u(Dt) ? Dt.forEach(function(Ln) {
                  return pt.addKey(Ln);
                }) : pt.addKey(Dt);
              }
              (Te || je).forEach(function(Dt, mr) {
                var Et = Te && _t(Te[mr]), mr = je && _t(je[mr]);
                zt(Et, mr) !== 0 && (Et != null && Rt(Et), mr != null && Rt(mr));
              });
            }))) : He ? (ot = { from: (ot = He.lower) !== null && ot !== void 0 ? ot : w.MIN_KEY, to: (ot = He.upper) !== null && ot !== void 0 ? ot : w.MAX_KEY }, nt.add(ot), Ge.add(ot)) : (Ge.add(R), nt.add(R), X.indexes.forEach(function(Je) {
              return we(Je.name).add(R);
            })), q.mutate(be).then(function(Je) {
              return !He || be.type !== "add" && be.type !== "put" || (Ge.addKeys(Je.results), re && re.forEach(function(pt) {
                for (var _t = be.values.map(function(Et) {
                  return pt.extractKey(Et);
                }), Rt = pt.keyPath.findIndex(function(Et) {
                  return Et === oe.keyPath;
                }), Dt = 0, Ln = Je.results.length; Dt < Ln; ++Dt) _t[Dt][Rt] = Je.results[Dt];
                we(pt.name).addKeys(_t);
              })), ze.mutatedParts = Fo(ze.mutatedParts || {}, $e), Je;
            });
          } }), he = function(we) {
            var ke = we.query, we = ke.index, ke = ke.range;
            return [we, new Pn((we = ke.lower) !== null && we !== void 0 ? we : w.MIN_KEY, (ke = ke.upper) !== null && ke !== void 0 ? ke : w.MAX_KEY)];
          }, _e = { get: function(be) {
            return [oe, new Pn(be.key)];
          }, getMany: function(be) {
            return [oe, new Pn().addKeys(be.keys)];
          }, count: he, query: he, openCursor: he };
          return o(_e).forEach(function(be) {
            pe[be] = function(we) {
              var ke = it.subscr, Te = !!ke, je = Cs(it, q) && ii(be, we) ? we.obsSet = {} : ke;
              if (Te) {
                var ze = function(ot) {
                  return ot = "idb://".concat(E, "/").concat(P, "/").concat(ot), je[ot] || (je[ot] = new Pn());
                }, $e = ze(""), Ge = ze(":dels"), ke = _e[be](we), Te = ke[0], ke = ke[1];
                if ((be === "query" && Te.isPrimaryKey && !we.values ? Ge : ze(Te.name || "")).add(ke), !Te.isPrimaryKey) {
                  if (be !== "count") {
                    var nt = be === "query" && ie && we.values && q.query(r(r({}, we), { values: !1 }));
                    return q[be].apply(this, arguments).then(function(ot) {
                      if (be === "query") {
                        if (ie && we.values) return nt.then(function(_t) {
                          return _t = _t.result, $e.addKeys(_t), ot;
                        });
                        var ut = we.values ? ot.result.map(U) : ot.result;
                        (we.values ? $e : Ge).addKeys(ut);
                      } else if (be === "openCursor") {
                        var Je = ot, pt = we.values;
                        return Je && Object.create(Je, { key: { get: function() {
                          return Ge.addKey(Je.primaryKey), Je.key;
                        } }, primaryKey: { get: function() {
                          var _t = Je.primaryKey;
                          return Ge.addKey(_t), _t;
                        } }, value: { get: function() {
                          return pt && $e.addKey(Je.primaryKey), Je.value;
                        } } });
                      }
                      return ot;
                    });
                  }
                  Ge.add(R);
                }
              }
              return q[be].apply(this, arguments);
            };
          }), pe;
        } });
      } };
      function $o(w, E, R) {
        if (R.numFailures === 0) return E;
        if (E.type === "deleteRange") return null;
        var P = E.keys ? E.keys.length : "values" in E && E.values ? E.values.length : 1;
        return R.numFailures === P ? null : (E = r({}, E), u(E.keys) && (E.keys = E.keys.filter(function(q, X) {
          return !(X in R.failures);
        })), "values" in E && u(E.values) && (E.values = E.values.filter(function(q, X) {
          return !(X in R.failures);
        })), E);
      }
      function Wl(w, E) {
        return R = w, ((P = E).lower === void 0 || (P.lowerOpen ? 0 < zt(R, P.lower) : 0 <= zt(R, P.lower))) && (w = w, (E = E).upper === void 0 || (E.upperOpen ? zt(w, E.upper) < 0 : zt(w, E.upper) <= 0));
        var R, P;
      }
      function $u(w, E, _e, P, q, X) {
        if (!_e || _e.length === 0) return w;
        var oe = E.query.index, U = oe.multiEntry, ie = E.query.range, re = P.schema.primaryKey.extractKey, pe = oe.extractKey, he = (oe.lowLevelIndex || oe).extractKey, _e = _e.reduce(function(be, we) {
          var ke = be, Te = [];
          if (we.type === "add" || we.type === "put") for (var je = new Pn(), ze = we.values.length - 1; 0 <= ze; --ze) {
            var $e, Ge = we.values[ze], nt = re(Ge);
            je.hasKey(nt) || ($e = pe(Ge), (U && u($e) ? $e.some(function(Je) {
              return Wl(Je, ie);
            }) : Wl($e, ie)) && (je.addKey(nt), Te.push(Ge)));
          }
          switch (we.type) {
            case "add":
              var lt = new Pn().addKeys(E.values ? be.map(function(pt) {
                return re(pt);
              }) : be), ke = be.concat(E.values ? Te.filter(function(pt) {
                return pt = re(pt), !lt.hasKey(pt) && (lt.addKey(pt), !0);
              }) : Te.map(function(pt) {
                return re(pt);
              }).filter(function(pt) {
                return !lt.hasKey(pt) && (lt.addKey(pt), !0);
              }));
              break;
            case "put":
              var He = new Pn().addKeys(we.values.map(function(pt) {
                return re(pt);
              }));
              ke = be.filter(function(pt) {
                return !He.hasKey(E.values ? re(pt) : pt);
              }).concat(E.values ? Te : Te.map(function(pt) {
                return re(pt);
              }));
              break;
            case "delete":
              var ot = new Pn().addKeys(we.keys);
              ke = be.filter(function(pt) {
                return !ot.hasKey(E.values ? re(pt) : pt);
              });
              break;
            case "deleteRange":
              var ut = we.range;
              ke = be.filter(function(pt) {
                return !Wl(re(pt), ut);
              });
          }
          return ke;
        }, w);
        return _e === w ? w : (_e.sort(function(be, we) {
          return zt(he(be), he(we)) || zt(re(be), re(we));
        }), E.limit && E.limit < 1 / 0 && (_e.length > E.limit ? _e.length = E.limit : w.length === E.limit && _e.length < E.limit && (q.dirty = !0)), X ? Object.freeze(_e) : _e);
      }
      function Vo(w, E) {
        return zt(w.lower, E.lower) === 0 && zt(w.upper, E.upper) === 0 && !!w.lowerOpen == !!E.lowerOpen && !!w.upperOpen == !!E.upperOpen;
      }
      function Xl(w, E) {
        return (function(R, P, q, X) {
          if (R === void 0) return P !== void 0 ? -1 : 0;
          if (P === void 0) return 1;
          if ((P = zt(R, P)) === 0) {
            if (q && X) return 0;
            if (q) return 1;
            if (X) return -1;
          }
          return P;
        })(w.lower, E.lower, w.lowerOpen, E.lowerOpen) <= 0 && 0 <= (function(R, P, q, X) {
          if (R === void 0) return P !== void 0 ? 1 : 0;
          if (P === void 0) return -1;
          if ((P = zt(R, P)) === 0) {
            if (q && X) return 0;
            if (q) return -1;
            if (X) return 1;
          }
          return P;
        })(w.upper, E.upper, w.upperOpen, E.upperOpen);
      }
      function Wm(w, E, R, P) {
        w.subscribers.add(R), P.addEventListener("abort", function() {
          var q, X;
          w.subscribers.delete(R), w.subscribers.size === 0 && (q = w, X = E, setTimeout(function() {
            q.subscribers.size === 0 && de(X, q);
          }, 3e3));
        });
      }
      var Vu = { stack: "dbcore", level: 0, name: "Cache", create: function(w) {
        var E = w.schema.name;
        return r(r({}, w), { transaction: function(R, P, q) {
          var X, oe, U = w.transaction(R, P, q);
          return P === "readwrite" && (oe = (X = new AbortController()).signal, q = function(ie) {
            return function() {
              if (X.abort(), P === "readwrite") {
                for (var re = /* @__PURE__ */ new Set(), pe = 0, he = R; pe < he.length; pe++) {
                  var _e = he[pe], be = Js["idb://".concat(E, "/").concat(_e)];
                  if (be) {
                    var we = w.table(_e), ke = be.optimisticOps.filter(function(pt) {
                      return pt.trans === U;
                    });
                    if (U._explicit && ie && U.mutatedParts) for (var Te = 0, je = Object.values(be.queries.query); Te < je.length; Te++) for (var ze = 0, $e = (lt = je[Te]).slice(); ze < $e.length; ze++) ef((He = $e[ze]).obsSet, U.mutatedParts) && (de(lt, He), He.subscribers.forEach(function(pt) {
                      return re.add(pt);
                    }));
                    else if (0 < ke.length) {
                      be.optimisticOps = be.optimisticOps.filter(function(pt) {
                        return pt.trans !== U;
                      });
                      for (var Ge = 0, nt = Object.values(be.queries.query); Ge < nt.length; Ge++) for (var lt, He, ot, ut = 0, Je = (lt = nt[Ge]).slice(); ut < Je.length; ut++) (He = Je[ut]).res != null && U.mutatedParts && (ie && !He.dirty ? (ot = Object.isFrozen(He.res), ot = $u(He.res, He.req, ke, we, He, ot), He.dirty ? (de(lt, He), He.subscribers.forEach(function(pt) {
                        return re.add(pt);
                      })) : ot !== He.res && (He.res = ot, He.promise = ct.resolve({ result: ot }))) : (He.dirty && de(lt, He), He.subscribers.forEach(function(pt) {
                        return re.add(pt);
                      })));
                    }
                  }
                }
                re.forEach(function(pt) {
                  return pt();
                });
              }
            };
          }, U.addEventListener("abort", q(!1), { signal: oe }), U.addEventListener("error", q(!1), { signal: oe }), U.addEventListener("complete", q(!0), { signal: oe })), U;
        }, table: function(R) {
          var P = w.table(R), q = P.schema.primaryKey;
          return r(r({}, P), { mutate: function(X) {
            var oe = it.trans;
            if (q.outbound || oe.db._options.cache === "disabled" || oe.explicit || oe.idbtrans.mode !== "readwrite") return P.mutate(X);
            var U = Js["idb://".concat(E, "/").concat(R)];
            return U ? (oe = P.mutate(X), X.type !== "add" && X.type !== "put" || !(50 <= X.values.length || Fu(q, X).some(function(ie) {
              return ie == null;
            })) ? (U.optimisticOps.push(X), X.mutatedParts && eo(X.mutatedParts), oe.then(function(ie) {
              0 < ie.numFailures && (de(U.optimisticOps, X), (ie = $o(0, X, ie)) && U.optimisticOps.push(ie), X.mutatedParts && eo(X.mutatedParts));
            }), oe.catch(function() {
              de(U.optimisticOps, X), X.mutatedParts && eo(X.mutatedParts);
            })) : oe.then(function(ie) {
              var re = $o(0, r(r({}, X), { values: X.values.map(function(pe, he) {
                var _e;
                return ie.failures[he] ? pe : (pe = (_e = q.keyPath) !== null && _e !== void 0 && _e.includes(".") ? me(pe) : r({}, pe), L(pe, q.keyPath, ie.results[he]), pe);
              }) }), ie);
              U.optimisticOps.push(re), queueMicrotask(function() {
                return X.mutatedParts && eo(X.mutatedParts);
              });
            }), oe) : P.mutate(X);
          }, query: function(X) {
            if (!Cs(it, P) || !ii("query", X)) return P.query(X);
            var oe = ((re = it.trans) === null || re === void 0 ? void 0 : re.db._options.cache) === "immutable", he = it, U = he.requery, ie = he.signal, re = (function(we, ke, Te, je) {
              var ze = Js["idb://".concat(we, "/").concat(ke)];
              if (!ze) return [];
              if (!(ke = ze.queries[Te])) return [null, !1, ze, null];
              var $e = ke[(je.query ? je.query.index.name : null) || ""];
              if (!$e) return [null, !1, ze, null];
              switch (Te) {
                case "query":
                  var Ge = $e.find(function(nt) {
                    return nt.req.limit === je.limit && nt.req.values === je.values && Vo(nt.req.query.range, je.query.range);
                  });
                  return Ge ? [Ge, !0, ze, $e] : [$e.find(function(nt) {
                    return ("limit" in nt.req ? nt.req.limit : 1 / 0) >= je.limit && (!je.values || nt.req.values) && Xl(nt.req.query.range, je.query.range);
                  }), !1, ze, $e];
                case "count":
                  return Ge = $e.find(function(nt) {
                    return Vo(nt.req.query.range, je.query.range);
                  }), [Ge, !!Ge, ze, $e];
              }
            })(E, R, "query", X), pe = re[0], he = re[1], _e = re[2], be = re[3];
            return pe && he ? pe.obsSet = X.obsSet : (he = P.query(X).then(function(we) {
              var ke = we.result;
              if (pe && (pe.res = ke), oe) {
                for (var Te = 0, je = ke.length; Te < je; ++Te) Object.freeze(ke[Te]);
                Object.freeze(ke);
              } else we.result = me(ke);
              return we;
            }).catch(function(we) {
              return be && pe && de(be, pe), Promise.reject(we);
            }), pe = { obsSet: X.obsSet, promise: he, subscribers: /* @__PURE__ */ new Set(), type: "query", req: X, dirty: !1 }, be ? be.push(pe) : (be = [pe], (_e = _e || (Js["idb://".concat(E, "/").concat(R)] = { queries: { query: {}, count: {} }, objs: /* @__PURE__ */ new Map(), optimisticOps: [], unsignaledParts: {} })).queries.query[X.query.index.name || ""] = be)), Wm(pe, be, U, ie), pe.promise.then(function(we) {
              return { result: $u(we.result, X, _e == null ? void 0 : _e.optimisticOps, P, pe, oe) };
            });
          } });
        } });
      } };
      function Ql(w, E) {
        return new Proxy(w, { get: function(R, P, q) {
          return P === "db" ? E : Reflect.get(R, P, q);
        } });
      }
      var Fr = (zn.prototype.version = function(w) {
        if (isNaN(w) || w < 0.1) throw new Re.Type("Given version is not a positive number");
        if (w = Math.round(10 * w) / 10, this.idbdb || this._state.isBeingOpened) throw new Re.Schema("Cannot add version when database is open");
        this.verno = Math.max(this.verno, w);
        var E = this._versions, R = E.filter(function(P) {
          return P._cfg.version === w;
        })[0];
        return R || (R = new this.Version(w), E.push(R), E.sort($l), R.stores({}), this._state.autoSchema = !1, R);
      }, zn.prototype._whenReady = function(w) {
        var E = this;
        return this.idbdb && (this._state.openComplete || it.letThrough || this._vip) ? w() : new ct(function(R, P) {
          if (E._state.openComplete) return P(new Re.DatabaseClosed(E._state.dbOpenError));
          if (!E._state.isBeingOpened) {
            if (!E._state.autoOpen) return void P(new Re.DatabaseClosed());
            E.open().catch(Ne);
          }
          E._state.dbReadyPromise.then(R, P);
        }).then(w);
      }, zn.prototype.use = function(w) {
        var E = w.stack, R = w.create, P = w.level, q = w.name;
        return q && this.unuse({ stack: E, name: q }), w = this._middlewares[E] || (this._middlewares[E] = []), w.push({ stack: E, create: R, level: P ?? 10, name: q }), w.sort(function(X, oe) {
          return X.level - oe.level;
        }), this;
      }, zn.prototype.unuse = function(w) {
        var E = w.stack, R = w.name, P = w.create;
        return E && this._middlewares[E] && (this._middlewares[E] = this._middlewares[E].filter(function(q) {
          return P ? q.create !== P : !!R && q.name !== R;
        })), this;
      }, zn.prototype.open = function() {
        var w = this;
        return li(kn, function() {
          return Wd(w);
        });
      }, zn.prototype._close = function() {
        this.on.close.fire(new CustomEvent("close"));
        var w = this._state, E = Ka.indexOf(this);
        if (0 <= E && Ka.splice(E, 1), this.idbdb) {
          try {
            this.idbdb.close();
          } catch {
          }
          this.idbdb = null;
        }
        w.isBeingOpened || (w.dbReadyPromise = new ct(function(R) {
          w.dbReadyResolve = R;
        }), w.openCanceller = new ct(function(R, P) {
          w.cancelOpen = P;
        }));
      }, zn.prototype.close = function(R) {
        var E = (R === void 0 ? { disableAutoOpen: !0 } : R).disableAutoOpen, R = this._state;
        E ? (R.isBeingOpened && R.cancelOpen(new Re.DatabaseClosed()), this._close(), R.autoOpen = !1, R.dbOpenError = new Re.DatabaseClosed()) : (this._close(), R.autoOpen = this._options.autoOpen || R.isBeingOpened, R.openComplete = !1, R.dbOpenError = null);
      }, zn.prototype.delete = function(w) {
        var E = this;
        w === void 0 && (w = { disableAutoOpen: !0 });
        var R = 0 < arguments.length && typeof arguments[0] != "object", P = this._state;
        return new ct(function(q, X) {
          function oe() {
            E.close(w);
            var U = E._deps.indexedDB.deleteDatabase(E.name);
            U.onsuccess = vn(function() {
              var ie, re, pe;
              ie = E._deps, re = E.name, pe = ie.indexedDB, ie = ie.IDBKeyRange, qr(pe) || re === Hs || Qc(pe, ie).delete(re).catch(Ne), q();
            }), U.onerror = Vi(X), U.onblocked = E._fireOnBlocked;
          }
          if (R) throw new Re.InvalidArgument("Invalid closeOptions argument to db.delete()");
          P.isBeingOpened ? P.dbReadyPromise.then(oe) : oe();
        });
      }, zn.prototype.backendDB = function() {
        return this.idbdb;
      }, zn.prototype.isOpen = function() {
        return this.idbdb !== null;
      }, zn.prototype.hasBeenClosed = function() {
        var w = this._state.dbOpenError;
        return w && w.name === "DatabaseClosed";
      }, zn.prototype.hasFailed = function() {
        return this._state.dbOpenError !== null;
      }, zn.prototype.dynamicallyOpened = function() {
        return this._state.autoSchema;
      }, Object.defineProperty(zn.prototype, "tables", { get: function() {
        var w = this;
        return o(this._allTables).map(function(E) {
          return w._allTables[E];
        });
      }, enumerable: !1, configurable: !0 }), zn.prototype.transaction = function() {
        var w = (function(E, R, P) {
          var q = arguments.length;
          if (q < 2) throw new Re.InvalidArgument("Too few arguments");
          for (var X = new Array(q - 1); --q; ) X[q - 1] = arguments[q];
          return P = X.pop(), [E, Y(X), P];
        }).apply(this, arguments);
        return this._transaction.apply(this, w);
      }, zn.prototype._transaction = function(w, E, R) {
        var P = this, q = it.trans;
        q && q.db === this && w.indexOf("!") === -1 || (q = null);
        var X, oe, U = w.indexOf("?") !== -1;
        w = w.replace("!", "").replace("?", "");
        try {
          if (oe = E.map(function(re) {
            if (re = re instanceof P.Table ? re.name : re, typeof re != "string") throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");
            return re;
          }), w == "r" || w === Ci) X = Ci;
          else {
            if (w != "rw" && w != $i) throw new Re.InvalidArgument("Invalid transaction mode: " + w);
            X = $i;
          }
          if (q) {
            if (q.mode === Ci && X === $i) {
              if (!U) throw new Re.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");
              q = null;
            }
            q && oe.forEach(function(re) {
              if (q && q.storeNames.indexOf(re) === -1) {
                if (!U) throw new Re.SubTransaction("Table " + re + " not included in parent transaction.");
                q = null;
              }
            }), U && q && !q.active && (q = null);
          }
        } catch (re) {
          return q ? q._promise(null, function(pe, he) {
            he(re);
          }) : on(re);
        }
        var ie = (function re(pe, he, _e, be, we) {
          return ct.resolve().then(function() {
            var ke = it.transless || it, Te = pe._createTransaction(he, _e, pe._dbSchema, be);
            if (Te.explicit = !0, ke = { trans: Te, transless: ke }, be) Te.idbtrans = be.idbtrans;
            else try {
              Te.create(), Te.idbtrans._explicit = !0, pe._state.PR1398_maxLoop = 3;
            } catch ($e) {
              return $e.name === Oe.InvalidState && pe.isOpen() && 0 < --pe._state.PR1398_maxLoop ? (console.warn("Dexie: Need to reopen db"), pe.close({ disableAutoOpen: !1 }), pe.open().then(function() {
                return re(pe, he, _e, null, we);
              })) : on($e);
            }
            var je, ze = $(we);
            return ze && Qn(), ke = ct.follow(function() {
              var $e;
              (je = we.call(Te, Te)) && (ze ? ($e = Mr.bind(null, null), je.then($e, $e)) : typeof je.next == "function" && typeof je.throw == "function" && (je = Uo(je)));
            }, ke), (je && typeof je.then == "function" ? ct.resolve(je).then(function($e) {
              return Te.active ? $e : on(new Re.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"));
            }) : ke.then(function() {
              return je;
            })).then(function($e) {
              return be && Te._resolve(), Te._completion.then(function() {
                return $e;
              });
            }).catch(function($e) {
              return Te._reject($e), on($e);
            });
          });
        }).bind(null, this, X, oe, q, R);
        return q ? q._promise(X, ie, "lock") : it.trans ? li(it.transless, function() {
          return P._whenReady(ie);
        }) : this._whenReady(ie);
      }, zn.prototype.table = function(w) {
        if (!p(this._allTables, w)) throw new Re.InvalidTable("Table ".concat(w, " does not exist"));
        return this._allTables[w];
      }, zn);
      function zn(w, E) {
        var R = this;
        this._middlewares = {}, this.verno = 0;
        var P = zn.dependencies;
        this._options = E = r({ addons: zn.addons, autoOpen: !0, indexedDB: P.indexedDB, IDBKeyRange: P.IDBKeyRange, cache: "cloned" }, E), this._deps = { indexedDB: E.indexedDB, IDBKeyRange: E.IDBKeyRange }, P = E.addons, this._dbSchema = {}, this._versions = [], this._storeNames = [], this._allTables = {}, this.idbdb = null, this._novip = this;
        var q, X, oe, U, ie, re = { dbOpenError: null, isBeingOpened: !1, onReadyBeingFired: null, openComplete: !1, dbReadyResolve: Ne, dbReadyPromise: null, cancelOpen: Ne, openCanceller: null, autoSchema: !0, PR1398_maxLoop: 3, autoOpen: E.autoOpen };
        re.dbReadyPromise = new ct(function(he) {
          re.dbReadyResolve = he;
        }), re.openCanceller = new ct(function(he, _e) {
          re.cancelOpen = _e;
        }), this._state = re, this.name = w, this.on = Ks(this, "populate", "blocked", "versionchange", "close", { ready: [Un, Ne] }), this.once = function(he, _e) {
          var be = function() {
            for (var we = [], ke = 0; ke < arguments.length; ke++) we[ke] = arguments[ke];
            R.on(he).unsubscribe(be), _e.apply(R, we);
          };
          return R.on(he, be);
        }, this.on.ready.subscribe = j(this.on.ready.subscribe, function(he) {
          return function(_e, be) {
            zn.vip(function() {
              var we, ke = R._state;
              ke.openComplete ? (ke.dbOpenError || ct.resolve().then(_e), be && he(_e)) : ke.onReadyBeingFired ? (ke.onReadyBeingFired.push(_e), be && he(_e)) : (he(_e), we = R, be || he(function Te() {
                we.on.ready.unsubscribe(_e), we.on.ready.unsubscribe(Te);
              }));
            });
          };
        }), this.Collection = (q = this, hr(Vd.prototype, function(je, Te) {
          this.db = q;
          var be = zo, we = null;
          if (Te) try {
            be = Te();
          } catch (ze) {
            we = ze;
          }
          var ke = je._ctx, Te = ke.table, je = Te.hook.reading.fire;
          this._ctx = { table: Te, index: ke.index, isPrimKey: !ke.index || Te.schema.primKey.keyPath && ke.index === Te.schema.primKey.name, range: be, keysOnly: !1, dir: "next", unique: "", algorithm: null, filter: null, replayFilter: null, justLimit: !0, isMatch: null, offset: 0, limit: 1 / 0, error: we, or: ke.or, valueMapper: je !== Ue ? je : null };
        })), this.Table = (X = this, hr(xs.prototype, function(he, _e, be) {
          this.db = X, this._tx = be, this.name = he, this.schema = _e, this.hook = X._allTables[he] ? X._allTables[he].hook : Ks(null, { creating: [st, Ne], reading: [et, Ue], updating: [Wn, Ne], deleting: [dt, Ne] });
        })), this.Transaction = (oe = this, hr(Yc.prototype, function(he, _e, be, we, ke) {
          var Te = this;
          he !== "readonly" && _e.forEach(function(je) {
            je = (je = be[je]) === null || je === void 0 ? void 0 : je.yProps, je && (_e = _e.concat(je.map(function(ze) {
              return ze.updatesTable;
            })));
          }), this.db = oe, this.mode = he, this.storeNames = _e, this.schema = be, this.chromeTransactionDurability = we, this.idbtrans = null, this.on = Ks(this, "complete", "error", "abort"), this.parent = ke || null, this.active = !0, this._reculock = 0, this._blockedFuncs = [], this._resolve = null, this._reject = null, this._waitingFor = null, this._waitingQueue = null, this._spinCount = 0, this._completion = new ct(function(je, ze) {
            Te._resolve = je, Te._reject = ze;
          }), this._completion.then(function() {
            Te.active = !1, Te.on.complete.fire();
          }, function(je) {
            var ze = Te.active;
            return Te.active = !1, Te.on.error.fire(je), Te.parent ? Te.parent._reject(je) : ze && Te.idbtrans && Te.idbtrans.abort(), on(je);
          });
        })), this.Version = (U = this, hr(Kd.prototype, function(he) {
          this.db = U, this._cfg = { version: he, storesSource: null, dbschema: {}, tables: {}, contentUpgrade: null };
        })), this.WhereClause = (ie = this, hr(ws.prototype, function(he, _e, be) {
          if (this.db = ie, this._ctx = { table: he, index: _e === ":id" ? null : _e, or: be }, this._cmp = this._ascending = zt, this._descending = function(we, ke) {
            return zt(ke, we);
          }, this._max = function(we, ke) {
            return 0 < zt(we, ke) ? we : ke;
          }, this._min = function(we, ke) {
            return zt(we, ke) < 0 ? we : ke;
          }, this._IDBKeyRange = ie._deps.IDBKeyRange, !this._IDBKeyRange) throw new Re.MissingAPI();
        })), this.on("versionchange", function(he) {
          0 < he.newVersion ? console.warn("Another connection wants to upgrade database '".concat(R.name, "'. Closing db now to resume the upgrade.")) : console.warn("Another connection wants to delete database '".concat(R.name, "'. Closing db now to resume the delete request.")), R.close({ disableAutoOpen: !1 });
        }), this.on("blocked", function(he) {
          !he.newVersion || he.newVersion < he.oldVersion ? console.warn("Dexie.delete('".concat(R.name, "') was blocked")) : console.warn("Upgrade '".concat(R.name, "' blocked by other connection holding version ").concat(he.oldVersion / 10));
        }), this._maxKey = ln(E.IDBKeyRange), this._createTransaction = function(he, _e, be, we) {
          return new R.Transaction(he, _e, be, R._options.chromeTransactionDurability, we);
        }, this._fireOnBlocked = function(he) {
          R.on("blocked").fire(he), Ka.filter(function(_e) {
            return _e.name === R.name && _e !== R && !_e._state.vcFired;
          }).map(function(_e) {
            return _e.on("versionchange").fire(he);
          });
        }, this.use(Xd), this.use(Vu), this.use(rf), this.use(nf), this.use(Uu);
        var pe = new Proxy(this, { get: function(he, _e, be) {
          if (_e === "_vip") return !0;
          if (_e === "table") return function(ke) {
            return Ql(R.table(ke), pe);
          };
          var we = Reflect.get(he, _e, be);
          return we instanceof xs ? Ql(we, pe) : _e === "tables" ? we.map(function(ke) {
            return Ql(ke, pe);
          }) : _e === "_createTransaction" ? function() {
            return Ql(we.apply(this, arguments), pe);
          } : we;
        } });
        this.vip = pe, P.forEach(function(he) {
          return he(R);
        });
      }
      var Ho, Ur = typeof Symbol < "u" && "observable" in Symbol ? Symbol.observable : "@@observable", af = (Ki.prototype.subscribe = function(w, E, R) {
        return this._subscribe(w && typeof w != "function" ? w : { next: w, error: E, complete: R });
      }, Ki.prototype[Ur] = function() {
        return this;
      }, Ki);
      function Ki(w) {
        this._subscribe = w;
      }
      try {
        Ho = { indexedDB: s.indexedDB || s.mozIndexedDB || s.webkitIndexedDB || s.msIndexedDB, IDBKeyRange: s.IDBKeyRange || s.webkitIDBKeyRange };
      } catch {
        Ho = { indexedDB: null, IDBKeyRange: null };
      }
      function Zl(w) {
        var E, R = !1, P = new af(function(q) {
          var X = $(w), oe, U = !1, ie = {}, re = {}, pe = { get closed() {
            return U;
          }, unsubscribe: function() {
            U || (U = !0, oe && oe.abort(), he && Rr.storagemutated.unsubscribe(be));
          } };
          q.start && q.start(pe);
          var he = !1, _e = function() {
            return ya(we);
          }, be = function(ke) {
            Fo(ie, ke), ef(re, ie) && _e();
          }, we = function() {
            var ke, Te, je;
            !U && Ho.indexedDB && (ie = {}, ke = {}, oe && oe.abort(), oe = new AbortController(), je = (function(ze) {
              var $e = ha();
              try {
                X && Qn();
                var Ge = wn(w, ze);
                return Ge = X ? Ge.finally(Mr) : Ge;
              } finally {
                $e && Si();
              }
            })(Te = { subscr: ke, signal: oe.signal, requery: _e, querier: w, trans: null }), Promise.resolve(je).then(function(ze) {
              R = !0, E = ze, U || Te.signal.aborted || (ie = {}, (function($e) {
                for (var Ge in $e) if (p($e, Ge)) return;
                return 1;
              })(re = ke) || he || (Rr(Lo, be), he = !0), ya(function() {
                return !U && q.next && q.next(ze);
              }));
            }, function(ze) {
              R = !1, ["DatabaseClosedError", "AbortError"].includes(ze == null ? void 0 : ze.name) || U || ya(function() {
                U || q.error && q.error(ze);
              });
            }));
          };
          return setTimeout(_e, 0), pe;
        });
        return P.hasValue = function() {
          return R;
        }, P.getValue = function() {
          return E;
        }, P;
      }
      var to = Fr;
      function sf(w) {
        var E = di;
        try {
          di = !0, Rr.storagemutated.fire(w), Ss(w, !0);
        } finally {
          di = E;
        }
      }
      x(to, r(r({}, Ie), { delete: function(w) {
        return new to(w, { addons: [] }).delete();
      }, exists: function(w) {
        return new to(w, { addons: [] }).open().then(function(E) {
          return E.close(), !0;
        }).catch("NoSuchDatabaseError", function() {
          return !1;
        });
      }, getDatabaseNames: function(w) {
        try {
          return E = to.dependencies, R = E.indexedDB, E = E.IDBKeyRange, (qr(R) ? Promise.resolve(R.databases()).then(function(P) {
            return P.map(function(q) {
              return q.name;
            }).filter(function(q) {
              return q !== Hs;
            });
          }) : Qc(R, E).toCollection().primaryKeys()).then(w);
        } catch {
          return on(new Re.MissingAPI());
        }
        var E, R;
      }, defineClass: function() {
        return function(w) {
          c(this, w);
        };
      }, ignoreTransaction: function(w) {
        return it.trans ? li(it.transless, w) : w();
      }, vip: Zc, async: function(w) {
        return function() {
          try {
            var E = Uo(w.apply(this, arguments));
            return E && typeof E.then == "function" ? E : ct.resolve(E);
          } catch (R) {
            return on(R);
          }
        };
      }, spawn: function(w, E, R) {
        try {
          var P = Uo(w.apply(R, E || []));
          return P && typeof P.then == "function" ? P : ct.resolve(P);
        } catch (q) {
          return on(q);
        }
      }, currentTransaction: { get: function() {
        return it.trans || null;
      } }, waitFor: function(w, E) {
        return E = ct.resolve(typeof w == "function" ? to.ignoreTransaction(w) : w).timeout(E || 6e4), it.trans ? it.trans.waitFor(E) : E;
      }, Promise: ct, debug: { get: function() {
        return Ht;
      }, set: function(w) {
        On(w);
      } }, derive: k, extend: c, props: x, override: j, Events: Ks, on: Rr, liveQuery: Zl, extendObservabilitySet: Fo, getByKeyPath: I, setByKeyPath: L, delByKeyPath: function(w, E) {
        typeof E == "string" ? L(w, E, void 0) : "length" in E && [].map.call(E, function(R) {
          L(w, R, void 0);
        });
      }, shallowClone: K, deepClone: me, getObjectDiff: Kl, cmp: zt, asap: z, minKey: -1 / 0, addons: [], connections: Ka, errnames: Oe, dependencies: Ho, cache: Js, semVer: "4.2.1", version: "4.2.1".split(".").map(function(w) {
        return parseInt(w);
      }).reduce(function(w, E, R) {
        return w + E / Math.pow(10, 2 * R);
      }) })), to.maxKey = ln(to.dependencies.IDBKeyRange), typeof dispatchEvent < "u" && typeof addEventListener < "u" && (Rr(Lo, function(w) {
        di || (w = new CustomEvent(Ya, { detail: w }), di = !0, dispatchEvent(w), di = !1);
      }), addEventListener(Ya, function(w) {
        w = w.detail, di || sf(w);
      }));
      var Go, di = !1, Mn = function() {
      };
      return typeof BroadcastChannel < "u" && ((Mn = function() {
        (Go = new BroadcastChannel(Ya)).onmessage = function(w) {
          return w.data && sf(w.data);
        };
      })(), typeof Go.unref == "function" && Go.unref(), Rr(Lo, function(w) {
        di || Go.postMessage(w);
      })), typeof addEventListener < "u" && (addEventListener("pagehide", function(w) {
        if (!Fr.disableBfCache && w.persisted) {
          Ht && console.debug("Dexie: handling persisted pagehide"), Go != null && Go.close();
          for (var E = 0, R = Ka; E < R.length; E++) R[E].close({ disableAutoOpen: !1 });
        }
      }), addEventListener("pageshow", function(w) {
        !Fr.disableBfCache && w.persisted && (Ht && console.debug("Dexie: handling persisted pageshow"), Mn(), sf({ all: new Pn(-1 / 0, [[]]) }));
      })), ct.rejectionMapper = function(w, E) {
        return !w || w instanceof G || w instanceof TypeError || w instanceof SyntaxError || !w.name || !ft[w.name] ? w : (E = new ft[w.name](E || w.message, w), "stack" in w && S(E, "stack", { get: function() {
          return this.inner.stack;
        } }), E);
      }, On(Ht), r(Fr, Object.freeze({ __proto__: null, Dexie: Fr, liveQuery: Zl, Entity: Mu, cmp: zt, PropModification: xa, replacePrefix: function(w, E) {
        return new xa({ replacePrefix: [w, E] });
      }, add: function(w) {
        return new xa({ add: w });
      }, remove: function(w) {
        return new xa({ remove: w });
      }, default: Fr, RangeSet: Pn, mergeRanges: Xa, rangesOverlap: Tn }), { default: Fr }), Fr;
    });
  })(rv)), rv.exports;
}
var nU = tU();
const f5 = /* @__PURE__ */ Uc(nU), Yk = Symbol.for("Dexie"), l0 = globalThis[Yk] || (globalThis[Yk] = f5);
if (f5.semVer !== l0.semVer)
  throw new Error(`Two different versions of Dexie loaded in the same app: ${f5.semVer} and ${l0.semVer}`);
const {
  liveQuery: dde,
  mergeRanges: hde,
  rangesOverlap: mde,
  RangeSet: pde,
  cmp: gde,
  Entity: yde,
  PropModification: vde,
  replacePrefix: xde,
  add: bde,
  remove: wde,
  DexieYProvider: _de
} = l0;
var qg = { exports: {} };
/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */
var rU = qg.exports, Wk;
function iU() {
  return Wk || (Wk = 1, (function(e, t) {
    (function() {
      var n, r = "4.17.21", i = 200, s = "Unsupported core-js use. Try https://npms.io/search?q=ponyfill.", o = "Expected a function", u = "Invalid `variable` option passed into `_.template`", c = "__lodash_hash_undefined__", d = 500, m = "__lodash_placeholder__", p = 1, x = 2, b = 4, S = 1, k = 2, A = 1, T = 2, M = 4, j = 8, D = 16, z = 32, I = 64, L = 128, K = 256, ne = 512, Y = 30, H = "...", Z = 800, me = 16, Q = 1, se = 2, J = 3, ue = 1 / 0, de = 9007199254740991, ce = 17976931348623157e292, W = NaN, $ = 4294967295, fe = $ - 1, G = $ >>> 1, le = [
        ["ary", L],
        ["bind", A],
        ["bindKey", T],
        ["curry", j],
        ["curryRight", D],
        ["flip", ne],
        ["partial", z],
        ["partialRight", I],
        ["rearg", K]
      ], xe = "[object Arguments]", Se = "[object Array]", Oe = "[object AsyncFunction]", Be = "[object Boolean]", Re = "[object Date]", ft = "[object DOMException]", Ie = "[object Error]", Ne = "[object Function]", Ue = "[object GeneratorFunction]", et = "[object Map]", tt = "[object Number]", st = "[object Null]", dt = "[object Object]", Wn = "[object Promise]", Rn = "[object Proxy]", Un = "[object RegExp]", Ht = "[object Set]", On = "[object String]", an = "[object Symbol]", En = "[object Undefined]", Xn = "[object WeakMap]", Fe = "[object WeakSet]", Qe = "[object ArrayBuffer]", yt = "[object DataView]", Tt = "[object Float32Array]", Pt = "[object Float64Array]", $n = "[object Int8Array]", Vn = "[object Int16Array]", sn = "[object Int32Array]", Qt = "[object Uint8Array]", kn = "[object Uint8ClampedArray]", it = "[object Uint16Array]", jr = "[object Uint32Array]", fr = /\b__p \+= '';/g, Io = /\b(__p \+=) '' \+/g, ct = /(__e\(.*?\)|\b__t\)) \+\n'';/g, Va = /&(?:amp|lt|gt|quot|#39);/g, gs = /[&<>"']/g, Ui = RegExp(Va.source), Us = RegExp(gs.source), Ha = /<%-([\s\S]+?)%>/g, Gc = /<%([\s\S]+?)%>/g, zl = /<%=([\s\S]+?)%>/g, ha = /\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/, Si = /^\w*$/, Ll = /[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g, Ga = /[\\^$.*+?()[\]{}|]/g, vn = RegExp(Ga.source), Dn = /^\s+/, Bl = /\s/, ys = /\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/, $s = /\{\n\/\* \[wrapped with (.+)\] \*/, Vs = /,? & /, ma = /[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g, wn = /[()=,{}\[\]\/\s]/, Qn = /\\(\\)?/g, Mr = /\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g, pa = /\w*$/, ju = /^[-+]0x[0-9a-f]+$/i, ga = /^0b[01]+$/i, ql = /^\[object .+?Constructor\]$/, li = /^0o[0-7]+$/i, Po = /^(?:0|[1-9]\d*)$/, ya = /[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g, on = /($^)/, ei = /['\n\r\u2028\u2029\\]/g, dr = "\\ud800-\\udfff", Zn = "\\u0300-\\u036f", Ka = "\\ufe20-\\ufe2f", Hs = "\\u20d0-\\u20ff", Ci = Zn + Ka + Hs, $i = "\\u2700-\\u27bf", va = "a-z\\xdf-\\xf6\\xf8-\\xff", zo = "\\xac\\xb1\\xd7\\xf7", Gs = "\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf", Mu = "\\u2000-\\u206f", zt = " \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000", vs = "A-Z\\xc0-\\xd6\\xd8-\\xde", ui = "\\ufe0e\\ufe0f", xr = zo + Gs + Mu + zt, xa = "[']", Ru = "[" + dr + "]", ba = "[" + xr + "]", xs = "[" + Ci + "]", Zt = "\\d+", Ks = "[" + $i + "]", hr = "[" + va + "]", ci = "[^" + dr + xr + Zt + $i + va + vs + "]", bs = "\\ud83c[\\udffb-\\udfff]", Ys = "(?:" + xs + "|" + bs + ")", fi = "[^" + dr + "]", Fl = "(?:\\ud83c[\\udde6-\\uddff]){2}", Ws = "[\\ud800-\\udbff][\\udc00-\\udfff]", Ei = "[" + vs + "]", Vd = "\\u200d", Yt = "(?:" + hr + "|" + ci + ")", Kc = "(?:" + Ei + "|" + ci + ")", Ou = "(?:" + xa + "(?:d|ll|m|re|s|t|ve))?", Hd = "(?:" + xa + "(?:D|LL|M|RE|S|T|VE))?", ti = Ys + "?", wa = "[" + ui + "]?", ki = "(?:" + Vd + "(?:" + [fi, Fl, Ws].join("|") + ")" + wa + ti + ")*", _a = "\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])", Du = "\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])", ws = wa + ti + ki, In = "(?:" + [Ks, Fl, Ws].join("|") + ")" + ws, Vi = "(?:" + [fi + xs + "?", xs, Fl, Ws, Ru].join("|") + ")", Xs = RegExp(xa, "g"), Lo = RegExp(xs, "g"), Ya = RegExp(bs + "(?=" + bs + ")|" + Vi + ws, "g"), Rr = RegExp([
        Ei + "?" + hr + "+" + Ou + "(?=" + [ba, Ei, "$"].join("|") + ")",
        Kc + "+" + Hd + "(?=" + [ba, Ei + Yt, "$"].join("|") + ")",
        Ei + "?" + Yt + "+" + Ou,
        Ei + "+" + Hd,
        Du,
        _a,
        Zt,
        In
      ].join("|"), "g"), Yc = RegExp("[" + Vd + dr + Ci + ui + "]"), ni = /[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/, Sa = [
        "Array",
        "Buffer",
        "DataView",
        "Date",
        "Error",
        "Float32Array",
        "Float64Array",
        "Function",
        "Int8Array",
        "Int16Array",
        "Int32Array",
        "Map",
        "Math",
        "Object",
        "Promise",
        "RegExp",
        "Set",
        "String",
        "Symbol",
        "TypeError",
        "Uint8Array",
        "Uint8ClampedArray",
        "Uint16Array",
        "Uint32Array",
        "WeakMap",
        "_",
        "clearTimeout",
        "isFinite",
        "parseInt",
        "setTimeout"
      ], Iu = -1, cn = {};
      cn[Tt] = cn[Pt] = cn[$n] = cn[Vn] = cn[sn] = cn[Qt] = cn[kn] = cn[it] = cn[jr] = !0, cn[xe] = cn[Se] = cn[Qe] = cn[Be] = cn[yt] = cn[Re] = cn[Ie] = cn[Ne] = cn[et] = cn[tt] = cn[dt] = cn[Un] = cn[Ht] = cn[On] = cn[Xn] = !1;
      var ln = {};
      ln[xe] = ln[Se] = ln[Qe] = ln[yt] = ln[Be] = ln[Re] = ln[Tt] = ln[Pt] = ln[$n] = ln[Vn] = ln[sn] = ln[et] = ln[tt] = ln[dt] = ln[Un] = ln[Ht] = ln[On] = ln[an] = ln[Qt] = ln[kn] = ln[it] = ln[jr] = !0, ln[Ie] = ln[Ne] = ln[Xn] = !1;
      var Bo = {
        // Latin-1 Supplement block.
        : "A",
        : "A",
        : "A",
        : "A",
        : "A",
        : "A",
        : "a",
        : "a",
        : "a",
        : "a",
        : "a",
        : "a",
        : "C",
        : "c",
        : "D",
        : "d",
        : "E",
        : "E",
        : "E",
        : "E",
        : "e",
        : "e",
        : "e",
        : "e",
        : "I",
        : "I",
        : "I",
        : "I",
        : "i",
        : "i",
        : "i",
        : "i",
        : "N",
        : "n",
        : "O",
        : "O",
        : "O",
        : "O",
        : "O",
        : "O",
        : "o",
        : "o",
        : "o",
        : "o",
        : "o",
        : "o",
        : "U",
        : "U",
        : "U",
        : "U",
        : "u",
        : "u",
        : "u",
        : "u",
        : "Y",
        : "y",
        : "y",
        : "Ae",
        : "ae",
        : "Th",
        : "th",
        : "ss",
        // Latin Extended-A block.
        : "A",
        : "A",
        : "A",
        : "a",
        : "a",
        : "a",
        : "C",
        : "C",
        : "C",
        : "C",
        : "c",
        : "c",
        : "c",
        : "c",
        : "D",
        : "D",
        : "d",
        : "d",
        : "E",
        : "E",
        : "E",
        : "E",
        : "E",
        : "e",
        : "e",
        : "e",
        : "e",
        : "e",
        : "G",
        : "G",
        : "G",
        : "G",
        : "g",
        : "g",
        : "g",
        : "g",
        : "H",
        : "H",
        : "h",
        : "h",
        : "I",
        : "I",
        : "I",
        : "I",
        : "I",
        : "i",
        : "i",
        : "i",
        : "i",
        : "i",
        : "J",
        : "j",
        : "K",
        : "k",
        : "k",
        : "L",
        : "L",
        : "L",
        : "L",
        : "L",
        : "l",
        : "l",
        : "l",
        : "l",
        : "l",
        : "N",
        : "N",
        : "N",
        : "N",
        : "n",
        : "n",
        : "n",
        : "n",
        : "O",
        : "O",
        : "O",
        : "o",
        : "o",
        : "o",
        : "R",
        : "R",
        : "R",
        : "r",
        : "r",
        : "r",
        : "S",
        : "S",
        : "S",
        : "S",
        : "s",
        : "s",
        : "s",
        : "s",
        : "T",
        : "T",
        : "T",
        : "t",
        : "t",
        : "t",
        : "U",
        : "U",
        : "U",
        : "U",
        : "U",
        : "U",
        : "u",
        : "u",
        : "u",
        : "u",
        : "u",
        : "u",
        : "W",
        : "w",
        : "Y",
        : "y",
        : "Y",
        : "Z",
        : "Z",
        : "Z",
        : "z",
        : "z",
        : "z",
        : "IJ",
        : "ij",
        : "Oe",
        : "oe",
        : "'n",
        : "s"
      }, Ul = {
        "&": "&amp;",
        "<": "&lt;",
        ">": "&gt;",
        '"': "&quot;",
        "'": "&#39;"
      }, Gd = {
        "&amp;": "&",
        "&lt;": "<",
        "&gt;": ">",
        "&quot;": '"',
        "&#39;": "'"
      }, br = {
        "\\": "\\",
        "'": "'",
        "\n": "n",
        "\r": "r",
        "\u2028": "u2028",
        "\u2029": "u2029"
      }, Qs = parseFloat, Pu = parseInt, Wa = typeof vu == "object" && vu && vu.Object === Object && vu, zu = typeof self == "object" && self && self.Object === Object && self, Jn = Wa || zu || Function("return this")(), $l = t && !t.nodeType && t, Hi = $l && !0 && e && !e.nodeType && e, Vl = Hi && Hi.exports === $l, qo = Vl && Wa.process, ri = (function() {
        try {
          var U = Hi && Hi.require && Hi.require("util").types;
          return U || qo && qo.binding && qo.binding("util");
        } catch {
        }
      })(), Wc = ri && ri.isArrayBuffer, Hl = ri && ri.isDate, Zs = ri && ri.isMap, Gl = ri && ri.isRegExp, Xc = ri && ri.isSet, Kd = ri && ri.isTypedArray;
      function wr(U, ie, re) {
        switch (re.length) {
          case 0:
            return U.call(ie);
          case 1:
            return U.call(ie, re[0]);
          case 2:
            return U.call(ie, re[0], re[1]);
          case 3:
            return U.call(ie, re[0], re[1], re[2]);
        }
        return U.apply(ie, re);
      }
      function Qc(U, ie, re, pe) {
        for (var he = -1, _e = U == null ? 0 : U.length; ++he < _e; ) {
          var be = U[he];
          ie(pe, be, re(be), U);
        }
        return pe;
      }
      function qr(U, ie) {
        for (var re = -1, pe = U == null ? 0 : U.length; ++re < pe && ie(U[re], re, U) !== !1; )
          ;
        return U;
      }
      function Zc(U, ie) {
        for (var re = U == null ? 0 : U.length; re-- && ie(U[re], re, U) !== !1; )
          ;
        return U;
      }
      function Lu(U, ie) {
        for (var re = -1, pe = U == null ? 0 : U.length; ++re < pe; )
          if (!ie(U[re], re, U))
            return !1;
        return !0;
      }
      function Pn(U, ie) {
        for (var re = -1, pe = U == null ? 0 : U.length, he = 0, _e = []; ++re < pe; ) {
          var be = U[re];
          ie(be, re, U) && (_e[he++] = be);
        }
        return _e;
      }
      function _s(U, ie) {
        var re = U == null ? 0 : U.length;
        return !!re && Ss(U, ie, 0) > -1;
      }
      function Xa(U, ie, re) {
        for (var pe = -1, he = U == null ? 0 : U.length; ++pe < he; )
          if (re(ie, U[pe]))
            return !0;
        return !1;
      }
      function Tn(U, ie) {
        for (var re = -1, pe = U == null ? 0 : U.length, he = Array(pe); ++re < pe; )
          he[re] = ie(U[re], re, U);
        return he;
      }
      function Gi(U, ie) {
        for (var re = -1, pe = ie.length, he = U.length; ++re < pe; )
          U[he + re] = ie[re];
        return U;
      }
      function Bu(U, ie, re, pe) {
        var he = -1, _e = U == null ? 0 : U.length;
        for (pe && _e && (re = U[++he]); ++he < _e; )
          re = ie(re, U[he], he, U);
        return re;
      }
      function Jc(U, ie, re, pe) {
        var he = U == null ? 0 : U.length;
        for (pe && he && (re = U[--he]); he--; )
          re = ie(re, U[he], he, U);
        return re;
      }
      function Fo(U, ie) {
        for (var re = -1, pe = U == null ? 0 : U.length; ++re < pe; )
          if (ie(U[re], re, U))
            return !0;
        return !1;
      }
      var ef = Ca("length");
      function Js(U) {
        return U.split("");
      }
      function tf(U) {
        return U.match(ma) || [];
      }
      function qu(U, ie, re) {
        var pe;
        return re(U, function(he, _e, be) {
          if (ie(he, _e, be))
            return pe = _e, !1;
        }), pe;
      }
      function eo(U, ie, re, pe) {
        for (var he = U.length, _e = re + (pe ? 1 : -1); pe ? _e-- : ++_e < he; )
          if (ie(U[_e], _e, U))
            return _e;
        return -1;
      }
      function Ss(U, ie, re) {
        return ie === ie ? sf(U, ie, re) : eo(U, Wd, re);
      }
      function Yd(U, ie, re, pe) {
        for (var he = re - 1, _e = U.length; ++he < _e; )
          if (pe(U[he], ie))
            return he;
        return -1;
      }
      function Wd(U) {
        return U !== U;
      }
      function Uo(U, ie) {
        var re = U == null ? 0 : U.length;
        return re ? Uu(U, ie) / re : W;
      }
      function Ca(U) {
        return function(ie) {
          return ie == null ? n : ie[U];
        };
      }
      function nf(U) {
        return function(ie) {
          return U == null ? n : U[ie];
        };
      }
      function Kl(U, ie, re, pe, he) {
        return he(U, function(_e, be, we) {
          re = pe ? (pe = !1, _e) : ie(re, _e, be, we);
        }), re;
      }
      function Fu(U, ie) {
        var re = U.length;
        for (U.sort(ie); re--; )
          U[re] = U[re].value;
        return U;
      }
      function Uu(U, ie) {
        for (var re, pe = -1, he = U.length; ++pe < he; ) {
          var _e = ie(U[pe]);
          _e !== n && (re = re === n ? _e : re + _e);
        }
        return re;
      }
      function Yl(U, ie) {
        for (var re = -1, pe = Array(U); ++re < U; )
          pe[re] = ie(re);
        return pe;
      }
      function Xd(U, ie) {
        return Tn(ie, function(re) {
          return [re, U[re]];
        });
      }
      function Cs(U) {
        return U && U.slice(0, w(U) + 1).replace(Dn, "");
      }
      function ii(U) {
        return function(ie) {
          return U(ie);
        };
      }
      function rf(U, ie) {
        return Tn(ie, function(re) {
          return U[re];
        });
      }
      function $o(U, ie) {
        return U.has(ie);
      }
      function Wl(U, ie) {
        for (var re = -1, pe = U.length; ++re < pe && Ss(ie, U[re], 0) > -1; )
          ;
        return re;
      }
      function $u(U, ie) {
        for (var re = U.length; re-- && Ss(ie, U[re], 0) > -1; )
          ;
        return re;
      }
      function Vo(U, ie) {
        for (var re = U.length, pe = 0; re--; )
          U[re] === ie && ++pe;
        return pe;
      }
      var Xl = nf(Bo), Wm = nf(Ul);
      function Vu(U) {
        return "\\" + br[U];
      }
      function Ql(U, ie) {
        return U == null ? n : U[ie];
      }
      function Fr(U) {
        return Yc.test(U);
      }
      function zn(U) {
        return ni.test(U);
      }
      function Ho(U) {
        for (var ie, re = []; !(ie = U.next()).done; )
          re.push(ie.value);
        return re;
      }
      function Ur(U) {
        var ie = -1, re = Array(U.size);
        return U.forEach(function(pe, he) {
          re[++ie] = [he, pe];
        }), re;
      }
      function af(U, ie) {
        return function(re) {
          return U(ie(re));
        };
      }
      function Ki(U, ie) {
        for (var re = -1, pe = U.length, he = 0, _e = []; ++re < pe; ) {
          var be = U[re];
          (be === ie || be === m) && (U[re] = m, _e[he++] = re);
        }
        return _e;
      }
      function Zl(U) {
        var ie = -1, re = Array(U.size);
        return U.forEach(function(pe) {
          re[++ie] = pe;
        }), re;
      }
      function to(U) {
        var ie = -1, re = Array(U.size);
        return U.forEach(function(pe) {
          re[++ie] = [pe, pe];
        }), re;
      }
      function sf(U, ie, re) {
        for (var pe = re - 1, he = U.length; ++pe < he; )
          if (U[pe] === ie)
            return pe;
        return -1;
      }
      function Go(U, ie, re) {
        for (var pe = re + 1; pe--; )
          if (U[pe] === ie)
            return pe;
        return pe;
      }
      function di(U) {
        return Fr(U) ? R(U) : ef(U);
      }
      function Mn(U) {
        return Fr(U) ? P(U) : Js(U);
      }
      function w(U) {
        for (var ie = U.length; ie-- && Bl.test(U.charAt(ie)); )
          ;
        return ie;
      }
      var E = nf(Gd);
      function R(U) {
        for (var ie = Ya.lastIndex = 0; Ya.test(U); )
          ++ie;
        return ie;
      }
      function P(U) {
        return U.match(Ya) || [];
      }
      function q(U) {
        return U.match(Rr) || [];
      }
      var X = (function U(ie) {
        ie = ie == null ? Jn : oe.defaults(Jn.Object(), ie, oe.pick(Jn, Sa));
        var re = ie.Array, pe = ie.Date, he = ie.Error, _e = ie.Function, be = ie.Math, we = ie.Object, ke = ie.RegExp, Te = ie.String, je = ie.TypeError, ze = re.prototype, $e = _e.prototype, Ge = we.prototype, nt = ie["__core-js_shared__"], lt = $e.toString, He = Ge.hasOwnProperty, ot = 0, ut = (function() {
          var h = /[^.]+$/.exec(nt && nt.keys && nt.keys.IE_PROTO || "");
          return h ? "Symbol(src)_1." + h : "";
        })(), Je = Ge.toString, pt = lt.call(we), _t = Jn._, Rt = ke(
          "^" + lt.call(He).replace(Ga, "\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g, "$1.*?") + "$"
        ), Dt = Vl ? ie.Buffer : n, Ln = ie.Symbol, Et = ie.Uint8Array, mr = Dt ? Dt.allocUnsafe : n, Nn = af(we.getPrototypeOf, we), Ko = we.create, pr = Ge.propertyIsEnumerable, $r = ze.splice, Hu = Ln ? Ln.isConcatSpreadable : n, Vr = Ln ? Ln.iterator : n, no = Ln ? Ln.toStringTag : n, Ea = (function() {
          try {
            var h = sl(we, "defineProperty");
            return h({}, "", {}), h;
          } catch {
          }
        })(), X0 = ie.clearTimeout !== Jn.clearTimeout && ie.clearTimeout, Qd = pe && pe.now !== Jn.Date.now && pe.now, Jl = ie.setTimeout !== Jn.setTimeout && ie.setTimeout, Gu = be.ceil, of = be.floor, lf = we.getOwnPropertySymbols, Q0 = Dt ? Dt.isBuffer : n, Yi = ie.isFinite, Ku = ze.join, Yu = af(we.keys, we), rr = be.max, _r = be.min, ka = pe.now, Ta = ie.parseInt, ro = be.random, Es = ze.reverse, Na = sl(ie, "DataView"), Wi = sl(ie, "Map"), Zd = sl(ie, "Promise"), Yo = sl(ie, "Set"), eu = sl(ie, "WeakMap"), Wu = sl(we, "create"), Sr = eu && new eu(), gn = {}, Jt = oi(Na), Wo = oi(Wi), Aa = oi(Zd), Xm = oi(Yo), Xo = oi(eu), uf = Ln ? Ln.prototype : n, Xu = uf ? uf.valueOf : n, tu = uf ? uf.toString : n;
        function te(h) {
          if (sr(h) && !It(h) && !(h instanceof Lt)) {
            if (h instanceof Ti)
              return h;
            if (He.call(h, "__wrapped__"))
              return Ah(h);
          }
          return new Ti(h);
        }
        var Qo = /* @__PURE__ */ (function() {
          function h() {
          }
          return function(v) {
            if (!Gn(v))
              return {};
            if (Ko)
              return Ko(v);
            h.prototype = v;
            var C = new h();
            return h.prototype = n, C;
          };
        })();
        function Zo() {
        }
        function Ti(h, v) {
          this.__wrapped__ = h, this.__actions__ = [], this.__chain__ = !!v, this.__index__ = 0, this.__values__ = n;
        }
        te.templateSettings = {
          /**
           * Used to detect `data` property values to be HTML-escaped.
           *
           * @memberOf _.templateSettings
           * @type {RegExp}
           */
          escape: Ha,
          /**
           * Used to detect code to be evaluated.
           *
           * @memberOf _.templateSettings
           * @type {RegExp}
           */
          evaluate: Gc,
          /**
           * Used to detect `data` property values to inject.
           *
           * @memberOf _.templateSettings
           * @type {RegExp}
           */
          interpolate: zl,
          /**
           * Used to reference the data object in the template text.
           *
           * @memberOf _.templateSettings
           * @type {string}
           */
          variable: "",
          /**
           * Used to import variables into the compiled template.
           *
           * @memberOf _.templateSettings
           * @type {Object}
           */
          imports: {
            /**
             * A reference to the `lodash` function.
             *
             * @memberOf _.templateSettings.imports
             * @type {Function}
             */
            _: te
          }
        }, te.prototype = Zo.prototype, te.prototype.constructor = te, Ti.prototype = Qo(Zo.prototype), Ti.prototype.constructor = Ti;
        function Lt(h) {
          this.__wrapped__ = h, this.__actions__ = [], this.__dir__ = 1, this.__filtered__ = !1, this.__iteratees__ = [], this.__takeCount__ = $, this.__views__ = [];
        }
        function io() {
          var h = new Lt(this.__wrapped__);
          return h.__actions__ = mi(this.__actions__), h.__dir__ = this.__dir__, h.__filtered__ = this.__filtered__, h.__iteratees__ = mi(this.__iteratees__), h.__takeCount__ = this.__takeCount__, h.__views__ = mi(this.__views__), h;
        }
        function Jo() {
          if (this.__filtered__) {
            var h = new Lt(this);
            h.__dir__ = -1, h.__filtered__ = !0;
          } else
            h = this.clone(), h.__dir__ *= -1;
          return h;
        }
        function ao() {
          var h = this.__wrapped__.value(), v = this.__dir__, C = It(h), O = v < 0, V = C ? h.length : 0, ae = Wx(0, V, this.__views__), ge = ae.start, Ce = ae.end, Me = Ce - ge, We = O ? Ce : ge - 1, Xe = this.__iteratees__, Ze = Xe.length, ht = 0, wt = _r(Me, this.__takeCount__);
          if (!C || !O && V == Me && wt == Me)
            return fp(h, this.__actions__);
          var jt = [];
          e:
            for (; Me-- && ht < wt; ) {
              We += v;
              for (var Vt = -1, Mt = h[We]; ++Vt < Ze; ) {
                var en = Xe[Vt], un = en.iteratee, ls = en.type, oa = un(Mt);
                if (ls == se)
                  Mt = oa;
                else if (!oa) {
                  if (ls == Q)
                    continue e;
                  break e;
                }
              }
              jt[ht++] = Mt;
            }
          return jt;
        }
        Lt.prototype = Qo(Zo.prototype), Lt.prototype.constructor = Lt;
        function so(h) {
          var v = -1, C = h == null ? 0 : h.length;
          for (this.clear(); ++v < C; ) {
            var O = h[v];
            this.set(O[0], O[1]);
          }
        }
        function Qm() {
          this.__data__ = Wu ? Wu(null) : {}, this.size = 0;
        }
        function Qu(h) {
          var v = this.has(h) && delete this.__data__[h];
          return this.size -= v ? 1 : 0, v;
        }
        function Jd(h) {
          var v = this.__data__;
          if (Wu) {
            var C = v[h];
            return C === c ? n : C;
          }
          return He.call(v, h) ? v[h] : n;
        }
        function nu(h) {
          var v = this.__data__;
          return Wu ? v[h] !== n : He.call(v, h);
        }
        function Hr(h, v) {
          var C = this.__data__;
          return this.size += this.has(h) ? 0 : 1, C[h] = Wu && v === n ? c : v, this;
        }
        so.prototype.clear = Qm, so.prototype.delete = Qu, so.prototype.get = Jd, so.prototype.has = nu, so.prototype.set = Hr;
        function ja(h) {
          var v = -1, C = h == null ? 0 : h.length;
          for (this.clear(); ++v < C; ) {
            var O = h[v];
            this.set(O[0], O[1]);
          }
        }
        function Z0() {
          this.__data__ = [], this.size = 0;
        }
        function Fx(h) {
          var v = this.__data__, C = ks(v, h);
          if (C < 0)
            return !1;
          var O = v.length - 1;
          return C == O ? v.pop() : $r.call(v, C, 1), --this.size, !0;
        }
        function Ux(h) {
          var v = this.__data__, C = ks(v, h);
          return C < 0 ? n : v[C][1];
        }
        function $x(h) {
          return ks(this.__data__, h) > -1;
        }
        function Cr(h, v) {
          var C = this.__data__, O = ks(C, h);
          return O < 0 ? (++this.size, C.push([h, v])) : C[O][1] = v, this;
        }
        ja.prototype.clear = Z0, ja.prototype.delete = Fx, ja.prototype.get = Ux, ja.prototype.has = $x, ja.prototype.set = Cr;
        function Qa(h) {
          var v = -1, C = h == null ? 0 : h.length;
          for (this.clear(); ++v < C; ) {
            var O = h[v];
            this.set(O[0], O[1]);
          }
        }
        function cf() {
          this.size = 0, this.__data__ = {
            hash: new so(),
            map: new (Wi || ja)(),
            string: new so()
          };
        }
        function ff(h) {
          var v = Af(this, h).delete(h);
          return this.size -= v ? 1 : 0, v;
        }
        function Zm(h) {
          return Af(this, h).get(h);
        }
        function Zu(h) {
          return Af(this, h).has(h);
        }
        function Ju(h, v) {
          var C = Af(this, h), O = C.size;
          return C.set(h, v), this.size += C.size == O ? 0 : 1, this;
        }
        Qa.prototype.clear = cf, Qa.prototype.delete = ff, Qa.prototype.get = Zm, Qa.prototype.has = Zu, Qa.prototype.set = Ju;
        function ru(h) {
          var v = -1, C = h == null ? 0 : h.length;
          for (this.__data__ = new Qa(); ++v < C; )
            this.add(h[v]);
        }
        function J0(h) {
          return this.__data__.set(h, c), this;
        }
        function Vx(h) {
          return this.__data__.has(h);
        }
        ru.prototype.add = ru.prototype.push = J0, ru.prototype.has = Vx;
        function Ma(h) {
          var v = this.__data__ = new ja(h);
          this.size = v.size;
        }
        function iu() {
          this.__data__ = new ja(), this.size = 0;
        }
        function Jm(h) {
          var v = this.__data__, C = v.delete(h);
          return this.size = v.size, C;
        }
        function eh(h) {
          return this.__data__.get(h);
        }
        function ey(h) {
          return this.__data__.has(h);
        }
        function ec(h, v) {
          var C = this.__data__;
          if (C instanceof ja) {
            var O = C.__data__;
            if (!Wi || O.length < i - 1)
              return O.push([h, v]), this.size = ++C.size, this;
            C = this.__data__ = new Qa(O);
          }
          return C.set(h, v), this.size = C.size, this;
        }
        Ma.prototype.clear = iu, Ma.prototype.delete = Jm, Ma.prototype.get = eh, Ma.prototype.has = ey, Ma.prototype.set = ec;
        function th(h, v) {
          var C = It(h), O = !C && du(h), V = !C && !O && hl(h), ae = !C && !O && !V && ml(h), ge = C || O || V || ae, Ce = ge ? Yl(h.length, Te) : [], Me = Ce.length;
          for (var We in h)
            (v || He.call(h, We)) && !(ge && // Safari 9 has enumerable `arguments.length` in strict mode.
            (We == "length" || // Node.js 0.10 has enumerable non-index properties on buffers.
            V && (We == "offset" || We == "parent") || // PhantomJS 2 has enumerable non-index properties on typed arrays.
            ae && (We == "buffer" || We == "byteLength" || We == "byteOffset") || // Skip index properties.
            is(We, Me))) && Ce.push(We);
          return Ce;
        }
        function df(h) {
          var v = h.length;
          return v ? h[lc(0, v - 1)] : n;
        }
        function nh(h, v) {
          return zf(mi(h), Ja(v, 0, h.length));
        }
        function ty(h) {
          return zf(mi(h));
        }
        function rh(h, v, C) {
          (C !== n && !ia(h[v], C) || C === n && !(v in h)) && Xi(h, v, C);
        }
        function Za(h, v, C) {
          var O = h[v];
          (!(He.call(h, v) && ia(O, C)) || C === n && !(v in h)) && Xi(h, v, C);
        }
        function ks(h, v) {
          for (var C = h.length; C--; )
            if (ia(h[C][0], v))
              return C;
          return -1;
        }
        function ny(h, v, C, O) {
          return Ts(h, function(V, ae, ge) {
            v(O, V, C(V), ge);
          }), O;
        }
        function ep(h, v) {
          return h && Ia(v, Dr(v), h);
        }
        function tc(h, v) {
          return h && Ia(v, zi(v), h);
        }
        function Xi(h, v, C) {
          v == "__proto__" && Ea ? Ea(h, v, {
            configurable: !0,
            enumerable: !0,
            value: C,
            writable: !0
          }) : h[v] = C;
        }
        function nc(h, v) {
          for (var C = -1, O = v.length, V = re(O), ae = h == null; ++C < O; )
            V[C] = ae ? n : pl(h, v[C]);
          return V;
        }
        function Ja(h, v, C) {
          return h === h && (C !== n && (h = h <= C ? h : C), v !== n && (h = h >= v ? h : v)), h;
        }
        function hi(h, v, C, O, V, ae) {
          var ge, Ce = v & p, Me = v & x, We = v & b;
          if (C && (ge = V ? C(h, O, V, ae) : C(h)), ge !== n)
            return ge;
          if (!Gn(h))
            return h;
          var Xe = It(h);
          if (Xe) {
            if (ge = xy(h), !Ce)
              return mi(h, ge);
          } else {
            var Ze = Kr(h), ht = Ze == Ne || Ze == Ue;
            if (hl(h))
              return mp(h, Ce);
            if (Ze == dt || Ze == xe || ht && !V) {
              if (ge = Me || ht ? {} : Np(h), !Ce)
                return Me ? my(h, tc(ge, h)) : hy(h, ep(ge, h));
            } else {
              if (!ln[Ze])
                return V ? h : {};
              ge = by(h, Ze, Ce);
            }
          }
          ae || (ae = new Ma());
          var wt = ae.get(h);
          if (wt)
            return wt;
          ae.set(h, ge), Jf(h) ? h.forEach(function(Mt) {
            ge.add(hi(Mt, v, C, Mt, h, ae));
          }) : n1(h) && h.forEach(function(Mt, en) {
            ge.set(en, hi(Mt, v, C, en, h, ae));
          });
          var jt = We ? Me ? Tp : wh : Me ? zi : Dr, Vt = Xe ? n : jt(h);
          return qr(Vt || h, function(Mt, en) {
            Vt && (en = Mt, Mt = h[en]), Za(ge, en, hi(Mt, v, C, en, h, ae));
          }), ge;
        }
        function ry(h) {
          var v = Dr(h);
          return function(C) {
            return el(C, h, v);
          };
        }
        function el(h, v, C) {
          var O = C.length;
          if (h == null)
            return !O;
          for (h = we(h); O--; ) {
            var V = C[O], ae = v[V], ge = h[V];
            if (ge === n && !(V in h) || !ae(ge))
              return !1;
          }
          return !0;
        }
        function tp(h, v, C) {
          if (typeof h != "function")
            throw new je(o);
          return Pf(function() {
            h.apply(n, C);
          }, v);
        }
        function Ra(h, v, C, O) {
          var V = -1, ae = _s, ge = !0, Ce = h.length, Me = [], We = v.length;
          if (!Ce)
            return Me;
          C && (v = Tn(v, ii(C))), O ? (ae = Xa, ge = !1) : v.length >= i && (ae = $o, ge = !1, v = new ru(v));
          e:
            for (; ++V < Ce; ) {
              var Xe = h[V], Ze = C == null ? Xe : C(Xe);
              if (Xe = O || Xe !== 0 ? Xe : 0, ge && Ze === Ze) {
                for (var ht = We; ht--; )
                  if (v[ht] === Ze)
                    continue e;
                Me.push(Xe);
              } else ae(v, Ze, O) || Me.push(Xe);
            }
          return Me;
        }
        var Ts = vp(ts), ih = vp(sh, !0);
        function tl(h, v) {
          var C = !0;
          return Ts(h, function(O, V, ae) {
            return C = !!v(O, V, ae), C;
          }), C;
        }
        function es(h, v, C) {
          for (var O = -1, V = h.length; ++O < V; ) {
            var ae = h[O], ge = v(ae);
            if (ge != null && (Ce === n ? ge === ge && !Pi(ge) : C(ge, Ce)))
              var Ce = ge, Me = ae;
          }
          return Me;
        }
        function hf(h, v, C, O) {
          var V = h.length;
          for (C = At(C), C < 0 && (C = -C > V ? 0 : V + C), O = O === n || O > V ? V : At(O), O < 0 && (O += V), O = C > O ? 0 : hg(O); C < O; )
            h[C++] = v;
          return h;
        }
        function ah(h, v) {
          var C = [];
          return Ts(h, function(O, V, ae) {
            v(O, V, ae) && C.push(O);
          }), C;
        }
        function Tr(h, v, C, O, V) {
          var ae = -1, ge = h.length;
          for (C || (C = jp), V || (V = []); ++ae < ge; ) {
            var Ce = h[ae];
            v > 0 && C(Ce) ? v > 1 ? Tr(Ce, v - 1, C, O, V) : Gi(V, Ce) : O || (V[V.length] = Ce);
          }
          return V;
        }
        var au = xp(), rc = xp(!0);
        function ts(h, v) {
          return h && au(h, v, Dr);
        }
        function sh(h, v) {
          return h && rc(h, v, Dr);
        }
        function oo(h, v) {
          return Pn(v, function(C) {
            return aa(h[C]);
          });
        }
        function Ns(h, v) {
          v = ea(v, h);
          for (var C = 0, O = v.length; h != null && C < O; )
            h = h[ji(v[C++])];
          return C && C == O ? h : n;
        }
        function np(h, v, C) {
          var O = v(h);
          return It(h) ? O : Gi(O, C(h));
        }
        function Gr(h) {
          return h == null ? h === n ? En : st : no && no in we(h) ? jf(h) : Rp(h);
        }
        function mf(h, v) {
          return h > v;
        }
        function Qi(h, v) {
          return h != null && He.call(h, v);
        }
        function Oa(h, v) {
          return h != null && v in we(h);
        }
        function nl(h, v, C) {
          return h >= _r(v, C) && h < rr(v, C);
        }
        function pf(h, v, C) {
          for (var O = C ? Xa : _s, V = h[0].length, ae = h.length, ge = ae, Ce = re(ae), Me = 1 / 0, We = []; ge--; ) {
            var Xe = h[ge];
            ge && v && (Xe = Tn(Xe, ii(v))), Me = _r(Xe.length, Me), Ce[ge] = !C && (v || V >= 120 && Xe.length >= 120) ? new ru(ge && Xe) : n;
          }
          Xe = h[0];
          var Ze = -1, ht = Ce[0];
          e:
            for (; ++Ze < V && We.length < Me; ) {
              var wt = Xe[Ze], jt = v ? v(wt) : wt;
              if (wt = C || wt !== 0 ? wt : 0, !(ht ? $o(ht, jt) : O(We, jt, C))) {
                for (ge = ae; --ge; ) {
                  var Vt = Ce[ge];
                  if (!(Vt ? $o(Vt, jt) : O(h[ge], jt, C)))
                    continue e;
                }
                ht && ht.push(jt), We.push(wt);
              }
            }
          return We;
        }
        function iy(h, v, C, O) {
          return ts(h, function(V, ae, ge) {
            v(O, C(V), ae, ge);
          }), O;
        }
        function Da(h, v, C) {
          v = ea(v, h), h = Df(h, v);
          var O = h == null ? h : h[ji(qn(v))];
          return O == null ? n : wr(O, h, C);
        }
        function Ni(h) {
          return sr(h) && Gr(h) == xe;
        }
        function gr(h) {
          return sr(h) && Gr(h) == Qe;
        }
        function oh(h) {
          return sr(h) && Gr(h) == Re;
        }
        function Zi(h, v, C, O, V) {
          return h === v ? !0 : h == null || v == null || !sr(h) && !sr(v) ? h !== h && v !== v : Bt(h, v, C, O, Zi, V);
        }
        function Bt(h, v, C, O, V, ae) {
          var ge = It(h), Ce = It(v), Me = ge ? Se : Kr(h), We = Ce ? Se : Kr(v);
          Me = Me == xe ? dt : Me, We = We == xe ? dt : We;
          var Xe = Me == dt, Ze = We == dt, ht = Me == We;
          if (ht && hl(h)) {
            if (!hl(v))
              return !1;
            ge = !0, Xe = !1;
          }
          if (ht && !Xe)
            return ae || (ae = new Ma()), ge || ml(h) ? Tf(h, v, C, O, V, ae) : vy(h, v, Me, C, O, V, ae);
          if (!(C & S)) {
            var wt = Xe && He.call(h, "__wrapped__"), jt = Ze && He.call(v, "__wrapped__");
            if (wt || jt) {
              var Vt = wt ? h.value() : h, Mt = jt ? v.value() : v;
              return ae || (ae = new Ma()), V(Vt, Mt, C, O, ae);
            }
          }
          return ht ? (ae || (ae = new Ma()), kp(h, v, C, O, V, ae)) : !1;
        }
        function _n(h) {
          return sr(h) && Kr(h) == et;
        }
        function ir(h, v, C, O) {
          var V = C.length, ae = V, ge = !O;
          if (h == null)
            return !ae;
          for (h = we(h); V--; ) {
            var Ce = C[V];
            if (ge && Ce[2] ? Ce[1] !== h[Ce[0]] : !(Ce[0] in h))
              return !1;
          }
          for (; ++V < ae; ) {
            Ce = C[V];
            var Me = Ce[0], We = h[Me], Xe = Ce[1];
            if (ge && Ce[2]) {
              if (We === n && !(Me in h))
                return !1;
            } else {
              var Ze = new Ma();
              if (O)
                var ht = O(We, Xe, Me, h, v, Ze);
              if (!(ht === n ? Zi(Xe, We, S | k, O, Ze) : ht))
                return !1;
            }
          }
          return !0;
        }
        function gf(h) {
          if (!Gn(h) || wy(h))
            return !1;
          var v = aa(h) ? Rt : ql;
          return v.test(oi(h));
        }
        function ic(h) {
          return sr(h) && Gr(h) == Un;
        }
        function su(h) {
          return sr(h) && Kr(h) == Ht;
        }
        function lh(h) {
          return sr(h) && Uh(h.length) && !!cn[Gr(h)];
        }
        function ac(h) {
          return typeof h == "function" ? h : h == null ? gi : typeof h == "object" ? It(h) ? rp(h[0], h[1]) : ch(h) : ee(h);
        }
        function rl(h) {
          if (!hc(h))
            return Yu(h);
          var v = [];
          for (var C in we(h))
            He.call(h, C) && C != "constructor" && v.push(C);
          return v;
        }
        function Hx(h) {
          if (!Gn(h))
            return uo(h);
          var v = hc(h), C = [];
          for (var O in h)
            O == "constructor" && (v || !He.call(h, O)) || C.push(O);
          return C;
        }
        function Hn(h, v) {
          return h < v;
        }
        function uh(h, v) {
          var C = -1, O = Ii(h) ? re(h.length) : [];
          return Ts(h, function(V, ae, ge) {
            O[++C] = v(V, ae, ge);
          }), O;
        }
        function ch(h) {
          var v = _h(h);
          return v.length == 1 && v[0][2] ? Th(v[0][0], v[0][1]) : function(C) {
            return C === h || ir(C, h, v);
          };
        }
        function rp(h, v) {
          return Rf(h) && js(v) ? Th(ji(h), v) : function(C) {
            var O = pl(C, h);
            return O === n && O === v ? pg(C, h) : Zi(v, O, S | k);
          };
        }
        function yf(h, v, C, O, V) {
          h !== v && au(v, function(ae, ge) {
            if (V || (V = new Ma()), Gn(ae))
              Gx(h, v, ge, C, yf, O, V);
            else {
              var Ce = O ? O(An(h, ge), ae, ge + "", h, v, V) : n;
              Ce === n && (Ce = ae), rh(h, ge, Ce);
            }
          }, zi);
        }
        function Gx(h, v, C, O, V, ae, ge) {
          var Ce = An(h, C), Me = An(v, C), We = ge.get(Me);
          if (We) {
            rh(h, C, We);
            return;
          }
          var Xe = ae ? ae(Ce, Me, C + "", h, v, ge) : n, Ze = Xe === n;
          if (Ze) {
            var ht = It(Me), wt = !ht && hl(Me), jt = !ht && !wt && ml(Me);
            Xe = Me, ht || wt || jt ? It(Ce) ? Xe = Ce : vr(Ce) ? Xe = mi(Ce) : wt ? (Ze = !1, Xe = mp(Me, !0)) : jt ? (Ze = !1, Xe = pp(Me, !0)) : Xe = [] : Qf(Me) || du(Me) ? (Xe = Ce, du(Ce) ? Xe = $h(Ce) : (!Gn(Ce) || aa(Ce)) && (Xe = Np(Me))) : Ze = !1;
          }
          Ze && (ge.set(Me, Xe), V(Xe, Me, O, ae, ge), ge.delete(Me)), rh(h, C, Xe);
        }
        function fh(h, v) {
          var C = h.length;
          if (C)
            return v += v < 0 ? C : 0, is(v, C) ? h[v] : n;
        }
        function dh(h, v, C) {
          v.length ? v = Tn(v, function(ae) {
            return It(ae) ? function(ge) {
              return Ns(ge, ae.length === 1 ? ae[0] : ae);
            } : ae;
          }) : v = [gi];
          var O = -1;
          v = Tn(v, ii(Ct()));
          var V = uh(h, function(ae, ge, Ce) {
            var Me = Tn(v, function(We) {
              return We(ae);
            });
            return { criteria: Me, index: ++O, value: ae };
          });
          return Fu(V, function(ae, ge) {
            return dy(ae, ge, C);
          });
        }
        function ip(h, v) {
          return ai(h, v, function(C, O) {
            return pg(h, O);
          });
        }
        function ai(h, v, C) {
          for (var O = -1, V = v.length, ae = {}; ++O < V; ) {
            var ge = v[O], Ce = Ns(h, ge);
            C(Ce, ge) && uc(ae, ea(ge, h), Ce);
          }
          return ae;
        }
        function yr(h) {
          return function(v) {
            return Ns(v, h);
          };
        }
        function sc(h, v, C, O) {
          var V = O ? Yd : Ss, ae = -1, ge = v.length, Ce = h;
          for (h === v && (v = mi(v)), C && (Ce = Tn(h, ii(C))); ++ae < ge; )
            for (var Me = 0, We = v[ae], Xe = C ? C(We) : We; (Me = V(Ce, Xe, Me, O)) > -1; )
              Ce !== h && $r.call(Ce, Me, 1), $r.call(h, Me, 1);
          return h;
        }
        function oc(h, v) {
          for (var C = h ? v.length : 0, O = C - 1; C--; ) {
            var V = v[C];
            if (C == O || V !== ae) {
              var ae = V;
              is(V) ? $r.call(h, V, 1) : vf(h, V);
            }
          }
          return h;
        }
        function lc(h, v) {
          return h + of(ro() * (v - h + 1));
        }
        function ap(h, v, C, O) {
          for (var V = -1, ae = rr(Gu((v - h) / (C || 1)), 0), ge = re(ae); ae--; )
            ge[O ? ae : ++V] = h, h += C;
          return ge;
        }
        function ns(h, v) {
          var C = "";
          if (!h || v < 1 || v > de)
            return C;
          do
            v % 2 && (C += h), v = of(v / 2), v && (h += h);
          while (v);
          return C;
        }
        function qt(h, v) {
          return Nh(Op(h, v, gi), h + "");
        }
        function sp(h) {
          return df(Tc(h));
        }
        function op(h, v) {
          var C = Tc(h);
          return zf(C, Ja(v, 0, C.length));
        }
        function uc(h, v, C, O) {
          if (!Gn(h))
            return h;
          v = ea(v, h);
          for (var V = -1, ae = v.length, ge = ae - 1, Ce = h; Ce != null && ++V < ae; ) {
            var Me = ji(v[V]), We = C;
            if (Me === "__proto__" || Me === "constructor" || Me === "prototype")
              return h;
            if (V != ge) {
              var Xe = Ce[Me];
              We = O ? O(Xe, Me, Ce) : n, We === n && (We = Gn(Xe) ? Xe : is(v[V + 1]) ? [] : {});
            }
            Za(Ce, Me, We), Ce = Ce[Me];
          }
          return h;
        }
        var lp = Sr ? function(h, v) {
          return Sr.set(h, v), h;
        } : gi, ay = Ea ? function(h, v) {
          return Ea(h, "toString", {
            configurable: !0,
            enumerable: !1,
            value: Ac(v),
            writable: !0
          });
        } : gi;
        function sy(h) {
          return zf(Tc(h));
        }
        function Ji(h, v, C) {
          var O = -1, V = h.length;
          v < 0 && (v = -v > V ? 0 : V + v), C = C > V ? V : C, C < 0 && (C += V), V = v > C ? 0 : C - v >>> 0, v >>>= 0;
          for (var ae = re(V); ++O < V; )
            ae[O] = h[O + v];
          return ae;
        }
        function oy(h, v) {
          var C;
          return Ts(h, function(O, V, ae) {
            return C = v(O, V, ae), !C;
          }), !!C;
        }
        function cc(h, v, C) {
          var O = 0, V = h == null ? O : h.length;
          if (typeof v == "number" && v === v && V <= G) {
            for (; O < V; ) {
              var ae = O + V >>> 1, ge = h[ae];
              ge !== null && !Pi(ge) && (C ? ge <= v : ge < v) ? O = ae + 1 : V = ae;
            }
            return V;
          }
          return hh(h, v, gi, C);
        }
        function hh(h, v, C, O) {
          var V = 0, ae = h == null ? 0 : h.length;
          if (ae === 0)
            return 0;
          v = C(v);
          for (var ge = v !== v, Ce = v === null, Me = Pi(v), We = v === n; V < ae; ) {
            var Xe = of((V + ae) / 2), Ze = C(h[Xe]), ht = Ze !== n, wt = Ze === null, jt = Ze === Ze, Vt = Pi(Ze);
            if (ge)
              var Mt = O || jt;
            else We ? Mt = jt && (O || ht) : Ce ? Mt = jt && ht && (O || !wt) : Me ? Mt = jt && ht && !wt && (O || !Vt) : wt || Vt ? Mt = !1 : Mt = O ? Ze <= v : Ze < v;
            Mt ? V = Xe + 1 : ae = Xe;
          }
          return _r(ae, fe);
        }
        function ly(h, v) {
          for (var C = -1, O = h.length, V = 0, ae = []; ++C < O; ) {
            var ge = h[C], Ce = v ? v(ge) : ge;
            if (!C || !ia(Ce, Me)) {
              var Me = Ce;
              ae[V++] = ge === 0 ? 0 : ge;
            }
          }
          return ae;
        }
        function up(h) {
          return typeof h == "number" ? h : Pi(h) ? W : +h;
        }
        function Ai(h) {
          if (typeof h == "string")
            return h;
          if (It(h))
            return Tn(h, Ai) + "";
          if (Pi(h))
            return tu ? tu.call(h) : "";
          var v = h + "";
          return v == "0" && 1 / h == -ue ? "-0" : v;
        }
        function lo(h, v, C) {
          var O = -1, V = _s, ae = h.length, ge = !0, Ce = [], Me = Ce;
          if (C)
            ge = !1, V = Xa;
          else if (ae >= i) {
            var We = v ? null : gy(h);
            if (We)
              return Zl(We);
            ge = !1, V = $o, Me = new ru();
          } else
            Me = v ? [] : Ce;
          e:
            for (; ++O < ae; ) {
              var Xe = h[O], Ze = v ? v(Xe) : Xe;
              if (Xe = C || Xe !== 0 ? Xe : 0, ge && Ze === Ze) {
                for (var ht = Me.length; ht--; )
                  if (Me[ht] === Ze)
                    continue e;
                v && Me.push(Ze), Ce.push(Xe);
              } else V(Me, Ze, C) || (Me !== Ce && Me.push(Ze), Ce.push(Xe));
            }
          return Ce;
        }
        function vf(h, v) {
          return v = ea(v, h), h = Df(h, v), h == null || delete h[ji(qn(v))];
        }
        function cp(h, v, C, O) {
          return uc(h, v, C(Ns(h, v)), O);
        }
        function xf(h, v, C, O) {
          for (var V = h.length, ae = O ? V : -1; (O ? ae-- : ++ae < V) && v(h[ae], ae, h); )
            ;
          return C ? Ji(h, O ? 0 : ae, O ? ae + 1 : V) : Ji(h, O ? ae + 1 : 0, O ? V : ae);
        }
        function fp(h, v) {
          var C = h;
          return C instanceof Lt && (C = C.value()), Bu(v, function(O, V) {
            return V.func.apply(V.thisArg, Gi([O], V.args));
          }, C);
        }
        function mh(h, v, C) {
          var O = h.length;
          if (O < 2)
            return O ? lo(h[0]) : [];
          for (var V = -1, ae = re(O); ++V < O; )
            for (var ge = h[V], Ce = -1; ++Ce < O; )
              Ce != V && (ae[V] = Ra(ae[V] || ge, h[Ce], v, C));
          return lo(Tr(ae, 1), v, C);
        }
        function dp(h, v, C) {
          for (var O = -1, V = h.length, ae = v.length, ge = {}; ++O < V; ) {
            var Ce = O < ae ? v[O] : n;
            C(ge, h[O], Ce);
          }
          return ge;
        }
        function hp(h) {
          return vr(h) ? h : [];
        }
        function ph(h) {
          return typeof h == "function" ? h : gi;
        }
        function ea(h, v) {
          return It(h) ? h : Rf(h, v) ? [h] : Dp(yn(h));
        }
        var uy = qt;
        function rs(h, v, C) {
          var O = h.length;
          return C = C === n ? O : C, !v && C >= O ? h : Ji(h, v, C);
        }
        var bf = X0 || function(h) {
          return Jn.clearTimeout(h);
        };
        function mp(h, v) {
          if (v)
            return h.slice();
          var C = h.length, O = mr ? mr(C) : new h.constructor(C);
          return h.copy(O), O;
        }
        function wf(h) {
          var v = new h.constructor(h.byteLength);
          return new Et(v).set(new Et(h)), v;
        }
        function Kx(h, v) {
          var C = v ? wf(h.buffer) : h.buffer;
          return new h.constructor(C, h.byteOffset, h.byteLength);
        }
        function cy(h) {
          var v = new h.constructor(h.source, pa.exec(h));
          return v.lastIndex = h.lastIndex, v;
        }
        function fy(h) {
          return Xu ? we(Xu.call(h)) : {};
        }
        function pp(h, v) {
          var C = v ? wf(h.buffer) : h.buffer;
          return new h.constructor(C, h.byteOffset, h.length);
        }
        function gp(h, v) {
          if (h !== v) {
            var C = h !== n, O = h === null, V = h === h, ae = Pi(h), ge = v !== n, Ce = v === null, Me = v === v, We = Pi(v);
            if (!Ce && !We && !ae && h > v || ae && ge && Me && !Ce && !We || O && ge && Me || !C && Me || !V)
              return 1;
            if (!O && !ae && !We && h < v || We && C && V && !O && !ae || Ce && C && V || !ge && V || !Me)
              return -1;
          }
          return 0;
        }
        function dy(h, v, C) {
          for (var O = -1, V = h.criteria, ae = v.criteria, ge = V.length, Ce = C.length; ++O < ge; ) {
            var Me = gp(V[O], ae[O]);
            if (Me) {
              if (O >= Ce)
                return Me;
              var We = C[O];
              return Me * (We == "desc" ? -1 : 1);
            }
          }
          return h.index - v.index;
        }
        function gh(h, v, C, O) {
          for (var V = -1, ae = h.length, ge = C.length, Ce = -1, Me = v.length, We = rr(ae - ge, 0), Xe = re(Me + We), Ze = !O; ++Ce < Me; )
            Xe[Ce] = v[Ce];
          for (; ++V < ge; )
            (Ze || V < ae) && (Xe[C[V]] = h[V]);
          for (; We--; )
            Xe[Ce++] = h[V++];
          return Xe;
        }
        function yp(h, v, C, O) {
          for (var V = -1, ae = h.length, ge = -1, Ce = C.length, Me = -1, We = v.length, Xe = rr(ae - Ce, 0), Ze = re(Xe + We), ht = !O; ++V < Xe; )
            Ze[V] = h[V];
          for (var wt = V; ++Me < We; )
            Ze[wt + Me] = v[Me];
          for (; ++ge < Ce; )
            (ht || V < ae) && (Ze[wt + C[ge]] = h[V++]);
          return Ze;
        }
        function mi(h, v) {
          var C = -1, O = h.length;
          for (v || (v = re(O)); ++C < O; )
            v[C] = h[C];
          return v;
        }
        function Ia(h, v, C, O) {
          var V = !C;
          C || (C = {});
          for (var ae = -1, ge = v.length; ++ae < ge; ) {
            var Ce = v[ae], Me = O ? O(C[Ce], h[Ce], Ce, C, h) : n;
            Me === n && (Me = h[Ce]), V ? Xi(C, Ce, Me) : Za(C, Ce, Me);
          }
          return C;
        }
        function hy(h, v) {
          return Ia(h, Sh(h), v);
        }
        function my(h, v) {
          return Ia(h, Mf(h), v);
        }
        function yh(h, v) {
          return function(C, O) {
            var V = It(C) ? Qc : ny, ae = v ? v() : {};
            return V(C, h, Ct(O, 2), ae);
          };
        }
        function il(h) {
          return qt(function(v, C) {
            var O = -1, V = C.length, ae = V > 1 ? C[V - 1] : n, ge = V > 2 ? C[2] : n;
            for (ae = h.length > 3 && typeof ae == "function" ? (V--, ae) : n, ge && si(C[0], C[1], ge) && (ae = V < 3 ? n : ae, V = 1), v = we(v); ++O < V; ) {
              var Ce = C[O];
              Ce && h(v, Ce, O, ae);
            }
            return v;
          });
        }
        function vp(h, v) {
          return function(C, O) {
            if (C == null)
              return C;
            if (!Ii(C))
              return h(C, O);
            for (var V = C.length, ae = v ? V : -1, ge = we(C); (v ? ae-- : ++ae < V) && O(ge[ae], ae, ge) !== !1; )
              ;
            return C;
          };
        }
        function xp(h) {
          return function(v, C, O) {
            for (var V = -1, ae = we(v), ge = O(v), Ce = ge.length; Ce--; ) {
              var Me = ge[h ? Ce : ++V];
              if (C(ae[Me], Me, ae) === !1)
                break;
            }
            return v;
          };
        }
        function bp(h, v, C) {
          var O = v & A, V = _f(h);
          function ae() {
            var ge = this && this !== Jn && this instanceof ae ? V : h;
            return ge.apply(O ? C : this, arguments);
          }
          return ae;
        }
        function wp(h) {
          return function(v) {
            v = yn(v);
            var C = Fr(v) ? Mn(v) : n, O = C ? C[0] : v.charAt(0), V = C ? rs(C, 1).join("") : v.slice(1);
            return O[h]() + V;
          };
        }
        function ou(h) {
          return function(v) {
            return Bu(A1(Nc(v).replace(Xs, "")), h, "");
          };
        }
        function _f(h) {
          return function() {
            var v = arguments;
            switch (v.length) {
              case 0:
                return new h();
              case 1:
                return new h(v[0]);
              case 2:
                return new h(v[0], v[1]);
              case 3:
                return new h(v[0], v[1], v[2]);
              case 4:
                return new h(v[0], v[1], v[2], v[3]);
              case 5:
                return new h(v[0], v[1], v[2], v[3], v[4]);
              case 6:
                return new h(v[0], v[1], v[2], v[3], v[4], v[5]);
              case 7:
                return new h(v[0], v[1], v[2], v[3], v[4], v[5], v[6]);
            }
            var C = Qo(h.prototype), O = h.apply(C, v);
            return Gn(O) ? O : C;
          };
        }
        function Yx(h, v, C) {
          var O = _f(h);
          function V() {
            for (var ae = arguments.length, ge = re(ae), Ce = ae, Me = ar(V); Ce--; )
              ge[Ce] = arguments[Ce];
            var We = ae < 3 && ge[0] !== Me && ge[ae - 1] !== Me ? [] : Ki(ge, Me);
            if (ae -= We.length, ae < C)
              return bh(
                h,
                v,
                dc,
                V.placeholder,
                n,
                ge,
                We,
                n,
                n,
                C - ae
              );
            var Xe = this && this !== Jn && this instanceof V ? O : h;
            return wr(Xe, this, ge);
          }
          return V;
        }
        function _p(h) {
          return function(v, C, O) {
            var V = we(v);
            if (!Ii(v)) {
              var ae = Ct(C, 3);
              v = Dr(v), C = function(Ce) {
                return ae(V[Ce], Ce, V);
              };
            }
            var ge = h(v, C, O);
            return ge > -1 ? V[ae ? v[ge] : ge] : n;
          };
        }
        function fc(h) {
          return As(function(v) {
            var C = v.length, O = C, V = Ti.prototype.thru;
            for (h && v.reverse(); O--; ) {
              var ae = v[O];
              if (typeof ae != "function")
                throw new je(o);
              if (V && !ge && er(ae) == "wrapper")
                var ge = new Ti([], !0);
            }
            for (O = ge ? O : C; ++O < C; ) {
              ae = v[O];
              var Ce = er(ae), Me = Ce == "wrapper" ? Nf(ae) : n;
              Me && Of(Me[0]) && Me[1] == (L | j | z | K) && !Me[4].length && Me[9] == 1 ? ge = ge[er(Me[0])].apply(ge, Me[3]) : ge = ae.length == 1 && Of(ae) ? ge[Ce]() : ge.thru(ae);
            }
            return function() {
              var We = arguments, Xe = We[0];
              if (ge && We.length == 1 && It(Xe))
                return ge.plant(Xe).value();
              for (var Ze = 0, ht = C ? v[Ze].apply(this, We) : Xe; ++Ze < C; )
                ht = v[Ze].call(this, ht);
              return ht;
            };
          });
        }
        function dc(h, v, C, O, V, ae, ge, Ce, Me, We) {
          var Xe = v & L, Ze = v & A, ht = v & T, wt = v & (j | D), jt = v & ne, Vt = ht ? n : _f(h);
          function Mt() {
            for (var en = arguments.length, un = re(en), ls = en; ls--; )
              un[ls] = arguments[ls];
            if (wt)
              var oa = ar(Mt), us = Vo(un, oa);
            if (O && (un = gh(un, O, V, wt)), ae && (un = yp(un, ae, ge, wt)), en -= us, wt && en < We) {
              var Ar = Ki(un, oa);
              return bh(
                h,
                v,
                dc,
                Mt.placeholder,
                C,
                un,
                Ar,
                Ce,
                Me,
                We - en
              );
            }
            var xo = Ze ? C : this, mu = ht ? xo[h] : h;
            return en = un.length, Ce ? un = If(un, Ce) : jt && en > 1 && un.reverse(), Xe && Me < en && (un.length = Me), this && this !== Jn && this instanceof Mt && (mu = Vt || _f(mu)), mu.apply(xo, un);
          }
          return Mt;
        }
        function Sf(h, v) {
          return function(C, O) {
            return iy(C, h, v(O), {});
          };
        }
        function Cf(h, v) {
          return function(C, O) {
            var V;
            if (C === n && O === n)
              return v;
            if (C !== n && (V = C), O !== n) {
              if (V === n)
                return O;
              typeof C == "string" || typeof O == "string" ? (C = Ai(C), O = Ai(O)) : (C = up(C), O = up(O)), V = h(C, O);
            }
            return V;
          };
        }
        function vh(h) {
          return As(function(v) {
            return v = Tn(v, ii(Ct())), qt(function(C) {
              var O = this;
              return h(v, function(V) {
                return wr(V, O, C);
              });
            });
          });
        }
        function al(h, v) {
          v = v === n ? " " : Ai(v);
          var C = v.length;
          if (C < 2)
            return C ? ns(v, h) : v;
          var O = ns(v, Gu(h / di(v)));
          return Fr(v) ? rs(Mn(O), 0, h).join("") : O.slice(0, h);
        }
        function py(h, v, C, O) {
          var V = v & A, ae = _f(h);
          function ge() {
            for (var Ce = -1, Me = arguments.length, We = -1, Xe = O.length, Ze = re(Xe + Me), ht = this && this !== Jn && this instanceof ge ? ae : h; ++We < Xe; )
              Ze[We] = O[We];
            for (; Me--; )
              Ze[We++] = arguments[++Ce];
            return wr(ht, V ? C : this, Ze);
          }
          return ge;
        }
        function xh(h) {
          return function(v, C, O) {
            return O && typeof O != "number" && si(v, C, O) && (C = O = n), v = yo(v), C === n ? (C = v, v = 0) : C = yo(C), O = O === n ? v < C ? 1 : -1 : yo(O), ap(v, C, O, h);
          };
        }
        function Ef(h) {
          return function(v, C) {
            return typeof v == "string" && typeof C == "string" || (v = sa(v), C = sa(C)), h(v, C);
          };
        }
        function bh(h, v, C, O, V, ae, ge, Ce, Me, We) {
          var Xe = v & j, Ze = Xe ? ge : n, ht = Xe ? n : ge, wt = Xe ? ae : n, jt = Xe ? n : ae;
          v |= Xe ? z : I, v &= ~(Xe ? I : z), v & M || (v &= -4);
          var Vt = [
            h,
            v,
            V,
            wt,
            Ze,
            jt,
            ht,
            Ce,
            Me,
            We
          ], Mt = C.apply(n, Vt);
          return Of(h) && Sy(Mt, Vt), Mt.placeholder = O, mc(Mt, h, v);
        }
        function kf(h) {
          var v = be[h];
          return function(C, O) {
            if (C = sa(C), O = O == null ? 0 : _r(At(O), 292), O && Yi(C)) {
              var V = (yn(C) + "e").split("e"), ae = v(V[0] + "e" + (+V[1] + O));
              return V = (yn(ae) + "e").split("e"), +(V[0] + "e" + (+V[1] - O));
            }
            return v(C);
          };
        }
        var gy = Yo && 1 / Zl(new Yo([, -0]))[1] == ue ? function(h) {
          return new Yo(h);
        } : f;
        function Sp(h) {
          return function(v) {
            var C = Kr(v);
            return C == et ? Ur(v) : C == Ht ? to(v) : Xd(v, h(v));
          };
        }
        function pi(h, v, C, O, V, ae, ge, Ce) {
          var Me = v & T;
          if (!Me && typeof h != "function")
            throw new je(o);
          var We = O ? O.length : 0;
          if (We || (v &= -97, O = V = n), ge = ge === n ? ge : rr(At(ge), 0), Ce = Ce === n ? Ce : At(Ce), We -= V ? V.length : 0, v & I) {
            var Xe = O, Ze = V;
            O = V = n;
          }
          var ht = Me ? n : Nf(h), wt = [
            h,
            v,
            C,
            O,
            V,
            Xe,
            Ze,
            ae,
            ge,
            Ce
          ];
          if (ht && _y(wt, ht), h = wt[0], v = wt[1], C = wt[2], O = wt[3], V = wt[4], Ce = wt[9] = wt[9] === n ? Me ? 0 : h.length : rr(wt[9] - We, 0), !Ce && v & (j | D) && (v &= -25), !v || v == A)
            var jt = bp(h, v, C);
          else v == j || v == D ? jt = Yx(h, v, Ce) : (v == z || v == (A | z)) && !V.length ? jt = py(h, v, C, O) : jt = dc.apply(n, wt);
          var Vt = ht ? lp : Sy;
          return mc(Vt(jt, wt), h, v);
        }
        function Cp(h, v, C, O) {
          return h === n || ia(h, Ge[C]) && !He.call(O, C) ? v : h;
        }
        function Ep(h, v, C, O, V, ae) {
          return Gn(h) && Gn(v) && (ae.set(v, h), yf(h, v, n, Ep, ae), ae.delete(v)), h;
        }
        function yy(h) {
          return Qf(h) ? n : h;
        }
        function Tf(h, v, C, O, V, ae) {
          var ge = C & S, Ce = h.length, Me = v.length;
          if (Ce != Me && !(ge && Me > Ce))
            return !1;
          var We = ae.get(h), Xe = ae.get(v);
          if (We && Xe)
            return We == v && Xe == h;
          var Ze = -1, ht = !0, wt = C & k ? new ru() : n;
          for (ae.set(h, v), ae.set(v, h); ++Ze < Ce; ) {
            var jt = h[Ze], Vt = v[Ze];
            if (O)
              var Mt = ge ? O(Vt, jt, Ze, v, h, ae) : O(jt, Vt, Ze, h, v, ae);
            if (Mt !== n) {
              if (Mt)
                continue;
              ht = !1;
              break;
            }
            if (wt) {
              if (!Fo(v, function(en, un) {
                if (!$o(wt, un) && (jt === en || V(jt, en, C, O, ae)))
                  return wt.push(un);
              })) {
                ht = !1;
                break;
              }
            } else if (!(jt === Vt || V(jt, Vt, C, O, ae))) {
              ht = !1;
              break;
            }
          }
          return ae.delete(h), ae.delete(v), ht;
        }
        function vy(h, v, C, O, V, ae, ge) {
          switch (C) {
            case yt:
              if (h.byteLength != v.byteLength || h.byteOffset != v.byteOffset)
                return !1;
              h = h.buffer, v = v.buffer;
            case Qe:
              return !(h.byteLength != v.byteLength || !ae(new Et(h), new Et(v)));
            case Be:
            case Re:
            case tt:
              return ia(+h, +v);
            case Ie:
              return h.name == v.name && h.message == v.message;
            case Un:
            case On:
              return h == v + "";
            case et:
              var Ce = Ur;
            case Ht:
              var Me = O & S;
              if (Ce || (Ce = Zl), h.size != v.size && !Me)
                return !1;
              var We = ge.get(h);
              if (We)
                return We == v;
              O |= k, ge.set(h, v);
              var Xe = Tf(Ce(h), Ce(v), O, V, ae, ge);
              return ge.delete(h), Xe;
            case an:
              if (Xu)
                return Xu.call(h) == Xu.call(v);
          }
          return !1;
        }
        function kp(h, v, C, O, V, ae) {
          var ge = C & S, Ce = wh(h), Me = Ce.length, We = wh(v), Xe = We.length;
          if (Me != Xe && !ge)
            return !1;
          for (var Ze = Me; Ze--; ) {
            var ht = Ce[Ze];
            if (!(ge ? ht in v : He.call(v, ht)))
              return !1;
          }
          var wt = ae.get(h), jt = ae.get(v);
          if (wt && jt)
            return wt == v && jt == h;
          var Vt = !0;
          ae.set(h, v), ae.set(v, h);
          for (var Mt = ge; ++Ze < Me; ) {
            ht = Ce[Ze];
            var en = h[ht], un = v[ht];
            if (O)
              var ls = ge ? O(un, en, ht, v, h, ae) : O(en, un, ht, h, v, ae);
            if (!(ls === n ? en === un || V(en, un, C, O, ae) : ls)) {
              Vt = !1;
              break;
            }
            Mt || (Mt = ht == "constructor");
          }
          if (Vt && !Mt) {
            var oa = h.constructor, us = v.constructor;
            oa != us && "constructor" in h && "constructor" in v && !(typeof oa == "function" && oa instanceof oa && typeof us == "function" && us instanceof us) && (Vt = !1);
          }
          return ae.delete(h), ae.delete(v), Vt;
        }
        function As(h) {
          return Nh(Op(h, n, Bn), h + "");
        }
        function wh(h) {
          return np(h, Dr, Sh);
        }
        function Tp(h) {
          return np(h, zi, Mf);
        }
        var Nf = Sr ? function(h) {
          return Sr.get(h);
        } : f;
        function er(h) {
          for (var v = h.name + "", C = gn[v], O = He.call(gn, v) ? C.length : 0; O--; ) {
            var V = C[O], ae = V.func;
            if (ae == null || ae == h)
              return V.name;
          }
          return v;
        }
        function ar(h) {
          var v = He.call(te, "placeholder") ? te : h;
          return v.placeholder;
        }
        function Ct() {
          var h = te.iteratee || ad;
          return h = h === ad ? ac : h, arguments.length ? h(arguments[0], arguments[1]) : h;
        }
        function Af(h, v) {
          var C = h.__data__;
          return kh(v) ? C[typeof v == "string" ? "string" : "hash"] : C.map;
        }
        function _h(h) {
          for (var v = Dr(h), C = v.length; C--; ) {
            var O = v[C], V = h[O];
            v[C] = [O, V, js(V)];
          }
          return v;
        }
        function sl(h, v) {
          var C = Ql(h, v);
          return gf(C) ? C : n;
        }
        function jf(h) {
          var v = He.call(h, no), C = h[no];
          try {
            h[no] = n;
            var O = !0;
          } catch {
          }
          var V = Je.call(h);
          return O && (v ? h[no] = C : delete h[no]), V;
        }
        var Sh = lf ? function(h) {
          return h == null ? [] : (h = we(h), Pn(lf(h), function(v) {
            return pr.call(h, v);
          }));
        } : Ye, Mf = lf ? function(h) {
          for (var v = []; h; )
            Gi(v, Sh(h)), h = Nn(h);
          return v;
        } : Ye, Kr = Gr;
        (Na && Kr(new Na(new ArrayBuffer(1))) != yt || Wi && Kr(new Wi()) != et || Zd && Kr(Zd.resolve()) != Wn || Yo && Kr(new Yo()) != Ht || eu && Kr(new eu()) != Xn) && (Kr = function(h) {
          var v = Gr(h), C = v == dt ? h.constructor : n, O = C ? oi(C) : "";
          if (O)
            switch (O) {
              case Jt:
                return yt;
              case Wo:
                return et;
              case Aa:
                return Wn;
              case Xm:
                return Ht;
              case Xo:
                return Xn;
            }
          return v;
        });
        function Wx(h, v, C) {
          for (var O = -1, V = C.length; ++O < V; ) {
            var ae = C[O], ge = ae.size;
            switch (ae.type) {
              case "drop":
                h += ge;
                break;
              case "dropRight":
                v -= ge;
                break;
              case "take":
                v = _r(v, h + ge);
                break;
              case "takeRight":
                h = rr(h, v - ge);
                break;
            }
          }
          return { start: h, end: v };
        }
        function Ch(h) {
          var v = h.match($s);
          return v ? v[1].split(Vs) : [];
        }
        function Eh(h, v, C) {
          v = ea(v, h);
          for (var O = -1, V = v.length, ae = !1; ++O < V; ) {
            var ge = ji(v[O]);
            if (!(ae = h != null && C(h, ge)))
              break;
            h = h[ge];
          }
          return ae || ++O != V ? ae : (V = h == null ? 0 : h.length, !!V && Uh(V) && is(ge, V) && (It(h) || du(h)));
        }
        function xy(h) {
          var v = h.length, C = new h.constructor(v);
          return v && typeof h[0] == "string" && He.call(h, "index") && (C.index = h.index, C.input = h.input), C;
        }
        function Np(h) {
          return typeof h.constructor == "function" && !hc(h) ? Qo(Nn(h)) : {};
        }
        function by(h, v, C) {
          var O = h.constructor;
          switch (v) {
            case Qe:
              return wf(h);
            case Be:
            case Re:
              return new O(+h);
            case yt:
              return Kx(h, C);
            case Tt:
            case Pt:
            case $n:
            case Vn:
            case sn:
            case Qt:
            case kn:
            case it:
            case jr:
              return pp(h, C);
            case et:
              return new O();
            case tt:
            case On:
              return new O(h);
            case Un:
              return cy(h);
            case Ht:
              return new O();
            case an:
              return fy(h);
          }
        }
        function Ap(h, v) {
          var C = v.length;
          if (!C)
            return h;
          var O = C - 1;
          return v[O] = (C > 1 ? "& " : "") + v[O], v = v.join(C > 2 ? ", " : " "), h.replace(ys, `{
/* [wrapped with ` + v + `] */
`);
        }
        function jp(h) {
          return It(h) || du(h) || !!(Hu && h && h[Hu]);
        }
        function is(h, v) {
          var C = typeof h;
          return v = v ?? de, !!v && (C == "number" || C != "symbol" && Po.test(h)) && h > -1 && h % 1 == 0 && h < v;
        }
        function si(h, v, C) {
          if (!Gn(C))
            return !1;
          var O = typeof v;
          return (O == "number" ? Ii(C) && is(v, C.length) : O == "string" && v in C) ? ia(C[v], h) : !1;
        }
        function Rf(h, v) {
          if (It(h))
            return !1;
          var C = typeof h;
          return C == "number" || C == "symbol" || C == "boolean" || h == null || Pi(h) ? !0 : Si.test(h) || !ha.test(h) || v != null && h in we(v);
        }
        function kh(h) {
          var v = typeof h;
          return v == "string" || v == "number" || v == "symbol" || v == "boolean" ? h !== "__proto__" : h === null;
        }
        function Of(h) {
          var v = er(h), C = te[v];
          if (typeof C != "function" || !(v in Lt.prototype))
            return !1;
          if (h === C)
            return !0;
          var O = Nf(C);
          return !!O && h === O[0];
        }
        function wy(h) {
          return !!ut && ut in h;
        }
        var Mp = nt ? aa : Le;
        function hc(h) {
          var v = h && h.constructor, C = typeof v == "function" && v.prototype || Ge;
          return h === C;
        }
        function js(h) {
          return h === h && !Gn(h);
        }
        function Th(h, v) {
          return function(C) {
            return C == null ? !1 : C[h] === v && (v !== n || h in we(C));
          };
        }
        function Xx(h) {
          var v = Kf(h, function(O) {
            return C.size === d && C.clear(), O;
          }), C = v.cache;
          return v;
        }
        function _y(h, v) {
          var C = h[1], O = v[1], V = C | O, ae = V < (A | T | L), ge = O == L && C == j || O == L && C == K && h[7].length <= v[8] || O == (L | K) && v[7].length <= v[8] && C == j;
          if (!(ae || ge))
            return h;
          O & A && (h[2] = v[2], V |= C & A ? 0 : M);
          var Ce = v[3];
          if (Ce) {
            var Me = h[3];
            h[3] = Me ? gh(Me, Ce, v[4]) : Ce, h[4] = Me ? Ki(h[3], m) : v[4];
          }
          return Ce = v[5], Ce && (Me = h[5], h[5] = Me ? yp(Me, Ce, v[6]) : Ce, h[6] = Me ? Ki(h[5], m) : v[6]), Ce = v[7], Ce && (h[7] = Ce), O & L && (h[8] = h[8] == null ? v[8] : _r(h[8], v[8])), h[9] == null && (h[9] = v[9]), h[0] = v[0], h[1] = V, h;
        }
        function uo(h) {
          var v = [];
          if (h != null)
            for (var C in we(h))
              v.push(C);
          return v;
        }
        function Rp(h) {
          return Je.call(h);
        }
        function Op(h, v, C) {
          return v = rr(v === n ? h.length - 1 : v, 0), function() {
            for (var O = arguments, V = -1, ae = rr(O.length - v, 0), ge = re(ae); ++V < ae; )
              ge[V] = O[v + V];
            V = -1;
            for (var Ce = re(v + 1); ++V < v; )
              Ce[V] = O[V];
            return Ce[v] = C(ge), wr(h, this, Ce);
          };
        }
        function Df(h, v) {
          return v.length < 2 ? h : Ns(h, Ji(v, 0, -1));
        }
        function If(h, v) {
          for (var C = h.length, O = _r(v.length, C), V = mi(h); O--; ) {
            var ae = v[O];
            h[O] = is(ae, C) ? V[ae] : n;
          }
          return h;
        }
        function An(h, v) {
          if (!(v === "constructor" && typeof h[v] == "function") && v != "__proto__")
            return h[v];
        }
        var Sy = co(lp), Pf = Jl || function(h, v) {
          return Jn.setTimeout(h, v);
        }, Nh = co(ay);
        function mc(h, v, C) {
          var O = v + "";
          return Nh(h, Ap(O, Cy(Ch(O), C)));
        }
        function co(h) {
          var v = 0, C = 0;
          return function() {
            var O = ka(), V = me - (O - C);
            if (C = O, V > 0) {
              if (++v >= Z)
                return arguments[0];
            } else
              v = 0;
            return h.apply(n, arguments);
          };
        }
        function zf(h, v) {
          var C = -1, O = h.length, V = O - 1;
          for (v = v === n ? O : v; ++C < v; ) {
            var ae = lc(C, V), ge = h[ae];
            h[ae] = h[C], h[C] = ge;
          }
          return h.length = v, h;
        }
        var Dp = Xx(function(h) {
          var v = [];
          return h.charCodeAt(0) === 46 && v.push(""), h.replace(Ll, function(C, O, V, ae) {
            v.push(V ? ae.replace(Qn, "$1") : O || C);
          }), v;
        });
        function ji(h) {
          if (typeof h == "string" || Pi(h))
            return h;
          var v = h + "";
          return v == "0" && 1 / h == -ue ? "-0" : v;
        }
        function oi(h) {
          if (h != null) {
            try {
              return lt.call(h);
            } catch {
            }
            try {
              return h + "";
            } catch {
            }
          }
          return "";
        }
        function Cy(h, v) {
          return qr(le, function(C) {
            var O = "_." + C[0];
            v & C[1] && !_s(h, O) && h.push(O);
          }), h.sort();
        }
        function Ah(h) {
          if (h instanceof Lt)
            return h.clone();
          var v = new Ti(h.__wrapped__, h.__chain__);
          return v.__actions__ = mi(h.__actions__), v.__index__ = h.__index__, v.__values__ = h.__values__, v;
        }
        function Ey(h, v, C) {
          (C ? si(h, v, C) : v === n) ? v = 1 : v = rr(At(v), 0);
          var O = h == null ? 0 : h.length;
          if (!O || v < 1)
            return [];
          for (var V = 0, ae = 0, ge = re(Gu(O / v)); V < O; )
            ge[ae++] = Ji(h, V, V += v);
          return ge;
        }
        function Ip(h) {
          for (var v = -1, C = h == null ? 0 : h.length, O = 0, V = []; ++v < C; ) {
            var ae = h[v];
            ae && (V[O++] = ae);
          }
          return V;
        }
        function Pp() {
          var h = arguments.length;
          if (!h)
            return [];
          for (var v = re(h - 1), C = arguments[0], O = h; O--; )
            v[O - 1] = arguments[O];
          return Gi(It(C) ? mi(C) : [C], Tr(v, 1));
        }
        var jh = qt(function(h, v) {
          return vr(h) ? Ra(h, Tr(v, 1, vr, !0)) : [];
        }), ky = qt(function(h, v) {
          var C = qn(v);
          return vr(C) && (C = n), vr(h) ? Ra(h, Tr(v, 1, vr, !0), Ct(C, 2)) : [];
        }), fo = qt(function(h, v) {
          var C = qn(v);
          return vr(C) && (C = n), vr(h) ? Ra(h, Tr(v, 1, vr, !0), n, C) : [];
        });
        function Er(h, v, C) {
          var O = h == null ? 0 : h.length;
          return O ? (v = C || v === n ? 1 : At(v), Ji(h, v < 0 ? 0 : v, O)) : [];
        }
        function zp(h, v, C) {
          var O = h == null ? 0 : h.length;
          return O ? (v = C || v === n ? 1 : At(v), v = O - v, Ji(h, 0, v < 0 ? 0 : v)) : [];
        }
        function Ty(h, v) {
          return h && h.length ? xf(h, Ct(v, 3), !0, !0) : [];
        }
        function Or(h, v) {
          return h && h.length ? xf(h, Ct(v, 3), !0) : [];
        }
        function Qx(h, v, C, O) {
          var V = h == null ? 0 : h.length;
          return V ? (C && typeof C != "number" && si(h, v, C) && (C = 0, O = V), hf(h, v, C, O)) : [];
        }
        function Lp(h, v, C) {
          var O = h == null ? 0 : h.length;
          if (!O)
            return -1;
          var V = C == null ? 0 : At(C);
          return V < 0 && (V = rr(O + V, 0)), eo(h, Ct(v, 3), V);
        }
        function Bp(h, v, C) {
          var O = h == null ? 0 : h.length;
          if (!O)
            return -1;
          var V = O - 1;
          return C !== n && (V = At(C), V = C < 0 ? rr(O + V, 0) : _r(V, O - 1)), eo(h, Ct(v, 3), V, !0);
        }
        function Bn(h) {
          var v = h == null ? 0 : h.length;
          return v ? Tr(h, 1) : [];
        }
        function Mi(h) {
          var v = h == null ? 0 : h.length;
          return v ? Tr(h, ue) : [];
        }
        function ho(h, v) {
          var C = h == null ? 0 : h.length;
          return C ? (v = v === n ? 1 : At(v), Tr(h, v)) : [];
        }
        function Ny(h) {
          for (var v = -1, C = h == null ? 0 : h.length, O = {}; ++v < C; ) {
            var V = h[v];
            O[V[0]] = V[1];
          }
          return O;
        }
        function qp(h) {
          return h && h.length ? h[0] : n;
        }
        function Ay(h, v, C) {
          var O = h == null ? 0 : h.length;
          if (!O)
            return -1;
          var V = C == null ? 0 : At(C);
          return V < 0 && (V = rr(O + V, 0)), Ss(h, v, V);
        }
        function Zx(h) {
          var v = h == null ? 0 : h.length;
          return v ? Ji(h, 0, -1) : [];
        }
        var Mh = qt(function(h) {
          var v = Tn(h, hp);
          return v.length && v[0] === h[0] ? pf(v) : [];
        }), Ri = qt(function(h) {
          var v = qn(h), C = Tn(h, hp);
          return v === qn(C) ? v = n : C.pop(), C.length && C[0] === h[0] ? pf(C, Ct(v, 2)) : [];
        }), as = qt(function(h) {
          var v = qn(h), C = Tn(h, hp);
          return v = typeof v == "function" ? v : n, v && C.pop(), C.length && C[0] === h[0] ? pf(C, n, v) : [];
        });
        function jy(h, v) {
          return h == null ? "" : Ku.call(h, v);
        }
        function qn(h) {
          var v = h == null ? 0 : h.length;
          return v ? h[v - 1] : n;
        }
        function My(h, v, C) {
          var O = h == null ? 0 : h.length;
          if (!O)
            return -1;
          var V = O;
          return C !== n && (V = At(C), V = V < 0 ? rr(O + V, 0) : _r(V, O - 1)), v === v ? Go(h, v, V) : eo(h, Wd, V, !0);
        }
        function mo(h, v) {
          return h && h.length ? fh(h, At(v)) : n;
        }
        var lu = qt(Ms);
        function Ms(h, v) {
          return h && h.length && v && v.length ? sc(h, v) : h;
        }
        function Fp(h, v, C) {
          return h && h.length && v && v.length ? sc(h, v, Ct(C, 2)) : h;
        }
        function Up(h, v, C) {
          return h && h.length && v && v.length ? sc(h, v, n, C) : h;
        }
        var ss = As(function(h, v) {
          var C = h == null ? 0 : h.length, O = nc(h, v);
          return oc(h, Tn(v, function(V) {
            return is(V, C) ? +V : V;
          }).sort(gp)), O;
        });
        function Ry(h, v) {
          var C = [];
          if (!(h && h.length))
            return C;
          var O = -1, V = [], ae = h.length;
          for (v = Ct(v, 3); ++O < ae; ) {
            var ge = h[O];
            v(ge, O, h) && (C.push(ge), V.push(O));
          }
          return oc(h, V), C;
        }
        function ol(h) {
          return h == null ? h : Es.call(h);
        }
        function Lf(h, v, C) {
          var O = h == null ? 0 : h.length;
          return O ? (C && typeof C != "number" && si(h, v, C) ? (v = 0, C = O) : (v = v == null ? 0 : At(v), C = C === n ? O : At(C)), Ji(h, v, C)) : [];
        }
        function Bf(h, v) {
          return cc(h, v);
        }
        function pc(h, v, C) {
          return hh(h, v, Ct(C, 2));
        }
        function Oy(h, v) {
          var C = h == null ? 0 : h.length;
          if (C) {
            var O = cc(h, v);
            if (O < C && ia(h[O], v))
              return O;
          }
          return -1;
        }
        function Dy(h, v) {
          return cc(h, v, !0);
        }
        function qf(h, v, C) {
          return hh(h, v, Ct(C, 2), !0);
        }
        function Iy(h, v) {
          var C = h == null ? 0 : h.length;
          if (C) {
            var O = cc(h, v, !0) - 1;
            if (ia(h[O], v))
              return O;
          }
          return -1;
        }
        function Rh(h) {
          return h && h.length ? ly(h) : [];
        }
        function Py(h, v) {
          return h && h.length ? ly(h, Ct(v, 2)) : [];
        }
        function Jx(h) {
          var v = h == null ? 0 : h.length;
          return v ? Ji(h, 1, v) : [];
        }
        function eb(h, v, C) {
          return h && h.length ? (v = C || v === n ? 1 : At(v), Ji(h, 0, v < 0 ? 0 : v)) : [];
        }
        function mn(h, v, C) {
          var O = h == null ? 0 : h.length;
          return O ? (v = C || v === n ? 1 : At(v), v = O - v, Ji(h, v < 0 ? 0 : v, O)) : [];
        }
        function jn(h, v) {
          return h && h.length ? xf(h, Ct(v, 3), !1, !0) : [];
        }
        function Gt(h, v) {
          return h && h.length ? xf(h, Ct(v, 3)) : [];
        }
        var Wt = qt(function(h) {
          return lo(Tr(h, 1, vr, !0));
        }), xn = qt(function(h) {
          var v = qn(h);
          return vr(v) && (v = n), lo(Tr(h, 1, vr, !0), Ct(v, 2));
        }), ta = qt(function(h) {
          var v = qn(h);
          return v = typeof v == "function" ? v : n, lo(Tr(h, 1, vr, !0), n, v);
        });
        function ll(h) {
          return h && h.length ? lo(h) : [];
        }
        function gc(h, v) {
          return h && h.length ? lo(h, Ct(v, 2)) : [];
        }
        function $p(h, v) {
          return v = typeof v == "function" ? v : n, h && h.length ? lo(h, n, v) : [];
        }
        function os(h) {
          if (!(h && h.length))
            return [];
          var v = 0;
          return h = Pn(h, function(C) {
            if (vr(C))
              return v = rr(C.length, v), !0;
          }), Yl(v, function(C) {
            return Tn(h, Ca(C));
          });
        }
        function tr(h, v) {
          if (!(h && h.length))
            return [];
          var C = os(h);
          return v == null ? C : Tn(C, function(O) {
            return wr(v, n, O);
          });
        }
        var ul = qt(function(h, v) {
          return vr(h) ? Ra(h, v) : [];
        }), uu = qt(function(h) {
          return mh(Pn(h, vr));
        }), Vp = qt(function(h) {
          var v = qn(h);
          return vr(v) && (v = n), mh(Pn(h, vr), Ct(v, 2));
        }), na = qt(function(h) {
          var v = qn(h);
          return v = typeof v == "function" ? v : n, mh(Pn(h, vr), n, v);
        }), yc = qt(os);
        function Ff(h, v) {
          return dp(h || [], v || [], Za);
        }
        function Oi(h, v) {
          return dp(h || [], v || [], uc);
        }
        var Hp = qt(function(h) {
          var v = h.length, C = v > 1 ? h[v - 1] : n;
          return C = typeof C == "function" ? (h.pop(), C) : n, tr(h, C);
        });
        function Uf(h) {
          var v = te(h);
          return v.__chain__ = !0, v;
        }
        function zy(h, v) {
          return v(h), h;
        }
        function cu(h, v) {
          return v(h);
        }
        var Oh = As(function(h) {
          var v = h.length, C = v ? h[0] : 0, O = this.__wrapped__, V = function(ae) {
            return nc(ae, h);
          };
          return v > 1 || this.__actions__.length || !(O instanceof Lt) || !is(C) ? this.thru(V) : (O = O.slice(C, +C + (v ? 1 : 0)), O.__actions__.push({
            func: cu,
            args: [V],
            thisArg: n
          }), new Ti(O, this.__chain__).thru(function(ae) {
            return v && !ae.length && ae.push(n), ae;
          }));
        });
        function cl() {
          return Uf(this);
        }
        function Nr() {
          return new Ti(this.value(), this.__chain__);
        }
        function fl() {
          this.__values__ === n && (this.__values__ = o1(this.value()));
          var h = this.__index__ >= this.__values__.length, v = h ? n : this.__values__[this.__index__++];
          return { done: h, value: v };
        }
        function vc() {
          return this;
        }
        function po(h) {
          for (var v, C = this; C instanceof Zo; ) {
            var O = Ah(C);
            O.__index__ = 0, O.__values__ = n, v ? V.__wrapped__ = O : v = O;
            var V = O;
            C = C.__wrapped__;
          }
          return V.__wrapped__ = h, v;
        }
        function Gp() {
          var h = this.__wrapped__;
          if (h instanceof Lt) {
            var v = h;
            return this.__actions__.length && (v = new Lt(this)), v = v.reverse(), v.__actions__.push({
              func: cu,
              args: [ol],
              thisArg: n
            }), new Ti(v, this.__chain__);
          }
          return this.thru(ol);
        }
        function Kp() {
          return fp(this.__wrapped__, this.__actions__);
        }
        var Ly = yh(function(h, v, C) {
          He.call(h, C) ? ++h[C] : Xi(h, C, 1);
        });
        function $f(h, v, C) {
          var O = It(h) ? Lu : tl;
          return C && si(h, v, C) && (v = n), O(h, Ct(v, 3));
        }
        function Yp(h, v) {
          var C = It(h) ? Pn : ah;
          return C(h, Ct(v, 3));
        }
        var ra = _p(Lp), By = _p(Bp);
        function Di(h, v) {
          return Tr(Vf(h, v), 1);
        }
        function qy(h, v) {
          return Tr(Vf(h, v), ue);
        }
        function Fy(h, v, C) {
          return C = C === n ? 1 : At(C), Tr(Vf(h, v), C);
        }
        function Uy(h, v) {
          var C = It(h) ? qr : Ts;
          return C(h, Ct(v, 3));
        }
        function go(h, v) {
          var C = It(h) ? Zc : ih;
          return C(h, Ct(v, 3));
        }
        var Dh = yh(function(h, v, C) {
          He.call(h, C) ? h[C].push(v) : Xi(h, C, [v]);
        });
        function Wp(h, v, C, O) {
          h = Ii(h) ? h : Tc(h), C = C && !O ? At(C) : 0;
          var V = h.length;
          return C < 0 && (C = rr(V + C, 0)), ed(h) ? C <= V && h.indexOf(v, C) > -1 : !!V && Ss(h, v, C) > -1;
        }
        var xc = qt(function(h, v, C) {
          var O = -1, V = typeof v == "function", ae = Ii(h) ? re(h.length) : [];
          return Ts(h, function(ge) {
            ae[++O] = V ? wr(v, ge, C) : Da(ge, v, C);
          }), ae;
        }), $y = yh(function(h, v, C) {
          Xi(h, C, v);
        });
        function Vf(h, v) {
          var C = It(h) ? Tn : uh;
          return C(h, Ct(v, 3));
        }
        function Vy(h, v, C, O) {
          return h == null ? [] : (It(v) || (v = v == null ? [] : [v]), C = O ? n : C, It(C) || (C = C == null ? [] : [C]), dh(h, v, C));
        }
        var Hy = yh(function(h, v, C) {
          h[C ? 0 : 1].push(v);
        }, function() {
          return [[], []];
        });
        function Ih(h, v, C) {
          var O = It(h) ? Bu : Kl, V = arguments.length < 3;
          return O(h, Ct(v, 4), C, V, Ts);
        }
        function Xp(h, v, C) {
          var O = It(h) ? Jc : Kl, V = arguments.length < 3;
          return O(h, Ct(v, 4), C, V, ih);
        }
        function tb(h, v) {
          var C = It(h) ? Pn : ah;
          return C(h, Lh(Ct(v, 3)));
        }
        function nb(h) {
          var v = It(h) ? df : sp;
          return v(h);
        }
        function rb(h, v, C) {
          (C ? si(h, v, C) : v === n) ? v = 1 : v = At(v);
          var O = It(h) ? nh : op;
          return O(h, v);
        }
        function Gy(h) {
          var v = It(h) ? ty : sy;
          return v(h);
        }
        function Ky(h) {
          if (h == null)
            return 0;
          if (Ii(h))
            return ed(h) ? di(h) : h.length;
          var v = Kr(h);
          return v == et || v == Ht ? h.size : rl(h).length;
        }
        function bc(h, v, C) {
          var O = It(h) ? Fo : oy;
          return C && si(h, v, C) && (v = n), O(h, Ct(v, 3));
        }
        var Ph = qt(function(h, v) {
          if (h == null)
            return [];
          var C = v.length;
          return C > 1 && si(h, v[0], v[1]) ? v = [] : C > 2 && si(v[0], v[1], v[2]) && (v = [v[0]]), dh(h, Tr(v, 1), []);
        }), Hf = Qd || function() {
          return Jn.Date.now();
        };
        function Yy(h, v) {
          if (typeof v != "function")
            throw new je(o);
          return h = At(h), function() {
            if (--h < 1)
              return v.apply(this, arguments);
          };
        }
        function Qp(h, v, C) {
          return v = C ? n : v, v = h && v == null ? h.length : v, pi(h, L, n, n, n, n, v);
        }
        function Zp(h, v) {
          var C;
          if (typeof v != "function")
            throw new je(o);
          return h = At(h), function() {
            return --h > 0 && (C = v.apply(this, arguments)), h <= 1 && (v = n), C;
          };
        }
        var zh = qt(function(h, v, C) {
          var O = A;
          if (C.length) {
            var V = Ki(C, ar(zh));
            O |= z;
          }
          return pi(h, O, v, C, V);
        }), Jp = qt(function(h, v, C) {
          var O = A | T;
          if (C.length) {
            var V = Ki(C, ar(Jp));
            O |= z;
          }
          return pi(v, O, h, C, V);
        });
        function Gf(h, v, C) {
          v = C ? n : v;
          var O = pi(h, j, n, n, n, n, n, v);
          return O.placeholder = Gf.placeholder, O;
        }
        function eg(h, v, C) {
          v = C ? n : v;
          var O = pi(h, D, n, n, n, n, n, v);
          return O.placeholder = eg.placeholder, O;
        }
        function tg(h, v, C) {
          var O, V, ae, ge, Ce, Me, We = 0, Xe = !1, Ze = !1, ht = !0;
          if (typeof h != "function")
            throw new je(o);
          v = sa(v) || 0, Gn(C) && (Xe = !!C.leading, Ze = "maxWait" in C, ae = Ze ? rr(sa(C.maxWait) || 0, v) : ae, ht = "trailing" in C ? !!C.trailing : ht);
          function wt(Ar) {
            var xo = O, mu = V;
            return O = V = n, We = Ar, ge = h.apply(mu, xo), ge;
          }
          function jt(Ar) {
            return We = Ar, Ce = Pf(en, v), Xe ? wt(Ar) : ge;
          }
          function Vt(Ar) {
            var xo = Ar - Me, mu = Ar - We, pk = v - xo;
            return Ze ? _r(pk, ae - mu) : pk;
          }
          function Mt(Ar) {
            var xo = Ar - Me, mu = Ar - We;
            return Me === n || xo >= v || xo < 0 || Ze && mu >= ae;
          }
          function en() {
            var Ar = Hf();
            if (Mt(Ar))
              return un(Ar);
            Ce = Pf(en, Vt(Ar));
          }
          function un(Ar) {
            return Ce = n, ht && O ? wt(Ar) : (O = V = n, ge);
          }
          function ls() {
            Ce !== n && bf(Ce), We = 0, O = Me = V = Ce = n;
          }
          function oa() {
            return Ce === n ? ge : un(Hf());
          }
          function us() {
            var Ar = Hf(), xo = Mt(Ar);
            if (O = arguments, V = this, Me = Ar, xo) {
              if (Ce === n)
                return jt(Me);
              if (Ze)
                return bf(Ce), Ce = Pf(en, v), wt(Me);
            }
            return Ce === n && (Ce = Pf(en, v)), ge;
          }
          return us.cancel = ls, us.flush = oa, us;
        }
        var bn = qt(function(h, v) {
          return tp(h, 1, v);
        }), ng = qt(function(h, v, C) {
          return tp(h, sa(v) || 0, C);
        });
        function ib(h) {
          return pi(h, ne);
        }
        function Kf(h, v) {
          if (typeof h != "function" || v != null && typeof v != "function")
            throw new je(o);
          var C = function() {
            var O = arguments, V = v ? v.apply(this, O) : O[0], ae = C.cache;
            if (ae.has(V))
              return ae.get(V);
            var ge = h.apply(this, O);
            return C.cache = ae.set(V, ge) || ae, ge;
          };
          return C.cache = new (Kf.Cache || Qa)(), C;
        }
        Kf.Cache = Qa;
        function Lh(h) {
          if (typeof h != "function")
            throw new je(o);
          return function() {
            var v = arguments;
            switch (v.length) {
              case 0:
                return !h.call(this);
              case 1:
                return !h.call(this, v[0]);
              case 2:
                return !h.call(this, v[0], v[1]);
              case 3:
                return !h.call(this, v[0], v[1], v[2]);
            }
            return !h.apply(this, v);
          };
        }
        function ab(h) {
          return Zp(2, h);
        }
        var sb = uy(function(h, v) {
          v = v.length == 1 && It(v[0]) ? Tn(v[0], ii(Ct())) : Tn(Tr(v, 1), ii(Ct()));
          var C = v.length;
          return qt(function(O) {
            for (var V = -1, ae = _r(O.length, C); ++V < ae; )
              O[V] = v[V].call(this, O[V]);
            return wr(h, this, O);
          });
        }), wc = qt(function(h, v) {
          var C = Ki(v, ar(wc));
          return pi(h, z, n, v, C);
        }), fu = qt(function(h, v) {
          var C = Ki(v, ar(fu));
          return pi(h, I, n, v, C);
        }), rg = As(function(h, v) {
          return pi(h, K, n, n, n, v);
        });
        function Bh(h, v) {
          if (typeof h != "function")
            throw new je(o);
          return v = v === n ? v : At(v), qt(h, v);
        }
        function ig(h, v) {
          if (typeof h != "function")
            throw new je(o);
          return v = v == null ? 0 : rr(At(v), 0), qt(function(C) {
            var O = C[v], V = rs(C, 0, v);
            return O && Gi(V, O), wr(h, this, V);
          });
        }
        function dl(h, v, C) {
          var O = !0, V = !0;
          if (typeof h != "function")
            throw new je(o);
          return Gn(C) && (O = "leading" in C ? !!C.leading : O, V = "trailing" in C ? !!C.trailing : V), tg(h, v, {
            leading: O,
            maxWait: v,
            trailing: V
          });
        }
        function Rs(h) {
          return Qp(h, 1);
        }
        function Yf(h, v) {
          return wc(ph(v), h);
        }
        function ob() {
          if (!arguments.length)
            return [];
          var h = arguments[0];
          return It(h) ? h : [h];
        }
        function Wy(h) {
          return hi(h, b);
        }
        function Xy(h, v) {
          return v = typeof v == "function" ? v : n, hi(h, b, v);
        }
        function Qy(h) {
          return hi(h, p | b);
        }
        function Zy(h, v) {
          return v = typeof v == "function" ? v : n, hi(h, p | b, v);
        }
        function lb(h, v) {
          return v == null || el(h, v, Dr(v));
        }
        function ia(h, v) {
          return h === v || h !== h && v !== v;
        }
        var Jy = Ef(mf), e1 = Ef(function(h, v) {
          return h >= v;
        }), du = Ni(/* @__PURE__ */ (function() {
          return arguments;
        })()) ? Ni : function(h) {
          return sr(h) && He.call(h, "callee") && !pr.call(h, "callee");
        }, It = re.isArray, ag = Wc ? ii(Wc) : gr;
        function Ii(h) {
          return h != null && Uh(h.length) && !aa(h);
        }
        function vr(h) {
          return sr(h) && Ii(h);
        }
        function Wf(h) {
          return h === !0 || h === !1 || sr(h) && Gr(h) == Be;
        }
        var hl = Q0 || Le, t1 = Hl ? ii(Hl) : oh;
        function Kt(h) {
          return sr(h) && h.nodeType === 1 && !Qf(h);
        }
        function sg(h) {
          if (h == null)
            return !0;
          if (Ii(h) && (It(h) || typeof h == "string" || typeof h.splice == "function" || hl(h) || ml(h) || du(h)))
            return !h.length;
          var v = Kr(h);
          if (v == et || v == Ht)
            return !h.size;
          if (hc(h))
            return !rl(h).length;
          for (var C in h)
            if (He.call(h, C))
              return !1;
          return !0;
        }
        function qh(h, v) {
          return Zi(h, v);
        }
        function og(h, v, C) {
          C = typeof C == "function" ? C : n;
          var O = C ? C(h, v) : n;
          return O === n ? Zi(h, v, n, C) : !!O;
        }
        function Fh(h) {
          if (!sr(h))
            return !1;
          var v = Gr(h);
          return v == Ie || v == ft || typeof h.message == "string" && typeof h.name == "string" && !Qf(h);
        }
        function lg(h) {
          return typeof h == "number" && Yi(h);
        }
        function aa(h) {
          if (!Gn(h))
            return !1;
          var v = Gr(h);
          return v == Ne || v == Ue || v == Oe || v == Rn;
        }
        function Xf(h) {
          return typeof h == "number" && h == At(h);
        }
        function Uh(h) {
          return typeof h == "number" && h > -1 && h % 1 == 0 && h <= de;
        }
        function Gn(h) {
          var v = typeof h;
          return h != null && (v == "object" || v == "function");
        }
        function sr(h) {
          return h != null && typeof h == "object";
        }
        var n1 = Zs ? ii(Zs) : _n;
        function r1(h, v) {
          return h === v || ir(h, v, _h(v));
        }
        function i1(h, v, C) {
          return C = typeof C == "function" ? C : n, ir(h, v, _h(v), C);
        }
        function Sn(h) {
          return cg(h) && h != +h;
        }
        function ug(h) {
          if (Mp(h))
            throw new he(s);
          return gf(h);
        }
        function Yr(h) {
          return h === null;
        }
        function ub(h) {
          return h == null;
        }
        function cg(h) {
          return typeof h == "number" || sr(h) && Gr(h) == tt;
        }
        function Qf(h) {
          if (!sr(h) || Gr(h) != dt)
            return !1;
          var v = Nn(h);
          if (v === null)
            return !0;
          var C = He.call(v, "constructor") && v.constructor;
          return typeof C == "function" && C instanceof C && lt.call(C) == pt;
        }
        var Zf = Gl ? ii(Gl) : ic;
        function fg(h) {
          return Xf(h) && h >= -de && h <= de;
        }
        var Jf = Xc ? ii(Xc) : su;
        function ed(h) {
          return typeof h == "string" || !It(h) && sr(h) && Gr(h) == On;
        }
        function Pi(h) {
          return typeof h == "symbol" || sr(h) && Gr(h) == an;
        }
        var ml = Kd ? ii(Kd) : lh;
        function dg(h) {
          return h === n;
        }
        function cb(h) {
          return sr(h) && Kr(h) == Xn;
        }
        function a1(h) {
          return sr(h) && Gr(h) == Fe;
        }
        var fb = Ef(Hn), s1 = Ef(function(h, v) {
          return h <= v;
        });
        function o1(h) {
          if (!h)
            return [];
          if (Ii(h))
            return ed(h) ? Mn(h) : mi(h);
          if (Vr && h[Vr])
            return Ho(h[Vr]());
          var v = Kr(h), C = v == et ? Ur : v == Ht ? Zl : Tc;
          return C(h);
        }
        function yo(h) {
          if (!h)
            return h === 0 ? h : 0;
          if (h = sa(h), h === ue || h === -ue) {
            var v = h < 0 ? -1 : 1;
            return v * ce;
          }
          return h === h ? h : 0;
        }
        function At(h) {
          var v = yo(h), C = v % 1;
          return v === v ? C ? v - C : v : 0;
        }
        function hg(h) {
          return h ? Ja(At(h), 0, $) : 0;
        }
        function sa(h) {
          if (typeof h == "number")
            return h;
          if (Pi(h))
            return W;
          if (Gn(h)) {
            var v = typeof h.valueOf == "function" ? h.valueOf() : h;
            h = Gn(v) ? v + "" : v;
          }
          if (typeof h != "string")
            return h === 0 ? h : +h;
          h = Cs(h);
          var C = ga.test(h);
          return C || li.test(h) ? Pu(h.slice(2), C ? 2 : 8) : ju.test(h) ? W : +h;
        }
        function $h(h) {
          return Ia(h, zi(h));
        }
        function db(h) {
          return h ? Ja(At(h), -de, de) : h === 0 ? h : 0;
        }
        function yn(h) {
          return h == null ? "" : Ai(h);
        }
        var l1 = il(function(h, v) {
          if (hc(v) || Ii(v)) {
            Ia(v, Dr(v), h);
            return;
          }
          for (var C in v)
            He.call(v, C) && Za(h, C, v[C]);
        }), Vh = il(function(h, v) {
          Ia(v, zi(v), h);
        }), _c = il(function(h, v, C, O) {
          Ia(v, zi(v), h, O);
        }), hb = il(function(h, v, C, O) {
          Ia(v, Dr(v), h, O);
        }), Pa = As(nc);
        function mg(h, v) {
          var C = Qo(h);
          return v == null ? C : ep(C, v);
        }
        var u1 = qt(function(h, v) {
          h = we(h);
          var C = -1, O = v.length, V = O > 2 ? v[2] : n;
          for (V && si(v[0], v[1], V) && (O = 1); ++C < O; )
            for (var ae = v[C], ge = zi(ae), Ce = -1, Me = ge.length; ++Ce < Me; ) {
              var We = ge[Ce], Xe = h[We];
              (Xe === n || ia(Xe, Ge[We]) && !He.call(h, We)) && (h[We] = ae[We]);
            }
          return h;
        }), c1 = qt(function(h) {
          return h.push(n, Ep), wr(Cc, n, h);
        });
        function f1(h, v) {
          return qu(h, Ct(v, 3), ts);
        }
        function td(h, v) {
          return qu(h, Ct(v, 3), sh);
        }
        function za(h, v) {
          return h == null ? h : au(h, Ct(v, 3), zi);
        }
        function d1(h, v) {
          return h == null ? h : rc(h, Ct(v, 3), zi);
        }
        function Hh(h, v) {
          return h && ts(h, Ct(v, 3));
        }
        function vo(h, v) {
          return h && sh(h, Ct(v, 3));
        }
        function mb(h) {
          return h == null ? [] : oo(h, Dr(h));
        }
        function pb(h) {
          return h == null ? [] : oo(h, zi(h));
        }
        function pl(h, v, C) {
          var O = h == null ? n : Ns(h, v);
          return O === n ? C : O;
        }
        function h1(h, v) {
          return h != null && Eh(h, v, Qi);
        }
        function pg(h, v) {
          return h != null && Eh(h, v, Oa);
        }
        var gb = Sf(function(h, v, C) {
          v != null && typeof v.toString != "function" && (v = Je.call(v)), h[v] = C;
        }, Ac(gi)), yb = Sf(function(h, v, C) {
          v != null && typeof v.toString != "function" && (v = Je.call(v)), He.call(h, v) ? h[v].push(C) : h[v] = [C];
        }, Ct), vb = qt(Da);
        function Dr(h) {
          return Ii(h) ? th(h) : rl(h);
        }
        function zi(h) {
          return Ii(h) ? th(h, !0) : Hx(h);
        }
        function xb(h, v) {
          var C = {};
          return v = Ct(v, 3), ts(h, function(O, V, ae) {
            Xi(C, v(O, V, ae), O);
          }), C;
        }
        function m1(h, v) {
          var C = {};
          return v = Ct(v, 3), ts(h, function(O, V, ae) {
            Xi(C, V, v(O, V, ae));
          }), C;
        }
        var Sc = il(function(h, v, C) {
          yf(h, v, C);
        }), Cc = il(function(h, v, C, O) {
          yf(h, v, C, O);
        }), p1 = As(function(h, v) {
          var C = {};
          if (h == null)
            return C;
          var O = !1;
          v = Tn(v, function(ae) {
            return ae = ea(ae, h), O || (O = ae.length > 1), ae;
          }), Ia(h, Tp(h), C), O && (C = hi(C, p | x | b, yy));
          for (var V = v.length; V--; )
            vf(C, v[V]);
          return C;
        });
        function bb(h, v) {
          return kc(h, Lh(Ct(v)));
        }
        var Ec = As(function(h, v) {
          return h == null ? {} : ip(h, v);
        });
        function kc(h, v) {
          if (h == null)
            return {};
          var C = Tn(Tp(h), function(O) {
            return [O];
          });
          return v = Ct(v), ai(h, C, function(O, V) {
            return v(O, V[0]);
          });
        }
        function g1(h, v, C) {
          v = ea(v, h);
          var O = -1, V = v.length;
          for (V || (V = 1, h = n); ++O < V; ) {
            var ae = h == null ? n : h[ji(v[O])];
            ae === n && (O = V, ae = C), h = aa(ae) ? ae.call(h) : ae;
          }
          return h;
        }
        function Gh(h, v, C) {
          return h == null ? h : uc(h, v, C);
        }
        function gg(h, v, C, O) {
          return O = typeof O == "function" ? O : n, h == null ? h : uc(h, v, C, O);
        }
        var Kh = Sp(Dr), nd = Sp(zi);
        function y1(h, v, C) {
          var O = It(h), V = O || hl(h) || ml(h);
          if (v = Ct(v, 4), C == null) {
            var ae = h && h.constructor;
            V ? C = O ? new ae() : [] : Gn(h) ? C = aa(ae) ? Qo(Nn(h)) : {} : C = {};
          }
          return (V ? qr : ts)(h, function(ge, Ce, Me) {
            return v(C, ge, Ce, Me);
          }), C;
        }
        function v1(h, v) {
          return h == null ? !0 : vf(h, v);
        }
        function wb(h, v, C) {
          return h == null ? h : cp(h, v, ph(C));
        }
        function x1(h, v, C, O) {
          return O = typeof O == "function" ? O : n, h == null ? h : cp(h, v, ph(C), O);
        }
        function Tc(h) {
          return h == null ? [] : rf(h, Dr(h));
        }
        function yg(h) {
          return h == null ? [] : rf(h, zi(h));
        }
        function _b(h, v, C) {
          return C === n && (C = v, v = n), C !== n && (C = sa(C), C = C === C ? C : 0), v !== n && (v = sa(v), v = v === v ? v : 0), Ja(sa(h), v, C);
        }
        function Yh(h, v, C) {
          return v = yo(v), C === n ? (C = v, v = 0) : C = yo(C), h = sa(h), nl(h, v, C);
        }
        function Wh(h, v, C) {
          if (C && typeof C != "boolean" && si(h, v, C) && (v = C = n), C === n && (typeof v == "boolean" ? (C = v, v = n) : typeof h == "boolean" && (C = h, h = n)), h === n && v === n ? (h = 0, v = 1) : (h = yo(h), v === n ? (v = h, h = 0) : v = yo(v)), h > v) {
            var O = h;
            h = v, v = O;
          }
          if (C || h % 1 || v % 1) {
            var V = ro();
            return _r(h + V * (v - h + Qs("1e-" + ((V + "").length - 1))), v);
          }
          return lc(h, v);
        }
        var Xh = ou(function(h, v, C) {
          return v = v.toLowerCase(), h + (C ? b1(v) : v);
        });
        function b1(h) {
          return hu(yn(h).toLowerCase());
        }
        function Nc(h) {
          return h = yn(h), h && h.replace(ya, Xl).replace(Lo, "");
        }
        function Sb(h, v, C) {
          h = yn(h), v = Ai(v);
          var O = h.length;
          C = C === n ? O : Ja(At(C), 0, O);
          var V = C;
          return C -= v.length, C >= 0 && h.slice(C, V) == v;
        }
        function w1(h) {
          return h = yn(h), h && Us.test(h) ? h.replace(gs, Wm) : h;
        }
        function _1(h) {
          return h = yn(h), h && vn.test(h) ? h.replace(Ga, "\\$&") : h;
        }
        var S1 = ou(function(h, v, C) {
          return h + (C ? "-" : "") + v.toLowerCase();
        }), C1 = ou(function(h, v, C) {
          return h + (C ? " " : "") + v.toLowerCase();
        }), vg = wp("toLowerCase");
        function E1(h, v, C) {
          h = yn(h), v = At(v);
          var O = v ? di(h) : 0;
          if (!v || O >= v)
            return h;
          var V = (v - O) / 2;
          return al(of(V), C) + h + al(Gu(V), C);
        }
        function k1(h, v, C) {
          h = yn(h), v = At(v);
          var O = v ? di(h) : 0;
          return v && O < v ? h + al(v - O, C) : h;
        }
        function Qh(h, v, C) {
          h = yn(h), v = At(v);
          var O = v ? di(h) : 0;
          return v && O < v ? al(v - O, C) + h : h;
        }
        function Cb(h, v, C) {
          return C || v == null ? v = 0 : v && (v = +v), Ta(yn(h).replace(Dn, ""), v || 0);
        }
        function Eb(h, v, C) {
          return (C ? si(h, v, C) : v === n) ? v = 1 : v = At(v), ns(yn(h), v);
        }
        function xg() {
          var h = arguments, v = yn(h[0]);
          return h.length < 3 ? v : v.replace(h[1], h[2]);
        }
        var bg = ou(function(h, v, C) {
          return h + (C ? "_" : "") + v.toLowerCase();
        });
        function Zh(h, v, C) {
          return C && typeof C != "number" && si(h, v, C) && (v = C = n), C = C === n ? $ : C >>> 0, C ? (h = yn(h), h && (typeof v == "string" || v != null && !Zf(v)) && (v = Ai(v), !v && Fr(h)) ? rs(Mn(h), 0, C) : h.split(v, C)) : [];
        }
        var wg = ou(function(h, v, C) {
          return h + (C ? " " : "") + hu(v);
        });
        function T1(h, v, C) {
          return h = yn(h), C = C == null ? 0 : Ja(At(C), 0, h.length), v = Ai(v), h.slice(C, C + v.length) == v;
        }
        function _g(h, v, C) {
          var O = te.templateSettings;
          C && si(h, v, C) && (v = n), h = yn(h), v = _c({}, v, O, Cp);
          var V = _c({}, v.imports, O.imports, Cp), ae = Dr(V), ge = rf(V, ae), Ce, Me, We = 0, Xe = v.interpolate || on, Ze = "__p += '", ht = ke(
            (v.escape || on).source + "|" + Xe.source + "|" + (Xe === zl ? Mr : on).source + "|" + (v.evaluate || on).source + "|$",
            "g"
          ), wt = "//# sourceURL=" + (He.call(v, "sourceURL") ? (v.sourceURL + "").replace(/\s/g, " ") : "lodash.templateSources[" + ++Iu + "]") + `
`;
          h.replace(ht, function(Mt, en, un, ls, oa, us) {
            return un || (un = ls), Ze += h.slice(We, us).replace(ei, Vu), en && (Ce = !0, Ze += `' +
__e(` + en + `) +
'`), oa && (Me = !0, Ze += `';
` + oa + `;
__p += '`), un && (Ze += `' +
((__t = (` + un + `)) == null ? '' : __t) +
'`), We = us + Mt.length, Mt;
          }), Ze += `';
`;
          var jt = He.call(v, "variable") && v.variable;
          if (!jt)
            Ze = `with (obj) {
` + Ze + `
}
`;
          else if (wn.test(jt))
            throw new he(u);
          Ze = (Me ? Ze.replace(fr, "") : Ze).replace(Io, "$1").replace(ct, "$1;"), Ze = "function(" + (jt || "obj") + `) {
` + (jt ? "" : `obj || (obj = {});
`) + "var __t, __p = ''" + (Ce ? ", __e = _.escape" : "") + (Me ? `, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
` : `;
`) + Ze + `return __p
}`;
          var Vt = Sg(function() {
            return _e(ae, wt + "return " + Ze).apply(n, ge);
          });
          if (Vt.source = Ze, Fh(Vt))
            throw Vt;
          return Vt;
        }
        function gl(h) {
          return yn(h).toLowerCase();
        }
        function yl(h) {
          return yn(h).toUpperCase();
        }
        function vl(h, v, C) {
          if (h = yn(h), h && (C || v === n))
            return Cs(h);
          if (!h || !(v = Ai(v)))
            return h;
          var O = Mn(h), V = Mn(v), ae = Wl(O, V), ge = $u(O, V) + 1;
          return rs(O, ae, ge).join("");
        }
        function rd(h, v, C) {
          if (h = yn(h), h && (C || v === n))
            return h.slice(0, w(h) + 1);
          if (!h || !(v = Ai(v)))
            return h;
          var O = Mn(h), V = $u(O, Mn(v)) + 1;
          return rs(O, 0, V).join("");
        }
        function id(h, v, C) {
          if (h = yn(h), h && (C || v === n))
            return h.replace(Dn, "");
          if (!h || !(v = Ai(v)))
            return h;
          var O = Mn(h), V = Wl(O, Mn(v));
          return rs(O, V).join("");
        }
        function xl(h, v) {
          var C = Y, O = H;
          if (Gn(v)) {
            var V = "separator" in v ? v.separator : V;
            C = "length" in v ? At(v.length) : C, O = "omission" in v ? Ai(v.omission) : O;
          }
          h = yn(h);
          var ae = h.length;
          if (Fr(h)) {
            var ge = Mn(h);
            ae = ge.length;
          }
          if (C >= ae)
            return h;
          var Ce = C - di(O);
          if (Ce < 1)
            return O;
          var Me = ge ? rs(ge, 0, Ce).join("") : h.slice(0, Ce);
          if (V === n)
            return Me + O;
          if (ge && (Ce += Me.length - Ce), Zf(V)) {
            if (h.slice(Ce).search(V)) {
              var We, Xe = Me;
              for (V.global || (V = ke(V.source, yn(pa.exec(V)) + "g")), V.lastIndex = 0; We = V.exec(Xe); )
                var Ze = We.index;
              Me = Me.slice(0, Ze === n ? Ce : Ze);
            }
          } else if (h.indexOf(Ai(V), Ce) != Ce) {
            var ht = Me.lastIndexOf(V);
            ht > -1 && (Me = Me.slice(0, ht));
          }
          return Me + O;
        }
        function kb(h) {
          return h = yn(h), h && Ui.test(h) ? h.replace(Va, E) : h;
        }
        var N1 = ou(function(h, v, C) {
          return h + (C ? " " : "") + v.toUpperCase();
        }), hu = wp("toUpperCase");
        function A1(h, v, C) {
          return h = yn(h), v = C ? n : v, v === n ? zn(h) ? q(h) : tf(h) : h.match(v) || [];
        }
        var Sg = qt(function(h, v) {
          try {
            return wr(h, n, v);
          } catch (C) {
            return Fh(C) ? C : new he(C);
          }
        }), Jh = As(function(h, v) {
          return qr(v, function(C) {
            C = ji(C), Xi(h, C, zh(h[C], h));
          }), h;
        });
        function j1(h) {
          var v = h == null ? 0 : h.length, C = Ct();
          return h = v ? Tn(h, function(O) {
            if (typeof O[1] != "function")
              throw new je(o);
            return [C(O[0]), O[1]];
          }) : [], qt(function(O) {
            for (var V = -1; ++V < v; ) {
              var ae = h[V];
              if (wr(ae[0], this, O))
                return wr(ae[1], this, O);
            }
          });
        }
        function Tb(h) {
          return ry(hi(h, p));
        }
        function Ac(h) {
          return function() {
            return h;
          };
        }
        function em(h, v) {
          return h == null || h !== h ? v : h;
        }
        var M1 = fc(), jc = fc(!0);
        function gi(h) {
          return h;
        }
        function ad(h) {
          return ac(typeof h == "function" ? h : hi(h, p));
        }
        function tm(h) {
          return ch(hi(h, p));
        }
        function R1(h, v) {
          return rp(h, hi(v, p));
        }
        var Nb = qt(function(h, v) {
          return function(C) {
            return Da(C, h, v);
          };
        }), nm = qt(function(h, v) {
          return function(C) {
            return Da(h, C, v);
          };
        });
        function a(h, v, C) {
          var O = Dr(v), V = oo(v, O);
          C == null && !(Gn(v) && (V.length || !O.length)) && (C = v, v = h, h = this, V = oo(v, Dr(v)));
          var ae = !(Gn(C) && "chain" in C) || !!C.chain, ge = aa(h);
          return qr(V, function(Ce) {
            var Me = v[Ce];
            h[Ce] = Me, ge && (h.prototype[Ce] = function() {
              var We = this.__chain__;
              if (ae || We) {
                var Xe = h(this.__wrapped__), Ze = Xe.__actions__ = mi(this.__actions__);
                return Ze.push({ func: Me, args: arguments, thisArg: h }), Xe.__chain__ = We, Xe;
              }
              return Me.apply(h, Gi([this.value()], arguments));
            });
          }), h;
        }
        function l() {
          return Jn._ === this && (Jn._ = _t), this;
        }
        function f() {
        }
        function y(h) {
          return h = At(h), qt(function(v) {
            return fh(v, h);
          });
        }
        var _ = vh(Tn), N = vh(Lu), B = vh(Fo);
        function ee(h) {
          return Rf(h) ? Ca(ji(h)) : yr(h);
        }
        function ye(h) {
          return function(v) {
            return h == null ? n : Ns(h, v);
          };
        }
        var Pe = xh(), Ve = xh(!0);
        function Ye() {
          return [];
        }
        function Le() {
          return !1;
        }
        function qe() {
          return {};
        }
        function xt() {
          return "";
        }
        function kt() {
          return !0;
        }
        function Cn(h, v) {
          if (h = At(h), h < 1 || h > de)
            return [];
          var C = $, O = _r(h, $);
          v = Ct(v), h -= $;
          for (var V = Yl(O, v); ++C < h; )
            v(C);
          return V;
        }
        function Ae(h) {
          return It(h) ? Tn(h, ji) : Pi(h) ? [h] : mi(Dp(yn(h)));
        }
        function Ee(h) {
          var v = ++ot;
          return yn(h) + v;
        }
        var De = Cf(function(h, v) {
          return h + v;
        }, 0), Ke = kf("ceil"), St = Cf(function(h, v) {
          return h / v;
        }, 1), fn = kf("floor");
        function bt(h) {
          return h && h.length ? es(h, gi, mf) : n;
        }
        function Ut(h, v) {
          return h && h.length ? es(h, Ct(v, 2), mf) : n;
        }
        function Xt(h) {
          return Uo(h, gi);
        }
        function dn(h, v) {
          return Uo(h, Ct(v, 2));
        }
        function bl(h) {
          return h && h.length ? es(h, gi, Hn) : n;
        }
        function Ab(h, v) {
          return h && h.length ? es(h, Ct(v, 2), Hn) : n;
        }
        var IL = Cf(function(h, v) {
          return h * v;
        }, 1), PL = kf("round"), zL = Cf(function(h, v) {
          return h - v;
        }, 0);
        function LL(h) {
          return h && h.length ? Uu(h, gi) : 0;
        }
        function BL(h, v) {
          return h && h.length ? Uu(h, Ct(v, 2)) : 0;
        }
        return te.after = Yy, te.ary = Qp, te.assign = l1, te.assignIn = Vh, te.assignInWith = _c, te.assignWith = hb, te.at = Pa, te.before = Zp, te.bind = zh, te.bindAll = Jh, te.bindKey = Jp, te.castArray = ob, te.chain = Uf, te.chunk = Ey, te.compact = Ip, te.concat = Pp, te.cond = j1, te.conforms = Tb, te.constant = Ac, te.countBy = Ly, te.create = mg, te.curry = Gf, te.curryRight = eg, te.debounce = tg, te.defaults = u1, te.defaultsDeep = c1, te.defer = bn, te.delay = ng, te.difference = jh, te.differenceBy = ky, te.differenceWith = fo, te.drop = Er, te.dropRight = zp, te.dropRightWhile = Ty, te.dropWhile = Or, te.fill = Qx, te.filter = Yp, te.flatMap = Di, te.flatMapDeep = qy, te.flatMapDepth = Fy, te.flatten = Bn, te.flattenDeep = Mi, te.flattenDepth = ho, te.flip = ib, te.flow = M1, te.flowRight = jc, te.fromPairs = Ny, te.functions = mb, te.functionsIn = pb, te.groupBy = Dh, te.initial = Zx, te.intersection = Mh, te.intersectionBy = Ri, te.intersectionWith = as, te.invert = gb, te.invertBy = yb, te.invokeMap = xc, te.iteratee = ad, te.keyBy = $y, te.keys = Dr, te.keysIn = zi, te.map = Vf, te.mapKeys = xb, te.mapValues = m1, te.matches = tm, te.matchesProperty = R1, te.memoize = Kf, te.merge = Sc, te.mergeWith = Cc, te.method = Nb, te.methodOf = nm, te.mixin = a, te.negate = Lh, te.nthArg = y, te.omit = p1, te.omitBy = bb, te.once = ab, te.orderBy = Vy, te.over = _, te.overArgs = sb, te.overEvery = N, te.overSome = B, te.partial = wc, te.partialRight = fu, te.partition = Hy, te.pick = Ec, te.pickBy = kc, te.property = ee, te.propertyOf = ye, te.pull = lu, te.pullAll = Ms, te.pullAllBy = Fp, te.pullAllWith = Up, te.pullAt = ss, te.range = Pe, te.rangeRight = Ve, te.rearg = rg, te.reject = tb, te.remove = Ry, te.rest = Bh, te.reverse = ol, te.sampleSize = rb, te.set = Gh, te.setWith = gg, te.shuffle = Gy, te.slice = Lf, te.sortBy = Ph, te.sortedUniq = Rh, te.sortedUniqBy = Py, te.split = Zh, te.spread = ig, te.tail = Jx, te.take = eb, te.takeRight = mn, te.takeRightWhile = jn, te.takeWhile = Gt, te.tap = zy, te.throttle = dl, te.thru = cu, te.toArray = o1, te.toPairs = Kh, te.toPairsIn = nd, te.toPath = Ae, te.toPlainObject = $h, te.transform = y1, te.unary = Rs, te.union = Wt, te.unionBy = xn, te.unionWith = ta, te.uniq = ll, te.uniqBy = gc, te.uniqWith = $p, te.unset = v1, te.unzip = os, te.unzipWith = tr, te.update = wb, te.updateWith = x1, te.values = Tc, te.valuesIn = yg, te.without = ul, te.words = A1, te.wrap = Yf, te.xor = uu, te.xorBy = Vp, te.xorWith = na, te.zip = yc, te.zipObject = Ff, te.zipObjectDeep = Oi, te.zipWith = Hp, te.entries = Kh, te.entriesIn = nd, te.extend = Vh, te.extendWith = _c, a(te, te), te.add = De, te.attempt = Sg, te.camelCase = Xh, te.capitalize = b1, te.ceil = Ke, te.clamp = _b, te.clone = Wy, te.cloneDeep = Qy, te.cloneDeepWith = Zy, te.cloneWith = Xy, te.conformsTo = lb, te.deburr = Nc, te.defaultTo = em, te.divide = St, te.endsWith = Sb, te.eq = ia, te.escape = w1, te.escapeRegExp = _1, te.every = $f, te.find = ra, te.findIndex = Lp, te.findKey = f1, te.findLast = By, te.findLastIndex = Bp, te.findLastKey = td, te.floor = fn, te.forEach = Uy, te.forEachRight = go, te.forIn = za, te.forInRight = d1, te.forOwn = Hh, te.forOwnRight = vo, te.get = pl, te.gt = Jy, te.gte = e1, te.has = h1, te.hasIn = pg, te.head = qp, te.identity = gi, te.includes = Wp, te.indexOf = Ay, te.inRange = Yh, te.invoke = vb, te.isArguments = du, te.isArray = It, te.isArrayBuffer = ag, te.isArrayLike = Ii, te.isArrayLikeObject = vr, te.isBoolean = Wf, te.isBuffer = hl, te.isDate = t1, te.isElement = Kt, te.isEmpty = sg, te.isEqual = qh, te.isEqualWith = og, te.isError = Fh, te.isFinite = lg, te.isFunction = aa, te.isInteger = Xf, te.isLength = Uh, te.isMap = n1, te.isMatch = r1, te.isMatchWith = i1, te.isNaN = Sn, te.isNative = ug, te.isNil = ub, te.isNull = Yr, te.isNumber = cg, te.isObject = Gn, te.isObjectLike = sr, te.isPlainObject = Qf, te.isRegExp = Zf, te.isSafeInteger = fg, te.isSet = Jf, te.isString = ed, te.isSymbol = Pi, te.isTypedArray = ml, te.isUndefined = dg, te.isWeakMap = cb, te.isWeakSet = a1, te.join = jy, te.kebabCase = S1, te.last = qn, te.lastIndexOf = My, te.lowerCase = C1, te.lowerFirst = vg, te.lt = fb, te.lte = s1, te.max = bt, te.maxBy = Ut, te.mean = Xt, te.meanBy = dn, te.min = bl, te.minBy = Ab, te.stubArray = Ye, te.stubFalse = Le, te.stubObject = qe, te.stubString = xt, te.stubTrue = kt, te.multiply = IL, te.nth = mo, te.noConflict = l, te.noop = f, te.now = Hf, te.pad = E1, te.padEnd = k1, te.padStart = Qh, te.parseInt = Cb, te.random = Wh, te.reduce = Ih, te.reduceRight = Xp, te.repeat = Eb, te.replace = xg, te.result = g1, te.round = PL, te.runInContext = U, te.sample = nb, te.size = Ky, te.snakeCase = bg, te.some = bc, te.sortedIndex = Bf, te.sortedIndexBy = pc, te.sortedIndexOf = Oy, te.sortedLastIndex = Dy, te.sortedLastIndexBy = qf, te.sortedLastIndexOf = Iy, te.startCase = wg, te.startsWith = T1, te.subtract = zL, te.sum = LL, te.sumBy = BL, te.template = _g, te.times = Cn, te.toFinite = yo, te.toInteger = At, te.toLength = hg, te.toLower = gl, te.toNumber = sa, te.toSafeInteger = db, te.toString = yn, te.toUpper = yl, te.trim = vl, te.trimEnd = rd, te.trimStart = id, te.truncate = xl, te.unescape = kb, te.uniqueId = Ee, te.upperCase = N1, te.upperFirst = hu, te.each = Uy, te.eachRight = go, te.first = qp, a(te, (function() {
          var h = {};
          return ts(te, function(v, C) {
            He.call(te.prototype, C) || (h[C] = v);
          }), h;
        })(), { chain: !1 }), te.VERSION = r, qr(["bind", "bindKey", "curry", "curryRight", "partial", "partialRight"], function(h) {
          te[h].placeholder = te;
        }), qr(["drop", "take"], function(h, v) {
          Lt.prototype[h] = function(C) {
            C = C === n ? 1 : rr(At(C), 0);
            var O = this.__filtered__ && !v ? new Lt(this) : this.clone();
            return O.__filtered__ ? O.__takeCount__ = _r(C, O.__takeCount__) : O.__views__.push({
              size: _r(C, $),
              type: h + (O.__dir__ < 0 ? "Right" : "")
            }), O;
          }, Lt.prototype[h + "Right"] = function(C) {
            return this.reverse()[h](C).reverse();
          };
        }), qr(["filter", "map", "takeWhile"], function(h, v) {
          var C = v + 1, O = C == Q || C == J;
          Lt.prototype[h] = function(V) {
            var ae = this.clone();
            return ae.__iteratees__.push({
              iteratee: Ct(V, 3),
              type: C
            }), ae.__filtered__ = ae.__filtered__ || O, ae;
          };
        }), qr(["head", "last"], function(h, v) {
          var C = "take" + (v ? "Right" : "");
          Lt.prototype[h] = function() {
            return this[C](1).value()[0];
          };
        }), qr(["initial", "tail"], function(h, v) {
          var C = "drop" + (v ? "" : "Right");
          Lt.prototype[h] = function() {
            return this.__filtered__ ? new Lt(this) : this[C](1);
          };
        }), Lt.prototype.compact = function() {
          return this.filter(gi);
        }, Lt.prototype.find = function(h) {
          return this.filter(h).head();
        }, Lt.prototype.findLast = function(h) {
          return this.reverse().find(h);
        }, Lt.prototype.invokeMap = qt(function(h, v) {
          return typeof h == "function" ? new Lt(this) : this.map(function(C) {
            return Da(C, h, v);
          });
        }), Lt.prototype.reject = function(h) {
          return this.filter(Lh(Ct(h)));
        }, Lt.prototype.slice = function(h, v) {
          h = At(h);
          var C = this;
          return C.__filtered__ && (h > 0 || v < 0) ? new Lt(C) : (h < 0 ? C = C.takeRight(-h) : h && (C = C.drop(h)), v !== n && (v = At(v), C = v < 0 ? C.dropRight(-v) : C.take(v - h)), C);
        }, Lt.prototype.takeRightWhile = function(h) {
          return this.reverse().takeWhile(h).reverse();
        }, Lt.prototype.toArray = function() {
          return this.take($);
        }, ts(Lt.prototype, function(h, v) {
          var C = /^(?:filter|find|map|reject)|While$/.test(v), O = /^(?:head|last)$/.test(v), V = te[O ? "take" + (v == "last" ? "Right" : "") : v], ae = O || /^find/.test(v);
          V && (te.prototype[v] = function() {
            var ge = this.__wrapped__, Ce = O ? [1] : arguments, Me = ge instanceof Lt, We = Ce[0], Xe = Me || It(ge), Ze = function(en) {
              var un = V.apply(te, Gi([en], Ce));
              return O && ht ? un[0] : un;
            };
            Xe && C && typeof We == "function" && We.length != 1 && (Me = Xe = !1);
            var ht = this.__chain__, wt = !!this.__actions__.length, jt = ae && !ht, Vt = Me && !wt;
            if (!ae && Xe) {
              ge = Vt ? ge : new Lt(this);
              var Mt = h.apply(ge, Ce);
              return Mt.__actions__.push({ func: cu, args: [Ze], thisArg: n }), new Ti(Mt, ht);
            }
            return jt && Vt ? h.apply(this, Ce) : (Mt = this.thru(Ze), jt ? O ? Mt.value()[0] : Mt.value() : Mt);
          });
        }), qr(["pop", "push", "shift", "sort", "splice", "unshift"], function(h) {
          var v = ze[h], C = /^(?:push|sort|unshift)$/.test(h) ? "tap" : "thru", O = /^(?:pop|shift)$/.test(h);
          te.prototype[h] = function() {
            var V = arguments;
            if (O && !this.__chain__) {
              var ae = this.value();
              return v.apply(It(ae) ? ae : [], V);
            }
            return this[C](function(ge) {
              return v.apply(It(ge) ? ge : [], V);
            });
          };
        }), ts(Lt.prototype, function(h, v) {
          var C = te[v];
          if (C) {
            var O = C.name + "";
            He.call(gn, O) || (gn[O] = []), gn[O].push({ name: v, func: C });
          }
        }), gn[dc(n, T).name] = [{
          name: "wrapper",
          func: n
        }], Lt.prototype.clone = io, Lt.prototype.reverse = Jo, Lt.prototype.value = ao, te.prototype.at = Oh, te.prototype.chain = cl, te.prototype.commit = Nr, te.prototype.next = fl, te.prototype.plant = po, te.prototype.reverse = Gp, te.prototype.toJSON = te.prototype.valueOf = te.prototype.value = Kp, te.prototype.first = te.prototype.head, Vr && (te.prototype[Vr] = vc), te;
      }), oe = X();
      Hi ? ((Hi.exports = oe)._ = oe, $l._ = oe) : Jn._ = oe;
    }).call(rU);
  })(qg, qg.exports)), qg.exports;
}
var aU = iU();
const cs = "SyncService", sU = 3e3, Ub = "webllm", $b = [0], md = class md {
  constructor() {
    vt(this, "debouncedUploads", /* @__PURE__ */ new Map());
    vt(this, "deviceId");
    this.deviceId = Math.random().toString(36).substring(2, 15), ve.info(cs, `Initialized with Device ID: ${this.deviceId}`);
  }
  static getInstance() {
    return md.instance || (md.instance = new md()), md.instance;
  }
  /**
   *  Collection ID
   * : engram_sync_{chatId}
   */
  getCollectionId(t) {
    return `engram_sync_${t}`;
  }
  /**
   * 
   */
  scheduleUpload(t) {
    const n = rt.getSettings().syncConfig;
    if (!(n != null && n.enabled) || !(n != null && n.autoSync))
      return;
    if (!this.debouncedUploads.has(t)) {
      const i = aU.debounce(() => {
        const s = rt.getSettings().syncConfig;
        !(s != null && s.enabled) || !(s != null && s.autoSync) || this.upload(t).catch((o) => {
          ve.error(cs, `Auto-upload failed for ${t}`, o);
        });
      }, sU);
      this.debouncedUploads.set(t, i);
    }
    const r = this.debouncedUploads.get(t);
    r && r();
  }
  /**
   *  Vector Store
   */
  async upload(t) {
    try {
      ve.info(cs, `Starting upload for ${t}...`);
      const n = await Al(t), r = await PR(n), i = Date.now();
      ve.info(cs, `Exporting... Events: ${r.events.length}, Entities: ${r.entities.length}`);
      const s = JSON.stringify({
        ...r,
        meta: { ...r.meta, syncTimestamp: i, deviceId: this.deviceId }
      }), o = {
        collectionId: this.getCollectionId(t),
        source: Ub,
        model: "engram_store",
        // Fix 'undefined' folder
        items: [{
          hash: 0,
          // Hack:  Item
          index: 0,
          text: s
        }],
        embeddings: {
          [s]: $b
        }
      };
      await this.purge(t);
      const u = await fetch("/api/vector/insert", {
        method: "POST",
        headers: Bg(),
        body: JSON.stringify(o)
      });
      if (!u.ok)
        throw new Error(`Upload failed: ${u.statusText}`);
      return ve.info(cs, `Upload success for ${t} at ${new Date(i).toLocaleString()}`), !0;
    } catch (n) {
      return ve.error(cs, `Upload error for ${t}`, n), !1;
    }
  }
  /**
   * 
   */
  async purge(t) {
    try {
      await fetch("/api/vector/purge", {
        method: "POST",
        headers: Bg(),
        body: JSON.stringify({
          collectionId: this.getCollectionId(t)
        })
      });
    } catch {
    }
  }
  /**
   * 
   */
  async getRemoteStatus(t) {
    var n, r;
    try {
      const i = await fetch("/api/vector/query", {
        method: "POST",
        headers: Bg(),
        body: JSON.stringify({
          collectionId: this.getCollectionId(t),
          searchText: "dummy",
          // webllm  embedding
          source: Ub,
          model: "engram_store",
          topK: 1,
          embeddings: {
            dummy: $b
          }
        })
      });
      if (!i.ok) return { exists: !1, timestamp: 0 };
      const o = await i.json();
      if (!o.metadata || o.metadata.length === 0)
        return { exists: !1, timestamp: 0 };
      const u = JSON.parse(o.metadata[0].text);
      return {
        exists: !0,
        timestamp: ((n = u.meta) == null ? void 0 : n.syncTimestamp) || 0,
        deviceId: (r = u.meta) == null ? void 0 : r.deviceId
      };
    } catch (i) {
      return ve.warn(cs, `Check status failed for ${t}`, i), { exists: !1, timestamp: 0 };
    }
  }
  /**
   * 
   */
  async download(t) {
    var n, r;
    try {
      ve.info(cs, `Downloading for ${t}...`);
      const i = await fetch("/api/vector/query", {
        method: "POST",
        headers: Bg(),
        body: JSON.stringify({
          collectionId: this.getCollectionId(t),
          searchText: "dummy",
          source: Ub,
          model: "engram_store",
          topK: 1,
          embeddings: {
            dummy: $b
          }
        })
      });
      if (!i.ok) throw new Error("Download request failed");
      const s = await i.json();
      if (!s.metadata || s.metadata.length === 0)
        return ve.warn(cs, `No remote data found for ${t}`), "no_data";
      const o = JSON.parse(s.metadata[0].text);
      ve.info(cs, `Received dump: ${(n = o.events) == null ? void 0 : n.length} events, ${(r = o.entities) == null ? void 0 : r.length} entities`);
      const u = await Al(t);
      await zR(u, o);
      const c = await u.events.count(), d = await u.entities.count();
      return ve.info(cs, `Import verification: DB has ${c} events, ${d} entities`), "success";
    } catch (i) {
      return ve.error(cs, `Download failed for ${t}`, i), "error";
    }
  }
  /**
   * 
   * @returns 'downloaded' | 'uploaded' | 'synced' | 'error' | 'ignored'
   */
  async autoSync(t) {
    const n = await this.getRemoteStatus(t);
    if (!n.exists)
      return "ignored";
    const i = await (await Al(t)).meta.toArray(), s = i.length > 0 ? i[0] : null, o = (s == null ? void 0 : s.syncTimestamp) || 0;
    return n.deviceId === this.deviceId ? "synced" : n.timestamp > o ? (ve.info(cs, `Remote is newer (${n.timestamp} > ${o}), downloading...`), await this.download(t) === "success" ? "downloaded" : "error") : "synced";
  }
};
vt(md, "instance");
let wv = md;
const cd = wv.getInstance(), oU = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  SyncService: wv,
  syncService: cd
}, Symbol.toStringTag, { value: "Module" }));
class IR extends l0 {
  constructor(n) {
    super(`Engram_${n}`);
    vt(this, "events");
    vt(this, "entities");
    vt(this, "meta");
    vt(this, "chatId");
    this.chatId = n, this.version(2).stores({
      // Events: 
      events: "id, timestamp, significance_score, level",
      // Entities:  (V0.9.4:  aliases )
      entities: "id, type, name, *aliases",
      // Meta:  (lastSummarizedFloor )
      meta: "key"
    }), this.events.hook("creating", () => {
      cd.scheduleUpload(this.chatId);
    }), this.events.hook("updating", () => {
      cd.scheduleUpload(this.chatId);
    }), this.events.hook("deleting", () => {
      cd.scheduleUpload(this.chatId);
    }), this.entities.hook("creating", () => {
      cd.scheduleUpload(this.chatId);
    }), this.entities.hook("updating", () => {
      cd.scheduleUpload(this.chatId);
    }), this.entities.hook("deleting", () => {
      cd.scheduleUpload(this.chatId);
    });
  }
}
async function PR(e) {
  const t = await e.events.toArray(), n = await e.entities.toArray(), i = (await e.meta.toArray()).reduce((s, o) => ({ ...s, [o.key]: o.value }), {});
  return { events: t, entities: n, meta: i };
}
async function zR(e, t) {
  await e.transaction("rw", e.events, e.entities, e.meta, async () => {
    await e.events.clear(), await e.entities.clear(), await e.meta.clear(), await e.events.bulkAdd(t.events), await e.entities.bulkAdd(t.entities);
    const n = Object.entries(t.meta || {}).map(([r, i]) => ({ key: r, value: i }));
    await e.meta.bulkAdd(n);
  });
}
const _d = /* @__PURE__ */ new Map();
function Al(e) {
  if (!e)
    throw new Error("[Engram DB] chatId is required");
  return _d.has(e) || (console.debug(`[Engram DB] Creating database for chat: ${e}`), _d.set(e, new IR(e))), _d.get(e);
}
function LR(e) {
  const t = _d.get(e);
  t && (t.close(), _d.delete(e), console.debug(`[Engram DB] Closed database for chat: ${e}`));
}
function lU(e) {
  return _d.has(e);
}
function Lc(e) {
  return _d.get(e) || null;
}
async function uU(e) {
  LR(e), await l0.delete(`Engram_${e}`), console.info(`[Engram DB] Deleted database for chat: ${e}`);
}
const cU = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  ChatDatabase: IR,
  closeDb: LR,
  deleteDatabase: uU,
  exportChatData: PR,
  getDbForChat: Al,
  hasDbForChat: lU,
  importChatData: zR,
  tryGetDbForChat: Lc
}, Symbol.toStringTag, { value: "Module" }));
class fU {
  async search(t) {
    const n = t.toLowerCase().trim();
    if (!n || n.length < 2) return [];
    const r = xi();
    if (!r) return [];
    const i = Lc(r);
    if (!i) return [];
    try {
      return (await i.events.filter((o) => o.summary.toLowerCase().includes(n)).reverse().limit(5).toArray()).map((o) => ({
        id: `memory-${o.id}`,
        type: "memory",
        title: o.summary.slice(0, 50) + (o.summary.length > 50 ? "..." : ""),
        description: new Date(o.timestamp).toLocaleString(),
        icon: zm,
        action: (u) => u("/memory"),
        // TODO: Nav to specific item?
        score: 5
        // Lower score than exact commands
      }));
    } catch (s) {
      return console.error("Memory search failed", s), [];
    }
  }
}
class dU {
  async search(t) {
    const n = t.toLowerCase().trim();
    if (!n) return [];
    const r = [];
    return (rt.get("promptTemplates") || []).forEach((s) => {
      s.name.toLowerCase().includes(n) && r.push({
        id: `template-${s.id}`,
        type: "setting",
        // or 'template'
        title: `: ${s.name}`,
        description: `Prompt Template (${s.category})`,
        icon: zm,
        action: (o) => o("presets:prompt"),
        // Ideally navigates to specific template
        score: 7
      });
    }), r;
  }
}
window.__ENGRAM_SEARCH_INIT__ || (cm.registerAdapter(new MR()), cm.registerAdapter(new QF()), cm.registerAdapter(new ZF()), cm.registerAdapter(new fU()), cm.registerAdapter(new dU()), window.__ENGRAM_SEARCH_INIT__ = !0);
const hU = ({ onNavigate: e }) => {
  const [t, n] = F.useState(""), [r, i] = F.useState(!1), [s, o] = F.useState(0), [u, c] = F.useState([]), d = F.useRef(null);
  F.useEffect(() => {
    (async () => {
      if (!t.trim()) {
        const k = await new MR().search("");
        c(k);
        return;
      }
      const S = await cm.search(t);
      c(S), o(0);
    })();
  }, [t, r]), F.useEffect(() => {
    const b = (S) => {
      (S.metaKey || S.ctrlKey) && S.key === "k" && (S.preventDefault(), i(!0));
    };
    return window.addEventListener("keydown", b), () => window.removeEventListener("keydown", b);
  }, []), F.useEffect(() => {
    r && setTimeout(() => {
      var b;
      return (b = d.current) == null ? void 0 : b.focus();
    }, 50);
  }, [r]);
  const m = (b) => {
    const S = u.length + (t ? 1 : 0);
    switch (b.key) {
      case "ArrowDown":
        b.preventDefault(), o((k) => (k + 1) % S);
        break;
      case "ArrowUp":
        b.preventDefault(), o((k) => (k - 1 + S) % S);
        break;
      case "Enter":
        b.preventDefault(), p();
        break;
      case "Escape":
        i(!1);
        break;
    }
  }, p = () => {
    u.length > 0 && s < u.length ? u[s].action(e) : t && (console.log("Searching memory for:", t), e("/memory")), i(!1), n("");
  }, x = /* @__PURE__ */ g.jsx(
    "div",
    {
      className: "fixed inset-0 flex items-start justify-center pt-[15vh] px-4 animate-in fade-in duration-200",
      style: {
        height: "100dvh",
        width: "100vw",
        backgroundColor: "rgba(0,0,0,0.4)",
        // Slightly more transparent to not feel too heavy
        backdropFilter: "var(--glass-backdrop-filter, blur(4px))",
        zIndex: 2147483647
        // Max safe integer to ensure it's on top of SillyTavern UI
      },
      onClick: (b) => {
        b.target === b.currentTarget && i(!1);
      },
      children: /* @__PURE__ */ g.jsxs(
        "div",
        {
          className: "w-full max-w-xl border border-border rounded-xl shadow-2xl overflow-hidden flex flex-col animate-in zoom-in-95 slide-in-from-top-4 duration-200",
          style: {
            backgroundColor: "var(--popover)",
            color: "var(--popover-foreground)",
            backdropFilter: "var(--glass-backdrop-filter)",
            maxHeight: "70vh"
          },
          children: [
            /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-3 px-4 py-3 border-b border-border/50", children: [
              /* @__PURE__ */ g.jsx(Ls, { size: 20, className: "text-muted-foreground shrink-0" }),
              /* @__PURE__ */ g.jsx(
                "input",
                {
                  ref: d,
                  type: "text",
                  className: "flex-1 bg-transparent border-none outline-none text-lg text-foreground placeholder:text-muted-foreground/50",
                  placeholder: "...",
                  value: t,
                  onChange: (b) => n(b.target.value),
                  onKeyDown: m
                }
              ),
              /* @__PURE__ */ g.jsx("div", { className: "text-[10px] text-muted-foreground border border-border px-1.5 py-0.5 rounded bg-muted/50 hidden sm:block", children: "ESC" })
            ] }),
            /* @__PURE__ */ g.jsxs("div", { className: "overflow-y-auto p-2 scroll-smooth", children: [
              u.length > 0 && /* @__PURE__ */ g.jsx("div", { className: "space-y-1", children: u.map((b, S) => /* @__PURE__ */ g.jsxs(
                "div",
                {
                  className: `flex items-center gap-3 px-3 py-2.5 rounded-lg cursor-pointer transition-colors ${S === s ? "bg-primary/10 text-primary" : "text-foreground hover:bg-muted/50"}`,
                  onClick: () => {
                    b.action(e), i(!1), n("");
                  },
                  onMouseEnter: () => o(S),
                  children: [
                    /* @__PURE__ */ g.jsx("div", { className: `
                                        w-8 h-8 rounded-md flex items-center justify-center shrink-0
                                        ${S === s ? "bg-primary/20" : "bg-muted/50 text-muted-foreground"}
                                    `, children: b.icon ? /* @__PURE__ */ g.jsx(b.icon, { size: 16 }) : /* @__PURE__ */ g.jsx(Tk, { size: 16 }) }),
                    /* @__PURE__ */ g.jsxs("div", { className: "flex-1 min-w-0", children: [
                      /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-2", children: [
                        /* @__PURE__ */ g.jsx("span", { className: "text-sm font-medium", children: b.title }),
                        b.type !== "command" && /* @__PURE__ */ g.jsx("span", { className: "text-[10px] px-1.5 py-0.5 rounded-full bg-muted text-muted-foreground uppercase", children: b.type })
                      ] }),
                      b.description && /* @__PURE__ */ g.jsx("div", { className: "text-xs text-muted-foreground/80 truncate", children: b.description })
                    ] }),
                    S === s && /* @__PURE__ */ g.jsx(Nk, { size: 16, className: "text-muted-foreground/50" })
                  ]
                },
                b.id
              )) }),
              t && /* @__PURE__ */ g.jsxs(
                "div",
                {
                  className: `
                            mt-2 pt-2 border-t border-border/50
                            flex items-center gap-3 px-3 py-2.5 rounded-lg cursor-pointer transition-colors
                            ${s === u.length ? "bg-primary/10 text-primary" : "text-foreground hover:bg-muted/50"}
                        `,
                  onClick: () => p(),
                  onMouseEnter: () => o(u.length),
                  children: [
                    /* @__PURE__ */ g.jsx("div", { className: `w-8 h-8 rounded-md flex items-center justify-center shrink-0 ${s === u.length ? "bg-primary/20" : "bg-muted/50 text-muted-foreground"}`, children: /* @__PURE__ */ g.jsx(Ls, { size: 16 }) }),
                    /* @__PURE__ */ g.jsxs("div", { className: "flex-1 min-w-0", children: [
                      /* @__PURE__ */ g.jsxs("div", { className: "text-sm font-medium", children: [
                        ': "',
                        /* @__PURE__ */ g.jsx("span", { className: "text-primary", children: t }),
                        '"'
                      ] }),
                      /* @__PURE__ */ g.jsx("div", { className: "text-xs text-muted-foreground/80", children: "..." })
                    ] }),
                    s === u.length && /* @__PURE__ */ g.jsx(Nk, { size: 16, className: "text-muted-foreground/50" })
                  ]
                }
              ),
              u.length === 0 && !t && /* @__PURE__ */ g.jsxs("div", { className: "px-4 py-8 text-center text-muted-foreground text-sm", children: [
                /* @__PURE__ */ g.jsx(Tk, { size: 32, className: "mx-auto mb-2 opacity-20" }),
                /* @__PURE__ */ g.jsx("p", { children: " (Cmd+K)" })
              ] })
            ] })
          ]
        }
      )
    }
  );
  return /* @__PURE__ */ g.jsxs(g.Fragment, { children: [
    /* @__PURE__ */ g.jsx(
      "button",
      {
        onClick: () => i(!0),
        className: "p-2 rounded-md hover:bg-accent hover:text-accent-foreground transition-colors text-muted-foreground",
        title: " (Cmd+K)",
        children: /* @__PURE__ */ g.jsx(Ls, { size: 20 })
      }
    ),
    r && EC.createPortal(x, document.body)
  ] });
}, mU = ({ className: e = "", size: t = 24 }) => /* @__PURE__ */ g.jsx(
  "svg",
  {
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 400 592",
    width: t,
    height: t,
    className: e,
    "aria-label": "Engram Icon",
    children: /* @__PURE__ */ g.jsx(
      "path",
      {
        fill: "currentColor",
        d: `M103.875908,522.166260 
                C75.225380,521.276611 55.289425,503.229828 52.249313,475.852142 
                C49.879883,454.514191 63.027035,433.000366 83.930901,424.858398 
                C88.449257,423.098541 89.857674,420.860199 89.801926,416.150269 
                C89.555420,395.322357 89.621246,374.489380 89.762306,353.659515 
                C89.787170,349.987000 88.728760,348.057556 85.120293,346.642609 
                C64.672897,338.625031 52.338894,320.951630 52.085896,299.869415 
                C51.832878,278.785156 63.730618,260.903198 84.118019,252.449951 
                C88.288918,250.720566 89.867378,248.680847 89.807304,244.052597 
                C89.539139,223.391968 89.589142,202.724701 89.796356,182.062561 
                C89.836380,178.071609 88.518524,176.326385 84.841705,174.787247 
                C57.730556,163.438416 45.530682,135.966721 55.436111,109.194000 
                C62.627293,89.757439 81.922821,76.710289 103.282494,76.841476 
                C124.355003,76.970901 143.082275,89.740875 149.993118,109.121849 
                C151.315979,112.831749 153.184799,113.869263 156.863403,113.853104 
                C186.192612,113.724319 215.522736,113.698357 244.851929,113.811600 
                C248.773117,113.826736 250.677307,112.652130 252.052902,108.765602 
                C259.013885,89.098465 278.589447,76.365829 300.503601,76.811897 
                C322.171844,77.252960 341.040283,91.132324 347.255371,111.201912 
                C356.569763,141.279358 340.344788,170.373184 309.893127,176.623123 
                C283.359375,182.068970 260.376740,167.450562 251.980011,145.670181 
                C250.492157,141.810806 248.818085,140.240295 244.552948,140.266785 
                C215.390915,140.447968 186.227219,140.357330 157.064072,140.375076 
                C154.628784,140.376556 151.855545,139.805771 151.141357,143.359161 
                C150.400787,147.043839 146.628937,150.064713 151.136917,154.478546 
                C184.592346,187.235229 217.778336,220.267349 250.982285,253.280014 
                C253.021469,255.307434 254.527191,255.254166 257.033264,254.047714 
                C276.199188,244.820953 294.752930,247.045853 310.978485,259.993408 
                C328.011017,273.584869 333.936798,292.106659 327.764038,313.282837 
                C321.779785,333.812378 307.254517,345.637268 286.367889,349.037231 
                C276.405396,350.658997 266.352570,349.443024 257.275055,344.363342 
                C254.265045,342.678986 252.301132,343.049744 249.903275,345.441406 
                C230.205368,365.088531 210.395386,384.623230 190.631638,404.204376 
                C177.732651,416.984222 164.859726,429.790344 151.962982,442.572388 
                C148.257980,446.244415 148.113403,452.901764 151.629196,456.671387 
                C152.707138,457.827148 154.029282,457.681976 155.328629,457.681946 
                C185.658203,457.681458 215.987854,457.631042 246.317261,457.695557 
                C249.355972,457.702026 250.687012,456.399414 251.717636,453.698944 
                C259.314423,433.793579 278.324493,420.868317 299.341309,421.146240 
                C320.526215,421.426361 339.575745,434.206421 346.686249,452.909271 
                C354.337341,473.034058 348.794159,495.642761 332.699371,509.956390 
                C307.061371,532.757202 263.380280,521.715210 251.978027,489.436371 
                C250.838303,486.209961 249.371201,484.953583 245.964813,484.962799 
                C216.302094,485.043304 186.639008,484.985840 156.976028,484.969330 
                C154.436981,484.967896 152.081528,484.923981 150.916916,488.054077 
                C142.892441,509.621246 126.842339,520.325989 103.875908,522.166260 
                M141.430466,266.110352 
                C145.394760,270.906738 148.503693,276.196198 150.388428,282.139069 
                C151.211502,284.734314 152.692291,285.770782 155.494156,285.760895 
                C179.139755,285.677429 202.787949,285.547394 226.430206,285.843811 
                C232.373352,285.918304 231.388184,281.058533 233.335602,278.254700 
                C235.007233,275.847992 233.916855,274.189880 232.000244,272.304352 
                C199.956863,240.780380 167.866821,209.301468 136.133682,177.467056 
                C131.183243,172.500824 127.483856,170.729507 121.013550,174.621368 
                C117.660522,176.638214 116.183739,178.155136 116.217278,182.042480 
                C116.398239,203.022598 116.444160,224.006012 116.243645,244.985474 
                C116.204666,249.064667 117.676285,250.918961 121.328865,252.228989 
                C128.972488,254.970444 135.505173,259.524170 141.430466,266.110352 
                M116.349434,377.499908 
                C116.351860,390.663696 116.870338,403.855377 116.161102,416.980713 
                C115.742699,424.723846 121.926743,423.801880 125.649162,426.262665 
                C129.080231,428.530792 130.798965,425.706268 132.741440,423.784821 
                C165.551407,391.329803 198.234940,358.745361 231.274231,326.525696 
                C235.764252,322.147095 232.377243,319.155212 231.599960,315.493317 
                C230.884583,312.123138 228.193359,312.382568 225.670288,312.382812 
                C202.675171,312.384949 179.679749,312.445435 156.685303,312.323212 
                C153.331955,312.305389 151.624329,313.386505 150.456299,316.584381 
                C145.119888,331.194611 135.004120,341.287384 120.496223,346.769958 
                C117.238434,348.001068 116.190170,349.706024 116.267418,353.006317 
                C116.450615,360.833862 116.340004,368.668243 116.349434,377.499908z`
      }
    )
  }
), pU = ({
  onToggleSidebar: e,
  isMobile: t,
  // Deprecated prop, handled by CSS
  onClose: n,
  onNavigate: r
}) => /* @__PURE__ */ g.jsxs("header", { className: "h-10 flex items-center justify-between px-4 bg-transparent z-50 transition-all duration-300 w-full flex-shrink-0", children: [
  /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-3 w-16 md:w-64", children: [
    /* @__PURE__ */ g.jsx(
      "button",
      {
        className: "p-2 -ml-2 rounded-md hover:bg-sidebar-accent hover:text-sidebar-accent-foreground transition-colors md:hidden",
        onClick: e,
        title: "",
        children: /* @__PURE__ */ g.jsx(mq, { size: 18 })
      }
    ),
    /* @__PURE__ */ g.jsxs("div", { className: "hidden md:flex items-center gap-2", children: [
      /* @__PURE__ */ g.jsx(mU, { size: 18, className: "text-primary" }),
      /* @__PURE__ */ g.jsx("span", { className: "font-semibold text-sidebar-foreground tracking-tight", children: "Engram" })
    ] })
  ] }),
  /* @__PURE__ */ g.jsx("div", { className: "flex-1" }),
  /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-1 md:gap-2", children: [
    /* @__PURE__ */ g.jsx(hU, { onNavigate: r }),
    /* @__PURE__ */ g.jsx("div", { className: "h-4 w-[1px] bg-border mx-1" }),
    /* @__PURE__ */ g.jsx(
      "button",
      {
        className: "p-2 rounded-md hover:bg-destructive hover:text-destructive-foreground transition-colors text-muted-foreground",
        onClick: n,
        title: "",
        children: /* @__PURE__ */ g.jsx(Lm, { size: 20 })
      }
    )
  ] })
] }), gU = ({ className: e = "", height: t = 24 }) => {
  const n = Math.round(t * 3.17);
  return /* @__PURE__ */ g.jsxs(
    "svg",
    {
      xmlns: "http://www.w3.org/2000/svg",
      viewBox: "235 175 555 175",
      width: n,
      height: t,
      className: e,
      "aria-label": "Engram",
      children: [
        /* @__PURE__ */ g.jsx("path", { fill: "currentColor", d: "M752.3,294.5c-0.2-11.8-0.3-23.1-0.4-34.4c0-2.7,0-5.3-0.2-8c-0.6-6.4-4.1-10.1-9.8-10.9 c-6.9-0.9-12.2,2-14.5,7.9c-1,2.5-1.2,5.2-1.2,7.9c0,11,-0.3,22,0,33c0.1,5.2-1.7,6.9-6.7,6.4c-3.3-0.3-6.7-0.3-10,0 c-4.9,0.5-5.9-1.9-5.8-6.2c0.2-11.8,0.2-23.7,0-35.5c-0.2-9.4-5.4-14.3-14.1-13.5c-6.4,0.6-11.1,5.7-11.3,13 c-0.3,11.7-0.2,23.3-0.3,35c0,7.1,0,7.1-7.3,7.1c-3.3,0-6.7-0.1-10,0c-3.3,0.1-4.9-1.1-4.9-4.6c0.1-21.5,0-43-0.1-64.5 c0-2.9,1.3-4.3,4.2-4.3c3.2,0,6.3-0.1,9.5,0.1c4,0,8.8-1,7.5,6.6c8.6-6.1,16.9-8.7,26.3-7c5.2,1,10.1,2.7,13.7,6.6 c2.8,2.9,4.6,2.4,7.4,0c6.8-5.8,15-7.9,23.8-6.9c16.3,1.8,25.1,11.7,25.8,29.5c0.5,13.3,0.1,26.6,0.2,40 c0,3.4-1.2,5.1-4.7,4.7C763.8,295.7,757.9,298,752.3,294.5z" }),
        /* @__PURE__ */ g.jsx("path", { fill: "currentColor", d: "M463.1,324.1c-10.8-0.7-20.9-2.4-30.2-7.5c-3.6-2-5-4-2.4-7.8c2.3-3.4,4.1-7.1,6.5-11.3 c6.1,3.6,11.8,6.8,18.5,7.7c5.3,0.7,10.6,1.1,15.8-0.5c8.3-2.6,12.2-9.1,10.9-18.6c-9.1,7.5-19.3,8.6-30.2,6.4 c-7.8-1.6-14.2-5.6-19.2-11.8c-10.5-12.8-10.6-32.5-0.5-45.5c11.2-14.3,28.6-16.4,50.9-6.1c-0.4-6.2,3.5-6.3,8.1-6.2 c13,0.2,13,0.1,13,13c0,16.3-0.5,32.7,0.1,49C505.4,309.3,491.3,322.1,467.6,324C466.2,324.1,464.9,324.1,463.1,324.1z M482.1,252.6 c-0.6-2.1-1.6-4-3-5.7c-4.6-6-13.5-8.4-21.2-5.5c-7.4,2.7-11.1,8.9-10.6,17.8c0.4,7.4,5.7,13.5,13.6,15.2 C474.1,277.2,485.2,266.4,482.1,252.6z" }),
        /* @__PURE__ */ g.jsx("path", { fill: "currentColor", d: "M258.1,201.6c20.3,0,40.1,0.1,60-0.1c4.5,0,6.3,1.3,6.1,5.9c-0.4,14.6,2.1,12.6-12.7,12.7 c-10.7,0.1-21.3,0.1-32-0.1c-3.8-0.1-5.2,1-5.3,5.1c0,13.4-0.2,13.4,13.4,13.4c8.7,0,17.3,0.1,26,0c3.4-0.1,4.7,1.2,4.7,4.7 c-0.2,16.4,1.9,13.7-13.1,13.9c-8.8,0.1-17.7,0.1-26.5,0c-3.2,0-4.6,1.1-4.4,4.4c0.2,3.8,0.2,7.7,0,11.5 c-0.2,3.5,1.1,4.7,4.6,4.7c13.7-0.1,27.3,0.2,41-0.1c5.1-0.1,6.6,1.5,6.5,6.5c-0.2,12.3,0,12.3-12.1,12.3 c-18.7-0.1-37.3-0.2-56,0c-4.9,0.1-6.7-1.2-6.7-6.4c0.2-27.5,0.2-55,0-82.5C251.6,203,253,200.9,258.1,201.6z" }),
        /* @__PURE__ */ g.jsx("path", { fill: "currentColor", d: "M599.5,239.6c-5.6,0.9-10.6,2.1-15,4.9c-2.5,1.6-4,0.9-5.1-1.6c-0.9-2-1.9-3.9-2.9-5.8 c-3.1-6.1-3-6.4,3-9.3c11.6-5.6,23.9-7.1,36.5-4.6c15.1,2.9,23.6,12.8,24.1,28.7c0.4,13.3,0.1,26.6,0.2,40 c0,3.5-1.5,4.8-4.8,4.6c-3,0-6,0-9,0.1c-4.2,0.2-8.1,0.2-6.6-6.6c-12.4,9.5-24.9,10.4-37.7,3.9c-8.5-4.3-11.9-12-11.3-21.2 c0.6-9.1,5.9-15,14.4-17.9c5.7-1.9,11.6-2.8,17.7-2.8c4.6,0,9.3,0.5,13.8-0.4c1.9-7.2-7.4-13.5-17.2-11.9 M617.7,271.9 c-0.1-2.5,1-5.8-3.3-5.8c-5,0-10-0.1-15,0.2c-4,0.3-6.9,2.4-7.1,6.9c-0.2,4.5,2.2,7.2,6.3,8.4C606.5,283.8,613.8,280.3,617.7,271.9z" }),
        /* @__PURE__ */ g.jsx("path", { fill: "currentColor", d: "M346.2,222.9c2.6,0,4.8,0.1,7,0c4.7-0.4,8.1,0.7,7,7.3c6-4,11.6-7.1,18.2-7.9c18.2-2.1,34.8,7.7,35,29.4 c0.1,13.2-0.1,26.3,0.1,39.5c0,3.9-1.2,5.5-5.2,5.2c-4,0-8,0-12,0.2c-3.5,0.2-4.7-1.3-4.7-4.7c0.1-10.3,0.1-20.7,0-31 c0-2.3-0.1-4.7-0.5-7c-1.3-8.4-5.4-12.3-12.9-12.6c-8.4-0.3-14.3,3.9-16,11.9c-2,9.6-0.7,19.3-0.9,28.9 c-0.2,14.4,0,14.4-14.4,14.4c-7.8,0-7.9,0-7.9-8c0-19.5,0-39,0-58.5C339,223.3,339.2,223.2,346.2,222.9z" }),
        /* @__PURE__ */ g.jsx("path", { fill: "currentColor", d: "M543.2,258.4c-0.1,11.1-0.3,21.8-0.2,32.4c0,4-1.2,5.9-5.4,5.6c-4.3-0.3-8.7-0.1-13-0.1 c-2.7,0-3.9-1.3-3.9-4c0-21.8,0-43.6,0-65.5c0-2.8,1.3-3.9,3.9-4c2.8,0,5.7,0,8.5-0.1c4.8-0.2,9.6-0.5,8.7,6.4 c2.1,0.8,2.8-0.7,3.9-1.3c2.3-1.2,4.5-2.8,7-3.8c11.8-4.7,14.3-3,14.3,9.3c0,0.8-0.1,1.7,0,2.5c0.6,4.6-1,6.4-6,6.5 C550,242.6,544.8,247.5,543.2,258.4z" })
      ]
    }
  );
}, yU = "0.9.6", BR = {
  version: yU
}, Xk = ({
  activeTab: e,
  onNavigate: t,
  isMobile: n,
  isOpen: r = !1,
  onClose: i,
  onShowUpdateNotice: s,
  hasUnreadUpdate: o
}) => {
  const u = (d) => {
    t(d), n && i && i();
  }, c = () => /* @__PURE__ */ g.jsxs("div", { className: "pt-4 border-t border-border/30 mt-2 space-y-2", children: [
    /* @__PURE__ */ g.jsxs(
      "button",
      {
        onClick: s,
        className: "w-full flex items-center gap-2 px-2 py-1.5 rounded-lg transition-all duration-200 text-muted-foreground hover:text-foreground hover:bg-muted/10 text-left",
        children: [
          /* @__PURE__ */ g.jsxs("div", { className: "relative", children: [
            /* @__PURE__ */ g.jsx(lB, { size: 16, strokeWidth: 1.5 }),
            o && /* @__PURE__ */ g.jsx("span", { className: "absolute -top-1 -right-1 w-2 h-2 bg-red-500 rounded-full animate-pulse" })
          ] }),
          /* @__PURE__ */ g.jsx("span", { className: "text-xs", children: "" }),
          o && /* @__PURE__ */ g.jsx("span", { className: "ml-auto text-[10px] px-1.5 py-0.5 bg-primary/20 text-primary rounded-full", children: "NEW" })
        ]
      }
    ),
    /* @__PURE__ */ g.jsxs(
      "a",
      {
        href: "https://github.com/shiyue137mh-netizen/Engram",
        target: "_blank",
        rel: "noopener noreferrer",
        className: "group w-full flex items-center gap-2 px-2 py-1.5 rounded-lg transition-all duration-200 text-muted-foreground hover:text-foreground hover:bg-muted/10",
        title: "",
        children: [
          /* @__PURE__ */ g.jsx(YB, { size: 16, strokeWidth: 1.5, className: "group-hover:text-primary transition-colors" }),
          /* @__PURE__ */ g.jsx("span", { className: "text-xs", children: "GitHub" }),
          /* @__PURE__ */ g.jsx("span", { className: "ml-auto text-[10px] text-primary opacity-0 group-hover:opacity-100 transition-opacity", children: "Star " })
        ]
      }
    ),
    /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-2 px-2 py-1 opacity-50", children: [
      /* @__PURE__ */ g.jsx(gU, { height: 12 }),
      /* @__PURE__ */ g.jsxs("span", { className: "text-[10px] text-muted-foreground font-mono", children: [
        "v",
        BR.version
      ] })
    ] })
  ] });
  return n && !r ? null : n ? /* @__PURE__ */ g.jsxs(
    "div",
    {
      className: "fixed inset-0 z-[60] flex justify-start",
      style: { height: "100dvh", width: "100vw" },
      children: [
        /* @__PURE__ */ g.jsx(
          "div",
          {
            className: "absolute inset-0 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",
            onClick: i
          }
        ),
        /* @__PURE__ */ g.jsxs(
          "div",
          {
            id: "mobile-menu-drawer",
            className: "relative w-64 max-w-[80vw] h-full bg-sidebar border-r border-border shadow-2xl flex flex-col p-6 animate-in slide-in-from-left duration-300",
            style: { height: "100dvh" },
            children: [
              /* @__PURE__ */ g.jsxs("div", { className: "flex justify-between items-center mb-8", children: [
                /* @__PURE__ */ g.jsx("span", { className: "text-lg font-semibold text-sidebar-foreground/80", children: "" }),
                /* @__PURE__ */ g.jsx(
                  "button",
                  {
                    onClick: i,
                    className: "p-2 -mr-2 rounded-md hover:bg-sidebar-accent text-muted-foreground hover:text-sidebar-accent-foreground transition-colors",
                    children: /* @__PURE__ */ g.jsx(Lm, { size: 20 })
                  }
                )
              ] }),
              /* @__PURE__ */ g.jsx("nav", { className: "space-y-2 flex-1 overflow-y-auto", children: xv.map((d) => {
                const m = d.icon, p = e === d.id;
                return /* @__PURE__ */ g.jsxs(
                  "button",
                  {
                    onClick: () => u(d.id),
                    className: `
                                    w-full flex items-center gap-4 px-4 py-3 rounded-xl text-left transition-all duration-200
                                    ${p ? "bg-primary/10 text-primary font-medium" : "text-muted-foreground hover:bg-sidebar-accent hover:text-sidebar-foreground"}
                                `,
                    children: [
                      /* @__PURE__ */ g.jsx(m, { size: 22, className: p ? "text-primary" : "text-muted-foreground/70" }),
                      /* @__PURE__ */ g.jsx("span", { children: d.label })
                    ]
                  },
                  d.id
                );
              }) }),
              /* @__PURE__ */ g.jsx("div", { className: "mt-auto", children: /* @__PURE__ */ g.jsx(c, {}) })
            ]
          }
        )
      ]
    }
  ) : /* @__PURE__ */ g.jsxs("aside", { className: "[display:none] md:flex w-36 flex-shrink-0 bg-sidebar flex-col z-40 pt-4 px-2 border-r border-border/50 animate-in slide-in-from-left-4 fade-in duration-500 fill-mode-both", style: { animationDelay: "100ms", animationFillMode: "both" }, children: [
    /* @__PURE__ */ g.jsx("nav", { className: "flex-1 w-full flex flex-col gap-1 overflow-y-auto no-scrollbar", children: xv.map((d) => {
      const m = d.icon, p = e === d.id;
      return /* @__PURE__ */ g.jsxs(
        "button",
        {
          onClick: () => u(d.id),
          className: `
                                    w-full flex items-center gap-2 px-2 py-2 rounded-lg transition-all duration-200 text-left
                                    ${p ? "bg-primary/10 text-primary" : "text-muted-foreground hover:text-foreground hover:bg-muted/10"}
                                `,
          children: [
            /* @__PURE__ */ g.jsx(m, { size: 18, strokeWidth: p ? 2 : 1.5, className: "flex-shrink-0" }),
            /* @__PURE__ */ g.jsx("span", { className: `text-xs ${p ? "font-medium" : "font-normal"}`, children: d.label })
          ]
        },
        d.id
      );
    }) }),
    /* @__PURE__ */ g.jsx("div", { className: "pb-3", children: /* @__PURE__ */ g.jsx(c, {}) })
  ] });
}, I1 = {
  timeOut: 5e3,
  extendedTimeOut: 1e3,
  closeButton: !0,
  progressBar: !0
}, pd = class pd {
  constructor() {
  }
  static getInstance() {
    return pd.instance || (pd.instance = new pd()), pd.instance;
  }
  /**
   *  toastr 
   */
  getToastr() {
    return window.toastr || null;
  }
  /**
   * 
   */
  success(t, n = "Engram", r = {}) {
    const i = this.getToastr();
    i ? i.success(t, n, { ...I1, ...r }) : console.log(`[Engram] SUCCESS: ${n} - ${t}`), ve.info("Notification", `Success: ${t}`);
  }
  /**
   * 
   */
  info(t, n = "Engram", r = {}) {
    const i = this.getToastr();
    i ? i.info(t, n, { ...I1, ...r }) : console.log(`[Engram] INFO: ${n} - ${t}`), ve.info("Notification", `Info: ${t}`);
  }
  /**
   * 
   */
  warning(t, n = "Engram", r = {}) {
    const i = this.getToastr();
    i ? i.warning(t, n, { ...I1, ...r }) : console.warn(`[Engram] WARNING: ${n} - ${t}`), ve.warn("Notification", `Warning: ${t}`);
  }
  /**
   * 
   */
  error(t, n = "Engram", r = {}) {
    const i = this.getToastr();
    i ? i.error(t, n, { ...I1, timeOut: 8e3, ...r }) : console.error(`[Engram] ERROR: ${n} - ${t}`), ve.error("Notification", `Error: ${t}`);
  }
  /**
   * 
   * @param message 
   * @param title 
   * @param onCancel 
   * @returns toastr 
   */
  running(t, n = "Engram", r) {
    const i = this.getToastr();
    if (i) {
      const s = r ? `${t} <small style="opacity:0.7">()</small>` : t;
      return i.info(s, n, {
        timeOut: 2e4,
        //  20 
        extendedTimeOut: 0,
        // 
        closeButton: !1,
        // 
        progressBar: !0,
        // 
        tapToDismiss: !!r,
        // 
        onclick: r ? () => {
          ve.info("Notification", ""), r();
        } : void 0,
        escapeHtml: !1
        //  HTML
      });
    } else
      return console.log(`[Engram] RUNNING: ${n} - ${t}`), null;
  }
  /**
   *  toastr 
   */
  remove(t) {
    const n = this.getToastr();
    n && t && n.remove(t);
  }
  /**
   * 
   */
  clear() {
    const t = this.getToastr();
    t && t.clear();
  }
};
vt(pd, "instance");
let d5 = pd;
const tn = d5.getInstance(), rm = {
  owner: "shiyue137mh-netizen",
  repo: "Engram",
  branch: "master"
}, P1 = BR.version;
let Tg = null, Ng = null;
function Vb(e, t) {
  const n = e.split(".").map(Number), r = t.split(".").map(Number);
  for (let i = 0; i < Math.max(n.length, r.length); i++) {
    const s = n[i] || 0, o = r[i] || 0;
    if (s > o) return 1;
    if (s < o) return -1;
  }
  return 0;
}
class Dc {
  /**
   * 
   */
  static getCurrentVersion() {
    return P1;
  }
  /**
   *  GitHub 
   */
  static async getLatestVersion() {
    if (Tg)
      return Tg;
    try {
      const t = `https://raw.githubusercontent.com/${rm.owner}/${rm.repo}/${rm.branch}/manifest.json`, n = await fetch(t);
      return n.ok ? (Tg = (await n.json()).version || null, Tg) : null;
    } catch {
      return null;
    }
  }
  /**
   * 
   */
  static async hasUpdate() {
    const t = await this.getLatestVersion();
    return t ? Vb(t, P1) > 0 : !1;
  }
  /**
   * 
   */
  static async getChangelog() {
    if (Ng)
      return Ng;
    try {
      const t = `https://raw.githubusercontent.com/${rm.owner}/${rm.repo}/${rm.branch}/CHANGELOG.md`, n = await fetch(t);
      return n.ok ? (Ng = await n.text(), Ng) : (console.warn("[Engram] UpdateService: ", n.status), tn.warning(`: ${n.status}`, ""), null);
    } catch (t) {
      return console.error("[Engram] UpdateService: ", t), tn.error("", ""), null;
    }
  }
  /**
   * 
   */
  static getReadVersion() {
    try {
      return rt.get("lastReadVersion") || "0.0.0";
    } catch {
      return "0.0.0";
    }
  }
  /**
   * 
   */
  static async markAsRead(t) {
    const n = t || await this.getLatestVersion() || P1;
    try {
      rt.set("lastReadVersion", n), console.debug("[Engram] UpdateService: ", n);
    } catch (r) {
      console.error("[Engram] UpdateService: ", r);
    }
  }
  /**
   * 
   */
  static async hasUnreadUpdate() {
    const t = await this.getLatestVersion();
    if (!t || Vb(t, P1) <= 0)
      return !1;
    const n = this.getReadVersion();
    return Vb(t, n) > 0;
  }
  /**
   * 
   */
  static clearCache() {
    Tg = null, Ng = null;
  }
}
function vU(e, t) {
  const n = {};
  return (e[e.length - 1] === "" ? [...e, ""] : e).join(
    (n.padRight ? " " : "") + "," + (n.padLeft === !1 ? "" : " ")
  ).trim();
}
const xU = /^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u, bU = /^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u, wU = {};
function Qk(e, t) {
  return (wU.jsx ? bU : xU).test(e);
}
const _U = /[ \t\n\f\r]/g;
function SU(e) {
  return typeof e == "object" ? e.type === "text" ? Zk(e.value) : !1 : Zk(e);
}
function Zk(e) {
  return e.replace(_U, "") === "";
}
class M0 {
  /**
   * @param {SchemaType['property']} property
   *   Property.
   * @param {SchemaType['normal']} normal
   *   Normal.
   * @param {Space | undefined} [space]
   *   Space.
   * @returns
   *   Schema.
   */
  constructor(t, n, r) {
    this.normal = n, this.property = t, r && (this.space = r);
  }
}
M0.prototype.normal = {};
M0.prototype.property = {};
M0.prototype.space = void 0;
function qR(e, t) {
  const n = {}, r = {};
  for (const i of e)
    Object.assign(n, i.property), Object.assign(r, i.normal);
  return new M0(n, r, t);
}
function h5(e) {
  return e.toLowerCase();
}
class $a {
  /**
   * @param {string} property
   *   Property.
   * @param {string} attribute
   *   Attribute.
   * @returns
   *   Info.
   */
  constructor(t, n) {
    this.attribute = n, this.property = t;
  }
}
$a.prototype.attribute = "";
$a.prototype.booleanish = !1;
$a.prototype.boolean = !1;
$a.prototype.commaOrSpaceSeparated = !1;
$a.prototype.commaSeparated = !1;
$a.prototype.defined = !1;
$a.prototype.mustUseProperty = !1;
$a.prototype.number = !1;
$a.prototype.overloadedBoolean = !1;
$a.prototype.property = "";
$a.prototype.spaceSeparated = !1;
$a.prototype.space = void 0;
let CU = 0;
const $t = Bd(), Ir = Bd(), m5 = Bd(), at = Bd(), Kn = Bd(), _m = Bd(), ds = Bd();
function Bd() {
  return 2 ** ++CU;
}
const p5 = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  boolean: $t,
  booleanish: Ir,
  commaOrSpaceSeparated: ds,
  commaSeparated: _m,
  number: at,
  overloadedBoolean: m5,
  spaceSeparated: Kn
}, Symbol.toStringTag, { value: "Module" })), Hb = (
  /** @type {ReadonlyArray<keyof typeof types>} */
  Object.keys(p5)
);
class OC extends $a {
  /**
   * @constructor
   * @param {string} property
   *   Property.
   * @param {string} attribute
   *   Attribute.
   * @param {number | null | undefined} [mask]
   *   Mask.
   * @param {Space | undefined} [space]
   *   Space.
   * @returns
   *   Info.
   */
  constructor(t, n, r, i) {
    let s = -1;
    if (super(t, n), Jk(this, "space", i), typeof r == "number")
      for (; ++s < Hb.length; ) {
        const o = Hb[s];
        Jk(this, Hb[s], (r & p5[o]) === p5[o]);
      }
  }
}
OC.prototype.defined = !0;
function Jk(e, t, n) {
  n && (e[t] = n);
}
function Bm(e) {
  const t = {}, n = {};
  for (const [r, i] of Object.entries(e.properties)) {
    const s = new OC(
      r,
      e.transform(e.attributes || {}, r),
      i,
      e.space
    );
    e.mustUseProperty && e.mustUseProperty.includes(r) && (s.mustUseProperty = !0), t[r] = s, n[h5(r)] = r, n[h5(s.attribute)] = r;
  }
  return new M0(t, n, e.space);
}
const FR = Bm({
  properties: {
    ariaActiveDescendant: null,
    ariaAtomic: Ir,
    ariaAutoComplete: null,
    ariaBusy: Ir,
    ariaChecked: Ir,
    ariaColCount: at,
    ariaColIndex: at,
    ariaColSpan: at,
    ariaControls: Kn,
    ariaCurrent: null,
    ariaDescribedBy: Kn,
    ariaDetails: null,
    ariaDisabled: Ir,
    ariaDropEffect: Kn,
    ariaErrorMessage: null,
    ariaExpanded: Ir,
    ariaFlowTo: Kn,
    ariaGrabbed: Ir,
    ariaHasPopup: null,
    ariaHidden: Ir,
    ariaInvalid: null,
    ariaKeyShortcuts: null,
    ariaLabel: null,
    ariaLabelledBy: Kn,
    ariaLevel: at,
    ariaLive: null,
    ariaModal: Ir,
    ariaMultiLine: Ir,
    ariaMultiSelectable: Ir,
    ariaOrientation: null,
    ariaOwns: Kn,
    ariaPlaceholder: null,
    ariaPosInSet: at,
    ariaPressed: Ir,
    ariaReadOnly: Ir,
    ariaRelevant: null,
    ariaRequired: Ir,
    ariaRoleDescription: Kn,
    ariaRowCount: at,
    ariaRowIndex: at,
    ariaRowSpan: at,
    ariaSelected: Ir,
    ariaSetSize: at,
    ariaSort: null,
    ariaValueMax: at,
    ariaValueMin: at,
    ariaValueNow: at,
    ariaValueText: null,
    role: null
  },
  transform(e, t) {
    return t === "role" ? t : "aria-" + t.slice(4).toLowerCase();
  }
});
function UR(e, t) {
  return t in e ? e[t] : t;
}
function $R(e, t) {
  return UR(e, t.toLowerCase());
}
const EU = Bm({
  attributes: {
    acceptcharset: "accept-charset",
    classname: "class",
    htmlfor: "for",
    httpequiv: "http-equiv"
  },
  mustUseProperty: ["checked", "multiple", "muted", "selected"],
  properties: {
    // Standard Properties.
    abbr: null,
    accept: _m,
    acceptCharset: Kn,
    accessKey: Kn,
    action: null,
    allow: null,
    allowFullScreen: $t,
    allowPaymentRequest: $t,
    allowUserMedia: $t,
    alt: null,
    as: null,
    async: $t,
    autoCapitalize: null,
    autoComplete: Kn,
    autoFocus: $t,
    autoPlay: $t,
    blocking: Kn,
    capture: null,
    charSet: null,
    checked: $t,
    cite: null,
    className: Kn,
    cols: at,
    colSpan: null,
    content: null,
    contentEditable: Ir,
    controls: $t,
    controlsList: Kn,
    coords: at | _m,
    crossOrigin: null,
    data: null,
    dateTime: null,
    decoding: null,
    default: $t,
    defer: $t,
    dir: null,
    dirName: null,
    disabled: $t,
    download: m5,
    draggable: Ir,
    encType: null,
    enterKeyHint: null,
    fetchPriority: null,
    form: null,
    formAction: null,
    formEncType: null,
    formMethod: null,
    formNoValidate: $t,
    formTarget: null,
    headers: Kn,
    height: at,
    hidden: m5,
    high: at,
    href: null,
    hrefLang: null,
    htmlFor: Kn,
    httpEquiv: Kn,
    id: null,
    imageSizes: null,
    imageSrcSet: null,
    inert: $t,
    inputMode: null,
    integrity: null,
    is: null,
    isMap: $t,
    itemId: null,
    itemProp: Kn,
    itemRef: Kn,
    itemScope: $t,
    itemType: Kn,
    kind: null,
    label: null,
    lang: null,
    language: null,
    list: null,
    loading: null,
    loop: $t,
    low: at,
    manifest: null,
    max: null,
    maxLength: at,
    media: null,
    method: null,
    min: null,
    minLength: at,
    multiple: $t,
    muted: $t,
    name: null,
    nonce: null,
    noModule: $t,
    noValidate: $t,
    onAbort: null,
    onAfterPrint: null,
    onAuxClick: null,
    onBeforeMatch: null,
    onBeforePrint: null,
    onBeforeToggle: null,
    onBeforeUnload: null,
    onBlur: null,
    onCancel: null,
    onCanPlay: null,
    onCanPlayThrough: null,
    onChange: null,
    onClick: null,
    onClose: null,
    onContextLost: null,
    onContextMenu: null,
    onContextRestored: null,
    onCopy: null,
    onCueChange: null,
    onCut: null,
    onDblClick: null,
    onDrag: null,
    onDragEnd: null,
    onDragEnter: null,
    onDragExit: null,
    onDragLeave: null,
    onDragOver: null,
    onDragStart: null,
    onDrop: null,
    onDurationChange: null,
    onEmptied: null,
    onEnded: null,
    onError: null,
    onFocus: null,
    onFormData: null,
    onHashChange: null,
    onInput: null,
    onInvalid: null,
    onKeyDown: null,
    onKeyPress: null,
    onKeyUp: null,
    onLanguageChange: null,
    onLoad: null,
    onLoadedData: null,
    onLoadedMetadata: null,
    onLoadEnd: null,
    onLoadStart: null,
    onMessage: null,
    onMessageError: null,
    onMouseDown: null,
    onMouseEnter: null,
    onMouseLeave: null,
    onMouseMove: null,
    onMouseOut: null,
    onMouseOver: null,
    onMouseUp: null,
    onOffline: null,
    onOnline: null,
    onPageHide: null,
    onPageShow: null,
    onPaste: null,
    onPause: null,
    onPlay: null,
    onPlaying: null,
    onPopState: null,
    onProgress: null,
    onRateChange: null,
    onRejectionHandled: null,
    onReset: null,
    onResize: null,
    onScroll: null,
    onScrollEnd: null,
    onSecurityPolicyViolation: null,
    onSeeked: null,
    onSeeking: null,
    onSelect: null,
    onSlotChange: null,
    onStalled: null,
    onStorage: null,
    onSubmit: null,
    onSuspend: null,
    onTimeUpdate: null,
    onToggle: null,
    onUnhandledRejection: null,
    onUnload: null,
    onVolumeChange: null,
    onWaiting: null,
    onWheel: null,
    open: $t,
    optimum: at,
    pattern: null,
    ping: Kn,
    placeholder: null,
    playsInline: $t,
    popover: null,
    popoverTarget: null,
    popoverTargetAction: null,
    poster: null,
    preload: null,
    readOnly: $t,
    referrerPolicy: null,
    rel: Kn,
    required: $t,
    reversed: $t,
    rows: at,
    rowSpan: at,
    sandbox: Kn,
    scope: null,
    scoped: $t,
    seamless: $t,
    selected: $t,
    shadowRootClonable: $t,
    shadowRootDelegatesFocus: $t,
    shadowRootMode: null,
    shape: null,
    size: at,
    sizes: null,
    slot: null,
    span: at,
    spellCheck: Ir,
    src: null,
    srcDoc: null,
    srcLang: null,
    srcSet: null,
    start: at,
    step: null,
    style: null,
    tabIndex: at,
    target: null,
    title: null,
    translate: null,
    type: null,
    typeMustMatch: $t,
    useMap: null,
    value: Ir,
    width: at,
    wrap: null,
    writingSuggestions: null,
    // Legacy.
    // See: https://html.spec.whatwg.org/#other-elements,-attributes-and-apis
    align: null,
    // Several. Use CSS `text-align` instead,
    aLink: null,
    // `<body>`. Use CSS `a:active {color}` instead
    archive: Kn,
    // `<object>`. List of URIs to archives
    axis: null,
    // `<td>` and `<th>`. Use `scope` on `<th>`
    background: null,
    // `<body>`. Use CSS `background-image` instead
    bgColor: null,
    // `<body>` and table elements. Use CSS `background-color` instead
    border: at,
    // `<table>`. Use CSS `border-width` instead,
    borderColor: null,
    // `<table>`. Use CSS `border-color` instead,
    bottomMargin: at,
    // `<body>`
    cellPadding: null,
    // `<table>`
    cellSpacing: null,
    // `<table>`
    char: null,
    // Several table elements. When `align=char`, sets the character to align on
    charOff: null,
    // Several table elements. When `char`, offsets the alignment
    classId: null,
    // `<object>`
    clear: null,
    // `<br>`. Use CSS `clear` instead
    code: null,
    // `<object>`
    codeBase: null,
    // `<object>`
    codeType: null,
    // `<object>`
    color: null,
    // `<font>` and `<hr>`. Use CSS instead
    compact: $t,
    // Lists. Use CSS to reduce space between items instead
    declare: $t,
    // `<object>`
    event: null,
    // `<script>`
    face: null,
    // `<font>`. Use CSS instead
    frame: null,
    // `<table>`
    frameBorder: null,
    // `<iframe>`. Use CSS `border` instead
    hSpace: at,
    // `<img>` and `<object>`
    leftMargin: at,
    // `<body>`
    link: null,
    // `<body>`. Use CSS `a:link {color: *}` instead
    longDesc: null,
    // `<frame>`, `<iframe>`, and `<img>`. Use an `<a>`
    lowSrc: null,
    // `<img>`. Use a `<picture>`
    marginHeight: at,
    // `<body>`
    marginWidth: at,
    // `<body>`
    noResize: $t,
    // `<frame>`
    noHref: $t,
    // `<area>`. Use no href instead of an explicit `nohref`
    noShade: $t,
    // `<hr>`. Use background-color and height instead of borders
    noWrap: $t,
    // `<td>` and `<th>`
    object: null,
    // `<applet>`
    profile: null,
    // `<head>`
    prompt: null,
    // `<isindex>`
    rev: null,
    // `<link>`
    rightMargin: at,
    // `<body>`
    rules: null,
    // `<table>`
    scheme: null,
    // `<meta>`
    scrolling: Ir,
    // `<frame>`. Use overflow in the child context
    standby: null,
    // `<object>`
    summary: null,
    // `<table>`
    text: null,
    // `<body>`. Use CSS `color` instead
    topMargin: at,
    // `<body>`
    valueType: null,
    // `<param>`
    version: null,
    // `<html>`. Use a doctype.
    vAlign: null,
    // Several. Use CSS `vertical-align` instead
    vLink: null,
    // `<body>`. Use CSS `a:visited {color}` instead
    vSpace: at,
    // `<img>` and `<object>`
    // Non-standard Properties.
    allowTransparency: null,
    autoCorrect: null,
    autoSave: null,
    disablePictureInPicture: $t,
    disableRemotePlayback: $t,
    prefix: null,
    property: null,
    results: at,
    security: null,
    unselectable: null
  },
  space: "html",
  transform: $R
}), kU = Bm({
  attributes: {
    accentHeight: "accent-height",
    alignmentBaseline: "alignment-baseline",
    arabicForm: "arabic-form",
    baselineShift: "baseline-shift",
    capHeight: "cap-height",
    className: "class",
    clipPath: "clip-path",
    clipRule: "clip-rule",
    colorInterpolation: "color-interpolation",
    colorInterpolationFilters: "color-interpolation-filters",
    colorProfile: "color-profile",
    colorRendering: "color-rendering",
    crossOrigin: "crossorigin",
    dataType: "datatype",
    dominantBaseline: "dominant-baseline",
    enableBackground: "enable-background",
    fillOpacity: "fill-opacity",
    fillRule: "fill-rule",
    floodColor: "flood-color",
    floodOpacity: "flood-opacity",
    fontFamily: "font-family",
    fontSize: "font-size",
    fontSizeAdjust: "font-size-adjust",
    fontStretch: "font-stretch",
    fontStyle: "font-style",
    fontVariant: "font-variant",
    fontWeight: "font-weight",
    glyphName: "glyph-name",
    glyphOrientationHorizontal: "glyph-orientation-horizontal",
    glyphOrientationVertical: "glyph-orientation-vertical",
    hrefLang: "hreflang",
    horizAdvX: "horiz-adv-x",
    horizOriginX: "horiz-origin-x",
    horizOriginY: "horiz-origin-y",
    imageRendering: "image-rendering",
    letterSpacing: "letter-spacing",
    lightingColor: "lighting-color",
    markerEnd: "marker-end",
    markerMid: "marker-mid",
    markerStart: "marker-start",
    navDown: "nav-down",
    navDownLeft: "nav-down-left",
    navDownRight: "nav-down-right",
    navLeft: "nav-left",
    navNext: "nav-next",
    navPrev: "nav-prev",
    navRight: "nav-right",
    navUp: "nav-up",
    navUpLeft: "nav-up-left",
    navUpRight: "nav-up-right",
    onAbort: "onabort",
    onActivate: "onactivate",
    onAfterPrint: "onafterprint",
    onBeforePrint: "onbeforeprint",
    onBegin: "onbegin",
    onCancel: "oncancel",
    onCanPlay: "oncanplay",
    onCanPlayThrough: "oncanplaythrough",
    onChange: "onchange",
    onClick: "onclick",
    onClose: "onclose",
    onCopy: "oncopy",
    onCueChange: "oncuechange",
    onCut: "oncut",
    onDblClick: "ondblclick",
    onDrag: "ondrag",
    onDragEnd: "ondragend",
    onDragEnter: "ondragenter",
    onDragExit: "ondragexit",
    onDragLeave: "ondragleave",
    onDragOver: "ondragover",
    onDragStart: "ondragstart",
    onDrop: "ondrop",
    onDurationChange: "ondurationchange",
    onEmptied: "onemptied",
    onEnd: "onend",
    onEnded: "onended",
    onError: "onerror",
    onFocus: "onfocus",
    onFocusIn: "onfocusin",
    onFocusOut: "onfocusout",
    onHashChange: "onhashchange",
    onInput: "oninput",
    onInvalid: "oninvalid",
    onKeyDown: "onkeydown",
    onKeyPress: "onkeypress",
    onKeyUp: "onkeyup",
    onLoad: "onload",
    onLoadedData: "onloadeddata",
    onLoadedMetadata: "onloadedmetadata",
    onLoadStart: "onloadstart",
    onMessage: "onmessage",
    onMouseDown: "onmousedown",
    onMouseEnter: "onmouseenter",
    onMouseLeave: "onmouseleave",
    onMouseMove: "onmousemove",
    onMouseOut: "onmouseout",
    onMouseOver: "onmouseover",
    onMouseUp: "onmouseup",
    onMouseWheel: "onmousewheel",
    onOffline: "onoffline",
    onOnline: "ononline",
    onPageHide: "onpagehide",
    onPageShow: "onpageshow",
    onPaste: "onpaste",
    onPause: "onpause",
    onPlay: "onplay",
    onPlaying: "onplaying",
    onPopState: "onpopstate",
    onProgress: "onprogress",
    onRateChange: "onratechange",
    onRepeat: "onrepeat",
    onReset: "onreset",
    onResize: "onresize",
    onScroll: "onscroll",
    onSeeked: "onseeked",
    onSeeking: "onseeking",
    onSelect: "onselect",
    onShow: "onshow",
    onStalled: "onstalled",
    onStorage: "onstorage",
    onSubmit: "onsubmit",
    onSuspend: "onsuspend",
    onTimeUpdate: "ontimeupdate",
    onToggle: "ontoggle",
    onUnload: "onunload",
    onVolumeChange: "onvolumechange",
    onWaiting: "onwaiting",
    onZoom: "onzoom",
    overlinePosition: "overline-position",
    overlineThickness: "overline-thickness",
    paintOrder: "paint-order",
    panose1: "panose-1",
    pointerEvents: "pointer-events",
    referrerPolicy: "referrerpolicy",
    renderingIntent: "rendering-intent",
    shapeRendering: "shape-rendering",
    stopColor: "stop-color",
    stopOpacity: "stop-opacity",
    strikethroughPosition: "strikethrough-position",
    strikethroughThickness: "strikethrough-thickness",
    strokeDashArray: "stroke-dasharray",
    strokeDashOffset: "stroke-dashoffset",
    strokeLineCap: "stroke-linecap",
    strokeLineJoin: "stroke-linejoin",
    strokeMiterLimit: "stroke-miterlimit",
    strokeOpacity: "stroke-opacity",
    strokeWidth: "stroke-width",
    tabIndex: "tabindex",
    textAnchor: "text-anchor",
    textDecoration: "text-decoration",
    textRendering: "text-rendering",
    transformOrigin: "transform-origin",
    typeOf: "typeof",
    underlinePosition: "underline-position",
    underlineThickness: "underline-thickness",
    unicodeBidi: "unicode-bidi",
    unicodeRange: "unicode-range",
    unitsPerEm: "units-per-em",
    vAlphabetic: "v-alphabetic",
    vHanging: "v-hanging",
    vIdeographic: "v-ideographic",
    vMathematical: "v-mathematical",
    vectorEffect: "vector-effect",
    vertAdvY: "vert-adv-y",
    vertOriginX: "vert-origin-x",
    vertOriginY: "vert-origin-y",
    wordSpacing: "word-spacing",
    writingMode: "writing-mode",
    xHeight: "x-height",
    // These were camelcased in Tiny. Now lowercased in SVG 2
    playbackOrder: "playbackorder",
    timelineBegin: "timelinebegin"
  },
  properties: {
    about: ds,
    accentHeight: at,
    accumulate: null,
    additive: null,
    alignmentBaseline: null,
    alphabetic: at,
    amplitude: at,
    arabicForm: null,
    ascent: at,
    attributeName: null,
    attributeType: null,
    azimuth: at,
    bandwidth: null,
    baselineShift: null,
    baseFrequency: null,
    baseProfile: null,
    bbox: null,
    begin: null,
    bias: at,
    by: null,
    calcMode: null,
    capHeight: at,
    className: Kn,
    clip: null,
    clipPath: null,
    clipPathUnits: null,
    clipRule: null,
    color: null,
    colorInterpolation: null,
    colorInterpolationFilters: null,
    colorProfile: null,
    colorRendering: null,
    content: null,
    contentScriptType: null,
    contentStyleType: null,
    crossOrigin: null,
    cursor: null,
    cx: null,
    cy: null,
    d: null,
    dataType: null,
    defaultAction: null,
    descent: at,
    diffuseConstant: at,
    direction: null,
    display: null,
    dur: null,
    divisor: at,
    dominantBaseline: null,
    download: $t,
    dx: null,
    dy: null,
    edgeMode: null,
    editable: null,
    elevation: at,
    enableBackground: null,
    end: null,
    event: null,
    exponent: at,
    externalResourcesRequired: null,
    fill: null,
    fillOpacity: at,
    fillRule: null,
    filter: null,
    filterRes: null,
    filterUnits: null,
    floodColor: null,
    floodOpacity: null,
    focusable: null,
    focusHighlight: null,
    fontFamily: null,
    fontSize: null,
    fontSizeAdjust: null,
    fontStretch: null,
    fontStyle: null,
    fontVariant: null,
    fontWeight: null,
    format: null,
    fr: null,
    from: null,
    fx: null,
    fy: null,
    g1: _m,
    g2: _m,
    glyphName: _m,
    glyphOrientationHorizontal: null,
    glyphOrientationVertical: null,
    glyphRef: null,
    gradientTransform: null,
    gradientUnits: null,
    handler: null,
    hanging: at,
    hatchContentUnits: null,
    hatchUnits: null,
    height: null,
    href: null,
    hrefLang: null,
    horizAdvX: at,
    horizOriginX: at,
    horizOriginY: at,
    id: null,
    ideographic: at,
    imageRendering: null,
    initialVisibility: null,
    in: null,
    in2: null,
    intercept: at,
    k: at,
    k1: at,
    k2: at,
    k3: at,
    k4: at,
    kernelMatrix: ds,
    kernelUnitLength: null,
    keyPoints: null,
    // SEMI_COLON_SEPARATED
    keySplines: null,
    // SEMI_COLON_SEPARATED
    keyTimes: null,
    // SEMI_COLON_SEPARATED
    kerning: null,
    lang: null,
    lengthAdjust: null,
    letterSpacing: null,
    lightingColor: null,
    limitingConeAngle: at,
    local: null,
    markerEnd: null,
    markerMid: null,
    markerStart: null,
    markerHeight: null,
    markerUnits: null,
    markerWidth: null,
    mask: null,
    maskContentUnits: null,
    maskUnits: null,
    mathematical: null,
    max: null,
    media: null,
    mediaCharacterEncoding: null,
    mediaContentEncodings: null,
    mediaSize: at,
    mediaTime: null,
    method: null,
    min: null,
    mode: null,
    name: null,
    navDown: null,
    navDownLeft: null,
    navDownRight: null,
    navLeft: null,
    navNext: null,
    navPrev: null,
    navRight: null,
    navUp: null,
    navUpLeft: null,
    navUpRight: null,
    numOctaves: null,
    observer: null,
    offset: null,
    onAbort: null,
    onActivate: null,
    onAfterPrint: null,
    onBeforePrint: null,
    onBegin: null,
    onCancel: null,
    onCanPlay: null,
    onCanPlayThrough: null,
    onChange: null,
    onClick: null,
    onClose: null,
    onCopy: null,
    onCueChange: null,
    onCut: null,
    onDblClick: null,
    onDrag: null,
    onDragEnd: null,
    onDragEnter: null,
    onDragExit: null,
    onDragLeave: null,
    onDragOver: null,
    onDragStart: null,
    onDrop: null,
    onDurationChange: null,
    onEmptied: null,
    onEnd: null,
    onEnded: null,
    onError: null,
    onFocus: null,
    onFocusIn: null,
    onFocusOut: null,
    onHashChange: null,
    onInput: null,
    onInvalid: null,
    onKeyDown: null,
    onKeyPress: null,
    onKeyUp: null,
    onLoad: null,
    onLoadedData: null,
    onLoadedMetadata: null,
    onLoadStart: null,
    onMessage: null,
    onMouseDown: null,
    onMouseEnter: null,
    onMouseLeave: null,
    onMouseMove: null,
    onMouseOut: null,
    onMouseOver: null,
    onMouseUp: null,
    onMouseWheel: null,
    onOffline: null,
    onOnline: null,
    onPageHide: null,
    onPageShow: null,
    onPaste: null,
    onPause: null,
    onPlay: null,
    onPlaying: null,
    onPopState: null,
    onProgress: null,
    onRateChange: null,
    onRepeat: null,
    onReset: null,
    onResize: null,
    onScroll: null,
    onSeeked: null,
    onSeeking: null,
    onSelect: null,
    onShow: null,
    onStalled: null,
    onStorage: null,
    onSubmit: null,
    onSuspend: null,
    onTimeUpdate: null,
    onToggle: null,
    onUnload: null,
    onVolumeChange: null,
    onWaiting: null,
    onZoom: null,
    opacity: null,
    operator: null,
    order: null,
    orient: null,
    orientation: null,
    origin: null,
    overflow: null,
    overlay: null,
    overlinePosition: at,
    overlineThickness: at,
    paintOrder: null,
    panose1: null,
    path: null,
    pathLength: at,
    patternContentUnits: null,
    patternTransform: null,
    patternUnits: null,
    phase: null,
    ping: Kn,
    pitch: null,
    playbackOrder: null,
    pointerEvents: null,
    points: null,
    pointsAtX: at,
    pointsAtY: at,
    pointsAtZ: at,
    preserveAlpha: null,
    preserveAspectRatio: null,
    primitiveUnits: null,
    propagate: null,
    property: ds,
    r: null,
    radius: null,
    referrerPolicy: null,
    refX: null,
    refY: null,
    rel: ds,
    rev: ds,
    renderingIntent: null,
    repeatCount: null,
    repeatDur: null,
    requiredExtensions: ds,
    requiredFeatures: ds,
    requiredFonts: ds,
    requiredFormats: ds,
    resource: null,
    restart: null,
    result: null,
    rotate: null,
    rx: null,
    ry: null,
    scale: null,
    seed: null,
    shapeRendering: null,
    side: null,
    slope: null,
    snapshotTime: null,
    specularConstant: at,
    specularExponent: at,
    spreadMethod: null,
    spacing: null,
    startOffset: null,
    stdDeviation: null,
    stemh: null,
    stemv: null,
    stitchTiles: null,
    stopColor: null,
    stopOpacity: null,
    strikethroughPosition: at,
    strikethroughThickness: at,
    string: null,
    stroke: null,
    strokeDashArray: ds,
    strokeDashOffset: null,
    strokeLineCap: null,
    strokeLineJoin: null,
    strokeMiterLimit: at,
    strokeOpacity: at,
    strokeWidth: null,
    style: null,
    surfaceScale: at,
    syncBehavior: null,
    syncBehaviorDefault: null,
    syncMaster: null,
    syncTolerance: null,
    syncToleranceDefault: null,
    systemLanguage: ds,
    tabIndex: at,
    tableValues: null,
    target: null,
    targetX: at,
    targetY: at,
    textAnchor: null,
    textDecoration: null,
    textRendering: null,
    textLength: null,
    timelineBegin: null,
    title: null,
    transformBehavior: null,
    type: null,
    typeOf: ds,
    to: null,
    transform: null,
    transformOrigin: null,
    u1: null,
    u2: null,
    underlinePosition: at,
    underlineThickness: at,
    unicode: null,
    unicodeBidi: null,
    unicodeRange: null,
    unitsPerEm: at,
    values: null,
    vAlphabetic: at,
    vMathematical: at,
    vectorEffect: null,
    vHanging: at,
    vIdeographic: at,
    version: null,
    vertAdvY: at,
    vertOriginX: at,
    vertOriginY: at,
    viewBox: null,
    viewTarget: null,
    visibility: null,
    width: null,
    widths: null,
    wordSpacing: null,
    writingMode: null,
    x: null,
    x1: null,
    x2: null,
    xChannelSelector: null,
    xHeight: at,
    y: null,
    y1: null,
    y2: null,
    yChannelSelector: null,
    z: null,
    zoomAndPan: null
  },
  space: "svg",
  transform: UR
}), VR = Bm({
  properties: {
    xLinkActuate: null,
    xLinkArcRole: null,
    xLinkHref: null,
    xLinkRole: null,
    xLinkShow: null,
    xLinkTitle: null,
    xLinkType: null
  },
  space: "xlink",
  transform(e, t) {
    return "xlink:" + t.slice(5).toLowerCase();
  }
}), HR = Bm({
  attributes: { xmlnsxlink: "xmlns:xlink" },
  properties: { xmlnsXLink: null, xmlns: null },
  space: "xmlns",
  transform: $R
}), GR = Bm({
  properties: { xmlBase: null, xmlLang: null, xmlSpace: null },
  space: "xml",
  transform(e, t) {
    return "xml:" + t.slice(3).toLowerCase();
  }
}), TU = {
  classId: "classID",
  dataType: "datatype",
  itemId: "itemID",
  strokeDashArray: "strokeDasharray",
  strokeDashOffset: "strokeDashoffset",
  strokeLineCap: "strokeLinecap",
  strokeLineJoin: "strokeLinejoin",
  strokeMiterLimit: "strokeMiterlimit",
  typeOf: "typeof",
  xLinkActuate: "xlinkActuate",
  xLinkArcRole: "xlinkArcrole",
  xLinkHref: "xlinkHref",
  xLinkRole: "xlinkRole",
  xLinkShow: "xlinkShow",
  xLinkTitle: "xlinkTitle",
  xLinkType: "xlinkType",
  xmlnsXLink: "xmlnsXlink"
}, NU = /[A-Z]/g, e6 = /-[a-z]/g, AU = /^data[-\w.:]+$/i;
function jU(e, t) {
  const n = h5(t);
  let r = t, i = $a;
  if (n in e.normal)
    return e.property[e.normal[n]];
  if (n.length > 4 && n.slice(0, 4) === "data" && AU.test(t)) {
    if (t.charAt(4) === "-") {
      const s = t.slice(5).replace(e6, RU);
      r = "data" + s.charAt(0).toUpperCase() + s.slice(1);
    } else {
      const s = t.slice(4);
      if (!e6.test(s)) {
        let o = s.replace(NU, MU);
        o.charAt(0) !== "-" && (o = "-" + o), t = "data" + o;
      }
    }
    i = OC;
  }
  return new i(r, t);
}
function MU(e) {
  return "-" + e.toLowerCase();
}
function RU(e) {
  return e.charAt(1).toUpperCase();
}
const OU = qR([FR, EU, VR, HR, GR], "html"), DC = qR([FR, kU, VR, HR, GR], "svg");
function DU(e) {
  return e.join(" ").trim();
}
var im = {}, Gb, t6;
function IU() {
  if (t6) return Gb;
  t6 = 1;
  var e = /\/\*[^*]*\*+([^/*][^*]*\*+)*\//g, t = /\n/g, n = /^\s*/, r = /^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/, i = /^:\s*/, s = /^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/, o = /^[;\s]*/, u = /^\s+|\s+$/g, c = `
`, d = "/", m = "*", p = "", x = "comment", b = "declaration";
  function S(A, T) {
    if (typeof A != "string")
      throw new TypeError("First argument must be a string");
    if (!A) return [];
    T = T || {};
    var M = 1, j = 1;
    function D(Q) {
      var se = Q.match(t);
      se && (M += se.length);
      var J = Q.lastIndexOf(c);
      j = ~J ? Q.length - J : j + Q.length;
    }
    function z() {
      var Q = { line: M, column: j };
      return function(se) {
        return se.position = new I(Q), ne(), se;
      };
    }
    function I(Q) {
      this.start = Q, this.end = { line: M, column: j }, this.source = T.source;
    }
    I.prototype.content = A;
    function L(Q) {
      var se = new Error(
        T.source + ":" + M + ":" + j + ": " + Q
      );
      if (se.reason = Q, se.filename = T.source, se.line = M, se.column = j, se.source = A, !T.silent) throw se;
    }
    function K(Q) {
      var se = Q.exec(A);
      if (se) {
        var J = se[0];
        return D(J), A = A.slice(J.length), se;
      }
    }
    function ne() {
      K(n);
    }
    function Y(Q) {
      var se;
      for (Q = Q || []; se = H(); )
        se !== !1 && Q.push(se);
      return Q;
    }
    function H() {
      var Q = z();
      if (!(d != A.charAt(0) || m != A.charAt(1))) {
        for (var se = 2; p != A.charAt(se) && (m != A.charAt(se) || d != A.charAt(se + 1)); )
          ++se;
        if (se += 2, p === A.charAt(se - 1))
          return L("End of comment missing");
        var J = A.slice(2, se - 2);
        return j += 2, D(J), A = A.slice(se), j += 2, Q({
          type: x,
          comment: J
        });
      }
    }
    function Z() {
      var Q = z(), se = K(r);
      if (se) {
        if (H(), !K(i)) return L("property missing ':'");
        var J = K(s), ue = Q({
          type: b,
          property: k(se[0].replace(e, p)),
          value: J ? k(J[0].replace(e, p)) : p
        });
        return K(o), ue;
      }
    }
    function me() {
      var Q = [];
      Y(Q);
      for (var se; se = Z(); )
        se !== !1 && (Q.push(se), Y(Q));
      return Q;
    }
    return ne(), me();
  }
  function k(A) {
    return A ? A.replace(u, p) : p;
  }
  return Gb = S, Gb;
}
var n6;
function PU() {
  if (n6) return im;
  n6 = 1;
  var e = im && im.__importDefault || function(r) {
    return r && r.__esModule ? r : { default: r };
  };
  Object.defineProperty(im, "__esModule", { value: !0 }), im.default = n;
  const t = e(IU());
  function n(r, i) {
    let s = null;
    if (!r || typeof r != "string")
      return s;
    const o = (0, t.default)(r), u = typeof i == "function";
    return o.forEach((c) => {
      if (c.type !== "declaration")
        return;
      const { property: d, value: m } = c;
      u ? i(d, m, c) : m && (s = s || {}, s[d] = m);
    }), s;
  }
  return im;
}
var Ag = {}, r6;
function zU() {
  if (r6) return Ag;
  r6 = 1, Object.defineProperty(Ag, "__esModule", { value: !0 }), Ag.camelCase = void 0;
  var e = /^--[a-zA-Z0-9_-]+$/, t = /-([a-z])/g, n = /^[^-]+$/, r = /^-(webkit|moz|ms|o|khtml)-/, i = /^-(ms)-/, s = function(d) {
    return !d || n.test(d) || e.test(d);
  }, o = function(d, m) {
    return m.toUpperCase();
  }, u = function(d, m) {
    return "".concat(m, "-");
  }, c = function(d, m) {
    return m === void 0 && (m = {}), s(d) ? d : (d = d.toLowerCase(), m.reactCompat ? d = d.replace(i, u) : d = d.replace(r, u), d.replace(t, o));
  };
  return Ag.camelCase = c, Ag;
}
var jg, i6;
function LU() {
  if (i6) return jg;
  i6 = 1;
  var e = jg && jg.__importDefault || function(i) {
    return i && i.__esModule ? i : { default: i };
  }, t = e(PU()), n = zU();
  function r(i, s) {
    var o = {};
    return !i || typeof i != "string" || (0, t.default)(i, function(u, c) {
      u && c && (o[(0, n.camelCase)(u, s)] = c);
    }), o;
  }
  return r.default = r, jg = r, jg;
}
var BU = LU();
const qU = /* @__PURE__ */ Uc(BU), KR = YR("end"), IC = YR("start");
function YR(e) {
  return t;
  function t(n) {
    const r = n && n.position && n.position[e] || {};
    if (typeof r.line == "number" && r.line > 0 && typeof r.column == "number" && r.column > 0)
      return {
        line: r.line,
        column: r.column,
        offset: typeof r.offset == "number" && r.offset > -1 ? r.offset : void 0
      };
  }
}
function FU(e) {
  const t = IC(e), n = KR(e);
  if (t && n)
    return { start: t, end: n };
}
function Wg(e) {
  return !e || typeof e != "object" ? "" : "position" in e || "type" in e ? a6(e.position) : "start" in e || "end" in e ? a6(e) : "line" in e || "column" in e ? g5(e) : "";
}
function g5(e) {
  return s6(e && e.line) + ":" + s6(e && e.column);
}
function a6(e) {
  return g5(e && e.start) + "-" + g5(e && e.end);
}
function s6(e) {
  return e && typeof e == "number" ? e : 1;
}
class Fi extends Error {
  /**
   * Create a message for `reason`.
   *
   * >  **Note**: also has obsolete signatures.
   *
   * @overload
   * @param {string} reason
   * @param {Options | null | undefined} [options]
   * @returns
   *
   * @overload
   * @param {string} reason
   * @param {Node | NodeLike | null | undefined} parent
   * @param {string | null | undefined} [origin]
   * @returns
   *
   * @overload
   * @param {string} reason
   * @param {Point | Position | null | undefined} place
   * @param {string | null | undefined} [origin]
   * @returns
   *
   * @overload
   * @param {string} reason
   * @param {string | null | undefined} [origin]
   * @returns
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {Node | NodeLike | null | undefined} parent
   * @param {string | null | undefined} [origin]
   * @returns
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {Point | Position | null | undefined} place
   * @param {string | null | undefined} [origin]
   * @returns
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {string | null | undefined} [origin]
   * @returns
   *
   * @param {Error | VFileMessage | string} causeOrReason
   *   Reason for message, should use markdown.
   * @param {Node | NodeLike | Options | Point | Position | string | null | undefined} [optionsOrParentOrPlace]
   *   Configuration (optional).
   * @param {string | null | undefined} [origin]
   *   Place in code where the message originates (example:
   *   `'my-package:my-rule'` or `'my-rule'`).
   * @returns
   *   Instance of `VFileMessage`.
   */
  // eslint-disable-next-line complexity
  constructor(t, n, r) {
    super(), typeof n == "string" && (r = n, n = void 0);
    let i = "", s = {}, o = !1;
    if (n && ("line" in n && "column" in n ? s = { place: n } : "start" in n && "end" in n ? s = { place: n } : "type" in n ? s = {
      ancestors: [n],
      place: n.position
    } : s = { ...n }), typeof t == "string" ? i = t : !s.cause && t && (o = !0, i = t.message, s.cause = t), !s.ruleId && !s.source && typeof r == "string") {
      const c = r.indexOf(":");
      c === -1 ? s.ruleId = r : (s.source = r.slice(0, c), s.ruleId = r.slice(c + 1));
    }
    if (!s.place && s.ancestors && s.ancestors) {
      const c = s.ancestors[s.ancestors.length - 1];
      c && (s.place = c.position);
    }
    const u = s.place && "start" in s.place ? s.place.start : s.place;
    this.ancestors = s.ancestors || void 0, this.cause = s.cause || void 0, this.column = u ? u.column : void 0, this.fatal = void 0, this.file = "", this.message = i, this.line = u ? u.line : void 0, this.name = Wg(s.place) || "1:1", this.place = s.place || void 0, this.reason = this.message, this.ruleId = s.ruleId || void 0, this.source = s.source || void 0, this.stack = o && s.cause && typeof s.cause.stack == "string" ? s.cause.stack : "", this.actual = void 0, this.expected = void 0, this.note = void 0, this.url = void 0;
  }
}
Fi.prototype.file = "";
Fi.prototype.name = "";
Fi.prototype.reason = "";
Fi.prototype.message = "";
Fi.prototype.stack = "";
Fi.prototype.column = void 0;
Fi.prototype.line = void 0;
Fi.prototype.ancestors = void 0;
Fi.prototype.cause = void 0;
Fi.prototype.fatal = void 0;
Fi.prototype.place = void 0;
Fi.prototype.ruleId = void 0;
Fi.prototype.source = void 0;
const PC = {}.hasOwnProperty, UU = /* @__PURE__ */ new Map(), $U = /[A-Z]/g, VU = /* @__PURE__ */ new Set(["table", "tbody", "thead", "tfoot", "tr"]), HU = /* @__PURE__ */ new Set(["td", "th"]), WR = "https://github.com/syntax-tree/hast-util-to-jsx-runtime";
function GU(e, t) {
  if (!t || t.Fragment === void 0)
    throw new TypeError("Expected `Fragment` in options");
  const n = t.filePath || void 0;
  let r;
  if (t.development) {
    if (typeof t.jsxDEV != "function")
      throw new TypeError(
        "Expected `jsxDEV` in options when `development: true`"
      );
    r = e$(n, t.jsxDEV);
  } else {
    if (typeof t.jsx != "function")
      throw new TypeError("Expected `jsx` in production options");
    if (typeof t.jsxs != "function")
      throw new TypeError("Expected `jsxs` in production options");
    r = JU(n, t.jsx, t.jsxs);
  }
  const i = {
    Fragment: t.Fragment,
    ancestors: [],
    components: t.components || {},
    create: r,
    elementAttributeNameCase: t.elementAttributeNameCase || "react",
    evaluater: t.createEvaluater ? t.createEvaluater() : void 0,
    filePath: n,
    ignoreInvalidStyle: t.ignoreInvalidStyle || !1,
    passKeys: t.passKeys !== !1,
    passNode: t.passNode || !1,
    schema: t.space === "svg" ? DC : OU,
    stylePropertyNameCase: t.stylePropertyNameCase || "dom",
    tableCellAlignToStyle: t.tableCellAlignToStyle !== !1
  }, s = XR(i, e, void 0);
  return s && typeof s != "string" ? s : i.create(
    e,
    i.Fragment,
    { children: s || void 0 },
    void 0
  );
}
function XR(e, t, n) {
  if (t.type === "element")
    return KU(e, t, n);
  if (t.type === "mdxFlowExpression" || t.type === "mdxTextExpression")
    return YU(e, t);
  if (t.type === "mdxJsxFlowElement" || t.type === "mdxJsxTextElement")
    return XU(e, t, n);
  if (t.type === "mdxjsEsm")
    return WU(e, t);
  if (t.type === "root")
    return QU(e, t, n);
  if (t.type === "text")
    return ZU(e, t);
}
function KU(e, t, n) {
  const r = e.schema;
  let i = r;
  t.tagName.toLowerCase() === "svg" && r.space === "html" && (i = DC, e.schema = i), e.ancestors.push(t);
  const s = ZR(e, t.tagName, !1), o = t$(e, t);
  let u = LC(e, t);
  return VU.has(t.tagName) && (u = u.filter(function(c) {
    return typeof c == "string" ? !SU(c) : !0;
  })), QR(e, o, s, t), zC(o, u), e.ancestors.pop(), e.schema = r, e.create(t, s, o, n);
}
function YU(e, t) {
  if (t.data && t.data.estree && e.evaluater) {
    const r = t.data.estree.body[0];
    return r.type, /** @type {Child | undefined} */
    e.evaluater.evaluateExpression(r.expression);
  }
  u0(e, t.position);
}
function WU(e, t) {
  if (t.data && t.data.estree && e.evaluater)
    return (
      /** @type {Child | undefined} */
      e.evaluater.evaluateProgram(t.data.estree)
    );
  u0(e, t.position);
}
function XU(e, t, n) {
  const r = e.schema;
  let i = r;
  t.name === "svg" && r.space === "html" && (i = DC, e.schema = i), e.ancestors.push(t);
  const s = t.name === null ? e.Fragment : ZR(e, t.name, !0), o = n$(e, t), u = LC(e, t);
  return QR(e, o, s, t), zC(o, u), e.ancestors.pop(), e.schema = r, e.create(t, s, o, n);
}
function QU(e, t, n) {
  const r = {};
  return zC(r, LC(e, t)), e.create(t, e.Fragment, r, n);
}
function ZU(e, t) {
  return t.value;
}
function QR(e, t, n, r) {
  typeof n != "string" && n !== e.Fragment && e.passNode && (t.node = r);
}
function zC(e, t) {
  if (t.length > 0) {
    const n = t.length > 1 ? t : t[0];
    n && (e.children = n);
  }
}
function JU(e, t, n) {
  return r;
  function r(i, s, o, u) {
    const d = Array.isArray(o.children) ? n : t;
    return u ? d(s, o, u) : d(s, o);
  }
}
function e$(e, t) {
  return n;
  function n(r, i, s, o) {
    const u = Array.isArray(s.children), c = IC(r);
    return t(
      i,
      s,
      o,
      u,
      {
        columnNumber: c ? c.column - 1 : void 0,
        fileName: e,
        lineNumber: c ? c.line : void 0
      },
      void 0
    );
  }
}
function t$(e, t) {
  const n = {};
  let r, i;
  for (i in t.properties)
    if (i !== "children" && PC.call(t.properties, i)) {
      const s = r$(e, i, t.properties[i]);
      if (s) {
        const [o, u] = s;
        e.tableCellAlignToStyle && o === "align" && typeof u == "string" && HU.has(t.tagName) ? r = u : n[o] = u;
      }
    }
  if (r) {
    const s = (
      /** @type {Style} */
      n.style || (n.style = {})
    );
    s[e.stylePropertyNameCase === "css" ? "text-align" : "textAlign"] = r;
  }
  return n;
}
function n$(e, t) {
  const n = {};
  for (const r of t.attributes)
    if (r.type === "mdxJsxExpressionAttribute")
      if (r.data && r.data.estree && e.evaluater) {
        const s = r.data.estree.body[0];
        s.type;
        const o = s.expression;
        o.type;
        const u = o.properties[0];
        u.type, Object.assign(
          n,
          e.evaluater.evaluateExpression(u.argument)
        );
      } else
        u0(e, t.position);
    else {
      const i = r.name;
      let s;
      if (r.value && typeof r.value == "object")
        if (r.value.data && r.value.data.estree && e.evaluater) {
          const u = r.value.data.estree.body[0];
          u.type, s = e.evaluater.evaluateExpression(u.expression);
        } else
          u0(e, t.position);
      else
        s = r.value === null ? !0 : r.value;
      n[i] = /** @type {Props[keyof Props]} */
      s;
    }
  return n;
}
function LC(e, t) {
  const n = [];
  let r = -1;
  const i = e.passKeys ? /* @__PURE__ */ new Map() : UU;
  for (; ++r < t.children.length; ) {
    const s = t.children[r];
    let o;
    if (e.passKeys) {
      const c = s.type === "element" ? s.tagName : s.type === "mdxJsxFlowElement" || s.type === "mdxJsxTextElement" ? s.name : void 0;
      if (c) {
        const d = i.get(c) || 0;
        o = c + "-" + d, i.set(c, d + 1);
      }
    }
    const u = XR(e, s, o);
    u !== void 0 && n.push(u);
  }
  return n;
}
function r$(e, t, n) {
  const r = jU(e.schema, t);
  if (!(n == null || typeof n == "number" && Number.isNaN(n))) {
    if (Array.isArray(n) && (n = r.commaSeparated ? vU(n) : DU(n)), r.property === "style") {
      let i = typeof n == "object" ? n : i$(e, String(n));
      return e.stylePropertyNameCase === "css" && (i = a$(i)), ["style", i];
    }
    return [
      e.elementAttributeNameCase === "react" && r.space ? TU[r.property] || r.property : r.attribute,
      n
    ];
  }
}
function i$(e, t) {
  try {
    return qU(t, { reactCompat: !0 });
  } catch (n) {
    if (e.ignoreInvalidStyle)
      return {};
    const r = (
      /** @type {Error} */
      n
    ), i = new Fi("Cannot parse `style` attribute", {
      ancestors: e.ancestors,
      cause: r,
      ruleId: "style",
      source: "hast-util-to-jsx-runtime"
    });
    throw i.file = e.filePath || void 0, i.url = WR + "#cannot-parse-style-attribute", i;
  }
}
function ZR(e, t, n) {
  let r;
  if (!n)
    r = { type: "Literal", value: t };
  else if (t.includes(".")) {
    const i = t.split(".");
    let s = -1, o;
    for (; ++s < i.length; ) {
      const u = Qk(i[s]) ? { type: "Identifier", name: i[s] } : { type: "Literal", value: i[s] };
      o = o ? {
        type: "MemberExpression",
        object: o,
        property: u,
        computed: !!(s && u.type === "Literal"),
        optional: !1
      } : u;
    }
    r = o;
  } else
    r = Qk(t) && !/^[a-z]/.test(t) ? { type: "Identifier", name: t } : { type: "Literal", value: t };
  if (r.type === "Literal") {
    const i = (
      /** @type {string | number} */
      r.value
    );
    return PC.call(e.components, i) ? e.components[i] : i;
  }
  if (e.evaluater)
    return e.evaluater.evaluateExpression(r);
  u0(e);
}
function u0(e, t) {
  const n = new Fi(
    "Cannot handle MDX estrees without `createEvaluater`",
    {
      ancestors: e.ancestors,
      place: t,
      ruleId: "mdx-estree",
      source: "hast-util-to-jsx-runtime"
    }
  );
  throw n.file = e.filePath || void 0, n.url = WR + "#cannot-handle-mdx-estrees-without-createevaluater", n;
}
function a$(e) {
  const t = {};
  let n;
  for (n in e)
    PC.call(e, n) && (t[s$(n)] = e[n]);
  return t;
}
function s$(e) {
  let t = e.replace($U, o$);
  return t.slice(0, 3) === "ms-" && (t = "-" + t), t;
}
function o$(e) {
  return "-" + e.toLowerCase();
}
const Kb = {
  action: ["form"],
  cite: ["blockquote", "del", "ins", "q"],
  data: ["object"],
  formAction: ["button", "input"],
  href: ["a", "area", "base", "link"],
  icon: ["menuitem"],
  itemId: null,
  manifest: ["html"],
  ping: ["a", "area"],
  poster: ["video"],
  src: [
    "audio",
    "embed",
    "iframe",
    "img",
    "input",
    "script",
    "source",
    "track",
    "video"
  ]
}, l$ = {};
function BC(e, t) {
  const n = l$, r = typeof n.includeImageAlt == "boolean" ? n.includeImageAlt : !0, i = typeof n.includeHtml == "boolean" ? n.includeHtml : !0;
  return JR(e, r, i);
}
function JR(e, t, n) {
  if (u$(e)) {
    if ("value" in e)
      return e.type === "html" && !n ? "" : e.value;
    if (t && "alt" in e && e.alt)
      return e.alt;
    if ("children" in e)
      return o6(e.children, t, n);
  }
  return Array.isArray(e) ? o6(e, t, n) : "";
}
function o6(e, t, n) {
  const r = [];
  let i = -1;
  for (; ++i < e.length; )
    r[i] = JR(e[i], t, n);
  return r.join("");
}
function u$(e) {
  return !!(e && typeof e == "object");
}
const l6 = document.createElement("i");
function qC(e) {
  const t = "&" + e + ";";
  l6.innerHTML = t;
  const n = l6.textContent;
  return (
    // @ts-expect-error: TypeScript is wrong that `textContent` on elements can
    // yield `null`.
    n.charCodeAt(n.length - 1) === 59 && e !== "semi" || n === t ? !1 : n
  );
}
function ms(e, t, n, r) {
  const i = e.length;
  let s = 0, o;
  if (t < 0 ? t = -t > i ? 0 : i + t : t = t > i ? i : t, n = n > 0 ? n : 0, r.length < 1e4)
    o = Array.from(r), o.unshift(t, n), e.splice(...o);
  else
    for (n && e.splice(t, n); s < r.length; )
      o = r.slice(s, s + 1e4), o.unshift(t, 0), e.splice(...o), s += 1e4, t += 1e4;
}
function Ds(e, t) {
  return e.length > 0 ? (ms(e, e.length, 0, t), e) : t;
}
const u6 = {}.hasOwnProperty;
function eO(e) {
  const t = {};
  let n = -1;
  for (; ++n < e.length; )
    c$(t, e[n]);
  return t;
}
function c$(e, t) {
  let n;
  for (n in t) {
    const i = (u6.call(e, n) ? e[n] : void 0) || (e[n] = {}), s = t[n];
    let o;
    if (s)
      for (o in s) {
        u6.call(i, o) || (i[o] = []);
        const u = s[o];
        f$(
          // @ts-expect-error Looks like a list.
          i[o],
          Array.isArray(u) ? u : u ? [u] : []
        );
      }
  }
}
function f$(e, t) {
  let n = -1;
  const r = [];
  for (; ++n < t.length; )
    (t[n].add === "after" ? e : r).push(t[n]);
  ms(e, 0, 0, r);
}
function tO(e, t) {
  const n = Number.parseInt(e, t);
  return (
    // C0 except for HT, LF, FF, CR, space.
    n < 9 || n === 11 || n > 13 && n < 32 || // Control character (DEL) of C0, and C1 controls.
    n > 126 && n < 160 || // Lone high surrogates and low surrogates.
    n > 55295 && n < 57344 || // Noncharacters.
    n > 64975 && n < 65008 || /* eslint-disable no-bitwise */
    (n & 65535) === 65535 || (n & 65535) === 65534 || /* eslint-enable no-bitwise */
    // Out of range
    n > 1114111 ? "" : String.fromCodePoint(n)
  );
}
function Ao(e) {
  return e.replace(/[\t\n\r ]+/g, " ").replace(/^ | $/g, "").toLowerCase().toUpperCase();
}
const la = $c(/[A-Za-z]/), qi = $c(/[\dA-Za-z]/), d$ = $c(/[#-'*+\--9=?A-Z^-~]/);
function _v(e) {
  return (
    // Special whitespace codes (which have negative values), C0 and Control
    // character DEL
    e !== null && (e < 32 || e === 127)
  );
}
const y5 = $c(/\d/), h$ = $c(/[\dA-Fa-f]/), m$ = $c(/[!-/:-@[-`{-~]/);
function Nt(e) {
  return e !== null && e < -2;
}
function Fn(e) {
  return e !== null && (e < 0 || e === 32);
}
function nn(e) {
  return e === -2 || e === -1 || e === 32;
}
const nx = $c(new RegExp("\\p{P}|\\p{S}", "u")), Md = $c(/\s/);
function $c(e) {
  return t;
  function t(n) {
    return n !== null && n > -1 && e.test(String.fromCharCode(n));
  }
}
function qm(e) {
  const t = [];
  let n = -1, r = 0, i = 0;
  for (; ++n < e.length; ) {
    const s = e.charCodeAt(n);
    let o = "";
    if (s === 37 && qi(e.charCodeAt(n + 1)) && qi(e.charCodeAt(n + 2)))
      i = 2;
    else if (s < 128)
      /[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(s)) || (o = String.fromCharCode(s));
    else if (s > 55295 && s < 57344) {
      const u = e.charCodeAt(n + 1);
      s < 56320 && u > 56319 && u < 57344 ? (o = String.fromCharCode(s, u), i = 1) : o = "";
    } else
      o = String.fromCharCode(s);
    o && (t.push(e.slice(r, n), encodeURIComponent(o)), r = n + i + 1, o = ""), i && (n += i, i = 0);
  }
  return t.join("") + e.slice(r);
}
function hn(e, t, n, r) {
  const i = r ? r - 1 : Number.POSITIVE_INFINITY;
  let s = 0;
  return o;
  function o(c) {
    return nn(c) ? (e.enter(n), u(c)) : t(c);
  }
  function u(c) {
    return nn(c) && s++ < i ? (e.consume(c), u) : (e.exit(n), t(c));
  }
}
const p$ = {
  tokenize: g$
};
function g$(e) {
  const t = e.attempt(this.parser.constructs.contentInitial, r, i);
  let n;
  return t;
  function r(u) {
    if (u === null) {
      e.consume(u);
      return;
    }
    return e.enter("lineEnding"), e.consume(u), e.exit("lineEnding"), hn(e, t, "linePrefix");
  }
  function i(u) {
    return e.enter("paragraph"), s(u);
  }
  function s(u) {
    const c = e.enter("chunkText", {
      contentType: "text",
      previous: n
    });
    return n && (n.next = c), n = c, o(u);
  }
  function o(u) {
    if (u === null) {
      e.exit("chunkText"), e.exit("paragraph"), e.consume(u);
      return;
    }
    return Nt(u) ? (e.consume(u), e.exit("chunkText"), s) : (e.consume(u), o);
  }
}
const y$ = {
  tokenize: v$
}, c6 = {
  tokenize: x$
};
function v$(e) {
  const t = this, n = [];
  let r = 0, i, s, o;
  return u;
  function u(j) {
    if (r < n.length) {
      const D = n[r];
      return t.containerState = D[1], e.attempt(D[0].continuation, c, d)(j);
    }
    return d(j);
  }
  function c(j) {
    if (r++, t.containerState._closeFlow) {
      t.containerState._closeFlow = void 0, i && M();
      const D = t.events.length;
      let z = D, I;
      for (; z--; )
        if (t.events[z][0] === "exit" && t.events[z][1].type === "chunkFlow") {
          I = t.events[z][1].end;
          break;
        }
      T(r);
      let L = D;
      for (; L < t.events.length; )
        t.events[L][1].end = {
          ...I
        }, L++;
      return ms(t.events, z + 1, 0, t.events.slice(D)), t.events.length = L, d(j);
    }
    return u(j);
  }
  function d(j) {
    if (r === n.length) {
      if (!i)
        return x(j);
      if (i.currentConstruct && i.currentConstruct.concrete)
        return S(j);
      t.interrupt = !!(i.currentConstruct && !i._gfmTableDynamicInterruptHack);
    }
    return t.containerState = {}, e.check(c6, m, p)(j);
  }
  function m(j) {
    return i && M(), T(r), x(j);
  }
  function p(j) {
    return t.parser.lazy[t.now().line] = r !== n.length, o = t.now().offset, S(j);
  }
  function x(j) {
    return t.containerState = {}, e.attempt(c6, b, S)(j);
  }
  function b(j) {
    return r++, n.push([t.currentConstruct, t.containerState]), x(j);
  }
  function S(j) {
    if (j === null) {
      i && M(), T(0), e.consume(j);
      return;
    }
    return i = i || t.parser.flow(t.now()), e.enter("chunkFlow", {
      _tokenizer: i,
      contentType: "flow",
      previous: s
    }), k(j);
  }
  function k(j) {
    if (j === null) {
      A(e.exit("chunkFlow"), !0), T(0), e.consume(j);
      return;
    }
    return Nt(j) ? (e.consume(j), A(e.exit("chunkFlow")), r = 0, t.interrupt = void 0, u) : (e.consume(j), k);
  }
  function A(j, D) {
    const z = t.sliceStream(j);
    if (D && z.push(null), j.previous = s, s && (s.next = j), s = j, i.defineSkip(j.start), i.write(z), t.parser.lazy[j.start.line]) {
      let I = i.events.length;
      for (; I--; )
        if (
          // The token starts before the line ending
          i.events[I][1].start.offset < o && // and either is not ended yet
          (!i.events[I][1].end || // or ends after it.
          i.events[I][1].end.offset > o)
        )
          return;
      const L = t.events.length;
      let K = L, ne, Y;
      for (; K--; )
        if (t.events[K][0] === "exit" && t.events[K][1].type === "chunkFlow") {
          if (ne) {
            Y = t.events[K][1].end;
            break;
          }
          ne = !0;
        }
      for (T(r), I = L; I < t.events.length; )
        t.events[I][1].end = {
          ...Y
        }, I++;
      ms(t.events, K + 1, 0, t.events.slice(L)), t.events.length = I;
    }
  }
  function T(j) {
    let D = n.length;
    for (; D-- > j; ) {
      const z = n[D];
      t.containerState = z[1], z[0].exit.call(t, e);
    }
    n.length = j;
  }
  function M() {
    i.write([null]), s = void 0, i = void 0, t.containerState._closeFlow = void 0;
  }
}
function x$(e, t, n) {
  return hn(e, e.attempt(this.parser.constructs.document, t, n), "linePrefix", this.parser.constructs.disable.null.includes("codeIndented") ? void 0 : 4);
}
function km(e) {
  if (e === null || Fn(e) || Md(e))
    return 1;
  if (nx(e))
    return 2;
}
function rx(e, t, n) {
  const r = [];
  let i = -1;
  for (; ++i < e.length; ) {
    const s = e[i].resolveAll;
    s && !r.includes(s) && (t = s(t, n), r.push(s));
  }
  return t;
}
const v5 = {
  name: "attention",
  resolveAll: b$,
  tokenize: w$
};
function b$(e, t) {
  let n = -1, r, i, s, o, u, c, d, m;
  for (; ++n < e.length; )
    if (e[n][0] === "enter" && e[n][1].type === "attentionSequence" && e[n][1]._close) {
      for (r = n; r--; )
        if (e[r][0] === "exit" && e[r][1].type === "attentionSequence" && e[r][1]._open && // If the markers are the same:
        t.sliceSerialize(e[r][1]).charCodeAt(0) === t.sliceSerialize(e[n][1]).charCodeAt(0)) {
          if ((e[r][1]._close || e[n][1]._open) && (e[n][1].end.offset - e[n][1].start.offset) % 3 && !((e[r][1].end.offset - e[r][1].start.offset + e[n][1].end.offset - e[n][1].start.offset) % 3))
            continue;
          c = e[r][1].end.offset - e[r][1].start.offset > 1 && e[n][1].end.offset - e[n][1].start.offset > 1 ? 2 : 1;
          const p = {
            ...e[r][1].end
          }, x = {
            ...e[n][1].start
          };
          f6(p, -c), f6(x, c), o = {
            type: c > 1 ? "strongSequence" : "emphasisSequence",
            start: p,
            end: {
              ...e[r][1].end
            }
          }, u = {
            type: c > 1 ? "strongSequence" : "emphasisSequence",
            start: {
              ...e[n][1].start
            },
            end: x
          }, s = {
            type: c > 1 ? "strongText" : "emphasisText",
            start: {
              ...e[r][1].end
            },
            end: {
              ...e[n][1].start
            }
          }, i = {
            type: c > 1 ? "strong" : "emphasis",
            start: {
              ...o.start
            },
            end: {
              ...u.end
            }
          }, e[r][1].end = {
            ...o.start
          }, e[n][1].start = {
            ...u.end
          }, d = [], e[r][1].end.offset - e[r][1].start.offset && (d = Ds(d, [["enter", e[r][1], t], ["exit", e[r][1], t]])), d = Ds(d, [["enter", i, t], ["enter", o, t], ["exit", o, t], ["enter", s, t]]), d = Ds(d, rx(t.parser.constructs.insideSpan.null, e.slice(r + 1, n), t)), d = Ds(d, [["exit", s, t], ["enter", u, t], ["exit", u, t], ["exit", i, t]]), e[n][1].end.offset - e[n][1].start.offset ? (m = 2, d = Ds(d, [["enter", e[n][1], t], ["exit", e[n][1], t]])) : m = 0, ms(e, r - 1, n - r + 3, d), n = r + d.length - m - 2;
          break;
        }
    }
  for (n = -1; ++n < e.length; )
    e[n][1].type === "attentionSequence" && (e[n][1].type = "data");
  return e;
}
function w$(e, t) {
  const n = this.parser.constructs.attentionMarkers.null, r = this.previous, i = km(r);
  let s;
  return o;
  function o(c) {
    return s = c, e.enter("attentionSequence"), u(c);
  }
  function u(c) {
    if (c === s)
      return e.consume(c), u;
    const d = e.exit("attentionSequence"), m = km(c), p = !m || m === 2 && i || n.includes(c), x = !i || i === 2 && m || n.includes(r);
    return d._open = !!(s === 42 ? p : p && (i || !x)), d._close = !!(s === 42 ? x : x && (m || !p)), t(c);
  }
}
function f6(e, t) {
  e.column += t, e.offset += t, e._bufferIndex += t;
}
const _$ = {
  name: "autolink",
  tokenize: S$
};
function S$(e, t, n) {
  let r = 0;
  return i;
  function i(b) {
    return e.enter("autolink"), e.enter("autolinkMarker"), e.consume(b), e.exit("autolinkMarker"), e.enter("autolinkProtocol"), s;
  }
  function s(b) {
    return la(b) ? (e.consume(b), o) : b === 64 ? n(b) : d(b);
  }
  function o(b) {
    return b === 43 || b === 45 || b === 46 || qi(b) ? (r = 1, u(b)) : d(b);
  }
  function u(b) {
    return b === 58 ? (e.consume(b), r = 0, c) : (b === 43 || b === 45 || b === 46 || qi(b)) && r++ < 32 ? (e.consume(b), u) : (r = 0, d(b));
  }
  function c(b) {
    return b === 62 ? (e.exit("autolinkProtocol"), e.enter("autolinkMarker"), e.consume(b), e.exit("autolinkMarker"), e.exit("autolink"), t) : b === null || b === 32 || b === 60 || _v(b) ? n(b) : (e.consume(b), c);
  }
  function d(b) {
    return b === 64 ? (e.consume(b), m) : d$(b) ? (e.consume(b), d) : n(b);
  }
  function m(b) {
    return qi(b) ? p(b) : n(b);
  }
  function p(b) {
    return b === 46 ? (e.consume(b), r = 0, m) : b === 62 ? (e.exit("autolinkProtocol").type = "autolinkEmail", e.enter("autolinkMarker"), e.consume(b), e.exit("autolinkMarker"), e.exit("autolink"), t) : x(b);
  }
  function x(b) {
    if ((b === 45 || qi(b)) && r++ < 63) {
      const S = b === 45 ? x : p;
      return e.consume(b), S;
    }
    return n(b);
  }
}
const R0 = {
  partial: !0,
  tokenize: C$
};
function C$(e, t, n) {
  return r;
  function r(s) {
    return nn(s) ? hn(e, i, "linePrefix")(s) : i(s);
  }
  function i(s) {
    return s === null || Nt(s) ? t(s) : n(s);
  }
}
const nO = {
  continuation: {
    tokenize: k$
  },
  exit: T$,
  name: "blockQuote",
  tokenize: E$
};
function E$(e, t, n) {
  const r = this;
  return i;
  function i(o) {
    if (o === 62) {
      const u = r.containerState;
      return u.open || (e.enter("blockQuote", {
        _container: !0
      }), u.open = !0), e.enter("blockQuotePrefix"), e.enter("blockQuoteMarker"), e.consume(o), e.exit("blockQuoteMarker"), s;
    }
    return n(o);
  }
  function s(o) {
    return nn(o) ? (e.enter("blockQuotePrefixWhitespace"), e.consume(o), e.exit("blockQuotePrefixWhitespace"), e.exit("blockQuotePrefix"), t) : (e.exit("blockQuotePrefix"), t(o));
  }
}
function k$(e, t, n) {
  const r = this;
  return i;
  function i(o) {
    return nn(o) ? hn(e, s, "linePrefix", r.parser.constructs.disable.null.includes("codeIndented") ? void 0 : 4)(o) : s(o);
  }
  function s(o) {
    return e.attempt(nO, t, n)(o);
  }
}
function T$(e) {
  e.exit("blockQuote");
}
const rO = {
  name: "characterEscape",
  tokenize: N$
};
function N$(e, t, n) {
  return r;
  function r(s) {
    return e.enter("characterEscape"), e.enter("escapeMarker"), e.consume(s), e.exit("escapeMarker"), i;
  }
  function i(s) {
    return m$(s) ? (e.enter("characterEscapeValue"), e.consume(s), e.exit("characterEscapeValue"), e.exit("characterEscape"), t) : n(s);
  }
}
const iO = {
  name: "characterReference",
  tokenize: A$
};
function A$(e, t, n) {
  const r = this;
  let i = 0, s, o;
  return u;
  function u(p) {
    return e.enter("characterReference"), e.enter("characterReferenceMarker"), e.consume(p), e.exit("characterReferenceMarker"), c;
  }
  function c(p) {
    return p === 35 ? (e.enter("characterReferenceMarkerNumeric"), e.consume(p), e.exit("characterReferenceMarkerNumeric"), d) : (e.enter("characterReferenceValue"), s = 31, o = qi, m(p));
  }
  function d(p) {
    return p === 88 || p === 120 ? (e.enter("characterReferenceMarkerHexadecimal"), e.consume(p), e.exit("characterReferenceMarkerHexadecimal"), e.enter("characterReferenceValue"), s = 6, o = h$, m) : (e.enter("characterReferenceValue"), s = 7, o = y5, m(p));
  }
  function m(p) {
    if (p === 59 && i) {
      const x = e.exit("characterReferenceValue");
      return o === qi && !qC(r.sliceSerialize(x)) ? n(p) : (e.enter("characterReferenceMarker"), e.consume(p), e.exit("characterReferenceMarker"), e.exit("characterReference"), t);
    }
    return o(p) && i++ < s ? (e.consume(p), m) : n(p);
  }
}
const d6 = {
  partial: !0,
  tokenize: M$
}, h6 = {
  concrete: !0,
  name: "codeFenced",
  tokenize: j$
};
function j$(e, t, n) {
  const r = this, i = {
    partial: !0,
    tokenize: z
  };
  let s = 0, o = 0, u;
  return c;
  function c(I) {
    return d(I);
  }
  function d(I) {
    const L = r.events[r.events.length - 1];
    return s = L && L[1].type === "linePrefix" ? L[2].sliceSerialize(L[1], !0).length : 0, u = I, e.enter("codeFenced"), e.enter("codeFencedFence"), e.enter("codeFencedFenceSequence"), m(I);
  }
  function m(I) {
    return I === u ? (o++, e.consume(I), m) : o < 3 ? n(I) : (e.exit("codeFencedFenceSequence"), nn(I) ? hn(e, p, "whitespace")(I) : p(I));
  }
  function p(I) {
    return I === null || Nt(I) ? (e.exit("codeFencedFence"), r.interrupt ? t(I) : e.check(d6, k, D)(I)) : (e.enter("codeFencedFenceInfo"), e.enter("chunkString", {
      contentType: "string"
    }), x(I));
  }
  function x(I) {
    return I === null || Nt(I) ? (e.exit("chunkString"), e.exit("codeFencedFenceInfo"), p(I)) : nn(I) ? (e.exit("chunkString"), e.exit("codeFencedFenceInfo"), hn(e, b, "whitespace")(I)) : I === 96 && I === u ? n(I) : (e.consume(I), x);
  }
  function b(I) {
    return I === null || Nt(I) ? p(I) : (e.enter("codeFencedFenceMeta"), e.enter("chunkString", {
      contentType: "string"
    }), S(I));
  }
  function S(I) {
    return I === null || Nt(I) ? (e.exit("chunkString"), e.exit("codeFencedFenceMeta"), p(I)) : I === 96 && I === u ? n(I) : (e.consume(I), S);
  }
  function k(I) {
    return e.attempt(i, D, A)(I);
  }
  function A(I) {
    return e.enter("lineEnding"), e.consume(I), e.exit("lineEnding"), T;
  }
  function T(I) {
    return s > 0 && nn(I) ? hn(e, M, "linePrefix", s + 1)(I) : M(I);
  }
  function M(I) {
    return I === null || Nt(I) ? e.check(d6, k, D)(I) : (e.enter("codeFlowValue"), j(I));
  }
  function j(I) {
    return I === null || Nt(I) ? (e.exit("codeFlowValue"), M(I)) : (e.consume(I), j);
  }
  function D(I) {
    return e.exit("codeFenced"), t(I);
  }
  function z(I, L, K) {
    let ne = 0;
    return Y;
    function Y(se) {
      return I.enter("lineEnding"), I.consume(se), I.exit("lineEnding"), H;
    }
    function H(se) {
      return I.enter("codeFencedFence"), nn(se) ? hn(I, Z, "linePrefix", r.parser.constructs.disable.null.includes("codeIndented") ? void 0 : 4)(se) : Z(se);
    }
    function Z(se) {
      return se === u ? (I.enter("codeFencedFenceSequence"), me(se)) : K(se);
    }
    function me(se) {
      return se === u ? (ne++, I.consume(se), me) : ne >= o ? (I.exit("codeFencedFenceSequence"), nn(se) ? hn(I, Q, "whitespace")(se) : Q(se)) : K(se);
    }
    function Q(se) {
      return se === null || Nt(se) ? (I.exit("codeFencedFence"), L(se)) : K(se);
    }
  }
}
function M$(e, t, n) {
  const r = this;
  return i;
  function i(o) {
    return o === null ? n(o) : (e.enter("lineEnding"), e.consume(o), e.exit("lineEnding"), s);
  }
  function s(o) {
    return r.parser.lazy[r.now().line] ? n(o) : t(o);
  }
}
const Yb = {
  name: "codeIndented",
  tokenize: O$
}, R$ = {
  partial: !0,
  tokenize: D$
};
function O$(e, t, n) {
  const r = this;
  return i;
  function i(d) {
    return e.enter("codeIndented"), hn(e, s, "linePrefix", 5)(d);
  }
  function s(d) {
    const m = r.events[r.events.length - 1];
    return m && m[1].type === "linePrefix" && m[2].sliceSerialize(m[1], !0).length >= 4 ? o(d) : n(d);
  }
  function o(d) {
    return d === null ? c(d) : Nt(d) ? e.attempt(R$, o, c)(d) : (e.enter("codeFlowValue"), u(d));
  }
  function u(d) {
    return d === null || Nt(d) ? (e.exit("codeFlowValue"), o(d)) : (e.consume(d), u);
  }
  function c(d) {
    return e.exit("codeIndented"), t(d);
  }
}
function D$(e, t, n) {
  const r = this;
  return i;
  function i(o) {
    return r.parser.lazy[r.now().line] ? n(o) : Nt(o) ? (e.enter("lineEnding"), e.consume(o), e.exit("lineEnding"), i) : hn(e, s, "linePrefix", 5)(o);
  }
  function s(o) {
    const u = r.events[r.events.length - 1];
    return u && u[1].type === "linePrefix" && u[2].sliceSerialize(u[1], !0).length >= 4 ? t(o) : Nt(o) ? i(o) : n(o);
  }
}
const I$ = {
  name: "codeText",
  previous: z$,
  resolve: P$,
  tokenize: L$
};
function P$(e) {
  let t = e.length - 4, n = 3, r, i;
  if ((e[n][1].type === "lineEnding" || e[n][1].type === "space") && (e[t][1].type === "lineEnding" || e[t][1].type === "space")) {
    for (r = n; ++r < t; )
      if (e[r][1].type === "codeTextData") {
        e[n][1].type = "codeTextPadding", e[t][1].type = "codeTextPadding", n += 2, t -= 2;
        break;
      }
  }
  for (r = n - 1, t++; ++r <= t; )
    i === void 0 ? r !== t && e[r][1].type !== "lineEnding" && (i = r) : (r === t || e[r][1].type === "lineEnding") && (e[i][1].type = "codeTextData", r !== i + 2 && (e[i][1].end = e[r - 1][1].end, e.splice(i + 2, r - i - 2), t -= r - i - 2, r = i + 2), i = void 0);
  return e;
}
function z$(e) {
  return e !== 96 || this.events[this.events.length - 1][1].type === "characterEscape";
}
function L$(e, t, n) {
  let r = 0, i, s;
  return o;
  function o(p) {
    return e.enter("codeText"), e.enter("codeTextSequence"), u(p);
  }
  function u(p) {
    return p === 96 ? (e.consume(p), r++, u) : (e.exit("codeTextSequence"), c(p));
  }
  function c(p) {
    return p === null ? n(p) : p === 32 ? (e.enter("space"), e.consume(p), e.exit("space"), c) : p === 96 ? (s = e.enter("codeTextSequence"), i = 0, m(p)) : Nt(p) ? (e.enter("lineEnding"), e.consume(p), e.exit("lineEnding"), c) : (e.enter("codeTextData"), d(p));
  }
  function d(p) {
    return p === null || p === 32 || p === 96 || Nt(p) ? (e.exit("codeTextData"), c(p)) : (e.consume(p), d);
  }
  function m(p) {
    return p === 96 ? (e.consume(p), i++, m) : i === r ? (e.exit("codeTextSequence"), e.exit("codeText"), t(p)) : (s.type = "codeTextData", d(p));
  }
}
class B$ {
  /**
   * @param {ReadonlyArray<T> | null | undefined} [initial]
   *   Initial items (optional).
   * @returns
   *   Splice buffer.
   */
  constructor(t) {
    this.left = t ? [...t] : [], this.right = [];
  }
  /**
   * Array access;
   * does not move the cursor.
   *
   * @param {number} index
   *   Index.
   * @return {T}
   *   Item.
   */
  get(t) {
    if (t < 0 || t >= this.left.length + this.right.length)
      throw new RangeError("Cannot access index `" + t + "` in a splice buffer of size `" + (this.left.length + this.right.length) + "`");
    return t < this.left.length ? this.left[t] : this.right[this.right.length - t + this.left.length - 1];
  }
  /**
   * The length of the splice buffer, one greater than the largest index in the
   * array.
   */
  get length() {
    return this.left.length + this.right.length;
  }
  /**
   * Remove and return `list[0]`;
   * moves the cursor to `0`.
   *
   * @returns {T | undefined}
   *   Item, optional.
   */
  shift() {
    return this.setCursor(0), this.right.pop();
  }
  /**
   * Slice the buffer to get an array;
   * does not move the cursor.
   *
   * @param {number} start
   *   Start.
   * @param {number | null | undefined} [end]
   *   End (optional).
   * @returns {Array<T>}
   *   Array of items.
   */
  slice(t, n) {
    const r = n ?? Number.POSITIVE_INFINITY;
    return r < this.left.length ? this.left.slice(t, r) : t > this.left.length ? this.right.slice(this.right.length - r + this.left.length, this.right.length - t + this.left.length).reverse() : this.left.slice(t).concat(this.right.slice(this.right.length - r + this.left.length).reverse());
  }
  /**
   * Mimics the behavior of Array.prototype.splice() except for the change of
   * interface necessary to avoid segfaults when patching in very large arrays.
   *
   * This operation moves cursor is moved to `start` and results in the cursor
   * placed after any inserted items.
   *
   * @param {number} start
   *   Start;
   *   zero-based index at which to start changing the array;
   *   negative numbers count backwards from the end of the array and values
   *   that are out-of bounds are clamped to the appropriate end of the array.
   * @param {number | null | undefined} [deleteCount=0]
   *   Delete count (default: `0`);
   *   maximum number of elements to delete, starting from start.
   * @param {Array<T> | null | undefined} [items=[]]
   *   Items to include in place of the deleted items (default: `[]`).
   * @return {Array<T>}
   *   Any removed items.
   */
  splice(t, n, r) {
    const i = n || 0;
    this.setCursor(Math.trunc(t));
    const s = this.right.splice(this.right.length - i, Number.POSITIVE_INFINITY);
    return r && Mg(this.left, r), s.reverse();
  }
  /**
   * Remove and return the highest-numbered item in the array, so
   * `list[list.length - 1]`;
   * Moves the cursor to `length`.
   *
   * @returns {T | undefined}
   *   Item, optional.
   */
  pop() {
    return this.setCursor(Number.POSITIVE_INFINITY), this.left.pop();
  }
  /**
   * Inserts a single item to the high-numbered side of the array;
   * moves the cursor to `length`.
   *
   * @param {T} item
   *   Item.
   * @returns {undefined}
   *   Nothing.
   */
  push(t) {
    this.setCursor(Number.POSITIVE_INFINITY), this.left.push(t);
  }
  /**
   * Inserts many items to the high-numbered side of the array.
   * Moves the cursor to `length`.
   *
   * @param {Array<T>} items
   *   Items.
   * @returns {undefined}
   *   Nothing.
   */
  pushMany(t) {
    this.setCursor(Number.POSITIVE_INFINITY), Mg(this.left, t);
  }
  /**
   * Inserts a single item to the low-numbered side of the array;
   * Moves the cursor to `0`.
   *
   * @param {T} item
   *   Item.
   * @returns {undefined}
   *   Nothing.
   */
  unshift(t) {
    this.setCursor(0), this.right.push(t);
  }
  /**
   * Inserts many items to the low-numbered side of the array;
   * moves the cursor to `0`.
   *
   * @param {Array<T>} items
   *   Items.
   * @returns {undefined}
   *   Nothing.
   */
  unshiftMany(t) {
    this.setCursor(0), Mg(this.right, t.reverse());
  }
  /**
   * Move the cursor to a specific position in the array. Requires
   * time proportional to the distance moved.
   *
   * If `n < 0`, the cursor will end up at the beginning.
   * If `n > length`, the cursor will end up at the end.
   *
   * @param {number} n
   *   Position.
   * @return {undefined}
   *   Nothing.
   */
  setCursor(t) {
    if (!(t === this.left.length || t > this.left.length && this.right.length === 0 || t < 0 && this.left.length === 0))
      if (t < this.left.length) {
        const n = this.left.splice(t, Number.POSITIVE_INFINITY);
        Mg(this.right, n.reverse());
      } else {
        const n = this.right.splice(this.left.length + this.right.length - t, Number.POSITIVE_INFINITY);
        Mg(this.left, n.reverse());
      }
  }
}
function Mg(e, t) {
  let n = 0;
  if (t.length < 1e4)
    e.push(...t);
  else
    for (; n < t.length; )
      e.push(...t.slice(n, n + 1e4)), n += 1e4;
}
function aO(e) {
  const t = {};
  let n = -1, r, i, s, o, u, c, d;
  const m = new B$(e);
  for (; ++n < m.length; ) {
    for (; n in t; )
      n = t[n];
    if (r = m.get(n), n && r[1].type === "chunkFlow" && m.get(n - 1)[1].type === "listItemPrefix" && (c = r[1]._tokenizer.events, s = 0, s < c.length && c[s][1].type === "lineEndingBlank" && (s += 2), s < c.length && c[s][1].type === "content"))
      for (; ++s < c.length && c[s][1].type !== "content"; )
        c[s][1].type === "chunkText" && (c[s][1]._isInFirstContentOfListItem = !0, s++);
    if (r[0] === "enter")
      r[1].contentType && (Object.assign(t, q$(m, n)), n = t[n], d = !0);
    else if (r[1]._container) {
      for (s = n, i = void 0; s--; )
        if (o = m.get(s), o[1].type === "lineEnding" || o[1].type === "lineEndingBlank")
          o[0] === "enter" && (i && (m.get(i)[1].type = "lineEndingBlank"), o[1].type = "lineEnding", i = s);
        else if (!(o[1].type === "linePrefix" || o[1].type === "listItemIndent")) break;
      i && (r[1].end = {
        ...m.get(i)[1].start
      }, u = m.slice(i, n), u.unshift(r), m.splice(i, n - i + 1, u));
    }
  }
  return ms(e, 0, Number.POSITIVE_INFINITY, m.slice(0)), !d;
}
function q$(e, t) {
  const n = e.get(t)[1], r = e.get(t)[2];
  let i = t - 1;
  const s = [];
  let o = n._tokenizer;
  o || (o = r.parser[n.contentType](n.start), n._contentTypeTextTrailing && (o._contentTypeTextTrailing = !0));
  const u = o.events, c = [], d = {};
  let m, p, x = -1, b = n, S = 0, k = 0;
  const A = [k];
  for (; b; ) {
    for (; e.get(++i)[1] !== b; )
      ;
    s.push(i), b._tokenizer || (m = r.sliceStream(b), b.next || m.push(null), p && o.defineSkip(b.start), b._isInFirstContentOfListItem && (o._gfmTasklistFirstContentOfListItem = !0), o.write(m), b._isInFirstContentOfListItem && (o._gfmTasklistFirstContentOfListItem = void 0)), p = b, b = b.next;
  }
  for (b = n; ++x < u.length; )
    // Find a void token that includes a break.
    u[x][0] === "exit" && u[x - 1][0] === "enter" && u[x][1].type === u[x - 1][1].type && u[x][1].start.line !== u[x][1].end.line && (k = x + 1, A.push(k), b._tokenizer = void 0, b.previous = void 0, b = b.next);
  for (o.events = [], b ? (b._tokenizer = void 0, b.previous = void 0) : A.pop(), x = A.length; x--; ) {
    const T = u.slice(A[x], A[x + 1]), M = s.pop();
    c.push([M, M + T.length - 1]), e.splice(M, 2, T);
  }
  for (c.reverse(), x = -1; ++x < c.length; )
    d[S + c[x][0]] = S + c[x][1], S += c[x][1] - c[x][0] - 1;
  return d;
}
const F$ = {
  resolve: $$,
  tokenize: V$
}, U$ = {
  partial: !0,
  tokenize: H$
};
function $$(e) {
  return aO(e), e;
}
function V$(e, t) {
  let n;
  return r;
  function r(u) {
    return e.enter("content"), n = e.enter("chunkContent", {
      contentType: "content"
    }), i(u);
  }
  function i(u) {
    return u === null ? s(u) : Nt(u) ? e.check(U$, o, s)(u) : (e.consume(u), i);
  }
  function s(u) {
    return e.exit("chunkContent"), e.exit("content"), t(u);
  }
  function o(u) {
    return e.consume(u), e.exit("chunkContent"), n.next = e.enter("chunkContent", {
      contentType: "content",
      previous: n
    }), n = n.next, i;
  }
}
function H$(e, t, n) {
  const r = this;
  return i;
  function i(o) {
    return e.exit("chunkContent"), e.enter("lineEnding"), e.consume(o), e.exit("lineEnding"), hn(e, s, "linePrefix");
  }
  function s(o) {
    if (o === null || Nt(o))
      return n(o);
    const u = r.events[r.events.length - 1];
    return !r.parser.constructs.disable.null.includes("codeIndented") && u && u[1].type === "linePrefix" && u[2].sliceSerialize(u[1], !0).length >= 4 ? t(o) : e.interrupt(r.parser.constructs.flow, n, t)(o);
  }
}
function sO(e, t, n, r, i, s, o, u, c) {
  const d = c || Number.POSITIVE_INFINITY;
  let m = 0;
  return p;
  function p(T) {
    return T === 60 ? (e.enter(r), e.enter(i), e.enter(s), e.consume(T), e.exit(s), x) : T === null || T === 32 || T === 41 || _v(T) ? n(T) : (e.enter(r), e.enter(o), e.enter(u), e.enter("chunkString", {
      contentType: "string"
    }), k(T));
  }
  function x(T) {
    return T === 62 ? (e.enter(s), e.consume(T), e.exit(s), e.exit(i), e.exit(r), t) : (e.enter(u), e.enter("chunkString", {
      contentType: "string"
    }), b(T));
  }
  function b(T) {
    return T === 62 ? (e.exit("chunkString"), e.exit(u), x(T)) : T === null || T === 60 || Nt(T) ? n(T) : (e.consume(T), T === 92 ? S : b);
  }
  function S(T) {
    return T === 60 || T === 62 || T === 92 ? (e.consume(T), b) : b(T);
  }
  function k(T) {
    return !m && (T === null || T === 41 || Fn(T)) ? (e.exit("chunkString"), e.exit(u), e.exit(o), e.exit(r), t(T)) : m < d && T === 40 ? (e.consume(T), m++, k) : T === 41 ? (e.consume(T), m--, k) : T === null || T === 32 || T === 40 || _v(T) ? n(T) : (e.consume(T), T === 92 ? A : k);
  }
  function A(T) {
    return T === 40 || T === 41 || T === 92 ? (e.consume(T), k) : k(T);
  }
}
function oO(e, t, n, r, i, s) {
  const o = this;
  let u = 0, c;
  return d;
  function d(b) {
    return e.enter(r), e.enter(i), e.consume(b), e.exit(i), e.enter(s), m;
  }
  function m(b) {
    return u > 999 || b === null || b === 91 || b === 93 && !c || // To do: remove in the future once weve switched from
    // `micromark-extension-footnote` to `micromark-extension-gfm-footnote`,
    // which doesnt need this.
    // Hidden footnotes hook.
    /* c8 ignore next 3 */
    b === 94 && !u && "_hiddenFootnoteSupport" in o.parser.constructs ? n(b) : b === 93 ? (e.exit(s), e.enter(i), e.consume(b), e.exit(i), e.exit(r), t) : Nt(b) ? (e.enter("lineEnding"), e.consume(b), e.exit("lineEnding"), m) : (e.enter("chunkString", {
      contentType: "string"
    }), p(b));
  }
  function p(b) {
    return b === null || b === 91 || b === 93 || Nt(b) || u++ > 999 ? (e.exit("chunkString"), m(b)) : (e.consume(b), c || (c = !nn(b)), b === 92 ? x : p);
  }
  function x(b) {
    return b === 91 || b === 92 || b === 93 ? (e.consume(b), u++, p) : p(b);
  }
}
function lO(e, t, n, r, i, s) {
  let o;
  return u;
  function u(x) {
    return x === 34 || x === 39 || x === 40 ? (e.enter(r), e.enter(i), e.consume(x), e.exit(i), o = x === 40 ? 41 : x, c) : n(x);
  }
  function c(x) {
    return x === o ? (e.enter(i), e.consume(x), e.exit(i), e.exit(r), t) : (e.enter(s), d(x));
  }
  function d(x) {
    return x === o ? (e.exit(s), c(o)) : x === null ? n(x) : Nt(x) ? (e.enter("lineEnding"), e.consume(x), e.exit("lineEnding"), hn(e, d, "linePrefix")) : (e.enter("chunkString", {
      contentType: "string"
    }), m(x));
  }
  function m(x) {
    return x === o || x === null || Nt(x) ? (e.exit("chunkString"), d(x)) : (e.consume(x), x === 92 ? p : m);
  }
  function p(x) {
    return x === o || x === 92 ? (e.consume(x), m) : m(x);
  }
}
function Xg(e, t) {
  let n;
  return r;
  function r(i) {
    return Nt(i) ? (e.enter("lineEnding"), e.consume(i), e.exit("lineEnding"), n = !0, r) : nn(i) ? hn(e, r, n ? "linePrefix" : "lineSuffix")(i) : t(i);
  }
}
const G$ = {
  name: "definition",
  tokenize: Y$
}, K$ = {
  partial: !0,
  tokenize: W$
};
function Y$(e, t, n) {
  const r = this;
  let i;
  return s;
  function s(b) {
    return e.enter("definition"), o(b);
  }
  function o(b) {
    return oO.call(
      r,
      e,
      u,
      // Note: we dont need to reset the way `markdown-rs` does.
      n,
      "definitionLabel",
      "definitionLabelMarker",
      "definitionLabelString"
    )(b);
  }
  function u(b) {
    return i = Ao(r.sliceSerialize(r.events[r.events.length - 1][1]).slice(1, -1)), b === 58 ? (e.enter("definitionMarker"), e.consume(b), e.exit("definitionMarker"), c) : n(b);
  }
  function c(b) {
    return Fn(b) ? Xg(e, d)(b) : d(b);
  }
  function d(b) {
    return sO(
      e,
      m,
      // Note: we dont need to reset the way `markdown-rs` does.
      n,
      "definitionDestination",
      "definitionDestinationLiteral",
      "definitionDestinationLiteralMarker",
      "definitionDestinationRaw",
      "definitionDestinationString"
    )(b);
  }
  function m(b) {
    return e.attempt(K$, p, p)(b);
  }
  function p(b) {
    return nn(b) ? hn(e, x, "whitespace")(b) : x(b);
  }
  function x(b) {
    return b === null || Nt(b) ? (e.exit("definition"), r.parser.defined.push(i), t(b)) : n(b);
  }
}
function W$(e, t, n) {
  return r;
  function r(u) {
    return Fn(u) ? Xg(e, i)(u) : n(u);
  }
  function i(u) {
    return lO(e, s, n, "definitionTitle", "definitionTitleMarker", "definitionTitleString")(u);
  }
  function s(u) {
    return nn(u) ? hn(e, o, "whitespace")(u) : o(u);
  }
  function o(u) {
    return u === null || Nt(u) ? t(u) : n(u);
  }
}
const X$ = {
  name: "hardBreakEscape",
  tokenize: Q$
};
function Q$(e, t, n) {
  return r;
  function r(s) {
    return e.enter("hardBreakEscape"), e.consume(s), i;
  }
  function i(s) {
    return Nt(s) ? (e.exit("hardBreakEscape"), t(s)) : n(s);
  }
}
const Z$ = {
  name: "headingAtx",
  resolve: J$,
  tokenize: eV
};
function J$(e, t) {
  let n = e.length - 2, r = 3, i, s;
  return e[r][1].type === "whitespace" && (r += 2), n - 2 > r && e[n][1].type === "whitespace" && (n -= 2), e[n][1].type === "atxHeadingSequence" && (r === n - 1 || n - 4 > r && e[n - 2][1].type === "whitespace") && (n -= r + 1 === n ? 2 : 4), n > r && (i = {
    type: "atxHeadingText",
    start: e[r][1].start,
    end: e[n][1].end
  }, s = {
    type: "chunkText",
    start: e[r][1].start,
    end: e[n][1].end,
    contentType: "text"
  }, ms(e, r, n - r + 1, [["enter", i, t], ["enter", s, t], ["exit", s, t], ["exit", i, t]])), e;
}
function eV(e, t, n) {
  let r = 0;
  return i;
  function i(m) {
    return e.enter("atxHeading"), s(m);
  }
  function s(m) {
    return e.enter("atxHeadingSequence"), o(m);
  }
  function o(m) {
    return m === 35 && r++ < 6 ? (e.consume(m), o) : m === null || Fn(m) ? (e.exit("atxHeadingSequence"), u(m)) : n(m);
  }
  function u(m) {
    return m === 35 ? (e.enter("atxHeadingSequence"), c(m)) : m === null || Nt(m) ? (e.exit("atxHeading"), t(m)) : nn(m) ? hn(e, u, "whitespace")(m) : (e.enter("atxHeadingText"), d(m));
  }
  function c(m) {
    return m === 35 ? (e.consume(m), c) : (e.exit("atxHeadingSequence"), u(m));
  }
  function d(m) {
    return m === null || m === 35 || Fn(m) ? (e.exit("atxHeadingText"), u(m)) : (e.consume(m), d);
  }
}
const tV = [
  "address",
  "article",
  "aside",
  "base",
  "basefont",
  "blockquote",
  "body",
  "caption",
  "center",
  "col",
  "colgroup",
  "dd",
  "details",
  "dialog",
  "dir",
  "div",
  "dl",
  "dt",
  "fieldset",
  "figcaption",
  "figure",
  "footer",
  "form",
  "frame",
  "frameset",
  "h1",
  "h2",
  "h3",
  "h4",
  "h5",
  "h6",
  "head",
  "header",
  "hr",
  "html",
  "iframe",
  "legend",
  "li",
  "link",
  "main",
  "menu",
  "menuitem",
  "nav",
  "noframes",
  "ol",
  "optgroup",
  "option",
  "p",
  "param",
  "search",
  "section",
  "summary",
  "table",
  "tbody",
  "td",
  "tfoot",
  "th",
  "thead",
  "title",
  "tr",
  "track",
  "ul"
], m6 = ["pre", "script", "style", "textarea"], nV = {
  concrete: !0,
  name: "htmlFlow",
  resolveTo: aV,
  tokenize: sV
}, rV = {
  partial: !0,
  tokenize: lV
}, iV = {
  partial: !0,
  tokenize: oV
};
function aV(e) {
  let t = e.length;
  for (; t-- && !(e[t][0] === "enter" && e[t][1].type === "htmlFlow"); )
    ;
  return t > 1 && e[t - 2][1].type === "linePrefix" && (e[t][1].start = e[t - 2][1].start, e[t + 1][1].start = e[t - 2][1].start, e.splice(t - 2, 2)), e;
}
function sV(e, t, n) {
  const r = this;
  let i, s, o, u, c;
  return d;
  function d(G) {
    return m(G);
  }
  function m(G) {
    return e.enter("htmlFlow"), e.enter("htmlFlowData"), e.consume(G), p;
  }
  function p(G) {
    return G === 33 ? (e.consume(G), x) : G === 47 ? (e.consume(G), s = !0, k) : G === 63 ? (e.consume(G), i = 3, r.interrupt ? t : W) : la(G) ? (e.consume(G), o = String.fromCharCode(G), A) : n(G);
  }
  function x(G) {
    return G === 45 ? (e.consume(G), i = 2, b) : G === 91 ? (e.consume(G), i = 5, u = 0, S) : la(G) ? (e.consume(G), i = 4, r.interrupt ? t : W) : n(G);
  }
  function b(G) {
    return G === 45 ? (e.consume(G), r.interrupt ? t : W) : n(G);
  }
  function S(G) {
    const le = "CDATA[";
    return G === le.charCodeAt(u++) ? (e.consume(G), u === le.length ? r.interrupt ? t : Z : S) : n(G);
  }
  function k(G) {
    return la(G) ? (e.consume(G), o = String.fromCharCode(G), A) : n(G);
  }
  function A(G) {
    if (G === null || G === 47 || G === 62 || Fn(G)) {
      const le = G === 47, xe = o.toLowerCase();
      return !le && !s && m6.includes(xe) ? (i = 1, r.interrupt ? t(G) : Z(G)) : tV.includes(o.toLowerCase()) ? (i = 6, le ? (e.consume(G), T) : r.interrupt ? t(G) : Z(G)) : (i = 7, r.interrupt && !r.parser.lazy[r.now().line] ? n(G) : s ? M(G) : j(G));
    }
    return G === 45 || qi(G) ? (e.consume(G), o += String.fromCharCode(G), A) : n(G);
  }
  function T(G) {
    return G === 62 ? (e.consume(G), r.interrupt ? t : Z) : n(G);
  }
  function M(G) {
    return nn(G) ? (e.consume(G), M) : Y(G);
  }
  function j(G) {
    return G === 47 ? (e.consume(G), Y) : G === 58 || G === 95 || la(G) ? (e.consume(G), D) : nn(G) ? (e.consume(G), j) : Y(G);
  }
  function D(G) {
    return G === 45 || G === 46 || G === 58 || G === 95 || qi(G) ? (e.consume(G), D) : z(G);
  }
  function z(G) {
    return G === 61 ? (e.consume(G), I) : nn(G) ? (e.consume(G), z) : j(G);
  }
  function I(G) {
    return G === null || G === 60 || G === 61 || G === 62 || G === 96 ? n(G) : G === 34 || G === 39 ? (e.consume(G), c = G, L) : nn(G) ? (e.consume(G), I) : K(G);
  }
  function L(G) {
    return G === c ? (e.consume(G), c = null, ne) : G === null || Nt(G) ? n(G) : (e.consume(G), L);
  }
  function K(G) {
    return G === null || G === 34 || G === 39 || G === 47 || G === 60 || G === 61 || G === 62 || G === 96 || Fn(G) ? z(G) : (e.consume(G), K);
  }
  function ne(G) {
    return G === 47 || G === 62 || nn(G) ? j(G) : n(G);
  }
  function Y(G) {
    return G === 62 ? (e.consume(G), H) : n(G);
  }
  function H(G) {
    return G === null || Nt(G) ? Z(G) : nn(G) ? (e.consume(G), H) : n(G);
  }
  function Z(G) {
    return G === 45 && i === 2 ? (e.consume(G), J) : G === 60 && i === 1 ? (e.consume(G), ue) : G === 62 && i === 4 ? (e.consume(G), $) : G === 63 && i === 3 ? (e.consume(G), W) : G === 93 && i === 5 ? (e.consume(G), ce) : Nt(G) && (i === 6 || i === 7) ? (e.exit("htmlFlowData"), e.check(rV, fe, me)(G)) : G === null || Nt(G) ? (e.exit("htmlFlowData"), me(G)) : (e.consume(G), Z);
  }
  function me(G) {
    return e.check(iV, Q, fe)(G);
  }
  function Q(G) {
    return e.enter("lineEnding"), e.consume(G), e.exit("lineEnding"), se;
  }
  function se(G) {
    return G === null || Nt(G) ? me(G) : (e.enter("htmlFlowData"), Z(G));
  }
  function J(G) {
    return G === 45 ? (e.consume(G), W) : Z(G);
  }
  function ue(G) {
    return G === 47 ? (e.consume(G), o = "", de) : Z(G);
  }
  function de(G) {
    if (G === 62) {
      const le = o.toLowerCase();
      return m6.includes(le) ? (e.consume(G), $) : Z(G);
    }
    return la(G) && o.length < 8 ? (e.consume(G), o += String.fromCharCode(G), de) : Z(G);
  }
  function ce(G) {
    return G === 93 ? (e.consume(G), W) : Z(G);
  }
  function W(G) {
    return G === 62 ? (e.consume(G), $) : G === 45 && i === 2 ? (e.consume(G), W) : Z(G);
  }
  function $(G) {
    return G === null || Nt(G) ? (e.exit("htmlFlowData"), fe(G)) : (e.consume(G), $);
  }
  function fe(G) {
    return e.exit("htmlFlow"), t(G);
  }
}
function oV(e, t, n) {
  const r = this;
  return i;
  function i(o) {
    return Nt(o) ? (e.enter("lineEnding"), e.consume(o), e.exit("lineEnding"), s) : n(o);
  }
  function s(o) {
    return r.parser.lazy[r.now().line] ? n(o) : t(o);
  }
}
function lV(e, t, n) {
  return r;
  function r(i) {
    return e.enter("lineEnding"), e.consume(i), e.exit("lineEnding"), e.attempt(R0, t, n);
  }
}
const uV = {
  name: "htmlText",
  tokenize: cV
};
function cV(e, t, n) {
  const r = this;
  let i, s, o;
  return u;
  function u(W) {
    return e.enter("htmlText"), e.enter("htmlTextData"), e.consume(W), c;
  }
  function c(W) {
    return W === 33 ? (e.consume(W), d) : W === 47 ? (e.consume(W), z) : W === 63 ? (e.consume(W), j) : la(W) ? (e.consume(W), K) : n(W);
  }
  function d(W) {
    return W === 45 ? (e.consume(W), m) : W === 91 ? (e.consume(W), s = 0, S) : la(W) ? (e.consume(W), M) : n(W);
  }
  function m(W) {
    return W === 45 ? (e.consume(W), b) : n(W);
  }
  function p(W) {
    return W === null ? n(W) : W === 45 ? (e.consume(W), x) : Nt(W) ? (o = p, ue(W)) : (e.consume(W), p);
  }
  function x(W) {
    return W === 45 ? (e.consume(W), b) : p(W);
  }
  function b(W) {
    return W === 62 ? J(W) : W === 45 ? x(W) : p(W);
  }
  function S(W) {
    const $ = "CDATA[";
    return W === $.charCodeAt(s++) ? (e.consume(W), s === $.length ? k : S) : n(W);
  }
  function k(W) {
    return W === null ? n(W) : W === 93 ? (e.consume(W), A) : Nt(W) ? (o = k, ue(W)) : (e.consume(W), k);
  }
  function A(W) {
    return W === 93 ? (e.consume(W), T) : k(W);
  }
  function T(W) {
    return W === 62 ? J(W) : W === 93 ? (e.consume(W), T) : k(W);
  }
  function M(W) {
    return W === null || W === 62 ? J(W) : Nt(W) ? (o = M, ue(W)) : (e.consume(W), M);
  }
  function j(W) {
    return W === null ? n(W) : W === 63 ? (e.consume(W), D) : Nt(W) ? (o = j, ue(W)) : (e.consume(W), j);
  }
  function D(W) {
    return W === 62 ? J(W) : j(W);
  }
  function z(W) {
    return la(W) ? (e.consume(W), I) : n(W);
  }
  function I(W) {
    return W === 45 || qi(W) ? (e.consume(W), I) : L(W);
  }
  function L(W) {
    return Nt(W) ? (o = L, ue(W)) : nn(W) ? (e.consume(W), L) : J(W);
  }
  function K(W) {
    return W === 45 || qi(W) ? (e.consume(W), K) : W === 47 || W === 62 || Fn(W) ? ne(W) : n(W);
  }
  function ne(W) {
    return W === 47 ? (e.consume(W), J) : W === 58 || W === 95 || la(W) ? (e.consume(W), Y) : Nt(W) ? (o = ne, ue(W)) : nn(W) ? (e.consume(W), ne) : J(W);
  }
  function Y(W) {
    return W === 45 || W === 46 || W === 58 || W === 95 || qi(W) ? (e.consume(W), Y) : H(W);
  }
  function H(W) {
    return W === 61 ? (e.consume(W), Z) : Nt(W) ? (o = H, ue(W)) : nn(W) ? (e.consume(W), H) : ne(W);
  }
  function Z(W) {
    return W === null || W === 60 || W === 61 || W === 62 || W === 96 ? n(W) : W === 34 || W === 39 ? (e.consume(W), i = W, me) : Nt(W) ? (o = Z, ue(W)) : nn(W) ? (e.consume(W), Z) : (e.consume(W), Q);
  }
  function me(W) {
    return W === i ? (e.consume(W), i = void 0, se) : W === null ? n(W) : Nt(W) ? (o = me, ue(W)) : (e.consume(W), me);
  }
  function Q(W) {
    return W === null || W === 34 || W === 39 || W === 60 || W === 61 || W === 96 ? n(W) : W === 47 || W === 62 || Fn(W) ? ne(W) : (e.consume(W), Q);
  }
  function se(W) {
    return W === 47 || W === 62 || Fn(W) ? ne(W) : n(W);
  }
  function J(W) {
    return W === 62 ? (e.consume(W), e.exit("htmlTextData"), e.exit("htmlText"), t) : n(W);
  }
  function ue(W) {
    return e.exit("htmlTextData"), e.enter("lineEnding"), e.consume(W), e.exit("lineEnding"), de;
  }
  function de(W) {
    return nn(W) ? hn(e, ce, "linePrefix", r.parser.constructs.disable.null.includes("codeIndented") ? void 0 : 4)(W) : ce(W);
  }
  function ce(W) {
    return e.enter("htmlTextData"), o(W);
  }
}
const FC = {
  name: "labelEnd",
  resolveAll: mV,
  resolveTo: pV,
  tokenize: gV
}, fV = {
  tokenize: yV
}, dV = {
  tokenize: vV
}, hV = {
  tokenize: xV
};
function mV(e) {
  let t = -1;
  const n = [];
  for (; ++t < e.length; ) {
    const r = e[t][1];
    if (n.push(e[t]), r.type === "labelImage" || r.type === "labelLink" || r.type === "labelEnd") {
      const i = r.type === "labelImage" ? 4 : 2;
      r.type = "data", t += i;
    }
  }
  return e.length !== n.length && ms(e, 0, e.length, n), e;
}
function pV(e, t) {
  let n = e.length, r = 0, i, s, o, u;
  for (; n--; )
    if (i = e[n][1], s) {
      if (i.type === "link" || i.type === "labelLink" && i._inactive)
        break;
      e[n][0] === "enter" && i.type === "labelLink" && (i._inactive = !0);
    } else if (o) {
      if (e[n][0] === "enter" && (i.type === "labelImage" || i.type === "labelLink") && !i._balanced && (s = n, i.type !== "labelLink")) {
        r = 2;
        break;
      }
    } else i.type === "labelEnd" && (o = n);
  const c = {
    type: e[s][1].type === "labelLink" ? "link" : "image",
    start: {
      ...e[s][1].start
    },
    end: {
      ...e[e.length - 1][1].end
    }
  }, d = {
    type: "label",
    start: {
      ...e[s][1].start
    },
    end: {
      ...e[o][1].end
    }
  }, m = {
    type: "labelText",
    start: {
      ...e[s + r + 2][1].end
    },
    end: {
      ...e[o - 2][1].start
    }
  };
  return u = [["enter", c, t], ["enter", d, t]], u = Ds(u, e.slice(s + 1, s + r + 3)), u = Ds(u, [["enter", m, t]]), u = Ds(u, rx(t.parser.constructs.insideSpan.null, e.slice(s + r + 4, o - 3), t)), u = Ds(u, [["exit", m, t], e[o - 2], e[o - 1], ["exit", d, t]]), u = Ds(u, e.slice(o + 1)), u = Ds(u, [["exit", c, t]]), ms(e, s, e.length, u), e;
}
function gV(e, t, n) {
  const r = this;
  let i = r.events.length, s, o;
  for (; i--; )
    if ((r.events[i][1].type === "labelImage" || r.events[i][1].type === "labelLink") && !r.events[i][1]._balanced) {
      s = r.events[i][1];
      break;
    }
  return u;
  function u(x) {
    return s ? s._inactive ? p(x) : (o = r.parser.defined.includes(Ao(r.sliceSerialize({
      start: s.end,
      end: r.now()
    }))), e.enter("labelEnd"), e.enter("labelMarker"), e.consume(x), e.exit("labelMarker"), e.exit("labelEnd"), c) : n(x);
  }
  function c(x) {
    return x === 40 ? e.attempt(fV, m, o ? m : p)(x) : x === 91 ? e.attempt(dV, m, o ? d : p)(x) : o ? m(x) : p(x);
  }
  function d(x) {
    return e.attempt(hV, m, p)(x);
  }
  function m(x) {
    return t(x);
  }
  function p(x) {
    return s._balanced = !0, n(x);
  }
}
function yV(e, t, n) {
  return r;
  function r(p) {
    return e.enter("resource"), e.enter("resourceMarker"), e.consume(p), e.exit("resourceMarker"), i;
  }
  function i(p) {
    return Fn(p) ? Xg(e, s)(p) : s(p);
  }
  function s(p) {
    return p === 41 ? m(p) : sO(e, o, u, "resourceDestination", "resourceDestinationLiteral", "resourceDestinationLiteralMarker", "resourceDestinationRaw", "resourceDestinationString", 32)(p);
  }
  function o(p) {
    return Fn(p) ? Xg(e, c)(p) : m(p);
  }
  function u(p) {
    return n(p);
  }
  function c(p) {
    return p === 34 || p === 39 || p === 40 ? lO(e, d, n, "resourceTitle", "resourceTitleMarker", "resourceTitleString")(p) : m(p);
  }
  function d(p) {
    return Fn(p) ? Xg(e, m)(p) : m(p);
  }
  function m(p) {
    return p === 41 ? (e.enter("resourceMarker"), e.consume(p), e.exit("resourceMarker"), e.exit("resource"), t) : n(p);
  }
}
function vV(e, t, n) {
  const r = this;
  return i;
  function i(u) {
    return oO.call(r, e, s, o, "reference", "referenceMarker", "referenceString")(u);
  }
  function s(u) {
    return r.parser.defined.includes(Ao(r.sliceSerialize(r.events[r.events.length - 1][1]).slice(1, -1))) ? t(u) : n(u);
  }
  function o(u) {
    return n(u);
  }
}
function xV(e, t, n) {
  return r;
  function r(s) {
    return e.enter("reference"), e.enter("referenceMarker"), e.consume(s), e.exit("referenceMarker"), i;
  }
  function i(s) {
    return s === 93 ? (e.enter("referenceMarker"), e.consume(s), e.exit("referenceMarker"), e.exit("reference"), t) : n(s);
  }
}
const bV = {
  name: "labelStartImage",
  resolveAll: FC.resolveAll,
  tokenize: wV
};
function wV(e, t, n) {
  const r = this;
  return i;
  function i(u) {
    return e.enter("labelImage"), e.enter("labelImageMarker"), e.consume(u), e.exit("labelImageMarker"), s;
  }
  function s(u) {
    return u === 91 ? (e.enter("labelMarker"), e.consume(u), e.exit("labelMarker"), e.exit("labelImage"), o) : n(u);
  }
  function o(u) {
    return u === 94 && "_hiddenFootnoteSupport" in r.parser.constructs ? n(u) : t(u);
  }
}
const _V = {
  name: "labelStartLink",
  resolveAll: FC.resolveAll,
  tokenize: SV
};
function SV(e, t, n) {
  const r = this;
  return i;
  function i(o) {
    return e.enter("labelLink"), e.enter("labelMarker"), e.consume(o), e.exit("labelMarker"), e.exit("labelLink"), s;
  }
  function s(o) {
    return o === 94 && "_hiddenFootnoteSupport" in r.parser.constructs ? n(o) : t(o);
  }
}
const Wb = {
  name: "lineEnding",
  tokenize: CV
};
function CV(e, t) {
  return n;
  function n(r) {
    return e.enter("lineEnding"), e.consume(r), e.exit("lineEnding"), hn(e, t, "linePrefix");
  }
}
const iv = {
  name: "thematicBreak",
  tokenize: EV
};
function EV(e, t, n) {
  let r = 0, i;
  return s;
  function s(d) {
    return e.enter("thematicBreak"), o(d);
  }
  function o(d) {
    return i = d, u(d);
  }
  function u(d) {
    return d === i ? (e.enter("thematicBreakSequence"), c(d)) : r >= 3 && (d === null || Nt(d)) ? (e.exit("thematicBreak"), t(d)) : n(d);
  }
  function c(d) {
    return d === i ? (e.consume(d), r++, c) : (e.exit("thematicBreakSequence"), nn(d) ? hn(e, u, "whitespace")(d) : u(d));
  }
}
const La = {
  continuation: {
    tokenize: AV
  },
  exit: MV,
  name: "list",
  tokenize: NV
}, kV = {
  partial: !0,
  tokenize: RV
}, TV = {
  partial: !0,
  tokenize: jV
};
function NV(e, t, n) {
  const r = this, i = r.events[r.events.length - 1];
  let s = i && i[1].type === "linePrefix" ? i[2].sliceSerialize(i[1], !0).length : 0, o = 0;
  return u;
  function u(b) {
    const S = r.containerState.type || (b === 42 || b === 43 || b === 45 ? "listUnordered" : "listOrdered");
    if (S === "listUnordered" ? !r.containerState.marker || b === r.containerState.marker : y5(b)) {
      if (r.containerState.type || (r.containerState.type = S, e.enter(S, {
        _container: !0
      })), S === "listUnordered")
        return e.enter("listItemPrefix"), b === 42 || b === 45 ? e.check(iv, n, d)(b) : d(b);
      if (!r.interrupt || b === 49)
        return e.enter("listItemPrefix"), e.enter("listItemValue"), c(b);
    }
    return n(b);
  }
  function c(b) {
    return y5(b) && ++o < 10 ? (e.consume(b), c) : (!r.interrupt || o < 2) && (r.containerState.marker ? b === r.containerState.marker : b === 41 || b === 46) ? (e.exit("listItemValue"), d(b)) : n(b);
  }
  function d(b) {
    return e.enter("listItemMarker"), e.consume(b), e.exit("listItemMarker"), r.containerState.marker = r.containerState.marker || b, e.check(
      R0,
      // Cant be empty when interrupting.
      r.interrupt ? n : m,
      e.attempt(kV, x, p)
    );
  }
  function m(b) {
    return r.containerState.initialBlankLine = !0, s++, x(b);
  }
  function p(b) {
    return nn(b) ? (e.enter("listItemPrefixWhitespace"), e.consume(b), e.exit("listItemPrefixWhitespace"), x) : n(b);
  }
  function x(b) {
    return r.containerState.size = s + r.sliceSerialize(e.exit("listItemPrefix"), !0).length, t(b);
  }
}
function AV(e, t, n) {
  const r = this;
  return r.containerState._closeFlow = void 0, e.check(R0, i, s);
  function i(u) {
    return r.containerState.furtherBlankLines = r.containerState.furtherBlankLines || r.containerState.initialBlankLine, hn(e, t, "listItemIndent", r.containerState.size + 1)(u);
  }
  function s(u) {
    return r.containerState.furtherBlankLines || !nn(u) ? (r.containerState.furtherBlankLines = void 0, r.containerState.initialBlankLine = void 0, o(u)) : (r.containerState.furtherBlankLines = void 0, r.containerState.initialBlankLine = void 0, e.attempt(TV, t, o)(u));
  }
  function o(u) {
    return r.containerState._closeFlow = !0, r.interrupt = void 0, hn(e, e.attempt(La, t, n), "linePrefix", r.parser.constructs.disable.null.includes("codeIndented") ? void 0 : 4)(u);
  }
}
function jV(e, t, n) {
  const r = this;
  return hn(e, i, "listItemIndent", r.containerState.size + 1);
  function i(s) {
    const o = r.events[r.events.length - 1];
    return o && o[1].type === "listItemIndent" && o[2].sliceSerialize(o[1], !0).length === r.containerState.size ? t(s) : n(s);
  }
}
function MV(e) {
  e.exit(this.containerState.type);
}
function RV(e, t, n) {
  const r = this;
  return hn(e, i, "listItemPrefixWhitespace", r.parser.constructs.disable.null.includes("codeIndented") ? void 0 : 5);
  function i(s) {
    const o = r.events[r.events.length - 1];
    return !nn(s) && o && o[1].type === "listItemPrefixWhitespace" ? t(s) : n(s);
  }
}
const p6 = {
  name: "setextUnderline",
  resolveTo: OV,
  tokenize: DV
};
function OV(e, t) {
  let n = e.length, r, i, s;
  for (; n--; )
    if (e[n][0] === "enter") {
      if (e[n][1].type === "content") {
        r = n;
        break;
      }
      e[n][1].type === "paragraph" && (i = n);
    } else
      e[n][1].type === "content" && e.splice(n, 1), !s && e[n][1].type === "definition" && (s = n);
  const o = {
    type: "setextHeading",
    start: {
      ...e[r][1].start
    },
    end: {
      ...e[e.length - 1][1].end
    }
  };
  return e[i][1].type = "setextHeadingText", s ? (e.splice(i, 0, ["enter", o, t]), e.splice(s + 1, 0, ["exit", e[r][1], t]), e[r][1].end = {
    ...e[s][1].end
  }) : e[r][1] = o, e.push(["exit", o, t]), e;
}
function DV(e, t, n) {
  const r = this;
  let i;
  return s;
  function s(d) {
    let m = r.events.length, p;
    for (; m--; )
      if (r.events[m][1].type !== "lineEnding" && r.events[m][1].type !== "linePrefix" && r.events[m][1].type !== "content") {
        p = r.events[m][1].type === "paragraph";
        break;
      }
    return !r.parser.lazy[r.now().line] && (r.interrupt || p) ? (e.enter("setextHeadingLine"), i = d, o(d)) : n(d);
  }
  function o(d) {
    return e.enter("setextHeadingLineSequence"), u(d);
  }
  function u(d) {
    return d === i ? (e.consume(d), u) : (e.exit("setextHeadingLineSequence"), nn(d) ? hn(e, c, "lineSuffix")(d) : c(d));
  }
  function c(d) {
    return d === null || Nt(d) ? (e.exit("setextHeadingLine"), t(d)) : n(d);
  }
}
const IV = {
  tokenize: PV
};
function PV(e) {
  const t = this, n = e.attempt(
    // Try to parse a blank line.
    R0,
    r,
    // Try to parse initial flow (essentially, only code).
    e.attempt(this.parser.constructs.flowInitial, i, hn(e, e.attempt(this.parser.constructs.flow, i, e.attempt(F$, i)), "linePrefix"))
  );
  return n;
  function r(s) {
    if (s === null) {
      e.consume(s);
      return;
    }
    return e.enter("lineEndingBlank"), e.consume(s), e.exit("lineEndingBlank"), t.currentConstruct = void 0, n;
  }
  function i(s) {
    if (s === null) {
      e.consume(s);
      return;
    }
    return e.enter("lineEnding"), e.consume(s), e.exit("lineEnding"), t.currentConstruct = void 0, n;
  }
}
const zV = {
  resolveAll: cO()
}, LV = uO("string"), BV = uO("text");
function uO(e) {
  return {
    resolveAll: cO(e === "text" ? qV : void 0),
    tokenize: t
  };
  function t(n) {
    const r = this, i = this.parser.constructs[e], s = n.attempt(i, o, u);
    return o;
    function o(m) {
      return d(m) ? s(m) : u(m);
    }
    function u(m) {
      if (m === null) {
        n.consume(m);
        return;
      }
      return n.enter("data"), n.consume(m), c;
    }
    function c(m) {
      return d(m) ? (n.exit("data"), s(m)) : (n.consume(m), c);
    }
    function d(m) {
      if (m === null)
        return !0;
      const p = i[m];
      let x = -1;
      if (p)
        for (; ++x < p.length; ) {
          const b = p[x];
          if (!b.previous || b.previous.call(r, r.previous))
            return !0;
        }
      return !1;
    }
  }
}
function cO(e) {
  return t;
  function t(n, r) {
    let i = -1, s;
    for (; ++i <= n.length; )
      s === void 0 ? n[i] && n[i][1].type === "data" && (s = i, i++) : (!n[i] || n[i][1].type !== "data") && (i !== s + 2 && (n[s][1].end = n[i - 1][1].end, n.splice(s + 2, i - s - 2), i = s + 2), s = void 0);
    return e ? e(n, r) : n;
  }
}
function qV(e, t) {
  let n = 0;
  for (; ++n <= e.length; )
    if ((n === e.length || e[n][1].type === "lineEnding") && e[n - 1][1].type === "data") {
      const r = e[n - 1][1], i = t.sliceStream(r);
      let s = i.length, o = -1, u = 0, c;
      for (; s--; ) {
        const d = i[s];
        if (typeof d == "string") {
          for (o = d.length; d.charCodeAt(o - 1) === 32; )
            u++, o--;
          if (o) break;
          o = -1;
        } else if (d === -2)
          c = !0, u++;
        else if (d !== -1) {
          s++;
          break;
        }
      }
      if (t._contentTypeTextTrailing && n === e.length && (u = 0), u) {
        const d = {
          type: n === e.length || c || u < 2 ? "lineSuffix" : "hardBreakTrailing",
          start: {
            _bufferIndex: s ? o : r.start._bufferIndex + o,
            _index: r.start._index + s,
            line: r.end.line,
            column: r.end.column - u,
            offset: r.end.offset - u
          },
          end: {
            ...r.end
          }
        };
        r.end = {
          ...d.start
        }, r.start.offset === r.end.offset ? Object.assign(r, d) : (e.splice(n, 0, ["enter", d, t], ["exit", d, t]), n += 2);
      }
      n++;
    }
  return e;
}
const FV = {
  42: La,
  43: La,
  45: La,
  48: La,
  49: La,
  50: La,
  51: La,
  52: La,
  53: La,
  54: La,
  55: La,
  56: La,
  57: La,
  62: nO
}, UV = {
  91: G$
}, $V = {
  [-2]: Yb,
  [-1]: Yb,
  32: Yb
}, VV = {
  35: Z$,
  42: iv,
  45: [p6, iv],
  60: nV,
  61: p6,
  95: iv,
  96: h6,
  126: h6
}, HV = {
  38: iO,
  92: rO
}, GV = {
  [-5]: Wb,
  [-4]: Wb,
  [-3]: Wb,
  33: bV,
  38: iO,
  42: v5,
  60: [_$, uV],
  91: _V,
  92: [X$, rO],
  93: FC,
  95: v5,
  96: I$
}, KV = {
  null: [v5, zV]
}, YV = {
  null: [42, 95]
}, WV = {
  null: []
}, XV = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  attentionMarkers: YV,
  contentInitial: UV,
  disable: WV,
  document: FV,
  flow: VV,
  flowInitial: $V,
  insideSpan: KV,
  string: HV,
  text: GV
}, Symbol.toStringTag, { value: "Module" }));
function QV(e, t, n) {
  let r = {
    _bufferIndex: -1,
    _index: 0,
    line: n && n.line || 1,
    column: n && n.column || 1,
    offset: n && n.offset || 0
  };
  const i = {}, s = [];
  let o = [], u = [];
  const c = {
    attempt: L(z),
    check: L(I),
    consume: M,
    enter: j,
    exit: D,
    interrupt: L(I, {
      interrupt: !0
    })
  }, d = {
    code: null,
    containerState: {},
    defineSkip: k,
    events: [],
    now: S,
    parser: e,
    previous: null,
    sliceSerialize: x,
    sliceStream: b,
    write: p
  };
  let m = t.tokenize.call(d, c);
  return t.resolveAll && s.push(t), d;
  function p(H) {
    return o = Ds(o, H), A(), o[o.length - 1] !== null ? [] : (K(t, 0), d.events = rx(s, d.events, d), d.events);
  }
  function x(H, Z) {
    return JV(b(H), Z);
  }
  function b(H) {
    return ZV(o, H);
  }
  function S() {
    const {
      _bufferIndex: H,
      _index: Z,
      line: me,
      column: Q,
      offset: se
    } = r;
    return {
      _bufferIndex: H,
      _index: Z,
      line: me,
      column: Q,
      offset: se
    };
  }
  function k(H) {
    i[H.line] = H.column, Y();
  }
  function A() {
    let H;
    for (; r._index < o.length; ) {
      const Z = o[r._index];
      if (typeof Z == "string")
        for (H = r._index, r._bufferIndex < 0 && (r._bufferIndex = 0); r._index === H && r._bufferIndex < Z.length; )
          T(Z.charCodeAt(r._bufferIndex));
      else
        T(Z);
    }
  }
  function T(H) {
    m = m(H);
  }
  function M(H) {
    Nt(H) ? (r.line++, r.column = 1, r.offset += H === -3 ? 2 : 1, Y()) : H !== -1 && (r.column++, r.offset++), r._bufferIndex < 0 ? r._index++ : (r._bufferIndex++, r._bufferIndex === // Points w/ non-negative `_bufferIndex` reference
    // strings.
    /** @type {string} */
    o[r._index].length && (r._bufferIndex = -1, r._index++)), d.previous = H;
  }
  function j(H, Z) {
    const me = Z || {};
    return me.type = H, me.start = S(), d.events.push(["enter", me, d]), u.push(me), me;
  }
  function D(H) {
    const Z = u.pop();
    return Z.end = S(), d.events.push(["exit", Z, d]), Z;
  }
  function z(H, Z) {
    K(H, Z.from);
  }
  function I(H, Z) {
    Z.restore();
  }
  function L(H, Z) {
    return me;
    function me(Q, se, J) {
      let ue, de, ce, W;
      return Array.isArray(Q) ? (
        /* c8 ignore next 1 */
        fe(Q)
      ) : "tokenize" in Q ? (
        // Looks like a construct.
        fe([
          /** @type {Construct} */
          Q
        ])
      ) : $(Q);
      function $(Se) {
        return Oe;
        function Oe(Be) {
          const Re = Be !== null && Se[Be], ft = Be !== null && Se.null, Ie = [
            // To do: add more extension tests.
            /* c8 ignore next 2 */
            ...Array.isArray(Re) ? Re : Re ? [Re] : [],
            ...Array.isArray(ft) ? ft : ft ? [ft] : []
          ];
          return fe(Ie)(Be);
        }
      }
      function fe(Se) {
        return ue = Se, de = 0, Se.length === 0 ? J : G(Se[de]);
      }
      function G(Se) {
        return Oe;
        function Oe(Be) {
          return W = ne(), ce = Se, Se.partial || (d.currentConstruct = Se), Se.name && d.parser.constructs.disable.null.includes(Se.name) ? xe() : Se.tokenize.call(
            // If we do have fields, create an object w/ `context` as its
            // prototype.
            // This allows a live binding, which is needed for `interrupt`.
            Z ? Object.assign(Object.create(d), Z) : d,
            c,
            le,
            xe
          )(Be);
        }
      }
      function le(Se) {
        return H(ce, W), se;
      }
      function xe(Se) {
        return W.restore(), ++de < ue.length ? G(ue[de]) : J;
      }
    }
  }
  function K(H, Z) {
    H.resolveAll && !s.includes(H) && s.push(H), H.resolve && ms(d.events, Z, d.events.length - Z, H.resolve(d.events.slice(Z), d)), H.resolveTo && (d.events = H.resolveTo(d.events, d));
  }
  function ne() {
    const H = S(), Z = d.previous, me = d.currentConstruct, Q = d.events.length, se = Array.from(u);
    return {
      from: Q,
      restore: J
    };
    function J() {
      r = H, d.previous = Z, d.currentConstruct = me, d.events.length = Q, u = se, Y();
    }
  }
  function Y() {
    r.line in i && r.column < 2 && (r.column = i[r.line], r.offset += i[r.line] - 1);
  }
}
function ZV(e, t) {
  const n = t.start._index, r = t.start._bufferIndex, i = t.end._index, s = t.end._bufferIndex;
  let o;
  if (n === i)
    o = [e[n].slice(r, s)];
  else {
    if (o = e.slice(n, i), r > -1) {
      const u = o[0];
      typeof u == "string" ? o[0] = u.slice(r) : o.shift();
    }
    s > 0 && o.push(e[i].slice(0, s));
  }
  return o;
}
function JV(e, t) {
  let n = -1;
  const r = [];
  let i;
  for (; ++n < e.length; ) {
    const s = e[n];
    let o;
    if (typeof s == "string")
      o = s;
    else switch (s) {
      case -5: {
        o = "\r";
        break;
      }
      case -4: {
        o = `
`;
        break;
      }
      case -3: {
        o = `\r
`;
        break;
      }
      case -2: {
        o = t ? " " : "	";
        break;
      }
      case -1: {
        if (!t && i) continue;
        o = " ";
        break;
      }
      default:
        o = String.fromCharCode(s);
    }
    i = s === -2, r.push(o);
  }
  return r.join("");
}
function eH(e) {
  const r = {
    constructs: (
      /** @type {FullNormalizedExtension} */
      eO([XV, ...(e || {}).extensions || []])
    ),
    content: i(p$),
    defined: [],
    document: i(y$),
    flow: i(IV),
    lazy: {},
    string: i(LV),
    text: i(BV)
  };
  return r;
  function i(s) {
    return o;
    function o(u) {
      return QV(r, s, u);
    }
  }
}
function tH(e) {
  for (; !aO(e); )
    ;
  return e;
}
const g6 = /[\0\t\n\r]/g;
function nH() {
  let e = 1, t = "", n = !0, r;
  return i;
  function i(s, o, u) {
    const c = [];
    let d, m, p, x, b;
    for (s = t + (typeof s == "string" ? s.toString() : new TextDecoder(o || void 0).decode(s)), p = 0, t = "", n && (s.charCodeAt(0) === 65279 && p++, n = void 0); p < s.length; ) {
      if (g6.lastIndex = p, d = g6.exec(s), x = d && d.index !== void 0 ? d.index : s.length, b = s.charCodeAt(x), !d) {
        t = s.slice(p);
        break;
      }
      if (b === 10 && p === x && r)
        c.push(-3), r = void 0;
      else
        switch (r && (c.push(-5), r = void 0), p < x && (c.push(s.slice(p, x)), e += x - p), b) {
          case 0: {
            c.push(65533), e++;
            break;
          }
          case 9: {
            for (m = Math.ceil(e / 4) * 4, c.push(-2); e++ < m; ) c.push(-1);
            break;
          }
          case 10: {
            c.push(-4), e = 1;
            break;
          }
          default:
            r = !0, e = 1;
        }
      p = x + 1;
    }
    return u && (r && c.push(-5), t && c.push(t), c.push(null)), c;
  }
}
const rH = /\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;
function iH(e) {
  return e.replace(rH, aH);
}
function aH(e, t, n) {
  if (t)
    return t;
  if (n.charCodeAt(0) === 35) {
    const i = n.charCodeAt(1), s = i === 120 || i === 88;
    return tO(n.slice(s ? 2 : 1), s ? 16 : 10);
  }
  return qC(n) || e;
}
const fO = {}.hasOwnProperty;
function sH(e, t, n) {
  return typeof t != "string" && (n = t, t = void 0), oH(n)(tH(eH(n).document().write(nH()(e, t, !0))));
}
function oH(e) {
  const t = {
    transforms: [],
    canContainEols: ["emphasis", "fragment", "heading", "paragraph", "strong"],
    enter: {
      autolink: s(Rn),
      autolinkProtocol: ne,
      autolinkEmail: ne,
      atxHeading: s(tt),
      blockQuote: s(ft),
      characterEscape: ne,
      characterReference: ne,
      codeFenced: s(Ie),
      codeFencedFenceInfo: o,
      codeFencedFenceMeta: o,
      codeIndented: s(Ie, o),
      codeText: s(Ne, o),
      codeTextData: ne,
      data: ne,
      codeFlowValue: ne,
      definition: s(Ue),
      definitionDestinationString: o,
      definitionLabelString: o,
      definitionTitleString: o,
      emphasis: s(et),
      hardBreakEscape: s(st),
      hardBreakTrailing: s(st),
      htmlFlow: s(dt, o),
      htmlFlowData: ne,
      htmlText: s(dt, o),
      htmlTextData: ne,
      image: s(Wn),
      label: o,
      link: s(Rn),
      listItem: s(Ht),
      listItemValue: x,
      listOrdered: s(Un, p),
      listUnordered: s(Un),
      paragraph: s(On),
      reference: G,
      referenceString: o,
      resourceDestinationString: o,
      resourceTitleString: o,
      setextHeading: s(tt),
      strong: s(an),
      thematicBreak: s(Xn)
    },
    exit: {
      atxHeading: c(),
      atxHeadingSequence: z,
      autolink: c(),
      autolinkEmail: Re,
      autolinkProtocol: Be,
      blockQuote: c(),
      characterEscapeValue: Y,
      characterReferenceMarkerHexadecimal: xe,
      characterReferenceMarkerNumeric: xe,
      characterReferenceValue: Se,
      characterReference: Oe,
      codeFenced: c(A),
      codeFencedFence: k,
      codeFencedFenceInfo: b,
      codeFencedFenceMeta: S,
      codeFlowValue: Y,
      codeIndented: c(T),
      codeText: c(se),
      codeTextData: Y,
      data: Y,
      definition: c(),
      definitionDestinationString: D,
      definitionLabelString: M,
      definitionTitleString: j,
      emphasis: c(),
      hardBreakEscape: c(Z),
      hardBreakTrailing: c(Z),
      htmlFlow: c(me),
      htmlFlowData: Y,
      htmlText: c(Q),
      htmlTextData: Y,
      image: c(ue),
      label: ce,
      labelText: de,
      lineEnding: H,
      link: c(J),
      listItem: c(),
      listOrdered: c(),
      listUnordered: c(),
      paragraph: c(),
      referenceString: le,
      resourceDestinationString: W,
      resourceTitleString: $,
      resource: fe,
      setextHeading: c(K),
      setextHeadingLineSequence: L,
      setextHeadingText: I,
      strong: c(),
      thematicBreak: c()
    }
  };
  dO(t, (e || {}).mdastExtensions || []);
  const n = {};
  return r;
  function r(Fe) {
    let Qe = {
      type: "root",
      children: []
    };
    const yt = {
      stack: [Qe],
      tokenStack: [],
      config: t,
      enter: u,
      exit: d,
      buffer: o,
      resume: m,
      data: n
    }, Tt = [];
    let Pt = -1;
    for (; ++Pt < Fe.length; )
      if (Fe[Pt][1].type === "listOrdered" || Fe[Pt][1].type === "listUnordered")
        if (Fe[Pt][0] === "enter")
          Tt.push(Pt);
        else {
          const $n = Tt.pop();
          Pt = i(Fe, $n, Pt);
        }
    for (Pt = -1; ++Pt < Fe.length; ) {
      const $n = t[Fe[Pt][0]];
      fO.call($n, Fe[Pt][1].type) && $n[Fe[Pt][1].type].call(Object.assign({
        sliceSerialize: Fe[Pt][2].sliceSerialize
      }, yt), Fe[Pt][1]);
    }
    if (yt.tokenStack.length > 0) {
      const $n = yt.tokenStack[yt.tokenStack.length - 1];
      ($n[1] || y6).call(yt, void 0, $n[0]);
    }
    for (Qe.position = {
      start: Mc(Fe.length > 0 ? Fe[0][1].start : {
        line: 1,
        column: 1,
        offset: 0
      }),
      end: Mc(Fe.length > 0 ? Fe[Fe.length - 2][1].end : {
        line: 1,
        column: 1,
        offset: 0
      })
    }, Pt = -1; ++Pt < t.transforms.length; )
      Qe = t.transforms[Pt](Qe) || Qe;
    return Qe;
  }
  function i(Fe, Qe, yt) {
    let Tt = Qe - 1, Pt = -1, $n = !1, Vn, sn, Qt, kn;
    for (; ++Tt <= yt; ) {
      const it = Fe[Tt];
      switch (it[1].type) {
        case "listUnordered":
        case "listOrdered":
        case "blockQuote": {
          it[0] === "enter" ? Pt++ : Pt--, kn = void 0;
          break;
        }
        case "lineEndingBlank": {
          it[0] === "enter" && (Vn && !kn && !Pt && !Qt && (Qt = Tt), kn = void 0);
          break;
        }
        case "linePrefix":
        case "listItemValue":
        case "listItemMarker":
        case "listItemPrefix":
        case "listItemPrefixWhitespace":
          break;
        default:
          kn = void 0;
      }
      if (!Pt && it[0] === "enter" && it[1].type === "listItemPrefix" || Pt === -1 && it[0] === "exit" && (it[1].type === "listUnordered" || it[1].type === "listOrdered")) {
        if (Vn) {
          let jr = Tt;
          for (sn = void 0; jr--; ) {
            const fr = Fe[jr];
            if (fr[1].type === "lineEnding" || fr[1].type === "lineEndingBlank") {
              if (fr[0] === "exit") continue;
              sn && (Fe[sn][1].type = "lineEndingBlank", $n = !0), fr[1].type = "lineEnding", sn = jr;
            } else if (!(fr[1].type === "linePrefix" || fr[1].type === "blockQuotePrefix" || fr[1].type === "blockQuotePrefixWhitespace" || fr[1].type === "blockQuoteMarker" || fr[1].type === "listItemIndent")) break;
          }
          Qt && (!sn || Qt < sn) && (Vn._spread = !0), Vn.end = Object.assign({}, sn ? Fe[sn][1].start : it[1].end), Fe.splice(sn || Tt, 0, ["exit", Vn, it[2]]), Tt++, yt++;
        }
        if (it[1].type === "listItemPrefix") {
          const jr = {
            type: "listItem",
            _spread: !1,
            start: Object.assign({}, it[1].start),
            // @ts-expect-error: well add `end` in a second.
            end: void 0
          };
          Vn = jr, Fe.splice(Tt, 0, ["enter", jr, it[2]]), Tt++, yt++, Qt = void 0, kn = !0;
        }
      }
    }
    return Fe[Qe][1]._spread = $n, yt;
  }
  function s(Fe, Qe) {
    return yt;
    function yt(Tt) {
      u.call(this, Fe(Tt), Tt), Qe && Qe.call(this, Tt);
    }
  }
  function o() {
    this.stack.push({
      type: "fragment",
      children: []
    });
  }
  function u(Fe, Qe, yt) {
    this.stack[this.stack.length - 1].children.push(Fe), this.stack.push(Fe), this.tokenStack.push([Qe, yt || void 0]), Fe.position = {
      start: Mc(Qe.start),
      // @ts-expect-error: `end` will be patched later.
      end: void 0
    };
  }
  function c(Fe) {
    return Qe;
    function Qe(yt) {
      Fe && Fe.call(this, yt), d.call(this, yt);
    }
  }
  function d(Fe, Qe) {
    const yt = this.stack.pop(), Tt = this.tokenStack.pop();
    if (Tt)
      Tt[0].type !== Fe.type && (Qe ? Qe.call(this, Fe, Tt[0]) : (Tt[1] || y6).call(this, Fe, Tt[0]));
    else throw new Error("Cannot close `" + Fe.type + "` (" + Wg({
      start: Fe.start,
      end: Fe.end
    }) + "): its not open");
    yt.position.end = Mc(Fe.end);
  }
  function m() {
    return BC(this.stack.pop());
  }
  function p() {
    this.data.expectingFirstListItemValue = !0;
  }
  function x(Fe) {
    if (this.data.expectingFirstListItemValue) {
      const Qe = this.stack[this.stack.length - 2];
      Qe.start = Number.parseInt(this.sliceSerialize(Fe), 10), this.data.expectingFirstListItemValue = void 0;
    }
  }
  function b() {
    const Fe = this.resume(), Qe = this.stack[this.stack.length - 1];
    Qe.lang = Fe;
  }
  function S() {
    const Fe = this.resume(), Qe = this.stack[this.stack.length - 1];
    Qe.meta = Fe;
  }
  function k() {
    this.data.flowCodeInside || (this.buffer(), this.data.flowCodeInside = !0);
  }
  function A() {
    const Fe = this.resume(), Qe = this.stack[this.stack.length - 1];
    Qe.value = Fe.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g, ""), this.data.flowCodeInside = void 0;
  }
  function T() {
    const Fe = this.resume(), Qe = this.stack[this.stack.length - 1];
    Qe.value = Fe.replace(/(\r?\n|\r)$/g, "");
  }
  function M(Fe) {
    const Qe = this.resume(), yt = this.stack[this.stack.length - 1];
    yt.label = Qe, yt.identifier = Ao(this.sliceSerialize(Fe)).toLowerCase();
  }
  function j() {
    const Fe = this.resume(), Qe = this.stack[this.stack.length - 1];
    Qe.title = Fe;
  }
  function D() {
    const Fe = this.resume(), Qe = this.stack[this.stack.length - 1];
    Qe.url = Fe;
  }
  function z(Fe) {
    const Qe = this.stack[this.stack.length - 1];
    if (!Qe.depth) {
      const yt = this.sliceSerialize(Fe).length;
      Qe.depth = yt;
    }
  }
  function I() {
    this.data.setextHeadingSlurpLineEnding = !0;
  }
  function L(Fe) {
    const Qe = this.stack[this.stack.length - 1];
    Qe.depth = this.sliceSerialize(Fe).codePointAt(0) === 61 ? 1 : 2;
  }
  function K() {
    this.data.setextHeadingSlurpLineEnding = void 0;
  }
  function ne(Fe) {
    const yt = this.stack[this.stack.length - 1].children;
    let Tt = yt[yt.length - 1];
    (!Tt || Tt.type !== "text") && (Tt = En(), Tt.position = {
      start: Mc(Fe.start),
      // @ts-expect-error: well add `end` later.
      end: void 0
    }, yt.push(Tt)), this.stack.push(Tt);
  }
  function Y(Fe) {
    const Qe = this.stack.pop();
    Qe.value += this.sliceSerialize(Fe), Qe.position.end = Mc(Fe.end);
  }
  function H(Fe) {
    const Qe = this.stack[this.stack.length - 1];
    if (this.data.atHardBreak) {
      const yt = Qe.children[Qe.children.length - 1];
      yt.position.end = Mc(Fe.end), this.data.atHardBreak = void 0;
      return;
    }
    !this.data.setextHeadingSlurpLineEnding && t.canContainEols.includes(Qe.type) && (ne.call(this, Fe), Y.call(this, Fe));
  }
  function Z() {
    this.data.atHardBreak = !0;
  }
  function me() {
    const Fe = this.resume(), Qe = this.stack[this.stack.length - 1];
    Qe.value = Fe;
  }
  function Q() {
    const Fe = this.resume(), Qe = this.stack[this.stack.length - 1];
    Qe.value = Fe;
  }
  function se() {
    const Fe = this.resume(), Qe = this.stack[this.stack.length - 1];
    Qe.value = Fe;
  }
  function J() {
    const Fe = this.stack[this.stack.length - 1];
    if (this.data.inReference) {
      const Qe = this.data.referenceType || "shortcut";
      Fe.type += "Reference", Fe.referenceType = Qe, delete Fe.url, delete Fe.title;
    } else
      delete Fe.identifier, delete Fe.label;
    this.data.referenceType = void 0;
  }
  function ue() {
    const Fe = this.stack[this.stack.length - 1];
    if (this.data.inReference) {
      const Qe = this.data.referenceType || "shortcut";
      Fe.type += "Reference", Fe.referenceType = Qe, delete Fe.url, delete Fe.title;
    } else
      delete Fe.identifier, delete Fe.label;
    this.data.referenceType = void 0;
  }
  function de(Fe) {
    const Qe = this.sliceSerialize(Fe), yt = this.stack[this.stack.length - 2];
    yt.label = iH(Qe), yt.identifier = Ao(Qe).toLowerCase();
  }
  function ce() {
    const Fe = this.stack[this.stack.length - 1], Qe = this.resume(), yt = this.stack[this.stack.length - 1];
    if (this.data.inReference = !0, yt.type === "link") {
      const Tt = Fe.children;
      yt.children = Tt;
    } else
      yt.alt = Qe;
  }
  function W() {
    const Fe = this.resume(), Qe = this.stack[this.stack.length - 1];
    Qe.url = Fe;
  }
  function $() {
    const Fe = this.resume(), Qe = this.stack[this.stack.length - 1];
    Qe.title = Fe;
  }
  function fe() {
    this.data.inReference = void 0;
  }
  function G() {
    this.data.referenceType = "collapsed";
  }
  function le(Fe) {
    const Qe = this.resume(), yt = this.stack[this.stack.length - 1];
    yt.label = Qe, yt.identifier = Ao(this.sliceSerialize(Fe)).toLowerCase(), this.data.referenceType = "full";
  }
  function xe(Fe) {
    this.data.characterReferenceType = Fe.type;
  }
  function Se(Fe) {
    const Qe = this.sliceSerialize(Fe), yt = this.data.characterReferenceType;
    let Tt;
    yt ? (Tt = tO(Qe, yt === "characterReferenceMarkerNumeric" ? 10 : 16), this.data.characterReferenceType = void 0) : Tt = qC(Qe);
    const Pt = this.stack[this.stack.length - 1];
    Pt.value += Tt;
  }
  function Oe(Fe) {
    const Qe = this.stack.pop();
    Qe.position.end = Mc(Fe.end);
  }
  function Be(Fe) {
    Y.call(this, Fe);
    const Qe = this.stack[this.stack.length - 1];
    Qe.url = this.sliceSerialize(Fe);
  }
  function Re(Fe) {
    Y.call(this, Fe);
    const Qe = this.stack[this.stack.length - 1];
    Qe.url = "mailto:" + this.sliceSerialize(Fe);
  }
  function ft() {
    return {
      type: "blockquote",
      children: []
    };
  }
  function Ie() {
    return {
      type: "code",
      lang: null,
      meta: null,
      value: ""
    };
  }
  function Ne() {
    return {
      type: "inlineCode",
      value: ""
    };
  }
  function Ue() {
    return {
      type: "definition",
      identifier: "",
      label: null,
      title: null,
      url: ""
    };
  }
  function et() {
    return {
      type: "emphasis",
      children: []
    };
  }
  function tt() {
    return {
      type: "heading",
      // @ts-expect-error `depth` will be set later.
      depth: 0,
      children: []
    };
  }
  function st() {
    return {
      type: "break"
    };
  }
  function dt() {
    return {
      type: "html",
      value: ""
    };
  }
  function Wn() {
    return {
      type: "image",
      title: null,
      url: "",
      alt: null
    };
  }
  function Rn() {
    return {
      type: "link",
      title: null,
      url: "",
      children: []
    };
  }
  function Un(Fe) {
    return {
      type: "list",
      ordered: Fe.type === "listOrdered",
      start: null,
      spread: Fe._spread,
      children: []
    };
  }
  function Ht(Fe) {
    return {
      type: "listItem",
      spread: Fe._spread,
      checked: null,
      children: []
    };
  }
  function On() {
    return {
      type: "paragraph",
      children: []
    };
  }
  function an() {
    return {
      type: "strong",
      children: []
    };
  }
  function En() {
    return {
      type: "text",
      value: ""
    };
  }
  function Xn() {
    return {
      type: "thematicBreak"
    };
  }
}
function Mc(e) {
  return {
    line: e.line,
    column: e.column,
    offset: e.offset
  };
}
function dO(e, t) {
  let n = -1;
  for (; ++n < t.length; ) {
    const r = t[n];
    Array.isArray(r) ? dO(e, r) : lH(e, r);
  }
}
function lH(e, t) {
  let n;
  for (n in t)
    if (fO.call(t, n))
      switch (n) {
        case "canContainEols": {
          const r = t[n];
          r && e[n].push(...r);
          break;
        }
        case "transforms": {
          const r = t[n];
          r && e[n].push(...r);
          break;
        }
        case "enter":
        case "exit": {
          const r = t[n];
          r && Object.assign(e[n], r);
          break;
        }
      }
}
function y6(e, t) {
  throw e ? new Error("Cannot close `" + e.type + "` (" + Wg({
    start: e.start,
    end: e.end
  }) + "): a different token (`" + t.type + "`, " + Wg({
    start: t.start,
    end: t.end
  }) + ") is open") : new Error("Cannot close document, a token (`" + t.type + "`, " + Wg({
    start: t.start,
    end: t.end
  }) + ") is still open");
}
function uH(e) {
  const t = this;
  t.parser = n;
  function n(r) {
    return sH(r, {
      ...t.data("settings"),
      ...e,
      // Note: these options are not in the readme.
      // The goal is for them to be set by plugins on `data` instead of being
      // passed by users.
      extensions: t.data("micromarkExtensions") || [],
      mdastExtensions: t.data("fromMarkdownExtensions") || []
    });
  }
}
function cH(e, t) {
  const n = {
    type: "element",
    tagName: "blockquote",
    properties: {},
    children: e.wrap(e.all(t), !0)
  };
  return e.patch(t, n), e.applyData(t, n);
}
function fH(e, t) {
  const n = { type: "element", tagName: "br", properties: {}, children: [] };
  return e.patch(t, n), [e.applyData(t, n), { type: "text", value: `
` }];
}
function dH(e, t) {
  const n = t.value ? t.value + `
` : "", r = {}, i = t.lang ? t.lang.split(/\s+/) : [];
  i.length > 0 && (r.className = ["language-" + i[0]]);
  let s = {
    type: "element",
    tagName: "code",
    properties: r,
    children: [{ type: "text", value: n }]
  };
  return t.meta && (s.data = { meta: t.meta }), e.patch(t, s), s = e.applyData(t, s), s = { type: "element", tagName: "pre", properties: {}, children: [s] }, e.patch(t, s), s;
}
function hH(e, t) {
  const n = {
    type: "element",
    tagName: "del",
    properties: {},
    children: e.all(t)
  };
  return e.patch(t, n), e.applyData(t, n);
}
function mH(e, t) {
  const n = {
    type: "element",
    tagName: "em",
    properties: {},
    children: e.all(t)
  };
  return e.patch(t, n), e.applyData(t, n);
}
function pH(e, t) {
  const n = typeof e.options.clobberPrefix == "string" ? e.options.clobberPrefix : "user-content-", r = String(t.identifier).toUpperCase(), i = qm(r.toLowerCase()), s = e.footnoteOrder.indexOf(r);
  let o, u = e.footnoteCounts.get(r);
  u === void 0 ? (u = 0, e.footnoteOrder.push(r), o = e.footnoteOrder.length) : o = s + 1, u += 1, e.footnoteCounts.set(r, u);
  const c = {
    type: "element",
    tagName: "a",
    properties: {
      href: "#" + n + "fn-" + i,
      id: n + "fnref-" + i + (u > 1 ? "-" + u : ""),
      dataFootnoteRef: !0,
      ariaDescribedBy: ["footnote-label"]
    },
    children: [{ type: "text", value: String(o) }]
  };
  e.patch(t, c);
  const d = {
    type: "element",
    tagName: "sup",
    properties: {},
    children: [c]
  };
  return e.patch(t, d), e.applyData(t, d);
}
function gH(e, t) {
  const n = {
    type: "element",
    tagName: "h" + t.depth,
    properties: {},
    children: e.all(t)
  };
  return e.patch(t, n), e.applyData(t, n);
}
function yH(e, t) {
  if (e.options.allowDangerousHtml) {
    const n = { type: "raw", value: t.value };
    return e.patch(t, n), e.applyData(t, n);
  }
}
function hO(e, t) {
  const n = t.referenceType;
  let r = "]";
  if (n === "collapsed" ? r += "[]" : n === "full" && (r += "[" + (t.label || t.identifier) + "]"), t.type === "imageReference")
    return [{ type: "text", value: "![" + t.alt + r }];
  const i = e.all(t), s = i[0];
  s && s.type === "text" ? s.value = "[" + s.value : i.unshift({ type: "text", value: "[" });
  const o = i[i.length - 1];
  return o && o.type === "text" ? o.value += r : i.push({ type: "text", value: r }), i;
}
function vH(e, t) {
  const n = String(t.identifier).toUpperCase(), r = e.definitionById.get(n);
  if (!r)
    return hO(e, t);
  const i = { src: qm(r.url || ""), alt: t.alt };
  r.title !== null && r.title !== void 0 && (i.title = r.title);
  const s = { type: "element", tagName: "img", properties: i, children: [] };
  return e.patch(t, s), e.applyData(t, s);
}
function xH(e, t) {
  const n = { src: qm(t.url) };
  t.alt !== null && t.alt !== void 0 && (n.alt = t.alt), t.title !== null && t.title !== void 0 && (n.title = t.title);
  const r = { type: "element", tagName: "img", properties: n, children: [] };
  return e.patch(t, r), e.applyData(t, r);
}
function bH(e, t) {
  const n = { type: "text", value: t.value.replace(/\r?\n|\r/g, " ") };
  e.patch(t, n);
  const r = {
    type: "element",
    tagName: "code",
    properties: {},
    children: [n]
  };
  return e.patch(t, r), e.applyData(t, r);
}
function wH(e, t) {
  const n = String(t.identifier).toUpperCase(), r = e.definitionById.get(n);
  if (!r)
    return hO(e, t);
  const i = { href: qm(r.url || "") };
  r.title !== null && r.title !== void 0 && (i.title = r.title);
  const s = {
    type: "element",
    tagName: "a",
    properties: i,
    children: e.all(t)
  };
  return e.patch(t, s), e.applyData(t, s);
}
function _H(e, t) {
  const n = { href: qm(t.url) };
  t.title !== null && t.title !== void 0 && (n.title = t.title);
  const r = {
    type: "element",
    tagName: "a",
    properties: n,
    children: e.all(t)
  };
  return e.patch(t, r), e.applyData(t, r);
}
function SH(e, t, n) {
  const r = e.all(t), i = n ? CH(n) : mO(t), s = {}, o = [];
  if (typeof t.checked == "boolean") {
    const m = r[0];
    let p;
    m && m.type === "element" && m.tagName === "p" ? p = m : (p = { type: "element", tagName: "p", properties: {}, children: [] }, r.unshift(p)), p.children.length > 0 && p.children.unshift({ type: "text", value: " " }), p.children.unshift({
      type: "element",
      tagName: "input",
      properties: { type: "checkbox", checked: t.checked, disabled: !0 },
      children: []
    }), s.className = ["task-list-item"];
  }
  let u = -1;
  for (; ++u < r.length; ) {
    const m = r[u];
    (i || u !== 0 || m.type !== "element" || m.tagName !== "p") && o.push({ type: "text", value: `
` }), m.type === "element" && m.tagName === "p" && !i ? o.push(...m.children) : o.push(m);
  }
  const c = r[r.length - 1];
  c && (i || c.type !== "element" || c.tagName !== "p") && o.push({ type: "text", value: `
` });
  const d = { type: "element", tagName: "li", properties: s, children: o };
  return e.patch(t, d), e.applyData(t, d);
}
function CH(e) {
  let t = !1;
  if (e.type === "list") {
    t = e.spread || !1;
    const n = e.children;
    let r = -1;
    for (; !t && ++r < n.length; )
      t = mO(n[r]);
  }
  return t;
}
function mO(e) {
  const t = e.spread;
  return t ?? e.children.length > 1;
}
function EH(e, t) {
  const n = {}, r = e.all(t);
  let i = -1;
  for (typeof t.start == "number" && t.start !== 1 && (n.start = t.start); ++i < r.length; ) {
    const o = r[i];
    if (o.type === "element" && o.tagName === "li" && o.properties && Array.isArray(o.properties.className) && o.properties.className.includes("task-list-item")) {
      n.className = ["contains-task-list"];
      break;
    }
  }
  const s = {
    type: "element",
    tagName: t.ordered ? "ol" : "ul",
    properties: n,
    children: e.wrap(r, !0)
  };
  return e.patch(t, s), e.applyData(t, s);
}
function kH(e, t) {
  const n = {
    type: "element",
    tagName: "p",
    properties: {},
    children: e.all(t)
  };
  return e.patch(t, n), e.applyData(t, n);
}
function TH(e, t) {
  const n = { type: "root", children: e.wrap(e.all(t)) };
  return e.patch(t, n), e.applyData(t, n);
}
function NH(e, t) {
  const n = {
    type: "element",
    tagName: "strong",
    properties: {},
    children: e.all(t)
  };
  return e.patch(t, n), e.applyData(t, n);
}
function AH(e, t) {
  const n = e.all(t), r = n.shift(), i = [];
  if (r) {
    const o = {
      type: "element",
      tagName: "thead",
      properties: {},
      children: e.wrap([r], !0)
    };
    e.patch(t.children[0], o), i.push(o);
  }
  if (n.length > 0) {
    const o = {
      type: "element",
      tagName: "tbody",
      properties: {},
      children: e.wrap(n, !0)
    }, u = IC(t.children[1]), c = KR(t.children[t.children.length - 1]);
    u && c && (o.position = { start: u, end: c }), i.push(o);
  }
  const s = {
    type: "element",
    tagName: "table",
    properties: {},
    children: e.wrap(i, !0)
  };
  return e.patch(t, s), e.applyData(t, s);
}
function jH(e, t, n) {
  const r = n ? n.children : void 0, s = (r ? r.indexOf(t) : 1) === 0 ? "th" : "td", o = n && n.type === "table" ? n.align : void 0, u = o ? o.length : t.children.length;
  let c = -1;
  const d = [];
  for (; ++c < u; ) {
    const p = t.children[c], x = {}, b = o ? o[c] : void 0;
    b && (x.align = b);
    let S = { type: "element", tagName: s, properties: x, children: [] };
    p && (S.children = e.all(p), e.patch(p, S), S = e.applyData(p, S)), d.push(S);
  }
  const m = {
    type: "element",
    tagName: "tr",
    properties: {},
    children: e.wrap(d, !0)
  };
  return e.patch(t, m), e.applyData(t, m);
}
function MH(e, t) {
  const n = {
    type: "element",
    tagName: "td",
    // Assume body cell.
    properties: {},
    children: e.all(t)
  };
  return e.patch(t, n), e.applyData(t, n);
}
const v6 = 9, x6 = 32;
function RH(e) {
  const t = String(e), n = /\r?\n|\r/g;
  let r = n.exec(t), i = 0;
  const s = [];
  for (; r; )
    s.push(
      b6(t.slice(i, r.index), i > 0, !0),
      r[0]
    ), i = r.index + r[0].length, r = n.exec(t);
  return s.push(b6(t.slice(i), i > 0, !1)), s.join("");
}
function b6(e, t, n) {
  let r = 0, i = e.length;
  if (t) {
    let s = e.codePointAt(r);
    for (; s === v6 || s === x6; )
      r++, s = e.codePointAt(r);
  }
  if (n) {
    let s = e.codePointAt(i - 1);
    for (; s === v6 || s === x6; )
      i--, s = e.codePointAt(i - 1);
  }
  return i > r ? e.slice(r, i) : "";
}
function OH(e, t) {
  const n = { type: "text", value: RH(String(t.value)) };
  return e.patch(t, n), e.applyData(t, n);
}
function DH(e, t) {
  const n = {
    type: "element",
    tagName: "hr",
    properties: {},
    children: []
  };
  return e.patch(t, n), e.applyData(t, n);
}
const IH = {
  blockquote: cH,
  break: fH,
  code: dH,
  delete: hH,
  emphasis: mH,
  footnoteReference: pH,
  heading: gH,
  html: yH,
  imageReference: vH,
  image: xH,
  inlineCode: bH,
  linkReference: wH,
  link: _H,
  listItem: SH,
  list: EH,
  paragraph: kH,
  // @ts-expect-error: root is different, but hard to type.
  root: TH,
  strong: NH,
  table: AH,
  tableCell: MH,
  tableRow: jH,
  text: OH,
  thematicBreak: DH,
  toml: z1,
  yaml: z1,
  definition: z1,
  footnoteDefinition: z1
};
function z1() {
}
const pO = -1, ix = 0, Qg = 1, Sv = 2, UC = 3, $C = 4, VC = 5, HC = 6, gO = 7, yO = 8, w6 = typeof self == "object" ? self : globalThis, PH = (e, t) => {
  const n = (i, s) => (e.set(s, i), i), r = (i) => {
    if (e.has(i))
      return e.get(i);
    const [s, o] = t[i];
    switch (s) {
      case ix:
      case pO:
        return n(o, i);
      case Qg: {
        const u = n([], i);
        for (const c of o)
          u.push(r(c));
        return u;
      }
      case Sv: {
        const u = n({}, i);
        for (const [c, d] of o)
          u[r(c)] = r(d);
        return u;
      }
      case UC:
        return n(new Date(o), i);
      case $C: {
        const { source: u, flags: c } = o;
        return n(new RegExp(u, c), i);
      }
      case VC: {
        const u = n(/* @__PURE__ */ new Map(), i);
        for (const [c, d] of o)
          u.set(r(c), r(d));
        return u;
      }
      case HC: {
        const u = n(/* @__PURE__ */ new Set(), i);
        for (const c of o)
          u.add(r(c));
        return u;
      }
      case gO: {
        const { name: u, message: c } = o;
        return n(new w6[u](c), i);
      }
      case yO:
        return n(BigInt(o), i);
      case "BigInt":
        return n(Object(BigInt(o)), i);
      case "ArrayBuffer":
        return n(new Uint8Array(o).buffer, o);
      case "DataView": {
        const { buffer: u } = new Uint8Array(o);
        return n(new DataView(u), o);
      }
    }
    return n(new w6[s](o), i);
  };
  return r;
}, _6 = (e) => PH(/* @__PURE__ */ new Map(), e)(0), am = "", { toString: zH } = {}, { keys: LH } = Object, Rg = (e) => {
  const t = typeof e;
  if (t !== "object" || !e)
    return [ix, t];
  const n = zH.call(e).slice(8, -1);
  switch (n) {
    case "Array":
      return [Qg, am];
    case "Object":
      return [Sv, am];
    case "Date":
      return [UC, am];
    case "RegExp":
      return [$C, am];
    case "Map":
      return [VC, am];
    case "Set":
      return [HC, am];
    case "DataView":
      return [Qg, n];
  }
  return n.includes("Array") ? [Qg, n] : n.includes("Error") ? [gO, n] : [Sv, n];
}, L1 = ([e, t]) => e === ix && (t === "function" || t === "symbol"), BH = (e, t, n, r) => {
  const i = (o, u) => {
    const c = r.push(o) - 1;
    return n.set(u, c), c;
  }, s = (o) => {
    if (n.has(o))
      return n.get(o);
    let [u, c] = Rg(o);
    switch (u) {
      case ix: {
        let m = o;
        switch (c) {
          case "bigint":
            u = yO, m = o.toString();
            break;
          case "function":
          case "symbol":
            if (e)
              throw new TypeError("unable to serialize " + c);
            m = null;
            break;
          case "undefined":
            return i([pO], o);
        }
        return i([u, m], o);
      }
      case Qg: {
        if (c) {
          let x = o;
          return c === "DataView" ? x = new Uint8Array(o.buffer) : c === "ArrayBuffer" && (x = new Uint8Array(o)), i([c, [...x]], o);
        }
        const m = [], p = i([u, m], o);
        for (const x of o)
          m.push(s(x));
        return p;
      }
      case Sv: {
        if (c)
          switch (c) {
            case "BigInt":
              return i([c, o.toString()], o);
            case "Boolean":
            case "Number":
            case "String":
              return i([c, o.valueOf()], o);
          }
        if (t && "toJSON" in o)
          return s(o.toJSON());
        const m = [], p = i([u, m], o);
        for (const x of LH(o))
          (e || !L1(Rg(o[x]))) && m.push([s(x), s(o[x])]);
        return p;
      }
      case UC:
        return i([u, o.toISOString()], o);
      case $C: {
        const { source: m, flags: p } = o;
        return i([u, { source: m, flags: p }], o);
      }
      case VC: {
        const m = [], p = i([u, m], o);
        for (const [x, b] of o)
          (e || !(L1(Rg(x)) || L1(Rg(b)))) && m.push([s(x), s(b)]);
        return p;
      }
      case HC: {
        const m = [], p = i([u, m], o);
        for (const x of o)
          (e || !L1(Rg(x))) && m.push(s(x));
        return p;
      }
    }
    const { message: d } = o;
    return i([u, { name: c, message: d }], o);
  };
  return s;
}, S6 = (e, { json: t, lossy: n } = {}) => {
  const r = [];
  return BH(!(t || n), !!t, /* @__PURE__ */ new Map(), r)(e), r;
}, Cv = typeof structuredClone == "function" ? (
  /* c8 ignore start */
  (e, t) => t && ("json" in t || "lossy" in t) ? _6(S6(e, t)) : structuredClone(e)
) : (e, t) => _6(S6(e, t));
function qH(e, t) {
  const n = [{ type: "text", value: "" }];
  return t > 1 && n.push({
    type: "element",
    tagName: "sup",
    properties: {},
    children: [{ type: "text", value: String(t) }]
  }), n;
}
function FH(e, t) {
  return "Back to reference " + (e + 1) + (t > 1 ? "-" + t : "");
}
function UH(e) {
  const t = typeof e.options.clobberPrefix == "string" ? e.options.clobberPrefix : "user-content-", n = e.options.footnoteBackContent || qH, r = e.options.footnoteBackLabel || FH, i = e.options.footnoteLabel || "Footnotes", s = e.options.footnoteLabelTagName || "h2", o = e.options.footnoteLabelProperties || {
    className: ["sr-only"]
  }, u = [];
  let c = -1;
  for (; ++c < e.footnoteOrder.length; ) {
    const d = e.footnoteById.get(
      e.footnoteOrder[c]
    );
    if (!d)
      continue;
    const m = e.all(d), p = String(d.identifier).toUpperCase(), x = qm(p.toLowerCase());
    let b = 0;
    const S = [], k = e.footnoteCounts.get(p);
    for (; k !== void 0 && ++b <= k; ) {
      S.length > 0 && S.push({ type: "text", value: " " });
      let M = typeof n == "string" ? n : n(c, b);
      typeof M == "string" && (M = { type: "text", value: M }), S.push({
        type: "element",
        tagName: "a",
        properties: {
          href: "#" + t + "fnref-" + x + (b > 1 ? "-" + b : ""),
          dataFootnoteBackref: "",
          ariaLabel: typeof r == "string" ? r : r(c, b),
          className: ["data-footnote-backref"]
        },
        children: Array.isArray(M) ? M : [M]
      });
    }
    const A = m[m.length - 1];
    if (A && A.type === "element" && A.tagName === "p") {
      const M = A.children[A.children.length - 1];
      M && M.type === "text" ? M.value += " " : A.children.push({ type: "text", value: " " }), A.children.push(...S);
    } else
      m.push(...S);
    const T = {
      type: "element",
      tagName: "li",
      properties: { id: t + "fn-" + x },
      children: e.wrap(m, !0)
    };
    e.patch(d, T), u.push(T);
  }
  if (u.length !== 0)
    return {
      type: "element",
      tagName: "section",
      properties: { dataFootnotes: !0, className: ["footnotes"] },
      children: [
        {
          type: "element",
          tagName: s,
          properties: {
            ...Cv(o),
            id: "footnote-label"
          },
          children: [{ type: "text", value: i }]
        },
        { type: "text", value: `
` },
        {
          type: "element",
          tagName: "ol",
          properties: {},
          children: e.wrap(u, !0)
        },
        { type: "text", value: `
` }
      ]
    };
}
const ax = (
  // Note: overloads in JSDoc cant yet use different `@template`s.
  /**
   * @type {(
   *   (<Condition extends string>(test: Condition) => (node: unknown, index?: number | null | undefined, parent?: Parent | null | undefined, context?: unknown) => node is Node & {type: Condition}) &
   *   (<Condition extends Props>(test: Condition) => (node: unknown, index?: number | null | undefined, parent?: Parent | null | undefined, context?: unknown) => node is Node & Condition) &
   *   (<Condition extends TestFunction>(test: Condition) => (node: unknown, index?: number | null | undefined, parent?: Parent | null | undefined, context?: unknown) => node is Node & Predicate<Condition, Node>) &
   *   ((test?: null | undefined) => (node?: unknown, index?: number | null | undefined, parent?: Parent | null | undefined, context?: unknown) => node is Node) &
   *   ((test?: Test) => Check)
   * )}
   */
  /**
   * @param {Test} [test]
   * @returns {Check}
   */
  (function(e) {
    if (e == null)
      return GH;
    if (typeof e == "function")
      return sx(e);
    if (typeof e == "object")
      return Array.isArray(e) ? $H(e) : (
        // Cast because `ReadonlyArray` goes into the above but `isArray`
        // narrows to `Array`.
        VH(
          /** @type {Props} */
          e
        )
      );
    if (typeof e == "string")
      return HH(e);
    throw new Error("Expected function, string, or object as test");
  })
);
function $H(e) {
  const t = [];
  let n = -1;
  for (; ++n < e.length; )
    t[n] = ax(e[n]);
  return sx(r);
  function r(...i) {
    let s = -1;
    for (; ++s < t.length; )
      if (t[s].apply(this, i)) return !0;
    return !1;
  }
}
function VH(e) {
  const t = (
    /** @type {Record<string, unknown>} */
    e
  );
  return sx(n);
  function n(r) {
    const i = (
      /** @type {Record<string, unknown>} */
      /** @type {unknown} */
      r
    );
    let s;
    for (s in e)
      if (i[s] !== t[s]) return !1;
    return !0;
  }
}
function HH(e) {
  return sx(t);
  function t(n) {
    return n && n.type === e;
  }
}
function sx(e) {
  return t;
  function t(n, r, i) {
    return !!(KH(n) && e.call(
      this,
      n,
      typeof r == "number" ? r : void 0,
      i || void 0
    ));
  }
}
function GH() {
  return !0;
}
function KH(e) {
  return e !== null && typeof e == "object" && "type" in e;
}
const vO = [], YH = !0, x5 = !1, WH = "skip";
function xO(e, t, n, r) {
  let i;
  typeof t == "function" && typeof n != "function" ? (r = n, n = t) : i = t;
  const s = ax(i), o = r ? -1 : 1;
  u(e, void 0, [])();
  function u(c, d, m) {
    const p = (
      /** @type {Record<string, unknown>} */
      c && typeof c == "object" ? c : {}
    );
    if (typeof p.type == "string") {
      const b = (
        // `hast`
        typeof p.tagName == "string" ? p.tagName : (
          // `xast`
          typeof p.name == "string" ? p.name : void 0
        )
      );
      Object.defineProperty(x, "name", {
        value: "node (" + (c.type + (b ? "<" + b + ">" : "")) + ")"
      });
    }
    return x;
    function x() {
      let b = vO, S, k, A;
      if ((!t || s(c, d, m[m.length - 1] || void 0)) && (b = XH(n(c, m)), b[0] === x5))
        return b;
      if ("children" in c && c.children) {
        const T = (
          /** @type {UnistParent} */
          c
        );
        if (T.children && b[0] !== WH)
          for (k = (r ? T.children.length : -1) + o, A = m.concat(T); k > -1 && k < T.children.length; ) {
            const M = T.children[k];
            if (S = u(M, k, A)(), S[0] === x5)
              return S;
            k = typeof S[1] == "number" ? S[1] : k + o;
          }
      }
      return b;
    }
  }
}
function XH(e) {
  return Array.isArray(e) ? e : typeof e == "number" ? [YH, e] : e == null ? vO : [e];
}
function GC(e, t, n, r) {
  let i, s, o;
  typeof t == "function" && typeof n != "function" ? (s = void 0, o = t, i = n) : (s = t, o = n, i = r), xO(e, s, u, i);
  function u(c, d) {
    const m = d[d.length - 1], p = m ? m.children.indexOf(c) : void 0;
    return o(c, p, m);
  }
}
const b5 = {}.hasOwnProperty, QH = {};
function ZH(e, t) {
  const n = t || QH, r = /* @__PURE__ */ new Map(), i = /* @__PURE__ */ new Map(), s = /* @__PURE__ */ new Map(), o = { ...IH, ...n.handlers }, u = {
    all: d,
    applyData: eG,
    definitionById: r,
    footnoteById: i,
    footnoteCounts: s,
    footnoteOrder: [],
    handlers: o,
    one: c,
    options: n,
    patch: JH,
    wrap: nG
  };
  return GC(e, function(m) {
    if (m.type === "definition" || m.type === "footnoteDefinition") {
      const p = m.type === "definition" ? r : i, x = String(m.identifier).toUpperCase();
      p.has(x) || p.set(x, m);
    }
  }), u;
  function c(m, p) {
    const x = m.type, b = u.handlers[x];
    if (b5.call(u.handlers, x) && b)
      return b(u, m, p);
    if (u.options.passThrough && u.options.passThrough.includes(x)) {
      if ("children" in m) {
        const { children: k, ...A } = m, T = Cv(A);
        return T.children = u.all(m), T;
      }
      return Cv(m);
    }
    return (u.options.unknownHandler || tG)(u, m, p);
  }
  function d(m) {
    const p = [];
    if ("children" in m) {
      const x = m.children;
      let b = -1;
      for (; ++b < x.length; ) {
        const S = u.one(x[b], m);
        if (S) {
          if (b && x[b - 1].type === "break" && (!Array.isArray(S) && S.type === "text" && (S.value = C6(S.value)), !Array.isArray(S) && S.type === "element")) {
            const k = S.children[0];
            k && k.type === "text" && (k.value = C6(k.value));
          }
          Array.isArray(S) ? p.push(...S) : p.push(S);
        }
      }
    }
    return p;
  }
}
function JH(e, t) {
  e.position && (t.position = FU(e));
}
function eG(e, t) {
  let n = t;
  if (e && e.data) {
    const r = e.data.hName, i = e.data.hChildren, s = e.data.hProperties;
    if (typeof r == "string")
      if (n.type === "element")
        n.tagName = r;
      else {
        const o = "children" in n ? n.children : [n];
        n = { type: "element", tagName: r, properties: {}, children: o };
      }
    n.type === "element" && s && Object.assign(n.properties, Cv(s)), "children" in n && n.children && i !== null && i !== void 0 && (n.children = i);
  }
  return n;
}
function tG(e, t) {
  const n = t.data || {}, r = "value" in t && !(b5.call(n, "hProperties") || b5.call(n, "hChildren")) ? { type: "text", value: t.value } : {
    type: "element",
    tagName: "div",
    properties: {},
    children: e.all(t)
  };
  return e.patch(t, r), e.applyData(t, r);
}
function nG(e, t) {
  const n = [];
  let r = -1;
  for (t && n.push({ type: "text", value: `
` }); ++r < e.length; )
    r && n.push({ type: "text", value: `
` }), n.push(e[r]);
  return t && e.length > 0 && n.push({ type: "text", value: `
` }), n;
}
function C6(e) {
  let t = 0, n = e.charCodeAt(t);
  for (; n === 9 || n === 32; )
    t++, n = e.charCodeAt(t);
  return e.slice(t);
}
function E6(e, t) {
  const n = ZH(e, t), r = n.one(e, void 0), i = UH(n), s = Array.isArray(r) ? { type: "root", children: r } : r || { type: "root", children: [] };
  return i && s.children.push({ type: "text", value: `
` }, i), s;
}
function rG(e, t) {
  return e && "run" in e ? async function(n, r) {
    const i = (
      /** @type {HastRoot} */
      E6(n, { file: r, ...t })
    );
    await e.run(i, r);
  } : function(n, r) {
    return (
      /** @type {HastRoot} */
      E6(n, { file: r, ...e || t })
    );
  };
}
function k6(e) {
  if (e)
    throw e;
}
var Xb, T6;
function iG() {
  if (T6) return Xb;
  T6 = 1;
  var e = Object.prototype.hasOwnProperty, t = Object.prototype.toString, n = Object.defineProperty, r = Object.getOwnPropertyDescriptor, i = function(d) {
    return typeof Array.isArray == "function" ? Array.isArray(d) : t.call(d) === "[object Array]";
  }, s = function(d) {
    if (!d || t.call(d) !== "[object Object]")
      return !1;
    var m = e.call(d, "constructor"), p = d.constructor && d.constructor.prototype && e.call(d.constructor.prototype, "isPrototypeOf");
    if (d.constructor && !m && !p)
      return !1;
    var x;
    for (x in d)
      ;
    return typeof x > "u" || e.call(d, x);
  }, o = function(d, m) {
    n && m.name === "__proto__" ? n(d, m.name, {
      enumerable: !0,
      configurable: !0,
      value: m.newValue,
      writable: !0
    }) : d[m.name] = m.newValue;
  }, u = function(d, m) {
    if (m === "__proto__")
      if (e.call(d, m)) {
        if (r)
          return r(d, m).value;
      } else return;
    return d[m];
  };
  return Xb = function c() {
    var d, m, p, x, b, S, k = arguments[0], A = 1, T = arguments.length, M = !1;
    for (typeof k == "boolean" && (M = k, k = arguments[1] || {}, A = 2), (k == null || typeof k != "object" && typeof k != "function") && (k = {}); A < T; ++A)
      if (d = arguments[A], d != null)
        for (m in d)
          p = u(k, m), x = u(d, m), k !== x && (M && x && (s(x) || (b = i(x))) ? (b ? (b = !1, S = p && i(p) ? p : []) : S = p && s(p) ? p : {}, o(k, { name: m, newValue: c(M, S, x) })) : typeof x < "u" && o(k, { name: m, newValue: x }));
    return k;
  }, Xb;
}
var aG = iG();
const Qb = /* @__PURE__ */ Uc(aG);
function w5(e) {
  if (typeof e != "object" || e === null)
    return !1;
  const t = Object.getPrototypeOf(e);
  return (t === null || t === Object.prototype || Object.getPrototypeOf(t) === null) && !(Symbol.toStringTag in e) && !(Symbol.iterator in e);
}
function sG() {
  const e = [], t = { run: n, use: r };
  return t;
  function n(...i) {
    let s = -1;
    const o = i.pop();
    if (typeof o != "function")
      throw new TypeError("Expected function as last argument, not " + o);
    u(null, ...i);
    function u(c, ...d) {
      const m = e[++s];
      let p = -1;
      if (c) {
        o(c);
        return;
      }
      for (; ++p < i.length; )
        (d[p] === null || d[p] === void 0) && (d[p] = i[p]);
      i = d, m ? oG(m, u)(...d) : o(null, ...d);
    }
  }
  function r(i) {
    if (typeof i != "function")
      throw new TypeError(
        "Expected `middelware` to be a function, not " + i
      );
    return e.push(i), t;
  }
}
function oG(e, t) {
  let n;
  return r;
  function r(...o) {
    const u = e.length > o.length;
    let c;
    u && o.push(i);
    try {
      c = e.apply(this, o);
    } catch (d) {
      const m = (
        /** @type {Error} */
        d
      );
      if (u && n)
        throw m;
      return i(m);
    }
    u || (c && c.then && typeof c.then == "function" ? c.then(s, i) : c instanceof Error ? i(c) : s(c));
  }
  function i(o, ...u) {
    n || (n = !0, t(o, ...u));
  }
  function s(o) {
    i(null, o);
  }
}
const Sl = { basename: lG, dirname: uG, extname: cG, join: fG, sep: "/" };
function lG(e, t) {
  if (t !== void 0 && typeof t != "string")
    throw new TypeError('"ext" argument must be a string');
  O0(e);
  let n = 0, r = -1, i = e.length, s;
  if (t === void 0 || t.length === 0 || t.length > e.length) {
    for (; i--; )
      if (e.codePointAt(i) === 47) {
        if (s) {
          n = i + 1;
          break;
        }
      } else r < 0 && (s = !0, r = i + 1);
    return r < 0 ? "" : e.slice(n, r);
  }
  if (t === e)
    return "";
  let o = -1, u = t.length - 1;
  for (; i--; )
    if (e.codePointAt(i) === 47) {
      if (s) {
        n = i + 1;
        break;
      }
    } else
      o < 0 && (s = !0, o = i + 1), u > -1 && (e.codePointAt(i) === t.codePointAt(u--) ? u < 0 && (r = i) : (u = -1, r = o));
  return n === r ? r = o : r < 0 && (r = e.length), e.slice(n, r);
}
function uG(e) {
  if (O0(e), e.length === 0)
    return ".";
  let t = -1, n = e.length, r;
  for (; --n; )
    if (e.codePointAt(n) === 47) {
      if (r) {
        t = n;
        break;
      }
    } else r || (r = !0);
  return t < 0 ? e.codePointAt(0) === 47 ? "/" : "." : t === 1 && e.codePointAt(0) === 47 ? "//" : e.slice(0, t);
}
function cG(e) {
  O0(e);
  let t = e.length, n = -1, r = 0, i = -1, s = 0, o;
  for (; t--; ) {
    const u = e.codePointAt(t);
    if (u === 47) {
      if (o) {
        r = t + 1;
        break;
      }
      continue;
    }
    n < 0 && (o = !0, n = t + 1), u === 46 ? i < 0 ? i = t : s !== 1 && (s = 1) : i > -1 && (s = -1);
  }
  return i < 0 || n < 0 || // We saw a non-dot character immediately before the dot.
  s === 0 || // The (right-most) trimmed path component is exactly `..`.
  s === 1 && i === n - 1 && i === r + 1 ? "" : e.slice(i, n);
}
function fG(...e) {
  let t = -1, n;
  for (; ++t < e.length; )
    O0(e[t]), e[t] && (n = n === void 0 ? e[t] : n + "/" + e[t]);
  return n === void 0 ? "." : dG(n);
}
function dG(e) {
  O0(e);
  const t = e.codePointAt(0) === 47;
  let n = hG(e, !t);
  return n.length === 0 && !t && (n = "."), n.length > 0 && e.codePointAt(e.length - 1) === 47 && (n += "/"), t ? "/" + n : n;
}
function hG(e, t) {
  let n = "", r = 0, i = -1, s = 0, o = -1, u, c;
  for (; ++o <= e.length; ) {
    if (o < e.length)
      u = e.codePointAt(o);
    else {
      if (u === 47)
        break;
      u = 47;
    }
    if (u === 47) {
      if (!(i === o - 1 || s === 1)) if (i !== o - 1 && s === 2) {
        if (n.length < 2 || r !== 2 || n.codePointAt(n.length - 1) !== 46 || n.codePointAt(n.length - 2) !== 46) {
          if (n.length > 2) {
            if (c = n.lastIndexOf("/"), c !== n.length - 1) {
              c < 0 ? (n = "", r = 0) : (n = n.slice(0, c), r = n.length - 1 - n.lastIndexOf("/")), i = o, s = 0;
              continue;
            }
          } else if (n.length > 0) {
            n = "", r = 0, i = o, s = 0;
            continue;
          }
        }
        t && (n = n.length > 0 ? n + "/.." : "..", r = 2);
      } else
        n.length > 0 ? n += "/" + e.slice(i + 1, o) : n = e.slice(i + 1, o), r = o - i - 1;
      i = o, s = 0;
    } else u === 46 && s > -1 ? s++ : s = -1;
  }
  return n;
}
function O0(e) {
  if (typeof e != "string")
    throw new TypeError(
      "Path must be a string. Received " + JSON.stringify(e)
    );
}
const mG = { cwd: pG };
function pG() {
  return "/";
}
function _5(e) {
  return !!(e !== null && typeof e == "object" && "href" in e && e.href && "protocol" in e && e.protocol && // @ts-expect-error: indexing is fine.
  e.auth === void 0);
}
function gG(e) {
  if (typeof e == "string")
    e = new URL(e);
  else if (!_5(e)) {
    const t = new TypeError(
      'The "path" argument must be of type string or an instance of URL. Received `' + e + "`"
    );
    throw t.code = "ERR_INVALID_ARG_TYPE", t;
  }
  if (e.protocol !== "file:") {
    const t = new TypeError("The URL must be of scheme file");
    throw t.code = "ERR_INVALID_URL_SCHEME", t;
  }
  return yG(e);
}
function yG(e) {
  if (e.hostname !== "") {
    const r = new TypeError(
      'File URL host must be "localhost" or empty on darwin'
    );
    throw r.code = "ERR_INVALID_FILE_URL_HOST", r;
  }
  const t = e.pathname;
  let n = -1;
  for (; ++n < t.length; )
    if (t.codePointAt(n) === 37 && t.codePointAt(n + 1) === 50) {
      const r = t.codePointAt(n + 2);
      if (r === 70 || r === 102) {
        const i = new TypeError(
          "File URL path must not include encoded / characters"
        );
        throw i.code = "ERR_INVALID_FILE_URL_PATH", i;
      }
    }
  return decodeURIComponent(t);
}
const Zb = (
  /** @type {const} */
  [
    "history",
    "path",
    "basename",
    "stem",
    "extname",
    "dirname"
  ]
);
class bO {
  /**
   * Create a new virtual file.
   *
   * `options` is treated as:
   *
   * *   `string` or `Uint8Array`  `{value: options}`
   * *   `URL`  `{path: options}`
   * *   `VFile`  shallow copies its data over to the new file
   * *   `object`  all fields are shallow copied over to the new file
   *
   * Path related fields are set in the following order (least specific to
   * most specific): `history`, `path`, `basename`, `stem`, `extname`,
   * `dirname`.
   *
   * You cannot set `dirname` or `extname` without setting either `history`,
   * `path`, `basename`, or `stem` too.
   *
   * @param {Compatible | null | undefined} [value]
   *   File value.
   * @returns
   *   New instance.
   */
  constructor(t) {
    let n;
    t ? _5(t) ? n = { path: t } : typeof t == "string" || vG(t) ? n = { value: t } : n = t : n = {}, this.cwd = "cwd" in n ? "" : mG.cwd(), this.data = {}, this.history = [], this.messages = [], this.value, this.map, this.result, this.stored;
    let r = -1;
    for (; ++r < Zb.length; ) {
      const s = Zb[r];
      s in n && n[s] !== void 0 && n[s] !== null && (this[s] = s === "history" ? [...n[s]] : n[s]);
    }
    let i;
    for (i in n)
      Zb.includes(i) || (this[i] = n[i]);
  }
  /**
   * Get the basename (including extname) (example: `'index.min.js'`).
   *
   * @returns {string | undefined}
   *   Basename.
   */
  get basename() {
    return typeof this.path == "string" ? Sl.basename(this.path) : void 0;
  }
  /**
   * Set basename (including extname) (`'index.min.js'`).
   *
   * Cannot contain path separators (`'/'` on unix, macOS, and browsers, `'\'`
   * on windows).
   * Cannot be nullified (use `file.path = file.dirname` instead).
   *
   * @param {string} basename
   *   Basename.
   * @returns {undefined}
   *   Nothing.
   */
  set basename(t) {
    e2(t, "basename"), Jb(t, "basename"), this.path = Sl.join(this.dirname || "", t);
  }
  /**
   * Get the parent path (example: `'~'`).
   *
   * @returns {string | undefined}
   *   Dirname.
   */
  get dirname() {
    return typeof this.path == "string" ? Sl.dirname(this.path) : void 0;
  }
  /**
   * Set the parent path (example: `'~'`).
   *
   * Cannot be set if theres no `path` yet.
   *
   * @param {string | undefined} dirname
   *   Dirname.
   * @returns {undefined}
   *   Nothing.
   */
  set dirname(t) {
    N6(this.basename, "dirname"), this.path = Sl.join(t || "", this.basename);
  }
  /**
   * Get the extname (including dot) (example: `'.js'`).
   *
   * @returns {string | undefined}
   *   Extname.
   */
  get extname() {
    return typeof this.path == "string" ? Sl.extname(this.path) : void 0;
  }
  /**
   * Set the extname (including dot) (example: `'.js'`).
   *
   * Cannot contain path separators (`'/'` on unix, macOS, and browsers, `'\'`
   * on windows).
   * Cannot be set if theres no `path` yet.
   *
   * @param {string | undefined} extname
   *   Extname.
   * @returns {undefined}
   *   Nothing.
   */
  set extname(t) {
    if (Jb(t, "extname"), N6(this.dirname, "extname"), t) {
      if (t.codePointAt(0) !== 46)
        throw new Error("`extname` must start with `.`");
      if (t.includes(".", 1))
        throw new Error("`extname` cannot contain multiple dots");
    }
    this.path = Sl.join(this.dirname, this.stem + (t || ""));
  }
  /**
   * Get the full path (example: `'~/index.min.js'`).
   *
   * @returns {string}
   *   Path.
   */
  get path() {
    return this.history[this.history.length - 1];
  }
  /**
   * Set the full path (example: `'~/index.min.js'`).
   *
   * Cannot be nullified.
   * You can set a file URL (a `URL` object with a `file:` protocol) which will
   * be turned into a path with `url.fileURLToPath`.
   *
   * @param {URL | string} path
   *   Path.
   * @returns {undefined}
   *   Nothing.
   */
  set path(t) {
    _5(t) && (t = gG(t)), e2(t, "path"), this.path !== t && this.history.push(t);
  }
  /**
   * Get the stem (basename w/o extname) (example: `'index.min'`).
   *
   * @returns {string | undefined}
   *   Stem.
   */
  get stem() {
    return typeof this.path == "string" ? Sl.basename(this.path, this.extname) : void 0;
  }
  /**
   * Set the stem (basename w/o extname) (example: `'index.min'`).
   *
   * Cannot contain path separators (`'/'` on unix, macOS, and browsers, `'\'`
   * on windows).
   * Cannot be nullified (use `file.path = file.dirname` instead).
   *
   * @param {string} stem
   *   Stem.
   * @returns {undefined}
   *   Nothing.
   */
  set stem(t) {
    e2(t, "stem"), Jb(t, "stem"), this.path = Sl.join(this.dirname || "", t + (this.extname || ""));
  }
  // Normal prototypal methods.
  /**
   * Create a fatal message for `reason` associated with the file.
   *
   * The `fatal` field of the message is set to `true` (error; file not usable)
   * and the `file` field is set to the current file path.
   * The message is added to the `messages` field on `file`.
   *
   * >  **Note**: also has obsolete signatures.
   *
   * @overload
   * @param {string} reason
   * @param {MessageOptions | null | undefined} [options]
   * @returns {never}
   *
   * @overload
   * @param {string} reason
   * @param {Node | NodeLike | null | undefined} parent
   * @param {string | null | undefined} [origin]
   * @returns {never}
   *
   * @overload
   * @param {string} reason
   * @param {Point | Position | null | undefined} place
   * @param {string | null | undefined} [origin]
   * @returns {never}
   *
   * @overload
   * @param {string} reason
   * @param {string | null | undefined} [origin]
   * @returns {never}
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {Node | NodeLike | null | undefined} parent
   * @param {string | null | undefined} [origin]
   * @returns {never}
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {Point | Position | null | undefined} place
   * @param {string | null | undefined} [origin]
   * @returns {never}
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {string | null | undefined} [origin]
   * @returns {never}
   *
   * @param {Error | VFileMessage | string} causeOrReason
   *   Reason for message, should use markdown.
   * @param {Node | NodeLike | MessageOptions | Point | Position | string | null | undefined} [optionsOrParentOrPlace]
   *   Configuration (optional).
   * @param {string | null | undefined} [origin]
   *   Place in code where the message originates (example:
   *   `'my-package:my-rule'` or `'my-rule'`).
   * @returns {never}
   *   Never.
   * @throws {VFileMessage}
   *   Message.
   */
  fail(t, n, r) {
    const i = this.message(t, n, r);
    throw i.fatal = !0, i;
  }
  /**
   * Create an info message for `reason` associated with the file.
   *
   * The `fatal` field of the message is set to `undefined` (info; change
   * likely not needed) and the `file` field is set to the current file path.
   * The message is added to the `messages` field on `file`.
   *
   * >  **Note**: also has obsolete signatures.
   *
   * @overload
   * @param {string} reason
   * @param {MessageOptions | null | undefined} [options]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {string} reason
   * @param {Node | NodeLike | null | undefined} parent
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {string} reason
   * @param {Point | Position | null | undefined} place
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {string} reason
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {Node | NodeLike | null | undefined} parent
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {Point | Position | null | undefined} place
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @param {Error | VFileMessage | string} causeOrReason
   *   Reason for message, should use markdown.
   * @param {Node | NodeLike | MessageOptions | Point | Position | string | null | undefined} [optionsOrParentOrPlace]
   *   Configuration (optional).
   * @param {string | null | undefined} [origin]
   *   Place in code where the message originates (example:
   *   `'my-package:my-rule'` or `'my-rule'`).
   * @returns {VFileMessage}
   *   Message.
   */
  info(t, n, r) {
    const i = this.message(t, n, r);
    return i.fatal = void 0, i;
  }
  /**
   * Create a message for `reason` associated with the file.
   *
   * The `fatal` field of the message is set to `false` (warning; change may be
   * needed) and the `file` field is set to the current file path.
   * The message is added to the `messages` field on `file`.
   *
   * >  **Note**: also has obsolete signatures.
   *
   * @overload
   * @param {string} reason
   * @param {MessageOptions | null | undefined} [options]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {string} reason
   * @param {Node | NodeLike | null | undefined} parent
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {string} reason
   * @param {Point | Position | null | undefined} place
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {string} reason
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {Node | NodeLike | null | undefined} parent
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {Point | Position | null | undefined} place
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @param {Error | VFileMessage | string} causeOrReason
   *   Reason for message, should use markdown.
   * @param {Node | NodeLike | MessageOptions | Point | Position | string | null | undefined} [optionsOrParentOrPlace]
   *   Configuration (optional).
   * @param {string | null | undefined} [origin]
   *   Place in code where the message originates (example:
   *   `'my-package:my-rule'` or `'my-rule'`).
   * @returns {VFileMessage}
   *   Message.
   */
  message(t, n, r) {
    const i = new Fi(
      // @ts-expect-error: the overloads are fine.
      t,
      n,
      r
    );
    return this.path && (i.name = this.path + ":" + i.name, i.file = this.path), i.fatal = !1, this.messages.push(i), i;
  }
  /**
   * Serialize the file.
   *
   * > **Note**: which encodings are supported depends on the engine.
   * > For info on Node.js, see:
   * > <https://nodejs.org/api/util.html#whatwg-supported-encodings>.
   *
   * @param {string | null | undefined} [encoding='utf8']
   *   Character encoding to understand `value` as when its a `Uint8Array`
   *   (default: `'utf-8'`).
   * @returns {string}
   *   Serialized file.
   */
  toString(t) {
    return this.value === void 0 ? "" : typeof this.value == "string" ? this.value : new TextDecoder(t || void 0).decode(this.value);
  }
}
function Jb(e, t) {
  if (e && e.includes(Sl.sep))
    throw new Error(
      "`" + t + "` cannot be a path: did not expect `" + Sl.sep + "`"
    );
}
function e2(e, t) {
  if (!e)
    throw new Error("`" + t + "` cannot be empty");
}
function N6(e, t) {
  if (!e)
    throw new Error("Setting `" + t + "` requires `path` to be set too");
}
function vG(e) {
  return !!(e && typeof e == "object" && "byteLength" in e && "byteOffset" in e);
}
const xG = (
  /**
   * @type {new <Parameters extends Array<unknown>, Result>(property: string | symbol) => (...parameters: Parameters) => Result}
   */
  /** @type {unknown} */
  /**
   * @this {Function}
   * @param {string | symbol} property
   * @returns {(...parameters: Array<unknown>) => unknown}
   */
  (function(e) {
    const r = (
      /** @type {Record<string | symbol, Function>} */
      // Prototypes do exist.
      // type-coverage:ignore-next-line
      this.constructor.prototype
    ), i = r[e], s = function() {
      return i.apply(s, arguments);
    };
    return Object.setPrototypeOf(s, r), s;
  })
), bG = {}.hasOwnProperty;
class KC extends xG {
  /**
   * Create a processor.
   */
  constructor() {
    super("copy"), this.Compiler = void 0, this.Parser = void 0, this.attachers = [], this.compiler = void 0, this.freezeIndex = -1, this.frozen = void 0, this.namespace = {}, this.parser = void 0, this.transformers = sG();
  }
  /**
   * Copy a processor.
   *
   * @deprecated
   *   This is a private internal method and should not be used.
   * @returns {Processor<ParseTree, HeadTree, TailTree, CompileTree, CompileResult>}
   *   New *unfrozen* processor ({@linkcode Processor}) that is
   *   configured to work the same as its ancestor.
   *   When the descendant processor is configured in the future it does not
   *   affect the ancestral processor.
   */
  copy() {
    const t = (
      /** @type {Processor<ParseTree, HeadTree, TailTree, CompileTree, CompileResult>} */
      new KC()
    );
    let n = -1;
    for (; ++n < this.attachers.length; ) {
      const r = this.attachers[n];
      t.use(...r);
    }
    return t.data(Qb(!0, {}, this.namespace)), t;
  }
  /**
   * Configure the processor with info available to all plugins.
   * Information is stored in an object.
   *
   * Typically, options can be given to a specific plugin, but sometimes it
   * makes sense to have information shared with several plugins.
   * For example, a list of HTML elements that are self-closing, which is
   * needed during all phases.
   *
   * > **Note**: setting information cannot occur on *frozen* processors.
   * > Call the processor first to create a new unfrozen processor.
   *
   * > **Note**: to register custom data in TypeScript, augment the
   * > {@linkcode Data} interface.
   *
   * @example
   *   This example show how to get and set info:
   *
   *   ```js
   *   import {unified} from 'unified'
   *
   *   const processor = unified().data('alpha', 'bravo')
   *
   *   processor.data('alpha') // => 'bravo'
   *
   *   processor.data() // => {alpha: 'bravo'}
   *
   *   processor.data({charlie: 'delta'})
   *
   *   processor.data() // => {charlie: 'delta'}
   *   ```
   *
   * @template {keyof Data} Key
   *
   * @overload
   * @returns {Data}
   *
   * @overload
   * @param {Data} dataset
   * @returns {Processor<ParseTree, HeadTree, TailTree, CompileTree, CompileResult>}
   *
   * @overload
   * @param {Key} key
   * @returns {Data[Key]}
   *
   * @overload
   * @param {Key} key
   * @param {Data[Key]} value
   * @returns {Processor<ParseTree, HeadTree, TailTree, CompileTree, CompileResult>}
   *
   * @param {Data | Key} [key]
   *   Key to get or set, or entire dataset to set, or nothing to get the
   *   entire dataset (optional).
   * @param {Data[Key]} [value]
   *   Value to set (optional).
   * @returns {unknown}
   *   The current processor when setting, the value at `key` when getting, or
   *   the entire dataset when getting without key.
   */
  data(t, n) {
    return typeof t == "string" ? arguments.length === 2 ? (r2("data", this.frozen), this.namespace[t] = n, this) : bG.call(this.namespace, t) && this.namespace[t] || void 0 : t ? (r2("data", this.frozen), this.namespace = t, this) : this.namespace;
  }
  /**
   * Freeze a processor.
   *
   * Frozen processors are meant to be extended and not to be configured
   * directly.
   *
   * When a processor is frozen it cannot be unfrozen.
   * New processors working the same way can be created by calling the
   * processor.
   *
   * Its possible to freeze processors explicitly by calling `.freeze()`.
   * Processors freeze automatically when `.parse()`, `.run()`, `.runSync()`,
   * `.stringify()`, `.process()`, or `.processSync()` are called.
   *
   * @returns {Processor<ParseTree, HeadTree, TailTree, CompileTree, CompileResult>}
   *   The current processor.
   */
  freeze() {
    if (this.frozen)
      return this;
    const t = (
      /** @type {Processor} */
      /** @type {unknown} */
      this
    );
    for (; ++this.freezeIndex < this.attachers.length; ) {
      const [n, ...r] = this.attachers[this.freezeIndex];
      if (r[0] === !1)
        continue;
      r[0] === !0 && (r[0] = void 0);
      const i = n.call(t, ...r);
      typeof i == "function" && this.transformers.use(i);
    }
    return this.frozen = !0, this.freezeIndex = Number.POSITIVE_INFINITY, this;
  }
  /**
   * Parse text to a syntax tree.
   *
   * > **Note**: `parse` freezes the processor if not already *frozen*.
   *
   * > **Note**: `parse` performs the parse phase, not the run phase or other
   * > phases.
   *
   * @param {Compatible | undefined} [file]
   *   file to parse (optional); typically `string` or `VFile`; any value
   *   accepted as `x` in `new VFile(x)`.
   * @returns {ParseTree extends undefined ? Node : ParseTree}
   *   Syntax tree representing `file`.
   */
  parse(t) {
    this.freeze();
    const n = B1(t), r = this.parser || this.Parser;
    return t2("parse", r), r(String(n), n);
  }
  /**
   * Process the given file as configured on the processor.
   *
   * > **Note**: `process` freezes the processor if not already *frozen*.
   *
   * > **Note**: `process` performs the parse, run, and stringify phases.
   *
   * @overload
   * @param {Compatible | undefined} file
   * @param {ProcessCallback<VFileWithOutput<CompileResult>>} done
   * @returns {undefined}
   *
   * @overload
   * @param {Compatible | undefined} [file]
   * @returns {Promise<VFileWithOutput<CompileResult>>}
   *
   * @param {Compatible | undefined} [file]
   *   File (optional); typically `string` or `VFile`]; any value accepted as
   *   `x` in `new VFile(x)`.
   * @param {ProcessCallback<VFileWithOutput<CompileResult>> | undefined} [done]
   *   Callback (optional).
   * @returns {Promise<VFile> | undefined}
   *   Nothing if `done` is given.
   *   Otherwise a promise, rejected with a fatal error or resolved with the
   *   processed file.
   *
   *   The parsed, transformed, and compiled value is available at
   *   `file.value` (see note).
   *
   *   > **Note**: unified typically compiles by serializing: most
   *   > compilers return `string` (or `Uint8Array`).
   *   > Some compilers, such as the one configured with
   *   > [`rehype-react`][rehype-react], return other values (in this case, a
   *   > React tree).
   *   > If youre using a compiler that doesnt serialize, expect different
   *   > result values.
   *   >
   *   > To register custom results in TypeScript, add them to
   *   > {@linkcode CompileResultMap}.
   *
   *   [rehype-react]: https://github.com/rehypejs/rehype-react
   */
  process(t, n) {
    const r = this;
    return this.freeze(), t2("process", this.parser || this.Parser), n2("process", this.compiler || this.Compiler), n ? i(void 0, n) : new Promise(i);
    function i(s, o) {
      const u = B1(t), c = (
        /** @type {HeadTree extends undefined ? Node : HeadTree} */
        /** @type {unknown} */
        r.parse(u)
      );
      r.run(c, u, function(m, p, x) {
        if (m || !p || !x)
          return d(m);
        const b = (
          /** @type {CompileTree extends undefined ? Node : CompileTree} */
          /** @type {unknown} */
          p
        ), S = r.stringify(b, x);
        SG(S) ? x.value = S : x.result = S, d(
          m,
          /** @type {VFileWithOutput<CompileResult>} */
          x
        );
      });
      function d(m, p) {
        m || !p ? o(m) : s ? s(p) : n(void 0, p);
      }
    }
  }
  /**
   * Process the given file as configured on the processor.
   *
   * An error is thrown if asynchronous transforms are configured.
   *
   * > **Note**: `processSync` freezes the processor if not already *frozen*.
   *
   * > **Note**: `processSync` performs the parse, run, and stringify phases.
   *
   * @param {Compatible | undefined} [file]
   *   File (optional); typically `string` or `VFile`; any value accepted as
   *   `x` in `new VFile(x)`.
   * @returns {VFileWithOutput<CompileResult>}
   *   The processed file.
   *
   *   The parsed, transformed, and compiled value is available at
   *   `file.value` (see note).
   *
   *   > **Note**: unified typically compiles by serializing: most
   *   > compilers return `string` (or `Uint8Array`).
   *   > Some compilers, such as the one configured with
   *   > [`rehype-react`][rehype-react], return other values (in this case, a
   *   > React tree).
   *   > If youre using a compiler that doesnt serialize, expect different
   *   > result values.
   *   >
   *   > To register custom results in TypeScript, add them to
   *   > {@linkcode CompileResultMap}.
   *
   *   [rehype-react]: https://github.com/rehypejs/rehype-react
   */
  processSync(t) {
    let n = !1, r;
    return this.freeze(), t2("processSync", this.parser || this.Parser), n2("processSync", this.compiler || this.Compiler), this.process(t, i), j6("processSync", "process", n), r;
    function i(s, o) {
      n = !0, k6(s), r = o;
    }
  }
  /**
   * Run *transformers* on a syntax tree.
   *
   * > **Note**: `run` freezes the processor if not already *frozen*.
   *
   * > **Note**: `run` performs the run phase, not other phases.
   *
   * @overload
   * @param {HeadTree extends undefined ? Node : HeadTree} tree
   * @param {RunCallback<TailTree extends undefined ? Node : TailTree>} done
   * @returns {undefined}
   *
   * @overload
   * @param {HeadTree extends undefined ? Node : HeadTree} tree
   * @param {Compatible | undefined} file
   * @param {RunCallback<TailTree extends undefined ? Node : TailTree>} done
   * @returns {undefined}
   *
   * @overload
   * @param {HeadTree extends undefined ? Node : HeadTree} tree
   * @param {Compatible | undefined} [file]
   * @returns {Promise<TailTree extends undefined ? Node : TailTree>}
   *
   * @param {HeadTree extends undefined ? Node : HeadTree} tree
   *   Tree to transform and inspect.
   * @param {(
   *   RunCallback<TailTree extends undefined ? Node : TailTree> |
   *   Compatible
   * )} [file]
   *   File associated with `node` (optional); any value accepted as `x` in
   *   `new VFile(x)`.
   * @param {RunCallback<TailTree extends undefined ? Node : TailTree>} [done]
   *   Callback (optional).
   * @returns {Promise<TailTree extends undefined ? Node : TailTree> | undefined}
   *   Nothing if `done` is given.
   *   Otherwise, a promise rejected with a fatal error or resolved with the
   *   transformed tree.
   */
  run(t, n, r) {
    A6(t), this.freeze();
    const i = this.transformers;
    return !r && typeof n == "function" && (r = n, n = void 0), r ? s(void 0, r) : new Promise(s);
    function s(o, u) {
      const c = B1(n);
      i.run(t, c, d);
      function d(m, p, x) {
        const b = (
          /** @type {TailTree extends undefined ? Node : TailTree} */
          p || t
        );
        m ? u(m) : o ? o(b) : r(void 0, b, x);
      }
    }
  }
  /**
   * Run *transformers* on a syntax tree.
   *
   * An error is thrown if asynchronous transforms are configured.
   *
   * > **Note**: `runSync` freezes the processor if not already *frozen*.
   *
   * > **Note**: `runSync` performs the run phase, not other phases.
   *
   * @param {HeadTree extends undefined ? Node : HeadTree} tree
   *   Tree to transform and inspect.
   * @param {Compatible | undefined} [file]
   *   File associated with `node` (optional); any value accepted as `x` in
   *   `new VFile(x)`.
   * @returns {TailTree extends undefined ? Node : TailTree}
   *   Transformed tree.
   */
  runSync(t, n) {
    let r = !1, i;
    return this.run(t, n, s), j6("runSync", "run", r), i;
    function s(o, u) {
      k6(o), i = u, r = !0;
    }
  }
  /**
   * Compile a syntax tree.
   *
   * > **Note**: `stringify` freezes the processor if not already *frozen*.
   *
   * > **Note**: `stringify` performs the stringify phase, not the run phase
   * > or other phases.
   *
   * @param {CompileTree extends undefined ? Node : CompileTree} tree
   *   Tree to compile.
   * @param {Compatible | undefined} [file]
   *   File associated with `node` (optional); any value accepted as `x` in
   *   `new VFile(x)`.
   * @returns {CompileResult extends undefined ? Value : CompileResult}
   *   Textual representation of the tree (see note).
   *
   *   > **Note**: unified typically compiles by serializing: most compilers
   *   > return `string` (or `Uint8Array`).
   *   > Some compilers, such as the one configured with
   *   > [`rehype-react`][rehype-react], return other values (in this case, a
   *   > React tree).
   *   > If youre using a compiler that doesnt serialize, expect different
   *   > result values.
   *   >
   *   > To register custom results in TypeScript, add them to
   *   > {@linkcode CompileResultMap}.
   *
   *   [rehype-react]: https://github.com/rehypejs/rehype-react
   */
  stringify(t, n) {
    this.freeze();
    const r = B1(n), i = this.compiler || this.Compiler;
    return n2("stringify", i), A6(t), i(t, r);
  }
  /**
   * Configure the processor to use a plugin, a list of usable values, or a
   * preset.
   *
   * If the processor is already using a plugin, the previous plugin
   * configuration is changed based on the options that are passed in.
   * In other words, the plugin is not added a second time.
   *
   * > **Note**: `use` cannot be called on *frozen* processors.
   * > Call the processor first to create a new unfrozen processor.
   *
   * @example
   *   There are many ways to pass plugins to `.use()`.
   *   This example gives an overview:
   *
   *   ```js
   *   import {unified} from 'unified'
   *
   *   unified()
   *     // Plugin with options:
   *     .use(pluginA, {x: true, y: true})
   *     // Passing the same plugin again merges configuration (to `{x: true, y: false, z: true}`):
   *     .use(pluginA, {y: false, z: true})
   *     // Plugins:
   *     .use([pluginB, pluginC])
   *     // Two plugins, the second with options:
   *     .use([pluginD, [pluginE, {}]])
   *     // Preset with plugins and settings:
   *     .use({plugins: [pluginF, [pluginG, {}]], settings: {position: false}})
   *     // Settings only:
   *     .use({settings: {position: false}})
   *   ```
   *
   * @template {Array<unknown>} [Parameters=[]]
   * @template {Node | string | undefined} [Input=undefined]
   * @template [Output=Input]
   *
   * @overload
   * @param {Preset | null | undefined} [preset]
   * @returns {Processor<ParseTree, HeadTree, TailTree, CompileTree, CompileResult>}
   *
   * @overload
   * @param {PluggableList} list
   * @returns {Processor<ParseTree, HeadTree, TailTree, CompileTree, CompileResult>}
   *
   * @overload
   * @param {Plugin<Parameters, Input, Output>} plugin
   * @param {...(Parameters | [boolean])} parameters
   * @returns {UsePlugin<ParseTree, HeadTree, TailTree, CompileTree, CompileResult, Input, Output>}
   *
   * @param {PluggableList | Plugin | Preset | null | undefined} value
   *   Usable value.
   * @param {...unknown} parameters
   *   Parameters, when a plugin is given as a usable value.
   * @returns {Processor<ParseTree, HeadTree, TailTree, CompileTree, CompileResult>}
   *   Current processor.
   */
  use(t, ...n) {
    const r = this.attachers, i = this.namespace;
    if (r2("use", this.frozen), t != null) if (typeof t == "function")
      c(t, n);
    else if (typeof t == "object")
      Array.isArray(t) ? u(t) : o(t);
    else
      throw new TypeError("Expected usable value, not `" + t + "`");
    return this;
    function s(d) {
      if (typeof d == "function")
        c(d, []);
      else if (typeof d == "object")
        if (Array.isArray(d)) {
          const [m, ...p] = (
            /** @type {PluginTuple<Array<unknown>>} */
            d
          );
          c(m, p);
        } else
          o(d);
      else
        throw new TypeError("Expected usable value, not `" + d + "`");
    }
    function o(d) {
      if (!("plugins" in d) && !("settings" in d))
        throw new Error(
          "Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither"
        );
      u(d.plugins), d.settings && (i.settings = Qb(!0, i.settings, d.settings));
    }
    function u(d) {
      let m = -1;
      if (d != null) if (Array.isArray(d))
        for (; ++m < d.length; ) {
          const p = d[m];
          s(p);
        }
      else
        throw new TypeError("Expected a list of plugins, not `" + d + "`");
    }
    function c(d, m) {
      let p = -1, x = -1;
      for (; ++p < r.length; )
        if (r[p][0] === d) {
          x = p;
          break;
        }
      if (x === -1)
        r.push([d, ...m]);
      else if (m.length > 0) {
        let [b, ...S] = m;
        const k = r[x][1];
        w5(k) && w5(b) && (b = Qb(!0, k, b)), r[x] = [d, b, ...S];
      }
    }
  }
}
const wG = new KC().freeze();
function t2(e, t) {
  if (typeof t != "function")
    throw new TypeError("Cannot `" + e + "` without `parser`");
}
function n2(e, t) {
  if (typeof t != "function")
    throw new TypeError("Cannot `" + e + "` without `compiler`");
}
function r2(e, t) {
  if (t)
    throw new Error(
      "Cannot call `" + e + "` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`."
    );
}
function A6(e) {
  if (!w5(e) || typeof e.type != "string")
    throw new TypeError("Expected node, got `" + e + "`");
}
function j6(e, t, n) {
  if (!n)
    throw new Error(
      "`" + e + "` finished async. Use `" + t + "` instead"
    );
}
function B1(e) {
  return _G(e) ? e : new bO(e);
}
function _G(e) {
  return !!(e && typeof e == "object" && "message" in e && "messages" in e);
}
function SG(e) {
  return typeof e == "string" || CG(e);
}
function CG(e) {
  return !!(e && typeof e == "object" && "byteLength" in e && "byteOffset" in e);
}
const EG = "https://github.com/remarkjs/react-markdown/blob/main/changelog.md", M6 = [], R6 = { allowDangerousHtml: !0 }, kG = /^(https?|ircs?|mailto|xmpp)$/i, TG = [
  { from: "astPlugins", id: "remove-buggy-html-in-markdown-parser" },
  { from: "allowDangerousHtml", id: "remove-buggy-html-in-markdown-parser" },
  {
    from: "allowNode",
    id: "replace-allownode-allowedtypes-and-disallowedtypes",
    to: "allowElement"
  },
  {
    from: "allowedTypes",
    id: "replace-allownode-allowedtypes-and-disallowedtypes",
    to: "allowedElements"
  },
  { from: "className", id: "remove-classname" },
  {
    from: "disallowedTypes",
    id: "replace-allownode-allowedtypes-and-disallowedtypes",
    to: "disallowedElements"
  },
  { from: "escapeHtml", id: "remove-buggy-html-in-markdown-parser" },
  { from: "includeElementIndex", id: "#remove-includeelementindex" },
  {
    from: "includeNodeIndex",
    id: "change-includenodeindex-to-includeelementindex"
  },
  { from: "linkTarget", id: "remove-linktarget" },
  { from: "plugins", id: "change-plugins-to-remarkplugins", to: "remarkPlugins" },
  { from: "rawSourcePos", id: "#remove-rawsourcepos" },
  { from: "renderers", id: "change-renderers-to-components", to: "components" },
  { from: "source", id: "change-source-to-children", to: "children" },
  { from: "sourcePos", id: "#remove-sourcepos" },
  { from: "transformImageUri", id: "#add-urltransform", to: "urlTransform" },
  { from: "transformLinkUri", id: "#add-urltransform", to: "urlTransform" }
];
function NG(e) {
  const t = AG(e), n = jG(e);
  return MG(t.runSync(t.parse(n), n), e);
}
function AG(e) {
  const t = e.rehypePlugins || M6, n = e.remarkPlugins || M6, r = e.remarkRehypeOptions ? { ...e.remarkRehypeOptions, ...R6 } : R6;
  return wG().use(uH).use(n).use(rG, r).use(t);
}
function jG(e) {
  const t = e.children || "", n = new bO();
  return typeof t == "string" && (n.value = t), n;
}
function MG(e, t) {
  const n = t.allowedElements, r = t.allowElement, i = t.components, s = t.disallowedElements, o = t.skipHtml, u = t.unwrapDisallowed, c = t.urlTransform || RG;
  for (const m of TG)
    Object.hasOwn(t, m.from) && ("" + m.from + (m.to ? "use `" + m.to + "` instead" : "remove it") + EG + m.id, void 0);
  return GC(e, d), GU(e, {
    Fragment: g.Fragment,
    components: i,
    ignoreInvalidStyle: !0,
    jsx: g.jsx,
    jsxs: g.jsxs,
    passKeys: !0,
    passNode: !0
  });
  function d(m, p, x) {
    if (m.type === "raw" && x && typeof p == "number")
      return o ? x.children.splice(p, 1) : x.children[p] = { type: "text", value: m.value }, p;
    if (m.type === "element") {
      let b;
      for (b in Kb)
        if (Object.hasOwn(Kb, b) && Object.hasOwn(m.properties, b)) {
          const S = m.properties[b], k = Kb[b];
          (k === null || k.includes(m.tagName)) && (m.properties[b] = c(String(S || ""), b, m));
        }
    }
    if (m.type === "element") {
      let b = n ? !n.includes(m.tagName) : s ? s.includes(m.tagName) : !1;
      if (!b && r && typeof p == "number" && (b = !r(m, p, x)), b && x && typeof p == "number")
        return u && m.children ? x.children.splice(p, 1, ...m.children) : x.children.splice(p, 1), p;
    }
  }
}
function RG(e) {
  const t = e.indexOf(":"), n = e.indexOf("?"), r = e.indexOf("#"), i = e.indexOf("/");
  return (
    // If there is no protocol, its relative.
    t === -1 || // If the first colon is after a `?`, `#`, or `/`, its not a protocol.
    i !== -1 && t > i || n !== -1 && t > n || r !== -1 && t > r || // It is a protocol, it should be allowed.
    kG.test(e.slice(0, t)) ? e : ""
  );
}
function O6(e, t) {
  const n = String(e);
  if (typeof t != "string")
    throw new TypeError("Expected character");
  let r = 0, i = n.indexOf(t);
  for (; i !== -1; )
    r++, i = n.indexOf(t, i + t.length);
  return r;
}
function OG(e) {
  if (typeof e != "string")
    throw new TypeError("Expected a string");
  return e.replace(/[|\\{}()[\]^$+*?.]/g, "\\$&").replace(/-/g, "\\x2d");
}
function DG(e, t, n) {
  const i = ax((n || {}).ignore || []), s = IG(t);
  let o = -1;
  for (; ++o < s.length; )
    xO(e, "text", u);
  function u(d, m) {
    let p = -1, x;
    for (; ++p < m.length; ) {
      const b = m[p], S = x ? x.children : void 0;
      if (i(
        b,
        S ? S.indexOf(b) : void 0,
        x
      ))
        return;
      x = b;
    }
    if (x)
      return c(d, m);
  }
  function c(d, m) {
    const p = m[m.length - 1], x = s[o][0], b = s[o][1];
    let S = 0;
    const A = p.children.indexOf(d);
    let T = !1, M = [];
    x.lastIndex = 0;
    let j = x.exec(d.value);
    for (; j; ) {
      const D = j.index, z = {
        index: j.index,
        input: j.input,
        stack: [...m, d]
      };
      let I = b(...j, z);
      if (typeof I == "string" && (I = I.length > 0 ? { type: "text", value: I } : void 0), I === !1 ? x.lastIndex = D + 1 : (S !== D && M.push({
        type: "text",
        value: d.value.slice(S, D)
      }), Array.isArray(I) ? M.push(...I) : I && M.push(I), S = D + j[0].length, T = !0), !x.global)
        break;
      j = x.exec(d.value);
    }
    return T ? (S < d.value.length && M.push({ type: "text", value: d.value.slice(S) }), p.children.splice(A, 1, ...M)) : M = [d], A + M.length;
  }
}
function IG(e) {
  const t = [];
  if (!Array.isArray(e))
    throw new TypeError("Expected find and replace tuple or list of tuples");
  const n = !e[0] || Array.isArray(e[0]) ? e : [e];
  let r = -1;
  for (; ++r < n.length; ) {
    const i = n[r];
    t.push([PG(i[0]), zG(i[1])]);
  }
  return t;
}
function PG(e) {
  return typeof e == "string" ? new RegExp(OG(e), "g") : e;
}
function zG(e) {
  return typeof e == "function" ? e : function() {
    return e;
  };
}
const i2 = "phrasing", a2 = ["autolink", "link", "image", "label"];
function LG() {
  return {
    transforms: [HG],
    enter: {
      literalAutolink: qG,
      literalAutolinkEmail: s2,
      literalAutolinkHttp: s2,
      literalAutolinkWww: s2
    },
    exit: {
      literalAutolink: VG,
      literalAutolinkEmail: $G,
      literalAutolinkHttp: FG,
      literalAutolinkWww: UG
    }
  };
}
function BG() {
  return {
    unsafe: [
      {
        character: "@",
        before: "[+\\-.\\w]",
        after: "[\\-.\\w]",
        inConstruct: i2,
        notInConstruct: a2
      },
      {
        character: ".",
        before: "[Ww]",
        after: "[\\-.\\w]",
        inConstruct: i2,
        notInConstruct: a2
      },
      {
        character: ":",
        before: "[ps]",
        after: "\\/",
        inConstruct: i2,
        notInConstruct: a2
      }
    ]
  };
}
function qG(e) {
  this.enter({ type: "link", title: null, url: "", children: [] }, e);
}
function s2(e) {
  this.config.enter.autolinkProtocol.call(this, e);
}
function FG(e) {
  this.config.exit.autolinkProtocol.call(this, e);
}
function UG(e) {
  this.config.exit.data.call(this, e);
  const t = this.stack[this.stack.length - 1];
  t.type, t.url = "http://" + this.sliceSerialize(e);
}
function $G(e) {
  this.config.exit.autolinkEmail.call(this, e);
}
function VG(e) {
  this.exit(e);
}
function HG(e) {
  DG(
    e,
    [
      [/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi, GG],
      [new RegExp("(?<=^|\\s|\\p{P}|\\p{S})([-.\\w+]+)@([-\\w]+(?:\\.[-\\w]+)+)", "gu"), KG]
    ],
    { ignore: ["link", "linkReference"] }
  );
}
function GG(e, t, n, r, i) {
  let s = "";
  if (!wO(i) || (/^w/i.test(t) && (n = t + n, t = "", s = "http://"), !YG(n)))
    return !1;
  const o = WG(n + r);
  if (!o[0]) return !1;
  const u = {
    type: "link",
    title: null,
    url: s + t + o[0],
    children: [{ type: "text", value: t + o[0] }]
  };
  return o[1] ? [u, { type: "text", value: o[1] }] : u;
}
function KG(e, t, n, r) {
  return (
    // Not an expected previous character.
    !wO(r, !0) || // Label ends in not allowed character.
    /[-\d_]$/.test(n) ? !1 : {
      type: "link",
      title: null,
      url: "mailto:" + t + "@" + n,
      children: [{ type: "text", value: t + "@" + n }]
    }
  );
}
function YG(e) {
  const t = e.split(".");
  return !(t.length < 2 || t[t.length - 1] && (/_/.test(t[t.length - 1]) || !/[a-zA-Z\d]/.test(t[t.length - 1])) || t[t.length - 2] && (/_/.test(t[t.length - 2]) || !/[a-zA-Z\d]/.test(t[t.length - 2])));
}
function WG(e) {
  const t = /[!"&'),.:;<>?\]}]+$/.exec(e);
  if (!t)
    return [e, void 0];
  e = e.slice(0, t.index);
  let n = t[0], r = n.indexOf(")");
  const i = O6(e, "(");
  let s = O6(e, ")");
  for (; r !== -1 && i > s; )
    e += n.slice(0, r + 1), n = n.slice(r + 1), r = n.indexOf(")"), s++;
  return [e, n];
}
function wO(e, t) {
  const n = e.input.charCodeAt(e.index - 1);
  return (e.index === 0 || Md(n) || nx(n)) && // If its an email, the previous character should not be a slash.
  (!t || n !== 47);
}
_O.peek = iK;
function XG() {
  this.buffer();
}
function QG(e) {
  this.enter({ type: "footnoteReference", identifier: "", label: "" }, e);
}
function ZG() {
  this.buffer();
}
function JG(e) {
  this.enter(
    { type: "footnoteDefinition", identifier: "", label: "", children: [] },
    e
  );
}
function eK(e) {
  const t = this.resume(), n = this.stack[this.stack.length - 1];
  n.type, n.identifier = Ao(
    this.sliceSerialize(e)
  ).toLowerCase(), n.label = t;
}
function tK(e) {
  this.exit(e);
}
function nK(e) {
  const t = this.resume(), n = this.stack[this.stack.length - 1];
  n.type, n.identifier = Ao(
    this.sliceSerialize(e)
  ).toLowerCase(), n.label = t;
}
function rK(e) {
  this.exit(e);
}
function iK() {
  return "[";
}
function _O(e, t, n, r) {
  const i = n.createTracker(r);
  let s = i.move("[^");
  const o = n.enter("footnoteReference"), u = n.enter("reference");
  return s += i.move(
    n.safe(n.associationId(e), { after: "]", before: s })
  ), u(), o(), s += i.move("]"), s;
}
function aK() {
  return {
    enter: {
      gfmFootnoteCallString: XG,
      gfmFootnoteCall: QG,
      gfmFootnoteDefinitionLabelString: ZG,
      gfmFootnoteDefinition: JG
    },
    exit: {
      gfmFootnoteCallString: eK,
      gfmFootnoteCall: tK,
      gfmFootnoteDefinitionLabelString: nK,
      gfmFootnoteDefinition: rK
    }
  };
}
function sK(e) {
  let t = !1;
  return e && e.firstLineBlank && (t = !0), {
    handlers: { footnoteDefinition: n, footnoteReference: _O },
    // This is on by default already.
    unsafe: [{ character: "[", inConstruct: ["label", "phrasing", "reference"] }]
  };
  function n(r, i, s, o) {
    const u = s.createTracker(o);
    let c = u.move("[^");
    const d = s.enter("footnoteDefinition"), m = s.enter("label");
    return c += u.move(
      s.safe(s.associationId(r), { before: c, after: "]" })
    ), m(), c += u.move("]:"), r.children && r.children.length > 0 && (u.shift(4), c += u.move(
      (t ? `
` : " ") + s.indentLines(
        s.containerFlow(r, u.current()),
        t ? SO : oK
      )
    )), d(), c;
  }
}
function oK(e, t, n) {
  return t === 0 ? e : SO(e, t, n);
}
function SO(e, t, n) {
  return (n ? "" : "    ") + e;
}
const lK = [
  "autolink",
  "destinationLiteral",
  "destinationRaw",
  "reference",
  "titleQuote",
  "titleApostrophe"
];
CO.peek = hK;
function uK() {
  return {
    canContainEols: ["delete"],
    enter: { strikethrough: fK },
    exit: { strikethrough: dK }
  };
}
function cK() {
  return {
    unsafe: [
      {
        character: "~",
        inConstruct: "phrasing",
        notInConstruct: lK
      }
    ],
    handlers: { delete: CO }
  };
}
function fK(e) {
  this.enter({ type: "delete", children: [] }, e);
}
function dK(e) {
  this.exit(e);
}
function CO(e, t, n, r) {
  const i = n.createTracker(r), s = n.enter("strikethrough");
  let o = i.move("~~");
  return o += n.containerPhrasing(e, {
    ...i.current(),
    before: o,
    after: "~"
  }), o += i.move("~~"), s(), o;
}
function hK() {
  return "~";
}
function mK(e) {
  return e.length;
}
function pK(e, t) {
  const n = t || {}, r = (n.align || []).concat(), i = n.stringLength || mK, s = [], o = [], u = [], c = [];
  let d = 0, m = -1;
  for (; ++m < e.length; ) {
    const k = [], A = [];
    let T = -1;
    for (e[m].length > d && (d = e[m].length); ++T < e[m].length; ) {
      const M = gK(e[m][T]);
      if (n.alignDelimiters !== !1) {
        const j = i(M);
        A[T] = j, (c[T] === void 0 || j > c[T]) && (c[T] = j);
      }
      k.push(M);
    }
    o[m] = k, u[m] = A;
  }
  let p = -1;
  if (typeof r == "object" && "length" in r)
    for (; ++p < d; )
      s[p] = D6(r[p]);
  else {
    const k = D6(r);
    for (; ++p < d; )
      s[p] = k;
  }
  p = -1;
  const x = [], b = [];
  for (; ++p < d; ) {
    const k = s[p];
    let A = "", T = "";
    k === 99 ? (A = ":", T = ":") : k === 108 ? A = ":" : k === 114 && (T = ":");
    let M = n.alignDelimiters === !1 ? 1 : Math.max(
      1,
      c[p] - A.length - T.length
    );
    const j = A + "-".repeat(M) + T;
    n.alignDelimiters !== !1 && (M = A.length + M + T.length, M > c[p] && (c[p] = M), b[p] = M), x[p] = j;
  }
  o.splice(1, 0, x), u.splice(1, 0, b), m = -1;
  const S = [];
  for (; ++m < o.length; ) {
    const k = o[m], A = u[m];
    p = -1;
    const T = [];
    for (; ++p < d; ) {
      const M = k[p] || "";
      let j = "", D = "";
      if (n.alignDelimiters !== !1) {
        const z = c[p] - (A[p] || 0), I = s[p];
        I === 114 ? j = " ".repeat(z) : I === 99 ? z % 2 ? (j = " ".repeat(z / 2 + 0.5), D = " ".repeat(z / 2 - 0.5)) : (j = " ".repeat(z / 2), D = j) : D = " ".repeat(z);
      }
      n.delimiterStart !== !1 && !p && T.push("|"), n.padding !== !1 && // Dont add the opening space if were not aligning and the cell is
      // empty: there will be a closing space.
      !(n.alignDelimiters === !1 && M === "") && (n.delimiterStart !== !1 || p) && T.push(" "), n.alignDelimiters !== !1 && T.push(j), T.push(M), n.alignDelimiters !== !1 && T.push(D), n.padding !== !1 && T.push(" "), (n.delimiterEnd !== !1 || p !== d - 1) && T.push("|");
    }
    S.push(
      n.delimiterEnd === !1 ? T.join("").replace(/ +$/, "") : T.join("")
    );
  }
  return S.join(`
`);
}
function gK(e) {
  return e == null ? "" : String(e);
}
function D6(e) {
  const t = typeof e == "string" ? e.codePointAt(0) : 0;
  return t === 67 || t === 99 ? 99 : t === 76 || t === 108 ? 108 : t === 82 || t === 114 ? 114 : 0;
}
function yK(e, t, n, r) {
  const i = n.enter("blockquote"), s = n.createTracker(r);
  s.move("> "), s.shift(2);
  const o = n.indentLines(
    n.containerFlow(e, s.current()),
    vK
  );
  return i(), o;
}
function vK(e, t, n) {
  return ">" + (n ? "" : " ") + e;
}
function xK(e, t) {
  return I6(e, t.inConstruct, !0) && !I6(e, t.notInConstruct, !1);
}
function I6(e, t, n) {
  if (typeof t == "string" && (t = [t]), !t || t.length === 0)
    return n;
  let r = -1;
  for (; ++r < t.length; )
    if (e.includes(t[r]))
      return !0;
  return !1;
}
function P6(e, t, n, r) {
  let i = -1;
  for (; ++i < n.unsafe.length; )
    if (n.unsafe[i].character === `
` && xK(n.stack, n.unsafe[i]))
      return /[ \t]/.test(r.before) ? "" : " ";
  return `\\
`;
}
function bK(e, t) {
  const n = String(e);
  let r = n.indexOf(t), i = r, s = 0, o = 0;
  if (typeof t != "string")
    throw new TypeError("Expected substring");
  for (; r !== -1; )
    r === i ? ++s > o && (o = s) : s = 1, i = r + t.length, r = n.indexOf(t, i);
  return o;
}
function wK(e, t) {
  return !!(t.options.fences === !1 && e.value && // If theres no info
  !e.lang && // And theres a non-whitespace character
  /[^ \r\n]/.test(e.value) && // And the value doesnt start or end in a blank
  !/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value));
}
function _K(e) {
  const t = e.options.fence || "`";
  if (t !== "`" && t !== "~")
    throw new Error(
      "Cannot serialize code with `" + t + "` for `options.fence`, expected `` ` `` or `~`"
    );
  return t;
}
function SK(e, t, n, r) {
  const i = _K(n), s = e.value || "", o = i === "`" ? "GraveAccent" : "Tilde";
  if (wK(e, n)) {
    const p = n.enter("codeIndented"), x = n.indentLines(s, CK);
    return p(), x;
  }
  const u = n.createTracker(r), c = i.repeat(Math.max(bK(s, i) + 1, 3)), d = n.enter("codeFenced");
  let m = u.move(c);
  if (e.lang) {
    const p = n.enter(`codeFencedLang${o}`);
    m += u.move(
      n.safe(e.lang, {
        before: m,
        after: " ",
        encode: ["`"],
        ...u.current()
      })
    ), p();
  }
  if (e.lang && e.meta) {
    const p = n.enter(`codeFencedMeta${o}`);
    m += u.move(" "), m += u.move(
      n.safe(e.meta, {
        before: m,
        after: `
`,
        encode: ["`"],
        ...u.current()
      })
    ), p();
  }
  return m += u.move(`
`), s && (m += u.move(s + `
`)), m += u.move(c), d(), m;
}
function CK(e, t, n) {
  return (n ? "" : "    ") + e;
}
function YC(e) {
  const t = e.options.quote || '"';
  if (t !== '"' && t !== "'")
    throw new Error(
      "Cannot serialize title with `" + t + "` for `options.quote`, expected `\"`, or `'`"
    );
  return t;
}
function EK(e, t, n, r) {
  const i = YC(n), s = i === '"' ? "Quote" : "Apostrophe", o = n.enter("definition");
  let u = n.enter("label");
  const c = n.createTracker(r);
  let d = c.move("[");
  return d += c.move(
    n.safe(n.associationId(e), {
      before: d,
      after: "]",
      ...c.current()
    })
  ), d += c.move("]: "), u(), // If theres no url, or
  !e.url || // If there are control characters or whitespace.
  /[\0- \u007F]/.test(e.url) ? (u = n.enter("destinationLiteral"), d += c.move("<"), d += c.move(
    n.safe(e.url, { before: d, after: ">", ...c.current() })
  ), d += c.move(">")) : (u = n.enter("destinationRaw"), d += c.move(
    n.safe(e.url, {
      before: d,
      after: e.title ? " " : `
`,
      ...c.current()
    })
  )), u(), e.title && (u = n.enter(`title${s}`), d += c.move(" " + i), d += c.move(
    n.safe(e.title, {
      before: d,
      after: i,
      ...c.current()
    })
  ), d += c.move(i), u()), o(), d;
}
function kK(e) {
  const t = e.options.emphasis || "*";
  if (t !== "*" && t !== "_")
    throw new Error(
      "Cannot serialize emphasis with `" + t + "` for `options.emphasis`, expected `*`, or `_`"
    );
  return t;
}
function c0(e) {
  return "&#x" + e.toString(16).toUpperCase() + ";";
}
function Ev(e, t, n) {
  const r = km(e), i = km(t);
  return r === void 0 ? i === void 0 ? (
    // Letter inside:
    // we have to encode *both* letters for `_` as it is looser.
    // it already forms for `*` (and GFMs `~`).
    n === "_" ? { inside: !0, outside: !0 } : { inside: !1, outside: !1 }
  ) : i === 1 ? (
    // Whitespace inside: encode both (letter, whitespace).
    { inside: !0, outside: !0 }
  ) : (
    // Punctuation inside: encode outer (letter)
    { inside: !1, outside: !0 }
  ) : r === 1 ? i === void 0 ? (
    // Letter inside: already forms.
    { inside: !1, outside: !1 }
  ) : i === 1 ? (
    // Whitespace inside: encode both (whitespace).
    { inside: !0, outside: !0 }
  ) : (
    // Punctuation inside: already forms.
    { inside: !1, outside: !1 }
  ) : i === void 0 ? (
    // Letter inside: already forms.
    { inside: !1, outside: !1 }
  ) : i === 1 ? (
    // Whitespace inside: encode inner (whitespace).
    { inside: !0, outside: !1 }
  ) : (
    // Punctuation inside: already forms.
    { inside: !1, outside: !1 }
  );
}
EO.peek = TK;
function EO(e, t, n, r) {
  const i = kK(n), s = n.enter("emphasis"), o = n.createTracker(r), u = o.move(i);
  let c = o.move(
    n.containerPhrasing(e, {
      after: i,
      before: u,
      ...o.current()
    })
  );
  const d = c.charCodeAt(0), m = Ev(
    r.before.charCodeAt(r.before.length - 1),
    d,
    i
  );
  m.inside && (c = c0(d) + c.slice(1));
  const p = c.charCodeAt(c.length - 1), x = Ev(r.after.charCodeAt(0), p, i);
  x.inside && (c = c.slice(0, -1) + c0(p));
  const b = o.move(i);
  return s(), n.attentionEncodeSurroundingInfo = {
    after: x.outside,
    before: m.outside
  }, u + c + b;
}
function TK(e, t, n) {
  return n.options.emphasis || "*";
}
function NK(e, t) {
  let n = !1;
  return GC(e, function(r) {
    if ("value" in r && /\r?\n|\r/.test(r.value) || r.type === "break")
      return n = !0, x5;
  }), !!((!e.depth || e.depth < 3) && BC(e) && (t.options.setext || n));
}
function AK(e, t, n, r) {
  const i = Math.max(Math.min(6, e.depth || 1), 1), s = n.createTracker(r);
  if (NK(e, n)) {
    const m = n.enter("headingSetext"), p = n.enter("phrasing"), x = n.containerPhrasing(e, {
      ...s.current(),
      before: `
`,
      after: `
`
    });
    return p(), m(), x + `
` + (i === 1 ? "=" : "-").repeat(
      // The whole size
      x.length - // Minus the position of the character after the last EOL (or
      // 0 if there is none)
      (Math.max(x.lastIndexOf("\r"), x.lastIndexOf(`
`)) + 1)
    );
  }
  const o = "#".repeat(i), u = n.enter("headingAtx"), c = n.enter("phrasing");
  s.move(o + " ");
  let d = n.containerPhrasing(e, {
    before: "# ",
    after: `
`,
    ...s.current()
  });
  return /^[\t ]/.test(d) && (d = c0(d.charCodeAt(0)) + d.slice(1)), d = d ? o + " " + d : o, n.options.closeAtx && (d += " " + o), c(), u(), d;
}
kO.peek = jK;
function kO(e) {
  return e.value || "";
}
function jK() {
  return "<";
}
TO.peek = MK;
function TO(e, t, n, r) {
  const i = YC(n), s = i === '"' ? "Quote" : "Apostrophe", o = n.enter("image");
  let u = n.enter("label");
  const c = n.createTracker(r);
  let d = c.move("![");
  return d += c.move(
    n.safe(e.alt, { before: d, after: "]", ...c.current() })
  ), d += c.move("]("), u(), // If theres no url but there is a title
  !e.url && e.title || // If there are control characters or whitespace.
  /[\0- \u007F]/.test(e.url) ? (u = n.enter("destinationLiteral"), d += c.move("<"), d += c.move(
    n.safe(e.url, { before: d, after: ">", ...c.current() })
  ), d += c.move(">")) : (u = n.enter("destinationRaw"), d += c.move(
    n.safe(e.url, {
      before: d,
      after: e.title ? " " : ")",
      ...c.current()
    })
  )), u(), e.title && (u = n.enter(`title${s}`), d += c.move(" " + i), d += c.move(
    n.safe(e.title, {
      before: d,
      after: i,
      ...c.current()
    })
  ), d += c.move(i), u()), d += c.move(")"), o(), d;
}
function MK() {
  return "!";
}
NO.peek = RK;
function NO(e, t, n, r) {
  const i = e.referenceType, s = n.enter("imageReference");
  let o = n.enter("label");
  const u = n.createTracker(r);
  let c = u.move("![");
  const d = n.safe(e.alt, {
    before: c,
    after: "]",
    ...u.current()
  });
  c += u.move(d + "]["), o();
  const m = n.stack;
  n.stack = [], o = n.enter("reference");
  const p = n.safe(n.associationId(e), {
    before: c,
    after: "]",
    ...u.current()
  });
  return o(), n.stack = m, s(), i === "full" || !d || d !== p ? c += u.move(p + "]") : i === "shortcut" ? c = c.slice(0, -1) : c += u.move("]"), c;
}
function RK() {
  return "!";
}
AO.peek = OK;
function AO(e, t, n) {
  let r = e.value || "", i = "`", s = -1;
  for (; new RegExp("(^|[^`])" + i + "([^`]|$)").test(r); )
    i += "`";
  for (/[^ \r\n]/.test(r) && (/^[ \r\n]/.test(r) && /[ \r\n]$/.test(r) || /^`|`$/.test(r)) && (r = " " + r + " "); ++s < n.unsafe.length; ) {
    const o = n.unsafe[s], u = n.compilePattern(o);
    let c;
    if (o.atBreak)
      for (; c = u.exec(r); ) {
        let d = c.index;
        r.charCodeAt(d) === 10 && r.charCodeAt(d - 1) === 13 && d--, r = r.slice(0, d) + " " + r.slice(c.index + 1);
      }
  }
  return i + r + i;
}
function OK() {
  return "`";
}
function jO(e, t) {
  const n = BC(e);
  return !!(!t.options.resourceLink && // If theres a url
  e.url && // And theres a no title
  !e.title && // And the content of `node` is a single text node
  e.children && e.children.length === 1 && e.children[0].type === "text" && // And if the url is the same as the content
  (n === e.url || "mailto:" + n === e.url) && // And that starts w/ a protocol
  /^[a-z][a-z+.-]+:/i.test(e.url) && // And that doesnt contain ASCII control codes (character escapes and
  // references dont work), space, or angle brackets
  !/[\0- <>\u007F]/.test(e.url));
}
MO.peek = DK;
function MO(e, t, n, r) {
  const i = YC(n), s = i === '"' ? "Quote" : "Apostrophe", o = n.createTracker(r);
  let u, c;
  if (jO(e, n)) {
    const m = n.stack;
    n.stack = [], u = n.enter("autolink");
    let p = o.move("<");
    return p += o.move(
      n.containerPhrasing(e, {
        before: p,
        after: ">",
        ...o.current()
      })
    ), p += o.move(">"), u(), n.stack = m, p;
  }
  u = n.enter("link"), c = n.enter("label");
  let d = o.move("[");
  return d += o.move(
    n.containerPhrasing(e, {
      before: d,
      after: "](",
      ...o.current()
    })
  ), d += o.move("]("), c(), // If theres no url but there is a title
  !e.url && e.title || // If there are control characters or whitespace.
  /[\0- \u007F]/.test(e.url) ? (c = n.enter("destinationLiteral"), d += o.move("<"), d += o.move(
    n.safe(e.url, { before: d, after: ">", ...o.current() })
  ), d += o.move(">")) : (c = n.enter("destinationRaw"), d += o.move(
    n.safe(e.url, {
      before: d,
      after: e.title ? " " : ")",
      ...o.current()
    })
  )), c(), e.title && (c = n.enter(`title${s}`), d += o.move(" " + i), d += o.move(
    n.safe(e.title, {
      before: d,
      after: i,
      ...o.current()
    })
  ), d += o.move(i), c()), d += o.move(")"), u(), d;
}
function DK(e, t, n) {
  return jO(e, n) ? "<" : "[";
}
RO.peek = IK;
function RO(e, t, n, r) {
  const i = e.referenceType, s = n.enter("linkReference");
  let o = n.enter("label");
  const u = n.createTracker(r);
  let c = u.move("[");
  const d = n.containerPhrasing(e, {
    before: c,
    after: "]",
    ...u.current()
  });
  c += u.move(d + "]["), o();
  const m = n.stack;
  n.stack = [], o = n.enter("reference");
  const p = n.safe(n.associationId(e), {
    before: c,
    after: "]",
    ...u.current()
  });
  return o(), n.stack = m, s(), i === "full" || !d || d !== p ? c += u.move(p + "]") : i === "shortcut" ? c = c.slice(0, -1) : c += u.move("]"), c;
}
function IK() {
  return "[";
}
function WC(e) {
  const t = e.options.bullet || "*";
  if (t !== "*" && t !== "+" && t !== "-")
    throw new Error(
      "Cannot serialize items with `" + t + "` for `options.bullet`, expected `*`, `+`, or `-`"
    );
  return t;
}
function PK(e) {
  const t = WC(e), n = e.options.bulletOther;
  if (!n)
    return t === "*" ? "-" : "*";
  if (n !== "*" && n !== "+" && n !== "-")
    throw new Error(
      "Cannot serialize items with `" + n + "` for `options.bulletOther`, expected `*`, `+`, or `-`"
    );
  if (n === t)
    throw new Error(
      "Expected `bullet` (`" + t + "`) and `bulletOther` (`" + n + "`) to be different"
    );
  return n;
}
function zK(e) {
  const t = e.options.bulletOrdered || ".";
  if (t !== "." && t !== ")")
    throw new Error(
      "Cannot serialize items with `" + t + "` for `options.bulletOrdered`, expected `.` or `)`"
    );
  return t;
}
function OO(e) {
  const t = e.options.rule || "*";
  if (t !== "*" && t !== "-" && t !== "_")
    throw new Error(
      "Cannot serialize rules with `" + t + "` for `options.rule`, expected `*`, `-`, or `_`"
    );
  return t;
}
function LK(e, t, n, r) {
  const i = n.enter("list"), s = n.bulletCurrent;
  let o = e.ordered ? zK(n) : WC(n);
  const u = e.ordered ? o === "." ? ")" : "." : PK(n);
  let c = t && n.bulletLastUsed ? o === n.bulletLastUsed : !1;
  if (!e.ordered) {
    const m = e.children ? e.children[0] : void 0;
    if (
      // Bullet could be used as a thematic break marker:
      (o === "*" || o === "-") && // Empty first list item:
      m && (!m.children || !m.children[0]) && // Directly in two other list items:
      n.stack[n.stack.length - 1] === "list" && n.stack[n.stack.length - 2] === "listItem" && n.stack[n.stack.length - 3] === "list" && n.stack[n.stack.length - 4] === "listItem" && // That are each the first child.
      n.indexStack[n.indexStack.length - 1] === 0 && n.indexStack[n.indexStack.length - 2] === 0 && n.indexStack[n.indexStack.length - 3] === 0 && (c = !0), OO(n) === o && m
    ) {
      let p = -1;
      for (; ++p < e.children.length; ) {
        const x = e.children[p];
        if (x && x.type === "listItem" && x.children && x.children[0] && x.children[0].type === "thematicBreak") {
          c = !0;
          break;
        }
      }
    }
  }
  c && (o = u), n.bulletCurrent = o;
  const d = n.containerFlow(e, r);
  return n.bulletLastUsed = o, n.bulletCurrent = s, i(), d;
}
function BK(e) {
  const t = e.options.listItemIndent || "one";
  if (t !== "tab" && t !== "one" && t !== "mixed")
    throw new Error(
      "Cannot serialize items with `" + t + "` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`"
    );
  return t;
}
function qK(e, t, n, r) {
  const i = BK(n);
  let s = n.bulletCurrent || WC(n);
  t && t.type === "list" && t.ordered && (s = (typeof t.start == "number" && t.start > -1 ? t.start : 1) + (n.options.incrementListMarker === !1 ? 0 : t.children.indexOf(e)) + s);
  let o = s.length + 1;
  (i === "tab" || i === "mixed" && (t && t.type === "list" && t.spread || e.spread)) && (o = Math.ceil(o / 4) * 4);
  const u = n.createTracker(r);
  u.move(s + " ".repeat(o - s.length)), u.shift(o);
  const c = n.enter("listItem"), d = n.indentLines(
    n.containerFlow(e, u.current()),
    m
  );
  return c(), d;
  function m(p, x, b) {
    return x ? (b ? "" : " ".repeat(o)) + p : (b ? s : s + " ".repeat(o - s.length)) + p;
  }
}
function FK(e, t, n, r) {
  const i = n.enter("paragraph"), s = n.enter("phrasing"), o = n.containerPhrasing(e, r);
  return s(), i(), o;
}
const UK = (
  /** @type {(node?: unknown) => node is Exclude<PhrasingContent, Html>} */
  ax([
    "break",
    "delete",
    "emphasis",
    // To do: next major: removed since footnotes were added to GFM.
    "footnote",
    "footnoteReference",
    "image",
    "imageReference",
    "inlineCode",
    // Enabled by `mdast-util-math`:
    "inlineMath",
    "link",
    "linkReference",
    // Enabled by `mdast-util-mdx`:
    "mdxJsxTextElement",
    // Enabled by `mdast-util-mdx`:
    "mdxTextExpression",
    "strong",
    "text",
    // Enabled by `mdast-util-directive`:
    "textDirective"
  ])
);
function $K(e, t, n, r) {
  return (e.children.some(function(o) {
    return UK(o);
  }) ? n.containerPhrasing : n.containerFlow).call(n, e, r);
}
function VK(e) {
  const t = e.options.strong || "*";
  if (t !== "*" && t !== "_")
    throw new Error(
      "Cannot serialize strong with `" + t + "` for `options.strong`, expected `*`, or `_`"
    );
  return t;
}
DO.peek = HK;
function DO(e, t, n, r) {
  const i = VK(n), s = n.enter("strong"), o = n.createTracker(r), u = o.move(i + i);
  let c = o.move(
    n.containerPhrasing(e, {
      after: i,
      before: u,
      ...o.current()
    })
  );
  const d = c.charCodeAt(0), m = Ev(
    r.before.charCodeAt(r.before.length - 1),
    d,
    i
  );
  m.inside && (c = c0(d) + c.slice(1));
  const p = c.charCodeAt(c.length - 1), x = Ev(r.after.charCodeAt(0), p, i);
  x.inside && (c = c.slice(0, -1) + c0(p));
  const b = o.move(i + i);
  return s(), n.attentionEncodeSurroundingInfo = {
    after: x.outside,
    before: m.outside
  }, u + c + b;
}
function HK(e, t, n) {
  return n.options.strong || "*";
}
function GK(e, t, n, r) {
  return n.safe(e.value, r);
}
function KK(e) {
  const t = e.options.ruleRepetition || 3;
  if (t < 3)
    throw new Error(
      "Cannot serialize rules with repetition `" + t + "` for `options.ruleRepetition`, expected `3` or more"
    );
  return t;
}
function YK(e, t, n) {
  const r = (OO(n) + (n.options.ruleSpaces ? " " : "")).repeat(KK(n));
  return n.options.ruleSpaces ? r.slice(0, -1) : r;
}
const IO = {
  blockquote: yK,
  break: P6,
  code: SK,
  definition: EK,
  emphasis: EO,
  hardBreak: P6,
  heading: AK,
  html: kO,
  image: TO,
  imageReference: NO,
  inlineCode: AO,
  link: MO,
  linkReference: RO,
  list: LK,
  listItem: qK,
  paragraph: FK,
  root: $K,
  strong: DO,
  text: GK,
  thematicBreak: YK
};
function WK() {
  return {
    enter: {
      table: XK,
      tableData: z6,
      tableHeader: z6,
      tableRow: ZK
    },
    exit: {
      codeText: JK,
      table: QK,
      tableData: o2,
      tableHeader: o2,
      tableRow: o2
    }
  };
}
function XK(e) {
  const t = e._align;
  this.enter(
    {
      type: "table",
      align: t.map(function(n) {
        return n === "none" ? null : n;
      }),
      children: []
    },
    e
  ), this.data.inTable = !0;
}
function QK(e) {
  this.exit(e), this.data.inTable = void 0;
}
function ZK(e) {
  this.enter({ type: "tableRow", children: [] }, e);
}
function o2(e) {
  this.exit(e);
}
function z6(e) {
  this.enter({ type: "tableCell", children: [] }, e);
}
function JK(e) {
  let t = this.resume();
  this.data.inTable && (t = t.replace(/\\([\\|])/g, eY));
  const n = this.stack[this.stack.length - 1];
  n.type, n.value = t, this.exit(e);
}
function eY(e, t) {
  return t === "|" ? t : e;
}
function tY(e) {
  const t = e || {}, n = t.tableCellPadding, r = t.tablePipeAlign, i = t.stringLength, s = n ? " " : "|";
  return {
    unsafe: [
      { character: "\r", inConstruct: "tableCell" },
      { character: `
`, inConstruct: "tableCell" },
      // A pipe, when followed by a tab or space (padding), or a dash or colon
      // (unpadded delimiter row), could result in a table.
      { atBreak: !0, character: "|", after: "[	 :-]" },
      // A pipe in a cell must be encoded.
      { character: "|", inConstruct: "tableCell" },
      // A colon must be followed by a dash, in which case it could start a
      // delimiter row.
      { atBreak: !0, character: ":", after: "-" },
      // A delimiter row can also start with a dash, when followed by more
      // dashes, a colon, or a pipe.
      // This is a stricter version than the built in check for lists, thematic
      // breaks, and setex heading underlines though:
      // <https://github.com/syntax-tree/mdast-util-to-markdown/blob/51a2038/lib/unsafe.js#L57>
      { atBreak: !0, character: "-", after: "[:|-]" }
    ],
    handlers: {
      inlineCode: x,
      table: o,
      tableCell: c,
      tableRow: u
    }
  };
  function o(b, S, k, A) {
    return d(m(b, k, A), b.align);
  }
  function u(b, S, k, A) {
    const T = p(b, k, A), M = d([T]);
    return M.slice(0, M.indexOf(`
`));
  }
  function c(b, S, k, A) {
    const T = k.enter("tableCell"), M = k.enter("phrasing"), j = k.containerPhrasing(b, {
      ...A,
      before: s,
      after: s
    });
    return M(), T(), j;
  }
  function d(b, S) {
    return pK(b, {
      align: S,
      // @ts-expect-error: `markdown-table` types should support `null`.
      alignDelimiters: r,
      // @ts-expect-error: `markdown-table` types should support `null`.
      padding: n,
      // @ts-expect-error: `markdown-table` types should support `null`.
      stringLength: i
    });
  }
  function m(b, S, k) {
    const A = b.children;
    let T = -1;
    const M = [], j = S.enter("table");
    for (; ++T < A.length; )
      M[T] = p(A[T], S, k);
    return j(), M;
  }
  function p(b, S, k) {
    const A = b.children;
    let T = -1;
    const M = [], j = S.enter("tableRow");
    for (; ++T < A.length; )
      M[T] = c(A[T], b, S, k);
    return j(), M;
  }
  function x(b, S, k) {
    let A = IO.inlineCode(b, S, k);
    return k.stack.includes("tableCell") && (A = A.replace(/\|/g, "\\$&")), A;
  }
}
function nY() {
  return {
    exit: {
      taskListCheckValueChecked: L6,
      taskListCheckValueUnchecked: L6,
      paragraph: iY
    }
  };
}
function rY() {
  return {
    unsafe: [{ atBreak: !0, character: "-", after: "[:|-]" }],
    handlers: { listItem: aY }
  };
}
function L6(e) {
  const t = this.stack[this.stack.length - 2];
  t.type, t.checked = e.type === "taskListCheckValueChecked";
}
function iY(e) {
  const t = this.stack[this.stack.length - 2];
  if (t && t.type === "listItem" && typeof t.checked == "boolean") {
    const n = this.stack[this.stack.length - 1];
    n.type;
    const r = n.children[0];
    if (r && r.type === "text") {
      const i = t.children;
      let s = -1, o;
      for (; ++s < i.length; ) {
        const u = i[s];
        if (u.type === "paragraph") {
          o = u;
          break;
        }
      }
      o === n && (r.value = r.value.slice(1), r.value.length === 0 ? n.children.shift() : n.position && r.position && typeof r.position.start.offset == "number" && (r.position.start.column++, r.position.start.offset++, n.position.start = Object.assign({}, r.position.start)));
    }
  }
  this.exit(e);
}
function aY(e, t, n, r) {
  const i = e.children[0], s = typeof e.checked == "boolean" && i && i.type === "paragraph", o = "[" + (e.checked ? "x" : " ") + "] ", u = n.createTracker(r);
  s && u.move(o);
  let c = IO.listItem(e, t, n, {
    ...r,
    ...u.current()
  });
  return s && (c = c.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/, d)), c;
  function d(m) {
    return m + o;
  }
}
function sY() {
  return [
    LG(),
    aK(),
    uK(),
    WK(),
    nY()
  ];
}
function oY(e) {
  return {
    extensions: [
      BG(),
      sK(e),
      cK(),
      tY(e),
      rY()
    ]
  };
}
const lY = {
  tokenize: mY,
  partial: !0
}, PO = {
  tokenize: pY,
  partial: !0
}, zO = {
  tokenize: gY,
  partial: !0
}, LO = {
  tokenize: yY,
  partial: !0
}, uY = {
  tokenize: vY,
  partial: !0
}, BO = {
  name: "wwwAutolink",
  tokenize: dY,
  previous: FO
}, qO = {
  name: "protocolAutolink",
  tokenize: hY,
  previous: UO
}, ku = {
  name: "emailAutolink",
  tokenize: fY,
  previous: $O
}, Dl = {};
function cY() {
  return {
    text: Dl
  };
}
let od = 48;
for (; od < 123; )
  Dl[od] = ku, od++, od === 58 ? od = 65 : od === 91 && (od = 97);
Dl[43] = ku;
Dl[45] = ku;
Dl[46] = ku;
Dl[95] = ku;
Dl[72] = [ku, qO];
Dl[104] = [ku, qO];
Dl[87] = [ku, BO];
Dl[119] = [ku, BO];
function fY(e, t, n) {
  const r = this;
  let i, s;
  return o;
  function o(p) {
    return !S5(p) || !$O.call(r, r.previous) || XC(r.events) ? n(p) : (e.enter("literalAutolink"), e.enter("literalAutolinkEmail"), u(p));
  }
  function u(p) {
    return S5(p) ? (e.consume(p), u) : p === 64 ? (e.consume(p), c) : n(p);
  }
  function c(p) {
    return p === 46 ? e.check(uY, m, d)(p) : p === 45 || p === 95 || qi(p) ? (s = !0, e.consume(p), c) : m(p);
  }
  function d(p) {
    return e.consume(p), i = !0, c;
  }
  function m(p) {
    return s && i && la(r.previous) ? (e.exit("literalAutolinkEmail"), e.exit("literalAutolink"), t(p)) : n(p);
  }
}
function dY(e, t, n) {
  const r = this;
  return i;
  function i(o) {
    return o !== 87 && o !== 119 || !FO.call(r, r.previous) || XC(r.events) ? n(o) : (e.enter("literalAutolink"), e.enter("literalAutolinkWww"), e.check(lY, e.attempt(PO, e.attempt(zO, s), n), n)(o));
  }
  function s(o) {
    return e.exit("literalAutolinkWww"), e.exit("literalAutolink"), t(o);
  }
}
function hY(e, t, n) {
  const r = this;
  let i = "", s = !1;
  return o;
  function o(p) {
    return (p === 72 || p === 104) && UO.call(r, r.previous) && !XC(r.events) ? (e.enter("literalAutolink"), e.enter("literalAutolinkHttp"), i += String.fromCodePoint(p), e.consume(p), u) : n(p);
  }
  function u(p) {
    if (la(p) && i.length < 5)
      return i += String.fromCodePoint(p), e.consume(p), u;
    if (p === 58) {
      const x = i.toLowerCase();
      if (x === "http" || x === "https")
        return e.consume(p), c;
    }
    return n(p);
  }
  function c(p) {
    return p === 47 ? (e.consume(p), s ? d : (s = !0, c)) : n(p);
  }
  function d(p) {
    return p === null || _v(p) || Fn(p) || Md(p) || nx(p) ? n(p) : e.attempt(PO, e.attempt(zO, m), n)(p);
  }
  function m(p) {
    return e.exit("literalAutolinkHttp"), e.exit("literalAutolink"), t(p);
  }
}
function mY(e, t, n) {
  let r = 0;
  return i;
  function i(o) {
    return (o === 87 || o === 119) && r < 3 ? (r++, e.consume(o), i) : o === 46 && r === 3 ? (e.consume(o), s) : n(o);
  }
  function s(o) {
    return o === null ? n(o) : t(o);
  }
}
function pY(e, t, n) {
  let r, i, s;
  return o;
  function o(d) {
    return d === 46 || d === 95 ? e.check(LO, c, u)(d) : d === null || Fn(d) || Md(d) || d !== 45 && nx(d) ? c(d) : (s = !0, e.consume(d), o);
  }
  function u(d) {
    return d === 95 ? r = !0 : (i = r, r = void 0), e.consume(d), o;
  }
  function c(d) {
    return i || r || !s ? n(d) : t(d);
  }
}
function gY(e, t) {
  let n = 0, r = 0;
  return i;
  function i(o) {
    return o === 40 ? (n++, e.consume(o), i) : o === 41 && r < n ? s(o) : o === 33 || o === 34 || o === 38 || o === 39 || o === 41 || o === 42 || o === 44 || o === 46 || o === 58 || o === 59 || o === 60 || o === 63 || o === 93 || o === 95 || o === 126 ? e.check(LO, t, s)(o) : o === null || Fn(o) || Md(o) ? t(o) : (e.consume(o), i);
  }
  function s(o) {
    return o === 41 && r++, e.consume(o), i;
  }
}
function yY(e, t, n) {
  return r;
  function r(u) {
    return u === 33 || u === 34 || u === 39 || u === 41 || u === 42 || u === 44 || u === 46 || u === 58 || u === 59 || u === 63 || u === 95 || u === 126 ? (e.consume(u), r) : u === 38 ? (e.consume(u), s) : u === 93 ? (e.consume(u), i) : (
      // `<` is an end.
      u === 60 || // So is whitespace.
      u === null || Fn(u) || Md(u) ? t(u) : n(u)
    );
  }
  function i(u) {
    return u === null || u === 40 || u === 91 || Fn(u) || Md(u) ? t(u) : r(u);
  }
  function s(u) {
    return la(u) ? o(u) : n(u);
  }
  function o(u) {
    return u === 59 ? (e.consume(u), r) : la(u) ? (e.consume(u), o) : n(u);
  }
}
function vY(e, t, n) {
  return r;
  function r(s) {
    return e.consume(s), i;
  }
  function i(s) {
    return qi(s) ? n(s) : t(s);
  }
}
function FO(e) {
  return e === null || e === 40 || e === 42 || e === 95 || e === 91 || e === 93 || e === 126 || Fn(e);
}
function UO(e) {
  return !la(e);
}
function $O(e) {
  return !(e === 47 || S5(e));
}
function S5(e) {
  return e === 43 || e === 45 || e === 46 || e === 95 || qi(e);
}
function XC(e) {
  let t = e.length, n = !1;
  for (; t--; ) {
    const r = e[t][1];
    if ((r.type === "labelLink" || r.type === "labelImage") && !r._balanced) {
      n = !0;
      break;
    }
    if (r._gfmAutolinkLiteralWalkedInto) {
      n = !1;
      break;
    }
  }
  return e.length > 0 && !n && (e[e.length - 1][1]._gfmAutolinkLiteralWalkedInto = !0), n;
}
const xY = {
  tokenize: TY,
  partial: !0
};
function bY() {
  return {
    document: {
      91: {
        name: "gfmFootnoteDefinition",
        tokenize: CY,
        continuation: {
          tokenize: EY
        },
        exit: kY
      }
    },
    text: {
      91: {
        name: "gfmFootnoteCall",
        tokenize: SY
      },
      93: {
        name: "gfmPotentialFootnoteCall",
        add: "after",
        tokenize: wY,
        resolveTo: _Y
      }
    }
  };
}
function wY(e, t, n) {
  const r = this;
  let i = r.events.length;
  const s = r.parser.gfmFootnotes || (r.parser.gfmFootnotes = []);
  let o;
  for (; i--; ) {
    const c = r.events[i][1];
    if (c.type === "labelImage") {
      o = c;
      break;
    }
    if (c.type === "gfmFootnoteCall" || c.type === "labelLink" || c.type === "label" || c.type === "image" || c.type === "link")
      break;
  }
  return u;
  function u(c) {
    if (!o || !o._balanced)
      return n(c);
    const d = Ao(r.sliceSerialize({
      start: o.end,
      end: r.now()
    }));
    return d.codePointAt(0) !== 94 || !s.includes(d.slice(1)) ? n(c) : (e.enter("gfmFootnoteCallLabelMarker"), e.consume(c), e.exit("gfmFootnoteCallLabelMarker"), t(c));
  }
}
function _Y(e, t) {
  let n = e.length;
  for (; n--; )
    if (e[n][1].type === "labelImage" && e[n][0] === "enter") {
      e[n][1];
      break;
    }
  e[n + 1][1].type = "data", e[n + 3][1].type = "gfmFootnoteCallLabelMarker";
  const r = {
    type: "gfmFootnoteCall",
    start: Object.assign({}, e[n + 3][1].start),
    end: Object.assign({}, e[e.length - 1][1].end)
  }, i = {
    type: "gfmFootnoteCallMarker",
    start: Object.assign({}, e[n + 3][1].end),
    end: Object.assign({}, e[n + 3][1].end)
  };
  i.end.column++, i.end.offset++, i.end._bufferIndex++;
  const s = {
    type: "gfmFootnoteCallString",
    start: Object.assign({}, i.end),
    end: Object.assign({}, e[e.length - 1][1].start)
  }, o = {
    type: "chunkString",
    contentType: "string",
    start: Object.assign({}, s.start),
    end: Object.assign({}, s.end)
  }, u = [
    // Take the `labelImageMarker` (now `data`, the `!`)
    e[n + 1],
    e[n + 2],
    ["enter", r, t],
    // The `[`
    e[n + 3],
    e[n + 4],
    // The `^`.
    ["enter", i, t],
    ["exit", i, t],
    // Everything in between.
    ["enter", s, t],
    ["enter", o, t],
    ["exit", o, t],
    ["exit", s, t],
    // The ending (`]`, properly parsed and labelled).
    e[e.length - 2],
    e[e.length - 1],
    ["exit", r, t]
  ];
  return e.splice(n, e.length - n + 1, ...u), e;
}
function SY(e, t, n) {
  const r = this, i = r.parser.gfmFootnotes || (r.parser.gfmFootnotes = []);
  let s = 0, o;
  return u;
  function u(p) {
    return e.enter("gfmFootnoteCall"), e.enter("gfmFootnoteCallLabelMarker"), e.consume(p), e.exit("gfmFootnoteCallLabelMarker"), c;
  }
  function c(p) {
    return p !== 94 ? n(p) : (e.enter("gfmFootnoteCallMarker"), e.consume(p), e.exit("gfmFootnoteCallMarker"), e.enter("gfmFootnoteCallString"), e.enter("chunkString").contentType = "string", d);
  }
  function d(p) {
    if (
      // Too long.
      s > 999 || // Closing brace with nothing.
      p === 93 && !o || // Space or tab is not supported by GFM for some reason.
      // `\n` and `[` not being supported makes sense.
      p === null || p === 91 || Fn(p)
    )
      return n(p);
    if (p === 93) {
      e.exit("chunkString");
      const x = e.exit("gfmFootnoteCallString");
      return i.includes(Ao(r.sliceSerialize(x))) ? (e.enter("gfmFootnoteCallLabelMarker"), e.consume(p), e.exit("gfmFootnoteCallLabelMarker"), e.exit("gfmFootnoteCall"), t) : n(p);
    }
    return Fn(p) || (o = !0), s++, e.consume(p), p === 92 ? m : d;
  }
  function m(p) {
    return p === 91 || p === 92 || p === 93 ? (e.consume(p), s++, d) : d(p);
  }
}
function CY(e, t, n) {
  const r = this, i = r.parser.gfmFootnotes || (r.parser.gfmFootnotes = []);
  let s, o = 0, u;
  return c;
  function c(S) {
    return e.enter("gfmFootnoteDefinition")._container = !0, e.enter("gfmFootnoteDefinitionLabel"), e.enter("gfmFootnoteDefinitionLabelMarker"), e.consume(S), e.exit("gfmFootnoteDefinitionLabelMarker"), d;
  }
  function d(S) {
    return S === 94 ? (e.enter("gfmFootnoteDefinitionMarker"), e.consume(S), e.exit("gfmFootnoteDefinitionMarker"), e.enter("gfmFootnoteDefinitionLabelString"), e.enter("chunkString").contentType = "string", m) : n(S);
  }
  function m(S) {
    if (
      // Too long.
      o > 999 || // Closing brace with nothing.
      S === 93 && !u || // Space or tab is not supported by GFM for some reason.
      // `\n` and `[` not being supported makes sense.
      S === null || S === 91 || Fn(S)
    )
      return n(S);
    if (S === 93) {
      e.exit("chunkString");
      const k = e.exit("gfmFootnoteDefinitionLabelString");
      return s = Ao(r.sliceSerialize(k)), e.enter("gfmFootnoteDefinitionLabelMarker"), e.consume(S), e.exit("gfmFootnoteDefinitionLabelMarker"), e.exit("gfmFootnoteDefinitionLabel"), x;
    }
    return Fn(S) || (u = !0), o++, e.consume(S), S === 92 ? p : m;
  }
  function p(S) {
    return S === 91 || S === 92 || S === 93 ? (e.consume(S), o++, m) : m(S);
  }
  function x(S) {
    return S === 58 ? (e.enter("definitionMarker"), e.consume(S), e.exit("definitionMarker"), i.includes(s) || i.push(s), hn(e, b, "gfmFootnoteDefinitionWhitespace")) : n(S);
  }
  function b(S) {
    return t(S);
  }
}
function EY(e, t, n) {
  return e.check(R0, t, e.attempt(xY, t, n));
}
function kY(e) {
  e.exit("gfmFootnoteDefinition");
}
function TY(e, t, n) {
  const r = this;
  return hn(e, i, "gfmFootnoteDefinitionIndent", 5);
  function i(s) {
    const o = r.events[r.events.length - 1];
    return o && o[1].type === "gfmFootnoteDefinitionIndent" && o[2].sliceSerialize(o[1], !0).length === 4 ? t(s) : n(s);
  }
}
function NY(e) {
  let n = (e || {}).singleTilde;
  const r = {
    name: "strikethrough",
    tokenize: s,
    resolveAll: i
  };
  return n == null && (n = !0), {
    text: {
      126: r
    },
    insideSpan: {
      null: [r]
    },
    attentionMarkers: {
      null: [126]
    }
  };
  function i(o, u) {
    let c = -1;
    for (; ++c < o.length; )
      if (o[c][0] === "enter" && o[c][1].type === "strikethroughSequenceTemporary" && o[c][1]._close) {
        let d = c;
        for (; d--; )
          if (o[d][0] === "exit" && o[d][1].type === "strikethroughSequenceTemporary" && o[d][1]._open && // If the sizes are the same:
          o[c][1].end.offset - o[c][1].start.offset === o[d][1].end.offset - o[d][1].start.offset) {
            o[c][1].type = "strikethroughSequence", o[d][1].type = "strikethroughSequence";
            const m = {
              type: "strikethrough",
              start: Object.assign({}, o[d][1].start),
              end: Object.assign({}, o[c][1].end)
            }, p = {
              type: "strikethroughText",
              start: Object.assign({}, o[d][1].end),
              end: Object.assign({}, o[c][1].start)
            }, x = [["enter", m, u], ["enter", o[d][1], u], ["exit", o[d][1], u], ["enter", p, u]], b = u.parser.constructs.insideSpan.null;
            b && ms(x, x.length, 0, rx(b, o.slice(d + 1, c), u)), ms(x, x.length, 0, [["exit", p, u], ["enter", o[c][1], u], ["exit", o[c][1], u], ["exit", m, u]]), ms(o, d - 1, c - d + 3, x), c = d + x.length - 2;
            break;
          }
      }
    for (c = -1; ++c < o.length; )
      o[c][1].type === "strikethroughSequenceTemporary" && (o[c][1].type = "data");
    return o;
  }
  function s(o, u, c) {
    const d = this.previous, m = this.events;
    let p = 0;
    return x;
    function x(S) {
      return d === 126 && m[m.length - 1][1].type !== "characterEscape" ? c(S) : (o.enter("strikethroughSequenceTemporary"), b(S));
    }
    function b(S) {
      const k = km(d);
      if (S === 126)
        return p > 1 ? c(S) : (o.consume(S), p++, b);
      if (p < 2 && !n) return c(S);
      const A = o.exit("strikethroughSequenceTemporary"), T = km(S);
      return A._open = !T || T === 2 && !!k, A._close = !k || k === 2 && !!T, u(S);
    }
  }
}
class AY {
  /**
   * Create a new edit map.
   */
  constructor() {
    this.map = [];
  }
  /**
   * Create an edit: a remove and/or add at a certain place.
   *
   * @param {number} index
   * @param {number} remove
   * @param {Array<Event>} add
   * @returns {undefined}
   */
  add(t, n, r) {
    jY(this, t, n, r);
  }
  // To do: add this when moving to `micromark`.
  // /**
  //  * Create an edit: but insert `add` before existing additions.
  //  *
  //  * @param {number} index
  //  * @param {number} remove
  //  * @param {Array<Event>} add
  //  * @returns {undefined}
  //  */
  // addBefore(index, remove, add) {
  //   addImplementation(this, index, remove, add, true)
  // }
  /**
   * Done, change the events.
   *
   * @param {Array<Event>} events
   * @returns {undefined}
   */
  consume(t) {
    if (this.map.sort(function(s, o) {
      return s[0] - o[0];
    }), this.map.length === 0)
      return;
    let n = this.map.length;
    const r = [];
    for (; n > 0; )
      n -= 1, r.push(t.slice(this.map[n][0] + this.map[n][1]), this.map[n][2]), t.length = this.map[n][0];
    r.push(t.slice()), t.length = 0;
    let i = r.pop();
    for (; i; ) {
      for (const s of i)
        t.push(s);
      i = r.pop();
    }
    this.map.length = 0;
  }
}
function jY(e, t, n, r) {
  let i = 0;
  if (!(n === 0 && r.length === 0)) {
    for (; i < e.map.length; ) {
      if (e.map[i][0] === t) {
        e.map[i][1] += n, e.map[i][2].push(...r);
        return;
      }
      i += 1;
    }
    e.map.push([t, n, r]);
  }
}
function MY(e, t) {
  let n = !1;
  const r = [];
  for (; t < e.length; ) {
    const i = e[t];
    if (n) {
      if (i[0] === "enter")
        i[1].type === "tableContent" && r.push(e[t + 1][1].type === "tableDelimiterMarker" ? "left" : "none");
      else if (i[1].type === "tableContent") {
        if (e[t - 1][1].type === "tableDelimiterMarker") {
          const s = r.length - 1;
          r[s] = r[s] === "left" ? "center" : "right";
        }
      } else if (i[1].type === "tableDelimiterRow")
        break;
    } else i[0] === "enter" && i[1].type === "tableDelimiterRow" && (n = !0);
    t += 1;
  }
  return r;
}
function RY() {
  return {
    flow: {
      null: {
        name: "table",
        tokenize: OY,
        resolveAll: DY
      }
    }
  };
}
function OY(e, t, n) {
  const r = this;
  let i = 0, s = 0, o;
  return u;
  function u(Y) {
    let H = r.events.length - 1;
    for (; H > -1; ) {
      const Q = r.events[H][1].type;
      if (Q === "lineEnding" || // Note: markdown-rs uses `whitespace` instead of `linePrefix`
      Q === "linePrefix") H--;
      else break;
    }
    const Z = H > -1 ? r.events[H][1].type : null, me = Z === "tableHead" || Z === "tableRow" ? I : c;
    return me === I && r.parser.lazy[r.now().line] ? n(Y) : me(Y);
  }
  function c(Y) {
    return e.enter("tableHead"), e.enter("tableRow"), d(Y);
  }
  function d(Y) {
    return Y === 124 || (o = !0, s += 1), m(Y);
  }
  function m(Y) {
    return Y === null ? n(Y) : Nt(Y) ? s > 1 ? (s = 0, r.interrupt = !0, e.exit("tableRow"), e.enter("lineEnding"), e.consume(Y), e.exit("lineEnding"), b) : n(Y) : nn(Y) ? hn(e, m, "whitespace")(Y) : (s += 1, o && (o = !1, i += 1), Y === 124 ? (e.enter("tableCellDivider"), e.consume(Y), e.exit("tableCellDivider"), o = !0, m) : (e.enter("data"), p(Y)));
  }
  function p(Y) {
    return Y === null || Y === 124 || Fn(Y) ? (e.exit("data"), m(Y)) : (e.consume(Y), Y === 92 ? x : p);
  }
  function x(Y) {
    return Y === 92 || Y === 124 ? (e.consume(Y), p) : p(Y);
  }
  function b(Y) {
    return r.interrupt = !1, r.parser.lazy[r.now().line] ? n(Y) : (e.enter("tableDelimiterRow"), o = !1, nn(Y) ? hn(e, S, "linePrefix", r.parser.constructs.disable.null.includes("codeIndented") ? void 0 : 4)(Y) : S(Y));
  }
  function S(Y) {
    return Y === 45 || Y === 58 ? A(Y) : Y === 124 ? (o = !0, e.enter("tableCellDivider"), e.consume(Y), e.exit("tableCellDivider"), k) : z(Y);
  }
  function k(Y) {
    return nn(Y) ? hn(e, A, "whitespace")(Y) : A(Y);
  }
  function A(Y) {
    return Y === 58 ? (s += 1, o = !0, e.enter("tableDelimiterMarker"), e.consume(Y), e.exit("tableDelimiterMarker"), T) : Y === 45 ? (s += 1, T(Y)) : Y === null || Nt(Y) ? D(Y) : z(Y);
  }
  function T(Y) {
    return Y === 45 ? (e.enter("tableDelimiterFiller"), M(Y)) : z(Y);
  }
  function M(Y) {
    return Y === 45 ? (e.consume(Y), M) : Y === 58 ? (o = !0, e.exit("tableDelimiterFiller"), e.enter("tableDelimiterMarker"), e.consume(Y), e.exit("tableDelimiterMarker"), j) : (e.exit("tableDelimiterFiller"), j(Y));
  }
  function j(Y) {
    return nn(Y) ? hn(e, D, "whitespace")(Y) : D(Y);
  }
  function D(Y) {
    return Y === 124 ? S(Y) : Y === null || Nt(Y) ? !o || i !== s ? z(Y) : (e.exit("tableDelimiterRow"), e.exit("tableHead"), t(Y)) : z(Y);
  }
  function z(Y) {
    return n(Y);
  }
  function I(Y) {
    return e.enter("tableRow"), L(Y);
  }
  function L(Y) {
    return Y === 124 ? (e.enter("tableCellDivider"), e.consume(Y), e.exit("tableCellDivider"), L) : Y === null || Nt(Y) ? (e.exit("tableRow"), t(Y)) : nn(Y) ? hn(e, L, "whitespace")(Y) : (e.enter("data"), K(Y));
  }
  function K(Y) {
    return Y === null || Y === 124 || Fn(Y) ? (e.exit("data"), L(Y)) : (e.consume(Y), Y === 92 ? ne : K);
  }
  function ne(Y) {
    return Y === 92 || Y === 124 ? (e.consume(Y), K) : K(Y);
  }
}
function DY(e, t) {
  let n = -1, r = !0, i = 0, s = [0, 0, 0, 0], o = [0, 0, 0, 0], u = !1, c = 0, d, m, p;
  const x = new AY();
  for (; ++n < e.length; ) {
    const b = e[n], S = b[1];
    b[0] === "enter" ? S.type === "tableHead" ? (u = !1, c !== 0 && (B6(x, t, c, d, m), m = void 0, c = 0), d = {
      type: "table",
      start: Object.assign({}, S.start),
      // Note: correct end is set later.
      end: Object.assign({}, S.end)
    }, x.add(n, 0, [["enter", d, t]])) : S.type === "tableRow" || S.type === "tableDelimiterRow" ? (r = !0, p = void 0, s = [0, 0, 0, 0], o = [0, n + 1, 0, 0], u && (u = !1, m = {
      type: "tableBody",
      start: Object.assign({}, S.start),
      // Note: correct end is set later.
      end: Object.assign({}, S.end)
    }, x.add(n, 0, [["enter", m, t]])), i = S.type === "tableDelimiterRow" ? 2 : m ? 3 : 1) : i && (S.type === "data" || S.type === "tableDelimiterMarker" || S.type === "tableDelimiterFiller") ? (r = !1, o[2] === 0 && (s[1] !== 0 && (o[0] = o[1], p = q1(x, t, s, i, void 0, p), s = [0, 0, 0, 0]), o[2] = n)) : S.type === "tableCellDivider" && (r ? r = !1 : (s[1] !== 0 && (o[0] = o[1], p = q1(x, t, s, i, void 0, p)), s = o, o = [s[1], n, 0, 0])) : S.type === "tableHead" ? (u = !0, c = n) : S.type === "tableRow" || S.type === "tableDelimiterRow" ? (c = n, s[1] !== 0 ? (o[0] = o[1], p = q1(x, t, s, i, n, p)) : o[1] !== 0 && (p = q1(x, t, o, i, n, p)), i = 0) : i && (S.type === "data" || S.type === "tableDelimiterMarker" || S.type === "tableDelimiterFiller") && (o[3] = n);
  }
  for (c !== 0 && B6(x, t, c, d, m), x.consume(t.events), n = -1; ++n < t.events.length; ) {
    const b = t.events[n];
    b[0] === "enter" && b[1].type === "table" && (b[1]._align = MY(t.events, n));
  }
  return e;
}
function q1(e, t, n, r, i, s) {
  const o = r === 1 ? "tableHeader" : r === 2 ? "tableDelimiter" : "tableData", u = "tableContent";
  n[0] !== 0 && (s.end = Object.assign({}, hm(t.events, n[0])), e.add(n[0], 0, [["exit", s, t]]));
  const c = hm(t.events, n[1]);
  if (s = {
    type: o,
    start: Object.assign({}, c),
    // Note: correct end is set later.
    end: Object.assign({}, c)
  }, e.add(n[1], 0, [["enter", s, t]]), n[2] !== 0) {
    const d = hm(t.events, n[2]), m = hm(t.events, n[3]), p = {
      type: u,
      start: Object.assign({}, d),
      end: Object.assign({}, m)
    };
    if (e.add(n[2], 0, [["enter", p, t]]), r !== 2) {
      const x = t.events[n[2]], b = t.events[n[3]];
      if (x[1].end = Object.assign({}, b[1].end), x[1].type = "chunkText", x[1].contentType = "text", n[3] > n[2] + 1) {
        const S = n[2] + 1, k = n[3] - n[2] - 1;
        e.add(S, k, []);
      }
    }
    e.add(n[3] + 1, 0, [["exit", p, t]]);
  }
  return i !== void 0 && (s.end = Object.assign({}, hm(t.events, i)), e.add(i, 0, [["exit", s, t]]), s = void 0), s;
}
function B6(e, t, n, r, i) {
  const s = [], o = hm(t.events, n);
  i && (i.end = Object.assign({}, o), s.push(["exit", i, t])), r.end = Object.assign({}, o), s.push(["exit", r, t]), e.add(n + 1, 0, s);
}
function hm(e, t) {
  const n = e[t], r = n[0] === "enter" ? "start" : "end";
  return n[1][r];
}
const IY = {
  name: "tasklistCheck",
  tokenize: zY
};
function PY() {
  return {
    text: {
      91: IY
    }
  };
}
function zY(e, t, n) {
  const r = this;
  return i;
  function i(c) {
    return (
      // Exit if theres stuff before.
      r.previous !== null || // Exit if not in the first content that is the first child of a list
      // item.
      !r._gfmTasklistFirstContentOfListItem ? n(c) : (e.enter("taskListCheck"), e.enter("taskListCheckMarker"), e.consume(c), e.exit("taskListCheckMarker"), s)
    );
  }
  function s(c) {
    return Fn(c) ? (e.enter("taskListCheckValueUnchecked"), e.consume(c), e.exit("taskListCheckValueUnchecked"), o) : c === 88 || c === 120 ? (e.enter("taskListCheckValueChecked"), e.consume(c), e.exit("taskListCheckValueChecked"), o) : n(c);
  }
  function o(c) {
    return c === 93 ? (e.enter("taskListCheckMarker"), e.consume(c), e.exit("taskListCheckMarker"), e.exit("taskListCheck"), u) : n(c);
  }
  function u(c) {
    return Nt(c) ? t(c) : nn(c) ? e.check({
      tokenize: LY
    }, t, n)(c) : n(c);
  }
}
function LY(e, t, n) {
  return hn(e, r, "whitespace");
  function r(i) {
    return i === null ? n(i) : t(i);
  }
}
function BY(e) {
  return eO([
    cY(),
    bY(),
    NY(e),
    RY(),
    PY()
  ]);
}
const qY = {};
function FY(e) {
  const t = (
    /** @type {Processor<Root>} */
    this
  ), n = e || qY, r = t.data(), i = r.micromarkExtensions || (r.micromarkExtensions = []), s = r.fromMarkdownExtensions || (r.fromMarkdownExtensions = []), o = r.toMarkdownExtensions || (r.toMarkdownExtensions = []);
  i.push(BY(n)), s.push(sY()), o.push(oY(n));
}
const UY = "Engram_project";
function $Y() {
  var e, t;
  try {
    if (typeof window.getRequestHeaders == "function")
      return window.getRequestHeaders();
    const n = (t = (e = window.SillyTavern) == null ? void 0 : e.getContext) == null ? void 0 : t.call(e);
    if (n != null && n.getRequestHeaders)
      return n.getRequestHeaders();
  } catch (n) {
    console.warn("[Engram] ", n);
  }
  return {
    "Content-Type": "application/json"
  };
}
async function VY() {
  try {
    const e = $Y(), t = await fetch("/api/extensions/update", {
      method: "POST",
      headers: {
        ...e,
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        extensionName: UY,
        global: !1
        // Engram 
      })
    });
    if (!t.ok)
      return { success: !1, message: await t.text() || t.statusText };
    const n = await t.json();
    return n.isUpToDate ? { success: !0, message: "", isUpToDate: !0 } : {
      success: !0,
      message: `: ${n.shortCommitHash || "latest"}`,
      isUpToDate: !1
    };
  } catch (e) {
    return console.error("[Engram] :", e), { success: !1, message: String(e) };
  }
}
const HY = ({ isOpen: e, onClose: t }) => {
  const [n, r] = F.useState(!0), [i, s] = F.useState(null), [o, u] = F.useState(null), [c, d] = F.useState(!1), [m, p] = F.useState(!1), [x, b] = F.useState(!1), [S, k] = F.useState(null), A = Dc.getCurrentVersion();
  F.useEffect(() => {
    e && (T(), k(null));
  }, [e]);
  const T = async () => {
    r(!0);
    try {
      const [z, I, L] = await Promise.all([
        Dc.getLatestVersion(),
        Dc.getChangelog(),
        Dc.hasUpdate()
      ]);
      s(z), u(I), d(L);
    } catch (z) {
      console.error("[Engram] ", z);
    } finally {
      r(!1);
    }
  }, M = async () => {
    p(!0);
    try {
      const z = i || A;
      console.debug("[Engram] Marking update as read:", z), await Dc.markAsRead(z), t();
    } finally {
      p(!1);
    }
  }, j = async () => {
    b(!0), k(null);
    try {
      const z = await VY();
      z.success && !z.isUpToDate ? (k(" 2 ..."), i && await Dc.markAsRead(i), setTimeout(() => {
        window.location.reload();
      }, 2e3)) : z.isUpToDate ? (k(""), d(!1)) : k(`: ${z.message}`);
    } catch (z) {
      k(`: ${String(z)}`);
    } finally {
      b(!1);
    }
  }, D = () => {
    Dc.clearCache(), T();
  };
  return e ? /* @__PURE__ */ g.jsxs("div", { className: "fixed inset-0 z-[100] flex items-center justify-center p-4", children: [
    /* @__PURE__ */ g.jsx(
      "div",
      {
        className: "absolute inset-0 bg-black/60 backdrop-blur-sm",
        onClick: t
      }
    ),
    /* @__PURE__ */ g.jsxs("div", { className: "relative bg-card border border-border rounded-xl shadow-2xl w-full max-w-lg max-h-[80vh] flex flex-col overflow-hidden animate-in zoom-in-95 duration-200", children: [
      /* @__PURE__ */ g.jsxs("div", { className: "flex items-center justify-between px-5 py-4 border-b border-border/50", children: [
        /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-3", children: [
          /* @__PURE__ */ g.jsx("div", { className: "w-8 h-8 rounded-lg bg-primary/10 flex items-center justify-center", children: /* @__PURE__ */ g.jsx(Kg, { size: 16, className: "text-primary" }) }),
          /* @__PURE__ */ g.jsxs("div", { children: [
            /* @__PURE__ */ g.jsx("h2", { className: "text-base font-semibold text-foreground", children: "" }),
            /* @__PURE__ */ g.jsxs("p", { className: "text-xs text-muted-foreground", children: [
              ": v",
              A
            ] })
          ] })
        ] }),
        /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-2", children: [
          /* @__PURE__ */ g.jsx(
            "button",
            {
              onClick: D,
              className: "p-2 rounded-lg hover:bg-muted/50 text-muted-foreground hover:text-foreground transition-colors",
              title: "",
              children: /* @__PURE__ */ g.jsx(zr, { size: 16, className: n ? "animate-spin" : "" })
            }
          ),
          /* @__PURE__ */ g.jsx(
            "button",
            {
              onClick: t,
              className: "p-2 rounded-lg hover:bg-muted/50 text-muted-foreground hover:text-foreground transition-colors",
              children: /* @__PURE__ */ g.jsx(Lm, { size: 16 })
            }
          )
        ] })
      ] }),
      /* @__PURE__ */ g.jsx("div", { className: "flex-1 overflow-y-auto p-5", children: n ? /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col items-center justify-center py-12 text-muted-foreground", children: [
        /* @__PURE__ */ g.jsx(zr, { size: 24, className: "animate-spin mb-3" }),
        /* @__PURE__ */ g.jsx("p", { className: "text-sm", children: "..." })
      ] }) : /* @__PURE__ */ g.jsxs("div", { className: "space-y-4", children: [
        /* @__PURE__ */ g.jsx("div", { className: `
                                p-4 rounded-lg border
                                ${c ? "bg-primary/5 border-primary/20" : "bg-green-500/5 border-green-500/20"}
                            `, children: /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-3", children: [
          c ? /* @__PURE__ */ g.jsx(Kg, { size: 20, className: "text-primary" }) : /* @__PURE__ */ g.jsx(xC, { size: 20, className: "text-green-500" }),
          /* @__PURE__ */ g.jsxs("div", { className: "flex-1", children: [
            /* @__PURE__ */ g.jsx("p", { className: "font-medium text-foreground", children: c ? `: v${i}` : "" }),
            /* @__PURE__ */ g.jsx("p", { className: "text-xs text-muted-foreground mt-0.5", children: c ? "" : "" })
          ] })
        ] }) }),
        S && /* @__PURE__ */ g.jsx("div", { className: `
                                    p-3 rounded-lg text-sm
                                    ${S.includes("") ? "bg-green-500/10 text-green-600 border border-green-500/20" : S.includes("") || S.includes("") ? "bg-red-500/10 text-red-600 border border-red-500/20" : "bg-muted/30 text-muted-foreground"}
                                `, children: S }),
        o && /* @__PURE__ */ g.jsxs("div", { className: "space-y-2", children: [
          /* @__PURE__ */ g.jsx("h3", { className: "text-xs font-medium text-muted-foreground uppercase tracking-wider", children: "" }),
          /* @__PURE__ */ g.jsx("div", { className: "bg-muted/20 rounded-lg p-4 max-h-64 overflow-y-auto engram-changelog-content text-sm", children: /* @__PURE__ */ g.jsx(NG, { remarkPlugins: [FY], children: o }) })
        ] }),
        !o && !n && /* @__PURE__ */ g.jsx("div", { className: "text-center py-8 text-muted-foreground", children: /* @__PURE__ */ g.jsx("p", { className: "text-sm", children: "" }) })
      ] }) }),
      /* @__PURE__ */ g.jsxs("div", { className: "px-5 py-4 border-t border-border/50 flex justify-end gap-3", children: [
        /* @__PURE__ */ g.jsx(
          "button",
          {
            onClick: t,
            className: "px-4 py-2 text-sm text-muted-foreground hover:text-foreground transition-colors",
            children: ""
          }
        ),
        c && /* @__PURE__ */ g.jsxs(g.Fragment, { children: [
          /* @__PURE__ */ g.jsx(
            "button",
            {
              onClick: M,
              disabled: m || x,
              className: "px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg transition-colors disabled:opacity-50",
              children: ""
            }
          ),
          /* @__PURE__ */ g.jsx(
            "button",
            {
              onClick: j,
              disabled: x || m,
              className: "px-4 py-2 text-sm bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50 flex items-center gap-2",
              children: x ? /* @__PURE__ */ g.jsxs(g.Fragment, { children: [
                /* @__PURE__ */ g.jsx(Eu, { size: 14, className: "animate-spin" }),
                "..."
              ] }) : /* @__PURE__ */ g.jsxs(g.Fragment, { children: [
                /* @__PURE__ */ g.jsx(Kg, { size: 14 }),
                ""
              ] })
            }
          )
        ] })
      ] })
    ] })
  ] }) : null;
}, GY = ({ children: e, activeTab: t, setActiveTab: n, onClose: r }) => {
  const [i, s] = F.useState(!1), [o, u] = F.useState(!1), [c, d] = F.useState(!1);
  F.useEffect(() => {
    (async () => {
      try {
        const b = await Dc.hasUnreadUpdate();
        d(b);
      } catch (b) {
        console.debug("[Engram] ", b);
      }
    })();
  }, []);
  const m = () => {
    u(!0);
  }, p = () => {
    u(!1), d(!1);
  };
  return /* @__PURE__ */ g.jsxs("div", { className: "flex absolute inset-0 w-full h-full bg-background text-foreground overflow-hidden font-sans selection:bg-primary/30 selection:text-primary animate-in fade-in duration-300", id: "engram-layout-root", children: [
    /* @__PURE__ */ g.jsx(ZL, {}),
    /* @__PURE__ */ g.jsx(
      HY,
      {
        isOpen: o,
        onClose: p
      }
    ),
    /* @__PURE__ */ g.jsx(
      Xk,
      {
        activeTab: t,
        onNavigate: n,
        isMobile: !1,
        onShowUpdateNotice: m,
        hasUnreadUpdate: c
      }
    ),
    /* @__PURE__ */ g.jsx(
      Xk,
      {
        activeTab: t,
        onNavigate: n,
        isMobile: !0,
        isOpen: i,
        onClose: () => s(!1),
        onShowUpdateNotice: m,
        hasUnreadUpdate: c
      }
    ),
    /* @__PURE__ */ g.jsxs("div", { className: "flex flex-1 flex-col overflow-hidden", children: [
      /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col flex-shrink-0 border-b border-border bg-sidebar/95 backdrop-blur z-50 transition-all duration-300", children: [
        /* @__PURE__ */ g.jsx(
          pU,
          {
            onToggleSidebar: () => s(!i),
            isMobile: !1,
            onClose: r,
            onNavigate: (x) => n(x.replace("/", ""))
          }
        ),
        /* @__PURE__ */ g.jsx("div", { id: "engram-header-extension", className: "z-40 flex-shrink-0 bg-transparent transition-all empty:hidden" })
      ] }),
      /* @__PURE__ */ g.jsx("main", { className: "flex-1 flex flex-col relative w-full overflow-hidden bg-background", children: /* @__PURE__ */ g.jsx("div", { className: "flex-1 overflow-y-auto overflow-x-hidden pt-0 px-4 pb-4 md:px-8 md:pb-8 lg:px-12 lg:pb-12 scroll-smooth animate-blur-in fill-mode-both", style: { animationDelay: "200ms", animationFillMode: "both" }, children: /* @__PURE__ */ g.jsx("div", { className: "max-w-6xl mx-auto min-h-full pb-20", children: e }) }) })
    ] }),
    "  "
  ] });
}, wl = {
  primary: "#FFFFFF",
  grid: "#111111"
}, KY = ({ onComplete: e }) => {
  const t = F.useRef(null), n = F.useRef(null), r = F.useRef(null), i = F.useRef(null), [s, o] = F.useState(!1);
  F.useEffect(() => {
    if (window.gsap) {
      o(!0);
      return;
    }
    const c = document.createElement("script");
    c.src = "https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js", c.async = !0, c.onload = () => o(!0), document.body.appendChild(c);
  }, []);
  const u = () => {
    var b;
    if (!s || !n.current) return;
    const c = window.gsap, d = n.current, m = d.getTotalLength();
    c.set(d, {
      strokeDasharray: m,
      strokeDashoffset: m,
      stroke: wl.primary,
      fillOpacity: 0,
      opacity: 1,
      strokeWidth: 2
    });
    const p = (b = r.current) == null ? void 0 : b.querySelectorAll("path");
    p && c.set(p, { opacity: 0, y: 10 }), c.set(i.current, { scale: 1, opacity: 1 }), c.set(t.current, { opacity: 1 });
    const x = c.timeline({
      onComplete: () => {
        c.to(t.current, {
          opacity: 0,
          duration: 0.8,
          ease: "power2.out",
          onComplete: e
        });
      }
    });
    x.to(d, {
      strokeDashoffset: 0,
      duration: 2.5,
      ease: "power2.inOut"
    }), p && x.to(p, {
      opacity: 1,
      y: 0,
      duration: 1.2,
      stagger: 0.08,
      ease: "power3.out"
    }, "-=0.8"), x.to({}, { duration: 1 });
  };
  return F.useEffect(() => {
    if (s) {
      const c = setTimeout(u, 800);
      return () => clearTimeout(c);
    }
  }, [s]), /* @__PURE__ */ g.jsxs(
    "div",
    {
      ref: t,
      className: "fixed inset-0 z-[200] flex flex-col items-center justify-center bg-black overflow-hidden",
      style: { touchAction: "none" },
      children: [
        /* @__PURE__ */ g.jsx(
          "div",
          {
            className: "absolute inset-0 pointer-events-none",
            style: {
              backgroundImage: `
                        linear-gradient(to right, ${wl.grid} 1px, transparent 1px),
                        linear-gradient(to bottom, ${wl.grid} 1px, transparent 1px)
                    `,
              backgroundSize: "40px 40px",
              opacity: 0.3
            }
          }
        ),
        /* @__PURE__ */ g.jsx(
          "div",
          {
            className: "absolute inset-0 pointer-events-none",
            style: { background: "radial-gradient(circle at center, transparent 0%, black 100%)", opacity: 0.9 }
          }
        ),
        /* @__PURE__ */ g.jsxs("div", { className: "z-10 relative flex flex-col items-center justify-center w-full h-full p-4", children: [
          /* @__PURE__ */ g.jsx("div", { className: "w-full max-w-[600px] md:max-w-[800px] aspect-[4/3]", children: /* @__PURE__ */ g.jsx(
            "svg",
            {
              version: "1.1",
              xmlns: "http://www.w3.org/2000/svg",
              viewBox: "250 0 550 600",
              className: "w-full h-full overflow-visible",
              children: /* @__PURE__ */ g.jsxs("g", { ref: i, className: "origin-center", children: [
                /* @__PURE__ */ g.jsx(
                  "path",
                  {
                    ref: n,
                    fill: "none",
                    stroke: wl.primary,
                    strokeWidth: "2",
                    strokeLinecap: "round",
                    strokeLinejoin: "round",
                    d: "M463.360840,364.455627 C437.246704,381.338409 406.466644,366.209045 404.026672,335.650848 C402.910156,321.667206 412.549713,306.544678 426.813293,300.633850 C430.474335,299.116699 431.826355,297.290924 431.760071,293.302460 C431.519287,278.808716 431.584564,264.307892 431.718292,249.811417 C431.748169,246.574463 430.886292,244.713684 427.681274,243.389038 C412.366425,237.059357 404.237366,225.144638 404.208862,208.867447 C404.179871,192.298615 412.621979,180.486938 428.224701,174.293686 C430.850494,173.251419 431.710938,171.751862 431.696136,169.060089 C431.613586,154.062912 431.568054,139.064117 431.723419,124.068092 C431.759430,120.590492 430.119568,119.052467 427.243103,117.790627 C413.349915,111.695946 405.841095,101.009903 404.195740,85.916542 C402.099884,66.690948 418.566650,47.364159 437.884277,46.682220 C456.888519,46.011345 468.064789,52.989845 476.252197,70.840332 C477.174438,72.851059 478.313995,73.541710 480.422974,73.516098 C499.569031,73.283493 518.722961,73.393646 537.862915,73.456795 C545.529785,73.482086 549.225952,71.767975 552.791809,64.663139 C559.898376,50.503635 576.618042,43.921410 592.447876,47.234680 C608.699890,50.636322 619.276489,62.116261 621.438904,78.701805 C623.839478,97.113228 612.679382,114.371338 595.357910,119.034004 C577.219604,123.916542 558.125427,115.204048 550.887390,98.365906 C549.251465,94.560234 547.316284,93.116508 543.150696,93.160004 C522.989380,93.370483 502.824707,93.284561 482.661285,93.261726 C479.716156,93.258385 477.395905,93.379341 475.956635,96.902077 C474.571899,100.291283 475.702576,102.070137 477.892181,104.225159 C501.524139,127.483910 525.127991,150.771423 548.653259,174.137985 C550.803162,176.273376 552.520325,176.380997 555.207153,175.171799 C569.642334,168.675354 583.205750,171.177368 594.759277,181.252563 C606.783813,191.738449 610.379395,205.504944 605.248840,220.725037 C600.321167,235.343246 589.568848,243.345337 574.305420,245.467117 C567.655396,246.391541 561.334045,245.373352 555.347839,242.591797 C552.373169,241.209595 550.274536,241.303284 547.832886,243.728531 C524.197693,267.205322 500.499634,290.619415 476.704651,313.934174 C474.165771,316.421844 475.106598,318.487793 476.015411,321.059723 C476.869354,323.476318 478.159149,324.356232 480.796143,324.332367 C501.456360,324.145294 522.118530,324.019531 542.778870,324.122131 C546.987793,324.143005 549.216675,322.931549 551.044983,318.871887 C558.230042,302.918091 576.073181,294.652069 593.497131,298.684143 C610.451355,302.607544 622.335205,317.668091 622.119812,334.958160 C621.900024,352.608002 609.316650,367.564362 591.822144,370.969543 C574.585754,374.324463 557.004028,364.861755 550.521484,348.456757 C549.268677,345.286346 547.631836,344.200745 544.294861,344.220337 C523.465576,344.342865 502.634888,344.322540 481.805359,344.218109 C478.697174,344.202545 476.993927,345.152252 475.888916,348.205902 C473.513214,354.771179 469.417969,360.183167 463.360840,364.455627 M472.733368,188.880936 C473.545441,190.333145 474.799072,191.702774 475.088898,193.252655 C476.058929,198.439468 479.434326,198.919983 483.888489,198.861130 C499.042145,198.660889 514.201233,198.707901 529.355957,198.872879 C532.819580,198.910583 534.700989,197.913788 536.177185,194.588806 C537.657104,191.255417 536.060120,189.735016 534.097900,187.805573 C510.706268,164.804840 487.354065,141.764008 463.949341,118.776604 C462.445251,117.299316 461.277863,114.441566 458.282349,116.423027 C455.343719,118.366882 451.028107,118.406143 451.180542,123.994591 C451.584534,138.807007 451.429443,153.638779 451.250458,168.459885 C451.208984,171.894135 452.474548,173.487930 455.559784,174.673798 C462.566864,177.367126 468.343140,181.758774 472.733368,188.880936 M457.308807,300.958954 C460.540070,302.823181 462.218414,300.310028 464.063263,298.488586 C487.164032,275.681519 510.248199,252.857559 533.326538,230.027756 C535.300171,228.075378 537.458679,226.516449 535.970032,222.843750 C534.495117,219.205124 532.067688,218.878906 528.898010,218.890778 C513.414001,218.948746 497.929138,219.002151 482.445862,218.887329 C478.998230,218.861771 477.090668,219.941055 475.670502,223.284790 C471.742218,232.533905 465.159332,239.474701 455.665497,243.103836 C452.239746,244.413376 451.216278,246.302231 451.253540,249.781387 C451.406891,264.098541 451.489380,278.421356 451.223358,292.735107 C451.142975,297.059998 452.224640,299.783386 457.308807,300.958954 z"
                  }
                ),
                /* @__PURE__ */ g.jsxs("g", { ref: r, children: [
                  /* @__PURE__ */ g.jsx("path", { fill: wl.primary, d: "M732.215698,483.876190 C732.750061,488.775055 731.110779,490.523590 726.372742,490.479736 C713.642639,490.361908 713.645874,490.566711 713.641113,477.834442 C713.638428,470.668732 713.788818,463.497284 713.552246,456.338928 C713.318970,449.278015 710.633911,445.451111 705.788818,444.403778 C698.667542,442.864441 692.689270,447.076904 692.324463,454.647736 C691.851685,464.458313 691.862549,474.305084 692.048706,484.128967 C692.137085,488.792786 690.778625,490.578705 685.827454,490.500549 C672.843933,490.295532 672.845886,490.510315 672.820435,477.502625 C672.805786,470.003754 672.887146,462.502136 672.708618,455.006927 C672.557556,448.666412 669.519653,444.981689 664.341858,444.320343 C658.234436,443.540314 653.997803,446.541077 652.162415,452.864807 C651.503052,455.136719 651.331299,457.435608 651.335754,459.781158 C651.352234,468.446747 651.306274,477.112488 651.338745,485.777985 C651.348389,488.341766 651.062439,490.138977 647.717529,490.447815 C632.733521,491.831421 632.748596,491.913239 632.764404,477.031830 C632.778870,463.366852 632.738831,449.701782 632.731445,436.036774 C632.727478,428.732941 632.735718,428.732544 640.257812,428.707031 C641.591003,428.702484 642.924194,428.695312 644.257324,428.701721 C647.429321,428.717010 651.058289,427.916016 650.925598,433.229431 C655.308960,431.486603 658.595154,429.192383 662.595154,428.377930 C670.453491,426.777832 677.619019,428.117981 683.735718,433.181641 C686.512207,435.480164 688.239807,435.373474 690.953918,433.250153 C697.176208,428.382202 704.485840,426.832367 712.194946,428.080414 C725.100098,430.169739 731.944641,439.074829 732.175659,453.896454 C732.328857,463.726379 732.212036,473.560547 732.215698,483.876190 z" }),
                  /* @__PURE__ */ g.jsx("path", { fill: wl.primary, d: "M487.575867,485.935303 C487.614716,484.616028 487.614716,483.640503 487.614716,481.796417 C479.116760,488.238525 470.153107,489.257660 460.718079,486.787720 C454.401794,485.134186 449.163879,481.675842 445.200134,476.457642 C436.960876,465.610748 437.295532,448.722229 445.889771,438.315796 C455.451538,426.737823 470.295227,425.042450 488.444458,433.733826 C487.913239,428.612457 491.194366,428.604004 494.772766,428.684540 C508.272736,428.988373 506.179840,426.849945 506.294434,440.421967 C506.411133,454.245575 506.366882,468.071228 506.299957,481.895538 C506.205750,501.359833 494.742065,512.847900 475.259460,513.370544 C465.272614,513.638489 455.717651,512.255005 446.682343,507.725311 C443.034790,505.896667 441.336151,503.847290 444.229065,500.105438 C444.329590,499.975464 444.390869,499.814941 444.469086,499.667908 C448.861603,491.411743 448.894196,491.340729 457.207886,495.157196 C463.352356,497.977905 469.817169,498.376801 476.285126,497.456818 C482.543640,496.566620 486.238434,492.476532 487.575867,485.935303 M469.264740,471.577881 C471.084900,471.642700 472.915710,471.865356 474.723328,471.743805 C481.074341,471.316620 486.258820,466.628052 487.489288,460.346558 C488.669373,454.322296 485.713593,448.118378 480.288971,445.234039 C472.426056,441.053253 462.868591,443.867035 459.399658,451.384033 C455.705688,459.388580 459.382996,467.492737 469.264740,471.577881 z" }),
                  /* @__PURE__ */ g.jsx("path", { fill: wl.primary, d: "M350.790619,410.644409 C354.007477,410.561554 355.147522,411.945587 355.144592,414.620361 C355.128937,428.846375 356.152588,426.165161 344.558044,426.338898 C335.900940,426.468628 327.237854,426.493591 318.582581,426.315826 C314.804382,426.238220 313.157715,427.376373 313.262451,431.424896 C313.571655,443.375275 312.019470,441.570435 323.204529,441.691742 C330.530579,441.771271 337.860626,441.831665 345.183899,441.671692 C348.853607,441.591553 350.203705,443.056824 350.190338,446.675842 C350.143219,459.433014 350.725433,457.207275 340.024445,457.368561 C332.865692,457.476471 325.700195,457.536346 318.545349,457.339996 C314.731018,457.235291 313.250702,458.478516 313.234222,462.478668 C313.185364,474.308960 313.038177,474.321259 324.813477,474.130890 C334.298523,473.977539 343.772430,475.169159 353.264343,474.338776 C354.864075,474.198792 356.466827,474.576569 356.702301,476.439850 C357.203217,480.403656 357.364838,484.405273 356.646729,488.365631 C356.297211,490.293060 354.652405,490.369568 353.118927,490.370575 C334.801880,490.382568 316.484711,490.350647 298.167847,490.412506 C295.104187,490.422852 294.024323,488.921082 294.024200,486.130402 C294.023224,462.484924 294.047699,438.839325 293.967896,415.194092 C293.954620,411.261261 296.028046,410.593658 299.359711,410.610138 C316.344330,410.694275 333.329620,410.638672 350.790619,410.644409 z" }),
                  /* @__PURE__ */ g.jsx("path", { fill: wl.primary, d: "M620.003906,453.402435 C620.062195,464.023071 619.882812,474.188721 620.189575,484.339661 C620.338318,489.262421 618.431458,490.973572 613.757507,490.452362 C611.783386,490.232208 609.754700,490.291412 607.767883,490.444916 C604.889648,490.667267 602.478821,490.168823 601.296570,486.513000 C594.831909,490.991821 587.888184,491.843719 580.600464,491.328247 C565.916626,490.289642 557.201233,476.053131 563.502625,463.374390 C565.502930,459.349640 568.872803,457.136932 572.794861,455.506927 C578.118103,453.294647 583.702881,452.709900 589.425354,452.731232 C592.879822,452.744110 596.387085,453.235260 599.791443,452.317169 C599.855774,446.843750 597.260681,443.903503 591.552673,443.177338 C585.446533,442.400513 579.495911,443.228607 574.179382,446.386688 C570.948853,448.305603 569.535645,447.214966 568.011658,444.340485 C563.043945,434.970917 563.058899,434.663818 573.199219,430.800537 C582.143921,427.392792 591.347961,426.734100 600.678101,428.904358 C613.358643,431.853943 619.173157,440.405762 620.003906,453.402435 M582.869263,466.083313 C579.496887,469.605530 579.013306,473.431427 581.947998,475.906952 C585.513611,478.914764 589.714966,478.291107 593.721985,477.031647 C597.412354,475.871704 599.990784,473.365112 600.658081,469.369629 C601.070496,466.900665 600.409729,465.044220 597.411255,465.098297 C592.800171,465.181488 588.157471,464.530182 582.869263,466.083313 z" }),
                  /* @__PURE__ */ g.jsx("path", { fill: wl.primary, d: "M410.915314,457.280090 C410.311127,447.930115 406.925934,444.198608 399.452026,444.194855 C391.667114,444.190948 386.727997,448.953094 386.409271,457.536652 C386.075653,466.521088 386.068634,475.532593 386.350006,484.518738 C386.494904,489.147247 384.896912,490.532959 380.337830,490.481964 C367.440552,490.337616 367.627808,490.513641 367.533173,477.713593 C367.426025,463.226135 368.160004,448.728760 367.168365,434.251617 C366.898468,430.311462 368.239288,428.249725 372.529694,428.668640 C374.840057,428.894196 377.203857,428.868896 379.519684,428.673553 C383.194244,428.363556 385.817352,429.188293 385.487488,434.182526 C390.858826,430.844635 395.856995,428.304504 401.601257,427.794434 C418.292908,426.312286 429.386810,436.518799 429.975342,454.379517 C430.315308,464.696716 429.971527,475.035126 430.046204,485.363190 C430.071198,488.817627 428.985992,490.534210 425.145325,490.442291 C408.307220,490.039520 411.204895,492.848450 410.942963,476.734924 C410.840088,470.406036 410.927368,464.074036 410.915314,457.280090 z" }),
                  /* @__PURE__ */ g.jsx("path", { fill: wl.primary, d: "M556.799500,444.921539 C554.214233,445.227783 552.026184,445.174683 549.913574,445.548401 C542.544189,446.852142 538.560974,452.210632 538.387756,461.266998 C538.231995,469.411011 538.239258,477.561676 538.377136,485.705963 C538.433838,489.055634 537.355591,490.537964 533.812988,490.447296 C516.656677,490.008148 519.942505,492.939087 519.712585,476.823181 C519.510925,462.693848 519.801025,448.557343 519.590698,434.428253 C519.527222,430.165985 520.732788,428.169983 525.216187,428.665833 C527.350830,428.901917 529.549255,428.854156 531.692566,428.654297 C535.487610,428.300446 537.940002,429.350586 537.432373,434.447845 C542.475464,431.817810 546.689819,428.862549 551.859985,428.147003 C557.409912,427.378845 558.504028,428.019318 558.285950,433.612213 C558.141113,437.327057 559.514648,441.236115 556.799500,444.921539 z" })
                ] })
              ] })
            }
          ) }),
          /* @__PURE__ */ g.jsx("p", { className: "mt-6 md:mt-8 text-white/30 text-xs md:text-sm tracking-widest uppercase", children: "Where memories leave their trace" })
        ] })
      ]
    }
  );
}, Zr = ({
  checked: e,
  onChange: t,
  disabled: n = !1,
  className: r = "",
  id: i
}) => {
  const s = (o) => {
    n || (o.stopPropagation(), t(!e));
  };
  return /* @__PURE__ */ g.jsx(
    "button",
    {
      type: "button",
      role: "switch",
      id: i,
      "aria-checked": e,
      onClick: s,
      disabled: n,
      className: `
                relative inline-flex h-3.5 w-9 shrink-0 cursor-pointer items-center rounded-full border transition-all duration-300 focus:outline-none
                ${e ? "bg-primary/20 border-primary/50 shadow-[0_0_10px_rgba(var(--primary),0.2)]" : "bg-black/20 border-border shadow-inner"}
                ${n ? "opacity-50 cursor-not-allowed" : ""}
                ${r}
            `,
      children: /* @__PURE__ */ g.jsx(
        "span",
        {
          className: `
                    pointer-events-none inline-block h-2.5 w-2.5 transform rounded-full shadow-sm ring-0 transition-all duration-300 cubic-bezier(0.34, 1.56, 0.64, 1)
                    ${e ? "bg-primary shadow-[0_0_8px_rgba(var(--primary),0.8)] border border-primary-foreground/20" : "bg-muted-foreground border border-transparent opacity-60"}
                `,
          style: { transform: e ? "translateX(24px)" : "translateX(2px)" }
        }
      )
    }
  );
}, YY = {
  none: "",
  sm: "my-2",
  md: "my-4",
  lg: "my-6"
}, Jr = ({
  orientation: e = "horizontal",
  length: t = 100,
  className: n = "",
  responsive: r = !1,
  spacing: i = "none"
}) => {
  const s = YY[i];
  return r ? /* @__PURE__ */ g.jsxs(g.Fragment, { children: [
    /* @__PURE__ */ g.jsx(
      "div",
      {
        className: `hidden lg:block absolute left-0 top-1/2 -translate-y-1/2 border-l border-border ${n}`,
        style: { height: `${t}%` }
      }
    ),
    /* @__PURE__ */ g.jsx(
      "div",
      {
        className: `lg:hidden border-t border-border/30 mx-auto ${s} ${n}`,
        style: { width: `${t}%` }
      }
    )
  ] }) : e === "vertical" ? /* @__PURE__ */ g.jsx(
    "div",
    {
      className: `border-l border-border/30 mx-auto ${n}`,
      style: { height: `${t}%` }
    }
  ) : /* @__PURE__ */ g.jsx(
    "div",
    {
      className: `border-t border-border/30 ${s} ${n}`,
      style: { width: `${t}%` }
    }
  );
};
var fd = /* @__PURE__ */ ((e) => (e.Character = "char", e.Location = "loc", e.Item = "item", e.Concept = "concept", e.Unknown = "unknown", e))(fd || {});
const Og = {
  last_summarized_floor: 0,
  token_usage_accumulated: 0,
  last_compressed_at: 0,
  active_summary_order: 9e3,
  last_extracted_floor: 0
}, l2 = "scope_state", q6 = "character_name";
class VO {
  constructor() {
    vt(this, "currentChatId", null);
    vt(this, "currentDb", null);
  }
  /**
   * 
   *  ST  chatId
   */
  getCurrentDb() {
    const t = xi();
    return t ? (t !== this.currentChatId && (this.currentChatId = t, this.currentDb = Al(t), console.debug(`[ChatManager] Switched to database: Engram_${t}`)), this.currentDb) : (console.warn("[ChatManager] No chat_id available"), null);
  }
  /**
   *  chatId
   */
  getCurrentChatId() {
    return xi();
  }
  /**
   * 
   */
  getCharacterName() {
    var t;
    return ((t = jd()) == null ? void 0 : t.name) || "Unknown";
  }
  /**
   * 
   */
  async getState() {
    const t = this.getCurrentDb();
    if (!t) return Og;
    try {
      const n = await t.meta.get(l2);
      return n != null && n.value ? { ...Og, ...n.value } : Og;
    } catch (n) {
      return console.error("[ChatManager] Failed to get state:", n), Og;
    }
  }
  /**
   * 
   */
  async updateState(t) {
    const n = this.getCurrentDb();
    if (n)
      try {
        const i = { ...await this.getState(), ...t };
        await n.meta.put({ key: l2, value: i });
      } catch (r) {
        console.error("[ChatManager] Failed to update state:", r);
      }
  }
  /**
   *  UI 
   */
  async saveCharacterName() {
    const t = this.getCurrentDb();
    if (!t) return;
    const n = this.getCharacterName();
    await t.meta.put({ key: q6, value: n });
  }
  /**
   * 
   */
  async getSavedCharacterName() {
    const t = this.getCurrentDb();
    if (!t) return "Unknown";
    const n = await t.meta.get(q6);
    return (n == null ? void 0 : n.value) || "Unknown";
  }
  /**
   * Debug/Dev only
   */
  async resetState() {
    const t = this.getCurrentDb();
    t && await t.meta.put({ key: l2, value: Og });
  }
}
const Sd = new VO(), WY = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  ChatManager: VO,
  chatManager: Sd
}, Symbol.toStringTag, { value: "Module" })), Eo = {
  // 
  MESSAGE_SENT: "message_sent",
  MESSAGE_RECEIVED: "message_received",
  MESSAGE_EDITED: "message_edited",
  MESSAGE_DELETED: "message_deleted",
  MESSAGE_UPDATED: "message_updated",
  MESSAGE_SWIPED: "message_swiped",
  USER_MESSAGE_RENDERED: "user_message_rendered",
  CHARACTER_MESSAGE_RENDERED: "character_message_rendered",
  // 
  CHAT_CHANGED: "chat_id_changed",
  CHAT_CREATED: "chat_created",
  CHAT_DELETED: "chat_deleted",
  // 
  GENERATION_STARTED: "generation_started",
  GENERATION_STOPPED: "generation_stopped",
  GENERATION_ENDED: "generation_ended",
  GENERATION_AFTER_COMMANDS: "GENERATION_AFTER_COMMANDS",
  STREAM_TOKEN_RECEIVED: "stream_token_received",
  // V0.7: RAG  -  prompt await  handler 
  GENERATE_BEFORE_COMBINE_PROMPTS: "generate_before_combine_prompts",
  GENERATE_AFTER_COMBINE_PROMPTS: "generate_after_combine_prompts",
  GENERATE_AFTER_DATA: "generate_after_data",
  // V0.8: Chat Completion  ()
  CHAT_COMPLETION_PROMPT_READY: "chat_completion_prompt_ready",
  CHAT_COMPLETION_SETTINGS_READY: "chat_completion_settings_ready",
  // 
  WORLDINFO_UPDATED: "worldinfo_updated",
  WORLDINFO_SETTINGS_UPDATED: "worldinfo_settings_updated",
  WORLDINFO_ENTRIES_LOADED: "worldinfo_entries_loaded",
  WORLD_INFO_ACTIVATED: "world_info_activated",
  // 
  APP_READY: "app_ready",
  SETTINGS_LOADED: "settings_loaded",
  SETTINGS_LOADED_AFTER: "settings_loaded_after",
  EXTENSION_SETTINGS_LOADED: "extension_settings_loaded",
  // 
  CHARACTER_EDITED: "character_edited",
  CHARACTER_DELETED: "characterDeleted",
  // 
  ENGRAM_REQUEST_REVISION: "engram:request_revision"
};
function sm() {
  try {
    const e = window.SillyTavern;
    if (e != null && e.getContext) {
      const t = e.getContext();
      return (t == null ? void 0 : t.eventSource) || null;
    }
    return null;
  } catch {
    return console.warn("[Engram] EventBus:  SillyTavern eventSource"), null;
  }
}
class Is {
  /**
   * 
   * @param event 
   * @param callback 
   * @returns 
   */
  static on(t, n) {
    const r = sm();
    return r && r.on(t, n), this.listeners.has(t) || this.listeners.set(t, /* @__PURE__ */ new Set()), this.listeners.get(t).add(n), () => {
      this.off(t, n);
    };
  }
  /**
   * 
   * @param event 
   * @param callback 
   */
  static once(t, n) {
    const r = sm();
    if (r)
      r.once(t, n);
    else {
      const i = (...s) => {
        this.off(t, i), n(...s);
      };
      this.on(t, i);
    }
  }
  /**
   * 
   * @param event 
   * @param callback 
   */
  static off(t, n) {
    var i;
    const r = sm();
    r && r.removeListener(t, n), (i = this.listeners.get(t)) == null || i.delete(n);
  }
  /**
   * 
   * @param event 
   * @param args 
   */
  static async emit(t, ...n) {
    const r = sm();
    if (r)
      return r.emit(t, ...n);
  }
  /**
   * 
   * 
   */
  static clearAll() {
    const t = sm();
    for (const [n, r] of this.listeners)
      for (const i of r)
        t && t.removeListener(n, i);
    this.listeners.clear();
  }
  /**
   *  EventBus 
   */
  static isAvailable() {
    return sm() !== null;
  }
}
vt(Is, "listeners", /* @__PURE__ */ new Map());
const XY = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  EventBus: Is,
  TavernEventType: Eo
}, Symbol.toStringTag, { value: "Module" }));
function QY(e, t) {
  let n = "assistant";
  return e.is_user ? n = "user" : e.is_system && (n = "system"), {
    id: t,
    role: n,
    content: e.mes || "",
    name: e.name || "",
    isHidden: e.is_hidden ?? !1,
    raw: e
  };
}
class HO {
  /**
   * 
   * @param options 
   */
  static getAllMessages(t = {}) {
    const n = Mo();
    if (!(n != null && n.chat))
      return [];
    let r = n.chat.map((i, s) => QY(i, s));
    if (t.includeHidden || (r = r.filter((i) => !i.isHidden)), t.role) {
      const i = Array.isArray(t.role) ? t.role : [t.role];
      r = r.filter((s) => i.includes(s.role));
    }
    return r;
  }
  /**
   *  N 
   * @param count 
   * @param options 
   */
  static getRecentMessages(t, n = {}) {
    return this.getAllMessages(n).slice(-t);
  }
  /**
   * 
   * @param start 
   * @param end 
   * @param options 
   */
  static getMessages(t, n, r = {}) {
    return this.getAllMessages(r).slice(t, n);
  }
  /**
   * 
   * @param options 
   */
  static getFloorCount(t = {}) {
    return this.getAllMessages(t).length;
  }
  /**
   * 
   * @param options 
   */
  static getLastMessage(t = {}) {
    const n = this.getAllMessages(t);
    return n.length > 0 ? n[n.length - 1] : null;
  }
  /**
   * 
   */
  static getCurrentCharacterName() {
    var n;
    const t = Mo();
    return !(t != null && t.characters) || t.characterId < 0 ? null : ((n = t.characters[t.characterId]) == null ? void 0 : n.name) || null;
  }
  /**
   *  LLM
   * @param messages 
   * @param format 
   */
  static formatMessagesAsText(t, n = "simple") {
    return n === "simple" ? t.map((r) => `${r.name}: ${r.content}`).join(`

`) : t.map((r) => `[${r.role.toUpperCase()}] ${r.name}:
${r.content}`).join(`

---

`);
  }
  /**
   *  MessageService 
   */
  static isAvailable() {
    return DR();
  }
}
const ZY = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  MessageService: HO
}, Symbol.toStringTag, { value: "Module" }));
async function F6(e) {
  try {
    const t = window.SillyTavern;
    if (t != null && t.getContext) {
      const n = t.getContext();
      if (n != null && n.getTokenCountAsync)
        return await n.getTokenCountAsync(e);
    }
    return Math.ceil(e.length / 4);
  } catch {
    return console.warn("[Engram] WorldInfoService:  Token "), Math.ceil(e.length / 4);
  }
}
function Ba() {
  try {
    return window.TavernHelper || null;
  } catch {
    return null;
  }
}
const Zg = "engram";
class pn {
  /**
   *  Token 
   * @param text 
   */
  static async countTokens(t) {
    return F6(t);
  }
  /**
   *  Engram  Token 
   * 
   * @param worldbookName 
   */
  static async countSummaryTokens(t) {
    const r = (await this.getEntries(t)).filter(
      (o) => o.enabled && o.keys.includes(Zg)
    );
    if (r.length === 0) return 0;
    const i = r.map((o) => o.content);
    return (await Promise.all(i.map((o) => this.countTokens(o)))).reduce((o, u) => o + u, 0);
  }
  /**
   *  Engram  {{engramSummaries}} 
   * 
   */
  static async getEngramSummariesContent() {
    const t = this.findExistingWorldbook();
    if (!t)
      return "";
    const r = (await this.getEntries(t)).filter((s) => s.keys.includes(Zg));
    return r.length === 0 ? "" : (r.sort((s, o) => s.order - o.order), r.map((s) => {
      const o = s.content.replace(/\{\{\/\/.*?\}\}/gs, "").trim();
      return `${s.name}
${o}`;
    }).join(`

---

`));
  }
  /**
   *  Token 
   * @param texts 
   */
  static async countTokensBatch(t) {
    return Promise.all(t.map((n) => F6(n)));
  }
  /**
   *  Engram 
   * 
   */
  static findExistingWorldbook() {
    try {
      const t = Ba();
      if (!(t != null && t.getCharWorldbookNames))
        return null;
      const n = t.getCharWorldbookNames("current");
      return n && [...n.additional || [], n.primary].filter(Boolean).find((s) => s == null ? void 0 : s.startsWith("[Engram]")) || null;
    } catch {
      return null;
    }
  }
  /**
   *  Engram 
   * 
   * ****
   * 
   *  the_world 
   * 1. TavernHelper.createWorldbook() 
   * 2. TavernHelper.getCharWorldbookNames() 
   * 3. TavernHelper.rebindCharWorldbooks() 
   */
  static async getOrCreateWorldbook() {
    var t, n;
    try {
      const r = this.findExistingWorldbook();
      if (r)
        return console.debug("[Engram] WorldInfoService: ", r), r;
      const i = Ba();
      if (!i)
        return console.warn("[Engram] WorldInfoService: TavernHelper "), null;
      const s = (n = (t = window.SillyTavern) == null ? void 0 : t.getContext) == null ? void 0 : n.call(t);
      if (!(s != null && s.name2) || s.name2 === "SillyTavern System")
        return console.warn("[Engram] WorldInfoService: "), null;
      const o = s.name2, u = `[Engram] ${o}`;
      if (console.debug("[Engram] WorldInfoService: ", u), i.createWorldbook)
        await i.createWorldbook(u);
      else
        return console.error("[Engram] WorldInfoService: TavernHelper.createWorldbook "), null;
      if (i.getCharWorldbookNames && i.rebindCharWorldbooks) {
        const c = i.getCharWorldbookNames("current");
        c && (c.additional.push(u), await i.rebindCharWorldbooks("current", c), console.info("[Engram] WorldInfoService: ", {
          character: o,
          worldbook: u
        }));
      }
      return u;
    } catch (r) {
      return console.error("[Engram] WorldInfoService: /", r), null;
    }
  }
  /**
   * @deprecated  getOrCreateWorldbook() 
   */
  static async getChatWorldbook() {
    return this.getOrCreateWorldbook();
  }
  /**
   * 
   * @param worldbookName 
   */
  static async getEntries(t) {
    const n = Ba();
    if (!(n != null && n.getWorldbook))
      return console.warn("[Engram] WorldInfoService: TavernHelper "), [];
    try {
      return (await n.getWorldbook(t)).map((i) => {
        const s = i, o = s.strategy, u = s.position, c = s.recursion, d = [];
        if (o != null && o.keys && Array.isArray(o.keys))
          for (const m of o.keys)
            typeof m == "string" ? d.push(m) : m && typeof m == "object" && "source" in m && d.push(m.source);
        return {
          uid: s.uid || 0,
          name: s.name || "",
          content: s.content || "",
          enabled: s.enabled ?? !0,
          constant: (o == null ? void 0 : o.type) === "constant",
          keys: d,
          position: (u == null ? void 0 : u.type) || "before_character_definition",
          depth: (u == null ? void 0 : u.depth) || 0,
          order: (u == null ? void 0 : u.order) || 100,
          recursion: c ? {
            prevent_incoming: c.prevent_incoming,
            prevent_outgoing: c.prevent_outgoing
          } : void 0,
          comment: s.comment || "",
          extra: s.extra || void 0
        };
      });
    } catch (r) {
      return console.error("[Engram] WorldInfoService: ", r), [];
    }
  }
  /**
   * 
   */
  static async getWorldbookNames() {
    const t = Ba();
    try {
      return t != null && t.getWorldbookNames ? t.getWorldbookNames() : [];
    } catch (n) {
      return console.error("[Engram] WorldInfoService: ", n), [];
    }
  }
  /**
   * 
   * @param worldbookName 
   */
  static async deleteWorldbook(t) {
    const n = Ba();
    if (!(n != null && n.deleteWorldbook))
      return console.warn("[Engram] WorldInfoService: TavernHelper.deleteWorldbook "), !1;
    try {
      const r = await n.deleteWorldbook(t);
      return r && console.info("[Engram] WorldInfoService: ", t), r;
    } catch (r) {
      return console.error("[Engram] WorldInfoService: ", r), !1;
    }
  }
  /**
   * 
   *  TavernHelper API the_world 
   * @param worldbookName 
   * @param params 
   */
  static async createEntry(t, n) {
    try {
      const r = Ba();
      if (!(r != null && r.createWorldbookEntries))
        return console.error("[Engram] WorldInfoService: TavernHelper.createWorldbookEntries "), !1;
      const i = {
        name: n.name,
        content: n.content,
        comment: n.name,
        // 
        disable: !(n.enabled ?? !0),
        // TavernHelper  disable 
        strategy: {
          type: n.constant ? "constant" : "selective",
          keys: n.keys || []
        },
        position: {
          type: n.position || "before_character_definition",
          order: n.order ?? 100,
          depth: n.depth ?? 4
        },
        recursion: n.recursion,
        //  Engram 
        extra: {
          engram: !0
        }
      };
      return console.debug("[Engram] WorldInfoService: ", {
        worldbook: t,
        name: n.name,
        contentLength: n.content.length
      }), await r.createWorldbookEntries(t, [i]), console.info("[Engram] WorldInfoService: ", t), !0;
    } catch (r) {
      return console.error("[Engram] WorldInfoService: ", r), !1;
    }
  }
  /**
   * 
   * @param worldbookName 
   * @param uid  UID
   * @param updates 
   */
  /**
   * 
   *  updateWorldbookWith 
   * @param worldbookName 
   * @param uid  UID
   * @param updates 
   */
  static async updateEntry(t, n, r) {
    const i = Ba();
    if (!(i != null && i.updateWorldbookWith))
      return console.warn("[Engram] WorldInfoService: TavernHelper.updateWorldbookWith "), !1;
    try {
      return await i.updateWorldbookWith(t, (s) => {
        var u;
        const o = s.findIndex((c) => c.uid === n);
        if (o !== -1) {
          const c = s[o];
          let d = c.disable;
          "enabled" in r && (d = !r.enabled);
          let m = c.strategy || { type: "selective", keys: [] };
          if ("constant" in r || "keys" in r) {
            const b = r.constant !== void 0 ? r.constant : m.type === "constant", S = r.keys !== void 0 ? r.keys : m.keys || [];
            m = {
              ...m,
              type: b ? "constant" : "selective",
              keys: S
            };
          }
          let p = c.position || { type: "before_character_definition", order: 0, depth: 0 };
          (r.position || typeof r.order == "number" || typeof r.depth == "number") && (p = {
            ...p,
            type: (typeof r.position == "string" ? r.position : (u = r.position) == null ? void 0 : u.type) || p.type,
            order: r.order ?? p.order,
            depth: r.depth ?? p.depth
          });
          let x = c.recursion;
          r.recursion && (x = r.recursion), s[o] = {
            ...c,
            name: r.name ?? c.name,
            content: r.content ?? c.content,
            comment: r.name ?? c.comment,
            // 
            disable: d,
            strategy: m,
            position: p,
            recursion: x
          }, console.debug("[Engram] WorldInfoService:  (In-Place)", { uid: n, name: s[o].name });
        } else
          console.warn("[Engram] WorldInfoService: updateEntry ", n);
        return s;
      }), !0;
    } catch (s) {
      return console.error("[Engram] WorldInfoService: ", s), !1;
    }
  }
  /**
   * 
   * @param worldbookName 
   * @param uid  UID
   */
  static async deleteEntry(t, n) {
    const r = Ba();
    if (!(r != null && r.deleteWorldbookEntries))
      return console.warn("[Engram] WorldInfoService: TavernHelper.deleteWorldbookEntries "), !1;
    try {
      return await r.deleteWorldbookEntries(t, (i) => i.uid === n), console.debug("[Engram] WorldInfoService: ", { worldbook: t, uid: n }), !0;
    } catch (i) {
      return console.error("[Engram] WorldInfoService: ", i), !1;
    }
  }
  /**
   * 
   * @param worldbookName 
   * @param uids  UID 
   */
  static async deleteEntries(t, n) {
    const r = Ba();
    if (!(r != null && r.deleteWorldbookEntries))
      return console.warn("[Engram] WorldInfoService: TavernHelper.deleteWorldbookEntries "), !1;
    try {
      const i = new Set(n);
      return await r.deleteWorldbookEntries(t, (s) => i.has(s.uid)), console.debug("[Engram] WorldInfoService: ", { worldbook: t, count: n.length }), !0;
    } catch (i) {
      return console.error("[Engram] WorldInfoService: ", i), !1;
    }
  }
  /**
   *  Engram  order 
   * 
   * @param worldbookName 
   */
  static async getSummaryEntries(t) {
    const r = (await this.getEntries(t)).filter((i) => i.keys.includes(Zg));
    return r.sort((i, s) => i.order - s.order), r;
  }
  /**
   * 
   * @param entryName  "_1-10"
   * @returns [startFloor, endFloor]  null
   */
  static parseFloorRangeFromName(t) {
    const n = t.match(/_(\d+)-(\d+)/);
    return n ? [parseInt(n[1], 10), parseInt(n[2], 10)] : null;
  }
  /**
   * 
   * 8999:  <summary>
   * 10000:  </summary>
   */
  static async ensureSeparatorEntries(t) {
    await this.findEntryByKey(t, "") || await this.createEntry(t, {
      name: "",
      content: "<summary>",
      keys: [""],
      constant: !0,
      order: 8999,
      enabled: !0,
      position: "before_character_definition"
    }), await this.findEntryByKey(t, "") || await this.createEntry(t, {
      name: "",
      content: "</summary>",
      keys: [""],
      constant: !0,
      order: 1e4,
      enabled: !0,
      position: "before_character_definition"
    });
  }
  /**
   * 
   *  9000
   */
  static async getNextSummaryOrder(t) {
    const r = (await this.getEntries(t)).map((s) => s.order).filter((s) => s >= 9e3 && s < 1e4);
    return r.length === 0 ? 9e3 : Math.max(...r) + 1;
  }
  /**
   *  Key 
   * @param worldbookName 
   * @param key 
   */
  static async findEntryByKey(t, n) {
    const r = await this.getEntries(t);
    let i = r.find((s) => s.keys.includes(n));
    return i || (i = r.find((s) => s.name === n || n === "__ENGRAM_STATE__" && s.name === "Engram System State")), i || null;
  }
  /**
   *  Token 
   * @param worldbookName 
   */
  static async getWorldbookTokenStats(t) {
    const n = await this.getEntries(t), r = await Promise.all(
      n.map(async (s) => ({
        name: s.name,
        tokens: await this.countTokens(s.content)
      }))
    );
    return {
      totalTokens: r.reduce((s, o) => s + o.tokens, 0),
      entryCount: n.length,
      entries: r
    };
  }
  /**
   *  WorldInfoService 
   */
  static isAvailable() {
    return Ba() !== null;
  }
  /**
   *  Token  API
   */
  static async isNativeTokenCountAvailable() {
    try {
      const t = window.SillyTavern;
      if (t != null && t.getContext) {
        const n = t.getContext();
        return typeof (n == null ? void 0 : n.getTokenCountAsync) == "function";
      }
      return !1;
    } catch {
      return !1;
    }
  }
  /**
   * 
   *  getWorldInfoPrompt 
   * + 
   * 
   * @param chatMessages 
   * @returns 
   */
  static async getActivatedWorldInfo(t) {
    var r, i, s;
    const { Logger: n } = await Promise.resolve().then(() => NC);
    try {
      const u = await new Function("path", "return import(path)")("/scripts/world-info.js"), c = u == null ? void 0 : u.getWorldInfoPrompt, d = u == null ? void 0 : u.getSortedEntries;
      if (typeof d == "function") {
        const L = await d(), K = [...new Set((L == null ? void 0 : L.map((Y) => Y.world)) || [])], ne = ((r = L == null ? void 0 : L.filter((Y) => Y.constant)) == null ? void 0 : r.length) || 0;
        n.info("WorldInfo", "getSortedEntries ", {
          totalEntries: (L == null ? void 0 : L.length) || 0,
          worlds: K,
          constantCount: ne,
          sampleEntry: L != null && L[0] ? {
            name: L[0].name,
            world: L[0].world,
            constant: L[0].constant
          } : null
        });
      }
      if (typeof c != "function")
        return n.warn("WorldInfo", "getWorldInfoPrompt "), this.getConstantWorldInfo();
      let m = t;
      if (!m || m.length === 0) {
        const L = (s = (i = window.SillyTavern) == null ? void 0 : i.getContext) == null ? void 0 : s.call(i);
        L != null && L.chat && Array.isArray(L.chat) && (m = L.chat.map((K) => K.mes || "").reverse());
      }
      if (!m || m.length === 0)
        return n.warn("WorldInfo", ""), this.getConstantWorldInfo();
      n.debug("WorldInfo", " getWorldInfoPrompt", {
        messageCount: m.length
      });
      const p = 1e6, x = u == null ? void 0 : u.checkWorldInfo;
      if (typeof x != "function")
        return n.error("WorldInfo", "checkWorldInfo "), this.getConstantWorldInfo();
      const b = await x(m, p, !0, {
        trigger: "normal"
      }), S = b == null ? void 0 : b.allActivatedEntries, k = S ? Array.from(S.values()) : [];
      n.info("WorldInfo", ` ${k.length} `);
      const A = await this.loadFilteringState(), { disabledGlobalBooks: T, disabledEntries: M, globalWorldbooks: j, config: D } = A, z = k.filter(
        (L) => this.shouldIncludeEntry(L, j, T, M, D)
      );
      return n.info("WorldInfo", "", {
        total: k.length,
        kept: z.length,
        filteredOut: k.length - z.length,
        keptWorlds: [...new Set(z.map((L) => L.world))]
      }), z.sort((L, K) => (L.order || 0) - (K.order || 0)), z.map((L) => L.content).filter(Boolean).join(`

`);
    } catch (o) {
      return n.error("WorldInfo", "", o), this.getConstantWorldInfo();
    }
  }
  /**
   * 
   * @private
   */
  static async loadFilteringState() {
    var m, p, x;
    const t = Ba(), n = ((m = t == null ? void 0 : t.getGlobalWorldbookNames) == null ? void 0 : m.call(t)) || [], { SettingsManager: r } = await Promise.resolve().then(() => RC), s = (p = r.getSettings().apiSettings) == null ? void 0 : p.worldbookConfig, o = (s == null ? void 0 : s.disabledWorldbooks) || [], { WorldBookStateService: u } = await Promise.resolve().then(() => DW), c = (x = t == null ? void 0 : t.getCharWorldbookNames) == null ? void 0 : x.call(t, "current");
    let d = {};
    return c != null && c.primary && (d = (await u.loadState(c.primary)).disabledEntries || {}), {
      globalWorldbooks: n,
      disabledGlobalBooks: o,
      disabledEntries: d,
      config: s
    };
  }
  /**
   * 
   * @private
   */
  static shouldIncludeEntry(t, n, r, i, s) {
    var o, u, c, d;
    if (((o = t.extra) == null ? void 0 : o.engram) === !0 || (u = t.world) != null && u.startsWith("[Engram]")) return !0;
    if (t.world && n.includes(t.world) && ((s == null ? void 0 : s.includeGlobal) === !1 || r.includes(t.world)))
      return !1;
    if (t.world && t.uid) {
      const m = i[t.world];
      if (m && m.includes(t.uid))
        return !1;
    }
    return !((c = t.world) != null && c.startsWith("") || (d = t.world) != null && d.startsWith("---"));
  }
  /**
   *  UI 
   * 
   */
  static async getWorldbookStructure() {
    var o;
    const t = Ba();
    if (!t) return {};
    const n = ((o = t.getGlobalWorldbookNames) == null ? void 0 : o.call(t)) || [];
    let r = [];
    if (t.getCharWorldbookNames) {
      const u = t.getCharWorldbookNames("current");
      u && (r = [...u.additional || [], u.primary].filter(Boolean));
    }
    const i = Array.from(/* @__PURE__ */ new Set([...n, ...r])).sort(), s = {};
    for (const u of i)
      try {
        const c = await this.getEntries(u);
        s[u] = c.map((d) => {
          var m;
          return {
            uid: d.uid,
            name: d.name,
            // 
            keys: d.keys,
            constant: d.constant,
            // 
            comment: d.comment || "",
            content: ((m = d.content) == null ? void 0 : m.substring(0, 50)) + "..."
            // 
          };
        });
      } catch (c) {
        console.warn(`[Engram] WorldInfoService:  ${u} `, c), s[u] = [];
      }
    return s;
  }
  /**
   * 
   *  getActivatedWorldInfo 
   */
  static async getConstantWorldInfo() {
    try {
      const n = await new Function("path", "return import(path)")("/scripts/world-info.js"), r = n == null ? void 0 : n.getSortedEntries;
      if (typeof r != "function")
        return "";
      const i = await r();
      if (!i || !Array.isArray(i))
        return "";
      const s = i.filter((o) => o.constant === !0 && o.disable !== !0 && o.content);
      return s.length === 0 ? "" : (console.debug(`[Engram] WorldInfoService:  ${s.length} `), s.map((o) => o.content).join(`

`));
    } catch {
      return "";
    }
  }
}
const JY = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  SUMMARY_ENTRY_KEY: Zg,
  WorldInfoService: pn,
  getTavernHelper: Ba
}, Symbol.toStringTag, { value: "Module" }));
async function eW() {
  const { EventBus: e } = await Promise.resolve().then(() => XY), { MessageService: t } = await Promise.resolve().then(() => ZY), { WorldInfoService: n } = await Promise.resolve().then(() => JY);
  return {
    eventBus: e.isAvailable(),
    messageService: t.isAvailable(),
    worldInfoService: n.isAvailable(),
    nativeTokenCount: await n.isNativeTokenCountAvailable(),
    floorCount: t.isAvailable() ? t.getFloorCount() : null,
    characterName: t.isAvailable() ? t.getCurrentCharacterName() : null
  };
}
const GO = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  EventBus: Is,
  MessageService: HO,
  TavernEventType: Eo,
  WorldInfoService: pn,
  checkTavernIntegration: eW
}, Symbol.toStringTag, { value: "Module" }));
function U6() {
  return typeof crypto < "u" && typeof crypto.randomUUID == "function" ? crypto.randomUUID() : "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, (e) => {
    const t = Math.random() * 16 | 0;
    return (e === "x" ? t : t & 3 | 8).toString(16);
  });
}
function fs() {
  const e = xi();
  return e ? Al(e) : null;
}
function $6() {
  const e = xi();
  return e ? Lc(e) : null;
}
const da = mR((e, t) => ({
  currentChatId: null,
  lastSummarizedFloor: 0,
  isProcessing: !1,
  recentEvents: [],
  // V0.6 
  currentScope: null,
  resolveScope: async (n, r) => {
    e({ currentChatId: n, currentScope: { id: 1 } });
    const i = await Sd.getState();
    return e({ lastSummarizedFloor: i.last_summarized_floor }), { id: 1 };
  },
  initChat: async () => {
    const n = xi();
    if (!n)
      return console.warn("[MemoryStore] No chat_id available"), null;
    if (n !== t().currentChatId) {
      console.debug(`[MemoryStore] Switching to chat: ${n}`);
      const r = await Sd.getState();
      e({
        currentChatId: n,
        currentScope: { id: 1 },
        // 
        lastSummarizedFloor: r.last_summarized_floor,
        recentEvents: []
      });
    }
    return Al(n);
  },
  saveEvent: async (n) => {
    const r = fs();
    if (!r)
      throw new Error("[MemoryStore] No current chat");
    const i = {
      ...n,
      id: U6(),
      timestamp: Date.now(),
      is_embedded: n.is_embedded ?? !1,
      // V0.7: 
      is_archived: n.is_archived ?? !1
      // V0.7: 
    };
    return await r.events.add(i), e((s) => ({
      recentEvents: [...s.recentEvents, i].slice(-10)
    })), i;
  },
  getEventSummaries: async (n) => {
    const r = $6();
    if (!r) return "";
    try {
      const i = await r.events.toArray();
      if (i.length === 0) return "";
      const s = n ? new Set(n) : null, o = i.filter(
        (c) => c.level >= 1 || // 
        !c.is_archived || // 
        (s == null ? void 0 : s.has(c.id))
        //  RAG 
      );
      return o.length === 0 ? "" : (o.sort((c, d) => {
        var S, k, A, T;
        const m = ((S = c.source_range) == null ? void 0 : S.start_index) ?? 0, p = ((k = d.source_range) == null ? void 0 : k.start_index) ?? 0;
        if (m !== p) return m - p;
        const x = ((A = c.source_range) == null ? void 0 : A.end_index) ?? 0, b = ((T = d.source_range) == null ? void 0 : T.end_index) ?? 0;
        return x !== b ? x - b : c.timestamp - d.timestamp;
      }), `<summary>
${o.map((c) => c.summary).join(`

`)}
</summary>`);
    } catch (i) {
      return console.error("[MemoryStore] Failed to get event summaries:", i), "";
    }
  },
  countEventTokens: async () => {
    const n = fs();
    if (!n) return { totalTokens: 0, eventCount: 0, activeEventCount: 0 };
    try {
      const r = await n.events.toArray();
      if (r.length === 0) return { totalTokens: 0, eventCount: 0, activeEventCount: 0 };
      const i = r.filter((u) => !u.is_archived), s = i.map((u) => u.summary).join(`

`);
      return {
        totalTokens: await pn.countTokens(s),
        eventCount: r.length,
        activeEventCount: i.length
        // 
      };
    } catch (r) {
      return console.error("[MemoryStore] Failed to count event tokens:", r), { totalTokens: 0, eventCount: 0, activeEventCount: 0 };
    }
  },
  setLastSummarizedFloor: async (n) => {
    await Sd.updateState({ last_summarized_floor: n }), e({ lastSummarizedFloor: n });
  },
  setProcessing: (n) => e({ isProcessing: n }),
  reset: () => e({
    currentChatId: null,
    currentScope: null,
    lastSummarizedFloor: 0,
    isProcessing: !1,
    recentEvents: []
  }),
  // ==================== Trim  ====================
  /**
   * 
   */
  archiveEvents: async (n) => {
    if (n.length === 0) return;
    const r = fs();
    if (r)
      try {
        await r.events.where("id").anyOf(n).modify({ is_archived: !0 }), console.log(`[MemoryStore] Archived ${n.length} events`);
      } catch (i) {
        console.error("[MemoryStore] Failed to archive events:", i);
      }
  },
  /**
   * 
   */
  markEventsAsEmbedded: async (n) => {
    if (n.length === 0) return;
    const r = fs();
    if (r)
      try {
        await r.events.where("id").anyOf(n).modify({ is_embedded: !0 }), console.log(`[MemoryStore] Marked ${n.length} events as embedded`);
      } catch (i) {
        console.error("[MemoryStore] Failed to mark events as embedded:", i);
      }
  },
  getEventsToMerge: async (n = 3) => {
    const r = fs();
    if (!r) return [];
    try {
      const i = await r.events.orderBy("timestamp").toArray();
      return i.length <= n ? [] : i.slice(0, i.length - n);
    } catch (i) {
      return console.error("[MemoryStore] Failed to get events to merge:", i), [];
    }
  },
  deleteEvents: async (n) => {
    if (n.length === 0) return;
    const r = fs();
    if (r)
      try {
        await r.events.bulkDelete(n), console.log(`[MemoryStore] Deleted ${n.length} events`);
      } catch (i) {
        throw console.error("[MemoryStore] Failed to delete events:", i), i;
      }
  },
  /**
   * 
   */
  updateEvent: async (n, r) => {
    if (!n) return;
    const i = fs();
    if (i)
      try {
        const { id: s, timestamp: o, ...u } = r;
        await i.events.update(n, u), console.log(`[MemoryStore] Updated event: ${n}`, u);
      } catch (s) {
        throw console.error("[MemoryStore] Failed to update event:", s), s;
      }
  },
  getAllEvents: async () => {
    const n = fs();
    if (!n) return [];
    try {
      return await n.events.orderBy("timestamp").toArray();
    } catch (r) {
      return console.error("[MemoryStore] Failed to get all events:", r), [];
    }
  },
  // ==================== V0.9  ====================
  getAllEntities: async () => {
    const n = fs();
    if (!n) return [];
    try {
      return await n.entities.toArray();
    } catch (r) {
      return console.error("[MemoryStore] Failed to get all entities:", r), [];
    }
  },
  saveEntity: async (n) => {
    const r = fs();
    if (!r)
      throw new Error("[MemoryStore] No current chat");
    const i = {
      ...n,
      id: U6(),
      last_updated_at: Date.now(),
      aliases: n.aliases || [],
      profile: n.profile || {}
    };
    return await r.entities.add(i), console.log(`[MemoryStore] Saved entity: ${i.name}`), i;
  },
  updateEntity: async (n, r) => {
    if (!n) return;
    const i = fs();
    if (i)
      try {
        const { id: s, ...o } = r;
        await i.entities.update(n, {
          ...o,
          last_updated_at: Date.now()
        }), console.log(`[MemoryStore] Updated entity: ${n}`);
      } catch (s) {
        throw console.error("[MemoryStore] Failed to update entity:", s), s;
      }
  },
  deleteEntity: async (n) => {
    if (!n) return;
    const r = fs();
    if (r)
      try {
        await r.entities.delete(n), console.log(`[MemoryStore] Deleted entity: ${n}`);
      } catch (i) {
        throw console.error("[MemoryStore] Failed to delete entity:", i), i;
      }
  },
  findEntityByName: async (n) => {
    const r = fs();
    if (!r) return null;
    try {
      const i = await r.entities.where("name").equals(n).first();
      return i || await r.entities.where("aliases").equals(n).first() || null;
    } catch (i) {
      return console.error("[MemoryStore] Failed to find entity by name:", i), null;
    }
  },
  /**
   * V0.9.2:  ()
   *  is_archived=true 
   */
  getArchivedEventSummaries: async () => {
    const n = $6();
    if (!n) return "";
    try {
      const i = (await n.events.toArray()).filter((o) => o.is_archived === !0);
      return i.length === 0 ? "" : (i.sort((o, u) => {
        var m, p;
        const c = ((m = o.source_range) == null ? void 0 : m.start_index) ?? 0, d = ((p = u.source_range) == null ? void 0 : p.start_index) ?? 0;
        return c !== d ? c - d : o.timestamp - u.timestamp;
      }), `<archived_summary>
${i.map((o) => o.summary).join(`

`)}
</archived_summary>`);
    } catch (r) {
      return console.error("[MemoryStore] Failed to get archived event summaries:", r), "";
    }
  }
})), KO = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  useMemoryStore: da
}, Symbol.toStringTag, { value: "Module" })), C5 = [
  { value: "input", label: "", description: " LLM " },
  { value: "output", label: "", description: " LLM /" },
  { value: "both", label: "", description: "" }
], Tm = [
  {
    id: "remove-think",
    name: "",
    pattern: "<think(?:\\s+[^>]*)?>[\\s\\S]*?<\\/think\\s*>",
    replacement: "",
    enabled: !0,
    flags: "gi",
    scope: "both",
    description: " LLM  <think>...</think> "
  },
  {
    id: "remove-headless-think",
    name: "",
    pattern: "[\\s\\S]*?<\\/think\\s*>",
    replacement: "",
    enabled: !0,
    flags: "gi",
    scope: "both",
    description: " </think> "
  },
  {
    id: "remove-update-variable",
    name: " UpdateVariable",
    pattern: "<UpdateVariable(?:\\s+[^>]*)?>[\\s\\S]*?<\\/UpdateVariable\\s*>",
    replacement: "",
    enabled: !0,
    flags: "gi",
    scope: "both",
    description: " MVU "
  },
  {
    id: "remove-status-placeholder",
    name: " StatusPlaceHolder",
    pattern: "<StatusPlaceHolderImpl(?:\\s+[^>]*)?\\s*\\/>",
    replacement: "",
    enabled: !0,
    flags: "gi",
    scope: "both",
    description: ""
  }
];
class ox {
  constructor(t) {
    vt(this, "rules", []);
    this.rules = t || [...Tm];
  }
  /**
   * 
   * @param text 
   * @param scope 
   */
  process(t, n) {
    let r = t;
    for (const i of this.rules)
      if (i.enabled && !(n && i.scope !== n && i.scope !== "both"))
        try {
          const s = new RegExp(i.pattern, i.flags);
          r = r.replace(s, i.replacement);
        } catch (s) {
          console.warn(`[RegexProcessor]  "${i.name}" :`, s);
        }
    return r;
  }
  /**
   * 
   */
  processWithRule(t, n) {
    try {
      const r = new RegExp(n.pattern, n.flags);
      return t.replace(r, n.replacement);
    } catch (r) {
      return console.warn("[RegexProcessor] :", r), t;
    }
  }
  /**
   * 
   */
  validatePattern(t, n) {
    try {
      return new RegExp(t, n), { valid: !0 };
    } catch (r) {
      return {
        valid: !1,
        error: r instanceof Error ? r.message : ""
      };
    }
  }
  /**
   * 
   */
  getRules() {
    return [...this.rules];
  }
  /**
   * 
   */
  setRules(t) {
    this.rules = [...t];
  }
  /**
   * 
   */
  addRule(t) {
    this.rules.push(t);
  }
  /**
   * 
   */
  updateRule(t, n) {
    const r = this.rules.findIndex((i) => i.id === t);
    r >= 0 && (this.rules[r] = { ...this.rules[r], ...n });
  }
  /**
   * 
   */
  deleteRule(t) {
    this.rules = this.rules.filter((n) => n.id !== t);
  }
  /**
   * /
   */
  toggleRule(t) {
    const n = this.rules.find((r) => r.id === t);
    n && (n.enabled = !n.enabled);
  }
  /**
   * 
   */
  resetToDefaults() {
    this.rules = [...Tm];
  }
  /**
   * 
   */
  getEnabledCount() {
    return this.rules.filter((t) => t.enabled).length;
  }
  // ========== V0.8:  ==========
  /**
   * 
   * @param text 
   * @param tagName  ( 'output', 'query')
   * @returns  null
   */
  captureTag(t, n) {
    var r;
    try {
      const i = new RegExp(`<${n}(?:\\s+[^>]*)?>([\\s\\S]*?)<\\/${n}\\s*>`, "i"), s = t.match(i);
      return ((r = s == null ? void 0 : s[1]) == null ? void 0 : r.trim()) || null;
    } catch (i) {
      return console.warn(`[RegexProcessor] : ${n}`, i), null;
    }
  }
  /**
   * 
   * @param text 
   * @param tagName 
   */
  removeTag(t, n) {
    try {
      const r = new RegExp(`<${n}(?:\\s+[^>]*)?>[\\s\\S]*?<\\/${n}\\s*>`, "gi");
      return t.replace(r, "").trim();
    } catch (r) {
      return console.warn(`[RegexProcessor] : ${n}`, r), t;
    }
  }
  /**
   * 
   * @param text 
   * @param tagNames 
   * @returns 
   */
  captureTags(t, n) {
    const r = {};
    for (const i of n)
      r[i] = this.captureTag(t, i);
    return r;
  }
}
const Ps = new ox(), QC = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  DEFAULT_REGEX_RULES: Tm,
  REGEX_SCOPE_OPTIONS: C5,
  RegexProcessor: ox,
  regexProcessor: Ps
}, Symbol.toStringTag, { value: "Module" })), Wr = class Wr {
  /**
   *  Engram 
   */
  static async init() {
    var t, n;
    if (!this.isInitialized)
      try {
        const r = (n = (t = window.SillyTavern) == null ? void 0 : t.getContext) == null ? void 0 : n.call(t);
        if (!(r != null && r.registerMacro)) {
          ve.warn("MacroService", "SillyTavern registerMacro API ");
          return;
        }
        r.registerMacro(
          "engramSummaries",
          () => Wr.cachedSummaries,
          "Engram:  ( IndexedDB)"
        ), r.registerMacro(
          "worldbookContext",
          () => Wr.cachedWorldbookContext,
          "Engram: "
        ), r.registerMacro(
          "userInput",
          () => Wr.cachedUserInput,
          "Engram: "
        ), r.registerMacro(
          "chatHistory",
          (s) => Wr.getChatHistory(s),
          "Engram:  (: , 20)"
        ), r.registerMacro(
          "context",
          () => Wr.cachedCharDescription,
          "Engram: "
        ), r.registerMacro(
          "engramGraph",
          () => Wr.cachedGraphData,
          "Engram:  JSON ()"
        ), r.registerMacro(
          "engramArchivedSummaries",
          () => Wr.cachedArchivedSummaries,
          "Engram:  ()"
        ), r.registerMacro(
          "userPersona",
          () => Wr.cachedUserPersona,
          "Engram:  ( Persona Description)"
        ), this.isInitialized = !0, ve.success("MacroService", "", {
          macros: ["{{engramSummaries}}", "{{worldbookContext}}", "{{userInput}}", "{{chatHistory}}", "{{context}}", "{{engramGraph}}", "{{engramArchivedSummaries}}", "{{userPersona}}"]
        }), await this.refreshCache();
        const i = r.eventSource;
        i && i.on("chat_id_changed", () => {
          this.refreshCache().catch((s) => ve.warn("MacroService", "", s));
        });
      } catch (r) {
        ve.error("MacroService", "", r);
      }
  }
  /**
   * 
   */
  static setUserInput(t) {
    this.cachedUserInput = t;
  }
  /**
   *  -  IndexedDB 
   * @param recalledIds RAG  ID 
   */
  static async refreshCache(t) {
    try {
      const n = da.getState();
      this.cachedSummaries = await n.getEventSummaries(t);
      try {
        const r = await pn.getActivatedWorldInfo(), i = await this.processEJSMacros([r]);
        this.cachedWorldbookContext = i[0] || "";
      } catch (r) {
        ve.debug("MacroService", "", r), this.cachedWorldbookContext = "";
      }
      this.refreshCharDescription(), await this.refreshArchivedSummaries(), this.refreshUserPersona(), this.refreshCustomMacros(), ve.debug("MacroService", "", {
        summariesLength: this.cachedSummaries.length,
        worldbookLength: this.cachedWorldbookContext.length,
        recalledCount: (t == null ? void 0 : t.length) ?? 0,
        customMacrosCount: this.cachedCustomMacros.size
      });
    } catch (n) {
      ve.warn("MacroService", "", n);
    }
  }
  /**
   * V0.9: 
   *  EventNode JSON embedding 
   */
  static async refreshGraphCache() {
    try {
      const t = da.getState(), n = await t.getAllEvents(), r = await t.getAllEntities(), i = n.map((o) => ({
        id: o.id,
        summary: o.summary,
        structured_kv: o.structured_kv,
        significance_score: o.significance_score,
        level: o.level,
        source_range: o.source_range
      })), s = r.map((o) => ({
        id: o.id,
        name: o.name,
        type: o.type,
        aliases: o.aliases || [],
        description: o.description
      }));
      this.cachedGraphData = JSON.stringify({
        events: i,
        existingEntities: s
      }, null, 2), ve.debug("MacroService", "", {
        eventCount: n.length,
        entityCount: r.length
      });
    } catch (t) {
      ve.warn("MacroService", "", t), this.cachedGraphData = JSON.stringify({ events: [], existingEntities: [] });
    }
  }
  /**
   * V0.8.5:  RAG 
   * 
   * @param nodes RAG 
   */
  static async refreshCacheWithNodes(t) {
    try {
      this.cachedSummaries = t.map((n) => n.summary).join(`

---

`);
      try {
        const n = await pn.getActivatedWorldInfo(), r = await this.processEJSMacros([n]);
        this.cachedWorldbookContext = r[0] || "";
      } catch (n) {
        ve.debug("MacroService", "", n), this.cachedWorldbookContext = "";
      }
      this.refreshCharDescription(), ve.debug("MacroService", "RAG ", {
        summariesLength: this.cachedSummaries.length,
        nodeCount: t.length
      });
    } catch (n) {
      ve.warn("MacroService", " RAG ", n);
    }
  }
  /**
   *  ST-Prompt-Template ()  EJS 
   * V0.8.6:  window.EjsTemplate API ( test/.js)
   */
  static async processEJSMacros(t) {
    if (t.length === 0) return t;
    if (!window.EjsTemplate || typeof window.EjsTemplate.evalTemplate != "function")
      return ve.debug("MacroService", "ST-Prompt-Template  EJS "), t;
    try {
      const n = await window.EjsTemplate.prepareContext();
      if (typeof window.Mvu < "u" && window.Mvu.getMvuData)
        try {
          const i = window.Mvu.getMvuData({ type: "message", message_id: "latest" });
          i && i.stat_data && (n.mvu = i.stat_data);
        } catch (i) {
          ve.warn("MacroService", " MVU ", i);
        }
      return await Promise.all(t.map(async (i) => {
        try {
          return await window.EjsTemplate.evalTemplate(i, n);
        } catch (s) {
          return ve.warn("MacroService", "EJS ", s), i;
        }
      }));
    } catch (n) {
      return ve.warn("MacroService", "EJS ", n), t;
    }
  }
  /**
   *  ()
   * @param depthStr  ( 20)
   */
  static getChatHistory(t) {
    var n, r;
    try {
      let i = 20;
      if (t) {
        const u = parseInt(t, 10);
        isNaN(u) || (u < 0 ? i = 1 / 0 : u > 0 ? i = u : i = this.getDynamicChatHistoryLimit());
      } else
        i = this.getDynamicChatHistoryLimit();
      ve.debug("MacroService", "getChatHistory called", { depthStr: t, limit: i });
      const s = (r = (n = window.SillyTavern) == null ? void 0 : n.getContext) == null ? void 0 : r.call(n), o = window.TavernHelper;
      if (s != null && s.chat && Array.isArray(s.chat)) {
        const u = s.chat.slice(-i);
        return ve.debug("MacroService", "Got recent messages", { count: u.length }), u.map((c, d) => {
          let m = c.mes || "";
          const p = m;
          if (o && typeof o.formatAsTavernRegexedString == "function")
            try {
              m = o.formatAsTavernRegexedString(m, "ai_output", { isPrompt: !0 });
            } catch (x) {
              ve.warn("MacroService", "", x);
            }
          return m = Ps.process(m, "both"), (d === 0 || d === u.length - 1) && ve.debug("MacroService", "Message processed", {
            index: d,
            original: p.substring(0, 50),
            processed: m.substring(0, 50)
          }), m;
        }).join(`
`);
      }
      return ve.warn("MacroService", "Context chat is empty or invalid"), "";
    } catch (i) {
      return ve.debug("MacroService", "", i), "";
    }
  }
  /**
   * 
   */
  static refreshCharDescription() {
    var t, n;
    try {
      const r = (n = (t = window.SillyTavern) == null ? void 0 : t.getContext) == null ? void 0 : n.call(t);
      if (r != null && r.characters && r.characterId >= 0) {
        const i = r.characters[r.characterId];
        this.cachedCharDescription = (i == null ? void 0 : i.description) || "";
      }
    } catch (r) {
      ve.debug("MacroService", "", r);
    }
  }
  /**
   * V0.9.2:  chatHistory 
   * : floorInterval - bufferSize
   *  {{chatHistory}} 
   */
  static getDynamicChatHistoryLimit() {
    try {
      const t = rt.get("summarizerConfig"), n = (t == null ? void 0 : t.floorInterval) ?? 20, r = (t == null ? void 0 : t.bufferSize) ?? 3, i = Math.max(1, n - r);
      return ve.debug("MacroService", " chatHistory limit", { floorInterval: n, bufferSize: r, limit: i }), i;
    } catch (t) {
      return ve.warn("MacroService", " limit  17", t), 17;
    }
  }
  /**
   * V0.9.2: 
   *  is_archived=true 
   */
  static async refreshArchivedSummaries() {
    try {
      const t = da.getState();
      this.cachedArchivedSummaries = await t.getArchivedEventSummaries(), ve.debug("MacroService", "", {
        length: this.cachedArchivedSummaries.length
      });
    } catch (t) {
      ve.warn("MacroService", "", t), this.cachedArchivedSummaries = "";
    }
  }
  /**
   * V0.9.2: 
   *  power_user.persona_description 
   */
  static refreshUserPersona() {
    try {
      const t = window.power_user;
      this.cachedUserPersona = (t == null ? void 0 : t.persona_description) || "", ve.debug("MacroService", "", {
        length: this.cachedUserPersona.length
      });
    } catch (t) {
      ve.debug("MacroService", "", t), this.cachedUserPersona = "";
    }
  }
  /**
   * V0.9.2: 
   *  apiSettings.customMacros 
   */
  static refreshCustomMacros() {
    var t, n;
    try {
      const r = (n = (t = window.SillyTavern) == null ? void 0 : t.getContext) == null ? void 0 : n.call(t);
      if (!(r != null && r.registerMacro)) {
        ve.debug("MacroService", " registerMacro ");
        return;
      }
      const i = rt.get("apiSettings"), s = (i == null ? void 0 : i.customMacros) || [];
      this.cachedCustomMacros.clear();
      for (const o of s) {
        if (!o.enabled || !o.name) continue;
        this.cachedCustomMacros.set(o.name, o.content);
        const u = o.name;
        r.registerMacro(
          u,
          () => this.cachedCustomMacros.get(u) ?? "",
          `Engram : {{${u}}}`
        );
      }
      ve.debug("MacroService", "", {
        count: this.cachedCustomMacros.size,
        names: Array.from(this.cachedCustomMacros.keys())
      });
    } catch (r) {
      ve.warn("MacroService", "", r);
    }
  }
};
vt(Wr, "isInitialized", !1), // ---  ---
vt(Wr, "cachedSummaries", ""), vt(Wr, "cachedWorldbookContext", ""), vt(Wr, "cachedUserInput", ""), vt(Wr, "cachedCharDescription", ""), // V0.9: 
vt(Wr, "cachedGraphData", ""), // V0.9.2: 
vt(Wr, "cachedArchivedSummaries", ""), vt(Wr, "cachedUserPersona", ""), // V0.9.2: 
vt(Wr, "cachedCustomMacros", /* @__PURE__ */ new Map());
let ko = Wr;
const YO = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  MacroService: ko
}, Symbol.toStringTag, { value: "Module" })), tW = [
  // 
  { pattern: /\n{3,}/g, replacement: `

`, description: "" },
  // 
  { pattern: /^[ \t]+|[ \t]+$/gm, replacement: "", description: "" },
  //  Markdown 
  { pattern: /```\w*\n?/g, replacement: "", description: "Markdown" },
  // 
  { pattern: /[""]/g, replacement: '"', description: "" },
  { pattern: /['']/g, replacement: "'", description: "" }
];
class WO {
  constructor(t) {
    vt(this, "rules");
    this.rules = t || tW;
  }
  /**
   *  LLM 
   * @param text 
   * @returns 
   */
  clean(t) {
    let n = t;
    for (const r of this.rules)
      n = n.replace(r.pattern, r.replacement);
    return n.trim();
  }
  /**
   * 
   * @param summary 
   * @param metadata 
   */
  formatAsWorldEntry(t, n) {
    let i = `  [${`${n.floorRange[0]}-${n.floorRange[1]}`}]
`;
    return i += t, i;
  }
  /**
   * 
   * @param text 
   */
  extractPlainText(t) {
    return t.replace(/```[\s\S]*?```/g, "").replace(/\[([^\]]+)\]\([^)]+\)/g, "$1").replace(/[*_~`#]/g, "").replace(/\n{2,}/g, `
`).trim();
  }
  /**
   * 
   * @param text 
   * @param maxLength 
   * @param suffix 
   */
  truncate(t, n, r = "...") {
    return t.length <= n ? t : t.slice(0, n - r.length) + r;
  }
  /**
   * 
   */
  addRule(t) {
    this.rules.push(t);
  }
  /**
   * 
   */
  getRules() {
    return [...this.rules];
  }
}
const XO = new WO();
function V6() {
  try {
    return window.TavernHelper || null;
  } catch {
    return null;
  }
}
function nW() {
  var e, t, n, r;
  try {
    const i = (t = (e = window.SillyTavern) == null ? void 0 : e.getContext) == null ? void 0 : t.call(e);
    return ((r = (n = i == null ? void 0 : i.extensionSettings) == null ? void 0 : n.connectionManager) == null ? void 0 : r.profiles) || [];
  } catch {
    return [];
  }
}
class QO {
  /**
   *  LLM 
   * @param request 
   */
  async generate(t) {
    var r, i, s, o;
    const n = V6();
    if (!(n != null && n.generateRaw) && !(n != null && n.generate))
      return {
        success: !1,
        content: "",
        error: "TavernHelper "
      };
    try {
      let u;
      const c = rt.getSettings();
      let d;
      t.presetId && (d = (i = (r = c.apiSettings) == null ? void 0 : r.llmPresets) == null ? void 0 : i.find((j) => j.id === t.presetId)), !d && ((s = c.apiSettings) != null && s.selectedPresetId) && (d = (o = c.apiSettings.llmPresets) == null ? void 0 : o.find((j) => j.id === c.apiSettings.selectedPresetId));
      let m;
      if (d && d.source !== "tavern") {
        if (m = {}, ve.info("LLMAdapter", `: ${d.name} (${d.source})`), d.parameters && (m = {
          ...m,
          //  ST API 
          temperature: d.parameters.temperature,
          max_tokens: d.parameters.maxTokens,
          // ST API  max_tokens
          top_p: d.parameters.topP,
          frequency_penalty: d.parameters.frequencyPenalty,
          presence_penalty: d.parameters.presencePenalty
          //  rep_pen  frequency_penalty 
          // rep_pen: preset.parameters.frequencyPenalty,
        }), d.source === "custom" && d.custom)
          m.apiurl = d.custom.apiUrl, m.key = d.custom.apiKey, m.model = d.custom.model, m.source = d.custom.apiSource || "openai";
        else if (d.source === "tavern_profile" && d.tavernProfileId) {
          const D = nW().find((z) => z.id === d.tavernProfileId);
          D ? (ve.info("LLMAdapter", ` Profile: ${D.name}`), m.model = D.model, m.source = D.api, D["api-url"] ? m.apiurl = D["api-url"] : D.request_url ? m.apiurl = D.request_url : D.openai_url && (m.apiurl = D.openai_url), D.key ? m.key = D.key : D.request_apikey ? m.key = D.request_apikey : D.openai_key && (m.key = D.openai_key)) : (ve.warn("LLMAdapter", ` ID  ${d.tavernProfileId} `), m = void 0);
        }
      }
      const p = t.systemPrompt ? `${t.systemPrompt}

${t.userPrompt}` : t.userPrompt, x = {
        prompt: p,
        // 
        body: {
          messages: [
            { role: "system", content: t.systemPrompt },
            { role: "user", content: t.userPrompt }
          ]
        },
        // 
        is_engram: !0
        //  ()
      }, { EventBus: b, TavernEventType: S } = await Promise.resolve().then(() => GO);
      await b.emit(S.GENERATION_AFTER_COMMANDS, "engram", {}, !1), await b.emit(S.GENERATE_AFTER_DATA, x);
      const k = typeof x.prompt == "string" ? x.prompt : p;
      let A = t.systemPrompt, T = t.userPrompt;
      k !== p && (A = "", T = k);
      const { regexProcessor: M } = await Promise.resolve().then(() => QC);
      if (T = M.process(T, "input"), n.generateRaw) {
        const j = [];
        A && j.push({ role: "system", content: A }), j.push({ role: "user", content: T }), u = await n.generateRaw({
          ordered_prompts: j,
          custom_api: m
          // V0.8.6 Fix
        });
      } else if (n.generate)
        u = await n.generate({
          user_input: T,
          system_prompt: A,
          should_stream: !1,
          max_chat_history: 0,
          custom_api: m
          // V0.8.6 Fix
        });
      else
        throw new Error(" API");
      return {
        success: !0,
        content: u || ""
      };
    } catch (u) {
      const c = u instanceof Error ? u.message : String(u);
      return console.error("[Engram] LLMAdapter :", u), {
        success: !1,
        content: "",
        error: c
      };
    }
  }
  /**
   *  LLM API 
   */
  isAvailable() {
    const t = V6();
    return !!(t != null && t.generate || t != null && t.generateRaw);
  }
  /**
   *  Token 
   * @param text 
   */
  estimateTokens(t) {
    return Math.ceil(t.length / 3);
  }
}
const Rd = new QO(), gd = class gd {
  constructor() {
    vt(this, "unsubscribers", []);
    vt(this, "callbacks", /* @__PURE__ */ new Map());
  }
  /**
   * 
   */
  static getInstance() {
    return gd.instance || (gd.instance = new gd()), gd.instance;
  }
  /**
   * 
   * 
   */
  start() {
    if (this.unsubscribers.length > 0) {
      console.log("[EventWatcher] Already started.");
      return;
    }
    this.unsubscribers.push(
      Is.on(Eo.MESSAGE_RECEIVED, () => this.emit("messageReceived")),
      Is.on(Eo.CHAT_CHANGED, () => this.emit("chatChanged")),
      Is.on(Eo.GENERATION_STARTED, () => this.emit("generationStarted")),
      Is.on(Eo.GENERATION_ENDED, () => this.emit("generationEnded"))
    ), console.log("[EventWatcher] Started, listening to core events.");
  }
  /**
   * 
   */
  stop() {
    this.unsubscribers.forEach((t) => t()), this.unsubscribers = [], console.log("[EventWatcher] Stopped.");
  }
  /**
   * 
   * @param event 
   * @param callback 
   * @returns 
   */
  on(t, n) {
    const r = this.mapEventKey(t);
    return this.callbacks.has(r) || this.callbacks.set(r, /* @__PURE__ */ new Set()), this.callbacks.get(r).add(n), () => {
      var i;
      (i = this.callbacks.get(r)) == null || i.delete(n);
    };
  }
  /**
   * 
   */
  emit(t) {
    const n = this.callbacks.get(t);
    n && n.forEach((r) => {
      try {
        r();
      } catch (i) {
        console.error(`[EventWatcher] Callback error for ${t}:`, i);
      }
    });
  }
  /**
   * 
   */
  mapEventKey(t) {
    return {
      onMessageReceived: "messageReceived",
      onChatChanged: "chatChanged",
      onGenerationStarted: "generationStarted",
      onGenerationEnded: "generationEnded"
    }[t];
  }
};
vt(gd, "instance", null);
let E5 = gd;
const u2 = E5.getInstance();
class ZC {
  /**
   * Clean and parse JSON from a string.
   * @param input Raw string from LLM
   * @returns Parsed object or null if failed
   */
  static parse(t) {
    const n = Ps.process(t, "output"), r = this.extractJsonBlock(n);
    if (!r)
      return console.warn("[RobustJsonParser] No JSON block found."), null;
    try {
      return JSON.parse(r);
    } catch {
      const s = this.simpleRepair(r);
      try {
        return JSON.parse(s);
      } catch (o) {
        return console.error("[RobustJsonParser] Parse failed:", o), console.debug("[RobustJsonParser] Failed string:", r), null;
      }
    }
  }
  /**
   * Extracts the likely JSON part from a string.
   * Prioritizes ```json ... ``` blocks, then looks for outer { ... }.
   */
  static extractJsonBlock(t) {
    const n = t.match(/```(?:json)?\s*([\s\S]*?)```/i);
    if (n && n[1])
      return n[1].trim();
    const r = t.indexOf("{"), i = t.lastIndexOf("}");
    return r !== -1 && i !== -1 && i > r ? t.substring(r, i + 1) : null;
  }
  /**
   * Simple JSON repair logic
   * Fixes common LLM JSON errors:
   * - Trailing commas
   * - Unquoted keys (simple cases)
   * - Single quotes
   */
  static simpleRepair(t) {
    let n = t;
    return n = n.replace(/,\s*([}\]])/g, "$1"), n;
  }
}
class rW {
  /**
   *  Pipeline
   * V0.6:  JSON Extractor LLM
   */
  async run(t) {
    const n = da.getState(), r = Date.now();
    try {
      if (console.log("[Pipeline] Starting..."), n.setProcessing(!0), !await n.initChat())
        return { success: !1, error: "No chat context available" };
      console.log(`[Pipeline] Chat database initialized (${Date.now() - r}ms)`);
      const s = ZC.parse(t.jsonContent);
      if (!s || !s.events || s.events.length === 0)
        return console.warn("[Pipeline] No events found in JSON"), { success: !1, error: "No events in JSON content" };
      console.log(`[Pipeline] Parsed ${s.events.length} events from JSON (${Date.now() - r}ms)`);
      const o = [];
      for (const c of s.events) {
        const d = c.meta, m = [];
        d.time_anchor && m.push(d.time_anchor), d.location && m.push(d.location), d.role && d.role.length > 0 && m.push(d.role.join(", "));
        const p = m.length > 0 ? `(${m.join(" | ")}) ` : "", x = d.event ? `${d.event}:
` : "", b = [];
        d.logic && d.logic.length > 0 && b.push(`[: ${d.logic.join(", ")}]`), d.causality && b.push(`[: ${d.causality}]`);
        const S = b.length > 0 ? `
${b.join(" ")}` : "", k = `${x}${p}${c.summary}${S}`, A = await n.saveEvent({
          summary: k,
          structured_kv: {
            time_anchor: d.time_anchor || "",
            role: d.role || [],
            location: d.location || "",
            event: d.event || "",
            logic: d.logic || [],
            causality: d.causality || ""
          },
          significance_score: c.significance_score,
          level: 0,
          is_embedded: !1,
          // V0.7: 
          is_archived: !1,
          // V0.7: 
          source_range: {
            start_index: t.sourceRange.start,
            end_index: t.sourceRange.end
          }
        });
        o.push(A);
      }
      console.log(`[Pipeline] Saved ${o.length} events to DB (${Date.now() - r}ms)`);
      const { MacroService: u } = await Promise.resolve().then(() => YO);
      return await u.refreshCache(), console.log(`[Pipeline] Macro cache refreshed (${Date.now() - r}ms)`), await n.setLastSummarizedFloor(t.sourceRange.end), console.log(`[Pipeline] Completed successfully in ${Date.now() - r}ms`), { success: !0, events: o };
    } catch (i) {
      return console.error("[Pipeline] Failed:", i), { success: !1, error: String(i) };
    } finally {
      n.setProcessing(!1);
    }
  }
}
const iW = new rW();
async function H6() {
  const { Logger: e } = await Promise.resolve().then(() => NC);
  await e.init(), e.info("STBridge", "Engram ...");
  const { SettingsManager: t } = await Promise.resolve().then(() => RC);
  t.initSettings(), e.info("STBridge", "SettingsManager initialized");
  const n = t.getRegexRules();
  if (n && n.length > 0) {
    const { regexProcessor: i } = await Promise.resolve().then(() => QC);
    i.setRules(n), e.info("STBridge", `Loaded ${n.length} regex rules`);
  }
  try {
    const { checkTavernIntegration: i } = await Promise.resolve().then(() => GO), s = await i();
    e.info("TavernAPI", "", s);
  } catch (i) {
    e.warn("TavernAPI", "", { error: String(i) });
  }
  try {
    const { summarizerService: i } = await Promise.resolve().then(() => _l);
    i.start();
    const s = i.getStatus();
    e.info("Summarizer", "", s);
  } catch (i) {
    e.warn("Summarizer", "", { error: String(i) });
  }
  aW();
  const { ThemeManager: r } = await Promise.resolve().then(() => nv);
  r.init();
  try {
    const { injector: i } = await Promise.resolve().then(() => $W);
    i.init(), e.info("Injector", "Service initialized");
  } catch (i) {
    e.warn("Injector", "Failed to initialize Injector", { error: String(i) });
  }
  try {
    const { MacroService: i } = await Promise.resolve().then(() => YO);
    await i.init();
  } catch (i) {
    e.warn("MacroService", "Failed to initialize MacroService", { error: String(i) });
  }
  try {
    const { initQuickPanelButton: i } = await Promise.resolve().then(() => MW);
    i(), e.info("QuickPanelButton", "QR ");
  } catch (i) {
    e.warn("QuickPanelButton", "Failed to initialize QuickPanelButton", { error: String(i) });
  }
  uW();
  try {
    const { CharacterDeleteService: i } = await Promise.resolve().then(() => VW);
    i.init(), e.info("STBridge", "CharacterDeleteService initialized");
  } catch (i) {
    e.warn("STBridge", "Failed to initialize CharacterDeleteService", { error: String(i) });
  }
  e.success("STBridge", "Engram  - Where memories leave their trace.");
}
const ZO = '<svg viewBox="0 0 400 592" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M103.875908,522.166260 C75.225380,521.276611 55.289425,503.229828 52.249313,475.852142 C49.879883,454.514191 63.027035,433.000366 83.930901,424.858398 C88.449257,423.098541 89.857674,420.860199 89.801926,416.150269 C89.555420,395.322357 89.621246,374.489380 89.762306,353.659515 C89.787170,349.987000 88.728760,348.057556 85.120293,346.642609 C64.672897,338.625031 52.338894,320.951630 52.085896,299.869415 C51.832878,278.785156 63.730618,260.903198 84.118019,252.449951 C88.288918,250.720566 89.867378,248.680847 89.807304,244.052597 C89.539139,223.391968 89.589142,202.724701 89.796356,182.062561 C89.836380,178.071609 88.518524,176.326385 84.841705,174.787247 C57.730556,163.438416 45.530682,135.966721 55.436111,109.194000 C62.627293,89.757439 81.922821,76.710289 103.282494,76.841476 C124.355003,76.970901 143.082275,89.740875 149.993118,109.121849 C151.315979,112.831749 153.184799,113.869263 156.863403,113.853104 C186.192612,113.724319 215.522736,113.698357 244.851929,113.811600 C248.773117,113.826736 250.677307,112.652130 252.052902,108.765602 C259.013885,89.098465 278.589447,76.365829 300.503601,76.811897 C322.171844,77.252960 341.040283,91.132324 347.255371,111.201912 C356.569763,141.279358 340.344788,170.373184 309.893127,176.623123 C283.359375,182.068970 260.376740,167.450562 251.980011,145.670181 C250.492157,141.810806 248.818085,140.240295 244.552948,140.266785 C215.390915,140.447968 186.227219,140.357330 157.064072,140.375076 C154.628784,140.376556 151.855545,139.805771 151.141357,143.359161 C150.400787,147.043839 146.628937,150.064713 151.136917,154.478546 C184.592346,187.235229 217.778336,220.267349 250.982285,253.280014 C253.021469,255.307434 254.527191,255.254166 257.033264,254.047714 C276.199188,244.820953 294.752930,247.045853 310.978485,259.993408 C328.011017,273.584869 333.936798,292.106659 327.764038,313.282837 C321.779785,333.812378 307.254517,345.637268 286.367889,349.037231 C276.405396,350.658997 266.352570,349.443024 257.275055,344.363342 C254.265045,342.678986 252.301132,343.049744 249.903275,345.441406 C230.205368,365.088531 210.395386,384.623230 190.631638,404.204376 C177.732651,416.984222 164.859726,429.790344 151.962982,442.572388 C148.257980,446.244415 148.113403,452.901764 151.629196,456.671387 C152.707138,457.827148 154.029282,457.681976 155.328629,457.681946 C185.658203,457.681458 215.987854,457.631042 246.317261,457.695557 C249.355972,457.702026 250.687012,456.399414 251.717636,453.698944 C259.314423,433.793579 278.324493,420.868317 299.341309,421.146240 C320.526215,421.426361 339.575745,434.206421 346.686249,452.909271 C354.337341,473.034058 348.794159,495.642761 332.699371,509.956390 C307.061371,532.757202 263.380280,521.715210 251.978027,489.436371 C250.838303,486.209961 249.371201,484.953583 245.964813,484.962799 C216.302094,485.043304 186.639008,484.985840 156.976028,484.969330 C154.436981,484.967896 152.081528,484.923981 150.916916,488.054077 C142.892441,509.621246 126.842339,520.325989 103.875908,522.166260 M141.430466,266.110352 C145.394760,270.906738 148.503693,276.196198 150.388428,282.139069 C151.211502,284.734314 152.692291,285.770782 155.494156,285.760895 C179.139755,285.677429 202.787949,285.547394 226.430206,285.843811 C232.373352,285.918304 231.388184,281.058533 233.335602,278.254700 C235.007233,275.847992 233.916855,274.189880 232.000244,272.304352 C199.956863,240.780380 167.866821,209.301468 136.133682,177.467056 C131.183243,172.500824 127.483856,170.729507 121.013550,174.621368 C117.660522,176.638214 116.183739,178.155136 116.217278,182.042480 C116.398239,203.022598 116.444160,224.006012 116.243645,244.985474 C116.204666,249.064667 117.676285,250.918961 121.328865,252.228989 C128.972488,254.970444 135.505173,259.524170 141.430466,266.110352 M116.349434,377.499908 C116.351860,390.663696 116.870338,403.855377 116.161102,416.980713 C115.742699,424.723846 121.926743,423.801880 125.649162,426.262665 C129.080231,428.530792 130.798965,425.706268 132.741440,423.784821 C165.551407,391.329803 198.234940,358.745361 231.274231,326.525696 C235.764252,322.147095 232.377243,319.155212 231.599960,315.493317 C230.884583,312.123138 228.193359,312.382568 225.670288,312.382812 C202.675171,312.384949 179.679749,312.445435 156.685303,312.323212 C153.331955,312.305389 151.624329,313.386505 150.456299,316.584381 C145.119888,331.194611 135.004120,341.287384 120.496223,346.769958 C117.238434,348.001068 116.190170,349.706024 116.267418,353.006317 C116.450615,360.833862 116.340004,368.668243 116.349434,377.499908z"/></svg>';
function aW() {
  const e = document.querySelector("#top-settings-holder"), t = document.querySelector("#WI-SP-button");
  if (!e) {
    console.warn("[Engram] #top-settings-holder not found, fallback to floating orb"), sW();
    return;
  }
  const n = document.createElement("div");
  n.id = "engram-drawer", n.className = "drawer";
  const r = document.createElement("div");
  r.className = "drawer-toggle drawer-header";
  const i = document.createElement("div");
  i.id = "engram-drawer-icon", i.className = "drawer-icon fa-fw closedIcon", i.title = "Engram - ", i.setAttribute("data-i18n", "[title]Engram - Memory OS"), i.innerHTML = ZO, i.addEventListener("click", Tv), r.appendChild(i), n.appendChild(r), t ? (e.insertBefore(n, t), console.log("[Engram] Top bar button injected before WI-SP-button")) : (e.appendChild(n), console.log("[Engram] Top bar button injected at end (WI-SP-button not found)"));
}
function sW() {
  const e = document.createElement("div");
  e.className = "fixed bottom-5 right-5 w-12 h-12 rounded-full cursor-pointer z-[9999] flex items-center justify-center transition-transform duration-200 bg-gradient-to-br from-orange-500 to-pink-500 shadow-[0_0_20px_rgba(249,115,22,0.5)] hover:scale-110 hover:shadow-[0_0_30px_rgba(249,115,22,0.7)] text-white", e.title = "Engram - ", e.innerHTML = ZO, e.addEventListener("click", Tv), document.body.appendChild(e);
}
let kv = null;
function oW(e) {
  kv = e, kv = e;
}
let k5 = null, G6 = null;
function lW(e) {
  k5 = e;
}
function uW() {
  if (!k5) {
    console.warn("[Engram] Global renderer not ready");
    return;
  }
  const e = "engram-global-overlay";
  let t = document.getElementById(e);
  t || (t = document.createElement("div"), t.id = e, t.className = "pointer-events-none fixed inset-0 z-[11000]", document.body.appendChild(t)), G6 || (G6 = k5(t, () => {
  }), console.log("[Engram] Global overlay mounted"));
}
let c2 = !1, Dg = null, av = null;
function Tv() {
  c2 && Dg ? (av && (av.unmount(), av = null), Dg.remove(), Dg = null, c2 = !1) : (Dg = cW(), document.body.appendChild(Dg), c2 = !0);
}
function cW() {
  var t;
  const e = document.createElement("div");
  return e.className = "fixed inset-0 w-full h-full z-[10000] flex flex-col bg-background text-foreground overflow-hidden", e.style.backgroundColor = "var(--background)", e.style.color = "var(--foreground)", e.style.height = "100dvh", e.style.width = "100vw", e.style.top = "0", e.style.left = "0", e.id = "engram-panel-root", kv ? av = kv(e, Tv) : (e.innerHTML = `
            <div class="flex items-center justify-between p-4 border-b border-slate-400/20">
                <h2 class="m-0 text-lg text-slate-200 flex items-center gap-2"> Engram</h2>
                <button class="bg-transparent border-none text-slate-400 text-2xl cursor-pointer p-1 hover:text-slate-200">&times;</button>
            </div>
            <div class="flex-1 overflow-auto p-5">
                <p style="color: #94a3b8;">React </p>
            </div>
        `, (t = e.querySelector("button")) == null || t.addEventListener("click", Tv)), e;
}
async function fW(e, t) {
  try {
    const r = await new Function("path", "return import(path)")("/scripts/chats.js");
    r && typeof r.hideChatMessageRange == "function" ? (await r.hideChatMessageRange(e, t, !1), console.log(`[Engram] Hidden messages range: ${e}-${t}`)) : console.warn("[Engram] hideChatMessageRange not found in chats.js");
  } catch (n) {
    console.error("[Engram] Failed to hide messages:", n);
  }
}
async function dW(e, t = "text", n = "") {
  return window.callPopup ? window.callPopup(e, t, n) : (console.warn("[Engram] callPopup not available"), Promise.resolve(t === "confirm" ? !0 : null));
}
class hW {
  /**
   * 
   * @returns Promise<string> 
   * @throws Error 
   */
  async requestRevision(t, n, r) {
    return new Promise((i, s) => {
      Is.emit(Eo.ENGRAM_REQUEST_REVISION, {
        title: t,
        description: n,
        content: r,
        onConfirm: (o) => i(o),
        onCancel: () => s(new Error("User cancelled revision"))
      });
    });
  }
}
const JC = new hW(), JO = {
  enabled: !0,
  triggerMode: "auto",
  floorInterval: 10,
  worldbookMode: "chat",
  previewEnabled: !0,
  promptTemplateId: null,
  // 
  llmPresetId: null,
  // 
  bufferSize: 3,
  //  3 
  autoHide: !1
  // 
}, om = "engram";
function K6() {
  var e, t;
  try {
    return ((t = (e = window.SillyTavern) == null ? void 0 : e.getContext) == null ? void 0 : t.call(e)) || null;
  } catch {
    return null;
  }
}
function Y6() {
  var e, t;
  try {
    const n = (t = (e = window.SillyTavern) == null ? void 0 : e.getContext) == null ? void 0 : t.call(e);
    return n != null && n.chat_metadata ? n.chat_metadata : window.chat_metadata || null;
  } catch {
    return null;
  }
}
function mW() {
  var e;
  try {
    (e = window.saveChatDebounced) == null || e.call(window);
  } catch {
    console.warn("[Engram] saveChatDebounced ");
  }
}
class eD {
  constructor(t, n, r) {
    vt(this, "config");
    vt(this, "textProcessor");
    vt(this, "llmAdapter");
    vt(this, "currentChatId", null);
    vt(this, "isRunning", !1);
    vt(this, "isSummarizing", !1);
    vt(this, "cancelRequested", !1);
    // 
    vt(this, "unsubscribeMessage", null);
    vt(this, "unsubscribeChat", null);
    vt(this, "summaryHistory", []);
    // 
    vt(this, "_lastSummarizedFloor", 0);
    const i = rt.get("summarizerConfig");
    this.config = { ...JO, ...i, ...t }, this.textProcessor = n || XO, this.llmAdapter = r || Rd;
  }
  // ====================  ====================
  // getInfoFromChatMetadata  saveToChatMetadata 
  //  WorldBookStateService
  /**
   * 
   */
  getFromChatMetadata(t) {
    const n = Y6();
    if (n)
      return n.extensions || (n.extensions = {}), n.extensions[om] || (n.extensions[om] = {}), n.extensions[om][t];
  }
  /**
   * 
   */
  saveToChatMetadata(t, n) {
    const r = Y6();
    r && (r.extensions || (r.extensions = {}), r.extensions[om] || (r.extensions[om] = {}), r.extensions[om][t] = n, this.log("debug", ` chat_metadata: ${t} = ${n}`), mW());
  }
  /**
   * 
   * V0.5:  memoryStore 
   * V0.8:  chatManager.getState() 
   */
  async getLastSummarizedFloor() {
    if (this._lastSummarizedFloor > 0) return this._lastSummarizedFloor;
    try {
      const { chatManager: t } = await Promise.resolve().then(() => WY), n = await t.getState();
      return this._lastSummarizedFloor = n.last_summarized_floor, this.log("debug", " DB  lastSummarizedFloor", { value: this._lastSummarizedFloor }), this._lastSummarizedFloor;
    } catch (t) {
      return this.log("warn", " lastSummarizedFloor  0", t), 0;
    }
  }
  /**
   * 
   * V0.5:  memoryStore (IndexedDB)
   */
  async setLastSummarizedFloor(t) {
    this._lastSummarizedFloor = t, await da.getState().setLastSummarizedFloor(t);
  }
  // ====================  ====================
  /**
   * 
   */
  getCurrentFloor() {
    const t = K6();
    return t != null && t.chat ? t.chat.length : 0;
  }
  /**
   *  ID
   */
  getCurrentChatId() {
    const t = K6();
    return (t == null ? void 0 : t.chatId) || null;
  }
  // ====================  ====================
  /**
   * 
   * V0.5:  EventWatcher 
   */
  start() {
    if (this.isRunning) {
      this.log("warn", "");
      return;
    }
    this.initializeForCurrentChat(), u2.start(), this.config.triggerMode === "auto" && (this.unsubscribeMessage = u2.on(
      "onMessageReceived",
      this.handleMessageReceived.bind(this)
    ), this.log("debug", " EventWatcher ")), this.unsubscribeChat = u2.on(
      "onChatChanged",
      this.handleChatChanged.bind(this)
    ), this.log("debug", " EventWatcher "), this.isRunning = !0;
    const t = this.getStatus();
    this.log("info", "", t);
  }
  /**
   *  ( 0)
   */
  async resetProgress() {
    await this.setLastSummarizedFloor(0), this.log("info", "");
  }
  /**
   * 
   */
  stop() {
    this.unsubscribeMessage && (this.unsubscribeMessage(), this.unsubscribeMessage = null), this.unsubscribeChat && (this.unsubscribeChat(), this.unsubscribeChat = null), this.isRunning = !1, this.log("info", "");
  }
  /**
   * 
   */
  async initializeForCurrentChat() {
    const t = this.getCurrentChatId(), n = this.getCurrentFloor();
    this.currentChatId = t, this.summaryHistory = [], this._lastSummarizedFloor = 0;
    const r = await this.getLastSummarizedFloor();
    this.log("info", "", {
      chatId: t,
      currentFloor: n,
      lastSummarizedFloor: r,
      pendingFloors: n - r
    });
  }
  // ====================  ====================
  /**
   * 
   * V0.9.1:  Summary 
   */
  async handleMessageReceived() {
    const t = this.getCurrentFloor(), n = await this.getLastSummarizedFloor(), r = t - n;
    this.log("debug", "", {
      currentFloor: t,
      lastSummarized: n,
      pendingFloors: r,
      triggerAt: this.config.floorInterval
    }), await this.checkEntityExtraction(t), r >= this.config.floorInterval && (this.log("info", "", {
      pendingFloors: r,
      interval: this.config.floorInterval
    }), await this.triggerSummary());
  }
  /**
   * V0.9.1: 
   *  Summary 
   */
  async checkEntityExtraction(t) {
    try {
      const { entityBuilder: n } = await Promise.resolve().then(() => HW);
      if (n.shouldTriggerOnFloor(t)) {
        this.log("info", "", { floor: t });
        const r = await ko.getChatHistory("50");
        n.extractFromChat(r, t, !1).catch((i) => {
          this.log("warn", "", { error: i });
        });
      }
    } catch (n) {
      this.log("warn", "", { error: n });
    }
  }
  /**
   * 
   */
  handleChatChanged() {
    const t = this.getCurrentChatId();
    this.log("info", "", {
      from: this.currentChatId,
      to: t
    }), this.initializeForCurrentChat();
  }
  // ====================  ====================
  /**
   * /
   */
  async triggerSummary(t = !1) {
    var s, o, u;
    if (this.isSummarizing)
      return this.log("warn", ""), null;
    if (!this.config.enabled && !t)
      return this.log("debug", ""), null;
    const n = this.getCurrentFloor(), r = await this.getLastSummarizedFloor();
    this.isSummarizing = !0, this.cancelRequested = !1, this.log("info", "", {
      floorRange: [r + 1, n],
      manual: t
    });
    const i = tn.running("...", "Engram", () => {
      var c, d, m, p;
      this.cancelRequested = !0, this.log("info", "");
      try {
        (p = (m = (d = (c = window.SillyTavern) == null ? void 0 : c.getContext) == null ? void 0 : d.call(c)) == null ? void 0 : m.stopGeneration) == null || p.call(m), this.log("info", " stopGeneration");
      } catch (x) {
        this.log("warn", " stopGeneration ", x);
      }
      tn.warning("...", "Engram");
    });
    try {
      const { WorldBookSlotService: c } = await Promise.resolve().then(() => GW);
      await c.init();
      const d = this._lastSummarizedFloor + 1, m = this.config.bufferSize || 0, p = n - m;
      if (d > p)
        return t && tn.info(" ()", "Engram"), null;
      const x = this.config.floorInterval || 10, b = d + x - 1, S = Math.min(p, b);
      if (d > S)
        return null;
      const k = [d, S];
      this.log("info", "", { startFloor: d, endFloor: S, currentFloor: n, buffer: m });
      const T = OR().slice(d - 1, S);
      if (this.log("info", "", {
        range: k,
        msgCount: T.length,
        firstMsg: (((s = T[0]) == null ? void 0 : s.mes) || "").substring(0, 20)
      }), T.length === 0)
        return this.log("warn", "", { floorRange: k }), null;
      const M = {
        messages: T.map(($) => {
          const fe = $.mes || $.content || $.message || "";
          return fe || console.warn("[Engram] Message content is empty/undefined:", $), {
            role: $.is_user ? "user" : "assistant",
            content: fe,
            name: $.name
          };
        }),
        floorRange: k,
        templateId: this.config.promptTemplateId || void 0
      }, j = T.map(($) => $.mes || $.content || $.message || "").join(`

`), D = Ps.process(j, "input");
      this.log("debug", "", {
        originalLength: j.length,
        cleanedLength: D.length
      });
      let z = "";
      try {
        const $ = await pn.getActivatedWorldInfo();
        $ && (z = `
` + $ + `

`, this.log("debug", "", { length: $.length }));
      } catch ($) {
        this.log("warn", "", { error: String($) });
      }
      const I = rt.getEnabledPromptTemplate("summary"), L = tx("summary"), K = (I == null ? void 0 : I.systemPrompt) || (L == null ? void 0 : L.systemPrompt) || "", ne = (I == null ? void 0 : I.userPromptTemplate) || (L == null ? void 0 : L.userPromptTemplate) || "";
      let Y = "";
      try {
        Y = await pn.getEngramSummariesContent(), Y && this.log("debug", " Engram ", { length: Y.length });
      } catch ($) {
        this.log("warn", " Engram ", { error: String($) });
      }
      const H = ne.replace("{{worldbookContext}}", z).replace("{{chatHistory}}", D).replace("{{context}}", z).replace("{{engramSummaries}}", Y);
      this.log("debug", "", {
        source: I ? "APIPresets" : "fallback",
        templateName: (I == null ? void 0 : I.name) || "default"
      });
      const Z = ua.logSend({
        type: "summarize",
        systemPrompt: K,
        userPrompt: H,
        floorRange: M.floorRange,
        model: j0(),
        character: (o = jd()) == null ? void 0 : o.name
      }), me = Date.now(), Q = await this.llmAdapter.generate({
        systemPrompt: K,
        userPrompt: H
      });
      if (ua.logReceive(Z, {
        response: Q.content,
        status: Q.success ? "success" : "error",
        error: Q.error,
        duration: Date.now() - me
      }), !Q.success)
        return this.log("error", "LLM ", { error: Q.error }), tn.error(`: ${Q.error}`, "Engram "), null;
      if (this.cancelRequested)
        return this.log("info", ""), tn.info("", "Engram"), null;
      const se = this.textProcessor.clean(Q.content), J = Ps.process(se, "output"), ue = await pn.countTokens(J), de = {
        id: Date.now().toString(),
        content: J,
        sourceFloors: M.floorRange,
        timestamp: Date.now(),
        tokenCount: ue,
        writtenToWorldbook: !1
      };
      if (this.config.previewEnabled) {
        this.log("info", "", { result: de });
        try {
          const $ = await JC.requestRevision(
            "",
            `: ${M.floorRange[0]} - ${M.floorRange[1]}  | Token: ${ue}`,
            de.content
          );
          de.content = $, de.tokenCount = await pn.countTokens($), this.log("info", "");
        } catch {
          return this.log("warn", ""), tn.info("", ""), null;
        }
      }
      const ce = xi(), W = jd();
      if (ce && W)
        try {
          const $ = await iW.run({
            jsonContent: de.content,
            //  JSON
            sourceRange: {
              start: M.floorRange[0],
              end: M.floorRange[1]
            }
          });
          $.success ? this.log("info", "Pipeline ", {
            eventsCount: ((u = $.events) == null ? void 0 : u.length) || 0
          }) : this.log("warn", "Pipeline ", { error: $.error });
        } catch ($) {
          this.log("error", "Pipeline ", { error: String($) });
        }
      if (de.writtenToWorldbook = !0, await this.setLastSummarizedFloor(M.floorRange[1]), this.summaryHistory.push(de), tn.success(` ${M.floorRange[0]}-${M.floorRange[1]} `, "Engram"), this.config.autoHide) {
        const $ = M.floorRange[0] - 1, fe = M.floorRange[1] - 1;
        this.log("info", "", { startIndex: $, endIndex: fe }), fW($, fe).catch((G) => {
          this.log("error", "", G);
        });
      }
      return de;
    } catch (c) {
      const d = c instanceof Error ? c.message : String(c);
      return this.log("error", "", { error: d }), tn.error(`: ${d}`, "Engram "), null;
    } finally {
      tn.remove(i), this.isSummarizing = !1;
    }
  }
  // ====================  ====================
  /**
   * 
   */
  getStatus() {
    const t = this.getCurrentFloor(), n = this._lastSummarizedFloor;
    return {
      running: this.isRunning,
      currentFloor: t,
      lastSummarizedFloor: n,
      pendingFloors: Math.max(0, t - n),
      historyCount: this.summaryHistory.length,
      isSummarizing: this.isSummarizing
    };
  }
  /**
   * 
   */
  refreshStatus() {
    return this.initializeForCurrentChat(), this.getStatus();
  }
  /**
   * 
   */
  getConfig() {
    return { ...this.config };
  }
  /**
   * 
   */
  updateConfig(t) {
    this.config = { ...this.config, ...t }, rt.set("summarizerConfig", this.config), this.log("debug", "", this.config);
  }
  /**
   * 
   */
  getHistory() {
    return [...this.summaryHistory];
  }
  /**
   * 
   */
  async resetBaseFloor() {
    const t = this.getCurrentFloor();
    await this.setLastSummarizedFloor(t), this.log("info", "", { currentFloor: t });
  }
  // ====================  ====================
  /**
   * 
   */
  async log(t, n, r) {
    try {
      const { Logger: i } = await Promise.resolve().then(() => NC);
      i[t]("Summarizer", n, r);
    } catch {
      console.log(`[Summarizer] ${t}: ${n}`, r);
    }
  }
}
const kl = new eD(), tD = {
  ...jR,
  keepRecentCount: 3,
  preserveOriginal: !1,
  previewEnabled: !0
};
class nD {
  constructor(t, n) {
    vt(this, "config");
    vt(this, "llmAdapter");
    vt(this, "isTrimming", !1);
    const r = rt.get("trimmerConfig") || {};
    this.config = { ...tD, ...r, ...t }, this.llmAdapter = n || Rd;
  }
  // ====================  ====================
  /**
   * 
   */
  getConfig() {
    return { ...this.config };
  }
  /**
   * 
   */
  updateConfig(t) {
    this.config = { ...this.config, ...t };
    const n = rt.get("summarizerConfig") || {};
    rt.set("summarizerConfig", {
      ...n,
      trimmer: this.config
    }), this.log("debug", "", this.config);
  }
  // ====================  ====================
  /**
   * 
   */
  async getStatus() {
    const t = pn.findExistingWorldbook();
    if (!t)
      return {
        triggered: !1,
        triggerType: this.config.trigger,
        currentValue: 0,
        threshold: this.getThreshold(),
        pendingEntryCount: 0,
        isTrimming: this.isTrimming
      };
    const n = await pn.getSummaryEntries(t), r = Math.max(0, n.length - this.config.keepRecentCount), i = await this.getCurrentTriggerValue(t, n), s = this.getThreshold();
    return {
      triggered: this.config.enabled && i >= s,
      triggerType: this.config.trigger,
      currentValue: i,
      threshold: s,
      pendingEntryCount: r,
      isTrimming: this.isTrimming
    };
  }
  /**
   * 
   */
  getThreshold() {
    switch (this.config.trigger) {
      case "token":
        return this.config.tokenLimit;
      case "count":
        return this.config.countLimit;
      default:
        return 0;
    }
  }
  /**
   * 
   */
  async getCurrentTriggerValue(t, n) {
    switch (this.config.trigger) {
      case "token":
        return await pn.countSummaryTokens(t);
      case "count":
        return n.length;
      default:
        return 0;
    }
  }
  /**
   * 
   */
  async checkTrigger() {
    return (await this.getStatus()).triggered;
  }
  // ====================  ====================
  /**
   * 
   *  N 
   */
  async getEntriesToMerge() {
    const t = pn.findExistingWorldbook();
    if (!t) return [];
    const n = await pn.getSummaryEntries(t), r = this.config.keepRecentCount;
    return n.length <= r ? [] : n.slice(0, n.length - r);
  }
  /**
   * /
   */
  async triggerTrim(t = !1) {
    var i;
    if (this.isTrimming)
      return this.log("warn", ""), null;
    if (!this.config.enabled && !t)
      return this.log("debug", ""), null;
    const n = pn.findExistingWorldbook();
    if (!n)
      return this.log("warn", ""), tn.warning(" Engram ", "Engram"), null;
    const r = await this.getEntriesToMerge();
    if (r.length < 2)
      return t && tn.info(" ( 2 )", "Engram"), null;
    this.isTrimming = !0, this.log("info", "", {
      entryCount: r.length,
      manual: t
    });
    try {
      const s = r.map((L) => pn.parseFloorRangeFromName(L.name)).filter((L) => L !== null);
      if (s.length === 0)
        return this.log("error", ""), null;
      const o = Math.min(...s.map((L) => L[0])), u = Math.max(...s.map((L) => L[1])), c = [o, u], d = r.map((L) => {
        const K = pn.parseFloorRangeFromName(L.name), ne = K ? `${K[0]}-${K[1]}` : `${L.name}`, Y = L.content.replace(/\{\{\/\/.*?\}\}/gs, "").trim();
        return `${ne}
${Y}`;
      }).join(`

---

`), m = rt.getEnabledPromptTemplate("trim"), p = tx("trim"), x = (m == null ? void 0 : m.systemPrompt) || (p == null ? void 0 : p.systemPrompt) || "", S = ((m == null ? void 0 : m.userPromptTemplate) || (p == null ? void 0 : p.userPromptTemplate) || "").replace("{{engramSummaries}}", d).replace("{{context}}", d);
      this.log("debug", "", {
        source: m ? "APIPresets" : "fallback",
        templateName: (m == null ? void 0 : m.name) || "default",
        inputLength: d.length
      });
      const k = ua.logSend({
        type: "trim",
        systemPrompt: x,
        userPrompt: S,
        floorRange: c,
        model: j0(),
        character: (i = jd()) == null ? void 0 : i.name
      }), A = Date.now(), T = await this.llmAdapter.generate({
        systemPrompt: x,
        userPrompt: S
      });
      if (ua.logReceive(k, {
        response: T.content,
        status: T.success ? "success" : "error",
        error: T.error,
        duration: Date.now() - A
      }), !T.success)
        return this.log("error", "LLM ", { error: T.error }), tn.error(`: ${T.error}`, "Engram "), null;
      const M = Ps.process(T.content, "output"), j = await pn.countTokens(M), D = Math.min(...r.map((L) => L.order)), z = {
        content: M,
        tokenCount: j,
        sourceEntryIds: r.map((L) => L.uid),
        newFloorRange: c,
        newOrder: D
      };
      if (this.config.previewEnabled) {
        this.log("info", "", { result: z });
        try {
          const L = await JC.requestRevision(
            "",
            ` ${r.length}  | : ${c[0]}-${c[1]}  | Token: ${j}`,
            z.content
          );
          z.content = L, z.tokenCount = await pn.countTokens(L), this.log("info", "");
        } catch {
          return this.log("warn", ""), tn.info("", ""), null;
        }
      }
      return await this.writeCompactedEntry(n, z) ? (await this.removeOriginalEntries(n, z.sourceEntryIds), tn.success(
        ` ${r.length}  1  (${c[0]}-${c[1]} )`,
        "Engram"
      ), z) : (this.log("error", ""), null);
    } catch (s) {
      const o = s instanceof Error ? s.message : String(s);
      return this.log("error", "", { error: o }), tn.error(`: ${o}`, "Engram "), null;
    } finally {
      this.isTrimming = !1;
    }
  }
  /**
   * 
   */
  async writeCompactedEntry(t, n) {
    try {
      const r = `{{// ${JSON.stringify({
        floors: n.newFloorRange,
        tokens: n.tokenCount,
        timestamp: Date.now(),
        layer: 2,
        // 
        mergedFrom: n.sourceEntryIds.length
      })} }}`, i = `${n.content}

${r}`, s = await pn.createEntry(t, {
        name: `_${n.newFloorRange[0]}-${n.newFloorRange[1]}`,
        content: i,
        keys: [Zg],
        // 
        enabled: !0,
        constant: !0,
        order: n.newOrder
      });
      return s && this.log("success", "", {
        worldbook: t,
        floorRange: n.newFloorRange,
        order: n.newOrder
      }), s;
    } catch (r) {
      return this.log("error", "", { error: String(r) }), !1;
    }
  }
  /**
   * /
   */
  async removeOriginalEntries(t, n) {
    if (this.config.preserveOriginal) {
      for (const r of n)
        await pn.updateEntry(t, r, { enabled: !1 });
      this.log("info", "", { count: n.length });
    } else
      await pn.deleteEntries(t, n) && this.log("info", "", { count: n.length });
  }
  // ====================  ====================
  /**
   * 
   */
  log(t, n, r) {
    ve[t]("Trimmer", n, r);
  }
}
new nD();
const _l = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  DEFAULT_REGEX_RULES: Tm,
  DEFAULT_SUMMARIZER_CONFIG: JO,
  DEFAULT_TRIMMER_CONFIG: tD,
  LLMAdapter: QO,
  RegexProcessor: ox,
  SummarizerService: eD,
  TextProcessor: WO,
  TrimmerService: nD,
  llmAdapter: Rd,
  regexProcessor: Ps,
  summarizerService: kl,
  textProcessor: XO
}, Symbol.toStringTag, { value: "Module" })), f0 = {
  enabled: !1,
  templateId: "query_enhance",
  autoTrigger: !0,
  preview: !0
  // 
};
function pW(e = 2e3) {
  const [t, n] = F.useState(!0), [r, i] = F.useState({
    isConnected: !1,
    characterName: "Unknown",
    currentFloor: 0,
    lastSummarizedFloor: 0,
    pendingFloors: 0,
    floorInterval: 10,
    isSummarizing: !1
  }), [s, o] = F.useState({
    eventCount: 0,
    entityCount: 0,
    entityByType: {},
    archivedCount: 0,
    activeCount: 0,
    estimatedTokens: 0
  }), [u, c] = F.useState({
    summarizer: !0,
    entity: !1,
    embedding: !1,
    recall: !0,
    preprocessing: !1
  }), d = da((b) => b.getAllEvents), m = da((b) => b.getAllEntities), p = F.useCallback(async () => {
    try {
      const b = Mo(), S = kl.getStatus(), k = rt.get("summarizerConfig") || {};
      i({
        isConnected: !!b,
        characterName: (b == null ? void 0 : b.name2) || "Unknown",
        currentFloor: S.currentFloor,
        lastSummarizedFloor: S.lastSummarizedFloor,
        pendingFloors: S.pendingFloors,
        floorInterval: k.floorInterval || 10,
        isSummarizing: S.isSummarizing
      });
      const A = await d(), T = await m(), M = {};
      T.forEach((Y) => {
        M[Y.type] = (M[Y.type] || 0) + 1;
      });
      const j = A.filter((Y) => Y.is_archived), D = A.reduce((Y, H) => {
        var Z;
        return Y + Math.ceil((((Z = H.summary) == null ? void 0 : Z.length) || 0) / 4);
      }, 0);
      o({
        eventCount: A.length,
        entityCount: T.length,
        entityByType: M,
        archivedCount: j.length,
        activeCount: A.length - j.length,
        estimatedTokens: D
      });
      const z = rt.get("apiSettings"), I = z == null ? void 0 : z.entityExtractConfig, L = z == null ? void 0 : z.embeddingConfig, K = z == null ? void 0 : z.recallConfig, ne = rt.get("preprocessingConfig");
      c({
        summarizer: k.enabled !== !1,
        entity: (I == null ? void 0 : I.enabled) || !1,
        embedding: (L == null ? void 0 : L.enabled) || !1,
        recall: (K == null ? void 0 : K.enabled) !== !1,
        preprocessing: (ne == null ? void 0 : ne.enabled) || !1
      }), n(!1);
    } catch (b) {
      console.error("[useDashboardData] Error refreshing data:", b), n(!1);
    }
  }, [d, m]), x = F.useCallback((b) => {
    const S = rt.get("apiSettings") || {}, k = rt.get("summarizerConfig") || {};
    switch (b) {
      case "summarizer":
        const A = !u.summarizer;
        rt.set("summarizerConfig", {
          ...k,
          enabled: A
        }), kl.updateConfig({ enabled: A });
        break;
      case "entity":
        const T = (S == null ? void 0 : S.entityExtractConfig) || {};
        rt.set("apiSettings", {
          ...S,
          entityExtractConfig: {
            ...T,
            enabled: !u.entity
          }
        });
        break;
      case "embedding":
        const M = (S == null ? void 0 : S.embeddingConfig) || {};
        rt.set("apiSettings", {
          ...S,
          embeddingConfig: {
            ...M,
            enabled: !u.embedding
          }
        });
        break;
      case "recall":
        const j = (S == null ? void 0 : S.recallConfig) || {};
        rt.set("apiSettings", {
          ...S,
          recallConfig: {
            ...j,
            enabled: !u.recall
          }
        });
        break;
      case "preprocessing":
        const D = rt.get("preprocessingConfig") || f0, z = !u.preprocessing;
        rt.set("preprocessingConfig", {
          ...D,
          enabled: z
        }), Promise.resolve().then(() => WF).then(({ getDefaultAPISettings: I }) => {
          const K = rt.get("apiSettings") || I(), ne = K.recallConfig || {};
          rt.set("apiSettings", {
            ...K,
            recallConfig: {
              ...ne,
              usePreprocessing: z
            }
          });
        });
        break;
    }
    p();
  }, [u, p]);
  return F.useEffect(() => {
    p();
    const b = setInterval(p, e);
    return () => clearInterval(b);
  }, [p, e]), {
    system: r,
    memory: s,
    features: u,
    isLoading: t,
    toggleFeature: x,
    refresh: p
  };
}
const gW = (e) => {
  switch (e) {
    case 0:
      return "text-muted-foreground";
    case 1:
      return "text-primary";
    case 2:
      return "text-green-400";
    case 3:
      return "text-yellow-400";
    case 4:
      return "text-red-400";
    default:
      return "text-primary";
  }
}, yW = [
  { key: "summarizer", label: "", desc: "", icon: JM },
  { key: "entity", label: "", desc: "/", icon: aR },
  { key: "embedding", label: "", desc: "", icon: Ls },
  { key: "recall", label: "RAG ", desc: "", icon: Ls },
  { key: "preprocessing", label: "", desc: "Query /", icon: uR }
], vW = xv.filter((e) => e.id !== "dashboard"), W6 = ({ onNavigate: e }) => {
  const [t, n] = F.useState([]), [r, i] = F.useState(0), { system: s, memory: o, features: u, toggleFeature: c } = pW(2e3);
  F.useEffect(() => (n(ve.getLogs().slice(0, 4)), ve.subscribe((S) => {
    n((k) => [S, ...k].slice(0, 4));
  })), []), F.useEffect(() => {
    const b = setInterval(() => i((S) => S + 1), 1e3);
    return () => clearInterval(b);
  }, []);
  const d = (b) => {
    const S = Math.floor(b / 3600), k = Math.floor(b % 3600 / 60), A = b % 60;
    return `${S.toString().padStart(2, "0")}:${k.toString().padStart(2, "0")}:${A.toString().padStart(2, "0")}`;
  }, m = (b) => e == null ? void 0 : e(b), p = s.floorInterval > 0 ? Math.min(100, s.pendingFloors / s.floorInterval * 100) : 0, x = o.eventCount > 0 ? Math.round(o.archivedCount / o.eventCount * 100) : 0;
  return /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col h-full", children: [
    /* @__PURE__ */ g.jsxs("div", { className: "mb-6", children: [
      /* @__PURE__ */ g.jsx("h1", { className: "text-2xl font-light text-foreground tracking-tight mb-2", children: "" }),
      /* @__PURE__ */ g.jsx("p", { className: "text-sm text-muted-foreground", children: "" })
    ] }),
    /* @__PURE__ */ g.jsx(Jr, { className: "mb-6" }),
    /* @__PURE__ */ g.jsx("div", { className: "flex-1 overflow-y-auto no-scrollbar", children: /* @__PURE__ */ g.jsxs("div", { className: "grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-12", children: [
      /* @__PURE__ */ g.jsxs("section", { className: "space-y-8", children: [
        /* @__PURE__ */ g.jsxs("div", { children: [
          /* @__PURE__ */ g.jsx("h2", { className: "text-xs font-medium text-muted-foreground uppercase tracking-wider mb-4", children: "" }),
          /* @__PURE__ */ g.jsxs("div", { className: "grid grid-cols-2 gap-6", children: [
            /* @__PURE__ */ g.jsxs("div", { children: [
              /* @__PURE__ */ g.jsx("span", { className: "text-xs text-muted-foreground block mb-1", children: "" }),
              /* @__PURE__ */ g.jsxs("div", { className: `flex items-center gap-2 text-lg font-medium ${s.isConnected ? "text-green-500" : "text-muted-foreground"}`, children: [
                s.isConnected ? /* @__PURE__ */ g.jsx(Yv, { size: 18 }) : /* @__PURE__ */ g.jsx(qc, { size: 18 }),
                s.isConnected ? s.characterName : ""
              ] })
            ] }),
            /* @__PURE__ */ g.jsxs("div", { children: [
              /* @__PURE__ */ g.jsx("span", { className: "text-xs text-muted-foreground block mb-1", children: "" }),
              /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-2", children: [
                /* @__PURE__ */ g.jsx("span", { className: "text-3xl font-light text-amber-500 font-mono", children: s.pendingFloors }),
                /* @__PURE__ */ g.jsxs("span", { className: "text-muted-foreground", children: [
                  "/ ",
                  s.floorInterval
                ] }),
                s.isSummarizing && /* @__PURE__ */ g.jsx(Eu, { size: 14, className: "animate-spin text-primary ml-1" })
              ] }),
              /* @__PURE__ */ g.jsx("div", { className: "mt-2 h-1 bg-border rounded-full overflow-hidden", children: /* @__PURE__ */ g.jsx(
                "div",
                {
                  className: `h-full transition-all duration-300 ${p >= 80 ? "bg-amber-500" : "bg-primary"}`,
                  style: { width: `${p}%` }
                }
              ) })
            ] })
          ] })
        ] }),
        /* @__PURE__ */ g.jsx(Jr, { length: 100, spacing: "md" }),
        /* @__PURE__ */ g.jsxs("div", { children: [
          /* @__PURE__ */ g.jsx("h2", { className: "text-xs font-medium text-muted-foreground uppercase tracking-wider mb-4", children: "" }),
          /* @__PURE__ */ g.jsxs("div", { className: "grid grid-cols-2 gap-6", children: [
            /* @__PURE__ */ g.jsxs("div", { children: [
              /* @__PURE__ */ g.jsx("span", { className: "text-[10px] text-muted-foreground/70 uppercase tracking-wider block mb-1", children: "" }),
              /* @__PURE__ */ g.jsxs("div", { className: "flex items-baseline gap-2", children: [
                /* @__PURE__ */ g.jsx("span", { className: "text-xl font-mono text-foreground/80", children: o.eventCount }),
                /* @__PURE__ */ g.jsxs("span", { className: "text-xs text-muted-foreground", children: [
                  "~",
                  o.estimatedTokens.toLocaleString(),
                  " tok"
                ] })
              ] }),
              /* @__PURE__ */ g.jsxs("div", { className: "mt-2 flex items-center gap-2 text-[10px] text-muted-foreground", children: [
                /* @__PURE__ */ g.jsxs("span", { children: [
                  " ",
                  o.activeCount
                ] }),
                /* @__PURE__ */ g.jsx("div", { className: "flex-1 h-1 bg-border rounded-full overflow-hidden", children: /* @__PURE__ */ g.jsx("div", { className: "h-full bg-primary", style: { width: `${100 - x}%` } }) }),
                /* @__PURE__ */ g.jsxs("span", { children: [
                  " ",
                  o.archivedCount
                ] })
              ] })
            ] }),
            /* @__PURE__ */ g.jsxs("div", { children: [
              /* @__PURE__ */ g.jsx("span", { className: "text-[10px] text-muted-foreground/70 uppercase tracking-wider block mb-1", children: "" }),
              /* @__PURE__ */ g.jsx("div", { className: "text-xl font-mono text-foreground/80", children: o.entityCount }),
              o.entityCount > 0 && /* @__PURE__ */ g.jsx("div", { className: "flex gap-2 mt-2", children: Object.entries(o.entityByType).slice(0, 3).map(([b, S]) => /* @__PURE__ */ g.jsxs("span", { className: "text-[10px] text-muted-foreground", children: [
                b,
                ": ",
                S
              ] }, b)) })
            ] })
          ] })
        ] }),
        /* @__PURE__ */ g.jsx(Jr, { length: 30, spacing: "md" }),
        /* @__PURE__ */ g.jsxs("div", { children: [
          /* @__PURE__ */ g.jsx("span", { className: "text-[10px] text-muted-foreground/60 uppercase tracking-wider block mb-1", children: "" }),
          /* @__PURE__ */ g.jsx("div", { className: "text-sm font-mono text-primary/80", children: d(r) })
        ] }),
        /* @__PURE__ */ g.jsx(Jr, { length: 100 }),
        /* @__PURE__ */ g.jsxs("div", { children: [
          /* @__PURE__ */ g.jsx("h2", { className: "text-xs font-medium text-muted-foreground uppercase tracking-wider mb-4", children: "" }),
          /* @__PURE__ */ g.jsx("div", { className: "grid grid-cols-5 gap-3", children: vW.map(({ id: b, label: S, icon: k, path: A }) => /* @__PURE__ */ g.jsxs(
            "button",
            {
              onClick: () => m(A.replace("/", "")),
              className: "flex flex-col items-center gap-2 p-3 rounded-lg text-muted-foreground hover:text-foreground hover:bg-accent/50 transition-all group",
              children: [
                /* @__PURE__ */ g.jsx(k, { size: 20, className: "text-primary group-hover:scale-110 transition-transform" }),
                /* @__PURE__ */ g.jsx("span", { className: "text-xs", children: S })
              ]
            },
            b
          )) })
        ] })
      ] }),
      /* @__PURE__ */ g.jsxs("section", { className: "space-y-6 lg:pl-8 relative", children: [
        /* @__PURE__ */ g.jsx(Jr, { responsive: !0, length: 30 }),
        /* @__PURE__ */ g.jsxs("div", { children: [
          /* @__PURE__ */ g.jsx("h2", { className: "text-xs font-medium text-muted-foreground uppercase tracking-wider mb-4", children: "" }),
          /* @__PURE__ */ g.jsx("div", { className: "space-y-4", children: yW.map(({ key: b, label: S, desc: k, icon: A }) => {
            const T = u[b];
            return /* @__PURE__ */ g.jsxs("div", { className: "flex items-center justify-between", children: [
              /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-3 min-w-0 flex-1", children: [
                /* @__PURE__ */ g.jsx("div", { className: `p-1.5 rounded-lg ${T ? "bg-primary/10 text-primary" : "bg-muted text-muted-foreground"}`, children: /* @__PURE__ */ g.jsx(A, { size: 14 }) }),
                /* @__PURE__ */ g.jsxs("div", { className: "min-w-0 flex-1", children: [
                  /* @__PURE__ */ g.jsx("span", { className: `text-sm ${T ? "text-foreground" : "text-muted-foreground"}`, children: S }),
                  /* @__PURE__ */ g.jsx("p", { className: "text-[10px] text-muted-foreground truncate", children: k })
                ] })
              ] }),
              /* @__PURE__ */ g.jsx(Zr, { checked: T, onChange: () => c(b) })
            ] }, b);
          }) })
        ] }),
        /* @__PURE__ */ g.jsx(Jr, { length: 100, spacing: "md" }),
        /* @__PURE__ */ g.jsxs("div", { children: [
          /* @__PURE__ */ g.jsxs("div", { className: "flex items-center justify-between mb-4", children: [
            /* @__PURE__ */ g.jsx("h2", { className: "text-xs font-medium text-muted-foreground uppercase tracking-wider", children: "" }),
            /* @__PURE__ */ g.jsxs(
              "button",
              {
                onClick: () => m("devlog"),
                className: "text-[10px] text-primary hover:underline flex items-center gap-0.5",
                children: [
                  " ",
                  /* @__PURE__ */ g.jsx(Pm, { size: 12 })
                ]
              }
            )
          ] }),
          /* @__PURE__ */ g.jsx("div", { className: "font-mono text-[11px] space-y-1.5", children: t.length === 0 ? /* @__PURE__ */ g.jsx("div", { className: "text-muted-foreground text-center py-4 italic", children: "" }) : t.map((b) => /* @__PURE__ */ g.jsxs("div", { className: `flex gap-2 opacity-80 ${gW(b.level)}`, children: [
            /* @__PURE__ */ g.jsxs("span", { className: "text-muted-foreground shrink-0", children: [
              "[",
              new Date(b.timestamp).toLocaleTimeString([], { hour12: !1 }),
              "]"
            ] }),
            /* @__PURE__ */ g.jsx("span", { className: "text-foreground truncate", children: b.message })
          ] }, b.id)) })
        ] })
      ] })
    ] }) })
  ] });
}, xW = F.lazy(() => Promise.resolve().then(() => lX).then((e) => ({ default: e.DevLog }))), bW = F.lazy(() => Promise.resolve().then(() => yte).then((e) => ({ default: e.APIPresets }))), wW = F.lazy(() => Promise.resolve().then(() => wte).then((e) => ({ default: e.Settings }))), _W = F.lazy(() => Promise.resolve().then(() => Yfe).then((e) => ({ default: e.MemoryStream }))), SW = F.lazy(() => Promise.resolve().then(() => cde).then((e) => ({ default: e.ProcessingView }))), CW = () => /* @__PURE__ */ g.jsx("div", { className: "flex items-center justify-center h-full", children: /* @__PURE__ */ g.jsx("div", { className: "animate-spin h-8 w-8 border-2 border-primary border-t-transparent rounded-full" }) }), EW = ({ onClose: e }) => {
  const [t, n] = F.useState("dashboard"), [r, i] = F.useState(!1), [s, o] = F.useState(!1), u = (m) => {
    const p = m.replace(/^\//, "");
    console.debug("[Engram] Navigating to:", p), n(p);
  };
  F.useEffect(() => {
    const m = setTimeout(() => {
      const p = rt.get("hasSeenWelcome");
      console.debug("[Engram] hasSeenWelcome:", p), p || i(!0), o(!0);
    }, 1e3);
    return () => clearTimeout(m);
  }, []);
  const c = () => {
    rt.set("hasSeenWelcome", !0), console.debug("[Engram] hasSeenWelcome saved"), i(!1);
  };
  if (!s)
    return null;
  const d = () => {
    const [m, p] = t.split(":");
    switch (m) {
      case "dashboard":
        return /* @__PURE__ */ g.jsx(W6, { onNavigate: n });
      case "presets":
        return /* @__PURE__ */ g.jsx(bW, { initialTab: p });
      case "devlog":
        return /* @__PURE__ */ g.jsx(xW, { initialTab: p });
      case "settings":
        return /* @__PURE__ */ g.jsx(wW, {});
      case "memory":
        return /* @__PURE__ */ g.jsx(_W, {});
      case "processing":
        return /* @__PURE__ */ g.jsx(SW, { onNavigate: n });
      default:
        return /* @__PURE__ */ g.jsx(W6, {});
    }
  };
  return (
    /*  */
    /* @__PURE__ */ g.jsxs(g.Fragment, { children: [
      r && /* @__PURE__ */ g.jsx(KY, { onComplete: c }),
      /* @__PURE__ */ g.jsx(GY, { activeTab: t, setActiveTab: u, onClose: e, children: /* @__PURE__ */ g.jsx(F.Suspense, { fallback: /* @__PURE__ */ g.jsx(CW, {}), children: d() }) })
    ] })
  );
}, kW = () => {
  const [e, t] = F.useState(!1), [n, r] = F.useState(null), [i, s] = F.useState(""), [o, u] = F.useState(!1);
  F.useEffect(() => {
    const p = Is.on(
      Eo.ENGRAM_REQUEST_REVISION,
      (x) => {
        const b = x;
        r(b), s(b.content), t(!0);
      }
    );
    return () => {
      p();
    };
  }, []);
  const c = () => {
    n && (n.onConfirm(i), t(!1), r(null));
  }, d = () => {
    n && n.onCancel(), t(!1), r(null);
  }, m = async () => {
    if (n != null && n.onReroll) {
      u(!0);
      try {
        const p = await n.onReroll();
        s(p);
      } catch (p) {
        console.error("[RevisionModal] Reroll failed:", p);
      } finally {
        u(!1);
      }
    }
  };
  return e ? EC.createPortal(
    /* @__PURE__ */ g.jsxs(
      "div",
      {
        className: "fixed inset-0 z-[11000] flex items-center justify-center p-4",
        style: { height: "100dvh", width: "100vw" },
        children: [
          /* @__PURE__ */ g.jsx(
            "div",
            {
              className: "absolute inset-0 bg-background/80 backdrop-blur-sm animate-in fade-in duration-200",
              onClick: d
            }
          ),
          /* @__PURE__ */ g.jsxs("div", { className: "relative w-full max-w-2xl bg-popover border border-border rounded-lg shadow-2xl flex flex-col max-h-[85vh] animate-in zoom-in-95 slide-in-from-bottom-2 duration-200", children: [
            /* @__PURE__ */ g.jsxs("div", { className: "flex items-start justify-between p-5 border-b border-border", children: [
              /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col gap-1", children: [
                /* @__PURE__ */ g.jsx("h3", { className: "text-lg font-medium text-foreground tracking-tight", children: (n == null ? void 0 : n.title) || "" }),
                (n == null ? void 0 : n.description) && /* @__PURE__ */ g.jsx("p", { className: "text-sm text-muted-foreground", children: n.description })
              ] }),
              /* @__PURE__ */ g.jsx(
                "button",
                {
                  onClick: d,
                  className: "p-2 -m-2 text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors",
                  "aria-label": "",
                  children: /* @__PURE__ */ g.jsx(Lm, { size: 18 })
                }
              )
            ] }),
            /* @__PURE__ */ g.jsxs("div", { className: "flex-1 p-5 overflow-hidden flex flex-col gap-4", children: [
              /* @__PURE__ */ g.jsxs("div", { className: "flex items-start gap-3 p-3 bg-primary/10 border border-primary/20 rounded-md", children: [
                /* @__PURE__ */ g.jsx(oR, { size: 16, className: "text-primary shrink-0 mt-0.5" }),
                /* @__PURE__ */ g.jsx("p", { className: "text-sm text-foreground/80 leading-relaxed", children: "" })
              ] }),
              /* @__PURE__ */ g.jsx(
                "textarea",
                {
                  value: i,
                  onChange: (p) => s(p.target.value),
                  className: "flex-1 w-full min-h-[200px] p-4 bg-muted border border-border rounded-md font-mono text-sm text-foreground leading-relaxed placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring resize-none",
                  spellCheck: !1,
                  placeholder: "..."
                }
              ),
              /* @__PURE__ */ g.jsxs("div", { className: "text-xs text-muted-foreground text-right font-mono", children: [
                i.length,
                " "
              ] })
            ] }),
            /* @__PURE__ */ g.jsxs("div", { className: "flex items-center justify-between px-5 py-4 border-t border-border bg-muted/30", children: [
              /* @__PURE__ */ g.jsx("div", { children: (n == null ? void 0 : n.onReroll) && /* @__PURE__ */ g.jsxs(
                "button",
                {
                  onClick: m,
                  disabled: o,
                  className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg transition-colors disabled:opacity-50",
                  children: [
                    o ? /* @__PURE__ */ g.jsx(Eu, { size: 16, className: "animate-spin" }) : /* @__PURE__ */ g.jsx(zr, { size: 16 }),
                    ""
                  ]
                }
              ) }),
              /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-3", children: [
                /* @__PURE__ */ g.jsx(
                  "button",
                  {
                    onClick: d,
                    disabled: o,
                    className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg transition-colors disabled:opacity-50",
                    children: ""
                  }
                ),
                /* @__PURE__ */ g.jsxs(
                  "button",
                  {
                    onClick: c,
                    disabled: o,
                    className: "inline-flex items-center gap-2 px-4 py-2 text-sm bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50 shadow-sm",
                    children: [
                      /* @__PURE__ */ g.jsx(Kv, { size: 16 }),
                      ""
                    ]
                  }
                )
              ] })
            ] })
          ] })
        ]
      }
    ),
    document.body
  ) : null;
}, TW = ({
  isOpen: e,
  onClose: t,
  title: n,
  children: r,
  initialPosition: i,
  width: s = 320,
  minWidth: o = 280,
  maxWidth: u = 600,
  minHeight: c = 150,
  resizable: d = !0
}) => {
  const m = F.useRef(null), [p, x] = F.useState(i || { x: 100, y: 100 }), [b, S] = F.useState({ width: s, height: "auto" }), [k, A] = F.useState(!1), [T, M] = F.useState(!1), j = F.useRef({ x: 0, y: 0 }), D = F.useRef({ width: 0, height: 0, x: 0, y: 0 });
  F.useEffect(() => {
    e && !i && x({
      x: Math.max(50, (window.innerWidth - s) / 2),
      y: Math.max(50, window.innerHeight - 450)
    });
  }, [e, i, s]);
  const z = F.useCallback((ne) => {
    if (!m.current) return;
    const Y = m.current.getBoundingClientRect();
    j.current = {
      x: ne.clientX - Y.left,
      y: ne.clientY - Y.top
    }, A(!0);
  }, []), I = F.useCallback((ne) => {
    if (k) {
      const Y = Math.max(0, Math.min(window.innerWidth - (typeof b.width == "number" ? b.width : 300), ne.clientX - j.current.x)), H = Math.max(0, Math.min(window.innerHeight - 100, ne.clientY - j.current.y));
      x({ x: Y, y: H });
    } else if (T && m.current) {
      const Y = ne.clientX - D.current.x, H = ne.clientY - D.current.y, Z = Math.max(o, Math.min(u, D.current.width + Y)), me = Math.max(c, D.current.height + H);
      S({ width: Z, height: me });
    }
  }, [k, T, b.width, o, u, c]), L = F.useCallback(() => {
    A(!1), M(!1);
  }, []), K = F.useCallback((ne) => {
    if (ne.preventDefault(), ne.stopPropagation(), !m.current) return;
    const Y = m.current.getBoundingClientRect();
    D.current = {
      width: Y.width,
      height: Y.height,
      x: ne.clientX,
      y: ne.clientY
    }, M(!0);
  }, []);
  return F.useEffect(() => {
    if (k || T)
      return window.addEventListener("mousemove", I), window.addEventListener("mouseup", L), () => {
        window.removeEventListener("mousemove", I), window.removeEventListener("mouseup", L);
      };
  }, [k, T, I, L]), e ? EC.createPortal(
    /* @__PURE__ */ g.jsxs(
      "div",
      {
        ref: m,
        className: "fixed z-[11000] flex flex-col rounded-lg shadow-2xl border border-border overflow-hidden",
        style: {
          left: p.x,
          top: p.y,
          width: b.width,
          height: b.height === "auto" ? "auto" : b.height,
          minHeight: c,
          backgroundColor: "var(--popover, #1a1a2e)",
          backdropFilter: "blur(20px)",
          WebkitBackdropFilter: "blur(20px)"
        },
        children: [
          /* @__PURE__ */ g.jsxs(
            "div",
            {
              className: "flex items-center justify-between px-3 py-2 border-b border-border select-none",
              onMouseDown: z,
              style: {
                cursor: k ? "grabbing" : "grab",
                backgroundColor: "var(--surface, rgba(255,255,255,0.05))"
              },
              children: [
                /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-2", children: [
                  /* @__PURE__ */ g.jsx(eR, { size: 14, className: "text-muted-foreground" }),
                  /* @__PURE__ */ g.jsx("span", { className: "text-sm font-medium text-foreground", children: n })
                ] }),
                /* @__PURE__ */ g.jsx(
                  "button",
                  {
                    onClick: t,
                    className: "p-1 text-muted-foreground hover:text-foreground rounded transition-colors",
                    style: { backgroundColor: "transparent" },
                    "aria-label": "",
                    onMouseDown: (ne) => ne.stopPropagation(),
                    children: /* @__PURE__ */ g.jsx(Lm, { size: 14 })
                  }
                )
              ]
            }
          ),
          /* @__PURE__ */ g.jsx("div", { className: "flex-1 overflow-auto p-3", children: r }),
          d && /* @__PURE__ */ g.jsx(
            "div",
            {
              className: "absolute bottom-0 right-0 w-4 h-4 cursor-se-resize",
              onMouseDown: K,
              style: {
                background: "linear-gradient(135deg, transparent 50%, var(--border, #333) 50%)"
              }
            }
          )
        ]
      }
    ),
    document.body
  ) : null;
};
function X6(e) {
  var t, n;
  try {
    const r = (n = (t = window.SillyTavern) == null ? void 0 : t.getContext) == null ? void 0 : n.call(t);
    return r != null && r.substituteParams ? r.substituteParams(e) : (ve.warn("Preprocessor", "substituteParams "), e);
  } catch (r) {
    return ve.warn("Preprocessor", "substituteParams ", r), e;
  }
}
async function NW() {
  var e, t;
  try {
    const n = (t = (e = window.SillyTavern) == null ? void 0 : e.getContext) == null ? void 0 : t.call(e);
    n != null && n.stopGeneration && (n.stopGeneration(), ve.info("Preprocessor", " stopGeneration"));
  } catch (n) {
    ve.warn("Preprocessor", " stopGeneration ", n);
  }
}
function Q6() {
  try {
    const e = jd();
    return e == null ? void 0 : e.name;
  } catch {
  }
}
function Z6() {
  try {
    return j0();
  } catch {
  }
}
const yd = class yd {
  constructor() {
    vt(this, "cancelRequested", !1);
  }
  // ... (rest of class)
  static getInstance() {
    return yd.instance || (yd.instance = new yd()), yd.instance;
  }
  /**
   * 
   */
  requestStopGeneration() {
    NW();
  }
  /**
   * 
   * @param userInput 
   * @returns 
   */
  async process(t) {
    var s;
    const n = Date.now(), r = this.getConfig();
    if (ve.info("Preprocessor", "", {
      enabled: r.enabled,
      templateId: r.templateId,
      inputLength: t.length
    }), !r.enabled)
      return ve.debug("Preprocessor", ""), {
        success: !0,
        output: null,
        query: null,
        rawOutput: "",
        processingTime: 0
      };
    this.cancelRequested = !1;
    const i = tn.running("...", "Engram", () => {
      this.cancelRequested = !0, ve.info("Preprocessor", ""), this.requestStopGeneration(), tn.warning("...", "Engram");
    });
    try {
      const o = rt.getPromptTemplateById(r.templateId);
      if (ve.debug("Preprocessor", "", {
        templateId: r.templateId,
        found: !!o,
        templateName: o == null ? void 0 : o.name
      }), !o) {
        const S = ` ${r.templateId}  API `;
        return ve.warn("Preprocessor", S), {
          success: !1,
          output: null,
          query: null,
          rawOutput: "",
          processingTime: Date.now() - n,
          error: S
        };
      }
      if (this.cancelRequested)
        return {
          success: !1,
          output: null,
          query: null,
          rawOutput: "",
          processingTime: Date.now() - n,
          error: ""
        };
      let u = o.systemPrompt.replace(/\{\{input\}\}/gi, t), c = o.userPromptTemplate.replace(/\{\{input\}\}/gi, t);
      u = X6(u), c = X6(c), ve.debug("Preprocessor", "", {
        systemPromptLength: u.length,
        userPromptLength: c.length,
        userPromptPreview: c.substring(0, 100) + "..."
      });
      const d = ua.logSend({
        type: "query",
        systemPrompt: u,
        userPrompt: c,
        model: Z6() || "Unknown",
        character: Q6() || "System"
      }), m = await Rd.generate({
        systemPrompt: u,
        userPrompt: c
      });
      if (ua.logReceive(d, {
        response: m.content,
        status: m.success ? "success" : "error",
        error: m.error,
        duration: Date.now() - n
      }), this.cancelRequested)
        return ve.info("Preprocessor", ""), {
          success: !1,
          output: null,
          query: null,
          rawOutput: "",
          processingTime: Date.now() - n,
          error: ""
        };
      if (!m.success || !m.content) {
        const S = m.error || "LLM ";
        return ve.error("Preprocessor", "LLM ", { error: S }), {
          success: !1,
          output: null,
          query: null,
          rawOutput: "",
          processingTime: Date.now() - n,
          error: S
        };
      }
      const p = Ps.process(m.content, "output"), x = Ps.captureTags(p, ["output", "query"]);
      if (r.preview && x.output) {
        ve.info("Preprocessor", "");
        try {
          const S = async () => {
            const A = ua.logSend({
              type: "query",
              systemPrompt: u,
              userPrompt: c,
              model: Z6() || "Unknown",
              character: Q6() || "System"
            }), T = await Rd.generate({
              systemPrompt: u,
              userPrompt: c
            });
            if (ua.logReceive(A, {
              response: T.content,
              status: T.success ? "success" : "error",
              error: T.error,
              duration: 0
            }), !T.success || !T.content)
              throw new Error(T.error || "LLM ");
            const M = Ps.process(T.content, "output");
            return Ps.captureTags(M, ["output", "query"]).output || M;
          }, k = await new Promise((A) => {
            Is.emit(Eo.ENGRAM_REQUEST_REVISION, {
              title: "",
              content: x.output,
              description: "",
              onConfirm: (T) => A(T),
              onCancel: () => A(null),
              // V0.9.2:  Roll 
              onReroll: S
            });
          });
          if (k !== null)
            x.output = k, ve.info("Preprocessor", "");
          else
            return ve.info("Preprocessor", ""), {
              success: !1,
              output: null,
              query: null,
              rawOutput: "",
              processingTime: Date.now() - n,
              error: ""
            };
        } catch (S) {
          ve.warn("Preprocessor", "", S);
        }
      }
      const b = Date.now() - n;
      return ve.info("Preprocessor", "", {
        hasOutput: !!x.output,
        hasQuery: !!x.query,
        outputLength: ((s = x.output) == null ? void 0 : s.length) || 0,
        processingTime: b
      }), tn.success("", "Engram"), {
        success: !0,
        output: x.output,
        query: x.query,
        rawOutput: p,
        processingTime: b
      };
    } catch (o) {
      const u = o instanceof Error ? o.message : "";
      return ve.error("Preprocessor", "", { error: u, stack: o.stack }), tn.error(`: ${u}`, "Engram"), {
        success: !1,
        output: null,
        query: null,
        rawOutput: "",
        processingTime: Date.now() - n,
        error: u
      };
    } finally {
      tn.remove(i);
    }
  }
  /**
   * 
   */
  getConfig() {
    return rt.get("preprocessingConfig") || f0;
  }
  /**
   * 
   */
  saveConfig(t) {
    ve.debug("Preprocessor", "", t), rt.set("preprocessingConfig", t);
  }
  /**
   * /
   */
  toggle() {
    const t = this.getConfig();
    return t.enabled = !t.enabled, this.saveConfig(t), ve.info("Preprocessor", `${t.enabled ? "" : ""}`), t.enabled;
  }
};
vt(yd, "instance");
let T5 = yd;
const Cd = T5.getInstance();
function AW({ isOpen: e, onClose: t }) {
  var p, x, b, S;
  const [n, r] = F.useState(
    Cd.getConfig() || f0
  ), [i, s] = F.useState(
    ((p = rt.get("apiSettings")) == null ? void 0 : p.recallConfig) || {}
  ), [o, u] = F.useState(
    ((x = rt.get("apiSettings")) == null ? void 0 : x.promptTemplates) || []
  );
  n.enabled && (i == null || i.usePreprocessing);
  const c = F.useMemo(() => o.filter((k) => k.category === "preprocessing").map((k) => ({
    id: k.id,
    name: k.name,
    description: k.userPromptTemplate.slice(0, 30).replace(/\n/g, " ") + "...",
    icon: uR
  })), [o]);
  F.useEffect(() => {
    if (!e) return;
    const k = () => {
      const T = Cd.getConfig() || f0;
      r((j) => JSON.stringify(j) !== JSON.stringify(T) ? T : j);
      const M = rt.get("apiSettings");
      if (M) {
        const j = M.recallConfig || {};
        s((z) => JSON.stringify(z) !== JSON.stringify(j) ? j : z);
        const D = M.promptTemplates || [];
        D.length !== o.length && u(D);
      }
    };
    k();
    const A = setInterval(k, 1e3);
    return () => clearInterval(A);
  }, [e, o.length]);
  const d = F.useCallback(() => {
    const k = (i == null ? void 0 : i.usePreprocessing) ?? !1, A = !k;
    ve.debug("QuickPanel", "", { from: k, to: A });
    const T = rt.get("apiSettings");
    if (T && T.recallConfig) {
      const j = { ...T.recallConfig, usePreprocessing: A };
      rt.set("apiSettings", {
        ...T,
        recallConfig: j
      });
    }
    const M = { ...n, enabled: A };
    r(M), rt.set("preprocessingConfig", M);
  }, [n, i]), m = F.useCallback((k) => {
    ve.debug("QuickPanel", "", { templateId: k });
    const A = { ...n, templateId: k, enabled: !0 };
    r(A), rt.set("preprocessingConfig", A);
    const T = rt.get("apiSettings");
    if (T && T.recallConfig && !T.recallConfig.usePreprocessing) {
      const M = { ...T.recallConfig, usePreprocessing: !0 };
      rt.set("apiSettings", {
        ...T,
        recallConfig: M
      });
    }
  }, [n]);
  return !n.templateId || c.some((k) => k.id === n.templateId), /* @__PURE__ */ g.jsx(
    TW,
    {
      isOpen: e,
      onClose: t,
      title: "Engram ",
      width: 300,
      children: /* @__PURE__ */ g.jsxs("div", { className: "space-y-3", children: [
        /* @__PURE__ */ g.jsxs(
          "div",
          {
            className: "flex items-center justify-between p-2 rounded-md",
            style: {
              backgroundColor: "var(--surface, rgba(255,255,255,0.05))",
              border: "1px solid var(--border, rgba(255,255,255,0.1))"
            },
            children: [
              /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-2", children: [
                /* @__PURE__ */ g.jsx(Ls, { size: 14, style: { color: "var(--primary, #ef7357)" } }),
                /* @__PURE__ */ g.jsx("span", { className: "text-sm font-medium", children: "" })
              ] }),
              /* @__PURE__ */ g.jsx(
                Zr,
                {
                  checked: (i == null ? void 0 : i.usePreprocessing) ?? n.enabled,
                  onChange: d
                }
              )
            ]
          }
        ),
        ((i == null ? void 0 : i.usePreprocessing) ?? n.enabled) && /* @__PURE__ */ g.jsxs(
          "div",
          {
            className: "flex items-center justify-between p-2 rounded-md",
            style: {
              backgroundColor: "var(--surface, rgba(255,255,255,0.05))",
              border: "1px solid var(--border, rgba(255,255,255,0.1))"
            },
            children: [
              /* @__PURE__ */ g.jsx("div", { className: "flex items-center gap-2 pl-2", children: /* @__PURE__ */ g.jsx("span", { className: "text-xs text-muted-foreground", children: "" }) }),
              /* @__PURE__ */ g.jsx(
                Zr,
                {
                  checked: n.preview,
                  onChange: () => {
                    const k = { ...n, preview: !n.preview };
                    r(k), Promise.resolve().then(() => RC).then(({ SettingsManager: A }) => {
                      A.set("preprocessingConfig", k);
                    });
                  }
                }
              )
            ]
          }
        ),
        ((i == null ? void 0 : i.usePreprocessing) ?? n.enabled) && /* @__PURE__ */ g.jsxs("div", { className: "space-y-2", children: [
          /* @__PURE__ */ g.jsx("div", { className: "text-xs px-1", style: { color: "var(--muted-foreground, #888)" }, children: "" }),
          c.length === 0 ? /* @__PURE__ */ g.jsxs(
            "div",
            {
              className: "flex items-start gap-2 p-2 rounded-md text-xs mt-2",
              style: {
                backgroundColor: "rgba(var(--primary-rgb, 239,115,87), 0.1)",
                border: "1px solid rgba(var(--primary-rgb, 239,115,87), 0.3)",
                color: "var(--muted-foreground, #888)"
              },
              children: [
                /* @__PURE__ */ g.jsx(qc, { size: 14, style: { color: "var(--primary, #ef7357)", flexShrink: 0, marginTop: 2 } }),
                /* @__PURE__ */ g.jsx("span", { children: " API    'preprocessing' " })
              ]
            }
          ) : /* @__PURE__ */ g.jsx("div", { className: "space-y-1", children: c.map((k) => {
            const A = k.icon, T = n.templateId === k.id;
            return /* @__PURE__ */ g.jsxs(
              "button",
              {
                onClick: () => m(k.id),
                className: "w-full flex items-center gap-3 p-2 rounded-md transition-all text-left",
                style: {
                  backgroundColor: T ? "rgba(var(--primary-rgb, 239,115,87), 0.15)" : "var(--surface, rgba(255,255,255,0.05))",
                  border: T ? "1px solid var(--primary, #ef7357)" : "1px solid var(--border, rgba(255,255,255,0.1))",
                  color: "var(--foreground, #fff)"
                },
                children: [
                  /* @__PURE__ */ g.jsx(
                    A,
                    {
                      size: 16,
                      style: {
                        color: T ? "var(--primary, #ef7357)" : "var(--muted-foreground, #888)"
                      }
                    }
                  ),
                  /* @__PURE__ */ g.jsxs("div", { className: "flex-1 min-w-0", children: [
                    /* @__PURE__ */ g.jsx("div", { className: "text-sm font-medium truncate", children: k.name }),
                    /* @__PURE__ */ g.jsx(
                      "div",
                      {
                        className: "text-xs truncate",
                        style: { color: "var(--muted-foreground, #888)" },
                        children: k.description
                      }
                    )
                  ] })
                ]
              },
              k.id
            );
          }) })
        ] }),
        /* @__PURE__ */ g.jsx(
          "div",
          {
            className: "text-xs text-center pt-2",
            style: {
              borderTop: "1px solid var(--border, rgba(255,255,255,0.1))",
              color: "var(--muted-foreground, #888)"
            },
            children: (i == null ? void 0 : i.usePreprocessing) ?? n.enabled ? (b = c.find((k) => k.id === n.templateId)) != null && b.name ? `  ${(S = c.find((k) => k.id === n.templateId)) == null ? void 0 : S.name}` : "  " : ""
          }
        )
      ] })
    }
  );
}
let N5 = !1, A5 = null;
function rD(e) {
  A5 = e;
}
function j5() {
  if (N5)
    return ve.debug("QuickPanelButton", ""), !0;
  const e = document.querySelector("#send_form");
  if (!e)
    return ve.warn("QuickPanelButton", "#send_form "), !1;
  window.getComputedStyle(e).position === "static" && (e.style.position = "relative");
  const n = document.createElement("div");
  n.id = "engram-quick-panel-trigger", n.className = "fa-solid fa-brain", n.title = "Engram ", n.style.cssText = `
        position: absolute;
        top: 0.5em;
        left: 0.5em;
        width: 1.5em;
        height: 1.5em;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.9em;
        cursor: pointer;
        color: var(--SmartThemeBodyColor, #ccc);
        opacity: 0.6;
        transition: all 0.2s ease;
        z-index: 1000;
    `;
  const r = window.getComputedStyle(e).paddingLeft, i = parseFloat(r) < 30 ? "30px" : r;
  return e.style.paddingLeft = i, n.addEventListener("mouseenter", () => {
    n.style.opacity = "1", n.style.color = "var(--SmartThemeEmColor, #fff)";
  }), n.addEventListener("mouseleave", () => {
    n.style.opacity = "0.7", n.style.color = "var(--SmartThemeBodyColor, #ccc)";
  }), n.addEventListener("click", (s) => {
    s.preventDefault(), s.stopPropagation(), ve.debug("QuickPanelButton", ""), A5 ? A5() : ve.warn("QuickPanelButton", "");
  }), e.appendChild(n), N5 = !0, ve.info("QuickPanelButton", " ()"), !0;
}
function jW() {
  if (j5())
    return;
  const e = new MutationObserver((t, n) => {
    j5() && n.disconnect();
  });
  e.observe(document.body, {
    childList: !0,
    subtree: !0
  }), setTimeout(() => {
    e.disconnect(), N5 || ve.warn("QuickPanelButton", " #send_form ");
  }, 1e4);
}
const MW = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  initQuickPanelButton: jW,
  injectQuickPanelButton: j5,
  setQuickPanelCallback: rD
}, Symbol.toStringTag, { value: "Module" }));
let RW = !1, Nv = null;
oW((e, t) => {
  const n = WM.createRoot(e);
  return n.render(yC.createElement(EW, { onClose: t })), n;
});
function OW() {
  const [e, t] = F.useState(RW);
  return F.useEffect(() => (Nv = t, () => {
    Nv = null;
  }), []), /* @__PURE__ */ g.jsxs("div", { className: "pointer-events-auto", children: [
    /* @__PURE__ */ g.jsx(kW, {}),
    /* @__PURE__ */ g.jsx(
      AW,
      {
        isOpen: e,
        onClose: () => t(!1)
      }
    )
  ] });
}
lW((e) => {
  const t = WM.createRoot(e);
  return t.render(/* @__PURE__ */ g.jsx(OW, {})), t;
});
rD(() => {
  Nv && Nv(!0);
});
document.readyState === "loading" ? document.addEventListener("DOMContentLoaded", H6) : H6();
const lm = "__ENGRAM_STATE__", F1 = {
  lastSummarizedFloor: 0,
  totalSummaries: 0,
  totalTokens: 0,
  updatedAt: Date.now()
};
class M5 {
  /**
   * 
   */
  static async loadState(t) {
    try {
      const n = await pn.findEntryByKey(t, lm);
      if (!n)
        return { ...F1 };
      try {
        const r = JSON.parse(n.content);
        return { ...F1, ...r };
      } catch (r) {
        return ve.warn("WorldBookStateService", "", r), { ...F1 };
      }
    } catch (n) {
      return ve.error("WorldBookStateService", "", n), { ...F1 };
    }
  }
  /**
   * 
   */
  static async saveState(t, n) {
    try {
      const i = {
        ...await this.loadState(t),
        ...n,
        updatedAt: Date.now()
      }, s = JSON.stringify(i, null, 2), u = (await pn.getEntries(t)).filter(
        (c) => c.name === "Engram System State" || c.keys.includes(lm)
      );
      if (u.length > 0) {
        u.sort((p, x) => {
          const b = p.keys.includes(lm) ? 1 : 0;
          return (x.keys.includes(lm) ? 1 : 0) - b;
        });
        const [c, ...d] = u;
        if (d.length > 0) {
          ve.warn("WorldBookStateService", ` ${d.length} ...`);
          for (const p of d)
            await pn.deleteEntry(t, p.uid);
        }
        ve.debug("WorldBookStateService", "", { uid: c.uid, state: i });
        const m = {
          content: s,
          name: "Engram System State",
          enabled: !1,
          constant: !1,
          keys: [lm],
          recursion: {
            prevent_incoming: !0,
            prevent_outgoing: !0
          },
          position: "before_character_definition",
          order: 0
        };
        return await pn.updateEntry(t, c.uid, m);
      } else {
        ve.debug("WorldBookStateService", "", { state: i });
        const c = {
          name: "Engram System State",
          content: s,
          keys: [lm],
          enabled: !1,
          constant: !1,
          position: "before_character_definition",
          role: "system",
          order: 0,
          recursion: {
            prevent_incoming: !0,
            prevent_outgoing: !0
          }
        };
        return await pn.createEntry(t, c);
      }
    } catch (r) {
      return ve.error("WorldBookStateService", "", r), !1;
    }
  }
}
const DW = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  WorldBookStateService: M5
}, Symbol.toStringTag, { value: "Module" })), f2 = {
  openai: "https://api.openai.com/v1/embeddings",
  ollama: "http://localhost:11434/api/embeddings",
  vllm: "http://localhost:8000/v1/embeddings",
  cohere: "https://api.cohere.ai/v1/embed",
  jina: "https://api.jina.ai/v1/embeddings",
  voyage: "https://api.voyageai.com/v1/embeddings"
}, IW = 5;
class PW {
  constructor() {
    vt(this, "config", null);
    vt(this, "concurrency", IW);
    vt(this, "stopSignal", !1);
  }
  /**
   * 
   */
  setConfig(t) {
    this.config = t;
  }
  /**
   * 
   */
  setConcurrency(t) {
    this.concurrency = Math.max(1, Math.min(20, t));
  }
  /**
   * 
   */
  stop() {
    this.stopSignal = !0;
  }
  /**
   * 
   */
  reset() {
    this.stopSignal = !1;
  }
  // ====================  ====================
  /**
   * 
   */
  async embed(t) {
    if (!this.config)
      throw new Error("EmbeddingService: config not set");
    const n = await this.embedBatch([{ id: "single", text: t }]);
    if (n[0].error)
      throw new Error(n[0].error);
    return n[0].embedding;
  }
  /**
   *  ()
   */
  async embedBatch(t, n) {
    if (!this.config)
      throw new Error("EmbeddingService: config not set");
    this.stopSignal = !1;
    const r = new Array(t.length);
    let i = 0, s = 0;
    const o = async (u) => {
      if (u >= t.length || this.stopSignal) return;
      const c = t[u];
      try {
        const d = await this.callEmbeddingAPI(c.text);
        r[u] = { id: c.id, embedding: d };
      } catch (d) {
        s++, r[u] = { id: c.id, embedding: [], error: d.message }, ve.warn("EmbeddingService", `: ${c.id}`, { error: d.message });
      } finally {
        i++, n == null || n(i, t.length, s);
      }
    };
    for (let u = 0; u < t.length && !this.stopSignal; u += this.concurrency) {
      const c = Array.from(
        { length: Math.min(this.concurrency, t.length - u) },
        (d, m) => o(u + m)
      );
      await Promise.all(c);
    }
    return r;
  }
  /**
   *  API
   */
  async callEmbeddingAPI(t) {
    const n = this.config;
    switch (n.source) {
      case "openai":
      case "custom":
      case "vllm":
      case "jina":
      case "voyage":
        return this.callOpenAICompatible(t, n);
      case "ollama":
        return this.callOllama(t, n);
      case "cohere":
        return this.callCohere(t, n);
      case "transformers":
        return this.callTransformers(t, n);
      default:
        throw new Error(`Unsupported vector source: ${n.source}`);
    }
  }
  /**
   * OpenAI  API 
   */
  async callOpenAICompatible(t, n) {
    let r = n.apiUrl || f2[n.source] || "";
    if ((n.source === "custom" || n.source === "openai") && r) {
      const o = r.replace(/\/+$/, "");
      !o.endsWith("embeddings") && !o.endsWith("embed") && (o.endsWith("/v1") ? r = `${o}/embeddings` : r = `${o}/v1/embeddings`, ve.debug("EmbeddingService", ` API URL: ${n.apiUrl} -> ${r}`));
    }
    if (!r)
      throw new Error("API endpoint not configured");
    const i = {
      "Content-Type": "application/json"
    };
    n.apiKey && (i.Authorization = `Bearer ${n.apiKey}`);
    const s = {
      model: n.model || "text-embedding-3-small",
      input: t
    };
    n.dimensions && (s.dimensions = n.dimensions);
    try {
      const o = await fetch(r, {
        method: "POST",
        headers: i,
        body: JSON.stringify(s)
      });
      if (!o.ok) {
        const c = await o.text();
        throw new Error(`API error ${o.status} at ${r}: ${c}`);
      }
      const u = await o.json();
      if (!u.data || u.data.length === 0)
        throw new Error("No embedding data returned");
      return u.data[0].embedding;
    } catch (o) {
      throw o.message.includes("at http") ? o : new Error(`Request to ${r} failed: ${o.message}`);
    }
  }
  /**
   * Ollama API 
   */
  async callOllama(t, n) {
    const r = n.apiUrl || f2.ollama, i = r.includes("/api/embed") && !r.includes("/api/embeddings"), s = {
      model: n.model || "nomic-embed-text"
    };
    i ? s.input = t : s.prompt = t;
    const o = await fetch(r, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(s)
    });
    if (!o.ok) {
      const c = await o.text();
      throw new Error(`Ollama error ${o.status}: ${c}`);
    }
    const u = await o.json();
    if (u.embedding)
      return u.embedding;
    if (u.embeddings && u.embeddings.length > 0)
      return u.embeddings[0];
    throw new Error(`No embedding data returned in Ollama response. Keys: ${Object.keys(u).join(", ")}`);
  }
  /**
   * Cohere API 
   */
  async callCohere(t, n) {
    const r = f2.cohere, i = await fetch(r, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        Authorization: `Bearer ${n.apiKey}`
      },
      body: JSON.stringify({
        model: n.model || "embed-multilingual-v3.0",
        texts: [t],
        input_type: "search_document"
      })
    });
    if (!i.ok) {
      const o = await i.text();
      throw new Error(`Cohere error ${i.status}: ${o}`);
    }
    const s = await i.json();
    if (!s.embeddings || s.embeddings.length === 0)
      throw new Error("No embedding data returned");
    return s.embeddings[0];
  }
  /**
   *  Transformers  ()
   */
  async callTransformers(t, n) {
    throw new Error("Transformers embedding not yet implemented");
  }
  // ==================== EventNode  ====================
  /**
   *  EventNode 
   * @param onProgress 
   * @returns 
   */
  async embedUnprocessedEvents(t) {
    const n = xi();
    if (!n)
      throw new Error("No current chat");
    const r = Al(n), i = await r.events.filter((d) => !d.is_embedded && !d.embedding).toArray();
    if (i.length === 0)
      return { success: 0, failed: 0 };
    ve.info("EmbeddingService", ` ${i.length} `);
    const s = i.map((d) => ({
      id: d.id,
      text: d.summary
    })), o = await this.embedBatch(s, t);
    let u = 0, c = 0;
    for (const d of o) {
      if (d.error || d.embedding.length === 0) {
        c++;
        continue;
      }
      await r.events.update(d.id, {
        embedding: d.embedding,
        is_embedded: !0
      }), u++;
    }
    return ve.info("EmbeddingService", `: ${u} , ${c} `), { success: u, failed: c };
  }
  /**
   * 
   */
  async embedEvents(t, n) {
    if (t.length === 0)
      return { success: 0, failed: 0 };
    const r = xi();
    if (!r) throw new Error("No current chat");
    const i = Al(r), s = t.map((d) => ({
      id: d.id,
      text: d.summary
    })), o = await this.embedBatch(s, n);
    let u = 0, c = 0;
    for (const d of o) {
      if (d.error || d.embedding.length === 0) {
        c++;
        continue;
      }
      await i.events.update(d.id, {
        embedding: d.embedding,
        is_embedded: !0
      }), u++;
    }
    return { success: u, failed: c };
  }
  /**
   *  EventNode 
   */
  async embedEvent(t) {
    const n = await this.embed(t.summary), r = xi();
    if (r) {
      const i = Lc(r);
      i && await i.events.update(t.id, {
        embedding: n,
        is_embedded: !0
      });
    }
    return n;
  }
  /**
   *  ()
   */
  async reembedAllEvents(t) {
    const n = xi();
    if (!n)
      throw new Error("No current chat");
    const r = Al(n), i = await r.events.toArray();
    if (i.length === 0)
      return { success: 0, failed: 0 };
    ve.info("EmbeddingService", ` ${i.length} `);
    for (const s of i)
      await r.events.update(s.id, {
        embedding: void 0,
        is_embedded: !1
      });
    return this.embedUnprocessedEvents(t);
  }
  // ====================  ====================
  /**
   * 
   */
  cosineSimilarity(t, n) {
    if (!t || !n || t.length !== n.length) return 0;
    let r = 0, i = 0, s = 0;
    for (let u = 0; u < t.length; u++)
      r += t[u] * n[u], i += t[u] * t[u], s += n[u] * n[u];
    const o = Math.sqrt(i) * Math.sqrt(s);
    return o === 0 ? 0 : r / o;
  }
  /**
   * 
   */
  async getEmbeddingStats() {
    const t = xi();
    if (!t)
      return { total: 0, embedded: 0, pending: 0 };
    const n = Lc(t);
    if (!n)
      return { total: 0, embedded: 0, pending: 0 };
    const r = await n.events.toArray(), i = r.filter((s) => s.is_embedded).length;
    return {
      total: r.length,
      embedded: i,
      pending: r.length - i
    };
  }
}
const Qr = new PW(), vd = class vd {
  constructor() {
  }
  static getInstance() {
    return vd.instance || (vd.instance = new vd()), vd.instance;
  }
  /**
   *  Rerank 
   */
  getConfig() {
    const t = rt.get("apiSettings");
    return (t == null ? void 0 : t.rerankConfig) || null;
  }
  /**
   *  Rerank 
   */
  isEnabled() {
    const t = this.getConfig();
    return !!(t != null && t.enabled && t.url && t.model);
  }
  /**
   *  Rerank API 
   *
   * @param query 
   * @param documents 
   * @returns 
   */
  async rerank(t, n) {
    var i;
    const r = this.getConfig();
    if (!(r != null && r.enabled))
      return ve.debug("RerankService", "Rerank "), n.map((s, o) => ({ index: o, relevance_score: 0 }));
    if (!r.url || !r.model)
      return ve.warn("RerankService", "Rerank ", { url: r.url, model: r.model }), n.map((s, o) => ({ index: o, relevance_score: 0 }));
    if (n.length === 0)
      return [];
    try {
      const s = r.url.endsWith("/rerank") ? r.url : `${r.url.replace(/\/$/, "")}/rerank`;
      ve.debug("RerankService", " Rerank API", {
        endpoint: s,
        model: r.model,
        queryLength: t.length,
        documentCount: n.length
      });
      const o = await fetch(s, {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          ...r.apiKey && {
            Authorization: `Bearer ${r.apiKey}`
          }
        },
        body: JSON.stringify({
          model: r.model,
          query: t,
          documents: n,
          top_n: r.topN || 5
        })
      });
      if (!o.ok) {
        const d = await o.text();
        throw new Error(`Rerank API  (${o.status}): ${d}`);
      }
      const u = await o.json(), c = u.results || u.data || [];
      return ve.info("RerankService", "Rerank ", {
        resultCount: c.length,
        topScore: (i = c[0]) == null ? void 0 : i.relevance_score
      }), c.sort((d, m) => m.relevance_score - d.relevance_score);
    } catch (s) {
      const o = s instanceof Error ? s.message : "";
      return ve.error("RerankService", "Rerank ", { error: o }), n.map((u, c) => ({ index: c, relevance_score: 0 }));
    }
  }
  /**
   *  (alpha)
   * 0 = 1 =  Rerank 
   */
  getHybridAlpha() {
    const t = this.getConfig();
    return (t == null ? void 0 : t.hybridAlpha) ?? 0.5;
  }
};
vt(vd, "instance");
let R5 = vd;
const d2 = R5.getInstance();
function zW(e, t, n) {
  return e == null && t == null ? 0 : e == null ? t ?? 0 : t == null ? e : (1 - n) * e + n * t;
}
function O5(e, t) {
  var r;
  const n = e.map((i) => ({
    ...i,
    hybridScore: zW(
      i.embeddingScore,
      i.rerankScore,
      t
    )
  }));
  return n.sort((i, s) => (s.hybridScore ?? 0) - (i.hybridScore ?? 0)), ve.debug("HybridScorer", "", {
    candidateCount: n.length,
    topScore: (r = n[0]) == null ? void 0 : r.hybridScore,
    alpha: t
  }), n;
}
function LW(e, t, n, r) {
  for (const s of t) {
    const o = n[s.index];
    if (o && e.has(o.id)) {
      const u = e.get(o.id);
      u.rerankScore = s.relevance_score;
    }
  }
  const i = Array.from(e.values());
  return O5(i, r);
}
function BW(e, t, n) {
  if (!n.enabled)
    return e;
  const r = e.map((i) => {
    const s = t.getStickyPenalty(i.id, n), u = (i.hybridScore ?? i.embeddingScore ?? 0) * (1 - s);
    return {
      ...i,
      hybridScore: u,
      stickyPenalty: s,
      isSticky: s > 0
    };
  });
  return r.sort((i, s) => (s.hybridScore ?? 0) - (i.hybridScore ?? 0)), ve.debug("HybridScorer", "", {
    totalCandidates: e.length,
    stickyCount: r.filter((i) => i.isSticky).length,
    maxPenalty: Math.max(...r.map((i) => i.stickyPenalty ?? 0))
  }), r;
}
class qW {
  constructor() {
    vt(this, "logs", []);
    vt(this, "maxLogs", 50);
    vt(this, "subscribers", /* @__PURE__ */ new Set());
  }
  /**
   * 
   */
  log(t) {
    const n = {
      id: `recall-${Date.now()}-${Math.random().toString(36).slice(2, 8)}`,
      timestamp: Date.now(),
      ...t
    };
    this.logs.unshift(n), this.logs.length > this.maxLogs && (this.logs = this.logs.slice(0, this.maxLogs)), ve.debug("RecallLogService", "", {
      query: t.query.substring(0, 50),
      resultCount: t.results.length
    }), this.notifySubscribers();
  }
  /**
   * 
   */
  getLogs() {
    return [...this.logs];
  }
  /**
   * 
   */
  clear() {
    this.logs = [], this.notifySubscribers();
  }
  /**
   * 
   */
  subscribe(t) {
    return this.subscribers.add(t), () => this.subscribers.delete(t);
  }
  /**
   * 
   */
  notifySubscribers() {
    const t = this.getLogs();
    this.subscribers.forEach((n) => n(t));
  }
  /**
   *  JSON 
   */
  exportLogs() {
    const { VERSION: t } = require("@/constants"), n = {
      version: t,
      exportedAt: Date.now(),
      logs: this.getLogs()
    }, r = new Blob([JSON.stringify(n, null, 2)], { type: "application/json" }), i = URL.createObjectURL(r), s = document.createElement("a");
    s.href = i, s.download = `engram_debug_log_${(/* @__PURE__ */ new Date()).toISOString().replace(/[:.]/g, "-")}.json`, document.body.appendChild(s), s.click(), document.body.removeChild(s), URL.revokeObjectURL(i);
  }
}
const sv = new qW();
class FW {
  /**
   * 
   */
  getRecallConfig() {
    const t = rt.get("apiSettings");
    return (t == null ? void 0 : t.recallConfig) || A0;
  }
  /**
   * 
   * 
   */
  async hasVectorizedNodes() {
    const t = xi();
    if (!t) return !1;
    const n = Lc(t);
    return n ? await n.events.filter((i) => !!i.embedding && i.embedding.length > 0).limit(1).count() > 0 : !1;
  }
  /**
   * 
   */
  getVectorConfig() {
    const t = rt.get("apiSettings");
    return t == null ? void 0 : t.vectorConfig;
  }
  /**
   *  Rerank 
   */
  getRerankConfig() {
    const t = rt.get("apiSettings");
    return (t == null ? void 0 : t.rerankConfig) || null;
  }
  /**
   * 
   *
   * @param userInput 
   * @param unifiedQueries  ()
   * @returns 
   */
  async search(t, n) {
    const r = this.getRecallConfig(), i = this.getVectorConfig();
    if (r.useEmbedding && i && Qr.setConfig(i), kg.nextRound(), !r.enabled) {
      ve.debug("Retriever", "");
      const s = (i == null ? void 0 : i.topK) || 20;
      return this.rollingSearch(s);
    }
    if (r.useBruteForce) {
      ve.debug("Retriever", " ()");
      const s = (i == null ? void 0 : i.topK) || 20;
      return this.rollingSearch(s);
    }
    return r.useEmbedding ? this.hybridSearch(t, n, r) : this.rollingSearch(config.embedding.topK);
  }
  /**
   * Embedding + Rerank
   */
  async hybridSearch(t, n, r) {
    const i = Date.now(), s = Date.now(), o = await this.doEmbeddingSearch(
      t,
      n,
      r
    ), u = Date.now() - s;
    if (o.length === 0)
      return ve.debug("Retriever", "Embedding "), { entries: [], nodes: [] };
    let c = o, d = 0;
    if (r.useRerank && d2.isEnabled()) {
      const k = Date.now(), A = (n == null ? void 0 : n[0]) || t, T = o.map((z) => z.summary), M = await d2.rerank(A, T);
      d = Date.now() - k;
      const j = new Map(o.map((z) => [z.id, z])), D = d2.getHybridAlpha();
      c = LW(
        j,
        M,
        o,
        D
      ), ve.info("Retriever", "", {
        embeddingCount: o.length,
        rerankCount: M.length,
        finalCount: c.length,
        embeddingTime: u,
        rerankTime: d
      });
    } else
      c = O5(o, 0);
    const m = r.sticky || _R;
    m.enabled && (c = BW(c, kg, m), ve.debug("Retriever", "", {
      candidatesWithPenalty: c.filter((k) => (k.stickyPenalty || 0) > 0).length
    }));
    const p = Date.now() - i;
    sv.log({
      query: t,
      preprocessedQuery: n == null ? void 0 : n[0],
      mode: "hybrid",
      results: c.map((k) => {
        var A, T, M, j;
        return {
          eventId: k.id,
          summary: k.summary,
          category: ((T = (A = k.node) == null ? void 0 : A.structured_kv) == null ? void 0 : T.event) || "unknown",
          embeddingScore: k.embeddingScore || 0,
          rerankScore: k.rerankScore,
          hybridScore: k.hybridScore,
          isTopK: !0,
          isReranked: k.rerankScore != null,
          sourceFloor: (j = (M = k.node) == null ? void 0 : M.source_range) == null ? void 0 : j.start_index
        };
      }),
      stats: {
        totalCandidates: o.length,
        topKCount: o.length,
        rerankCount: c.length,
        latencyMs: p
      }
    });
    const x = c.map((k) => k.id);
    kg.markRecalledBatch(x), kg.cleanup(10);
    const b = c.filter((k) => k.node).map((k) => k.node), S = c.map((k) => k.summary);
    return ve.info("Retriever", "", {
      useEmbedding: r.useEmbedding,
      useRerank: r.useRerank,
      totalTime: p,
      resultCount: b.length,
      stickyRound: kg.getCurrentRound()
    }), { entries: S, nodes: b };
  }
  /**
   *  Embedding  ()
   */
  async embeddingOnlySearch(t, n, r) {
    const i = await this.doEmbeddingSearch(t, n, r), s = O5(i, 0), o = s.filter((c) => c.node).map((c) => c.node);
    return { entries: s.map((c) => c.summary), nodes: o };
  }
  /**
   *  Embedding 
   */
  async doEmbeddingSearch(t, n, r) {
    var p, x;
    const i = xi();
    if (!i)
      return [];
    const s = Lc(i);
    if (!s)
      return [];
    const o = await s.events.filter((b) => !!b.embedding && b.embedding.length > 0).toArray();
    if (o.length === 0)
      return ve.debug("Retriever", ""), [];
    const u = n && n.length > 0 ? n : [t];
    ve.debug("Retriever", "", {
      queryCount: u.length,
      eventCount: o.length
    });
    const c = /* @__PURE__ */ new Map();
    for (const b of u)
      try {
        const S = await Qr.embed(b);
        for (const k of o) {
          if (!k.embedding) continue;
          const A = Qr.cosineSimilarity(
            S,
            k.embedding
          ), T = ((p = r.embedding) == null ? void 0 : p.minScoreThreshold) ?? 0.3;
          if (A < T) continue;
          const M = c.get(k.id);
          (!M || A > (M.embeddingScore || 0)) && c.set(k.id, {
            id: k.id,
            summary: k.summary,
            embeddingScore: A,
            node: k
          });
        }
      } catch (S) {
        ve.error("Retriever", `Query : ${b}`, {
          message: (S == null ? void 0 : S.message) || S,
          stack: S == null ? void 0 : S.stack
        });
      }
    const d = this.getVectorConfig(), m = Array.from(c.values()).sort((b, S) => (S.embeddingScore || 0) - (b.embeddingScore || 0)).slice(0, (d == null ? void 0 : d.topK) || 20);
    return ve.debug("Retriever", "Embedding ", {
      totalMatched: c.size,
      topK: m.length,
      topScore: (x = m[0]) == null ? void 0 : x.embeddingScore
    }), m;
  }
  /**
   *  ()
   * 
   */
  async rollingSearch(t) {
    const n = xi();
    if (!n)
      return { entries: [], nodes: [] };
    const r = Lc(n);
    if (!r)
      return { entries: [], nodes: [] };
    const i = await r.events.filter((c) => c.level === 0).reverse().limit(t).toArray(), s = await r.events.filter((c) => c.level === 1).reverse().first(), o = [...i];
    return s && o.unshift(s), { entries: o.map((c) => c.summary), nodes: o };
  }
  /**
   * @deprecated  search() 
   */
  async vectorSearch(t, n) {
    return this.search(t);
  }
}
const J6 = new FW();
class iD {
  constructor() {
    vt(this, "isInitialized", !1);
    vt(this, "isProcessing", !1);
  }
  // 
  /**
   * Initialize the Injector
   */
  init() {
    this.isInitialized || (ve.info("Injector", " V0.8 ..."), console.log("[Injector] Starting initialization..."), Is.on(
      Eo.GENERATION_AFTER_COMMANDS,
      async (t, n, r) => {
        console.log("[Injector]  GENERATION_AFTER_COMMANDS triggered", { type: t, dryRun: r }), ve.info("Injector", "  GENERATION_AFTER_COMMANDS ", { type: t, dryRun: r }), await this.handleGenerationAfterCommands(t, n, r);
      }
    ), Is.on(Eo.CHAT_CHANGED, () => {
      ve.debug("Injector", " CHAT_CHANGED "), this.isProcessing = !1, ko.refreshCache().catch((t) => {
        ve.warn("Injector", "", t);
      });
    }), this.isInitialized = !0, ve.success("Injector", "V0.8 Injector "), console.log("[Injector]  V0.8 Initialized - Listening for GENERATION_AFTER_COMMANDS"));
  }
  /**
   *  GENERATION_AFTER_COMMANDS 
   *  async  await
   */
  async handleGenerationAfterCommands(t, n, r) {
    try {
      if (r) {
        ve.debug("Injector", "dryRun ");
        return;
      }
      if (t === "regenerate" || t === "swipe" || t === "quiet" || t === "impersonate") {
        ve.debug("Injector", ` ${t} `);
        return;
      }
      if (n._engram_processed) {
        ve.debug("Injector", "");
        return;
      }
      if (this.isProcessing) {
        ve.debug("Injector", "");
        return;
      }
      const i = xi();
      if (!i) {
        ve.warn("Injector", " ID");
        return;
      }
      const s = Mo();
      if (!s || !s.chat || s.chat.length === 0) {
        ve.warn("Injector", "");
        return;
      }
      const o = s.chat, u = o.length - 1, c = o[u];
      let d = "", m = "chat";
      if (c && c.is_user)
        d = c.mes;
      else {
        const A = document.getElementById("send_textarea");
        if (A && A.value && A.value.trim().length > 0)
          d = A.value, m = "textarea", ve.info("Injector", " Textarea  (Strategy 2)", {
            preview: d.substring(0, 50)
          });
        else {
          ve.debug("Injector", "", {
            index: u,
            isUser: c == null ? void 0 : c.is_user
          });
          return;
        }
      }
      if (!d || d.trim().length === 0) {
        ve.debug("Injector", "");
        return;
      }
      ve.debug("Injector", "...");
      let p, x, b;
      try {
        if (p = rt.get("apiSettings"), ve.debug("Injector", " apiSettings"), x = (p == null ? void 0 : p.recallConfig) || A0, ve.debug("Injector", " recallConfig", x), !Cd)
          throw new Error("Preprocessor service is undefined");
        b = Cd.getConfig(), ve.debug("Injector", " preprocessorConfig", b);
      } catch (A) {
        throw ve.error("Injector", "", A), A;
      }
      if (ve.info("Injector", "", {
        chatId: i,
        userInputLength: d.length,
        userInputPreview: d.substring(0, 50) + "...",
        recallEnabled: x.enabled,
        preprocessingEnabled: x.usePreprocessing && b.enabled,
        autoTrigger: b.autoTrigger,
        templateId: b.templateId
      }), x.usePreprocessing && b.enabled && !b.autoTrigger && (ve.debug("Injector", " autoTrigger "), !x.enabled))
        return;
      this.isProcessing = !0, n._engram_processed = !0, c && (c._engram_processed = !0), ve.info("Injector", " ...");
      let S = d, k = [];
      try {
        if (x.usePreprocessing && b.enabled && b.autoTrigger)
          try {
            ko.setUserInput(d), await ko.refreshCache();
            const A = await Cd.process(d);
            if (A.success && A.output) {
              ve.success("Injector", " ", {
                outputLength: A.output.length,
                hasQuery: !!A.query
              });
              const T = rt.getPromptTemplateById(b.templateId), M = (T == null ? void 0 : T.injectionMode) || "replace";
              M === "append" ? S = `${d}

${A.output}` : M === "prepend" ? S = `${A.output}

${d}` : S = A.output, A.query && k.push(A.query);
            } else
              ve.warn("Injector", "");
          } catch (A) {
            ve.warn("Injector", " ", A);
          }
        if (x.enabled)
          try {
            if (!await J6.hasVectorizedNodes())
              ve.info("Injector", " RAG ");
            else {
              ve.info("Injector", "  RAG ", {
                queryCount: k.length,
                firstQuery: k[0] || d.substring(0, 50)
              });
              const T = await J6.search(
                d,
                k.length > 0 ? k : void 0
              );
              T.nodes.length > 0 ? (ve.info("Injector", " RAG ", {
                nodeCount: T.nodes.length,
                entries: T.entries.length
              }), await ko.refreshCacheWithNodes(T.nodes)) : ve.debug("Injector", "RAG ");
            }
          } catch (A) {
            ve.error("Injector", "RAG ", A);
          }
        if (S = Ps.process(S, "output"), S !== d) {
          if (m === "chat") {
            c.mes = S;
            try {
              const A = s.eventSource, T = s.event_types;
              A && (T != null && T.MESSAGE_UPDATED) && (A.emit(T.MESSAGE_UPDATED, u), ve.debug("Injector", " MESSAGE_UPDATED "));
            } catch (A) {
              ve.warn("Injector", " MESSAGE_UPDATED ", A);
            }
            try {
              const A = document.getElementById("send_textarea");
              A && A.value === d && (A.value = "", A.dispatchEvent(new Event("input", { bubbles: !0 })));
            } catch {
            }
          } else if (m === "textarea") {
            ve.info("Injector", " Textarea (Strategy 2)");
            try {
              const A = document.getElementById("send_textarea");
              A && (A.value = S, A.dispatchEvent(new Event("input", { bubbles: !0 }))), n && (n.prompt = S);
            } catch (A) {
              ve.warn("Injector", " Textarea ", A);
            }
          }
        }
      } finally {
        setTimeout(() => {
          this.isProcessing = !1;
        }, 1e3);
      }
    } catch (i) {
      this.isProcessing = !1, ve.error("Injector", "handleGenerationAfterCommands ", {
        message: (i == null ? void 0 : i.message) || i,
        stack: i == null ? void 0 : i.stack
      }), console.error("[Injector] Error:", i);
    }
  }
}
const UW = new iD(), $W = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  Injector: iD,
  injector: UW
}, Symbol.toStringTag, { value: "Module" }));
class aD {
  static init() {
    if (!this.isInitialized)
      try {
        const t = Mo();
        if (!(t != null && t.eventSource) || !(t != null && t.event_types)) {
          ve.warn("CharacterDeleteService", "");
          return;
        }
        t.event_types.CHARACTER_DELETED && (t.eventSource.on(t.event_types.CHARACTER_DELETED, this.onCharacterDeleted.bind(this)), ve.info("CharacterDeleteService", " CHARACTER_DELETED ")), t.event_types.CHAT_DELETED && (t.eventSource.on(t.event_types.CHAT_DELETED, this.onChatDeleted.bind(this)), ve.info("CharacterDeleteService", " CHAT_DELETED ")), t.event_types.GROUP_CHAT_DELETED && (t.eventSource.on(t.event_types.GROUP_CHAT_DELETED, this.onChatDeleted.bind(this)), ve.info("CharacterDeleteService", " GROUP_CHAT_DELETED ")), this.isInitialized = !0;
      } catch (t) {
        ve.error("CharacterDeleteService", "", t);
      }
  }
  /**
   * 
   */
  static async onCharacterDeleted(t) {
    var s;
    const n = rt.getSettings().linkedDeletion;
    if (!(n != null && n.enabled) || !(n != null && n.deleteWorldbook)) return;
    ve.debug("CharacterDeleteService", "", t);
    const r = t.character, i = (r == null ? void 0 : r.name) || (r == null ? void 0 : r.avatar) || (r == null ? void 0 : r.ch_name) || ((s = r == null ? void 0 : r.data) == null ? void 0 : s.name);
    if (!i) {
      ve.warn("CharacterDeleteService", "");
      return;
    }
    await this.deleteEngramWorldbooks(i, "", n.showConfirmation);
  }
  /**
   * 
   * @param chatId  ID "CharName - 2024-1-1@12h30m" 
   */
  static async onChatDeleted(t) {
    const n = rt.getSettings().linkedDeletion;
    if (!(n != null && n.enabled)) return;
    ve.debug("CharacterDeleteService", "", t);
    try {
      const { deleteDatabase: i, hasDbForChat: s } = await Promise.resolve().then(() => cU);
      s(t) && (await i(t), ve.info("CharacterDeleteService", ` IndexedDB: Engram_${t}`), tn.info(" Engram ", "Engram"));
    } catch (i) {
      ve.error("CharacterDeleteService", `: Engram_${t}`, i);
    }
    if (!n.deleteChatWorldbook) return;
    const r = this.extractCharacterNameFromChatId(t);
    if (!r) {
      ve.debug("CharacterDeleteService", ` chatId : ${t}`);
      return;
    }
    await this.deleteEngramWorldbooks(r, "", n.showConfirmation);
  }
  /**
   *  chatId 
   */
  static extractCharacterNameFromChatId(t) {
    if (!t) return null;
    let n = t.match(/^(.+?)\s*-\s*\d{4}/);
    return n || (n = t.match(/^(.+?)_\d{4}/), n) ? n[1].trim() : null;
  }
  /**
   *  Engram 
   */
  static async deleteEngramWorldbooks(t, n, r) {
    const i = /* @__PURE__ */ new Set();
    i.add(`[Engram] ${t}`), i.add(`Engram_${t}`);
    const s = await pn.getWorldbookNames(), o = new Set(s), u = Array.from(i).filter((m) => {
      if (!o.has(m)) return !1;
      const p = m.toLowerCase().includes("engram");
      return p || ve.info("CharacterDeleteService", ` Engram : ${m}`), p;
    });
    if (u.length === 0) {
      ve.debug("CharacterDeleteService", ` "${t}"  Engram `);
      return;
    }
    if (ve.info("CharacterDeleteService", `: ${u.join(", ")}`), r) {
      const m = `
                <div style="font-size: 0.9em;">
                    <h3> Engram </h3>
                    <p>${n} <b>${t}</b> </p>
                    <p> Engram </p>
                    <ul style="max-height: 100px; overflow-y: auto; background: var(--black50a); padding: 5px; border-radius: 4px; list-style: none; margin: 10px 0;">
                        ${u.map((x) => `<li style="padding: 2px 0;"> ${x}</li>`).join("")}
                    </ul>
                    <p></p>
                    <small style="opacity: 0.7;"></small>
                </div>
            `;
      if (!await dW(m, "confirm")) {
        ve.info("CharacterDeleteService", "");
        return;
      }
    }
    let c = 0;
    const d = [];
    tn.info(" Engram ...", "Engram");
    for (const m of u)
      try {
        await pn.deleteWorldbook(m) ? (c++, ve.info("CharacterDeleteService", `: ${m}`)) : d.push(m);
      } catch (p) {
        ve.error("CharacterDeleteService", ` ${m} `, p), d.push(m);
      }
    c > 0 && tn.success(` ${c} `, "Engram"), d.length > 0 && tn.warning(`: ${d.join(", ")}`, "Engram");
  }
}
vt(aD, "isInitialized", !1);
const VW = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  CharacterDeleteService: aD
}, Symbol.toStringTag, { value: "Module" }));
class sD {
  constructor(t) {
    vt(this, "config");
    vt(this, "isExtracting", !1);
    this.config = { ...AC, ...t };
  }
  /**
   * 
   */
  updateConfig(t) {
    this.config = { ...this.config, ...t };
  }
  /**
   * 
   */
  getConfig() {
    return { ...this.config };
  }
  /**
   * 
   * V0.9.1:  SummarizerService 
   */
  shouldTriggerOnFloor(t) {
    return !this.config.enabled || this.config.trigger !== "floor" ? !1 : t > 0 && t % this.config.floorInterval === 0;
  }
  /**
   * 
   * V0.9.1:  chatHistory  engramGraph
   *
   * @param chatHistory 
   * @param floor 
   * @param manual 
   */
  async extractFromChat(t, n, r = !1) {
    var i, s;
    if (this.isExtracting)
      return ve.warn("EntityBuilder", ""), null;
    this.isExtracting = !0, ve.info("EntityBuilder", ` ( ${n})`);
    try {
      const u = await da.getState().getAllEntities(), c = u.map((j) => ({
        name: j.name,
        type: j.type,
        aliases: j.aliases || []
      })), m = (((i = rt.get("apiSettings")) == null ? void 0 : i.promptTemplates) || []).find((j) => j.category === "entity_extraction" && j.enabled), p = (m == null ? void 0 : m.systemPrompt) || wR, b = ((m == null ? void 0 : m.userPromptTemplate) || `

****:
{{chatHistory}}

****:
{{existingEntities}}

---
 JSON `).replace("{{chatHistory}}", t).replace("{{existingEntities}}", JSON.stringify(c, null, 2)).replace("{{worldbookContext}}", ko.cachedWorldbookContext || ""), S = ua.logSend({
        type: "entity_extraction",
        systemPrompt: p,
        userPrompt: b,
        floorRange: [n, n],
        // 
        model: j0(),
        character: (s = jd()) == null ? void 0 : s.name
      }), k = Date.now(), A = await Rd.generate({
        systemPrompt: p,
        userPrompt: b
      });
      if (ua.logReceive(S, {
        response: A.content,
        status: A.success ? "success" : "error",
        error: A.error,
        duration: Date.now() - k
      }), !A.success || !A.content)
        return ve.error("EntityBuilder", "LLM ", { error: A.error }), r && tn.error("LLM ", "Engram"), { success: !1, newEntities: [], updatedEntities: [], error: A.error };
      const T = ZC.parse(A.content);
      if (!T || !T.entities)
        return ve.error("EntityBuilder", "JSON "), r && tn.error("", "Engram"), { success: !1, newEntities: [], updatedEntities: [], error: "JSON parse failed" };
      const M = await this.saveEntities(T, u);
      return await Sd.updateState({ last_extracted_floor: n }), ve.success("EntityBuilder", "", {
        floor: n,
        newCount: M.newEntities.length,
        updatedCount: M.updatedEntities.length,
        duration: Date.now() - k
      }), r && tn.success(
        ` ${M.newEntities.length} `,
        "Engram"
      ), M;
    } catch (o) {
      const u = o instanceof Error ? o.message : String(o);
      return ve.error("EntityBuilder", "", { error: u }), r && tn.error(`: ${u}`, "Engram "), { success: !1, newEntities: [], updatedEntities: [], error: u };
    } finally {
      this.isExtracting = !1;
    }
  }
  /**
   * 
   */
  async extractManual() {
    const t = await ko.getChatHistory("50"), n = await Sd.getState();
    return this.extractFromChat(t, n.last_summarized_floor, !0);
  }
  /**
   * 
   * V0.9.4:  profile 
   */
  async saveEntities(t, n) {
    var o, u;
    const r = da.getState(), i = [], s = [];
    for (const c of t.entities) {
      const d = this.resolveEntity(c.name, c.aliases, n), m = this.profileToYaml(c.name, c.type, c.profile);
      if (d) {
        const p = {
          ...d.profile,
          ...c.profile
        };
        if (Array.isArray((o = c.profile) == null ? void 0 : o.relations)) {
          const S = ((u = d.profile) == null ? void 0 : u.relations) || [], k = c.profile.relations, A = new Map(S.map((T) => [T.target, T]));
          for (const T of k)
            A.set(T.target, T);
          p.relations = Array.from(A.values());
        }
        const x = {
          description: this.profileToYaml(d.name, d.type, p),
          profile: p
        }, b = /* @__PURE__ */ new Set([...d.aliases || [], ...c.aliases]);
        x.aliases = Array.from(b), await r.updateEntity(d.id, x), s.push({ ...d, ...x });
      } else {
        const p = {
          char: fd.Character,
          loc: fd.Location,
          item: fd.Item,
          concept: fd.Concept,
          unknown: fd.Unknown
        }, x = await r.saveEntity({
          name: c.name,
          type: p[c.type] || fd.Unknown,
          description: m,
          aliases: c.aliases || [],
          profile: c.profile || {}
        });
        i.push(x);
      }
    }
    return {
      success: !0,
      newEntities: i,
      updatedEntities: s
    };
  }
  /**
   *  profile  YAML  (For Model)
   * V0.9.4: 
   */
  profileToYaml(t, n, r) {
    const i = [`${t} (${n})`];
    for (const [s, o] of Object.entries(r))
      if (s === "relations" && Array.isArray(o)) {
        i.push(":");
        for (const u of o) {
          const c = u.description ? ` - ${u.description}` : "";
          i.push(`  - ${u.target}: ${u.type}${c}`);
        }
      } else typeof o == "string" ? i.push(`${s}: ${o}`) : Array.isArray(o) && i.push(`${s}: ${o.join(", ")}`);
    return i.join(`
`);
  }
  /**
   * 
   */
  resolveEntity(t, n, r) {
    const i = r.find((o) => o.name === t);
    if (i) return i;
    const s = r.find((o) => {
      var u;
      return (u = o.aliases) == null ? void 0 : u.includes(t);
    });
    if (s) return s;
    for (const o of n) {
      const u = r.find(
        (c) => {
          var d;
          return c.name === o || ((d = c.aliases) == null ? void 0 : d.includes(o));
        }
      );
      if (u) return u;
    }
    return null;
  }
  /**
   *  (UI )
   * V0.9.1: 
   */
  async getStatus() {
    const n = await da.getState().getAllEntities(), r = await Sd.getState();
    return {
      enabled: this.config.enabled,
      trigger: this.config.trigger,
      floorInterval: this.config.floorInterval,
      lastExtractedFloor: r.last_extracted_floor,
      entityCount: n.length,
      isExtracting: this.isExtracting
    };
  }
}
const yu = new sD(), HW = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  EntityBuilder: sD,
  entityBuilder: yu
}, Symbol.toStringTag, { value: "Module" })), e8 = "engram_macro_slot", t8 = "Engram Memory Context";
class oD {
  /**
   *  WorldBook 
   * 
   */
  static async init() {
    if (!this.isInitialized)
      try {
        const t = await pn.getOrCreateWorldbook();
        if (!t) {
          ve.warn("WorldBookSlotService", "");
          return;
        }
        const n = await pn.findEntryByKey(t, e8);
        if (n) {
          ve.debug("WorldBookSlotService", "", {
            uid: n.uid,
            name: n.name
          }), this.isInitialized = !0;
          return;
        }
        await pn.createEntry(t, {
          name: t8,
          content: "{{engramSummaries}}",
          keys: [e8],
          constant: !0,
          enabled: !0,
          position: "at_depth",
          role: "system",
          depth: 999,
          order: 9e3
          //  order
        }) ? (ve.success("WorldBookSlotService", "", {
          worldbook: t,
          name: t8
        }), this.isInitialized = !0) : ve.error("WorldBookSlotService", "");
      } catch (t) {
        ve.error("WorldBookSlotService", "", t);
      }
  }
  /**
   * 
   */
  static isReady() {
    return this.isInitialized;
  }
  /**
   * 
   */
  static reset() {
    this.isInitialized = !1;
  }
}
vt(oD, "isInitialized", !1);
const GW = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  WorldBookSlotService: oD
}, Symbol.toStringTag, { value: "Module" }));
function KW(e) {
  return new Date(e).toTimeString().slice(0, 8);
}
const YW = {
  [Yn.DEBUG]: { text: "text-zinc-500", bg: "bg-zinc-500/10" },
  [Yn.INFO]: { text: "text-blue-400", bg: "bg-blue-500/10" },
  [Yn.SUCCESS]: { text: "text-emerald-400", bg: "bg-emerald-500/10" },
  [Yn.WARN]: { text: "text-amber-400", bg: "bg-amber-500/10" },
  [Yn.ERROR]: { text: "text-red-400", bg: "bg-red-500/10" }
}, WW = ({ entry: e }) => {
  const [t, n] = F.useState(!1), r = e.data !== void 0, i = bv[e.level], s = YW[e.level];
  return /* @__PURE__ */ g.jsxs("div", { className: "group", children: [
    /* @__PURE__ */ g.jsxs(
      "div",
      {
        className: `
                    flex items-start gap-3 px-2 py-1 rounded-sm transition-colors
                    hover:bg-white/[0.02]
                    ${r ? "cursor-pointer" : ""}
                `,
        onClick: () => r && n(!t),
        children: [
          /* @__PURE__ */ g.jsx("span", { className: "flex items-center text-zinc-600 shrink-0 mt-0.5 w-3", children: r ? t ? /* @__PURE__ */ g.jsx(Ad, { size: 12 }) : /* @__PURE__ */ g.jsx(Pm, { size: 12 }) : null }),
          /* @__PURE__ */ g.jsx("span", { className: "text-zinc-600 shrink-0 tabular-nums text-[11px]", children: KW(e.timestamp) }),
          /* @__PURE__ */ g.jsx("span", { className: `
                    shrink-0 text-[10px] font-medium px-1.5 py-0.5 rounded
                    ${s.text} ${s.bg}
                `, children: i.label }),
          /* @__PURE__ */ g.jsx("span", { className: "text-zinc-500 shrink-0 text-[11px]", children: e.module }),
          /* @__PURE__ */ g.jsx("span", { className: "text-zinc-300 text-[11px] break-words flex-1 leading-relaxed", children: e.message })
        ]
      }
    ),
    t && r && /* @__PURE__ */ g.jsx("div", { className: "ml-10 mr-2 mb-1 px-3 py-2 bg-zinc-900/50 border-l-2 border-zinc-700 rounded-r text-[10px]", children: /* @__PURE__ */ g.jsx("pre", { className: "m-0 text-zinc-400 whitespace-pre-wrap break-words font-mono", children: JSON.stringify(e.data, null, 2) }) })
  ] });
}, XW = {
  summarize: { label: "", color: "bg-blue-500/20 text-blue-400" },
  trim: { label: "", color: "bg-yellow-500/20 text-yellow-500" },
  vectorize: { label: "", color: "bg-purple-500/20 text-purple-400" },
  query: { label: "", color: "bg-green-500/20 text-green-400" },
  other: { label: "", color: "bg-gray-500/20 text-gray-400" }
}, QW = ({ status: e }) => {
  switch (e) {
    case "pending":
      return /* @__PURE__ */ g.jsx(Eu, { size: 14, className: "animate-spin text-yellow-400" });
    case "success":
      return /* @__PURE__ */ g.jsx(xC, { size: 14, className: "text-green-400" });
    case "error":
      return /* @__PURE__ */ g.jsx(qc, { size: 14, className: "text-red-400" });
  }
}, ZW = (e) => new Date(e).toLocaleTimeString("zh-CN", {
  hour12: !1,
  hour: "2-digit",
  minute: "2-digit",
  second: "2-digit"
}), JW = (e) => e === void 0 ? "-" : e < 1e3 ? `${e}ms` : `${(e / 1e3).toFixed(1)}s`, eX = ({ sent: e, received: t }) => {
  const [n, r] = F.useState(!1), i = XW[e.type];
  return /* @__PURE__ */ g.jsxs("div", { className: "border border-border rounded-lg overflow-hidden bg-card", children: [
    /* @__PURE__ */ g.jsxs(
      "div",
      {
        className: "flex items-center gap-2 px-3 py-2 bg-muted-20 cursor-pointer hover:bg-muted-30",
        onClick: () => r(!n),
        children: [
          n ? /* @__PURE__ */ g.jsx(Ad, { size: 14 }) : /* @__PURE__ */ g.jsx(Pm, { size: 14 }),
          /* @__PURE__ */ g.jsx("span", { className: `px-2 py-0.5 rounded text-xs font-medium ${i.color}`, children: i.label }),
          e.model && /* @__PURE__ */ g.jsx("span", { className: "px-1.5 py-0.5 rounded text-[10px] font-medium bg-indigo-500/10 text-indigo-400 border border-indigo-500/20 truncate max-w-[150px]", title: `: ${e.model}`, children: e.model }),
          e.character && /* @__PURE__ */ g.jsx("span", { className: "px-1.5 py-0.5 rounded text-[10px] font-medium bg-orange-500/10 text-orange-400 border border-orange-500/20 truncate max-w-[120px]", title: `: ${e.character}`, children: e.character }),
          /* @__PURE__ */ g.jsx("span", { className: "text-xs text-muted-foreground", children: ZW(e.timestamp) }),
          /* @__PURE__ */ g.jsx(QW, { status: (t == null ? void 0 : t.status) || e.status }),
          e.floorRange && /* @__PURE__ */ g.jsxs("span", { className: "text-xs text-muted-foreground", children: [
            " #",
            e.floorRange[0],
            "-",
            e.floorRange[1]
          ] }),
          /* @__PURE__ */ g.jsxs("span", { className: "ml-auto text-xs text-muted-foreground flex items-center gap-1", children: [
            /* @__PURE__ */ g.jsx(yv, { size: 12 }),
            JW((t == null ? void 0 : t.duration) || e.duration)
          ] })
        ]
      }
    ),
    n && /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col md:flex-row", children: [
      /* @__PURE__ */ g.jsxs("div", { className: "flex-1 border-r border-border p-3", children: [
        /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-2 mb-2 text-sm font-medium text-blue-400", children: [
          /* @__PURE__ */ g.jsx(Pq, { size: 14 }),
          "",
          e.tokensSent && /* @__PURE__ */ g.jsxs("span", { className: "text-xs text-muted-foreground ml-auto", children: [
            "~",
            e.tokensSent,
            " tokens"
          ] })
        ] }),
        e.systemPrompt && /* @__PURE__ */ g.jsxs("div", { className: "mb-3", children: [
          /* @__PURE__ */ g.jsx("div", { className: "text-xs text-muted-foreground mb-1", children: "System" }),
          /* @__PURE__ */ g.jsx("div", { className: "text-sm p-2 bg-muted-20 rounded max-h-[500px] overflow-y-auto whitespace-pre-wrap", children: e.systemPrompt })
        ] }),
        e.userPrompt && /* @__PURE__ */ g.jsxs("div", { children: [
          /* @__PURE__ */ g.jsx("div", { className: "text-xs text-muted-foreground mb-1", children: "User" }),
          /* @__PURE__ */ g.jsx("div", { className: "text-sm p-2 bg-muted-20 rounded max-h-[500px] overflow-y-auto whitespace-pre-wrap", children: e.userPrompt })
        ] })
      ] }),
      /* @__PURE__ */ g.jsxs("div", { className: "flex-1 p-3", children: [
        /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-2 mb-2 text-sm font-medium text-green-400", children: [
          /* @__PURE__ */ g.jsx(QM, { size: 14 }),
          "",
          (t == null ? void 0 : t.tokensReceived) && /* @__PURE__ */ g.jsxs("span", { className: "text-xs text-muted-foreground ml-auto", children: [
            "~",
            t.tokensReceived,
            " tokens"
          ] })
        ] }),
        (t == null ? void 0 : t.status) === "error" && t.error && /* @__PURE__ */ g.jsx("div", { className: "p-2 bg-red-500/10 border border-red-500/30 rounded text-sm text-red-400", children: t.error }),
        (t == null ? void 0 : t.response) && /* @__PURE__ */ g.jsx("div", { className: "text-sm p-2 bg-muted-20 rounded max-h-[500px] overflow-y-auto whitespace-pre-wrap", children: t.response }),
        !t && e.status === "pending" && /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-2 text-sm text-muted-foreground", children: [
          /* @__PURE__ */ g.jsx(Eu, { size: 14, className: "animate-spin" }),
          "..."
        ] })
      ] })
    ] })
  ] });
}, tX = () => {
  const [e, t] = F.useState(ua.getPaired());
  return F.useEffect(() => ua.subscribe(() => {
    t(ua.getPaired());
  }), []), /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col h-full", children: [
    /* @__PURE__ */ g.jsxs("div", { className: "flex items-center justify-between px-4 py-3 border-b border-border shrink-0", children: [
      /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-2", children: [
        /* @__PURE__ */ g.jsx(Ld, { size: 16, className: "text-primary" }),
        /* @__PURE__ */ g.jsx("span", { className: "font-medium text-foreground", children: "" }),
        /* @__PURE__ */ g.jsxs("span", { className: "text-xs text-muted-foreground", children: [
          "(",
          e.length,
          ")"
        ] })
      ] }),
      /* @__PURE__ */ g.jsx(
        "button",
        {
          className: "p-1.5 rounded-md hover:bg-destructive hover:text-destructive-foreground transition-colors text-muted-foreground",
          onClick: () => ua.clear(),
          title: "",
          children: /* @__PURE__ */ g.jsx(jo, { size: 14 })
        }
      )
    ] }),
    /* @__PURE__ */ g.jsx("div", { className: "flex-1 overflow-y-auto p-4", children: e.length === 0 ? /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col items-center justify-center h-full text-muted-foreground gap-3", children: [
      /* @__PURE__ */ g.jsx(QM, { size: 48, className: "opacity-30" }),
      /* @__PURE__ */ g.jsx("p", { className: "text-sm", children: "" }),
      /* @__PURE__ */ g.jsx("p", { className: "text-xs", children: "" })
    ] }) : /* @__PURE__ */ g.jsx("div", { className: "flex flex-col gap-3", children: e.map(({ sent: n, received: r }) => /* @__PURE__ */ g.jsx(eX, { sent: n, received: r }, n.id)) }) })
  ] });
}, n8 = 768, lD = (e) => new Date(e).toLocaleTimeString("zh-CN", {
  hour12: !1,
  hour: "2-digit",
  minute: "2-digit",
  second: "2-digit"
}), uD = (e) => e === void 0 ? "-" : e < 1e3 ? `${e}ms` : `${(e / 1e3).toFixed(1)}s`, nX = ({ entry: e, isSelected: t, onSelect: n }) => /* @__PURE__ */ g.jsxs(
  "div",
  {
    className: `
                px-3 py-2 cursor-pointer border-b border-border/30 transition-colors
                ${t ? "bg-primary/10 border-l-2 border-l-primary" : "hover:bg-muted/30"}
            `,
    onClick: n,
    children: [
      /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-2 mb-1", children: [
        /* @__PURE__ */ g.jsx("span", { className: `px-1.5 py-0.5 rounded text-[10px] font-medium ${e.mode === "hybrid" ? "bg-purple-500/20 text-purple-400" : "bg-blue-500/20 text-blue-400"}`, children: e.mode === "hybrid" ? "" : "Embed" }),
        /* @__PURE__ */ g.jsxs("span", { className: "text-[10px] text-muted-foreground", children: [
          e.stats.rerankCount,
          "/",
          e.stats.topKCount,
          " "
        ] }),
        /* @__PURE__ */ g.jsxs("span", { className: "text-[10px] text-muted-foreground ml-auto flex items-center gap-1", children: [
          /* @__PURE__ */ g.jsx(yv, { size: 10 }),
          lD(e.timestamp)
        ] })
      ] }),
      /* @__PURE__ */ g.jsx("p", { className: "text-sm text-foreground line-clamp-2", children: e.query }),
      /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-2 mt-1 text-[10px] text-muted-foreground", children: [
        /* @__PURE__ */ g.jsx(Ld, { size: 10 }),
        uD(e.stats.latencyMs)
      ] })
    ]
  }
), h2 = ({ label: e, score: t, color: n }) => {
  const r = Math.min(100, t * 100);
  return /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-2 text-xs", children: [
    /* @__PURE__ */ g.jsx("span", { className: "text-muted-foreground w-16 shrink-0", children: e }),
    /* @__PURE__ */ g.jsx("div", { className: "flex-1 h-1.5 bg-muted/30 rounded-full overflow-hidden", children: /* @__PURE__ */ g.jsx(
      "div",
      {
        className: `h-full ${n} rounded-full transition-all duration-300`,
        style: { width: `${r}%` }
      }
    ) }),
    /* @__PURE__ */ g.jsx("span", { className: "text-muted-foreground w-14 text-right font-mono shrink-0", children: t.toFixed(3) })
  ] });
}, rX = ({ item: e }) => {
  const [t, n] = F.useState(!1);
  return /* @__PURE__ */ g.jsxs(
    "div",
    {
      className: `
                border-b border-border/30 py-3 px-4 cursor-pointer
                hover:bg-muted/10 transition-colors
                ${e.isReranked ? "bg-purple-500/5" : e.isTopK ? "bg-blue-500/5" : ""}
            `,
      onClick: () => n(!t),
      children: [
        /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-2 mb-1.5", children: [
          e.isReranked && /* @__PURE__ */ g.jsx("span", { className: "px-1.5 py-0.5 text-[10px] bg-purple-500/20 text-purple-400 rounded", children: "Rerank" }),
          e.isTopK && !e.isReranked && /* @__PURE__ */ g.jsx("span", { className: "px-1.5 py-0.5 text-[10px] bg-blue-500/20 text-blue-400 rounded", children: "TopK" }),
          /* @__PURE__ */ g.jsx("span", { className: "text-[10px] text-muted-foreground truncate max-w-[150px]", children: e.category }),
          e.sourceFloor && /* @__PURE__ */ g.jsxs("span", { className: "text-[10px] text-muted-foreground", children: [
            " #",
            e.sourceFloor
          ] }),
          /* @__PURE__ */ g.jsx(Pm, { size: 12, className: `ml-auto text-muted-foreground transition-transform ${t ? "rotate-90" : ""}` })
        ] }),
        /* @__PURE__ */ g.jsx("p", { className: `text-sm text-foreground ${t ? "" : "line-clamp-2"}`, children: e.summary }),
        t && /* @__PURE__ */ g.jsxs("div", { className: "mt-3 space-y-1.5 pt-2 border-t border-border/20", children: [
          /* @__PURE__ */ g.jsx(h2, { label: "Embedding", score: e.embeddingScore, color: "bg-blue-500" }),
          e.rerankScore != null && /* @__PURE__ */ g.jsx(h2, { label: "Rerank", score: e.rerankScore, color: "bg-orange-500" }),
          e.hybridScore != null && /* @__PURE__ */ g.jsx(h2, { label: "Hybrid", score: e.hybridScore, color: "bg-purple-500" })
        ] })
      ]
    }
  );
}, r8 = ({ entry: e, isFullScreen: t, onClose: n }) => {
  const [r, i] = F.useState("all"), [s, o] = F.useState("hybrid"), [u, c] = F.useState(""), d = F.useMemo(() => {
    if (!e) return [];
    let m = [...e.results];
    if (u.trim()) {
      const p = u.toLowerCase();
      m = m.filter((x) => x.summary.toLowerCase().includes(p));
    }
    return r === "topK" ? m = m.filter((p) => p.isTopK) : r === "reranked" && (m = m.filter((p) => p.isReranked)), m.sort((p, x) => {
      const b = (S) => {
        switch (s) {
          case "embedding":
            return S.embeddingScore;
          case "rerank":
            return S.rerankScore ?? 0;
          case "hybrid":
            return S.hybridScore ?? (S.rerankScore != null ? (S.embeddingScore + S.rerankScore) / 2 : S.embeddingScore);
        }
      };
      return b(x) - b(p);
    }), m;
  }, [e, r, s, u]);
  return e ? /* @__PURE__ */ g.jsxs("div", { className: `flex flex-col h-full ${t ? "p-4" : ""}`, children: [
    t && n && /* @__PURE__ */ g.jsxs(
      "button",
      {
        onClick: n,
        className: "flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground mb-4",
        children: [
          /* @__PURE__ */ g.jsx(vC, { size: 16 }),
          ""
        ]
      }
    ),
    /* @__PURE__ */ g.jsxs("div", { className: "mb-4 pb-4 border-b border-border shrink-0", children: [
      /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-2 mb-2", children: [
        /* @__PURE__ */ g.jsx("span", { className: `px-2 py-0.5 rounded text-xs font-medium ${e.mode === "hybrid" ? "bg-purple-500/20 text-purple-400" : "bg-blue-500/20 text-blue-400"}`, children: e.mode === "hybrid" ? "" : "" }),
        /* @__PURE__ */ g.jsx("span", { className: "text-xs text-muted-foreground", children: lD(e.timestamp) })
      ] }),
      /* @__PURE__ */ g.jsx("p", { className: "text-sm text-foreground mb-2", children: e.query }),
      e.preprocessedQuery && e.preprocessedQuery !== e.query && /* @__PURE__ */ g.jsxs("p", { className: "text-xs text-muted-foreground", children: [
        " : ",
        e.preprocessedQuery
      ] }),
      /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-4 mt-3 text-xs text-muted-foreground", children: [
        /* @__PURE__ */ g.jsxs("span", { children: [
          ": ",
          e.stats.totalCandidates
        ] }),
        /* @__PURE__ */ g.jsxs("span", { children: [
          "TopK: ",
          e.stats.topKCount
        ] }),
        /* @__PURE__ */ g.jsxs("span", { children: [
          "Rerank: ",
          e.stats.rerankCount
        ] }),
        /* @__PURE__ */ g.jsxs("span", { className: "flex items-center gap-1", children: [
          /* @__PURE__ */ g.jsx(Ld, { size: 10 }),
          uD(e.stats.latencyMs)
        ] })
      ] })
    ] }),
    /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-3 flex-wrap mb-3 shrink-0", children: [
      /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-1 text-xs", children: [
        /* @__PURE__ */ g.jsx(VB, { size: 12, className: "text-muted-foreground" }),
        ["all", "topK", "reranked"].map((m) => /* @__PURE__ */ g.jsx(
          "button",
          {
            className: `px-2 py-1 rounded transition-colors ${r === m ? "bg-primary/20 text-primary" : "text-muted-foreground hover:text-foreground"}`,
            onClick: () => i(m),
            children: m === "all" ? "" : m === "topK" ? "TopK" : "Reranked"
          },
          m
        ))
      ] }),
      /* @__PURE__ */ g.jsx("div", { className: "w-px h-4 bg-border" }),
      /* @__PURE__ */ g.jsx("div", { className: "flex items-center gap-1 text-xs", children: ["embedding", "rerank", "hybrid"].map((m) => /* @__PURE__ */ g.jsx(
        "button",
        {
          className: `px-2 py-1 rounded transition-colors ${s === m ? "bg-primary/20 text-primary" : "text-muted-foreground hover:text-foreground"}`,
          onClick: () => o(m),
          children: m.charAt(0).toUpperCase() + m.slice(1)
        },
        m
      )) }),
      /* @__PURE__ */ g.jsx("div", { className: "w-px h-4 bg-border" }),
      /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-1.5 text-muted-foreground", children: [
        /* @__PURE__ */ g.jsx(Ls, { size: 12 }),
        /* @__PURE__ */ g.jsx(
          "input",
          {
            type: "text",
            placeholder: "...",
            value: u,
            onChange: (m) => c(m.target.value),
            className: "bg-transparent border-none outline-none text-xs text-foreground placeholder:text-muted-foreground w-24"
          }
        )
      ] })
    ] }),
    /* @__PURE__ */ g.jsx("div", { className: "flex-1 overflow-y-auto -mx-4 md:mx-0", children: d.length === 0 ? /* @__PURE__ */ g.jsx("div", { className: "py-8 text-center text-muted-foreground text-sm", children: "" }) : d.map((m, p) => /* @__PURE__ */ g.jsx(rX, { item: m }, p)) }),
    /* @__PURE__ */ g.jsxs("div", { className: "text-[10px] text-muted-foreground py-2 border-t border-border mt-2 shrink-0", children: [
      " ",
      d.length,
      " / ",
      e.results.length,
      " "
    ] })
  ] }) : /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col items-center justify-center h-full text-muted-foreground gap-3", children: [
    /* @__PURE__ */ g.jsx(CC, { size: 32, className: "opacity-30" }),
    /* @__PURE__ */ g.jsx("p", { className: "text-sm font-light", children: "" })
  ] });
}, iX = () => {
  const [e, t] = F.useState(sv.getLogs()), [n, r] = F.useState(null), [i, s] = F.useState(window.innerWidth < n8), [o, u] = F.useState(!1);
  F.useEffect(() => {
    const p = () => {
      s(window.innerWidth < n8);
    };
    return window.addEventListener("resize", p), () => window.removeEventListener("resize", p);
  }, []), F.useEffect(() => sv.subscribe((x) => {
    t(x);
  }), []);
  const c = F.useMemo(() => e.find((p) => p.id === n) || null, [e, n]), d = (p) => {
    r(p), i && u(!0);
  }, m = () => {
    u(!1), i && r(null);
  };
  return i && o && c ? /* @__PURE__ */ g.jsx(
    r8,
    {
      entry: c,
      isFullScreen: !0,
      onClose: m
    }
  ) : /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col h-full", children: [
    /* @__PURE__ */ g.jsxs("div", { className: "flex items-center justify-between px-4 py-3 border-b border-border shrink-0", children: [
      /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-2", children: [
        /* @__PURE__ */ g.jsx(CC, { size: 16, className: "text-primary" }),
        /* @__PURE__ */ g.jsx("span", { className: "font-medium text-foreground", children: "" }),
        /* @__PURE__ */ g.jsxs("span", { className: "text-xs text-muted-foreground", children: [
          "(",
          e.length,
          ")"
        ] })
      ] }),
      /* @__PURE__ */ g.jsx(
        "button",
        {
          className: "p-1.5 rounded-md hover:bg-destructive hover:text-destructive-foreground transition-colors text-muted-foreground",
          onClick: () => sv.clear(),
          title: "",
          children: /* @__PURE__ */ g.jsx(jo, { size: 14 })
        }
      )
    ] }),
    /* @__PURE__ */ g.jsxs("div", { className: "flex-1 flex min-h-0", children: [
      /* @__PURE__ */ g.jsx("div", { className: `
                    ${i ? "w-full" : "w-[30%] min-w-[240px]"}
                    overflow-y-auto
                    ${i ? "" : "border-r border-border/50"}
                `, children: e.length === 0 ? /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col items-center justify-center h-full text-muted-foreground gap-3 p-4", children: [
        /* @__PURE__ */ g.jsx(Wv, { size: 32, className: "opacity-30" }),
        /* @__PURE__ */ g.jsx("p", { className: "text-sm font-light", children: "" }),
        /* @__PURE__ */ g.jsx("p", { className: "text-xs opacity-70", children: " RAG " })
      ] }) : e.map((p) => /* @__PURE__ */ g.jsx(
        nX,
        {
          entry: p,
          isSelected: p.id === n,
          onSelect: () => d(p.id)
        },
        p.id
      )) }),
      !i && /* @__PURE__ */ g.jsx("div", { className: "flex-1 overflow-y-auto p-4", children: /* @__PURE__ */ g.jsx(r8, { entry: c }) })
    ] })
  ] });
}, cD = ({ tabs: e, activeTab: t, onChange: n, sticky: r = !0, top: i = 0, className: s = "", actions: o }) => /* @__PURE__ */ g.jsxs(
  "div",
  {
    className: `
            flex items-center justify-between gap-4 mb-6 border-b border-border
            ${r ? "glass-sticky sticky z-20 pt-4 pb-0 -mt-4 -mx-4 px-4 md:-mx-8 md:px-8 lg:-mx-12 lg:px-12" : "px-0"}
            ${s}
        `,
    style: r ? {
      top: i
    } : void 0,
    children: [
      /* @__PURE__ */ g.jsx("div", { className: "flex overflow-x-auto gap-2 pb-1 no-scrollbar", children: e.map((u) => /* @__PURE__ */ g.jsxs(
        "button",
        {
          onClick: () => n(u.id),
          className: `flex items-center gap-2 whitespace-nowrap px-4 py-1.5 text-sm transition-all relative ${t === u.id ? "text-foreground" : "text-muted-foreground hover:text-foreground"}`,
          children: [
            u.icon && /* @__PURE__ */ g.jsx("span", { className: "w-4 h-4", children: u.icon }),
            u.label,
            t === u.id && /* @__PURE__ */ g.jsx("div", { className: "absolute -bottom-[1px] left-0 right-0 h-[2px] bg-primary shadow-[0_0_8px_var(--primary)] z-10 transition-all duration-300" })
          ]
        },
        u.id
      )) }),
      o && /* @__PURE__ */ g.jsx("div", { className: "flex items-center gap-2 pb-1 shrink-0", children: o })
    ]
  }
), lx = (e) => {
  const [t, n] = F.useState(!1);
  F.useEffect(() => (n(!0), () => n(!1)), []);
  const r = document.getElementById("engram-header-extension");
  if (!t || !r)
    return null;
  const i = {
    ...e,
    sticky: !1,
    className: `!mb-0 !border-0 !bg-transparent px-4 md:px-8 lg:px-12 ${e.className || ""}`
  };
  return cR.createPortal(
    /* @__PURE__ */ g.jsx(cD, { ...i }),
    r
  );
}, aX = [
  { id: "runtime", label: "", icon: /* @__PURE__ */ g.jsx(Zv, { size: 14 }) },
  { id: "model", label: "", icon: /* @__PURE__ */ g.jsx(Ld, { size: 14 }) },
  { id: "recall", label: "", icon: /* @__PURE__ */ g.jsx(CC, { size: 14 }) }
], sX = [
  "ALL",
  "Logger",
  "EventBus",
  "Summarizer",
  "CORE/Pipeline",
  "CORE/RAG",
  "CORE/Memory",
  "UI/GraphView",
  "UI/MemoryStream"
], oX = ({ initialTab: e }) => {
  const [t, n] = F.useState(e || "runtime"), [r, i] = F.useState([]), [s, o] = F.useState([]), [u, c] = F.useState(""), [d, m] = F.useState(-1), [p, x] = F.useState("ALL"), [b, S] = F.useState(!0), [k, A] = F.useState(!1), [T, M] = F.useState(!1), j = F.useRef(null);
  F.useEffect(() => {
    i(ve.getLogs());
    const I = ve.subscribe((L) => {
      i((K) => [...K, L]);
    });
    return () => I();
  }, []), F.useEffect(() => {
    let I = r;
    if (d !== -1 && (I = I.filter((L) => L.level >= d)), p !== "ALL" && (I = I.filter((L) => L.module.startsWith(p))), u.trim()) {
      const L = u.toLowerCase();
      I = I.filter(
        (K) => K.message.toLowerCase().includes(L) || K.module.toLowerCase().includes(L)
      );
    }
    o(I);
  }, [r, d, p, u]), F.useEffect(() => {
    b && j.current && j.current.scrollIntoView({ behavior: "smooth", block: "nearest" });
  }, [s, b]);
  const D = F.useCallback(async () => {
    await ve.clear(), i([]);
  }, []), z = F.useCallback(() => {
    const I = ve.exportToMarkdown(), L = ve.getExportFilename(), K = new Blob([I], { type: "text/markdown" }), ne = URL.createObjectURL(K), Y = document.createElement("a");
    Y.href = ne, Y.download = L, Y.click(), URL.revokeObjectURL(ne), ve.success("DevLog", `: ${L}`);
  }, []);
  return /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col h-full", children: [
    /* @__PURE__ */ g.jsxs("div", { className: "mb-2", children: [
      /* @__PURE__ */ g.jsx("h1", { className: "text-2xl font-light text-foreground tracking-tight mb-2", children: "" }),
      /* @__PURE__ */ g.jsx("p", { className: "text-sm text-muted-foreground", children: "" })
    ] }),
    /* @__PURE__ */ g.jsx(
      lx,
      {
        tabs: aX,
        activeTab: t,
        onChange: (I) => n(I)
      }
    ),
    t === "runtime" && /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col flex-1 min-h-0", children: [
      /* @__PURE__ */ g.jsx("div", { className: "sticky top-0 z-10 bg-background/95 backdrop-blur-sm py-3 -mx-4 px-4 md:-mx-8 md:px-8 lg:-mx-12 lg:px-12 border-b border-border", children: /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-2 flex-wrap", children: [
        /* @__PURE__ */ g.jsxs("div", { className: "relative", children: [
          /* @__PURE__ */ g.jsxs(
            "button",
            {
              className: "inline-flex items-center gap-1.5 px-2.5 py-1.5 text-xs text-muted-foreground hover:text-foreground transition-colors",
              onClick: () => A(!k),
              children: [
                d === -1 ? "" : bv[d].label,
                /* @__PURE__ */ g.jsx(Ad, { size: 12 })
              ]
            }
          ),
          k && /* @__PURE__ */ g.jsxs("div", { className: "absolute top-full left-0 mt-1 bg-popover border border-border rounded-md shadow-lg z-20 min-w-[100px] py-1 flex flex-col", children: [
            /* @__PURE__ */ g.jsx(
              "button",
              {
                className: "block w-full text-left px-3 py-1.5 text-xs hover:bg-accent transition-colors",
                onClick: () => {
                  m(-1), A(!1);
                },
                children: ""
              }
            ),
            Object.entries(bv).map(([I, L]) => /* @__PURE__ */ g.jsxs(
              "button",
              {
                className: "block w-full text-left px-3 py-1.5 text-xs hover:bg-accent transition-colors",
                onClick: () => {
                  m(Number(I)), A(!1);
                },
                children: [
                  L.icon,
                  " ",
                  L.label
                ]
              },
              I
            ))
          ] })
        ] }),
        /* @__PURE__ */ g.jsx("div", { className: "w-px h-4 bg-border" }),
        /* @__PURE__ */ g.jsxs("div", { className: "relative", children: [
          /* @__PURE__ */ g.jsxs(
            "button",
            {
              className: "inline-flex items-center gap-1.5 px-2.5 py-1.5 text-xs text-muted-foreground hover:text-foreground transition-colors",
              onClick: () => M(!T),
              children: [
                p,
                /* @__PURE__ */ g.jsx(Ad, { size: 12 })
              ]
            }
          ),
          T && /* @__PURE__ */ g.jsx("div", { className: "absolute top-full left-0 mt-1 bg-popover border border-border rounded-md shadow-lg z-20 min-w-[120px] py-1 max-h-48 overflow-y-auto flex flex-col", children: sX.map((I) => /* @__PURE__ */ g.jsx(
            "button",
            {
              className: "block w-full text-left px-3 py-1.5 text-xs hover:bg-accent transition-colors",
              onClick: () => {
                x(I), M(!1);
              },
              children: I
            },
            I
          )) })
        ] }),
        /* @__PURE__ */ g.jsx("div", { className: "w-px h-4 bg-border" }),
        /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-1.5 text-muted-foreground", children: [
          /* @__PURE__ */ g.jsx(Ls, { size: 12 }),
          /* @__PURE__ */ g.jsx(
            "input",
            {
              type: "text",
              placeholder: "...",
              value: u,
              onChange: (I) => c(I.target.value),
              className: "bg-transparent border-none outline-none text-xs text-foreground placeholder:text-muted-foreground w-24 md:w-40"
            }
          )
        ] }),
        /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-1 ml-auto", children: [
          /* @__PURE__ */ g.jsx(
            "button",
            {
              className: `p-1.5 rounded transition-colors ${b ? "text-primary" : "text-muted-foreground hover:text-foreground"}`,
              onClick: () => S(!b),
              title: "",
              children: /* @__PURE__ */ g.jsx(aB, { size: 14 })
            }
          ),
          /* @__PURE__ */ g.jsx(
            "button",
            {
              className: "p-1.5 rounded text-muted-foreground hover:text-foreground transition-colors",
              onClick: D,
              title: "",
              children: /* @__PURE__ */ g.jsx(jo, { size: 14 })
            }
          ),
          /* @__PURE__ */ g.jsxs(
            "button",
            {
              className: "inline-flex items-center gap-1 px-2 py-1 text-xs text-muted-foreground hover:text-foreground transition-colors",
              onClick: z,
              children: [
                /* @__PURE__ */ g.jsx(Kg, { size: 12 }),
                ""
              ]
            }
          )
        ] })
      ] }) }),
      /* @__PURE__ */ g.jsx("div", { className: "flex-1 overflow-y-auto font-mono text-xs leading-relaxed py-2", children: s.length === 0 ? /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col items-center justify-center h-full gap-3 text-muted-foreground", children: [
        /* @__PURE__ */ g.jsx(Zv, { size: 32, strokeWidth: 1, className: "opacity-30" }),
        /* @__PURE__ */ g.jsx("p", { className: "text-sm font-light", children: "" })
      ] }) : /* @__PURE__ */ g.jsxs(g.Fragment, { children: [
        s.map((I) => /* @__PURE__ */ g.jsx(WW, { entry: I }, I.id)),
        /* @__PURE__ */ g.jsx("div", { ref: j })
      ] }) }),
      /* @__PURE__ */ g.jsxs("div", { className: "text-[10px] text-muted-foreground py-2 border-t border-border", children: [
        r.length,
        " ",
        s.length !== r.length && `  ${s.length} `
      ] })
    ] }),
    t === "model" && /* @__PURE__ */ g.jsx("div", { className: "flex-1 overflow-hidden", children: /* @__PURE__ */ g.jsx(tX, {}) }),
    t === "recall" && /* @__PURE__ */ g.jsx("div", { className: "flex-1 overflow-hidden", children: /* @__PURE__ */ g.jsx(iX, {}) })
  ] });
}, lX = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  DevLog: oX
}, Symbol.toStringTag, { value: "Module" })), uX = {
  default: "text-muted-foreground bg-muted/50",
  primary: "text-primary bg-primary/10",
  blue: "text-blue-500 bg-blue-500/10",
  purple: "text-purple-500 bg-purple-500/10",
  orange: "text-orange-500 bg-orange-500/10",
  emerald: "text-emerald-500 bg-emerald-500/10"
}, cX = ({
  icon: e,
  title: t,
  subtitle: n,
  meta: r,
  badges: i = [],
  selected: s = !1,
  disabled: o = !1,
  toggle: u,
  onClick: c,
  actions: d = [],
  className: m = "",
  compact: p = !1
}) => {
  const x = d.filter((S) => !S.hidden), b = !!u;
  return /* @__PURE__ */ g.jsxs(
    "div",
    {
      className: `
                group relative flex items-center gap-3 
                ${p ? "py-2 px-2" : "py-3 px-3"}
                rounded-lg cursor-pointer transition-all duration-150
                ${s ? "bg-accent/60" : "hover:bg-muted/40"}
                ${o ? "opacity-50 pointer-events-none" : ""}
                ${m}
            `,
      onClick: c,
      children: [
        (e || b) && /* @__PURE__ */ g.jsx("div", { className: "flex-shrink-0", children: b ? /* @__PURE__ */ g.jsx(
          "button",
          {
            className: `
                                w-7 h-7 flex items-center justify-center rounded-md transition-colors
                                ${u.checked ? "text-primary" : "text-muted-foreground hover:text-foreground"}
                            `,
            onClick: (S) => {
              S.stopPropagation(), u.onChange(!u.checked);
            },
            children: /* @__PURE__ */ g.jsx(Qv, { size: 14 })
          }
        ) : /* @__PURE__ */ g.jsx("div", { className: `
                            w-7 h-7 flex items-center justify-center rounded-md transition-colors
                            ${s ? "text-primary" : "text-muted-foreground group-hover:text-foreground"}
                        `, children: e }) }),
        /* @__PURE__ */ g.jsxs("div", { className: "flex-1 min-w-0", children: [
          /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-2", children: [
            /* @__PURE__ */ g.jsx("span", { className: `
                        text-sm font-medium truncate transition-colors
                        ${s ? "text-foreground" : "text-muted-foreground group-hover:text-foreground"}
                        ${u && !u.checked ? "line-through opacity-60" : ""}
                    `, children: t }),
            i.map((S, k) => /* @__PURE__ */ g.jsx(
              "span",
              {
                className: `
                                text-[10px] px-1.5 py-0.5 rounded-sm font-medium flex-shrink-0
                                ${uX[S.color || "default"]}
                            `,
                children: S.text
              },
              k
            ))
          ] }),
          (n || r) && /* @__PURE__ */ g.jsxs("div", { className: "flex items-center justify-between mt-0.5 text-[11px] text-muted-foreground/70", children: [
            n && /* @__PURE__ */ g.jsx("span", { className: "truncate", children: n }),
            r && /* @__PURE__ */ g.jsx("span", { className: "flex-shrink-0 font-mono", children: r })
          ] })
        ] }),
        s && !x.length && /* @__PURE__ */ g.jsx(Kv, { size: 14, className: "text-primary flex-shrink-0" }),
        x.length > 0 && /* @__PURE__ */ g.jsx("div", { className: `
                    flex items-center gap-0.5 flex-shrink-0
                    ${s ? "opacity-100" : "opacity-0 group-hover:opacity-100"}
                    transition-opacity
                `, children: x.map((S, k) => /* @__PURE__ */ g.jsx(
          "button",
          {
            className: `
                                p-1.5 rounded transition-colors
                                ${S.danger ? "text-muted-foreground hover:text-destructive hover:bg-destructive/10" : "text-muted-foreground hover:text-foreground hover:bg-muted"}
                            `,
            onClick: (A) => {
              A.stopPropagation(), S.onClick(A);
            },
            title: S.title,
            children: S.icon
          },
          k
        )) })
      ]
    }
  );
}, fX = ({
  preset: e,
  isSelected: t,
  onSelect: n,
  onEdit: r,
  onCopy: i,
  onDelete: s
}) => {
  var c;
  const o = e.source === "tavern" || e.source === "tavern_profile" ? Lq : RB, u = e.source === "custom" ? ((c = e.custom) == null ? void 0 : c.model) || "" : "";
  return /* @__PURE__ */ g.jsx(
    cX,
    {
      icon: /* @__PURE__ */ g.jsx(o, { size: 14 }),
      title: e.name,
      subtitle: u,
      meta: `T:${e.parameters.temperature}`,
      badges: e.isDefault ? [{ text: "DEFAULT", color: "primary" }] : [],
      selected: t,
      onClick: n,
      actions: [
        { icon: /* @__PURE__ */ g.jsx(_q, { size: 12 }), onClick: () => r(), title: "" },
        { icon: /* @__PURE__ */ g.jsx(bC, { size: 12 }), onClick: () => i(), title: "" },
        { icon: /* @__PURE__ */ g.jsx(jo, { size: 12 }), onClick: () => s(), title: "", danger: !0, hidden: e.isDefault }
      ]
    }
  );
}, ca = ({ title: e, description: t, children: n, className: r = "" }) => /* @__PURE__ */ g.jsxs("div", { className: `mb-8 ${r}`, children: [
  /* @__PURE__ */ g.jsxs("div", { className: "mb-4", children: [
    /* @__PURE__ */ g.jsx("h3", { className: "text-sm font-medium text-primary", children: e }),
    t && /* @__PURE__ */ g.jsx("p", { className: "text-xs text-muted-foreground mt-1 break-words", children: t })
  ] }),
  /* @__PURE__ */ g.jsx("div", { className: "space-y-4", children: n })
] }), wi = ({
  label: e,
  description: t,
  error: n,
  required: r,
  className: i = "",
  value: s,
  onChange: o,
  placeholder: u,
  type: c = "text",
  disabled: d,
  readOnly: m,
  multiline: p,
  rows: x = 3
}) => {
  const b = {
    background: "transparent",
    backgroundColor: "transparent",
    border: "none",
    borderBottom: "1px solid var(--border)",
    borderRadius: 0,
    boxShadow: "none",
    outline: "none",
    padding: "8px 0",
    fontSize: "14px",
    width: "100%",
    color: "var(--foreground, inherit)"
  };
  return /* @__PURE__ */ g.jsxs("div", { className: `flex flex-col gap-1 ${i}`, children: [
    /* @__PURE__ */ g.jsxs("label", { className: "text-xs text-muted-foreground flex items-center gap-1", children: [
      e,
      r && /* @__PURE__ */ g.jsx("span", { className: "text-destructive", children: "*" })
    ] }),
    p ? /* @__PURE__ */ g.jsx(
      "textarea",
      {
        value: s,
        onChange: (S) => o(S.target.value),
        placeholder: u,
        disabled: d,
        readOnly: m,
        rows: x,
        style: b,
        className: "font-mono resize-y min-h-[80px] placeholder:text-muted-foreground/40 disabled:opacity-50 focus:border-primary transition-colors"
      }
    ) : /* @__PURE__ */ g.jsx(
      "input",
      {
        type: c,
        value: s,
        onChange: (S) => o(S.target.value),
        placeholder: u,
        disabled: d,
        readOnly: m,
        style: b,
        className: "placeholder:text-muted-foreground/40 disabled:opacity-50 focus:border-primary transition-colors"
      }
    ),
    t && /* @__PURE__ */ g.jsx("p", { className: "text-[10px] text-muted-foreground/70 break-words", children: t }),
    n && /* @__PURE__ */ g.jsx("p", { className: "text-[10px] text-destructive", children: n })
  ] });
}, bi = ({
  label: e,
  description: t,
  error: n,
  required: r,
  className: i = "",
  value: s,
  onChange: o,
  min: u,
  max: c,
  step: d = 1,
  showSlider: m = !0,
  suffix: p
}) => {
  const x = {
    background: "transparent",
    backgroundColor: "transparent",
    border: "none",
    borderRadius: 0,
    boxShadow: "none",
    outline: "none",
    padding: "0",
    fontSize: "12px",
    width: "auto",
    minWidth: "40px",
    textAlign: "right",
    fontFamily: "monospace",
    color: "var(--foreground, inherit)"
  }, b = u !== void 0 && c !== void 0 ? Math.min(100, Math.max(0, (s - u) / (c - u) * 100)) : 0;
  return /* @__PURE__ */ g.jsxs("div", { className: `flex flex-col gap-2 ${i}`, children: [
    /* @__PURE__ */ g.jsxs("div", { className: "flex justify-between items-center", children: [
      /* @__PURE__ */ g.jsxs("label", { className: "text-xs text-muted-foreground flex items-center gap-1", children: [
        e,
        r && /* @__PURE__ */ g.jsx("span", { className: "text-destructive", children: "*" })
      ] }),
      /* @__PURE__ */ g.jsx(
        "input",
        {
          type: "number",
          min: u,
          max: c,
          step: d,
          value: s,
          onChange: (S) => o(Number(S.target.value)),
          style: x,
          className: "focus:text-primary transition-colors [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"
        }
      )
    ] }),
    /* @__PURE__ */ g.jsx("div", { className: "flex items-center gap-3 pt-1", children: m && u !== void 0 && c !== void 0 && /* @__PURE__ */ g.jsxs("div", { className: "flex-1 relative h-4 flex items-center group cursor-pointer", children: [
      /* @__PURE__ */ g.jsx(
        "div",
        {
          className: "absolute inset-x-0 h-[1px]",
          style: { backgroundColor: "var(--border)" }
        }
      ),
      /* @__PURE__ */ g.jsx(
        "div",
        {
          className: "absolute top-1/2 -translate-y-1/2 w-2.5 h-2.5 bg-muted-foreground/80 rounded-full shadow-sm pointer-events-none transition-transform duration-75 ease-out group-hover:scale-125 group-hover:bg-foreground",
          style: { left: `${b}%`, transform: "translate(-50%, -50%)" }
        }
      ),
      /* @__PURE__ */ g.jsx(
        "input",
        {
          type: "range",
          min: u,
          max: c,
          step: d,
          value: s,
          onChange: (S) => o(Number(S.target.value)),
          className: "absolute inset-x-0 w-full h-full opacity-0 cursor-pointer z-10 m-0",
          style: { appearance: "none", WebkitAppearance: "none" }
        }
      )
    ] }) }),
    t && /* @__PURE__ */ g.jsx("p", { className: "text-[10px] text-muted-foreground/70 break-words", children: t }),
    n && /* @__PURE__ */ g.jsx("p", { className: "text-[10px] text-destructive", children: n })
  ] });
}, xu = ({
  label: e,
  description: t,
  error: n,
  required: r,
  className: i = "",
  value: s,
  onChange: o,
  options: u,
  placeholder: c = "...",
  disabled: d
}) => {
  const m = {
    background: "transparent",
    backgroundColor: "transparent",
    border: "none",
    borderBottom: "1px solid var(--border)",
    borderRadius: 0,
    boxShadow: "none",
    outline: "none",
    padding: "8px 24px 8px 0",
    fontSize: "14px",
    width: "100%",
    cursor: "pointer",
    color: "var(--foreground, inherit)",
    appearance: "none",
    WebkitAppearance: "none"
  };
  return /* @__PURE__ */ g.jsxs("div", { className: `flex flex-col gap-1 ${i}`, children: [
    /* @__PURE__ */ g.jsxs("label", { className: "text-xs text-muted-foreground flex items-center gap-1", children: [
      e,
      r && /* @__PURE__ */ g.jsx("span", { className: "text-destructive", children: "*" })
    ] }),
    /* @__PURE__ */ g.jsxs("div", { className: "relative", children: [
      /* @__PURE__ */ g.jsxs(
        "select",
        {
          value: s,
          onChange: (p) => o(p.target.value),
          disabled: d,
          style: m,
          className: "disabled:opacity-50 disabled:cursor-not-allowed focus:border-primary transition-colors",
          children: [
            /* @__PURE__ */ g.jsx("option", { value: "", disabled: !0, className: "bg-popover text-muted-foreground", children: c }),
            u.map((p) => /* @__PURE__ */ g.jsx("option", { value: p.value, className: "bg-popover text-foreground", children: p.label }, p.value))
          ]
        }
      ),
      /* @__PURE__ */ g.jsx(Ad, { size: 14, className: "absolute right-0 top-1/2 -translate-y-1/2 text-muted-foreground/50 pointer-events-none" })
    ] }),
    t && /* @__PURE__ */ g.jsx("p", { className: "text-[10px] text-muted-foreground/70 break-words", children: t }),
    n && /* @__PURE__ */ g.jsx("p", { className: "text-[10px] text-destructive", children: n })
  ] });
}, So = ({
  label: e,
  description: t,
  error: n,
  className: r = "",
  checked: i,
  onChange: s,
  disabled: o,
  compact: u
}) => /* @__PURE__ */ g.jsxs("div", { className: `flex items-start justify-between gap-4 ${u ? "py-0" : "py-1"} ${r} ${o ? "opacity-50 pointer-events-none" : ""}`, children: [
  e && /* @__PURE__ */ g.jsxs("div", { className: "flex-1 min-w-0", children: [
    /* @__PURE__ */ g.jsx(
      "label",
      {
        className: "text-xs text-foreground cursor-pointer block truncate",
        onClick: () => !o && s(!i),
        children: e
      }
    ),
    t && /* @__PURE__ */ g.jsx("p", { className: "text-[10px] text-muted-foreground/70 mt-0.5 break-words", children: t }),
    n && /* @__PURE__ */ g.jsx("p", { className: "text-[10px] text-destructive mt-0.5", children: n })
  ] }),
  /* @__PURE__ */ g.jsx(
    Zr,
    {
      checked: i,
      onChange: s,
      disabled: o
    }
  )
] }), fD = ({
  label: e,
  description: t,
  error: n,
  required: r,
  className: i = "",
  value: s,
  onChange: o,
  options: u,
  placeholder: c = "...",
  disabled: d,
  emptyText: m = ""
}) => {
  var D;
  const [p, x] = F.useState(!1), [b, S] = F.useState(""), k = F.useRef(null), A = F.useRef(null), T = u.filter(
    (z) => z.label.toLowerCase().includes(b.toLowerCase()) || z.value.toLowerCase().includes(b.toLowerCase())
  ), M = ((D = u.find((z) => z.value === s)) == null ? void 0 : D.label) || s || c;
  F.useEffect(() => {
    const z = (I) => {
      k.current && !k.current.contains(I.target) && (x(!1), S(""));
    };
    return document.addEventListener("mousedown", z), () => document.removeEventListener("mousedown", z);
  }, []), F.useEffect(() => {
    p && A.current && A.current.focus();
  }, [p]);
  const j = (z) => {
    o(z), x(!1), S("");
  };
  return /* @__PURE__ */ g.jsxs("div", { className: `flex flex-col gap-1 ${i}`, ref: k, children: [
    /* @__PURE__ */ g.jsxs("label", { className: "text-xs text-muted-foreground flex items-center gap-1", children: [
      e,
      r && /* @__PURE__ */ g.jsx("span", { className: "text-destructive", children: "*" })
    ] }),
    /* @__PURE__ */ g.jsxs(
      "button",
      {
        type: "button",
        onClick: () => !d && x(!p),
        disabled: d,
        className: "relative w-full text-left py-2 pr-6 border-0 border-b border-border bg-transparent text-sm text-foreground cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed focus:border-primary transition-colors",
        children: [
          /* @__PURE__ */ g.jsx("span", { className: s ? "" : "text-muted-foreground", children: M }),
          /* @__PURE__ */ g.jsx(
            Ad,
            {
              size: 14,
              className: `absolute right-0 top-1/2 -translate-y-1/2 text-muted-foreground/50 transition-transform ${p ? "rotate-180" : ""}`
            }
          )
        ]
      }
    ),
    p && /* @__PURE__ */ g.jsxs(
      "div",
      {
        className: "glass-panel absolute z-50 mt-1 w-full max-h-64 border border-border rounded-lg shadow-xl overflow-hidden flex flex-col animate-in fade-in slide-in-from-top-1 duration-150",
        style: { top: "100%", left: 0, right: 0 },
        children: [
          /* @__PURE__ */ g.jsxs("div", { className: "p-2 border-b border-border flex items-center gap-2", children: [
            /* @__PURE__ */ g.jsx(Ls, { size: 14, className: "text-muted-foreground flex-shrink-0" }),
            /* @__PURE__ */ g.jsx(
              "input",
              {
                ref: A,
                type: "text",
                value: b,
                onChange: (z) => S(z.target.value),
                placeholder: "...",
                className: "flex-1 bg-transparent border-none outline-none text-sm text-foreground placeholder:text-muted-foreground/50"
              }
            ),
            b && /* @__PURE__ */ g.jsx(
              "button",
              {
                type: "button",
                onClick: () => S(""),
                className: "p-0.5 hover:bg-muted rounded",
                children: /* @__PURE__ */ g.jsx(Lm, { size: 12, className: "text-muted-foreground" })
              }
            )
          ] }),
          /* @__PURE__ */ g.jsx("div", { className: "overflow-y-auto max-h-48", children: T.length > 0 ? T.map((z) => /* @__PURE__ */ g.jsx(
            "div",
            {
              onClick: () => j(z.value),
              className: `px-3 py-2 cursor-pointer text-sm truncate transition-colors ${z.value === s ? "bg-primary/15 text-primary" : "hover:bg-muted text-foreground"}`,
              title: z.label,
              children: z.label
            },
            z.value
          )) : /* @__PURE__ */ g.jsx("div", { className: "px-3 py-4 text-center text-sm text-muted-foreground", children: b ? "" : m }) }),
          u.length > 10 && /* @__PURE__ */ g.jsxs("div", { className: "px-3 py-1 border-t border-border text-xs text-muted-foreground/70", children: [
            T.length,
            " / ",
            u.length,
            " "
          ] })
        ]
      }
    ),
    t && /* @__PURE__ */ g.jsx("p", { className: "text-[10px] text-muted-foreground/70 break-words", children: t }),
    n && /* @__PURE__ */ g.jsx("p", { className: "text-[10px] text-destructive", children: n })
  ] });
};
class Tl {
  // 10
  /**
   *  API 
   */
  static async fetchModels(t, n) {
    switch (t) {
      case "openai":
        return this.fetchOpenAIModels(n);
      case "ollama":
        return this.fetchOllamaModels(n);
      case "vllm":
        return this.fetchVLLMModels(n);
      case "cohere":
        return this.fetchCohereModels(n);
      case "jina":
      case "voyage":
        return this.getPresetModels(t);
      default:
        return ve.warn("ModelService", `Unknown API type: ${t}`), [];
    }
  }
  /**
   *  OpenAI  API 
   * : OpenAI, Azure,  OpenAI 
   */
  static async fetchOpenAIModels(t) {
    const { apiUrl: n, apiKey: r, timeout: i = this.DEFAULT_TIMEOUT } = t, s = n.replace(/\/+$/, ""), o = s.endsWith("/v1") ? `${s}/models` : `${s}/v1/models`;
    try {
      const u = new AbortController(), c = setTimeout(() => u.abort(), i), d = {
        "Content-Type": "application/json"
      };
      r && (d.Authorization = `Bearer ${r}`);
      const m = await fetch(o, {
        method: "GET",
        headers: d,
        signal: u.signal
      });
      if (clearTimeout(c), !m.ok)
        throw new Error(`HTTP ${m.status}: ${m.statusText}`);
      const p = await m.json(), x = (p.data || p || []).map((b) => ({
        id: b.id || b.model,
        name: b.name || b.id || b.model,
        owned_by: b.owned_by
      }));
      return ve.info("ModelService", `Fetched ${x.length} models from OpenAI API`), x.sort((b, S) => b.id.localeCompare(S.id));
    } catch (u) {
      throw u.name === "AbortError" ? ve.error("ModelService", "OpenAI API request timeout") : ve.error("ModelService", `OpenAI API error: ${u.message}`), u;
    }
  }
  /**
   *  Ollama 
   */
  static async fetchOllamaModels(t) {
    const { apiUrl: n, timeout: r = this.DEFAULT_TIMEOUT } = t, s = `${n.replace(/\/+$/, "")}/api/tags`;
    try {
      const o = new AbortController(), u = setTimeout(() => o.abort(), r), c = await fetch(s, {
        method: "GET",
        signal: o.signal
      });
      if (clearTimeout(u), !c.ok)
        throw new Error(`HTTP ${c.status}: ${c.statusText}`);
      const m = ((await c.json()).models || []).map((p) => ({
        id: p.name || p.model,
        name: p.name || p.model
      }));
      return ve.info("ModelService", `Fetched ${m.length} models from Ollama`), m;
    } catch (o) {
      throw ve.error("ModelService", `Ollama API error: ${o.message}`), o;
    }
  }
  /**
   *  vLLM 
   * vLLM  OpenAI  API
   */
  static async fetchVLLMModels(t) {
    return this.fetchOpenAIModels(t);
  }
  /**
   *  Cohere 
   */
  static async fetchCohereModels(t) {
    const { apiKey: n, timeout: r = this.DEFAULT_TIMEOUT } = t;
    if (!n)
      return ve.warn("ModelService", "Cohere API key required"), this.getPresetModels("cohere");
    try {
      const i = new AbortController(), s = setTimeout(() => i.abort(), r), o = await fetch("https://api.cohere.ai/v1/models", {
        method: "GET",
        headers: {
          Authorization: `Bearer ${n}`,
          "Content-Type": "application/json"
        },
        signal: i.signal
      });
      if (clearTimeout(s), !o.ok)
        throw new Error(`HTTP ${o.status}: ${o.statusText}`);
      const c = ((await o.json()).models || []).filter((d) => {
        var m;
        return (m = d.endpoints) == null ? void 0 : m.includes("embed");
      }).map((d) => ({
        id: d.name,
        name: d.name,
        contextLength: d.context_length
      }));
      return ve.info("ModelService", `Fetched ${c.length} embed models from Cohere`), c;
    } catch (i) {
      return ve.error("ModelService", `Cohere API error: ${i.message}`), this.getPresetModels("cohere");
    }
  }
  /**
   * 
   */
  static getPresetModels(t) {
    return {
      cohere: [
        { id: "embed-multilingual-v3.0", name: "Embed Multilingual v3.0" },
        { id: "embed-english-v3.0", name: "Embed English v3.0" },
        { id: "embed-multilingual-light-v3.0", name: "Embed Multilingual Light v3.0" },
        { id: "embed-english-light-v3.0", name: "Embed English Light v3.0" }
      ],
      jina: [
        { id: "jina-embeddings-v3", name: "Jina Embeddings v3" },
        { id: "jina-embeddings-v2-base-en", name: "Jina Embeddings v2 Base EN" },
        { id: "jina-embeddings-v2-base-zh", name: "Jina Embeddings v2 Base ZH" },
        { id: "jina-colbert-v2", name: "Jina ColBERT v2" }
      ],
      voyage: [
        { id: "voyage-3", name: "Voyage 3" },
        { id: "voyage-3-lite", name: "Voyage 3 Lite" },
        { id: "voyage-large-2", name: "Voyage Large 2" },
        { id: "voyage-code-2", name: "Voyage Code 2" },
        { id: "voyage-multilingual-2", name: "Voyage Multilingual 2" }
      ],
      openai: [
        { id: "text-embedding-3-large", name: "Text Embedding 3 Large" },
        { id: "text-embedding-3-small", name: "Text Embedding 3 Small" },
        { id: "text-embedding-ada-002", name: "Text Embedding Ada 002" }
      ]
    }[t] || [];
  }
  /**
   *  Rerank 
   */
  static getCommonRerankModels() {
    return [
      { id: "BAAI/bge-reranker-v2-m3", name: "BGE Reranker v2 m3" },
      { id: "BAAI/bge-reranker-large", name: "BGE Reranker Large" },
      { id: "BAAI/bge-reranker-base", name: "BGE Reranker Base" },
      { id: "cross-encoder/ms-marco-MiniLM-L-12-v2", name: "MS MARCO MiniLM L12" },
      { id: "Xenova/ms-marco-MiniLM-L-6-v2", name: "MS MARCO MiniLM L6 (ONNX)" },
      { id: "jinaai/jina-reranker-v2-base-multilingual", name: "Jina Reranker v2 Multilingual" }
    ];
  }
}
vt(Tl, "DEFAULT_TIMEOUT", 1e4);
const dX = [
  { value: "openai", label: "OpenAI" },
  { value: "anthropic", label: "Anthropic" },
  { value: "ollama", label: "Ollama" },
  { value: "vllm", label: "vLLM" },
  { value: "azure", label: "Azure OpenAI" },
  { value: "custom", label: "" }
], hX = [
  { value: "tavern", label: "" },
  { value: "tavern_profile", label: "" },
  { value: "custom", label: " API " }
];
function mX() {
  var e, t, n, r;
  try {
    const i = (n = (t = (e = window.SillyTavern) == null ? void 0 : e.getContext) == null ? void 0 : t.call(e)) == null ? void 0 : n.extensionSettings;
    return ((r = i == null ? void 0 : i.connectionManager) == null ? void 0 : r.profiles) || [];
  } catch (i) {
    return console.warn("[Engram]  connection_profiles:", i), [];
  }
}
const i8 = ({
  preset: e,
  onChange: t,
  isNew: n = !1
}) => {
  var z, I, L, K, ne, Y;
  const [r, i] = F.useState([]), [s, o] = F.useState(!1), [u, c] = F.useState([]), [d, m] = F.useState(!1), [p, x] = F.useState(null), b = () => {
    o(!0);
    try {
      const H = mX();
      i(H);
    } finally {
      o(!1);
    }
  }, S = async () => {
    const { apiUrl: H, apiKey: Z, apiSource: me } = e.custom || {};
    if (!H) {
      x(" API URL");
      return;
    }
    m(!0), x(null);
    try {
      let Q = [];
      me === "ollama" ? Q = await Tl.fetchOllamaModels({ apiUrl: H }) : Q = await Tl.fetchOpenAIModels({ apiUrl: H, apiKey: Z }), c(Q), Q.length === 0 && x("");
    } catch (Q) {
      x(Q.message || ""), c([]);
    } finally {
      m(!1);
    }
  };
  F.useEffect(() => {
    b();
  }, []);
  const k = (H) => {
    t({ ...e, ...H, updatedAt: Date.now() });
  }, A = (H, Z) => {
    k({
      parameters: { ...e.parameters, [H]: Z }
    });
  }, T = (H, Z) => {
    var me, Q, se, J;
    k({
      custom: {
        apiUrl: ((me = e.custom) == null ? void 0 : me.apiUrl) || "",
        apiKey: ((Q = e.custom) == null ? void 0 : Q.apiKey) || "",
        model: ((se = e.custom) == null ? void 0 : se.model) || "",
        apiSource: ((J = e.custom) == null ? void 0 : J.apiSource) || "openai",
        [H]: Z
      }
    });
  }, M = (H) => {
    const Z = H;
    k({
      source: Z,
      tavernProfileId: Z === "tavern_profile" ? e.tavernProfileId : void 0
    }), Z === "tavern_profile" && b();
  }, j = r.map((H) => ({
    value: H.id,
    label: `${H.name} (${H.api || "Unknown"} - ${H.model || "Unknown"})`
  })), D = r.find((H) => H.id === e.tavernProfileId);
  return /* @__PURE__ */ g.jsxs("div", { className: "", children: [
    /* @__PURE__ */ g.jsxs(ca, { title: "", children: [
      /* @__PURE__ */ g.jsx(
        wi,
        {
          label: "",
          value: e.name,
          onChange: (H) => k({ name: H }),
          placeholder: "",
          required: !0
        }
      ),
      /* @__PURE__ */ g.jsx(
        xu,
        {
          label: "",
          value: e.source,
          onChange: M,
          options: hX,
          description: " API "
        }
      )
    ] }),
    e.source === "tavern_profile" && /* @__PURE__ */ g.jsxs(ca, { title: "", description: "", children: [
      /* @__PURE__ */ g.jsxs("div", { className: "flex items-end gap-2", children: [
        /* @__PURE__ */ g.jsx(
          xu,
          {
            className: "flex-1 !mb-0",
            label: "",
            value: e.tavernProfileId || "",
            onChange: (H) => k({ tavernProfileId: H }),
            options: j,
            placeholder: s ? "..." : "",
            disabled: s || j.length === 0
          }
        ),
        /* @__PURE__ */ g.jsx(
          "button",
          {
            type: "button",
            className: "h-[42px] w-[42px] min-w-[42px] flex items-center justify-center border-none rounded-md bg-muted text-muted-foreground cursor-pointer transition-all hover:bg-accent hover:text-foreground",
            onClick: b,
            disabled: s,
            title: "",
            children: /* @__PURE__ */ g.jsx(zr, { size: 16, className: s ? "animate-spin" : "" })
          }
        )
      ] }),
      j.length === 0 && !s && /* @__PURE__ */ g.jsx("div", { className: "p-3 bg-muted/30 border border-dashed border-border rounded-lg text-muted-foreground text-sm text-center mt-3", children: "" }),
      D && /* @__PURE__ */ g.jsxs("div", { className: "mt-4 p-3 bg-card rounded-lg border border-border", children: [
        /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-2 py-1 text-sm border-b border-border last:border-0", children: [
          /* @__PURE__ */ g.jsx("span", { className: "text-muted-foreground min-w-[60px]", children: "API:" }),
          /* @__PURE__ */ g.jsx("span", { className: "text-foreground font-mono", children: D.api || "-" })
        ] }),
        /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-2 py-1 text-sm border-b border-border last:border-0", children: [
          /* @__PURE__ */ g.jsx("span", { className: "text-muted-foreground min-w-[60px]", children: ":" }),
          /* @__PURE__ */ g.jsx("span", { className: "text-foreground font-mono", children: D.model || "-" })
        ] }),
        /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-2 py-1 text-sm border-b border-border last:border-0", children: [
          /* @__PURE__ */ g.jsx("span", { className: "text-muted-foreground min-w-[60px]", children: ":" }),
          /* @__PURE__ */ g.jsx("span", { className: "text-foreground font-mono", children: D.preset || "-" })
        ] })
      ] })
    ] }),
    e.source === "custom" && /* @__PURE__ */ g.jsxs(ca, { title: "API ", description: " API ", children: [
      /* @__PURE__ */ g.jsx(
        xu,
        {
          label: "API ",
          value: ((z = e.custom) == null ? void 0 : z.apiSource) || "openai",
          onChange: (H) => T("apiSource", H),
          options: dX
        }
      ),
      /* @__PURE__ */ g.jsx(
        wi,
        {
          label: "API URL",
          type: "url",
          value: ((I = e.custom) == null ? void 0 : I.apiUrl) || "",
          onChange: (H) => T("apiUrl", H),
          placeholder: "https://api.openai.com/v1",
          required: !0
        }
      ),
      /* @__PURE__ */ g.jsx(
        wi,
        {
          label: "API Key",
          type: "password",
          value: ((L = e.custom) == null ? void 0 : L.apiKey) || "",
          onChange: (H) => T("apiKey", H),
          placeholder: "sk-..."
        }
      ),
      /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col gap-2", children: [
        /* @__PURE__ */ g.jsxs("div", { className: "flex items-end gap-2", children: [
          u.length > 0 ? /* @__PURE__ */ g.jsx(
            xu,
            {
              className: "flex-1 !mb-0",
              label: "",
              value: ((K = e.custom) == null ? void 0 : K.model) || "",
              onChange: (H) => T("model", H),
              options: u.map((H) => ({ value: H.id, label: H.name || H.id })),
              placeholder: ""
            }
          ) : /* @__PURE__ */ g.jsx(
            wi,
            {
              className: "flex-1 !mb-0",
              label: "",
              value: ((ne = e.custom) == null ? void 0 : ne.model) || "",
              onChange: (H) => T("model", H),
              placeholder: "gpt-4o-mini",
              required: !0
            }
          ),
          /* @__PURE__ */ g.jsx(
            "button",
            {
              type: "button",
              className: "h-[42px] w-[42px] min-w-[42px] flex items-center justify-center border-none rounded-md bg-muted text-muted-foreground cursor-pointer transition-all hover:bg-accent hover:text-foreground disabled:opacity-50 disabled:cursor-not-allowed",
              onClick: S,
              disabled: d || !((Y = e.custom) != null && Y.apiUrl),
              title: "",
              children: d ? /* @__PURE__ */ g.jsx(Eu, { size: 16, className: "animate-spin" }) : /* @__PURE__ */ g.jsx(zr, { size: 16 })
            }
          )
        ] }),
        p && /* @__PURE__ */ g.jsx("p", { className: "text-xs text-destructive", children: p }),
        u.length > 0 && /* @__PURE__ */ g.jsxs("p", { className: "text-xs text-muted-foreground", children: [
          " ",
          u.length,
          " "
        ] })
      ] })
    ] }),
    /* @__PURE__ */ g.jsxs(ca, { title: "", description: "", children: [
      /* @__PURE__ */ g.jsx(
        bi,
        {
          label: " (Temperature)",
          value: e.parameters.temperature,
          onChange: (H) => A("temperature", H),
          min: 0,
          max: 2,
          step: 0.1,
          description: ""
        }
      ),
      /* @__PURE__ */ g.jsx(
        bi,
        {
          label: "Top-P",
          value: e.parameters.topP,
          onChange: (H) => A("topP", H),
          min: 0,
          max: 1,
          step: 0.05,
          description: " token "
        }
      ),
      /* @__PURE__ */ g.jsx(
        bi,
        {
          label: " Tokens",
          value: e.parameters.maxTokens,
          onChange: (H) => A("maxTokens", H),
          min: 64,
          max: 16384,
          step: 64,
          showSlider: !1
        }
      ),
      /* @__PURE__ */ g.jsx(
        bi,
        {
          label: "",
          value: e.parameters.frequencyPenalty,
          onChange: (H) => A("frequencyPenalty", H),
          min: -2,
          max: 2,
          step: 0.1,
          description: " token "
        }
      ),
      /* @__PURE__ */ g.jsx(
        bi,
        {
          label: "",
          value: e.parameters.presencePenalty,
          onChange: (H) => A("presencePenalty", H),
          min: -2,
          max: 2,
          step: 0.1,
          description: ""
        }
      )
    ] })
  ] });
}, pX = [
  { value: "custom", label: " (OpenAI )" },
  { value: "transformers", label: "Transformers ()" },
  { value: "openai", label: "OpenAI Embeddings" },
  { value: "ollama", label: "Ollama" },
  { value: "vllm", label: "vLLM" },
  { value: "cohere", label: "Cohere" },
  { value: "jina", label: "Jina AI" },
  { value: "voyage", label: "Voyage AI" }
], a8 = {
  custom: "text-embedding-3-small",
  transformers: "Xenova/all-MiniLM-L6-v2",
  openai: "text-embedding-3-small",
  ollama: "nomic-embed-text",
  vllm: "BAAI/bge-m3",
  cohere: "embed-multilingual-v3.0",
  jina: "jina-embeddings-v3",
  voyage: "voyage-large-2"
}, s8 = ["custom", "ollama", "vllm"], o8 = ["custom", "openai", "cohere", "jina", "voyage"], gX = ({
  config: e,
  onChange: t
}) => {
  var b;
  const n = (S) => {
    t({ ...e, ...S });
  }, r = (S) => {
    n({
      source: S,
      model: a8[S],
      apiUrl: s8.includes(S) ? e.apiUrl : void 0,
      apiKey: o8.includes(S) ? e.apiKey : void 0
    });
  }, i = s8.includes(e.source), s = o8.includes(e.source), [o, u] = F.useState([]), [c, d] = F.useState(!1), [m, p] = F.useState(null), x = async () => {
    d(!0), p(null);
    try {
      let S = [];
      const k = { apiUrl: e.apiUrl || "", apiKey: e.apiKey };
      switch (e.source) {
        case "custom":
          if (!e.apiUrl) {
            p(" API URL");
            return;
          }
          S = await Tl.fetchOpenAIModels(k);
          break;
        case "ollama":
          if (!e.apiUrl) {
            p(" API URL");
            return;
          }
          S = await Tl.fetchOllamaModels(k);
          break;
        case "vllm":
          if (!e.apiUrl) {
            p(" API URL");
            return;
          }
          S = await Tl.fetchVLLMModels(k);
          break;
        case "openai":
        case "cohere":
        case "jina":
        case "voyage":
          S = Tl.getPresetModels(e.source);
          break;
        default:
          S = [];
      }
      u(S), S.length === 0 && p("");
    } catch (S) {
      p(S.message || ""), u([]);
    } finally {
      d(!1);
    }
  };
  return /* @__PURE__ */ g.jsxs("div", { className: "", children: [
    /* @__PURE__ */ g.jsxs(ca, { title: "", description: "", children: [
      /* @__PURE__ */ g.jsx(
        xu,
        {
          label: "",
          value: e.source,
          onChange: (S) => r(S),
          options: pX,
          description: ""
        }
      ),
      i && /* @__PURE__ */ g.jsx(
        wi,
        {
          label: e.source === "ollama" ? "API Endpoint ()" : " API URL",
          type: "url",
          value: e.apiUrl || "",
          onChange: (S) => n({ apiUrl: S }),
          placeholder: e.source === "ollama" ? "http://localhost:11434/api/embeddings" : "https://api.openai.com/v1/embeddings",
          description: e.source === "ollama" ? ": http://localhost:11434/api/embeddings" : " /v1/embeddings"
        }
      ),
      s && /* @__PURE__ */ g.jsx(
        wi,
        {
          label: "API Key",
          type: "password",
          value: e.apiKey || "",
          onChange: (S) => n({ apiKey: S }),
          placeholder: " API "
        }
      ),
      /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col gap-2", children: [
        /* @__PURE__ */ g.jsxs("div", { className: "flex items-end gap-2", children: [
          o.length > 0 ? /* @__PURE__ */ g.jsx("div", { className: "flex-1 relative", children: /* @__PURE__ */ g.jsx(
            fD,
            {
              className: "!mb-0",
              label: "",
              value: e.model || "",
              onChange: (S) => n({ model: S }),
              options: o.map((S) => ({ value: S.id, label: S.name || S.id })),
              placeholder: "",
              emptyText: ""
            }
          ) }) : /* @__PURE__ */ g.jsx(
            wi,
            {
              className: "flex-1 !mb-0",
              label: "",
              value: e.model || "",
              onChange: (S) => n({ model: S }),
              placeholder: a8[e.source],
              description: ""
            }
          ),
          (i || s) && /* @__PURE__ */ g.jsx(
            "button",
            {
              type: "button",
              className: "h-[42px] w-[42px] min-w-[42px] flex items-center justify-center border-none rounded-md bg-muted text-muted-foreground cursor-pointer transition-all hover:bg-accent hover:text-foreground disabled:opacity-50 disabled:cursor-not-allowed",
              onClick: x,
              disabled: c,
              title: "",
              children: c ? /* @__PURE__ */ g.jsx(Eu, { size: 16, className: "animate-spin" }) : /* @__PURE__ */ g.jsx(zr, { size: 16 })
            }
          )
        ] }),
        m && /* @__PURE__ */ g.jsx("p", { className: "text-xs text-destructive", children: m }),
        o.length > 0 && /* @__PURE__ */ g.jsxs("p", { className: "text-xs text-muted-foreground", children: [
          " ",
          o.length,
          " "
        ] })
      ] })
    ] }),
    /* @__PURE__ */ g.jsx(ca, { title: "", collapsible: !0, defaultCollapsed: !0, children: /* @__PURE__ */ g.jsx(
      wi,
      {
        label: "",
        value: ((b = e.dimensions) == null ? void 0 : b.toString()) || "",
        onChange: (S) => {
          const k = parseInt(S, 10);
          n({ dimensions: isNaN(k) ? void 0 : k });
        },
        placeholder: "",
        description: ""
      }
    ) })
  ] });
}, yX = ({
  config: e,
  onChange: t
}) => {
  const n = (m) => {
    t({ ...e, ...m });
  }, [r, i] = F.useState([]), [s, o] = F.useState(!1), [u, c] = F.useState(null), d = async () => {
    if (!e.url) {
      c(" API URL");
      return;
    }
    o(!0), c(null);
    try {
      const m = await Tl.fetchOpenAIModels({
        apiUrl: e.url,
        apiKey: e.apiKey
      });
      m.length > 0 ? i(m) : i(Tl.getCommonRerankModels());
    } catch {
      i(Tl.getCommonRerankModels());
    } finally {
      o(!1);
    }
  };
  return /* @__PURE__ */ g.jsxs("div", { className: "", children: [
    /* @__PURE__ */ g.jsx(ca, { title: "Rerank ", description: "", children: /* @__PURE__ */ g.jsx(
      So,
      {
        label: " Rerank",
        checked: e.enabled,
        onChange: (m) => n({ enabled: m }),
        description: " Rerank "
      }
    ) }),
    e.enabled && /* @__PURE__ */ g.jsxs(g.Fragment, { children: [
      /* @__PURE__ */ g.jsxs(ca, { title: "API ", children: [
        /* @__PURE__ */ g.jsx(
          wi,
          {
            label: "API URL",
            type: "url",
            value: e.url,
            onChange: (m) => n({ url: m }),
            placeholder: "http://localhost:8000/rerank",
            description: "Rerank  API ",
            required: !0
          }
        ),
        /* @__PURE__ */ g.jsx(
          wi,
          {
            label: "API Key",
            type: "password",
            value: e.apiKey,
            onChange: (m) => n({ apiKey: m }),
            placeholder: " API "
          }
        ),
        /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col gap-2", children: [
          /* @__PURE__ */ g.jsxs("div", { className: "flex items-end gap-2", children: [
            r.length > 0 ? /* @__PURE__ */ g.jsx("div", { className: "flex-1 relative", children: /* @__PURE__ */ g.jsx(
              fD,
              {
                className: "!mb-0",
                label: "",
                value: e.model,
                onChange: (m) => n({ model: m }),
                options: r.map((m) => ({ value: m.id, label: m.name || m.id })),
                placeholder: "",
                emptyText: ""
              }
            ) }) : /* @__PURE__ */ g.jsx(
              wi,
              {
                className: "flex-1 !mb-0",
                label: "",
                value: e.model,
                onChange: (m) => n({ model: m }),
                placeholder: "BAAI/bge-reranker-v2-m3",
                description: " Rerank ",
                required: !0
              }
            ),
            /* @__PURE__ */ g.jsx(
              "button",
              {
                type: "button",
                className: "h-[42px] w-[42px] min-w-[42px] flex items-center justify-center border-none rounded-md bg-muted text-muted-foreground cursor-pointer transition-all hover:bg-accent hover:text-foreground disabled:opacity-50 disabled:cursor-not-allowed",
                onClick: d,
                disabled: s,
                title: "",
                children: s ? /* @__PURE__ */ g.jsx(Eu, { size: 16, className: "animate-spin" }) : /* @__PURE__ */ g.jsx(zr, { size: 16 })
              }
            )
          ] }),
          u && /* @__PURE__ */ g.jsx("p", { className: "text-xs text-destructive", children: u }),
          r.length > 0 && /* @__PURE__ */ g.jsxs("p", { className: "text-xs text-muted-foreground", children: [
            " ",
            r.length,
            " "
          ] })
        ] })
      ] }),
      /* @__PURE__ */ g.jsxs(ca, { title: "", children: [
        /* @__PURE__ */ g.jsx(
          bi,
          {
            label: "Top-N",
            value: e.topN,
            onChange: (m) => n({ topN: m }),
            min: 1,
            max: 50,
            step: 1,
            description: ""
          }
        ),
        /* @__PURE__ */ g.jsx(
          bi,
          {
            label: " (Hybrid Alpha)",
            value: e.hybridAlpha,
            onChange: (m) => n({ hybridAlpha: m }),
            min: 0,
            max: 1,
            step: 0.1,
            description: "0 = 1 =  Rerank "
          }
        )
      ] })
    ] })
  ] });
};
function vX(e) {
  switch (e) {
    case "summary":
      return "text-blue-500 bg-blue-500/10 border border-blue-500/20";
    case "trim":
      return "text-orange-500 bg-orange-500/10 border border-orange-500/20";
    case "preprocessing":
      return "text-emerald-500 bg-emerald-500/10 border border-emerald-500/20";
    default:
      return "text-muted-foreground bg-muted border border-border";
  }
}
function xX(e) {
  var t;
  return ((t = o0.find((n) => n.value === e)) == null ? void 0 : t.label) || e;
}
const bX = ({
  template: e,
  isSelected: t = !1,
  onSelect: n,
  onCopy: r,
  onDelete: i,
  onToggleEnabled: s,
  onImport: o,
  onResetToDefault: u
}) => {
  const c = F.useRef(null), d = (b) => {
    b.stopPropagation();
    const S = {
      version: "1.0",
      exportedAt: Date.now(),
      template: {
        name: e.name,
        category: e.category,
        boundPresetId: e.boundPresetId,
        systemPrompt: e.systemPrompt,
        userPromptTemplate: e.userPromptTemplate
      }
    }, k = new Blob([JSON.stringify(S, null, 2)], { type: "application/json" }), A = URL.createObjectURL(k), T = document.createElement("a");
    T.href = A, T.download = `engram_template_${e.name.replace(/\s+/g, "_")}.json`, T.click(), URL.revokeObjectURL(A);
  }, m = (b) => {
    var S;
    b.stopPropagation(), (S = c.current) == null || S.click();
  }, p = (b) => {
    var A;
    const S = (A = b.target.files) == null ? void 0 : A[0];
    if (!S || !o) return;
    const k = new FileReader();
    k.onload = (T) => {
      var M;
      try {
        const j = JSON.parse((M = T.target) == null ? void 0 : M.result);
        if (j.version && j.template) {
          const D = Cl(
            j.template.name,
            j.template.category,
            {
              enabled: e.enabled,
              // 
              isBuiltIn: e.isBuiltIn,
              // 
              boundPresetId: j.template.boundPresetId,
              systemPrompt: j.template.systemPrompt,
              userPromptTemplate: j.template.userPromptTemplate
            }
          );
          D.id = e.id, o(D);
        }
      } catch (j) {
        console.error(":", j);
      }
    }, k.readAsText(S), c.current && (c.current.value = "");
  }, x = e.category === "preprocessing";
  return /* @__PURE__ */ g.jsxs(
    "div",
    {
      className: `
                group relative p-3 rounded-lg border cursor-pointer transition-all duration-200
                ${t ? "bg-accent/50 border-input" : "bg-transparent border-transparent hover:bg-muted/50 hover:border-border"}
                ${!e.enabled && !x && "opacity-50"}
            `,
      onClick: n,
      children: [
        /* @__PURE__ */ g.jsxs("div", { className: "flex items-start gap-3", children: [
          x ? (
            // ""
            /* @__PURE__ */ g.jsx(
              "div",
              {
                className: "w-8 h-8 flex items-center justify-center rounded-lg bg-emerald-500/10 text-emerald-500 flex-shrink-0",
                title: " ()",
                children: /* @__PURE__ */ g.jsx(Kv, { size: 16 })
              }
            )
          ) : /* @__PURE__ */ g.jsx(
            "button",
            {
              className: `
                            w-8 h-8 flex items-center justify-center rounded-lg transition-colors flex-shrink-0
                            ${e.enabled ? "bg-primary/10 text-primary" : "bg-muted text-muted-foreground hover:bg-muted/80"}
                        `,
              onClick: (b) => {
                b.stopPropagation(), s == null || s(!e.enabled);
              },
              title: e.enabled ? "" : "",
              children: /* @__PURE__ */ g.jsx(Qv, { size: 16 })
            }
          ),
          /* @__PURE__ */ g.jsxs("div", { className: "flex-1 min-w-0", children: [
            /* @__PURE__ */ g.jsxs("div", { className: "flex items-center justify-between gap-2", children: [
              /* @__PURE__ */ g.jsx("h4", { className: `text-sm font-medium truncate ${t ? "text-foreground" : "text-muted-foreground group-hover:text-foreground"} ${!e.enabled && "line-through"}`, children: e.name }),
              /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-1.5 flex-shrink-0", children: [
                /* @__PURE__ */ g.jsx("span", { className: `text-[10px] px-1.5 py-0.5 rounded-sm font-medium ${vX(e.category)}`, children: xX(e.category) }),
                e.isBuiltIn && /* @__PURE__ */ g.jsx("span", { className: "text-[10px] px-1.5 py-0.5 rounded-sm bg-muted text-muted-foreground", children: "BUILTIN" })
              ] })
            ] }),
            /* @__PURE__ */ g.jsx("div", { className: "mt-1 flex items-center justify-between text-[10px] text-muted-foreground/70 font-mono", children: /* @__PURE__ */ g.jsx("span", { className: "truncate max-w-[120px]", children: e.boundPresetId ? `BOUND: ${e.boundPresetId}` : "DEFAULT PRESET" }) })
          ] })
        ] }),
        /* @__PURE__ */ g.jsxs("div", { className: `mt-2 flex justify-end gap-1 ${t || "opacity-0 group-hover:opacity-100"} transition-opacity`, children: [
          /* @__PURE__ */ g.jsx("button", { className: "p-1.5 hover:bg-muted rounded text-muted-foreground hover:text-foreground transition-colors", onClick: m, title: "Import", children: /* @__PURE__ */ g.jsx(lR, { size: 12 }) }),
          /* @__PURE__ */ g.jsx("button", { className: "p-1.5 hover:bg-muted rounded text-muted-foreground hover:text-foreground transition-colors", onClick: d, title: "Export", children: /* @__PURE__ */ g.jsx(Kg, { size: 12 }) }),
          /* @__PURE__ */ g.jsx("button", { className: "p-1.5 hover:bg-muted rounded text-muted-foreground hover:text-foreground transition-colors", onClick: (b) => {
            b.stopPropagation(), r == null || r();
          }, title: "Copy", children: /* @__PURE__ */ g.jsx(bC, { size: 12 }) }),
          e.isBuiltIn && /* @__PURE__ */ g.jsx(
            "button",
            {
              className: "p-1.5 hover:bg-amber-500/10 rounded text-muted-foreground hover:text-amber-500 transition-colors",
              onClick: (b) => {
                b.stopPropagation();
                let S = MC(e.id);
                S || (S = tx(e.category)), S && u && u({
                  ...S,
                  id: e.id,
                  enabled: e.enabled
                });
              },
              title: "",
              children: /* @__PURE__ */ g.jsx(iR, { size: 12 })
            }
          ),
          !e.isBuiltIn && /* @__PURE__ */ g.jsx("button", { className: "p-1.5 hover:bg-destructive/10 rounded text-muted-foreground hover:text-destructive transition-colors", onClick: (b) => {
            b.stopPropagation(), i == null || i();
          }, title: "Delete", children: /* @__PURE__ */ g.jsx(jo, { size: 12 }) })
        ] }),
        /* @__PURE__ */ g.jsx(
          "input",
          {
            ref: c,
            type: "file",
            accept: ".json",
            onChange: p,
            className: "hidden"
          }
        )
      ]
    }
  );
}, wX = ({
  templates: e,
  selectedId: t,
  onSelect: n,
  onAdd: r,
  onUpdate: i,
  onDelete: s
}) => {
  const o = () => {
    const p = Cl(
      ` ${e.length + 1}`,
      "summary"
    );
    r(p), n(p);
  }, u = (p) => {
    const x = Cl(
      `${p.name} ()`,
      p.category,
      {
        enabled: !1,
        // 
        boundPresetId: p.boundPresetId,
        systemPrompt: p.systemPrompt,
        userPromptTemplate: p.userPromptTemplate
      }
    );
    r(x);
  }, c = (p, x) => {
    x && e.filter((b) => b.category === p.category && b.id !== p.id && b.enabled).forEach((b) => i({ ...b, enabled: !1 })), i({ ...p, enabled: x });
  }, d = (p) => {
    i(p);
  }, m = o0.map((p) => ({
    ...p,
    templates: e.filter((x) => x.category === p.value)
  })).filter((p) => p.templates.length > 0);
  return /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col gap-4 h-full", children: [
    /* @__PURE__ */ g.jsxs("div", { className: "flex items-center justify-between gap-2", children: [
      /* @__PURE__ */ g.jsx("h3", { className: "text-xs font-bold text-muted-foreground uppercase tracking-wider", children: "" }),
      /* @__PURE__ */ g.jsx(
        "button",
        {
          className: "text-muted-foreground hover:text-foreground transition-colors",
          onClick: o,
          children: /* @__PURE__ */ g.jsx(SC, { size: 16 })
        }
      )
    ] }),
    /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col gap-6 overflow-y-auto flex-1 no-scrollbar", children: [
      m.map((p) => /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col gap-2", children: [
        /* @__PURE__ */ g.jsxs("div", { className: "text-[10px] items-center gap-2 text-muted-foreground font-medium px-1 uppercase tracking-wider flex", children: [
          p.label,
          /* @__PURE__ */ g.jsx("div", { className: "h-px bg-border flex-1" })
        ] }),
        /* @__PURE__ */ g.jsx("div", { className: "flex flex-col gap-1", children: p.templates.map((x) => /* @__PURE__ */ g.jsx(
          bX,
          {
            template: x,
            isSelected: t === x.id,
            onSelect: () => n(x),
            onCopy: () => u(x),
            onDelete: () => s(x),
            onToggleEnabled: (b) => c(x, b),
            onImport: d,
            onResetToDefault: (b) => i(b)
          },
          x.id
        )) })
      ] }, p.value)),
      e.length === 0 && /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col items-center justify-center py-12 text-muted-foreground gap-2 border border-dashed border-border rounded-lg", children: [
        /* @__PURE__ */ g.jsx(zm, { size: 24, className: "opacity-50" }),
        /* @__PURE__ */ g.jsx("p", { className: "text-xs", children: "" })
      ] })
    ] })
  ] });
}, _X = [
  // Context
  { name: "{{userInput}}", desc: "", category: "Context ()" },
  { name: "{{chatHistory}}", desc: ": {{chatHistory:20}}", category: "Context ()" },
  { name: "{{context}}", desc: " (Description/Persona...)", category: "Context ()" },
  { name: "{{worldbookContext}}", desc: "", category: "Context ()" },
  { name: "{{userPersona}}", desc: " (Persona Description)", category: "Context ()" },
  { name: "{{char}}", desc: "", category: "Context ()" },
  { name: "{{user}}", desc: "", category: "Context ()" },
  // Text Generation
  { name: "{{engramSummaries}}", desc: " (, /)", category: "Text Generation ()" },
  { name: "{{engramArchivedSummaries}}", desc: " ()", category: "Text Generation ()" },
  // Data Layer
  { name: "{{engramGraph}}", desc: " JSON (/)", category: "Data Layer ()" }
], SX = ({ macro: e }) => {
  const [t, n] = F.useState(!1), r = () => {
    navigator.clipboard.writeText(e.name), n(!0), setTimeout(() => n(!1), 2e3);
  };
  return /* @__PURE__ */ g.jsxs("div", { className: "flex items-center justify-between gap-2 p-1.5 rounded hover:bg-muted/50 group transition-colors", children: [
    /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col gap-0.5", children: [
      /* @__PURE__ */ g.jsx("code", { className: "text-[11px] text-primary font-mono font-medium", children: e.name }),
      /* @__PURE__ */ g.jsx("span", { className: "text-[10px] text-muted-foreground", children: e.desc })
    ] }),
    /* @__PURE__ */ g.jsx(
      "button",
      {
        onClick: r,
        className: "opacity-0 group-hover:opacity-100 transition-opacity p-1 hover:bg-muted rounded text-muted-foreground hover:text-foreground",
        title: "",
        children: t ? /* @__PURE__ */ g.jsx(Kv, { size: 12, className: "text-green-500" }) : /* @__PURE__ */ g.jsx(bC, { size: 12 })
      }
    )
  ] });
}, l8 = ({
  template: e,
  llmPresets: t,
  defaultPresetId: n,
  onChange: r
}) => {
  var u, c;
  const i = [
    { value: "", label: "" + (n ? ` (${((u = t.find((d) => d.id === n)) == null ? void 0 : u.name) || n})` : "") },
    ...t.map((d) => ({ value: d.id, label: d.name }))
  ], s = (d) => {
    r({ ...e, ...d, updatedAt: Date.now() });
  }, o = _X.reduce((d, m) => (d[m.category] || (d[m.category] = []), d[m.category].push(m), d), {});
  return /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col gap-4", children: [
    /* @__PURE__ */ g.jsxs(ca, { title: "", children: [
      /* @__PURE__ */ g.jsx(
        wi,
        {
          label: "",
          value: e.name,
          onChange: (d) => s({ name: d }),
          placeholder: "",
          required: !0,
          disabled: e.isBuiltIn
        }
      ),
      /* @__PURE__ */ g.jsx(
        xu,
        {
          label: "",
          value: e.category,
          onChange: (d) => s({ category: d }),
          options: o0.map((d) => ({ value: d.value, label: d.label })),
          description: (c = o0.find((d) => d.value === e.category)) == null ? void 0 : c.description
        }
      ),
      /* @__PURE__ */ g.jsx(
        xu,
        {
          label: "",
          value: e.boundPresetId || "",
          onChange: (d) => s({ boundPresetId: d || null }),
          options: i,
          description: " LLM "
        }
      ),
      e.category === "preprocessing" && /* @__PURE__ */ g.jsx(
        xu,
        {
          label: "",
          value: e.injectionMode || "replace",
          onChange: (d) => s({ injectionMode: d }),
          options: [
            { value: "replace", label: " (Overwrite)" },
            { value: "append", label: " (Append)" },
            { value: "prepend", label: " (Prepend)" }
          ],
          description: ""
        }
      )
    ] }),
    /* @__PURE__ */ g.jsxs(ca, { title: "", children: [
      /* @__PURE__ */ g.jsx(
        wi,
        {
          label: "",
          value: e.systemPrompt,
          onChange: (d) => s({ systemPrompt: d }),
          placeholder: "...",
          multiline: !0,
          rows: 4
        }
      ),
      /* @__PURE__ */ g.jsx(
        wi,
        {
          label: "",
          value: e.userPromptTemplate,
          onChange: (d) => s({ userPromptTemplate: d }),
          placeholder: "...",
          multiline: !0,
          rows: 6
        }
      )
    ] }),
    /* @__PURE__ */ g.jsxs("div", { className: "px-3 py-3 bg-muted/20 rounded-md border border-border/50 space-y-3", children: [
      /* @__PURE__ */ g.jsxs("div", { className: "text-[11px] font-semibold text-muted-foreground uppercase tracking-wider flex items-center gap-2", children: [
        /* @__PURE__ */ g.jsx("span", { children: "" }),
        /* @__PURE__ */ g.jsx("div", { className: "h-px bg-border flex-1" })
      ] }),
      /* @__PURE__ */ g.jsx("div", { className: "flex flex-col gap-4", children: Object.entries(o).map(([d, m]) => /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col gap-1", children: [
        /* @__PURE__ */ g.jsx("div", { className: "text-[10px] text-primary/70 font-medium px-1 mb-0.5", children: d }),
        /* @__PURE__ */ g.jsx("div", { className: "grid grid-cols-1 gap-px bg-border/20 rounded overflow-hidden", children: m.map((p) => /* @__PURE__ */ g.jsx("div", { className: "bg-background/50", children: /* @__PURE__ */ g.jsx(SX, { macro: p }) }, p.name)) })
      ] }, d)) })
    ] })
  ] });
}, dD = F.createContext({});
function D0(e) {
  const t = F.useRef(null);
  return t.current === null && (t.current = e()), t.current;
}
const eE = typeof window < "u", hD = eE ? F.useLayoutEffect : F.useEffect, tE = /* @__PURE__ */ F.createContext(null);
function nE(e, t) {
  e.indexOf(t) === -1 && e.push(t);
}
function rE(e, t) {
  const n = e.indexOf(t);
  n > -1 && e.splice(n, 1);
}
function CX([...e], t, n) {
  const r = t < 0 ? e.length + t : t;
  if (r >= 0 && r < e.length) {
    const i = n < 0 ? e.length + n : n, [s] = e.splice(t, 1);
    e.splice(i, 0, s);
  }
  return e;
}
const wu = (e, t, n) => n > t ? t : n < e ? e : n;
let iE = () => {
};
const _u = {}, mD = (e) => /^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);
function pD(e) {
  return typeof e == "object" && e !== null;
}
const gD = (e) => /^0[^.\s]+$/u.test(e);
// @__NO_SIDE_EFFECTS__
function aE(e) {
  let t;
  return () => (t === void 0 && (t = e()), t);
}
const Bs = /* @__NO_SIDE_EFFECTS__ */ (e) => e, EX = (e, t) => (n) => t(e(n)), I0 = (...e) => e.reduce(EX), d0 = /* @__NO_SIDE_EFFECTS__ */ (e, t, n) => {
  const r = t - e;
  return r === 0 ? 1 : (n - e) / r;
};
class sE {
  constructor() {
    this.subscriptions = [];
  }
  add(t) {
    return nE(this.subscriptions, t), () => rE(this.subscriptions, t);
  }
  notify(t, n, r) {
    const i = this.subscriptions.length;
    if (i)
      if (i === 1)
        this.subscriptions[0](t, n, r);
      else
        for (let s = 0; s < i; s++) {
          const o = this.subscriptions[s];
          o && o(t, n, r);
        }
  }
  getSize() {
    return this.subscriptions.length;
  }
  clear() {
    this.subscriptions.length = 0;
  }
}
const jl = /* @__NO_SIDE_EFFECTS__ */ (e) => e * 1e3, zs = /* @__NO_SIDE_EFFECTS__ */ (e) => e / 1e3;
function yD(e, t) {
  return t ? e * (1e3 / t) : 0;
}
const vD = (e, t, n) => (((1 - 3 * n + 3 * t) * e + (3 * n - 6 * t)) * e + 3 * t) * e, kX = 1e-7, TX = 12;
function NX(e, t, n, r, i) {
  let s, o, u = 0;
  do
    o = t + (n - t) / 2, s = vD(o, r, i) - e, s > 0 ? n = o : t = o;
  while (Math.abs(s) > kX && ++u < TX);
  return o;
}
function P0(e, t, n, r) {
  if (e === t && n === r)
    return Bs;
  const i = (s) => NX(s, 0, 1, e, n);
  return (s) => s === 0 || s === 1 ? s : vD(i(s), t, r);
}
const xD = (e) => (t) => t <= 0.5 ? e(2 * t) / 2 : (2 - e(2 * (1 - t))) / 2, bD = (e) => (t) => 1 - e(1 - t), wD = /* @__PURE__ */ P0(0.33, 1.53, 0.69, 0.99), oE = /* @__PURE__ */ bD(wD), _D = /* @__PURE__ */ xD(oE), SD = (e) => (e *= 2) < 1 ? 0.5 * oE(e) : 0.5 * (2 - Math.pow(2, -10 * (e - 1))), lE = (e) => 1 - Math.sin(Math.acos(e)), CD = bD(lE), ED = xD(lE), AX = /* @__PURE__ */ P0(0.42, 0, 1, 1), jX = /* @__PURE__ */ P0(0, 0, 0.58, 1), kD = /* @__PURE__ */ P0(0.42, 0, 0.58, 1), MX = (e) => Array.isArray(e) && typeof e[0] != "number", TD = (e) => Array.isArray(e) && typeof e[0] == "number", RX = {
  linear: Bs,
  easeIn: AX,
  easeInOut: kD,
  easeOut: jX,
  circIn: lE,
  circInOut: ED,
  circOut: CD,
  backIn: oE,
  backInOut: _D,
  backOut: wD,
  anticipate: SD
}, OX = (e) => typeof e == "string", u8 = (e) => {
  if (TD(e)) {
    iE(e.length === 4);
    const [t, n, r, i] = e;
    return P0(t, n, r, i);
  } else if (OX(e))
    return RX[e];
  return e;
}, U1 = [
  "setup",
  // Compute
  "read",
  // Read
  "resolveKeyframes",
  // Write/Read/Write/Read
  "preUpdate",
  // Compute
  "update",
  // Compute
  "preRender",
  // Compute
  "render",
  // Write
  "postRender"
  // Compute
];
function DX(e, t) {
  let n = /* @__PURE__ */ new Set(), r = /* @__PURE__ */ new Set(), i = !1, s = !1;
  const o = /* @__PURE__ */ new WeakSet();
  let u = {
    delta: 0,
    timestamp: 0,
    isProcessing: !1
  };
  function c(m) {
    o.has(m) && (d.schedule(m), e()), m(u);
  }
  const d = {
    /**
     * Schedule a process to run on the next frame.
     */
    schedule: (m, p = !1, x = !1) => {
      const S = x && i ? n : r;
      return p && o.add(m), S.has(m) || S.add(m), m;
    },
    /**
     * Cancel the provided callback from running on the next frame.
     */
    cancel: (m) => {
      r.delete(m), o.delete(m);
    },
    /**
     * Execute all schedule callbacks.
     */
    process: (m) => {
      if (u = m, i) {
        s = !0;
        return;
      }
      i = !0, [n, r] = [r, n], n.forEach(c), n.clear(), i = !1, s && (s = !1, d.process(m));
    }
  };
  return d;
}
const IX = 40;
function ND(e, t) {
  let n = !1, r = !0;
  const i = {
    delta: 0,
    timestamp: 0,
    isProcessing: !1
  }, s = () => n = !0, o = U1.reduce((j, D) => (j[D] = DX(s), j), {}), { setup: u, read: c, resolveKeyframes: d, preUpdate: m, update: p, preRender: x, render: b, postRender: S } = o, k = () => {
    const j = _u.useManualTiming ? i.timestamp : performance.now();
    n = !1, _u.useManualTiming || (i.delta = r ? 1e3 / 60 : Math.max(Math.min(j - i.timestamp, IX), 1)), i.timestamp = j, i.isProcessing = !0, u.process(i), c.process(i), d.process(i), m.process(i), p.process(i), x.process(i), b.process(i), S.process(i), i.isProcessing = !1, n && t && (r = !1, e(k));
  }, A = () => {
    n = !0, r = !0, i.isProcessing || e(k);
  };
  return { schedule: U1.reduce((j, D) => {
    const z = o[D];
    return j[D] = (I, L = !1, K = !1) => (n || A(), z.schedule(I, L, K)), j;
  }, {}), cancel: (j) => {
    for (let D = 0; D < U1.length; D++)
      o[U1[D]].cancel(j);
  }, state: i, steps: o };
}
const { schedule: nr, cancel: Su, state: vi, steps: m2 } = /* @__PURE__ */ ND(typeof requestAnimationFrame < "u" ? requestAnimationFrame : Bs, !0);
let ov;
function PX() {
  ov = void 0;
}
const qa = {
  now: () => (ov === void 0 && qa.set(vi.isProcessing || _u.useManualTiming ? vi.timestamp : performance.now()), ov),
  set: (e) => {
    ov = e, queueMicrotask(PX);
  }
}, AD = (e) => (t) => typeof t == "string" && t.startsWith(e), jD = /* @__PURE__ */ AD("--"), zX = /* @__PURE__ */ AD("var(--"), uE = (e) => zX(e) ? LX.test(e.split("/*")[0].trim()) : !1, LX = /var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu, Fm = {
  test: (e) => typeof e == "number",
  parse: parseFloat,
  transform: (e) => e
}, h0 = {
  ...Fm,
  transform: (e) => wu(0, 1, e)
}, $1 = {
  ...Fm,
  default: 1
}, Jg = (e) => Math.round(e * 1e5) / 1e5, cE = /-?(?:\d+(?:\.\d+)?|\.\d+)/gu;
function BX(e) {
  return e == null;
}
const qX = /^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu, fE = (e, t) => (n) => !!(typeof n == "string" && qX.test(n) && n.startsWith(e) || t && !BX(n) && Object.prototype.hasOwnProperty.call(n, t)), MD = (e, t, n) => (r) => {
  if (typeof r != "string")
    return r;
  const [i, s, o, u] = r.match(cE);
  return {
    [e]: parseFloat(i),
    [t]: parseFloat(s),
    [n]: parseFloat(o),
    alpha: u !== void 0 ? parseFloat(u) : 1
  };
}, FX = (e) => wu(0, 255, e), p2 = {
  ...Fm,
  transform: (e) => Math.round(FX(e))
}, xd = {
  test: /* @__PURE__ */ fE("rgb", "red"),
  parse: /* @__PURE__ */ MD("red", "green", "blue"),
  transform: ({ red: e, green: t, blue: n, alpha: r = 1 }) => "rgba(" + p2.transform(e) + ", " + p2.transform(t) + ", " + p2.transform(n) + ", " + Jg(h0.transform(r)) + ")"
};
function UX(e) {
  let t = "", n = "", r = "", i = "";
  return e.length > 5 ? (t = e.substring(1, 3), n = e.substring(3, 5), r = e.substring(5, 7), i = e.substring(7, 9)) : (t = e.substring(1, 2), n = e.substring(2, 3), r = e.substring(3, 4), i = e.substring(4, 5), t += t, n += n, r += r, i += i), {
    red: parseInt(t, 16),
    green: parseInt(n, 16),
    blue: parseInt(r, 16),
    alpha: i ? parseInt(i, 16) / 255 : 1
  };
}
const D5 = {
  test: /* @__PURE__ */ fE("#"),
  parse: UX,
  transform: xd.transform
}, z0 = /* @__NO_SIDE_EFFECTS__ */ (e) => ({
  test: (t) => typeof t == "string" && t.endsWith(e) && t.split(" ").length === 1,
  parse: parseFloat,
  transform: (t) => `${t}${e}`
}), Ic = /* @__PURE__ */ z0("deg"), Ml = /* @__PURE__ */ z0("%"), Ot = /* @__PURE__ */ z0("px"), $X = /* @__PURE__ */ z0("vh"), VX = /* @__PURE__ */ z0("vw"), c8 = {
  ...Ml,
  parse: (e) => Ml.parse(e) / 100,
  transform: (e) => Ml.transform(e * 100)
}, pm = {
  test: /* @__PURE__ */ fE("hsl", "hue"),
  parse: /* @__PURE__ */ MD("hue", "saturation", "lightness"),
  transform: ({ hue: e, saturation: t, lightness: n, alpha: r = 1 }) => "hsla(" + Math.round(e) + ", " + Ml.transform(Jg(t)) + ", " + Ml.transform(Jg(n)) + ", " + Jg(h0.transform(r)) + ")"
}, Pr = {
  test: (e) => xd.test(e) || D5.test(e) || pm.test(e),
  parse: (e) => xd.test(e) ? xd.parse(e) : pm.test(e) ? pm.parse(e) : D5.parse(e),
  transform: (e) => typeof e == "string" ? e : e.hasOwnProperty("red") ? xd.transform(e) : pm.transform(e),
  getAnimatableNone: (e) => {
    const t = Pr.parse(e);
    return t.alpha = 0, Pr.transform(t);
  }
}, HX = /(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;
function GX(e) {
  var t, n;
  return isNaN(e) && typeof e == "string" && (((t = e.match(cE)) == null ? void 0 : t.length) || 0) + (((n = e.match(HX)) == null ? void 0 : n.length) || 0) > 0;
}
const RD = "number", OD = "color", KX = "var", YX = "var(", f8 = "${}", WX = /var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;
function m0(e) {
  const t = e.toString(), n = [], r = {
    color: [],
    number: [],
    var: []
  }, i = [];
  let s = 0;
  const u = t.replace(WX, (c) => (Pr.test(c) ? (r.color.push(s), i.push(OD), n.push(Pr.parse(c))) : c.startsWith(YX) ? (r.var.push(s), i.push(KX), n.push(c)) : (r.number.push(s), i.push(RD), n.push(parseFloat(c))), ++s, f8)).split(f8);
  return { values: n, split: u, indexes: r, types: i };
}
function DD(e) {
  return m0(e).values;
}
function ID(e) {
  const { split: t, types: n } = m0(e), r = t.length;
  return (i) => {
    let s = "";
    for (let o = 0; o < r; o++)
      if (s += t[o], i[o] !== void 0) {
        const u = n[o];
        u === RD ? s += Jg(i[o]) : u === OD ? s += Pr.transform(i[o]) : s += i[o];
      }
    return s;
  };
}
const XX = (e) => typeof e == "number" ? 0 : Pr.test(e) ? Pr.getAnimatableNone(e) : e;
function QX(e) {
  const t = DD(e);
  return ID(e)(t.map(XX));
}
const Fc = {
  test: GX,
  parse: DD,
  createTransformer: ID,
  getAnimatableNone: QX
};
function g2(e, t, n) {
  return n < 0 && (n += 1), n > 1 && (n -= 1), n < 1 / 6 ? e + (t - e) * 6 * n : n < 1 / 2 ? t : n < 2 / 3 ? e + (t - e) * (2 / 3 - n) * 6 : e;
}
function ZX({ hue: e, saturation: t, lightness: n, alpha: r }) {
  e /= 360, t /= 100, n /= 100;
  let i = 0, s = 0, o = 0;
  if (!t)
    i = s = o = n;
  else {
    const u = n < 0.5 ? n * (1 + t) : n + t - n * t, c = 2 * n - u;
    i = g2(c, u, e + 1 / 3), s = g2(c, u, e), o = g2(c, u, e - 1 / 3);
  }
  return {
    red: Math.round(i * 255),
    green: Math.round(s * 255),
    blue: Math.round(o * 255),
    alpha: r
  };
}
function Av(e, t) {
  return (n) => n > 0 ? t : e;
}
const or = (e, t, n) => e + (t - e) * n, y2 = (e, t, n) => {
  const r = e * e, i = n * (t * t - r) + r;
  return i < 0 ? 0 : Math.sqrt(i);
}, JX = [D5, xd, pm], eQ = (e) => JX.find((t) => t.test(e));
function d8(e) {
  const t = eQ(e);
  if (!t)
    return !1;
  let n = t.parse(e);
  return t === pm && (n = ZX(n)), n;
}
const h8 = (e, t) => {
  const n = d8(e), r = d8(t);
  if (!n || !r)
    return Av(e, t);
  const i = { ...n };
  return (s) => (i.red = y2(n.red, r.red, s), i.green = y2(n.green, r.green, s), i.blue = y2(n.blue, r.blue, s), i.alpha = or(n.alpha, r.alpha, s), xd.transform(i));
}, I5 = /* @__PURE__ */ new Set(["none", "hidden"]);
function tQ(e, t) {
  return I5.has(e) ? (n) => n <= 0 ? e : t : (n) => n >= 1 ? t : e;
}
function nQ(e, t) {
  return (n) => or(e, t, n);
}
function dE(e) {
  return typeof e == "number" ? nQ : typeof e == "string" ? uE(e) ? Av : Pr.test(e) ? h8 : aQ : Array.isArray(e) ? PD : typeof e == "object" ? Pr.test(e) ? h8 : rQ : Av;
}
function PD(e, t) {
  const n = [...e], r = n.length, i = e.map((s, o) => dE(s)(s, t[o]));
  return (s) => {
    for (let o = 0; o < r; o++)
      n[o] = i[o](s);
    return n;
  };
}
function rQ(e, t) {
  const n = { ...e, ...t }, r = {};
  for (const i in n)
    e[i] !== void 0 && t[i] !== void 0 && (r[i] = dE(e[i])(e[i], t[i]));
  return (i) => {
    for (const s in r)
      n[s] = r[s](i);
    return n;
  };
}
function iQ(e, t) {
  const n = [], r = { color: 0, var: 0, number: 0 };
  for (let i = 0; i < t.values.length; i++) {
    const s = t.types[i], o = e.indexes[s][r[s]], u = e.values[o] ?? 0;
    n[i] = u, r[s]++;
  }
  return n;
}
const aQ = (e, t) => {
  const n = Fc.createTransformer(t), r = m0(e), i = m0(t);
  return r.indexes.var.length === i.indexes.var.length && r.indexes.color.length === i.indexes.color.length && r.indexes.number.length >= i.indexes.number.length ? I5.has(e) && !i.values.length || I5.has(t) && !r.values.length ? tQ(e, t) : I0(PD(iQ(r, i), i.values), n) : Av(e, t);
};
function zD(e, t, n) {
  return typeof e == "number" && typeof t == "number" && typeof n == "number" ? or(e, t, n) : dE(e)(e, t);
}
const sQ = (e) => {
  const t = ({ timestamp: n }) => e(n);
  return {
    start: (n = !0) => nr.update(t, n),
    stop: () => Su(t),
    /**
     * If we're processing this frame we can use the
     * framelocked timestamp to keep things in sync.
     */
    now: () => vi.isProcessing ? vi.timestamp : qa.now()
  };
}, LD = (e, t, n = 10) => {
  let r = "";
  const i = Math.max(Math.round(t / n), 2);
  for (let s = 0; s < i; s++)
    r += Math.round(e(s / (i - 1)) * 1e4) / 1e4 + ", ";
  return `linear(${r.substring(0, r.length - 2)})`;
}, jv = 2e4;
function hE(e) {
  let t = 0;
  const n = 50;
  let r = e.next(t);
  for (; !r.done && t < jv; )
    t += n, r = e.next(t);
  return t >= jv ? 1 / 0 : t;
}
function oQ(e, t = 100, n) {
  const r = n({ ...e, keyframes: [0, t] }), i = Math.min(hE(r), jv);
  return {
    type: "keyframes",
    ease: (s) => r.next(i * s).value / t,
    duration: /* @__PURE__ */ zs(i)
  };
}
const lQ = 5;
function BD(e, t, n) {
  const r = Math.max(t - lQ, 0);
  return yD(n - e(r), t - r);
}
const kr = {
  // Default spring physics
  stiffness: 100,
  damping: 10,
  mass: 1,
  velocity: 0,
  // Default duration/bounce-based options
  duration: 800,
  // in ms
  bounce: 0.3,
  visualDuration: 0.3,
  // in seconds
  // Rest thresholds
  restSpeed: {
    granular: 0.01,
    default: 2
  },
  restDelta: {
    granular: 5e-3,
    default: 0.5
  },
  // Limits
  minDuration: 0.01,
  // in seconds
  maxDuration: 10,
  // in seconds
  minDamping: 0.05,
  maxDamping: 1
}, v2 = 1e-3;
function uQ({ duration: e = kr.duration, bounce: t = kr.bounce, velocity: n = kr.velocity, mass: r = kr.mass }) {
  let i, s, o = 1 - t;
  o = wu(kr.minDamping, kr.maxDamping, o), e = wu(kr.minDuration, kr.maxDuration, /* @__PURE__ */ zs(e)), o < 1 ? (i = (d) => {
    const m = d * o, p = m * e, x = m - n, b = P5(d, o), S = Math.exp(-p);
    return v2 - x / b * S;
  }, s = (d) => {
    const p = d * o * e, x = p * n + n, b = Math.pow(o, 2) * Math.pow(d, 2) * e, S = Math.exp(-p), k = P5(Math.pow(d, 2), o);
    return (-i(d) + v2 > 0 ? -1 : 1) * ((x - b) * S) / k;
  }) : (i = (d) => {
    const m = Math.exp(-d * e), p = (d - n) * e + 1;
    return -v2 + m * p;
  }, s = (d) => {
    const m = Math.exp(-d * e), p = (n - d) * (e * e);
    return m * p;
  });
  const u = 5 / e, c = fQ(i, s, u);
  if (e = /* @__PURE__ */ jl(e), isNaN(c))
    return {
      stiffness: kr.stiffness,
      damping: kr.damping,
      duration: e
    };
  {
    const d = Math.pow(c, 2) * r;
    return {
      stiffness: d,
      damping: o * 2 * Math.sqrt(r * d),
      duration: e
    };
  }
}
const cQ = 12;
function fQ(e, t, n) {
  let r = n;
  for (let i = 1; i < cQ; i++)
    r = r - e(r) / t(r);
  return r;
}
function P5(e, t) {
  return e * Math.sqrt(1 - t * t);
}
const dQ = ["duration", "bounce"], hQ = ["stiffness", "damping", "mass"];
function m8(e, t) {
  return t.some((n) => e[n] !== void 0);
}
function mQ(e) {
  let t = {
    velocity: kr.velocity,
    stiffness: kr.stiffness,
    damping: kr.damping,
    mass: kr.mass,
    isResolvedFromDuration: !1,
    ...e
  };
  if (!m8(e, hQ) && m8(e, dQ))
    if (e.visualDuration) {
      const n = e.visualDuration, r = 2 * Math.PI / (n * 1.2), i = r * r, s = 2 * wu(0.05, 1, 1 - (e.bounce || 0)) * Math.sqrt(i);
      t = {
        ...t,
        mass: kr.mass,
        stiffness: i,
        damping: s
      };
    } else {
      const n = uQ(e);
      t = {
        ...t,
        ...n,
        mass: kr.mass
      }, t.isResolvedFromDuration = !0;
    }
  return t;
}
function Mv(e = kr.visualDuration, t = kr.bounce) {
  const n = typeof e != "object" ? {
    visualDuration: e,
    keyframes: [0, 1],
    bounce: t
  } : e;
  let { restSpeed: r, restDelta: i } = n;
  const s = n.keyframes[0], o = n.keyframes[n.keyframes.length - 1], u = { done: !1, value: s }, { stiffness: c, damping: d, mass: m, duration: p, velocity: x, isResolvedFromDuration: b } = mQ({
    ...n,
    velocity: -/* @__PURE__ */ zs(n.velocity || 0)
  }), S = x || 0, k = d / (2 * Math.sqrt(c * m)), A = o - s, T = /* @__PURE__ */ zs(Math.sqrt(c / m)), M = Math.abs(A) < 5;
  r || (r = M ? kr.restSpeed.granular : kr.restSpeed.default), i || (i = M ? kr.restDelta.granular : kr.restDelta.default);
  let j;
  if (k < 1) {
    const z = P5(T, k);
    j = (I) => {
      const L = Math.exp(-k * T * I);
      return o - L * ((S + k * T * A) / z * Math.sin(z * I) + A * Math.cos(z * I));
    };
  } else if (k === 1)
    j = (z) => o - Math.exp(-T * z) * (A + (S + T * A) * z);
  else {
    const z = T * Math.sqrt(k * k - 1);
    j = (I) => {
      const L = Math.exp(-k * T * I), K = Math.min(z * I, 300);
      return o - L * ((S + k * T * A) * Math.sinh(K) + z * A * Math.cosh(K)) / z;
    };
  }
  const D = {
    calculatedDuration: b && p || null,
    next: (z) => {
      const I = j(z);
      if (b)
        u.done = z >= p;
      else {
        let L = z === 0 ? S : 0;
        k < 1 && (L = z === 0 ? /* @__PURE__ */ jl(S) : BD(j, z, I));
        const K = Math.abs(L) <= r, ne = Math.abs(o - I) <= i;
        u.done = K && ne;
      }
      return u.value = u.done ? o : I, u;
    },
    toString: () => {
      const z = Math.min(hE(D), jv), I = LD((L) => D.next(z * L).value, z, 30);
      return z + "ms " + I;
    },
    toTransition: () => {
    }
  };
  return D;
}
Mv.applyToOptions = (e) => {
  const t = oQ(e, 100, Mv);
  return e.ease = t.ease, e.duration = /* @__PURE__ */ jl(t.duration), e.type = "keyframes", e;
};
function z5({ keyframes: e, velocity: t = 0, power: n = 0.8, timeConstant: r = 325, bounceDamping: i = 10, bounceStiffness: s = 500, modifyTarget: o, min: u, max: c, restDelta: d = 0.5, restSpeed: m }) {
  const p = e[0], x = {
    done: !1,
    value: p
  }, b = (K) => u !== void 0 && K < u || c !== void 0 && K > c, S = (K) => u === void 0 ? c : c === void 0 || Math.abs(u - K) < Math.abs(c - K) ? u : c;
  let k = n * t;
  const A = p + k, T = o === void 0 ? A : o(A);
  T !== A && (k = T - p);
  const M = (K) => -k * Math.exp(-K / r), j = (K) => T + M(K), D = (K) => {
    const ne = M(K), Y = j(K);
    x.done = Math.abs(ne) <= d, x.value = x.done ? T : Y;
  };
  let z, I;
  const L = (K) => {
    b(x.value) && (z = K, I = Mv({
      keyframes: [x.value, S(x.value)],
      velocity: BD(j, K, x.value),
      // TODO: This should be passing * 1000
      damping: i,
      stiffness: s,
      restDelta: d,
      restSpeed: m
    }));
  };
  return L(0), {
    calculatedDuration: null,
    next: (K) => {
      let ne = !1;
      return !I && z === void 0 && (ne = !0, D(K), L(K)), z !== void 0 && K >= z ? I.next(K - z) : (!ne && D(K), x);
    }
  };
}
function pQ(e, t, n) {
  const r = [], i = n || _u.mix || zD, s = e.length - 1;
  for (let o = 0; o < s; o++) {
    let u = i(e[o], e[o + 1]);
    if (t) {
      const c = Array.isArray(t) ? t[o] || Bs : t;
      u = I0(c, u);
    }
    r.push(u);
  }
  return r;
}
function qD(e, t, { clamp: n = !0, ease: r, mixer: i } = {}) {
  const s = e.length;
  if (iE(s === t.length), s === 1)
    return () => t[0];
  if (s === 2 && t[0] === t[1])
    return () => t[1];
  const o = e[0] === e[1];
  e[0] > e[s - 1] && (e = [...e].reverse(), t = [...t].reverse());
  const u = pQ(t, r, i), c = u.length, d = (m) => {
    if (o && m < e[0])
      return t[0];
    let p = 0;
    if (c > 1)
      for (; p < e.length - 2 && !(m < e[p + 1]); p++)
        ;
    const x = /* @__PURE__ */ d0(e[p], e[p + 1], m);
    return u[p](x);
  };
  return n ? (m) => d(wu(e[0], e[s - 1], m)) : d;
}
function gQ(e, t) {
  const n = e[e.length - 1];
  for (let r = 1; r <= t; r++) {
    const i = /* @__PURE__ */ d0(0, t, r);
    e.push(or(n, 1, i));
  }
}
function yQ(e) {
  const t = [0];
  return gQ(t, e.length - 1), t;
}
function vQ(e, t) {
  return e.map((n) => n * t);
}
function xQ(e, t) {
  return e.map(() => t || kD).splice(0, e.length - 1);
}
function e0({ duration: e = 300, keyframes: t, times: n, ease: r = "easeInOut" }) {
  const i = MX(r) ? r.map(u8) : u8(r), s = {
    done: !1,
    value: t[0]
  }, o = vQ(
    // Only use the provided offsets if they're the correct length
    // TODO Maybe we should warn here if there's a length mismatch
    n && n.length === t.length ? n : yQ(t),
    e
  ), u = qD(o, t, {
    ease: Array.isArray(i) ? i : xQ(t, i)
  });
  return {
    calculatedDuration: e,
    next: (c) => (s.value = u(c), s.done = c >= e, s)
  };
}
const bQ = (e) => e !== null;
function mE(e, { repeat: t, repeatType: n = "loop" }, r, i = 1) {
  const s = e.filter(bQ), u = i < 0 || t && n !== "loop" && t % 2 === 1 ? 0 : s.length - 1;
  return !u || r === void 0 ? s[u] : r;
}
const wQ = {
  decay: z5,
  inertia: z5,
  tween: e0,
  keyframes: e0,
  spring: Mv
};
function FD(e) {
  typeof e.type == "string" && (e.type = wQ[e.type]);
}
class pE {
  constructor() {
    this.updateFinished();
  }
  get finished() {
    return this._finished;
  }
  updateFinished() {
    this._finished = new Promise((t) => {
      this.resolve = t;
    });
  }
  notifyFinished() {
    this.resolve();
  }
  /**
   * Allows the animation to be awaited.
   *
   * @deprecated Use `finished` instead.
   */
  then(t, n) {
    return this.finished.then(t, n);
  }
}
const _Q = (e) => e / 100;
class gE extends pE {
  constructor(t) {
    super(), this.state = "idle", this.startTime = null, this.isStopped = !1, this.currentTime = 0, this.holdTime = null, this.playbackSpeed = 1, this.stop = () => {
      var r, i;
      const { motionValue: n } = this.options;
      n && n.updatedAt !== qa.now() && this.tick(qa.now()), this.isStopped = !0, this.state !== "idle" && (this.teardown(), (i = (r = this.options).onStop) == null || i.call(r));
    }, this.options = t, this.initAnimation(), this.play(), t.autoplay === !1 && this.pause();
  }
  initAnimation() {
    const { options: t } = this;
    FD(t);
    const { type: n = e0, repeat: r = 0, repeatDelay: i = 0, repeatType: s, velocity: o = 0 } = t;
    let { keyframes: u } = t;
    const c = n || e0;
    c !== e0 && typeof u[0] != "number" && (this.mixKeyframes = I0(_Q, zD(u[0], u[1])), u = [0, 100]);
    const d = c({ ...t, keyframes: u });
    s === "mirror" && (this.mirroredGenerator = c({
      ...t,
      keyframes: [...u].reverse(),
      velocity: -o
    })), d.calculatedDuration === null && (d.calculatedDuration = hE(d));
    const { calculatedDuration: m } = d;
    this.calculatedDuration = m, this.resolvedDuration = m + i, this.totalDuration = this.resolvedDuration * (r + 1) - i, this.generator = d;
  }
  updateTime(t) {
    const n = Math.round(t - this.startTime) * this.playbackSpeed;
    this.holdTime !== null ? this.currentTime = this.holdTime : this.currentTime = n;
  }
  tick(t, n = !1) {
    const { generator: r, totalDuration: i, mixKeyframes: s, mirroredGenerator: o, resolvedDuration: u, calculatedDuration: c } = this;
    if (this.startTime === null)
      return r.next(0);
    const { delay: d = 0, keyframes: m, repeat: p, repeatType: x, repeatDelay: b, type: S, onUpdate: k, finalKeyframe: A } = this.options;
    this.speed > 0 ? this.startTime = Math.min(this.startTime, t) : this.speed < 0 && (this.startTime = Math.min(t - i / this.speed, this.startTime)), n ? this.currentTime = t : this.updateTime(t);
    const T = this.currentTime - d * (this.playbackSpeed >= 0 ? 1 : -1), M = this.playbackSpeed >= 0 ? T < 0 : T > i;
    this.currentTime = Math.max(T, 0), this.state === "finished" && this.holdTime === null && (this.currentTime = i);
    let j = this.currentTime, D = r;
    if (p) {
      const K = Math.min(this.currentTime, i) / u;
      let ne = Math.floor(K), Y = K % 1;
      !Y && K >= 1 && (Y = 1), Y === 1 && ne--, ne = Math.min(ne, p + 1), !!(ne % 2) && (x === "reverse" ? (Y = 1 - Y, b && (Y -= b / u)) : x === "mirror" && (D = o)), j = wu(0, 1, Y) * u;
    }
    const z = M ? { done: !1, value: m[0] } : D.next(j);
    s && (z.value = s(z.value));
    let { done: I } = z;
    !M && c !== null && (I = this.playbackSpeed >= 0 ? this.currentTime >= i : this.currentTime <= 0);
    const L = this.holdTime === null && (this.state === "finished" || this.state === "running" && I);
    return L && S !== z5 && (z.value = mE(m, this.options, A, this.speed)), k && k(z.value), L && this.finish(), z;
  }
  /**
   * Allows the returned animation to be awaited or promise-chained. Currently
   * resolves when the animation finishes at all but in a future update could/should
   * reject if its cancels.
   */
  then(t, n) {
    return this.finished.then(t, n);
  }
  get duration() {
    return /* @__PURE__ */ zs(this.calculatedDuration);
  }
  get iterationDuration() {
    const { delay: t = 0 } = this.options || {};
    return this.duration + /* @__PURE__ */ zs(t);
  }
  get time() {
    return /* @__PURE__ */ zs(this.currentTime);
  }
  set time(t) {
    var n;
    t = /* @__PURE__ */ jl(t), this.currentTime = t, this.startTime === null || this.holdTime !== null || this.playbackSpeed === 0 ? this.holdTime = t : this.driver && (this.startTime = this.driver.now() - t / this.playbackSpeed), (n = this.driver) == null || n.start(!1);
  }
  get speed() {
    return this.playbackSpeed;
  }
  set speed(t) {
    this.updateTime(qa.now());
    const n = this.playbackSpeed !== t;
    this.playbackSpeed = t, n && (this.time = /* @__PURE__ */ zs(this.currentTime));
  }
  play() {
    var i, s;
    if (this.isStopped)
      return;
    const { driver: t = sQ, startTime: n } = this.options;
    this.driver || (this.driver = t((o) => this.tick(o))), (s = (i = this.options).onPlay) == null || s.call(i);
    const r = this.driver.now();
    this.state === "finished" ? (this.updateFinished(), this.startTime = r) : this.holdTime !== null ? this.startTime = r - this.holdTime : this.startTime || (this.startTime = n ?? r), this.state === "finished" && this.speed < 0 && (this.startTime += this.calculatedDuration), this.holdTime = null, this.state = "running", this.driver.start();
  }
  pause() {
    this.state = "paused", this.updateTime(qa.now()), this.holdTime = this.currentTime;
  }
  complete() {
    this.state !== "running" && this.play(), this.state = "finished", this.holdTime = null;
  }
  finish() {
    var t, n;
    this.notifyFinished(), this.teardown(), this.state = "finished", (n = (t = this.options).onComplete) == null || n.call(t);
  }
  cancel() {
    var t, n;
    this.holdTime = null, this.startTime = 0, this.tick(0), this.teardown(), (n = (t = this.options).onCancel) == null || n.call(t);
  }
  teardown() {
    this.state = "idle", this.stopDriver(), this.startTime = this.holdTime = null;
  }
  stopDriver() {
    this.driver && (this.driver.stop(), this.driver = void 0);
  }
  sample(t) {
    return this.startTime = 0, this.tick(t, !0);
  }
  attachTimeline(t) {
    var n;
    return this.options.allowFlatten && (this.options.type = "keyframes", this.options.ease = "linear", this.initAnimation()), (n = this.driver) == null || n.stop(), t.observe(this);
  }
}
function SQ(e) {
  for (let t = 1; t < e.length; t++)
    e[t] ?? (e[t] = e[t - 1]);
}
const bd = (e) => e * 180 / Math.PI, L5 = (e) => {
  const t = bd(Math.atan2(e[1], e[0]));
  return B5(t);
}, CQ = {
  x: 4,
  y: 5,
  translateX: 4,
  translateY: 5,
  scaleX: 0,
  scaleY: 3,
  scale: (e) => (Math.abs(e[0]) + Math.abs(e[3])) / 2,
  rotate: L5,
  rotateZ: L5,
  skewX: (e) => bd(Math.atan(e[1])),
  skewY: (e) => bd(Math.atan(e[2])),
  skew: (e) => (Math.abs(e[1]) + Math.abs(e[2])) / 2
}, B5 = (e) => (e = e % 360, e < 0 && (e += 360), e), p8 = L5, g8 = (e) => Math.sqrt(e[0] * e[0] + e[1] * e[1]), y8 = (e) => Math.sqrt(e[4] * e[4] + e[5] * e[5]), EQ = {
  x: 12,
  y: 13,
  z: 14,
  translateX: 12,
  translateY: 13,
  translateZ: 14,
  scaleX: g8,
  scaleY: y8,
  scale: (e) => (g8(e) + y8(e)) / 2,
  rotateX: (e) => B5(bd(Math.atan2(e[6], e[5]))),
  rotateY: (e) => B5(bd(Math.atan2(-e[2], e[0]))),
  rotateZ: p8,
  rotate: p8,
  skewX: (e) => bd(Math.atan(e[4])),
  skewY: (e) => bd(Math.atan(e[1])),
  skew: (e) => (Math.abs(e[1]) + Math.abs(e[4])) / 2
};
function q5(e) {
  return e.includes("scale") ? 1 : 0;
}
function F5(e, t) {
  if (!e || e === "none")
    return q5(t);
  const n = e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);
  let r, i;
  if (n)
    r = EQ, i = n;
  else {
    const u = e.match(/^matrix\(([-\d.e\s,]+)\)$/u);
    r = CQ, i = u;
  }
  if (!i)
    return q5(t);
  const s = r[t], o = i[1].split(",").map(TQ);
  return typeof s == "function" ? s(o) : o[s];
}
const kQ = (e, t) => {
  const { transform: n = "none" } = getComputedStyle(e);
  return F5(n, t);
};
function TQ(e) {
  return parseFloat(e.trim());
}
const Um = [
  "transformPerspective",
  "x",
  "y",
  "z",
  "translateX",
  "translateY",
  "translateZ",
  "scale",
  "scaleX",
  "scaleY",
  "rotate",
  "rotateX",
  "rotateY",
  "rotateZ",
  "skew",
  "skewX",
  "skewY"
], $m = new Set(Um), v8 = (e) => e === Fm || e === Ot, NQ = /* @__PURE__ */ new Set(["x", "y", "z"]), AQ = Um.filter((e) => !NQ.has(e));
function jQ(e) {
  const t = [];
  return AQ.forEach((n) => {
    const r = e.getValue(n);
    r !== void 0 && (t.push([n, r.get()]), r.set(n.startsWith("scale") ? 1 : 0));
  }), t;
}
const Ed = {
  // Dimensions
  width: ({ x: e }, { paddingLeft: t = "0", paddingRight: n = "0" }) => e.max - e.min - parseFloat(t) - parseFloat(n),
  height: ({ y: e }, { paddingTop: t = "0", paddingBottom: n = "0" }) => e.max - e.min - parseFloat(t) - parseFloat(n),
  top: (e, { top: t }) => parseFloat(t),
  left: (e, { left: t }) => parseFloat(t),
  bottom: ({ y: e }, { top: t }) => parseFloat(t) + (e.max - e.min),
  right: ({ x: e }, { left: t }) => parseFloat(t) + (e.max - e.min),
  // Transform
  x: (e, { transform: t }) => F5(t, "x"),
  y: (e, { transform: t }) => F5(t, "y")
};
Ed.translateX = Ed.x;
Ed.translateY = Ed.y;
const kd = /* @__PURE__ */ new Set();
let U5 = !1, $5 = !1, V5 = !1;
function UD() {
  if ($5) {
    const e = Array.from(kd).filter((r) => r.needsMeasurement), t = new Set(e.map((r) => r.element)), n = /* @__PURE__ */ new Map();
    t.forEach((r) => {
      const i = jQ(r);
      i.length && (n.set(r, i), r.render());
    }), e.forEach((r) => r.measureInitialState()), t.forEach((r) => {
      r.render();
      const i = n.get(r);
      i && i.forEach(([s, o]) => {
        var u;
        (u = r.getValue(s)) == null || u.set(o);
      });
    }), e.forEach((r) => r.measureEndState()), e.forEach((r) => {
      r.suspendedScrollY !== void 0 && window.scrollTo(0, r.suspendedScrollY);
    });
  }
  $5 = !1, U5 = !1, kd.forEach((e) => e.complete(V5)), kd.clear();
}
function $D() {
  kd.forEach((e) => {
    e.readKeyframes(), e.needsMeasurement && ($5 = !0);
  });
}
function MQ() {
  V5 = !0, $D(), UD(), V5 = !1;
}
class yE {
  constructor(t, n, r, i, s, o = !1) {
    this.state = "pending", this.isAsync = !1, this.needsMeasurement = !1, this.unresolvedKeyframes = [...t], this.onComplete = n, this.name = r, this.motionValue = i, this.element = s, this.isAsync = o;
  }
  scheduleResolve() {
    this.state = "scheduled", this.isAsync ? (kd.add(this), U5 || (U5 = !0, nr.read($D), nr.resolveKeyframes(UD))) : (this.readKeyframes(), this.complete());
  }
  readKeyframes() {
    const { unresolvedKeyframes: t, name: n, element: r, motionValue: i } = this;
    if (t[0] === null) {
      const s = i == null ? void 0 : i.get(), o = t[t.length - 1];
      if (s !== void 0)
        t[0] = s;
      else if (r && n) {
        const u = r.readValue(n, o);
        u != null && (t[0] = u);
      }
      t[0] === void 0 && (t[0] = o), i && s === void 0 && i.set(t[0]);
    }
    SQ(t);
  }
  setFinalKeyframe() {
  }
  measureInitialState() {
  }
  renderEndStyles() {
  }
  measureEndState() {
  }
  complete(t = !1) {
    this.state = "complete", this.onComplete(this.unresolvedKeyframes, this.finalKeyframe, t), kd.delete(this);
  }
  cancel() {
    this.state === "scheduled" && (kd.delete(this), this.state = "pending");
  }
  resume() {
    this.state === "pending" && this.scheduleResolve();
  }
}
const RQ = (e) => e.startsWith("--");
function OQ(e, t, n) {
  RQ(t) ? e.style.setProperty(t, n) : e.style[t] = n;
}
const DQ = /* @__PURE__ */ aE(() => window.ScrollTimeline !== void 0), IQ = {};
function PQ(e, t) {
  const n = /* @__PURE__ */ aE(e);
  return () => IQ[t] ?? n();
}
const VD = /* @__PURE__ */ PQ(() => {
  try {
    document.createElement("div").animate({ opacity: 0 }, { easing: "linear(0, 1)" });
  } catch {
    return !1;
  }
  return !0;
}, "linearEasing"), Fg = ([e, t, n, r]) => `cubic-bezier(${e}, ${t}, ${n}, ${r})`, x8 = {
  linear: "linear",
  ease: "ease",
  easeIn: "ease-in",
  easeOut: "ease-out",
  easeInOut: "ease-in-out",
  circIn: /* @__PURE__ */ Fg([0, 0.65, 0.55, 1]),
  circOut: /* @__PURE__ */ Fg([0.55, 0, 1, 0.45]),
  backIn: /* @__PURE__ */ Fg([0.31, 0.01, 0.66, -0.59]),
  backOut: /* @__PURE__ */ Fg([0.33, 1.53, 0.69, 0.99])
};
function HD(e, t) {
  if (e)
    return typeof e == "function" ? VD() ? LD(e, t) : "ease-out" : TD(e) ? Fg(e) : Array.isArray(e) ? e.map((n) => HD(n, t) || x8.easeOut) : x8[e];
}
function zQ(e, t, n, { delay: r = 0, duration: i = 300, repeat: s = 0, repeatType: o = "loop", ease: u = "easeOut", times: c } = {}, d = void 0) {
  const m = {
    [t]: n
  };
  c && (m.offset = c);
  const p = HD(u, i);
  Array.isArray(p) && (m.easing = p);
  const x = {
    delay: r,
    duration: i,
    easing: Array.isArray(p) ? "linear" : p,
    fill: "both",
    iterations: s + 1,
    direction: o === "reverse" ? "alternate" : "normal"
  };
  return d && (x.pseudoElement = d), e.animate(m, x);
}
function GD(e) {
  return typeof e == "function" && "applyToOptions" in e;
}
function LQ({ type: e, ...t }) {
  return GD(e) && VD() ? e.applyToOptions(t) : (t.duration ?? (t.duration = 300), t.ease ?? (t.ease = "easeOut"), t);
}
class BQ extends pE {
  constructor(t) {
    if (super(), this.finishedTime = null, this.isStopped = !1, !t)
      return;
    const { element: n, name: r, keyframes: i, pseudoElement: s, allowFlatten: o = !1, finalKeyframe: u, onComplete: c } = t;
    this.isPseudoElement = !!s, this.allowFlatten = o, this.options = t, iE(typeof t.type != "string");
    const d = LQ(t);
    this.animation = zQ(n, r, i, d, s), d.autoplay === !1 && this.animation.pause(), this.animation.onfinish = () => {
      if (this.finishedTime = this.time, !s) {
        const m = mE(i, this.options, u, this.speed);
        this.updateMotionValue ? this.updateMotionValue(m) : OQ(n, r, m), this.animation.cancel();
      }
      c == null || c(), this.notifyFinished();
    };
  }
  play() {
    this.isStopped || (this.animation.play(), this.state === "finished" && this.updateFinished());
  }
  pause() {
    this.animation.pause();
  }
  complete() {
    var t, n;
    (n = (t = this.animation).finish) == null || n.call(t);
  }
  cancel() {
    try {
      this.animation.cancel();
    } catch {
    }
  }
  stop() {
    if (this.isStopped)
      return;
    this.isStopped = !0;
    const { state: t } = this;
    t === "idle" || t === "finished" || (this.updateMotionValue ? this.updateMotionValue() : this.commitStyles(), this.isPseudoElement || this.cancel());
  }
  /**
   * WAAPI doesn't natively have any interruption capabilities.
   *
   * In this method, we commit styles back to the DOM before cancelling
   * the animation.
   *
   * This is designed to be overridden by NativeAnimationExtended, which
   * will create a renderless JS animation and sample it twice to calculate
   * its current value, "previous" value, and therefore allow
   * Motion to also correctly calculate velocity for any subsequent animation
   * while deferring the commit until the next animation frame.
   */
  commitStyles() {
    var t, n;
    this.isPseudoElement || (n = (t = this.animation).commitStyles) == null || n.call(t);
  }
  get duration() {
    var n, r;
    const t = ((r = (n = this.animation.effect) == null ? void 0 : n.getComputedTiming) == null ? void 0 : r.call(n).duration) || 0;
    return /* @__PURE__ */ zs(Number(t));
  }
  get iterationDuration() {
    const { delay: t = 0 } = this.options || {};
    return this.duration + /* @__PURE__ */ zs(t);
  }
  get time() {
    return /* @__PURE__ */ zs(Number(this.animation.currentTime) || 0);
  }
  set time(t) {
    this.finishedTime = null, this.animation.currentTime = /* @__PURE__ */ jl(t);
  }
  /**
   * The playback speed of the animation.
   * 1 = normal speed, 2 = double speed, 0.5 = half speed.
   */
  get speed() {
    return this.animation.playbackRate;
  }
  set speed(t) {
    t < 0 && (this.finishedTime = null), this.animation.playbackRate = t;
  }
  get state() {
    return this.finishedTime !== null ? "finished" : this.animation.playState;
  }
  get startTime() {
    return Number(this.animation.startTime);
  }
  set startTime(t) {
    this.animation.startTime = t;
  }
  /**
   * Attaches a timeline to the animation, for instance the `ScrollTimeline`.
   */
  attachTimeline({ timeline: t, observe: n }) {
    var r;
    return this.allowFlatten && ((r = this.animation.effect) == null || r.updateTiming({ easing: "linear" })), this.animation.onfinish = null, t && DQ() ? (this.animation.timeline = t, Bs) : n(this);
  }
}
const KD = {
  anticipate: SD,
  backInOut: _D,
  circInOut: ED
};
function qQ(e) {
  return e in KD;
}
function FQ(e) {
  typeof e.ease == "string" && qQ(e.ease) && (e.ease = KD[e.ease]);
}
const b8 = 10;
class UQ extends BQ {
  constructor(t) {
    FQ(t), FD(t), super(t), t.startTime && (this.startTime = t.startTime), this.options = t;
  }
  /**
   * WAAPI doesn't natively have any interruption capabilities.
   *
   * Rather than read commited styles back out of the DOM, we can
   * create a renderless JS animation and sample it twice to calculate
   * its current value, "previous" value, and therefore allow
   * Motion to calculate velocity for any subsequent animation.
   */
  updateMotionValue(t) {
    const { motionValue: n, onUpdate: r, onComplete: i, element: s, ...o } = this.options;
    if (!n)
      return;
    if (t !== void 0) {
      n.set(t);
      return;
    }
    const u = new gE({
      ...o,
      autoplay: !1
    }), c = /* @__PURE__ */ jl(this.finishedTime ?? this.time);
    n.setWithVelocity(u.sample(c - b8).value, u.sample(c).value, b8), u.stop();
  }
}
const w8 = (e, t) => t === "zIndex" ? !1 : !!(typeof e == "number" || Array.isArray(e) || typeof e == "string" && // It's animatable if we have a string
(Fc.test(e) || e === "0") && // And it contains numbers and/or colors
!e.startsWith("url("));
function $Q(e) {
  const t = e[0];
  if (e.length === 1)
    return !0;
  for (let n = 0; n < e.length; n++)
    if (e[n] !== t)
      return !0;
}
function VQ(e, t, n, r) {
  const i = e[0];
  if (i === null)
    return !1;
  if (t === "display" || t === "visibility")
    return !0;
  const s = e[e.length - 1], o = w8(i, t), u = w8(s, t);
  return !o || !u ? !1 : $Q(e) || (n === "spring" || GD(n)) && r;
}
function H5(e) {
  e.duration = 0, e.type = "keyframes";
}
const HQ = /* @__PURE__ */ new Set([
  "opacity",
  "clipPath",
  "filter",
  "transform"
  // TODO: Could be re-enabled now we have support for linear() easing
  // "background-color"
]), GQ = /* @__PURE__ */ aE(() => Object.hasOwnProperty.call(Element.prototype, "animate"));
function KQ(e) {
  var m;
  const { motionValue: t, name: n, repeatDelay: r, repeatType: i, damping: s, type: o } = e;
  if (!(((m = t == null ? void 0 : t.owner) == null ? void 0 : m.current) instanceof HTMLElement))
    return !1;
  const { onUpdate: c, transformTemplate: d } = t.owner.getProps();
  return GQ() && n && HQ.has(n) && (n !== "transform" || !d) && /**
   * If we're outputting values to onUpdate then we can't use WAAPI as there's
   * no way to read the value from WAAPI every frame.
   */
  !c && !r && i !== "mirror" && s !== 0 && o !== "inertia";
}
const YQ = 40;
class WQ extends pE {
  constructor({ autoplay: t = !0, delay: n = 0, type: r = "keyframes", repeat: i = 0, repeatDelay: s = 0, repeatType: o = "loop", keyframes: u, name: c, motionValue: d, element: m, ...p }) {
    var S;
    super(), this.stop = () => {
      var k, A;
      this._animation && (this._animation.stop(), (k = this.stopTimeline) == null || k.call(this)), (A = this.keyframeResolver) == null || A.cancel();
    }, this.createdAt = qa.now();
    const x = {
      autoplay: t,
      delay: n,
      type: r,
      repeat: i,
      repeatDelay: s,
      repeatType: o,
      name: c,
      motionValue: d,
      element: m,
      ...p
    }, b = (m == null ? void 0 : m.KeyframeResolver) || yE;
    this.keyframeResolver = new b(u, (k, A, T) => this.onKeyframesResolved(k, A, x, !T), c, d, m), (S = this.keyframeResolver) == null || S.scheduleResolve();
  }
  onKeyframesResolved(t, n, r, i) {
    this.keyframeResolver = void 0;
    const { name: s, type: o, velocity: u, delay: c, isHandoff: d, onUpdate: m } = r;
    this.resolvedAt = qa.now(), VQ(t, s, o, u) || ((_u.instantAnimations || !c) && (m == null || m(mE(t, r, n))), t[0] = t[t.length - 1], H5(r), r.repeat = 0);
    const x = {
      startTime: i ? this.resolvedAt ? this.resolvedAt - this.createdAt > YQ ? this.resolvedAt : this.createdAt : this.createdAt : void 0,
      finalKeyframe: n,
      ...r,
      keyframes: t
    }, b = !d && KQ(x) ? new UQ({
      ...x,
      element: x.motionValue.owner.current
    }) : new gE(x);
    b.finished.then(() => this.notifyFinished()).catch(Bs), this.pendingTimeline && (this.stopTimeline = b.attachTimeline(this.pendingTimeline), this.pendingTimeline = void 0), this._animation = b;
  }
  get finished() {
    return this._animation ? this.animation.finished : this._finished;
  }
  then(t, n) {
    return this.finished.finally(t).then(() => {
    });
  }
  get animation() {
    var t;
    return this._animation || ((t = this.keyframeResolver) == null || t.resume(), MQ()), this._animation;
  }
  get duration() {
    return this.animation.duration;
  }
  get iterationDuration() {
    return this.animation.iterationDuration;
  }
  get time() {
    return this.animation.time;
  }
  set time(t) {
    this.animation.time = t;
  }
  get speed() {
    return this.animation.speed;
  }
  get state() {
    return this.animation.state;
  }
  set speed(t) {
    this.animation.speed = t;
  }
  get startTime() {
    return this.animation.startTime;
  }
  attachTimeline(t) {
    return this._animation ? this.stopTimeline = this.animation.attachTimeline(t) : this.pendingTimeline = t, () => this.stop();
  }
  play() {
    this.animation.play();
  }
  pause() {
    this.animation.pause();
  }
  complete() {
    this.animation.complete();
  }
  cancel() {
    var t;
    this._animation && this.animation.cancel(), (t = this.keyframeResolver) == null || t.cancel();
  }
}
const XQ = (
  // eslint-disable-next-line redos-detector/no-unsafe-regex -- false positive, as it can match a lot of words
  /^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u
);
function QQ(e) {
  const t = XQ.exec(e);
  if (!t)
    return [,];
  const [, n, r, i] = t;
  return [`--${n ?? r}`, i];
}
function YD(e, t, n = 1) {
  const [r, i] = QQ(e);
  if (!r)
    return;
  const s = window.getComputedStyle(t).getPropertyValue(r);
  if (s) {
    const o = s.trim();
    return mD(o) ? parseFloat(o) : o;
  }
  return uE(i) ? YD(i, t, n + 1) : i;
}
function vE(e, t) {
  return (e == null ? void 0 : e[t]) ?? (e == null ? void 0 : e.default) ?? e;
}
const WD = /* @__PURE__ */ new Set([
  "width",
  "height",
  "top",
  "left",
  "right",
  "bottom",
  ...Um
]), ZQ = {
  test: (e) => e === "auto",
  parse: (e) => e
}, XD = (e) => (t) => t.test(e), QD = [Fm, Ot, Ml, Ic, VX, $X, ZQ], _8 = (e) => QD.find(XD(e));
function JQ(e) {
  return typeof e == "number" ? e === 0 : e !== null ? e === "none" || e === "0" || gD(e) : !0;
}
const eZ = /* @__PURE__ */ new Set(["brightness", "contrast", "saturate", "opacity"]);
function tZ(e) {
  const [t, n] = e.slice(0, -1).split("(");
  if (t === "drop-shadow")
    return e;
  const [r] = n.match(cE) || [];
  if (!r)
    return e;
  const i = n.replace(r, "");
  let s = eZ.has(t) ? 1 : 0;
  return r !== n && (s *= 100), t + "(" + s + i + ")";
}
const nZ = /\b([a-z-]*)\(.*?\)/gu, G5 = {
  ...Fc,
  getAnimatableNone: (e) => {
    const t = e.match(nZ);
    return t ? t.map(tZ).join(" ") : e;
  }
}, S8 = {
  ...Fm,
  transform: Math.round
}, rZ = {
  rotate: Ic,
  rotateX: Ic,
  rotateY: Ic,
  rotateZ: Ic,
  scale: $1,
  scaleX: $1,
  scaleY: $1,
  scaleZ: $1,
  skew: Ic,
  skewX: Ic,
  skewY: Ic,
  distance: Ot,
  translateX: Ot,
  translateY: Ot,
  translateZ: Ot,
  x: Ot,
  y: Ot,
  z: Ot,
  perspective: Ot,
  transformPerspective: Ot,
  opacity: h0,
  originX: c8,
  originY: c8,
  originZ: Ot
}, xE = {
  // Border props
  borderWidth: Ot,
  borderTopWidth: Ot,
  borderRightWidth: Ot,
  borderBottomWidth: Ot,
  borderLeftWidth: Ot,
  borderRadius: Ot,
  radius: Ot,
  borderTopLeftRadius: Ot,
  borderTopRightRadius: Ot,
  borderBottomRightRadius: Ot,
  borderBottomLeftRadius: Ot,
  // Positioning props
  width: Ot,
  maxWidth: Ot,
  height: Ot,
  maxHeight: Ot,
  top: Ot,
  right: Ot,
  bottom: Ot,
  left: Ot,
  // Spacing props
  padding: Ot,
  paddingTop: Ot,
  paddingRight: Ot,
  paddingBottom: Ot,
  paddingLeft: Ot,
  margin: Ot,
  marginTop: Ot,
  marginRight: Ot,
  marginBottom: Ot,
  marginLeft: Ot,
  // Misc
  backgroundPositionX: Ot,
  backgroundPositionY: Ot,
  ...rZ,
  zIndex: S8,
  // SVG
  fillOpacity: h0,
  strokeOpacity: h0,
  numOctaves: S8
}, iZ = {
  ...xE,
  // Color props
  color: Pr,
  backgroundColor: Pr,
  outlineColor: Pr,
  fill: Pr,
  stroke: Pr,
  // Border props
  borderColor: Pr,
  borderTopColor: Pr,
  borderRightColor: Pr,
  borderBottomColor: Pr,
  borderLeftColor: Pr,
  filter: G5,
  WebkitFilter: G5
}, ZD = (e) => iZ[e];
function JD(e, t) {
  let n = ZD(e);
  return n !== G5 && (n = Fc), n.getAnimatableNone ? n.getAnimatableNone(t) : void 0;
}
const aZ = /* @__PURE__ */ new Set(["auto", "none", "0"]);
function sZ(e, t, n) {
  let r = 0, i;
  for (; r < e.length && !i; ) {
    const s = e[r];
    typeof s == "string" && !aZ.has(s) && m0(s).values.length && (i = e[r]), r++;
  }
  if (i && n)
    for (const s of t)
      e[s] = JD(n, i);
}
class oZ extends yE {
  constructor(t, n, r, i, s) {
    super(t, n, r, i, s, !0);
  }
  readKeyframes() {
    const { unresolvedKeyframes: t, element: n, name: r } = this;
    if (!n || !n.current)
      return;
    super.readKeyframes();
    for (let c = 0; c < t.length; c++) {
      let d = t[c];
      if (typeof d == "string" && (d = d.trim(), uE(d))) {
        const m = YD(d, n.current);
        m !== void 0 && (t[c] = m), c === t.length - 1 && (this.finalKeyframe = d);
      }
    }
    if (this.resolveNoneKeyframes(), !WD.has(r) || t.length !== 2)
      return;
    const [i, s] = t, o = _8(i), u = _8(s);
    if (o !== u)
      if (v8(o) && v8(u))
        for (let c = 0; c < t.length; c++) {
          const d = t[c];
          typeof d == "string" && (t[c] = parseFloat(d));
        }
      else Ed[r] && (this.needsMeasurement = !0);
  }
  resolveNoneKeyframes() {
    const { unresolvedKeyframes: t, name: n } = this, r = [];
    for (let i = 0; i < t.length; i++)
      (t[i] === null || JQ(t[i])) && r.push(i);
    r.length && sZ(t, r, n);
  }
  measureInitialState() {
    const { element: t, unresolvedKeyframes: n, name: r } = this;
    if (!t || !t.current)
      return;
    r === "height" && (this.suspendedScrollY = window.pageYOffset), this.measuredOrigin = Ed[r](t.measureViewportBox(), window.getComputedStyle(t.current)), n[0] = this.measuredOrigin;
    const i = n[n.length - 1];
    i !== void 0 && t.getValue(r, i).jump(i, !1);
  }
  measureEndState() {
    var u;
    const { element: t, name: n, unresolvedKeyframes: r } = this;
    if (!t || !t.current)
      return;
    const i = t.getValue(n);
    i && i.jump(this.measuredOrigin, !1);
    const s = r.length - 1, o = r[s];
    r[s] = Ed[n](t.measureViewportBox(), window.getComputedStyle(t.current)), o !== null && this.finalKeyframe === void 0 && (this.finalKeyframe = o), (u = this.removedTransforms) != null && u.length && this.removedTransforms.forEach(([c, d]) => {
      t.getValue(c).set(d);
    }), this.resolveNoneKeyframes();
  }
}
function lZ(e, t, n) {
  if (e instanceof EventTarget)
    return [e];
  if (typeof e == "string") {
    let r = document;
    const i = (n == null ? void 0 : n[e]) ?? r.querySelectorAll(e);
    return i ? Array.from(i) : [];
  }
  return Array.from(e);
}
const eI = (e, t) => t && typeof e == "number" ? t.transform(e) : e;
function uZ(e) {
  return pD(e) && "offsetHeight" in e;
}
const C8 = 30, cZ = (e) => !isNaN(parseFloat(e)), t0 = {
  current: void 0
};
class fZ {
  /**
   * @param init - The initiating value
   * @param config - Optional configuration options
   *
   * -  `transformer`: A function to transform incoming values with.
   */
  constructor(t, n = {}) {
    this.canTrackVelocity = null, this.events = {}, this.updateAndNotify = (r) => {
      var s;
      const i = qa.now();
      if (this.updatedAt !== i && this.setPrevFrameValue(), this.prev = this.current, this.setCurrent(r), this.current !== this.prev && ((s = this.events.change) == null || s.notify(this.current), this.dependents))
        for (const o of this.dependents)
          o.dirty();
    }, this.hasAnimated = !1, this.setCurrent(t), this.owner = n.owner;
  }
  setCurrent(t) {
    this.current = t, this.updatedAt = qa.now(), this.canTrackVelocity === null && t !== void 0 && (this.canTrackVelocity = cZ(this.current));
  }
  setPrevFrameValue(t = this.current) {
    this.prevFrameValue = t, this.prevUpdatedAt = this.updatedAt;
  }
  /**
   * Adds a function that will be notified when the `MotionValue` is updated.
   *
   * It returns a function that, when called, will cancel the subscription.
   *
   * When calling `onChange` inside a React component, it should be wrapped with the
   * `useEffect` hook. As it returns an unsubscribe function, this should be returned
   * from the `useEffect` function to ensure you don't add duplicate subscribers..
   *
   * ```jsx
   * export const MyComponent = () => {
   *   const x = useMotionValue(0)
   *   const y = useMotionValue(0)
   *   const opacity = useMotionValue(1)
   *
   *   useEffect(() => {
   *     function updateOpacity() {
   *       const maxXY = Math.max(x.get(), y.get())
   *       const newOpacity = transform(maxXY, [0, 100], [1, 0])
   *       opacity.set(newOpacity)
   *     }
   *
   *     const unsubscribeX = x.on("change", updateOpacity)
   *     const unsubscribeY = y.on("change", updateOpacity)
   *
   *     return () => {
   *       unsubscribeX()
   *       unsubscribeY()
   *     }
   *   }, [])
   *
   *   return <motion.div style={{ x }} />
   * }
   * ```
   *
   * @param subscriber - A function that receives the latest value.
   * @returns A function that, when called, will cancel this subscription.
   *
   * @deprecated
   */
  onChange(t) {
    return this.on("change", t);
  }
  on(t, n) {
    this.events[t] || (this.events[t] = new sE());
    const r = this.events[t].add(n);
    return t === "change" ? () => {
      r(), nr.read(() => {
        this.events.change.getSize() || this.stop();
      });
    } : r;
  }
  clearListeners() {
    for (const t in this.events)
      this.events[t].clear();
  }
  /**
   * Attaches a passive effect to the `MotionValue`.
   */
  attach(t, n) {
    this.passiveEffect = t, this.stopPassiveEffect = n;
  }
  /**
   * Sets the state of the `MotionValue`.
   *
   * @remarks
   *
   * ```jsx
   * const x = useMotionValue(0)
   * x.set(10)
   * ```
   *
   * @param latest - Latest value to set.
   * @param render - Whether to notify render subscribers. Defaults to `true`
   *
   * @public
   */
  set(t) {
    this.passiveEffect ? this.passiveEffect(t, this.updateAndNotify) : this.updateAndNotify(t);
  }
  setWithVelocity(t, n, r) {
    this.set(n), this.prev = void 0, this.prevFrameValue = t, this.prevUpdatedAt = this.updatedAt - r;
  }
  /**
   * Set the state of the `MotionValue`, stopping any active animations,
   * effects, and resets velocity to `0`.
   */
  jump(t, n = !0) {
    this.updateAndNotify(t), this.prev = t, this.prevUpdatedAt = this.prevFrameValue = void 0, n && this.stop(), this.stopPassiveEffect && this.stopPassiveEffect();
  }
  dirty() {
    var t;
    (t = this.events.change) == null || t.notify(this.current);
  }
  addDependent(t) {
    this.dependents || (this.dependents = /* @__PURE__ */ new Set()), this.dependents.add(t);
  }
  removeDependent(t) {
    this.dependents && this.dependents.delete(t);
  }
  /**
   * Returns the latest state of `MotionValue`
   *
   * @returns - The latest state of `MotionValue`
   *
   * @public
   */
  get() {
    return t0.current && t0.current.push(this), this.current;
  }
  /**
   * @public
   */
  getPrevious() {
    return this.prev;
  }
  /**
   * Returns the latest velocity of `MotionValue`
   *
   * @returns - The latest velocity of `MotionValue`. Returns `0` if the state is non-numerical.
   *
   * @public
   */
  getVelocity() {
    const t = qa.now();
    if (!this.canTrackVelocity || this.prevFrameValue === void 0 || t - this.updatedAt > C8)
      return 0;
    const n = Math.min(this.updatedAt - this.prevUpdatedAt, C8);
    return yD(parseFloat(this.current) - parseFloat(this.prevFrameValue), n);
  }
  /**
   * Registers a new animation to control this `MotionValue`. Only one
   * animation can drive a `MotionValue` at one time.
   *
   * ```jsx
   * value.start()
   * ```
   *
   * @param animation - A function that starts the provided animation
   */
  start(t) {
    return this.stop(), new Promise((n) => {
      this.hasAnimated = !0, this.animation = t(n), this.events.animationStart && this.events.animationStart.notify();
    }).then(() => {
      this.events.animationComplete && this.events.animationComplete.notify(), this.clearAnimation();
    });
  }
  /**
   * Stop the currently active animation.
   *
   * @public
   */
  stop() {
    this.animation && (this.animation.stop(), this.events.animationCancel && this.events.animationCancel.notify()), this.clearAnimation();
  }
  /**
   * Returns `true` if this value is currently animating.
   *
   * @public
   */
  isAnimating() {
    return !!this.animation;
  }
  clearAnimation() {
    delete this.animation;
  }
  /**
   * Destroy and clean up subscribers to this `MotionValue`.
   *
   * The `MotionValue` hooks like `useMotionValue` and `useTransform` automatically
   * handle the lifecycle of the returned `MotionValue`, so this method is only necessary if you've manually
   * created a `MotionValue` via the `motionValue` function.
   *
   * @public
   */
  destroy() {
    var t, n;
    (t = this.dependents) == null || t.clear(), (n = this.events.destroy) == null || n.notify(), this.clearListeners(), this.stop(), this.stopPassiveEffect && this.stopPassiveEffect();
  }
}
function Od(e, t) {
  return new fZ(e, t);
}
const { schedule: bE } = /* @__PURE__ */ ND(queueMicrotask, !1), wo = {
  x: !1,
  y: !1
};
function tI() {
  return wo.x || wo.y;
}
function dZ(e) {
  return e === "x" || e === "y" ? wo[e] ? null : (wo[e] = !0, () => {
    wo[e] = !1;
  }) : wo.x || wo.y ? null : (wo.x = wo.y = !0, () => {
    wo.x = wo.y = !1;
  });
}
function nI(e, t) {
  const n = lZ(e), r = new AbortController(), i = {
    passive: !0,
    ...t,
    signal: r.signal
  };
  return [n, i, () => r.abort()];
}
function E8(e) {
  return !(e.pointerType === "touch" || tI());
}
function hZ(e, t, n = {}) {
  const [r, i, s] = nI(e, n), o = (u) => {
    if (!E8(u))
      return;
    const { target: c } = u, d = t(c, u);
    if (typeof d != "function" || !c)
      return;
    const m = (p) => {
      E8(p) && (d(p), c.removeEventListener("pointerleave", m));
    };
    c.addEventListener("pointerleave", m, i);
  };
  return r.forEach((u) => {
    u.addEventListener("pointerenter", o, i);
  }), s;
}
const rI = (e, t) => t ? e === t ? !0 : rI(e, t.parentElement) : !1, wE = (e) => e.pointerType === "mouse" ? typeof e.button != "number" || e.button <= 0 : e.isPrimary !== !1, mZ = /* @__PURE__ */ new Set([
  "BUTTON",
  "INPUT",
  "SELECT",
  "TEXTAREA",
  "A"
]);
function pZ(e) {
  return mZ.has(e.tagName) || e.tabIndex !== -1;
}
const lv = /* @__PURE__ */ new WeakSet();
function k8(e) {
  return (t) => {
    t.key === "Enter" && e(t);
  };
}
function x2(e, t) {
  e.dispatchEvent(new PointerEvent("pointer" + t, { isPrimary: !0, bubbles: !0 }));
}
const gZ = (e, t) => {
  const n = e.currentTarget;
  if (!n)
    return;
  const r = k8(() => {
    if (lv.has(n))
      return;
    x2(n, "down");
    const i = k8(() => {
      x2(n, "up");
    }), s = () => x2(n, "cancel");
    n.addEventListener("keyup", i, t), n.addEventListener("blur", s, t);
  });
  n.addEventListener("keydown", r, t), n.addEventListener("blur", () => n.removeEventListener("keydown", r), t);
};
function T8(e) {
  return wE(e) && !tI();
}
function yZ(e, t, n = {}) {
  const [r, i, s] = nI(e, n), o = (u) => {
    const c = u.currentTarget;
    if (!T8(u))
      return;
    lv.add(c);
    const d = t(c, u), m = (b, S) => {
      window.removeEventListener("pointerup", p), window.removeEventListener("pointercancel", x), lv.has(c) && lv.delete(c), T8(b) && typeof d == "function" && d(b, { success: S });
    }, p = (b) => {
      m(b, c === window || c === document || n.useGlobalTarget || rI(c, b.target));
    }, x = (b) => {
      m(b, !1);
    };
    window.addEventListener("pointerup", p, i), window.addEventListener("pointercancel", x, i);
  };
  return r.forEach((u) => {
    (n.useGlobalTarget ? window : u).addEventListener("pointerdown", o, i), uZ(u) && (u.addEventListener("focus", (d) => gZ(d, i)), !pZ(u) && !u.hasAttribute("tabindex") && (u.tabIndex = 0));
  }), s;
}
function iI(e) {
  return pD(e) && "ownerSVGElement" in e;
}
function vZ(e) {
  return iI(e) && e.tagName === "svg";
}
function xZ(...e) {
  const t = !Array.isArray(e[0]), n = t ? 0 : -1, r = e[0 + n], i = e[1 + n], s = e[2 + n], o = e[3 + n], u = qD(i, s, o);
  return t ? u(r) : u;
}
const _i = (e) => !!(e && e.getVelocity), bZ = [...QD, Pr, Fc], wZ = (e) => bZ.find(XD(e)), _E = F.createContext({
  transformPagePoint: (e) => e,
  isStatic: !1,
  reducedMotion: "never"
});
function _Z(e = !0) {
  const t = F.useContext(tE);
  if (t === null)
    return [!0, null];
  const { isPresent: n, onExitComplete: r, register: i } = t, s = F.useId();
  F.useEffect(() => {
    if (e)
      return i(s);
  }, [e]);
  const o = F.useCallback(() => e && r && r(s), [s, r, e]);
  return !n && r ? [!1, o] : [!0];
}
const aI = F.createContext({ strict: !1 }), N8 = {
  animation: [
    "animate",
    "variants",
    "whileHover",
    "whileTap",
    "exit",
    "whileInView",
    "whileFocus",
    "whileDrag"
  ],
  exit: ["exit"],
  drag: ["drag", "dragControls"],
  focus: ["whileFocus"],
  hover: ["whileHover", "onHoverStart", "onHoverEnd"],
  tap: ["whileTap", "onTap", "onTapStart", "onTapCancel"],
  pan: ["onPan", "onPanStart", "onPanSessionStart", "onPanEnd"],
  inView: ["whileInView", "onViewportEnter", "onViewportLeave"],
  layout: ["layout", "layoutId"]
}, Nm = {};
for (const e in N8)
  Nm[e] = {
    isEnabled: (t) => N8[e].some((n) => !!t[n])
  };
function SZ(e) {
  for (const t in e)
    Nm[t] = {
      ...Nm[t],
      ...e[t]
    };
}
const CZ = /* @__PURE__ */ new Set([
  "animate",
  "exit",
  "variants",
  "initial",
  "style",
  "values",
  "variants",
  "transition",
  "transformTemplate",
  "custom",
  "inherit",
  "onBeforeLayoutMeasure",
  "onAnimationStart",
  "onAnimationComplete",
  "onUpdate",
  "onDragStart",
  "onDrag",
  "onDragEnd",
  "onMeasureDragConstraints",
  "onDirectionLock",
  "onDragTransitionEnd",
  "_dragX",
  "_dragY",
  "onHoverStart",
  "onHoverEnd",
  "onViewportEnter",
  "onViewportLeave",
  "globalTapTarget",
  "ignoreStrict",
  "viewport"
]);
function Rv(e) {
  return e.startsWith("while") || e.startsWith("drag") && e !== "draggable" || e.startsWith("layout") || e.startsWith("onTap") || e.startsWith("onPan") || e.startsWith("onLayout") || CZ.has(e);
}
let sI = (e) => !Rv(e);
function EZ(e) {
  typeof e == "function" && (sI = (t) => t.startsWith("on") ? !Rv(t) : e(t));
}
try {
  EZ(require("@emotion/is-prop-valid").default);
} catch {
}
function kZ(e, t, n) {
  const r = {};
  for (const i in e)
    i === "values" && typeof e.values == "object" || (sI(i) || n === !0 && Rv(i) || !t && !Rv(i) || // If trying to use native HTML drag events, forward drag listeners
    e.draggable && i.startsWith("onDrag")) && (r[i] = e[i]);
  return r;
}
const ux = /* @__PURE__ */ F.createContext({});
function cx(e) {
  return e !== null && typeof e == "object" && typeof e.start == "function";
}
function p0(e) {
  return typeof e == "string" || Array.isArray(e);
}
const SE = [
  "animate",
  "whileInView",
  "whileFocus",
  "whileHover",
  "whileTap",
  "whileDrag",
  "exit"
], CE = ["initial", ...SE];
function fx(e) {
  return cx(e.animate) || CE.some((t) => p0(e[t]));
}
function oI(e) {
  return !!(fx(e) || e.variants);
}
function TZ(e, t) {
  if (fx(e)) {
    const { initial: n, animate: r } = e;
    return {
      initial: n === !1 || p0(n) ? n : void 0,
      animate: p0(r) ? r : void 0
    };
  }
  return e.inherit !== !1 ? t : {};
}
function NZ(e) {
  const { initial: t, animate: n } = TZ(e, F.useContext(ux));
  return F.useMemo(() => ({ initial: t, animate: n }), [A8(t), A8(n)]);
}
function A8(e) {
  return Array.isArray(e) ? e.join(" ") : e;
}
function j8(e, t) {
  return t.max === t.min ? 0 : e / (t.max - t.min) * 100;
}
const Ig = {
  correct: (e, t) => {
    if (!t.target)
      return e;
    if (typeof e == "string")
      if (Ot.test(e))
        e = parseFloat(e);
      else
        return e;
    const n = j8(e, t.target.x), r = j8(e, t.target.y);
    return `${n}% ${r}%`;
  }
}, AZ = {
  correct: (e, { treeScale: t, projectionDelta: n }) => {
    const r = e, i = Fc.parse(e);
    if (i.length > 5)
      return r;
    const s = Fc.createTransformer(e), o = typeof i[0] != "number" ? 1 : 0, u = n.x.scale * t.x, c = n.y.scale * t.y;
    i[0 + o] /= u, i[1 + o] /= c;
    const d = or(u, c, 0.5);
    return typeof i[2 + o] == "number" && (i[2 + o] /= d), typeof i[3 + o] == "number" && (i[3 + o] /= d), s(i);
  }
}, K5 = {
  borderRadius: {
    ...Ig,
    applyTo: [
      "borderTopLeftRadius",
      "borderTopRightRadius",
      "borderBottomLeftRadius",
      "borderBottomRightRadius"
    ]
  },
  borderTopLeftRadius: Ig,
  borderTopRightRadius: Ig,
  borderBottomLeftRadius: Ig,
  borderBottomRightRadius: Ig,
  boxShadow: AZ
};
function lI(e, { layout: t, layoutId: n }) {
  return $m.has(e) || e.startsWith("origin") || (t || n !== void 0) && (!!K5[e] || e === "opacity");
}
const jZ = {
  x: "translateX",
  y: "translateY",
  z: "translateZ",
  transformPerspective: "perspective"
}, MZ = Um.length;
function RZ(e, t, n) {
  let r = "", i = !0;
  for (let s = 0; s < MZ; s++) {
    const o = Um[s], u = e[o];
    if (u === void 0)
      continue;
    let c = !0;
    if (typeof u == "number" ? c = u === (o.startsWith("scale") ? 1 : 0) : c = parseFloat(u) === 0, !c || n) {
      const d = eI(u, xE[o]);
      if (!c) {
        i = !1;
        const m = jZ[o] || o;
        r += `${m}(${d}) `;
      }
      n && (t[o] = d);
    }
  }
  return r = r.trim(), n ? r = n(t, i ? "" : r) : i && (r = "none"), r;
}
function EE(e, t, n) {
  const { style: r, vars: i, transformOrigin: s } = e;
  let o = !1, u = !1;
  for (const c in t) {
    const d = t[c];
    if ($m.has(c)) {
      o = !0;
      continue;
    } else if (jD(c)) {
      i[c] = d;
      continue;
    } else {
      const m = eI(d, xE[c]);
      c.startsWith("origin") ? (u = !0, s[c] = m) : r[c] = m;
    }
  }
  if (t.transform || (o || n ? r.transform = RZ(t, e.transform, n) : r.transform && (r.transform = "none")), u) {
    const { originX: c = "50%", originY: d = "50%", originZ: m = 0 } = s;
    r.transformOrigin = `${c} ${d} ${m}`;
  }
}
const kE = () => ({
  style: {},
  transform: {},
  transformOrigin: {},
  vars: {}
});
function uI(e, t, n) {
  for (const r in t)
    !_i(t[r]) && !lI(r, n) && (e[r] = t[r]);
}
function OZ({ transformTemplate: e }, t) {
  return F.useMemo(() => {
    const n = kE();
    return EE(n, t, e), Object.assign({}, n.vars, n.style);
  }, [t]);
}
function DZ(e, t) {
  const n = e.style || {}, r = {};
  return uI(r, n, e), Object.assign(r, OZ(e, t)), r;
}
function IZ(e, t) {
  const n = {}, r = DZ(e, t);
  return e.drag && e.dragListener !== !1 && (n.draggable = !1, r.userSelect = r.WebkitUserSelect = r.WebkitTouchCallout = "none", r.touchAction = e.drag === !0 ? "none" : `pan-${e.drag === "x" ? "y" : "x"}`), e.tabIndex === void 0 && (e.onTap || e.onTapStart || e.whileTap) && (n.tabIndex = 0), n.style = r, n;
}
const PZ = {
  offset: "stroke-dashoffset",
  array: "stroke-dasharray"
}, zZ = {
  offset: "strokeDashoffset",
  array: "strokeDasharray"
};
function LZ(e, t, n = 1, r = 0, i = !0) {
  e.pathLength = 1;
  const s = i ? PZ : zZ;
  e[s.offset] = Ot.transform(-r);
  const o = Ot.transform(t), u = Ot.transform(n);
  e[s.array] = `${o} ${u}`;
}
function cI(e, {
  attrX: t,
  attrY: n,
  attrScale: r,
  pathLength: i,
  pathSpacing: s = 1,
  pathOffset: o = 0,
  // This is object creation, which we try to avoid per-frame.
  ...u
}, c, d, m) {
  if (EE(e, u, d), c) {
    e.style.viewBox && (e.attrs.viewBox = e.style.viewBox);
    return;
  }
  e.attrs = e.style, e.style = {};
  const { attrs: p, style: x } = e;
  p.transform && (x.transform = p.transform, delete p.transform), (x.transform || p.transformOrigin) && (x.transformOrigin = p.transformOrigin ?? "50% 50%", delete p.transformOrigin), x.transform && (x.transformBox = (m == null ? void 0 : m.transformBox) ?? "fill-box", delete p.transformBox), t !== void 0 && (p.x = t), n !== void 0 && (p.y = n), r !== void 0 && (p.scale = r), i !== void 0 && LZ(p, i, s, o, !1);
}
const fI = () => ({
  ...kE(),
  attrs: {}
}), dI = (e) => typeof e == "string" && e.toLowerCase() === "svg";
function BZ(e, t, n, r) {
  const i = F.useMemo(() => {
    const s = fI();
    return cI(s, t, dI(r), e.transformTemplate, e.style), {
      ...s.attrs,
      style: { ...s.style }
    };
  }, [t]);
  if (e.style) {
    const s = {};
    uI(s, e.style, e), i.style = { ...s, ...i.style };
  }
  return i;
}
const qZ = [
  "animate",
  "circle",
  "defs",
  "desc",
  "ellipse",
  "g",
  "image",
  "line",
  "filter",
  "marker",
  "mask",
  "metadata",
  "path",
  "pattern",
  "polygon",
  "polyline",
  "rect",
  "stop",
  "switch",
  "symbol",
  "svg",
  "text",
  "tspan",
  "use",
  "view"
];
function TE(e) {
  return (
    /**
     * If it's not a string, it's a custom React component. Currently we only support
     * HTML custom React components.
     */
    typeof e != "string" || /**
     * If it contains a dash, the element is a custom HTML webcomponent.
     */
    e.includes("-") ? !1 : (
      /**
       * If it's in our list of lowercase SVG tags, it's an SVG component
       */
      !!(qZ.indexOf(e) > -1 || /**
       * If it contains a capital letter, it's an SVG component
       */
      /[A-Z]/u.test(e))
    )
  );
}
function FZ(e, t, n, { latestValues: r }, i, s = !1) {
  const u = (TE(e) ? BZ : IZ)(t, r, i, e), c = kZ(t, typeof e == "string", s), d = e !== F.Fragment ? { ...c, ...u, ref: n } : {}, { children: m } = t, p = F.useMemo(() => _i(m) ? m.get() : m, [m]);
  return F.createElement(e, {
    ...d,
    children: p
  });
}
function M8(e) {
  const t = [{}, {}];
  return e == null || e.values.forEach((n, r) => {
    t[0][r] = n.get(), t[1][r] = n.getVelocity();
  }), t;
}
function NE(e, t, n, r) {
  if (typeof t == "function") {
    const [i, s] = M8(r);
    t = t(n !== void 0 ? n : e.custom, i, s);
  }
  if (typeof t == "string" && (t = e.variants && e.variants[t]), typeof t == "function") {
    const [i, s] = M8(r);
    t = t(n !== void 0 ? n : e.custom, i, s);
  }
  return t;
}
function uv(e) {
  return _i(e) ? e.get() : e;
}
function UZ({ scrapeMotionValuesFromProps: e, createRenderState: t }, n, r, i) {
  return {
    latestValues: $Z(n, r, i, e),
    renderState: t()
  };
}
function $Z(e, t, n, r) {
  const i = {}, s = r(e, {});
  for (const x in s)
    i[x] = uv(s[x]);
  let { initial: o, animate: u } = e;
  const c = fx(e), d = oI(e);
  t && d && !c && e.inherit !== !1 && (o === void 0 && (o = t.initial), u === void 0 && (u = t.animate));
  let m = n ? n.initial === !1 : !1;
  m = m || o === !1;
  const p = m ? u : o;
  if (p && typeof p != "boolean" && !cx(p)) {
    const x = Array.isArray(p) ? p : [p];
    for (let b = 0; b < x.length; b++) {
      const S = NE(e, x[b]);
      if (S) {
        const { transitionEnd: k, transition: A, ...T } = S;
        for (const M in T) {
          let j = T[M];
          if (Array.isArray(j)) {
            const D = m ? j.length - 1 : 0;
            j = j[D];
          }
          j !== null && (i[M] = j);
        }
        for (const M in k)
          i[M] = k[M];
      }
    }
  }
  return i;
}
const hI = (e) => (t, n) => {
  const r = F.useContext(ux), i = F.useContext(tE), s = () => UZ(e, t, r, i);
  return n ? s() : D0(s);
};
function AE(e, t, n) {
  var s;
  const { style: r } = e, i = {};
  for (const o in r)
    (_i(r[o]) || t.style && _i(t.style[o]) || lI(o, e) || ((s = n == null ? void 0 : n.getValue(o)) == null ? void 0 : s.liveStyle) !== void 0) && (i[o] = r[o]);
  return i;
}
const VZ = /* @__PURE__ */ hI({
  scrapeMotionValuesFromProps: AE,
  createRenderState: kE
});
function mI(e, t, n) {
  const r = AE(e, t, n);
  for (const i in e)
    if (_i(e[i]) || _i(t[i])) {
      const s = Um.indexOf(i) !== -1 ? "attr" + i.charAt(0).toUpperCase() + i.substring(1) : i;
      r[s] = e[i];
    }
  return r;
}
const HZ = /* @__PURE__ */ hI({
  scrapeMotionValuesFromProps: mI,
  createRenderState: fI
}), GZ = Symbol.for("motionComponentSymbol");
function gm(e) {
  return e && typeof e == "object" && Object.prototype.hasOwnProperty.call(e, "current");
}
function KZ(e, t, n) {
  return F.useCallback(
    (r) => {
      r && e.onMount && e.onMount(r), t && (r ? t.mount(r) : t.unmount()), n && (typeof n == "function" ? n(r) : gm(n) && (n.current = r));
    },
    /**
     * Include externalRef in dependencies to ensure the callback updates
     * when the ref changes, allowing proper ref forwarding.
     */
    [t]
  );
}
const jE = (e) => e.replace(/([a-z])([A-Z])/gu, "$1-$2").toLowerCase(), YZ = "framerAppearId", pI = "data-" + jE(YZ), gI = F.createContext({});
function WZ(e, t, n, r, i) {
  var k, A;
  const { visualElement: s } = F.useContext(ux), o = F.useContext(aI), u = F.useContext(tE), c = F.useContext(_E).reducedMotion, d = F.useRef(null);
  r = r || o.renderer, !d.current && r && (d.current = r(e, {
    visualState: t,
    parent: s,
    props: n,
    presenceContext: u,
    blockInitialAnimation: u ? u.initial === !1 : !1,
    reducedMotionConfig: c
  }));
  const m = d.current, p = F.useContext(gI);
  m && !m.projection && i && (m.type === "html" || m.type === "svg") && XZ(d.current, n, i, p);
  const x = F.useRef(!1);
  F.useInsertionEffect(() => {
    m && x.current && m.update(n, u);
  });
  const b = n[pI], S = F.useRef(!!b && !((k = window.MotionHandoffIsComplete) != null && k.call(window, b)) && ((A = window.MotionHasOptimisedAnimation) == null ? void 0 : A.call(window, b)));
  return hD(() => {
    m && (x.current = !0, window.MotionIsMounted = !0, m.updateFeatures(), m.scheduleRenderMicrotask(), S.current && m.animationState && m.animationState.animateChanges());
  }), F.useEffect(() => {
    m && (!S.current && m.animationState && m.animationState.animateChanges(), S.current && (queueMicrotask(() => {
      var T;
      (T = window.MotionHandoffMarkAsComplete) == null || T.call(window, b);
    }), S.current = !1), m.enteringChildren = void 0);
  }), m;
}
function XZ(e, t, n, r) {
  const { layoutId: i, layout: s, drag: o, dragConstraints: u, layoutScroll: c, layoutRoot: d, layoutCrossfade: m } = t;
  e.projection = new n(e.latestValues, t["data-framer-portal-id"] ? void 0 : yI(e.parent)), e.projection.setOptions({
    layoutId: i,
    layout: s,
    alwaysMeasureLayout: !!o || u && gm(u),
    visualElement: e,
    /**
     * TODO: Update options in an effect. This could be tricky as it'll be too late
     * to update by the time layout animations run.
     * We also need to fix this safeToRemove by linking it up to the one returned by usePresence,
     * ensuring it gets called if there's no potential layout animations.
     *
     */
    animationType: typeof s == "string" ? s : "both",
    initialPromotionConfig: r,
    crossfade: m,
    layoutScroll: c,
    layoutRoot: d
  });
}
function yI(e) {
  if (e)
    return e.options.allowProjection !== !1 ? e.projection : yI(e.parent);
}
function b2(e, { forwardMotionProps: t = !1 } = {}, n, r) {
  n && SZ(n);
  const i = TE(e) ? HZ : VZ;
  function s(u, c) {
    let d;
    const m = {
      ...F.useContext(_E),
      ...u,
      layoutId: QZ(u)
    }, { isStatic: p } = m, x = NZ(u), b = i(u, p);
    if (!p && eE) {
      ZZ();
      const S = JZ(m);
      d = S.MeasureLayout, x.visualElement = WZ(e, b, m, r, S.ProjectionNode);
    }
    return g.jsxs(ux.Provider, { value: x, children: [d && x.visualElement ? g.jsx(d, { visualElement: x.visualElement, ...m }) : null, FZ(e, u, KZ(b, x.visualElement, c), b, p, t)] });
  }
  s.displayName = `motion.${typeof e == "string" ? e : `create(${e.displayName ?? e.name ?? ""})`}`;
  const o = F.forwardRef(s);
  return o[GZ] = e, o;
}
function QZ({ layoutId: e }) {
  const t = F.useContext(dD).id;
  return t && e !== void 0 ? t + "-" + e : e;
}
function ZZ(e, t) {
  F.useContext(aI).strict;
}
function JZ(e) {
  const { drag: t, layout: n } = Nm;
  if (!t && !n)
    return {};
  const r = { ...t, ...n };
  return {
    MeasureLayout: t != null && t.isEnabled(e) || n != null && n.isEnabled(e) ? r.MeasureLayout : void 0,
    ProjectionNode: r.ProjectionNode
  };
}
function eJ(e, t) {
  if (typeof Proxy > "u")
    return b2;
  const n = /* @__PURE__ */ new Map(), r = (s, o) => b2(s, o, e, t), i = (s, o) => r(s, o);
  return new Proxy(i, {
    /**
     * Called when `motion` is referenced with a prop: `motion.div`, `motion.input` etc.
     * The prop name is passed through as `key` and we can use that to generate a `motion`
     * DOM component with that name.
     */
    get: (s, o) => o === "create" ? r : (n.has(o) || n.set(o, b2(o, void 0, e, t)), n.get(o))
  });
}
function vI({ top: e, left: t, right: n, bottom: r }) {
  return {
    x: { min: t, max: n },
    y: { min: e, max: r }
  };
}
function tJ({ x: e, y: t }) {
  return { top: t.min, right: e.max, bottom: t.max, left: e.min };
}
function nJ(e, t) {
  if (!t)
    return e;
  const n = t({ x: e.left, y: e.top }), r = t({ x: e.right, y: e.bottom });
  return {
    top: n.y,
    left: n.x,
    bottom: r.y,
    right: r.x
  };
}
function w2(e) {
  return e === void 0 || e === 1;
}
function Y5({ scale: e, scaleX: t, scaleY: n }) {
  return !w2(e) || !w2(t) || !w2(n);
}
function dd(e) {
  return Y5(e) || xI(e) || e.z || e.rotate || e.rotateX || e.rotateY || e.skewX || e.skewY;
}
function xI(e) {
  return R8(e.x) || R8(e.y);
}
function R8(e) {
  return e && e !== "0%";
}
function Ov(e, t, n) {
  const r = e - n, i = t * r;
  return n + i;
}
function O8(e, t, n, r, i) {
  return i !== void 0 && (e = Ov(e, i, r)), Ov(e, n, r) + t;
}
function W5(e, t = 0, n = 1, r, i) {
  e.min = O8(e.min, t, n, r, i), e.max = O8(e.max, t, n, r, i);
}
function bI(e, { x: t, y: n }) {
  W5(e.x, t.translate, t.scale, t.originPoint), W5(e.y, n.translate, n.scale, n.originPoint);
}
const D8 = 0.999999999999, I8 = 1.0000000000001;
function rJ(e, t, n, r = !1) {
  const i = n.length;
  if (!i)
    return;
  t.x = t.y = 1;
  let s, o;
  for (let u = 0; u < i; u++) {
    s = n[u], o = s.projectionDelta;
    const { visualElement: c } = s.options;
    c && c.props.style && c.props.style.display === "contents" || (r && s.options.layoutScroll && s.scroll && s !== s.root && vm(e, {
      x: -s.scroll.offset.x,
      y: -s.scroll.offset.y
    }), o && (t.x *= o.x.scale, t.y *= o.y.scale, bI(e, o)), r && dd(s.latestValues) && vm(e, s.latestValues));
  }
  t.x < I8 && t.x > D8 && (t.x = 1), t.y < I8 && t.y > D8 && (t.y = 1);
}
function ym(e, t) {
  e.min = e.min + t, e.max = e.max + t;
}
function P8(e, t, n, r, i = 0.5) {
  const s = or(e.min, e.max, i);
  W5(e, t, n, s, r);
}
function vm(e, t) {
  P8(e.x, t.x, t.scaleX, t.scale, t.originX), P8(e.y, t.y, t.scaleY, t.scale, t.originY);
}
function wI(e, t) {
  return vI(nJ(e.getBoundingClientRect(), t));
}
function iJ(e, t, n) {
  const r = wI(e, n), { scroll: i } = t;
  return i && (ym(r.x, i.offset.x), ym(r.y, i.offset.y)), r;
}
const z8 = () => ({
  translate: 0,
  scale: 1,
  origin: 0,
  originPoint: 0
}), xm = () => ({
  x: z8(),
  y: z8()
}), L8 = () => ({ min: 0, max: 0 }), Xr = () => ({
  x: L8(),
  y: L8()
}), X5 = { current: null }, _I = { current: !1 };
function aJ() {
  if (_I.current = !0, !!eE)
    if (window.matchMedia) {
      const e = window.matchMedia("(prefers-reduced-motion)"), t = () => X5.current = e.matches;
      e.addEventListener("change", t), t();
    } else
      X5.current = !1;
}
const sJ = /* @__PURE__ */ new WeakMap();
function oJ(e, t, n) {
  for (const r in t) {
    const i = t[r], s = n[r];
    if (_i(i))
      e.addValue(r, i);
    else if (_i(s))
      e.addValue(r, Od(i, { owner: e }));
    else if (s !== i)
      if (e.hasValue(r)) {
        const o = e.getValue(r);
        o.liveStyle === !0 ? o.jump(i) : o.hasAnimated || o.set(i);
      } else {
        const o = e.getStaticValue(r);
        e.addValue(r, Od(o !== void 0 ? o : i, { owner: e }));
      }
  }
  for (const r in n)
    t[r] === void 0 && e.removeValue(r);
  return t;
}
const B8 = [
  "AnimationStart",
  "AnimationComplete",
  "Update",
  "BeforeLayoutMeasure",
  "LayoutMeasure",
  "LayoutAnimationStart",
  "LayoutAnimationComplete"
];
class lJ {
  /**
   * This method takes React props and returns found MotionValues. For example, HTML
   * MotionValues will be found within the style prop, whereas for Three.js within attribute arrays.
   *
   * This isn't an abstract method as it needs calling in the constructor, but it is
   * intended to be one.
   */
  scrapeMotionValuesFromProps(t, n, r) {
    return {};
  }
  constructor({ parent: t, props: n, presenceContext: r, reducedMotionConfig: i, blockInitialAnimation: s, visualState: o }, u = {}) {
    this.current = null, this.children = /* @__PURE__ */ new Set(), this.isVariantNode = !1, this.isControllingVariants = !1, this.shouldReduceMotion = null, this.values = /* @__PURE__ */ new Map(), this.KeyframeResolver = yE, this.features = {}, this.valueSubscriptions = /* @__PURE__ */ new Map(), this.prevMotionValues = {}, this.events = {}, this.propEventSubscriptions = {}, this.notifyUpdate = () => this.notify("Update", this.latestValues), this.render = () => {
      this.current && (this.triggerBuild(), this.renderInstance(this.current, this.renderState, this.props.style, this.projection));
    }, this.renderScheduledAt = 0, this.scheduleRender = () => {
      const x = qa.now();
      this.renderScheduledAt < x && (this.renderScheduledAt = x, nr.render(this.render, !1, !0));
    };
    const { latestValues: c, renderState: d } = o;
    this.latestValues = c, this.baseTarget = { ...c }, this.initialValues = n.initial ? { ...c } : {}, this.renderState = d, this.parent = t, this.props = n, this.presenceContext = r, this.depth = t ? t.depth + 1 : 0, this.reducedMotionConfig = i, this.options = u, this.blockInitialAnimation = !!s, this.isControllingVariants = fx(n), this.isVariantNode = oI(n), this.isVariantNode && (this.variantChildren = /* @__PURE__ */ new Set()), this.manuallyAnimateOnMount = !!(t && t.current);
    const { willChange: m, ...p } = this.scrapeMotionValuesFromProps(n, {}, this);
    for (const x in p) {
      const b = p[x];
      c[x] !== void 0 && _i(b) && b.set(c[x]);
    }
  }
  mount(t) {
    var n;
    this.current = t, sJ.set(t, this), this.projection && !this.projection.instance && this.projection.mount(t), this.parent && this.isVariantNode && !this.isControllingVariants && (this.removeFromVariantTree = this.parent.addVariantChild(this)), this.values.forEach((r, i) => this.bindToMotionValue(i, r)), _I.current || aJ(), this.shouldReduceMotion = this.reducedMotionConfig === "never" ? !1 : this.reducedMotionConfig === "always" ? !0 : X5.current, (n = this.parent) == null || n.addChild(this), this.update(this.props, this.presenceContext);
  }
  unmount() {
    var t;
    this.projection && this.projection.unmount(), Su(this.notifyUpdate), Su(this.render), this.valueSubscriptions.forEach((n) => n()), this.valueSubscriptions.clear(), this.removeFromVariantTree && this.removeFromVariantTree(), (t = this.parent) == null || t.removeChild(this);
    for (const n in this.events)
      this.events[n].clear();
    for (const n in this.features) {
      const r = this.features[n];
      r && (r.unmount(), r.isMounted = !1);
    }
    this.current = null;
  }
  addChild(t) {
    this.children.add(t), this.enteringChildren ?? (this.enteringChildren = /* @__PURE__ */ new Set()), this.enteringChildren.add(t);
  }
  removeChild(t) {
    this.children.delete(t), this.enteringChildren && this.enteringChildren.delete(t);
  }
  bindToMotionValue(t, n) {
    this.valueSubscriptions.has(t) && this.valueSubscriptions.get(t)();
    const r = $m.has(t);
    r && this.onBindTransform && this.onBindTransform();
    const i = n.on("change", (o) => {
      this.latestValues[t] = o, this.props.onUpdate && nr.preRender(this.notifyUpdate), r && this.projection && (this.projection.isTransformDirty = !0), this.scheduleRender();
    });
    let s;
    window.MotionCheckAppearSync && (s = window.MotionCheckAppearSync(this, t, n)), this.valueSubscriptions.set(t, () => {
      i(), s && s(), n.owner && n.stop();
    });
  }
  sortNodePosition(t) {
    return !this.current || !this.sortInstanceNodePosition || this.type !== t.type ? 0 : this.sortInstanceNodePosition(this.current, t.current);
  }
  updateFeatures() {
    let t = "animation";
    for (t in Nm) {
      const n = Nm[t];
      if (!n)
        continue;
      const { isEnabled: r, Feature: i } = n;
      if (!this.features[t] && i && r(this.props) && (this.features[t] = new i(this)), this.features[t]) {
        const s = this.features[t];
        s.isMounted ? s.update() : (s.mount(), s.isMounted = !0);
      }
    }
  }
  triggerBuild() {
    this.build(this.renderState, this.latestValues, this.props);
  }
  /**
   * Measure the current viewport box with or without transforms.
   * Only measures axis-aligned boxes, rotate and skew must be manually
   * removed with a re-render to work.
   */
  measureViewportBox() {
    return this.current ? this.measureInstanceViewportBox(this.current, this.props) : Xr();
  }
  getStaticValue(t) {
    return this.latestValues[t];
  }
  setStaticValue(t, n) {
    this.latestValues[t] = n;
  }
  /**
   * Update the provided props. Ensure any newly-added motion values are
   * added to our map, old ones removed, and listeners updated.
   */
  update(t, n) {
    (t.transformTemplate || this.props.transformTemplate) && this.scheduleRender(), this.prevProps = this.props, this.props = t, this.prevPresenceContext = this.presenceContext, this.presenceContext = n;
    for (let r = 0; r < B8.length; r++) {
      const i = B8[r];
      this.propEventSubscriptions[i] && (this.propEventSubscriptions[i](), delete this.propEventSubscriptions[i]);
      const s = "on" + i, o = t[s];
      o && (this.propEventSubscriptions[i] = this.on(i, o));
    }
    this.prevMotionValues = oJ(this, this.scrapeMotionValuesFromProps(t, this.prevProps, this), this.prevMotionValues), this.handleChildMotionValue && this.handleChildMotionValue();
  }
  getProps() {
    return this.props;
  }
  /**
   * Returns the variant definition with a given name.
   */
  getVariant(t) {
    return this.props.variants ? this.props.variants[t] : void 0;
  }
  /**
   * Returns the defined default transition on this component.
   */
  getDefaultTransition() {
    return this.props.transition;
  }
  getTransformPagePoint() {
    return this.props.transformPagePoint;
  }
  getClosestVariantNode() {
    return this.isVariantNode ? this : this.parent ? this.parent.getClosestVariantNode() : void 0;
  }
  /**
   * Add a child visual element to our set of children.
   */
  addVariantChild(t) {
    const n = this.getClosestVariantNode();
    if (n)
      return n.variantChildren && n.variantChildren.add(t), () => n.variantChildren.delete(t);
  }
  /**
   * Add a motion value and bind it to this visual element.
   */
  addValue(t, n) {
    const r = this.values.get(t);
    n !== r && (r && this.removeValue(t), this.bindToMotionValue(t, n), this.values.set(t, n), this.latestValues[t] = n.get());
  }
  /**
   * Remove a motion value and unbind any active subscriptions.
   */
  removeValue(t) {
    this.values.delete(t);
    const n = this.valueSubscriptions.get(t);
    n && (n(), this.valueSubscriptions.delete(t)), delete this.latestValues[t], this.removeValueFromRenderState(t, this.renderState);
  }
  /**
   * Check whether we have a motion value for this key
   */
  hasValue(t) {
    return this.values.has(t);
  }
  getValue(t, n) {
    if (this.props.values && this.props.values[t])
      return this.props.values[t];
    let r = this.values.get(t);
    return r === void 0 && n !== void 0 && (r = Od(n === null ? void 0 : n, { owner: this }), this.addValue(t, r)), r;
  }
  /**
   * If we're trying to animate to a previously unencountered value,
   * we need to check for it in our state and as a last resort read it
   * directly from the instance (which might have performance implications).
   */
  readValue(t, n) {
    let r = this.latestValues[t] !== void 0 || !this.current ? this.latestValues[t] : this.getBaseTargetFromProps(this.props, t) ?? this.readValueFromInstance(this.current, t, this.options);
    return r != null && (typeof r == "string" && (mD(r) || gD(r)) ? r = parseFloat(r) : !wZ(r) && Fc.test(n) && (r = JD(t, n)), this.setBaseTarget(t, _i(r) ? r.get() : r)), _i(r) ? r.get() : r;
  }
  /**
   * Set the base target to later animate back to. This is currently
   * only hydrated on creation and when we first read a value.
   */
  setBaseTarget(t, n) {
    this.baseTarget[t] = n;
  }
  /**
   * Find the base target for a value thats been removed from all animation
   * props.
   */
  getBaseTarget(t) {
    var s;
    const { initial: n } = this.props;
    let r;
    if (typeof n == "string" || typeof n == "object") {
      const o = NE(this.props, n, (s = this.presenceContext) == null ? void 0 : s.custom);
      o && (r = o[t]);
    }
    if (n && r !== void 0)
      return r;
    const i = this.getBaseTargetFromProps(this.props, t);
    return i !== void 0 && !_i(i) ? i : this.initialValues[t] !== void 0 && r === void 0 ? void 0 : this.baseTarget[t];
  }
  on(t, n) {
    return this.events[t] || (this.events[t] = new sE()), this.events[t].add(n);
  }
  notify(t, ...n) {
    this.events[t] && this.events[t].notify(...n);
  }
  scheduleRenderMicrotask() {
    bE.render(this.render);
  }
}
class SI extends lJ {
  constructor() {
    super(...arguments), this.KeyframeResolver = oZ;
  }
  sortInstanceNodePosition(t, n) {
    return t.compareDocumentPosition(n) & 2 ? 1 : -1;
  }
  getBaseTargetFromProps(t, n) {
    return t.style ? t.style[n] : void 0;
  }
  removeValueFromRenderState(t, { vars: n, style: r }) {
    delete n[t], delete r[t];
  }
  handleChildMotionValue() {
    this.childSubscription && (this.childSubscription(), delete this.childSubscription);
    const { children: t } = this.props;
    _i(t) && (this.childSubscription = t.on("change", (n) => {
      this.current && (this.current.textContent = `${n}`);
    }));
  }
}
function CI(e, { style: t, vars: n }, r, i) {
  const s = e.style;
  let o;
  for (o in t)
    s[o] = t[o];
  i == null || i.applyProjectionStyles(s, r);
  for (o in n)
    s.setProperty(o, n[o]);
}
function uJ(e) {
  return window.getComputedStyle(e);
}
class cJ extends SI {
  constructor() {
    super(...arguments), this.type = "html", this.renderInstance = CI;
  }
  readValueFromInstance(t, n) {
    var r;
    if ($m.has(n))
      return (r = this.projection) != null && r.isProjecting ? q5(n) : kQ(t, n);
    {
      const i = uJ(t), s = (jD(n) ? i.getPropertyValue(n) : i[n]) || 0;
      return typeof s == "string" ? s.trim() : s;
    }
  }
  measureInstanceViewportBox(t, { transformPagePoint: n }) {
    return wI(t, n);
  }
  build(t, n, r) {
    EE(t, n, r.transformTemplate);
  }
  scrapeMotionValuesFromProps(t, n, r) {
    return AE(t, n, r);
  }
}
const EI = /* @__PURE__ */ new Set([
  "baseFrequency",
  "diffuseConstant",
  "kernelMatrix",
  "kernelUnitLength",
  "keySplines",
  "keyTimes",
  "limitingConeAngle",
  "markerHeight",
  "markerWidth",
  "numOctaves",
  "targetX",
  "targetY",
  "surfaceScale",
  "specularConstant",
  "specularExponent",
  "stdDeviation",
  "tableValues",
  "viewBox",
  "gradientTransform",
  "pathLength",
  "startOffset",
  "textLength",
  "lengthAdjust"
]);
function fJ(e, t, n, r) {
  CI(e, t, void 0, r);
  for (const i in t.attrs)
    e.setAttribute(EI.has(i) ? i : jE(i), t.attrs[i]);
}
class dJ extends SI {
  constructor() {
    super(...arguments), this.type = "svg", this.isSVGTag = !1, this.measureInstanceViewportBox = Xr;
  }
  getBaseTargetFromProps(t, n) {
    return t[n];
  }
  readValueFromInstance(t, n) {
    if ($m.has(n)) {
      const r = ZD(n);
      return r && r.default || 0;
    }
    return n = EI.has(n) ? n : jE(n), t.getAttribute(n);
  }
  scrapeMotionValuesFromProps(t, n, r) {
    return mI(t, n, r);
  }
  build(t, n, r) {
    cI(t, n, this.isSVGTag, r.transformTemplate, r.style);
  }
  renderInstance(t, n, r, i) {
    fJ(t, n, r, i);
  }
  mount(t) {
    this.isSVGTag = dI(t.tagName), super.mount(t);
  }
}
const hJ = (e, t) => TE(e) ? new dJ(t) : new cJ(t, {
  allowProjection: e !== F.Fragment
});
function Sm(e, t, n) {
  const r = e.getProps();
  return NE(r, t, n !== void 0 ? n : r.custom, e);
}
const Q5 = (e) => Array.isArray(e);
function mJ(e, t, n) {
  e.hasValue(t) ? e.getValue(t).set(n) : e.addValue(t, Od(n));
}
function pJ(e) {
  return Q5(e) ? e[e.length - 1] || 0 : e;
}
function gJ(e, t) {
  const n = Sm(e, t);
  let { transitionEnd: r = {}, transition: i = {}, ...s } = n || {};
  s = { ...s, ...r };
  for (const o in s) {
    const u = pJ(s[o]);
    mJ(e, o, u);
  }
}
function yJ(e) {
  return !!(_i(e) && e.add);
}
function Z5(e, t) {
  const n = e.getValue("willChange");
  if (yJ(n))
    return n.add(t);
  if (!n && _u.WillChange) {
    const r = new _u.WillChange("auto");
    e.addValue("willChange", r), r.add(t);
  }
}
function kI(e) {
  return e.props[pI];
}
const vJ = (e) => e !== null;
function xJ(e, { repeat: t, repeatType: n = "loop" }, r) {
  const i = e.filter(vJ), s = t && n !== "loop" && t % 2 === 1 ? 0 : i.length - 1;
  return i[s];
}
const bJ = {
  type: "spring",
  stiffness: 500,
  damping: 25,
  restSpeed: 10
}, wJ = (e) => ({
  type: "spring",
  stiffness: 550,
  damping: e === 0 ? 2 * Math.sqrt(550) : 30,
  restSpeed: 10
}), _J = {
  type: "keyframes",
  duration: 0.8
}, SJ = {
  type: "keyframes",
  ease: [0.25, 0.1, 0.35, 1],
  duration: 0.3
}, CJ = (e, { keyframes: t }) => t.length > 2 ? _J : $m.has(e) ? e.startsWith("scale") ? wJ(t[1]) : bJ : SJ;
function EJ({ when: e, delay: t, delayChildren: n, staggerChildren: r, staggerDirection: i, repeat: s, repeatType: o, repeatDelay: u, from: c, elapsed: d, ...m }) {
  return !!Object.keys(m).length;
}
const ME = (e, t, n, r = {}, i, s) => (o) => {
  const u = vE(r, e) || {}, c = u.delay || r.delay || 0;
  let { elapsed: d = 0 } = r;
  d = d - /* @__PURE__ */ jl(c);
  const m = {
    keyframes: Array.isArray(n) ? n : [null, n],
    ease: "easeOut",
    velocity: t.getVelocity(),
    ...u,
    delay: -d,
    onUpdate: (x) => {
      t.set(x), u.onUpdate && u.onUpdate(x);
    },
    onComplete: () => {
      o(), u.onComplete && u.onComplete();
    },
    name: e,
    motionValue: t,
    element: s ? void 0 : i
  };
  EJ(u) || Object.assign(m, CJ(e, m)), m.duration && (m.duration = /* @__PURE__ */ jl(m.duration)), m.repeatDelay && (m.repeatDelay = /* @__PURE__ */ jl(m.repeatDelay)), m.from !== void 0 && (m.keyframes[0] = m.from);
  let p = !1;
  if ((m.type === !1 || m.duration === 0 && !m.repeatDelay) && (H5(m), m.delay === 0 && (p = !0)), (_u.instantAnimations || _u.skipAnimations) && (p = !0, H5(m), m.delay = 0), m.allowFlatten = !u.type && !u.ease, p && !s && t.get() !== void 0) {
    const x = xJ(m.keyframes, u);
    if (x !== void 0) {
      nr.update(() => {
        m.onUpdate(x), m.onComplete();
      });
      return;
    }
  }
  return u.isSync ? new gE(m) : new WQ(m);
};
function kJ({ protectedKeys: e, needsAnimating: t }, n) {
  const r = e.hasOwnProperty(n) && t[n] !== !0;
  return t[n] = !1, r;
}
function TI(e, t, { delay: n = 0, transitionOverride: r, type: i } = {}) {
  let { transition: s = e.getDefaultTransition(), transitionEnd: o, ...u } = t;
  r && (s = r);
  const c = [], d = i && e.animationState && e.animationState.getState()[i];
  for (const m in u) {
    const p = e.getValue(m, e.latestValues[m] ?? null), x = u[m];
    if (x === void 0 || d && kJ(d, m))
      continue;
    const b = {
      delay: n,
      ...vE(s || {}, m)
    }, S = p.get();
    if (S !== void 0 && !p.isAnimating && !Array.isArray(x) && x === S && !b.velocity)
      continue;
    let k = !1;
    if (window.MotionHandoffAnimation) {
      const T = kI(e);
      if (T) {
        const M = window.MotionHandoffAnimation(T, m, nr);
        M !== null && (b.startTime = M, k = !0);
      }
    }
    Z5(e, m), p.start(ME(m, p, x, e.shouldReduceMotion && WD.has(m) ? { type: !1 } : b, e, k));
    const A = p.animation;
    A && c.push(A);
  }
  return o && Promise.all(c).then(() => {
    nr.update(() => {
      o && gJ(e, o);
    });
  }), c;
}
function NI(e, t, n, r = 0, i = 1) {
  const s = Array.from(e).sort((d, m) => d.sortNodePosition(m)).indexOf(t), o = e.size, u = (o - 1) * r;
  return typeof n == "function" ? n(s, o) : i === 1 ? s * r : u - s * r;
}
function J5(e, t, n = {}) {
  var c;
  const r = Sm(e, t, n.type === "exit" ? (c = e.presenceContext) == null ? void 0 : c.custom : void 0);
  let { transition: i = e.getDefaultTransition() || {} } = r || {};
  n.transitionOverride && (i = n.transitionOverride);
  const s = r ? () => Promise.all(TI(e, r, n)) : () => Promise.resolve(), o = e.variantChildren && e.variantChildren.size ? (d = 0) => {
    const { delayChildren: m = 0, staggerChildren: p, staggerDirection: x } = i;
    return TJ(e, t, d, m, p, x, n);
  } : () => Promise.resolve(), { when: u } = i;
  if (u) {
    const [d, m] = u === "beforeChildren" ? [s, o] : [o, s];
    return d().then(() => m());
  } else
    return Promise.all([s(), o(n.delay)]);
}
function TJ(e, t, n = 0, r = 0, i = 0, s = 1, o) {
  const u = [];
  for (const c of e.variantChildren)
    c.notify("AnimationStart", t), u.push(J5(c, t, {
      ...o,
      delay: n + (typeof r == "function" ? 0 : r) + NI(e.variantChildren, c, r, i, s)
    }).then(() => c.notify("AnimationComplete", t)));
  return Promise.all(u);
}
function NJ(e, t, n = {}) {
  e.notify("AnimationStart", t);
  let r;
  if (Array.isArray(t)) {
    const i = t.map((s) => J5(e, s, n));
    r = Promise.all(i);
  } else if (typeof t == "string")
    r = J5(e, t, n);
  else {
    const i = typeof t == "function" ? Sm(e, t, n.custom) : t;
    r = Promise.all(TI(e, i, n));
  }
  return r.then(() => {
    e.notify("AnimationComplete", t);
  });
}
function AI(e, t) {
  if (!Array.isArray(t))
    return !1;
  const n = t.length;
  if (n !== e.length)
    return !1;
  for (let r = 0; r < n; r++)
    if (t[r] !== e[r])
      return !1;
  return !0;
}
const AJ = CE.length;
function jI(e) {
  if (!e)
    return;
  if (!e.isControllingVariants) {
    const n = e.parent ? jI(e.parent) || {} : {};
    return e.props.initial !== void 0 && (n.initial = e.props.initial), n;
  }
  const t = {};
  for (let n = 0; n < AJ; n++) {
    const r = CE[n], i = e.props[r];
    (p0(i) || i === !1) && (t[r] = i);
  }
  return t;
}
const jJ = [...SE].reverse(), MJ = SE.length;
function RJ(e) {
  return (t) => Promise.all(t.map(({ animation: n, options: r }) => NJ(e, n, r)));
}
function OJ(e) {
  let t = RJ(e), n = q8(), r = !0;
  const i = (c) => (d, m) => {
    var x;
    const p = Sm(e, m, c === "exit" ? (x = e.presenceContext) == null ? void 0 : x.custom : void 0);
    if (p) {
      const { transition: b, transitionEnd: S, ...k } = p;
      d = { ...d, ...k, ...S };
    }
    return d;
  };
  function s(c) {
    t = c(e);
  }
  function o(c) {
    const { props: d } = e, m = jI(e.parent) || {}, p = [], x = /* @__PURE__ */ new Set();
    let b = {}, S = 1 / 0;
    for (let A = 0; A < MJ; A++) {
      const T = jJ[A], M = n[T], j = d[T] !== void 0 ? d[T] : m[T], D = p0(j), z = T === c ? M.isActive : null;
      z === !1 && (S = A);
      let I = j === m[T] && j !== d[T] && D;
      if (I && r && e.manuallyAnimateOnMount && (I = !1), M.protectedKeys = { ...b }, // If it isn't active and hasn't *just* been set as inactive
      !M.isActive && z === null || // If we didn't and don't have any defined prop for this animation type
      !j && !M.prevProp || // Or if the prop doesn't define an animation
      cx(j) || typeof j == "boolean")
        continue;
      const L = DJ(M.prevProp, j);
      let K = L || // If we're making this variant active, we want to always make it active
      T === c && M.isActive && !I && D || // If we removed a higher-priority variant (i is in reverse order)
      A > S && D, ne = !1;
      const Y = Array.isArray(j) ? j : [j];
      let H = Y.reduce(i(T), {});
      z === !1 && (H = {});
      const { prevResolvedValues: Z = {} } = M, me = {
        ...Z,
        ...H
      }, Q = (ue) => {
        K = !0, x.has(ue) && (ne = !0, x.delete(ue)), M.needsAnimating[ue] = !0;
        const de = e.getValue(ue);
        de && (de.liveStyle = !1);
      };
      for (const ue in me) {
        const de = H[ue], ce = Z[ue];
        if (b.hasOwnProperty(ue))
          continue;
        let W = !1;
        Q5(de) && Q5(ce) ? W = !AI(de, ce) : W = de !== ce, W ? de != null ? Q(ue) : x.add(ue) : de !== void 0 && x.has(ue) ? Q(ue) : M.protectedKeys[ue] = !0;
      }
      M.prevProp = j, M.prevResolvedValues = H, M.isActive && (b = { ...b, ...H }), r && e.blockInitialAnimation && (K = !1);
      const se = I && L;
      K && (!se || ne) && p.push(...Y.map((ue) => {
        const de = { type: T };
        if (typeof ue == "string" && r && !se && e.manuallyAnimateOnMount && e.parent) {
          const { parent: ce } = e, W = Sm(ce, ue);
          if (ce.enteringChildren && W) {
            const { delayChildren: $ } = W.transition || {};
            de.delay = NI(ce.enteringChildren, e, $);
          }
        }
        return {
          animation: ue,
          options: de
        };
      }));
    }
    if (x.size) {
      const A = {};
      if (typeof d.initial != "boolean") {
        const T = Sm(e, Array.isArray(d.initial) ? d.initial[0] : d.initial);
        T && T.transition && (A.transition = T.transition);
      }
      x.forEach((T) => {
        const M = e.getBaseTarget(T), j = e.getValue(T);
        j && (j.liveStyle = !0), A[T] = M ?? null;
      }), p.push({ animation: A });
    }
    let k = !!p.length;
    return r && (d.initial === !1 || d.initial === d.animate) && !e.manuallyAnimateOnMount && (k = !1), r = !1, k ? t(p) : Promise.resolve();
  }
  function u(c, d) {
    var p;
    if (n[c].isActive === d)
      return Promise.resolve();
    (p = e.variantChildren) == null || p.forEach((x) => {
      var b;
      return (b = x.animationState) == null ? void 0 : b.setActive(c, d);
    }), n[c].isActive = d;
    const m = o(c);
    for (const x in n)
      n[x].protectedKeys = {};
    return m;
  }
  return {
    animateChanges: o,
    setActive: u,
    setAnimateFunction: s,
    getState: () => n,
    reset: () => {
      n = q8();
    }
  };
}
function DJ(e, t) {
  return typeof t == "string" ? t !== e : Array.isArray(t) ? !AI(t, e) : !1;
}
function ld(e = !1) {
  return {
    isActive: e,
    protectedKeys: {},
    needsAnimating: {},
    prevResolvedValues: {}
  };
}
function q8() {
  return {
    animate: ld(!0),
    whileInView: ld(),
    whileHover: ld(),
    whileTap: ld(),
    whileDrag: ld(),
    whileFocus: ld(),
    exit: ld()
  };
}
class Vc {
  constructor(t) {
    this.isMounted = !1, this.node = t;
  }
  update() {
  }
}
class IJ extends Vc {
  /**
   * We dynamically generate the AnimationState manager as it contains a reference
   * to the underlying animation library. We only want to load that if we load this,
   * so people can optionally code split it out using the `m` component.
   */
  constructor(t) {
    super(t), t.animationState || (t.animationState = OJ(t));
  }
  updateAnimationControlsSubscription() {
    const { animate: t } = this.node.getProps();
    cx(t) && (this.unmountControls = t.subscribe(this.node));
  }
  /**
   * Subscribe any provided AnimationControls to the component's VisualElement
   */
  mount() {
    this.updateAnimationControlsSubscription();
  }
  update() {
    const { animate: t } = this.node.getProps(), { animate: n } = this.node.prevProps || {};
    t !== n && this.updateAnimationControlsSubscription();
  }
  unmount() {
    var t;
    this.node.animationState.reset(), (t = this.unmountControls) == null || t.call(this);
  }
}
let PJ = 0;
class zJ extends Vc {
  constructor() {
    super(...arguments), this.id = PJ++;
  }
  update() {
    if (!this.node.presenceContext)
      return;
    const { isPresent: t, onExitComplete: n } = this.node.presenceContext, { isPresent: r } = this.node.prevPresenceContext || {};
    if (!this.node.animationState || t === r)
      return;
    const i = this.node.animationState.setActive("exit", !t);
    n && !t && i.then(() => {
      n(this.id);
    });
  }
  mount() {
    const { register: t, onExitComplete: n } = this.node.presenceContext || {};
    n && n(this.id), t && (this.unmount = t(this.id));
  }
  unmount() {
  }
}
const LJ = {
  animation: {
    Feature: IJ
  },
  exit: {
    Feature: zJ
  }
};
function g0(e, t, n, r = { passive: !0 }) {
  return e.addEventListener(t, n, r), () => e.removeEventListener(t, n);
}
function L0(e) {
  return {
    point: {
      x: e.pageX,
      y: e.pageY
    }
  };
}
const BJ = (e) => (t) => wE(t) && e(t, L0(t));
function n0(e, t, n, r) {
  return g0(e, t, BJ(n), r);
}
const MI = 1e-4, qJ = 1 - MI, FJ = 1 + MI, RI = 0.01, UJ = 0 - RI, $J = 0 + RI;
function fa(e) {
  return e.max - e.min;
}
function VJ(e, t, n) {
  return Math.abs(e - t) <= n;
}
function F8(e, t, n, r = 0.5) {
  e.origin = r, e.originPoint = or(t.min, t.max, e.origin), e.scale = fa(n) / fa(t), e.translate = or(n.min, n.max, e.origin) - e.originPoint, (e.scale >= qJ && e.scale <= FJ || isNaN(e.scale)) && (e.scale = 1), (e.translate >= UJ && e.translate <= $J || isNaN(e.translate)) && (e.translate = 0);
}
function r0(e, t, n, r) {
  F8(e.x, t.x, n.x, r ? r.originX : void 0), F8(e.y, t.y, n.y, r ? r.originY : void 0);
}
function U8(e, t, n) {
  e.min = n.min + t.min, e.max = e.min + fa(t);
}
function HJ(e, t, n) {
  U8(e.x, t.x, n.x), U8(e.y, t.y, n.y);
}
function $8(e, t, n) {
  e.min = t.min - n.min, e.max = e.min + fa(t);
}
function Dv(e, t, n) {
  $8(e.x, t.x, n.x), $8(e.y, t.y, n.y);
}
function Os(e) {
  return [e("x"), e("y")];
}
const OI = ({ current: e }) => e ? e.ownerDocument.defaultView : null, V8 = (e, t) => Math.abs(e - t);
function GJ(e, t) {
  const n = V8(e.x, t.x), r = V8(e.y, t.y);
  return Math.sqrt(n ** 2 + r ** 2);
}
class DI {
  constructor(t, n, { transformPagePoint: r, contextWindow: i = window, dragSnapToOrigin: s = !1, distanceThreshold: o = 3 } = {}) {
    if (this.startEvent = null, this.lastMoveEvent = null, this.lastMoveEventInfo = null, this.handlers = {}, this.contextWindow = window, this.updatePoint = () => {
      if (!(this.lastMoveEvent && this.lastMoveEventInfo))
        return;
      const x = S2(this.lastMoveEventInfo, this.history), b = this.startEvent !== null, S = GJ(x.offset, { x: 0, y: 0 }) >= this.distanceThreshold;
      if (!b && !S)
        return;
      const { point: k } = x, { timestamp: A } = vi;
      this.history.push({ ...k, timestamp: A });
      const { onStart: T, onMove: M } = this.handlers;
      b || (T && T(this.lastMoveEvent, x), this.startEvent = this.lastMoveEvent), M && M(this.lastMoveEvent, x);
    }, this.handlePointerMove = (x, b) => {
      this.lastMoveEvent = x, this.lastMoveEventInfo = _2(b, this.transformPagePoint), nr.update(this.updatePoint, !0);
    }, this.handlePointerUp = (x, b) => {
      this.end();
      const { onEnd: S, onSessionEnd: k, resumeAnimation: A } = this.handlers;
      if (this.dragSnapToOrigin && A && A(), !(this.lastMoveEvent && this.lastMoveEventInfo))
        return;
      const T = S2(x.type === "pointercancel" ? this.lastMoveEventInfo : _2(b, this.transformPagePoint), this.history);
      this.startEvent && S && S(x, T), k && k(x, T);
    }, !wE(t))
      return;
    this.dragSnapToOrigin = s, this.handlers = n, this.transformPagePoint = r, this.distanceThreshold = o, this.contextWindow = i || window;
    const u = L0(t), c = _2(u, this.transformPagePoint), { point: d } = c, { timestamp: m } = vi;
    this.history = [{ ...d, timestamp: m }];
    const { onSessionStart: p } = n;
    p && p(t, S2(c, this.history)), this.removeListeners = I0(n0(this.contextWindow, "pointermove", this.handlePointerMove), n0(this.contextWindow, "pointerup", this.handlePointerUp), n0(this.contextWindow, "pointercancel", this.handlePointerUp));
  }
  updateHandlers(t) {
    this.handlers = t;
  }
  end() {
    this.removeListeners && this.removeListeners(), Su(this.updatePoint);
  }
}
function _2(e, t) {
  return t ? { point: t(e.point) } : e;
}
function H8(e, t) {
  return { x: e.x - t.x, y: e.y - t.y };
}
function S2({ point: e }, t) {
  return {
    point: e,
    delta: H8(e, II(t)),
    offset: H8(e, KJ(t)),
    velocity: YJ(t, 0.1)
  };
}
function KJ(e) {
  return e[0];
}
function II(e) {
  return e[e.length - 1];
}
function YJ(e, t) {
  if (e.length < 2)
    return { x: 0, y: 0 };
  let n = e.length - 1, r = null;
  const i = II(e);
  for (; n >= 0 && (r = e[n], !(i.timestamp - r.timestamp > /* @__PURE__ */ jl(t))); )
    n--;
  if (!r)
    return { x: 0, y: 0 };
  const s = /* @__PURE__ */ zs(i.timestamp - r.timestamp);
  if (s === 0)
    return { x: 0, y: 0 };
  const o = {
    x: (i.x - r.x) / s,
    y: (i.y - r.y) / s
  };
  return o.x === 1 / 0 && (o.x = 0), o.y === 1 / 0 && (o.y = 0), o;
}
function WJ(e, { min: t, max: n }, r) {
  return t !== void 0 && e < t ? e = r ? or(t, e, r.min) : Math.max(e, t) : n !== void 0 && e > n && (e = r ? or(n, e, r.max) : Math.min(e, n)), e;
}
function G8(e, t, n) {
  return {
    min: t !== void 0 ? e.min + t : void 0,
    max: n !== void 0 ? e.max + n - (e.max - e.min) : void 0
  };
}
function XJ(e, { top: t, left: n, bottom: r, right: i }) {
  return {
    x: G8(e.x, n, i),
    y: G8(e.y, t, r)
  };
}
function K8(e, t) {
  let n = t.min - e.min, r = t.max - e.max;
  return t.max - t.min < e.max - e.min && ([n, r] = [r, n]), { min: n, max: r };
}
function QJ(e, t) {
  return {
    x: K8(e.x, t.x),
    y: K8(e.y, t.y)
  };
}
function ZJ(e, t) {
  let n = 0.5;
  const r = fa(e), i = fa(t);
  return i > r ? n = /* @__PURE__ */ d0(t.min, t.max - r, e.min) : r > i && (n = /* @__PURE__ */ d0(e.min, e.max - i, t.min)), wu(0, 1, n);
}
function JJ(e, t) {
  const n = {};
  return t.min !== void 0 && (n.min = t.min - e.min), t.max !== void 0 && (n.max = t.max - e.min), n;
}
const eC = 0.35;
function eee(e = eC) {
  return e === !1 ? e = 0 : e === !0 && (e = eC), {
    x: Y8(e, "left", "right"),
    y: Y8(e, "top", "bottom")
  };
}
function Y8(e, t, n) {
  return {
    min: W8(e, t),
    max: W8(e, n)
  };
}
function W8(e, t) {
  return typeof e == "number" ? e : e[t] || 0;
}
const tee = /* @__PURE__ */ new WeakMap();
class nee {
  constructor(t) {
    this.openDragLock = null, this.isDragging = !1, this.currentDirection = null, this.originPoint = { x: 0, y: 0 }, this.constraints = !1, this.hasMutatedConstraints = !1, this.elastic = Xr(), this.latestPointerEvent = null, this.latestPanInfo = null, this.visualElement = t;
  }
  start(t, { snapToCursor: n = !1, distanceThreshold: r } = {}) {
    const { presenceContext: i } = this.visualElement;
    if (i && i.isPresent === !1)
      return;
    const s = (p) => {
      const { dragSnapToOrigin: x } = this.getProps();
      x ? this.pauseAnimation() : this.stopAnimation(), n && this.snapToCursor(L0(p).point);
    }, o = (p, x) => {
      const { drag: b, dragPropagation: S, onDragStart: k } = this.getProps();
      if (b && !S && (this.openDragLock && this.openDragLock(), this.openDragLock = dZ(b), !this.openDragLock))
        return;
      this.latestPointerEvent = p, this.latestPanInfo = x, this.isDragging = !0, this.currentDirection = null, this.resolveConstraints(), this.visualElement.projection && (this.visualElement.projection.isAnimationBlocked = !0, this.visualElement.projection.target = void 0), Os((T) => {
        let M = this.getAxisMotionValue(T).get() || 0;
        if (Ml.test(M)) {
          const { projection: j } = this.visualElement;
          if (j && j.layout) {
            const D = j.layout.layoutBox[T];
            D && (M = fa(D) * (parseFloat(M) / 100));
          }
        }
        this.originPoint[T] = M;
      }), k && nr.postRender(() => k(p, x)), Z5(this.visualElement, "transform");
      const { animationState: A } = this.visualElement;
      A && A.setActive("whileDrag", !0);
    }, u = (p, x) => {
      this.latestPointerEvent = p, this.latestPanInfo = x;
      const { dragPropagation: b, dragDirectionLock: S, onDirectionLock: k, onDrag: A } = this.getProps();
      if (!b && !this.openDragLock)
        return;
      const { offset: T } = x;
      if (S && this.currentDirection === null) {
        this.currentDirection = ree(T), this.currentDirection !== null && k && k(this.currentDirection);
        return;
      }
      this.updateAxis("x", x.point, T), this.updateAxis("y", x.point, T), this.visualElement.render(), A && A(p, x);
    }, c = (p, x) => {
      this.latestPointerEvent = p, this.latestPanInfo = x, this.stop(p, x), this.latestPointerEvent = null, this.latestPanInfo = null;
    }, d = () => Os((p) => {
      var x;
      return this.getAnimationState(p) === "paused" && ((x = this.getAxisMotionValue(p).animation) == null ? void 0 : x.play());
    }), { dragSnapToOrigin: m } = this.getProps();
    this.panSession = new DI(t, {
      onSessionStart: s,
      onStart: o,
      onMove: u,
      onSessionEnd: c,
      resumeAnimation: d
    }, {
      transformPagePoint: this.visualElement.getTransformPagePoint(),
      dragSnapToOrigin: m,
      distanceThreshold: r,
      contextWindow: OI(this.visualElement)
    });
  }
  /**
   * @internal
   */
  stop(t, n) {
    const r = t || this.latestPointerEvent, i = n || this.latestPanInfo, s = this.isDragging;
    if (this.cancel(), !s || !i || !r)
      return;
    const { velocity: o } = i;
    this.startAnimation(o);
    const { onDragEnd: u } = this.getProps();
    u && nr.postRender(() => u(r, i));
  }
  /**
   * @internal
   */
  cancel() {
    this.isDragging = !1;
    const { projection: t, animationState: n } = this.visualElement;
    t && (t.isAnimationBlocked = !1), this.panSession && this.panSession.end(), this.panSession = void 0;
    const { dragPropagation: r } = this.getProps();
    !r && this.openDragLock && (this.openDragLock(), this.openDragLock = null), n && n.setActive("whileDrag", !1);
  }
  updateAxis(t, n, r) {
    const { drag: i } = this.getProps();
    if (!r || !V1(t, i, this.currentDirection))
      return;
    const s = this.getAxisMotionValue(t);
    let o = this.originPoint[t] + r[t];
    this.constraints && this.constraints[t] && (o = WJ(o, this.constraints[t], this.elastic[t])), s.set(o);
  }
  resolveConstraints() {
    var s;
    const { dragConstraints: t, dragElastic: n } = this.getProps(), r = this.visualElement.projection && !this.visualElement.projection.layout ? this.visualElement.projection.measure(!1) : (s = this.visualElement.projection) == null ? void 0 : s.layout, i = this.constraints;
    t && gm(t) ? this.constraints || (this.constraints = this.resolveRefConstraints()) : t && r ? this.constraints = XJ(r.layoutBox, t) : this.constraints = !1, this.elastic = eee(n), i !== this.constraints && r && this.constraints && !this.hasMutatedConstraints && Os((o) => {
      this.constraints !== !1 && this.getAxisMotionValue(o) && (this.constraints[o] = JJ(r.layoutBox[o], this.constraints[o]));
    });
  }
  resolveRefConstraints() {
    const { dragConstraints: t, onMeasureDragConstraints: n } = this.getProps();
    if (!t || !gm(t))
      return !1;
    const r = t.current, { projection: i } = this.visualElement;
    if (!i || !i.layout)
      return !1;
    const s = iJ(r, i.root, this.visualElement.getTransformPagePoint());
    let o = QJ(i.layout.layoutBox, s);
    if (n) {
      const u = n(tJ(o));
      this.hasMutatedConstraints = !!u, u && (o = vI(u));
    }
    return o;
  }
  startAnimation(t) {
    const { drag: n, dragMomentum: r, dragElastic: i, dragTransition: s, dragSnapToOrigin: o, onDragTransitionEnd: u } = this.getProps(), c = this.constraints || {}, d = Os((m) => {
      if (!V1(m, n, this.currentDirection))
        return;
      let p = c && c[m] || {};
      o && (p = { min: 0, max: 0 });
      const x = i ? 200 : 1e6, b = i ? 40 : 1e7, S = {
        type: "inertia",
        velocity: r ? t[m] : 0,
        bounceStiffness: x,
        bounceDamping: b,
        timeConstant: 750,
        restDelta: 1,
        restSpeed: 10,
        ...s,
        ...p
      };
      return this.startAxisValueAnimation(m, S);
    });
    return Promise.all(d).then(u);
  }
  startAxisValueAnimation(t, n) {
    const r = this.getAxisMotionValue(t);
    return Z5(this.visualElement, t), r.start(ME(t, r, 0, n, this.visualElement, !1));
  }
  stopAnimation() {
    Os((t) => this.getAxisMotionValue(t).stop());
  }
  pauseAnimation() {
    Os((t) => {
      var n;
      return (n = this.getAxisMotionValue(t).animation) == null ? void 0 : n.pause();
    });
  }
  getAnimationState(t) {
    var n;
    return (n = this.getAxisMotionValue(t).animation) == null ? void 0 : n.state;
  }
  /**
   * Drag works differently depending on which props are provided.
   *
   * - If _dragX and _dragY are provided, we output the gesture delta directly to those motion values.
   * - Otherwise, we apply the delta to the x/y motion values.
   */
  getAxisMotionValue(t) {
    const n = `_drag${t.toUpperCase()}`, r = this.visualElement.getProps(), i = r[n];
    return i || this.visualElement.getValue(t, (r.initial ? r.initial[t] : void 0) || 0);
  }
  snapToCursor(t) {
    Os((n) => {
      const { drag: r } = this.getProps();
      if (!V1(n, r, this.currentDirection))
        return;
      const { projection: i } = this.visualElement, s = this.getAxisMotionValue(n);
      if (i && i.layout) {
        const { min: o, max: u } = i.layout.layoutBox[n];
        s.set(t[n] - or(o, u, 0.5));
      }
    });
  }
  /**
   * When the viewport resizes we want to check if the measured constraints
   * have changed and, if so, reposition the element within those new constraints
   * relative to where it was before the resize.
   */
  scalePositionWithinConstraints() {
    if (!this.visualElement.current)
      return;
    const { drag: t, dragConstraints: n } = this.getProps(), { projection: r } = this.visualElement;
    if (!gm(n) || !r || !this.constraints)
      return;
    this.stopAnimation();
    const i = { x: 0, y: 0 };
    Os((o) => {
      const u = this.getAxisMotionValue(o);
      if (u && this.constraints !== !1) {
        const c = u.get();
        i[o] = ZJ({ min: c, max: c }, this.constraints[o]);
      }
    });
    const { transformTemplate: s } = this.visualElement.getProps();
    this.visualElement.current.style.transform = s ? s({}, "") : "none", r.root && r.root.updateScroll(), r.updateLayout(), this.resolveConstraints(), Os((o) => {
      if (!V1(o, t, null))
        return;
      const u = this.getAxisMotionValue(o), { min: c, max: d } = this.constraints[o];
      u.set(or(c, d, i[o]));
    });
  }
  addListeners() {
    if (!this.visualElement.current)
      return;
    tee.set(this.visualElement, this);
    const t = this.visualElement.current, n = n0(t, "pointerdown", (c) => {
      const { drag: d, dragListener: m = !0 } = this.getProps();
      d && m && this.start(c);
    }), r = () => {
      const { dragConstraints: c } = this.getProps();
      gm(c) && c.current && (this.constraints = this.resolveRefConstraints());
    }, { projection: i } = this.visualElement, s = i.addEventListener("measure", r);
    i && !i.layout && (i.root && i.root.updateScroll(), i.updateLayout()), nr.read(r);
    const o = g0(window, "resize", () => this.scalePositionWithinConstraints()), u = i.addEventListener("didUpdate", (({ delta: c, hasLayoutChanged: d }) => {
      this.isDragging && d && (Os((m) => {
        const p = this.getAxisMotionValue(m);
        p && (this.originPoint[m] += c[m].translate, p.set(p.get() + c[m].translate));
      }), this.visualElement.render());
    }));
    return () => {
      o(), n(), s(), u && u();
    };
  }
  getProps() {
    const t = this.visualElement.getProps(), { drag: n = !1, dragDirectionLock: r = !1, dragPropagation: i = !1, dragConstraints: s = !1, dragElastic: o = eC, dragMomentum: u = !0 } = t;
    return {
      ...t,
      drag: n,
      dragDirectionLock: r,
      dragPropagation: i,
      dragConstraints: s,
      dragElastic: o,
      dragMomentum: u
    };
  }
}
function V1(e, t, n) {
  return (t === !0 || t === e) && (n === null || n === e);
}
function ree(e, t = 10) {
  let n = null;
  return Math.abs(e.y) > t ? n = "y" : Math.abs(e.x) > t && (n = "x"), n;
}
class iee extends Vc {
  constructor(t) {
    super(t), this.removeGroupControls = Bs, this.removeListeners = Bs, this.controls = new nee(t);
  }
  mount() {
    const { dragControls: t } = this.node.getProps();
    t && (this.removeGroupControls = t.subscribe(this.controls)), this.removeListeners = this.controls.addListeners() || Bs;
  }
  unmount() {
    this.removeGroupControls(), this.removeListeners();
  }
}
const X8 = (e) => (t, n) => {
  e && nr.postRender(() => e(t, n));
};
class aee extends Vc {
  constructor() {
    super(...arguments), this.removePointerDownListener = Bs;
  }
  onPointerDown(t) {
    this.session = new DI(t, this.createPanHandlers(), {
      transformPagePoint: this.node.getTransformPagePoint(),
      contextWindow: OI(this.node)
    });
  }
  createPanHandlers() {
    const { onPanSessionStart: t, onPanStart: n, onPan: r, onPanEnd: i } = this.node.getProps();
    return {
      onSessionStart: X8(t),
      onStart: X8(n),
      onMove: r,
      onEnd: (s, o) => {
        delete this.session, i && nr.postRender(() => i(s, o));
      }
    };
  }
  mount() {
    this.removePointerDownListener = n0(this.node.current, "pointerdown", (t) => this.onPointerDown(t));
  }
  update() {
    this.session && this.session.updateHandlers(this.createPanHandlers());
  }
  unmount() {
    this.removePointerDownListener(), this.session && this.session.end();
  }
}
const cv = {
  /**
   * Global flag as to whether the tree has animated since the last time
   * we resized the window
   */
  hasAnimatedSinceResize: !0,
  /**
   * We set this to true once, on the first update. Any nodes added to the tree beyond that
   * update will be given a `data-projection-id` attribute.
   */
  hasEverUpdated: !1
};
let C2 = !1;
class see extends F.Component {
  /**
   * This only mounts projection nodes for components that
   * need measuring, we might want to do it for all components
   * in order to incorporate transforms
   */
  componentDidMount() {
    const { visualElement: t, layoutGroup: n, switchLayoutGroup: r, layoutId: i } = this.props, { projection: s } = t;
    s && (n.group && n.group.add(s), r && r.register && i && r.register(s), C2 && s.root.didUpdate(), s.addEventListener("animationComplete", () => {
      this.safeToRemove();
    }), s.setOptions({
      ...s.options,
      onExitComplete: () => this.safeToRemove()
    })), cv.hasEverUpdated = !0;
  }
  getSnapshotBeforeUpdate(t) {
    const { layoutDependency: n, visualElement: r, drag: i, isPresent: s } = this.props, { projection: o } = r;
    return o && (o.isPresent = s, C2 = !0, i || t.layoutDependency !== n || n === void 0 || t.isPresent !== s ? o.willUpdate() : this.safeToRemove(), t.isPresent !== s && (s ? o.promote() : o.relegate() || nr.postRender(() => {
      const u = o.getStack();
      (!u || !u.members.length) && this.safeToRemove();
    }))), null;
  }
  componentDidUpdate() {
    const { projection: t } = this.props.visualElement;
    t && (t.root.didUpdate(), bE.postRender(() => {
      !t.currentAnimation && t.isLead() && this.safeToRemove();
    }));
  }
  componentWillUnmount() {
    const { visualElement: t, layoutGroup: n, switchLayoutGroup: r } = this.props, { projection: i } = t;
    C2 = !0, i && (i.scheduleCheckAfterUnmount(), n && n.group && n.group.remove(i), r && r.deregister && r.deregister(i));
  }
  safeToRemove() {
    const { safeToRemove: t } = this.props;
    t && t();
  }
  render() {
    return null;
  }
}
function PI(e) {
  const [t, n] = _Z(), r = F.useContext(dD);
  return g.jsx(see, { ...e, layoutGroup: r, switchLayoutGroup: F.useContext(gI), isPresent: t, safeToRemove: n });
}
function oee(e, t, n) {
  const r = _i(e) ? e : Od(e);
  return r.start(ME("", r, t, n)), r.animation;
}
const lee = (e, t) => e.depth - t.depth;
class uee {
  constructor() {
    this.children = [], this.isDirty = !1;
  }
  add(t) {
    nE(this.children, t), this.isDirty = !0;
  }
  remove(t) {
    rE(this.children, t), this.isDirty = !0;
  }
  forEach(t) {
    this.isDirty && this.children.sort(lee), this.isDirty = !1, this.children.forEach(t);
  }
}
function cee(e, t) {
  const n = qa.now(), r = ({ timestamp: i }) => {
    const s = i - n;
    s >= t && (Su(r), e(s - t));
  };
  return nr.setup(r, !0), () => Su(r);
}
const zI = ["TopLeft", "TopRight", "BottomLeft", "BottomRight"], fee = zI.length, Q8 = (e) => typeof e == "string" ? parseFloat(e) : e, Z8 = (e) => typeof e == "number" || Ot.test(e);
function dee(e, t, n, r, i, s) {
  i ? (e.opacity = or(0, n.opacity ?? 1, hee(r)), e.opacityExit = or(t.opacity ?? 1, 0, mee(r))) : s && (e.opacity = or(t.opacity ?? 1, n.opacity ?? 1, r));
  for (let o = 0; o < fee; o++) {
    const u = `border${zI[o]}Radius`;
    let c = J8(t, u), d = J8(n, u);
    if (c === void 0 && d === void 0)
      continue;
    c || (c = 0), d || (d = 0), c === 0 || d === 0 || Z8(c) === Z8(d) ? (e[u] = Math.max(or(Q8(c), Q8(d), r), 0), (Ml.test(d) || Ml.test(c)) && (e[u] += "%")) : e[u] = d;
  }
  (t.rotate || n.rotate) && (e.rotate = or(t.rotate || 0, n.rotate || 0, r));
}
function J8(e, t) {
  return e[t] !== void 0 ? e[t] : e.borderRadius;
}
const hee = /* @__PURE__ */ LI(0, 0.5, CD), mee = /* @__PURE__ */ LI(0.5, 0.95, Bs);
function LI(e, t, n) {
  return (r) => r < e ? 0 : r > t ? 1 : n(/* @__PURE__ */ d0(e, t, r));
}
function eT(e, t) {
  e.min = t.min, e.max = t.max;
}
function bo(e, t) {
  eT(e.x, t.x), eT(e.y, t.y);
}
function tT(e, t) {
  e.translate = t.translate, e.scale = t.scale, e.originPoint = t.originPoint, e.origin = t.origin;
}
function nT(e, t, n, r, i) {
  return e -= t, e = Ov(e, 1 / n, r), i !== void 0 && (e = Ov(e, 1 / i, r)), e;
}
function pee(e, t = 0, n = 1, r = 0.5, i, s = e, o = e) {
  if (Ml.test(t) && (t = parseFloat(t), t = or(o.min, o.max, t / 100) - o.min), typeof t != "number")
    return;
  let u = or(s.min, s.max, r);
  e === s && (u -= t), e.min = nT(e.min, t, n, u, i), e.max = nT(e.max, t, n, u, i);
}
function rT(e, t, [n, r, i], s, o) {
  pee(e, t[n], t[r], t[i], t.scale, s, o);
}
const gee = ["x", "scaleX", "originX"], yee = ["y", "scaleY", "originY"];
function iT(e, t, n, r) {
  rT(e.x, t, gee, n ? n.x : void 0, r ? r.x : void 0), rT(e.y, t, yee, n ? n.y : void 0, r ? r.y : void 0);
}
function aT(e) {
  return e.translate === 0 && e.scale === 1;
}
function BI(e) {
  return aT(e.x) && aT(e.y);
}
function sT(e, t) {
  return e.min === t.min && e.max === t.max;
}
function vee(e, t) {
  return sT(e.x, t.x) && sT(e.y, t.y);
}
function oT(e, t) {
  return Math.round(e.min) === Math.round(t.min) && Math.round(e.max) === Math.round(t.max);
}
function qI(e, t) {
  return oT(e.x, t.x) && oT(e.y, t.y);
}
function lT(e) {
  return fa(e.x) / fa(e.y);
}
function uT(e, t) {
  return e.translate === t.translate && e.scale === t.scale && e.originPoint === t.originPoint;
}
class xee {
  constructor() {
    this.members = [];
  }
  add(t) {
    nE(this.members, t), t.scheduleRender();
  }
  remove(t) {
    if (rE(this.members, t), t === this.prevLead && (this.prevLead = void 0), t === this.lead) {
      const n = this.members[this.members.length - 1];
      n && this.promote(n);
    }
  }
  relegate(t) {
    const n = this.members.findIndex((i) => t === i);
    if (n === 0)
      return !1;
    let r;
    for (let i = n; i >= 0; i--) {
      const s = this.members[i];
      if (s.isPresent !== !1) {
        r = s;
        break;
      }
    }
    return r ? (this.promote(r), !0) : !1;
  }
  promote(t, n) {
    const r = this.lead;
    if (t !== r && (this.prevLead = r, this.lead = t, t.show(), r)) {
      r.instance && r.scheduleRender(), t.scheduleRender(), t.resumeFrom = r, n && (t.resumeFrom.preserveOpacity = !0), r.snapshot && (t.snapshot = r.snapshot, t.snapshot.latestValues = r.animationValues || r.latestValues), t.root && t.root.isUpdating && (t.isLayoutDirty = !0);
      const { crossfade: i } = t.options;
      i === !1 && r.hide();
    }
  }
  exitAnimationComplete() {
    this.members.forEach((t) => {
      const { options: n, resumingFrom: r } = t;
      n.onExitComplete && n.onExitComplete(), r && r.options.onExitComplete && r.options.onExitComplete();
    });
  }
  scheduleRender() {
    this.members.forEach((t) => {
      t.instance && t.scheduleRender(!1);
    });
  }
  /**
   * Clear any leads that have been removed this render to prevent them from being
   * used in future animations and to prevent memory leaks
   */
  removeLeadSnapshot() {
    this.lead && this.lead.snapshot && (this.lead.snapshot = void 0);
  }
}
function bee(e, t, n) {
  let r = "";
  const i = e.x.translate / t.x, s = e.y.translate / t.y, o = (n == null ? void 0 : n.z) || 0;
  if ((i || s || o) && (r = `translate3d(${i}px, ${s}px, ${o}px) `), (t.x !== 1 || t.y !== 1) && (r += `scale(${1 / t.x}, ${1 / t.y}) `), n) {
    const { transformPerspective: d, rotate: m, rotateX: p, rotateY: x, skewX: b, skewY: S } = n;
    d && (r = `perspective(${d}px) ${r}`), m && (r += `rotate(${m}deg) `), p && (r += `rotateX(${p}deg) `), x && (r += `rotateY(${x}deg) `), b && (r += `skewX(${b}deg) `), S && (r += `skewY(${S}deg) `);
  }
  const u = e.x.scale * t.x, c = e.y.scale * t.y;
  return (u !== 1 || c !== 1) && (r += `scale(${u}, ${c})`), r || "none";
}
const E2 = ["", "X", "Y", "Z"], wee = 1e3;
let _ee = 0;
function k2(e, t, n, r) {
  const { latestValues: i } = t;
  i[e] && (n[e] = i[e], t.setStaticValue(e, 0), r && (r[e] = 0));
}
function FI(e) {
  if (e.hasCheckedOptimisedAppear = !0, e.root === e)
    return;
  const { visualElement: t } = e.options;
  if (!t)
    return;
  const n = kI(t);
  if (window.MotionHasOptimisedAnimation(n, "transform")) {
    const { layout: i, layoutId: s } = e.options;
    window.MotionCancelOptimisedAnimation(n, "transform", nr, !(i || s));
  }
  const { parent: r } = e;
  r && !r.hasCheckedOptimisedAppear && FI(r);
}
function UI({ attachResizeListener: e, defaultParent: t, measureScroll: n, checkIsScrollRoot: r, resetTransform: i }) {
  return class {
    constructor(o = {}, u = t == null ? void 0 : t()) {
      this.id = _ee++, this.animationId = 0, this.animationCommitId = 0, this.children = /* @__PURE__ */ new Set(), this.options = {}, this.isTreeAnimating = !1, this.isAnimationBlocked = !1, this.isLayoutDirty = !1, this.isProjectionDirty = !1, this.isSharedProjectionDirty = !1, this.isTransformDirty = !1, this.updateManuallyBlocked = !1, this.updateBlockedByResize = !1, this.isUpdating = !1, this.isSVG = !1, this.needsReset = !1, this.shouldResetTransform = !1, this.hasCheckedOptimisedAppear = !1, this.treeScale = { x: 1, y: 1 }, this.eventHandlers = /* @__PURE__ */ new Map(), this.hasTreeAnimated = !1, this.layoutVersion = 0, this.updateScheduled = !1, this.scheduleUpdate = () => this.update(), this.projectionUpdateScheduled = !1, this.checkUpdateFailed = () => {
        this.isUpdating && (this.isUpdating = !1, this.clearAllSnapshots());
      }, this.updateProjection = () => {
        this.projectionUpdateScheduled = !1, this.nodes.forEach(Eee), this.nodes.forEach(Aee), this.nodes.forEach(jee), this.nodes.forEach(kee);
      }, this.resolvedRelativeTargetAt = 0, this.linkedParentVersion = 0, this.hasProjected = !1, this.isVisible = !0, this.animationProgress = 0, this.sharedNodes = /* @__PURE__ */ new Map(), this.latestValues = o, this.root = u ? u.root || u : this, this.path = u ? [...u.path, u] : [], this.parent = u, this.depth = u ? u.depth + 1 : 0;
      for (let c = 0; c < this.path.length; c++)
        this.path[c].shouldResetTransform = !0;
      this.root === this && (this.nodes = new uee());
    }
    addEventListener(o, u) {
      return this.eventHandlers.has(o) || this.eventHandlers.set(o, new sE()), this.eventHandlers.get(o).add(u);
    }
    notifyListeners(o, ...u) {
      const c = this.eventHandlers.get(o);
      c && c.notify(...u);
    }
    hasListeners(o) {
      return this.eventHandlers.has(o);
    }
    /**
     * Lifecycles
     */
    mount(o) {
      if (this.instance)
        return;
      this.isSVG = iI(o) && !vZ(o), this.instance = o;
      const { layoutId: u, layout: c, visualElement: d } = this.options;
      if (d && !d.current && d.mount(o), this.root.nodes.add(this), this.parent && this.parent.children.add(this), this.root.hasTreeAnimated && (c || u) && (this.isLayoutDirty = !0), e) {
        let m, p = 0;
        const x = () => this.root.updateBlockedByResize = !1;
        nr.read(() => {
          p = window.innerWidth;
        }), e(o, () => {
          const b = window.innerWidth;
          b !== p && (p = b, this.root.updateBlockedByResize = !0, m && m(), m = cee(x, 250), cv.hasAnimatedSinceResize && (cv.hasAnimatedSinceResize = !1, this.nodes.forEach(dT)));
        });
      }
      u && this.root.registerSharedNode(u, this), this.options.animate !== !1 && d && (u || c) && this.addEventListener("didUpdate", ({ delta: m, hasLayoutChanged: p, hasRelativeLayoutChanged: x, layout: b }) => {
        if (this.isTreeAnimationBlocked()) {
          this.target = void 0, this.relativeTarget = void 0;
          return;
        }
        const S = this.options.transition || d.getDefaultTransition() || Iee, { onLayoutAnimationStart: k, onLayoutAnimationComplete: A } = d.getProps(), T = !this.targetLayout || !qI(this.targetLayout, b), M = !p && x;
        if (this.options.layoutRoot || this.resumeFrom || M || p && (T || !this.currentAnimation)) {
          this.resumeFrom && (this.resumingFrom = this.resumeFrom, this.resumingFrom.resumingFrom = void 0);
          const j = {
            ...vE(S, "layout"),
            onPlay: k,
            onComplete: A
          };
          (d.shouldReduceMotion || this.options.layoutRoot) && (j.delay = 0, j.type = !1), this.startAnimation(j), this.setAnimationOrigin(m, M);
        } else
          p || dT(this), this.isLead() && this.options.onExitComplete && this.options.onExitComplete();
        this.targetLayout = b;
      });
    }
    unmount() {
      this.options.layoutId && this.willUpdate(), this.root.nodes.remove(this);
      const o = this.getStack();
      o && o.remove(this), this.parent && this.parent.children.delete(this), this.instance = void 0, this.eventHandlers.clear(), Su(this.updateProjection);
    }
    // only on the root
    blockUpdate() {
      this.updateManuallyBlocked = !0;
    }
    unblockUpdate() {
      this.updateManuallyBlocked = !1;
    }
    isUpdateBlocked() {
      return this.updateManuallyBlocked || this.updateBlockedByResize;
    }
    isTreeAnimationBlocked() {
      return this.isAnimationBlocked || this.parent && this.parent.isTreeAnimationBlocked() || !1;
    }
    // Note: currently only running on root node
    startUpdate() {
      this.isUpdateBlocked() || (this.isUpdating = !0, this.nodes && this.nodes.forEach(Mee), this.animationId++);
    }
    getTransformTemplate() {
      const { visualElement: o } = this.options;
      return o && o.getProps().transformTemplate;
    }
    willUpdate(o = !0) {
      if (this.root.hasTreeAnimated = !0, this.root.isUpdateBlocked()) {
        this.options.onExitComplete && this.options.onExitComplete();
        return;
      }
      if (window.MotionCancelOptimisedAnimation && !this.hasCheckedOptimisedAppear && FI(this), !this.root.isUpdating && this.root.startUpdate(), this.isLayoutDirty)
        return;
      this.isLayoutDirty = !0;
      for (let m = 0; m < this.path.length; m++) {
        const p = this.path[m];
        p.shouldResetTransform = !0, p.updateScroll("snapshot"), p.options.layoutRoot && p.willUpdate(!1);
      }
      const { layoutId: u, layout: c } = this.options;
      if (u === void 0 && !c)
        return;
      const d = this.getTransformTemplate();
      this.prevTransformTemplateValue = d ? d(this.latestValues, "") : void 0, this.updateSnapshot(), o && this.notifyListeners("willUpdate");
    }
    update() {
      if (this.updateScheduled = !1, this.isUpdateBlocked()) {
        this.unblockUpdate(), this.clearAllSnapshots(), this.nodes.forEach(cT);
        return;
      }
      if (this.animationId <= this.animationCommitId) {
        this.nodes.forEach(fT);
        return;
      }
      this.animationCommitId = this.animationId, this.isUpdating ? (this.isUpdating = !1, this.nodes.forEach(Nee), this.nodes.forEach(See), this.nodes.forEach(Cee)) : this.nodes.forEach(fT), this.clearAllSnapshots();
      const u = qa.now();
      vi.delta = wu(0, 1e3 / 60, u - vi.timestamp), vi.timestamp = u, vi.isProcessing = !0, m2.update.process(vi), m2.preRender.process(vi), m2.render.process(vi), vi.isProcessing = !1;
    }
    didUpdate() {
      this.updateScheduled || (this.updateScheduled = !0, bE.read(this.scheduleUpdate));
    }
    clearAllSnapshots() {
      this.nodes.forEach(Tee), this.sharedNodes.forEach(Ree);
    }
    scheduleUpdateProjection() {
      this.projectionUpdateScheduled || (this.projectionUpdateScheduled = !0, nr.preRender(this.updateProjection, !1, !0));
    }
    scheduleCheckAfterUnmount() {
      nr.postRender(() => {
        this.isLayoutDirty ? this.root.didUpdate() : this.root.checkUpdateFailed();
      });
    }
    /**
     * Update measurements
     */
    updateSnapshot() {
      this.snapshot || !this.instance || (this.snapshot = this.measure(), this.snapshot && !fa(this.snapshot.measuredBox.x) && !fa(this.snapshot.measuredBox.y) && (this.snapshot = void 0));
    }
    updateLayout() {
      if (!this.instance || (this.updateScroll(), !(this.options.alwaysMeasureLayout && this.isLead()) && !this.isLayoutDirty))
        return;
      if (this.resumeFrom && !this.resumeFrom.instance)
        for (let c = 0; c < this.path.length; c++)
          this.path[c].updateScroll();
      const o = this.layout;
      this.layout = this.measure(!1), this.layoutVersion++, this.layoutCorrected = Xr(), this.isLayoutDirty = !1, this.projectionDelta = void 0, this.notifyListeners("measure", this.layout.layoutBox);
      const { visualElement: u } = this.options;
      u && u.notify("LayoutMeasure", this.layout.layoutBox, o ? o.layoutBox : void 0);
    }
    updateScroll(o = "measure") {
      let u = !!(this.options.layoutScroll && this.instance);
      if (this.scroll && this.scroll.animationId === this.root.animationId && this.scroll.phase === o && (u = !1), u && this.instance) {
        const c = r(this.instance);
        this.scroll = {
          animationId: this.root.animationId,
          phase: o,
          isRoot: c,
          offset: n(this.instance),
          wasRoot: this.scroll ? this.scroll.isRoot : c
        };
      }
    }
    resetTransform() {
      if (!i)
        return;
      const o = this.isLayoutDirty || this.shouldResetTransform || this.options.alwaysMeasureLayout, u = this.projectionDelta && !BI(this.projectionDelta), c = this.getTransformTemplate(), d = c ? c(this.latestValues, "") : void 0, m = d !== this.prevTransformTemplateValue;
      o && this.instance && (u || dd(this.latestValues) || m) && (i(this.instance, d), this.shouldResetTransform = !1, this.scheduleRender());
    }
    measure(o = !0) {
      const u = this.measurePageBox();
      let c = this.removeElementScroll(u);
      return o && (c = this.removeTransform(c)), Pee(c), {
        animationId: this.root.animationId,
        measuredBox: u,
        layoutBox: c,
        latestValues: {},
        source: this.id
      };
    }
    measurePageBox() {
      var d;
      const { visualElement: o } = this.options;
      if (!o)
        return Xr();
      const u = o.measureViewportBox();
      if (!(((d = this.scroll) == null ? void 0 : d.wasRoot) || this.path.some(zee))) {
        const { scroll: m } = this.root;
        m && (ym(u.x, m.offset.x), ym(u.y, m.offset.y));
      }
      return u;
    }
    removeElementScroll(o) {
      var c;
      const u = Xr();
      if (bo(u, o), (c = this.scroll) != null && c.wasRoot)
        return u;
      for (let d = 0; d < this.path.length; d++) {
        const m = this.path[d], { scroll: p, options: x } = m;
        m !== this.root && p && x.layoutScroll && (p.wasRoot && bo(u, o), ym(u.x, p.offset.x), ym(u.y, p.offset.y));
      }
      return u;
    }
    applyTransform(o, u = !1) {
      const c = Xr();
      bo(c, o);
      for (let d = 0; d < this.path.length; d++) {
        const m = this.path[d];
        !u && m.options.layoutScroll && m.scroll && m !== m.root && vm(c, {
          x: -m.scroll.offset.x,
          y: -m.scroll.offset.y
        }), dd(m.latestValues) && vm(c, m.latestValues);
      }
      return dd(this.latestValues) && vm(c, this.latestValues), c;
    }
    removeTransform(o) {
      const u = Xr();
      bo(u, o);
      for (let c = 0; c < this.path.length; c++) {
        const d = this.path[c];
        if (!d.instance || !dd(d.latestValues))
          continue;
        Y5(d.latestValues) && d.updateSnapshot();
        const m = Xr(), p = d.measurePageBox();
        bo(m, p), iT(u, d.latestValues, d.snapshot ? d.snapshot.layoutBox : void 0, m);
      }
      return dd(this.latestValues) && iT(u, this.latestValues), u;
    }
    setTargetDelta(o) {
      this.targetDelta = o, this.root.scheduleUpdateProjection(), this.isProjectionDirty = !0;
    }
    setOptions(o) {
      this.options = {
        ...this.options,
        ...o,
        crossfade: o.crossfade !== void 0 ? o.crossfade : !0
      };
    }
    clearMeasurements() {
      this.scroll = void 0, this.layout = void 0, this.snapshot = void 0, this.prevTransformTemplateValue = void 0, this.targetDelta = void 0, this.target = void 0, this.isLayoutDirty = !1;
    }
    forceRelativeParentToResolveTarget() {
      this.relativeParent && this.relativeParent.resolvedRelativeTargetAt !== vi.timestamp && this.relativeParent.resolveTargetDelta(!0);
    }
    resolveTargetDelta(o = !1) {
      var b;
      const u = this.getLead();
      this.isProjectionDirty || (this.isProjectionDirty = u.isProjectionDirty), this.isTransformDirty || (this.isTransformDirty = u.isTransformDirty), this.isSharedProjectionDirty || (this.isSharedProjectionDirty = u.isSharedProjectionDirty);
      const c = !!this.resumingFrom || this !== u;
      if (!(o || c && this.isSharedProjectionDirty || this.isProjectionDirty || (b = this.parent) != null && b.isProjectionDirty || this.attemptToResolveRelativeTarget || this.root.updateBlockedByResize))
        return;
      const { layout: m, layoutId: p } = this.options;
      if (!this.layout || !(m || p))
        return;
      this.resolvedRelativeTargetAt = vi.timestamp;
      const x = this.getClosestProjectingParent();
      x && this.linkedParentVersion !== x.layoutVersion && !x.options.layoutRoot && this.removeRelativeTarget(), !this.targetDelta && !this.relativeTarget && (x && x.layout ? this.createRelativeTarget(x, this.layout.layoutBox, x.layout.layoutBox) : this.removeRelativeTarget()), !(!this.relativeTarget && !this.targetDelta) && (this.target || (this.target = Xr(), this.targetWithTransforms = Xr()), this.relativeTarget && this.relativeTargetOrigin && this.relativeParent && this.relativeParent.target ? (this.forceRelativeParentToResolveTarget(), HJ(this.target, this.relativeTarget, this.relativeParent.target)) : this.targetDelta ? (this.resumingFrom ? this.target = this.applyTransform(this.layout.layoutBox) : bo(this.target, this.layout.layoutBox), bI(this.target, this.targetDelta)) : bo(this.target, this.layout.layoutBox), this.attemptToResolveRelativeTarget && (this.attemptToResolveRelativeTarget = !1, x && !!x.resumingFrom == !!this.resumingFrom && !x.options.layoutScroll && x.target && this.animationProgress !== 1 ? this.createRelativeTarget(x, this.target, x.target) : this.relativeParent = this.relativeTarget = void 0));
    }
    getClosestProjectingParent() {
      if (!(!this.parent || Y5(this.parent.latestValues) || xI(this.parent.latestValues)))
        return this.parent.isProjecting() ? this.parent : this.parent.getClosestProjectingParent();
    }
    isProjecting() {
      return !!((this.relativeTarget || this.targetDelta || this.options.layoutRoot) && this.layout);
    }
    createRelativeTarget(o, u, c) {
      this.relativeParent = o, this.linkedParentVersion = o.layoutVersion, this.forceRelativeParentToResolveTarget(), this.relativeTarget = Xr(), this.relativeTargetOrigin = Xr(), Dv(this.relativeTargetOrigin, u, c), bo(this.relativeTarget, this.relativeTargetOrigin);
    }
    removeRelativeTarget() {
      this.relativeParent = this.relativeTarget = void 0;
    }
    calcProjection() {
      var S;
      const o = this.getLead(), u = !!this.resumingFrom || this !== o;
      let c = !0;
      if ((this.isProjectionDirty || (S = this.parent) != null && S.isProjectionDirty) && (c = !1), u && (this.isSharedProjectionDirty || this.isTransformDirty) && (c = !1), this.resolvedRelativeTargetAt === vi.timestamp && (c = !1), c)
        return;
      const { layout: d, layoutId: m } = this.options;
      if (this.isTreeAnimating = !!(this.parent && this.parent.isTreeAnimating || this.currentAnimation || this.pendingAnimation), this.isTreeAnimating || (this.targetDelta = this.relativeTarget = void 0), !this.layout || !(d || m))
        return;
      bo(this.layoutCorrected, this.layout.layoutBox);
      const p = this.treeScale.x, x = this.treeScale.y;
      rJ(this.layoutCorrected, this.treeScale, this.path, u), o.layout && !o.target && (this.treeScale.x !== 1 || this.treeScale.y !== 1) && (o.target = o.layout.layoutBox, o.targetWithTransforms = Xr());
      const { target: b } = o;
      if (!b) {
        this.prevProjectionDelta && (this.createProjectionDeltas(), this.scheduleRender());
        return;
      }
      !this.projectionDelta || !this.prevProjectionDelta ? this.createProjectionDeltas() : (tT(this.prevProjectionDelta.x, this.projectionDelta.x), tT(this.prevProjectionDelta.y, this.projectionDelta.y)), r0(this.projectionDelta, this.layoutCorrected, b, this.latestValues), (this.treeScale.x !== p || this.treeScale.y !== x || !uT(this.projectionDelta.x, this.prevProjectionDelta.x) || !uT(this.projectionDelta.y, this.prevProjectionDelta.y)) && (this.hasProjected = !0, this.scheduleRender(), this.notifyListeners("projectionUpdate", b));
    }
    hide() {
      this.isVisible = !1;
    }
    show() {
      this.isVisible = !0;
    }
    scheduleRender(o = !0) {
      var u;
      if ((u = this.options.visualElement) == null || u.scheduleRender(), o) {
        const c = this.getStack();
        c && c.scheduleRender();
      }
      this.resumingFrom && !this.resumingFrom.instance && (this.resumingFrom = void 0);
    }
    createProjectionDeltas() {
      this.prevProjectionDelta = xm(), this.projectionDelta = xm(), this.projectionDeltaWithTransform = xm();
    }
    setAnimationOrigin(o, u = !1) {
      const c = this.snapshot, d = c ? c.latestValues : {}, m = { ...this.latestValues }, p = xm();
      (!this.relativeParent || !this.relativeParent.options.layoutRoot) && (this.relativeTarget = this.relativeTargetOrigin = void 0), this.attemptToResolveRelativeTarget = !u;
      const x = Xr(), b = c ? c.source : void 0, S = this.layout ? this.layout.source : void 0, k = b !== S, A = this.getStack(), T = !A || A.members.length <= 1, M = !!(k && !T && this.options.crossfade === !0 && !this.path.some(Dee));
      this.animationProgress = 0;
      let j;
      this.mixTargetDelta = (D) => {
        const z = D / 1e3;
        hT(p.x, o.x, z), hT(p.y, o.y, z), this.setTargetDelta(p), this.relativeTarget && this.relativeTargetOrigin && this.layout && this.relativeParent && this.relativeParent.layout && (Dv(x, this.layout.layoutBox, this.relativeParent.layout.layoutBox), Oee(this.relativeTarget, this.relativeTargetOrigin, x, z), j && vee(this.relativeTarget, j) && (this.isProjectionDirty = !1), j || (j = Xr()), bo(j, this.relativeTarget)), k && (this.animationValues = m, dee(m, d, this.latestValues, z, M, T)), this.root.scheduleUpdateProjection(), this.scheduleRender(), this.animationProgress = z;
      }, this.mixTargetDelta(this.options.layoutRoot ? 1e3 : 0);
    }
    startAnimation(o) {
      var u, c, d;
      this.notifyListeners("animationStart"), (u = this.currentAnimation) == null || u.stop(), (d = (c = this.resumingFrom) == null ? void 0 : c.currentAnimation) == null || d.stop(), this.pendingAnimation && (Su(this.pendingAnimation), this.pendingAnimation = void 0), this.pendingAnimation = nr.update(() => {
        cv.hasAnimatedSinceResize = !0, this.motionValue || (this.motionValue = Od(0)), this.currentAnimation = oee(this.motionValue, [0, 1e3], {
          ...o,
          velocity: 0,
          isSync: !0,
          onUpdate: (m) => {
            this.mixTargetDelta(m), o.onUpdate && o.onUpdate(m);
          },
          onStop: () => {
          },
          onComplete: () => {
            o.onComplete && o.onComplete(), this.completeAnimation();
          }
        }), this.resumingFrom && (this.resumingFrom.currentAnimation = this.currentAnimation), this.pendingAnimation = void 0;
      });
    }
    completeAnimation() {
      this.resumingFrom && (this.resumingFrom.currentAnimation = void 0, this.resumingFrom.preserveOpacity = void 0);
      const o = this.getStack();
      o && o.exitAnimationComplete(), this.resumingFrom = this.currentAnimation = this.animationValues = void 0, this.notifyListeners("animationComplete");
    }
    finishAnimation() {
      this.currentAnimation && (this.mixTargetDelta && this.mixTargetDelta(wee), this.currentAnimation.stop()), this.completeAnimation();
    }
    applyTransformsToTarget() {
      const o = this.getLead();
      let { targetWithTransforms: u, target: c, layout: d, latestValues: m } = o;
      if (!(!u || !c || !d)) {
        if (this !== o && this.layout && d && $I(this.options.animationType, this.layout.layoutBox, d.layoutBox)) {
          c = this.target || Xr();
          const p = fa(this.layout.layoutBox.x);
          c.x.min = o.target.x.min, c.x.max = c.x.min + p;
          const x = fa(this.layout.layoutBox.y);
          c.y.min = o.target.y.min, c.y.max = c.y.min + x;
        }
        bo(u, c), vm(u, m), r0(this.projectionDeltaWithTransform, this.layoutCorrected, u, m);
      }
    }
    registerSharedNode(o, u) {
      this.sharedNodes.has(o) || this.sharedNodes.set(o, new xee()), this.sharedNodes.get(o).add(u);
      const d = u.options.initialPromotionConfig;
      u.promote({
        transition: d ? d.transition : void 0,
        preserveFollowOpacity: d && d.shouldPreserveFollowOpacity ? d.shouldPreserveFollowOpacity(u) : void 0
      });
    }
    isLead() {
      const o = this.getStack();
      return o ? o.lead === this : !0;
    }
    getLead() {
      var u;
      const { layoutId: o } = this.options;
      return o ? ((u = this.getStack()) == null ? void 0 : u.lead) || this : this;
    }
    getPrevLead() {
      var u;
      const { layoutId: o } = this.options;
      return o ? (u = this.getStack()) == null ? void 0 : u.prevLead : void 0;
    }
    getStack() {
      const { layoutId: o } = this.options;
      if (o)
        return this.root.sharedNodes.get(o);
    }
    promote({ needsReset: o, transition: u, preserveFollowOpacity: c } = {}) {
      const d = this.getStack();
      d && d.promote(this, c), o && (this.projectionDelta = void 0, this.needsReset = !0), u && this.setOptions({ transition: u });
    }
    relegate() {
      const o = this.getStack();
      return o ? o.relegate(this) : !1;
    }
    resetSkewAndRotation() {
      const { visualElement: o } = this.options;
      if (!o)
        return;
      let u = !1;
      const { latestValues: c } = o;
      if ((c.z || c.rotate || c.rotateX || c.rotateY || c.rotateZ || c.skewX || c.skewY) && (u = !0), !u)
        return;
      const d = {};
      c.z && k2("z", o, d, this.animationValues);
      for (let m = 0; m < E2.length; m++)
        k2(`rotate${E2[m]}`, o, d, this.animationValues), k2(`skew${E2[m]}`, o, d, this.animationValues);
      o.render();
      for (const m in d)
        o.setStaticValue(m, d[m]), this.animationValues && (this.animationValues[m] = d[m]);
      o.scheduleRender();
    }
    applyProjectionStyles(o, u) {
      if (!this.instance || this.isSVG)
        return;
      if (!this.isVisible) {
        o.visibility = "hidden";
        return;
      }
      const c = this.getTransformTemplate();
      if (this.needsReset) {
        this.needsReset = !1, o.visibility = "", o.opacity = "", o.pointerEvents = uv(u == null ? void 0 : u.pointerEvents) || "", o.transform = c ? c(this.latestValues, "") : "none";
        return;
      }
      const d = this.getLead();
      if (!this.projectionDelta || !this.layout || !d.target) {
        this.options.layoutId && (o.opacity = this.latestValues.opacity !== void 0 ? this.latestValues.opacity : 1, o.pointerEvents = uv(u == null ? void 0 : u.pointerEvents) || ""), this.hasProjected && !dd(this.latestValues) && (o.transform = c ? c({}, "") : "none", this.hasProjected = !1);
        return;
      }
      o.visibility = "";
      const m = d.animationValues || d.latestValues;
      this.applyTransformsToTarget();
      let p = bee(this.projectionDeltaWithTransform, this.treeScale, m);
      c && (p = c(m, p)), o.transform = p;
      const { x, y: b } = this.projectionDelta;
      o.transformOrigin = `${x.origin * 100}% ${b.origin * 100}% 0`, d.animationValues ? o.opacity = d === this ? m.opacity ?? this.latestValues.opacity ?? 1 : this.preserveOpacity ? this.latestValues.opacity : m.opacityExit : o.opacity = d === this ? m.opacity !== void 0 ? m.opacity : "" : m.opacityExit !== void 0 ? m.opacityExit : 0;
      for (const S in K5) {
        if (m[S] === void 0)
          continue;
        const { correct: k, applyTo: A, isCSSVariable: T } = K5[S], M = p === "none" ? m[S] : k(m[S], d);
        if (A) {
          const j = A.length;
          for (let D = 0; D < j; D++)
            o[A[D]] = M;
        } else
          T ? this.options.visualElement.renderState.vars[S] = M : o[S] = M;
      }
      this.options.layoutId && (o.pointerEvents = d === this ? uv(u == null ? void 0 : u.pointerEvents) || "" : "none");
    }
    clearSnapshot() {
      this.resumeFrom = this.snapshot = void 0;
    }
    // Only run on root
    resetTree() {
      this.root.nodes.forEach((o) => {
        var u;
        return (u = o.currentAnimation) == null ? void 0 : u.stop();
      }), this.root.nodes.forEach(cT), this.root.sharedNodes.clear();
    }
  };
}
function See(e) {
  e.updateLayout();
}
function Cee(e) {
  var n;
  const t = ((n = e.resumeFrom) == null ? void 0 : n.snapshot) || e.snapshot;
  if (e.isLead() && e.layout && t && e.hasListeners("didUpdate")) {
    const { layoutBox: r, measuredBox: i } = e.layout, { animationType: s } = e.options, o = t.source !== e.layout.source;
    s === "size" ? Os((p) => {
      const x = o ? t.measuredBox[p] : t.layoutBox[p], b = fa(x);
      x.min = r[p].min, x.max = x.min + b;
    }) : $I(s, t.layoutBox, r) && Os((p) => {
      const x = o ? t.measuredBox[p] : t.layoutBox[p], b = fa(r[p]);
      x.max = x.min + b, e.relativeTarget && !e.currentAnimation && (e.isProjectionDirty = !0, e.relativeTarget[p].max = e.relativeTarget[p].min + b);
    });
    const u = xm();
    r0(u, r, t.layoutBox);
    const c = xm();
    o ? r0(c, e.applyTransform(i, !0), t.measuredBox) : r0(c, r, t.layoutBox);
    const d = !BI(u);
    let m = !1;
    if (!e.resumeFrom) {
      const p = e.getClosestProjectingParent();
      if (p && !p.resumeFrom) {
        const { snapshot: x, layout: b } = p;
        if (x && b) {
          const S = Xr();
          Dv(S, t.layoutBox, x.layoutBox);
          const k = Xr();
          Dv(k, r, b.layoutBox), qI(S, k) || (m = !0), p.options.layoutRoot && (e.relativeTarget = k, e.relativeTargetOrigin = S, e.relativeParent = p);
        }
      }
    }
    e.notifyListeners("didUpdate", {
      layout: r,
      snapshot: t,
      delta: c,
      layoutDelta: u,
      hasLayoutChanged: d,
      hasRelativeLayoutChanged: m
    });
  } else if (e.isLead()) {
    const { onExitComplete: r } = e.options;
    r && r();
  }
  e.options.transition = void 0;
}
function Eee(e) {
  e.parent && (e.isProjecting() || (e.isProjectionDirty = e.parent.isProjectionDirty), e.isSharedProjectionDirty || (e.isSharedProjectionDirty = !!(e.isProjectionDirty || e.parent.isProjectionDirty || e.parent.isSharedProjectionDirty)), e.isTransformDirty || (e.isTransformDirty = e.parent.isTransformDirty));
}
function kee(e) {
  e.isProjectionDirty = e.isSharedProjectionDirty = e.isTransformDirty = !1;
}
function Tee(e) {
  e.clearSnapshot();
}
function cT(e) {
  e.clearMeasurements();
}
function fT(e) {
  e.isLayoutDirty = !1;
}
function Nee(e) {
  const { visualElement: t } = e.options;
  t && t.getProps().onBeforeLayoutMeasure && t.notify("BeforeLayoutMeasure"), e.resetTransform();
}
function dT(e) {
  e.finishAnimation(), e.targetDelta = e.relativeTarget = e.target = void 0, e.isProjectionDirty = !0;
}
function Aee(e) {
  e.resolveTargetDelta();
}
function jee(e) {
  e.calcProjection();
}
function Mee(e) {
  e.resetSkewAndRotation();
}
function Ree(e) {
  e.removeLeadSnapshot();
}
function hT(e, t, n) {
  e.translate = or(t.translate, 0, n), e.scale = or(t.scale, 1, n), e.origin = t.origin, e.originPoint = t.originPoint;
}
function mT(e, t, n, r) {
  e.min = or(t.min, n.min, r), e.max = or(t.max, n.max, r);
}
function Oee(e, t, n, r) {
  mT(e.x, t.x, n.x, r), mT(e.y, t.y, n.y, r);
}
function Dee(e) {
  return e.animationValues && e.animationValues.opacityExit !== void 0;
}
const Iee = {
  duration: 0.45,
  ease: [0.4, 0, 0.1, 1]
}, pT = (e) => typeof navigator < "u" && navigator.userAgent && navigator.userAgent.toLowerCase().includes(e), gT = pT("applewebkit/") && !pT("chrome/") ? Math.round : Bs;
function yT(e) {
  e.min = gT(e.min), e.max = gT(e.max);
}
function Pee(e) {
  yT(e.x), yT(e.y);
}
function $I(e, t, n) {
  return e === "position" || e === "preserve-aspect" && !VJ(lT(t), lT(n), 0.2);
}
function zee(e) {
  var t;
  return e !== e.root && ((t = e.scroll) == null ? void 0 : t.wasRoot);
}
const Lee = UI({
  attachResizeListener: (e, t) => g0(e, "resize", t),
  measureScroll: () => ({
    x: document.documentElement.scrollLeft || document.body.scrollLeft,
    y: document.documentElement.scrollTop || document.body.scrollTop
  }),
  checkIsScrollRoot: () => !0
}), T2 = {
  current: void 0
}, VI = UI({
  measureScroll: (e) => ({
    x: e.scrollLeft,
    y: e.scrollTop
  }),
  defaultParent: () => {
    if (!T2.current) {
      const e = new Lee({});
      e.mount(window), e.setOptions({ layoutScroll: !0 }), T2.current = e;
    }
    return T2.current;
  },
  resetTransform: (e, t) => {
    e.style.transform = t !== void 0 ? t : "none";
  },
  checkIsScrollRoot: (e) => window.getComputedStyle(e).position === "fixed"
}), Bee = {
  pan: {
    Feature: aee
  },
  drag: {
    Feature: iee,
    ProjectionNode: VI,
    MeasureLayout: PI
  }
};
function vT(e, t, n) {
  const { props: r } = e;
  e.animationState && r.whileHover && e.animationState.setActive("whileHover", n === "Start");
  const i = "onHover" + n, s = r[i];
  s && nr.postRender(() => s(t, L0(t)));
}
class qee extends Vc {
  mount() {
    const { current: t } = this.node;
    t && (this.unmount = hZ(t, (n, r) => (vT(this.node, r, "Start"), (i) => vT(this.node, i, "End"))));
  }
  unmount() {
  }
}
class Fee extends Vc {
  constructor() {
    super(...arguments), this.isActive = !1;
  }
  onFocus() {
    let t = !1;
    try {
      t = this.node.current.matches(":focus-visible");
    } catch {
      t = !0;
    }
    !t || !this.node.animationState || (this.node.animationState.setActive("whileFocus", !0), this.isActive = !0);
  }
  onBlur() {
    !this.isActive || !this.node.animationState || (this.node.animationState.setActive("whileFocus", !1), this.isActive = !1);
  }
  mount() {
    this.unmount = I0(g0(this.node.current, "focus", () => this.onFocus()), g0(this.node.current, "blur", () => this.onBlur()));
  }
  unmount() {
  }
}
function xT(e, t, n) {
  const { props: r } = e;
  if (e.current instanceof HTMLButtonElement && e.current.disabled)
    return;
  e.animationState && r.whileTap && e.animationState.setActive("whileTap", n === "Start");
  const i = "onTap" + (n === "End" ? "" : n), s = r[i];
  s && nr.postRender(() => s(t, L0(t)));
}
class Uee extends Vc {
  mount() {
    const { current: t } = this.node;
    t && (this.unmount = yZ(t, (n, r) => (xT(this.node, r, "Start"), (i, { success: s }) => xT(this.node, i, s ? "End" : "Cancel")), { useGlobalTarget: this.node.props.globalTapTarget }));
  }
  unmount() {
  }
}
const tC = /* @__PURE__ */ new WeakMap(), N2 = /* @__PURE__ */ new WeakMap(), $ee = (e) => {
  const t = tC.get(e.target);
  t && t(e);
}, Vee = (e) => {
  e.forEach($ee);
};
function Hee({ root: e, ...t }) {
  const n = e || document;
  N2.has(n) || N2.set(n, {});
  const r = N2.get(n), i = JSON.stringify(t);
  return r[i] || (r[i] = new IntersectionObserver(Vee, { root: e, ...t })), r[i];
}
function Gee(e, t, n) {
  const r = Hee(t);
  return tC.set(e, n), r.observe(e), () => {
    tC.delete(e), r.unobserve(e);
  };
}
const Kee = {
  some: 0,
  all: 1
};
class Yee extends Vc {
  constructor() {
    super(...arguments), this.hasEnteredView = !1, this.isInView = !1;
  }
  startObserver() {
    this.unmount();
    const { viewport: t = {} } = this.node.getProps(), { root: n, margin: r, amount: i = "some", once: s } = t, o = {
      root: n ? n.current : void 0,
      rootMargin: r,
      threshold: typeof i == "number" ? i : Kee[i]
    }, u = (c) => {
      const { isIntersecting: d } = c;
      if (this.isInView === d || (this.isInView = d, s && !d && this.hasEnteredView))
        return;
      d && (this.hasEnteredView = !0), this.node.animationState && this.node.animationState.setActive("whileInView", d);
      const { onViewportEnter: m, onViewportLeave: p } = this.node.getProps(), x = d ? m : p;
      x && x(c);
    };
    return Gee(this.node.current, o, u);
  }
  mount() {
    this.startObserver();
  }
  update() {
    if (typeof IntersectionObserver > "u")
      return;
    const { props: t, prevProps: n } = this.node;
    ["amount", "margin", "root"].some(Wee(t, n)) && this.startObserver();
  }
  unmount() {
  }
}
function Wee({ viewport: e = {} }, { viewport: t = {} } = {}) {
  return (n) => e[n] !== t[n];
}
const Xee = {
  inView: {
    Feature: Yee
  },
  tap: {
    Feature: Uee
  },
  focus: {
    Feature: Fee
  },
  hover: {
    Feature: qee
  }
}, Qee = {
  layout: {
    ProjectionNode: VI,
    MeasureLayout: PI
  }
}, Zee = {
  ...LJ,
  ...Xee,
  ...Bee,
  ...Qee
}, HI = /* @__PURE__ */ eJ(Zee, hJ);
function GI(e) {
  const t = D0(() => Od(e)), { isStatic: n } = F.useContext(_E);
  if (n) {
    const [, r] = F.useState(e);
    F.useEffect(() => t.on("change", r), []);
  }
  return t;
}
function KI(e, t) {
  const n = GI(t()), r = () => n.set(t());
  return r(), hD(() => {
    const i = () => nr.preRender(r, !1, !0), s = e.map((o) => o.on("change", i));
    return () => {
      s.forEach((o) => o()), Su(r);
    };
  }), n;
}
function Jee(e) {
  t0.current = [], e();
  const t = KI(t0.current, e);
  return t0.current = void 0, t;
}
function ete(e, t, n, r) {
  if (typeof e == "function")
    return Jee(e);
  const i = typeof t == "function" ? t : xZ(t, n, r);
  return Array.isArray(e) ? bT(e, i) : bT([e], ([s]) => i(s));
}
function bT(e, t) {
  const n = D0(() => []);
  return KI(e, () => {
    n.length = 0;
    const r = e.length;
    for (let i = 0; i < r; i++)
      n[i] = e[i].get();
    return t(n);
  });
}
const YI = F.createContext(null);
function tte(e, t, n, r) {
  if (!r)
    return e;
  const i = e.findIndex((m) => m.value === t);
  if (i === -1)
    return e;
  const s = r > 0 ? 1 : -1, o = e[i + s];
  if (!o)
    return e;
  const u = e[i], c = o.layout, d = or(c.min, c.max, 0.5);
  return s === 1 && u.layout.max + n > d || s === -1 && u.layout.min + n < d ? CX(e, i, i + s) : e;
}
function nte({ children: e, as: t = "ul", axis: n = "y", onReorder: r, values: i, ...s }, o) {
  const u = D0(() => HI[t]), c = [], d = F.useRef(!1), m = {
    axis: n,
    registerItem: (p, x) => {
      const b = c.findIndex((S) => p === S.value);
      b !== -1 ? c[b].layout = x[n] : c.push({ value: p, layout: x[n] }), c.sort(ate);
    },
    updateOrder: (p, x, b) => {
      if (d.current)
        return;
      const S = tte(c, p, x, b);
      c !== S && (d.current = !0, r(S.map(ite).filter((k) => i.indexOf(k) !== -1)));
    }
  };
  return F.useEffect(() => {
    d.current = !1;
  }), g.jsx(u, { ...s, ref: o, ignoreStrict: !0, children: g.jsx(YI.Provider, { value: m, children: e }) });
}
const rte = /* @__PURE__ */ F.forwardRef(nte);
function ite(e) {
  return e.value;
}
function ate(e, t) {
  return e.layout.min - t.layout.min;
}
function wT(e, t = 0) {
  return _i(e) ? e : GI(t);
}
function ste({ children: e, style: t = {}, value: n, as: r = "li", onDrag: i, layout: s = !0, ...o }, u) {
  const c = D0(() => HI[r]), d = F.useContext(YI), m = {
    x: wT(t.x),
    y: wT(t.y)
  }, p = ete([m.x, m.y], ([k, A]) => k || A ? 1 : "unset"), { axis: x, registerItem: b, updateOrder: S } = d;
  return g.jsx(c, { drag: x, ...o, dragSnapToOrigin: !0, style: { ...t, x: m.x, y: m.y, zIndex: p }, layout: s, onDrag: (k, A) => {
    const { velocity: T } = A;
    T[x] && S(n, m[x].get(), T[x]), i && i(k, A);
  }, onLayoutMeasure: (k) => b(n, k), ref: u, ignoreStrict: !0, children: e });
}
const ote = /* @__PURE__ */ F.forwardRef(ste), lte = ({
  rules: e,
  selectedId: t,
  onSelect: n,
  onToggle: r,
  onDelete: i,
  onAdd: s,
  onReset: o,
  onReorder: u,
  enableNativeRegex: c,
  onToggleNativeRegex: d
}) => /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col gap-4", children: [
  /* @__PURE__ */ g.jsxs("div", { className: "flex items-center justify-between", children: [
    /* @__PURE__ */ g.jsx("h3", { className: "text-xs font-bold text-muted-foreground uppercase tracking-wider", children: "" }),
    /* @__PURE__ */ g.jsxs("div", { className: "flex gap-2", children: [
      /* @__PURE__ */ g.jsx(
        "button",
        {
          className: "text-[10px] text-muted-foreground hover:text-destructive transition-colors",
          onClick: o,
          children: ""
        }
      ),
      /* @__PURE__ */ g.jsx(
        "button",
        {
          className: "text-muted-foreground hover:text-foreground transition-colors",
          onClick: s,
          children: /* @__PURE__ */ g.jsx(rR, { size: 16 })
        }
      )
    ] })
  ] }),
  /* @__PURE__ */ g.jsx("div", { className: "bg-muted/10 border border-border/50 rounded-lg p-3 mb-2", children: /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4", children: [
    /* @__PURE__ */ g.jsxs("div", { className: "flex-1 min-w-0", children: [
      /* @__PURE__ */ g.jsx("h4", { className: "text-sm font-medium", children: " Regex " }),
      /* @__PURE__ */ g.jsx("p", { className: "text-xs text-muted-foreground mt-0.5 break-words", children: " SillyTavern  Regex " })
    ] }),
    /* @__PURE__ */ g.jsx(
      Zr,
      {
        checked: c ?? !0,
        onChange: (m) => d == null ? void 0 : d(m)
      }
    )
  ] }) }),
  /* @__PURE__ */ g.jsx(rte, { axis: "y", values: e, onReorder: u, className: "flex flex-col gap-1", children: e.map((m) => /* @__PURE__ */ g.jsxs(
    ote,
    {
      value: m,
      className: `
                            group p-3 rounded-lg transition-all duration-200 cursor-pointer border flex items-center gap-3
                            ${t === m.id ? "bg-accent/50 border-input" : "bg-transparent border-transparent hover:bg-muted/50 hover:border-border"}
                            ${!m.enabled && "opacity-50"}
                        `,
      onClick: () => n(m.id),
      children: [
        /* @__PURE__ */ g.jsx("div", { className: "cursor-grab active:cursor-grabbing text-muted-foreground hover:text-foreground transition-colors", children: /* @__PURE__ */ g.jsx(eR, { size: 14 }) }),
        /* @__PURE__ */ g.jsx(
          "button",
          {
            className: `
                                w-8 h-8 flex items-center justify-center rounded-lg transition-colors
                                ${m.enabled ? t === m.id ? "bg-primary/20 text-primary" : "bg-muted text-primary" : "bg-muted text-muted-foreground"}
                            `,
            onClick: (p) => {
              p.stopPropagation(), r(m.id);
            },
            title: m.enabled ? "" : "",
            children: /* @__PURE__ */ g.jsx(Qv, { size: 14 })
          }
        ),
        /* @__PURE__ */ g.jsxs("div", { className: "flex-1 min-w-0", children: [
          /* @__PURE__ */ g.jsx("div", { className: "flex items-center justify-between", children: /* @__PURE__ */ g.jsx("h4", { className: `text-sm font-medium truncate ${t === m.id ? "text-foreground" : "text-muted-foreground group-hover:text-foreground"} ${!m.enabled && "opacity-50 line-through"}`, children: m.name }) }),
          /* @__PURE__ */ g.jsx("div", { className: "mt-0.5 flex items-center gap-2", children: /* @__PURE__ */ g.jsxs("code", { className: "text-[10px] bg-muted px-1 rounded text-muted-foreground font-mono truncate max-w-[120px]", children: [
            "/",
            m.pattern,
            "/",
            m.flags
          ] }) })
        ] }),
        /* @__PURE__ */ g.jsx("div", { className: `flex items-center ${t === m.id ? "opacity-100" : "opacity-0 group-hover:opacity-100"} transition-opacity`, children: /* @__PURE__ */ g.jsx(
          "button",
          {
            className: "p-1.5 hover:bg-destructive/10 rounded text-muted-foreground hover:text-destructive transition-colors",
            onClick: (p) => {
              p.stopPropagation(), i(m.id);
            },
            children: /* @__PURE__ */ g.jsx(jo, { size: 12 })
          }
        ) })
      ]
    },
    m.id
  )) }),
  e.length === 0 && /* @__PURE__ */ g.jsx("div", { className: "text-center p-8 border border-dashed border-border rounded-lg", children: /* @__PURE__ */ g.jsx("p", { className: "text-xs text-muted-foreground", children: "" }) })
] }), ute = [
  { value: "g", label: "", description: "" },
  { value: "i", label: "", description: "" },
  { value: "m", label: "", description: "^$ " },
  { value: "s", label: "", description: ". " }
], _T = ({ rule: e, onChange: t }) => {
  var m;
  const [n, r] = F.useState(""), [i, s] = F.useState(""), [o, u] = F.useState({ valid: !0 }), c = new ox();
  F.useEffect(() => {
    const p = c.validatePattern(e.pattern, e.flags);
    u(p);
  }, [e.pattern, e.flags]), F.useEffect(() => {
    if (n && o.valid) {
      const p = c.processWithRule(n, e);
      s(p);
    } else
      s("");
  }, [n, e, o.valid]);
  const d = (p) => {
    const x = e.flags.split(""), b = x.indexOf(p);
    b >= 0 ? x.splice(b, 1) : x.push(p), t({ flags: x.join("") });
  };
  return /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col gap-4", children: [
    /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col gap-3", children: [
      /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col gap-1.5", children: [
        /* @__PURE__ */ g.jsx("label", { className: "text-sm font-medium text-foreground", children: "" }),
        /* @__PURE__ */ g.jsx(
          "input",
          {
            type: "text",
            className: "w-full px-3 py-2 rounded-md border border-input bg-background text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring",
            value: e.name,
            onChange: (p) => t({ name: p.target.value }),
            placeholder: ""
          }
        )
      ] }),
      /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col gap-1.5", children: [
        /* @__PURE__ */ g.jsx("label", { className: "text-sm font-medium text-foreground", children: "" }),
        /* @__PURE__ */ g.jsx(
          "input",
          {
            type: "text",
            className: "w-full px-3 py-2 rounded-md border border-input bg-background text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring",
            value: e.description || "",
            onChange: (p) => t({ description: p.target.value }),
            placeholder: ""
          }
        )
      ] }),
      /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col gap-1.5", children: [
        /* @__PURE__ */ g.jsx("label", { className: "text-sm font-medium text-foreground", children: "" }),
        /* @__PURE__ */ g.jsx("div", { className: "flex gap-2", children: C5.map((p) => /* @__PURE__ */ g.jsx(
          "button",
          {
            className: `flex-1 px-3 py-2 text-sm rounded-md border transition-colors ${e.scope === p.value ? "bg-primary-20 border-primary text-primary" : "bg-background border-border text-muted-foreground hover:bg-muted"}`,
            onClick: () => t({ scope: p.value }),
            title: p.description,
            children: p.label
          },
          p.value
        )) }),
        /* @__PURE__ */ g.jsx("p", { className: "text-xs text-muted-foreground", children: (m = C5.find((p) => p.value === e.scope)) == null ? void 0 : m.description })
      ] })
    ] }),
    /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col gap-3 p-4 bg-card border border-border rounded-lg", children: [
      /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col gap-1.5", children: [
        /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-2", children: [
          /* @__PURE__ */ g.jsx("label", { className: "text-sm font-medium text-foreground", children: "" }),
          o.valid ? /* @__PURE__ */ g.jsx(xC, { size: 14, className: "text-green-500" }) : /* @__PURE__ */ g.jsx(qc, { size: 14, className: "text-red-500" })
        ] }),
        /* @__PURE__ */ g.jsx(
          "input",
          {
            type: "text",
            className: `w-full px-3 py-2 rounded-md border bg-background text-foreground font-mono text-sm placeholder:text-muted-foreground focus:outline-none focus:ring-2 ${o.valid ? "border-input focus:ring-ring" : "border-red-500 focus:ring-red-500"}`,
            value: e.pattern,
            onChange: (p) => t({ pattern: p.target.value }),
            placeholder: "<think>[\\s\\S]*?</think>"
          }
        ),
        !o.valid && o.error && /* @__PURE__ */ g.jsx("p", { className: "text-xs text-red-500", children: o.error })
      ] }),
      /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col gap-1.5", children: [
        /* @__PURE__ */ g.jsx("label", { className: "text-sm font-medium text-foreground", children: "" }),
        /* @__PURE__ */ g.jsx(
          "input",
          {
            type: "text",
            className: "w-full px-3 py-2 rounded-md border border-input bg-background text-foreground font-mono text-sm placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring",
            value: e.replacement,
            onChange: (p) => t({ replacement: p.target.value }),
            placeholder: ""
          }
        )
      ] }),
      /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col gap-1.5", children: [
        /* @__PURE__ */ g.jsx("label", { className: "text-sm font-medium text-foreground", children: "" }),
        /* @__PURE__ */ g.jsx("div", { className: "flex flex-wrap gap-2", children: ute.map((p) => /* @__PURE__ */ g.jsxs(
          "button",
          {
            className: `px-2 py-1 text-xs rounded-md border transition-colors ${e.flags.includes(p.value) ? "bg-primary-20 border-primary text-primary" : "bg-background border-border text-muted-foreground hover:bg-muted"}`,
            onClick: () => d(p.value),
            title: p.description,
            children: [
              p.label,
              " (",
              p.value,
              ")"
            ]
          },
          p.value
        )) })
      ] })
    ] }),
    /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col gap-3 p-4 bg-muted-20 border border-border rounded-lg", children: [
      /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-2 text-sm font-medium text-foreground", children: [
        /* @__PURE__ */ g.jsx(s0, { size: 14 }),
        ""
      ] }),
      /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col gap-1.5", children: [
        /* @__PURE__ */ g.jsx("label", { className: "text-xs text-muted-foreground", children: "" }),
        /* @__PURE__ */ g.jsx(
          "textarea",
          {
            className: "w-full min-h-[80px] px-3 py-2 rounded-md border border-input bg-background text-foreground text-sm resize-y focus:outline-none focus:ring-2 focus:ring-ring",
            value: n,
            onChange: (p) => r(p.target.value),
            placeholder: `
<think></think>
`
          }
        )
      ] }),
      n && o.valid && /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col gap-1.5", children: [
        /* @__PURE__ */ g.jsx("label", { className: "text-xs text-muted-foreground", children: "" }),
        /* @__PURE__ */ g.jsx("div", { className: "min-h-[60px] px-3 py-2 rounded-md border border-border bg-background text-sm whitespace-pre-wrap", children: i || /* @__PURE__ */ g.jsx("span", { className: "text-muted-foreground italic", children: "" }) })
      ] })
    ] }),
    /* @__PURE__ */ g.jsxs("div", { className: "flex items-start gap-2 p-3 bg-blue-500/10 border border-blue-500/30 rounded-lg text-sm text-blue-400", children: [
      /* @__PURE__ */ g.jsx(tq, { size: 16, className: "shrink-0 mt-0.5" }),
      /* @__PURE__ */ g.jsxs("div", { children: [
        /* @__PURE__ */ g.jsx("strong", { children: "" }),
        " LLM ",
        /* @__PURE__ */ g.jsx("strong", { children: "" }),
        " LLM  ",
        /* @__PURE__ */ g.jsx("code", { className: "bg-blue-500/20 px-1 rounded", children: "<think>" }),
        ""
      ] })
    ] })
  ] });
}, cte = ({
  config: e,
  onChange: t,
  worldbookStructure: n = {},
  disabledEntries: r = {},
  onToggleWorldbook: i,
  onToggleEntry: s,
  onRefresh: o
}) => {
  const [u, c] = F.useState(/* @__PURE__ */ new Set()), [d, m] = F.useState(""), p = (T) => {
    t({
      ...e,
      [T]: !e[T]
    });
  }, x = (T) => {
    const M = new Set(u);
    M.has(T) ? M.delete(T) : M.add(T), c(M);
  }, b = (T) => {
    var M;
    return ((M = e.disabledWorldbooks) == null ? void 0 : M.includes(T)) || !1;
  }, S = (T, M) => {
    var j;
    return ((j = r[T]) == null ? void 0 : j.includes(M)) || !1;
  }, A = Object.keys(n).sort().filter(
    (T) => T.toLowerCase().includes(d.toLowerCase()) || n[T].some(
      (M) => {
        var j, D;
        return ((j = M.names) == null ? void 0 : j.join(" ").toLowerCase().includes(d.toLowerCase())) || ((D = M.comment) == null ? void 0 : D.toLowerCase().includes(d.toLowerCase()));
      }
    )
  );
  return /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col gap-6", children: [
    /* @__PURE__ */ g.jsxs(ca, { title: "", description: "", children: [
      /* @__PURE__ */ g.jsx(
        So,
        {
          label: "",
          description: "",
          checked: e.enabled,
          onChange: () => p("enabled")
        }
      ),
      /* @__PURE__ */ g.jsx(
        So,
        {
          label: "",
          description: " / ",
          checked: e.includeGlobal,
          onChange: () => p("includeGlobal"),
          disabled: !e.enabled
        }
      ),
      /* @__PURE__ */ g.jsx(
        So,
        {
          label: " EJS  (ST-Prompt-Template)",
          description: "[]  WorldInfo  EJS  ST-Prompt-Template",
          checked: e.enableEJS ?? !0,
          onChange: () => p("enableEJS"),
          disabled: !e.enabled
        }
      )
    ] }),
    e.enabled && /* @__PURE__ */ g.jsxs(ca, { title: "", description: "", children: [
      /* @__PURE__ */ g.jsxs("div", { className: "flex items-center justify-between mb-4 gap-4", children: [
        /* @__PURE__ */ g.jsxs("div", { className: "relative flex-1", children: [
          /* @__PURE__ */ g.jsx(Ls, { className: "absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground w-4 h-4" }),
          /* @__PURE__ */ g.jsx(
            "input",
            {
              type: "text",
              placeholder: "...",
              className: "w-full h-9 pl-9 pr-3 rounded-md border border-input bg-transparent text-sm shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring",
              value: d,
              onChange: (T) => m(T.target.value)
            }
          )
        ] }),
        /* @__PURE__ */ g.jsx(
          "button",
          {
            onClick: o,
            className: "inline-flex items-center justify-center rounded-md w-9 h-9 hover:bg-accent hover:text-accent-foreground transition-colors",
            title: "",
            children: /* @__PURE__ */ g.jsx(zr, { size: 16 })
          }
        )
      ] }),
      /* @__PURE__ */ g.jsx("div", { className: "flex flex-col gap-2", children: A.length === 0 ? /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col items-center justify-center py-8 text-muted-foreground gap-2 border border-dashed rounded-lg", children: [
        /* @__PURE__ */ g.jsx(qc, { size: 24, className: "opacity-50" }),
        /* @__PURE__ */ g.jsx("span", { className: "text-sm", children: "" })
      ] }) : A.map((T) => {
        const M = b(T), j = n[T] || [], D = u.has(T), z = j.filter((I) => !S(T, I.uid)).length;
        return /* @__PURE__ */ g.jsxs("div", { className: `transition-all border-b border-border last:border-0 ${M ? "bg-muted/10 opacity-60 grayscale" : ""}`, children: [
          /* @__PURE__ */ g.jsxs("div", { className: "flex items-center justify-between p-3", children: [
            /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-3 flex-1 overflow-hidden", children: [
              /* @__PURE__ */ g.jsx(
                "button",
                {
                  onClick: () => x(T),
                  className: "p-1 hover:bg-accent rounded-sm transition-colors",
                  children: D ? /* @__PURE__ */ g.jsx(Ad, { size: 16 }) : /* @__PURE__ */ g.jsx(Pm, { size: 16 })
                }
              ),
              /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-2 min-w-0", children: [
                /* @__PURE__ */ g.jsx(dB, { size: 16, className: M ? "text-muted-foreground" : "text-primary" }),
                /* @__PURE__ */ g.jsx("span", { className: `font-medium truncate ${M ? "text-muted-foreground line-through" : ""}`, children: T }),
                /* @__PURE__ */ g.jsxs("span", { className: "text-xs text-muted-foreground px-2 py-0.5 bg-muted rounded-full whitespace-nowrap", children: [
                  z,
                  " / ",
                  j.length,
                  " "
                ] })
              ] })
            ] }),
            /* @__PURE__ */ g.jsx("div", { className: "flex items-center gap-4", children: /* @__PURE__ */ g.jsx(
              So,
              {
                label: "",
                checked: !M,
                onChange: (I) => i == null ? void 0 : i(T, !I),
                compact: !0
              }
            ) })
          ] }),
          D && !M && /* @__PURE__ */ g.jsx("div", { className: "pl-4 pr-1 py-1 flex flex-col gap-0 animate-in slide-in-from-top-1 duration-200", children: j.length === 0 ? /* @__PURE__ */ g.jsx("div", { className: "text-xs text-muted-foreground text-center py-4", children: "" }) : j.map((I) => {
            const L = S(T, I.uid);
            return /* @__PURE__ */ g.jsxs("div", { className: `flex items-start justify-between py-2 -mx-2 px-2 rounded hover:bg-accent/40 transition-colors group ${L ? "bg-muted/10 opacity-60 grayscale" : ""}`, children: [
              /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col gap-1 min-w-0 flex-1 pr-4", children: [
                /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-2 flex-wrap min-w-0", children: [
                  /* @__PURE__ */ g.jsx(
                    "div",
                    {
                      className: `w-1.5 h-1.5 rounded-full flex-shrink-0 ${I.constant ? "bg-primary" : "bg-emerald-500"}`,
                      title: I.constant ? " (Constant)" : " (Selective)"
                    }
                  ),
                  /* @__PURE__ */ g.jsx("span", { className: `text-sm font-medium truncate max-w-full ${L ? "text-muted-foreground line-through" : "text-foreground"}`, children: I.name || ` #${I.uid}` }),
                  (I.keys || []).length > 0 && /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-1 ml-auto md:ml-2 overflow-hidden max-w-full", children: [
                    I.keys.slice(0, 3).map((K, ne) => /* @__PURE__ */ g.jsx("span", { className: "text-[10px] px-1 py-0.5 rounded border border-border bg-muted/20 text-muted-foreground whitespace-nowrap overflow-hidden text-ellipsis max-w-[80px]", children: K }, ne)),
                    I.keys.length > 3 && /* @__PURE__ */ g.jsxs("span", { className: "text-[10px] text-muted-foreground", children: [
                      "+",
                      I.keys.length - 3
                    ] })
                  ] })
                ] }),
                (I.comment || I.content) && /* @__PURE__ */ g.jsx("p", { className: "text-xs text-muted-foreground/80 pl-3.5 break-words line-clamp-2", children: I.comment || I.content })
              ] }),
              /* @__PURE__ */ g.jsx("div", { className: "flex-shrink-0", children: /* @__PURE__ */ g.jsx(
                So,
                {
                  label: "",
                  checked: !L,
                  onChange: (K) => s == null ? void 0 : s(T, I.uid, !K),
                  compact: !0
                }
              ) })
            ] }, I.uid);
          }) })
        ] }, T);
      }) })
    ] })
  ] });
}, fte = ({
  macros: e,
  selectedId: t,
  onSelect: n,
  onAdd: r,
  onToggle: i,
  onDelete: s
}) => /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col gap-4 h-full", children: [
  /* @__PURE__ */ g.jsxs("div", { className: "flex items-center justify-between gap-2", children: [
    /* @__PURE__ */ g.jsx("h3", { className: "text-xs font-bold text-muted-foreground uppercase tracking-wider", children: "" }),
    /* @__PURE__ */ g.jsx(
      "button",
      {
        className: "text-muted-foreground hover:text-foreground transition-colors",
        onClick: r,
        title: "",
        children: /* @__PURE__ */ g.jsx(SC, { size: 16 })
      }
    )
  ] }),
  /* @__PURE__ */ g.jsxs("div", { className: "text-xs text-muted-foreground bg-muted/30 rounded px-2 py-1.5 border border-border/50 leading-relaxed", children: [
    " ",
    /* @__PURE__ */ g.jsx("code", { className: "bg-muted px-1 rounded", children: "{{}}" }),
    " "
  ] }),
  /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col gap-1 overflow-y-auto flex-1 no-scrollbar", children: [
    e.map((o) => /* @__PURE__ */ g.jsxs(
      "div",
      {
        className: `
                            group p-3 rounded-lg transition-all duration-200 cursor-pointer border flex items-center gap-3
                            ${t === o.id ? "bg-accent/50 border-input" : "bg-transparent border-transparent hover:bg-muted/50 hover:border-border"}
                            ${!o.enabled && "opacity-50"}
                        `,
        onClick: () => n(o),
        children: [
          /* @__PURE__ */ g.jsx(
            "button",
            {
              className: `
                                w-8 h-8 flex items-center justify-center rounded-lg transition-colors flex-shrink-0
                                ${o.enabled ? t === o.id ? "bg-primary/20 text-primary" : "bg-muted text-primary" : "bg-muted text-muted-foreground"}
                            `,
              onClick: (u) => {
                u.stopPropagation(), i(o.id);
              },
              title: o.enabled ? "" : "",
              children: /* @__PURE__ */ g.jsx(Qv, { size: 14 })
            }
          ),
          /* @__PURE__ */ g.jsxs("div", { className: "flex-1 min-w-0", children: [
            /* @__PURE__ */ g.jsx("div", { className: "flex items-center gap-2", children: /* @__PURE__ */ g.jsx("code", { className: `text-sm font-medium truncate ${t === o.id ? "text-primary" : "text-foreground"}`, children: `{{${o.name}}}` }) }),
            /* @__PURE__ */ g.jsx("p", { className: "mt-0.5 text-[10px] text-muted-foreground truncate", children: o.content ? o.content.slice(0, 50) + (o.content.length > 50 ? "..." : "") : "()" })
          ] }),
          /* @__PURE__ */ g.jsx(
            "button",
            {
              className: `p-1.5 hover:bg-destructive/10 rounded text-muted-foreground hover:text-destructive transition-colors ${t === o.id ? "opacity-100" : "opacity-0 group-hover:opacity-100"}`,
              onClick: (u) => {
                u.stopPropagation(), s(o.id);
              },
              title: "",
              children: /* @__PURE__ */ g.jsx(jo, { size: 12 })
            }
          )
        ]
      },
      o.id
    )),
    e.length === 0 && /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col items-center justify-center py-12 text-muted-foreground gap-2 border border-dashed border-border rounded-lg", children: [
      /* @__PURE__ */ g.jsx(ZM, { size: 24, className: "opacity-50" }),
      /* @__PURE__ */ g.jsx("p", { className: "text-xs", children: "" }),
      /* @__PURE__ */ g.jsx(
        "button",
        {
          className: "text-xs text-primary hover:underline",
          onClick: r,
          children: ""
        }
      )
    ] })
  ] })
] }), dte = ({
  macro: e,
  onChange: t
}) => /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col gap-4", children: [
  /* @__PURE__ */ g.jsx(ca, { title: "", children: /* @__PURE__ */ g.jsx(
    wi,
    {
      label: "",
      value: e.name,
      onChange: (n) => t({ name: n }),
      placeholder: "",
      required: !0,
      description: " {{}} "
    }
  ) }),
  /* @__PURE__ */ g.jsx(ca, { title: "", children: /* @__PURE__ */ g.jsx(
    wi,
    {
      label: "",
      value: e.content,
      onChange: (n) => t({ content: n }),
      placeholder: "",
      multiline: !0,
      rows: 8
    }
  ) }),
  /* @__PURE__ */ g.jsxs("div", { className: "px-3 py-2 bg-muted/30 rounded border border-border", children: [
    /* @__PURE__ */ g.jsx("div", { className: "text-[10px] text-muted-foreground mb-2 font-medium uppercase tracking-wider", children: "" }),
    /* @__PURE__ */ g.jsxs("div", { className: "text-xs text-muted-foreground leading-relaxed", children: [
      /* @__PURE__ */ g.jsxs("p", { children: [
        " ",
        /* @__PURE__ */ g.jsx("code", { className: "px-1 py-0.5 bg-muted rounded text-primary font-mono", children: `{{${e.name || ""}}}` }),
        " "
      ] }),
      /* @__PURE__ */ g.jsx("p", { className: "mt-1", children: " SillyTavern " })
    ] })
  ] })
] }), RE = ({ title: e, subtitle: t, actions: n, className: r = "" }) => /* @__PURE__ */ g.jsxs("div", { className: `mb-8 px-4 md:px-0 flex justify-between items-start animate-in fade-in slide-in-from-bottom-2 duration-500 ${r}`, children: [
  /* @__PURE__ */ g.jsxs("div", { children: [
    /* @__PURE__ */ g.jsx("h1", { className: "text-3xl font-light tracking-tight text-foreground", children: e }),
    t && /* @__PURE__ */ g.jsx("p", { className: "mt-2 text-muted-foreground text-sm font-light", children: t })
  ] }),
  n && /* @__PURE__ */ g.jsx("div", { className: "flex gap-2", children: n })
] }), A2 = ({
  title: e,
  onClose: t,
  children: n,
  actions: r
}) => /* @__PURE__ */ g.jsxs(
  "div",
  {
    className: "fixed inset-0 bg-background z-50 flex flex-col animate-in slide-in-from-right-4 duration-200",
    style: { height: "100dvh", width: "100vw" },
    children: [
      /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-3 px-4 py-3 border-b border-border shrink-0", children: [
        /* @__PURE__ */ g.jsx(
          "button",
          {
            onClick: t,
            className: "p-1 hover:bg-accent rounded",
            children: /* @__PURE__ */ g.jsx(vC, { size: 20 })
          }
        ),
        /* @__PURE__ */ g.jsx("h2", { className: "text-lg font-light flex-1", children: e }),
        r
      ] }),
      /* @__PURE__ */ g.jsx("div", { className: "flex-1 overflow-y-auto p-4 no-scrollbar", children: n })
    ]
  }
);
function hte(e, t) {
  const n = [];
  for (const i of e.filter((s) => s.isBuiltIn)) {
    let s = t.find((o) => o.id === i.id);
    s || (s = t.find(
      (o) => o.isBuiltIn && o.category === i.category && o.name === i.name
    )), s ? n.push({
      ...s,
      id: i.id
    }) : n.push(i);
  }
  const r = t.filter((i) => !i.isBuiltIn);
  return n.push(...r), n;
}
function mte() {
  const [e, t] = F.useState(c5), [n, r] = F.useState(null), [i, s] = F.useState(null), [o, u] = F.useState(!1), [c, d] = F.useState([...Tm]), [m, p] = F.useState(null), [x, b] = F.useState({}), [S, k] = F.useState({}), [A, T] = F.useState(null), M = F.useCallback(async () => {
    var et;
    const Ie = await pn.getWorldbookStructure();
    b(Ie);
    const Ne = Ba(), Ue = (et = Ne == null ? void 0 : Ne.getCharWorldbookNames) == null ? void 0 : et.call(Ne, "current");
    if (Ue != null && Ue.primary) {
      T(Ue.primary);
      const tt = await M5.loadState(Ue.primary);
      tt.disabledEntries && k(tt.disabledEntries);
    }
  }, []);
  F.useEffect(() => {
    M();
  }, [M]), F.useEffect(() => {
    var Ue;
    const Ie = rt.get("apiSettings");
    if (Ie) {
      const et = c5(), tt = {
        ...et,
        ...Ie,
        // 
        llmPresets: ((Ue = Ie.llmPresets) == null ? void 0 : Ue.length) > 0 ? Ie.llmPresets : et.llmPresets,
        // 
        promptTemplates: hte(
          et.promptTemplates,
          Ie.promptTemplates || []
        )
      };
      t(tt);
    }
    const Ne = rt.getRegexRules();
    Ne && Ne.length > 0 && d(Ne);
  }, []);
  const j = F.useCallback((Ie) => {
    t((Ne) => ({ ...Ne, selectedPresetId: Ie.id })), r(Ie);
  }, []), D = F.useCallback(() => {
    const Ie = jC(` ${e.llmPresets.length + 1}`);
    Ie.isDefault = !1, t((Ne) => ({
      ...Ne,
      llmPresets: [...Ne.llmPresets, Ie],
      selectedPresetId: Ie.id
    })), r(Ie), u(!0);
  }, [e.llmPresets.length]), z = F.useCallback((Ie) => {
    t((Ne) => ({
      ...Ne,
      llmPresets: Ne.llmPresets.map((Ue) => Ue.id === Ie.id ? Ie : Ue)
    })), r(Ie), u(!0);
  }, []), I = F.useCallback((Ie) => {
    const Ne = {
      ...Ie,
      id: `preset_${Date.now()}`,
      name: `${Ie.name} ()`,
      isDefault: !1,
      createdAt: Date.now(),
      updatedAt: Date.now()
    };
    t((Ue) => ({ ...Ue, llmPresets: [...Ue.llmPresets, Ne] })), u(!0);
  }, []), L = F.useCallback((Ie) => {
    Ie.isDefault || (t((Ne) => ({
      ...Ne,
      llmPresets: Ne.llmPresets.filter((Ue) => Ue.id !== Ie.id),
      selectedPresetId: Ne.selectedPresetId === Ie.id ? null : Ne.selectedPresetId
    })), r((Ne) => (Ne == null ? void 0 : Ne.id) === Ie.id ? null : Ne), u(!0));
  }, []), K = F.useCallback((Ie) => {
    s(Ie);
  }, []), ne = F.useCallback((Ie) => {
    t((Ne) => ({
      ...Ne,
      promptTemplates: [...Ne.promptTemplates, Ie]
    })), u(!0);
  }, []), Y = F.useCallback((Ie) => {
    t((Ne) => ({
      ...Ne,
      promptTemplates: Ne.promptTemplates.map((Ue) => Ue.id === Ie.id ? Ie : Ue)
    })), s(Ie), u(!0);
  }, []), H = F.useCallback((Ie) => {
    Ie.isBuiltIn || (t((Ne) => ({
      ...Ne,
      promptTemplates: Ne.promptTemplates.filter((Ue) => Ue.id !== Ie.id)
    })), s((Ne) => (Ne == null ? void 0 : Ne.id) === Ie.id ? null : Ne), u(!0));
  }, []), Z = F.useCallback((Ie) => {
    t((Ne) => ({ ...Ne, vectorConfig: Ie })), u(!0);
  }, []), me = F.useCallback((Ie) => {
    t((Ne) => ({ ...Ne, rerankConfig: Ie })), u(!0);
  }, []), Q = F.useCallback((Ie) => {
    t((Ne) => ({ ...Ne, worldbookConfig: Ie })), u(!0);
  }, []), se = F.useCallback((Ie) => {
    t((Ne) => ({ ...Ne, regexConfig: Ie })), u(!0);
  }, []), J = F.useCallback((Ie, Ne) => {
    t((Ue) => {
      const et = Ue.worldbookConfig.disabledWorldbooks || [];
      let tt;
      return Ne ? tt = [.../* @__PURE__ */ new Set([...et, Ie])] : tt = et.filter((st) => st !== Ie), {
        ...Ue,
        worldbookConfig: {
          ...Ue.worldbookConfig,
          disabledWorldbooks: tt
        }
      };
    }), u(!0);
  }, []), ue = F.useCallback((Ie, Ne, Ue) => {
    k((et) => {
      const tt = et[Ie] || [];
      let st;
      return Ue ? st = [.../* @__PURE__ */ new Set([...tt, Ne])] : st = tt.filter((dt) => dt !== Ne), {
        ...et,
        [Ie]: st
      };
    }), u(!0);
  }, []), de = F.useCallback((Ie) => {
    const Ne = c.find((Ue) => Ue.id === Ie);
    p(Ne || null);
  }, [c]), ce = F.useCallback(() => {
    const Ie = {
      id: `rule_${Date.now()}`,
      name: "",
      pattern: "",
      replacement: "",
      enabled: !0,
      flags: "gi",
      scope: "both",
      description: ""
    };
    d((Ne) => [...Ne, Ie]), p(Ie), u(!0);
  }, []), W = F.useCallback((Ie) => {
    if (!m) return;
    const Ne = { ...m, ...Ie };
    p(Ne), d((Ue) => Ue.map((et) => et.id === Ne.id ? Ne : et)), u(!0);
  }, [m]), $ = F.useCallback((Ie) => {
    d((Ne) => Ne.map(
      (Ue) => Ue.id === Ie ? { ...Ue, enabled: !Ue.enabled } : Ue
    )), u(!0);
  }, []), fe = F.useCallback((Ie) => {
    d((Ne) => Ne.filter((Ue) => Ue.id !== Ie)), p((Ne) => (Ne == null ? void 0 : Ne.id) === Ie ? null : Ne), u(!0);
  }, []), G = F.useCallback(() => {
    d([...Tm]), p(null), u(!0);
  }, []), le = F.useCallback((Ie) => {
    d(Ie), u(!0);
  }, []), xe = F.useCallback(async () => {
    rt.set("apiSettings", e), rt.setRegexRules(c);
    const { regexProcessor: Ie } = await Promise.resolve().then(() => QC);
    Ie.setRules(c), A && await M5.saveState(A, {
      disabledEntries: S
    }), console.log("[Engram] :", e, c, S), u(!1);
  }, [e, c, A, S]), Se = F.useCallback((Ie) => {
    t((Ne) => ({
      ...Ne,
      recallConfig: Ie
    })), u(!0);
  }, []), Oe = F.useCallback(() => {
    const Ie = {
      id: `custom_${Date.now()}`,
      name: "",
      content: "",
      enabled: !0,
      createdAt: Date.now()
    };
    t((Ne) => ({
      ...Ne,
      customMacros: [...Ne.customMacros || [], Ie]
    })), u(!0);
  }, []), Be = F.useCallback((Ie, Ne) => {
    t((Ue) => ({
      ...Ue,
      customMacros: (Ue.customMacros || []).map(
        (et) => et.id === Ie ? { ...et, ...Ne } : et
      )
    })), u(!0);
  }, []), Re = F.useCallback((Ie) => {
    t((Ne) => ({
      ...Ne,
      customMacros: (Ne.customMacros || []).filter((Ue) => Ue.id !== Ie)
    })), u(!0);
  }, []), ft = F.useCallback((Ie) => {
    t((Ne) => ({
      ...Ne,
      customMacros: (Ne.customMacros || []).map(
        (Ue) => Ue.id === Ie ? { ...Ue, enabled: !Ue.enabled } : Ue
      )
    })), u(!0);
  }, []);
  return {
    settings: e,
    editingPreset: n,
    editingTemplate: i,
    hasChanges: o,
    regexRules: c,
    editingRule: m,
    selectPreset: j,
    addPreset: D,
    updatePreset: z,
    copyPreset: I,
    deletePreset: L,
    selectTemplate: K,
    addTemplate: ne,
    updateTemplate: Y,
    deleteTemplate: H,
    updateVectorConfig: Z,
    updateRerankConfig: me,
    updateWorldbookConfig: Q,
    updateRegexConfig: se,
    toggleWorldbook: J,
    toggleEntry: ue,
    refreshWorldbooks: M,
    worldbookStructure: x,
    disabledEntries: S,
    currentCharWorldbook: A,
    updateRecallConfig: Se,
    selectRule: de,
    addRule: ce,
    updateRule: W,
    toggleRule: $,
    deleteRule: fe,
    resetRules: G,
    reorderRules: le,
    // V0.9.2: 
    addCustomMacro: Oe,
    updateCustomMacro: Be,
    deleteCustomMacro: Re,
    toggleCustomMacro: ft,
    save: xe
  };
}
const ST = 768, pte = [
  { id: "llm", label: "LLM ", icon: Xv },
  { id: "vector", label: "", icon: wC },
  { id: "rerank", label: "Rerank", icon: _C }
], gte = ({ initialTab: e }) => {
  var tt;
  const [t, n] = F.useState(e || "model"), [r, i] = F.useState("llm"), [s, o] = F.useState("templates"), [u, c] = F.useState(null), [d, m] = F.useState(window.innerWidth < ST), [p, x] = F.useState(!1);
  F.useEffect(() => {
    const st = () => {
      const dt = window.innerWidth < ST;
      m(dt), dt || x(!1);
    };
    return window.addEventListener("resize", st), () => window.removeEventListener("resize", st);
  }, []);
  const {
    settings: b,
    editingPreset: S,
    editingTemplate: k,
    hasChanges: A,
    regexRules: T,
    editingRule: M,
    selectPreset: j,
    addPreset: D,
    updatePreset: z,
    copyPreset: I,
    deletePreset: L,
    selectTemplate: K,
    addTemplate: ne,
    updateTemplate: Y,
    deleteTemplate: H,
    updateVectorConfig: Z,
    updateRerankConfig: me,
    updateWorldbookConfig: Q,
    updateRegexConfig: se,
    // New!
    selectRule: J,
    addRule: ue,
    updateRule: de,
    toggleRule: ce,
    deleteRule: W,
    resetRules: $,
    reorderRules: fe,
    save: G,
    toggleWorldbook: le,
    toggleEntry: xe,
    refreshWorldbooks: Se,
    worldbookStructure: Oe,
    disabledEntries: Be,
    // V0.9.2: 
    addCustomMacro: Re,
    updateCustomMacro: ft,
    deleteCustomMacro: Ie,
    toggleCustomMacro: Ne
  } = mte(), Ue = (st) => {
    st(), d && x(!0);
  }, et = () => {
    x(!1);
  };
  return d && p && r === "llm" && S ? /* @__PURE__ */ g.jsx(
    A2,
    {
      title: " LLM ",
      onClose: et,
      actions: A && /* @__PURE__ */ g.jsx(
        "button",
        {
          className: "p-2 text-primary",
          onClick: G,
          children: /* @__PURE__ */ g.jsx(Lg, { size: 18 })
        }
      ),
      children: /* @__PURE__ */ g.jsx(i8, { preset: S, onChange: z })
    }
  ) : d && p && t === "prompt" && k ? /* @__PURE__ */ g.jsx(
    A2,
    {
      title: "",
      onClose: et,
      actions: A && /* @__PURE__ */ g.jsx(
        "button",
        {
          className: "p-2 text-primary",
          onClick: G,
          children: /* @__PURE__ */ g.jsx(Lg, { size: 18 })
        }
      ),
      children: /* @__PURE__ */ g.jsx(
        l8,
        {
          template: k,
          llmPresets: b.llmPresets,
          defaultPresetId: b.selectedPresetId,
          onChange: Y
        }
      )
    }
  ) : d && p && t === "regex" && M ? /* @__PURE__ */ g.jsx(
    A2,
    {
      title: "",
      onClose: et,
      actions: A && /* @__PURE__ */ g.jsx(
        "button",
        {
          className: "p-2 text-primary",
          onClick: G,
          children: /* @__PURE__ */ g.jsx(Lg, { size: 18 })
        }
      ),
      children: /* @__PURE__ */ g.jsx(_T, { rule: M, onChange: de })
    }
  ) : /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col h-full animate-in fade-in", children: [
    /* @__PURE__ */ g.jsx(
      RE,
      {
        title: "API ",
        subtitle: "",
        className: "mb-2"
      }
    ),
    /* @__PURE__ */ g.jsx(
      lx,
      {
        tabs: [
          { id: "model", label: "" },
          { id: "prompt", label: "" },
          { id: "regex", label: "" },
          { id: "worldbook", label: "" }
        ],
        activeTab: t,
        onChange: (st) => n(st),
        actions: A && /* @__PURE__ */ g.jsxs(
          "button",
          {
            className: "inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-primary hover:text-primary-foreground hover:bg-primary border border-primary/50 rounded transition-colors",
            onClick: G,
            children: [
              /* @__PURE__ */ g.jsx(Lg, { size: 12 }),
              ""
            ]
          }
        )
      }
    ),
    /* @__PURE__ */ g.jsxs("div", { className: "flex-1 overflow-y-auto no-scrollbar", children: [
      t === "model" && /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col gap-2", children: [
        /* @__PURE__ */ g.jsx(
          cD,
          {
            tabs: pte.map((st) => ({ ...st, icon: /* @__PURE__ */ g.jsx(st.icon, { size: 14 }) })),
            activeTab: r,
            onChange: (st) => i(st),
            sticky: !1,
            top: 0,
            className: "-mx-4 px-4 !mb-4"
          }
        ),
        r === "llm" && /* @__PURE__ */ g.jsxs("div", { className: `flex gap-6 ${d ? "flex-col" : ""}`, children: [
          /* @__PURE__ */ g.jsxs("div", { className: `
                                    flex flex-col gap-4
                                    ${d ? "w-full" : "w-[30%] min-w-[240px] border-r border-border/50 pr-4"}
                                `, children: [
            /* @__PURE__ */ g.jsxs("div", { className: "flex items-center justify-between", children: [
              /* @__PURE__ */ g.jsx("h3", { className: "text-xs font-bold text-muted-foreground uppercase tracking-wider", children: "" }),
              /* @__PURE__ */ g.jsx("button", { className: "text-muted-foreground hover:text-foreground transition-colors", onClick: D, children: /* @__PURE__ */ g.jsx(SC, { size: 16 }) })
            ] }),
            /* @__PURE__ */ g.jsx("div", { className: "flex flex-col gap-1", children: b.llmPresets.map((st) => /* @__PURE__ */ g.jsx(
              fX,
              {
                preset: st,
                isSelected: b.selectedPresetId === st.id,
                onSelect: () => Ue(() => j(st)),
                onEdit: () => Ue(() => j(st)),
                onCopy: () => I(st),
                onDelete: () => L(st)
              },
              st.id
            )) })
          ] }),
          !d && /* @__PURE__ */ g.jsx("div", { className: "flex-1", children: S ? /* @__PURE__ */ g.jsx("div", { className: "animate-in fade-in slide-in-from-right-2 duration-300", children: /* @__PURE__ */ g.jsx(i8, { preset: S, onChange: z }) }) : /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col items-center justify-center p-12 text-muted-foreground gap-4", children: [
            /* @__PURE__ */ g.jsx(Xv, { size: 32, className: "opacity-20" }),
            /* @__PURE__ */ g.jsx("p", { className: "text-sm font-light", children: "" })
          ] }) })
        ] }),
        r === "vector" && /* @__PURE__ */ g.jsx(gX, { config: b.vectorConfig, onChange: Z }),
        r === "rerank" && /* @__PURE__ */ g.jsx(yX, { config: b.rerankConfig, onChange: me })
      ] }),
      t === "prompt" && /* @__PURE__ */ g.jsxs("div", { className: `flex gap-6 h-full ${d ? "flex-col" : ""}`, children: [
        /* @__PURE__ */ g.jsxs("div", { className: `
                            ${d ? "w-full" : "w-[30%] min-w-[280px] border-r border-border/50 pr-4"}
                        `, children: [
          /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-2 mb-4", children: [
            /* @__PURE__ */ g.jsx(
              "button",
              {
                onClick: () => o("templates"),
                className: `text-xs font-bold uppercase tracking-wider transition-colors ${s === "templates" ? "text-primary" : "text-muted-foreground hover:text-foreground"}`,
                children: ""
              }
            ),
            /* @__PURE__ */ g.jsx("span", { className: "text-muted-foreground/30", children: "|" }),
            /* @__PURE__ */ g.jsx(
              "button",
              {
                onClick: () => o("macros"),
                className: `text-xs font-bold uppercase tracking-wider transition-colors ${s === "macros" ? "text-primary" : "text-muted-foreground hover:text-foreground"}`,
                children: ""
              }
            )
          ] }),
          s === "templates" ? /* @__PURE__ */ g.jsx(
            wX,
            {
              templates: b.promptTemplates,
              selectedId: (k == null ? void 0 : k.id) || null,
              onSelect: (st) => Ue(() => K(st)),
              onAdd: ne,
              onUpdate: Y,
              onDelete: H
            }
          ) : /* @__PURE__ */ g.jsx(
            fte,
            {
              macros: b.customMacros || [],
              selectedId: u,
              onSelect: (st) => Ue(() => c(st.id)),
              onAdd: Re,
              onToggle: Ne,
              onDelete: Ie
            }
          )
        ] }),
        !d && s === "templates" && /* @__PURE__ */ g.jsx("div", { className: "flex-1 overflow-y-auto no-scrollbar", children: k ? /* @__PURE__ */ g.jsx(
          l8,
          {
            template: k,
            llmPresets: b.llmPresets,
            defaultPresetId: b.selectedPresetId,
            onChange: Y
          }
        ) : /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col items-center justify-center p-12 text-muted-foreground gap-4", children: [
          /* @__PURE__ */ g.jsx(zm, { size: 32, className: "opacity-20" }),
          /* @__PURE__ */ g.jsx("p", { className: "text-sm font-light", children: "" })
        ] }) }),
        !d && s === "macros" && /* @__PURE__ */ g.jsx("div", { className: "flex-1 overflow-y-auto no-scrollbar", children: (() => {
          const st = (b.customMacros || []).find((dt) => dt.id === u);
          return st ? /* @__PURE__ */ g.jsx(
            dte,
            {
              macro: st,
              onChange: (dt) => ft(st.id, dt)
            }
          ) : /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col items-center justify-center p-12 text-muted-foreground gap-4", children: [
            /* @__PURE__ */ g.jsx(ZM, { size: 32, className: "opacity-20" }),
            /* @__PURE__ */ g.jsx("p", { className: "text-sm font-light", children: "" })
          ] });
        })() })
      ] }),
      t === "regex" && /* @__PURE__ */ g.jsxs("div", { className: `flex gap-6 h-full ${d ? "flex-col" : ""}`, children: [
        /* @__PURE__ */ g.jsx("div", { className: `
                            ${d ? "w-full" : "w-[30%] min-w-[280px] border-r border-border/50 pr-4"}
                        `, children: /* @__PURE__ */ g.jsx(
          lte,
          {
            rules: T,
            selectedId: (M == null ? void 0 : M.id) || null,
            onSelect: (st) => Ue(() => J(st)),
            onToggle: ce,
            onDelete: W,
            onAdd: ue,
            onReset: $,
            onReorder: fe,
            enableNativeRegex: ((tt = b.regexConfig) == null ? void 0 : tt.enableNativeRegex) ?? !0,
            onToggleNativeRegex: (st) => se({
              ...b.regexConfig,
              enableNativeRegex: st
            })
          }
        ) }),
        !d && /* @__PURE__ */ g.jsx("div", { className: "flex-1 overflow-y-auto no-scrollbar", children: M ? /* @__PURE__ */ g.jsx(_T, { rule: M, onChange: de }) : /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col items-center justify-center p-12 text-muted-foreground gap-4", children: [
          /* @__PURE__ */ g.jsx(rR, { size: 32, className: "opacity-20" }),
          /* @__PURE__ */ g.jsx("p", { className: "text-sm font-light", children: "" })
        ] }) })
      ] }),
      t === "worldbook" && /* @__PURE__ */ g.jsx("div", { className: "max-w-2xl py-4", children: /* @__PURE__ */ g.jsx(
        cte,
        {
          config: b.worldbookConfig,
          onChange: Q,
          worldbookStructure: Oe,
          disabledEntries: Be,
          onToggleWorldbook: le,
          onToggleEntry: xe,
          onRefresh: Se
        }
      ) })
    ] })
  ] });
}, yte = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  APIPresets: gte
}, Symbol.toStringTag, { value: "Module" })), vte = () => {
  const [e, t] = F.useState("claudeDark");
  F.useEffect(() => {
    t(zc.getTheme());
  }, []);
  const n = (i) => {
    zc.setTheme(i), rt.set("theme", i), t(i);
  }, r = Object.entries(ev).map(([i, s]) => {
    let o = s.colors.background, u = s.colors.primary;
    return {
      id: i,
      name: s.name,
      background: o,
      sidebar: s.colors.sidebar,
      // Add sidebar color
      primary: u
    };
  });
  return /* @__PURE__ */ g.jsxs("div", { className: "space-y-4", children: [
    /* @__PURE__ */ g.jsx("h3", { className: "text-lg font-medium", children: "" }),
    /* @__PURE__ */ g.jsx("div", { className: "grid grid-cols-2 sm:grid-cols-4 gap-4", children: r.map((i) => /* @__PURE__ */ g.jsxs(
      "button",
      {
        onClick: () => n(i.id),
        className: `
                            relative group flex flex-col items-center gap-2 p-3 rounded-xl border-2 transition-all
                            ${e === i.id ? "border-primary bg-accent/10" : "border-transparent hover:bg-accent/5"}
                        `,
        children: [
          /* @__PURE__ */ g.jsxs("div", { className: "flex items-center justify-center -space-x-3 mb-2", children: [
            /* @__PURE__ */ g.jsx(
              "div",
              {
                className: "w-8 h-8 rounded-full border border-border shadow-sm z-10",
                style: { background: i.background },
                title: "Background"
              }
            ),
            /* @__PURE__ */ g.jsx(
              "div",
              {
                className: "w-8 h-8 rounded-full border border-border shadow-sm z-20",
                style: { background: i.sidebar },
                title: "Sidebar"
              }
            ),
            /* @__PURE__ */ g.jsx(
              "div",
              {
                className: "w-8 h-8 rounded-full border border-border shadow-sm z-30 ring-2 ring-background",
                style: { background: i.primary },
                title: "Primary"
              }
            )
          ] }),
          /* @__PURE__ */ g.jsx("span", { className: `text-sm font-medium ${e === i.id ? "text-primary" : "text-muted-foreground"}`, children: i.name }),
          e === i.id && /* @__PURE__ */ g.jsx("div", { className: "absolute top-2 right-2 w-2 h-2 rounded-full bg-primary" })
        ]
      },
      i.id
    )) })
  ] });
}, xte = () => {
  var u, c, d, m, p, x;
  const [e, t] = F.useState(((u = rt.getSettings().summarizerConfig) == null ? void 0 : u.previewEnabled) ?? !0), [n, r] = F.useState(((c = rt.getSettings().preprocessingConfig) == null ? void 0 : c.preview) ?? f0.preview), [, i] = F.useState({});
  F.useEffect(() => {
    rt.loadSettings();
  }, []);
  const [s, o] = F.useState(rt.getSettings().linkedDeletion);
  return /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col h-full animate-in fade-in", children: [
    /* @__PURE__ */ g.jsx(RE, { title: "", subtitle: "" }),
    /* @__PURE__ */ g.jsxs("div", { className: "p-6 space-y-8", children: [
      /* @__PURE__ */ g.jsxs("section", { children: [
        /* @__PURE__ */ g.jsx("h3", { className: "text-sm font-medium text-muted-foreground uppercase tracking-wider mb-4", children: "" }),
        /* @__PURE__ */ g.jsx(vte, {})
      ] }),
      /* @__PURE__ */ g.jsxs("section", { children: [
        /* @__PURE__ */ g.jsx("h3", { className: "text-sm font-medium text-muted-foreground uppercase tracking-wider mb-4", children: " (Glass Effect)" }),
        /* @__PURE__ */ g.jsxs("div", { className: "bg-muted/30 border border-border rounded-lg p-4 space-y-6", children: [
          /* @__PURE__ */ g.jsxs("div", { className: "flex items-center justify-between gap-3", children: [
            /* @__PURE__ */ g.jsx("div", { className: "flex items-center gap-3 min-w-0 flex-1", children: /* @__PURE__ */ g.jsxs("div", { className: "min-w-0 flex-1", children: [
              /* @__PURE__ */ g.jsx("h4", { className: "font-medium text-foreground truncate", children: "" }),
              /* @__PURE__ */ g.jsx("p", { className: "text-sm text-muted-foreground line-clamp-2", children: "" })
            ] }) }),
            /* @__PURE__ */ g.jsx(
              Zr,
              {
                checked: ((d = rt.getSettings().glassSettings) == null ? void 0 : d.enabled) ?? !0,
                onChange: (b) => {
                  const k = {
                    ...rt.getSettings().glassSettings,
                    enabled: b
                  };
                  rt.set("glassSettings", k), Promise.resolve().then(() => nv).then(({ ThemeManager: A }) => {
                    A.setTheme(A.getTheme());
                  }), i({});
                }
              }
            )
          ] }),
          (((m = rt.getSettings().glassSettings) == null ? void 0 : m.enabled) ?? !0) && /* @__PURE__ */ g.jsxs(g.Fragment, { children: [
            /* @__PURE__ */ g.jsx(
              bi,
              {
                label: " (Opacity)",
                description: "",
                value: ((p = rt.getSettings().glassSettings) == null ? void 0 : p.opacity) ?? 0.8,
                onChange: (b) => {
                  const k = {
                    ...rt.getSettings().glassSettings,
                    opacity: b
                  };
                  rt.set("glassSettings", k), Promise.resolve().then(() => nv).then(({ ThemeManager: A }) => {
                    A.setTheme(A.getTheme());
                  }), i({});
                },
                min: 0,
                max: 1,
                step: 0.05,
                showSlider: !0
              }
            ),
            /* @__PURE__ */ g.jsx(
              bi,
              {
                label: " (Blur)",
                description: " (px)",
                value: ((x = rt.getSettings().glassSettings) == null ? void 0 : x.blur) ?? 10,
                onChange: (b) => {
                  const k = {
                    ...rt.getSettings().glassSettings,
                    blur: b
                  };
                  rt.set("glassSettings", k), Promise.resolve().then(() => nv).then(({ ThemeManager: A }) => {
                    A.setTheme(A.getTheme());
                  }), i({});
                },
                min: 0,
                max: 50,
                step: 1,
                showSlider: !0
              }
            )
          ] })
        ] })
      ] }),
      /* @__PURE__ */ g.jsxs("section", { children: [
        /* @__PURE__ */ g.jsx("h3", { className: "text-sm font-medium text-muted-foreground uppercase tracking-wider mb-4", children: "" }),
        /* @__PURE__ */ g.jsx("div", { className: "bg-muted/30 border border-border rounded-lg p-4", children: /* @__PURE__ */ g.jsxs("div", { className: "flex items-center justify-between gap-3", children: [
          /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-3 min-w-0 flex-1", children: [
            /* @__PURE__ */ g.jsx("div", { className: "p-2 rounded-lg bg-primary/10 text-primary flex-shrink-0", children: /* @__PURE__ */ g.jsx(Ak, { size: 20 }) }),
            /* @__PURE__ */ g.jsxs("div", { className: "min-w-0 flex-1", children: [
              /* @__PURE__ */ g.jsx("h4", { className: "font-medium text-foreground truncate", children: "" }),
              /* @__PURE__ */ g.jsx("p", { className: "text-sm text-muted-foreground line-clamp-2", children: "" })
            ] })
          ] }),
          /* @__PURE__ */ g.jsx(
            Zr,
            {
              checked: e,
              onChange: (b) => {
                t(b), kl.updateConfig({ previewEnabled: b });
              }
            }
          )
        ] }) })
      ] }),
      /* @__PURE__ */ g.jsxs("section", { children: [
        /* @__PURE__ */ g.jsx("h3", { className: "text-sm font-medium text-muted-foreground uppercase tracking-wider mb-4", children: "" }),
        /* @__PURE__ */ g.jsx("div", { className: "bg-muted/30 border border-border rounded-lg p-4", children: /* @__PURE__ */ g.jsxs("div", { className: "flex items-center justify-between gap-3", children: [
          /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-3 min-w-0 flex-1", children: [
            /* @__PURE__ */ g.jsx("div", { className: "p-2 rounded-lg bg-primary/10 text-primary flex-shrink-0", children: /* @__PURE__ */ g.jsx(Ak, { size: 20 }) }),
            /* @__PURE__ */ g.jsxs("div", { className: "min-w-0 flex-1", children: [
              /* @__PURE__ */ g.jsx("h4", { className: "font-medium text-foreground truncate", children: "" }),
              /* @__PURE__ */ g.jsx("p", { className: "text-sm text-muted-foreground line-clamp-2", children: "" })
            ] })
          ] }),
          /* @__PURE__ */ g.jsx(
            Zr,
            {
              checked: n,
              onChange: (b) => {
                r(b);
                const S = Cd.getConfig();
                Cd.saveConfig({ ...S, preview: b });
              }
            }
          )
        ] }) })
      ] }),
      /* @__PURE__ */ g.jsxs("section", { children: [
        /* @__PURE__ */ g.jsx("h3", { className: "text-sm font-medium text-muted-foreground uppercase tracking-wider mb-4", children: "" }),
        /* @__PURE__ */ g.jsxs("div", { className: "bg-muted/30 border border-border rounded-lg p-4 space-y-4", children: [
          /* @__PURE__ */ g.jsxs("div", { className: "flex items-center justify-between gap-3", children: [
            /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-3 min-w-0 flex-1", children: [
              /* @__PURE__ */ g.jsx("div", { className: "p-2 rounded-lg bg-red-500/10 text-red-500 flex-shrink-0", children: /* @__PURE__ */ g.jsx(jo, { size: 20 }) }),
              /* @__PURE__ */ g.jsxs("div", { className: "min-w-0 flex-1", children: [
                /* @__PURE__ */ g.jsx("h4", { className: "font-medium text-foreground truncate", children: "" }),
                /* @__PURE__ */ g.jsx("p", { className: "text-sm text-muted-foreground line-clamp-2", children: "/" })
              ] })
            ] }),
            /* @__PURE__ */ g.jsx(
              Zr,
              {
                checked: s.enabled,
                onChange: (b) => {
                  const S = { ...s, enabled: b };
                  o(S), rt.set("linkedDeletion", S);
                }
              }
            )
          ] }),
          s.enabled && /* @__PURE__ */ g.jsxs("div", { className: "pl-14 space-y-3 border-t border-border pt-3", children: [
            /* @__PURE__ */ g.jsxs("div", { className: "flex items-center justify-between", children: [
              /* @__PURE__ */ g.jsx("span", { className: "text-sm text-muted-foreground", children: "" }),
              /* @__PURE__ */ g.jsx(
                Zr,
                {
                  checked: s.showConfirmation,
                  onChange: (b) => {
                    const S = { ...s, showConfirmation: b };
                    o(S), rt.set("linkedDeletion", S);
                  },
                  className: "scale-90"
                }
              )
            ] }),
            /* @__PURE__ */ g.jsxs("div", { className: "flex items-center justify-between gap-3", children: [
              /* @__PURE__ */ g.jsxs("div", { className: "min-w-0 flex-1", children: [
                /* @__PURE__ */ g.jsx("span", { className: "text-sm text-muted-foreground block truncate", children: " Worldbook" }),
                /* @__PURE__ */ g.jsx("p", { className: "text-xs text-muted-foreground/60 line-clamp-2", children: ":  Worldbook " })
              ] }),
              /* @__PURE__ */ g.jsx(
                Zr,
                {
                  checked: s.deleteChatWorldbook ?? !1,
                  onChange: (b) => {
                    const S = { ...s, deleteChatWorldbook: b };
                    o(S), rt.set("linkedDeletion", S);
                  },
                  className: "scale-90"
                }
              )
            ] })
          ] })
        ] }),
        /* @__PURE__ */ g.jsx(bte, {})
      ] }),
      /* @__PURE__ */ g.jsx("div", { className: "mt-8 pt-8 border-t border-border", children: /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col items-center justify-center text-muted-foreground gap-2 py-8 opacity-50", children: [
        /* @__PURE__ */ g.jsx(vv, { size: 32 }),
        /* @__PURE__ */ g.jsx("p", { className: "text-sm", children: "..." })
      ] }) })
    ] })
  ] });
}, bte = () => {
  const [e, t] = F.useState(rt.getSettings().syncConfig || { enabled: !1, autoSync: !0 }), [n, r] = F.useState("idle"), [i, s] = F.useState(""), [o, u] = F.useState(0), c = (m) => (p) => {
    const x = { ...e, [m]: p };
    t(x), rt.set("syncConfig", x);
  }, d = async () => {
    try {
      r("check"), s("...");
      const { getSTContext: m } = await Promise.resolve().then(() => JF);
      if (!m().chatId) {
        alert(""), r("idle"), s("");
        return;
      }
      const p = m().chatId;
      r("syncing"), s("...");
      const { syncService: x } = await Promise.resolve().then(() => oU), b = await x.autoSync(p);
      switch (u(Date.now()), b) {
        case "downloaded":
          r("success"), s("");
          break;
        case "uploaded":
          r("success"), s("");
          break;
        case "synced":
          r("success"), s("");
          break;
        case "ignored":
          r("idle"), s("");
          break;
        case "error":
        default:
          r("error"), s("");
          break;
      }
      b !== "error" && setTimeout(() => {
        r("idle"), s("");
      }, 3e3);
    } catch (m) {
      console.error(m), r("error"), s("");
    }
  };
  return /* @__PURE__ */ g.jsxs("div", { className: "bg-muted/30 border border-border rounded-lg p-4 mt-4", children: [
    /* @__PURE__ */ g.jsxs("div", { className: "flex items-center justify-between gap-3 mb-4", children: [
      /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-3 min-w-0 flex-1", children: [
        /* @__PURE__ */ g.jsx("div", { className: "p-2 rounded-lg bg-blue-500/10 text-blue-500 flex-shrink-0", children: /* @__PURE__ */ g.jsxs("svg", { width: "20", height: "20", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", children: [
          /* @__PURE__ */ g.jsx("path", { d: "M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8" }),
          /* @__PURE__ */ g.jsx("path", { d: "M3 3v5h5" }),
          /* @__PURE__ */ g.jsx("path", { d: "M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16" }),
          /* @__PURE__ */ g.jsx("path", { d: "M16 16h5v5" })
        ] }) }),
        /* @__PURE__ */ g.jsxs("div", { className: "min-w-0 flex-1", children: [
          /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-2", children: [
            /* @__PURE__ */ g.jsx("h4", { className: "font-medium text-foreground truncate", children: " (Beta)" }),
            n !== "idle" && /* @__PURE__ */ g.jsx("span", { className: `text-xs ${n === "error" ? "text-red-500" : n === "success" ? "text-green-500" : "text-blue-500 animate-pulse"}`, children: i })
          ] }),
          /* @__PURE__ */ g.jsx("p", { className: "text-sm text-muted-foreground line-clamp-2", children: " WebLLM " })
        ] })
      ] }),
      /* @__PURE__ */ g.jsx(
        Zr,
        {
          checked: e.enabled,
          onChange: c("enabled")
        }
      )
    ] }),
    e.enabled && /* @__PURE__ */ g.jsxs("div", { className: "pl-14 space-y-3 border-t border-border pt-3", children: [
      /* @__PURE__ */ g.jsxs("div", { className: "flex items-center justify-between", children: [
        /* @__PURE__ */ g.jsxs("div", { className: "min-w-0 flex-1", children: [
          /* @__PURE__ */ g.jsx("span", { className: "text-sm text-muted-foreground", children: "" }),
          /* @__PURE__ */ g.jsx("p", { className: "text-xs text-muted-foreground/60", children: "3" })
        ] }),
        /* @__PURE__ */ g.jsx(
          Zr,
          {
            checked: e.autoSync,
            onChange: c("autoSync"),
            className: "scale-90"
          }
        )
      ] }),
      /* @__PURE__ */ g.jsxs("div", { className: "flex items-center justify-between", children: [
        /* @__PURE__ */ g.jsxs("div", { className: "min-w-0 flex-1", children: [
          /* @__PURE__ */ g.jsx("span", { className: "text-sm text-muted-foreground", children: "" }),
          /* @__PURE__ */ g.jsx("p", { className: "text-xs text-muted-foreground/60", children: o > 0 ? new Date(o).toLocaleString() : "" })
        ] }),
        /* @__PURE__ */ g.jsx(
          "button",
          {
            onClick: d,
            disabled: n === "syncing",
            className: "px-3 py-1.5 text-xs font-medium rounded-md bg-background border border-border hover:bg-muted transition-colors disabled:opacity-50",
            children: ""
          }
        )
      ] }),
      /* @__PURE__ */ g.jsxs("div", { className: "mt-2 text-xs text-muted-foreground/60 p-2 bg-background/50 rounded", children: [
        /* @__PURE__ */ g.jsx("p", { children: " Beta " }),
        /* @__PURE__ */ g.jsxs("ul", { className: "list-disc pl-4 mt-1 space-y-1", children: [
          /* @__PURE__ */ g.jsx("li", { children: ": `data/default-user/vectors/webllm`" }),
          /* @__PURE__ */ g.jsx("li", { children: '""' }),
          /* @__PURE__ */ g.jsx("li", { children: "" })
        ] })
      ] })
    ] })
  ] });
}, wte = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  Settings: xte
}, Symbol.toStringTag, { value: "Module" }));
function _te({ score: e }) {
  const t = Math.round(e * 5);
  return /* @__PURE__ */ g.jsx("div", { className: "flex gap-0.5", children: [0, 1, 2, 3, 4].map((n) => /* @__PURE__ */ g.jsx(
    "span",
    {
      className: `w-1.5 h-1.5 rounded-full ${n < t ? "bg-primary" : "bg-muted"}`
    },
    n
  )) });
}
function Ste({ isEmbedded: e }) {
  return e ? /* @__PURE__ */ g.jsxs(
    "span",
    {
      className: "inline-flex items-center gap-0.5 px-1.5 py-0.5 bg-primary/10 text-primary rounded text-[10px] font-medium",
      title: "",
      children: [
        /* @__PURE__ */ g.jsx(Ld, { size: 10 }),
        /* @__PURE__ */ g.jsx("span", { children: "" })
      ]
    }
  ) : null;
}
function Cte({ event: e }) {
  const t = e.structured_kv, n = [];
  return t.time_anchor && n.push(t.time_anchor), t.location && n.push(t.location), t.role && t.role.length > 0 && n.push(t.role.join(", ")), n.length === 0 ? null : /* @__PURE__ */ g.jsxs("p", { className: "text-xs text-muted-foreground truncate", children: [
    "(",
    n.join(" | "),
    ")"
  ] });
}
const Ete = ({
  event: e,
  isSelected: t = !1,
  isCompact: n = !1,
  onSelect: r,
  onCheck: i,
  checked: s = !1,
  hasChanges: o = !1
}) => {
  var p;
  const u = e.structured_kv, c = e.summary.split(`
`), d = u.event || ((p = c[0]) == null ? void 0 : p.replace(/:\s*$/, "")) || "", m = c.length > 1 ? c.slice(1).join(" ").trim() : e.summary;
  return n ? /* @__PURE__ */ g.jsxs(
    "div",
    {
      className: `
                    flex items-center gap-3 p-3 cursor-pointer
                    border-b border-border
                    transition-colors duration-150
                    ${t ? "border-l-2 border-l-primary bg-transparent" : "hover:bg-accent/30"}
                `,
      onClick: r,
      children: [
        /* @__PURE__ */ g.jsx(
          "input",
          {
            type: "checkbox",
            checked: s,
            onChange: (x) => {
              x.stopPropagation(), i == null || i(x.target.checked);
            },
            className: "w-4 h-4 rounded border-border accent-primary"
          }
        ),
        /* @__PURE__ */ g.jsxs("div", { className: "flex-1 min-w-0", children: [
          /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-2", children: [
            /* @__PURE__ */ g.jsx("span", { className: "text-xs font-medium text-primary", children: d }),
            e.is_embedded && /* @__PURE__ */ g.jsx(Ld, { size: 10, className: "text-primary" }),
            /* @__PURE__ */ g.jsx("span", { className: "text-xs text-muted-foreground", children: e.significance_score.toFixed(1) })
          ] }),
          /* @__PURE__ */ g.jsxs("p", { className: "text-sm text-foreground truncate mt-1", children: [
            m.substring(0, 50),
            "..."
          ] })
        ] }),
        /* @__PURE__ */ g.jsx(Pm, { size: 16, className: "text-muted-foreground" })
      ]
    }
  ) : /* @__PURE__ */ g.jsxs(
    "div",
    {
      className: `
                p-4 cursor-pointer rounded-lg
                transition-all duration-150
                ${t ? "border border-primary bg-transparent" : "border border-transparent hover:border-border/50"}
            `,
      onClick: r,
      children: [
        /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-3 mb-2", children: [
          /* @__PURE__ */ g.jsx(
            "input",
            {
              type: "checkbox",
              checked: s,
              onChange: (x) => {
                x.stopPropagation(), i == null || i(x.target.checked);
              },
              className: "w-4 h-4 rounded border-border accent-primary"
            }
          ),
          /* @__PURE__ */ g.jsx("span", { className: "text-xs font-medium text-primary", children: d }),
          /* @__PURE__ */ g.jsx(Ste, { isEmbedded: e.is_embedded }),
          o && /* @__PURE__ */ g.jsx("span", { className: "w-2 h-2 rounded-full bg-yellow-500", title: "" }),
          /* @__PURE__ */ g.jsx("div", { className: "flex-1" }),
          /* @__PURE__ */ g.jsx(_te, { score: e.significance_score })
        ] }),
        /* @__PURE__ */ g.jsx(Cte, { event: e }),
        /* @__PURE__ */ g.jsx("p", { className: "text-sm text-foreground mt-1 line-clamp-2", children: m }),
        /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-2 mt-2 text-xs text-muted-foreground", children: [
          /* @__PURE__ */ g.jsxs("span", { children: [
            "Level ",
            e.level
          ] }),
          e.source_range && /* @__PURE__ */ g.jsxs(g.Fragment, { children: [
            /* @__PURE__ */ g.jsx("span", { children: "" }),
            /* @__PURE__ */ g.jsxs("span", { children: [
              ": ",
              e.source_range.start_index,
              "-",
              e.source_range.end_index,
              ""
            ] })
          ] })
        ] })
      ]
    }
  );
}, mm = {
  background: "transparent",
  backgroundColor: "transparent",
  border: "none",
  borderBottom: "1px solid var(--border)",
  borderRadius: 0,
  boxShadow: "none",
  outline: "none",
  padding: "8px 0",
  fontSize: "14px",
  width: "100%",
  color: "var(--foreground, inherit)"
};
({
  ...mm
});
function CT(e) {
  const t = [];
  return e.time_anchor && e.location ? t.push(`${e.time_anchor}${e.location}`) : e.time_anchor ? t.push(`${e.time_anchor}`) : e.location && t.push(`${e.location}`), e.role && e.role.length > 0 && t.push(e.role.join("")), e.event && t.push(e.event), e.logic && e.logic.length > 0 && t.push(`(${e.logic.join("/")})`), t.join(" ");
}
const nC = F.forwardRef(({
  event: e,
  isFullScreen: t = !1,
  onSave: n,
  onDelete: r,
  onClose: i
}, s) => {
  const [o, u] = F.useState(""), [c, d] = F.useState(""), [m, p] = F.useState(""), [x, b] = F.useState(""), [S, k] = F.useState(""), [A, T] = F.useState(""), [M, j] = F.useState(0.5), [D, z] = F.useState(!1), [I, L] = F.useState(null), K = F.useRef(!1), ne = F.useRef(!0), Y = F.useRef(null);
  F.useEffect(() => () => {
    ne.current = !1, Y.current && clearTimeout(Y.current);
  }, []), F.useEffect(() => {
    var ce, W;
    e && e.id !== I && (u(e.summary), d(e.structured_kv.event || ""), p(e.structured_kv.time_anchor || ""), b(e.structured_kv.location || ""), k(((ce = e.structured_kv.role) == null ? void 0 : ce.join(", ")) || ""), T(((W = e.structured_kv.logic) == null ? void 0 : W.join(", ")) || ""), j(e.significance_score), z(!1), L(e.id));
  }, [e, I]);
  const H = () => {
    confirm("") && (r == null || r(e.id));
  }, Z = F.useCallback((ce = {}) => {
    var le;
    if (!e) return;
    const W = {
      eventType: ce.eventType ?? c,
      timeAnchor: ce.timeAnchor ?? m,
      location: ce.location ?? x,
      roleText: ce.roleText ?? S,
      logicText: ce.logicText ?? A,
      score: ce.score ?? M
    }, $ = (xe) => xe.split(",").map((Se) => Se.trim()).filter(Boolean), fe = {
      event: W.eventType,
      time_anchor: W.timeAnchor,
      location: W.location,
      role: $(W.roleText),
      logic: $(W.logicText),
      causality: ((le = e.structured_kv) == null ? void 0 : le.causality) || ""
    }, G = CT(fe);
    n == null || n(e.id, {
      summary: G || o,
      structured_kv: { ...e.structured_kv, ...fe },
      significance_score: W.score
    });
  }, [e, c, m, x, S, A, M, o, n]);
  F.useImperativeHandle(s, () => ({
    save: () => Z(),
    isDirty: () => D
  }), [Z, D]);
  const me = () => {
    K.current = !0;
  }, Q = (ce, W, $) => {
    if (K.current = !1, !ne.current) return;
    const fe = ce.currentTarget.value;
    W(fe), z(!0), Z({ [$]: fe });
  }, se = (ce, W, $) => {
    ce(W), z(!0), K.current || Z({ [$]: W });
  }, J = () => {
    Y.current && clearTimeout(Y.current), Y.current = window.setTimeout(() => {
      ne.current && D && Z();
    }, 50);
  }, ue = (ce) => {
    j(ce), z(!0), Z({ score: ce });
  };
  if (!e)
    return /* @__PURE__ */ g.jsx("div", { className: "flex flex-col items-center justify-center h-full text-muted-foreground gap-2 p-8", children: /* @__PURE__ */ g.jsx("p", { className: "text-sm font-light", children: "" }) });
  const de = /* @__PURE__ */ g.jsxs(g.Fragment, { children: [
    /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col gap-1", children: [
      /* @__PURE__ */ g.jsx("label", { className: "text-xs text-muted-foreground", children: "" }),
      /* @__PURE__ */ g.jsx(
        "input",
        {
          type: "text",
          value: c,
          onChange: (ce) => se(d, ce.target.value, "eventType"),
          onCompositionStart: me,
          onCompositionEnd: (ce) => Q(ce, d, "eventType"),
          onBlur: J,
          style: mm,
          className: "placeholder:text-muted-foreground/40 focus:border-primary transition-colors",
          placeholder: ""
        }
      )
    ] }),
    /* @__PURE__ */ g.jsx(
      wi,
      {
        label: " ()",
        value: CT({
          event: c,
          time_anchor: m,
          location: x,
          role: S.split(",").map((ce) => ce.trim()).filter(Boolean),
          logic: A.split(",").map((ce) => ce.trim()).filter(Boolean)
        }),
        onChange: () => {
        },
        multiline: !0,
        rows: 4,
        readOnly: !0,
        placeholder: "...",
        className: "font-mono text-sm"
      }
    ),
    /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col gap-1", children: [
      /* @__PURE__ */ g.jsx("label", { className: "text-xs text-muted-foreground", children: "" }),
      /* @__PURE__ */ g.jsx(
        "input",
        {
          type: "text",
          value: m,
          onChange: (ce) => se(p, ce.target.value, "timeAnchor"),
          onCompositionStart: me,
          onCompositionEnd: (ce) => Q(ce, p, "timeAnchor"),
          onBlur: J,
          style: mm,
          className: "placeholder:text-muted-foreground/40 focus:border-primary transition-colors",
          placeholder: "102344"
        }
      )
    ] }),
    /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col gap-1", children: [
      /* @__PURE__ */ g.jsx("label", { className: "text-xs text-muted-foreground", children: "" }),
      /* @__PURE__ */ g.jsx(
        "input",
        {
          type: "text",
          value: x,
          onChange: (ce) => se(b, ce.target.value, "location"),
          onCompositionStart: me,
          onCompositionEnd: (ce) => Q(ce, b, "location"),
          onBlur: J,
          style: mm,
          className: "placeholder:text-muted-foreground/40 focus:border-primary transition-colors",
          placeholder: ""
        }
      )
    ] }),
    /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col gap-1", children: [
      /* @__PURE__ */ g.jsx("label", { className: "text-xs text-muted-foreground", children: "" }),
      /* @__PURE__ */ g.jsx(
        "input",
        {
          type: "text",
          value: S,
          onChange: (ce) => se(k, ce.target.value, "roleText"),
          onCompositionStart: me,
          onCompositionEnd: (ce) => Q(ce, k, "roleText"),
          onBlur: J,
          style: mm,
          className: "placeholder:text-muted-foreground/40 focus:border-primary transition-colors",
          placeholder: "{{user}}, "
        }
      )
    ] }),
    /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col gap-1", children: [
      /* @__PURE__ */ g.jsx("label", { className: "text-xs text-muted-foreground", children: "" }),
      /* @__PURE__ */ g.jsx(
        "input",
        {
          type: "text",
          value: A,
          onChange: (ce) => se(T, ce.target.value, "logicText"),
          onCompositionStart: me,
          onCompositionEnd: (ce) => Q(ce, T, "logicText"),
          onBlur: J,
          style: mm,
          className: "placeholder:text-muted-foreground/40 focus:border-primary transition-colors",
          placeholder: ", "
        }
      )
    ] }),
    /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col gap-2", children: [
      /* @__PURE__ */ g.jsxs("div", { className: "flex justify-between items-center", children: [
        /* @__PURE__ */ g.jsx("label", { className: "text-xs text-muted-foreground", children: "" }),
        /* @__PURE__ */ g.jsx("span", { className: "text-xs font-mono text-foreground", children: M.toFixed(2) })
      ] }),
      /* @__PURE__ */ g.jsxs("div", { className: "relative h-4 flex items-center group cursor-pointer", children: [
        /* @__PURE__ */ g.jsx(
          "div",
          {
            className: "absolute inset-x-0 h-[1px]",
            style: { backgroundColor: "var(--border)" }
          }
        ),
        /* @__PURE__ */ g.jsx(
          "div",
          {
            className: "absolute top-1/2 -translate-y-1/2 w-2.5 h-2.5 bg-muted-foreground/80 rounded-full shadow-sm pointer-events-none transition-transform duration-75 ease-out group-hover:scale-125 group-hover:bg-foreground",
            style: { left: `${M * 100}%`, transform: "translate(-50%, -50%)" }
          }
        ),
        /* @__PURE__ */ g.jsx(
          "input",
          {
            type: "range",
            min: "0",
            max: "1",
            step: "0.05",
            value: M,
            onChange: (ce) => ue(parseFloat(ce.target.value)),
            className: "absolute inset-x-0 w-full h-full opacity-0 cursor-pointer z-10 m-0",
            style: { appearance: "none", WebkitAppearance: "none" }
          }
        )
      ] })
    ] }),
    /* @__PURE__ */ g.jsx(Jr, { spacing: "md" }),
    /* @__PURE__ */ g.jsxs("div", { className: "space-y-1 text-xs text-muted-foreground", children: [
      /* @__PURE__ */ g.jsxs("p", { children: [
        "ID: ",
        /* @__PURE__ */ g.jsxs("span", { className: "font-mono", children: [
          e.id.substring(0, 8),
          "..."
        ] })
      ] }),
      /* @__PURE__ */ g.jsxs("p", { children: [
        "Level: ",
        e.level
      ] }),
      e.source_range && /* @__PURE__ */ g.jsxs("p", { children: [
        ": ",
        e.source_range.start_index,
        "-",
        e.source_range.end_index,
        ""
      ] }),
      /* @__PURE__ */ g.jsxs("p", { children: [
        ": ",
        new Date(e.timestamp).toLocaleString()
      ] }),
      /* @__PURE__ */ g.jsxs("p", { children: [
        ":",
        e.is_archived && /* @__PURE__ */ g.jsx("span", { className: "ml-1 text-yellow-500", children: "" }),
        e.is_embedded && /* @__PURE__ */ g.jsx("span", { className: "ml-1 text-green-500", children: "" }),
        !e.is_archived && !e.is_embedded && /* @__PURE__ */ g.jsx("span", { className: "ml-1", children: "" })
      ] })
    ] })
  ] });
  return t ? /* @__PURE__ */ g.jsxs("div", { className: "fixed inset-0 bg-background z-50 flex flex-col", style: { height: "100dvh" }, children: [
    /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-3 px-4 py-3 border-b border-border shrink-0", children: [
      /* @__PURE__ */ g.jsx(
        "button",
        {
          onClick: i,
          className: "p-1 hover:bg-accent rounded",
          children: /* @__PURE__ */ g.jsx(vC, { size: 20 })
        }
      ),
      /* @__PURE__ */ g.jsx("h2", { className: "text-lg font-light flex-1", children: "" }),
      /* @__PURE__ */ g.jsx(
        "button",
        {
          onClick: H,
          className: "p-2 text-destructive hover:bg-destructive/10 rounded",
          children: /* @__PURE__ */ g.jsx(jo, { size: 18 })
        }
      )
    ] }),
    /* @__PURE__ */ g.jsx("div", { className: "flex-1 overflow-y-auto p-4 space-y-4", children: de }),
    /* @__PURE__ */ g.jsx("div", { className: "p-4 border-t border-border shrink-0", children: /* @__PURE__ */ g.jsx(
      "button",
      {
        onClick: i,
        className: "w-full py-2 text-sm border border-border rounded-md hover:bg-accent",
        children: ""
      }
    ) })
  ] }) : /* @__PURE__ */ g.jsxs("div", { className: "h-full flex flex-col", children: [
    /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-2 pb-4 border-b border-border shrink-0", children: [
      /* @__PURE__ */ g.jsx("h3", { className: "text-sm font-medium text-primary flex-1", children: "" }),
      /* @__PURE__ */ g.jsx(
        "button",
        {
          onClick: H,
          className: "p-1.5 text-destructive hover:bg-destructive/10 rounded",
          title: "",
          children: /* @__PURE__ */ g.jsx(jo, { size: 16 })
        }
      )
    ] }),
    /* @__PURE__ */ g.jsx("div", { className: "flex-1 overflow-y-auto py-4 space-y-4 no-scrollbar", children: de })
  ] });
});
nC.displayName = "EventEditor";
function Lr(e) {
  if (typeof e == "string" || typeof e == "number") return "" + e;
  let t = "";
  if (Array.isArray(e))
    for (let n = 0, r; n < e.length; n++)
      (r = Lr(e[n])) !== "" && (t += (t && " ") + r);
  else
    for (let n in e)
      e[n] && (t += (t && " ") + n);
  return t;
}
var kte = { value: () => {
} };
function dx() {
  for (var e = 0, t = arguments.length, n = {}, r; e < t; ++e) {
    if (!(r = arguments[e] + "") || r in n || /[\s.]/.test(r)) throw new Error("illegal type: " + r);
    n[r] = [];
  }
  return new fv(n);
}
function fv(e) {
  this._ = e;
}
function Tte(e, t) {
  return e.trim().split(/^|\s+/).map(function(n) {
    var r = "", i = n.indexOf(".");
    if (i >= 0 && (r = n.slice(i + 1), n = n.slice(0, i)), n && !t.hasOwnProperty(n)) throw new Error("unknown type: " + n);
    return { type: n, name: r };
  });
}
fv.prototype = dx.prototype = {
  constructor: fv,
  on: function(e, t) {
    var n = this._, r = Tte(e + "", n), i, s = -1, o = r.length;
    if (arguments.length < 2) {
      for (; ++s < o; ) if ((i = (e = r[s]).type) && (i = Nte(n[i], e.name))) return i;
      return;
    }
    if (t != null && typeof t != "function") throw new Error("invalid callback: " + t);
    for (; ++s < o; )
      if (i = (e = r[s]).type) n[i] = ET(n[i], e.name, t);
      else if (t == null) for (i in n) n[i] = ET(n[i], e.name, null);
    return this;
  },
  copy: function() {
    var e = {}, t = this._;
    for (var n in t) e[n] = t[n].slice();
    return new fv(e);
  },
  call: function(e, t) {
    if ((i = arguments.length - 2) > 0) for (var n = new Array(i), r = 0, i, s; r < i; ++r) n[r] = arguments[r + 2];
    if (!this._.hasOwnProperty(e)) throw new Error("unknown type: " + e);
    for (s = this._[e], r = 0, i = s.length; r < i; ++r) s[r].value.apply(t, n);
  },
  apply: function(e, t, n) {
    if (!this._.hasOwnProperty(e)) throw new Error("unknown type: " + e);
    for (var r = this._[e], i = 0, s = r.length; i < s; ++i) r[i].value.apply(t, n);
  }
};
function Nte(e, t) {
  for (var n = 0, r = e.length, i; n < r; ++n)
    if ((i = e[n]).name === t)
      return i.value;
}
function ET(e, t, n) {
  for (var r = 0, i = e.length; r < i; ++r)
    if (e[r].name === t) {
      e[r] = kte, e = e.slice(0, r).concat(e.slice(r + 1));
      break;
    }
  return n != null && e.push({ name: t, value: n }), e;
}
var rC = "http://www.w3.org/1999/xhtml";
const kT = {
  svg: "http://www.w3.org/2000/svg",
  xhtml: rC,
  xlink: "http://www.w3.org/1999/xlink",
  xml: "http://www.w3.org/XML/1998/namespace",
  xmlns: "http://www.w3.org/2000/xmlns/"
};
function hx(e) {
  var t = e += "", n = t.indexOf(":");
  return n >= 0 && (t = e.slice(0, n)) !== "xmlns" && (e = e.slice(n + 1)), kT.hasOwnProperty(t) ? { space: kT[t], local: e } : e;
}
function Ate(e) {
  return function() {
    var t = this.ownerDocument, n = this.namespaceURI;
    return n === rC && t.documentElement.namespaceURI === rC ? t.createElement(e) : t.createElementNS(n, e);
  };
}
function jte(e) {
  return function() {
    return this.ownerDocument.createElementNS(e.space, e.local);
  };
}
function WI(e) {
  var t = hx(e);
  return (t.local ? jte : Ate)(t);
}
function Mte() {
}
function OE(e) {
  return e == null ? Mte : function() {
    return this.querySelector(e);
  };
}
function Rte(e) {
  typeof e != "function" && (e = OE(e));
  for (var t = this._groups, n = t.length, r = new Array(n), i = 0; i < n; ++i)
    for (var s = t[i], o = s.length, u = r[i] = new Array(o), c, d, m = 0; m < o; ++m)
      (c = s[m]) && (d = e.call(c, c.__data__, m, s)) && ("__data__" in c && (d.__data__ = c.__data__), u[m] = d);
  return new ps(r, this._parents);
}
function Ote(e) {
  return e == null ? [] : Array.isArray(e) ? e : Array.from(e);
}
function Dte() {
  return [];
}
function XI(e) {
  return e == null ? Dte : function() {
    return this.querySelectorAll(e);
  };
}
function Ite(e) {
  return function() {
    return Ote(e.apply(this, arguments));
  };
}
function Pte(e) {
  typeof e == "function" ? e = Ite(e) : e = XI(e);
  for (var t = this._groups, n = t.length, r = [], i = [], s = 0; s < n; ++s)
    for (var o = t[s], u = o.length, c, d = 0; d < u; ++d)
      (c = o[d]) && (r.push(e.call(c, c.__data__, d, o)), i.push(c));
  return new ps(r, i);
}
function QI(e) {
  return function() {
    return this.matches(e);
  };
}
function ZI(e) {
  return function(t) {
    return t.matches(e);
  };
}
var zte = Array.prototype.find;
function Lte(e) {
  return function() {
    return zte.call(this.children, e);
  };
}
function Bte() {
  return this.firstElementChild;
}
function qte(e) {
  return this.select(e == null ? Bte : Lte(typeof e == "function" ? e : ZI(e)));
}
var Fte = Array.prototype.filter;
function Ute() {
  return Array.from(this.children);
}
function $te(e) {
  return function() {
    return Fte.call(this.children, e);
  };
}
function Vte(e) {
  return this.selectAll(e == null ? Ute : $te(typeof e == "function" ? e : ZI(e)));
}
function Hte(e) {
  typeof e != "function" && (e = QI(e));
  for (var t = this._groups, n = t.length, r = new Array(n), i = 0; i < n; ++i)
    for (var s = t[i], o = s.length, u = r[i] = [], c, d = 0; d < o; ++d)
      (c = s[d]) && e.call(c, c.__data__, d, s) && u.push(c);
  return new ps(r, this._parents);
}
function JI(e) {
  return new Array(e.length);
}
function Gte() {
  return new ps(this._enter || this._groups.map(JI), this._parents);
}
function Iv(e, t) {
  this.ownerDocument = e.ownerDocument, this.namespaceURI = e.namespaceURI, this._next = null, this._parent = e, this.__data__ = t;
}
Iv.prototype = {
  constructor: Iv,
  appendChild: function(e) {
    return this._parent.insertBefore(e, this._next);
  },
  insertBefore: function(e, t) {
    return this._parent.insertBefore(e, t);
  },
  querySelector: function(e) {
    return this._parent.querySelector(e);
  },
  querySelectorAll: function(e) {
    return this._parent.querySelectorAll(e);
  }
};
function Kte(e) {
  return function() {
    return e;
  };
}
function Yte(e, t, n, r, i, s) {
  for (var o = 0, u, c = t.length, d = s.length; o < d; ++o)
    (u = t[o]) ? (u.__data__ = s[o], r[o] = u) : n[o] = new Iv(e, s[o]);
  for (; o < c; ++o)
    (u = t[o]) && (i[o] = u);
}
function Wte(e, t, n, r, i, s, o) {
  var u, c, d = /* @__PURE__ */ new Map(), m = t.length, p = s.length, x = new Array(m), b;
  for (u = 0; u < m; ++u)
    (c = t[u]) && (x[u] = b = o.call(c, c.__data__, u, t) + "", d.has(b) ? i[u] = c : d.set(b, c));
  for (u = 0; u < p; ++u)
    b = o.call(e, s[u], u, s) + "", (c = d.get(b)) ? (r[u] = c, c.__data__ = s[u], d.delete(b)) : n[u] = new Iv(e, s[u]);
  for (u = 0; u < m; ++u)
    (c = t[u]) && d.get(x[u]) === c && (i[u] = c);
}
function Xte(e) {
  return e.__data__;
}
function Qte(e, t) {
  if (!arguments.length) return Array.from(this, Xte);
  var n = t ? Wte : Yte, r = this._parents, i = this._groups;
  typeof e != "function" && (e = Kte(e));
  for (var s = i.length, o = new Array(s), u = new Array(s), c = new Array(s), d = 0; d < s; ++d) {
    var m = r[d], p = i[d], x = p.length, b = Zte(e.call(m, m && m.__data__, d, r)), S = b.length, k = u[d] = new Array(S), A = o[d] = new Array(S), T = c[d] = new Array(x);
    n(m, p, k, A, T, b, t);
    for (var M = 0, j = 0, D, z; M < S; ++M)
      if (D = k[M]) {
        for (M >= j && (j = M + 1); !(z = A[j]) && ++j < S; ) ;
        D._next = z || null;
      }
  }
  return o = new ps(o, r), o._enter = u, o._exit = c, o;
}
function Zte(e) {
  return typeof e == "object" && "length" in e ? e : Array.from(e);
}
function Jte() {
  return new ps(this._exit || this._groups.map(JI), this._parents);
}
function ene(e, t, n) {
  var r = this.enter(), i = this, s = this.exit();
  return typeof e == "function" ? (r = e(r), r && (r = r.selection())) : r = r.append(e + ""), t != null && (i = t(i), i && (i = i.selection())), n == null ? s.remove() : n(s), r && i ? r.merge(i).order() : i;
}
function tne(e) {
  for (var t = e.selection ? e.selection() : e, n = this._groups, r = t._groups, i = n.length, s = r.length, o = Math.min(i, s), u = new Array(i), c = 0; c < o; ++c)
    for (var d = n[c], m = r[c], p = d.length, x = u[c] = new Array(p), b, S = 0; S < p; ++S)
      (b = d[S] || m[S]) && (x[S] = b);
  for (; c < i; ++c)
    u[c] = n[c];
  return new ps(u, this._parents);
}
function nne() {
  for (var e = this._groups, t = -1, n = e.length; ++t < n; )
    for (var r = e[t], i = r.length - 1, s = r[i], o; --i >= 0; )
      (o = r[i]) && (s && o.compareDocumentPosition(s) ^ 4 && s.parentNode.insertBefore(o, s), s = o);
  return this;
}
function rne(e) {
  e || (e = ine);
  function t(p, x) {
    return p && x ? e(p.__data__, x.__data__) : !p - !x;
  }
  for (var n = this._groups, r = n.length, i = new Array(r), s = 0; s < r; ++s) {
    for (var o = n[s], u = o.length, c = i[s] = new Array(u), d, m = 0; m < u; ++m)
      (d = o[m]) && (c[m] = d);
    c.sort(t);
  }
  return new ps(i, this._parents).order();
}
function ine(e, t) {
  return e < t ? -1 : e > t ? 1 : e >= t ? 0 : NaN;
}
function ane() {
  var e = arguments[0];
  return arguments[0] = this, e.apply(null, arguments), this;
}
function sne() {
  return Array.from(this);
}
function one() {
  for (var e = this._groups, t = 0, n = e.length; t < n; ++t)
    for (var r = e[t], i = 0, s = r.length; i < s; ++i) {
      var o = r[i];
      if (o) return o;
    }
  return null;
}
function lne() {
  let e = 0;
  for (const t of this) ++e;
  return e;
}
function une() {
  return !this.node();
}
function cne(e) {
  for (var t = this._groups, n = 0, r = t.length; n < r; ++n)
    for (var i = t[n], s = 0, o = i.length, u; s < o; ++s)
      (u = i[s]) && e.call(u, u.__data__, s, i);
  return this;
}
function fne(e) {
  return function() {
    this.removeAttribute(e);
  };
}
function dne(e) {
  return function() {
    this.removeAttributeNS(e.space, e.local);
  };
}
function hne(e, t) {
  return function() {
    this.setAttribute(e, t);
  };
}
function mne(e, t) {
  return function() {
    this.setAttributeNS(e.space, e.local, t);
  };
}
function pne(e, t) {
  return function() {
    var n = t.apply(this, arguments);
    n == null ? this.removeAttribute(e) : this.setAttribute(e, n);
  };
}
function gne(e, t) {
  return function() {
    var n = t.apply(this, arguments);
    n == null ? this.removeAttributeNS(e.space, e.local) : this.setAttributeNS(e.space, e.local, n);
  };
}
function yne(e, t) {
  var n = hx(e);
  if (arguments.length < 2) {
    var r = this.node();
    return n.local ? r.getAttributeNS(n.space, n.local) : r.getAttribute(n);
  }
  return this.each((t == null ? n.local ? dne : fne : typeof t == "function" ? n.local ? gne : pne : n.local ? mne : hne)(n, t));
}
function eP(e) {
  return e.ownerDocument && e.ownerDocument.defaultView || e.document && e || e.defaultView;
}
function vne(e) {
  return function() {
    this.style.removeProperty(e);
  };
}
function xne(e, t, n) {
  return function() {
    this.style.setProperty(e, t, n);
  };
}
function bne(e, t, n) {
  return function() {
    var r = t.apply(this, arguments);
    r == null ? this.style.removeProperty(e) : this.style.setProperty(e, r, n);
  };
}
function wne(e, t, n) {
  return arguments.length > 1 ? this.each((t == null ? vne : typeof t == "function" ? bne : xne)(e, t, n ?? "")) : Am(this.node(), e);
}
function Am(e, t) {
  return e.style.getPropertyValue(t) || eP(e).getComputedStyle(e, null).getPropertyValue(t);
}
function _ne(e) {
  return function() {
    delete this[e];
  };
}
function Sne(e, t) {
  return function() {
    this[e] = t;
  };
}
function Cne(e, t) {
  return function() {
    var n = t.apply(this, arguments);
    n == null ? delete this[e] : this[e] = n;
  };
}
function Ene(e, t) {
  return arguments.length > 1 ? this.each((t == null ? _ne : typeof t == "function" ? Cne : Sne)(e, t)) : this.node()[e];
}
function tP(e) {
  return e.trim().split(/^|\s+/);
}
function DE(e) {
  return e.classList || new nP(e);
}
function nP(e) {
  this._node = e, this._names = tP(e.getAttribute("class") || "");
}
nP.prototype = {
  add: function(e) {
    var t = this._names.indexOf(e);
    t < 0 && (this._names.push(e), this._node.setAttribute("class", this._names.join(" ")));
  },
  remove: function(e) {
    var t = this._names.indexOf(e);
    t >= 0 && (this._names.splice(t, 1), this._node.setAttribute("class", this._names.join(" ")));
  },
  contains: function(e) {
    return this._names.indexOf(e) >= 0;
  }
};
function rP(e, t) {
  for (var n = DE(e), r = -1, i = t.length; ++r < i; ) n.add(t[r]);
}
function iP(e, t) {
  for (var n = DE(e), r = -1, i = t.length; ++r < i; ) n.remove(t[r]);
}
function kne(e) {
  return function() {
    rP(this, e);
  };
}
function Tne(e) {
  return function() {
    iP(this, e);
  };
}
function Nne(e, t) {
  return function() {
    (t.apply(this, arguments) ? rP : iP)(this, e);
  };
}
function Ane(e, t) {
  var n = tP(e + "");
  if (arguments.length < 2) {
    for (var r = DE(this.node()), i = -1, s = n.length; ++i < s; ) if (!r.contains(n[i])) return !1;
    return !0;
  }
  return this.each((typeof t == "function" ? Nne : t ? kne : Tne)(n, t));
}
function jne() {
  this.textContent = "";
}
function Mne(e) {
  return function() {
    this.textContent = e;
  };
}
function Rne(e) {
  return function() {
    var t = e.apply(this, arguments);
    this.textContent = t ?? "";
  };
}
function One(e) {
  return arguments.length ? this.each(e == null ? jne : (typeof e == "function" ? Rne : Mne)(e)) : this.node().textContent;
}
function Dne() {
  this.innerHTML = "";
}
function Ine(e) {
  return function() {
    this.innerHTML = e;
  };
}
function Pne(e) {
  return function() {
    var t = e.apply(this, arguments);
    this.innerHTML = t ?? "";
  };
}
function zne(e) {
  return arguments.length ? this.each(e == null ? Dne : (typeof e == "function" ? Pne : Ine)(e)) : this.node().innerHTML;
}
function Lne() {
  this.nextSibling && this.parentNode.appendChild(this);
}
function Bne() {
  return this.each(Lne);
}
function qne() {
  this.previousSibling && this.parentNode.insertBefore(this, this.parentNode.firstChild);
}
function Fne() {
  return this.each(qne);
}
function Une(e) {
  var t = typeof e == "function" ? e : WI(e);
  return this.select(function() {
    return this.appendChild(t.apply(this, arguments));
  });
}
function $ne() {
  return null;
}
function Vne(e, t) {
  var n = typeof e == "function" ? e : WI(e), r = t == null ? $ne : typeof t == "function" ? t : OE(t);
  return this.select(function() {
    return this.insertBefore(n.apply(this, arguments), r.apply(this, arguments) || null);
  });
}
function Hne() {
  var e = this.parentNode;
  e && e.removeChild(this);
}
function Gne() {
  return this.each(Hne);
}
function Kne() {
  var e = this.cloneNode(!1), t = this.parentNode;
  return t ? t.insertBefore(e, this.nextSibling) : e;
}
function Yne() {
  var e = this.cloneNode(!0), t = this.parentNode;
  return t ? t.insertBefore(e, this.nextSibling) : e;
}
function Wne(e) {
  return this.select(e ? Yne : Kne);
}
function Xne(e) {
  return arguments.length ? this.property("__data__", e) : this.node().__data__;
}
function Qne(e) {
  return function(t) {
    e.call(this, t, this.__data__);
  };
}
function Zne(e) {
  return e.trim().split(/^|\s+/).map(function(t) {
    var n = "", r = t.indexOf(".");
    return r >= 0 && (n = t.slice(r + 1), t = t.slice(0, r)), { type: t, name: n };
  });
}
function Jne(e) {
  return function() {
    var t = this.__on;
    if (t) {
      for (var n = 0, r = -1, i = t.length, s; n < i; ++n)
        s = t[n], (!e.type || s.type === e.type) && s.name === e.name ? this.removeEventListener(s.type, s.listener, s.options) : t[++r] = s;
      ++r ? t.length = r : delete this.__on;
    }
  };
}
function ere(e, t, n) {
  return function() {
    var r = this.__on, i, s = Qne(t);
    if (r) {
      for (var o = 0, u = r.length; o < u; ++o)
        if ((i = r[o]).type === e.type && i.name === e.name) {
          this.removeEventListener(i.type, i.listener, i.options), this.addEventListener(i.type, i.listener = s, i.options = n), i.value = t;
          return;
        }
    }
    this.addEventListener(e.type, s, n), i = { type: e.type, name: e.name, value: t, listener: s, options: n }, r ? r.push(i) : this.__on = [i];
  };
}
function tre(e, t, n) {
  var r = Zne(e + ""), i, s = r.length, o;
  if (arguments.length < 2) {
    var u = this.node().__on;
    if (u) {
      for (var c = 0, d = u.length, m; c < d; ++c)
        for (i = 0, m = u[c]; i < s; ++i)
          if ((o = r[i]).type === m.type && o.name === m.name)
            return m.value;
    }
    return;
  }
  for (u = t ? ere : Jne, i = 0; i < s; ++i) this.each(u(r[i], t, n));
  return this;
}
function aP(e, t, n) {
  var r = eP(e), i = r.CustomEvent;
  typeof i == "function" ? i = new i(t, n) : (i = r.document.createEvent("Event"), n ? (i.initEvent(t, n.bubbles, n.cancelable), i.detail = n.detail) : i.initEvent(t, !1, !1)), e.dispatchEvent(i);
}
function nre(e, t) {
  return function() {
    return aP(this, e, t);
  };
}
function rre(e, t) {
  return function() {
    return aP(this, e, t.apply(this, arguments));
  };
}
function ire(e, t) {
  return this.each((typeof t == "function" ? rre : nre)(e, t));
}
function* are() {
  for (var e = this._groups, t = 0, n = e.length; t < n; ++t)
    for (var r = e[t], i = 0, s = r.length, o; i < s; ++i)
      (o = r[i]) && (yield o);
}
var sP = [null];
function ps(e, t) {
  this._groups = e, this._parents = t;
}
function B0() {
  return new ps([[document.documentElement]], sP);
}
function sre() {
  return this;
}
ps.prototype = B0.prototype = {
  constructor: ps,
  select: Rte,
  selectAll: Pte,
  selectChild: qte,
  selectChildren: Vte,
  filter: Hte,
  data: Qte,
  enter: Gte,
  exit: Jte,
  join: ene,
  merge: tne,
  selection: sre,
  order: nne,
  sort: rne,
  call: ane,
  nodes: sne,
  node: one,
  size: lne,
  empty: une,
  each: cne,
  attr: yne,
  style: wne,
  property: Ene,
  classed: Ane,
  text: One,
  html: zne,
  raise: Bne,
  lower: Fne,
  append: Une,
  insert: Vne,
  remove: Gne,
  clone: Wne,
  datum: Xne,
  on: tre,
  dispatch: ire,
  [Symbol.iterator]: are
};
function hs(e) {
  return typeof e == "string" ? new ps([[document.querySelector(e)]], [document.documentElement]) : new ps([[e]], sP);
}
function ore(e) {
  let t;
  for (; t = e.sourceEvent; ) e = t;
  return e;
}
function _o(e, t) {
  if (e = ore(e), t === void 0 && (t = e.currentTarget), t) {
    var n = t.ownerSVGElement || t;
    if (n.createSVGPoint) {
      var r = n.createSVGPoint();
      return r.x = e.clientX, r.y = e.clientY, r = r.matrixTransform(t.getScreenCTM().inverse()), [r.x, r.y];
    }
    if (t.getBoundingClientRect) {
      var i = t.getBoundingClientRect();
      return [e.clientX - i.left - t.clientLeft, e.clientY - i.top - t.clientTop];
    }
  }
  return [e.pageX, e.pageY];
}
const lre = { passive: !1 }, y0 = { capture: !0, passive: !1 };
function j2(e) {
  e.stopImmediatePropagation();
}
function Cm(e) {
  e.preventDefault(), e.stopImmediatePropagation();
}
function oP(e) {
  var t = e.document.documentElement, n = hs(e).on("dragstart.drag", Cm, y0);
  "onselectstart" in t ? n.on("selectstart.drag", Cm, y0) : (t.__noselect = t.style.MozUserSelect, t.style.MozUserSelect = "none");
}
function lP(e, t) {
  var n = e.document.documentElement, r = hs(e).on("dragstart.drag", null);
  t && (r.on("click.drag", Cm, y0), setTimeout(function() {
    r.on("click.drag", null);
  }, 0)), "onselectstart" in n ? r.on("selectstart.drag", null) : (n.style.MozUserSelect = n.__noselect, delete n.__noselect);
}
const H1 = (e) => () => e;
function iC(e, {
  sourceEvent: t,
  subject: n,
  target: r,
  identifier: i,
  active: s,
  x: o,
  y: u,
  dx: c,
  dy: d,
  dispatch: m
}) {
  Object.defineProperties(this, {
    type: { value: e, enumerable: !0, configurable: !0 },
    sourceEvent: { value: t, enumerable: !0, configurable: !0 },
    subject: { value: n, enumerable: !0, configurable: !0 },
    target: { value: r, enumerable: !0, configurable: !0 },
    identifier: { value: i, enumerable: !0, configurable: !0 },
    active: { value: s, enumerable: !0, configurable: !0 },
    x: { value: o, enumerable: !0, configurable: !0 },
    y: { value: u, enumerable: !0, configurable: !0 },
    dx: { value: c, enumerable: !0, configurable: !0 },
    dy: { value: d, enumerable: !0, configurable: !0 },
    _: { value: m }
  });
}
iC.prototype.on = function() {
  var e = this._.on.apply(this._, arguments);
  return e === this._ ? this : e;
};
function ure(e) {
  return !e.ctrlKey && !e.button;
}
function cre() {
  return this.parentNode;
}
function fre(e, t) {
  return t ?? { x: e.x, y: e.y };
}
function dre() {
  return navigator.maxTouchPoints || "ontouchstart" in this;
}
function uP() {
  var e = ure, t = cre, n = fre, r = dre, i = {}, s = dx("start", "drag", "end"), o = 0, u, c, d, m, p = 0;
  function x(D) {
    D.on("mousedown.drag", b).filter(r).on("touchstart.drag", A).on("touchmove.drag", T, lre).on("touchend.drag touchcancel.drag", M).style("touch-action", "none").style("-webkit-tap-highlight-color", "rgba(0,0,0,0)");
  }
  function b(D, z) {
    if (!(m || !e.call(this, D, z))) {
      var I = j(this, t.call(this, D, z), D, z, "mouse");
      I && (hs(D.view).on("mousemove.drag", S, y0).on("mouseup.drag", k, y0), oP(D.view), j2(D), d = !1, u = D.clientX, c = D.clientY, I("start", D));
    }
  }
  function S(D) {
    if (Cm(D), !d) {
      var z = D.clientX - u, I = D.clientY - c;
      d = z * z + I * I > p;
    }
    i.mouse("drag", D);
  }
  function k(D) {
    hs(D.view).on("mousemove.drag mouseup.drag", null), lP(D.view, d), Cm(D), i.mouse("end", D);
  }
  function A(D, z) {
    if (e.call(this, D, z)) {
      var I = D.changedTouches, L = t.call(this, D, z), K = I.length, ne, Y;
      for (ne = 0; ne < K; ++ne)
        (Y = j(this, L, D, z, I[ne].identifier, I[ne])) && (j2(D), Y("start", D, I[ne]));
    }
  }
  function T(D) {
    var z = D.changedTouches, I = z.length, L, K;
    for (L = 0; L < I; ++L)
      (K = i[z[L].identifier]) && (Cm(D), K("drag", D, z[L]));
  }
  function M(D) {
    var z = D.changedTouches, I = z.length, L, K;
    for (m && clearTimeout(m), m = setTimeout(function() {
      m = null;
    }, 500), L = 0; L < I; ++L)
      (K = i[z[L].identifier]) && (j2(D), K("end", D, z[L]));
  }
  function j(D, z, I, L, K, ne) {
    var Y = s.copy(), H = _o(ne || I, z), Z, me, Q;
    if ((Q = n.call(D, new iC("beforestart", {
      sourceEvent: I,
      target: x,
      identifier: K,
      active: o,
      x: H[0],
      y: H[1],
      dx: 0,
      dy: 0,
      dispatch: Y
    }), L)) != null)
      return Z = Q.x - H[0] || 0, me = Q.y - H[1] || 0, function se(J, ue, de) {
        var ce = H, W;
        switch (J) {
          case "start":
            i[K] = se, W = o++;
            break;
          case "end":
            delete i[K], --o;
          // falls through
          case "drag":
            H = _o(de || ue, z), W = o;
            break;
        }
        Y.call(
          J,
          D,
          new iC(J, {
            sourceEvent: ue,
            subject: Q,
            target: x,
            identifier: K,
            active: W,
            x: H[0] + Z,
            y: H[1] + me,
            dx: H[0] - ce[0],
            dy: H[1] - ce[1],
            dispatch: Y
          }),
          L
        );
      };
  }
  return x.filter = function(D) {
    return arguments.length ? (e = typeof D == "function" ? D : H1(!!D), x) : e;
  }, x.container = function(D) {
    return arguments.length ? (t = typeof D == "function" ? D : H1(D), x) : t;
  }, x.subject = function(D) {
    return arguments.length ? (n = typeof D == "function" ? D : H1(D), x) : n;
  }, x.touchable = function(D) {
    return arguments.length ? (r = typeof D == "function" ? D : H1(!!D), x) : r;
  }, x.on = function() {
    var D = s.on.apply(s, arguments);
    return D === s ? x : D;
  }, x.clickDistance = function(D) {
    return arguments.length ? (p = (D = +D) * D, x) : Math.sqrt(p);
  }, x;
}
function IE(e, t, n) {
  e.prototype = t.prototype = n, n.constructor = e;
}
function cP(e, t) {
  var n = Object.create(e.prototype);
  for (var r in t) n[r] = t[r];
  return n;
}
function q0() {
}
var v0 = 0.7, Pv = 1 / v0, Em = "\\s*([+-]?\\d+)\\s*", x0 = "\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*", Rl = "\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*", hre = /^#([0-9a-f]{3,8})$/, mre = new RegExp(`^rgb\\(${Em},${Em},${Em}\\)$`), pre = new RegExp(`^rgb\\(${Rl},${Rl},${Rl}\\)$`), gre = new RegExp(`^rgba\\(${Em},${Em},${Em},${x0}\\)$`), yre = new RegExp(`^rgba\\(${Rl},${Rl},${Rl},${x0}\\)$`), vre = new RegExp(`^hsl\\(${x0},${Rl},${Rl}\\)$`), xre = new RegExp(`^hsla\\(${x0},${Rl},${Rl},${x0}\\)$`), TT = {
  aliceblue: 15792383,
  antiquewhite: 16444375,
  aqua: 65535,
  aquamarine: 8388564,
  azure: 15794175,
  beige: 16119260,
  bisque: 16770244,
  black: 0,
  blanchedalmond: 16772045,
  blue: 255,
  blueviolet: 9055202,
  brown: 10824234,
  burlywood: 14596231,
  cadetblue: 6266528,
  chartreuse: 8388352,
  chocolate: 13789470,
  coral: 16744272,
  cornflowerblue: 6591981,
  cornsilk: 16775388,
  crimson: 14423100,
  cyan: 65535,
  darkblue: 139,
  darkcyan: 35723,
  darkgoldenrod: 12092939,
  darkgray: 11119017,
  darkgreen: 25600,
  darkgrey: 11119017,
  darkkhaki: 12433259,
  darkmagenta: 9109643,
  darkolivegreen: 5597999,
  darkorange: 16747520,
  darkorchid: 10040012,
  darkred: 9109504,
  darksalmon: 15308410,
  darkseagreen: 9419919,
  darkslateblue: 4734347,
  darkslategray: 3100495,
  darkslategrey: 3100495,
  darkturquoise: 52945,
  darkviolet: 9699539,
  deeppink: 16716947,
  deepskyblue: 49151,
  dimgray: 6908265,
  dimgrey: 6908265,
  dodgerblue: 2003199,
  firebrick: 11674146,
  floralwhite: 16775920,
  forestgreen: 2263842,
  fuchsia: 16711935,
  gainsboro: 14474460,
  ghostwhite: 16316671,
  gold: 16766720,
  goldenrod: 14329120,
  gray: 8421504,
  green: 32768,
  greenyellow: 11403055,
  grey: 8421504,
  honeydew: 15794160,
  hotpink: 16738740,
  indianred: 13458524,
  indigo: 4915330,
  ivory: 16777200,
  khaki: 15787660,
  lavender: 15132410,
  lavenderblush: 16773365,
  lawngreen: 8190976,
  lemonchiffon: 16775885,
  lightblue: 11393254,
  lightcoral: 15761536,
  lightcyan: 14745599,
  lightgoldenrodyellow: 16448210,
  lightgray: 13882323,
  lightgreen: 9498256,
  lightgrey: 13882323,
  lightpink: 16758465,
  lightsalmon: 16752762,
  lightseagreen: 2142890,
  lightskyblue: 8900346,
  lightslategray: 7833753,
  lightslategrey: 7833753,
  lightsteelblue: 11584734,
  lightyellow: 16777184,
  lime: 65280,
  limegreen: 3329330,
  linen: 16445670,
  magenta: 16711935,
  maroon: 8388608,
  mediumaquamarine: 6737322,
  mediumblue: 205,
  mediumorchid: 12211667,
  mediumpurple: 9662683,
  mediumseagreen: 3978097,
  mediumslateblue: 8087790,
  mediumspringgreen: 64154,
  mediumturquoise: 4772300,
  mediumvioletred: 13047173,
  midnightblue: 1644912,
  mintcream: 16121850,
  mistyrose: 16770273,
  moccasin: 16770229,
  navajowhite: 16768685,
  navy: 128,
  oldlace: 16643558,
  olive: 8421376,
  olivedrab: 7048739,
  orange: 16753920,
  orangered: 16729344,
  orchid: 14315734,
  palegoldenrod: 15657130,
  palegreen: 10025880,
  paleturquoise: 11529966,
  palevioletred: 14381203,
  papayawhip: 16773077,
  peachpuff: 16767673,
  peru: 13468991,
  pink: 16761035,
  plum: 14524637,
  powderblue: 11591910,
  purple: 8388736,
  rebeccapurple: 6697881,
  red: 16711680,
  rosybrown: 12357519,
  royalblue: 4286945,
  saddlebrown: 9127187,
  salmon: 16416882,
  sandybrown: 16032864,
  seagreen: 3050327,
  seashell: 16774638,
  sienna: 10506797,
  silver: 12632256,
  skyblue: 8900331,
  slateblue: 6970061,
  slategray: 7372944,
  slategrey: 7372944,
  snow: 16775930,
  springgreen: 65407,
  steelblue: 4620980,
  tan: 13808780,
  teal: 32896,
  thistle: 14204888,
  tomato: 16737095,
  turquoise: 4251856,
  violet: 15631086,
  wheat: 16113331,
  white: 16777215,
  whitesmoke: 16119285,
  yellow: 16776960,
  yellowgreen: 10145074
};
IE(q0, Dd, {
  copy(e) {
    return Object.assign(new this.constructor(), this, e);
  },
  displayable() {
    return this.rgb().displayable();
  },
  hex: NT,
  // Deprecated! Use color.formatHex.
  formatHex: NT,
  formatHex8: bre,
  formatHsl: wre,
  formatRgb: AT,
  toString: AT
});
function NT() {
  return this.rgb().formatHex();
}
function bre() {
  return this.rgb().formatHex8();
}
function wre() {
  return fP(this).formatHsl();
}
function AT() {
  return this.rgb().formatRgb();
}
function Dd(e) {
  var t, n;
  return e = (e + "").trim().toLowerCase(), (t = hre.exec(e)) ? (n = t[1].length, t = parseInt(t[1], 16), n === 6 ? jT(t) : n === 3 ? new Fa(t >> 8 & 15 | t >> 4 & 240, t >> 4 & 15 | t & 240, (t & 15) << 4 | t & 15, 1) : n === 8 ? G1(t >> 24 & 255, t >> 16 & 255, t >> 8 & 255, (t & 255) / 255) : n === 4 ? G1(t >> 12 & 15 | t >> 8 & 240, t >> 8 & 15 | t >> 4 & 240, t >> 4 & 15 | t & 240, ((t & 15) << 4 | t & 15) / 255) : null) : (t = mre.exec(e)) ? new Fa(t[1], t[2], t[3], 1) : (t = pre.exec(e)) ? new Fa(t[1] * 255 / 100, t[2] * 255 / 100, t[3] * 255 / 100, 1) : (t = gre.exec(e)) ? G1(t[1], t[2], t[3], t[4]) : (t = yre.exec(e)) ? G1(t[1] * 255 / 100, t[2] * 255 / 100, t[3] * 255 / 100, t[4]) : (t = vre.exec(e)) ? OT(t[1], t[2] / 100, t[3] / 100, 1) : (t = xre.exec(e)) ? OT(t[1], t[2] / 100, t[3] / 100, t[4]) : TT.hasOwnProperty(e) ? jT(TT[e]) : e === "transparent" ? new Fa(NaN, NaN, NaN, 0) : null;
}
function jT(e) {
  return new Fa(e >> 16 & 255, e >> 8 & 255, e & 255, 1);
}
function G1(e, t, n, r) {
  return r <= 0 && (e = t = n = NaN), new Fa(e, t, n, r);
}
function _re(e) {
  return e instanceof q0 || (e = Dd(e)), e ? (e = e.rgb(), new Fa(e.r, e.g, e.b, e.opacity)) : new Fa();
}
function aC(e, t, n, r) {
  return arguments.length === 1 ? _re(e) : new Fa(e, t, n, r ?? 1);
}
function Fa(e, t, n, r) {
  this.r = +e, this.g = +t, this.b = +n, this.opacity = +r;
}
IE(Fa, aC, cP(q0, {
  brighter(e) {
    return e = e == null ? Pv : Math.pow(Pv, e), new Fa(this.r * e, this.g * e, this.b * e, this.opacity);
  },
  darker(e) {
    return e = e == null ? v0 : Math.pow(v0, e), new Fa(this.r * e, this.g * e, this.b * e, this.opacity);
  },
  rgb() {
    return this;
  },
  clamp() {
    return new Fa(Td(this.r), Td(this.g), Td(this.b), zv(this.opacity));
  },
  displayable() {
    return -0.5 <= this.r && this.r < 255.5 && -0.5 <= this.g && this.g < 255.5 && -0.5 <= this.b && this.b < 255.5 && 0 <= this.opacity && this.opacity <= 1;
  },
  hex: MT,
  // Deprecated! Use color.formatHex.
  formatHex: MT,
  formatHex8: Sre,
  formatRgb: RT,
  toString: RT
}));
function MT() {
  return `#${wd(this.r)}${wd(this.g)}${wd(this.b)}`;
}
function Sre() {
  return `#${wd(this.r)}${wd(this.g)}${wd(this.b)}${wd((isNaN(this.opacity) ? 1 : this.opacity) * 255)}`;
}
function RT() {
  const e = zv(this.opacity);
  return `${e === 1 ? "rgb(" : "rgba("}${Td(this.r)}, ${Td(this.g)}, ${Td(this.b)}${e === 1 ? ")" : `, ${e})`}`;
}
function zv(e) {
  return isNaN(e) ? 1 : Math.max(0, Math.min(1, e));
}
function Td(e) {
  return Math.max(0, Math.min(255, Math.round(e) || 0));
}
function wd(e) {
  return e = Td(e), (e < 16 ? "0" : "") + e.toString(16);
}
function OT(e, t, n, r) {
  return r <= 0 ? e = t = n = NaN : n <= 0 || n >= 1 ? e = t = NaN : t <= 0 && (e = NaN), new Co(e, t, n, r);
}
function fP(e) {
  if (e instanceof Co) return new Co(e.h, e.s, e.l, e.opacity);
  if (e instanceof q0 || (e = Dd(e)), !e) return new Co();
  if (e instanceof Co) return e;
  e = e.rgb();
  var t = e.r / 255, n = e.g / 255, r = e.b / 255, i = Math.min(t, n, r), s = Math.max(t, n, r), o = NaN, u = s - i, c = (s + i) / 2;
  return u ? (t === s ? o = (n - r) / u + (n < r) * 6 : n === s ? o = (r - t) / u + 2 : o = (t - n) / u + 4, u /= c < 0.5 ? s + i : 2 - s - i, o *= 60) : u = c > 0 && c < 1 ? 0 : o, new Co(o, u, c, e.opacity);
}
function Cre(e, t, n, r) {
  return arguments.length === 1 ? fP(e) : new Co(e, t, n, r ?? 1);
}
function Co(e, t, n, r) {
  this.h = +e, this.s = +t, this.l = +n, this.opacity = +r;
}
IE(Co, Cre, cP(q0, {
  brighter(e) {
    return e = e == null ? Pv : Math.pow(Pv, e), new Co(this.h, this.s, this.l * e, this.opacity);
  },
  darker(e) {
    return e = e == null ? v0 : Math.pow(v0, e), new Co(this.h, this.s, this.l * e, this.opacity);
  },
  rgb() {
    var e = this.h % 360 + (this.h < 0) * 360, t = isNaN(e) || isNaN(this.s) ? 0 : this.s, n = this.l, r = n + (n < 0.5 ? n : 1 - n) * t, i = 2 * n - r;
    return new Fa(
      M2(e >= 240 ? e - 240 : e + 120, i, r),
      M2(e, i, r),
      M2(e < 120 ? e + 240 : e - 120, i, r),
      this.opacity
    );
  },
  clamp() {
    return new Co(DT(this.h), K1(this.s), K1(this.l), zv(this.opacity));
  },
  displayable() {
    return (0 <= this.s && this.s <= 1 || isNaN(this.s)) && 0 <= this.l && this.l <= 1 && 0 <= this.opacity && this.opacity <= 1;
  },
  formatHsl() {
    const e = zv(this.opacity);
    return `${e === 1 ? "hsl(" : "hsla("}${DT(this.h)}, ${K1(this.s) * 100}%, ${K1(this.l) * 100}%${e === 1 ? ")" : `, ${e})`}`;
  }
}));
function DT(e) {
  return e = (e || 0) % 360, e < 0 ? e + 360 : e;
}
function K1(e) {
  return Math.max(0, Math.min(1, e || 0));
}
function M2(e, t, n) {
  return (e < 60 ? t + (n - t) * e / 60 : e < 180 ? n : e < 240 ? t + (n - t) * (240 - e) / 60 : t) * 255;
}
const PE = (e) => () => e;
function Ere(e, t) {
  return function(n) {
    return e + n * t;
  };
}
function kre(e, t, n) {
  return e = Math.pow(e, n), t = Math.pow(t, n) - e, n = 1 / n, function(r) {
    return Math.pow(e + r * t, n);
  };
}
function Tre(e) {
  return (e = +e) == 1 ? dP : function(t, n) {
    return n - t ? kre(t, n, e) : PE(isNaN(t) ? n : t);
  };
}
function dP(e, t) {
  var n = t - e;
  return n ? Ere(e, n) : PE(isNaN(e) ? t : e);
}
const Lv = (function e(t) {
  var n = Tre(t);
  function r(i, s) {
    var o = n((i = aC(i)).r, (s = aC(s)).r), u = n(i.g, s.g), c = n(i.b, s.b), d = dP(i.opacity, s.opacity);
    return function(m) {
      return i.r = o(m), i.g = u(m), i.b = c(m), i.opacity = d(m), i + "";
    };
  }
  return r.gamma = e, r;
})(1);
function Nre(e, t) {
  t || (t = []);
  var n = e ? Math.min(t.length, e.length) : 0, r = t.slice(), i;
  return function(s) {
    for (i = 0; i < n; ++i) r[i] = e[i] * (1 - s) + t[i] * s;
    return r;
  };
}
function Are(e) {
  return ArrayBuffer.isView(e) && !(e instanceof DataView);
}
function jre(e, t) {
  var n = t ? t.length : 0, r = e ? Math.min(n, e.length) : 0, i = new Array(r), s = new Array(n), o;
  for (o = 0; o < r; ++o) i[o] = i0(e[o], t[o]);
  for (; o < n; ++o) s[o] = t[o];
  return function(u) {
    for (o = 0; o < r; ++o) s[o] = i[o](u);
    return s;
  };
}
function Mre(e, t) {
  var n = /* @__PURE__ */ new Date();
  return e = +e, t = +t, function(r) {
    return n.setTime(e * (1 - r) + t * r), n;
  };
}
function El(e, t) {
  return e = +e, t = +t, function(n) {
    return e * (1 - n) + t * n;
  };
}
function Rre(e, t) {
  var n = {}, r = {}, i;
  (e === null || typeof e != "object") && (e = {}), (t === null || typeof t != "object") && (t = {});
  for (i in t)
    i in e ? n[i] = i0(e[i], t[i]) : r[i] = t[i];
  return function(s) {
    for (i in n) r[i] = n[i](s);
    return r;
  };
}
var sC = /[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g, R2 = new RegExp(sC.source, "g");
function Ore(e) {
  return function() {
    return e;
  };
}
function Dre(e) {
  return function(t) {
    return e(t) + "";
  };
}
function hP(e, t) {
  var n = sC.lastIndex = R2.lastIndex = 0, r, i, s, o = -1, u = [], c = [];
  for (e = e + "", t = t + ""; (r = sC.exec(e)) && (i = R2.exec(t)); )
    (s = i.index) > n && (s = t.slice(n, s), u[o] ? u[o] += s : u[++o] = s), (r = r[0]) === (i = i[0]) ? u[o] ? u[o] += i : u[++o] = i : (u[++o] = null, c.push({ i: o, x: El(r, i) })), n = R2.lastIndex;
  return n < t.length && (s = t.slice(n), u[o] ? u[o] += s : u[++o] = s), u.length < 2 ? c[0] ? Dre(c[0].x) : Ore(t) : (t = c.length, function(d) {
    for (var m = 0, p; m < t; ++m) u[(p = c[m]).i] = p.x(d);
    return u.join("");
  });
}
function i0(e, t) {
  var n = typeof t, r;
  return t == null || n === "boolean" ? PE(t) : (n === "number" ? El : n === "string" ? (r = Dd(t)) ? (t = r, Lv) : hP : t instanceof Dd ? Lv : t instanceof Date ? Mre : Are(t) ? Nre : Array.isArray(t) ? jre : typeof t.valueOf != "function" && typeof t.toString != "function" || isNaN(t) ? Rre : El)(e, t);
}
var IT = 180 / Math.PI, oC = {
  translateX: 0,
  translateY: 0,
  rotate: 0,
  skewX: 0,
  scaleX: 1,
  scaleY: 1
};
function mP(e, t, n, r, i, s) {
  var o, u, c;
  return (o = Math.sqrt(e * e + t * t)) && (e /= o, t /= o), (c = e * n + t * r) && (n -= e * c, r -= t * c), (u = Math.sqrt(n * n + r * r)) && (n /= u, r /= u, c /= u), e * r < t * n && (e = -e, t = -t, c = -c, o = -o), {
    translateX: i,
    translateY: s,
    rotate: Math.atan2(t, e) * IT,
    skewX: Math.atan(c) * IT,
    scaleX: o,
    scaleY: u
  };
}
var Y1;
function Ire(e) {
  const t = new (typeof DOMMatrix == "function" ? DOMMatrix : WebKitCSSMatrix)(e + "");
  return t.isIdentity ? oC : mP(t.a, t.b, t.c, t.d, t.e, t.f);
}
function Pre(e) {
  return e == null || (Y1 || (Y1 = document.createElementNS("http://www.w3.org/2000/svg", "g")), Y1.setAttribute("transform", e), !(e = Y1.transform.baseVal.consolidate())) ? oC : (e = e.matrix, mP(e.a, e.b, e.c, e.d, e.e, e.f));
}
function pP(e, t, n, r) {
  function i(d) {
    return d.length ? d.pop() + " " : "";
  }
  function s(d, m, p, x, b, S) {
    if (d !== p || m !== x) {
      var k = b.push("translate(", null, t, null, n);
      S.push({ i: k - 4, x: El(d, p) }, { i: k - 2, x: El(m, x) });
    } else (p || x) && b.push("translate(" + p + t + x + n);
  }
  function o(d, m, p, x) {
    d !== m ? (d - m > 180 ? m += 360 : m - d > 180 && (d += 360), x.push({ i: p.push(i(p) + "rotate(", null, r) - 2, x: El(d, m) })) : m && p.push(i(p) + "rotate(" + m + r);
  }
  function u(d, m, p, x) {
    d !== m ? x.push({ i: p.push(i(p) + "skewX(", null, r) - 2, x: El(d, m) }) : m && p.push(i(p) + "skewX(" + m + r);
  }
  function c(d, m, p, x, b, S) {
    if (d !== p || m !== x) {
      var k = b.push(i(b) + "scale(", null, ",", null, ")");
      S.push({ i: k - 4, x: El(d, p) }, { i: k - 2, x: El(m, x) });
    } else (p !== 1 || x !== 1) && b.push(i(b) + "scale(" + p + "," + x + ")");
  }
  return function(d, m) {
    var p = [], x = [];
    return d = e(d), m = e(m), s(d.translateX, d.translateY, m.translateX, m.translateY, p, x), o(d.rotate, m.rotate, p, x), u(d.skewX, m.skewX, p, x), c(d.scaleX, d.scaleY, m.scaleX, m.scaleY, p, x), d = m = null, function(b) {
      for (var S = -1, k = x.length, A; ++S < k; ) p[(A = x[S]).i] = A.x(b);
      return p.join("");
    };
  };
}
var zre = pP(Ire, "px, ", "px)", "deg)"), Lre = pP(Pre, ", ", ")", ")"), Bre = 1e-12;
function PT(e) {
  return ((e = Math.exp(e)) + 1 / e) / 2;
}
function qre(e) {
  return ((e = Math.exp(e)) - 1 / e) / 2;
}
function Fre(e) {
  return ((e = Math.exp(2 * e)) - 1) / (e + 1);
}
const dv = (function e(t, n, r) {
  function i(s, o) {
    var u = s[0], c = s[1], d = s[2], m = o[0], p = o[1], x = o[2], b = m - u, S = p - c, k = b * b + S * S, A, T;
    if (k < Bre)
      T = Math.log(x / d) / t, A = function(L) {
        return [
          u + L * b,
          c + L * S,
          d * Math.exp(t * L * T)
        ];
      };
    else {
      var M = Math.sqrt(k), j = (x * x - d * d + r * k) / (2 * d * n * M), D = (x * x - d * d - r * k) / (2 * x * n * M), z = Math.log(Math.sqrt(j * j + 1) - j), I = Math.log(Math.sqrt(D * D + 1) - D);
      T = (I - z) / t, A = function(L) {
        var K = L * T, ne = PT(z), Y = d / (n * M) * (ne * Fre(t * K + z) - qre(z));
        return [
          u + Y * b,
          c + Y * S,
          d * ne / PT(t * K + z)
        ];
      };
    }
    return A.duration = T * 1e3 * t / Math.SQRT2, A;
  }
  return i.rho = function(s) {
    var o = Math.max(1e-3, +s), u = o * o, c = u * u;
    return e(o, u, c);
  }, i;
})(Math.SQRT2, 2, 4);
var jm = 0, Ug = 0, Pg = 0, gP = 1e3, Bv, $g, qv = 0, Id = 0, mx = 0, b0 = typeof performance == "object" && performance.now ? performance : Date, yP = typeof window == "object" && window.requestAnimationFrame ? window.requestAnimationFrame.bind(window) : function(e) {
  setTimeout(e, 17);
};
function zE() {
  return Id || (yP(Ure), Id = b0.now() + mx);
}
function Ure() {
  Id = 0;
}
function Fv() {
  this._call = this._time = this._next = null;
}
Fv.prototype = vP.prototype = {
  constructor: Fv,
  restart: function(e, t, n) {
    if (typeof e != "function") throw new TypeError("callback is not a function");
    n = (n == null ? zE() : +n) + (t == null ? 0 : +t), !this._next && $g !== this && ($g ? $g._next = this : Bv = this, $g = this), this._call = e, this._time = n, lC();
  },
  stop: function() {
    this._call && (this._call = null, this._time = 1 / 0, lC());
  }
};
function vP(e, t, n) {
  var r = new Fv();
  return r.restart(e, t, n), r;
}
function $re() {
  zE(), ++jm;
  for (var e = Bv, t; e; )
    (t = Id - e._time) >= 0 && e._call.call(void 0, t), e = e._next;
  --jm;
}
function zT() {
  Id = (qv = b0.now()) + mx, jm = Ug = 0;
  try {
    $re();
  } finally {
    jm = 0, Hre(), Id = 0;
  }
}
function Vre() {
  var e = b0.now(), t = e - qv;
  t > gP && (mx -= t, qv = e);
}
function Hre() {
  for (var e, t = Bv, n, r = 1 / 0; t; )
    t._call ? (r > t._time && (r = t._time), e = t, t = t._next) : (n = t._next, t._next = null, t = e ? e._next = n : Bv = n);
  $g = e, lC(r);
}
function lC(e) {
  if (!jm) {
    Ug && (Ug = clearTimeout(Ug));
    var t = e - Id;
    t > 24 ? (e < 1 / 0 && (Ug = setTimeout(zT, e - b0.now() - mx)), Pg && (Pg = clearInterval(Pg))) : (Pg || (qv = b0.now(), Pg = setInterval(Vre, gP)), jm = 1, yP(zT));
  }
}
function LT(e, t, n) {
  var r = new Fv();
  return t = t == null ? 0 : +t, r.restart((i) => {
    r.stop(), e(i + t);
  }, t, n), r;
}
var Gre = dx("start", "end", "cancel", "interrupt"), Kre = [], xP = 0, BT = 1, uC = 2, hv = 3, qT = 4, cC = 5, mv = 6;
function px(e, t, n, r, i, s) {
  var o = e.__transition;
  if (!o) e.__transition = {};
  else if (n in o) return;
  Yre(e, n, {
    name: t,
    index: r,
    // For context during callback.
    group: i,
    // For context during callback.
    on: Gre,
    tween: Kre,
    time: s.time,
    delay: s.delay,
    duration: s.duration,
    ease: s.ease,
    timer: null,
    state: xP
  });
}
function LE(e, t) {
  var n = Oo(e, t);
  if (n.state > xP) throw new Error("too late; already scheduled");
  return n;
}
function Il(e, t) {
  var n = Oo(e, t);
  if (n.state > hv) throw new Error("too late; already running");
  return n;
}
function Oo(e, t) {
  var n = e.__transition;
  if (!n || !(n = n[t])) throw new Error("transition not found");
  return n;
}
function Yre(e, t, n) {
  var r = e.__transition, i;
  r[t] = n, n.timer = vP(s, 0, n.time);
  function s(d) {
    n.state = BT, n.timer.restart(o, n.delay, n.time), n.delay <= d && o(d - n.delay);
  }
  function o(d) {
    var m, p, x, b;
    if (n.state !== BT) return c();
    for (m in r)
      if (b = r[m], b.name === n.name) {
        if (b.state === hv) return LT(o);
        b.state === qT ? (b.state = mv, b.timer.stop(), b.on.call("interrupt", e, e.__data__, b.index, b.group), delete r[m]) : +m < t && (b.state = mv, b.timer.stop(), b.on.call("cancel", e, e.__data__, b.index, b.group), delete r[m]);
      }
    if (LT(function() {
      n.state === hv && (n.state = qT, n.timer.restart(u, n.delay, n.time), u(d));
    }), n.state = uC, n.on.call("start", e, e.__data__, n.index, n.group), n.state === uC) {
      for (n.state = hv, i = new Array(x = n.tween.length), m = 0, p = -1; m < x; ++m)
        (b = n.tween[m].value.call(e, e.__data__, n.index, n.group)) && (i[++p] = b);
      i.length = p + 1;
    }
  }
  function u(d) {
    for (var m = d < n.duration ? n.ease.call(null, d / n.duration) : (n.timer.restart(c), n.state = cC, 1), p = -1, x = i.length; ++p < x; )
      i[p].call(e, m);
    n.state === cC && (n.on.call("end", e, e.__data__, n.index, n.group), c());
  }
  function c() {
    n.state = mv, n.timer.stop(), delete r[t];
    for (var d in r) return;
    delete e.__transition;
  }
}
function pv(e, t) {
  var n = e.__transition, r, i, s = !0, o;
  if (n) {
    t = t == null ? null : t + "";
    for (o in n) {
      if ((r = n[o]).name !== t) {
        s = !1;
        continue;
      }
      i = r.state > uC && r.state < cC, r.state = mv, r.timer.stop(), r.on.call(i ? "interrupt" : "cancel", e, e.__data__, r.index, r.group), delete n[o];
    }
    s && delete e.__transition;
  }
}
function Wre(e) {
  return this.each(function() {
    pv(this, e);
  });
}
function Xre(e, t) {
  var n, r;
  return function() {
    var i = Il(this, e), s = i.tween;
    if (s !== n) {
      r = n = s;
      for (var o = 0, u = r.length; o < u; ++o)
        if (r[o].name === t) {
          r = r.slice(), r.splice(o, 1);
          break;
        }
    }
    i.tween = r;
  };
}
function Qre(e, t, n) {
  var r, i;
  if (typeof n != "function") throw new Error();
  return function() {
    var s = Il(this, e), o = s.tween;
    if (o !== r) {
      i = (r = o).slice();
      for (var u = { name: t, value: n }, c = 0, d = i.length; c < d; ++c)
        if (i[c].name === t) {
          i[c] = u;
          break;
        }
      c === d && i.push(u);
    }
    s.tween = i;
  };
}
function Zre(e, t) {
  var n = this._id;
  if (e += "", arguments.length < 2) {
    for (var r = Oo(this.node(), n).tween, i = 0, s = r.length, o; i < s; ++i)
      if ((o = r[i]).name === e)
        return o.value;
    return null;
  }
  return this.each((t == null ? Xre : Qre)(n, e, t));
}
function BE(e, t, n) {
  var r = e._id;
  return e.each(function() {
    var i = Il(this, r);
    (i.value || (i.value = {}))[t] = n.apply(this, arguments);
  }), function(i) {
    return Oo(i, r).value[t];
  };
}
function bP(e, t) {
  var n;
  return (typeof t == "number" ? El : t instanceof Dd ? Lv : (n = Dd(t)) ? (t = n, Lv) : hP)(e, t);
}
function Jre(e) {
  return function() {
    this.removeAttribute(e);
  };
}
function eie(e) {
  return function() {
    this.removeAttributeNS(e.space, e.local);
  };
}
function tie(e, t, n) {
  var r, i = n + "", s;
  return function() {
    var o = this.getAttribute(e);
    return o === i ? null : o === r ? s : s = t(r = o, n);
  };
}
function nie(e, t, n) {
  var r, i = n + "", s;
  return function() {
    var o = this.getAttributeNS(e.space, e.local);
    return o === i ? null : o === r ? s : s = t(r = o, n);
  };
}
function rie(e, t, n) {
  var r, i, s;
  return function() {
    var o, u = n(this), c;
    return u == null ? void this.removeAttribute(e) : (o = this.getAttribute(e), c = u + "", o === c ? null : o === r && c === i ? s : (i = c, s = t(r = o, u)));
  };
}
function iie(e, t, n) {
  var r, i, s;
  return function() {
    var o, u = n(this), c;
    return u == null ? void this.removeAttributeNS(e.space, e.local) : (o = this.getAttributeNS(e.space, e.local), c = u + "", o === c ? null : o === r && c === i ? s : (i = c, s = t(r = o, u)));
  };
}
function aie(e, t) {
  var n = hx(e), r = n === "transform" ? Lre : bP;
  return this.attrTween(e, typeof t == "function" ? (n.local ? iie : rie)(n, r, BE(this, "attr." + e, t)) : t == null ? (n.local ? eie : Jre)(n) : (n.local ? nie : tie)(n, r, t));
}
function sie(e, t) {
  return function(n) {
    this.setAttribute(e, t.call(this, n));
  };
}
function oie(e, t) {
  return function(n) {
    this.setAttributeNS(e.space, e.local, t.call(this, n));
  };
}
function lie(e, t) {
  var n, r;
  function i() {
    var s = t.apply(this, arguments);
    return s !== r && (n = (r = s) && oie(e, s)), n;
  }
  return i._value = t, i;
}
function uie(e, t) {
  var n, r;
  function i() {
    var s = t.apply(this, arguments);
    return s !== r && (n = (r = s) && sie(e, s)), n;
  }
  return i._value = t, i;
}
function cie(e, t) {
  var n = "attr." + e;
  if (arguments.length < 2) return (n = this.tween(n)) && n._value;
  if (t == null) return this.tween(n, null);
  if (typeof t != "function") throw new Error();
  var r = hx(e);
  return this.tween(n, (r.local ? lie : uie)(r, t));
}
function fie(e, t) {
  return function() {
    LE(this, e).delay = +t.apply(this, arguments);
  };
}
function die(e, t) {
  return t = +t, function() {
    LE(this, e).delay = t;
  };
}
function hie(e) {
  var t = this._id;
  return arguments.length ? this.each((typeof e == "function" ? fie : die)(t, e)) : Oo(this.node(), t).delay;
}
function mie(e, t) {
  return function() {
    Il(this, e).duration = +t.apply(this, arguments);
  };
}
function pie(e, t) {
  return t = +t, function() {
    Il(this, e).duration = t;
  };
}
function gie(e) {
  var t = this._id;
  return arguments.length ? this.each((typeof e == "function" ? mie : pie)(t, e)) : Oo(this.node(), t).duration;
}
function yie(e, t) {
  if (typeof t != "function") throw new Error();
  return function() {
    Il(this, e).ease = t;
  };
}
function vie(e) {
  var t = this._id;
  return arguments.length ? this.each(yie(t, e)) : Oo(this.node(), t).ease;
}
function xie(e, t) {
  return function() {
    var n = t.apply(this, arguments);
    if (typeof n != "function") throw new Error();
    Il(this, e).ease = n;
  };
}
function bie(e) {
  if (typeof e != "function") throw new Error();
  return this.each(xie(this._id, e));
}
function wie(e) {
  typeof e != "function" && (e = QI(e));
  for (var t = this._groups, n = t.length, r = new Array(n), i = 0; i < n; ++i)
    for (var s = t[i], o = s.length, u = r[i] = [], c, d = 0; d < o; ++d)
      (c = s[d]) && e.call(c, c.__data__, d, s) && u.push(c);
  return new Cu(r, this._parents, this._name, this._id);
}
function _ie(e) {
  if (e._id !== this._id) throw new Error();
  for (var t = this._groups, n = e._groups, r = t.length, i = n.length, s = Math.min(r, i), o = new Array(r), u = 0; u < s; ++u)
    for (var c = t[u], d = n[u], m = c.length, p = o[u] = new Array(m), x, b = 0; b < m; ++b)
      (x = c[b] || d[b]) && (p[b] = x);
  for (; u < r; ++u)
    o[u] = t[u];
  return new Cu(o, this._parents, this._name, this._id);
}
function Sie(e) {
  return (e + "").trim().split(/^|\s+/).every(function(t) {
    var n = t.indexOf(".");
    return n >= 0 && (t = t.slice(0, n)), !t || t === "start";
  });
}
function Cie(e, t, n) {
  var r, i, s = Sie(t) ? LE : Il;
  return function() {
    var o = s(this, e), u = o.on;
    u !== r && (i = (r = u).copy()).on(t, n), o.on = i;
  };
}
function Eie(e, t) {
  var n = this._id;
  return arguments.length < 2 ? Oo(this.node(), n).on.on(e) : this.each(Cie(n, e, t));
}
function kie(e) {
  return function() {
    var t = this.parentNode;
    for (var n in this.__transition) if (+n !== e) return;
    t && t.removeChild(this);
  };
}
function Tie() {
  return this.on("end.remove", kie(this._id));
}
function Nie(e) {
  var t = this._name, n = this._id;
  typeof e != "function" && (e = OE(e));
  for (var r = this._groups, i = r.length, s = new Array(i), o = 0; o < i; ++o)
    for (var u = r[o], c = u.length, d = s[o] = new Array(c), m, p, x = 0; x < c; ++x)
      (m = u[x]) && (p = e.call(m, m.__data__, x, u)) && ("__data__" in m && (p.__data__ = m.__data__), d[x] = p, px(d[x], t, n, x, d, Oo(m, n)));
  return new Cu(s, this._parents, t, n);
}
function Aie(e) {
  var t = this._name, n = this._id;
  typeof e != "function" && (e = XI(e));
  for (var r = this._groups, i = r.length, s = [], o = [], u = 0; u < i; ++u)
    for (var c = r[u], d = c.length, m, p = 0; p < d; ++p)
      if (m = c[p]) {
        for (var x = e.call(m, m.__data__, p, c), b, S = Oo(m, n), k = 0, A = x.length; k < A; ++k)
          (b = x[k]) && px(b, t, n, k, x, S);
        s.push(x), o.push(m);
      }
  return new Cu(s, o, t, n);
}
var jie = B0.prototype.constructor;
function Mie() {
  return new jie(this._groups, this._parents);
}
function Rie(e, t) {
  var n, r, i;
  return function() {
    var s = Am(this, e), o = (this.style.removeProperty(e), Am(this, e));
    return s === o ? null : s === n && o === r ? i : i = t(n = s, r = o);
  };
}
function wP(e) {
  return function() {
    this.style.removeProperty(e);
  };
}
function Oie(e, t, n) {
  var r, i = n + "", s;
  return function() {
    var o = Am(this, e);
    return o === i ? null : o === r ? s : s = t(r = o, n);
  };
}
function Die(e, t, n) {
  var r, i, s;
  return function() {
    var o = Am(this, e), u = n(this), c = u + "";
    return u == null && (c = u = (this.style.removeProperty(e), Am(this, e))), o === c ? null : o === r && c === i ? s : (i = c, s = t(r = o, u));
  };
}
function Iie(e, t) {
  var n, r, i, s = "style." + t, o = "end." + s, u;
  return function() {
    var c = Il(this, e), d = c.on, m = c.value[s] == null ? u || (u = wP(t)) : void 0;
    (d !== n || i !== m) && (r = (n = d).copy()).on(o, i = m), c.on = r;
  };
}
function Pie(e, t, n) {
  var r = (e += "") == "transform" ? zre : bP;
  return t == null ? this.styleTween(e, Rie(e, r)).on("end.style." + e, wP(e)) : typeof t == "function" ? this.styleTween(e, Die(e, r, BE(this, "style." + e, t))).each(Iie(this._id, e)) : this.styleTween(e, Oie(e, r, t), n).on("end.style." + e, null);
}
function zie(e, t, n) {
  return function(r) {
    this.style.setProperty(e, t.call(this, r), n);
  };
}
function Lie(e, t, n) {
  var r, i;
  function s() {
    var o = t.apply(this, arguments);
    return o !== i && (r = (i = o) && zie(e, o, n)), r;
  }
  return s._value = t, s;
}
function Bie(e, t, n) {
  var r = "style." + (e += "");
  if (arguments.length < 2) return (r = this.tween(r)) && r._value;
  if (t == null) return this.tween(r, null);
  if (typeof t != "function") throw new Error();
  return this.tween(r, Lie(e, t, n ?? ""));
}
function qie(e) {
  return function() {
    this.textContent = e;
  };
}
function Fie(e) {
  return function() {
    var t = e(this);
    this.textContent = t ?? "";
  };
}
function Uie(e) {
  return this.tween("text", typeof e == "function" ? Fie(BE(this, "text", e)) : qie(e == null ? "" : e + ""));
}
function $ie(e) {
  return function(t) {
    this.textContent = e.call(this, t);
  };
}
function Vie(e) {
  var t, n;
  function r() {
    var i = e.apply(this, arguments);
    return i !== n && (t = (n = i) && $ie(i)), t;
  }
  return r._value = e, r;
}
function Hie(e) {
  var t = "text";
  if (arguments.length < 1) return (t = this.tween(t)) && t._value;
  if (e == null) return this.tween(t, null);
  if (typeof e != "function") throw new Error();
  return this.tween(t, Vie(e));
}
function Gie() {
  for (var e = this._name, t = this._id, n = _P(), r = this._groups, i = r.length, s = 0; s < i; ++s)
    for (var o = r[s], u = o.length, c, d = 0; d < u; ++d)
      if (c = o[d]) {
        var m = Oo(c, t);
        px(c, e, n, d, o, {
          time: m.time + m.delay + m.duration,
          delay: 0,
          duration: m.duration,
          ease: m.ease
        });
      }
  return new Cu(r, this._parents, e, n);
}
function Kie() {
  var e, t, n = this, r = n._id, i = n.size();
  return new Promise(function(s, o) {
    var u = { value: o }, c = { value: function() {
      --i === 0 && s();
    } };
    n.each(function() {
      var d = Il(this, r), m = d.on;
      m !== e && (t = (e = m).copy(), t._.cancel.push(u), t._.interrupt.push(u), t._.end.push(c)), d.on = t;
    }), i === 0 && s();
  });
}
var Yie = 0;
function Cu(e, t, n, r) {
  this._groups = e, this._parents = t, this._name = n, this._id = r;
}
function _P() {
  return ++Yie;
}
var pu = B0.prototype;
Cu.prototype = {
  constructor: Cu,
  select: Nie,
  selectAll: Aie,
  selectChild: pu.selectChild,
  selectChildren: pu.selectChildren,
  filter: wie,
  merge: _ie,
  selection: Mie,
  transition: Gie,
  call: pu.call,
  nodes: pu.nodes,
  node: pu.node,
  size: pu.size,
  empty: pu.empty,
  each: pu.each,
  on: Eie,
  attr: aie,
  attrTween: cie,
  style: Pie,
  styleTween: Bie,
  text: Uie,
  textTween: Hie,
  remove: Tie,
  tween: Zre,
  delay: hie,
  duration: gie,
  ease: vie,
  easeVarying: bie,
  end: Kie,
  [Symbol.iterator]: pu[Symbol.iterator]
};
function Wie(e) {
  return ((e *= 2) <= 1 ? e * e * e : (e -= 2) * e * e + 2) / 2;
}
var Xie = {
  time: null,
  // Set on use.
  delay: 0,
  duration: 250,
  ease: Wie
};
function Qie(e, t) {
  for (var n; !(n = e.__transition) || !(n = n[t]); )
    if (!(e = e.parentNode))
      throw new Error(`transition ${t} not found`);
  return n;
}
function Zie(e) {
  var t, n;
  e instanceof Cu ? (t = e._id, e = e._name) : (t = _P(), (n = Xie).time = zE(), e = e == null ? null : e + "");
  for (var r = this._groups, i = r.length, s = 0; s < i; ++s)
    for (var o = r[s], u = o.length, c, d = 0; d < u; ++d)
      (c = o[d]) && px(c, e, t, d, o, n || Qie(c, t));
  return new Cu(r, this._parents, e, t);
}
B0.prototype.interrupt = Wre;
B0.prototype.transition = Zie;
const W1 = (e) => () => e;
function Jie(e, {
  sourceEvent: t,
  target: n,
  transform: r,
  dispatch: i
}) {
  Object.defineProperties(this, {
    type: { value: e, enumerable: !0, configurable: !0 },
    sourceEvent: { value: t, enumerable: !0, configurable: !0 },
    target: { value: n, enumerable: !0, configurable: !0 },
    transform: { value: r, enumerable: !0, configurable: !0 },
    _: { value: i }
  });
}
function bu(e, t, n) {
  this.k = e, this.x = t, this.y = n;
}
bu.prototype = {
  constructor: bu,
  scale: function(e) {
    return e === 1 ? this : new bu(this.k * e, this.x, this.y);
  },
  translate: function(e, t) {
    return e === 0 & t === 0 ? this : new bu(this.k, this.x + this.k * e, this.y + this.k * t);
  },
  apply: function(e) {
    return [e[0] * this.k + this.x, e[1] * this.k + this.y];
  },
  applyX: function(e) {
    return e * this.k + this.x;
  },
  applyY: function(e) {
    return e * this.k + this.y;
  },
  invert: function(e) {
    return [(e[0] - this.x) / this.k, (e[1] - this.y) / this.k];
  },
  invertX: function(e) {
    return (e - this.x) / this.k;
  },
  invertY: function(e) {
    return (e - this.y) / this.k;
  },
  rescaleX: function(e) {
    return e.copy().domain(e.range().map(this.invertX, this).map(e.invert, e));
  },
  rescaleY: function(e) {
    return e.copy().domain(e.range().map(this.invertY, this).map(e.invert, e));
  },
  toString: function() {
    return "translate(" + this.x + "," + this.y + ") scale(" + this.k + ")";
  }
};
var gx = new bu(1, 0, 0);
SP.prototype = bu.prototype;
function SP(e) {
  for (; !e.__zoom; ) if (!(e = e.parentNode)) return gx;
  return e.__zoom;
}
function O2(e) {
  e.stopImmediatePropagation();
}
function zg(e) {
  e.preventDefault(), e.stopImmediatePropagation();
}
function eae(e) {
  return (!e.ctrlKey || e.type === "wheel") && !e.button;
}
function tae() {
  var e = this;
  return e instanceof SVGElement ? (e = e.ownerSVGElement || e, e.hasAttribute("viewBox") ? (e = e.viewBox.baseVal, [[e.x, e.y], [e.x + e.width, e.y + e.height]]) : [[0, 0], [e.width.baseVal.value, e.height.baseVal.value]]) : [[0, 0], [e.clientWidth, e.clientHeight]];
}
function FT() {
  return this.__zoom || gx;
}
function nae(e) {
  return -e.deltaY * (e.deltaMode === 1 ? 0.05 : e.deltaMode ? 1 : 2e-3) * (e.ctrlKey ? 10 : 1);
}
function rae() {
  return navigator.maxTouchPoints || "ontouchstart" in this;
}
function iae(e, t, n) {
  var r = e.invertX(t[0][0]) - n[0][0], i = e.invertX(t[1][0]) - n[1][0], s = e.invertY(t[0][1]) - n[0][1], o = e.invertY(t[1][1]) - n[1][1];
  return e.translate(
    i > r ? (r + i) / 2 : Math.min(0, r) || Math.max(0, i),
    o > s ? (s + o) / 2 : Math.min(0, s) || Math.max(0, o)
  );
}
function CP() {
  var e = eae, t = tae, n = iae, r = nae, i = rae, s = [0, 1 / 0], o = [[-1 / 0, -1 / 0], [1 / 0, 1 / 0]], u = 250, c = dv, d = dx("start", "zoom", "end"), m, p, x, b = 500, S = 150, k = 0, A = 10;
  function T(Q) {
    Q.property("__zoom", FT).on("wheel.zoom", K, { passive: !1 }).on("mousedown.zoom", ne).on("dblclick.zoom", Y).filter(i).on("touchstart.zoom", H).on("touchmove.zoom", Z).on("touchend.zoom touchcancel.zoom", me).style("-webkit-tap-highlight-color", "rgba(0,0,0,0)");
  }
  T.transform = function(Q, se, J, ue) {
    var de = Q.selection ? Q.selection() : Q;
    de.property("__zoom", FT), Q !== de ? z(Q, se, J, ue) : de.interrupt().each(function() {
      I(this, arguments).event(ue).start().zoom(null, typeof se == "function" ? se.apply(this, arguments) : se).end();
    });
  }, T.scaleBy = function(Q, se, J, ue) {
    T.scaleTo(Q, function() {
      var de = this.__zoom.k, ce = typeof se == "function" ? se.apply(this, arguments) : se;
      return de * ce;
    }, J, ue);
  }, T.scaleTo = function(Q, se, J, ue) {
    T.transform(Q, function() {
      var de = t.apply(this, arguments), ce = this.__zoom, W = J == null ? D(de) : typeof J == "function" ? J.apply(this, arguments) : J, $ = ce.invert(W), fe = typeof se == "function" ? se.apply(this, arguments) : se;
      return n(j(M(ce, fe), W, $), de, o);
    }, J, ue);
  }, T.translateBy = function(Q, se, J, ue) {
    T.transform(Q, function() {
      return n(this.__zoom.translate(
        typeof se == "function" ? se.apply(this, arguments) : se,
        typeof J == "function" ? J.apply(this, arguments) : J
      ), t.apply(this, arguments), o);
    }, null, ue);
  }, T.translateTo = function(Q, se, J, ue, de) {
    T.transform(Q, function() {
      var ce = t.apply(this, arguments), W = this.__zoom, $ = ue == null ? D(ce) : typeof ue == "function" ? ue.apply(this, arguments) : ue;
      return n(gx.translate($[0], $[1]).scale(W.k).translate(
        typeof se == "function" ? -se.apply(this, arguments) : -se,
        typeof J == "function" ? -J.apply(this, arguments) : -J
      ), ce, o);
    }, ue, de);
  };
  function M(Q, se) {
    return se = Math.max(s[0], Math.min(s[1], se)), se === Q.k ? Q : new bu(se, Q.x, Q.y);
  }
  function j(Q, se, J) {
    var ue = se[0] - J[0] * Q.k, de = se[1] - J[1] * Q.k;
    return ue === Q.x && de === Q.y ? Q : new bu(Q.k, ue, de);
  }
  function D(Q) {
    return [(+Q[0][0] + +Q[1][0]) / 2, (+Q[0][1] + +Q[1][1]) / 2];
  }
  function z(Q, se, J, ue) {
    Q.on("start.zoom", function() {
      I(this, arguments).event(ue).start();
    }).on("interrupt.zoom end.zoom", function() {
      I(this, arguments).event(ue).end();
    }).tween("zoom", function() {
      var de = this, ce = arguments, W = I(de, ce).event(ue), $ = t.apply(de, ce), fe = J == null ? D($) : typeof J == "function" ? J.apply(de, ce) : J, G = Math.max($[1][0] - $[0][0], $[1][1] - $[0][1]), le = de.__zoom, xe = typeof se == "function" ? se.apply(de, ce) : se, Se = c(le.invert(fe).concat(G / le.k), xe.invert(fe).concat(G / xe.k));
      return function(Oe) {
        if (Oe === 1) Oe = xe;
        else {
          var Be = Se(Oe), Re = G / Be[2];
          Oe = new bu(Re, fe[0] - Be[0] * Re, fe[1] - Be[1] * Re);
        }
        W.zoom(null, Oe);
      };
    });
  }
  function I(Q, se, J) {
    return !J && Q.__zooming || new L(Q, se);
  }
  function L(Q, se) {
    this.that = Q, this.args = se, this.active = 0, this.sourceEvent = null, this.extent = t.apply(Q, se), this.taps = 0;
  }
  L.prototype = {
    event: function(Q) {
      return Q && (this.sourceEvent = Q), this;
    },
    start: function() {
      return ++this.active === 1 && (this.that.__zooming = this, this.emit("start")), this;
    },
    zoom: function(Q, se) {
      return this.mouse && Q !== "mouse" && (this.mouse[1] = se.invert(this.mouse[0])), this.touch0 && Q !== "touch" && (this.touch0[1] = se.invert(this.touch0[0])), this.touch1 && Q !== "touch" && (this.touch1[1] = se.invert(this.touch1[0])), this.that.__zoom = se, this.emit("zoom"), this;
    },
    end: function() {
      return --this.active === 0 && (delete this.that.__zooming, this.emit("end")), this;
    },
    emit: function(Q) {
      var se = hs(this.that).datum();
      d.call(
        Q,
        this.that,
        new Jie(Q, {
          sourceEvent: this.sourceEvent,
          target: T,
          transform: this.that.__zoom,
          dispatch: d
        }),
        se
      );
    }
  };
  function K(Q, ...se) {
    if (!e.apply(this, arguments)) return;
    var J = I(this, se).event(Q), ue = this.__zoom, de = Math.max(s[0], Math.min(s[1], ue.k * Math.pow(2, r.apply(this, arguments)))), ce = _o(Q);
    if (J.wheel)
      (J.mouse[0][0] !== ce[0] || J.mouse[0][1] !== ce[1]) && (J.mouse[1] = ue.invert(J.mouse[0] = ce)), clearTimeout(J.wheel);
    else {
      if (ue.k === de) return;
      J.mouse = [ce, ue.invert(ce)], pv(this), J.start();
    }
    zg(Q), J.wheel = setTimeout(W, S), J.zoom("mouse", n(j(M(ue, de), J.mouse[0], J.mouse[1]), J.extent, o));
    function W() {
      J.wheel = null, J.end();
    }
  }
  function ne(Q, ...se) {
    if (x || !e.apply(this, arguments)) return;
    var J = Q.currentTarget, ue = I(this, se, !0).event(Q), de = hs(Q.view).on("mousemove.zoom", fe, !0).on("mouseup.zoom", G, !0), ce = _o(Q, J), W = Q.clientX, $ = Q.clientY;
    oP(Q.view), O2(Q), ue.mouse = [ce, this.__zoom.invert(ce)], pv(this), ue.start();
    function fe(le) {
      if (zg(le), !ue.moved) {
        var xe = le.clientX - W, Se = le.clientY - $;
        ue.moved = xe * xe + Se * Se > k;
      }
      ue.event(le).zoom("mouse", n(j(ue.that.__zoom, ue.mouse[0] = _o(le, J), ue.mouse[1]), ue.extent, o));
    }
    function G(le) {
      de.on("mousemove.zoom mouseup.zoom", null), lP(le.view, ue.moved), zg(le), ue.event(le).end();
    }
  }
  function Y(Q, ...se) {
    if (e.apply(this, arguments)) {
      var J = this.__zoom, ue = _o(Q.changedTouches ? Q.changedTouches[0] : Q, this), de = J.invert(ue), ce = J.k * (Q.shiftKey ? 0.5 : 2), W = n(j(M(J, ce), ue, de), t.apply(this, se), o);
      zg(Q), u > 0 ? hs(this).transition().duration(u).call(z, W, ue, Q) : hs(this).call(T.transform, W, ue, Q);
    }
  }
  function H(Q, ...se) {
    if (e.apply(this, arguments)) {
      var J = Q.touches, ue = J.length, de = I(this, se, Q.changedTouches.length === ue).event(Q), ce, W, $, fe;
      for (O2(Q), W = 0; W < ue; ++W)
        $ = J[W], fe = _o($, this), fe = [fe, this.__zoom.invert(fe), $.identifier], de.touch0 ? !de.touch1 && de.touch0[2] !== fe[2] && (de.touch1 = fe, de.taps = 0) : (de.touch0 = fe, ce = !0, de.taps = 1 + !!m);
      m && (m = clearTimeout(m)), ce && (de.taps < 2 && (p = fe[0], m = setTimeout(function() {
        m = null;
      }, b)), pv(this), de.start());
    }
  }
  function Z(Q, ...se) {
    if (this.__zooming) {
      var J = I(this, se).event(Q), ue = Q.changedTouches, de = ue.length, ce, W, $, fe;
      for (zg(Q), ce = 0; ce < de; ++ce)
        W = ue[ce], $ = _o(W, this), J.touch0 && J.touch0[2] === W.identifier ? J.touch0[0] = $ : J.touch1 && J.touch1[2] === W.identifier && (J.touch1[0] = $);
      if (W = J.that.__zoom, J.touch1) {
        var G = J.touch0[0], le = J.touch0[1], xe = J.touch1[0], Se = J.touch1[1], Oe = (Oe = xe[0] - G[0]) * Oe + (Oe = xe[1] - G[1]) * Oe, Be = (Be = Se[0] - le[0]) * Be + (Be = Se[1] - le[1]) * Be;
        W = M(W, Math.sqrt(Oe / Be)), $ = [(G[0] + xe[0]) / 2, (G[1] + xe[1]) / 2], fe = [(le[0] + Se[0]) / 2, (le[1] + Se[1]) / 2];
      } else if (J.touch0) $ = J.touch0[0], fe = J.touch0[1];
      else return;
      J.zoom("touch", n(j(W, $, fe), J.extent, o));
    }
  }
  function me(Q, ...se) {
    if (this.__zooming) {
      var J = I(this, se).event(Q), ue = Q.changedTouches, de = ue.length, ce, W;
      for (O2(Q), x && clearTimeout(x), x = setTimeout(function() {
        x = null;
      }, b), ce = 0; ce < de; ++ce)
        W = ue[ce], J.touch0 && J.touch0[2] === W.identifier ? delete J.touch0 : J.touch1 && J.touch1[2] === W.identifier && delete J.touch1;
      if (J.touch1 && !J.touch0 && (J.touch0 = J.touch1, delete J.touch1), J.touch0) J.touch0[1] = this.__zoom.invert(J.touch0[0]);
      else if (J.end(), J.taps === 2 && (W = _o(W, this), Math.hypot(p[0] - W[0], p[1] - W[1]) < A)) {
        var $ = hs(this).on("dblclick.zoom");
        $ && $.apply(this, arguments);
      }
    }
  }
  return T.wheelDelta = function(Q) {
    return arguments.length ? (r = typeof Q == "function" ? Q : W1(+Q), T) : r;
  }, T.filter = function(Q) {
    return arguments.length ? (e = typeof Q == "function" ? Q : W1(!!Q), T) : e;
  }, T.touchable = function(Q) {
    return arguments.length ? (i = typeof Q == "function" ? Q : W1(!!Q), T) : i;
  }, T.extent = function(Q) {
    return arguments.length ? (t = typeof Q == "function" ? Q : W1([[+Q[0][0], +Q[0][1]], [+Q[1][0], +Q[1][1]]]), T) : t;
  }, T.scaleExtent = function(Q) {
    return arguments.length ? (s[0] = +Q[0], s[1] = +Q[1], T) : [s[0], s[1]];
  }, T.translateExtent = function(Q) {
    return arguments.length ? (o[0][0] = +Q[0][0], o[1][0] = +Q[1][0], o[0][1] = +Q[0][1], o[1][1] = +Q[1][1], T) : [[o[0][0], o[0][1]], [o[1][0], o[1][1]]];
  }, T.constrain = function(Q) {
    return arguments.length ? (n = Q, T) : n;
  }, T.duration = function(Q) {
    return arguments.length ? (u = +Q, T) : u;
  }, T.interpolate = function(Q) {
    return arguments.length ? (c = Q, T) : c;
  }, T.on = function() {
    var Q = d.on.apply(d, arguments);
    return Q === d ? T : Q;
  }, T.clickDistance = function(Q) {
    return arguments.length ? (k = (Q = +Q) * Q, T) : Math.sqrt(k);
  }, T.tapDistance = function(Q) {
    return arguments.length ? (A = +Q, T) : A;
  }, T;
}
const Ol = {
  error001: () => "[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",
  error002: () => "It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",
  error003: (e) => `Node type "${e}" not found. Using fallback type "default".`,
  error004: () => "The React Flow parent container needs a width and a height to render the graph.",
  error005: () => "Only child nodes can use a parent extent.",
  error006: () => "Can't create edge. An edge needs a source and a target.",
  error007: (e) => `The old edge with id=${e} does not exist.`,
  error009: (e) => `Marker type "${e}" doesn't exist.`,
  error008: (e, { id: t, sourceHandle: n, targetHandle: r }) => `Couldn't create edge for ${e} handle id: "${e === "source" ? n : r}", edge id: ${t}.`,
  error010: () => "Handle: No node id found. Make sure to only use a Handle inside a custom Node.",
  error011: (e) => `Edge type "${e}" not found. Using fallback type "default".`,
  error012: (e) => `Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,
  error013: (e = "react") => `It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,
  error014: () => "useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",
  error015: () => "It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."
}, w0 = [
  [Number.NEGATIVE_INFINITY, Number.NEGATIVE_INFINITY],
  [Number.POSITIVE_INFINITY, Number.POSITIVE_INFINITY]
], EP = ["Enter", " ", "Escape"], kP = {
  "node.a11yDescription.default": "Press enter or space to select a node. Press delete to remove it and escape to cancel.",
  "node.a11yDescription.keyboardDisabled": "Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.",
  "node.a11yDescription.ariaLiveMessage": ({ direction: e, x: t, y: n }) => `Moved selected node ${e}. New position, x: ${t}, y: ${n}`,
  "edge.a11yDescription.default": "Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.",
  // Control elements
  "controls.ariaLabel": "Control Panel",
  "controls.zoomIn.ariaLabel": "Zoom In",
  "controls.zoomOut.ariaLabel": "Zoom Out",
  "controls.fitView.ariaLabel": "Fit View",
  "controls.interactive.ariaLabel": "Toggle Interactivity",
  // Mini map
  "minimap.ariaLabel": "Mini Map",
  // Handle
  "handle.ariaLabel": "Handle"
};
var Mm;
(function(e) {
  e.Strict = "strict", e.Loose = "loose";
})(Mm || (Mm = {}));
var Nd;
(function(e) {
  e.Free = "free", e.Vertical = "vertical", e.Horizontal = "horizontal";
})(Nd || (Nd = {}));
var _0;
(function(e) {
  e.Partial = "partial", e.Full = "full";
})(_0 || (_0 = {}));
const TP = {
  inProgress: !1,
  isValid: null,
  from: null,
  fromHandle: null,
  fromPosition: null,
  fromNode: null,
  to: null,
  toHandle: null,
  toPosition: null,
  toNode: null,
  pointer: null
};
var Pc;
(function(e) {
  e.Bezier = "default", e.Straight = "straight", e.Step = "step", e.SmoothStep = "smoothstep", e.SimpleBezier = "simplebezier";
})(Pc || (Pc = {}));
var S0;
(function(e) {
  e.Arrow = "arrow", e.ArrowClosed = "arrowclosed";
})(S0 || (S0 = {}));
var gt;
(function(e) {
  e.Left = "left", e.Top = "top", e.Right = "right", e.Bottom = "bottom";
})(gt || (gt = {}));
const UT = {
  [gt.Left]: gt.Right,
  [gt.Right]: gt.Left,
  [gt.Top]: gt.Bottom,
  [gt.Bottom]: gt.Top
};
function NP(e) {
  return e === null ? null : e ? "valid" : "invalid";
}
const AP = (e) => "id" in e && "source" in e && "target" in e, aae = (e) => "id" in e && "position" in e && !("source" in e) && !("target" in e), qE = (e) => "id" in e && "internals" in e && !("source" in e) && !("target" in e), F0 = (e, t = [0, 0]) => {
  const { width: n, height: r } = Tu(e), i = e.origin ?? t, s = n * i[0], o = r * i[1];
  return {
    x: e.position.x - s,
    y: e.position.y - o
  };
}, sae = (e, t = { nodeOrigin: [0, 0] }) => {
  if (e.length === 0)
    return { x: 0, y: 0, width: 0, height: 0 };
  const n = e.reduce((r, i) => {
    const s = typeof i == "string";
    let o = !t.nodeLookup && !s ? i : void 0;
    t.nodeLookup && (o = s ? t.nodeLookup.get(i) : qE(i) ? i : t.nodeLookup.get(i.id));
    const u = o ? Uv(o, t.nodeOrigin) : { x: 0, y: 0, x2: 0, y2: 0 };
    return yx(r, u);
  }, { x: 1 / 0, y: 1 / 0, x2: -1 / 0, y2: -1 / 0 });
  return vx(n);
}, U0 = (e, t = {}) => {
  let n = { x: 1 / 0, y: 1 / 0, x2: -1 / 0, y2: -1 / 0 }, r = !1;
  return e.forEach((i) => {
    (t.filter === void 0 || t.filter(i)) && (n = yx(n, Uv(i)), r = !0);
  }), r ? vx(n) : { x: 0, y: 0, width: 0, height: 0 };
}, FE = (e, t, [n, r, i] = [0, 0, 1], s = !1, o = !1) => {
  const u = {
    ...V0(t, [n, r, i]),
    width: t.width / i,
    height: t.height / i
  }, c = [];
  for (const d of e.values()) {
    const { measured: m, selectable: p = !0, hidden: x = !1 } = d;
    if (o && !p || x)
      continue;
    const b = m.width ?? d.width ?? d.initialWidth ?? null, S = m.height ?? d.height ?? d.initialHeight ?? null, k = C0(u, Om(d)), A = (b ?? 0) * (S ?? 0), T = s && k > 0;
    (!d.internals.handleBounds || T || k >= A || d.dragging) && c.push(d);
  }
  return c;
}, oae = (e, t) => {
  const n = /* @__PURE__ */ new Set();
  return e.forEach((r) => {
    n.add(r.id);
  }), t.filter((r) => n.has(r.source) || n.has(r.target));
};
function lae(e, t) {
  const n = /* @__PURE__ */ new Map(), r = t != null && t.nodes ? new Set(t.nodes.map((i) => i.id)) : null;
  return e.forEach((i) => {
    i.measured.width && i.measured.height && ((t == null ? void 0 : t.includeHiddenNodes) || !i.hidden) && (!r || r.has(i.id)) && n.set(i.id, i);
  }), n;
}
async function uae({ nodes: e, width: t, height: n, panZoom: r, minZoom: i, maxZoom: s }, o) {
  if (e.size === 0)
    return Promise.resolve(!0);
  const u = lae(e, o), c = U0(u), d = UE(c, t, n, (o == null ? void 0 : o.minZoom) ?? i, (o == null ? void 0 : o.maxZoom) ?? s, (o == null ? void 0 : o.padding) ?? 0.1);
  return await r.setViewport(d, {
    duration: o == null ? void 0 : o.duration,
    ease: o == null ? void 0 : o.ease,
    interpolate: o == null ? void 0 : o.interpolate
  }), Promise.resolve(!0);
}
function jP({ nodeId: e, nextPosition: t, nodeLookup: n, nodeOrigin: r = [0, 0], nodeExtent: i, onError: s }) {
  const o = n.get(e), u = o.parentId ? n.get(o.parentId) : void 0, { x: c, y: d } = u ? u.internals.positionAbsolute : { x: 0, y: 0 }, m = o.origin ?? r;
  let p = o.extent || i;
  if (o.extent === "parent" && !o.expandParent)
    if (!u)
      s == null || s("005", Ol.error005());
    else {
      const b = u.measured.width, S = u.measured.height;
      b && S && (p = [
        [c, d],
        [c + b, d + S]
      ]);
    }
  else u && Dm(o.extent) && (p = [
    [o.extent[0][0] + c, o.extent[0][1] + d],
    [o.extent[1][0] + c, o.extent[1][1] + d]
  ]);
  const x = Dm(p) ? Pd(t, p, o.measured) : t;
  return (o.measured.width === void 0 || o.measured.height === void 0) && (s == null || s("015", Ol.error015())), {
    position: {
      x: x.x - c + (o.measured.width ?? 0) * m[0],
      y: x.y - d + (o.measured.height ?? 0) * m[1]
    },
    positionAbsolute: x
  };
}
async function cae({ nodesToRemove: e = [], edgesToRemove: t = [], nodes: n, edges: r, onBeforeDelete: i }) {
  const s = new Set(e.map((x) => x.id)), o = [];
  for (const x of n) {
    if (x.deletable === !1)
      continue;
    const b = s.has(x.id), S = !b && x.parentId && o.find((k) => k.id === x.parentId);
    (b || S) && o.push(x);
  }
  const u = new Set(t.map((x) => x.id)), c = r.filter((x) => x.deletable !== !1), m = oae(o, c);
  for (const x of c)
    u.has(x.id) && !m.find((S) => S.id === x.id) && m.push(x);
  if (!i)
    return {
      edges: m,
      nodes: o
    };
  const p = await i({
    nodes: o,
    edges: m
  });
  return typeof p == "boolean" ? p ? { edges: m, nodes: o } : { edges: [], nodes: [] } : p;
}
const Rm = (e, t = 0, n = 1) => Math.min(Math.max(e, t), n), Pd = (e = { x: 0, y: 0 }, t, n) => ({
  x: Rm(e.x, t[0][0], t[1][0] - ((n == null ? void 0 : n.width) ?? 0)),
  y: Rm(e.y, t[0][1], t[1][1] - ((n == null ? void 0 : n.height) ?? 0))
});
function MP(e, t, n) {
  const { width: r, height: i } = Tu(n), { x: s, y: o } = n.internals.positionAbsolute;
  return Pd(e, [
    [s, o],
    [s + r, o + i]
  ], t);
}
const $T = (e, t, n) => e < t ? Rm(Math.abs(e - t), 1, t) / t : e > n ? -Rm(Math.abs(e - n), 1, t) / t : 0, RP = (e, t, n = 15, r = 40) => {
  const i = $T(e.x, r, t.width - r) * n, s = $T(e.y, r, t.height - r) * n;
  return [i, s];
}, yx = (e, t) => ({
  x: Math.min(e.x, t.x),
  y: Math.min(e.y, t.y),
  x2: Math.max(e.x2, t.x2),
  y2: Math.max(e.y2, t.y2)
}), fC = ({ x: e, y: t, width: n, height: r }) => ({
  x: e,
  y: t,
  x2: e + n,
  y2: t + r
}), vx = ({ x: e, y: t, x2: n, y2: r }) => ({
  x: e,
  y: t,
  width: n - e,
  height: r - t
}), Om = (e, t = [0, 0]) => {
  var i, s;
  const { x: n, y: r } = qE(e) ? e.internals.positionAbsolute : F0(e, t);
  return {
    x: n,
    y: r,
    width: ((i = e.measured) == null ? void 0 : i.width) ?? e.width ?? e.initialWidth ?? 0,
    height: ((s = e.measured) == null ? void 0 : s.height) ?? e.height ?? e.initialHeight ?? 0
  };
}, Uv = (e, t = [0, 0]) => {
  var i, s;
  const { x: n, y: r } = qE(e) ? e.internals.positionAbsolute : F0(e, t);
  return {
    x: n,
    y: r,
    x2: n + (((i = e.measured) == null ? void 0 : i.width) ?? e.width ?? e.initialWidth ?? 0),
    y2: r + (((s = e.measured) == null ? void 0 : s.height) ?? e.height ?? e.initialHeight ?? 0)
  };
}, OP = (e, t) => vx(yx(fC(e), fC(t))), C0 = (e, t) => {
  const n = Math.max(0, Math.min(e.x + e.width, t.x + t.width) - Math.max(e.x, t.x)), r = Math.max(0, Math.min(e.y + e.height, t.y + t.height) - Math.max(e.y, t.y));
  return Math.ceil(n * r);
}, VT = (e) => To(e.width) && To(e.height) && To(e.x) && To(e.y), To = (e) => !isNaN(e) && isFinite(e), fae = (e, t) => {
}, $0 = (e, t = [1, 1]) => ({
  x: t[0] * Math.round(e.x / t[0]),
  y: t[1] * Math.round(e.y / t[1])
}), V0 = ({ x: e, y: t }, [n, r, i], s = !1, o = [1, 1]) => {
  const u = {
    x: (e - n) / i,
    y: (t - r) / i
  };
  return s ? $0(u, o) : u;
}, $v = ({ x: e, y: t }, [n, r, i]) => ({
  x: e * i + n,
  y: t * i + r
});
function um(e, t) {
  if (typeof e == "number")
    return Math.floor((t - t / (1 + e)) * 0.5);
  if (typeof e == "string" && e.endsWith("px")) {
    const n = parseFloat(e);
    if (!Number.isNaN(n))
      return Math.floor(n);
  }
  if (typeof e == "string" && e.endsWith("%")) {
    const n = parseFloat(e);
    if (!Number.isNaN(n))
      return Math.floor(t * n * 0.01);
  }
  return console.error(`[React Flow] The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`), 0;
}
function dae(e, t, n) {
  if (typeof e == "string" || typeof e == "number") {
    const r = um(e, n), i = um(e, t);
    return {
      top: r,
      right: i,
      bottom: r,
      left: i,
      x: i * 2,
      y: r * 2
    };
  }
  if (typeof e == "object") {
    const r = um(e.top ?? e.y ?? 0, n), i = um(e.bottom ?? e.y ?? 0, n), s = um(e.left ?? e.x ?? 0, t), o = um(e.right ?? e.x ?? 0, t);
    return { top: r, right: o, bottom: i, left: s, x: s + o, y: r + i };
  }
  return { top: 0, right: 0, bottom: 0, left: 0, x: 0, y: 0 };
}
function hae(e, t, n, r, i, s) {
  const { x: o, y: u } = $v(e, [t, n, r]), { x: c, y: d } = $v({ x: e.x + e.width, y: e.y + e.height }, [t, n, r]), m = i - c, p = s - d;
  return {
    left: Math.floor(o),
    top: Math.floor(u),
    right: Math.floor(m),
    bottom: Math.floor(p)
  };
}
const UE = (e, t, n, r, i, s) => {
  const o = dae(s, t, n), u = (t - o.x) / e.width, c = (n - o.y) / e.height, d = Math.min(u, c), m = Rm(d, r, i), p = e.x + e.width / 2, x = e.y + e.height / 2, b = t / 2 - p * m, S = n / 2 - x * m, k = hae(e, b, S, m, t, n), A = {
    left: Math.min(k.left - o.left, 0),
    top: Math.min(k.top - o.top, 0),
    right: Math.min(k.right - o.right, 0),
    bottom: Math.min(k.bottom - o.bottom, 0)
  };
  return {
    x: b - A.left + A.right,
    y: S - A.top + A.bottom,
    zoom: m
  };
}, E0 = () => {
  var e;
  return typeof navigator < "u" && ((e = navigator == null ? void 0 : navigator.userAgent) == null ? void 0 : e.indexOf("Mac")) >= 0;
};
function Dm(e) {
  return e != null && e !== "parent";
}
function Tu(e) {
  var t, n;
  return {
    width: ((t = e.measured) == null ? void 0 : t.width) ?? e.width ?? e.initialWidth ?? 0,
    height: ((n = e.measured) == null ? void 0 : n.height) ?? e.height ?? e.initialHeight ?? 0
  };
}
function DP(e) {
  var t, n;
  return (((t = e.measured) == null ? void 0 : t.width) ?? e.width ?? e.initialWidth) !== void 0 && (((n = e.measured) == null ? void 0 : n.height) ?? e.height ?? e.initialHeight) !== void 0;
}
function IP(e, t = { width: 0, height: 0 }, n, r, i) {
  const s = { ...e }, o = r.get(n);
  if (o) {
    const u = o.origin || i;
    s.x += o.internals.positionAbsolute.x - (t.width ?? 0) * u[0], s.y += o.internals.positionAbsolute.y - (t.height ?? 0) * u[1];
  }
  return s;
}
function HT(e, t) {
  if (e.size !== t.size)
    return !1;
  for (const n of e)
    if (!t.has(n))
      return !1;
  return !0;
}
function mae() {
  let e, t;
  return { promise: new Promise((r, i) => {
    e = r, t = i;
  }), resolve: e, reject: t };
}
function pae(e) {
  return { ...kP, ...e || {} };
}
function a0(e, { snapGrid: t = [0, 0], snapToGrid: n = !1, transform: r, containerBounds: i }) {
  const { x: s, y: o } = No(e), u = V0({ x: s - ((i == null ? void 0 : i.left) ?? 0), y: o - ((i == null ? void 0 : i.top) ?? 0) }, r), { x: c, y: d } = n ? $0(u, t) : u;
  return {
    xSnapped: c,
    ySnapped: d,
    ...u
  };
}
const $E = (e) => ({
  width: e.offsetWidth,
  height: e.offsetHeight
}), PP = (e) => {
  var t;
  return ((t = e == null ? void 0 : e.getRootNode) == null ? void 0 : t.call(e)) || (window == null ? void 0 : window.document);
}, gae = ["INPUT", "SELECT", "TEXTAREA"];
function zP(e) {
  var r, i;
  const t = ((i = (r = e.composedPath) == null ? void 0 : r.call(e)) == null ? void 0 : i[0]) || e.target;
  return (t == null ? void 0 : t.nodeType) !== 1 ? !1 : gae.includes(t.nodeName) || t.hasAttribute("contenteditable") || !!t.closest(".nokey");
}
const LP = (e) => "clientX" in e, No = (e, t) => {
  var s, o;
  const n = LP(e), r = n ? e.clientX : (s = e.touches) == null ? void 0 : s[0].clientX, i = n ? e.clientY : (o = e.touches) == null ? void 0 : o[0].clientY;
  return {
    x: r - ((t == null ? void 0 : t.left) ?? 0),
    y: i - ((t == null ? void 0 : t.top) ?? 0)
  };
}, GT = (e, t, n, r, i) => {
  const s = t.querySelectorAll(`.${e}`);
  return !s || !s.length ? null : Array.from(s).map((o) => {
    const u = o.getBoundingClientRect();
    return {
      id: o.getAttribute("data-handleid"),
      type: e,
      nodeId: i,
      position: o.getAttribute("data-handlepos"),
      x: (u.left - n.left) / r,
      y: (u.top - n.top) / r,
      ...$E(o)
    };
  });
};
function BP({ sourceX: e, sourceY: t, targetX: n, targetY: r, sourceControlX: i, sourceControlY: s, targetControlX: o, targetControlY: u }) {
  const c = e * 0.125 + i * 0.375 + o * 0.375 + n * 0.125, d = t * 0.125 + s * 0.375 + u * 0.375 + r * 0.125, m = Math.abs(c - e), p = Math.abs(d - t);
  return [c, d, m, p];
}
function X1(e, t) {
  return e >= 0 ? 0.5 * e : t * 25 * Math.sqrt(-e);
}
function KT({ pos: e, x1: t, y1: n, x2: r, y2: i, c: s }) {
  switch (e) {
    case gt.Left:
      return [t - X1(t - r, s), n];
    case gt.Right:
      return [t + X1(r - t, s), n];
    case gt.Top:
      return [t, n - X1(n - i, s)];
    case gt.Bottom:
      return [t, n + X1(i - n, s)];
  }
}
function qP({ sourceX: e, sourceY: t, sourcePosition: n = gt.Bottom, targetX: r, targetY: i, targetPosition: s = gt.Top, curvature: o = 0.25 }) {
  const [u, c] = KT({
    pos: n,
    x1: e,
    y1: t,
    x2: r,
    y2: i,
    c: o
  }), [d, m] = KT({
    pos: s,
    x1: r,
    y1: i,
    x2: e,
    y2: t,
    c: o
  }), [p, x, b, S] = BP({
    sourceX: e,
    sourceY: t,
    targetX: r,
    targetY: i,
    sourceControlX: u,
    sourceControlY: c,
    targetControlX: d,
    targetControlY: m
  });
  return [
    `M${e},${t} C${u},${c} ${d},${m} ${r},${i}`,
    p,
    x,
    b,
    S
  ];
}
function FP({ sourceX: e, sourceY: t, targetX: n, targetY: r }) {
  const i = Math.abs(n - e) / 2, s = n < e ? n + i : n - i, o = Math.abs(r - t) / 2, u = r < t ? r + o : r - o;
  return [s, u, i, o];
}
function yae({ sourceNode: e, targetNode: t, selected: n = !1, zIndex: r = 0, elevateOnSelect: i = !1, zIndexMode: s = "basic" }) {
  if (s === "manual")
    return r;
  const o = i && n ? r + 1e3 : r, u = Math.max(e.parentId || i && e.selected ? e.internals.z : 0, t.parentId || i && t.selected ? t.internals.z : 0);
  return o + u;
}
function vae({ sourceNode: e, targetNode: t, width: n, height: r, transform: i }) {
  const s = yx(Uv(e), Uv(t));
  s.x === s.x2 && (s.x2 += 1), s.y === s.y2 && (s.y2 += 1);
  const o = {
    x: -i[0] / i[2],
    y: -i[1] / i[2],
    width: n / i[2],
    height: r / i[2]
  };
  return C0(o, vx(s)) > 0;
}
const xae = ({ source: e, sourceHandle: t, target: n, targetHandle: r }) => `xy-edge__${e}${t || ""}-${n}${r || ""}`, bae = (e, t) => t.some((n) => n.source === e.source && n.target === e.target && (n.sourceHandle === e.sourceHandle || !n.sourceHandle && !e.sourceHandle) && (n.targetHandle === e.targetHandle || !n.targetHandle && !e.targetHandle)), wae = (e, t, n = {}) => {
  if (!e.source || !e.target)
    return t;
  const r = n.getEdgeId || xae;
  let i;
  return AP(e) ? i = { ...e } : i = {
    ...e,
    id: r(e)
  }, bae(i, t) ? t : (i.sourceHandle === null && delete i.sourceHandle, i.targetHandle === null && delete i.targetHandle, t.concat(i));
};
function UP({ sourceX: e, sourceY: t, targetX: n, targetY: r }) {
  const [i, s, o, u] = FP({
    sourceX: e,
    sourceY: t,
    targetX: n,
    targetY: r
  });
  return [`M ${e},${t}L ${n},${r}`, i, s, o, u];
}
const YT = {
  [gt.Left]: { x: -1, y: 0 },
  [gt.Right]: { x: 1, y: 0 },
  [gt.Top]: { x: 0, y: -1 },
  [gt.Bottom]: { x: 0, y: 1 }
}, _ae = ({ source: e, sourcePosition: t = gt.Bottom, target: n }) => t === gt.Left || t === gt.Right ? e.x < n.x ? { x: 1, y: 0 } : { x: -1, y: 0 } : e.y < n.y ? { x: 0, y: 1 } : { x: 0, y: -1 }, WT = (e, t) => Math.sqrt(Math.pow(t.x - e.x, 2) + Math.pow(t.y - e.y, 2));
function Sae({ source: e, sourcePosition: t = gt.Bottom, target: n, targetPosition: r = gt.Top, center: i, offset: s, stepPosition: o }) {
  const u = YT[t], c = YT[r], d = { x: e.x + u.x * s, y: e.y + u.y * s }, m = { x: n.x + c.x * s, y: n.y + c.y * s }, p = _ae({
    source: d,
    sourcePosition: t,
    target: m
  }), x = p.x !== 0 ? "x" : "y", b = p[x];
  let S = [], k, A;
  const T = { x: 0, y: 0 }, M = { x: 0, y: 0 }, [, , j, D] = FP({
    sourceX: e.x,
    sourceY: e.y,
    targetX: n.x,
    targetY: n.y
  });
  if (u[x] * c[x] === -1) {
    x === "x" ? (k = i.x ?? d.x + (m.x - d.x) * o, A = i.y ?? (d.y + m.y) / 2) : (k = i.x ?? (d.x + m.x) / 2, A = i.y ?? d.y + (m.y - d.y) * o);
    const I = [
      { x: k, y: d.y },
      { x: k, y: m.y }
    ], L = [
      { x: d.x, y: A },
      { x: m.x, y: A }
    ];
    u[x] === b ? S = x === "x" ? I : L : S = x === "x" ? L : I;
  } else {
    const I = [{ x: d.x, y: m.y }], L = [{ x: m.x, y: d.y }];
    if (x === "x" ? S = u.x === b ? L : I : S = u.y === b ? I : L, t === r) {
      const Z = Math.abs(e[x] - n[x]);
      if (Z <= s) {
        const me = Math.min(s - 1, s - Z);
        u[x] === b ? T[x] = (d[x] > e[x] ? -1 : 1) * me : M[x] = (m[x] > n[x] ? -1 : 1) * me;
      }
    }
    if (t !== r) {
      const Z = x === "x" ? "y" : "x", me = u[x] === c[Z], Q = d[Z] > m[Z], se = d[Z] < m[Z];
      (u[x] === 1 && (!me && Q || me && se) || u[x] !== 1 && (!me && se || me && Q)) && (S = x === "x" ? I : L);
    }
    const K = { x: d.x + T.x, y: d.y + T.y }, ne = { x: m.x + M.x, y: m.y + M.y }, Y = Math.max(Math.abs(K.x - S[0].x), Math.abs(ne.x - S[0].x)), H = Math.max(Math.abs(K.y - S[0].y), Math.abs(ne.y - S[0].y));
    Y >= H ? (k = (K.x + ne.x) / 2, A = S[0].y) : (k = S[0].x, A = (K.y + ne.y) / 2);
  }
  return [[
    e,
    { x: d.x + T.x, y: d.y + T.y },
    ...S,
    { x: m.x + M.x, y: m.y + M.y },
    n
  ], k, A, j, D];
}
function Cae(e, t, n, r) {
  const i = Math.min(WT(e, t) / 2, WT(t, n) / 2, r), { x: s, y: o } = t;
  if (e.x === s && s === n.x || e.y === o && o === n.y)
    return `L${s} ${o}`;
  if (e.y === o) {
    const d = e.x < n.x ? -1 : 1, m = e.y < n.y ? 1 : -1;
    return `L ${s + i * d},${o}Q ${s},${o} ${s},${o + i * m}`;
  }
  const u = e.x < n.x ? 1 : -1, c = e.y < n.y ? -1 : 1;
  return `L ${s},${o + i * c}Q ${s},${o} ${s + i * u},${o}`;
}
function dC({ sourceX: e, sourceY: t, sourcePosition: n = gt.Bottom, targetX: r, targetY: i, targetPosition: s = gt.Top, borderRadius: o = 5, centerX: u, centerY: c, offset: d = 20, stepPosition: m = 0.5 }) {
  const [p, x, b, S, k] = Sae({
    source: { x: e, y: t },
    sourcePosition: n,
    target: { x: r, y: i },
    targetPosition: s,
    center: { x: u, y: c },
    offset: d,
    stepPosition: m
  });
  return [p.reduce((T, M, j) => {
    let D = "";
    return j > 0 && j < p.length - 1 ? D = Cae(p[j - 1], M, p[j + 1], o) : D = `${j === 0 ? "M" : "L"}${M.x} ${M.y}`, T += D, T;
  }, ""), x, b, S, k];
}
function XT(e) {
  var t;
  return e && !!(e.internals.handleBounds || (t = e.handles) != null && t.length) && !!(e.measured.width || e.width || e.initialWidth);
}
function Eae(e) {
  var p;
  const { sourceNode: t, targetNode: n } = e;
  if (!XT(t) || !XT(n))
    return null;
  const r = t.internals.handleBounds || QT(t.handles), i = n.internals.handleBounds || QT(n.handles), s = ZT((r == null ? void 0 : r.source) ?? [], e.sourceHandle), o = ZT(
    // when connection type is loose we can define all handles as sources and connect source -> source
    e.connectionMode === Mm.Strict ? (i == null ? void 0 : i.target) ?? [] : ((i == null ? void 0 : i.target) ?? []).concat((i == null ? void 0 : i.source) ?? []),
    e.targetHandle
  );
  if (!s || !o)
    return (p = e.onError) == null || p.call(e, "008", Ol.error008(s ? "target" : "source", {
      id: e.id,
      sourceHandle: e.sourceHandle,
      targetHandle: e.targetHandle
    })), null;
  const u = (s == null ? void 0 : s.position) || gt.Bottom, c = (o == null ? void 0 : o.position) || gt.Top, d = zd(t, s, u), m = zd(n, o, c);
  return {
    sourceX: d.x,
    sourceY: d.y,
    targetX: m.x,
    targetY: m.y,
    sourcePosition: u,
    targetPosition: c
  };
}
function QT(e) {
  if (!e)
    return null;
  const t = [], n = [];
  for (const r of e)
    r.width = r.width ?? 1, r.height = r.height ?? 1, r.type === "source" ? t.push(r) : r.type === "target" && n.push(r);
  return {
    source: t,
    target: n
  };
}
function zd(e, t, n = gt.Left, r = !1) {
  const i = ((t == null ? void 0 : t.x) ?? 0) + e.internals.positionAbsolute.x, s = ((t == null ? void 0 : t.y) ?? 0) + e.internals.positionAbsolute.y, { width: o, height: u } = t ?? Tu(e);
  if (r)
    return { x: i + o / 2, y: s + u / 2 };
  switch ((t == null ? void 0 : t.position) ?? n) {
    case gt.Top:
      return { x: i + o / 2, y: s };
    case gt.Right:
      return { x: i + o, y: s + u / 2 };
    case gt.Bottom:
      return { x: i + o / 2, y: s + u };
    case gt.Left:
      return { x: i, y: s + u / 2 };
  }
}
function ZT(e, t) {
  return e && (t ? e.find((n) => n.id === t) : e[0]) || null;
}
function hC(e, t) {
  return e ? typeof e == "string" ? e : `${t ? `${t}__` : ""}${Object.keys(e).sort().map((r) => `${r}=${e[r]}`).join("&")}` : "";
}
function kae(e, { id: t, defaultColor: n, defaultMarkerStart: r, defaultMarkerEnd: i }) {
  const s = /* @__PURE__ */ new Set();
  return e.reduce((o, u) => ([u.markerStart || r, u.markerEnd || i].forEach((c) => {
    if (c && typeof c == "object") {
      const d = hC(c, t);
      s.has(d) || (o.push({ id: d, color: c.color || n, ...c }), s.add(d));
    }
  }), o), []).sort((o, u) => o.id.localeCompare(u.id));
}
const $P = 1e3, Tae = 10, VE = {
  nodeOrigin: [0, 0],
  nodeExtent: w0,
  elevateNodesOnSelect: !0,
  zIndexMode: "basic",
  defaults: {}
}, Nae = {
  ...VE,
  checkEquality: !0
};
function HE(e, t) {
  const n = { ...e };
  for (const r in t)
    t[r] !== void 0 && (n[r] = t[r]);
  return n;
}
function Aae(e, t, n) {
  const r = HE(VE, n);
  for (const i of e.values())
    if (i.parentId)
      KE(i, e, t, r);
    else {
      const s = F0(i, r.nodeOrigin), o = Dm(i.extent) ? i.extent : r.nodeExtent, u = Pd(s, o, Tu(i));
      i.internals.positionAbsolute = u;
    }
}
function jae(e, t) {
  if (!e.handles)
    return e.measured ? t == null ? void 0 : t.internals.handleBounds : void 0;
  const n = [], r = [];
  for (const i of e.handles) {
    const s = {
      id: i.id,
      width: i.width ?? 1,
      height: i.height ?? 1,
      nodeId: e.id,
      x: i.x,
      y: i.y,
      position: i.position,
      type: i.type
    };
    i.type === "source" ? n.push(s) : i.type === "target" && r.push(s);
  }
  return {
    source: n,
    target: r
  };
}
function GE(e) {
  return e === "manual";
}
function mC(e, t, n, r = {}) {
  var d, m;
  const i = HE(Nae, r), s = { i: 0 }, o = new Map(t), u = i != null && i.elevateNodesOnSelect && !GE(i.zIndexMode) ? $P : 0;
  let c = e.length > 0;
  t.clear(), n.clear();
  for (const p of e) {
    let x = o.get(p.id);
    if (i.checkEquality && p === (x == null ? void 0 : x.internals.userNode))
      t.set(p.id, x);
    else {
      const b = F0(p, i.nodeOrigin), S = Dm(p.extent) ? p.extent : i.nodeExtent, k = Pd(b, S, Tu(p));
      x = {
        ...i.defaults,
        ...p,
        measured: {
          width: (d = p.measured) == null ? void 0 : d.width,
          height: (m = p.measured) == null ? void 0 : m.height
        },
        internals: {
          positionAbsolute: k,
          // if user re-initializes the node or removes `measured` for whatever reason, we reset the handleBounds so that the node gets re-measured
          handleBounds: jae(p, x),
          z: VP(p, u, i.zIndexMode),
          userNode: p
        }
      }, t.set(p.id, x);
    }
    (x.measured === void 0 || x.measured.width === void 0 || x.measured.height === void 0) && !x.hidden && (c = !1), p.parentId && KE(x, t, n, r, s);
  }
  return c;
}
function Mae(e, t) {
  if (!e.parentId)
    return;
  const n = t.get(e.parentId);
  n ? n.set(e.id, e) : t.set(e.parentId, /* @__PURE__ */ new Map([[e.id, e]]));
}
function KE(e, t, n, r, i) {
  const { elevateNodesOnSelect: s, nodeOrigin: o, nodeExtent: u, zIndexMode: c } = HE(VE, r), d = e.parentId, m = t.get(d);
  if (!m) {
    console.warn(`Parent node ${d} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);
    return;
  }
  Mae(e, n), i && !m.parentId && m.internals.rootParentIndex === void 0 && c === "auto" && (m.internals.rootParentIndex = ++i.i, m.internals.z = m.internals.z + i.i * Tae), i && m.internals.rootParentIndex !== void 0 && (i.i = m.internals.rootParentIndex);
  const p = s && !GE(c) ? $P : 0, { x, y: b, z: S } = Rae(e, m, o, u, p, c), { positionAbsolute: k } = e.internals, A = x !== k.x || b !== k.y;
  (A || S !== e.internals.z) && t.set(e.id, {
    ...e,
    internals: {
      ...e.internals,
      positionAbsolute: A ? { x, y: b } : k,
      z: S
    }
  });
}
function VP(e, t, n) {
  const r = To(e.zIndex) ? e.zIndex : 0;
  return GE(n) ? r : r + (e.selected ? t : 0);
}
function Rae(e, t, n, r, i, s) {
  const { x: o, y: u } = t.internals.positionAbsolute, c = Tu(e), d = F0(e, n), m = Dm(e.extent) ? Pd(d, e.extent, c) : d;
  let p = Pd({ x: o + m.x, y: u + m.y }, r, c);
  e.extent === "parent" && (p = MP(p, c, t));
  const x = VP(e, i, s), b = t.internals.z ?? 0;
  return {
    x: p.x,
    y: p.y,
    z: b >= x ? b + 1 : x
  };
}
function YE(e, t, n, r = [0, 0]) {
  var o;
  const i = [], s = /* @__PURE__ */ new Map();
  for (const u of e) {
    const c = t.get(u.parentId);
    if (!c)
      continue;
    const d = ((o = s.get(u.parentId)) == null ? void 0 : o.expandedRect) ?? Om(c), m = OP(d, u.rect);
    s.set(u.parentId, { expandedRect: m, parent: c });
  }
  return s.size > 0 && s.forEach(({ expandedRect: u, parent: c }, d) => {
    var j;
    const m = c.internals.positionAbsolute, p = Tu(c), x = c.origin ?? r, b = u.x < m.x ? Math.round(Math.abs(m.x - u.x)) : 0, S = u.y < m.y ? Math.round(Math.abs(m.y - u.y)) : 0, k = Math.max(p.width, Math.round(u.width)), A = Math.max(p.height, Math.round(u.height)), T = (k - p.width) * x[0], M = (A - p.height) * x[1];
    (b > 0 || S > 0 || T || M) && (i.push({
      id: d,
      type: "position",
      position: {
        x: c.position.x - b + T,
        y: c.position.y - S + M
      }
    }), (j = n.get(d)) == null || j.forEach((D) => {
      e.some((z) => z.id === D.id) || i.push({
        id: D.id,
        type: "position",
        position: {
          x: D.position.x + b,
          y: D.position.y + S
        }
      });
    })), (p.width < u.width || p.height < u.height || b || S) && i.push({
      id: d,
      type: "dimensions",
      setAttributes: !0,
      dimensions: {
        width: k + (b ? x[0] * b - T : 0),
        height: A + (S ? x[1] * S - M : 0)
      }
    });
  }), i;
}
function Oae(e, t, n, r, i, s, o) {
  const u = r == null ? void 0 : r.querySelector(".xyflow__viewport");
  let c = !1;
  if (!u)
    return { changes: [], updatedInternals: c };
  const d = [], m = window.getComputedStyle(u), { m22: p } = new window.DOMMatrixReadOnly(m.transform), x = [];
  for (const b of e.values()) {
    const S = t.get(b.id);
    if (!S)
      continue;
    if (S.hidden) {
      t.set(S.id, {
        ...S,
        internals: {
          ...S.internals,
          handleBounds: void 0
        }
      }), c = !0;
      continue;
    }
    const k = $E(b.nodeElement), A = S.measured.width !== k.width || S.measured.height !== k.height;
    if (!!(k.width && k.height && (A || !S.internals.handleBounds || b.force))) {
      const M = b.nodeElement.getBoundingClientRect(), j = Dm(S.extent) ? S.extent : s;
      let { positionAbsolute: D } = S.internals;
      S.parentId && S.extent === "parent" ? D = MP(D, k, t.get(S.parentId)) : j && (D = Pd(D, j, k));
      const z = {
        ...S,
        measured: k,
        internals: {
          ...S.internals,
          positionAbsolute: D,
          handleBounds: {
            source: GT("source", b.nodeElement, M, p, S.id),
            target: GT("target", b.nodeElement, M, p, S.id)
          }
        }
      };
      t.set(S.id, z), S.parentId && KE(z, t, n, { nodeOrigin: i, zIndexMode: o }), c = !0, A && (d.push({
        id: S.id,
        type: "dimensions",
        dimensions: k
      }), S.expandParent && S.parentId && x.push({
        id: S.id,
        parentId: S.parentId,
        rect: Om(z, i)
      }));
    }
  }
  if (x.length > 0) {
    const b = YE(x, t, n, i);
    d.push(...b);
  }
  return { changes: d, updatedInternals: c };
}
async function Dae({ delta: e, panZoom: t, transform: n, translateExtent: r, width: i, height: s }) {
  if (!t || !e.x && !e.y)
    return Promise.resolve(!1);
  const o = await t.setViewportConstrained({
    x: n[0] + e.x,
    y: n[1] + e.y,
    zoom: n[2]
  }, [
    [0, 0],
    [i, s]
  ], r), u = !!o && (o.x !== n[0] || o.y !== n[1] || o.k !== n[2]);
  return Promise.resolve(u);
}
function JT(e, t, n, r, i, s) {
  let o = i;
  const u = r.get(o) || /* @__PURE__ */ new Map();
  r.set(o, u.set(n, t)), o = `${i}-${e}`;
  const c = r.get(o) || /* @__PURE__ */ new Map();
  if (r.set(o, c.set(n, t)), s) {
    o = `${i}-${e}-${s}`;
    const d = r.get(o) || /* @__PURE__ */ new Map();
    r.set(o, d.set(n, t));
  }
}
function HP(e, t, n) {
  e.clear(), t.clear();
  for (const r of n) {
    const { source: i, target: s, sourceHandle: o = null, targetHandle: u = null } = r, c = { edgeId: r.id, source: i, target: s, sourceHandle: o, targetHandle: u }, d = `${i}-${o}--${s}-${u}`, m = `${s}-${u}--${i}-${o}`;
    JT("source", c, m, e, i, o), JT("target", c, d, e, s, u), t.set(r.id, r);
  }
}
function GP(e, t) {
  if (!e.parentId)
    return !1;
  const n = t.get(e.parentId);
  return n ? n.selected ? !0 : GP(n, t) : !1;
}
function eN(e, t, n) {
  var i;
  let r = e;
  do {
    if ((i = r == null ? void 0 : r.matches) != null && i.call(r, t))
      return !0;
    if (r === n)
      return !1;
    r = r == null ? void 0 : r.parentElement;
  } while (r);
  return !1;
}
function Iae(e, t, n, r) {
  const i = /* @__PURE__ */ new Map();
  for (const [s, o] of e)
    if ((o.selected || o.id === r) && (!o.parentId || !GP(o, e)) && (o.draggable || t && typeof o.draggable > "u")) {
      const u = e.get(s);
      u && i.set(s, {
        id: s,
        position: u.position || { x: 0, y: 0 },
        distance: {
          x: n.x - u.internals.positionAbsolute.x,
          y: n.y - u.internals.positionAbsolute.y
        },
        extent: u.extent,
        parentId: u.parentId,
        origin: u.origin,
        expandParent: u.expandParent,
        internals: {
          positionAbsolute: u.internals.positionAbsolute || { x: 0, y: 0 }
        },
        measured: {
          width: u.measured.width ?? 0,
          height: u.measured.height ?? 0
        }
      });
    }
  return i;
}
function D2({ nodeId: e, dragItems: t, nodeLookup: n, dragging: r = !0 }) {
  var o, u, c;
  const i = [];
  for (const [d, m] of t) {
    const p = (o = n.get(d)) == null ? void 0 : o.internals.userNode;
    p && i.push({
      ...p,
      position: m.position,
      dragging: r
    });
  }
  if (!e)
    return [i[0], i];
  const s = (u = n.get(e)) == null ? void 0 : u.internals.userNode;
  return [
    s ? {
      ...s,
      position: ((c = t.get(e)) == null ? void 0 : c.position) || s.position,
      dragging: r
    } : i[0],
    i
  ];
}
function Pae({ dragItems: e, snapGrid: t, x: n, y: r }) {
  const i = e.values().next().value;
  if (!i)
    return null;
  const s = {
    x: n - i.distance.x,
    y: r - i.distance.y
  }, o = $0(s, t);
  return {
    x: o.x - s.x,
    y: o.y - s.y
  };
}
function zae({ onNodeMouseDown: e, getStoreItems: t, onDragStart: n, onDrag: r, onDragStop: i }) {
  let s = { x: null, y: null }, o = 0, u = /* @__PURE__ */ new Map(), c = !1, d = { x: 0, y: 0 }, m = null, p = !1, x = null, b = !1, S = !1, k = null;
  function A({ noDragClassName: M, handleSelector: j, domNode: D, isSelectable: z, nodeId: I, nodeClickDistance: L = 0 }) {
    x = hs(D);
    function K({ x: Z, y: me }) {
      const { nodeLookup: Q, nodeExtent: se, snapGrid: J, snapToGrid: ue, nodeOrigin: de, onNodeDrag: ce, onSelectionDrag: W, onError: $, updateNodePositions: fe } = t();
      s = { x: Z, y: me };
      let G = !1;
      const le = u.size > 1, xe = le && se ? fC(U0(u)) : null, Se = le && ue ? Pae({
        dragItems: u,
        snapGrid: J,
        x: Z,
        y: me
      }) : null;
      for (const [Oe, Be] of u) {
        if (!Q.has(Oe))
          continue;
        let Re = { x: Z - Be.distance.x, y: me - Be.distance.y };
        ue && (Re = Se ? {
          x: Math.round(Re.x + Se.x),
          y: Math.round(Re.y + Se.y)
        } : $0(Re, J));
        let ft = null;
        if (le && se && !Be.extent && xe) {
          const { positionAbsolute: Ue } = Be.internals, et = Ue.x - xe.x + se[0][0], tt = Ue.x + Be.measured.width - xe.x2 + se[1][0], st = Ue.y - xe.y + se[0][1], dt = Ue.y + Be.measured.height - xe.y2 + se[1][1];
          ft = [
            [et, st],
            [tt, dt]
          ];
        }
        const { position: Ie, positionAbsolute: Ne } = jP({
          nodeId: Oe,
          nextPosition: Re,
          nodeLookup: Q,
          nodeExtent: ft || se,
          nodeOrigin: de,
          onError: $
        });
        G = G || Be.position.x !== Ie.x || Be.position.y !== Ie.y, Be.position = Ie, Be.internals.positionAbsolute = Ne;
      }
      if (S = S || G, !!G && (fe(u, !0), k && (r || ce || !I && W))) {
        const [Oe, Be] = D2({
          nodeId: I,
          dragItems: u,
          nodeLookup: Q
        });
        r == null || r(k, u, Oe, Be), ce == null || ce(k, Oe, Be), I || W == null || W(k, Be);
      }
    }
    async function ne() {
      if (!m)
        return;
      const { transform: Z, panBy: me, autoPanSpeed: Q, autoPanOnNodeDrag: se } = t();
      if (!se) {
        c = !1, cancelAnimationFrame(o);
        return;
      }
      const [J, ue] = RP(d, m, Q);
      (J !== 0 || ue !== 0) && (s.x = (s.x ?? 0) - J / Z[2], s.y = (s.y ?? 0) - ue / Z[2], await me({ x: J, y: ue }) && K(s)), o = requestAnimationFrame(ne);
    }
    function Y(Z) {
      var le;
      const { nodeLookup: me, multiSelectionActive: Q, nodesDraggable: se, transform: J, snapGrid: ue, snapToGrid: de, selectNodesOnDrag: ce, onNodeDragStart: W, onSelectionDragStart: $, unselectNodesAndEdges: fe } = t();
      p = !0, (!ce || !z) && !Q && I && ((le = me.get(I)) != null && le.selected || fe()), z && ce && I && (e == null || e(I));
      const G = a0(Z.sourceEvent, { transform: J, snapGrid: ue, snapToGrid: de, containerBounds: m });
      if (s = G, u = Iae(me, se, G, I), u.size > 0 && (n || W || !I && $)) {
        const [xe, Se] = D2({
          nodeId: I,
          dragItems: u,
          nodeLookup: me
        });
        n == null || n(Z.sourceEvent, u, xe, Se), W == null || W(Z.sourceEvent, xe, Se), I || $ == null || $(Z.sourceEvent, Se);
      }
    }
    const H = uP().clickDistance(L).on("start", (Z) => {
      const { domNode: me, nodeDragThreshold: Q, transform: se, snapGrid: J, snapToGrid: ue } = t();
      m = (me == null ? void 0 : me.getBoundingClientRect()) || null, b = !1, S = !1, k = Z.sourceEvent, Q === 0 && Y(Z), s = a0(Z.sourceEvent, { transform: se, snapGrid: J, snapToGrid: ue, containerBounds: m }), d = No(Z.sourceEvent, m);
    }).on("drag", (Z) => {
      const { autoPanOnNodeDrag: me, transform: Q, snapGrid: se, snapToGrid: J, nodeDragThreshold: ue, nodeLookup: de } = t(), ce = a0(Z.sourceEvent, { transform: Q, snapGrid: se, snapToGrid: J, containerBounds: m });
      if (k = Z.sourceEvent, (Z.sourceEvent.type === "touchmove" && Z.sourceEvent.touches.length > 1 || // if user deletes a node while dragging, we need to abort the drag to prevent errors
      I && !de.has(I)) && (b = !0), !b) {
        if (!c && me && p && (c = !0, ne()), !p) {
          const W = No(Z.sourceEvent, m), $ = W.x - d.x, fe = W.y - d.y;
          Math.sqrt($ * $ + fe * fe) > ue && Y(Z);
        }
        (s.x !== ce.xSnapped || s.y !== ce.ySnapped) && u && p && (d = No(Z.sourceEvent, m), K(ce));
      }
    }).on("end", (Z) => {
      if (!(!p || b) && (c = !1, p = !1, cancelAnimationFrame(o), u.size > 0)) {
        const { nodeLookup: me, updateNodePositions: Q, onNodeDragStop: se, onSelectionDragStop: J } = t();
        if (S && (Q(u, !1), S = !1), i || se || !I && J) {
          const [ue, de] = D2({
            nodeId: I,
            dragItems: u,
            nodeLookup: me,
            dragging: !1
          });
          i == null || i(Z.sourceEvent, u, ue, de), se == null || se(Z.sourceEvent, ue, de), I || J == null || J(Z.sourceEvent, de);
        }
      }
    }).filter((Z) => {
      const me = Z.target;
      return !Z.button && (!M || !eN(me, `.${M}`, D)) && (!j || eN(me, j, D));
    });
    x.call(H);
  }
  function T() {
    x == null || x.on(".drag", null);
  }
  return {
    update: A,
    destroy: T
  };
}
function Lae(e, t, n) {
  const r = [], i = {
    x: e.x - n,
    y: e.y - n,
    width: n * 2,
    height: n * 2
  };
  for (const s of t.values())
    C0(i, Om(s)) > 0 && r.push(s);
  return r;
}
const Bae = 250;
function qae(e, t, n, r) {
  var u, c;
  let i = [], s = 1 / 0;
  const o = Lae(e, n, t + Bae);
  for (const d of o) {
    const m = [...((u = d.internals.handleBounds) == null ? void 0 : u.source) ?? [], ...((c = d.internals.handleBounds) == null ? void 0 : c.target) ?? []];
    for (const p of m) {
      if (r.nodeId === p.nodeId && r.type === p.type && r.id === p.id)
        continue;
      const { x, y: b } = zd(d, p, p.position, !0), S = Math.sqrt(Math.pow(x - e.x, 2) + Math.pow(b - e.y, 2));
      S > t || (S < s ? (i = [{ ...p, x, y: b }], s = S) : S === s && i.push({ ...p, x, y: b }));
    }
  }
  if (!i.length)
    return null;
  if (i.length > 1) {
    const d = r.type === "source" ? "target" : "source";
    return i.find((m) => m.type === d) ?? i[0];
  }
  return i[0];
}
function KP(e, t, n, r, i, s = !1) {
  var d, m, p;
  const o = r.get(e);
  if (!o)
    return null;
  const u = i === "strict" ? (d = o.internals.handleBounds) == null ? void 0 : d[t] : [...((m = o.internals.handleBounds) == null ? void 0 : m.source) ?? [], ...((p = o.internals.handleBounds) == null ? void 0 : p.target) ?? []], c = (n ? u == null ? void 0 : u.find((x) => x.id === n) : u == null ? void 0 : u[0]) ?? null;
  return c && s ? { ...c, ...zd(o, c, c.position, !0) } : c;
}
function YP(e, t) {
  return e || (t != null && t.classList.contains("target") ? "target" : t != null && t.classList.contains("source") ? "source" : null);
}
function Fae(e, t) {
  let n = null;
  return t ? n = !0 : e && !t && (n = !1), n;
}
const WP = () => !0;
function Uae(e, { connectionMode: t, connectionRadius: n, handleId: r, nodeId: i, edgeUpdaterType: s, isTarget: o, domNode: u, nodeLookup: c, lib: d, autoPanOnConnect: m, flowId: p, panBy: x, cancelConnection: b, onConnectStart: S, onConnect: k, onConnectEnd: A, isValidConnection: T = WP, onReconnectEnd: M, updateConnection: j, getTransform: D, getFromHandle: z, autoPanSpeed: I, dragThreshold: L = 1, handleDomNode: K }) {
  const ne = PP(e.target);
  let Y = 0, H;
  const { x: Z, y: me } = No(e), Q = YP(s, K), se = u == null ? void 0 : u.getBoundingClientRect();
  let J = !1;
  if (!se || !Q)
    return;
  const ue = KP(i, Q, r, c, t);
  if (!ue)
    return;
  let de = No(e, se), ce = !1, W = null, $ = !1, fe = null;
  function G() {
    if (!m || !se)
      return;
    const [Ie, Ne] = RP(de, se, I);
    x({ x: Ie, y: Ne }), Y = requestAnimationFrame(G);
  }
  const le = {
    ...ue,
    nodeId: i,
    type: Q,
    position: ue.position
  }, xe = c.get(i);
  let Oe = {
    inProgress: !0,
    isValid: null,
    from: zd(xe, le, gt.Left, !0),
    fromHandle: le,
    fromPosition: le.position,
    fromNode: xe,
    to: de,
    toHandle: null,
    toPosition: UT[le.position],
    toNode: null,
    pointer: de
  };
  function Be() {
    J = !0, j(Oe), S == null || S(e, { nodeId: i, handleId: r, handleType: Q });
  }
  L === 0 && Be();
  function Re(Ie) {
    if (!J) {
      const { x: dt, y: Wn } = No(Ie), Rn = dt - Z, Un = Wn - me;
      if (!(Rn * Rn + Un * Un > L * L))
        return;
      Be();
    }
    if (!z() || !le) {
      ft(Ie);
      return;
    }
    const Ne = D();
    de = No(Ie, se), H = qae(V0(de, Ne, !1, [1, 1]), n, c, le), ce || (G(), ce = !0);
    const Ue = XP(Ie, {
      handle: H,
      connectionMode: t,
      fromNodeId: i,
      fromHandleId: r,
      fromType: o ? "target" : "source",
      isValidConnection: T,
      doc: ne,
      lib: d,
      flowId: p,
      nodeLookup: c
    });
    fe = Ue.handleDomNode, W = Ue.connection, $ = Fae(!!H, Ue.isValid);
    const et = c.get(i), tt = et ? zd(et, le, gt.Left, !0) : Oe.from, st = {
      ...Oe,
      from: tt,
      isValid: $,
      to: Ue.toHandle && $ ? $v({ x: Ue.toHandle.x, y: Ue.toHandle.y }, Ne) : de,
      toHandle: Ue.toHandle,
      toPosition: $ && Ue.toHandle ? Ue.toHandle.position : UT[le.position],
      toNode: Ue.toHandle ? c.get(Ue.toHandle.nodeId) : null,
      pointer: de
    };
    j(st), Oe = st;
  }
  function ft(Ie) {
    if (!("touches" in Ie && Ie.touches.length > 0)) {
      if (J) {
        (H || fe) && W && $ && (k == null || k(W));
        const { inProgress: Ne, ...Ue } = Oe, et = {
          ...Ue,
          toPosition: Oe.toHandle ? Oe.toPosition : null
        };
        A == null || A(Ie, et), s && (M == null || M(Ie, et));
      }
      b(), cancelAnimationFrame(Y), ce = !1, $ = !1, W = null, fe = null, ne.removeEventListener("mousemove", Re), ne.removeEventListener("mouseup", ft), ne.removeEventListener("touchmove", Re), ne.removeEventListener("touchend", ft);
    }
  }
  ne.addEventListener("mousemove", Re), ne.addEventListener("mouseup", ft), ne.addEventListener("touchmove", Re), ne.addEventListener("touchend", ft);
}
function XP(e, { handle: t, connectionMode: n, fromNodeId: r, fromHandleId: i, fromType: s, doc: o, lib: u, flowId: c, isValidConnection: d = WP, nodeLookup: m }) {
  const p = s === "target", x = t ? o.querySelector(`.${u}-flow__handle[data-id="${c}-${t == null ? void 0 : t.nodeId}-${t == null ? void 0 : t.id}-${t == null ? void 0 : t.type}"]`) : null, { x: b, y: S } = No(e), k = o.elementFromPoint(b, S), A = k != null && k.classList.contains(`${u}-flow__handle`) ? k : x, T = {
    handleDomNode: A,
    isValid: !1,
    connection: null,
    toHandle: null
  };
  if (A) {
    const M = YP(void 0, A), j = A.getAttribute("data-nodeid"), D = A.getAttribute("data-handleid"), z = A.classList.contains("connectable"), I = A.classList.contains("connectableend");
    if (!j || !M)
      return T;
    const L = {
      source: p ? j : r,
      sourceHandle: p ? D : i,
      target: p ? r : j,
      targetHandle: p ? i : D
    };
    T.connection = L;
    const ne = z && I && (n === Mm.Strict ? p && M === "source" || !p && M === "target" : j !== r || D !== i);
    T.isValid = ne && d(L), T.toHandle = KP(j, M, D, m, n, !0);
  }
  return T;
}
const pC = {
  onPointerDown: Uae,
  isValid: XP
};
function $ae({ domNode: e, panZoom: t, getTransform: n, getViewScale: r }) {
  const i = hs(e);
  function s({ translateExtent: u, width: c, height: d, zoomStep: m = 1, pannable: p = !0, zoomable: x = !0, inversePan: b = !1 }) {
    const S = (j) => {
      if (j.sourceEvent.type !== "wheel" || !t)
        return;
      const D = n(), z = j.sourceEvent.ctrlKey && E0() ? 10 : 1, I = -j.sourceEvent.deltaY * (j.sourceEvent.deltaMode === 1 ? 0.05 : j.sourceEvent.deltaMode ? 1 : 2e-3) * m, L = D[2] * Math.pow(2, I * z);
      t.scaleTo(L);
    };
    let k = [0, 0];
    const A = (j) => {
      (j.sourceEvent.type === "mousedown" || j.sourceEvent.type === "touchstart") && (k = [
        j.sourceEvent.clientX ?? j.sourceEvent.touches[0].clientX,
        j.sourceEvent.clientY ?? j.sourceEvent.touches[0].clientY
      ]);
    }, T = (j) => {
      const D = n();
      if (j.sourceEvent.type !== "mousemove" && j.sourceEvent.type !== "touchmove" || !t)
        return;
      const z = [
        j.sourceEvent.clientX ?? j.sourceEvent.touches[0].clientX,
        j.sourceEvent.clientY ?? j.sourceEvent.touches[0].clientY
      ], I = [z[0] - k[0], z[1] - k[1]];
      k = z;
      const L = r() * Math.max(D[2], Math.log(D[2])) * (b ? -1 : 1), K = {
        x: D[0] - I[0] * L,
        y: D[1] - I[1] * L
      }, ne = [
        [0, 0],
        [c, d]
      ];
      t.setViewportConstrained({
        x: K.x,
        y: K.y,
        zoom: D[2]
      }, ne, u);
    }, M = CP().on("start", A).on("zoom", p ? T : null).on("zoom.wheel", x ? S : null);
    i.call(M, {});
  }
  function o() {
    i.on("zoom", null);
  }
  return {
    update: s,
    destroy: o,
    pointer: _o
  };
}
const xx = (e) => ({
  x: e.x,
  y: e.y,
  zoom: e.k
}), I2 = ({ x: e, y: t, zoom: n }) => gx.translate(e, t).scale(n), bm = (e, t) => e.target.closest(`.${t}`), QP = (e, t) => t === 2 && Array.isArray(e) && e.includes(2), Vae = (e) => ((e *= 2) <= 1 ? e * e * e : (e -= 2) * e * e + 2) / 2, P2 = (e, t = 0, n = Vae, r = () => {
}) => {
  const i = typeof t == "number" && t > 0;
  return i || r(), i ? e.transition().duration(t).ease(n).on("end", r) : e;
}, ZP = (e) => {
  const t = e.ctrlKey && E0() ? 10 : 1;
  return -e.deltaY * (e.deltaMode === 1 ? 0.05 : e.deltaMode ? 1 : 2e-3) * t;
};
function Hae({ zoomPanValues: e, noWheelClassName: t, d3Selection: n, d3Zoom: r, panOnScrollMode: i, panOnScrollSpeed: s, zoomOnPinch: o, onPanZoomStart: u, onPanZoom: c, onPanZoomEnd: d }) {
  return (m) => {
    if (bm(m, t))
      return m.ctrlKey && m.preventDefault(), !1;
    m.preventDefault(), m.stopImmediatePropagation();
    const p = n.property("__zoom").k || 1;
    if (m.ctrlKey && o) {
      const A = _o(m), T = ZP(m), M = p * Math.pow(2, T);
      r.scaleTo(n, M, A, m);
      return;
    }
    const x = m.deltaMode === 1 ? 20 : 1;
    let b = i === Nd.Vertical ? 0 : m.deltaX * x, S = i === Nd.Horizontal ? 0 : m.deltaY * x;
    !E0() && m.shiftKey && i !== Nd.Vertical && (b = m.deltaY * x, S = 0), r.translateBy(
      n,
      -(b / p) * s,
      -(S / p) * s,
      // @ts-ignore
      { internal: !0 }
    );
    const k = xx(n.property("__zoom"));
    clearTimeout(e.panScrollTimeout), e.isPanScrolling ? (c == null || c(m, k), e.panScrollTimeout = setTimeout(() => {
      d == null || d(m, k), e.isPanScrolling = !1;
    }, 150)) : (e.isPanScrolling = !0, u == null || u(m, k));
  };
}
function Gae({ noWheelClassName: e, preventScrolling: t, d3ZoomHandler: n }) {
  return function(r, i) {
    const s = r.type === "wheel", o = !t && s && !r.ctrlKey, u = bm(r, e);
    if (r.ctrlKey && s && u && r.preventDefault(), o || u)
      return null;
    r.preventDefault(), n.call(this, r, i);
  };
}
function Kae({ zoomPanValues: e, onDraggingChange: t, onPanZoomStart: n }) {
  return (r) => {
    var s, o, u;
    if ((s = r.sourceEvent) != null && s.internal)
      return;
    const i = xx(r.transform);
    e.mouseButton = ((o = r.sourceEvent) == null ? void 0 : o.button) || 0, e.isZoomingOrPanning = !0, e.prevViewport = i, ((u = r.sourceEvent) == null ? void 0 : u.type) === "mousedown" && t(!0), n && (n == null || n(r.sourceEvent, i));
  };
}
function Yae({ zoomPanValues: e, panOnDrag: t, onPaneContextMenu: n, onTransformChange: r, onPanZoom: i }) {
  return (s) => {
    var o, u;
    e.usedRightMouseButton = !!(n && QP(t, e.mouseButton ?? 0)), (o = s.sourceEvent) != null && o.sync || r([s.transform.x, s.transform.y, s.transform.k]), i && !((u = s.sourceEvent) != null && u.internal) && (i == null || i(s.sourceEvent, xx(s.transform)));
  };
}
function Wae({ zoomPanValues: e, panOnDrag: t, panOnScroll: n, onDraggingChange: r, onPanZoomEnd: i, onPaneContextMenu: s }) {
  return (o) => {
    var u;
    if (!((u = o.sourceEvent) != null && u.internal) && (e.isZoomingOrPanning = !1, s && QP(t, e.mouseButton ?? 0) && !e.usedRightMouseButton && o.sourceEvent && s(o.sourceEvent), e.usedRightMouseButton = !1, r(!1), i)) {
      const c = xx(o.transform);
      e.prevViewport = c, clearTimeout(e.timerId), e.timerId = setTimeout(
        () => {
          i == null || i(o.sourceEvent, c);
        },
        // we need a setTimeout for panOnScroll to supress multiple end events fired during scroll
        n ? 150 : 0
      );
    }
  };
}
function Xae({ zoomActivationKeyPressed: e, zoomOnScroll: t, zoomOnPinch: n, panOnDrag: r, panOnScroll: i, zoomOnDoubleClick: s, userSelectionActive: o, noWheelClassName: u, noPanClassName: c, lib: d, connectionInProgress: m }) {
  return (p) => {
    var A;
    const x = e || t, b = n && p.ctrlKey, S = p.type === "wheel";
    if (p.button === 1 && p.type === "mousedown" && (bm(p, `${d}-flow__node`) || bm(p, `${d}-flow__edge`)))
      return !0;
    if (!r && !x && !i && !s && !n || o || m && !S || bm(p, u) && S || bm(p, c) && (!S || i && S && !e) || !n && p.ctrlKey && S)
      return !1;
    if (!n && p.type === "touchstart" && ((A = p.touches) == null ? void 0 : A.length) > 1)
      return p.preventDefault(), !1;
    if (!x && !i && !b && S || !r && (p.type === "mousedown" || p.type === "touchstart") || Array.isArray(r) && !r.includes(p.button) && p.type === "mousedown")
      return !1;
    const k = Array.isArray(r) && r.includes(p.button) || !p.button || p.button <= 1;
    return (!p.ctrlKey || S) && k;
  };
}
function Qae({ domNode: e, minZoom: t, maxZoom: n, translateExtent: r, viewport: i, onPanZoom: s, onPanZoomStart: o, onPanZoomEnd: u, onDraggingChange: c }) {
  const d = {
    isZoomingOrPanning: !1,
    usedRightMouseButton: !1,
    prevViewport: {},
    mouseButton: 0,
    timerId: void 0,
    panScrollTimeout: void 0,
    isPanScrolling: !1
  }, m = e.getBoundingClientRect(), p = CP().scaleExtent([t, n]).translateExtent(r), x = hs(e).call(p);
  M({
    x: i.x,
    y: i.y,
    zoom: Rm(i.zoom, t, n)
  }, [
    [0, 0],
    [m.width, m.height]
  ], r);
  const b = x.on("wheel.zoom"), S = x.on("dblclick.zoom");
  p.wheelDelta(ZP);
  function k(H, Z) {
    return x ? new Promise((me) => {
      p == null || p.interpolate((Z == null ? void 0 : Z.interpolate) === "linear" ? i0 : dv).transform(P2(x, Z == null ? void 0 : Z.duration, Z == null ? void 0 : Z.ease, () => me(!0)), H);
    }) : Promise.resolve(!1);
  }
  function A({ noWheelClassName: H, noPanClassName: Z, onPaneContextMenu: me, userSelectionActive: Q, panOnScroll: se, panOnDrag: J, panOnScrollMode: ue, panOnScrollSpeed: de, preventScrolling: ce, zoomOnPinch: W, zoomOnScroll: $, zoomOnDoubleClick: fe, zoomActivationKeyPressed: G, lib: le, onTransformChange: xe, connectionInProgress: Se, paneClickDistance: Oe, selectionOnDrag: Be }) {
    Q && !d.isZoomingOrPanning && T();
    const Re = se && !G && !Q;
    p.clickDistance(Be ? 1 / 0 : !To(Oe) || Oe < 0 ? 0 : Oe);
    const ft = Re ? Hae({
      zoomPanValues: d,
      noWheelClassName: H,
      d3Selection: x,
      d3Zoom: p,
      panOnScrollMode: ue,
      panOnScrollSpeed: de,
      zoomOnPinch: W,
      onPanZoomStart: o,
      onPanZoom: s,
      onPanZoomEnd: u
    }) : Gae({
      noWheelClassName: H,
      preventScrolling: ce,
      d3ZoomHandler: b
    });
    if (x.on("wheel.zoom", ft, { passive: !1 }), !Q) {
      const Ne = Kae({
        zoomPanValues: d,
        onDraggingChange: c,
        onPanZoomStart: o
      });
      p.on("start", Ne);
      const Ue = Yae({
        zoomPanValues: d,
        panOnDrag: J,
        onPaneContextMenu: !!me,
        onPanZoom: s,
        onTransformChange: xe
      });
      p.on("zoom", Ue);
      const et = Wae({
        zoomPanValues: d,
        panOnDrag: J,
        panOnScroll: se,
        onPaneContextMenu: me,
        onPanZoomEnd: u,
        onDraggingChange: c
      });
      p.on("end", et);
    }
    const Ie = Xae({
      zoomActivationKeyPressed: G,
      panOnDrag: J,
      zoomOnScroll: $,
      panOnScroll: se,
      zoomOnDoubleClick: fe,
      zoomOnPinch: W,
      userSelectionActive: Q,
      noPanClassName: Z,
      noWheelClassName: H,
      lib: le,
      connectionInProgress: Se
    });
    p.filter(Ie), fe ? x.on("dblclick.zoom", S) : x.on("dblclick.zoom", null);
  }
  function T() {
    p.on("zoom", null);
  }
  async function M(H, Z, me) {
    const Q = I2(H), se = p == null ? void 0 : p.constrain()(Q, Z, me);
    return se && await k(se), new Promise((J) => J(se));
  }
  async function j(H, Z) {
    const me = I2(H);
    return await k(me, Z), new Promise((Q) => Q(me));
  }
  function D(H) {
    if (x) {
      const Z = I2(H), me = x.property("__zoom");
      (me.k !== H.zoom || me.x !== H.x || me.y !== H.y) && (p == null || p.transform(x, Z, null, { sync: !0 }));
    }
  }
  function z() {
    const H = x ? SP(x.node()) : { x: 0, y: 0, k: 1 };
    return { x: H.x, y: H.y, zoom: H.k };
  }
  function I(H, Z) {
    return x ? new Promise((me) => {
      p == null || p.interpolate((Z == null ? void 0 : Z.interpolate) === "linear" ? i0 : dv).scaleTo(P2(x, Z == null ? void 0 : Z.duration, Z == null ? void 0 : Z.ease, () => me(!0)), H);
    }) : Promise.resolve(!1);
  }
  function L(H, Z) {
    return x ? new Promise((me) => {
      p == null || p.interpolate((Z == null ? void 0 : Z.interpolate) === "linear" ? i0 : dv).scaleBy(P2(x, Z == null ? void 0 : Z.duration, Z == null ? void 0 : Z.ease, () => me(!0)), H);
    }) : Promise.resolve(!1);
  }
  function K(H) {
    p == null || p.scaleExtent(H);
  }
  function ne(H) {
    p == null || p.translateExtent(H);
  }
  function Y(H) {
    const Z = !To(H) || H < 0 ? 0 : H;
    p == null || p.clickDistance(Z);
  }
  return {
    update: A,
    destroy: T,
    setViewport: j,
    setViewportConstrained: M,
    getViewport: z,
    scaleTo: I,
    scaleBy: L,
    setScaleExtent: K,
    setTranslateExtent: ne,
    syncViewport: D,
    setClickDistance: Y
  };
}
var Im;
(function(e) {
  e.Line = "line", e.Handle = "handle";
})(Im || (Im = {}));
function Zae({ width: e, prevWidth: t, height: n, prevHeight: r, affectsX: i, affectsY: s }) {
  const o = e - t, u = n - r, c = [o > 0 ? 1 : o < 0 ? -1 : 0, u > 0 ? 1 : u < 0 ? -1 : 0];
  return o && i && (c[0] = c[0] * -1), u && s && (c[1] = c[1] * -1), c;
}
function tN(e) {
  const t = e.includes("right") || e.includes("left"), n = e.includes("bottom") || e.includes("top"), r = e.includes("left"), i = e.includes("top");
  return {
    isHorizontal: t,
    isVertical: n,
    affectsX: r,
    affectsY: i
  };
}
function Rc(e, t) {
  return Math.max(0, t - e);
}
function Oc(e, t) {
  return Math.max(0, e - t);
}
function Q1(e, t, n) {
  return Math.max(0, t - e, e - n);
}
function nN(e, t) {
  return e ? !t : t;
}
function Jae(e, t, n, r, i, s, o, u) {
  let { affectsX: c, affectsY: d } = t;
  const { isHorizontal: m, isVertical: p } = t, x = m && p, { xSnapped: b, ySnapped: S } = n, { minWidth: k, maxWidth: A, minHeight: T, maxHeight: M } = r, { x: j, y: D, width: z, height: I, aspectRatio: L } = e;
  let K = Math.floor(m ? b - e.pointerX : 0), ne = Math.floor(p ? S - e.pointerY : 0);
  const Y = z + (c ? -K : K), H = I + (d ? -ne : ne), Z = -s[0] * z, me = -s[1] * I;
  let Q = Q1(Y, k, A), se = Q1(H, T, M);
  if (o) {
    let de = 0, ce = 0;
    c && K < 0 ? de = Rc(j + K + Z, o[0][0]) : !c && K > 0 && (de = Oc(j + Y + Z, o[1][0])), d && ne < 0 ? ce = Rc(D + ne + me, o[0][1]) : !d && ne > 0 && (ce = Oc(D + H + me, o[1][1])), Q = Math.max(Q, de), se = Math.max(se, ce);
  }
  if (u) {
    let de = 0, ce = 0;
    c && K > 0 ? de = Oc(j + K, u[0][0]) : !c && K < 0 && (de = Rc(j + Y, u[1][0])), d && ne > 0 ? ce = Oc(D + ne, u[0][1]) : !d && ne < 0 && (ce = Rc(D + H, u[1][1])), Q = Math.max(Q, de), se = Math.max(se, ce);
  }
  if (i) {
    if (m) {
      const de = Q1(Y / L, T, M) * L;
      if (Q = Math.max(Q, de), o) {
        let ce = 0;
        !c && !d || c && !d && x ? ce = Oc(D + me + Y / L, o[1][1]) * L : ce = Rc(D + me + (c ? K : -K) / L, o[0][1]) * L, Q = Math.max(Q, ce);
      }
      if (u) {
        let ce = 0;
        !c && !d || c && !d && x ? ce = Rc(D + Y / L, u[1][1]) * L : ce = Oc(D + (c ? K : -K) / L, u[0][1]) * L, Q = Math.max(Q, ce);
      }
    }
    if (p) {
      const de = Q1(H * L, k, A) / L;
      if (se = Math.max(se, de), o) {
        let ce = 0;
        !c && !d || d && !c && x ? ce = Oc(j + H * L + Z, o[1][0]) / L : ce = Rc(j + (d ? ne : -ne) * L + Z, o[0][0]) / L, se = Math.max(se, ce);
      }
      if (u) {
        let ce = 0;
        !c && !d || d && !c && x ? ce = Rc(j + H * L, u[1][0]) / L : ce = Oc(j + (d ? ne : -ne) * L, u[0][0]) / L, se = Math.max(se, ce);
      }
    }
  }
  ne = ne + (ne < 0 ? se : -se), K = K + (K < 0 ? Q : -Q), i && (x ? Y > H * L ? ne = (nN(c, d) ? -K : K) / L : K = (nN(c, d) ? -ne : ne) * L : m ? (ne = K / L, d = c) : (K = ne * L, c = d));
  const J = c ? j + K : j, ue = d ? D + ne : D;
  return {
    width: z + (c ? -K : K),
    height: I + (d ? -ne : ne),
    x: s[0] * K * (c ? -1 : 1) + J,
    y: s[1] * ne * (d ? -1 : 1) + ue
  };
}
const JP = { width: 0, height: 0, x: 0, y: 0 }, ese = {
  ...JP,
  pointerX: 0,
  pointerY: 0,
  aspectRatio: 1
};
function tse(e) {
  return [
    [0, 0],
    [e.measured.width, e.measured.height]
  ];
}
function nse(e, t, n) {
  const r = t.position.x + e.position.x, i = t.position.y + e.position.y, s = e.measured.width ?? 0, o = e.measured.height ?? 0, u = n[0] * s, c = n[1] * o;
  return [
    [r - u, i - c],
    [r + s - u, i + o - c]
  ];
}
function rse({ domNode: e, nodeId: t, getStoreItems: n, onChange: r, onEnd: i }) {
  const s = hs(e);
  let o = {
    controlDirection: tN("bottom-right"),
    boundaries: {
      minWidth: 0,
      minHeight: 0,
      maxWidth: Number.MAX_VALUE,
      maxHeight: Number.MAX_VALUE
    },
    resizeDirection: void 0,
    keepAspectRatio: !1
  };
  function u({ controlPosition: d, boundaries: m, keepAspectRatio: p, resizeDirection: x, onResizeStart: b, onResize: S, onResizeEnd: k, shouldResize: A }) {
    let T = { ...JP }, M = { ...ese };
    o = {
      boundaries: m,
      resizeDirection: x,
      keepAspectRatio: p,
      controlDirection: tN(d)
    };
    let j, D = null, z = [], I, L, K, ne = !1;
    const Y = uP().on("start", (H) => {
      const { nodeLookup: Z, transform: me, snapGrid: Q, snapToGrid: se, nodeOrigin: J, paneDomNode: ue } = n();
      if (j = Z.get(t), !j)
        return;
      D = (ue == null ? void 0 : ue.getBoundingClientRect()) ?? null;
      const { xSnapped: de, ySnapped: ce } = a0(H.sourceEvent, {
        transform: me,
        snapGrid: Q,
        snapToGrid: se,
        containerBounds: D
      });
      T = {
        width: j.measured.width ?? 0,
        height: j.measured.height ?? 0,
        x: j.position.x ?? 0,
        y: j.position.y ?? 0
      }, M = {
        ...T,
        pointerX: de,
        pointerY: ce,
        aspectRatio: T.width / T.height
      }, I = void 0, j.parentId && (j.extent === "parent" || j.expandParent) && (I = Z.get(j.parentId), L = I && j.extent === "parent" ? tse(I) : void 0), z = [], K = void 0;
      for (const [W, $] of Z)
        if ($.parentId === t && (z.push({
          id: W,
          position: { ...$.position },
          extent: $.extent
        }), $.extent === "parent" || $.expandParent)) {
          const fe = nse($, j, $.origin ?? J);
          K ? K = [
            [Math.min(fe[0][0], K[0][0]), Math.min(fe[0][1], K[0][1])],
            [Math.max(fe[1][0], K[1][0]), Math.max(fe[1][1], K[1][1])]
          ] : K = fe;
        }
      b == null || b(H, { ...T });
    }).on("drag", (H) => {
      const { transform: Z, snapGrid: me, snapToGrid: Q, nodeOrigin: se } = n(), J = a0(H.sourceEvent, {
        transform: Z,
        snapGrid: me,
        snapToGrid: Q,
        containerBounds: D
      }), ue = [];
      if (!j)
        return;
      const { x: de, y: ce, width: W, height: $ } = T, fe = {}, G = j.origin ?? se, { width: le, height: xe, x: Se, y: Oe } = Jae(M, o.controlDirection, J, o.boundaries, o.keepAspectRatio, G, L, K), Be = le !== W, Re = xe !== $, ft = Se !== de && Be, Ie = Oe !== ce && Re;
      if (!ft && !Ie && !Be && !Re)
        return;
      if ((ft || Ie || G[0] === 1 || G[1] === 1) && (fe.x = ft ? Se : T.x, fe.y = Ie ? Oe : T.y, T.x = fe.x, T.y = fe.y, z.length > 0)) {
        const tt = Se - de, st = Oe - ce;
        for (const dt of z)
          dt.position = {
            x: dt.position.x - tt + G[0] * (le - W),
            y: dt.position.y - st + G[1] * (xe - $)
          }, ue.push(dt);
      }
      if ((Be || Re) && (fe.width = Be && (!o.resizeDirection || o.resizeDirection === "horizontal") ? le : T.width, fe.height = Re && (!o.resizeDirection || o.resizeDirection === "vertical") ? xe : T.height, T.width = fe.width, T.height = fe.height), I && j.expandParent) {
        const tt = G[0] * (fe.width ?? 0);
        fe.x && fe.x < tt && (T.x = tt, M.x = M.x - (fe.x - tt));
        const st = G[1] * (fe.height ?? 0);
        fe.y && fe.y < st && (T.y = st, M.y = M.y - (fe.y - st));
      }
      const Ne = Zae({
        width: T.width,
        prevWidth: W,
        height: T.height,
        prevHeight: $,
        affectsX: o.controlDirection.affectsX,
        affectsY: o.controlDirection.affectsY
      }), Ue = { ...T, direction: Ne };
      (A == null ? void 0 : A(H, Ue)) !== !1 && (ne = !0, S == null || S(H, Ue), r(fe, ue));
    }).on("end", (H) => {
      ne && (k == null || k(H, { ...T }), i == null || i({ ...T }), ne = !1);
    });
    s.call(Y);
  }
  function c() {
    s.on(".drag", null);
  }
  return {
    update: u,
    destroy: c
  };
}
const { useDebugValue: ise } = yC, { useSyncExternalStoreWithSelector: ase } = dR, sse = (e) => e;
function ez(e, t = sse, n) {
  const r = ase(
    e.subscribe,
    e.getState,
    e.getServerState || e.getInitialState,
    t,
    n
  );
  return ise(r), r;
}
const rN = (e, t) => {
  const n = fR(e), r = (i, s = t) => ez(n, i, s);
  return Object.assign(r, n), r;
}, ose = (e, t) => e ? rN(e, t) : rN;
function lr(e, t) {
  if (Object.is(e, t))
    return !0;
  if (typeof e != "object" || e === null || typeof t != "object" || t === null)
    return !1;
  if (e instanceof Map && t instanceof Map) {
    if (e.size !== t.size) return !1;
    for (const [r, i] of e)
      if (!Object.is(i, t.get(r)))
        return !1;
    return !0;
  }
  if (e instanceof Set && t instanceof Set) {
    if (e.size !== t.size) return !1;
    for (const r of e)
      if (!t.has(r))
        return !1;
    return !0;
  }
  const n = Object.keys(e);
  if (n.length !== Object.keys(t).length)
    return !1;
  for (const r of n)
    if (!Object.prototype.hasOwnProperty.call(t, r) || !Object.is(e[r], t[r]))
      return !1;
  return !0;
}
const bx = F.createContext(null), lse = bx.Provider, tz = Ol.error001();
function rn(e, t) {
  const n = F.useContext(bx);
  if (n === null)
    throw new Error(tz);
  return ez(n, e, t);
}
function ur() {
  const e = F.useContext(bx);
  if (e === null)
    throw new Error(tz);
  return F.useMemo(() => ({
    getState: e.getState,
    setState: e.setState,
    subscribe: e.subscribe
  }), [e]);
}
const iN = { display: "none" }, use = {
  position: "absolute",
  width: 1,
  height: 1,
  margin: -1,
  border: 0,
  padding: 0,
  overflow: "hidden",
  clip: "rect(0px, 0px, 0px, 0px)",
  clipPath: "inset(100%)"
}, nz = "react-flow__node-desc", rz = "react-flow__edge-desc", cse = "react-flow__aria-live", fse = (e) => e.ariaLiveMessage, dse = (e) => e.ariaLabelConfig;
function hse({ rfId: e }) {
  const t = rn(fse);
  return g.jsx("div", { id: `${cse}-${e}`, "aria-live": "assertive", "aria-atomic": "true", style: use, children: t });
}
function mse({ rfId: e, disableKeyboardA11y: t }) {
  const n = rn(dse);
  return g.jsxs(g.Fragment, { children: [g.jsx("div", { id: `${nz}-${e}`, style: iN, children: t ? n["node.a11yDescription.default"] : n["node.a11yDescription.keyboardDisabled"] }), g.jsx("div", { id: `${rz}-${e}`, style: iN, children: n["edge.a11yDescription.default"] }), !t && g.jsx(hse, { rfId: e })] });
}
const wx = F.forwardRef(({ position: e = "top-left", children: t, className: n, style: r, ...i }, s) => {
  const o = `${e}`.split("-");
  return g.jsx("div", { className: Lr(["react-flow__panel", n, ...o]), style: r, ref: s, ...i, children: t });
});
wx.displayName = "Panel";
function pse({ proOptions: e, position: t = "bottom-right" }) {
  return e != null && e.hideAttribution ? null : g.jsx(wx, { position: t, className: "react-flow__attribution", "data-message": "Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev", children: g.jsx("a", { href: "https://reactflow.dev", target: "_blank", rel: "noopener noreferrer", "aria-label": "React Flow attribution", children: "React Flow" }) });
}
const gse = (e) => {
  const t = [], n = [];
  for (const [, r] of e.nodeLookup)
    r.selected && t.push(r.internals.userNode);
  for (const [, r] of e.edgeLookup)
    r.selected && n.push(r);
  return { selectedNodes: t, selectedEdges: n };
}, Z1 = (e) => e.id;
function yse(e, t) {
  return lr(e.selectedNodes.map(Z1), t.selectedNodes.map(Z1)) && lr(e.selectedEdges.map(Z1), t.selectedEdges.map(Z1));
}
function vse({ onSelectionChange: e }) {
  const t = ur(), { selectedNodes: n, selectedEdges: r } = rn(gse, yse);
  return F.useEffect(() => {
    const i = { nodes: n, edges: r };
    e == null || e(i), t.getState().onSelectionChangeHandlers.forEach((s) => s(i));
  }, [n, r, e]), null;
}
const xse = (e) => !!e.onSelectionChangeHandlers;
function bse({ onSelectionChange: e }) {
  const t = rn(xse);
  return e || t ? g.jsx(vse, { onSelectionChange: e }) : null;
}
const iz = [0, 0], wse = { x: 0, y: 0, zoom: 1 }, _se = [
  "nodes",
  "edges",
  "defaultNodes",
  "defaultEdges",
  "onConnect",
  "onConnectStart",
  "onConnectEnd",
  "onClickConnectStart",
  "onClickConnectEnd",
  "nodesDraggable",
  "autoPanOnNodeFocus",
  "nodesConnectable",
  "nodesFocusable",
  "edgesFocusable",
  "edgesReconnectable",
  "elevateNodesOnSelect",
  "elevateEdgesOnSelect",
  "minZoom",
  "maxZoom",
  "nodeExtent",
  "onNodesChange",
  "onEdgesChange",
  "elementsSelectable",
  "connectionMode",
  "snapGrid",
  "snapToGrid",
  "translateExtent",
  "connectOnClick",
  "defaultEdgeOptions",
  "fitView",
  "fitViewOptions",
  "onNodesDelete",
  "onEdgesDelete",
  "onDelete",
  "onNodeDrag",
  "onNodeDragStart",
  "onNodeDragStop",
  "onSelectionDrag",
  "onSelectionDragStart",
  "onSelectionDragStop",
  "onMoveStart",
  "onMove",
  "onMoveEnd",
  "noPanClassName",
  "nodeOrigin",
  "autoPanOnConnect",
  "autoPanOnNodeDrag",
  "onError",
  "connectionRadius",
  "isValidConnection",
  "selectNodesOnDrag",
  "nodeDragThreshold",
  "connectionDragThreshold",
  "onBeforeDelete",
  "debug",
  "autoPanSpeed",
  "ariaLabelConfig",
  "zIndexMode"
], aN = [..._se, "rfId"], Sse = (e) => ({
  setNodes: e.setNodes,
  setEdges: e.setEdges,
  setMinZoom: e.setMinZoom,
  setMaxZoom: e.setMaxZoom,
  setTranslateExtent: e.setTranslateExtent,
  setNodeExtent: e.setNodeExtent,
  reset: e.reset,
  setDefaultNodesAndEdges: e.setDefaultNodesAndEdges
}), sN = {
  /*
   * these are values that are also passed directly to other components
   * than the StoreUpdater. We can reduce the number of setStore calls
   * by setting the same values here as prev fields.
   */
  translateExtent: w0,
  nodeOrigin: iz,
  minZoom: 0.5,
  maxZoom: 2,
  elementsSelectable: !0,
  noPanClassName: "nopan",
  rfId: "1"
};
function Cse(e) {
  const { setNodes: t, setEdges: n, setMinZoom: r, setMaxZoom: i, setTranslateExtent: s, setNodeExtent: o, reset: u, setDefaultNodesAndEdges: c } = rn(Sse, lr), d = ur();
  F.useEffect(() => (c(e.defaultNodes, e.defaultEdges), () => {
    m.current = sN, u();
  }), []);
  const m = F.useRef(sN);
  return F.useEffect(
    () => {
      for (const p of aN) {
        const x = e[p], b = m.current[p];
        x !== b && (typeof e[p] > "u" || (p === "nodes" ? t(x) : p === "edges" ? n(x) : p === "minZoom" ? r(x) : p === "maxZoom" ? i(x) : p === "translateExtent" ? s(x) : p === "nodeExtent" ? o(x) : p === "ariaLabelConfig" ? d.setState({ ariaLabelConfig: pae(x) }) : p === "fitView" ? d.setState({ fitViewQueued: x }) : p === "fitViewOptions" ? d.setState({ fitViewOptions: x }) : d.setState({ [p]: x })));
      }
      m.current = e;
    },
    // Only re-run the effect if one of the fields we track changes
    aN.map((p) => e[p])
  ), null;
}
function oN() {
  return typeof window > "u" || !window.matchMedia ? null : window.matchMedia("(prefers-color-scheme: dark)");
}
function Ese(e) {
  var r;
  const [t, n] = F.useState(e === "system" ? null : e);
  return F.useEffect(() => {
    if (e !== "system") {
      n(e);
      return;
    }
    const i = oN(), s = () => n(i != null && i.matches ? "dark" : "light");
    return s(), i == null || i.addEventListener("change", s), () => {
      i == null || i.removeEventListener("change", s);
    };
  }, [e]), t !== null ? t : (r = oN()) != null && r.matches ? "dark" : "light";
}
const lN = typeof document < "u" ? document : null;
function k0(e = null, t = { target: lN, actInsideInputWithModifier: !0 }) {
  const [n, r] = F.useState(!1), i = F.useRef(!1), s = F.useRef(/* @__PURE__ */ new Set([])), [o, u] = F.useMemo(() => {
    if (e !== null) {
      const d = (Array.isArray(e) ? e : [e]).filter((p) => typeof p == "string").map((p) => p.replace("+", `
`).replace(`

`, `
+`).split(`
`)), m = d.reduce((p, x) => p.concat(...x), []);
      return [d, m];
    }
    return [[], []];
  }, [e]);
  return F.useEffect(() => {
    const c = (t == null ? void 0 : t.target) ?? lN, d = (t == null ? void 0 : t.actInsideInputWithModifier) ?? !0;
    if (e !== null) {
      const m = (b) => {
        var A, T;
        if (i.current = b.ctrlKey || b.metaKey || b.shiftKey || b.altKey, (!i.current || i.current && !d) && zP(b))
          return !1;
        const k = cN(b.code, u);
        if (s.current.add(b[k]), uN(o, s.current, !1)) {
          const M = ((T = (A = b.composedPath) == null ? void 0 : A.call(b)) == null ? void 0 : T[0]) || b.target, j = (M == null ? void 0 : M.nodeName) === "BUTTON" || (M == null ? void 0 : M.nodeName) === "A";
          t.preventDefault !== !1 && (i.current || !j) && b.preventDefault(), r(!0);
        }
      }, p = (b) => {
        const S = cN(b.code, u);
        uN(o, s.current, !0) ? (r(!1), s.current.clear()) : s.current.delete(b[S]), b.key === "Meta" && s.current.clear(), i.current = !1;
      }, x = () => {
        s.current.clear(), r(!1);
      };
      return c == null || c.addEventListener("keydown", m), c == null || c.addEventListener("keyup", p), window.addEventListener("blur", x), window.addEventListener("contextmenu", x), () => {
        c == null || c.removeEventListener("keydown", m), c == null || c.removeEventListener("keyup", p), window.removeEventListener("blur", x), window.removeEventListener("contextmenu", x);
      };
    }
  }, [e, r]), n;
}
function uN(e, t, n) {
  return e.filter((r) => n || r.length === t.size).some((r) => r.every((i) => t.has(i)));
}
function cN(e, t) {
  return t.includes(e) ? "code" : "key";
}
const kse = () => {
  const e = ur();
  return F.useMemo(() => ({
    zoomIn: (t) => {
      const { panZoom: n } = e.getState();
      return n ? n.scaleBy(1.2, { duration: t == null ? void 0 : t.duration }) : Promise.resolve(!1);
    },
    zoomOut: (t) => {
      const { panZoom: n } = e.getState();
      return n ? n.scaleBy(1 / 1.2, { duration: t == null ? void 0 : t.duration }) : Promise.resolve(!1);
    },
    zoomTo: (t, n) => {
      const { panZoom: r } = e.getState();
      return r ? r.scaleTo(t, { duration: n == null ? void 0 : n.duration }) : Promise.resolve(!1);
    },
    getZoom: () => e.getState().transform[2],
    setViewport: async (t, n) => {
      const { transform: [r, i, s], panZoom: o } = e.getState();
      return o ? (await o.setViewport({
        x: t.x ?? r,
        y: t.y ?? i,
        zoom: t.zoom ?? s
      }, n), Promise.resolve(!0)) : Promise.resolve(!1);
    },
    getViewport: () => {
      const [t, n, r] = e.getState().transform;
      return { x: t, y: n, zoom: r };
    },
    setCenter: async (t, n, r) => e.getState().setCenter(t, n, r),
    fitBounds: async (t, n) => {
      const { width: r, height: i, minZoom: s, maxZoom: o, panZoom: u } = e.getState(), c = UE(t, r, i, s, o, (n == null ? void 0 : n.padding) ?? 0.1);
      return u ? (await u.setViewport(c, {
        duration: n == null ? void 0 : n.duration,
        ease: n == null ? void 0 : n.ease,
        interpolate: n == null ? void 0 : n.interpolate
      }), Promise.resolve(!0)) : Promise.resolve(!1);
    },
    screenToFlowPosition: (t, n = {}) => {
      const { transform: r, snapGrid: i, snapToGrid: s, domNode: o } = e.getState();
      if (!o)
        return t;
      const { x: u, y: c } = o.getBoundingClientRect(), d = {
        x: t.x - u,
        y: t.y - c
      }, m = n.snapGrid ?? i, p = n.snapToGrid ?? s;
      return V0(d, r, p, m);
    },
    flowToScreenPosition: (t) => {
      const { transform: n, domNode: r } = e.getState();
      if (!r)
        return t;
      const { x: i, y: s } = r.getBoundingClientRect(), o = $v(t, n);
      return {
        x: o.x + i,
        y: o.y + s
      };
    }
  }), []);
};
function az(e, t) {
  const n = [], r = /* @__PURE__ */ new Map(), i = [];
  for (const s of e)
    if (s.type === "add") {
      i.push(s);
      continue;
    } else if (s.type === "remove" || s.type === "replace")
      r.set(s.id, [s]);
    else {
      const o = r.get(s.id);
      o ? o.push(s) : r.set(s.id, [s]);
    }
  for (const s of t) {
    const o = r.get(s.id);
    if (!o) {
      n.push(s);
      continue;
    }
    if (o[0].type === "remove")
      continue;
    if (o[0].type === "replace") {
      n.push({ ...o[0].item });
      continue;
    }
    const u = { ...s };
    for (const c of o)
      Tse(c, u);
    n.push(u);
  }
  return i.length && i.forEach((s) => {
    s.index !== void 0 ? n.splice(s.index, 0, { ...s.item }) : n.push({ ...s.item });
  }), n;
}
function Tse(e, t) {
  switch (e.type) {
    case "select": {
      t.selected = e.selected;
      break;
    }
    case "position": {
      typeof e.position < "u" && (t.position = e.position), typeof e.dragging < "u" && (t.dragging = e.dragging);
      break;
    }
    case "dimensions": {
      typeof e.dimensions < "u" && (t.measured = {
        ...e.dimensions
      }, e.setAttributes && ((e.setAttributes === !0 || e.setAttributes === "width") && (t.width = e.dimensions.width), (e.setAttributes === !0 || e.setAttributes === "height") && (t.height = e.dimensions.height))), typeof e.resizing == "boolean" && (t.resizing = e.resizing);
      break;
    }
  }
}
function sz(e, t) {
  return az(e, t);
}
function oz(e, t) {
  return az(e, t);
}
function hd(e, t) {
  return {
    id: e,
    type: "select",
    selected: t
  };
}
function wm(e, t = /* @__PURE__ */ new Set(), n = !1) {
  const r = [];
  for (const [i, s] of e) {
    const o = t.has(i);
    !(s.selected === void 0 && !o) && s.selected !== o && (n && (s.selected = o), r.push(hd(s.id, o)));
  }
  return r;
}
function fN({ items: e = [], lookup: t }) {
  var i;
  const n = [], r = new Map(e.map((s) => [s.id, s]));
  for (const [s, o] of e.entries()) {
    const u = t.get(o.id), c = ((i = u == null ? void 0 : u.internals) == null ? void 0 : i.userNode) ?? u;
    c !== void 0 && c !== o && n.push({ id: o.id, item: o, type: "replace" }), c === void 0 && n.push({ item: o, type: "add", index: s });
  }
  for (const [s] of t)
    r.get(s) === void 0 && n.push({ id: s, type: "remove" });
  return n;
}
function dN(e) {
  return {
    id: e.id,
    type: "remove"
  };
}
const hN = (e) => aae(e), Nse = (e) => AP(e);
function lz(e) {
  return F.forwardRef(e);
}
const Ase = typeof window < "u" ? F.useLayoutEffect : F.useEffect;
function mN(e) {
  const [t, n] = F.useState(BigInt(0)), [r] = F.useState(() => jse(() => n((i) => i + BigInt(1))));
  return Ase(() => {
    const i = r.get();
    i.length && (e(i), r.reset());
  }, [t]), r;
}
function jse(e) {
  let t = [];
  return {
    get: () => t,
    reset: () => {
      t = [];
    },
    push: (n) => {
      t.push(n), e();
    }
  };
}
const uz = F.createContext(null);
function Mse({ children: e }) {
  const t = ur(), n = F.useCallback((u) => {
    const { nodes: c = [], setNodes: d, hasDefaultNodes: m, onNodesChange: p, nodeLookup: x, fitViewQueued: b, onNodesChangeMiddlewareMap: S } = t.getState();
    let k = c;
    for (const T of u)
      k = typeof T == "function" ? T(k) : T;
    let A = fN({
      items: k,
      lookup: x
    });
    for (const T of S.values())
      A = T(A);
    m && d(k), A.length > 0 ? p == null || p(A) : b && window.requestAnimationFrame(() => {
      const { fitViewQueued: T, nodes: M, setNodes: j } = t.getState();
      T && j(M);
    });
  }, []), r = mN(n), i = F.useCallback((u) => {
    const { edges: c = [], setEdges: d, hasDefaultEdges: m, onEdgesChange: p, edgeLookup: x } = t.getState();
    let b = c;
    for (const S of u)
      b = typeof S == "function" ? S(b) : S;
    m ? d(b) : p && p(fN({
      items: b,
      lookup: x
    }));
  }, []), s = mN(i), o = F.useMemo(() => ({ nodeQueue: r, edgeQueue: s }), []);
  return g.jsx(uz.Provider, { value: o, children: e });
}
function Rse() {
  const e = F.useContext(uz);
  if (!e)
    throw new Error("useBatchContext must be used within a BatchProvider");
  return e;
}
const Ose = (e) => !!e.panZoom;
function WE() {
  const e = kse(), t = ur(), n = Rse(), r = rn(Ose), i = F.useMemo(() => {
    const s = (p) => t.getState().nodeLookup.get(p), o = (p) => {
      n.nodeQueue.push(p);
    }, u = (p) => {
      n.edgeQueue.push(p);
    }, c = (p) => {
      var T, M;
      const { nodeLookup: x, nodeOrigin: b } = t.getState(), S = hN(p) ? p : x.get(p.id), k = S.parentId ? IP(S.position, S.measured, S.parentId, x, b) : S.position, A = {
        ...S,
        position: k,
        width: ((T = S.measured) == null ? void 0 : T.width) ?? S.width,
        height: ((M = S.measured) == null ? void 0 : M.height) ?? S.height
      };
      return Om(A);
    }, d = (p, x, b = { replace: !1 }) => {
      o((S) => S.map((k) => {
        if (k.id === p) {
          const A = typeof x == "function" ? x(k) : x;
          return b.replace && hN(A) ? A : { ...k, ...A };
        }
        return k;
      }));
    }, m = (p, x, b = { replace: !1 }) => {
      u((S) => S.map((k) => {
        if (k.id === p) {
          const A = typeof x == "function" ? x(k) : x;
          return b.replace && Nse(A) ? A : { ...k, ...A };
        }
        return k;
      }));
    };
    return {
      getNodes: () => t.getState().nodes.map((p) => ({ ...p })),
      getNode: (p) => {
        var x;
        return (x = s(p)) == null ? void 0 : x.internals.userNode;
      },
      getInternalNode: s,
      getEdges: () => {
        const { edges: p = [] } = t.getState();
        return p.map((x) => ({ ...x }));
      },
      getEdge: (p) => t.getState().edgeLookup.get(p),
      setNodes: o,
      setEdges: u,
      addNodes: (p) => {
        const x = Array.isArray(p) ? p : [p];
        n.nodeQueue.push((b) => [...b, ...x]);
      },
      addEdges: (p) => {
        const x = Array.isArray(p) ? p : [p];
        n.edgeQueue.push((b) => [...b, ...x]);
      },
      toObject: () => {
        const { nodes: p = [], edges: x = [], transform: b } = t.getState(), [S, k, A] = b;
        return {
          nodes: p.map((T) => ({ ...T })),
          edges: x.map((T) => ({ ...T })),
          viewport: {
            x: S,
            y: k,
            zoom: A
          }
        };
      },
      deleteElements: async ({ nodes: p = [], edges: x = [] }) => {
        const { nodes: b, edges: S, onNodesDelete: k, onEdgesDelete: A, triggerNodeChanges: T, triggerEdgeChanges: M, onDelete: j, onBeforeDelete: D } = t.getState(), { nodes: z, edges: I } = await cae({
          nodesToRemove: p,
          edgesToRemove: x,
          nodes: b,
          edges: S,
          onBeforeDelete: D
        }), L = I.length > 0, K = z.length > 0;
        if (L) {
          const ne = I.map(dN);
          A == null || A(I), M(ne);
        }
        if (K) {
          const ne = z.map(dN);
          k == null || k(z), T(ne);
        }
        return (K || L) && (j == null || j({ nodes: z, edges: I })), { deletedNodes: z, deletedEdges: I };
      },
      /**
       * Partial is defined as "the 2 nodes/areas are intersecting partially".
       * If a is contained in b or b is contained in a, they are both
       * considered fully intersecting.
       */
      getIntersectingNodes: (p, x = !0, b) => {
        const S = VT(p), k = S ? p : c(p), A = b !== void 0;
        return k ? (b || t.getState().nodes).filter((T) => {
          const M = t.getState().nodeLookup.get(T.id);
          if (M && !S && (T.id === p.id || !M.internals.positionAbsolute))
            return !1;
          const j = Om(A ? T : M), D = C0(j, k);
          return x && D > 0 || D >= j.width * j.height || D >= k.width * k.height;
        }) : [];
      },
      isNodeIntersecting: (p, x, b = !0) => {
        const k = VT(p) ? p : c(p);
        if (!k)
          return !1;
        const A = C0(k, x);
        return b && A > 0 || A >= x.width * x.height || A >= k.width * k.height;
      },
      updateNode: d,
      updateNodeData: (p, x, b = { replace: !1 }) => {
        d(p, (S) => {
          const k = typeof x == "function" ? x(S) : x;
          return b.replace ? { ...S, data: k } : { ...S, data: { ...S.data, ...k } };
        }, b);
      },
      updateEdge: m,
      updateEdgeData: (p, x, b = { replace: !1 }) => {
        m(p, (S) => {
          const k = typeof x == "function" ? x(S) : x;
          return b.replace ? { ...S, data: k } : { ...S, data: { ...S.data, ...k } };
        }, b);
      },
      getNodesBounds: (p) => {
        const { nodeLookup: x, nodeOrigin: b } = t.getState();
        return sae(p, { nodeLookup: x, nodeOrigin: b });
      },
      getHandleConnections: ({ type: p, id: x, nodeId: b }) => {
        var S;
        return Array.from(((S = t.getState().connectionLookup.get(`${b}-${p}${x ? `-${x}` : ""}`)) == null ? void 0 : S.values()) ?? []);
      },
      getNodeConnections: ({ type: p, handleId: x, nodeId: b }) => {
        var S;
        return Array.from(((S = t.getState().connectionLookup.get(`${b}${p ? x ? `-${p}-${x}` : `-${p}` : ""}`)) == null ? void 0 : S.values()) ?? []);
      },
      fitView: async (p) => {
        const x = t.getState().fitViewResolver ?? mae();
        return t.setState({ fitViewQueued: !0, fitViewOptions: p, fitViewResolver: x }), n.nodeQueue.push((b) => [...b]), x.promise;
      }
    };
  }, []);
  return F.useMemo(() => ({
    ...i,
    ...e,
    viewportInitialized: r
  }), [r]);
}
const pN = (e) => e.selected, Dse = typeof window < "u" ? window : void 0;
function Ise({ deleteKeyCode: e, multiSelectionKeyCode: t }) {
  const n = ur(), { deleteElements: r } = WE(), i = k0(e, { actInsideInputWithModifier: !1 }), s = k0(t, { target: Dse });
  F.useEffect(() => {
    if (i) {
      const { edges: o, nodes: u } = n.getState();
      r({ nodes: u.filter(pN), edges: o.filter(pN) }), n.setState({ nodesSelectionActive: !1 });
    }
  }, [i]), F.useEffect(() => {
    n.setState({ multiSelectionActive: s });
  }, [s]);
}
function Pse(e) {
  const t = ur();
  F.useEffect(() => {
    const n = () => {
      var i, s, o, u;
      if (!e.current || !(((s = (i = e.current).checkVisibility) == null ? void 0 : s.call(i)) ?? !0))
        return !1;
      const r = $E(e.current);
      (r.height === 0 || r.width === 0) && ((u = (o = t.getState()).onError) == null || u.call(o, "004", Ol.error004())), t.setState({ width: r.width || 500, height: r.height || 500 });
    };
    if (e.current) {
      n(), window.addEventListener("resize", n);
      const r = new ResizeObserver(() => n());
      return r.observe(e.current), () => {
        window.removeEventListener("resize", n), r && e.current && r.unobserve(e.current);
      };
    }
  }, []);
}
const _x = {
  position: "absolute",
  width: "100%",
  height: "100%",
  top: 0,
  left: 0
}, zse = (e) => ({
  userSelectionActive: e.userSelectionActive,
  lib: e.lib,
  connectionInProgress: e.connection.inProgress
});
function Lse({ onPaneContextMenu: e, zoomOnScroll: t = !0, zoomOnPinch: n = !0, panOnScroll: r = !1, panOnScrollSpeed: i = 0.5, panOnScrollMode: s = Nd.Free, zoomOnDoubleClick: o = !0, panOnDrag: u = !0, defaultViewport: c, translateExtent: d, minZoom: m, maxZoom: p, zoomActivationKeyCode: x, preventScrolling: b = !0, children: S, noWheelClassName: k, noPanClassName: A, onViewportChange: T, isControlledViewport: M, paneClickDistance: j, selectionOnDrag: D }) {
  const z = ur(), I = F.useRef(null), { userSelectionActive: L, lib: K, connectionInProgress: ne } = rn(zse, lr), Y = k0(x), H = F.useRef();
  Pse(I);
  const Z = F.useCallback((me) => {
    T == null || T({ x: me[0], y: me[1], zoom: me[2] }), M || z.setState({ transform: me });
  }, [T, M]);
  return F.useEffect(() => {
    if (I.current) {
      H.current = Qae({
        domNode: I.current,
        minZoom: m,
        maxZoom: p,
        translateExtent: d,
        viewport: c,
        onDraggingChange: (J) => z.setState({ paneDragging: J }),
        onPanZoomStart: (J, ue) => {
          const { onViewportChangeStart: de, onMoveStart: ce } = z.getState();
          ce == null || ce(J, ue), de == null || de(ue);
        },
        onPanZoom: (J, ue) => {
          const { onViewportChange: de, onMove: ce } = z.getState();
          ce == null || ce(J, ue), de == null || de(ue);
        },
        onPanZoomEnd: (J, ue) => {
          const { onViewportChangeEnd: de, onMoveEnd: ce } = z.getState();
          ce == null || ce(J, ue), de == null || de(ue);
        }
      });
      const { x: me, y: Q, zoom: se } = H.current.getViewport();
      return z.setState({
        panZoom: H.current,
        transform: [me, Q, se],
        domNode: I.current.closest(".react-flow")
      }), () => {
        var J;
        (J = H.current) == null || J.destroy();
      };
    }
  }, []), F.useEffect(() => {
    var me;
    (me = H.current) == null || me.update({
      onPaneContextMenu: e,
      zoomOnScroll: t,
      zoomOnPinch: n,
      panOnScroll: r,
      panOnScrollSpeed: i,
      panOnScrollMode: s,
      zoomOnDoubleClick: o,
      panOnDrag: u,
      zoomActivationKeyPressed: Y,
      preventScrolling: b,
      noPanClassName: A,
      userSelectionActive: L,
      noWheelClassName: k,
      lib: K,
      onTransformChange: Z,
      connectionInProgress: ne,
      selectionOnDrag: D,
      paneClickDistance: j
    });
  }, [
    e,
    t,
    n,
    r,
    i,
    s,
    o,
    u,
    Y,
    b,
    A,
    L,
    k,
    K,
    Z,
    ne,
    D,
    j
  ]), g.jsx("div", { className: "react-flow__renderer", ref: I, style: _x, children: S });
}
const Bse = (e) => ({
  userSelectionActive: e.userSelectionActive,
  userSelectionRect: e.userSelectionRect
});
function qse() {
  const { userSelectionActive: e, userSelectionRect: t } = rn(Bse, lr);
  return e && t ? g.jsx("div", { className: "react-flow__selection react-flow__container", style: {
    width: t.width,
    height: t.height,
    transform: `translate(${t.x}px, ${t.y}px)`
  } }) : null;
}
const z2 = (e, t) => (n) => {
  n.target === t.current && (e == null || e(n));
}, Fse = (e) => ({
  userSelectionActive: e.userSelectionActive,
  elementsSelectable: e.elementsSelectable,
  connectionInProgress: e.connection.inProgress,
  dragging: e.paneDragging
});
function Use({ isSelecting: e, selectionKeyPressed: t, selectionMode: n = _0.Full, panOnDrag: r, paneClickDistance: i, selectionOnDrag: s, onSelectionStart: o, onSelectionEnd: u, onPaneClick: c, onPaneContextMenu: d, onPaneScroll: m, onPaneMouseEnter: p, onPaneMouseMove: x, onPaneMouseLeave: b, children: S }) {
  const k = ur(), { userSelectionActive: A, elementsSelectable: T, dragging: M, connectionInProgress: j } = rn(Fse, lr), D = T && (e || A), z = F.useRef(null), I = F.useRef(), L = F.useRef(/* @__PURE__ */ new Set()), K = F.useRef(/* @__PURE__ */ new Set()), ne = F.useRef(!1), Y = (de) => {
    if (ne.current || j) {
      ne.current = !1;
      return;
    }
    c == null || c(de), k.getState().resetSelectedElements(), k.setState({ nodesSelectionActive: !1 });
  }, H = (de) => {
    if (Array.isArray(r) && (r != null && r.includes(2))) {
      de.preventDefault();
      return;
    }
    d == null || d(de);
  }, Z = m ? (de) => m(de) : void 0, me = (de) => {
    ne.current && (de.stopPropagation(), ne.current = !1);
  }, Q = (de) => {
    var xe, Se;
    const { domNode: ce } = k.getState();
    if (I.current = ce == null ? void 0 : ce.getBoundingClientRect(), !I.current)
      return;
    const W = de.target === z.current;
    if (!W && !!de.target.closest(".nokey") || !e || !(s && W || t) || de.button !== 0 || !de.isPrimary)
      return;
    (Se = (xe = de.target) == null ? void 0 : xe.setPointerCapture) == null || Se.call(xe, de.pointerId), ne.current = !1;
    const { x: G, y: le } = No(de.nativeEvent, I.current);
    k.setState({
      userSelectionRect: {
        width: 0,
        height: 0,
        startX: G,
        startY: le,
        x: G,
        y: le
      }
    }), W || (de.stopPropagation(), de.preventDefault());
  }, se = (de) => {
    const { userSelectionRect: ce, transform: W, nodeLookup: $, edgeLookup: fe, connectionLookup: G, triggerNodeChanges: le, triggerEdgeChanges: xe, defaultEdgeOptions: Se, resetSelectedElements: Oe } = k.getState();
    if (!I.current || !ce)
      return;
    const { x: Be, y: Re } = No(de.nativeEvent, I.current), { startX: ft, startY: Ie } = ce;
    if (!ne.current) {
      const st = t ? 0 : i;
      if (Math.hypot(Be - ft, Re - Ie) <= st)
        return;
      Oe(), o == null || o(de);
    }
    ne.current = !0;
    const Ne = {
      startX: ft,
      startY: Ie,
      x: Be < ft ? Be : ft,
      y: Re < Ie ? Re : Ie,
      width: Math.abs(Be - ft),
      height: Math.abs(Re - Ie)
    }, Ue = L.current, et = K.current;
    L.current = new Set(FE($, Ne, W, n === _0.Partial, !0).map((st) => st.id)), K.current = /* @__PURE__ */ new Set();
    const tt = (Se == null ? void 0 : Se.selectable) ?? !0;
    for (const st of L.current) {
      const dt = G.get(st);
      if (dt)
        for (const { edgeId: Wn } of dt.values()) {
          const Rn = fe.get(Wn);
          Rn && (Rn.selectable ?? tt) && K.current.add(Wn);
        }
    }
    if (!HT(Ue, L.current)) {
      const st = wm($, L.current, !0);
      le(st);
    }
    if (!HT(et, K.current)) {
      const st = wm(fe, K.current);
      xe(st);
    }
    k.setState({
      userSelectionRect: Ne,
      userSelectionActive: !0,
      nodesSelectionActive: !1
    });
  }, J = (de) => {
    var ce, W;
    de.button === 0 && ((W = (ce = de.target) == null ? void 0 : ce.releasePointerCapture) == null || W.call(ce, de.pointerId), !A && de.target === z.current && k.getState().userSelectionRect && (Y == null || Y(de)), k.setState({
      userSelectionActive: !1,
      userSelectionRect: null
    }), ne.current && (u == null || u(de), k.setState({
      nodesSelectionActive: L.current.size > 0
    })));
  }, ue = r === !0 || Array.isArray(r) && r.includes(0);
  return g.jsxs("div", { className: Lr(["react-flow__pane", { draggable: ue, dragging: M, selection: e }]), onClick: D ? void 0 : z2(Y, z), onContextMenu: z2(H, z), onWheel: z2(Z, z), onPointerEnter: D ? void 0 : p, onPointerMove: D ? se : x, onPointerUp: D ? J : void 0, onPointerDownCapture: D ? Q : void 0, onClickCapture: D ? me : void 0, onPointerLeave: b, ref: z, style: _x, children: [S, g.jsx(qse, {})] });
}
function gC({ id: e, store: t, unselect: n = !1, nodeRef: r }) {
  const { addSelectedNodes: i, unselectNodesAndEdges: s, multiSelectionActive: o, nodeLookup: u, onError: c } = t.getState(), d = u.get(e);
  if (!d) {
    c == null || c("012", Ol.error012(e));
    return;
  }
  t.setState({ nodesSelectionActive: !1 }), d.selected ? (n || d.selected && o) && (s({ nodes: [d], edges: [] }), requestAnimationFrame(() => {
    var m;
    return (m = r == null ? void 0 : r.current) == null ? void 0 : m.blur();
  })) : i([e]);
}
function cz({ nodeRef: e, disabled: t = !1, noDragClassName: n, handleSelector: r, nodeId: i, isSelectable: s, nodeClickDistance: o }) {
  const u = ur(), [c, d] = F.useState(!1), m = F.useRef();
  return F.useEffect(() => {
    m.current = zae({
      getStoreItems: () => u.getState(),
      onNodeMouseDown: (p) => {
        gC({
          id: p,
          store: u,
          nodeRef: e
        });
      },
      onDragStart: () => {
        d(!0);
      },
      onDragStop: () => {
        d(!1);
      }
    });
  }, []), F.useEffect(() => {
    var p, x;
    if (t)
      (p = m.current) == null || p.destroy();
    else if (e.current)
      return (x = m.current) == null || x.update({
        noDragClassName: n,
        handleSelector: r,
        domNode: e.current,
        isSelectable: s,
        nodeId: i,
        nodeClickDistance: o
      }), () => {
        var b;
        (b = m.current) == null || b.destroy();
      };
  }, [n, r, t, s, e, i]), c;
}
const $se = (e) => (t) => t.selected && (t.draggable || e && typeof t.draggable > "u");
function fz() {
  const e = ur();
  return F.useCallback((n) => {
    const { nodeExtent: r, snapToGrid: i, snapGrid: s, nodesDraggable: o, onError: u, updateNodePositions: c, nodeLookup: d, nodeOrigin: m } = e.getState(), p = /* @__PURE__ */ new Map(), x = $se(o), b = i ? s[0] : 5, S = i ? s[1] : 5, k = n.direction.x * b * n.factor, A = n.direction.y * S * n.factor;
    for (const [, T] of d) {
      if (!x(T))
        continue;
      let M = {
        x: T.internals.positionAbsolute.x + k,
        y: T.internals.positionAbsolute.y + A
      };
      i && (M = $0(M, s));
      const { position: j, positionAbsolute: D } = jP({
        nodeId: T.id,
        nextPosition: M,
        nodeLookup: d,
        nodeExtent: r,
        nodeOrigin: m,
        onError: u
      });
      T.position = j, T.internals.positionAbsolute = D, p.set(T.id, T);
    }
    c(p);
  }, []);
}
const XE = F.createContext(null), Vse = XE.Provider;
XE.Consumer;
const dz = () => F.useContext(XE), Hse = (e) => ({
  connectOnClick: e.connectOnClick,
  noPanClassName: e.noPanClassName,
  rfId: e.rfId
}), Gse = (e, t, n) => (r) => {
  const { connectionClickStartHandle: i, connectionMode: s, connection: o } = r, { fromHandle: u, toHandle: c, isValid: d } = o, m = (c == null ? void 0 : c.nodeId) === e && (c == null ? void 0 : c.id) === t && (c == null ? void 0 : c.type) === n;
  return {
    connectingFrom: (u == null ? void 0 : u.nodeId) === e && (u == null ? void 0 : u.id) === t && (u == null ? void 0 : u.type) === n,
    connectingTo: m,
    clickConnecting: (i == null ? void 0 : i.nodeId) === e && (i == null ? void 0 : i.id) === t && (i == null ? void 0 : i.type) === n,
    isPossibleEndHandle: s === Mm.Strict ? (u == null ? void 0 : u.type) !== n : e !== (u == null ? void 0 : u.nodeId) || t !== (u == null ? void 0 : u.id),
    connectionInProcess: !!u,
    clickConnectionInProcess: !!i,
    valid: m && d
  };
};
function Kse({ type: e = "source", position: t = gt.Top, isValidConnection: n, isConnectable: r = !0, isConnectableStart: i = !0, isConnectableEnd: s = !0, id: o, onConnect: u, children: c, className: d, onMouseDown: m, onTouchStart: p, ...x }, b) {
  var se, J;
  const S = o || null, k = e === "target", A = ur(), T = dz(), { connectOnClick: M, noPanClassName: j, rfId: D } = rn(Hse, lr), { connectingFrom: z, connectingTo: I, clickConnecting: L, isPossibleEndHandle: K, connectionInProcess: ne, clickConnectionInProcess: Y, valid: H } = rn(Gse(T, S, e), lr);
  T || (J = (se = A.getState()).onError) == null || J.call(se, "010", Ol.error010());
  const Z = (ue) => {
    const { defaultEdgeOptions: de, onConnect: ce, hasDefaultEdges: W } = A.getState(), $ = {
      ...de,
      ...ue
    };
    if (W) {
      const { edges: fe, setEdges: G } = A.getState();
      G(wae($, fe));
    }
    ce == null || ce($), u == null || u($);
  }, me = (ue) => {
    if (!T)
      return;
    const de = LP(ue.nativeEvent);
    if (i && (de && ue.button === 0 || !de)) {
      const ce = A.getState();
      pC.onPointerDown(ue.nativeEvent, {
        handleDomNode: ue.currentTarget,
        autoPanOnConnect: ce.autoPanOnConnect,
        connectionMode: ce.connectionMode,
        connectionRadius: ce.connectionRadius,
        domNode: ce.domNode,
        nodeLookup: ce.nodeLookup,
        lib: ce.lib,
        isTarget: k,
        handleId: S,
        nodeId: T,
        flowId: ce.rfId,
        panBy: ce.panBy,
        cancelConnection: ce.cancelConnection,
        onConnectStart: ce.onConnectStart,
        onConnectEnd: ce.onConnectEnd,
        updateConnection: ce.updateConnection,
        onConnect: Z,
        isValidConnection: n || ce.isValidConnection,
        getTransform: () => A.getState().transform,
        getFromHandle: () => A.getState().connection.fromHandle,
        autoPanSpeed: ce.autoPanSpeed,
        dragThreshold: ce.connectionDragThreshold
      });
    }
    de ? m == null || m(ue) : p == null || p(ue);
  }, Q = (ue) => {
    const { onClickConnectStart: de, onClickConnectEnd: ce, connectionClickStartHandle: W, connectionMode: $, isValidConnection: fe, lib: G, rfId: le, nodeLookup: xe, connection: Se } = A.getState();
    if (!T || !W && !i)
      return;
    if (!W) {
      de == null || de(ue.nativeEvent, { nodeId: T, handleId: S, handleType: e }), A.setState({ connectionClickStartHandle: { nodeId: T, type: e, id: S } });
      return;
    }
    const Oe = PP(ue.target), Be = n || fe, { connection: Re, isValid: ft } = pC.isValid(ue.nativeEvent, {
      handle: {
        nodeId: T,
        id: S,
        type: e
      },
      connectionMode: $,
      fromNodeId: W.nodeId,
      fromHandleId: W.id || null,
      fromType: W.type,
      isValidConnection: Be,
      flowId: le,
      doc: Oe,
      lib: G,
      nodeLookup: xe
    });
    ft && Re && Z(Re);
    const Ie = structuredClone(Se);
    delete Ie.inProgress, Ie.toPosition = Ie.toHandle ? Ie.toHandle.position : null, ce == null || ce(ue, Ie), A.setState({ connectionClickStartHandle: null });
  };
  return g.jsx("div", { "data-handleid": S, "data-nodeid": T, "data-handlepos": t, "data-id": `${D}-${T}-${S}-${e}`, className: Lr([
    "react-flow__handle",
    `react-flow__handle-${t}`,
    "nodrag",
    j,
    d,
    {
      source: !k,
      target: k,
      connectable: r,
      connectablestart: i,
      connectableend: s,
      clickconnecting: L,
      connectingfrom: z,
      connectingto: I,
      valid: H,
      /*
       * shows where you can start a connection from
       * and where you can end it while connecting
       */
      connectionindicator: r && (!ne || K) && (ne || Y ? s : i)
    }
  ]), onMouseDown: me, onTouchStart: me, onClick: M ? Q : void 0, ref: b, ...x, children: c });
}
const Bi = F.memo(lz(Kse));
function Yse({ data: e, isConnectable: t, sourcePosition: n = gt.Bottom }) {
  return g.jsxs(g.Fragment, { children: [e == null ? void 0 : e.label, g.jsx(Bi, { type: "source", position: n, isConnectable: t })] });
}
function Wse({ data: e, isConnectable: t, targetPosition: n = gt.Top, sourcePosition: r = gt.Bottom }) {
  return g.jsxs(g.Fragment, { children: [g.jsx(Bi, { type: "target", position: n, isConnectable: t }), e == null ? void 0 : e.label, g.jsx(Bi, { type: "source", position: r, isConnectable: t })] });
}
function Xse() {
  return null;
}
function Qse({ data: e, isConnectable: t, targetPosition: n = gt.Top }) {
  return g.jsxs(g.Fragment, { children: [g.jsx(Bi, { type: "target", position: n, isConnectable: t }), e == null ? void 0 : e.label] });
}
const Vv = {
  ArrowUp: { x: 0, y: -1 },
  ArrowDown: { x: 0, y: 1 },
  ArrowLeft: { x: -1, y: 0 },
  ArrowRight: { x: 1, y: 0 }
}, gN = {
  input: Yse,
  default: Wse,
  output: Qse,
  group: Xse
};
function Zse(e) {
  var t, n, r, i;
  return e.internals.handleBounds === void 0 ? {
    width: e.width ?? e.initialWidth ?? ((t = e.style) == null ? void 0 : t.width),
    height: e.height ?? e.initialHeight ?? ((n = e.style) == null ? void 0 : n.height)
  } : {
    width: e.width ?? ((r = e.style) == null ? void 0 : r.width),
    height: e.height ?? ((i = e.style) == null ? void 0 : i.height)
  };
}
const Jse = (e) => {
  const { width: t, height: n, x: r, y: i } = U0(e.nodeLookup, {
    filter: (s) => !!s.selected
  });
  return {
    width: To(t) ? t : null,
    height: To(n) ? n : null,
    userSelectionActive: e.userSelectionActive,
    transformString: `translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${r}px,${i}px)`
  };
};
function eoe({ onSelectionContextMenu: e, noPanClassName: t, disableKeyboardA11y: n }) {
  const r = ur(), { width: i, height: s, transformString: o, userSelectionActive: u } = rn(Jse, lr), c = fz(), d = F.useRef(null);
  if (F.useEffect(() => {
    var x;
    n || (x = d.current) == null || x.focus({
      preventScroll: !0
    });
  }, [n]), cz({
    nodeRef: d
  }), u || !i || !s)
    return null;
  const m = e ? (x) => {
    const b = r.getState().nodes.filter((S) => S.selected);
    e(x, b);
  } : void 0, p = (x) => {
    Object.prototype.hasOwnProperty.call(Vv, x.key) && (x.preventDefault(), c({
      direction: Vv[x.key],
      factor: x.shiftKey ? 4 : 1
    }));
  };
  return g.jsx("div", { className: Lr(["react-flow__nodesselection", "react-flow__container", t]), style: {
    transform: o
  }, children: g.jsx("div", { ref: d, className: "react-flow__nodesselection-rect", onContextMenu: m, tabIndex: n ? void 0 : -1, onKeyDown: n ? void 0 : p, style: {
    width: i,
    height: s
  } }) });
}
const yN = typeof window < "u" ? window : void 0, toe = (e) => ({ nodesSelectionActive: e.nodesSelectionActive, userSelectionActive: e.userSelectionActive });
function hz({ children: e, onPaneClick: t, onPaneMouseEnter: n, onPaneMouseMove: r, onPaneMouseLeave: i, onPaneContextMenu: s, onPaneScroll: o, paneClickDistance: u, deleteKeyCode: c, selectionKeyCode: d, selectionOnDrag: m, selectionMode: p, onSelectionStart: x, onSelectionEnd: b, multiSelectionKeyCode: S, panActivationKeyCode: k, zoomActivationKeyCode: A, elementsSelectable: T, zoomOnScroll: M, zoomOnPinch: j, panOnScroll: D, panOnScrollSpeed: z, panOnScrollMode: I, zoomOnDoubleClick: L, panOnDrag: K, defaultViewport: ne, translateExtent: Y, minZoom: H, maxZoom: Z, preventScrolling: me, onSelectionContextMenu: Q, noWheelClassName: se, noPanClassName: J, disableKeyboardA11y: ue, onViewportChange: de, isControlledViewport: ce }) {
  const { nodesSelectionActive: W, userSelectionActive: $ } = rn(toe, lr), fe = k0(d, { target: yN }), G = k0(k, { target: yN }), le = G || K, xe = G || D, Se = m && le !== !0, Oe = fe || $ || Se;
  return Ise({ deleteKeyCode: c, multiSelectionKeyCode: S }), g.jsx(Lse, { onPaneContextMenu: s, elementsSelectable: T, zoomOnScroll: M, zoomOnPinch: j, panOnScroll: xe, panOnScrollSpeed: z, panOnScrollMode: I, zoomOnDoubleClick: L, panOnDrag: !fe && le, defaultViewport: ne, translateExtent: Y, minZoom: H, maxZoom: Z, zoomActivationKeyCode: A, preventScrolling: me, noWheelClassName: se, noPanClassName: J, onViewportChange: de, isControlledViewport: ce, paneClickDistance: u, selectionOnDrag: Se, children: g.jsxs(Use, { onSelectionStart: x, onSelectionEnd: b, onPaneClick: t, onPaneMouseEnter: n, onPaneMouseMove: r, onPaneMouseLeave: i, onPaneContextMenu: s, onPaneScroll: o, panOnDrag: le, isSelecting: !!Oe, selectionMode: p, selectionKeyPressed: fe, paneClickDistance: u, selectionOnDrag: Se, children: [e, W && g.jsx(eoe, { onSelectionContextMenu: Q, noPanClassName: J, disableKeyboardA11y: ue })] }) });
}
hz.displayName = "FlowRenderer";
const noe = F.memo(hz), roe = (e) => (t) => e ? FE(t.nodeLookup, { x: 0, y: 0, width: t.width, height: t.height }, t.transform, !0).map((n) => n.id) : Array.from(t.nodeLookup.keys());
function ioe(e) {
  return rn(F.useCallback(roe(e), [e]), lr);
}
const aoe = (e) => e.updateNodeInternals;
function soe() {
  const e = rn(aoe), [t] = F.useState(() => typeof ResizeObserver > "u" ? null : new ResizeObserver((n) => {
    const r = /* @__PURE__ */ new Map();
    n.forEach((i) => {
      const s = i.target.getAttribute("data-id");
      r.set(s, {
        id: s,
        nodeElement: i.target,
        force: !0
      });
    }), e(r);
  }));
  return F.useEffect(() => () => {
    t == null || t.disconnect();
  }, [t]), t;
}
function ooe({ node: e, nodeType: t, hasDimensions: n, resizeObserver: r }) {
  const i = ur(), s = F.useRef(null), o = F.useRef(null), u = F.useRef(e.sourcePosition), c = F.useRef(e.targetPosition), d = F.useRef(t), m = n && !!e.internals.handleBounds;
  return F.useEffect(() => {
    s.current && !e.hidden && (!m || o.current !== s.current) && (o.current && (r == null || r.unobserve(o.current)), r == null || r.observe(s.current), o.current = s.current);
  }, [m, e.hidden]), F.useEffect(() => () => {
    o.current && (r == null || r.unobserve(o.current), o.current = null);
  }, []), F.useEffect(() => {
    if (s.current) {
      const p = d.current !== t, x = u.current !== e.sourcePosition, b = c.current !== e.targetPosition;
      (p || x || b) && (d.current = t, u.current = e.sourcePosition, c.current = e.targetPosition, i.getState().updateNodeInternals(/* @__PURE__ */ new Map([[e.id, { id: e.id, nodeElement: s.current, force: !0 }]])));
    }
  }, [e.id, t, e.sourcePosition, e.targetPosition]), s;
}
function loe({ id: e, onClick: t, onMouseEnter: n, onMouseMove: r, onMouseLeave: i, onContextMenu: s, onDoubleClick: o, nodesDraggable: u, elementsSelectable: c, nodesConnectable: d, nodesFocusable: m, resizeObserver: p, noDragClassName: x, noPanClassName: b, disableKeyboardA11y: S, rfId: k, nodeTypes: A, nodeClickDistance: T, onError: M }) {
  const { node: j, internals: D, isParent: z } = rn((Be) => {
    const Re = Be.nodeLookup.get(e), ft = Be.parentLookup.has(e);
    return {
      node: Re,
      internals: Re.internals,
      isParent: ft
    };
  }, lr);
  let I = j.type || "default", L = (A == null ? void 0 : A[I]) || gN[I];
  L === void 0 && (M == null || M("003", Ol.error003(I)), I = "default", L = (A == null ? void 0 : A.default) || gN.default);
  const K = !!(j.draggable || u && typeof j.draggable > "u"), ne = !!(j.selectable || c && typeof j.selectable > "u"), Y = !!(j.connectable || d && typeof j.connectable > "u"), H = !!(j.focusable || m && typeof j.focusable > "u"), Z = ur(), me = DP(j), Q = ooe({ node: j, nodeType: I, hasDimensions: me, resizeObserver: p }), se = cz({
    nodeRef: Q,
    disabled: j.hidden || !K,
    noDragClassName: x,
    handleSelector: j.dragHandle,
    nodeId: e,
    isSelectable: ne,
    nodeClickDistance: T
  }), J = fz();
  if (j.hidden)
    return null;
  const ue = Tu(j), de = Zse(j), ce = ne || K || t || n || r || i, W = n ? (Be) => n(Be, { ...D.userNode }) : void 0, $ = r ? (Be) => r(Be, { ...D.userNode }) : void 0, fe = i ? (Be) => i(Be, { ...D.userNode }) : void 0, G = s ? (Be) => s(Be, { ...D.userNode }) : void 0, le = o ? (Be) => o(Be, { ...D.userNode }) : void 0, xe = (Be) => {
    const { selectNodesOnDrag: Re, nodeDragThreshold: ft } = Z.getState();
    ne && (!Re || !K || ft > 0) && gC({
      id: e,
      store: Z,
      nodeRef: Q
    }), t && t(Be, { ...D.userNode });
  }, Se = (Be) => {
    if (!(zP(Be.nativeEvent) || S)) {
      if (EP.includes(Be.key) && ne) {
        const Re = Be.key === "Escape";
        gC({
          id: e,
          store: Z,
          unselect: Re,
          nodeRef: Q
        });
      } else if (K && j.selected && Object.prototype.hasOwnProperty.call(Vv, Be.key)) {
        Be.preventDefault();
        const { ariaLabelConfig: Re } = Z.getState();
        Z.setState({
          ariaLiveMessage: Re["node.a11yDescription.ariaLiveMessage"]({
            direction: Be.key.replace("Arrow", "").toLowerCase(),
            x: ~~D.positionAbsolute.x,
            y: ~~D.positionAbsolute.y
          })
        }), J({
          direction: Vv[Be.key],
          factor: Be.shiftKey ? 4 : 1
        });
      }
    }
  }, Oe = () => {
    var et;
    if (S || !((et = Q.current) != null && et.matches(":focus-visible")))
      return;
    const { transform: Be, width: Re, height: ft, autoPanOnNodeFocus: Ie, setCenter: Ne } = Z.getState();
    if (!Ie)
      return;
    FE(/* @__PURE__ */ new Map([[e, j]]), { x: 0, y: 0, width: Re, height: ft }, Be, !0).length > 0 || Ne(j.position.x + ue.width / 2, j.position.y + ue.height / 2, {
      zoom: Be[2]
    });
  };
  return g.jsx("div", { className: Lr([
    "react-flow__node",
    `react-flow__node-${I}`,
    {
      // this is overwritable by passing `nopan` as a class name
      [b]: K
    },
    j.className,
    {
      selected: j.selected,
      selectable: ne,
      parent: z,
      draggable: K,
      dragging: se
    }
  ]), ref: Q, style: {
    zIndex: D.z,
    transform: `translate(${D.positionAbsolute.x}px,${D.positionAbsolute.y}px)`,
    pointerEvents: ce ? "all" : "none",
    visibility: me ? "visible" : "hidden",
    ...j.style,
    ...de
  }, "data-id": e, "data-testid": `rf__node-${e}`, onMouseEnter: W, onMouseMove: $, onMouseLeave: fe, onContextMenu: G, onClick: xe, onDoubleClick: le, onKeyDown: H ? Se : void 0, tabIndex: H ? 0 : void 0, onFocus: H ? Oe : void 0, role: j.ariaRole ?? (H ? "group" : void 0), "aria-roledescription": "node", "aria-describedby": S ? void 0 : `${nz}-${k}`, "aria-label": j.ariaLabel, ...j.domAttributes, children: g.jsx(Vse, { value: e, children: g.jsx(L, { id: e, data: j.data, type: I, positionAbsoluteX: D.positionAbsolute.x, positionAbsoluteY: D.positionAbsolute.y, selected: j.selected ?? !1, selectable: ne, draggable: K, deletable: j.deletable ?? !0, isConnectable: Y, sourcePosition: j.sourcePosition, targetPosition: j.targetPosition, dragging: se, dragHandle: j.dragHandle, zIndex: D.z, parentId: j.parentId, ...ue }) }) });
}
var uoe = F.memo(loe);
const coe = (e) => ({
  nodesDraggable: e.nodesDraggable,
  nodesConnectable: e.nodesConnectable,
  nodesFocusable: e.nodesFocusable,
  elementsSelectable: e.elementsSelectable,
  onError: e.onError
});
function mz(e) {
  const { nodesDraggable: t, nodesConnectable: n, nodesFocusable: r, elementsSelectable: i, onError: s } = rn(coe, lr), o = ioe(e.onlyRenderVisibleElements), u = soe();
  return g.jsx("div", { className: "react-flow__nodes", style: _x, children: o.map((c) => (
    /*
     * The split of responsibilities between NodeRenderer and
     * NodeComponentWrapper may appear weird. However, its designed to
     * minimize the cost of updates when individual nodes change.
     *
     * For example, when youre dragging a single node, that node gets
     * updated multiple times per second. If `NodeRenderer` were to update
     * every time, it would have to re-run the `nodes.map()` loop every
     * time. This gets pricey with hundreds of nodes, especially if every
     * loop cycle does more than just rendering a JSX element!
     *
     * As a result of this choice, we took the following implementation
     * decisions:
     * - NodeRenderer subscribes *only* to node IDs  and therefore
     *   rerender *only* when visible nodes are added or removed.
     * - NodeRenderer performs all operations the result of which can be
     *   shared between nodes (such as creating the `ResizeObserver`
     *   instance, or subscribing to `selector`). This means extra prop
     *   drilling into `NodeComponentWrapper`, but it means we need to run
     *   these operations only once  instead of once per node.
     * - Any operations that youd normally write inside `nodes.map` are
     *   moved into `NodeComponentWrapper`. This ensures they are
     *   memorized  so if `NodeRenderer` *has* to rerender, it only
     *   needs to regenerate the list of nodes, nothing else.
     */
    g.jsx(uoe, { id: c, nodeTypes: e.nodeTypes, nodeExtent: e.nodeExtent, onClick: e.onNodeClick, onMouseEnter: e.onNodeMouseEnter, onMouseMove: e.onNodeMouseMove, onMouseLeave: e.onNodeMouseLeave, onContextMenu: e.onNodeContextMenu, onDoubleClick: e.onNodeDoubleClick, noDragClassName: e.noDragClassName, noPanClassName: e.noPanClassName, rfId: e.rfId, disableKeyboardA11y: e.disableKeyboardA11y, resizeObserver: u, nodesDraggable: t, nodesConnectable: n, nodesFocusable: r, elementsSelectable: i, nodeClickDistance: e.nodeClickDistance, onError: s }, c)
  )) });
}
mz.displayName = "NodeRenderer";
const foe = F.memo(mz);
function doe(e) {
  return rn(F.useCallback((n) => {
    if (!e)
      return n.edges.map((i) => i.id);
    const r = [];
    if (n.width && n.height)
      for (const i of n.edges) {
        const s = n.nodeLookup.get(i.source), o = n.nodeLookup.get(i.target);
        s && o && vae({
          sourceNode: s,
          targetNode: o,
          width: n.width,
          height: n.height,
          transform: n.transform
        }) && r.push(i.id);
      }
    return r;
  }, [e]), lr);
}
const hoe = ({ color: e = "none", strokeWidth: t = 1 }) => {
  const n = {
    strokeWidth: t,
    ...e && { stroke: e }
  };
  return g.jsx("polyline", { className: "arrow", style: n, strokeLinecap: "round", fill: "none", strokeLinejoin: "round", points: "-5,-4 0,0 -5,4" });
}, moe = ({ color: e = "none", strokeWidth: t = 1 }) => {
  const n = {
    strokeWidth: t,
    ...e && { stroke: e, fill: e }
  };
  return g.jsx("polyline", { className: "arrowclosed", style: n, strokeLinecap: "round", strokeLinejoin: "round", points: "-5,-4 0,0 -5,4 -5,-4" });
}, vN = {
  [S0.Arrow]: hoe,
  [S0.ArrowClosed]: moe
};
function poe(e) {
  const t = ur();
  return F.useMemo(() => {
    var i, s;
    return Object.prototype.hasOwnProperty.call(vN, e) ? vN[e] : ((s = (i = t.getState()).onError) == null || s.call(i, "009", Ol.error009(e)), null);
  }, [e]);
}
const goe = ({ id: e, type: t, color: n, width: r = 12.5, height: i = 12.5, markerUnits: s = "strokeWidth", strokeWidth: o, orient: u = "auto-start-reverse" }) => {
  const c = poe(t);
  return c ? g.jsx("marker", { className: "react-flow__arrowhead", id: e, markerWidth: `${r}`, markerHeight: `${i}`, viewBox: "-10 -10 20 20", markerUnits: s, orient: u, refX: "0", refY: "0", children: g.jsx(c, { color: n, strokeWidth: o }) }) : null;
}, pz = ({ defaultColor: e, rfId: t }) => {
  const n = rn((s) => s.edges), r = rn((s) => s.defaultEdgeOptions), i = F.useMemo(() => kae(n, {
    id: t,
    defaultColor: e,
    defaultMarkerStart: r == null ? void 0 : r.markerStart,
    defaultMarkerEnd: r == null ? void 0 : r.markerEnd
  }), [n, r, t, e]);
  return i.length ? g.jsx("svg", { className: "react-flow__marker", "aria-hidden": "true", children: g.jsx("defs", { children: i.map((s) => g.jsx(goe, { id: s.id, type: s.type, color: s.color, width: s.width, height: s.height, markerUnits: s.markerUnits, strokeWidth: s.strokeWidth, orient: s.orient }, s.id)) }) }) : null;
};
pz.displayName = "MarkerDefinitions";
var yoe = F.memo(pz);
function gz({ x: e, y: t, label: n, labelStyle: r, labelShowBg: i = !0, labelBgStyle: s, labelBgPadding: o = [2, 4], labelBgBorderRadius: u = 2, children: c, className: d, ...m }) {
  const [p, x] = F.useState({ x: 1, y: 0, width: 0, height: 0 }), b = Lr(["react-flow__edge-textwrapper", d]), S = F.useRef(null);
  return F.useEffect(() => {
    if (S.current) {
      const k = S.current.getBBox();
      x({
        x: k.x,
        y: k.y,
        width: k.width,
        height: k.height
      });
    }
  }, [n]), n ? g.jsxs("g", { transform: `translate(${e - p.width / 2} ${t - p.height / 2})`, className: b, visibility: p.width ? "visible" : "hidden", ...m, children: [i && g.jsx("rect", { width: p.width + 2 * o[0], x: -o[0], y: -o[1], height: p.height + 2 * o[1], className: "react-flow__edge-textbg", style: s, rx: u, ry: u }), g.jsx("text", { className: "react-flow__edge-text", y: p.height / 2, dy: "0.3em", ref: S, style: r, children: n }), c] }) : null;
}
gz.displayName = "EdgeText";
const voe = F.memo(gz);
function Sx({ path: e, labelX: t, labelY: n, label: r, labelStyle: i, labelShowBg: s, labelBgStyle: o, labelBgPadding: u, labelBgBorderRadius: c, interactionWidth: d = 20, ...m }) {
  return g.jsxs(g.Fragment, { children: [g.jsx("path", { ...m, d: e, fill: "none", className: Lr(["react-flow__edge-path", m.className]) }), d ? g.jsx("path", { d: e, fill: "none", strokeOpacity: 0, strokeWidth: d, className: "react-flow__edge-interaction" }) : null, r && To(t) && To(n) ? g.jsx(voe, { x: t, y: n, label: r, labelStyle: i, labelShowBg: s, labelBgStyle: o, labelBgPadding: u, labelBgBorderRadius: c }) : null] });
}
function xN({ pos: e, x1: t, y1: n, x2: r, y2: i }) {
  return e === gt.Left || e === gt.Right ? [0.5 * (t + r), n] : [t, 0.5 * (n + i)];
}
function yz({ sourceX: e, sourceY: t, sourcePosition: n = gt.Bottom, targetX: r, targetY: i, targetPosition: s = gt.Top }) {
  const [o, u] = xN({
    pos: n,
    x1: e,
    y1: t,
    x2: r,
    y2: i
  }), [c, d] = xN({
    pos: s,
    x1: r,
    y1: i,
    x2: e,
    y2: t
  }), [m, p, x, b] = BP({
    sourceX: e,
    sourceY: t,
    targetX: r,
    targetY: i,
    sourceControlX: o,
    sourceControlY: u,
    targetControlX: c,
    targetControlY: d
  });
  return [
    `M${e},${t} C${o},${u} ${c},${d} ${r},${i}`,
    m,
    p,
    x,
    b
  ];
}
function vz(e) {
  return F.memo(({ id: t, sourceX: n, sourceY: r, targetX: i, targetY: s, sourcePosition: o, targetPosition: u, label: c, labelStyle: d, labelShowBg: m, labelBgStyle: p, labelBgPadding: x, labelBgBorderRadius: b, style: S, markerEnd: k, markerStart: A, interactionWidth: T }) => {
    const [M, j, D] = yz({
      sourceX: n,
      sourceY: r,
      sourcePosition: o,
      targetX: i,
      targetY: s,
      targetPosition: u
    }), z = e.isInternal ? void 0 : t;
    return g.jsx(Sx, { id: z, path: M, labelX: j, labelY: D, label: c, labelStyle: d, labelShowBg: m, labelBgStyle: p, labelBgPadding: x, labelBgBorderRadius: b, style: S, markerEnd: k, markerStart: A, interactionWidth: T });
  });
}
const xoe = vz({ isInternal: !1 }), xz = vz({ isInternal: !0 });
xoe.displayName = "SimpleBezierEdge";
xz.displayName = "SimpleBezierEdgeInternal";
function bz(e) {
  return F.memo(({ id: t, sourceX: n, sourceY: r, targetX: i, targetY: s, label: o, labelStyle: u, labelShowBg: c, labelBgStyle: d, labelBgPadding: m, labelBgBorderRadius: p, style: x, sourcePosition: b = gt.Bottom, targetPosition: S = gt.Top, markerEnd: k, markerStart: A, pathOptions: T, interactionWidth: M }) => {
    const [j, D, z] = dC({
      sourceX: n,
      sourceY: r,
      sourcePosition: b,
      targetX: i,
      targetY: s,
      targetPosition: S,
      borderRadius: T == null ? void 0 : T.borderRadius,
      offset: T == null ? void 0 : T.offset,
      stepPosition: T == null ? void 0 : T.stepPosition
    }), I = e.isInternal ? void 0 : t;
    return g.jsx(Sx, { id: I, path: j, labelX: D, labelY: z, label: o, labelStyle: u, labelShowBg: c, labelBgStyle: d, labelBgPadding: m, labelBgBorderRadius: p, style: x, markerEnd: k, markerStart: A, interactionWidth: M });
  });
}
const wz = bz({ isInternal: !1 }), _z = bz({ isInternal: !0 });
wz.displayName = "SmoothStepEdge";
_z.displayName = "SmoothStepEdgeInternal";
function Sz(e) {
  return F.memo(({ id: t, ...n }) => {
    var i;
    const r = e.isInternal ? void 0 : t;
    return g.jsx(wz, { ...n, id: r, pathOptions: F.useMemo(() => {
      var s;
      return { borderRadius: 0, offset: (s = n.pathOptions) == null ? void 0 : s.offset };
    }, [(i = n.pathOptions) == null ? void 0 : i.offset]) });
  });
}
const boe = Sz({ isInternal: !1 }), Cz = Sz({ isInternal: !0 });
boe.displayName = "StepEdge";
Cz.displayName = "StepEdgeInternal";
function Ez(e) {
  return F.memo(({ id: t, sourceX: n, sourceY: r, targetX: i, targetY: s, label: o, labelStyle: u, labelShowBg: c, labelBgStyle: d, labelBgPadding: m, labelBgBorderRadius: p, style: x, markerEnd: b, markerStart: S, interactionWidth: k }) => {
    const [A, T, M] = UP({ sourceX: n, sourceY: r, targetX: i, targetY: s }), j = e.isInternal ? void 0 : t;
    return g.jsx(Sx, { id: j, path: A, labelX: T, labelY: M, label: o, labelStyle: u, labelShowBg: c, labelBgStyle: d, labelBgPadding: m, labelBgBorderRadius: p, style: x, markerEnd: b, markerStart: S, interactionWidth: k });
  });
}
const woe = Ez({ isInternal: !1 }), kz = Ez({ isInternal: !0 });
woe.displayName = "StraightEdge";
kz.displayName = "StraightEdgeInternal";
function Tz(e) {
  return F.memo(({ id: t, sourceX: n, sourceY: r, targetX: i, targetY: s, sourcePosition: o = gt.Bottom, targetPosition: u = gt.Top, label: c, labelStyle: d, labelShowBg: m, labelBgStyle: p, labelBgPadding: x, labelBgBorderRadius: b, style: S, markerEnd: k, markerStart: A, pathOptions: T, interactionWidth: M }) => {
    const [j, D, z] = qP({
      sourceX: n,
      sourceY: r,
      sourcePosition: o,
      targetX: i,
      targetY: s,
      targetPosition: u,
      curvature: T == null ? void 0 : T.curvature
    }), I = e.isInternal ? void 0 : t;
    return g.jsx(Sx, { id: I, path: j, labelX: D, labelY: z, label: c, labelStyle: d, labelShowBg: m, labelBgStyle: p, labelBgPadding: x, labelBgBorderRadius: b, style: S, markerEnd: k, markerStart: A, interactionWidth: M });
  });
}
const _oe = Tz({ isInternal: !1 }), Nz = Tz({ isInternal: !0 });
_oe.displayName = "BezierEdge";
Nz.displayName = "BezierEdgeInternal";
const bN = {
  default: Nz,
  straight: kz,
  step: Cz,
  smoothstep: _z,
  simplebezier: xz
}, wN = {
  sourceX: null,
  sourceY: null,
  targetX: null,
  targetY: null,
  sourcePosition: null,
  targetPosition: null
}, Soe = (e, t, n) => n === gt.Left ? e - t : n === gt.Right ? e + t : e, Coe = (e, t, n) => n === gt.Top ? e - t : n === gt.Bottom ? e + t : e, _N = "react-flow__edgeupdater";
function SN({ position: e, centerX: t, centerY: n, radius: r = 10, onMouseDown: i, onMouseEnter: s, onMouseOut: o, type: u }) {
  return g.jsx("circle", { onMouseDown: i, onMouseEnter: s, onMouseOut: o, className: Lr([_N, `${_N}-${u}`]), cx: Soe(t, r, e), cy: Coe(n, r, e), r, stroke: "transparent", fill: "transparent" });
}
function Eoe({ isReconnectable: e, reconnectRadius: t, edge: n, sourceX: r, sourceY: i, targetX: s, targetY: o, sourcePosition: u, targetPosition: c, onReconnect: d, onReconnectStart: m, onReconnectEnd: p, setReconnecting: x, setUpdateHover: b }) {
  const S = ur(), k = (D, z) => {
    if (D.button !== 0)
      return;
    const { autoPanOnConnect: I, domNode: L, isValidConnection: K, connectionMode: ne, connectionRadius: Y, lib: H, onConnectStart: Z, onConnectEnd: me, cancelConnection: Q, nodeLookup: se, rfId: J, panBy: ue, updateConnection: de } = S.getState(), ce = z.type === "target", W = (G, le) => {
      x(!1), p == null || p(G, n, z.type, le);
    }, $ = (G) => d == null ? void 0 : d(n, G), fe = (G, le) => {
      x(!0), m == null || m(D, n, z.type), Z == null || Z(G, le);
    };
    pC.onPointerDown(D.nativeEvent, {
      autoPanOnConnect: I,
      connectionMode: ne,
      connectionRadius: Y,
      domNode: L,
      handleId: z.id,
      nodeId: z.nodeId,
      nodeLookup: se,
      isTarget: ce,
      edgeUpdaterType: z.type,
      lib: H,
      flowId: J,
      cancelConnection: Q,
      panBy: ue,
      isValidConnection: K,
      onConnect: $,
      onConnectStart: fe,
      onConnectEnd: me,
      onReconnectEnd: W,
      updateConnection: de,
      getTransform: () => S.getState().transform,
      getFromHandle: () => S.getState().connection.fromHandle,
      dragThreshold: S.getState().connectionDragThreshold,
      handleDomNode: D.currentTarget
    });
  }, A = (D) => k(D, { nodeId: n.target, id: n.targetHandle ?? null, type: "target" }), T = (D) => k(D, { nodeId: n.source, id: n.sourceHandle ?? null, type: "source" }), M = () => b(!0), j = () => b(!1);
  return g.jsxs(g.Fragment, { children: [(e === !0 || e === "source") && g.jsx(SN, { position: u, centerX: r, centerY: i, radius: t, onMouseDown: A, onMouseEnter: M, onMouseOut: j, type: "source" }), (e === !0 || e === "target") && g.jsx(SN, { position: c, centerX: s, centerY: o, radius: t, onMouseDown: T, onMouseEnter: M, onMouseOut: j, type: "target" })] });
}
function koe({ id: e, edgesFocusable: t, edgesReconnectable: n, elementsSelectable: r, onClick: i, onDoubleClick: s, onContextMenu: o, onMouseEnter: u, onMouseMove: c, onMouseLeave: d, reconnectRadius: m, onReconnect: p, onReconnectStart: x, onReconnectEnd: b, rfId: S, edgeTypes: k, noPanClassName: A, onError: T, disableKeyboardA11y: M }) {
  let j = rn((Ne) => Ne.edgeLookup.get(e));
  const D = rn((Ne) => Ne.defaultEdgeOptions);
  j = D ? { ...D, ...j } : j;
  let z = j.type || "default", I = (k == null ? void 0 : k[z]) || bN[z];
  I === void 0 && (T == null || T("011", Ol.error011(z)), z = "default", I = (k == null ? void 0 : k.default) || bN.default);
  const L = !!(j.focusable || t && typeof j.focusable > "u"), K = typeof p < "u" && (j.reconnectable || n && typeof j.reconnectable > "u"), ne = !!(j.selectable || r && typeof j.selectable > "u"), Y = F.useRef(null), [H, Z] = F.useState(!1), [me, Q] = F.useState(!1), se = ur(), { zIndex: J, sourceX: ue, sourceY: de, targetX: ce, targetY: W, sourcePosition: $, targetPosition: fe } = rn(F.useCallback((Ne) => {
    const Ue = Ne.nodeLookup.get(j.source), et = Ne.nodeLookup.get(j.target);
    if (!Ue || !et)
      return {
        zIndex: j.zIndex,
        ...wN
      };
    const tt = Eae({
      id: e,
      sourceNode: Ue,
      targetNode: et,
      sourceHandle: j.sourceHandle || null,
      targetHandle: j.targetHandle || null,
      connectionMode: Ne.connectionMode,
      onError: T
    });
    return {
      zIndex: yae({
        selected: j.selected,
        zIndex: j.zIndex,
        sourceNode: Ue,
        targetNode: et,
        elevateOnSelect: Ne.elevateEdgesOnSelect,
        zIndexMode: Ne.zIndexMode
      }),
      ...tt || wN
    };
  }, [j.source, j.target, j.sourceHandle, j.targetHandle, j.selected, j.zIndex]), lr), G = F.useMemo(() => j.markerStart ? `url('#${hC(j.markerStart, S)}')` : void 0, [j.markerStart, S]), le = F.useMemo(() => j.markerEnd ? `url('#${hC(j.markerEnd, S)}')` : void 0, [j.markerEnd, S]);
  if (j.hidden || ue === null || de === null || ce === null || W === null)
    return null;
  const xe = (Ne) => {
    var st;
    const { addSelectedEdges: Ue, unselectNodesAndEdges: et, multiSelectionActive: tt } = se.getState();
    ne && (se.setState({ nodesSelectionActive: !1 }), j.selected && tt ? (et({ nodes: [], edges: [j] }), (st = Y.current) == null || st.blur()) : Ue([e])), i && i(Ne, j);
  }, Se = s ? (Ne) => {
    s(Ne, { ...j });
  } : void 0, Oe = o ? (Ne) => {
    o(Ne, { ...j });
  } : void 0, Be = u ? (Ne) => {
    u(Ne, { ...j });
  } : void 0, Re = c ? (Ne) => {
    c(Ne, { ...j });
  } : void 0, ft = d ? (Ne) => {
    d(Ne, { ...j });
  } : void 0, Ie = (Ne) => {
    var Ue;
    if (!M && EP.includes(Ne.key) && ne) {
      const { unselectNodesAndEdges: et, addSelectedEdges: tt } = se.getState();
      Ne.key === "Escape" ? ((Ue = Y.current) == null || Ue.blur(), et({ edges: [j] })) : tt([e]);
    }
  };
  return g.jsx("svg", { style: { zIndex: J }, children: g.jsxs("g", { className: Lr([
    "react-flow__edge",
    `react-flow__edge-${z}`,
    j.className,
    A,
    {
      selected: j.selected,
      animated: j.animated,
      inactive: !ne && !i,
      updating: H,
      selectable: ne
    }
  ]), onClick: xe, onDoubleClick: Se, onContextMenu: Oe, onMouseEnter: Be, onMouseMove: Re, onMouseLeave: ft, onKeyDown: L ? Ie : void 0, tabIndex: L ? 0 : void 0, role: j.ariaRole ?? (L ? "group" : "img"), "aria-roledescription": "edge", "data-id": e, "data-testid": `rf__edge-${e}`, "aria-label": j.ariaLabel === null ? void 0 : j.ariaLabel || `Edge from ${j.source} to ${j.target}`, "aria-describedby": L ? `${rz}-${S}` : void 0, ref: Y, ...j.domAttributes, children: [!me && g.jsx(I, { id: e, source: j.source, target: j.target, type: j.type, selected: j.selected, animated: j.animated, selectable: ne, deletable: j.deletable ?? !0, label: j.label, labelStyle: j.labelStyle, labelShowBg: j.labelShowBg, labelBgStyle: j.labelBgStyle, labelBgPadding: j.labelBgPadding, labelBgBorderRadius: j.labelBgBorderRadius, sourceX: ue, sourceY: de, targetX: ce, targetY: W, sourcePosition: $, targetPosition: fe, data: j.data, style: j.style, sourceHandleId: j.sourceHandle, targetHandleId: j.targetHandle, markerStart: G, markerEnd: le, pathOptions: "pathOptions" in j ? j.pathOptions : void 0, interactionWidth: j.interactionWidth }), K && g.jsx(Eoe, { edge: j, isReconnectable: K, reconnectRadius: m, onReconnect: p, onReconnectStart: x, onReconnectEnd: b, sourceX: ue, sourceY: de, targetX: ce, targetY: W, sourcePosition: $, targetPosition: fe, setUpdateHover: Z, setReconnecting: Q })] }) });
}
var Toe = F.memo(koe);
const Noe = (e) => ({
  edgesFocusable: e.edgesFocusable,
  edgesReconnectable: e.edgesReconnectable,
  elementsSelectable: e.elementsSelectable,
  connectionMode: e.connectionMode,
  onError: e.onError
});
function Az({ defaultMarkerColor: e, onlyRenderVisibleElements: t, rfId: n, edgeTypes: r, noPanClassName: i, onReconnect: s, onEdgeContextMenu: o, onEdgeMouseEnter: u, onEdgeMouseMove: c, onEdgeMouseLeave: d, onEdgeClick: m, reconnectRadius: p, onEdgeDoubleClick: x, onReconnectStart: b, onReconnectEnd: S, disableKeyboardA11y: k }) {
  const { edgesFocusable: A, edgesReconnectable: T, elementsSelectable: M, onError: j } = rn(Noe, lr), D = doe(t);
  return g.jsxs("div", { className: "react-flow__edges", children: [g.jsx(yoe, { defaultColor: e, rfId: n }), D.map((z) => g.jsx(Toe, { id: z, edgesFocusable: A, edgesReconnectable: T, elementsSelectable: M, noPanClassName: i, onReconnect: s, onContextMenu: o, onMouseEnter: u, onMouseMove: c, onMouseLeave: d, onClick: m, reconnectRadius: p, onDoubleClick: x, onReconnectStart: b, onReconnectEnd: S, rfId: n, onError: j, edgeTypes: r, disableKeyboardA11y: k }, z))] });
}
Az.displayName = "EdgeRenderer";
const Aoe = F.memo(Az), joe = (e) => `translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;
function Moe({ children: e }) {
  const t = rn(joe);
  return g.jsx("div", { className: "react-flow__viewport xyflow__viewport react-flow__container", style: { transform: t }, children: e });
}
function Roe(e) {
  const t = WE(), n = F.useRef(!1);
  F.useEffect(() => {
    !n.current && t.viewportInitialized && e && (setTimeout(() => e(t), 1), n.current = !0);
  }, [e, t.viewportInitialized]);
}
const Ooe = (e) => {
  var t;
  return (t = e.panZoom) == null ? void 0 : t.syncViewport;
};
function Doe(e) {
  const t = rn(Ooe), n = ur();
  return F.useEffect(() => {
    e && (t == null || t(e), n.setState({ transform: [e.x, e.y, e.zoom] }));
  }, [e, t]), null;
}
function Ioe(e) {
  return e.connection.inProgress ? { ...e.connection, to: V0(e.connection.to, e.transform) } : { ...e.connection };
}
function Poe(e) {
  return Ioe;
}
function zoe(e) {
  const t = Poe();
  return rn(t, lr);
}
const Loe = (e) => ({
  nodesConnectable: e.nodesConnectable,
  isValid: e.connection.isValid,
  inProgress: e.connection.inProgress,
  width: e.width,
  height: e.height
});
function Boe({ containerStyle: e, style: t, type: n, component: r }) {
  const { nodesConnectable: i, width: s, height: o, isValid: u, inProgress: c } = rn(Loe, lr);
  return !(s && i && c) ? null : g.jsx("svg", { style: e, width: s, height: o, className: "react-flow__connectionline react-flow__container", children: g.jsx("g", { className: Lr(["react-flow__connection", NP(u)]), children: g.jsx(jz, { style: t, type: n, CustomComponent: r, isValid: u }) }) });
}
const jz = ({ style: e, type: t = Pc.Bezier, CustomComponent: n, isValid: r }) => {
  const { inProgress: i, from: s, fromNode: o, fromHandle: u, fromPosition: c, to: d, toNode: m, toHandle: p, toPosition: x, pointer: b } = zoe();
  if (!i)
    return;
  if (n)
    return g.jsx(n, { connectionLineType: t, connectionLineStyle: e, fromNode: o, fromHandle: u, fromX: s.x, fromY: s.y, toX: d.x, toY: d.y, fromPosition: c, toPosition: x, connectionStatus: NP(r), toNode: m, toHandle: p, pointer: b });
  let S = "";
  const k = {
    sourceX: s.x,
    sourceY: s.y,
    sourcePosition: c,
    targetX: d.x,
    targetY: d.y,
    targetPosition: x
  };
  switch (t) {
    case Pc.Bezier:
      [S] = qP(k);
      break;
    case Pc.SimpleBezier:
      [S] = yz(k);
      break;
    case Pc.Step:
      [S] = dC({
        ...k,
        borderRadius: 0
      });
      break;
    case Pc.SmoothStep:
      [S] = dC(k);
      break;
    default:
      [S] = UP(k);
  }
  return g.jsx("path", { d: S, fill: "none", className: "react-flow__connection-path", style: e });
};
jz.displayName = "ConnectionLine";
const qoe = {};
function CN(e = qoe) {
  F.useRef(e), ur(), F.useEffect(() => {
  }, [e]);
}
function Foe() {
  ur(), F.useRef(!1), F.useEffect(() => {
  }, []);
}
function Mz({ nodeTypes: e, edgeTypes: t, onInit: n, onNodeClick: r, onEdgeClick: i, onNodeDoubleClick: s, onEdgeDoubleClick: o, onNodeMouseEnter: u, onNodeMouseMove: c, onNodeMouseLeave: d, onNodeContextMenu: m, onSelectionContextMenu: p, onSelectionStart: x, onSelectionEnd: b, connectionLineType: S, connectionLineStyle: k, connectionLineComponent: A, connectionLineContainerStyle: T, selectionKeyCode: M, selectionOnDrag: j, selectionMode: D, multiSelectionKeyCode: z, panActivationKeyCode: I, zoomActivationKeyCode: L, deleteKeyCode: K, onlyRenderVisibleElements: ne, elementsSelectable: Y, defaultViewport: H, translateExtent: Z, minZoom: me, maxZoom: Q, preventScrolling: se, defaultMarkerColor: J, zoomOnScroll: ue, zoomOnPinch: de, panOnScroll: ce, panOnScrollSpeed: W, panOnScrollMode: $, zoomOnDoubleClick: fe, panOnDrag: G, onPaneClick: le, onPaneMouseEnter: xe, onPaneMouseMove: Se, onPaneMouseLeave: Oe, onPaneScroll: Be, onPaneContextMenu: Re, paneClickDistance: ft, nodeClickDistance: Ie, onEdgeContextMenu: Ne, onEdgeMouseEnter: Ue, onEdgeMouseMove: et, onEdgeMouseLeave: tt, reconnectRadius: st, onReconnect: dt, onReconnectStart: Wn, onReconnectEnd: Rn, noDragClassName: Un, noWheelClassName: Ht, noPanClassName: On, disableKeyboardA11y: an, nodeExtent: En, rfId: Xn, viewport: Fe, onViewportChange: Qe }) {
  return CN(e), CN(t), Foe(), Roe(n), Doe(Fe), g.jsx(noe, { onPaneClick: le, onPaneMouseEnter: xe, onPaneMouseMove: Se, onPaneMouseLeave: Oe, onPaneContextMenu: Re, onPaneScroll: Be, paneClickDistance: ft, deleteKeyCode: K, selectionKeyCode: M, selectionOnDrag: j, selectionMode: D, onSelectionStart: x, onSelectionEnd: b, multiSelectionKeyCode: z, panActivationKeyCode: I, zoomActivationKeyCode: L, elementsSelectable: Y, zoomOnScroll: ue, zoomOnPinch: de, zoomOnDoubleClick: fe, panOnScroll: ce, panOnScrollSpeed: W, panOnScrollMode: $, panOnDrag: G, defaultViewport: H, translateExtent: Z, minZoom: me, maxZoom: Q, onSelectionContextMenu: p, preventScrolling: se, noDragClassName: Un, noWheelClassName: Ht, noPanClassName: On, disableKeyboardA11y: an, onViewportChange: Qe, isControlledViewport: !!Fe, children: g.jsxs(Moe, { children: [g.jsx(Aoe, { edgeTypes: t, onEdgeClick: i, onEdgeDoubleClick: o, onReconnect: dt, onReconnectStart: Wn, onReconnectEnd: Rn, onlyRenderVisibleElements: ne, onEdgeContextMenu: Ne, onEdgeMouseEnter: Ue, onEdgeMouseMove: et, onEdgeMouseLeave: tt, reconnectRadius: st, defaultMarkerColor: J, noPanClassName: On, disableKeyboardA11y: an, rfId: Xn }), g.jsx(Boe, { style: k, type: S, component: A, containerStyle: T }), g.jsx("div", { className: "react-flow__edgelabel-renderer" }), g.jsx(foe, { nodeTypes: e, onNodeClick: r, onNodeDoubleClick: s, onNodeMouseEnter: u, onNodeMouseMove: c, onNodeMouseLeave: d, onNodeContextMenu: m, nodeClickDistance: Ie, onlyRenderVisibleElements: ne, noPanClassName: On, noDragClassName: Un, disableKeyboardA11y: an, nodeExtent: En, rfId: Xn }), g.jsx("div", { className: "react-flow__viewport-portal" })] }) });
}
Mz.displayName = "GraphView";
const Uoe = F.memo(Mz), EN = ({ nodes: e, edges: t, defaultNodes: n, defaultEdges: r, width: i, height: s, fitView: o, fitViewOptions: u, minZoom: c = 0.5, maxZoom: d = 2, nodeOrigin: m, nodeExtent: p, zIndexMode: x = "basic" } = {}) => {
  const b = /* @__PURE__ */ new Map(), S = /* @__PURE__ */ new Map(), k = /* @__PURE__ */ new Map(), A = /* @__PURE__ */ new Map(), T = r ?? t ?? [], M = n ?? e ?? [], j = m ?? [0, 0], D = p ?? w0;
  HP(k, A, T);
  const z = mC(M, b, S, {
    nodeOrigin: j,
    nodeExtent: D,
    zIndexMode: x
  });
  let I = [0, 0, 1];
  if (o && i && s) {
    const L = U0(b, {
      filter: (H) => !!((H.width || H.initialWidth) && (H.height || H.initialHeight))
    }), { x: K, y: ne, zoom: Y } = UE(L, i, s, c, d, (u == null ? void 0 : u.padding) ?? 0.1);
    I = [K, ne, Y];
  }
  return {
    rfId: "1",
    width: i ?? 0,
    height: s ?? 0,
    transform: I,
    nodes: M,
    nodesInitialized: z,
    nodeLookup: b,
    parentLookup: S,
    edges: T,
    edgeLookup: A,
    connectionLookup: k,
    onNodesChange: null,
    onEdgesChange: null,
    hasDefaultNodes: n !== void 0,
    hasDefaultEdges: r !== void 0,
    panZoom: null,
    minZoom: c,
    maxZoom: d,
    translateExtent: w0,
    nodeExtent: D,
    nodesSelectionActive: !1,
    userSelectionActive: !1,
    userSelectionRect: null,
    connectionMode: Mm.Strict,
    domNode: null,
    paneDragging: !1,
    noPanClassName: "nopan",
    nodeOrigin: j,
    nodeDragThreshold: 1,
    connectionDragThreshold: 1,
    snapGrid: [15, 15],
    snapToGrid: !1,
    nodesDraggable: !0,
    nodesConnectable: !0,
    nodesFocusable: !0,
    edgesFocusable: !0,
    edgesReconnectable: !0,
    elementsSelectable: !0,
    elevateNodesOnSelect: !0,
    elevateEdgesOnSelect: !0,
    selectNodesOnDrag: !0,
    multiSelectionActive: !1,
    fitViewQueued: o ?? !1,
    fitViewOptions: u,
    fitViewResolver: null,
    connection: { ...TP },
    connectionClickStartHandle: null,
    connectOnClick: !0,
    ariaLiveMessage: "",
    autoPanOnConnect: !0,
    autoPanOnNodeDrag: !0,
    autoPanOnNodeFocus: !0,
    autoPanSpeed: 15,
    connectionRadius: 20,
    onError: fae,
    isValidConnection: void 0,
    onSelectionChangeHandlers: [],
    lib: "react",
    debug: !1,
    ariaLabelConfig: kP,
    zIndexMode: x,
    onNodesChangeMiddlewareMap: /* @__PURE__ */ new Map(),
    onEdgesChangeMiddlewareMap: /* @__PURE__ */ new Map()
  };
}, $oe = ({ nodes: e, edges: t, defaultNodes: n, defaultEdges: r, width: i, height: s, fitView: o, fitViewOptions: u, minZoom: c, maxZoom: d, nodeOrigin: m, nodeExtent: p, zIndexMode: x }) => ose((b, S) => {
  async function k() {
    const { nodeLookup: A, panZoom: T, fitViewOptions: M, fitViewResolver: j, width: D, height: z, minZoom: I, maxZoom: L } = S();
    T && (await uae({
      nodes: A,
      width: D,
      height: z,
      panZoom: T,
      minZoom: I,
      maxZoom: L
    }, M), j == null || j.resolve(!0), b({ fitViewResolver: null }));
  }
  return {
    ...EN({
      nodes: e,
      edges: t,
      width: i,
      height: s,
      fitView: o,
      fitViewOptions: u,
      minZoom: c,
      maxZoom: d,
      nodeOrigin: m,
      nodeExtent: p,
      defaultNodes: n,
      defaultEdges: r,
      zIndexMode: x
    }),
    setNodes: (A) => {
      const { nodeLookup: T, parentLookup: M, nodeOrigin: j, elevateNodesOnSelect: D, fitViewQueued: z, zIndexMode: I } = S(), L = mC(A, T, M, {
        nodeOrigin: j,
        nodeExtent: p,
        elevateNodesOnSelect: D,
        checkEquality: !0,
        zIndexMode: I
      });
      z && L ? (k(), b({ nodes: A, nodesInitialized: L, fitViewQueued: !1, fitViewOptions: void 0 })) : b({ nodes: A, nodesInitialized: L });
    },
    setEdges: (A) => {
      const { connectionLookup: T, edgeLookup: M } = S();
      HP(T, M, A), b({ edges: A });
    },
    setDefaultNodesAndEdges: (A, T) => {
      if (A) {
        const { setNodes: M } = S();
        M(A), b({ hasDefaultNodes: !0 });
      }
      if (T) {
        const { setEdges: M } = S();
        M(T), b({ hasDefaultEdges: !0 });
      }
    },
    /*
     * Every node gets registerd at a ResizeObserver. Whenever a node
     * changes its dimensions, this function is called to measure the
     * new dimensions and update the nodes.
     */
    updateNodeInternals: (A) => {
      const { triggerNodeChanges: T, nodeLookup: M, parentLookup: j, domNode: D, nodeOrigin: z, nodeExtent: I, debug: L, fitViewQueued: K, zIndexMode: ne } = S(), { changes: Y, updatedInternals: H } = Oae(A, M, j, D, z, I, ne);
      H && (Aae(M, j, { nodeOrigin: z, nodeExtent: I, zIndexMode: ne }), K ? (k(), b({ fitViewQueued: !1, fitViewOptions: void 0 })) : b({}), (Y == null ? void 0 : Y.length) > 0 && (L && console.log("React Flow: trigger node changes", Y), T == null || T(Y)));
    },
    updateNodePositions: (A, T = !1) => {
      const M = [];
      let j = [];
      const { nodeLookup: D, triggerNodeChanges: z, connection: I, updateConnection: L, onNodesChangeMiddlewareMap: K } = S();
      for (const [ne, Y] of A) {
        const H = D.get(ne), Z = !!(H != null && H.expandParent && (H != null && H.parentId) && (Y != null && Y.position)), me = {
          id: ne,
          type: "position",
          position: Z ? {
            x: Math.max(0, Y.position.x),
            y: Math.max(0, Y.position.y)
          } : Y.position,
          dragging: T
        };
        if (H && I.inProgress && I.fromNode.id === H.id) {
          const Q = zd(H, I.fromHandle, gt.Left, !0);
          L({ ...I, from: Q });
        }
        Z && H.parentId && M.push({
          id: ne,
          parentId: H.parentId,
          rect: {
            ...Y.internals.positionAbsolute,
            width: Y.measured.width ?? 0,
            height: Y.measured.height ?? 0
          }
        }), j.push(me);
      }
      if (M.length > 0) {
        const { parentLookup: ne, nodeOrigin: Y } = S(), H = YE(M, D, ne, Y);
        j.push(...H);
      }
      for (const ne of K.values())
        j = ne(j);
      z(j);
    },
    triggerNodeChanges: (A) => {
      const { onNodesChange: T, setNodes: M, nodes: j, hasDefaultNodes: D, debug: z } = S();
      if (A != null && A.length) {
        if (D) {
          const I = sz(A, j);
          M(I);
        }
        z && console.log("React Flow: trigger node changes", A), T == null || T(A);
      }
    },
    triggerEdgeChanges: (A) => {
      const { onEdgesChange: T, setEdges: M, edges: j, hasDefaultEdges: D, debug: z } = S();
      if (A != null && A.length) {
        if (D) {
          const I = oz(A, j);
          M(I);
        }
        z && console.log("React Flow: trigger edge changes", A), T == null || T(A);
      }
    },
    addSelectedNodes: (A) => {
      const { multiSelectionActive: T, edgeLookup: M, nodeLookup: j, triggerNodeChanges: D, triggerEdgeChanges: z } = S();
      if (T) {
        const I = A.map((L) => hd(L, !0));
        D(I);
        return;
      }
      D(wm(j, /* @__PURE__ */ new Set([...A]), !0)), z(wm(M));
    },
    addSelectedEdges: (A) => {
      const { multiSelectionActive: T, edgeLookup: M, nodeLookup: j, triggerNodeChanges: D, triggerEdgeChanges: z } = S();
      if (T) {
        const I = A.map((L) => hd(L, !0));
        z(I);
        return;
      }
      z(wm(M, /* @__PURE__ */ new Set([...A]))), D(wm(j, /* @__PURE__ */ new Set(), !0));
    },
    unselectNodesAndEdges: ({ nodes: A, edges: T } = {}) => {
      const { edges: M, nodes: j, nodeLookup: D, triggerNodeChanges: z, triggerEdgeChanges: I } = S(), L = A || j, K = T || M, ne = L.map((H) => {
        const Z = D.get(H.id);
        return Z && (Z.selected = !1), hd(H.id, !1);
      }), Y = K.map((H) => hd(H.id, !1));
      z(ne), I(Y);
    },
    setMinZoom: (A) => {
      const { panZoom: T, maxZoom: M } = S();
      T == null || T.setScaleExtent([A, M]), b({ minZoom: A });
    },
    setMaxZoom: (A) => {
      const { panZoom: T, minZoom: M } = S();
      T == null || T.setScaleExtent([M, A]), b({ maxZoom: A });
    },
    setTranslateExtent: (A) => {
      var T;
      (T = S().panZoom) == null || T.setTranslateExtent(A), b({ translateExtent: A });
    },
    resetSelectedElements: () => {
      const { edges: A, nodes: T, triggerNodeChanges: M, triggerEdgeChanges: j, elementsSelectable: D } = S();
      if (!D)
        return;
      const z = T.reduce((L, K) => K.selected ? [...L, hd(K.id, !1)] : L, []), I = A.reduce((L, K) => K.selected ? [...L, hd(K.id, !1)] : L, []);
      M(z), j(I);
    },
    setNodeExtent: (A) => {
      const { nodes: T, nodeLookup: M, parentLookup: j, nodeOrigin: D, elevateNodesOnSelect: z, nodeExtent: I, zIndexMode: L } = S();
      A[0][0] === I[0][0] && A[0][1] === I[0][1] && A[1][0] === I[1][0] && A[1][1] === I[1][1] || (mC(T, M, j, {
        nodeOrigin: D,
        nodeExtent: A,
        elevateNodesOnSelect: z,
        checkEquality: !1,
        zIndexMode: L
      }), b({ nodeExtent: A }));
    },
    panBy: (A) => {
      const { transform: T, width: M, height: j, panZoom: D, translateExtent: z } = S();
      return Dae({ delta: A, panZoom: D, transform: T, translateExtent: z, width: M, height: j });
    },
    setCenter: async (A, T, M) => {
      const { width: j, height: D, maxZoom: z, panZoom: I } = S();
      if (!I)
        return Promise.resolve(!1);
      const L = typeof (M == null ? void 0 : M.zoom) < "u" ? M.zoom : z;
      return await I.setViewport({
        x: j / 2 - A * L,
        y: D / 2 - T * L,
        zoom: L
      }, { duration: M == null ? void 0 : M.duration, ease: M == null ? void 0 : M.ease, interpolate: M == null ? void 0 : M.interpolate }), Promise.resolve(!0);
    },
    cancelConnection: () => {
      b({
        connection: { ...TP }
      });
    },
    updateConnection: (A) => {
      b({ connection: A });
    },
    reset: () => b({ ...EN() })
  };
}, Object.is);
function Voe({ initialNodes: e, initialEdges: t, defaultNodes: n, defaultEdges: r, initialWidth: i, initialHeight: s, initialMinZoom: o, initialMaxZoom: u, initialFitViewOptions: c, fitView: d, nodeOrigin: m, nodeExtent: p, zIndexMode: x, children: b }) {
  const [S] = F.useState(() => $oe({
    nodes: e,
    edges: t,
    defaultNodes: n,
    defaultEdges: r,
    width: i,
    height: s,
    fitView: d,
    minZoom: o,
    maxZoom: u,
    fitViewOptions: c,
    nodeOrigin: m,
    nodeExtent: p,
    zIndexMode: x
  }));
  return g.jsx(lse, { value: S, children: g.jsx(Mse, { children: b }) });
}
function Hoe({ children: e, nodes: t, edges: n, defaultNodes: r, defaultEdges: i, width: s, height: o, fitView: u, fitViewOptions: c, minZoom: d, maxZoom: m, nodeOrigin: p, nodeExtent: x, zIndexMode: b }) {
  return F.useContext(bx) ? g.jsx(g.Fragment, { children: e }) : g.jsx(Voe, { initialNodes: t, initialEdges: n, defaultNodes: r, defaultEdges: i, initialWidth: s, initialHeight: o, fitView: u, initialFitViewOptions: c, initialMinZoom: d, initialMaxZoom: m, nodeOrigin: p, nodeExtent: x, zIndexMode: b, children: e });
}
const Goe = {
  width: "100%",
  height: "100%",
  overflow: "hidden",
  position: "relative",
  zIndex: 0
};
function Koe({ nodes: e, edges: t, defaultNodes: n, defaultEdges: r, className: i, nodeTypes: s, edgeTypes: o, onNodeClick: u, onEdgeClick: c, onInit: d, onMove: m, onMoveStart: p, onMoveEnd: x, onConnect: b, onConnectStart: S, onConnectEnd: k, onClickConnectStart: A, onClickConnectEnd: T, onNodeMouseEnter: M, onNodeMouseMove: j, onNodeMouseLeave: D, onNodeContextMenu: z, onNodeDoubleClick: I, onNodeDragStart: L, onNodeDrag: K, onNodeDragStop: ne, onNodesDelete: Y, onEdgesDelete: H, onDelete: Z, onSelectionChange: me, onSelectionDragStart: Q, onSelectionDrag: se, onSelectionDragStop: J, onSelectionContextMenu: ue, onSelectionStart: de, onSelectionEnd: ce, onBeforeDelete: W, connectionMode: $, connectionLineType: fe = Pc.Bezier, connectionLineStyle: G, connectionLineComponent: le, connectionLineContainerStyle: xe, deleteKeyCode: Se = "Backspace", selectionKeyCode: Oe = "Shift", selectionOnDrag: Be = !1, selectionMode: Re = _0.Full, panActivationKeyCode: ft = "Space", multiSelectionKeyCode: Ie = E0() ? "Meta" : "Control", zoomActivationKeyCode: Ne = E0() ? "Meta" : "Control", snapToGrid: Ue, snapGrid: et, onlyRenderVisibleElements: tt = !1, selectNodesOnDrag: st, nodesDraggable: dt, autoPanOnNodeFocus: Wn, nodesConnectable: Rn, nodesFocusable: Un, nodeOrigin: Ht = iz, edgesFocusable: On, edgesReconnectable: an, elementsSelectable: En = !0, defaultViewport: Xn = wse, minZoom: Fe = 0.5, maxZoom: Qe = 2, translateExtent: yt = w0, preventScrolling: Tt = !0, nodeExtent: Pt, defaultMarkerColor: $n = "#b1b1b7", zoomOnScroll: Vn = !0, zoomOnPinch: sn = !0, panOnScroll: Qt = !1, panOnScrollSpeed: kn = 0.5, panOnScrollMode: it = Nd.Free, zoomOnDoubleClick: jr = !0, panOnDrag: fr = !0, onPaneClick: Io, onPaneMouseEnter: ct, onPaneMouseMove: Va, onPaneMouseLeave: gs, onPaneScroll: Ui, onPaneContextMenu: Us, paneClickDistance: Ha = 1, nodeClickDistance: Gc = 0, children: zl, onReconnect: ha, onReconnectStart: Si, onReconnectEnd: Ll, onEdgeContextMenu: Ga, onEdgeDoubleClick: vn, onEdgeMouseEnter: Dn, onEdgeMouseMove: Bl, onEdgeMouseLeave: ys, reconnectRadius: $s = 10, onNodesChange: Vs, onEdgesChange: ma, noDragClassName: wn = "nodrag", noWheelClassName: Qn = "nowheel", noPanClassName: Mr = "nopan", fitView: pa, fitViewOptions: ju, connectOnClick: ga, attributionPosition: ql, proOptions: li, defaultEdgeOptions: Po, elevateNodesOnSelect: ya = !0, elevateEdgesOnSelect: on = !1, disableKeyboardA11y: ei = !1, autoPanOnConnect: dr, autoPanOnNodeDrag: Zn, autoPanSpeed: Ka, connectionRadius: Hs, isValidConnection: Ci, onError: $i, style: va, id: zo, nodeDragThreshold: Gs, connectionDragThreshold: Mu, viewport: zt, onViewportChange: vs, width: ui, height: xr, colorMode: xa = "light", debug: Ru, onScroll: ba, ariaLabelConfig: xs, zIndexMode: Zt = "basic", ...Ks }, hr) {
  const ci = zo || "1", bs = Ese(xa), Ys = F.useCallback((fi) => {
    fi.currentTarget.scrollTo({ top: 0, left: 0, behavior: "instant" }), ba == null || ba(fi);
  }, [ba]);
  return g.jsx("div", { "data-testid": "rf__wrapper", ...Ks, onScroll: Ys, style: { ...va, ...Goe }, ref: hr, className: Lr(["react-flow", i, bs]), id: zo, role: "application", children: g.jsxs(Hoe, { nodes: e, edges: t, width: ui, height: xr, fitView: pa, fitViewOptions: ju, minZoom: Fe, maxZoom: Qe, nodeOrigin: Ht, nodeExtent: Pt, zIndexMode: Zt, children: [g.jsx(Uoe, { onInit: d, onNodeClick: u, onEdgeClick: c, onNodeMouseEnter: M, onNodeMouseMove: j, onNodeMouseLeave: D, onNodeContextMenu: z, onNodeDoubleClick: I, nodeTypes: s, edgeTypes: o, connectionLineType: fe, connectionLineStyle: G, connectionLineComponent: le, connectionLineContainerStyle: xe, selectionKeyCode: Oe, selectionOnDrag: Be, selectionMode: Re, deleteKeyCode: Se, multiSelectionKeyCode: Ie, panActivationKeyCode: ft, zoomActivationKeyCode: Ne, onlyRenderVisibleElements: tt, defaultViewport: Xn, translateExtent: yt, minZoom: Fe, maxZoom: Qe, preventScrolling: Tt, zoomOnScroll: Vn, zoomOnPinch: sn, zoomOnDoubleClick: jr, panOnScroll: Qt, panOnScrollSpeed: kn, panOnScrollMode: it, panOnDrag: fr, onPaneClick: Io, onPaneMouseEnter: ct, onPaneMouseMove: Va, onPaneMouseLeave: gs, onPaneScroll: Ui, onPaneContextMenu: Us, paneClickDistance: Ha, nodeClickDistance: Gc, onSelectionContextMenu: ue, onSelectionStart: de, onSelectionEnd: ce, onReconnect: ha, onReconnectStart: Si, onReconnectEnd: Ll, onEdgeContextMenu: Ga, onEdgeDoubleClick: vn, onEdgeMouseEnter: Dn, onEdgeMouseMove: Bl, onEdgeMouseLeave: ys, reconnectRadius: $s, defaultMarkerColor: $n, noDragClassName: wn, noWheelClassName: Qn, noPanClassName: Mr, rfId: ci, disableKeyboardA11y: ei, nodeExtent: Pt, viewport: zt, onViewportChange: vs }), g.jsx(Cse, { nodes: e, edges: t, defaultNodes: n, defaultEdges: r, onConnect: b, onConnectStart: S, onConnectEnd: k, onClickConnectStart: A, onClickConnectEnd: T, nodesDraggable: dt, autoPanOnNodeFocus: Wn, nodesConnectable: Rn, nodesFocusable: Un, edgesFocusable: On, edgesReconnectable: an, elementsSelectable: En, elevateNodesOnSelect: ya, elevateEdgesOnSelect: on, minZoom: Fe, maxZoom: Qe, nodeExtent: Pt, onNodesChange: Vs, onEdgesChange: ma, snapToGrid: Ue, snapGrid: et, connectionMode: $, translateExtent: yt, connectOnClick: ga, defaultEdgeOptions: Po, fitView: pa, fitViewOptions: ju, onNodesDelete: Y, onEdgesDelete: H, onDelete: Z, onNodeDragStart: L, onNodeDrag: K, onNodeDragStop: ne, onSelectionDrag: se, onSelectionDragStart: Q, onSelectionDragStop: J, onMove: m, onMoveStart: p, onMoveEnd: x, noPanClassName: Mr, nodeOrigin: Ht, rfId: ci, autoPanOnConnect: dr, autoPanOnNodeDrag: Zn, autoPanSpeed: Ka, onError: $i, connectionRadius: Hs, isValidConnection: Ci, selectNodesOnDrag: st, nodeDragThreshold: Gs, connectionDragThreshold: Mu, onBeforeDelete: W, debug: Ru, ariaLabelConfig: xs, zIndexMode: Zt }), g.jsx(bse, { onSelectionChange: me }), zl, g.jsx(pse, { proOptions: li, position: ql }), g.jsx(mse, { rfId: ci, disableKeyboardA11y: ei })] }) });
}
var Yoe = lz(Koe);
function Woe(e) {
  const [t, n] = F.useState(e), r = F.useCallback((i) => n((s) => sz(i, s)), []);
  return [t, n, r];
}
function Xoe(e) {
  const [t, n] = F.useState(e), r = F.useCallback((i) => n((s) => oz(i, s)), []);
  return [t, n, r];
}
function Qoe({ dimensions: e, lineWidth: t, variant: n, className: r }) {
  return g.jsx("path", { strokeWidth: t, d: `M${e[0] / 2} 0 V${e[1]} M0 ${e[1] / 2} H${e[0]}`, className: Lr(["react-flow__background-pattern", n, r]) });
}
function Zoe({ radius: e, className: t }) {
  return g.jsx("circle", { cx: e, cy: e, r: e, className: Lr(["react-flow__background-pattern", "dots", t]) });
}
var Bc;
(function(e) {
  e.Lines = "lines", e.Dots = "dots", e.Cross = "cross";
})(Bc || (Bc = {}));
const Joe = {
  [Bc.Dots]: 1,
  [Bc.Lines]: 1,
  [Bc.Cross]: 6
}, ele = (e) => ({ transform: e.transform, patternId: `pattern-${e.rfId}` });
function Rz({
  id: e,
  variant: t = Bc.Dots,
  // only used for dots and cross
  gap: n = 20,
  // only used for lines and cross
  size: r,
  lineWidth: i = 1,
  offset: s = 0,
  color: o,
  bgColor: u,
  style: c,
  className: d,
  patternClassName: m
}) {
  const p = F.useRef(null), { transform: x, patternId: b } = rn(ele, lr), S = r || Joe[t], k = t === Bc.Dots, A = t === Bc.Cross, T = Array.isArray(n) ? n : [n, n], M = [T[0] * x[2] || 1, T[1] * x[2] || 1], j = S * x[2], D = Array.isArray(s) ? s : [s, s], z = A ? [j, j] : M, I = [
    D[0] * x[2] || 1 + z[0] / 2,
    D[1] * x[2] || 1 + z[1] / 2
  ], L = `${b}${e || ""}`;
  return g.jsxs("svg", { className: Lr(["react-flow__background", d]), style: {
    ...c,
    ..._x,
    "--xy-background-color-props": u,
    "--xy-background-pattern-color-props": o
  }, ref: p, "data-testid": "rf__background", children: [g.jsx("pattern", { id: L, x: x[0] % M[0], y: x[1] % M[1], width: M[0], height: M[1], patternUnits: "userSpaceOnUse", patternTransform: `translate(-${I[0]},-${I[1]})`, children: k ? g.jsx(Zoe, { radius: j / 2, className: m }) : g.jsx(Qoe, { dimensions: z, lineWidth: i, variant: t, className: m }) }), g.jsx("rect", { x: "0", y: "0", width: "100%", height: "100%", fill: `url(#${L})` })] });
}
Rz.displayName = "Background";
const tle = F.memo(Rz);
function nle() {
  return g.jsx("svg", { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 32 32", children: g.jsx("path", { d: "M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z" }) });
}
function rle() {
  return g.jsx("svg", { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 32 5", children: g.jsx("path", { d: "M0 0h32v4.2H0z" }) });
}
function ile() {
  return g.jsx("svg", { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 32 30", children: g.jsx("path", { d: "M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z" }) });
}
function ale() {
  return g.jsx("svg", { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 25 32", children: g.jsx("path", { d: "M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z" }) });
}
function sle() {
  return g.jsx("svg", { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 25 32", children: g.jsx("path", { d: "M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z" }) });
}
function J1({ children: e, className: t, ...n }) {
  return g.jsx("button", { type: "button", className: Lr(["react-flow__controls-button", t]), ...n, children: e });
}
const ole = (e) => ({
  isInteractive: e.nodesDraggable || e.nodesConnectable || e.elementsSelectable,
  minZoomReached: e.transform[2] <= e.minZoom,
  maxZoomReached: e.transform[2] >= e.maxZoom,
  ariaLabelConfig: e.ariaLabelConfig
});
function Oz({ style: e, showZoom: t = !0, showFitView: n = !0, showInteractive: r = !0, fitViewOptions: i, onZoomIn: s, onZoomOut: o, onFitView: u, onInteractiveChange: c, className: d, children: m, position: p = "bottom-left", orientation: x = "vertical", "aria-label": b }) {
  const S = ur(), { isInteractive: k, minZoomReached: A, maxZoomReached: T, ariaLabelConfig: M } = rn(ole, lr), { zoomIn: j, zoomOut: D, fitView: z } = WE(), I = () => {
    j(), s == null || s();
  }, L = () => {
    D(), o == null || o();
  }, K = () => {
    z(i), u == null || u();
  }, ne = () => {
    S.setState({
      nodesDraggable: !k,
      nodesConnectable: !k,
      elementsSelectable: !k
    }), c == null || c(!k);
  }, Y = x === "horizontal" ? "horizontal" : "vertical";
  return g.jsxs(wx, { className: Lr(["react-flow__controls", Y, d]), position: p, style: e, "data-testid": "rf__controls", "aria-label": b ?? M["controls.ariaLabel"], children: [t && g.jsxs(g.Fragment, { children: [g.jsx(J1, { onClick: I, className: "react-flow__controls-zoomin", title: M["controls.zoomIn.ariaLabel"], "aria-label": M["controls.zoomIn.ariaLabel"], disabled: T, children: g.jsx(nle, {}) }), g.jsx(J1, { onClick: L, className: "react-flow__controls-zoomout", title: M["controls.zoomOut.ariaLabel"], "aria-label": M["controls.zoomOut.ariaLabel"], disabled: A, children: g.jsx(rle, {}) })] }), n && g.jsx(J1, { className: "react-flow__controls-fitview", onClick: K, title: M["controls.fitView.ariaLabel"], "aria-label": M["controls.fitView.ariaLabel"], children: g.jsx(ile, {}) }), r && g.jsx(J1, { className: "react-flow__controls-interactive", onClick: ne, title: M["controls.interactive.ariaLabel"], "aria-label": M["controls.interactive.ariaLabel"], children: k ? g.jsx(sle, {}) : g.jsx(ale, {}) }), m] });
}
Oz.displayName = "Controls";
const lle = F.memo(Oz);
function ule({ id: e, x: t, y: n, width: r, height: i, style: s, color: o, strokeColor: u, strokeWidth: c, className: d, borderRadius: m, shapeRendering: p, selected: x, onClick: b }) {
  const { background: S, backgroundColor: k } = s || {}, A = o || S || k;
  return g.jsx("rect", { className: Lr(["react-flow__minimap-node", { selected: x }, d]), x: t, y: n, rx: m, ry: m, width: r, height: i, style: {
    fill: A,
    stroke: u,
    strokeWidth: c
  }, shapeRendering: p, onClick: b ? (T) => b(T, e) : void 0 });
}
const cle = F.memo(ule), fle = (e) => e.nodes.map((t) => t.id), L2 = (e) => e instanceof Function ? e : () => e;
function dle({
  nodeStrokeColor: e,
  nodeColor: t,
  nodeClassName: n = "",
  nodeBorderRadius: r = 5,
  nodeStrokeWidth: i,
  /*
   * We need to rename the prop to be `CapitalCase` so that JSX will render it as
   * a component properly.
   */
  nodeComponent: s = cle,
  onClick: o
}) {
  const u = rn(fle, lr), c = L2(t), d = L2(e), m = L2(n), p = typeof window > "u" || window.chrome ? "crispEdges" : "geometricPrecision";
  return g.jsx(g.Fragment, { children: u.map((x) => (
    /*
     * The split of responsibilities between MiniMapNodes and
     * NodeComponentWrapper may appear weird. However, its designed to
     * minimize the cost of updates when individual nodes change.
     *
     * For more details, see a similar commit in `NodeRenderer/index.tsx`.
     */
    g.jsx(mle, { id: x, nodeColorFunc: c, nodeStrokeColorFunc: d, nodeClassNameFunc: m, nodeBorderRadius: r, nodeStrokeWidth: i, NodeComponent: s, onClick: o, shapeRendering: p }, x)
  )) });
}
function hle({ id: e, nodeColorFunc: t, nodeStrokeColorFunc: n, nodeClassNameFunc: r, nodeBorderRadius: i, nodeStrokeWidth: s, shapeRendering: o, NodeComponent: u, onClick: c }) {
  const { node: d, x: m, y: p, width: x, height: b } = rn((S) => {
    const { internals: k } = S.nodeLookup.get(e), A = k.userNode, { x: T, y: M } = k.positionAbsolute, { width: j, height: D } = Tu(A);
    return {
      node: A,
      x: T,
      y: M,
      width: j,
      height: D
    };
  }, lr);
  return !d || d.hidden || !DP(d) ? null : g.jsx(u, { x: m, y: p, width: x, height: b, style: d.style, selected: !!d.selected, className: r(d), color: t(d), borderRadius: i, strokeColor: n(d), strokeWidth: s, shapeRendering: o, onClick: c, id: d.id });
}
const mle = F.memo(hle);
var ple = F.memo(dle);
const gle = 200, yle = 150, vle = (e) => !e.hidden, xle = (e) => {
  const t = {
    x: -e.transform[0] / e.transform[2],
    y: -e.transform[1] / e.transform[2],
    width: e.width / e.transform[2],
    height: e.height / e.transform[2]
  };
  return {
    viewBB: t,
    boundingRect: e.nodeLookup.size > 0 ? OP(U0(e.nodeLookup, { filter: vle }), t) : t,
    rfId: e.rfId,
    panZoom: e.panZoom,
    translateExtent: e.translateExtent,
    flowWidth: e.width,
    flowHeight: e.height,
    ariaLabelConfig: e.ariaLabelConfig
  };
}, ble = "react-flow__minimap-desc";
function Dz({
  style: e,
  className: t,
  nodeStrokeColor: n,
  nodeColor: r,
  nodeClassName: i = "",
  nodeBorderRadius: s = 5,
  nodeStrokeWidth: o,
  /*
   * We need to rename the prop to be `CapitalCase` so that JSX will render it as
   * a component properly.
   */
  nodeComponent: u,
  bgColor: c,
  maskColor: d,
  maskStrokeColor: m,
  maskStrokeWidth: p,
  position: x = "bottom-right",
  onClick: b,
  onNodeClick: S,
  pannable: k = !1,
  zoomable: A = !1,
  ariaLabel: T,
  inversePan: M,
  zoomStep: j = 1,
  offsetScale: D = 5
}) {
  const z = ur(), I = F.useRef(null), { boundingRect: L, viewBB: K, rfId: ne, panZoom: Y, translateExtent: H, flowWidth: Z, flowHeight: me, ariaLabelConfig: Q } = rn(xle, lr), se = (e == null ? void 0 : e.width) ?? gle, J = (e == null ? void 0 : e.height) ?? yle, ue = L.width / se, de = L.height / J, ce = Math.max(ue, de), W = ce * se, $ = ce * J, fe = D * ce, G = L.x - (W - L.width) / 2 - fe, le = L.y - ($ - L.height) / 2 - fe, xe = W + fe * 2, Se = $ + fe * 2, Oe = `${ble}-${ne}`, Be = F.useRef(0), Re = F.useRef();
  Be.current = ce, F.useEffect(() => {
    if (I.current && Y)
      return Re.current = $ae({
        domNode: I.current,
        panZoom: Y,
        getTransform: () => z.getState().transform,
        getViewScale: () => Be.current
      }), () => {
        var Ue;
        (Ue = Re.current) == null || Ue.destroy();
      };
  }, [Y]), F.useEffect(() => {
    var Ue;
    (Ue = Re.current) == null || Ue.update({
      translateExtent: H,
      width: Z,
      height: me,
      inversePan: M,
      pannable: k,
      zoomStep: j,
      zoomable: A
    });
  }, [k, A, M, j, H, Z, me]);
  const ft = b ? (Ue) => {
    var st;
    const [et, tt] = ((st = Re.current) == null ? void 0 : st.pointer(Ue)) || [0, 0];
    b(Ue, { x: et, y: tt });
  } : void 0, Ie = S ? F.useCallback((Ue, et) => {
    const tt = z.getState().nodeLookup.get(et).internals.userNode;
    S(Ue, tt);
  }, []) : void 0, Ne = T ?? Q["minimap.ariaLabel"];
  return g.jsx(wx, { position: x, style: {
    ...e,
    "--xy-minimap-background-color-props": typeof c == "string" ? c : void 0,
    "--xy-minimap-mask-background-color-props": typeof d == "string" ? d : void 0,
    "--xy-minimap-mask-stroke-color-props": typeof m == "string" ? m : void 0,
    "--xy-minimap-mask-stroke-width-props": typeof p == "number" ? p * ce : void 0,
    "--xy-minimap-node-background-color-props": typeof r == "string" ? r : void 0,
    "--xy-minimap-node-stroke-color-props": typeof n == "string" ? n : void 0,
    "--xy-minimap-node-stroke-width-props": typeof o == "number" ? o : void 0
  }, className: Lr(["react-flow__minimap", t]), "data-testid": "rf__minimap", children: g.jsxs("svg", { width: se, height: J, viewBox: `${G} ${le} ${xe} ${Se}`, className: "react-flow__minimap-svg", role: "img", "aria-labelledby": Oe, ref: I, onClick: ft, children: [Ne && g.jsx("title", { id: Oe, children: Ne }), g.jsx(ple, { onClick: Ie, nodeColor: r, nodeStrokeColor: n, nodeBorderRadius: s, nodeClassName: i, nodeStrokeWidth: o, nodeComponent: u }), g.jsx("path", { className: "react-flow__minimap-mask", d: `M${G - fe},${le - fe}h${xe + fe * 2}v${Se + fe * 2}h${-xe - fe * 2}z
        M${K.x},${K.y}h${K.width}v${K.height}h${-K.width}z`, fillRule: "evenodd", pointerEvents: "none" })] }) });
}
Dz.displayName = "MiniMap";
const wle = F.memo(Dz), _le = (e) => (t) => e ? `${Math.max(1 / t.transform[2], 1)}` : void 0, Sle = {
  [Im.Line]: "right",
  [Im.Handle]: "bottom-right"
};
function Cle({ nodeId: e, position: t, variant: n = Im.Handle, className: r, style: i = void 0, children: s, color: o, minWidth: u = 10, minHeight: c = 10, maxWidth: d = Number.MAX_VALUE, maxHeight: m = Number.MAX_VALUE, keepAspectRatio: p = !1, resizeDirection: x, autoScale: b = !0, shouldResize: S, onResizeStart: k, onResize: A, onResizeEnd: T }) {
  const M = dz(), j = typeof e == "string" ? e : M, D = ur(), z = F.useRef(null), I = n === Im.Handle, L = rn(F.useCallback(_le(I && b), [I, b]), lr), K = F.useRef(null), ne = t ?? Sle[n];
  F.useEffect(() => {
    if (!(!z.current || !j))
      return K.current || (K.current = rse({
        domNode: z.current,
        nodeId: j,
        getStoreItems: () => {
          const { nodeLookup: H, transform: Z, snapGrid: me, snapToGrid: Q, nodeOrigin: se, domNode: J } = D.getState();
          return {
            nodeLookup: H,
            transform: Z,
            snapGrid: me,
            snapToGrid: Q,
            nodeOrigin: se,
            paneDomNode: J
          };
        },
        onChange: (H, Z) => {
          const { triggerNodeChanges: me, nodeLookup: Q, parentLookup: se, nodeOrigin: J } = D.getState(), ue = [], de = { x: H.x, y: H.y }, ce = Q.get(j);
          if (ce && ce.expandParent && ce.parentId) {
            const W = ce.origin ?? J, $ = H.width ?? ce.measured.width ?? 0, fe = H.height ?? ce.measured.height ?? 0, G = {
              id: ce.id,
              parentId: ce.parentId,
              rect: {
                width: $,
                height: fe,
                ...IP({
                  x: H.x ?? ce.position.x,
                  y: H.y ?? ce.position.y
                }, { width: $, height: fe }, ce.parentId, Q, W)
              }
            }, le = YE([G], Q, se, J);
            ue.push(...le), de.x = H.x ? Math.max(W[0] * $, H.x) : void 0, de.y = H.y ? Math.max(W[1] * fe, H.y) : void 0;
          }
          if (de.x !== void 0 && de.y !== void 0) {
            const W = {
              id: j,
              type: "position",
              position: { ...de }
            };
            ue.push(W);
          }
          if (H.width !== void 0 && H.height !== void 0) {
            const $ = {
              id: j,
              type: "dimensions",
              resizing: !0,
              setAttributes: x ? x === "horizontal" ? "width" : "height" : !0,
              dimensions: {
                width: H.width,
                height: H.height
              }
            };
            ue.push($);
          }
          for (const W of Z) {
            const $ = {
              ...W,
              type: "position"
            };
            ue.push($);
          }
          me(ue);
        },
        onEnd: ({ width: H, height: Z }) => {
          const me = {
            id: j,
            type: "dimensions",
            resizing: !1,
            dimensions: {
              width: H,
              height: Z
            }
          };
          D.getState().triggerNodeChanges([me]);
        }
      })), K.current.update({
        controlPosition: ne,
        boundaries: {
          minWidth: u,
          minHeight: c,
          maxWidth: d,
          maxHeight: m
        },
        keepAspectRatio: p,
        resizeDirection: x,
        onResizeStart: k,
        onResize: A,
        onResizeEnd: T,
        shouldResize: S
      }), () => {
        var H;
        (H = K.current) == null || H.destroy();
      };
  }, [
    ne,
    u,
    c,
    d,
    m,
    p,
    k,
    A,
    T,
    S
  ]);
  const Y = ne.split("-");
  return g.jsx("div", { className: Lr(["react-flow__resize-control", "nodrag", ...Y, n, r]), ref: z, style: {
    ...i,
    scale: L,
    ...o && { [I ? "backgroundColor" : "borderColor"]: o }
  }, children: s });
}
F.memo(Cle);
function QE(e) {
  throw new Error('Could not dynamically require "' + e + '". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.');
}
var B2, kN;
function Ele() {
  if (kN) return B2;
  kN = 1;
  function e() {
    this.__data__ = [], this.size = 0;
  }
  return B2 = e, B2;
}
var q2, TN;
function Vm() {
  if (TN) return q2;
  TN = 1;
  function e(t, n) {
    return t === n || t !== t && n !== n;
  }
  return q2 = e, q2;
}
var F2, NN;
function Cx() {
  if (NN) return F2;
  NN = 1;
  var e = Vm();
  function t(n, r) {
    for (var i = n.length; i--; )
      if (e(n[i][0], r))
        return i;
    return -1;
  }
  return F2 = t, F2;
}
var U2, AN;
function kle() {
  if (AN) return U2;
  AN = 1;
  var e = Cx(), t = Array.prototype, n = t.splice;
  function r(i) {
    var s = this.__data__, o = e(s, i);
    if (o < 0)
      return !1;
    var u = s.length - 1;
    return o == u ? s.pop() : n.call(s, o, 1), --this.size, !0;
  }
  return U2 = r, U2;
}
var $2, jN;
function Tle() {
  if (jN) return $2;
  jN = 1;
  var e = Cx();
  function t(n) {
    var r = this.__data__, i = e(r, n);
    return i < 0 ? void 0 : r[i][1];
  }
  return $2 = t, $2;
}
var V2, MN;
function Nle() {
  if (MN) return V2;
  MN = 1;
  var e = Cx();
  function t(n) {
    return e(this.__data__, n) > -1;
  }
  return V2 = t, V2;
}
var H2, RN;
function Ale() {
  if (RN) return H2;
  RN = 1;
  var e = Cx();
  function t(n, r) {
    var i = this.__data__, s = e(i, n);
    return s < 0 ? (++this.size, i.push([n, r])) : i[s][1] = r, this;
  }
  return H2 = t, H2;
}
var G2, ON;
function Ex() {
  if (ON) return G2;
  ON = 1;
  var e = Ele(), t = kle(), n = Tle(), r = Nle(), i = Ale();
  function s(o) {
    var u = -1, c = o == null ? 0 : o.length;
    for (this.clear(); ++u < c; ) {
      var d = o[u];
      this.set(d[0], d[1]);
    }
  }
  return s.prototype.clear = e, s.prototype.delete = t, s.prototype.get = n, s.prototype.has = r, s.prototype.set = i, G2 = s, G2;
}
var K2, DN;
function jle() {
  if (DN) return K2;
  DN = 1;
  var e = Ex();
  function t() {
    this.__data__ = new e(), this.size = 0;
  }
  return K2 = t, K2;
}
var Y2, IN;
function Mle() {
  if (IN) return Y2;
  IN = 1;
  function e(t) {
    var n = this.__data__, r = n.delete(t);
    return this.size = n.size, r;
  }
  return Y2 = e, Y2;
}
var W2, PN;
function Rle() {
  if (PN) return W2;
  PN = 1;
  function e(t) {
    return this.__data__.get(t);
  }
  return W2 = e, W2;
}
var X2, zN;
function Ole() {
  if (zN) return X2;
  zN = 1;
  function e(t) {
    return this.__data__.has(t);
  }
  return X2 = e, X2;
}
var Q2, LN;
function Iz() {
  if (LN) return Q2;
  LN = 1;
  var e = typeof vu == "object" && vu && vu.Object === Object && vu;
  return Q2 = e, Q2;
}
var Z2, BN;
function Do() {
  if (BN) return Z2;
  BN = 1;
  var e = Iz(), t = typeof self == "object" && self && self.Object === Object && self, n = e || t || Function("return this")();
  return Z2 = n, Z2;
}
var J2, qN;
function Hm() {
  if (qN) return J2;
  qN = 1;
  var e = Do(), t = e.Symbol;
  return J2 = t, J2;
}
var ew, FN;
function Dle() {
  if (FN) return ew;
  FN = 1;
  var e = Hm(), t = Object.prototype, n = t.hasOwnProperty, r = t.toString, i = e ? e.toStringTag : void 0;
  function s(o) {
    var u = n.call(o, i), c = o[i];
    try {
      o[i] = void 0;
      var d = !0;
    } catch {
    }
    var m = r.call(o);
    return d && (u ? o[i] = c : delete o[i]), m;
  }
  return ew = s, ew;
}
var tw, UN;
function Ile() {
  if (UN) return tw;
  UN = 1;
  var e = Object.prototype, t = e.toString;
  function n(r) {
    return t.call(r);
  }
  return tw = n, tw;
}
var nw, $N;
function qd() {
  if ($N) return nw;
  $N = 1;
  var e = Hm(), t = Dle(), n = Ile(), r = "[object Null]", i = "[object Undefined]", s = e ? e.toStringTag : void 0;
  function o(u) {
    return u == null ? u === void 0 ? i : r : s && s in Object(u) ? t(u) : n(u);
  }
  return nw = o, nw;
}
var rw, VN;
function qs() {
  if (VN) return rw;
  VN = 1;
  function e(t) {
    var n = typeof t;
    return t != null && (n == "object" || n == "function");
  }
  return rw = e, rw;
}
var iw, HN;
function H0() {
  if (HN) return iw;
  HN = 1;
  var e = qd(), t = qs(), n = "[object AsyncFunction]", r = "[object Function]", i = "[object GeneratorFunction]", s = "[object Proxy]";
  function o(u) {
    if (!t(u))
      return !1;
    var c = e(u);
    return c == r || c == i || c == n || c == s;
  }
  return iw = o, iw;
}
var aw, GN;
function Ple() {
  if (GN) return aw;
  GN = 1;
  var e = Do(), t = e["__core-js_shared__"];
  return aw = t, aw;
}
var sw, KN;
function zle() {
  if (KN) return sw;
  KN = 1;
  var e = Ple(), t = (function() {
    var r = /[^.]+$/.exec(e && e.keys && e.keys.IE_PROTO || "");
    return r ? "Symbol(src)_1." + r : "";
  })();
  function n(r) {
    return !!t && t in r;
  }
  return sw = n, sw;
}
var ow, YN;
function Pz() {
  if (YN) return ow;
  YN = 1;
  var e = Function.prototype, t = e.toString;
  function n(r) {
    if (r != null) {
      try {
        return t.call(r);
      } catch {
      }
      try {
        return r + "";
      } catch {
      }
    }
    return "";
  }
  return ow = n, ow;
}
var lw, WN;
function Lle() {
  if (WN) return lw;
  WN = 1;
  var e = H0(), t = zle(), n = qs(), r = Pz(), i = /[\\^$.*+?()[\]{}|]/g, s = /^\[object .+?Constructor\]$/, o = Function.prototype, u = Object.prototype, c = o.toString, d = u.hasOwnProperty, m = RegExp(
    "^" + c.call(d).replace(i, "\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g, "$1.*?") + "$"
  );
  function p(x) {
    if (!n(x) || t(x))
      return !1;
    var b = e(x) ? m : s;
    return b.test(r(x));
  }
  return lw = p, lw;
}
var uw, XN;
function Ble() {
  if (XN) return uw;
  XN = 1;
  function e(t, n) {
    return t == null ? void 0 : t[n];
  }
  return uw = e, uw;
}
var cw, QN;
function Fd() {
  if (QN) return cw;
  QN = 1;
  var e = Lle(), t = Ble();
  function n(r, i) {
    var s = t(r, i);
    return e(s) ? s : void 0;
  }
  return cw = n, cw;
}
var fw, ZN;
function ZE() {
  if (ZN) return fw;
  ZN = 1;
  var e = Fd(), t = Do(), n = e(t, "Map");
  return fw = n, fw;
}
var dw, JN;
function kx() {
  if (JN) return dw;
  JN = 1;
  var e = Fd(), t = e(Object, "create");
  return dw = t, dw;
}
var hw, eA;
function qle() {
  if (eA) return hw;
  eA = 1;
  var e = kx();
  function t() {
    this.__data__ = e ? e(null) : {}, this.size = 0;
  }
  return hw = t, hw;
}
var mw, tA;
function Fle() {
  if (tA) return mw;
  tA = 1;
  function e(t) {
    var n = this.has(t) && delete this.__data__[t];
    return this.size -= n ? 1 : 0, n;
  }
  return mw = e, mw;
}
var pw, nA;
function Ule() {
  if (nA) return pw;
  nA = 1;
  var e = kx(), t = "__lodash_hash_undefined__", n = Object.prototype, r = n.hasOwnProperty;
  function i(s) {
    var o = this.__data__;
    if (e) {
      var u = o[s];
      return u === t ? void 0 : u;
    }
    return r.call(o, s) ? o[s] : void 0;
  }
  return pw = i, pw;
}
var gw, rA;
function $le() {
  if (rA) return gw;
  rA = 1;
  var e = kx(), t = Object.prototype, n = t.hasOwnProperty;
  function r(i) {
    var s = this.__data__;
    return e ? s[i] !== void 0 : n.call(s, i);
  }
  return gw = r, gw;
}
var yw, iA;
function Vle() {
  if (iA) return yw;
  iA = 1;
  var e = kx(), t = "__lodash_hash_undefined__";
  function n(r, i) {
    var s = this.__data__;
    return this.size += this.has(r) ? 0 : 1, s[r] = e && i === void 0 ? t : i, this;
  }
  return yw = n, yw;
}
var vw, aA;
function Hle() {
  if (aA) return vw;
  aA = 1;
  var e = qle(), t = Fle(), n = Ule(), r = $le(), i = Vle();
  function s(o) {
    var u = -1, c = o == null ? 0 : o.length;
    for (this.clear(); ++u < c; ) {
      var d = o[u];
      this.set(d[0], d[1]);
    }
  }
  return s.prototype.clear = e, s.prototype.delete = t, s.prototype.get = n, s.prototype.has = r, s.prototype.set = i, vw = s, vw;
}
var xw, sA;
function Gle() {
  if (sA) return xw;
  sA = 1;
  var e = Hle(), t = Ex(), n = ZE();
  function r() {
    this.size = 0, this.__data__ = {
      hash: new e(),
      map: new (n || t)(),
      string: new e()
    };
  }
  return xw = r, xw;
}
var bw, oA;
function Kle() {
  if (oA) return bw;
  oA = 1;
  function e(t) {
    var n = typeof t;
    return n == "string" || n == "number" || n == "symbol" || n == "boolean" ? t !== "__proto__" : t === null;
  }
  return bw = e, bw;
}
var ww, lA;
function Tx() {
  if (lA) return ww;
  lA = 1;
  var e = Kle();
  function t(n, r) {
    var i = n.__data__;
    return e(r) ? i[typeof r == "string" ? "string" : "hash"] : i.map;
  }
  return ww = t, ww;
}
var _w, uA;
function Yle() {
  if (uA) return _w;
  uA = 1;
  var e = Tx();
  function t(n) {
    var r = e(this, n).delete(n);
    return this.size -= r ? 1 : 0, r;
  }
  return _w = t, _w;
}
var Sw, cA;
function Wle() {
  if (cA) return Sw;
  cA = 1;
  var e = Tx();
  function t(n) {
    return e(this, n).get(n);
  }
  return Sw = t, Sw;
}
var Cw, fA;
function Xle() {
  if (fA) return Cw;
  fA = 1;
  var e = Tx();
  function t(n) {
    return e(this, n).has(n);
  }
  return Cw = t, Cw;
}
var Ew, dA;
function Qle() {
  if (dA) return Ew;
  dA = 1;
  var e = Tx();
  function t(n, r) {
    var i = e(this, n), s = i.size;
    return i.set(n, r), this.size += i.size == s ? 0 : 1, this;
  }
  return Ew = t, Ew;
}
var kw, hA;
function JE() {
  if (hA) return kw;
  hA = 1;
  var e = Gle(), t = Yle(), n = Wle(), r = Xle(), i = Qle();
  function s(o) {
    var u = -1, c = o == null ? 0 : o.length;
    for (this.clear(); ++u < c; ) {
      var d = o[u];
      this.set(d[0], d[1]);
    }
  }
  return s.prototype.clear = e, s.prototype.delete = t, s.prototype.get = n, s.prototype.has = r, s.prototype.set = i, kw = s, kw;
}
var Tw, mA;
function Zle() {
  if (mA) return Tw;
  mA = 1;
  var e = Ex(), t = ZE(), n = JE(), r = 200;
  function i(s, o) {
    var u = this.__data__;
    if (u instanceof e) {
      var c = u.__data__;
      if (!t || c.length < r - 1)
        return c.push([s, o]), this.size = ++u.size, this;
      u = this.__data__ = new n(c);
    }
    return u.set(s, o), this.size = u.size, this;
  }
  return Tw = i, Tw;
}
var Nw, pA;
function Nx() {
  if (pA) return Nw;
  pA = 1;
  var e = Ex(), t = jle(), n = Mle(), r = Rle(), i = Ole(), s = Zle();
  function o(u) {
    var c = this.__data__ = new e(u);
    this.size = c.size;
  }
  return o.prototype.clear = t, o.prototype.delete = n, o.prototype.get = r, o.prototype.has = i, o.prototype.set = s, Nw = o, Nw;
}
var Aw, gA;
function ek() {
  if (gA) return Aw;
  gA = 1;
  function e(t, n) {
    for (var r = -1, i = t == null ? 0 : t.length; ++r < i && n(t[r], r, t) !== !1; )
      ;
    return t;
  }
  return Aw = e, Aw;
}
var jw, yA;
function zz() {
  if (yA) return jw;
  yA = 1;
  var e = Fd(), t = (function() {
    try {
      var n = e(Object, "defineProperty");
      return n({}, "", {}), n;
    } catch {
    }
  })();
  return jw = t, jw;
}
var Mw, vA;
function Ax() {
  if (vA) return Mw;
  vA = 1;
  var e = zz();
  function t(n, r, i) {
    r == "__proto__" && e ? e(n, r, {
      configurable: !0,
      enumerable: !0,
      value: i,
      writable: !0
    }) : n[r] = i;
  }
  return Mw = t, Mw;
}
var Rw, xA;
function jx() {
  if (xA) return Rw;
  xA = 1;
  var e = Ax(), t = Vm(), n = Object.prototype, r = n.hasOwnProperty;
  function i(s, o, u) {
    var c = s[o];
    (!(r.call(s, o) && t(c, u)) || u === void 0 && !(o in s)) && e(s, o, u);
  }
  return Rw = i, Rw;
}
var Ow, bA;
function G0() {
  if (bA) return Ow;
  bA = 1;
  var e = jx(), t = Ax();
  function n(r, i, s, o) {
    var u = !s;
    s || (s = {});
    for (var c = -1, d = i.length; ++c < d; ) {
      var m = i[c], p = o ? o(s[m], r[m], m, s, r) : void 0;
      p === void 0 && (p = r[m]), u ? t(s, m, p) : e(s, m, p);
    }
    return s;
  }
  return Ow = n, Ow;
}
var Dw, wA;
function Jle() {
  if (wA) return Dw;
  wA = 1;
  function e(t, n) {
    for (var r = -1, i = Array(t); ++r < t; )
      i[r] = n(r);
    return i;
  }
  return Dw = e, Dw;
}
var Iw, _A;
function Pl() {
  if (_A) return Iw;
  _A = 1;
  function e(t) {
    return t != null && typeof t == "object";
  }
  return Iw = e, Iw;
}
var Pw, SA;
function eue() {
  if (SA) return Pw;
  SA = 1;
  var e = qd(), t = Pl(), n = "[object Arguments]";
  function r(i) {
    return t(i) && e(i) == n;
  }
  return Pw = r, Pw;
}
var zw, CA;
function K0() {
  if (CA) return zw;
  CA = 1;
  var e = eue(), t = Pl(), n = Object.prototype, r = n.hasOwnProperty, i = n.propertyIsEnumerable, s = e(/* @__PURE__ */ (function() {
    return arguments;
  })()) ? e : function(o) {
    return t(o) && r.call(o, "callee") && !i.call(o, "callee");
  };
  return zw = s, zw;
}
var Lw, EA;
function Br() {
  if (EA) return Lw;
  EA = 1;
  var e = Array.isArray;
  return Lw = e, Lw;
}
var Vg = { exports: {} }, Bw, kA;
function tue() {
  if (kA) return Bw;
  kA = 1;
  function e() {
    return !1;
  }
  return Bw = e, Bw;
}
Vg.exports;
var TA;
function Gm() {
  return TA || (TA = 1, (function(e, t) {
    var n = Do(), r = tue(), i = t && !t.nodeType && t, s = i && !0 && e && !e.nodeType && e, o = s && s.exports === i, u = o ? n.Buffer : void 0, c = u ? u.isBuffer : void 0, d = c || r;
    e.exports = d;
  })(Vg, Vg.exports)), Vg.exports;
}
var qw, NA;
function Mx() {
  if (NA) return qw;
  NA = 1;
  var e = 9007199254740991, t = /^(?:0|[1-9]\d*)$/;
  function n(r, i) {
    var s = typeof r;
    return i = i ?? e, !!i && (s == "number" || s != "symbol" && t.test(r)) && r > -1 && r % 1 == 0 && r < i;
  }
  return qw = n, qw;
}
var Fw, AA;
function tk() {
  if (AA) return Fw;
  AA = 1;
  var e = 9007199254740991;
  function t(n) {
    return typeof n == "number" && n > -1 && n % 1 == 0 && n <= e;
  }
  return Fw = t, Fw;
}
var Uw, jA;
function nue() {
  if (jA) return Uw;
  jA = 1;
  var e = qd(), t = tk(), n = Pl(), r = "[object Arguments]", i = "[object Array]", s = "[object Boolean]", o = "[object Date]", u = "[object Error]", c = "[object Function]", d = "[object Map]", m = "[object Number]", p = "[object Object]", x = "[object RegExp]", b = "[object Set]", S = "[object String]", k = "[object WeakMap]", A = "[object ArrayBuffer]", T = "[object DataView]", M = "[object Float32Array]", j = "[object Float64Array]", D = "[object Int8Array]", z = "[object Int16Array]", I = "[object Int32Array]", L = "[object Uint8Array]", K = "[object Uint8ClampedArray]", ne = "[object Uint16Array]", Y = "[object Uint32Array]", H = {};
  H[M] = H[j] = H[D] = H[z] = H[I] = H[L] = H[K] = H[ne] = H[Y] = !0, H[r] = H[i] = H[A] = H[s] = H[T] = H[o] = H[u] = H[c] = H[d] = H[m] = H[p] = H[x] = H[b] = H[S] = H[k] = !1;
  function Z(me) {
    return n(me) && t(me.length) && !!H[e(me)];
  }
  return Uw = Z, Uw;
}
var $w, MA;
function Rx() {
  if (MA) return $w;
  MA = 1;
  function e(t) {
    return function(n) {
      return t(n);
    };
  }
  return $w = e, $w;
}
var Hg = { exports: {} };
Hg.exports;
var RA;
function nk() {
  return RA || (RA = 1, (function(e, t) {
    var n = Iz(), r = t && !t.nodeType && t, i = r && !0 && e && !e.nodeType && e, s = i && i.exports === r, o = s && n.process, u = (function() {
      try {
        var c = i && i.require && i.require("util").types;
        return c || o && o.binding && o.binding("util");
      } catch {
      }
    })();
    e.exports = u;
  })(Hg, Hg.exports)), Hg.exports;
}
var Vw, OA;
function Y0() {
  if (OA) return Vw;
  OA = 1;
  var e = nue(), t = Rx(), n = nk(), r = n && n.isTypedArray, i = r ? t(r) : e;
  return Vw = i, Vw;
}
var Hw, DA;
function Lz() {
  if (DA) return Hw;
  DA = 1;
  var e = Jle(), t = K0(), n = Br(), r = Gm(), i = Mx(), s = Y0(), o = Object.prototype, u = o.hasOwnProperty;
  function c(d, m) {
    var p = n(d), x = !p && t(d), b = !p && !x && r(d), S = !p && !x && !b && s(d), k = p || x || b || S, A = k ? e(d.length, String) : [], T = A.length;
    for (var M in d)
      (m || u.call(d, M)) && !(k && // Safari 9 has enumerable `arguments.length` in strict mode.
      (M == "length" || // Node.js 0.10 has enumerable non-index properties on buffers.
      b && (M == "offset" || M == "parent") || // PhantomJS 2 has enumerable non-index properties on typed arrays.
      S && (M == "buffer" || M == "byteLength" || M == "byteOffset") || // Skip index properties.
      i(M, T))) && A.push(M);
    return A;
  }
  return Hw = c, Hw;
}
var Gw, IA;
function Ox() {
  if (IA) return Gw;
  IA = 1;
  var e = Object.prototype;
  function t(n) {
    var r = n && n.constructor, i = typeof r == "function" && r.prototype || e;
    return n === i;
  }
  return Gw = t, Gw;
}
var Kw, PA;
function Bz() {
  if (PA) return Kw;
  PA = 1;
  function e(t, n) {
    return function(r) {
      return t(n(r));
    };
  }
  return Kw = e, Kw;
}
var Yw, zA;
function rue() {
  if (zA) return Yw;
  zA = 1;
  var e = Bz(), t = e(Object.keys, Object);
  return Yw = t, Yw;
}
var Ww, LA;
function rk() {
  if (LA) return Ww;
  LA = 1;
  var e = Ox(), t = rue(), n = Object.prototype, r = n.hasOwnProperty;
  function i(s) {
    if (!e(s))
      return t(s);
    var o = [];
    for (var u in Object(s))
      r.call(s, u) && u != "constructor" && o.push(u);
    return o;
  }
  return Ww = i, Ww;
}
var Xw, BA;
function Nu() {
  if (BA) return Xw;
  BA = 1;
  var e = H0(), t = tk();
  function n(r) {
    return r != null && t(r.length) && !e(r);
  }
  return Xw = n, Xw;
}
var Qw, qA;
function Hc() {
  if (qA) return Qw;
  qA = 1;
  var e = Lz(), t = rk(), n = Nu();
  function r(i) {
    return n(i) ? e(i) : t(i);
  }
  return Qw = r, Qw;
}
var Zw, FA;
function iue() {
  if (FA) return Zw;
  FA = 1;
  var e = G0(), t = Hc();
  function n(r, i) {
    return r && e(i, t(i), r);
  }
  return Zw = n, Zw;
}
var Jw, UA;
function aue() {
  if (UA) return Jw;
  UA = 1;
  function e(t) {
    var n = [];
    if (t != null)
      for (var r in Object(t))
        n.push(r);
    return n;
  }
  return Jw = e, Jw;
}
var e_, $A;
function sue() {
  if ($A) return e_;
  $A = 1;
  var e = qs(), t = Ox(), n = aue(), r = Object.prototype, i = r.hasOwnProperty;
  function s(o) {
    if (!e(o))
      return n(o);
    var u = t(o), c = [];
    for (var d in o)
      d == "constructor" && (u || !i.call(o, d)) || c.push(d);
    return c;
  }
  return e_ = s, e_;
}
var t_, VA;
function Ud() {
  if (VA) return t_;
  VA = 1;
  var e = Lz(), t = sue(), n = Nu();
  function r(i) {
    return n(i) ? e(i, !0) : t(i);
  }
  return t_ = r, t_;
}
var n_, HA;
function oue() {
  if (HA) return n_;
  HA = 1;
  var e = G0(), t = Ud();
  function n(r, i) {
    return r && e(i, t(i), r);
  }
  return n_ = n, n_;
}
var Gg = { exports: {} };
Gg.exports;
var GA;
function qz() {
  return GA || (GA = 1, (function(e, t) {
    var n = Do(), r = t && !t.nodeType && t, i = r && !0 && e && !e.nodeType && e, s = i && i.exports === r, o = s ? n.Buffer : void 0, u = o ? o.allocUnsafe : void 0;
    function c(d, m) {
      if (m)
        return d.slice();
      var p = d.length, x = u ? u(p) : new d.constructor(p);
      return d.copy(x), x;
    }
    e.exports = c;
  })(Gg, Gg.exports)), Gg.exports;
}
var r_, KA;
function Fz() {
  if (KA) return r_;
  KA = 1;
  function e(t, n) {
    var r = -1, i = t.length;
    for (n || (n = Array(i)); ++r < i; )
      n[r] = t[r];
    return n;
  }
  return r_ = e, r_;
}
var i_, YA;
function Uz() {
  if (YA) return i_;
  YA = 1;
  function e(t, n) {
    for (var r = -1, i = t == null ? 0 : t.length, s = 0, o = []; ++r < i; ) {
      var u = t[r];
      n(u, r, t) && (o[s++] = u);
    }
    return o;
  }
  return i_ = e, i_;
}
var a_, WA;
function $z() {
  if (WA) return a_;
  WA = 1;
  function e() {
    return [];
  }
  return a_ = e, a_;
}
var s_, XA;
function ik() {
  if (XA) return s_;
  XA = 1;
  var e = Uz(), t = $z(), n = Object.prototype, r = n.propertyIsEnumerable, i = Object.getOwnPropertySymbols, s = i ? function(o) {
    return o == null ? [] : (o = Object(o), e(i(o), function(u) {
      return r.call(o, u);
    }));
  } : t;
  return s_ = s, s_;
}
var o_, QA;
function lue() {
  if (QA) return o_;
  QA = 1;
  var e = G0(), t = ik();
  function n(r, i) {
    return e(r, t(r), i);
  }
  return o_ = n, o_;
}
var l_, ZA;
function ak() {
  if (ZA) return l_;
  ZA = 1;
  function e(t, n) {
    for (var r = -1, i = n.length, s = t.length; ++r < i; )
      t[s + r] = n[r];
    return t;
  }
  return l_ = e, l_;
}
var u_, JA;
function Dx() {
  if (JA) return u_;
  JA = 1;
  var e = Bz(), t = e(Object.getPrototypeOf, Object);
  return u_ = t, u_;
}
var c_, ej;
function Vz() {
  if (ej) return c_;
  ej = 1;
  var e = ak(), t = Dx(), n = ik(), r = $z(), i = Object.getOwnPropertySymbols, s = i ? function(o) {
    for (var u = []; o; )
      e(u, n(o)), o = t(o);
    return u;
  } : r;
  return c_ = s, c_;
}
var f_, tj;
function uue() {
  if (tj) return f_;
  tj = 1;
  var e = G0(), t = Vz();
  function n(r, i) {
    return e(r, t(r), i);
  }
  return f_ = n, f_;
}
var d_, nj;
function Hz() {
  if (nj) return d_;
  nj = 1;
  var e = ak(), t = Br();
  function n(r, i, s) {
    var o = i(r);
    return t(r) ? o : e(o, s(r));
  }
  return d_ = n, d_;
}
var h_, rj;
function Gz() {
  if (rj) return h_;
  rj = 1;
  var e = Hz(), t = ik(), n = Hc();
  function r(i) {
    return e(i, n, t);
  }
  return h_ = r, h_;
}
var m_, ij;
function cue() {
  if (ij) return m_;
  ij = 1;
  var e = Hz(), t = Vz(), n = Ud();
  function r(i) {
    return e(i, n, t);
  }
  return m_ = r, m_;
}
var p_, aj;
function fue() {
  if (aj) return p_;
  aj = 1;
  var e = Fd(), t = Do(), n = e(t, "DataView");
  return p_ = n, p_;
}
var g_, sj;
function due() {
  if (sj) return g_;
  sj = 1;
  var e = Fd(), t = Do(), n = e(t, "Promise");
  return g_ = n, g_;
}
var y_, oj;
function Kz() {
  if (oj) return y_;
  oj = 1;
  var e = Fd(), t = Do(), n = e(t, "Set");
  return y_ = n, y_;
}
var v_, lj;
function hue() {
  if (lj) return v_;
  lj = 1;
  var e = Fd(), t = Do(), n = e(t, "WeakMap");
  return v_ = n, v_;
}
var x_, uj;
function Km() {
  if (uj) return x_;
  uj = 1;
  var e = fue(), t = ZE(), n = due(), r = Kz(), i = hue(), s = qd(), o = Pz(), u = "[object Map]", c = "[object Object]", d = "[object Promise]", m = "[object Set]", p = "[object WeakMap]", x = "[object DataView]", b = o(e), S = o(t), k = o(n), A = o(r), T = o(i), M = s;
  return (e && M(new e(new ArrayBuffer(1))) != x || t && M(new t()) != u || n && M(n.resolve()) != d || r && M(new r()) != m || i && M(new i()) != p) && (M = function(j) {
    var D = s(j), z = D == c ? j.constructor : void 0, I = z ? o(z) : "";
    if (I)
      switch (I) {
        case b:
          return x;
        case S:
          return u;
        case k:
          return d;
        case A:
          return m;
        case T:
          return p;
      }
    return D;
  }), x_ = M, x_;
}
var b_, cj;
function mue() {
  if (cj) return b_;
  cj = 1;
  var e = Object.prototype, t = e.hasOwnProperty;
  function n(r) {
    var i = r.length, s = new r.constructor(i);
    return i && typeof r[0] == "string" && t.call(r, "index") && (s.index = r.index, s.input = r.input), s;
  }
  return b_ = n, b_;
}
var w_, fj;
function Yz() {
  if (fj) return w_;
  fj = 1;
  var e = Do(), t = e.Uint8Array;
  return w_ = t, w_;
}
var __, dj;
function sk() {
  if (dj) return __;
  dj = 1;
  var e = Yz();
  function t(n) {
    var r = new n.constructor(n.byteLength);
    return new e(r).set(new e(n)), r;
  }
  return __ = t, __;
}
var S_, hj;
function pue() {
  if (hj) return S_;
  hj = 1;
  var e = sk();
  function t(n, r) {
    var i = r ? e(n.buffer) : n.buffer;
    return new n.constructor(i, n.byteOffset, n.byteLength);
  }
  return S_ = t, S_;
}
var C_, mj;
function gue() {
  if (mj) return C_;
  mj = 1;
  var e = /\w*$/;
  function t(n) {
    var r = new n.constructor(n.source, e.exec(n));
    return r.lastIndex = n.lastIndex, r;
  }
  return C_ = t, C_;
}
var E_, pj;
function yue() {
  if (pj) return E_;
  pj = 1;
  var e = Hm(), t = e ? e.prototype : void 0, n = t ? t.valueOf : void 0;
  function r(i) {
    return n ? Object(n.call(i)) : {};
  }
  return E_ = r, E_;
}
var k_, gj;
function Wz() {
  if (gj) return k_;
  gj = 1;
  var e = sk();
  function t(n, r) {
    var i = r ? e(n.buffer) : n.buffer;
    return new n.constructor(i, n.byteOffset, n.length);
  }
  return k_ = t, k_;
}
var T_, yj;
function vue() {
  if (yj) return T_;
  yj = 1;
  var e = sk(), t = pue(), n = gue(), r = yue(), i = Wz(), s = "[object Boolean]", o = "[object Date]", u = "[object Map]", c = "[object Number]", d = "[object RegExp]", m = "[object Set]", p = "[object String]", x = "[object Symbol]", b = "[object ArrayBuffer]", S = "[object DataView]", k = "[object Float32Array]", A = "[object Float64Array]", T = "[object Int8Array]", M = "[object Int16Array]", j = "[object Int32Array]", D = "[object Uint8Array]", z = "[object Uint8ClampedArray]", I = "[object Uint16Array]", L = "[object Uint32Array]";
  function K(ne, Y, H) {
    var Z = ne.constructor;
    switch (Y) {
      case b:
        return e(ne);
      case s:
      case o:
        return new Z(+ne);
      case S:
        return t(ne, H);
      case k:
      case A:
      case T:
      case M:
      case j:
      case D:
      case z:
      case I:
      case L:
        return i(ne, H);
      case u:
        return new Z();
      case c:
      case p:
        return new Z(ne);
      case d:
        return n(ne);
      case m:
        return new Z();
      case x:
        return r(ne);
    }
  }
  return T_ = K, T_;
}
var N_, vj;
function Xz() {
  if (vj) return N_;
  vj = 1;
  var e = qs(), t = Object.create, n = /* @__PURE__ */ (function() {
    function r() {
    }
    return function(i) {
      if (!e(i))
        return {};
      if (t)
        return t(i);
      r.prototype = i;
      var s = new r();
      return r.prototype = void 0, s;
    };
  })();
  return N_ = n, N_;
}
var A_, xj;
function Qz() {
  if (xj) return A_;
  xj = 1;
  var e = Xz(), t = Dx(), n = Ox();
  function r(i) {
    return typeof i.constructor == "function" && !n(i) ? e(t(i)) : {};
  }
  return A_ = r, A_;
}
var j_, bj;
function xue() {
  if (bj) return j_;
  bj = 1;
  var e = Km(), t = Pl(), n = "[object Map]";
  function r(i) {
    return t(i) && e(i) == n;
  }
  return j_ = r, j_;
}
var M_, wj;
function bue() {
  if (wj) return M_;
  wj = 1;
  var e = xue(), t = Rx(), n = nk(), r = n && n.isMap, i = r ? t(r) : e;
  return M_ = i, M_;
}
var R_, _j;
function wue() {
  if (_j) return R_;
  _j = 1;
  var e = Km(), t = Pl(), n = "[object Set]";
  function r(i) {
    return t(i) && e(i) == n;
  }
  return R_ = r, R_;
}
var O_, Sj;
function _ue() {
  if (Sj) return O_;
  Sj = 1;
  var e = wue(), t = Rx(), n = nk(), r = n && n.isSet, i = r ? t(r) : e;
  return O_ = i, O_;
}
var D_, Cj;
function Zz() {
  if (Cj) return D_;
  Cj = 1;
  var e = Nx(), t = ek(), n = jx(), r = iue(), i = oue(), s = qz(), o = Fz(), u = lue(), c = uue(), d = Gz(), m = cue(), p = Km(), x = mue(), b = vue(), S = Qz(), k = Br(), A = Gm(), T = bue(), M = qs(), j = _ue(), D = Hc(), z = Ud(), I = 1, L = 2, K = 4, ne = "[object Arguments]", Y = "[object Array]", H = "[object Boolean]", Z = "[object Date]", me = "[object Error]", Q = "[object Function]", se = "[object GeneratorFunction]", J = "[object Map]", ue = "[object Number]", de = "[object Object]", ce = "[object RegExp]", W = "[object Set]", $ = "[object String]", fe = "[object Symbol]", G = "[object WeakMap]", le = "[object ArrayBuffer]", xe = "[object DataView]", Se = "[object Float32Array]", Oe = "[object Float64Array]", Be = "[object Int8Array]", Re = "[object Int16Array]", ft = "[object Int32Array]", Ie = "[object Uint8Array]", Ne = "[object Uint8ClampedArray]", Ue = "[object Uint16Array]", et = "[object Uint32Array]", tt = {};
  tt[ne] = tt[Y] = tt[le] = tt[xe] = tt[H] = tt[Z] = tt[Se] = tt[Oe] = tt[Be] = tt[Re] = tt[ft] = tt[J] = tt[ue] = tt[de] = tt[ce] = tt[W] = tt[$] = tt[fe] = tt[Ie] = tt[Ne] = tt[Ue] = tt[et] = !0, tt[me] = tt[Q] = tt[G] = !1;
  function st(dt, Wn, Rn, Un, Ht, On) {
    var an, En = Wn & I, Xn = Wn & L, Fe = Wn & K;
    if (Rn && (an = Ht ? Rn(dt, Un, Ht, On) : Rn(dt)), an !== void 0)
      return an;
    if (!M(dt))
      return dt;
    var Qe = k(dt);
    if (Qe) {
      if (an = x(dt), !En)
        return o(dt, an);
    } else {
      var yt = p(dt), Tt = yt == Q || yt == se;
      if (A(dt))
        return s(dt, En);
      if (yt == de || yt == ne || Tt && !Ht) {
        if (an = Xn || Tt ? {} : S(dt), !En)
          return Xn ? c(dt, i(an, dt)) : u(dt, r(an, dt));
      } else {
        if (!tt[yt])
          return Ht ? dt : {};
        an = b(dt, yt, En);
      }
    }
    On || (On = new e());
    var Pt = On.get(dt);
    if (Pt)
      return Pt;
    On.set(dt, an), j(dt) ? dt.forEach(function(sn) {
      an.add(st(sn, Wn, Rn, sn, dt, On));
    }) : T(dt) && dt.forEach(function(sn, Qt) {
      an.set(Qt, st(sn, Wn, Rn, Qt, dt, On));
    });
    var $n = Fe ? Xn ? m : d : Xn ? z : D, Vn = Qe ? void 0 : $n(dt);
    return t(Vn || dt, function(sn, Qt) {
      Vn && (Qt = sn, sn = dt[Qt]), n(an, Qt, st(sn, Wn, Rn, Qt, dt, On));
    }), an;
  }
  return D_ = st, D_;
}
var I_, Ej;
function Sue() {
  if (Ej) return I_;
  Ej = 1;
  var e = Zz(), t = 4;
  function n(r) {
    return e(r, t);
  }
  return I_ = n, I_;
}
var P_, kj;
function ok() {
  if (kj) return P_;
  kj = 1;
  function e(t) {
    return function() {
      return t;
    };
  }
  return P_ = e, P_;
}
var z_, Tj;
function Cue() {
  if (Tj) return z_;
  Tj = 1;
  function e(t) {
    return function(n, r, i) {
      for (var s = -1, o = Object(n), u = i(n), c = u.length; c--; ) {
        var d = u[t ? c : ++s];
        if (r(o[d], d, o) === !1)
          break;
      }
      return n;
    };
  }
  return z_ = e, z_;
}
var L_, Nj;
function lk() {
  if (Nj) return L_;
  Nj = 1;
  var e = Cue(), t = e();
  return L_ = t, L_;
}
var B_, Aj;
function uk() {
  if (Aj) return B_;
  Aj = 1;
  var e = lk(), t = Hc();
  function n(r, i) {
    return r && e(r, i, t);
  }
  return B_ = n, B_;
}
var q_, jj;
function Eue() {
  if (jj) return q_;
  jj = 1;
  var e = Nu();
  function t(n, r) {
    return function(i, s) {
      if (i == null)
        return i;
      if (!e(i))
        return n(i, s);
      for (var o = i.length, u = r ? o : -1, c = Object(i); (r ? u-- : ++u < o) && s(c[u], u, c) !== !1; )
        ;
      return i;
    };
  }
  return q_ = t, q_;
}
var F_, Mj;
function Ix() {
  if (Mj) return F_;
  Mj = 1;
  var e = uk(), t = Eue(), n = t(e);
  return F_ = n, F_;
}
var U_, Rj;
function $d() {
  if (Rj) return U_;
  Rj = 1;
  function e(t) {
    return t;
  }
  return U_ = e, U_;
}
var $_, Oj;
function Jz() {
  if (Oj) return $_;
  Oj = 1;
  var e = $d();
  function t(n) {
    return typeof n == "function" ? n : e;
  }
  return $_ = t, $_;
}
var V_, Dj;
function eL() {
  if (Dj) return V_;
  Dj = 1;
  var e = ek(), t = Ix(), n = Jz(), r = Br();
  function i(s, o) {
    var u = r(s) ? e : t;
    return u(s, n(o));
  }
  return V_ = i, V_;
}
var H_, Ij;
function tL() {
  return Ij || (Ij = 1, H_ = eL()), H_;
}
var G_, Pj;
function kue() {
  if (Pj) return G_;
  Pj = 1;
  var e = Ix();
  function t(n, r) {
    var i = [];
    return e(n, function(s, o, u) {
      r(s, o, u) && i.push(s);
    }), i;
  }
  return G_ = t, G_;
}
var K_, zj;
function Tue() {
  if (zj) return K_;
  zj = 1;
  var e = "__lodash_hash_undefined__";
  function t(n) {
    return this.__data__.set(n, e), this;
  }
  return K_ = t, K_;
}
var Y_, Lj;
function Nue() {
  if (Lj) return Y_;
  Lj = 1;
  function e(t) {
    return this.__data__.has(t);
  }
  return Y_ = e, Y_;
}
var W_, Bj;
function nL() {
  if (Bj) return W_;
  Bj = 1;
  var e = JE(), t = Tue(), n = Nue();
  function r(i) {
    var s = -1, o = i == null ? 0 : i.length;
    for (this.__data__ = new e(); ++s < o; )
      this.add(i[s]);
  }
  return r.prototype.add = r.prototype.push = t, r.prototype.has = n, W_ = r, W_;
}
var X_, qj;
function Aue() {
  if (qj) return X_;
  qj = 1;
  function e(t, n) {
    for (var r = -1, i = t == null ? 0 : t.length; ++r < i; )
      if (n(t[r], r, t))
        return !0;
    return !1;
  }
  return X_ = e, X_;
}
var Q_, Fj;
function rL() {
  if (Fj) return Q_;
  Fj = 1;
  function e(t, n) {
    return t.has(n);
  }
  return Q_ = e, Q_;
}
var Z_, Uj;
function iL() {
  if (Uj) return Z_;
  Uj = 1;
  var e = nL(), t = Aue(), n = rL(), r = 1, i = 2;
  function s(o, u, c, d, m, p) {
    var x = c & r, b = o.length, S = u.length;
    if (b != S && !(x && S > b))
      return !1;
    var k = p.get(o), A = p.get(u);
    if (k && A)
      return k == u && A == o;
    var T = -1, M = !0, j = c & i ? new e() : void 0;
    for (p.set(o, u), p.set(u, o); ++T < b; ) {
      var D = o[T], z = u[T];
      if (d)
        var I = x ? d(z, D, T, u, o, p) : d(D, z, T, o, u, p);
      if (I !== void 0) {
        if (I)
          continue;
        M = !1;
        break;
      }
      if (j) {
        if (!t(u, function(L, K) {
          if (!n(j, K) && (D === L || m(D, L, c, d, p)))
            return j.push(K);
        })) {
          M = !1;
          break;
        }
      } else if (!(D === z || m(D, z, c, d, p))) {
        M = !1;
        break;
      }
    }
    return p.delete(o), p.delete(u), M;
  }
  return Z_ = s, Z_;
}
var J_, $j;
function jue() {
  if ($j) return J_;
  $j = 1;
  function e(t) {
    var n = -1, r = Array(t.size);
    return t.forEach(function(i, s) {
      r[++n] = [s, i];
    }), r;
  }
  return J_ = e, J_;
}
var e4, Vj;
function ck() {
  if (Vj) return e4;
  Vj = 1;
  function e(t) {
    var n = -1, r = Array(t.size);
    return t.forEach(function(i) {
      r[++n] = i;
    }), r;
  }
  return e4 = e, e4;
}
var t4, Hj;
function Mue() {
  if (Hj) return t4;
  Hj = 1;
  var e = Hm(), t = Yz(), n = Vm(), r = iL(), i = jue(), s = ck(), o = 1, u = 2, c = "[object Boolean]", d = "[object Date]", m = "[object Error]", p = "[object Map]", x = "[object Number]", b = "[object RegExp]", S = "[object Set]", k = "[object String]", A = "[object Symbol]", T = "[object ArrayBuffer]", M = "[object DataView]", j = e ? e.prototype : void 0, D = j ? j.valueOf : void 0;
  function z(I, L, K, ne, Y, H, Z) {
    switch (K) {
      case M:
        if (I.byteLength != L.byteLength || I.byteOffset != L.byteOffset)
          return !1;
        I = I.buffer, L = L.buffer;
      case T:
        return !(I.byteLength != L.byteLength || !H(new t(I), new t(L)));
      case c:
      case d:
      case x:
        return n(+I, +L);
      case m:
        return I.name == L.name && I.message == L.message;
      case b:
      case k:
        return I == L + "";
      case p:
        var me = i;
      case S:
        var Q = ne & o;
        if (me || (me = s), I.size != L.size && !Q)
          return !1;
        var se = Z.get(I);
        if (se)
          return se == L;
        ne |= u, Z.set(I, L);
        var J = r(me(I), me(L), ne, Y, H, Z);
        return Z.delete(I), J;
      case A:
        if (D)
          return D.call(I) == D.call(L);
    }
    return !1;
  }
  return t4 = z, t4;
}
var n4, Gj;
function Rue() {
  if (Gj) return n4;
  Gj = 1;
  var e = Gz(), t = 1, n = Object.prototype, r = n.hasOwnProperty;
  function i(s, o, u, c, d, m) {
    var p = u & t, x = e(s), b = x.length, S = e(o), k = S.length;
    if (b != k && !p)
      return !1;
    for (var A = b; A--; ) {
      var T = x[A];
      if (!(p ? T in o : r.call(o, T)))
        return !1;
    }
    var M = m.get(s), j = m.get(o);
    if (M && j)
      return M == o && j == s;
    var D = !0;
    m.set(s, o), m.set(o, s);
    for (var z = p; ++A < b; ) {
      T = x[A];
      var I = s[T], L = o[T];
      if (c)
        var K = p ? c(L, I, T, o, s, m) : c(I, L, T, s, o, m);
      if (!(K === void 0 ? I === L || d(I, L, u, c, m) : K)) {
        D = !1;
        break;
      }
      z || (z = T == "constructor");
    }
    if (D && !z) {
      var ne = s.constructor, Y = o.constructor;
      ne != Y && "constructor" in s && "constructor" in o && !(typeof ne == "function" && ne instanceof ne && typeof Y == "function" && Y instanceof Y) && (D = !1);
    }
    return m.delete(s), m.delete(o), D;
  }
  return n4 = i, n4;
}
var r4, Kj;
function Oue() {
  if (Kj) return r4;
  Kj = 1;
  var e = Nx(), t = iL(), n = Mue(), r = Rue(), i = Km(), s = Br(), o = Gm(), u = Y0(), c = 1, d = "[object Arguments]", m = "[object Array]", p = "[object Object]", x = Object.prototype, b = x.hasOwnProperty;
  function S(k, A, T, M, j, D) {
    var z = s(k), I = s(A), L = z ? m : i(k), K = I ? m : i(A);
    L = L == d ? p : L, K = K == d ? p : K;
    var ne = L == p, Y = K == p, H = L == K;
    if (H && o(k)) {
      if (!o(A))
        return !1;
      z = !0, ne = !1;
    }
    if (H && !ne)
      return D || (D = new e()), z || u(k) ? t(k, A, T, M, j, D) : n(k, A, L, T, M, j, D);
    if (!(T & c)) {
      var Z = ne && b.call(k, "__wrapped__"), me = Y && b.call(A, "__wrapped__");
      if (Z || me) {
        var Q = Z ? k.value() : k, se = me ? A.value() : A;
        return D || (D = new e()), j(Q, se, T, M, D);
      }
    }
    return H ? (D || (D = new e()), r(k, A, T, M, j, D)) : !1;
  }
  return r4 = S, r4;
}
var i4, Yj;
function aL() {
  if (Yj) return i4;
  Yj = 1;
  var e = Oue(), t = Pl();
  function n(r, i, s, o, u) {
    return r === i ? !0 : r == null || i == null || !t(r) && !t(i) ? r !== r && i !== i : e(r, i, s, o, n, u);
  }
  return i4 = n, i4;
}
var a4, Wj;
function Due() {
  if (Wj) return a4;
  Wj = 1;
  var e = Nx(), t = aL(), n = 1, r = 2;
  function i(s, o, u, c) {
    var d = u.length, m = d, p = !c;
    if (s == null)
      return !m;
    for (s = Object(s); d--; ) {
      var x = u[d];
      if (p && x[2] ? x[1] !== s[x[0]] : !(x[0] in s))
        return !1;
    }
    for (; ++d < m; ) {
      x = u[d];
      var b = x[0], S = s[b], k = x[1];
      if (p && x[2]) {
        if (S === void 0 && !(b in s))
          return !1;
      } else {
        var A = new e();
        if (c)
          var T = c(S, k, b, s, o, A);
        if (!(T === void 0 ? t(k, S, n | r, c, A) : T))
          return !1;
      }
    }
    return !0;
  }
  return a4 = i, a4;
}
var s4, Xj;
function sL() {
  if (Xj) return s4;
  Xj = 1;
  var e = qs();
  function t(n) {
    return n === n && !e(n);
  }
  return s4 = t, s4;
}
var o4, Qj;
function Iue() {
  if (Qj) return o4;
  Qj = 1;
  var e = sL(), t = Hc();
  function n(r) {
    for (var i = t(r), s = i.length; s--; ) {
      var o = i[s], u = r[o];
      i[s] = [o, u, e(u)];
    }
    return i;
  }
  return o4 = n, o4;
}
var l4, Zj;
function oL() {
  if (Zj) return l4;
  Zj = 1;
  function e(t, n) {
    return function(r) {
      return r == null ? !1 : r[t] === n && (n !== void 0 || t in Object(r));
    };
  }
  return l4 = e, l4;
}
var u4, Jj;
function Pue() {
  if (Jj) return u4;
  Jj = 1;
  var e = Due(), t = Iue(), n = oL();
  function r(i) {
    var s = t(i);
    return s.length == 1 && s[0][2] ? n(s[0][0], s[0][1]) : function(o) {
      return o === i || e(o, i, s);
    };
  }
  return u4 = r, u4;
}
var c4, e9;
function Ym() {
  if (e9) return c4;
  e9 = 1;
  var e = qd(), t = Pl(), n = "[object Symbol]";
  function r(i) {
    return typeof i == "symbol" || t(i) && e(i) == n;
  }
  return c4 = r, c4;
}
var f4, t9;
function fk() {
  if (t9) return f4;
  t9 = 1;
  var e = Br(), t = Ym(), n = /\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/, r = /^\w*$/;
  function i(s, o) {
    if (e(s))
      return !1;
    var u = typeof s;
    return u == "number" || u == "symbol" || u == "boolean" || s == null || t(s) ? !0 : r.test(s) || !n.test(s) || o != null && s in Object(o);
  }
  return f4 = i, f4;
}
var d4, n9;
function zue() {
  if (n9) return d4;
  n9 = 1;
  var e = JE(), t = "Expected a function";
  function n(r, i) {
    if (typeof r != "function" || i != null && typeof i != "function")
      throw new TypeError(t);
    var s = function() {
      var o = arguments, u = i ? i.apply(this, o) : o[0], c = s.cache;
      if (c.has(u))
        return c.get(u);
      var d = r.apply(this, o);
      return s.cache = c.set(u, d) || c, d;
    };
    return s.cache = new (n.Cache || e)(), s;
  }
  return n.Cache = e, d4 = n, d4;
}
var h4, r9;
function Lue() {
  if (r9) return h4;
  r9 = 1;
  var e = zue(), t = 500;
  function n(r) {
    var i = e(r, function(o) {
      return s.size === t && s.clear(), o;
    }), s = i.cache;
    return i;
  }
  return h4 = n, h4;
}
var m4, i9;
function Bue() {
  if (i9) return m4;
  i9 = 1;
  var e = Lue(), t = /[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g, n = /\\(\\)?/g, r = e(function(i) {
    var s = [];
    return i.charCodeAt(0) === 46 && s.push(""), i.replace(t, function(o, u, c, d) {
      s.push(c ? d.replace(n, "$1") : u || o);
    }), s;
  });
  return m4 = r, m4;
}
var p4, a9;
function Px() {
  if (a9) return p4;
  a9 = 1;
  function e(t, n) {
    for (var r = -1, i = t == null ? 0 : t.length, s = Array(i); ++r < i; )
      s[r] = n(t[r], r, t);
    return s;
  }
  return p4 = e, p4;
}
var g4, s9;
function que() {
  if (s9) return g4;
  s9 = 1;
  var e = Hm(), t = Px(), n = Br(), r = Ym(), i = e ? e.prototype : void 0, s = i ? i.toString : void 0;
  function o(u) {
    if (typeof u == "string")
      return u;
    if (n(u))
      return t(u, o) + "";
    if (r(u))
      return s ? s.call(u) : "";
    var c = u + "";
    return c == "0" && 1 / u == -1 / 0 ? "-0" : c;
  }
  return g4 = o, g4;
}
var y4, o9;
function lL() {
  if (o9) return y4;
  o9 = 1;
  var e = que();
  function t(n) {
    return n == null ? "" : e(n);
  }
  return y4 = t, y4;
}
var v4, l9;
function zx() {
  if (l9) return v4;
  l9 = 1;
  var e = Br(), t = fk(), n = Bue(), r = lL();
  function i(s, o) {
    return e(s) ? s : t(s, o) ? [s] : n(r(s));
  }
  return v4 = i, v4;
}
var x4, u9;
function W0() {
  if (u9) return x4;
  u9 = 1;
  var e = Ym();
  function t(n) {
    if (typeof n == "string" || e(n))
      return n;
    var r = n + "";
    return r == "0" && 1 / n == -1 / 0 ? "-0" : r;
  }
  return x4 = t, x4;
}
var b4, c9;
function Lx() {
  if (c9) return b4;
  c9 = 1;
  var e = zx(), t = W0();
  function n(r, i) {
    i = e(i, r);
    for (var s = 0, o = i.length; r != null && s < o; )
      r = r[t(i[s++])];
    return s && s == o ? r : void 0;
  }
  return b4 = n, b4;
}
var w4, f9;
function Fue() {
  if (f9) return w4;
  f9 = 1;
  var e = Lx();
  function t(n, r, i) {
    var s = n == null ? void 0 : e(n, r);
    return s === void 0 ? i : s;
  }
  return w4 = t, w4;
}
var _4, d9;
function Uue() {
  if (d9) return _4;
  d9 = 1;
  function e(t, n) {
    return t != null && n in Object(t);
  }
  return _4 = e, _4;
}
var S4, h9;
function uL() {
  if (h9) return S4;
  h9 = 1;
  var e = zx(), t = K0(), n = Br(), r = Mx(), i = tk(), s = W0();
  function o(u, c, d) {
    c = e(c, u);
    for (var m = -1, p = c.length, x = !1; ++m < p; ) {
      var b = s(c[m]);
      if (!(x = u != null && d(u, b)))
        break;
      u = u[b];
    }
    return x || ++m != p ? x : (p = u == null ? 0 : u.length, !!p && i(p) && r(b, p) && (n(u) || t(u)));
  }
  return S4 = o, S4;
}
var C4, m9;
function cL() {
  if (m9) return C4;
  m9 = 1;
  var e = Uue(), t = uL();
  function n(r, i) {
    return r != null && t(r, i, e);
  }
  return C4 = n, C4;
}
var E4, p9;
function $ue() {
  if (p9) return E4;
  p9 = 1;
  var e = aL(), t = Fue(), n = cL(), r = fk(), i = sL(), s = oL(), o = W0(), u = 1, c = 2;
  function d(m, p) {
    return r(m) && i(p) ? s(o(m), p) : function(x) {
      var b = t(x, m);
      return b === void 0 && b === p ? n(x, m) : e(p, b, u | c);
    };
  }
  return E4 = d, E4;
}
var k4, g9;
function fL() {
  if (g9) return k4;
  g9 = 1;
  function e(t) {
    return function(n) {
      return n == null ? void 0 : n[t];
    };
  }
  return k4 = e, k4;
}
var T4, y9;
function Vue() {
  if (y9) return T4;
  y9 = 1;
  var e = Lx();
  function t(n) {
    return function(r) {
      return e(r, n);
    };
  }
  return T4 = t, T4;
}
var N4, v9;
function Hue() {
  if (v9) return N4;
  v9 = 1;
  var e = fL(), t = Vue(), n = fk(), r = W0();
  function i(s) {
    return n(s) ? e(r(s)) : t(s);
  }
  return N4 = i, N4;
}
var A4, x9;
function Au() {
  if (x9) return A4;
  x9 = 1;
  var e = Pue(), t = $ue(), n = $d(), r = Br(), i = Hue();
  function s(o) {
    return typeof o == "function" ? o : o == null ? n : typeof o == "object" ? r(o) ? t(o[0], o[1]) : e(o) : i(o);
  }
  return A4 = s, A4;
}
var j4, b9;
function dL() {
  if (b9) return j4;
  b9 = 1;
  var e = Uz(), t = kue(), n = Au(), r = Br();
  function i(s, o) {
    var u = r(s) ? e : t;
    return u(s, n(o, 3));
  }
  return j4 = i, j4;
}
var M4, w9;
function Gue() {
  if (w9) return M4;
  w9 = 1;
  var e = Object.prototype, t = e.hasOwnProperty;
  function n(r, i) {
    return r != null && t.call(r, i);
  }
  return M4 = n, M4;
}
var R4, _9;
function hL() {
  if (_9) return R4;
  _9 = 1;
  var e = Gue(), t = uL();
  function n(r, i) {
    return r != null && t(r, i, e);
  }
  return R4 = n, R4;
}
var O4, S9;
function Kue() {
  if (S9) return O4;
  S9 = 1;
  var e = rk(), t = Km(), n = K0(), r = Br(), i = Nu(), s = Gm(), o = Ox(), u = Y0(), c = "[object Map]", d = "[object Set]", m = Object.prototype, p = m.hasOwnProperty;
  function x(b) {
    if (b == null)
      return !0;
    if (i(b) && (r(b) || typeof b == "string" || typeof b.splice == "function" || s(b) || u(b) || n(b)))
      return !b.length;
    var S = t(b);
    if (S == c || S == d)
      return !b.size;
    if (o(b))
      return !e(b).length;
    for (var k in b)
      if (p.call(b, k))
        return !1;
    return !0;
  }
  return O4 = x, O4;
}
var D4, C9;
function mL() {
  if (C9) return D4;
  C9 = 1;
  function e(t) {
    return t === void 0;
  }
  return D4 = e, D4;
}
var I4, E9;
function pL() {
  if (E9) return I4;
  E9 = 1;
  var e = Ix(), t = Nu();
  function n(r, i) {
    var s = -1, o = t(r) ? Array(r.length) : [];
    return e(r, function(u, c, d) {
      o[++s] = i(u, c, d);
    }), o;
  }
  return I4 = n, I4;
}
var P4, k9;
function gL() {
  if (k9) return P4;
  k9 = 1;
  var e = Px(), t = Au(), n = pL(), r = Br();
  function i(s, o) {
    var u = r(s) ? e : n;
    return u(s, t(o, 3));
  }
  return P4 = i, P4;
}
var z4, T9;
function Yue() {
  if (T9) return z4;
  T9 = 1;
  function e(t, n, r, i) {
    var s = -1, o = t == null ? 0 : t.length;
    for (i && o && (r = t[++s]); ++s < o; )
      r = n(r, t[s], s, t);
    return r;
  }
  return z4 = e, z4;
}
var L4, N9;
function Wue() {
  if (N9) return L4;
  N9 = 1;
  function e(t, n, r, i, s) {
    return s(t, function(o, u, c) {
      r = i ? (i = !1, o) : n(r, o, u, c);
    }), r;
  }
  return L4 = e, L4;
}
var B4, A9;
function yL() {
  if (A9) return B4;
  A9 = 1;
  var e = Yue(), t = Ix(), n = Au(), r = Wue(), i = Br();
  function s(o, u, c) {
    var d = i(o) ? e : r, m = arguments.length < 3;
    return d(o, n(u, 4), c, m, t);
  }
  return B4 = s, B4;
}
var q4, j9;
function Xue() {
  if (j9) return q4;
  j9 = 1;
  var e = qd(), t = Br(), n = Pl(), r = "[object String]";
  function i(s) {
    return typeof s == "string" || !t(s) && n(s) && e(s) == r;
  }
  return q4 = i, q4;
}
var F4, M9;
function Que() {
  if (M9) return F4;
  M9 = 1;
  var e = fL(), t = e("length");
  return F4 = t, F4;
}
var U4, R9;
function Zue() {
  if (R9) return U4;
  R9 = 1;
  var e = "\\ud800-\\udfff", t = "\\u0300-\\u036f", n = "\\ufe20-\\ufe2f", r = "\\u20d0-\\u20ff", i = t + n + r, s = "\\ufe0e\\ufe0f", o = "\\u200d", u = RegExp("[" + o + e + i + s + "]");
  function c(d) {
    return u.test(d);
  }
  return U4 = c, U4;
}
var $4, O9;
function Jue() {
  if (O9) return $4;
  O9 = 1;
  var e = "\\ud800-\\udfff", t = "\\u0300-\\u036f", n = "\\ufe20-\\ufe2f", r = "\\u20d0-\\u20ff", i = t + n + r, s = "\\ufe0e\\ufe0f", o = "[" + e + "]", u = "[" + i + "]", c = "\\ud83c[\\udffb-\\udfff]", d = "(?:" + u + "|" + c + ")", m = "[^" + e + "]", p = "(?:\\ud83c[\\udde6-\\uddff]){2}", x = "[\\ud800-\\udbff][\\udc00-\\udfff]", b = "\\u200d", S = d + "?", k = "[" + s + "]?", A = "(?:" + b + "(?:" + [m, p, x].join("|") + ")" + k + S + ")*", T = k + S + A, M = "(?:" + [m + u + "?", u, p, x, o].join("|") + ")", j = RegExp(c + "(?=" + c + ")|" + M + T, "g");
  function D(z) {
    for (var I = j.lastIndex = 0; j.test(z); )
      ++I;
    return I;
  }
  return $4 = D, $4;
}
var V4, D9;
function ece() {
  if (D9) return V4;
  D9 = 1;
  var e = Que(), t = Zue(), n = Jue();
  function r(i) {
    return t(i) ? n(i) : e(i);
  }
  return V4 = r, V4;
}
var H4, I9;
function tce() {
  if (I9) return H4;
  I9 = 1;
  var e = rk(), t = Km(), n = Nu(), r = Xue(), i = ece(), s = "[object Map]", o = "[object Set]";
  function u(c) {
    if (c == null)
      return 0;
    if (n(c))
      return r(c) ? i(c) : c.length;
    var d = t(c);
    return d == s || d == o ? c.size : e(c).length;
  }
  return H4 = u, H4;
}
var G4, P9;
function nce() {
  if (P9) return G4;
  P9 = 1;
  var e = ek(), t = Xz(), n = uk(), r = Au(), i = Dx(), s = Br(), o = Gm(), u = H0(), c = qs(), d = Y0();
  function m(p, x, b) {
    var S = s(p), k = S || o(p) || d(p);
    if (x = r(x, 4), b == null) {
      var A = p && p.constructor;
      k ? b = S ? new A() : [] : c(p) ? b = u(A) ? t(i(p)) : {} : b = {};
    }
    return (k ? e : n)(p, function(T, M, j) {
      return x(b, T, M, j);
    }), b;
  }
  return G4 = m, G4;
}
var K4, z9;
function rce() {
  if (z9) return K4;
  z9 = 1;
  var e = Hm(), t = K0(), n = Br(), r = e ? e.isConcatSpreadable : void 0;
  function i(s) {
    return n(s) || t(s) || !!(r && s && s[r]);
  }
  return K4 = i, K4;
}
var Y4, L9;
function dk() {
  if (L9) return Y4;
  L9 = 1;
  var e = ak(), t = rce();
  function n(r, i, s, o, u) {
    var c = -1, d = r.length;
    for (s || (s = t), u || (u = []); ++c < d; ) {
      var m = r[c];
      i > 0 && s(m) ? i > 1 ? n(m, i - 1, s, o, u) : e(u, m) : o || (u[u.length] = m);
    }
    return u;
  }
  return Y4 = n, Y4;
}
var W4, B9;
function ice() {
  if (B9) return W4;
  B9 = 1;
  function e(t, n, r) {
    switch (r.length) {
      case 0:
        return t.call(n);
      case 1:
        return t.call(n, r[0]);
      case 2:
        return t.call(n, r[0], r[1]);
      case 3:
        return t.call(n, r[0], r[1], r[2]);
    }
    return t.apply(n, r);
  }
  return W4 = e, W4;
}
var X4, q9;
function vL() {
  if (q9) return X4;
  q9 = 1;
  var e = ice(), t = Math.max;
  function n(r, i, s) {
    return i = t(i === void 0 ? r.length - 1 : i, 0), function() {
      for (var o = arguments, u = -1, c = t(o.length - i, 0), d = Array(c); ++u < c; )
        d[u] = o[i + u];
      u = -1;
      for (var m = Array(i + 1); ++u < i; )
        m[u] = o[u];
      return m[i] = s(d), e(r, this, m);
    };
  }
  return X4 = n, X4;
}
var Q4, F9;
function ace() {
  if (F9) return Q4;
  F9 = 1;
  var e = ok(), t = zz(), n = $d(), r = t ? function(i, s) {
    return t(i, "toString", {
      configurable: !0,
      enumerable: !1,
      value: e(s),
      writable: !0
    });
  } : n;
  return Q4 = r, Q4;
}
var Z4, U9;
function sce() {
  if (U9) return Z4;
  U9 = 1;
  var e = 800, t = 16, n = Date.now;
  function r(i) {
    var s = 0, o = 0;
    return function() {
      var u = n(), c = t - (u - o);
      if (o = u, c > 0) {
        if (++s >= e)
          return arguments[0];
      } else
        s = 0;
      return i.apply(void 0, arguments);
    };
  }
  return Z4 = r, Z4;
}
var J4, $9;
function xL() {
  if ($9) return J4;
  $9 = 1;
  var e = ace(), t = sce(), n = t(e);
  return J4 = n, J4;
}
var eS, V9;
function Bx() {
  if (V9) return eS;
  V9 = 1;
  var e = $d(), t = vL(), n = xL();
  function r(i, s) {
    return n(t(i, s, e), i + "");
  }
  return eS = r, eS;
}
var tS, H9;
function bL() {
  if (H9) return tS;
  H9 = 1;
  function e(t, n, r, i) {
    for (var s = t.length, o = r + (i ? 1 : -1); i ? o-- : ++o < s; )
      if (n(t[o], o, t))
        return o;
    return -1;
  }
  return tS = e, tS;
}
var nS, G9;
function oce() {
  if (G9) return nS;
  G9 = 1;
  function e(t) {
    return t !== t;
  }
  return nS = e, nS;
}
var rS, K9;
function lce() {
  if (K9) return rS;
  K9 = 1;
  function e(t, n, r) {
    for (var i = r - 1, s = t.length; ++i < s; )
      if (t[i] === n)
        return i;
    return -1;
  }
  return rS = e, rS;
}
var iS, Y9;
function uce() {
  if (Y9) return iS;
  Y9 = 1;
  var e = bL(), t = oce(), n = lce();
  function r(i, s, o) {
    return s === s ? n(i, s, o) : e(i, t, o);
  }
  return iS = r, iS;
}
var aS, W9;
function cce() {
  if (W9) return aS;
  W9 = 1;
  var e = uce();
  function t(n, r) {
    var i = n == null ? 0 : n.length;
    return !!i && e(n, r, 0) > -1;
  }
  return aS = t, aS;
}
var sS, X9;
function fce() {
  if (X9) return sS;
  X9 = 1;
  function e(t, n, r) {
    for (var i = -1, s = t == null ? 0 : t.length; ++i < s; )
      if (r(n, t[i]))
        return !0;
    return !1;
  }
  return sS = e, sS;
}
var oS, Q9;
function dce() {
  if (Q9) return oS;
  Q9 = 1;
  function e() {
  }
  return oS = e, oS;
}
var lS, Z9;
function hce() {
  if (Z9) return lS;
  Z9 = 1;
  var e = Kz(), t = dce(), n = ck(), r = 1 / 0, i = e && 1 / n(new e([, -0]))[1] == r ? function(s) {
    return new e(s);
  } : t;
  return lS = i, lS;
}
var uS, J9;
function mce() {
  if (J9) return uS;
  J9 = 1;
  var e = nL(), t = cce(), n = fce(), r = rL(), i = hce(), s = ck(), o = 200;
  function u(c, d, m) {
    var p = -1, x = t, b = c.length, S = !0, k = [], A = k;
    if (m)
      S = !1, x = n;
    else if (b >= o) {
      var T = d ? null : i(c);
      if (T)
        return s(T);
      S = !1, x = r, A = new e();
    } else
      A = d ? [] : k;
    e:
      for (; ++p < b; ) {
        var M = c[p], j = d ? d(M) : M;
        if (M = m || M !== 0 ? M : 0, S && j === j) {
          for (var D = A.length; D--; )
            if (A[D] === j)
              continue e;
          d && A.push(j), k.push(M);
        } else x(A, j, m) || (A !== k && A.push(j), k.push(M));
      }
    return k;
  }
  return uS = u, uS;
}
var cS, e7;
function wL() {
  if (e7) return cS;
  e7 = 1;
  var e = Nu(), t = Pl();
  function n(r) {
    return t(r) && e(r);
  }
  return cS = n, cS;
}
var fS, t7;
function pce() {
  if (t7) return fS;
  t7 = 1;
  var e = dk(), t = Bx(), n = mce(), r = wL(), i = t(function(s) {
    return n(e(s, 1, r, !0));
  });
  return fS = i, fS;
}
var dS, n7;
function gce() {
  if (n7) return dS;
  n7 = 1;
  var e = Px();
  function t(n, r) {
    return e(r, function(i) {
      return n[i];
    });
  }
  return dS = t, dS;
}
var hS, r7;
function _L() {
  if (r7) return hS;
  r7 = 1;
  var e = gce(), t = Hc();
  function n(r) {
    return r == null ? [] : e(r, t(r));
  }
  return hS = n, hS;
}
var mS, i7;
function Fs() {
  if (i7) return mS;
  i7 = 1;
  var e;
  if (typeof QE == "function")
    try {
      e = {
        clone: Sue(),
        constant: ok(),
        each: tL(),
        filter: dL(),
        has: hL(),
        isArray: Br(),
        isEmpty: Kue(),
        isFunction: H0(),
        isUndefined: mL(),
        keys: Hc(),
        map: gL(),
        reduce: yL(),
        size: tce(),
        transform: nce(),
        union: pce(),
        values: _L()
      };
    } catch {
    }
  return e || (e = window._), mS = e, mS;
}
var pS, a7;
function hk() {
  if (a7) return pS;
  a7 = 1;
  var e = Fs();
  pS = i;
  var t = "\0", n = "\0", r = "";
  function i(m) {
    this._isDirected = e.has(m, "directed") ? m.directed : !0, this._isMultigraph = e.has(m, "multigraph") ? m.multigraph : !1, this._isCompound = e.has(m, "compound") ? m.compound : !1, this._label = void 0, this._defaultNodeLabelFn = e.constant(void 0), this._defaultEdgeLabelFn = e.constant(void 0), this._nodes = {}, this._isCompound && (this._parent = {}, this._children = {}, this._children[n] = {}), this._in = {}, this._preds = {}, this._out = {}, this._sucs = {}, this._edgeObjs = {}, this._edgeLabels = {};
  }
  i.prototype._nodeCount = 0, i.prototype._edgeCount = 0, i.prototype.isDirected = function() {
    return this._isDirected;
  }, i.prototype.isMultigraph = function() {
    return this._isMultigraph;
  }, i.prototype.isCompound = function() {
    return this._isCompound;
  }, i.prototype.setGraph = function(m) {
    return this._label = m, this;
  }, i.prototype.graph = function() {
    return this._label;
  }, i.prototype.setDefaultNodeLabel = function(m) {
    return e.isFunction(m) || (m = e.constant(m)), this._defaultNodeLabelFn = m, this;
  }, i.prototype.nodeCount = function() {
    return this._nodeCount;
  }, i.prototype.nodes = function() {
    return e.keys(this._nodes);
  }, i.prototype.sources = function() {
    var m = this;
    return e.filter(this.nodes(), function(p) {
      return e.isEmpty(m._in[p]);
    });
  }, i.prototype.sinks = function() {
    var m = this;
    return e.filter(this.nodes(), function(p) {
      return e.isEmpty(m._out[p]);
    });
  }, i.prototype.setNodes = function(m, p) {
    var x = arguments, b = this;
    return e.each(m, function(S) {
      x.length > 1 ? b.setNode(S, p) : b.setNode(S);
    }), this;
  }, i.prototype.setNode = function(m, p) {
    return e.has(this._nodes, m) ? (arguments.length > 1 && (this._nodes[m] = p), this) : (this._nodes[m] = arguments.length > 1 ? p : this._defaultNodeLabelFn(m), this._isCompound && (this._parent[m] = n, this._children[m] = {}, this._children[n][m] = !0), this._in[m] = {}, this._preds[m] = {}, this._out[m] = {}, this._sucs[m] = {}, ++this._nodeCount, this);
  }, i.prototype.node = function(m) {
    return this._nodes[m];
  }, i.prototype.hasNode = function(m) {
    return e.has(this._nodes, m);
  }, i.prototype.removeNode = function(m) {
    var p = this;
    if (e.has(this._nodes, m)) {
      var x = function(b) {
        p.removeEdge(p._edgeObjs[b]);
      };
      delete this._nodes[m], this._isCompound && (this._removeFromParentsChildList(m), delete this._parent[m], e.each(this.children(m), function(b) {
        p.setParent(b);
      }), delete this._children[m]), e.each(e.keys(this._in[m]), x), delete this._in[m], delete this._preds[m], e.each(e.keys(this._out[m]), x), delete this._out[m], delete this._sucs[m], --this._nodeCount;
    }
    return this;
  }, i.prototype.setParent = function(m, p) {
    if (!this._isCompound)
      throw new Error("Cannot set parent in a non-compound graph");
    if (e.isUndefined(p))
      p = n;
    else {
      p += "";
      for (var x = p; !e.isUndefined(x); x = this.parent(x))
        if (x === m)
          throw new Error("Setting " + p + " as parent of " + m + " would create a cycle");
      this.setNode(p);
    }
    return this.setNode(m), this._removeFromParentsChildList(m), this._parent[m] = p, this._children[p][m] = !0, this;
  }, i.prototype._removeFromParentsChildList = function(m) {
    delete this._children[this._parent[m]][m];
  }, i.prototype.parent = function(m) {
    if (this._isCompound) {
      var p = this._parent[m];
      if (p !== n)
        return p;
    }
  }, i.prototype.children = function(m) {
    if (e.isUndefined(m) && (m = n), this._isCompound) {
      var p = this._children[m];
      if (p)
        return e.keys(p);
    } else {
      if (m === n)
        return this.nodes();
      if (this.hasNode(m))
        return [];
    }
  }, i.prototype.predecessors = function(m) {
    var p = this._preds[m];
    if (p)
      return e.keys(p);
  }, i.prototype.successors = function(m) {
    var p = this._sucs[m];
    if (p)
      return e.keys(p);
  }, i.prototype.neighbors = function(m) {
    var p = this.predecessors(m);
    if (p)
      return e.union(p, this.successors(m));
  }, i.prototype.isLeaf = function(m) {
    var p;
    return this.isDirected() ? p = this.successors(m) : p = this.neighbors(m), p.length === 0;
  }, i.prototype.filterNodes = function(m) {
    var p = new this.constructor({
      directed: this._isDirected,
      multigraph: this._isMultigraph,
      compound: this._isCompound
    });
    p.setGraph(this.graph());
    var x = this;
    e.each(this._nodes, function(k, A) {
      m(A) && p.setNode(A, k);
    }), e.each(this._edgeObjs, function(k) {
      p.hasNode(k.v) && p.hasNode(k.w) && p.setEdge(k, x.edge(k));
    });
    var b = {};
    function S(k) {
      var A = x.parent(k);
      return A === void 0 || p.hasNode(A) ? (b[k] = A, A) : A in b ? b[A] : S(A);
    }
    return this._isCompound && e.each(p.nodes(), function(k) {
      p.setParent(k, S(k));
    }), p;
  }, i.prototype.setDefaultEdgeLabel = function(m) {
    return e.isFunction(m) || (m = e.constant(m)), this._defaultEdgeLabelFn = m, this;
  }, i.prototype.edgeCount = function() {
    return this._edgeCount;
  }, i.prototype.edges = function() {
    return e.values(this._edgeObjs);
  }, i.prototype.setPath = function(m, p) {
    var x = this, b = arguments;
    return e.reduce(m, function(S, k) {
      return b.length > 1 ? x.setEdge(S, k, p) : x.setEdge(S, k), k;
    }), this;
  }, i.prototype.setEdge = function() {
    var m, p, x, b, S = !1, k = arguments[0];
    typeof k == "object" && k !== null && "v" in k ? (m = k.v, p = k.w, x = k.name, arguments.length === 2 && (b = arguments[1], S = !0)) : (m = k, p = arguments[1], x = arguments[3], arguments.length > 2 && (b = arguments[2], S = !0)), m = "" + m, p = "" + p, e.isUndefined(x) || (x = "" + x);
    var A = u(this._isDirected, m, p, x);
    if (e.has(this._edgeLabels, A))
      return S && (this._edgeLabels[A] = b), this;
    if (!e.isUndefined(x) && !this._isMultigraph)
      throw new Error("Cannot set a named edge when isMultigraph = false");
    this.setNode(m), this.setNode(p), this._edgeLabels[A] = S ? b : this._defaultEdgeLabelFn(m, p, x);
    var T = c(this._isDirected, m, p, x);
    return m = T.v, p = T.w, Object.freeze(T), this._edgeObjs[A] = T, s(this._preds[p], m), s(this._sucs[m], p), this._in[p][A] = T, this._out[m][A] = T, this._edgeCount++, this;
  }, i.prototype.edge = function(m, p, x) {
    var b = arguments.length === 1 ? d(this._isDirected, arguments[0]) : u(this._isDirected, m, p, x);
    return this._edgeLabels[b];
  }, i.prototype.hasEdge = function(m, p, x) {
    var b = arguments.length === 1 ? d(this._isDirected, arguments[0]) : u(this._isDirected, m, p, x);
    return e.has(this._edgeLabels, b);
  }, i.prototype.removeEdge = function(m, p, x) {
    var b = arguments.length === 1 ? d(this._isDirected, arguments[0]) : u(this._isDirected, m, p, x), S = this._edgeObjs[b];
    return S && (m = S.v, p = S.w, delete this._edgeLabels[b], delete this._edgeObjs[b], o(this._preds[p], m), o(this._sucs[m], p), delete this._in[p][b], delete this._out[m][b], this._edgeCount--), this;
  }, i.prototype.inEdges = function(m, p) {
    var x = this._in[m];
    if (x) {
      var b = e.values(x);
      return p ? e.filter(b, function(S) {
        return S.v === p;
      }) : b;
    }
  }, i.prototype.outEdges = function(m, p) {
    var x = this._out[m];
    if (x) {
      var b = e.values(x);
      return p ? e.filter(b, function(S) {
        return S.w === p;
      }) : b;
    }
  }, i.prototype.nodeEdges = function(m, p) {
    var x = this.inEdges(m, p);
    if (x)
      return x.concat(this.outEdges(m, p));
  };
  function s(m, p) {
    m[p] ? m[p]++ : m[p] = 1;
  }
  function o(m, p) {
    --m[p] || delete m[p];
  }
  function u(m, p, x, b) {
    var S = "" + p, k = "" + x;
    if (!m && S > k) {
      var A = S;
      S = k, k = A;
    }
    return S + r + k + r + (e.isUndefined(b) ? t : b);
  }
  function c(m, p, x, b) {
    var S = "" + p, k = "" + x;
    if (!m && S > k) {
      var A = S;
      S = k, k = A;
    }
    var T = { v: S, w: k };
    return b && (T.name = b), T;
  }
  function d(m, p) {
    return u(m, p.v, p.w, p.name);
  }
  return pS;
}
var gS, s7;
function yce() {
  return s7 || (s7 = 1, gS = "2.1.8"), gS;
}
var yS, o7;
function vce() {
  return o7 || (o7 = 1, yS = {
    Graph: hk(),
    version: yce()
  }), yS;
}
var vS, l7;
function xce() {
  if (l7) return vS;
  l7 = 1;
  var e = Fs(), t = hk();
  vS = {
    write: n,
    read: s
  };
  function n(o) {
    var u = {
      options: {
        directed: o.isDirected(),
        multigraph: o.isMultigraph(),
        compound: o.isCompound()
      },
      nodes: r(o),
      edges: i(o)
    };
    return e.isUndefined(o.graph()) || (u.value = e.clone(o.graph())), u;
  }
  function r(o) {
    return e.map(o.nodes(), function(u) {
      var c = o.node(u), d = o.parent(u), m = { v: u };
      return e.isUndefined(c) || (m.value = c), e.isUndefined(d) || (m.parent = d), m;
    });
  }
  function i(o) {
    return e.map(o.edges(), function(u) {
      var c = o.edge(u), d = { v: u.v, w: u.w };
      return e.isUndefined(u.name) || (d.name = u.name), e.isUndefined(c) || (d.value = c), d;
    });
  }
  function s(o) {
    var u = new t(o.options).setGraph(o.value);
    return e.each(o.nodes, function(c) {
      u.setNode(c.v, c.value), c.parent && u.setParent(c.v, c.parent);
    }), e.each(o.edges, function(c) {
      u.setEdge({ v: c.v, w: c.w, name: c.name }, c.value);
    }), u;
  }
  return vS;
}
var xS, u7;
function bce() {
  if (u7) return xS;
  u7 = 1;
  var e = Fs();
  xS = t;
  function t(n) {
    var r = {}, i = [], s;
    function o(u) {
      e.has(r, u) || (r[u] = !0, s.push(u), e.each(n.successors(u), o), e.each(n.predecessors(u), o));
    }
    return e.each(n.nodes(), function(u) {
      s = [], o(u), s.length && i.push(s);
    }), i;
  }
  return xS;
}
var bS, c7;
function SL() {
  if (c7) return bS;
  c7 = 1;
  var e = Fs();
  bS = t;
  function t() {
    this._arr = [], this._keyIndices = {};
  }
  return t.prototype.size = function() {
    return this._arr.length;
  }, t.prototype.keys = function() {
    return this._arr.map(function(n) {
      return n.key;
    });
  }, t.prototype.has = function(n) {
    return e.has(this._keyIndices, n);
  }, t.prototype.priority = function(n) {
    var r = this._keyIndices[n];
    if (r !== void 0)
      return this._arr[r].priority;
  }, t.prototype.min = function() {
    if (this.size() === 0)
      throw new Error("Queue underflow");
    return this._arr[0].key;
  }, t.prototype.add = function(n, r) {
    var i = this._keyIndices;
    if (n = String(n), !e.has(i, n)) {
      var s = this._arr, o = s.length;
      return i[n] = o, s.push({ key: n, priority: r }), this._decrease(o), !0;
    }
    return !1;
  }, t.prototype.removeMin = function() {
    this._swap(0, this._arr.length - 1);
    var n = this._arr.pop();
    return delete this._keyIndices[n.key], this._heapify(0), n.key;
  }, t.prototype.decrease = function(n, r) {
    var i = this._keyIndices[n];
    if (r > this._arr[i].priority)
      throw new Error("New priority is greater than current priority. Key: " + n + " Old: " + this._arr[i].priority + " New: " + r);
    this._arr[i].priority = r, this._decrease(i);
  }, t.prototype._heapify = function(n) {
    var r = this._arr, i = 2 * n, s = i + 1, o = n;
    i < r.length && (o = r[i].priority < r[o].priority ? i : o, s < r.length && (o = r[s].priority < r[o].priority ? s : o), o !== n && (this._swap(n, o), this._heapify(o)));
  }, t.prototype._decrease = function(n) {
    for (var r = this._arr, i = r[n].priority, s; n !== 0 && (s = n >> 1, !(r[s].priority < i)); )
      this._swap(n, s), n = s;
  }, t.prototype._swap = function(n, r) {
    var i = this._arr, s = this._keyIndices, o = i[n], u = i[r];
    i[n] = u, i[r] = o, s[u.key] = n, s[o.key] = r;
  }, bS;
}
var wS, f7;
function CL() {
  if (f7) return wS;
  f7 = 1;
  var e = Fs(), t = SL();
  wS = r;
  var n = e.constant(1);
  function r(s, o, u, c) {
    return i(
      s,
      String(o),
      u || n,
      c || function(d) {
        return s.outEdges(d);
      }
    );
  }
  function i(s, o, u, c) {
    var d = {}, m = new t(), p, x, b = function(S) {
      var k = S.v !== p ? S.v : S.w, A = d[k], T = u(S), M = x.distance + T;
      if (T < 0)
        throw new Error("dijkstra does not allow negative edge weights. Bad edge: " + S + " Weight: " + T);
      M < A.distance && (A.distance = M, A.predecessor = p, m.decrease(k, M));
    };
    for (s.nodes().forEach(function(S) {
      var k = S === o ? 0 : Number.POSITIVE_INFINITY;
      d[S] = { distance: k }, m.add(S, k);
    }); m.size() > 0 && (p = m.removeMin(), x = d[p], x.distance !== Number.POSITIVE_INFINITY); )
      c(p).forEach(b);
    return d;
  }
  return wS;
}
var _S, d7;
function wce() {
  if (d7) return _S;
  d7 = 1;
  var e = CL(), t = Fs();
  _S = n;
  function n(r, i, s) {
    return t.transform(r.nodes(), function(o, u) {
      o[u] = e(r, u, i, s);
    }, {});
  }
  return _S;
}
var SS, h7;
function EL() {
  if (h7) return SS;
  h7 = 1;
  var e = Fs();
  SS = t;
  function t(n) {
    var r = 0, i = [], s = {}, o = [];
    function u(c) {
      var d = s[c] = {
        onStack: !0,
        lowlink: r,
        index: r++
      };
      if (i.push(c), n.successors(c).forEach(function(x) {
        e.has(s, x) ? s[x].onStack && (d.lowlink = Math.min(d.lowlink, s[x].index)) : (u(x), d.lowlink = Math.min(d.lowlink, s[x].lowlink));
      }), d.lowlink === d.index) {
        var m = [], p;
        do
          p = i.pop(), s[p].onStack = !1, m.push(p);
        while (c !== p);
        o.push(m);
      }
    }
    return n.nodes().forEach(function(c) {
      e.has(s, c) || u(c);
    }), o;
  }
  return SS;
}
var CS, m7;
function _ce() {
  if (m7) return CS;
  m7 = 1;
  var e = Fs(), t = EL();
  CS = n;
  function n(r) {
    return e.filter(t(r), function(i) {
      return i.length > 1 || i.length === 1 && r.hasEdge(i[0], i[0]);
    });
  }
  return CS;
}
var ES, p7;
function Sce() {
  if (p7) return ES;
  p7 = 1;
  var e = Fs();
  ES = n;
  var t = e.constant(1);
  function n(i, s, o) {
    return r(
      i,
      s || t,
      o || function(u) {
        return i.outEdges(u);
      }
    );
  }
  function r(i, s, o) {
    var u = {}, c = i.nodes();
    return c.forEach(function(d) {
      u[d] = {}, u[d][d] = { distance: 0 }, c.forEach(function(m) {
        d !== m && (u[d][m] = { distance: Number.POSITIVE_INFINITY });
      }), o(d).forEach(function(m) {
        var p = m.v === d ? m.w : m.v, x = s(m);
        u[d][p] = { distance: x, predecessor: d };
      });
    }), c.forEach(function(d) {
      var m = u[d];
      c.forEach(function(p) {
        var x = u[p];
        c.forEach(function(b) {
          var S = x[d], k = m[b], A = x[b], T = S.distance + k.distance;
          T < A.distance && (A.distance = T, A.predecessor = k.predecessor);
        });
      });
    }), u;
  }
  return ES;
}
var kS, g7;
function kL() {
  if (g7) return kS;
  g7 = 1;
  var e = Fs();
  kS = t, t.CycleException = n;
  function t(r) {
    var i = {}, s = {}, o = [];
    function u(c) {
      if (e.has(s, c))
        throw new n();
      e.has(i, c) || (s[c] = !0, i[c] = !0, e.each(r.predecessors(c), u), delete s[c], o.push(c));
    }
    if (e.each(r.sinks(), u), e.size(i) !== r.nodeCount())
      throw new n();
    return o;
  }
  function n() {
  }
  return n.prototype = new Error(), kS;
}
var TS, y7;
function Cce() {
  if (y7) return TS;
  y7 = 1;
  var e = kL();
  TS = t;
  function t(n) {
    try {
      e(n);
    } catch (r) {
      if (r instanceof e.CycleException)
        return !1;
      throw r;
    }
    return !0;
  }
  return TS;
}
var NS, v7;
function TL() {
  if (v7) return NS;
  v7 = 1;
  var e = Fs();
  NS = t;
  function t(r, i, s) {
    e.isArray(i) || (i = [i]);
    var o = (r.isDirected() ? r.successors : r.neighbors).bind(r), u = [], c = {};
    return e.each(i, function(d) {
      if (!r.hasNode(d))
        throw new Error("Graph does not have node: " + d);
      n(r, d, s === "post", c, o, u);
    }), u;
  }
  function n(r, i, s, o, u, c) {
    e.has(o, i) || (o[i] = !0, s || c.push(i), e.each(u(i), function(d) {
      n(r, d, s, o, u, c);
    }), s && c.push(i));
  }
  return NS;
}
var AS, x7;
function Ece() {
  if (x7) return AS;
  x7 = 1;
  var e = TL();
  AS = t;
  function t(n, r) {
    return e(n, r, "post");
  }
  return AS;
}
var jS, b7;
function kce() {
  if (b7) return jS;
  b7 = 1;
  var e = TL();
  jS = t;
  function t(n, r) {
    return e(n, r, "pre");
  }
  return jS;
}
var MS, w7;
function Tce() {
  if (w7) return MS;
  w7 = 1;
  var e = Fs(), t = hk(), n = SL();
  MS = r;
  function r(i, s) {
    var o = new t(), u = {}, c = new n(), d;
    function m(x) {
      var b = x.v === d ? x.w : x.v, S = c.priority(b);
      if (S !== void 0) {
        var k = s(x);
        k < S && (u[b] = d, c.decrease(b, k));
      }
    }
    if (i.nodeCount() === 0)
      return o;
    e.each(i.nodes(), function(x) {
      c.add(x, Number.POSITIVE_INFINITY), o.setNode(x);
    }), c.decrease(i.nodes()[0], 0);
    for (var p = !1; c.size() > 0; ) {
      if (d = c.removeMin(), e.has(u, d))
        o.setEdge(d, u[d]);
      else {
        if (p)
          throw new Error("Input graph is not connected: " + i);
        p = !0;
      }
      i.nodeEdges(d).forEach(m);
    }
    return o;
  }
  return MS;
}
var RS, _7;
function Nce() {
  return _7 || (_7 = 1, RS = {
    components: bce(),
    dijkstra: CL(),
    dijkstraAll: wce(),
    findCycles: _ce(),
    floydWarshall: Sce(),
    isAcyclic: Cce(),
    postorder: Ece(),
    preorder: kce(),
    prim: Tce(),
    tarjan: EL(),
    topsort: kL()
  }), RS;
}
var OS, S7;
function Ace() {
  if (S7) return OS;
  S7 = 1;
  var e = vce();
  return OS = {
    Graph: e.Graph,
    json: xce(),
    alg: Nce(),
    version: e.version
  }, OS;
}
var DS, C7;
function Ro() {
  if (C7) return DS;
  C7 = 1;
  var e;
  if (typeof QE == "function")
    try {
      e = Ace();
    } catch {
    }
  return e || (e = window.graphlib), DS = e, DS;
}
var IS, E7;
function jce() {
  if (E7) return IS;
  E7 = 1;
  var e = Zz(), t = 1, n = 4;
  function r(i) {
    return e(i, t | n);
  }
  return IS = r, IS;
}
var PS, k7;
function qx() {
  if (k7) return PS;
  k7 = 1;
  var e = Vm(), t = Nu(), n = Mx(), r = qs();
  function i(s, o, u) {
    if (!r(u))
      return !1;
    var c = typeof o;
    return (c == "number" ? t(u) && n(o, u.length) : c == "string" && o in u) ? e(u[o], s) : !1;
  }
  return PS = i, PS;
}
var zS, T7;
function Mce() {
  if (T7) return zS;
  T7 = 1;
  var e = Bx(), t = Vm(), n = qx(), r = Ud(), i = Object.prototype, s = i.hasOwnProperty, o = e(function(u, c) {
    u = Object(u);
    var d = -1, m = c.length, p = m > 2 ? c[2] : void 0;
    for (p && n(c[0], c[1], p) && (m = 1); ++d < m; )
      for (var x = c[d], b = r(x), S = -1, k = b.length; ++S < k; ) {
        var A = b[S], T = u[A];
        (T === void 0 || t(T, i[A]) && !s.call(u, A)) && (u[A] = x[A]);
      }
    return u;
  });
  return zS = o, zS;
}
var LS, N7;
function Rce() {
  if (N7) return LS;
  N7 = 1;
  var e = Au(), t = Nu(), n = Hc();
  function r(i) {
    return function(s, o, u) {
      var c = Object(s);
      if (!t(s)) {
        var d = e(o, 3);
        s = n(s), o = function(p) {
          return d(c[p], p, c);
        };
      }
      var m = i(s, o, u);
      return m > -1 ? c[d ? s[m] : m] : void 0;
    };
  }
  return LS = r, LS;
}
var BS, A7;
function Oce() {
  if (A7) return BS;
  A7 = 1;
  var e = /\s/;
  function t(n) {
    for (var r = n.length; r-- && e.test(n.charAt(r)); )
      ;
    return r;
  }
  return BS = t, BS;
}
var qS, j7;
function Dce() {
  if (j7) return qS;
  j7 = 1;
  var e = Oce(), t = /^\s+/;
  function n(r) {
    return r && r.slice(0, e(r) + 1).replace(t, "");
  }
  return qS = n, qS;
}
var FS, M7;
function Ice() {
  if (M7) return FS;
  M7 = 1;
  var e = Dce(), t = qs(), n = Ym(), r = NaN, i = /^[-+]0x[0-9a-f]+$/i, s = /^0b[01]+$/i, o = /^0o[0-7]+$/i, u = parseInt;
  function c(d) {
    if (typeof d == "number")
      return d;
    if (n(d))
      return r;
    if (t(d)) {
      var m = typeof d.valueOf == "function" ? d.valueOf() : d;
      d = t(m) ? m + "" : m;
    }
    if (typeof d != "string")
      return d === 0 ? d : +d;
    d = e(d);
    var p = s.test(d);
    return p || o.test(d) ? u(d.slice(2), p ? 2 : 8) : i.test(d) ? r : +d;
  }
  return FS = c, FS;
}
var US, R7;
function NL() {
  if (R7) return US;
  R7 = 1;
  var e = Ice(), t = 1 / 0, n = 17976931348623157e292;
  function r(i) {
    if (!i)
      return i === 0 ? i : 0;
    if (i = e(i), i === t || i === -t) {
      var s = i < 0 ? -1 : 1;
      return s * n;
    }
    return i === i ? i : 0;
  }
  return US = r, US;
}
var $S, O7;
function Pce() {
  if (O7) return $S;
  O7 = 1;
  var e = NL();
  function t(n) {
    var r = e(n), i = r % 1;
    return r === r ? i ? r - i : r : 0;
  }
  return $S = t, $S;
}
var VS, D7;
function zce() {
  if (D7) return VS;
  D7 = 1;
  var e = bL(), t = Au(), n = Pce(), r = Math.max;
  function i(s, o, u) {
    var c = s == null ? 0 : s.length;
    if (!c)
      return -1;
    var d = u == null ? 0 : n(u);
    return d < 0 && (d = r(c + d, 0)), e(s, t(o, 3), d);
  }
  return VS = i, VS;
}
var HS, I7;
function Lce() {
  if (I7) return HS;
  I7 = 1;
  var e = Rce(), t = zce(), n = e(t);
  return HS = n, HS;
}
var GS, P7;
function AL() {
  if (P7) return GS;
  P7 = 1;
  var e = dk();
  function t(n) {
    var r = n == null ? 0 : n.length;
    return r ? e(n, 1) : [];
  }
  return GS = t, GS;
}
var KS, z7;
function Bce() {
  if (z7) return KS;
  z7 = 1;
  var e = lk(), t = Jz(), n = Ud();
  function r(i, s) {
    return i == null ? i : e(i, t(s), n);
  }
  return KS = r, KS;
}
var YS, L7;
function qce() {
  if (L7) return YS;
  L7 = 1;
  function e(t) {
    var n = t == null ? 0 : t.length;
    return n ? t[n - 1] : void 0;
  }
  return YS = e, YS;
}
var WS, B7;
function Fce() {
  if (B7) return WS;
  B7 = 1;
  var e = Ax(), t = uk(), n = Au();
  function r(i, s) {
    var o = {};
    return s = n(s, 3), t(i, function(u, c, d) {
      e(o, c, s(u, c, d));
    }), o;
  }
  return WS = r, WS;
}
var XS, q7;
function mk() {
  if (q7) return XS;
  q7 = 1;
  var e = Ym();
  function t(n, r, i) {
    for (var s = -1, o = n.length; ++s < o; ) {
      var u = n[s], c = r(u);
      if (c != null && (d === void 0 ? c === c && !e(c) : i(c, d)))
        var d = c, m = u;
    }
    return m;
  }
  return XS = t, XS;
}
var QS, F7;
function Uce() {
  if (F7) return QS;
  F7 = 1;
  function e(t, n) {
    return t > n;
  }
  return QS = e, QS;
}
var ZS, U7;
function $ce() {
  if (U7) return ZS;
  U7 = 1;
  var e = mk(), t = Uce(), n = $d();
  function r(i) {
    return i && i.length ? e(i, n, t) : void 0;
  }
  return ZS = r, ZS;
}
var JS, $7;
function jL() {
  if ($7) return JS;
  $7 = 1;
  var e = Ax(), t = Vm();
  function n(r, i, s) {
    (s !== void 0 && !t(r[i], s) || s === void 0 && !(i in r)) && e(r, i, s);
  }
  return JS = n, JS;
}
var e3, V7;
function Vce() {
  if (V7) return e3;
  V7 = 1;
  var e = qd(), t = Dx(), n = Pl(), r = "[object Object]", i = Function.prototype, s = Object.prototype, o = i.toString, u = s.hasOwnProperty, c = o.call(Object);
  function d(m) {
    if (!n(m) || e(m) != r)
      return !1;
    var p = t(m);
    if (p === null)
      return !0;
    var x = u.call(p, "constructor") && p.constructor;
    return typeof x == "function" && x instanceof x && o.call(x) == c;
  }
  return e3 = d, e3;
}
var t3, H7;
function ML() {
  if (H7) return t3;
  H7 = 1;
  function e(t, n) {
    if (!(n === "constructor" && typeof t[n] == "function") && n != "__proto__")
      return t[n];
  }
  return t3 = e, t3;
}
var n3, G7;
function Hce() {
  if (G7) return n3;
  G7 = 1;
  var e = G0(), t = Ud();
  function n(r) {
    return e(r, t(r));
  }
  return n3 = n, n3;
}
var r3, K7;
function Gce() {
  if (K7) return r3;
  K7 = 1;
  var e = jL(), t = qz(), n = Wz(), r = Fz(), i = Qz(), s = K0(), o = Br(), u = wL(), c = Gm(), d = H0(), m = qs(), p = Vce(), x = Y0(), b = ML(), S = Hce();
  function k(A, T, M, j, D, z, I) {
    var L = b(A, M), K = b(T, M), ne = I.get(K);
    if (ne) {
      e(A, M, ne);
      return;
    }
    var Y = z ? z(L, K, M + "", A, T, I) : void 0, H = Y === void 0;
    if (H) {
      var Z = o(K), me = !Z && c(K), Q = !Z && !me && x(K);
      Y = K, Z || me || Q ? o(L) ? Y = L : u(L) ? Y = r(L) : me ? (H = !1, Y = t(K, !0)) : Q ? (H = !1, Y = n(K, !0)) : Y = [] : p(K) || s(K) ? (Y = L, s(L) ? Y = S(L) : (!m(L) || d(L)) && (Y = i(K))) : H = !1;
    }
    H && (I.set(K, Y), D(Y, K, j, z, I), I.delete(K)), e(A, M, Y);
  }
  return r3 = k, r3;
}
var i3, Y7;
function Kce() {
  if (Y7) return i3;
  Y7 = 1;
  var e = Nx(), t = jL(), n = lk(), r = Gce(), i = qs(), s = Ud(), o = ML();
  function u(c, d, m, p, x) {
    c !== d && n(d, function(b, S) {
      if (x || (x = new e()), i(b))
        r(c, d, S, m, u, p, x);
      else {
        var k = p ? p(o(c, S), b, S + "", c, d, x) : void 0;
        k === void 0 && (k = b), t(c, S, k);
      }
    }, s);
  }
  return i3 = u, i3;
}
var a3, W7;
function Yce() {
  if (W7) return a3;
  W7 = 1;
  var e = Bx(), t = qx();
  function n(r) {
    return e(function(i, s) {
      var o = -1, u = s.length, c = u > 1 ? s[u - 1] : void 0, d = u > 2 ? s[2] : void 0;
      for (c = r.length > 3 && typeof c == "function" ? (u--, c) : void 0, d && t(s[0], s[1], d) && (c = u < 3 ? void 0 : c, u = 1), i = Object(i); ++o < u; ) {
        var m = s[o];
        m && r(i, m, o, c);
      }
      return i;
    });
  }
  return a3 = n, a3;
}
var s3, X7;
function Wce() {
  if (X7) return s3;
  X7 = 1;
  var e = Kce(), t = Yce(), n = t(function(r, i, s) {
    e(r, i, s);
  });
  return s3 = n, s3;
}
var o3, Q7;
function RL() {
  if (Q7) return o3;
  Q7 = 1;
  function e(t, n) {
    return t < n;
  }
  return o3 = e, o3;
}
var l3, Z7;
function Xce() {
  if (Z7) return l3;
  Z7 = 1;
  var e = mk(), t = RL(), n = $d();
  function r(i) {
    return i && i.length ? e(i, n, t) : void 0;
  }
  return l3 = r, l3;
}
var u3, J7;
function Qce() {
  if (J7) return u3;
  J7 = 1;
  var e = mk(), t = Au(), n = RL();
  function r(i, s) {
    return i && i.length ? e(i, t(s, 2), n) : void 0;
  }
  return u3 = r, u3;
}
var c3, eM;
function Zce() {
  if (eM) return c3;
  eM = 1;
  var e = Do(), t = function() {
    return e.Date.now();
  };
  return c3 = t, c3;
}
var f3, tM;
function Jce() {
  if (tM) return f3;
  tM = 1;
  var e = jx(), t = zx(), n = Mx(), r = qs(), i = W0();
  function s(o, u, c, d) {
    if (!r(o))
      return o;
    u = t(u, o);
    for (var m = -1, p = u.length, x = p - 1, b = o; b != null && ++m < p; ) {
      var S = i(u[m]), k = c;
      if (S === "__proto__" || S === "constructor" || S === "prototype")
        return o;
      if (m != x) {
        var A = b[S];
        k = d ? d(A, S, b) : void 0, k === void 0 && (k = r(A) ? A : n(u[m + 1]) ? [] : {});
      }
      e(b, S, k), b = b[S];
    }
    return o;
  }
  return f3 = s, f3;
}
var d3, nM;
function efe() {
  if (nM) return d3;
  nM = 1;
  var e = Lx(), t = Jce(), n = zx();
  function r(i, s, o) {
    for (var u = -1, c = s.length, d = {}; ++u < c; ) {
      var m = s[u], p = e(i, m);
      o(p, m) && t(d, n(m, i), p);
    }
    return d;
  }
  return d3 = r, d3;
}
var h3, rM;
function tfe() {
  if (rM) return h3;
  rM = 1;
  var e = efe(), t = cL();
  function n(r, i) {
    return e(r, i, function(s, o) {
      return t(r, o);
    });
  }
  return h3 = n, h3;
}
var m3, iM;
function nfe() {
  if (iM) return m3;
  iM = 1;
  var e = AL(), t = vL(), n = xL();
  function r(i) {
    return n(t(i, void 0, e), i + "");
  }
  return m3 = r, m3;
}
var p3, aM;
function rfe() {
  if (aM) return p3;
  aM = 1;
  var e = tfe(), t = nfe(), n = t(function(r, i) {
    return r == null ? {} : e(r, i);
  });
  return p3 = n, p3;
}
var g3, sM;
function ife() {
  if (sM) return g3;
  sM = 1;
  var e = Math.ceil, t = Math.max;
  function n(r, i, s, o) {
    for (var u = -1, c = t(e((i - r) / (s || 1)), 0), d = Array(c); c--; )
      d[o ? c : ++u] = r, r += s;
    return d;
  }
  return g3 = n, g3;
}
var y3, oM;
function afe() {
  if (oM) return y3;
  oM = 1;
  var e = ife(), t = qx(), n = NL();
  function r(i) {
    return function(s, o, u) {
      return u && typeof u != "number" && t(s, o, u) && (o = u = void 0), s = n(s), o === void 0 ? (o = s, s = 0) : o = n(o), u = u === void 0 ? s < o ? 1 : -1 : n(u), e(s, o, u, i);
    };
  }
  return y3 = r, y3;
}
var v3, lM;
function sfe() {
  if (lM) return v3;
  lM = 1;
  var e = afe(), t = e();
  return v3 = t, v3;
}
var x3, uM;
function ofe() {
  if (uM) return x3;
  uM = 1;
  function e(t, n) {
    var r = t.length;
    for (t.sort(n); r--; )
      t[r] = t[r].value;
    return t;
  }
  return x3 = e, x3;
}
var b3, cM;
function lfe() {
  if (cM) return b3;
  cM = 1;
  var e = Ym();
  function t(n, r) {
    if (n !== r) {
      var i = n !== void 0, s = n === null, o = n === n, u = e(n), c = r !== void 0, d = r === null, m = r === r, p = e(r);
      if (!d && !p && !u && n > r || u && c && m && !d && !p || s && c && m || !i && m || !o)
        return 1;
      if (!s && !u && !p && n < r || p && i && o && !s && !u || d && i && o || !c && o || !m)
        return -1;
    }
    return 0;
  }
  return b3 = t, b3;
}
var w3, fM;
function ufe() {
  if (fM) return w3;
  fM = 1;
  var e = lfe();
  function t(n, r, i) {
    for (var s = -1, o = n.criteria, u = r.criteria, c = o.length, d = i.length; ++s < c; ) {
      var m = e(o[s], u[s]);
      if (m) {
        if (s >= d)
          return m;
        var p = i[s];
        return m * (p == "desc" ? -1 : 1);
      }
    }
    return n.index - r.index;
  }
  return w3 = t, w3;
}
var _3, dM;
function cfe() {
  if (dM) return _3;
  dM = 1;
  var e = Px(), t = Lx(), n = Au(), r = pL(), i = ofe(), s = Rx(), o = ufe(), u = $d(), c = Br();
  function d(m, p, x) {
    p.length ? p = e(p, function(k) {
      return c(k) ? function(A) {
        return t(A, k.length === 1 ? k[0] : k);
      } : k;
    }) : p = [u];
    var b = -1;
    p = e(p, s(n));
    var S = r(m, function(k, A, T) {
      var M = e(p, function(j) {
        return j(k);
      });
      return { criteria: M, index: ++b, value: k };
    });
    return i(S, function(k, A) {
      return o(k, A, x);
    });
  }
  return _3 = d, _3;
}
var S3, hM;
function ffe() {
  if (hM) return S3;
  hM = 1;
  var e = dk(), t = cfe(), n = Bx(), r = qx(), i = n(function(s, o) {
    if (s == null)
      return [];
    var u = o.length;
    return u > 1 && r(s, o[0], o[1]) ? o = [] : u > 2 && r(o[0], o[1], o[2]) && (o = [o[0]]), t(s, e(o, 1), []);
  });
  return S3 = i, S3;
}
var C3, mM;
function dfe() {
  if (mM) return C3;
  mM = 1;
  var e = lL(), t = 0;
  function n(r) {
    var i = ++t;
    return e(r) + i;
  }
  return C3 = n, C3;
}
var E3, pM;
function hfe() {
  if (pM) return E3;
  pM = 1;
  function e(t, n, r) {
    for (var i = -1, s = t.length, o = n.length, u = {}; ++i < s; ) {
      var c = i < o ? n[i] : void 0;
      r(u, t[i], c);
    }
    return u;
  }
  return E3 = e, E3;
}
var k3, gM;
function mfe() {
  if (gM) return k3;
  gM = 1;
  var e = jx(), t = hfe();
  function n(r, i) {
    return t(r || [], i || [], e);
  }
  return k3 = n, k3;
}
var T3, yM;
function cr() {
  if (yM) return T3;
  yM = 1;
  var e;
  if (typeof QE == "function")
    try {
      e = {
        cloneDeep: jce(),
        constant: ok(),
        defaults: Mce(),
        each: tL(),
        filter: dL(),
        find: Lce(),
        flatten: AL(),
        forEach: eL(),
        forIn: Bce(),
        has: hL(),
        isUndefined: mL(),
        last: qce(),
        map: gL(),
        mapValues: Fce(),
        max: $ce(),
        merge: Wce(),
        min: Xce(),
        minBy: Qce(),
        now: Zce(),
        pick: rfe(),
        range: sfe(),
        reduce: yL(),
        sortBy: ffe(),
        uniqueId: dfe(),
        values: _L(),
        zipObject: mfe()
      };
    } catch {
    }
  return e || (e = window._), T3 = e, T3;
}
var N3, vM;
function pfe() {
  if (vM) return N3;
  vM = 1, N3 = e;
  function e() {
    var r = {};
    r._next = r._prev = r, this._sentinel = r;
  }
  e.prototype.dequeue = function() {
    var r = this._sentinel, i = r._prev;
    if (i !== r)
      return t(i), i;
  }, e.prototype.enqueue = function(r) {
    var i = this._sentinel;
    r._prev && r._next && t(r), r._next = i._next, i._next._prev = r, i._next = r, r._prev = i;
  }, e.prototype.toString = function() {
    for (var r = [], i = this._sentinel, s = i._prev; s !== i; )
      r.push(JSON.stringify(s, n)), s = s._prev;
    return "[" + r.join(", ") + "]";
  };
  function t(r) {
    r._prev._next = r._next, r._next._prev = r._prev, delete r._next, delete r._prev;
  }
  function n(r, i) {
    if (r !== "_next" && r !== "_prev")
      return i;
  }
  return N3;
}
var A3, xM;
function gfe() {
  if (xM) return A3;
  xM = 1;
  var e = cr(), t = Ro().Graph, n = pfe();
  A3 = i;
  var r = e.constant(1);
  function i(d, m) {
    if (d.nodeCount() <= 1)
      return [];
    var p = u(d, m || r), x = s(p.graph, p.buckets, p.zeroIdx);
    return e.flatten(e.map(x, function(b) {
      return d.outEdges(b.v, b.w);
    }), !0);
  }
  function s(d, m, p) {
    for (var x = [], b = m[m.length - 1], S = m[0], k; d.nodeCount(); ) {
      for (; k = S.dequeue(); )
        o(d, m, p, k);
      for (; k = b.dequeue(); )
        o(d, m, p, k);
      if (d.nodeCount()) {
        for (var A = m.length - 2; A > 0; --A)
          if (k = m[A].dequeue(), k) {
            x = x.concat(o(d, m, p, k, !0));
            break;
          }
      }
    }
    return x;
  }
  function o(d, m, p, x, b) {
    var S = b ? [] : void 0;
    return e.forEach(d.inEdges(x.v), function(k) {
      var A = d.edge(k), T = d.node(k.v);
      b && S.push({ v: k.v, w: k.w }), T.out -= A, c(m, p, T);
    }), e.forEach(d.outEdges(x.v), function(k) {
      var A = d.edge(k), T = k.w, M = d.node(T);
      M.in -= A, c(m, p, M);
    }), d.removeNode(x.v), S;
  }
  function u(d, m) {
    var p = new t(), x = 0, b = 0;
    e.forEach(d.nodes(), function(A) {
      p.setNode(A, { v: A, in: 0, out: 0 });
    }), e.forEach(d.edges(), function(A) {
      var T = p.edge(A.v, A.w) || 0, M = m(A), j = T + M;
      p.setEdge(A.v, A.w, j), b = Math.max(b, p.node(A.v).out += M), x = Math.max(x, p.node(A.w).in += M);
    });
    var S = e.range(b + x + 3).map(function() {
      return new n();
    }), k = x + 1;
    return e.forEach(p.nodes(), function(A) {
      c(S, k, p.node(A));
    }), { graph: p, buckets: S, zeroIdx: k };
  }
  function c(d, m, p) {
    p.out ? p.in ? d[p.out - p.in + m].enqueue(p) : d[d.length - 1].enqueue(p) : d[0].enqueue(p);
  }
  return A3;
}
var j3, bM;
function yfe() {
  if (bM) return j3;
  bM = 1;
  var e = cr(), t = gfe();
  j3 = {
    run: n,
    undo: i
  };
  function n(s) {
    var o = s.graph().acyclicer === "greedy" ? t(s, u(s)) : r(s);
    e.forEach(o, function(c) {
      var d = s.edge(c);
      s.removeEdge(c), d.forwardName = c.name, d.reversed = !0, s.setEdge(c.w, c.v, d, e.uniqueId("rev"));
    });
    function u(c) {
      return function(d) {
        return c.edge(d).weight;
      };
    }
  }
  function r(s) {
    var o = [], u = {}, c = {};
    function d(m) {
      e.has(c, m) || (c[m] = !0, u[m] = !0, e.forEach(s.outEdges(m), function(p) {
        e.has(u, p.w) ? o.push(p) : d(p.w);
      }), delete u[m]);
    }
    return e.forEach(s.nodes(), d), o;
  }
  function i(s) {
    e.forEach(s.edges(), function(o) {
      var u = s.edge(o);
      if (u.reversed) {
        s.removeEdge(o);
        var c = u.forwardName;
        delete u.reversed, delete u.forwardName, s.setEdge(o.w, o.v, u, c);
      }
    });
  }
  return j3;
}
var M3, wM;
function Ua() {
  if (wM) return M3;
  wM = 1;
  var e = cr(), t = Ro().Graph;
  M3 = {
    addDummyNode: n,
    simplify: r,
    asNonCompoundGraph: i,
    successorWeights: s,
    predecessorWeights: o,
    intersectRect: u,
    buildLayerMatrix: c,
    normalizeRanks: d,
    removeEmptyRanks: m,
    addBorderNode: p,
    maxRank: x,
    partition: b,
    time: S,
    notime: k
  };
  function n(A, T, M, j) {
    var D;
    do
      D = e.uniqueId(j);
    while (A.hasNode(D));
    return M.dummy = T, A.setNode(D, M), D;
  }
  function r(A) {
    var T = new t().setGraph(A.graph());
    return e.forEach(A.nodes(), function(M) {
      T.setNode(M, A.node(M));
    }), e.forEach(A.edges(), function(M) {
      var j = T.edge(M.v, M.w) || { weight: 0, minlen: 1 }, D = A.edge(M);
      T.setEdge(M.v, M.w, {
        weight: j.weight + D.weight,
        minlen: Math.max(j.minlen, D.minlen)
      });
    }), T;
  }
  function i(A) {
    var T = new t({ multigraph: A.isMultigraph() }).setGraph(A.graph());
    return e.forEach(A.nodes(), function(M) {
      A.children(M).length || T.setNode(M, A.node(M));
    }), e.forEach(A.edges(), function(M) {
      T.setEdge(M, A.edge(M));
    }), T;
  }
  function s(A) {
    var T = e.map(A.nodes(), function(M) {
      var j = {};
      return e.forEach(A.outEdges(M), function(D) {
        j[D.w] = (j[D.w] || 0) + A.edge(D).weight;
      }), j;
    });
    return e.zipObject(A.nodes(), T);
  }
  function o(A) {
    var T = e.map(A.nodes(), function(M) {
      var j = {};
      return e.forEach(A.inEdges(M), function(D) {
        j[D.v] = (j[D.v] || 0) + A.edge(D).weight;
      }), j;
    });
    return e.zipObject(A.nodes(), T);
  }
  function u(A, T) {
    var M = A.x, j = A.y, D = T.x - M, z = T.y - j, I = A.width / 2, L = A.height / 2;
    if (!D && !z)
      throw new Error("Not possible to find intersection inside of the rectangle");
    var K, ne;
    return Math.abs(z) * I > Math.abs(D) * L ? (z < 0 && (L = -L), K = L * D / z, ne = L) : (D < 0 && (I = -I), K = I, ne = I * z / D), { x: M + K, y: j + ne };
  }
  function c(A) {
    var T = e.map(e.range(x(A) + 1), function() {
      return [];
    });
    return e.forEach(A.nodes(), function(M) {
      var j = A.node(M), D = j.rank;
      e.isUndefined(D) || (T[D][j.order] = M);
    }), T;
  }
  function d(A) {
    var T = e.min(e.map(A.nodes(), function(M) {
      return A.node(M).rank;
    }));
    e.forEach(A.nodes(), function(M) {
      var j = A.node(M);
      e.has(j, "rank") && (j.rank -= T);
    });
  }
  function m(A) {
    var T = e.min(e.map(A.nodes(), function(z) {
      return A.node(z).rank;
    })), M = [];
    e.forEach(A.nodes(), function(z) {
      var I = A.node(z).rank - T;
      M[I] || (M[I] = []), M[I].push(z);
    });
    var j = 0, D = A.graph().nodeRankFactor;
    e.forEach(M, function(z, I) {
      e.isUndefined(z) && I % D !== 0 ? --j : j && e.forEach(z, function(L) {
        A.node(L).rank += j;
      });
    });
  }
  function p(A, T, M, j) {
    var D = {
      width: 0,
      height: 0
    };
    return arguments.length >= 4 && (D.rank = M, D.order = j), n(A, "border", D, T);
  }
  function x(A) {
    return e.max(e.map(A.nodes(), function(T) {
      var M = A.node(T).rank;
      if (!e.isUndefined(M))
        return M;
    }));
  }
  function b(A, T) {
    var M = { lhs: [], rhs: [] };
    return e.forEach(A, function(j) {
      T(j) ? M.lhs.push(j) : M.rhs.push(j);
    }), M;
  }
  function S(A, T) {
    var M = e.now();
    try {
      return T();
    } finally {
      console.log(A + " time: " + (e.now() - M) + "ms");
    }
  }
  function k(A, T) {
    return T();
  }
  return M3;
}
var R3, _M;
function vfe() {
  if (_M) return R3;
  _M = 1;
  var e = cr(), t = Ua();
  R3 = {
    run: n,
    undo: i
  };
  function n(s) {
    s.graph().dummyChains = [], e.forEach(s.edges(), function(o) {
      r(s, o);
    });
  }
  function r(s, o) {
    var u = o.v, c = s.node(u).rank, d = o.w, m = s.node(d).rank, p = o.name, x = s.edge(o), b = x.labelRank;
    if (m !== c + 1) {
      s.removeEdge(o);
      var S, k, A;
      for (A = 0, ++c; c < m; ++A, ++c)
        x.points = [], k = {
          width: 0,
          height: 0,
          edgeLabel: x,
          edgeObj: o,
          rank: c
        }, S = t.addDummyNode(s, "edge", k, "_d"), c === b && (k.width = x.width, k.height = x.height, k.dummy = "edge-label", k.labelpos = x.labelpos), s.setEdge(u, S, { weight: x.weight }, p), A === 0 && s.graph().dummyChains.push(S), u = S;
      s.setEdge(u, d, { weight: x.weight }, p);
    }
  }
  function i(s) {
    e.forEach(s.graph().dummyChains, function(o) {
      var u = s.node(o), c = u.edgeLabel, d;
      for (s.setEdge(u.edgeObj, c); u.dummy; )
        d = s.successors(o)[0], s.removeNode(o), c.points.push({ x: u.x, y: u.y }), u.dummy === "edge-label" && (c.x = u.x, c.y = u.y, c.width = u.width, c.height = u.height), o = d, u = s.node(o);
    });
  }
  return R3;
}
var O3, SM;
function Hv() {
  if (SM) return O3;
  SM = 1;
  var e = cr();
  O3 = {
    longestPath: t,
    slack: n
  };
  function t(r) {
    var i = {};
    function s(o) {
      var u = r.node(o);
      if (e.has(i, o))
        return u.rank;
      i[o] = !0;
      var c = e.min(e.map(r.outEdges(o), function(d) {
        return s(d.w) - r.edge(d).minlen;
      }));
      return (c === Number.POSITIVE_INFINITY || // return value of _.map([]) for Lodash 3
      c === void 0 || // return value of _.map([]) for Lodash 4
      c === null) && (c = 0), u.rank = c;
    }
    e.forEach(r.sources(), s);
  }
  function n(r, i) {
    return r.node(i.w).rank - r.node(i.v).rank - r.edge(i).minlen;
  }
  return O3;
}
var D3, CM;
function OL() {
  if (CM) return D3;
  CM = 1;
  var e = cr(), t = Ro().Graph, n = Hv().slack;
  D3 = r;
  function r(u) {
    var c = new t({ directed: !1 }), d = u.nodes()[0], m = u.nodeCount();
    c.setNode(d, {});
    for (var p, x; i(c, u) < m; )
      p = s(c, u), x = c.hasNode(p.v) ? n(u, p) : -n(u, p), o(c, u, x);
    return c;
  }
  function i(u, c) {
    function d(m) {
      e.forEach(c.nodeEdges(m), function(p) {
        var x = p.v, b = m === x ? p.w : x;
        !u.hasNode(b) && !n(c, p) && (u.setNode(b, {}), u.setEdge(m, b, {}), d(b));
      });
    }
    return e.forEach(u.nodes(), d), u.nodeCount();
  }
  function s(u, c) {
    return e.minBy(c.edges(), function(d) {
      if (u.hasNode(d.v) !== u.hasNode(d.w))
        return n(c, d);
    });
  }
  function o(u, c, d) {
    e.forEach(u.nodes(), function(m) {
      c.node(m).rank += d;
    });
  }
  return D3;
}
var I3, EM;
function xfe() {
  if (EM) return I3;
  EM = 1;
  var e = cr(), t = OL(), n = Hv().slack, r = Hv().longestPath, i = Ro().alg.preorder, s = Ro().alg.postorder, o = Ua().simplify;
  I3 = u, u.initLowLimValues = p, u.initCutValues = c, u.calcCutValue = m, u.leaveEdge = b, u.enterEdge = S, u.exchangeEdges = k;
  function u(j) {
    j = o(j), r(j);
    var D = t(j);
    p(D), c(D, j);
    for (var z, I; z = b(D); )
      I = S(D, j, z), k(D, j, z, I);
  }
  function c(j, D) {
    var z = s(j, j.nodes());
    z = z.slice(0, z.length - 1), e.forEach(z, function(I) {
      d(j, D, I);
    });
  }
  function d(j, D, z) {
    var I = j.node(z), L = I.parent;
    j.edge(z, L).cutvalue = m(j, D, z);
  }
  function m(j, D, z) {
    var I = j.node(z), L = I.parent, K = !0, ne = D.edge(z, L), Y = 0;
    return ne || (K = !1, ne = D.edge(L, z)), Y = ne.weight, e.forEach(D.nodeEdges(z), function(H) {
      var Z = H.v === z, me = Z ? H.w : H.v;
      if (me !== L) {
        var Q = Z === K, se = D.edge(H).weight;
        if (Y += Q ? se : -se, T(j, z, me)) {
          var J = j.edge(z, me).cutvalue;
          Y += Q ? -J : J;
        }
      }
    }), Y;
  }
  function p(j, D) {
    arguments.length < 2 && (D = j.nodes()[0]), x(j, {}, 1, D);
  }
  function x(j, D, z, I, L) {
    var K = z, ne = j.node(I);
    return D[I] = !0, e.forEach(j.neighbors(I), function(Y) {
      e.has(D, Y) || (z = x(j, D, z, Y, I));
    }), ne.low = K, ne.lim = z++, L ? ne.parent = L : delete ne.parent, z;
  }
  function b(j) {
    return e.find(j.edges(), function(D) {
      return j.edge(D).cutvalue < 0;
    });
  }
  function S(j, D, z) {
    var I = z.v, L = z.w;
    D.hasEdge(I, L) || (I = z.w, L = z.v);
    var K = j.node(I), ne = j.node(L), Y = K, H = !1;
    K.lim > ne.lim && (Y = ne, H = !0);
    var Z = e.filter(D.edges(), function(me) {
      return H === M(j, j.node(me.v), Y) && H !== M(j, j.node(me.w), Y);
    });
    return e.minBy(Z, function(me) {
      return n(D, me);
    });
  }
  function k(j, D, z, I) {
    var L = z.v, K = z.w;
    j.removeEdge(L, K), j.setEdge(I.v, I.w, {}), p(j), c(j, D), A(j, D);
  }
  function A(j, D) {
    var z = e.find(j.nodes(), function(L) {
      return !D.node(L).parent;
    }), I = i(j, z);
    I = I.slice(1), e.forEach(I, function(L) {
      var K = j.node(L).parent, ne = D.edge(L, K), Y = !1;
      ne || (ne = D.edge(K, L), Y = !0), D.node(L).rank = D.node(K).rank + (Y ? ne.minlen : -ne.minlen);
    });
  }
  function T(j, D, z) {
    return j.hasEdge(D, z);
  }
  function M(j, D, z) {
    return z.low <= D.lim && D.lim <= z.lim;
  }
  return I3;
}
var P3, kM;
function bfe() {
  if (kM) return P3;
  kM = 1;
  var e = Hv(), t = e.longestPath, n = OL(), r = xfe();
  P3 = i;
  function i(c) {
    switch (c.graph().ranker) {
      case "network-simplex":
        u(c);
        break;
      case "tight-tree":
        o(c);
        break;
      case "longest-path":
        s(c);
        break;
      default:
        u(c);
    }
  }
  var s = t;
  function o(c) {
    t(c), n(c);
  }
  function u(c) {
    r(c);
  }
  return P3;
}
var z3, TM;
function wfe() {
  if (TM) return z3;
  TM = 1;
  var e = cr();
  z3 = t;
  function t(i) {
    var s = r(i);
    e.forEach(i.graph().dummyChains, function(o) {
      for (var u = i.node(o), c = u.edgeObj, d = n(i, s, c.v, c.w), m = d.path, p = d.lca, x = 0, b = m[x], S = !0; o !== c.w; ) {
        if (u = i.node(o), S) {
          for (; (b = m[x]) !== p && i.node(b).maxRank < u.rank; )
            x++;
          b === p && (S = !1);
        }
        if (!S) {
          for (; x < m.length - 1 && i.node(b = m[x + 1]).minRank <= u.rank; )
            x++;
          b = m[x];
        }
        i.setParent(o, b), o = i.successors(o)[0];
      }
    });
  }
  function n(i, s, o, u) {
    var c = [], d = [], m = Math.min(s[o].low, s[u].low), p = Math.max(s[o].lim, s[u].lim), x, b;
    x = o;
    do
      x = i.parent(x), c.push(x);
    while (x && (s[x].low > m || p > s[x].lim));
    for (b = x, x = u; (x = i.parent(x)) !== b; )
      d.push(x);
    return { path: c.concat(d.reverse()), lca: b };
  }
  function r(i) {
    var s = {}, o = 0;
    function u(c) {
      var d = o;
      e.forEach(i.children(c), u), s[c] = { low: d, lim: o++ };
    }
    return e.forEach(i.children(), u), s;
  }
  return z3;
}
var L3, NM;
function _fe() {
  if (NM) return L3;
  NM = 1;
  var e = cr(), t = Ua();
  L3 = {
    run: n,
    cleanup: o
  };
  function n(u) {
    var c = t.addDummyNode(u, "root", {}, "_root"), d = i(u), m = e.max(e.values(d)) - 1, p = 2 * m + 1;
    u.graph().nestingRoot = c, e.forEach(u.edges(), function(b) {
      u.edge(b).minlen *= p;
    });
    var x = s(u) + 1;
    e.forEach(u.children(), function(b) {
      r(u, c, p, x, m, d, b);
    }), u.graph().nodeRankFactor = p;
  }
  function r(u, c, d, m, p, x, b) {
    var S = u.children(b);
    if (!S.length) {
      b !== c && u.setEdge(c, b, { weight: 0, minlen: d });
      return;
    }
    var k = t.addBorderNode(u, "_bt"), A = t.addBorderNode(u, "_bb"), T = u.node(b);
    u.setParent(k, b), T.borderTop = k, u.setParent(A, b), T.borderBottom = A, e.forEach(S, function(M) {
      r(u, c, d, m, p, x, M);
      var j = u.node(M), D = j.borderTop ? j.borderTop : M, z = j.borderBottom ? j.borderBottom : M, I = j.borderTop ? m : 2 * m, L = D !== z ? 1 : p - x[b] + 1;
      u.setEdge(k, D, {
        weight: I,
        minlen: L,
        nestingEdge: !0
      }), u.setEdge(z, A, {
        weight: I,
        minlen: L,
        nestingEdge: !0
      });
    }), u.parent(b) || u.setEdge(c, k, { weight: 0, minlen: p + x[b] });
  }
  function i(u) {
    var c = {};
    function d(m, p) {
      var x = u.children(m);
      x && x.length && e.forEach(x, function(b) {
        d(b, p + 1);
      }), c[m] = p;
    }
    return e.forEach(u.children(), function(m) {
      d(m, 1);
    }), c;
  }
  function s(u) {
    return e.reduce(u.edges(), function(c, d) {
      return c + u.edge(d).weight;
    }, 0);
  }
  function o(u) {
    var c = u.graph();
    u.removeNode(c.nestingRoot), delete c.nestingRoot, e.forEach(u.edges(), function(d) {
      var m = u.edge(d);
      m.nestingEdge && u.removeEdge(d);
    });
  }
  return L3;
}
var B3, AM;
function Sfe() {
  if (AM) return B3;
  AM = 1;
  var e = cr(), t = Ua();
  B3 = n;
  function n(i) {
    function s(o) {
      var u = i.children(o), c = i.node(o);
      if (u.length && e.forEach(u, s), e.has(c, "minRank")) {
        c.borderLeft = [], c.borderRight = [];
        for (var d = c.minRank, m = c.maxRank + 1; d < m; ++d)
          r(i, "borderLeft", "_bl", o, c, d), r(i, "borderRight", "_br", o, c, d);
      }
    }
    e.forEach(i.children(), s);
  }
  function r(i, s, o, u, c, d) {
    var m = { width: 0, height: 0, rank: d, borderType: s }, p = c[s][d - 1], x = t.addDummyNode(i, "border", m, o);
    c[s][d] = x, i.setParent(x, u), p && i.setEdge(p, x, { weight: 1 });
  }
  return B3;
}
var q3, jM;
function Cfe() {
  if (jM) return q3;
  jM = 1;
  var e = cr();
  q3 = {
    adjust: t,
    undo: n
  };
  function t(d) {
    var m = d.graph().rankdir.toLowerCase();
    (m === "lr" || m === "rl") && r(d);
  }
  function n(d) {
    var m = d.graph().rankdir.toLowerCase();
    (m === "bt" || m === "rl") && s(d), (m === "lr" || m === "rl") && (u(d), r(d));
  }
  function r(d) {
    e.forEach(d.nodes(), function(m) {
      i(d.node(m));
    }), e.forEach(d.edges(), function(m) {
      i(d.edge(m));
    });
  }
  function i(d) {
    var m = d.width;
    d.width = d.height, d.height = m;
  }
  function s(d) {
    e.forEach(d.nodes(), function(m) {
      o(d.node(m));
    }), e.forEach(d.edges(), function(m) {
      var p = d.edge(m);
      e.forEach(p.points, o), e.has(p, "y") && o(p);
    });
  }
  function o(d) {
    d.y = -d.y;
  }
  function u(d) {
    e.forEach(d.nodes(), function(m) {
      c(d.node(m));
    }), e.forEach(d.edges(), function(m) {
      var p = d.edge(m);
      e.forEach(p.points, c), e.has(p, "x") && c(p);
    });
  }
  function c(d) {
    var m = d.x;
    d.x = d.y, d.y = m;
  }
  return q3;
}
var F3, MM;
function Efe() {
  if (MM) return F3;
  MM = 1;
  var e = cr();
  F3 = t;
  function t(n) {
    var r = {}, i = e.filter(n.nodes(), function(d) {
      return !n.children(d).length;
    }), s = e.max(e.map(i, function(d) {
      return n.node(d).rank;
    })), o = e.map(e.range(s + 1), function() {
      return [];
    });
    function u(d) {
      if (!e.has(r, d)) {
        r[d] = !0;
        var m = n.node(d);
        o[m.rank].push(d), e.forEach(n.successors(d), u);
      }
    }
    var c = e.sortBy(i, function(d) {
      return n.node(d).rank;
    });
    return e.forEach(c, u), o;
  }
  return F3;
}
var U3, RM;
function kfe() {
  if (RM) return U3;
  RM = 1;
  var e = cr();
  U3 = t;
  function t(r, i) {
    for (var s = 0, o = 1; o < i.length; ++o)
      s += n(r, i[o - 1], i[o]);
    return s;
  }
  function n(r, i, s) {
    for (var o = e.zipObject(
      s,
      e.map(s, function(x, b) {
        return b;
      })
    ), u = e.flatten(e.map(i, function(x) {
      return e.sortBy(e.map(r.outEdges(x), function(b) {
        return { pos: o[b.w], weight: r.edge(b).weight };
      }), "pos");
    }), !0), c = 1; c < s.length; ) c <<= 1;
    var d = 2 * c - 1;
    c -= 1;
    var m = e.map(new Array(d), function() {
      return 0;
    }), p = 0;
    return e.forEach(u.forEach(function(x) {
      var b = x.pos + c;
      m[b] += x.weight;
      for (var S = 0; b > 0; )
        b % 2 && (S += m[b + 1]), b = b - 1 >> 1, m[b] += x.weight;
      p += x.weight * S;
    })), p;
  }
  return U3;
}
var $3, OM;
function Tfe() {
  if (OM) return $3;
  OM = 1;
  var e = cr();
  $3 = t;
  function t(n, r) {
    return e.map(r, function(i) {
      var s = n.inEdges(i);
      if (s.length) {
        var o = e.reduce(s, function(u, c) {
          var d = n.edge(c), m = n.node(c.v);
          return {
            sum: u.sum + d.weight * m.order,
            weight: u.weight + d.weight
          };
        }, { sum: 0, weight: 0 });
        return {
          v: i,
          barycenter: o.sum / o.weight,
          weight: o.weight
        };
      } else
        return { v: i };
    });
  }
  return $3;
}
var V3, DM;
function Nfe() {
  if (DM) return V3;
  DM = 1;
  var e = cr();
  V3 = t;
  function t(i, s) {
    var o = {};
    e.forEach(i, function(c, d) {
      var m = o[c.v] = {
        indegree: 0,
        in: [],
        out: [],
        vs: [c.v],
        i: d
      };
      e.isUndefined(c.barycenter) || (m.barycenter = c.barycenter, m.weight = c.weight);
    }), e.forEach(s.edges(), function(c) {
      var d = o[c.v], m = o[c.w];
      !e.isUndefined(d) && !e.isUndefined(m) && (m.indegree++, d.out.push(o[c.w]));
    });
    var u = e.filter(o, function(c) {
      return !c.indegree;
    });
    return n(u);
  }
  function n(i) {
    var s = [];
    function o(d) {
      return function(m) {
        m.merged || (e.isUndefined(m.barycenter) || e.isUndefined(d.barycenter) || m.barycenter >= d.barycenter) && r(d, m);
      };
    }
    function u(d) {
      return function(m) {
        m.in.push(d), --m.indegree === 0 && i.push(m);
      };
    }
    for (; i.length; ) {
      var c = i.pop();
      s.push(c), e.forEach(c.in.reverse(), o(c)), e.forEach(c.out, u(c));
    }
    return e.map(
      e.filter(s, function(d) {
        return !d.merged;
      }),
      function(d) {
        return e.pick(d, ["vs", "i", "barycenter", "weight"]);
      }
    );
  }
  function r(i, s) {
    var o = 0, u = 0;
    i.weight && (o += i.barycenter * i.weight, u += i.weight), s.weight && (o += s.barycenter * s.weight, u += s.weight), i.vs = s.vs.concat(i.vs), i.barycenter = o / u, i.weight = u, i.i = Math.min(s.i, i.i), s.merged = !0;
  }
  return V3;
}
var H3, IM;
function Afe() {
  if (IM) return H3;
  IM = 1;
  var e = cr(), t = Ua();
  H3 = n;
  function n(s, o) {
    var u = t.partition(s, function(k) {
      return e.has(k, "barycenter");
    }), c = u.lhs, d = e.sortBy(u.rhs, function(k) {
      return -k.i;
    }), m = [], p = 0, x = 0, b = 0;
    c.sort(i(!!o)), b = r(m, d, b), e.forEach(c, function(k) {
      b += k.vs.length, m.push(k.vs), p += k.barycenter * k.weight, x += k.weight, b = r(m, d, b);
    });
    var S = { vs: e.flatten(m, !0) };
    return x && (S.barycenter = p / x, S.weight = x), S;
  }
  function r(s, o, u) {
    for (var c; o.length && (c = e.last(o)).i <= u; )
      o.pop(), s.push(c.vs), u++;
    return u;
  }
  function i(s) {
    return function(o, u) {
      return o.barycenter < u.barycenter ? -1 : o.barycenter > u.barycenter ? 1 : s ? u.i - o.i : o.i - u.i;
    };
  }
  return H3;
}
var G3, PM;
function jfe() {
  if (PM) return G3;
  PM = 1;
  var e = cr(), t = Tfe(), n = Nfe(), r = Afe();
  G3 = i;
  function i(u, c, d, m) {
    var p = u.children(c), x = u.node(c), b = x ? x.borderLeft : void 0, S = x ? x.borderRight : void 0, k = {};
    b && (p = e.filter(p, function(z) {
      return z !== b && z !== S;
    }));
    var A = t(u, p);
    e.forEach(A, function(z) {
      if (u.children(z.v).length) {
        var I = i(u, z.v, d, m);
        k[z.v] = I, e.has(I, "barycenter") && o(z, I);
      }
    });
    var T = n(A, d);
    s(T, k);
    var M = r(T, m);
    if (b && (M.vs = e.flatten([b, M.vs, S], !0), u.predecessors(b).length)) {
      var j = u.node(u.predecessors(b)[0]), D = u.node(u.predecessors(S)[0]);
      e.has(M, "barycenter") || (M.barycenter = 0, M.weight = 0), M.barycenter = (M.barycenter * M.weight + j.order + D.order) / (M.weight + 2), M.weight += 2;
    }
    return M;
  }
  function s(u, c) {
    e.forEach(u, function(d) {
      d.vs = e.flatten(d.vs.map(function(m) {
        return c[m] ? c[m].vs : m;
      }), !0);
    });
  }
  function o(u, c) {
    e.isUndefined(u.barycenter) ? (u.barycenter = c.barycenter, u.weight = c.weight) : (u.barycenter = (u.barycenter * u.weight + c.barycenter * c.weight) / (u.weight + c.weight), u.weight += c.weight);
  }
  return G3;
}
var K3, zM;
function Mfe() {
  if (zM) return K3;
  zM = 1;
  var e = cr(), t = Ro().Graph;
  K3 = n;
  function n(i, s, o) {
    var u = r(i), c = new t({ compound: !0 }).setGraph({ root: u }).setDefaultNodeLabel(function(d) {
      return i.node(d);
    });
    return e.forEach(i.nodes(), function(d) {
      var m = i.node(d), p = i.parent(d);
      (m.rank === s || m.minRank <= s && s <= m.maxRank) && (c.setNode(d), c.setParent(d, p || u), e.forEach(i[o](d), function(x) {
        var b = x.v === d ? x.w : x.v, S = c.edge(b, d), k = e.isUndefined(S) ? 0 : S.weight;
        c.setEdge(b, d, { weight: i.edge(x).weight + k });
      }), e.has(m, "minRank") && c.setNode(d, {
        borderLeft: m.borderLeft[s],
        borderRight: m.borderRight[s]
      }));
    }), c;
  }
  function r(i) {
    for (var s; i.hasNode(s = e.uniqueId("_root")); ) ;
    return s;
  }
  return K3;
}
var Y3, LM;
function Rfe() {
  if (LM) return Y3;
  LM = 1;
  var e = cr();
  Y3 = t;
  function t(n, r, i) {
    var s = {}, o;
    e.forEach(i, function(u) {
      for (var c = n.parent(u), d, m; c; ) {
        if (d = n.parent(c), d ? (m = s[d], s[d] = c) : (m = o, o = c), m && m !== c) {
          r.setEdge(m, c);
          return;
        }
        c = d;
      }
    });
  }
  return Y3;
}
var W3, BM;
function Ofe() {
  if (BM) return W3;
  BM = 1;
  var e = cr(), t = Efe(), n = kfe(), r = jfe(), i = Mfe(), s = Rfe(), o = Ro().Graph, u = Ua();
  W3 = c;
  function c(x) {
    var b = u.maxRank(x), S = d(x, e.range(1, b + 1), "inEdges"), k = d(x, e.range(b - 1, -1, -1), "outEdges"), A = t(x);
    p(x, A);
    for (var T = Number.POSITIVE_INFINITY, M, j = 0, D = 0; D < 4; ++j, ++D) {
      m(j % 2 ? S : k, j % 4 >= 2), A = u.buildLayerMatrix(x);
      var z = n(x, A);
      z < T && (D = 0, M = e.cloneDeep(A), T = z);
    }
    p(x, M);
  }
  function d(x, b, S) {
    return e.map(b, function(k) {
      return i(x, k, S);
    });
  }
  function m(x, b) {
    var S = new o();
    e.forEach(x, function(k) {
      var A = k.graph().root, T = r(k, A, S, b);
      e.forEach(T.vs, function(M, j) {
        k.node(M).order = j;
      }), s(k, S, T.vs);
    });
  }
  function p(x, b) {
    e.forEach(b, function(S) {
      e.forEach(S, function(k, A) {
        x.node(k).order = A;
      });
    });
  }
  return W3;
}
var X3, qM;
function Dfe() {
  if (qM) return X3;
  qM = 1;
  var e = cr(), t = Ro().Graph, n = Ua();
  X3 = {
    positionX: S,
    findType1Conflicts: r,
    findType2Conflicts: i,
    addConflict: o,
    hasConflict: u,
    verticalAlignment: c,
    horizontalCompaction: d,
    alignCoordinates: x,
    findSmallestWidthAlignment: p,
    balance: b
  };
  function r(T, M) {
    var j = {};
    function D(z, I) {
      var L = 0, K = 0, ne = z.length, Y = e.last(I);
      return e.forEach(I, function(H, Z) {
        var me = s(T, H), Q = me ? T.node(me).order : ne;
        (me || H === Y) && (e.forEach(I.slice(K, Z + 1), function(se) {
          e.forEach(T.predecessors(se), function(J) {
            var ue = T.node(J), de = ue.order;
            (de < L || Q < de) && !(ue.dummy && T.node(se).dummy) && o(j, J, se);
          });
        }), K = Z + 1, L = Q);
      }), I;
    }
    return e.reduce(M, D), j;
  }
  function i(T, M) {
    var j = {};
    function D(I, L, K, ne, Y) {
      var H;
      e.forEach(e.range(L, K), function(Z) {
        H = I[Z], T.node(H).dummy && e.forEach(T.predecessors(H), function(me) {
          var Q = T.node(me);
          Q.dummy && (Q.order < ne || Q.order > Y) && o(j, me, H);
        });
      });
    }
    function z(I, L) {
      var K = -1, ne, Y = 0;
      return e.forEach(L, function(H, Z) {
        if (T.node(H).dummy === "border") {
          var me = T.predecessors(H);
          me.length && (ne = T.node(me[0]).order, D(L, Y, Z, K, ne), Y = Z, K = ne);
        }
        D(L, Y, L.length, ne, I.length);
      }), L;
    }
    return e.reduce(M, z), j;
  }
  function s(T, M) {
    if (T.node(M).dummy)
      return e.find(T.predecessors(M), function(j) {
        return T.node(j).dummy;
      });
  }
  function o(T, M, j) {
    if (M > j) {
      var D = M;
      M = j, j = D;
    }
    var z = T[M];
    z || (T[M] = z = {}), z[j] = !0;
  }
  function u(T, M, j) {
    if (M > j) {
      var D = M;
      M = j, j = D;
    }
    return e.has(T[M], j);
  }
  function c(T, M, j, D) {
    var z = {}, I = {}, L = {};
    return e.forEach(M, function(K) {
      e.forEach(K, function(ne, Y) {
        z[ne] = ne, I[ne] = ne, L[ne] = Y;
      });
    }), e.forEach(M, function(K) {
      var ne = -1;
      e.forEach(K, function(Y) {
        var H = D(Y);
        if (H.length) {
          H = e.sortBy(H, function(J) {
            return L[J];
          });
          for (var Z = (H.length - 1) / 2, me = Math.floor(Z), Q = Math.ceil(Z); me <= Q; ++me) {
            var se = H[me];
            I[Y] === Y && ne < L[se] && !u(j, Y, se) && (I[se] = Y, I[Y] = z[Y] = z[se], ne = L[se]);
          }
        }
      });
    }), { root: z, align: I };
  }
  function d(T, M, j, D, z) {
    var I = {}, L = m(T, M, j, z), K = z ? "borderLeft" : "borderRight";
    function ne(Z, me) {
      for (var Q = L.nodes(), se = Q.pop(), J = {}; se; )
        J[se] ? Z(se) : (J[se] = !0, Q.push(se), Q = Q.concat(me(se))), se = Q.pop();
    }
    function Y(Z) {
      I[Z] = L.inEdges(Z).reduce(function(me, Q) {
        return Math.max(me, I[Q.v] + L.edge(Q));
      }, 0);
    }
    function H(Z) {
      var me = L.outEdges(Z).reduce(function(se, J) {
        return Math.min(se, I[J.w] - L.edge(J));
      }, Number.POSITIVE_INFINITY), Q = T.node(Z);
      me !== Number.POSITIVE_INFINITY && Q.borderType !== K && (I[Z] = Math.max(I[Z], me));
    }
    return ne(Y, L.predecessors.bind(L)), ne(H, L.successors.bind(L)), e.forEach(D, function(Z) {
      I[Z] = I[j[Z]];
    }), I;
  }
  function m(T, M, j, D) {
    var z = new t(), I = T.graph(), L = k(I.nodesep, I.edgesep, D);
    return e.forEach(M, function(K) {
      var ne;
      e.forEach(K, function(Y) {
        var H = j[Y];
        if (z.setNode(H), ne) {
          var Z = j[ne], me = z.edge(Z, H);
          z.setEdge(Z, H, Math.max(L(T, Y, ne), me || 0));
        }
        ne = Y;
      });
    }), z;
  }
  function p(T, M) {
    return e.minBy(e.values(M), function(j) {
      var D = Number.NEGATIVE_INFINITY, z = Number.POSITIVE_INFINITY;
      return e.forIn(j, function(I, L) {
        var K = A(T, L) / 2;
        D = Math.max(I + K, D), z = Math.min(I - K, z);
      }), D - z;
    });
  }
  function x(T, M) {
    var j = e.values(M), D = e.min(j), z = e.max(j);
    e.forEach(["u", "d"], function(I) {
      e.forEach(["l", "r"], function(L) {
        var K = I + L, ne = T[K], Y;
        if (ne !== M) {
          var H = e.values(ne);
          Y = L === "l" ? D - e.min(H) : z - e.max(H), Y && (T[K] = e.mapValues(ne, function(Z) {
            return Z + Y;
          }));
        }
      });
    });
  }
  function b(T, M) {
    return e.mapValues(T.ul, function(j, D) {
      if (M)
        return T[M.toLowerCase()][D];
      var z = e.sortBy(e.map(T, D));
      return (z[1] + z[2]) / 2;
    });
  }
  function S(T) {
    var M = n.buildLayerMatrix(T), j = e.merge(
      r(T, M),
      i(T, M)
    ), D = {}, z;
    e.forEach(["u", "d"], function(L) {
      z = L === "u" ? M : e.values(M).reverse(), e.forEach(["l", "r"], function(K) {
        K === "r" && (z = e.map(z, function(Z) {
          return e.values(Z).reverse();
        }));
        var ne = (L === "u" ? T.predecessors : T.successors).bind(T), Y = c(T, z, j, ne), H = d(
          T,
          z,
          Y.root,
          Y.align,
          K === "r"
        );
        K === "r" && (H = e.mapValues(H, function(Z) {
          return -Z;
        })), D[L + K] = H;
      });
    });
    var I = p(T, D);
    return x(D, I), b(D, T.graph().align);
  }
  function k(T, M, j) {
    return function(D, z, I) {
      var L = D.node(z), K = D.node(I), ne = 0, Y;
      if (ne += L.width / 2, e.has(L, "labelpos"))
        switch (L.labelpos.toLowerCase()) {
          case "l":
            Y = -L.width / 2;
            break;
          case "r":
            Y = L.width / 2;
            break;
        }
      if (Y && (ne += j ? Y : -Y), Y = 0, ne += (L.dummy ? M : T) / 2, ne += (K.dummy ? M : T) / 2, ne += K.width / 2, e.has(K, "labelpos"))
        switch (K.labelpos.toLowerCase()) {
          case "l":
            Y = K.width / 2;
            break;
          case "r":
            Y = -K.width / 2;
            break;
        }
      return Y && (ne += j ? Y : -Y), Y = 0, ne;
    };
  }
  function A(T, M) {
    return T.node(M).width;
  }
  return X3;
}
var Q3, FM;
function Ife() {
  if (FM) return Q3;
  FM = 1;
  var e = cr(), t = Ua(), n = Dfe().positionX;
  Q3 = r;
  function r(s) {
    s = t.asNonCompoundGraph(s), i(s), e.forEach(n(s), function(o, u) {
      s.node(u).x = o;
    });
  }
  function i(s) {
    var o = t.buildLayerMatrix(s), u = s.graph().ranksep, c = 0;
    e.forEach(o, function(d) {
      var m = e.max(e.map(d, function(p) {
        return s.node(p).height;
      }));
      e.forEach(d, function(p) {
        s.node(p).y = c + m / 2;
      }), c += m + u;
    });
  }
  return Q3;
}
var Z3, UM;
function Pfe() {
  if (UM) return Z3;
  UM = 1;
  var e = cr(), t = yfe(), n = vfe(), r = bfe(), i = Ua().normalizeRanks, s = wfe(), o = Ua().removeEmptyRanks, u = _fe(), c = Sfe(), d = Cfe(), m = Ofe(), p = Ife(), x = Ua(), b = Ro().Graph;
  Z3 = S;
  function S(le, xe) {
    var Se = xe && xe.debugTiming ? x.time : x.notime;
    Se("layout", function() {
      var Oe = Se("  buildLayoutGraph", function() {
        return ne(le);
      });
      Se("  runLayout", function() {
        k(Oe, Se);
      }), Se("  updateInputGraph", function() {
        A(le, Oe);
      });
    });
  }
  function k(le, xe) {
    xe("    makeSpaceForEdgeLabels", function() {
      Y(le);
    }), xe("    removeSelfEdges", function() {
      ce(le);
    }), xe("    acyclic", function() {
      t.run(le);
    }), xe("    nestingGraph.run", function() {
      u.run(le);
    }), xe("    rank", function() {
      r(x.asNonCompoundGraph(le));
    }), xe("    injectEdgeLabelProxies", function() {
      H(le);
    }), xe("    removeEmptyRanks", function() {
      o(le);
    }), xe("    nestingGraph.cleanup", function() {
      u.cleanup(le);
    }), xe("    normalizeRanks", function() {
      i(le);
    }), xe("    assignRankMinMax", function() {
      Z(le);
    }), xe("    removeEdgeLabelProxies", function() {
      me(le);
    }), xe("    normalize.run", function() {
      n.run(le);
    }), xe("    parentDummyChains", function() {
      s(le);
    }), xe("    addBorderSegments", function() {
      c(le);
    }), xe("    order", function() {
      m(le);
    }), xe("    insertSelfEdges", function() {
      W(le);
    }), xe("    adjustCoordinateSystem", function() {
      d.adjust(le);
    }), xe("    position", function() {
      p(le);
    }), xe("    positionSelfEdges", function() {
      $(le);
    }), xe("    removeBorderNodes", function() {
      de(le);
    }), xe("    normalize.undo", function() {
      n.undo(le);
    }), xe("    fixupEdgeLabelCoords", function() {
      J(le);
    }), xe("    undoCoordinateSystem", function() {
      d.undo(le);
    }), xe("    translateGraph", function() {
      Q(le);
    }), xe("    assignNodeIntersects", function() {
      se(le);
    }), xe("    reversePoints", function() {
      ue(le);
    }), xe("    acyclic.undo", function() {
      t.undo(le);
    });
  }
  function A(le, xe) {
    e.forEach(le.nodes(), function(Se) {
      var Oe = le.node(Se), Be = xe.node(Se);
      Oe && (Oe.x = Be.x, Oe.y = Be.y, xe.children(Se).length && (Oe.width = Be.width, Oe.height = Be.height));
    }), e.forEach(le.edges(), function(Se) {
      var Oe = le.edge(Se), Be = xe.edge(Se);
      Oe.points = Be.points, e.has(Be, "x") && (Oe.x = Be.x, Oe.y = Be.y);
    }), le.graph().width = xe.graph().width, le.graph().height = xe.graph().height;
  }
  var T = ["nodesep", "edgesep", "ranksep", "marginx", "marginy"], M = { ranksep: 50, edgesep: 20, nodesep: 50, rankdir: "tb" }, j = ["acyclicer", "ranker", "rankdir", "align"], D = ["width", "height"], z = { width: 0, height: 0 }, I = ["minlen", "weight", "width", "height", "labeloffset"], L = {
    minlen: 1,
    weight: 1,
    width: 0,
    height: 0,
    labeloffset: 10,
    labelpos: "r"
  }, K = ["labelpos"];
  function ne(le) {
    var xe = new b({ multigraph: !0, compound: !0 }), Se = G(le.graph());
    return xe.setGraph(e.merge(
      {},
      M,
      fe(Se, T),
      e.pick(Se, j)
    )), e.forEach(le.nodes(), function(Oe) {
      var Be = G(le.node(Oe));
      xe.setNode(Oe, e.defaults(fe(Be, D), z)), xe.setParent(Oe, le.parent(Oe));
    }), e.forEach(le.edges(), function(Oe) {
      var Be = G(le.edge(Oe));
      xe.setEdge(Oe, e.merge(
        {},
        L,
        fe(Be, I),
        e.pick(Be, K)
      ));
    }), xe;
  }
  function Y(le) {
    var xe = le.graph();
    xe.ranksep /= 2, e.forEach(le.edges(), function(Se) {
      var Oe = le.edge(Se);
      Oe.minlen *= 2, Oe.labelpos.toLowerCase() !== "c" && (xe.rankdir === "TB" || xe.rankdir === "BT" ? Oe.width += Oe.labeloffset : Oe.height += Oe.labeloffset);
    });
  }
  function H(le) {
    e.forEach(le.edges(), function(xe) {
      var Se = le.edge(xe);
      if (Se.width && Se.height) {
        var Oe = le.node(xe.v), Be = le.node(xe.w), Re = { rank: (Be.rank - Oe.rank) / 2 + Oe.rank, e: xe };
        x.addDummyNode(le, "edge-proxy", Re, "_ep");
      }
    });
  }
  function Z(le) {
    var xe = 0;
    e.forEach(le.nodes(), function(Se) {
      var Oe = le.node(Se);
      Oe.borderTop && (Oe.minRank = le.node(Oe.borderTop).rank, Oe.maxRank = le.node(Oe.borderBottom).rank, xe = e.max(xe, Oe.maxRank));
    }), le.graph().maxRank = xe;
  }
  function me(le) {
    e.forEach(le.nodes(), function(xe) {
      var Se = le.node(xe);
      Se.dummy === "edge-proxy" && (le.edge(Se.e).labelRank = Se.rank, le.removeNode(xe));
    });
  }
  function Q(le) {
    var xe = Number.POSITIVE_INFINITY, Se = 0, Oe = Number.POSITIVE_INFINITY, Be = 0, Re = le.graph(), ft = Re.marginx || 0, Ie = Re.marginy || 0;
    function Ne(Ue) {
      var et = Ue.x, tt = Ue.y, st = Ue.width, dt = Ue.height;
      xe = Math.min(xe, et - st / 2), Se = Math.max(Se, et + st / 2), Oe = Math.min(Oe, tt - dt / 2), Be = Math.max(Be, tt + dt / 2);
    }
    e.forEach(le.nodes(), function(Ue) {
      Ne(le.node(Ue));
    }), e.forEach(le.edges(), function(Ue) {
      var et = le.edge(Ue);
      e.has(et, "x") && Ne(et);
    }), xe -= ft, Oe -= Ie, e.forEach(le.nodes(), function(Ue) {
      var et = le.node(Ue);
      et.x -= xe, et.y -= Oe;
    }), e.forEach(le.edges(), function(Ue) {
      var et = le.edge(Ue);
      e.forEach(et.points, function(tt) {
        tt.x -= xe, tt.y -= Oe;
      }), e.has(et, "x") && (et.x -= xe), e.has(et, "y") && (et.y -= Oe);
    }), Re.width = Se - xe + ft, Re.height = Be - Oe + Ie;
  }
  function se(le) {
    e.forEach(le.edges(), function(xe) {
      var Se = le.edge(xe), Oe = le.node(xe.v), Be = le.node(xe.w), Re, ft;
      Se.points ? (Re = Se.points[0], ft = Se.points[Se.points.length - 1]) : (Se.points = [], Re = Be, ft = Oe), Se.points.unshift(x.intersectRect(Oe, Re)), Se.points.push(x.intersectRect(Be, ft));
    });
  }
  function J(le) {
    e.forEach(le.edges(), function(xe) {
      var Se = le.edge(xe);
      if (e.has(Se, "x"))
        switch ((Se.labelpos === "l" || Se.labelpos === "r") && (Se.width -= Se.labeloffset), Se.labelpos) {
          case "l":
            Se.x -= Se.width / 2 + Se.labeloffset;
            break;
          case "r":
            Se.x += Se.width / 2 + Se.labeloffset;
            break;
        }
    });
  }
  function ue(le) {
    e.forEach(le.edges(), function(xe) {
      var Se = le.edge(xe);
      Se.reversed && Se.points.reverse();
    });
  }
  function de(le) {
    e.forEach(le.nodes(), function(xe) {
      if (le.children(xe).length) {
        var Se = le.node(xe), Oe = le.node(Se.borderTop), Be = le.node(Se.borderBottom), Re = le.node(e.last(Se.borderLeft)), ft = le.node(e.last(Se.borderRight));
        Se.width = Math.abs(ft.x - Re.x), Se.height = Math.abs(Be.y - Oe.y), Se.x = Re.x + Se.width / 2, Se.y = Oe.y + Se.height / 2;
      }
    }), e.forEach(le.nodes(), function(xe) {
      le.node(xe).dummy === "border" && le.removeNode(xe);
    });
  }
  function ce(le) {
    e.forEach(le.edges(), function(xe) {
      if (xe.v === xe.w) {
        var Se = le.node(xe.v);
        Se.selfEdges || (Se.selfEdges = []), Se.selfEdges.push({ e: xe, label: le.edge(xe) }), le.removeEdge(xe);
      }
    });
  }
  function W(le) {
    var xe = x.buildLayerMatrix(le);
    e.forEach(xe, function(Se) {
      var Oe = 0;
      e.forEach(Se, function(Be, Re) {
        var ft = le.node(Be);
        ft.order = Re + Oe, e.forEach(ft.selfEdges, function(Ie) {
          x.addDummyNode(le, "selfedge", {
            width: Ie.label.width,
            height: Ie.label.height,
            rank: ft.rank,
            order: Re + ++Oe,
            e: Ie.e,
            label: Ie.label
          }, "_se");
        }), delete ft.selfEdges;
      });
    });
  }
  function $(le) {
    e.forEach(le.nodes(), function(xe) {
      var Se = le.node(xe);
      if (Se.dummy === "selfedge") {
        var Oe = le.node(Se.e.v), Be = Oe.x + Oe.width / 2, Re = Oe.y, ft = Se.x - Be, Ie = Oe.height / 2;
        le.setEdge(Se.e, Se.label), le.removeNode(xe), Se.label.points = [
          { x: Be + 2 * ft / 3, y: Re - Ie },
          { x: Be + 5 * ft / 6, y: Re - Ie },
          { x: Be + ft, y: Re },
          { x: Be + 5 * ft / 6, y: Re + Ie },
          { x: Be + 2 * ft / 3, y: Re + Ie }
        ], Se.label.x = Se.x, Se.label.y = Se.y;
      }
    });
  }
  function fe(le, xe) {
    return e.mapValues(e.pick(le, xe), Number);
  }
  function G(le) {
    var xe = {};
    return e.forEach(le, function(Se, Oe) {
      xe[Oe.toLowerCase()] = Se;
    }), xe;
  }
  return Z3;
}
var J3, $M;
function zfe() {
  if ($M) return J3;
  $M = 1;
  var e = cr(), t = Ua(), n = Ro().Graph;
  J3 = {
    debugOrdering: r
  };
  function r(i) {
    var s = t.buildLayerMatrix(i), o = new n({ compound: !0, multigraph: !0 }).setGraph({});
    return e.forEach(i.nodes(), function(u) {
      o.setNode(u, { label: u }), o.setParent(u, "layer" + i.node(u).rank);
    }), e.forEach(i.edges(), function(u) {
      o.setEdge(u.v, u.w, {}, u.name);
    }), e.forEach(s, function(u, c) {
      var d = "layer" + c;
      o.setNode(d, { rank: "same" }), e.reduce(u, function(m, p) {
        return o.setEdge(m, p, { style: "invis" }), p;
      });
    }), o;
  }
  return J3;
}
var e5, VM;
function Lfe() {
  return VM || (VM = 1, e5 = "0.8.5"), e5;
}
var t5, HM;
function Bfe() {
  return HM || (HM = 1, t5 = {
    graphlib: Ro(),
    layout: Pfe(),
    debug: zfe(),
    util: {
      time: Ua().time,
      notime: Ua().notime
    },
    version: Lfe()
  }), t5;
}
var qfe = Bfe();
const GM = /* @__PURE__ */ Uc(qfe);
function Ffe(e, t, n = "TB") {
  const r = new GM.graphlib.Graph();
  r.setDefaultEdgeLabel(() => ({}));
  const i = n === "LR";
  return r.setGraph({
    rankdir: n,
    nodesep: 50,
    // 
    ranksep: 80,
    // 
    marginx: 20,
    marginy: 20
  }), e.forEach((o) => {
    const u = o.type === "event" ? 250 : 150, c = o.type === "event" ? 100 : 60;
    r.setNode(o.id, { width: u, height: c });
  }), t.forEach((o) => {
    r.setEdge(o.source, o.target);
  }), GM.layout(r), { nodes: e.map((o) => {
    const u = r.node(o.id);
    if (!u) return o;
    const c = o.type === "event" ? 250 : 150, d = o.type === "event" ? 100 : 60;
    return {
      ...o,
      targetPosition: i ? gt.Left : gt.Top,
      sourcePosition: i ? gt.Right : gt.Bottom,
      position: {
        x: u.x - c / 2,
        y: u.y - d / 2
      }
    };
  }), edges: t };
}
const Ufe = ({ data: e }) => {
  var n;
  const t = rn((r) => r.transform[2]);
  return t < 0.15 ? /* @__PURE__ */ g.jsxs("div", { style: { width: 32, height: 32, borderRadius: "50%", backgroundColor: "#e07850", border: "2px solid #e07850", display: "flex", alignItems: "center", justifyContent: "center" }, children: [
    /* @__PURE__ */ g.jsx(Bi, { type: "target", position: gt.Top, style: { backgroundColor: "#e07850" } }),
    /* @__PURE__ */ g.jsx(Bi, { type: "source", position: gt.Bottom, style: { backgroundColor: "#e07850" } })
  ] }) : t > 1 ? /* @__PURE__ */ g.jsxs("div", { className: "w-[280px] p-3 rounded-lg border border-border bg-card shadow-md", children: [
    /* @__PURE__ */ g.jsx(Bi, { type: "target", position: gt.Top, className: "!bg-primary" }),
    /* @__PURE__ */ g.jsx("div", { className: "text-xs text-muted-foreground mb-1", children: e.time_anchor || "" }),
    /* @__PURE__ */ g.jsx("div", { className: "text-sm font-medium text-foreground mb-2 line-clamp-3", children: e.summary }),
    /* @__PURE__ */ g.jsx("div", { className: "flex flex-wrap gap-1", children: (n = e.roles) == null ? void 0 : n.map((r, i) => /* @__PURE__ */ g.jsx("span", { className: "px-1.5 py-0.5 text-xs bg-primary/10 text-primary rounded", children: r }, i)) }),
    /* @__PURE__ */ g.jsx(Bi, { type: "source", position: gt.Bottom, className: "!bg-primary" })
  ] }) : /* @__PURE__ */ g.jsxs("div", { style: { width: 220, padding: 8, borderRadius: 8, border: "1px solid #444", backgroundColor: "#2a2a2a", boxShadow: "0 1px 3px rgba(0,0,0,0.3)" }, children: [
    /* @__PURE__ */ g.jsx(Bi, { type: "target", position: gt.Top, style: { backgroundColor: "#e07850" } }),
    /* @__PURE__ */ g.jsx("div", { style: { fontSize: 11, color: "#888", marginBottom: 4, overflow: "hidden", textOverflow: "ellipsis", whiteSpace: "nowrap" }, children: e.time_anchor || "" }),
    /* @__PURE__ */ g.jsx("div", { style: { fontSize: 13, color: "#eee", display: "-webkit-box", WebkitLineClamp: 2, WebkitBoxOrient: "vertical", overflow: "hidden" }, children: e.label }),
    /* @__PURE__ */ g.jsx(Bi, { type: "source", position: gt.Bottom, style: { backgroundColor: "#e07850" } })
  ] });
}, $fe = ({ data: e }) => {
  const t = rn((n) => n.transform[2]);
  return t < 0.15 ? /* @__PURE__ */ g.jsxs("div", { style: { width: 24, height: 24, borderRadius: "50%", backgroundColor: "#555", border: "1px solid #666", display: "flex", alignItems: "center", justifyContent: "center" }, children: [
    /* @__PURE__ */ g.jsx(Bi, { type: "target", position: gt.Top, style: { backgroundColor: "#888" } }),
    /* @__PURE__ */ g.jsx(Bi, { type: "source", position: gt.Bottom, style: { backgroundColor: "#888" } })
  ] }) : t > 1 ? /* @__PURE__ */ g.jsxs("div", { className: "w-[160px] p-2 rounded-lg border border-border bg-muted/50", children: [
    /* @__PURE__ */ g.jsx(Bi, { type: "target", position: gt.Top, className: "!bg-muted-foreground" }),
    /* @__PURE__ */ g.jsx("div", { className: "text-xs text-muted-foreground uppercase", children: e.type }),
    /* @__PURE__ */ g.jsx("div", { className: "text-sm font-medium text-foreground", children: e.label }),
    /* @__PURE__ */ g.jsx("div", { className: "text-xs text-muted-foreground mt-1 line-clamp-2", children: e.description }),
    /* @__PURE__ */ g.jsx(Bi, { type: "source", position: gt.Bottom, className: "!bg-muted-foreground" })
  ] }) : /* @__PURE__ */ g.jsxs("div", { style: { width: 120, padding: 6, borderRadius: 6, border: "1px solid #555", backgroundColor: "#333" }, children: [
    /* @__PURE__ */ g.jsx(Bi, { type: "target", position: gt.Top, style: { backgroundColor: "#888" } }),
    /* @__PURE__ */ g.jsx("div", { style: { fontSize: 12, color: "#ddd", overflow: "hidden", textOverflow: "ellipsis", whiteSpace: "nowrap" }, children: e.label }),
    /* @__PURE__ */ g.jsx(Bi, { type: "source", position: gt.Bottom, style: { backgroundColor: "#888" } })
  ] });
}, Vfe = {
  event: Ufe,
  entity: $fe
}, Hfe = ({ events: e, entities: t }) => {
  const [n, r, i] = Woe([]), [s, o, u] = Xoe([]), [c, d] = F.useState(!1), m = F.useRef(null), p = F.useCallback(() => {
    const b = [], S = [];
    return e.forEach((k, A) => {
      var T, M;
      b.push({
        id: k.id,
        type: "event",
        position: { x: 0, y: A * 120 },
        data: {
          label: k.summary.substring(0, 50) + (k.summary.length > 50 ? "..." : ""),
          summary: k.summary,
          time_anchor: (T = k.structured_kv) == null ? void 0 : T.time_anchor,
          roles: (M = k.structured_kv) == null ? void 0 : M.role,
          significance: k.significance_score
        }
      }), A > 0 && S.push({
        id: `e-${e[A - 1].id}-${k.id}`,
        source: e[A - 1].id,
        target: k.id,
        type: "smoothstep",
        animated: !1,
        style: { stroke: "var(--primary)", strokeWidth: 2 },
        markerEnd: { type: S0.ArrowClosed, color: "var(--primary)" }
      });
    }), t.forEach((k, A) => {
      b.push({
        id: k.id,
        type: "entity",
        position: { x: 300 + A % 3 * 100, y: Math.floor(A / 3) * 80 },
        data: {
          label: k.name,
          type: k.type,
          description: k.description,
          profile: k.profile
        }
      });
    }), t.forEach((k) => {
      var T;
      const A = (T = k.profile) == null ? void 0 : T.relations;
      A && Array.isArray(A) && A.forEach((M) => {
        const j = t.find((D) => D.name === M.target);
        j && S.push({
          id: `rel-${k.id}-${j.id}`,
          source: k.id,
          target: j.id,
          type: "smoothstep",
          animated: !1,
          label: M.type,
          style: { stroke: "#888", strokeWidth: 1 },
          labelStyle: { fontSize: 10, fill: "#aaa" }
        });
      });
    }), e.forEach((k) => {
      var M;
      const A = ((M = k.structured_kv) == null ? void 0 : M.role) || [];
      t.filter(
        (j) => {
          var D;
          return A.includes(j.name) || ((D = j.aliases) == null ? void 0 : D.some((z) => A.includes(z)));
        }
      ).forEach((j) => {
        S.push({
          id: `co-${j.id}-${k.id}`,
          source: j.id,
          target: k.id,
          type: "smoothstep",
          animated: !1,
          style: { stroke: "var(--muted-foreground)", strokeWidth: 1, strokeDasharray: "4 2" }
        });
      });
    }), { nodes: b, edges: S };
  }, [e, t]), x = F.useCallback(() => {
    d(!0);
    const { nodes: b, edges: S } = p(), { nodes: k, edges: A } = Ffe(b, S, "TB");
    r(k), o(A), d(!1), setTimeout(() => {
      var T;
      (T = m.current) == null || T.fitView({ padding: 0.2 });
    }, 50);
  }, [p, r, o]);
  return F.useEffect(() => {
    (e.length > 0 || t.length > 0) && x();
  }, [e.length, t.length]), e.length === 0 && t.length === 0 ? /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col items-center justify-center h-full text-muted-foreground gap-4", children: [
    /* @__PURE__ */ g.jsx(oq, { size: 48, className: "opacity-20" }),
    /* @__PURE__ */ g.jsx("p", { className: "text-sm", children: "" }),
    /* @__PURE__ */ g.jsx("p", { className: "text-xs", children: "" })
  ] }) : /* @__PURE__ */ g.jsxs("div", { style: { position: "relative", width: "100%", height: "400px" }, children: [
    /* @__PURE__ */ g.jsx("div", { className: "absolute top-2 left-2 z-10 flex gap-2", children: /* @__PURE__ */ g.jsxs(
      "button",
      {
        onClick: x,
        disabled: c,
        className: "flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-md bg-card border border-border text-foreground hover:bg-accent transition-colors disabled:opacity-50",
        children: [
          /* @__PURE__ */ g.jsx(zr, { size: 12, className: c ? "animate-spin" : "" }),
          ""
        ]
      }
    ) }),
    /* @__PURE__ */ g.jsxs(
      Yoe,
      {
        nodes: n,
        edges: s,
        onNodesChange: i,
        onEdgesChange: u,
        onInit: (b) => {
          m.current = b;
        },
        nodeTypes: Vfe,
        fitView: !0,
        minZoom: 0.1,
        maxZoom: 2,
        colorMode: "dark",
        defaultEdgeOptions: {
          type: "smoothstep"
        },
        proOptions: { hideAttribution: !0 },
        children: [
          /* @__PURE__ */ g.jsx(tle, { color: "#333", gap: 20 }),
          /* @__PURE__ */ g.jsx(lle, { className: "!bg-card !border-border" }),
          /* @__PURE__ */ g.jsx(
            wle,
            {
              nodeColor: (b) => b.type === "event" ? "#e07850" : "#888",
              className: "!bg-card !border-border"
            }
          )
        ]
      }
    )
  ] });
}, KM = 768, Gfe = [
  { id: "list", label: "", icon: /* @__PURE__ */ g.jsx(fq, { size: 14 }) },
  { id: "graph", label: "", icon: /* @__PURE__ */ g.jsx(GB, { size: 14 }) }
], Kfe = () => {
  const [e, t] = F.useState([]), [n, r] = F.useState(null), [i, s] = F.useState(/* @__PURE__ */ new Set()), [o, u] = F.useState(""), [c, d] = F.useState(!0), [m, p] = F.useState(window.innerWidth < KM), [x, b] = F.useState(!1), [S, k] = F.useState("list"), [A, T] = F.useState([]), [M, j] = F.useState(/* @__PURE__ */ new Map()), D = M.size > 0, [z, I] = F.useState(!1), L = da.getState(), K = F.useRef(null);
  F.useEffect(() => {
    const $ = () => {
      p(window.innerWidth < KM);
    };
    return window.addEventListener("resize", $), () => window.removeEventListener("resize", $);
  }, []);
  const ne = async () => {
    d(!0);
    try {
      const $ = await L.getAllEvents();
      t($.sort((fe, G) => G.timestamp - fe.timestamp));
    } catch ($) {
      console.error("[MemoryStream] Failed to load events:", $);
    } finally {
      d(!1);
    }
  };
  F.useEffect(() => {
    ne(), Y();
  }, []);
  const Y = async () => {
    try {
      const $ = await L.getAllEntities();
      T($);
    } catch ($) {
      console.error("[MemoryStream] Failed to load entities:", $);
    }
  }, H = F.useMemo(() => {
    if (!o.trim()) return e;
    const $ = o.toLowerCase();
    return e.filter(
      (fe) => {
        var G, le;
        return fe.summary.toLowerCase().includes($) || ((G = fe.structured_kv.event) == null ? void 0 : G.toLowerCase().includes($)) || ((le = fe.structured_kv.role) == null ? void 0 : le.some((xe) => xe.toLowerCase().includes($)));
      }
    );
  }, [e, o]), Z = F.useMemo(() => {
    const $ = e.find((G) => G.id === n);
    if (!$) return null;
    const fe = M.get($.id);
    return fe ? { ...$, ...fe } : $;
  }, [e, n, M]), me = ($) => {
    r($), m && b(!0);
  }, Q = ($, fe) => {
    const G = new Set(i);
    fe ? G.add($) : G.delete($), s(G);
  }, se = F.useCallback(($, fe) => {
    j((G) => {
      const le = new Map(G), xe = le.get($) || {};
      return le.set($, { ...xe, ...fe }), le;
    }), t((G) => G.map(
      (le) => le.id === $ ? { ...le, ...fe } : le
    ));
  }, []), J = async () => {
    if (M.size !== 0)
      try {
        const $ = Array.from(M.entries()).map(
          ([fe, G]) => L.updateEvent(fe, G)
        );
        await Promise.all($), console.log(`[MemoryStream] Batch saved ${M.size} events`), j(/* @__PURE__ */ new Map());
      } catch ($) {
        console.error("[MemoryStream] Batch save failed:", $);
      }
  }, ue = async () => {
    const $ = rt.get("apiSettings"), fe = $ == null ? void 0 : $.vectorConfig;
    if (!fe) {
      alert(" API ");
      return;
    }
    if (confirm("")) {
      I(!0);
      try {
        Qr.setConfig(fe);
        const G = $ == null ? void 0 : $.embeddingConfig;
        G != null && G.concurrency && Qr.setConcurrency(G.concurrency), await Qr.reembedAllEvents((le, xe, Se) => {
          console.log(`[MemoryStream] Reembedding: ${le}/${xe}, errors: ${Se}`);
        }), await ne(), alert("");
      } catch (G) {
        console.error("[MemoryStream] Reembed failed:", G), alert(": " + (G.message || ""));
      } finally {
        I(!1);
      }
    }
  }, de = async ($) => {
    await L.deleteEvents([$]), t((fe) => fe.filter((G) => G.id !== $)), r(null), b(!1), j((fe) => {
      const G = new Map(fe);
      return G.delete($), G;
    });
  }, ce = async () => {
    i.size !== 0 && confirm(` ${i.size} `) && (await L.deleteEvents(Array.from(i)), t(($) => $.filter((fe) => !i.has(fe.id))), s(/* @__PURE__ */ new Set()), j(($) => {
      const fe = new Map($);
      return i.forEach((G) => fe.delete(G)), fe;
    }));
  }, W = () => {
    b(!1), m && r(null);
  };
  return m && x && Z ? /* @__PURE__ */ g.jsx(
    nC,
    {
      ref: K,
      event: Z,
      isFullScreen: !0,
      onSave: se,
      onDelete: de,
      onClose: W
    }
  ) : /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col h-full animate-in fade-in overflow-hidden", children: [
    /* @__PURE__ */ g.jsx(RE, { title: "", subtitle: "" }),
    /* @__PURE__ */ g.jsx(Jr, { className: "mb-6" }),
    /* @__PURE__ */ g.jsx(
      lx,
      {
        tabs: Gfe,
        activeTab: S,
        onChange: ($) => k($),
        actions: /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-2", children: [
          D && /* @__PURE__ */ g.jsxs(
            "button",
            {
              className: "inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-primary hover:text-primary-foreground hover:bg-primary border border-primary/50 rounded transition-colors",
              onClick: J,
              children: [
                /* @__PURE__ */ g.jsx(Lg, { size: 12 }),
                " (",
                M.size,
                ")"
              ]
            }
          ),
          /* @__PURE__ */ g.jsxs(
            "button",
            {
              onClick: ue,
              disabled: z,
              className: "inline-flex items-center gap-1.5 px-2 py-1.5 text-xs text-muted-foreground hover:text-foreground hover:bg-accent rounded transition-colors disabled:opacity-50",
              title: "",
              children: [
                /* @__PURE__ */ g.jsx(aR, { size: 12, className: z ? "animate-pulse" : "" }),
                z ? "..." : ""
              ]
            }
          ),
          /* @__PURE__ */ g.jsx(
            "button",
            {
              onClick: ne,
              className: "p-1.5 hover:bg-accent rounded-md text-muted-foreground hover:text-foreground transition-colors",
              title: "",
              children: /* @__PURE__ */ g.jsx(zr, { size: 14, className: c ? "animate-spin" : "" })
            }
          ),
          i.size > 0 && /* @__PURE__ */ g.jsxs(
            "button",
            {
              onClick: ce,
              className: "flex items-center gap-1 px-2 py-1 text-xs text-destructive hover:bg-destructive/10 rounded-md",
              children: [
                /* @__PURE__ */ g.jsx(jo, { size: 12 }),
                " (",
                i.size,
                ")"
              ]
            }
          )
        ] })
      }
    ),
    S === "list" && /* @__PURE__ */ g.jsxs(
      "div",
      {
        className: "flex flex-col overflow-hidden",
        style: {
          //  - header(~50px) - tabs(~80px) - title(~60px) - (~80px)
          height: "calc(100vh - 100px)",
          minHeight: "300px"
        },
        children: [
          /* @__PURE__ */ g.jsxs("div", { className: "relative mb-4 shrink-0", children: [
            /* @__PURE__ */ g.jsx(Ls, { size: 14, className: "absolute left-0 top-1/2 -translate-y-1/2 text-muted-foreground" }),
            /* @__PURE__ */ g.jsx(
              "input",
              {
                type: "text",
                value: o,
                onChange: ($) => u($.target.value),
                placeholder: "...",
                style: {
                  background: "transparent",
                  border: "none",
                  borderBottom: "1px solid var(--border)",
                  borderRadius: 0,
                  outline: "none",
                  padding: "8px 0 8px 24px",
                  fontSize: "14px",
                  width: "100%",
                  color: "var(--foreground)"
                },
                className: "placeholder:text-muted-foreground/40 focus:border-primary transition-colors"
              }
            )
          ] }),
          /* @__PURE__ */ g.jsxs("div", { className: "flex-1 flex gap-6 min-h-0", children: [
            /* @__PURE__ */ g.jsx("div", { className: `
                            ${m ? "w-full" : "w-[30%] min-w-[240px]"}
                            overflow-y-auto no-scrollbar
                            ${m ? "" : "border-r border-border/50 pr-4"}
                        `, children: c ? /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col items-center justify-center h-48 text-muted-foreground gap-2", children: [
              /* @__PURE__ */ g.jsx(zr, { size: 24, className: "animate-spin" }),
              /* @__PURE__ */ g.jsx("p", { className: "text-sm font-light", children: "..." })
            ] }) : H.length === 0 ? /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col items-center justify-center h-48 text-muted-foreground gap-4", children: [
              /* @__PURE__ */ g.jsx(JM, { size: 48, className: "opacity-20" }),
              /* @__PURE__ */ g.jsx("p", { className: "text-sm font-light", children: o ? "" : "" })
            ] }) : /* @__PURE__ */ g.jsx("div", { className: m ? "" : "space-y-1 pb-4", children: H.map(($) => /* @__PURE__ */ g.jsx(
              Ete,
              {
                event: $,
                isSelected: $.id === n,
                isCompact: m,
                checked: i.has($.id),
                hasChanges: M.has($.id),
                onSelect: () => me($.id),
                onCheck: (fe) => Q($.id, fe)
              },
              $.id
            )) }) }),
            !m && /* @__PURE__ */ g.jsx("div", { className: "flex-1 overflow-y-auto no-scrollbar", children: /* @__PURE__ */ g.jsx(
              nC,
              {
                ref: K,
                event: Z,
                isFullScreen: !1,
                onSave: se,
                onDelete: de,
                onClose: () => r(null)
              }
            ) })
          ] })
        ]
      }
    ),
    S === "graph" && /* @__PURE__ */ g.jsx(
      "div",
      {
        className: "flex-1 min-h-0",
        style: {
          // 
          height: "calc(100vh - 270px)",
          minHeight: "400px"
        },
        children: /* @__PURE__ */ g.jsx(Hfe, { events: e, entities: A })
      }
    )
  ] });
}, Yfe = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  MemoryStream: Kfe
}, Symbol.toStringTag, { value: "Module" })), Wfe = ({ links: e, onNavigate: t, className: n = "" }) => e.length === 0 ? null : /* @__PURE__ */ g.jsx("div", { className: `flex items-center gap-4 ${n}`, children: e.map((r) => {
  const i = r.icon || qB;
  return /* @__PURE__ */ g.jsxs(
    "button",
    {
      className: "inline-flex items-center gap-1.5 text-xs text-muted-foreground hover:text-foreground transition-colors",
      onClick: () => t(r.linkTo),
      title: r.label,
      children: [
        /* @__PURE__ */ g.jsx(i, { size: 12 }),
        /* @__PURE__ */ g.jsx("span", { children: r.label })
      ]
    },
    r.id
  );
}) }), Gv = {
  keepRecentCount: 3,
  previewEnabled: !0
};
class DL {
  constructor(t) {
    vt(this, "config");
    vt(this, "isTrimming", !1);
    this.config = { ...Gv, ...t };
  }
  /**
   * 
   */
  updateConfig(t) {
    this.config = { ...this.config, ...t };
  }
  /**
   * 
   */
  async canTrim() {
    const n = await da.getState().getAllEvents(), r = Math.max(0, n.length - this.config.keepRecentCount);
    return {
      canTrim: r >= 2,
      //  2 
      eventCount: n.length,
      pendingCount: r
    };
  }
  /**
   * 
   *  1 
   */
  async trim(t = !1) {
    if (this.isTrimming)
      return ve.warn("EventTrimmer", ""), null;
    const n = da.getState(), r = await n.getEventsToMerge(this.config.keepRecentCount);
    if (r.length < 2)
      return t && tn.info(" ( 2 )", "Engram"), null;
    this.isTrimming = !0, ve.info("EventTrimmer", "", { eventCount: r.length });
    try {
      const i = this.formatEventsForTrim(r), s = await Rd.generate({
        systemPrompt: bR,
        userPrompt: `

${i}`
      });
      if (!s.success || !s.content)
        return ve.error("EventTrimmer", "LLM ", { error: s.error }), tn.error("LLM ", "Engram"), null;
      const o = ZC.parse(s.content);
      if (!o || !o.events || o.events.length === 0)
        return ve.error("EventTrimmer", "JSON "), tn.error("", "Engram"), null;
      let u = o.events.map((b) => b.summary).join(`

`);
      if (this.config.previewEnabled)
        try {
          u = await JC.requestRevision(
            "",
            ` ${r.length} `,
            u
          );
        } catch {
          return ve.warn("EventTrimmer", ""), tn.info("", ""), null;
        }
      const c = o.events[0], d = await n.saveEvent({
        summary: u,
        structured_kv: {
          time_anchor: c.meta.time_anchor || "",
          role: this.mergeArrays(r.map((b) => b.structured_kv.role)),
          location: c.meta.location || "",
          event: "",
          logic: this.mergeArrays(r.map((b) => b.structured_kv.logic)),
          causality: "Chain"
        },
        significance_score: Math.max(...r.map((b) => b.significance_score)),
        level: 1,
        // 
        is_embedded: !1,
        //  ( Trim )
        is_archived: !1,
        // 
        source_range: {
          start_index: Math.min(...r.map((b) => {
            var S;
            return ((S = b.source_range) == null ? void 0 : S.start_index) ?? 0;
          })),
          end_index: Math.max(...r.map((b) => {
            var S;
            return ((S = b.source_range) == null ? void 0 : S.end_index) ?? 0;
          }))
        }
      }), m = r.map((b) => b.id), p = rt.get("apiSettings"), x = p == null ? void 0 : p.embeddingConfig;
      if (x != null && x.enabled && x.trigger === "with_trim") {
        ve.info("EventTrimmer", "", { count: r.length });
        try {
          await Qr.embedEvents(r), await n.markEventsAsEmbedded(m);
        } catch (b) {
          ve.error("EventTrimmer", "", { error: b }), tn.warning("", "Engram");
        }
      }
      return await n.archiveEvents(m), await ko.refreshCache(), ve.success("EventTrimmer", "", {
        merged: r.length,
        newEventId: d.id
      }), tn.success(
        ` ${r.length}  1 `,
        "Engram"
      ), {
        newEvent: d,
        deletedCount: 0,
        // V0.7: 
        sourceEventIds: m
      };
    } catch (i) {
      const s = i instanceof Error ? i.message : String(i);
      return ve.error("EventTrimmer", "", { error: s }), tn.error(`: ${s}`, "Engram "), null;
    } finally {
      this.isTrimming = !1;
    }
  }
  /**
   *  ()
   */
  formatEventsForTrim(t) {
    return t.map((n) => {
      const r = n.structured_kv;
      return `${n.summary}
Role: [${r.role.join(", ")}]
Loc: ${r.location}
Event: ${r.event}
Logic: [${r.logic.join(", ")}]
Causality: ${r.causality}
Significance: ${n.significance_score}`;
    }).join(`

---

`);
  }
  /**
   * 
   */
  mergeArrays(t) {
    const n = /* @__PURE__ */ new Set();
    for (const r of t)
      for (const i of r)
        n.add(i);
    return Array.from(n);
  }
  /**
   * 
   */
  getConfig() {
    return { ...this.config };
  }
  /**
   *  (UI )
   */
  async getStatus() {
    var k;
    const { useMemoryStore: t } = await Promise.resolve().then(() => KO), n = t.getState(), { totalTokens: r, eventCount: i } = await n.countEventTokens();
    let s = !1, o = 0, u = 0;
    const d = ((k = rt.getSummarizerSettings()) == null ? void 0 : k.trimConfig) || this.config, m = d.trigger || "token", p = d.tokenLimit || 10240, x = d.countLimit || 5;
    m === "token" ? (o = r, u = p) : (o = i, u = x), s = o >= u;
    const b = d.keepRecentCount || 3, S = Math.max(0, i - b);
    return {
      triggered: s,
      triggerType: m,
      currentValue: o,
      threshold: u,
      pendingEntryCount: S,
      isTrimming: this.isTrimming
    };
  }
}
const gv = new DL(), n5 = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  DEFAULT_TRIM_CONFIG: Gv,
  EventTrimmer: DL,
  eventTrimmer: gv
}, Symbol.toStringTag, { value: "Module" })), Xfe = [
  { id: "token", label: "Token ", icon: wB },
  { id: "count", label: "", icon: QB }
], Qfe = () => {
  const [e, t] = F.useState(null), [n, r] = F.useState(!1), [i, s] = F.useState(!1), [o, u] = F.useState({
    autoEnabled: !0,
    floorInterval: 10,
    bufferSize: 3,
    autoHide: !1
  }), [c, d] = F.useState({ ...Gv, keepRecentCount: 3 }), [m, p] = F.useState(null), [x, b] = F.useState(0), [S, k] = F.useState(0);
  F.useEffect(() => {
    A();
  }, []);
  const A = async () => {
    var Z;
    try {
      const { summarizerService: me } = await Promise.resolve().then(() => _l);
      await me.initializeForCurrentChat();
      const Q = me.getStatus();
      t(Q);
      const se = me.getConfig();
      u({
        autoEnabled: se.enabled,
        floorInterval: se.floorInterval,
        bufferSize: se.bufferSize || 3,
        autoHide: se.autoHide || !1
      });
      const J = (Z = rt.getSummarizerSettings()) == null ? void 0 : Z.trimConfig;
      J && d({ ...Gv, ...J });
      const { eventTrimmer: ue } = await Promise.resolve().then(() => n5), de = await ue.getStatus();
      p(de);
      const { useMemoryStore: ce } = await Promise.resolve().then(() => KO), W = ce.getState(), { totalTokens: $, activeEventCount: fe } = await W.countEventTokens();
      b($), k(fe);
    } catch (me) {
      console.error(" Summarizer :", me);
    }
  }, T = async () => {
    try {
      const { summarizerService: Z } = await Promise.resolve().then(() => _l);
      Z.start(), await A();
    } catch (Z) {
      console.error(":", Z);
    }
  }, M = async () => {
    try {
      const { summarizerService: Z } = await Promise.resolve().then(() => _l);
      Z.stop(), await A();
    } catch (Z) {
      console.error(":", Z);
    }
  }, j = async () => {
    r(!0);
    try {
      const { summarizerService: Z } = await Promise.resolve().then(() => _l);
      await Z.triggerSummary(!0), await A();
    } catch (Z) {
      console.error(":", Z);
    } finally {
      r(!1);
    }
  }, D = async () => {
    if (confirm("")) {
      r(!0);
      try {
        const { summarizerService: Z } = await Promise.resolve().then(() => _l);
        await Z.setLastSummarizedFloor(0), await A();
      } catch (Z) {
        console.error(":", Z);
      } finally {
        r(!1);
      }
    }
  }, z = (Z) => {
    const me = { ...c, trigger: Z };
    d(me), L(me);
  }, I = (Z, me) => {
    const Q = { ...c, [Z]: me };
    d(Q), L(Q);
  }, L = (Z) => {
    rt.setSummarizerSettings({ trimConfig: Z });
  }, K = async () => {
    const Z = { ...c, enabled: !c.enabled };
    d(Z), L(Z);
    const { eventTrimmer: me } = await Promise.resolve().then(() => n5);
    me.updateConfig({ enabled: Z.enabled });
  }, ne = async () => {
    s(!0);
    try {
      const { eventTrimmer: Z } = await Promise.resolve().then(() => n5);
      await Z.trim(!0), await A();
    } catch (Z) {
      console.error(":", Z);
    } finally {
      s(!1);
    }
  }, H = (() => {
    switch (c.trigger) {
      case "token":
        return { value: c.tokenLimit ?? 10240, min: 1024, max: 1e5, step: 1024, label: "Token " };
      case "count":
        return { value: c.countLimit ?? 5, min: 2, max: 20, step: 1, label: "" };
      default:
        return { value: 10240, min: 1024, max: 1e5, step: 1024, label: "Token " };
    }
  })();
  return /* @__PURE__ */ g.jsxs("div", { className: "grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-12", children: [
    /* @__PURE__ */ g.jsxs("section", { className: "space-y-8", children: [
      /* @__PURE__ */ g.jsxs("div", { children: [
        /* @__PURE__ */ g.jsxs("div", { className: "flex items-center justify-between mb-6", children: [
          /* @__PURE__ */ g.jsx("h2", { className: "text-xs font-medium text-muted-foreground uppercase tracking-wider", children: "" }),
          /* @__PURE__ */ g.jsx(
            "button",
            {
              className: "p-1 rounded text-muted-foreground hover:text-foreground transition-colors",
              onClick: A,
              title: "",
              children: /* @__PURE__ */ g.jsx(zr, { size: 14 })
            }
          )
        ] }),
        e ? /* @__PURE__ */ g.jsxs("div", { className: "space-y-6", children: [
          /* @__PURE__ */ g.jsxs("div", { className: "grid grid-cols-2 gap-6", children: [
            /* @__PURE__ */ g.jsxs("div", { children: [
              /* @__PURE__ */ g.jsx("span", { className: "text-xs text-muted-foreground block mb-1", children: "" }),
              /* @__PURE__ */ g.jsxs("div", { className: `flex items-center gap-2 text-lg font-medium ${e.running ? "text-green-500" : "text-muted-foreground"}`, children: [
                e.running ? /* @__PURE__ */ g.jsx(Yv, { size: 18 }) : /* @__PURE__ */ g.jsx(qc, { size: 18 }),
                e.running ? "" : ""
              ] })
            ] }),
            /* @__PURE__ */ g.jsxs("div", { children: [
              /* @__PURE__ */ g.jsx("span", { className: "text-xs text-muted-foreground block mb-1", children: "" }),
              /* @__PURE__ */ g.jsx("div", { className: "text-3xl font-light text-amber-500 font-mono", children: e.pendingFloors })
            ] })
          ] }),
          /* @__PURE__ */ g.jsx(Jr, { length: 100, spacing: "md" }),
          /* @__PURE__ */ g.jsxs("div", { className: "grid grid-cols-2 gap-6", children: [
            /* @__PURE__ */ g.jsxs("div", { children: [
              /* @__PURE__ */ g.jsx("span", { className: "text-[10px] text-muted-foreground/70 uppercase tracking-wider block mb-1", children: "" }),
              /* @__PURE__ */ g.jsx("div", { className: "text-xl font-mono text-foreground/80", children: e.currentFloor })
            ] }),
            /* @__PURE__ */ g.jsxs("div", { children: [
              /* @__PURE__ */ g.jsx("span", { className: "text-[10px] text-muted-foreground/70 uppercase tracking-wider block mb-1", children: " ()" }),
              /* @__PURE__ */ g.jsx("div", { className: "text-xl font-mono text-foreground/80", children: S })
            ] })
          ] }),
          /* @__PURE__ */ g.jsx(Jr, { length: 30, spacing: "md" }),
          /* @__PURE__ */ g.jsxs("div", { children: [
            /* @__PURE__ */ g.jsx("span", { className: "text-[10px] text-muted-foreground/60 uppercase tracking-wider block mb-1", children: " Token (Engram)" }),
            /* @__PURE__ */ g.jsx("div", { className: "text-sm font-mono text-primary/80", children: x.toLocaleString() })
          ] })
        ] }) : /* @__PURE__ */ g.jsx("p", { className: "text-sm text-muted-foreground", children: "..." })
      ] }),
      /* @__PURE__ */ g.jsxs("div", { className: "flex gap-3", children: [
        e != null && e.running ? /* @__PURE__ */ g.jsxs(
          "button",
          {
            className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg transition-colors",
            onClick: M,
            children: [
              /* @__PURE__ */ g.jsx(nR, { size: 14 }),
              ""
            ]
          }
        ) : /* @__PURE__ */ g.jsxs(
          "button",
          {
            className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg transition-colors hover:bg-accent",
            onClick: T,
            children: [
              /* @__PURE__ */ g.jsx(s0, { size: 14 }),
              ""
            ]
          }
        ),
        /* @__PURE__ */ g.jsxs(
          "button",
          {
            className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg transition-colors disabled:opacity-50",
            onClick: j,
            disabled: n || (e == null ? void 0 : e.isSummarizing),
            children: [
              /* @__PURE__ */ g.jsx(zr, { size: 14, className: n ? "animate-spin" : "" }),
              n ? "..." : ""
            ]
          }
        )
      ] }),
      /* @__PURE__ */ g.jsxs("div", { className: "pt-6 space-y-6", children: [
        /* @__PURE__ */ g.jsx(Jr, { length: 100 }),
        /* @__PURE__ */ g.jsxs("div", { className: "grid grid-cols-2 gap-4", children: [
          /* @__PURE__ */ g.jsxs("div", { className: "flex items-center justify-between", children: [
            /* @__PURE__ */ g.jsx("span", { className: "text-sm text-foreground", children: "" }),
            /* @__PURE__ */ g.jsx(
              So,
              {
                label: "",
                checked: o.autoEnabled,
                onChange: async (Z) => {
                  u((Q) => ({ ...Q, autoEnabled: Z }));
                  const { summarizerService: me } = await Promise.resolve().then(() => _l);
                  me.updateConfig({ enabled: Z });
                }
              }
            )
          ] }),
          /* @__PURE__ */ g.jsxs("div", { className: "flex items-center justify-between", children: [
            /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col", children: [
              /* @__PURE__ */ g.jsx("span", { className: "text-sm text-foreground", children: "" }),
              /* @__PURE__ */ g.jsx("span", { className: "text-[10px] text-muted-foreground", children: "" })
            ] }),
            /* @__PURE__ */ g.jsx(
              So,
              {
                label: "",
                checked: o.autoHide,
                onChange: (Z) => {
                  u((me) => ({ ...me, autoHide: Z })), Promise.resolve().then(() => _l).then(({ summarizerService: me }) => {
                    me.updateConfig({ autoHide: Z });
                  });
                }
              }
            )
          ] })
        ] }),
        o.autoEnabled && /* @__PURE__ */ g.jsx(g.Fragment, { children: /* @__PURE__ */ g.jsxs("div", { className: "grid grid-cols-2 gap-6", children: [
          /* @__PURE__ */ g.jsxs("div", { className: "space-y-3", children: [
            /* @__PURE__ */ g.jsxs("div", { className: "text-xs text-muted-foreground", children: [
              " ",
              /* @__PURE__ */ g.jsx("span", { className: "text-base font-medium text-foreground mx-0.5", children: o.floorInterval }),
              " "
            ] }),
            /* @__PURE__ */ g.jsxs("div", { className: "relative h-4 flex items-center group cursor-pointer", children: [
              /* @__PURE__ */ g.jsx("div", { className: "absolute inset-x-0 h-[1px]", style: { backgroundColor: "var(--border)" } }),
              /* @__PURE__ */ g.jsx(
                "div",
                {
                  className: "absolute top-1/2 -translate-y-1/2 w-2.5 h-2.5 bg-muted-foreground/80 rounded-full shadow-sm pointer-events-none transition-transform duration-75 ease-out group-hover:scale-125 group-hover:bg-foreground",
                  style: { left: `${(o.floorInterval - 5) / 95 * 100}%`, transform: "translate(-50%, -50%)" }
                }
              ),
              /* @__PURE__ */ g.jsx(
                "input",
                {
                  type: "range",
                  min: 5,
                  max: 100,
                  step: 5,
                  value: o.floorInterval,
                  onChange: async (Z) => {
                    const me = Number(Z.target.value);
                    u((se) => ({ ...se, floorInterval: me }));
                    const { summarizerService: Q } = await Promise.resolve().then(() => _l);
                    Q.updateConfig({ floorInterval: me });
                  },
                  className: "absolute inset-x-0 w-full h-full opacity-0 cursor-pointer z-10 m-0",
                  style: { appearance: "none", WebkitAppearance: "none" }
                }
              )
            ] })
          ] }),
          /* @__PURE__ */ g.jsxs("div", { className: "space-y-3", children: [
            /* @__PURE__ */ g.jsxs("div", { className: "text-xs text-muted-foreground", children: [
              " ",
              /* @__PURE__ */ g.jsx("span", { className: "text-base font-medium text-foreground mx-0.5", children: o.bufferSize }),
              " "
            ] }),
            /* @__PURE__ */ g.jsxs("div", { className: "relative h-4 flex items-center group cursor-pointer", children: [
              /* @__PURE__ */ g.jsx("div", { className: "absolute inset-x-0 h-[1px]", style: { backgroundColor: "var(--border)" } }),
              /* @__PURE__ */ g.jsx(
                "div",
                {
                  className: "absolute top-1/2 -translate-y-1/2 w-2.5 h-2.5 bg-muted-foreground/80 rounded-full shadow-sm pointer-events-none transition-transform duration-75 ease-out group-hover:scale-125 group-hover:bg-foreground",
                  style: { left: `${o.bufferSize / 20 * 100}%`, transform: "translate(-50%, -50%)" }
                }
              ),
              /* @__PURE__ */ g.jsx(
                "input",
                {
                  type: "range",
                  min: 0,
                  max: 20,
                  step: 1,
                  value: o.bufferSize,
                  onChange: (Z) => {
                    const me = Number(Z.target.value);
                    u((Q) => ({ ...Q, bufferSize: me })), Promise.resolve().then(() => _l).then(({ summarizerService: Q }) => {
                      Q.updateConfig({ bufferSize: me });
                    });
                  },
                  className: "absolute inset-x-0 w-full h-full opacity-0 cursor-pointer z-10 m-0",
                  style: { appearance: "none", WebkitAppearance: "none" }
                }
              )
            ] })
          ] })
        ] }) })
      ] }),
      /* @__PURE__ */ g.jsx("div", { className: "flex justify-end", children: /* @__PURE__ */ g.jsxs(
        "button",
        {
          className: "inline-flex items-center gap-2 px-3 py-1.5 text-xs text-red-500 hover:text-red-400 border border-red-500/30 hover:border-red-500/50 hover:bg-red-500/10 rounded transition-colors",
          onClick: D,
          disabled: n,
          title: " ()",
          children: [
            /* @__PURE__ */ g.jsx(zr, { size: 12, className: n ? "animate-spin" : "" }),
            ""
          ]
        }
      ) })
    ] }),
    /* @__PURE__ */ g.jsxs("section", { className: "space-y-6 lg:pl-8 relative", children: [
      /* @__PURE__ */ g.jsx(Jr, { responsive: !0, length: 30 }),
      /* @__PURE__ */ g.jsxs("div", { className: "flex items-center justify-between", children: [
        /* @__PURE__ */ g.jsxs("div", { children: [
          /* @__PURE__ */ g.jsx("h2", { className: "text-sm font-medium text-foreground", children: "" }),
          /* @__PURE__ */ g.jsx("p", { className: "text-xs text-muted-foreground mt-0.5", children: "" })
        ] }),
        /* @__PURE__ */ g.jsx(
          So,
          {
            label: "",
            checked: c.enabled ?? !1,
            onChange: K
          }
        )
      ] }),
      /* @__PURE__ */ g.jsxs("div", { className: `space-y-6 transition-opacity ${c.enabled ? "opacity-100" : "opacity-40 pointer-events-none"}`, children: [
        /* @__PURE__ */ g.jsxs("div", { className: "space-y-3", children: [
          /* @__PURE__ */ g.jsx("span", { className: "text-xs text-muted-foreground", children: "" }),
          /* @__PURE__ */ g.jsx("div", { className: "flex gap-6", children: Xfe.map((Z) => /* @__PURE__ */ g.jsxs(
            "label",
            {
              className: "flex items-center gap-2 cursor-pointer group",
              onClick: () => z(Z.id),
              children: [
                /* @__PURE__ */ g.jsx(
                  "span",
                  {
                    className: `w-4 h-4 rounded-full border-2 flex items-center justify-center transition-colors
                                        ${c.trigger === Z.id ? "border-primary bg-primary" : "border-border group-hover:border-muted-foreground"}`,
                    children: c.trigger === Z.id && /* @__PURE__ */ g.jsx("span", { className: "w-1.5 h-1.5 rounded-full bg-primary-foreground" })
                  }
                ),
                /* @__PURE__ */ g.jsx("span", { className: `text-sm transition-colors ${c.trigger === Z.id ? "text-foreground" : "text-muted-foreground"}`, children: Z.label })
              ]
            },
            Z.id
          )) })
        ] }),
        /* @__PURE__ */ g.jsxs("div", { className: "space-y-3", children: [
          /* @__PURE__ */ g.jsx("div", { className: "text-xs text-muted-foreground", children: H.label === "Token " ? /* @__PURE__ */ g.jsxs(g.Fragment, { children: [
            " Token  ",
            /* @__PURE__ */ g.jsx("span", { className: "text-base font-medium text-foreground mx-0.5", children: H.value }),
            " "
          ] }) : /* @__PURE__ */ g.jsxs(g.Fragment, { children: [
            " ",
            /* @__PURE__ */ g.jsx("span", { className: "text-base font-medium text-foreground mx-0.5", children: H.value }),
            " "
          ] }) }),
          /* @__PURE__ */ g.jsxs("div", { className: "relative h-4 flex items-center group cursor-pointer", children: [
            /* @__PURE__ */ g.jsx("div", { className: "absolute inset-x-0 h-[1px]", style: { backgroundColor: "var(--border)" } }),
            /* @__PURE__ */ g.jsx(
              "div",
              {
                className: "absolute top-1/2 -translate-y-1/2 w-2.5 h-2.5 bg-muted-foreground/80 rounded-full shadow-sm pointer-events-none transition-transform duration-75 ease-out group-hover:scale-125 group-hover:bg-foreground",
                style: { left: `${(H.value - H.min) / (H.max - H.min) * 100}%`, transform: "translate(-50%, -50%)" }
              }
            ),
            /* @__PURE__ */ g.jsx(
              "input",
              {
                type: "range",
                min: H.min,
                max: H.max,
                step: H.step,
                value: H.value,
                onChange: (Z) => {
                  const me = Number(Z.target.value), Q = c.trigger === "token" ? "tokenLimit" : "countLimit";
                  I(Q, me);
                },
                className: "absolute inset-x-0 w-full h-full opacity-0 cursor-pointer z-10 m-0",
                style: { appearance: "none", WebkitAppearance: "none" }
              }
            )
          ] })
        ] }),
        /* @__PURE__ */ g.jsxs("div", { className: "space-y-3", children: [
          /* @__PURE__ */ g.jsxs("div", { className: "text-xs text-muted-foreground", children: [
            " ",
            /* @__PURE__ */ g.jsx("span", { className: "text-base font-medium text-foreground mx-0.5", children: c.keepRecentCount ?? 3 }),
            " "
          ] }),
          /* @__PURE__ */ g.jsxs("div", { className: "relative h-4 flex items-center group cursor-pointer", children: [
            /* @__PURE__ */ g.jsx("div", { className: "absolute inset-x-0 h-[1px]", style: { backgroundColor: "var(--border)" } }),
            /* @__PURE__ */ g.jsx(
              "div",
              {
                className: "absolute top-1/2 -translate-y-1/2 w-2.5 h-2.5 bg-muted-foreground/80 rounded-full shadow-sm pointer-events-none transition-transform duration-75 ease-out group-hover:scale-125 group-hover:bg-foreground",
                style: { left: `${(c.keepRecentCount ?? 3) / 10 * 100}%`, transform: "translate(-50%, -50%)" }
              }
            ),
            /* @__PURE__ */ g.jsx(
              "input",
              {
                type: "range",
                min: 0,
                max: 10,
                step: 1,
                value: c.keepRecentCount ?? 3,
                onChange: (Z) => I("keepRecentCount", Number(Z.target.value)),
                className: "absolute inset-x-0 w-full h-full opacity-0 cursor-pointer z-10 m-0",
                style: { appearance: "none", WebkitAppearance: "none" }
              }
            )
          ] })
        ] }),
        m && /* @__PURE__ */ g.jsxs("div", { className: "text-xs text-muted-foreground space-y-1", children: [
          /* @__PURE__ */ g.jsxs("div", { className: "flex justify-between", children: [
            /* @__PURE__ */ g.jsx("span", { children: ":" }),
            /* @__PURE__ */ g.jsx("span", { className: "font-mono", children: m.pendingEntryCount })
          ] }),
          /* @__PURE__ */ g.jsxs("div", { className: "flex justify-between", children: [
            /* @__PURE__ */ g.jsxs("span", { children: [
              "",
              c.trigger === "token" ? "Token" : "",
              ":"
            ] }),
            /* @__PURE__ */ g.jsxs("span", { className: `font-mono ${m.triggered ? "text-amber-500" : ""}`, children: [
              m.currentValue,
              " / ",
              H.value
            ] })
          ] })
        ] }),
        /* @__PURE__ */ g.jsxs(
          "button",
          {
            type: "button",
            className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg hover:bg-accent transition-colors disabled:opacity-50",
            onClick: ne,
            disabled: i || ((m == null ? void 0 : m.pendingEntryCount) ?? 0) < 2,
            children: [
              /* @__PURE__ */ g.jsx(Mq, { size: 14, className: i ? "animate-pulse" : "" }),
              i ? "..." : ""
            ]
          }
        ),
        /* @__PURE__ */ g.jsx("p", { className: "text-xs text-muted-foreground/70 leading-relaxed", children: " Token " })
      ] })
    ] })
  ] });
}, Zfe = () => {
  const [e, t] = F.useState({ total: 0, embedded: 0, pending: 0 }), [n, r] = F.useState(null), [i, s] = F.useState(!1), [o, u] = F.useState(!0), [c, d] = F.useState(null), [m, p] = F.useState(null), [x, b] = F.useState({ ...u5 }), [S, k] = F.useState(null);
  F.useEffect(() => {
    A();
  }, []);
  const A = async () => {
    u(!0), d(null);
    try {
      const K = rt.get("apiSettings");
      K != null && K.vectorConfig && (k(K.vectorConfig), Qr.setConfig(K.vectorConfig)), K != null && K.embeddingConfig && b({ ...u5, ...K.embeddingConfig });
      const ne = await Qr.getEmbeddingStats();
      t(ne);
    } catch (K) {
      d(K.message || "");
    } finally {
      u(!1);
    }
  }, T = F.useCallback(async () => {
    const K = await Qr.getEmbeddingStats();
    t(K);
  }, []), M = async () => {
    if (!S) {
      d("");
      return;
    }
    s(!0), r({ current: 0, total: e.pending, errors: 0 }), d(null), p(null);
    try {
      Qr.setConfig(S), Qr.setConcurrency(x.concurrency);
      const K = await Qr.embedUnprocessedEvents((ne, Y, H) => {
        r({ current: ne, total: Y, errors: H });
      });
      p(K), await T();
    } catch (K) {
      d(K.message || "");
    } finally {
      s(!1), r(null);
    }
  }, j = () => {
    Qr.stop();
  }, D = async () => {
    if (!S) {
      d("");
      return;
    }
    if (confirm("")) {
      s(!0), r({ current: 0, total: e.total, errors: 0 }), d(null), p(null);
      try {
        Qr.setConfig(S), Qr.setConcurrency(x.concurrency);
        const K = await Qr.reembedAllEvents((ne, Y, H) => {
          r({ current: ne, total: Y, errors: H });
        });
        p(K), await T();
      } catch (K) {
        d(K.message || "");
      } finally {
        s(!1), r(null);
      }
    }
  }, z = (K) => {
    const ne = { ...x, ...K };
    b(ne);
    const Y = rt.get("apiSettings");
    Y && rt.set("apiSettings", {
      ...Y,
      embeddingConfig: ne
    });
  }, I = n && n.total > 0 ? Math.round(n.current / n.total * 100) : 0, L = S && (S.source === "transformers" || S.model);
  return o ? /* @__PURE__ */ g.jsxs("div", { className: "flex items-center justify-center h-48 text-muted-foreground gap-2", children: [
    /* @__PURE__ */ g.jsx(Eu, { size: 20, className: "animate-spin" }),
    /* @__PURE__ */ g.jsx("span", { className: "text-sm font-light", children: "..." })
  ] }) : /* @__PURE__ */ g.jsxs("div", { className: "py-4", children: [
    /* @__PURE__ */ g.jsxs("div", { className: "grid grid-cols-3 gap-4 mb-6", children: [
      /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col gap-1", children: [
        /* @__PURE__ */ g.jsx("span", { className: "text-xs text-muted-foreground uppercase tracking-wider", children: "" }),
        /* @__PURE__ */ g.jsx("span", { className: "text-2xl font-light", children: e.total })
      ] }),
      /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col gap-1", children: [
        /* @__PURE__ */ g.jsx("span", { className: "text-xs text-muted-foreground uppercase tracking-wider", children: "" }),
        /* @__PURE__ */ g.jsx("span", { className: "text-2xl font-light text-primary", children: e.embedded })
      ] }),
      /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col gap-1", children: [
        /* @__PURE__ */ g.jsx("span", { className: "text-xs text-muted-foreground uppercase tracking-wider", children: "" }),
        /* @__PURE__ */ g.jsx("span", { className: "text-2xl font-light text-warning", children: e.pending })
      ] })
    ] }),
    n && /* @__PURE__ */ g.jsxs("div", { className: "mb-6 p-4 bg-muted/30 rounded-lg", children: [
      /* @__PURE__ */ g.jsxs("div", { className: "flex items-center justify-between mb-2", children: [
        /* @__PURE__ */ g.jsxs("span", { className: "text-sm text-muted-foreground", children: [
          " ",
          n.current,
          "/",
          n.total
        ] }),
        /* @__PURE__ */ g.jsxs("span", { className: "text-sm font-medium", children: [
          I,
          "%"
        ] })
      ] }),
      /* @__PURE__ */ g.jsx("div", { className: "h-2 bg-muted rounded-full overflow-hidden", children: /* @__PURE__ */ g.jsx(
        "div",
        {
          className: "h-full bg-primary transition-all duration-300",
          style: { width: `${I}%` }
        }
      ) }),
      n.errors > 0 && /* @__PURE__ */ g.jsxs("p", { className: "text-xs text-destructive mt-2", children: [
        n.errors,
        " "
      ] })
    ] }),
    m && /* @__PURE__ */ g.jsxs("div", { className: `mb-6 p-3 rounded-lg flex items-center gap-2 ${m.failed > 0 ? "bg-warning/10 text-warning" : "bg-primary/10 text-primary"}`, children: [
      m.failed > 0 ? /* @__PURE__ */ g.jsx(qc, { size: 16 }) : /* @__PURE__ */ g.jsx(Yv, { size: 16 }),
      /* @__PURE__ */ g.jsxs("span", { className: "text-sm", children: [
        "",
        m.success,
        " ",
        m.failed > 0 && `${m.failed} `
      ] })
    ] }),
    c && /* @__PURE__ */ g.jsxs("div", { className: "mb-6 p-3 bg-destructive/10 text-destructive rounded-lg flex items-center gap-2", children: [
      /* @__PURE__ */ g.jsx(qc, { size: 16 }),
      /* @__PURE__ */ g.jsx("span", { className: "text-sm", children: c })
    ] }),
    !L && /* @__PURE__ */ g.jsx("div", { className: "mb-6 p-3 bg-muted/50 rounded-lg", children: /* @__PURE__ */ g.jsxs("p", { className: "text-sm text-muted-foreground", children: [
      "",
      /* @__PURE__ */ g.jsx("span", { className: "text-primary mx-1", children: "API     " }),
      ""
    ] }) }),
    /* @__PURE__ */ g.jsx("div", { className: "flex flex-wrap gap-3 mb-6", children: i ? /* @__PURE__ */ g.jsxs(
      "button",
      {
        onClick: j,
        className: "inline-flex items-center gap-2 px-4 py-2 bg-destructive text-destructive-foreground rounded-md hover:bg-destructive/90 transition-colors",
        children: [
          /* @__PURE__ */ g.jsx(sR, { size: 16 }),
          ""
        ]
      }
    ) : /* @__PURE__ */ g.jsxs(g.Fragment, { children: [
      /* @__PURE__ */ g.jsxs(
        "button",
        {
          onClick: M,
          disabled: e.pending === 0 || !L,
          className: "inline-flex items-center gap-2 px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",
          children: [
            /* @__PURE__ */ g.jsx(s0, { size: 16 }),
            " (",
            e.pending,
            ")"
          ]
        }
      ),
      /* @__PURE__ */ g.jsxs(
        "button",
        {
          onClick: D,
          disabled: e.total === 0 || !L,
          className: "inline-flex items-center gap-2 px-4 py-2 border border-border text-foreground rounded-md hover:bg-muted transition-colors disabled:opacity-50 disabled:cursor-not-allowed",
          children: [
            /* @__PURE__ */ g.jsx(zr, { size: 16 }),
            ""
          ]
        }
      ),
      /* @__PURE__ */ g.jsx(
        "button",
        {
          onClick: T,
          className: "inline-flex items-center gap-2 px-3 py-2 text-muted-foreground hover:text-foreground transition-colors",
          children: /* @__PURE__ */ g.jsx(zr, { size: 16 })
        }
      )
    ] }) }),
    /* @__PURE__ */ g.jsx(Jr, { className: "my-6" }),
    /* @__PURE__ */ g.jsxs("div", { className: "space-y-4", children: [
      /* @__PURE__ */ g.jsx("h3", { className: "text-sm font-medium text-muted-foreground uppercase tracking-wider", children: "" }),
      /* @__PURE__ */ g.jsx(
        So,
        {
          label: "",
          checked: x.enabled,
          onChange: (K) => z({ enabled: K }),
          description: ""
        }
      ),
      /* @__PURE__ */ g.jsx(
        xu,
        {
          label: "",
          value: x.trigger,
          onChange: (K) => z({ trigger: K }),
          options: [
            { value: "with_trim", label: " Trim " },
            { value: "standalone", label: "" },
            { value: "manual", label: "" }
          ],
          description: "with_trim: Trim  | standalone: "
        }
      ),
      /* @__PURE__ */ g.jsx(
        bi,
        {
          label: "",
          value: x.concurrency,
          onChange: (K) => z({ concurrency: Math.max(1, Math.min(20, K)) }),
          min: 1,
          max: 20,
          description: " (1-20)"
        }
      ),
      S && /* @__PURE__ */ g.jsxs("div", { className: "p-3 bg-muted/30 rounded-lg", children: [
        /* @__PURE__ */ g.jsx("p", { className: "text-xs text-muted-foreground mb-1", children: "" }),
        /* @__PURE__ */ g.jsxs("p", { className: "text-sm", children: [
          /* @__PURE__ */ g.jsx("span", { className: "text-primary", children: S.source }),
          S.model && /* @__PURE__ */ g.jsxs("span", { className: "text-muted-foreground ml-2", children: [
            "/ ",
            S.model
          ] })
        ] })
      ] })
    ] })
  ] });
}, Jfe = ({ config: e, onChange: t }) => {
  var r, i, s, o;
  const n = (u) => {
    const c = { ...e, ...u };
    t(c);
  };
  return /* @__PURE__ */ g.jsxs("div", { className: "space-y-6 animate-in fade-in slide-in-from-right-4 duration-500", children: [
    /* @__PURE__ */ g.jsx("div", { className: "bg-secondary/20 p-4 rounded-lg border border-border/50", children: /* @__PURE__ */ g.jsxs("div", { className: "flex items-center justify-between", children: [
      /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-3", children: [
        /* @__PURE__ */ g.jsx("div", { className: `p-2 rounded-md ${e.enabled ? "bg-primary/20 text-primary" : "bg-muted text-muted-foreground"}`, children: /* @__PURE__ */ g.jsx(tR, { size: 20 }) }),
        /* @__PURE__ */ g.jsxs("div", { children: [
          /* @__PURE__ */ g.jsx("div", { className: "font-medium", children: " RAG " }),
          /* @__PURE__ */ g.jsx("div", { className: "text-xs text-muted-foreground", children: "" })
        ] })
      ] }),
      /* @__PURE__ */ g.jsx(
        Zr,
        {
          checked: e.enabled,
          onChange: (u) => n({ enabled: u })
        }
      )
    ] }) }),
    /* @__PURE__ */ g.jsxs("div", { className: "space-y-4", children: [
      /* @__PURE__ */ g.jsx("h3", { className: "text-sm font-medium text-muted-foreground uppercase tracking-wider px-1", children: "" }),
      /* @__PURE__ */ g.jsxs("div", { className: "grid grid-cols-1 md:grid-cols-2 gap-4", children: [
        /* @__PURE__ */ g.jsxs("div", { className: `p-4 rounded-lg border transition-all ${e.useBruteForce ? "bg-primary/5 border-primary/30" : "bg-card border-border/50 hover:border-border"}`, children: [
          /* @__PURE__ */ g.jsxs("div", { className: "flex items-start justify-between mb-2", children: [
            /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-2 text-sm font-medium", children: [
              /* @__PURE__ */ g.jsx(Ld, { size: 16, className: e.useBruteForce ? "text-primary" : "text-muted-foreground" }),
              " (Brute Force)"
            ] }),
            /* @__PURE__ */ g.jsx(
              Zr,
              {
                checked: e.useBruteForce,
                onChange: (u) => n({ useBruteForce: u })
              }
            )
          ] }),
          /* @__PURE__ */ g.jsx("p", { className: "text-xs text-muted-foreground leading-relaxed", children: "" })
        ] }),
        /* @__PURE__ */ g.jsxs("div", { className: `p-4 rounded-lg border transition-all ${e.useEmbedding ? "bg-primary/5 border-primary/30" : "bg-card border-border/50 hover:border-border"}`, children: [
          /* @__PURE__ */ g.jsxs("div", { className: "flex items-start justify-between mb-2", children: [
            /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-2 text-sm font-medium", children: [
              /* @__PURE__ */ g.jsx(Wv, { size: 16, className: e.useEmbedding ? "text-primary" : "text-muted-foreground" }),
              " (Embedding)"
            ] }),
            /* @__PURE__ */ g.jsx(
              Zr,
              {
                checked: e.useEmbedding,
                onChange: (u) => n({ useEmbedding: u })
              }
            )
          ] }),
          /* @__PURE__ */ g.jsx("p", { className: "text-xs text-muted-foreground leading-relaxed", children: "RAG " })
        ] }),
        /* @__PURE__ */ g.jsxs("div", { className: `p-4 rounded-lg border transition-all ${e.usePreprocessing ? "bg-primary/5 border-primary/30" : "bg-card border-border/50 hover:border-border"}`, children: [
          /* @__PURE__ */ g.jsxs("div", { className: "flex items-start justify-between mb-2", children: [
            /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-2 text-sm font-medium", children: [
              /* @__PURE__ */ g.jsx(gB, { size: 16, className: e.usePreprocessing ? "text-primary" : "text-muted-foreground" }),
              "LLM "
            ] }),
            /* @__PURE__ */ g.jsx(
              Zr,
              {
                checked: e.usePreprocessing,
                onChange: (u) => n({ usePreprocessing: u })
              }
            )
          ] }),
          /* @__PURE__ */ g.jsx("p", { className: "text-xs text-muted-foreground leading-relaxed", children: " LLM " })
        ] }),
        /* @__PURE__ */ g.jsxs("div", { className: `p-4 rounded-lg border transition-all ${e.useRerank ? "bg-primary/5 border-primary/30" : "bg-card border-border/50 hover:border-border"}`, children: [
          /* @__PURE__ */ g.jsxs("div", { className: "flex items-start justify-between mb-2", children: [
            /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-2 text-sm font-medium", children: [
              /* @__PURE__ */ g.jsx(_C, { size: 16, className: e.useRerank ? "text-primary" : "text-muted-foreground" }),
              "Rerank "
            ] }),
            /* @__PURE__ */ g.jsx(
              Zr,
              {
                checked: e.useRerank,
                disabled: !e.useEmbedding,
                onChange: (u) => n({ useRerank: u })
              }
            )
          ] }),
          /* @__PURE__ */ g.jsxs("p", { className: "text-xs text-muted-foreground leading-relaxed", children: [
            " Rerank ",
            !e.useEmbedding && /* @__PURE__ */ g.jsxs("span", { className: "text-yellow-500 block mt-1 text-[10px] flex items-center gap-1", children: [
              /* @__PURE__ */ g.jsx(oR, { size: 10 }),
              " "
            ] })
          ] })
        ] })
      ] })
    ] }),
    /* @__PURE__ */ g.jsxs("div", { className: "grid grid-cols-1 md:grid-cols-2 gap-6 pt-4 border-t border-border/30", children: [
      /* @__PURE__ */ g.jsx(
        bi,
        {
          label: " (Top-K)",
          description: "",
          min: 1,
          max: 100,
          value: ((r = e.embedding) == null ? void 0 : r.topK) ?? 20,
          onChange: (u) => {
            var c;
            return n({
              embedding: {
                topK: u,
                minScoreThreshold: ((c = e.embedding) == null ? void 0 : c.minScoreThreshold) ?? 0.3
              }
            });
          }
        }
      ),
      /* @__PURE__ */ g.jsx(
        bi,
        {
          label: "",
          description: " (0.0 - 1.0)",
          min: 0,
          max: 1,
          step: 0.05,
          value: ((i = e.embedding) == null ? void 0 : i.minScoreThreshold) ?? 0.3,
          onChange: (u) => {
            var c;
            return n({
              embedding: {
                topK: ((c = e.embedding) == null ? void 0 : c.topK) ?? 20,
                minScoreThreshold: u
              }
            });
          }
        }
      )
    ] }),
    /* @__PURE__ */ g.jsxs("div", { className: "space-y-4 pt-4 border-t border-border/30", children: [
      /* @__PURE__ */ g.jsxs("div", { className: "flex items-center justify-between", children: [
        /* @__PURE__ */ g.jsx("h3", { className: "text-sm font-medium text-muted-foreground uppercase tracking-wider", children: " (Sticky)" }),
        /* @__PURE__ */ g.jsx(
          Zr,
          {
            checked: ((s = e.sticky) == null ? void 0 : s.enabled) ?? !0,
            onChange: (u) => n({
              sticky: {
                ...e.sticky || { decayFactor: 0.15, maxStickRounds: 3 },
                enabled: u
              }
            })
          }
        )
      ] }),
      ((o = e.sticky) == null ? void 0 : o.enabled) && /* @__PURE__ */ g.jsx("div", { className: "grid grid-cols-1 md:grid-cols-2 gap-6", children: /* @__PURE__ */ g.jsx(
        bi,
        {
          label: "",
          description: " (0-1)",
          min: 0,
          max: 1,
          step: 0.05,
          value: e.sticky.decayFactor,
          onChange: (u) => n({
            sticky: { ...e.sticky, decayFactor: u }
          })
        }
      ) })
    ] })
  ] });
}, ede = () => {
  const [e, t] = F.useState(A0);
  F.useEffect(() => {
    const r = rt.get("apiSettings");
    r != null && r.recallConfig && t(r.recallConfig);
  }, []);
  const n = (r) => {
    t(r);
    const i = rt.get("apiSettings");
    i && (rt.set("apiSettings", {
      ...i,
      recallConfig: r
    }), ve.debug("RecallPanel", "", r));
  };
  return /* @__PURE__ */ g.jsx("div", { className: "p-1", children: /* @__PURE__ */ g.jsx(Jfe, { config: e, onChange: n }) });
}, tde = () => {
  const [e, t] = F.useState({ ...AC, enabled: !1 }), [n, r] = F.useState(null), [i, s] = F.useState(!1), o = async () => {
    try {
      const m = await yu.getStatus();
      r(m), t(yu.getConfig());
    } catch (m) {
      console.error("[EntityConfigPanel] Failed to load status:", m);
    }
  };
  F.useEffect(() => {
    o();
  }, []);
  const u = () => {
    const m = { ...e, enabled: !e.enabled };
    yu.updateConfig(m), t(m);
  }, c = (m) => {
    const p = { ...e, floorInterval: Math.max(10, m) };
    yu.updateConfig(p), t(p);
  }, d = async () => {
    s(!0);
    try {
      await yu.extractManual(), await o();
    } catch (m) {
      console.error("[EntityConfigPanel] Manual extraction failed:", m);
    } finally {
      s(!1);
    }
  };
  return /* @__PURE__ */ g.jsxs("div", { className: "grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-12", children: [
    /* @__PURE__ */ g.jsxs("section", { className: "space-y-8", children: [
      /* @__PURE__ */ g.jsxs("div", { children: [
        /* @__PURE__ */ g.jsxs("div", { className: "flex items-center justify-between mb-6", children: [
          /* @__PURE__ */ g.jsx("h2", { className: "text-xs font-medium text-muted-foreground uppercase tracking-wider", children: "" }),
          /* @__PURE__ */ g.jsx(
            "button",
            {
              className: "p-1 rounded text-muted-foreground hover:text-foreground transition-colors",
              onClick: o,
              title: "",
              children: /* @__PURE__ */ g.jsx(zr, { size: 14 })
            }
          )
        ] }),
        n ? /* @__PURE__ */ g.jsxs("div", { className: "space-y-6", children: [
          /* @__PURE__ */ g.jsxs("div", { className: "grid grid-cols-2 gap-6", children: [
            /* @__PURE__ */ g.jsxs("div", { children: [
              /* @__PURE__ */ g.jsx("span", { className: "text-xs text-muted-foreground block mb-1", children: "" }),
              /* @__PURE__ */ g.jsx("div", { className: `text-lg font-medium ${e.enabled ? "text-green-500" : "text-muted-foreground"}`, children: e.enabled ? "" : "" })
            ] }),
            /* @__PURE__ */ g.jsxs("div", { children: [
              /* @__PURE__ */ g.jsx("span", { className: "text-xs text-muted-foreground block mb-1", children: "" }),
              /* @__PURE__ */ g.jsx("div", { className: "text-3xl font-light text-primary font-mono", children: n.entityCount })
            ] })
          ] }),
          /* @__PURE__ */ g.jsx(Jr, { length: 100, spacing: "md" }),
          /* @__PURE__ */ g.jsxs("div", { className: "grid grid-cols-2 gap-6", children: [
            /* @__PURE__ */ g.jsxs("div", { children: [
              /* @__PURE__ */ g.jsx("span", { className: "text-[10px] text-muted-foreground/70 uppercase tracking-wider block mb-1", children: "" }),
              /* @__PURE__ */ g.jsx("div", { className: "text-xl font-mono text-foreground/80", children: n.floorInterval })
            ] }),
            /* @__PURE__ */ g.jsxs("div", { children: [
              /* @__PURE__ */ g.jsx("span", { className: "text-[10px] text-muted-foreground/70 uppercase tracking-wider block mb-1", children: "" }),
              /* @__PURE__ */ g.jsx("div", { className: "text-xl font-mono text-foreground/80", children: n.lastExtractedFloor })
            ] })
          ] })
        ] }) : /* @__PURE__ */ g.jsx("p", { className: "text-sm text-muted-foreground", children: "..." })
      ] }),
      /* @__PURE__ */ g.jsx("div", { className: "flex gap-3", children: /* @__PURE__ */ g.jsxs(
        "button",
        {
          onClick: d,
          disabled: i || (n == null ? void 0 : n.isExtracting) || !e.enabled,
          className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",
          children: [
            /* @__PURE__ */ g.jsx(zr, { size: 14, className: i ? "animate-spin" : "" }),
            i ? "..." : ""
          ]
        }
      ) })
    ] }),
    /* @__PURE__ */ g.jsxs("section", { className: "space-y-6 lg:pl-8 relative", children: [
      /* @__PURE__ */ g.jsx(Jr, { responsive: !0, length: 30 }),
      /* @__PURE__ */ g.jsxs("div", { className: "flex items-center justify-between", children: [
        /* @__PURE__ */ g.jsxs("div", { children: [
          /* @__PURE__ */ g.jsx("h2", { className: "text-sm font-medium text-foreground", children: "" }),
          /* @__PURE__ */ g.jsx("p", { className: "text-xs text-muted-foreground mt-0.5", children: "" })
        ] }),
        /* @__PURE__ */ g.jsx(
          So,
          {
            label: "",
            checked: e.enabled,
            onChange: u
          }
        )
      ] }),
      /* @__PURE__ */ g.jsxs("div", { className: `space-y-6 transition-opacity ${e.enabled ? "opacity-100" : "opacity-40 pointer-events-none"}`, children: [
        /* @__PURE__ */ g.jsxs("div", { className: "space-y-3", children: [
          /* @__PURE__ */ g.jsxs("div", { className: "text-xs text-muted-foreground", children: [
            " ",
            /* @__PURE__ */ g.jsx("span", { className: "text-base font-medium text-foreground mx-0.5", children: e.floorInterval }),
            " "
          ] }),
          /* @__PURE__ */ g.jsxs("div", { className: "relative h-4 flex items-center group cursor-pointer", children: [
            /* @__PURE__ */ g.jsx("div", { className: "absolute inset-x-0 h-[1px]", style: { backgroundColor: "var(--border)" } }),
            /* @__PURE__ */ g.jsx(
              "div",
              {
                className: "absolute top-1/2 -translate-y-1/2 w-2.5 h-2.5 bg-muted-foreground/80 rounded-full shadow-sm pointer-events-none transition-transform duration-75 ease-out group-hover:scale-125 group-hover:bg-foreground",
                style: { left: `${(e.floorInterval - 10) / 90 * 100}%`, transform: "translate(-50%, -50%)" }
              }
            ),
            /* @__PURE__ */ g.jsx(
              "input",
              {
                type: "range",
                min: 10,
                max: 100,
                step: 5,
                value: e.floorInterval,
                onChange: (m) => c(parseInt(m.target.value)),
                className: "absolute inset-x-0 w-full h-full opacity-0 cursor-pointer z-10 m-0",
                style: { appearance: "none", WebkitAppearance: "none" }
              }
            )
          ] })
        ] }),
        /* @__PURE__ */ g.jsx("p", { className: "text-xs text-muted-foreground/70 leading-relaxed", children: "" })
      ] })
    ] })
  ] });
}, nde = {
  mode: "detailed",
  chunkSize: 2e3,
  overlapSize: 200
};
class rde {
  constructor() {
    vt(this, "queue", {
      tasks: [],
      isRunning: !1,
      isPaused: !1,
      currentTaskIndex: 0,
      overallProgress: { current: 0, total: 0 }
    });
    vt(this, "onProgress");
    vt(this, "stopSignal", !1);
  }
  /**  */
  async analyzeHistory(t = 0, n) {
    const i = kl.getStatus().currentFloor, s = n ?? i, o = kl.getConfig(), u = yu.getConfig(), c = gv.getConfig(), d = s - t, m = o.floorInterval || 10, p = u.floorInterval || 50, x = Math.ceil(d / m), b = u.enabled ? Math.ceil(d / p) : 0, S = c.countLimit || 5, k = c.enabled ? Math.floor(x / S) : 0, A = x * 2, T = x * 2e3 + b * 2e3 + k * 2e3 + A * 200;
    return {
      currentFloor: i,
      startFloor: t,
      endFloor: s,
      summaryTasks: x,
      entityTasks: b,
      trimTasks: k,
      embedTasks: A,
      estimatedTokens: T
    };
  }
  /**  */
  buildQueue(t) {
    const n = [], { startFloor: r, endFloor: i, summaryTasks: s, entityTasks: o, trimTasks: u, embedTasks: c } = t, d = kl.getConfig().floorInterval || 10, m = yu.getConfig().floorInterval || 50;
    for (let p = 0; p < s; p++) {
      const x = r + p * d, b = Math.min(x + d, i);
      n.push({
        id: fm(),
        type: "summary",
        status: "pending",
        progress: { current: 0, total: 1 },
        floorRange: { start: x, end: b }
      });
    }
    for (let p = 0; p < o; p++) {
      const x = r + p * m, b = Math.min(x + m, i);
      n.push({
        id: fm(),
        type: "entity",
        status: "pending",
        progress: { current: 0, total: 1 },
        floorRange: { start: x, end: b }
      });
    }
    for (let p = 0; p < u; p++)
      n.push({
        id: fm(),
        type: "trim",
        status: "pending",
        progress: { current: 0, total: 1 }
      });
    return n.push({
      id: fm(),
      type: "embed",
      status: "pending",
      progress: { current: 0, total: c }
    }), n;
  }
  /**  */
  async start(t = 0, n, r) {
    if (this.queue.isRunning) {
      ve.warn("BatchProcessor", "Already running");
      return;
    }
    this.onProgress = r, this.stopSignal = !1;
    const i = await this.analyzeHistory(t, n);
    this.queue.tasks = this.buildQueue(i), this.queue.isRunning = !0, this.queue.isPaused = !1, this.queue.currentTaskIndex = 0, this.queue.overallProgress = { current: 0, total: this.queue.tasks.length }, ve.info("BatchProcessor", `Starting: ${this.queue.tasks.length} tasks`), this.notifyProgress(), await this.runQueue();
  }
  /**  */
  async runQueue() {
    for (; this.queue.currentTaskIndex < this.queue.tasks.length; ) {
      if (this.stopSignal) {
        ve.info("BatchProcessor", "Stopped by user");
        break;
      }
      if (this.queue.isPaused) {
        await new Promise((n) => setTimeout(n, 500));
        continue;
      }
      const t = this.queue.tasks[this.queue.currentTaskIndex];
      t.status = "running", this.notifyProgress();
      try {
        await this.executeTask(t), t.status = "done", t.progress.current = t.progress.total;
      } catch (n) {
        t.status = "error", t.error = String(n), ve.error("BatchProcessor", `Task ${t.type} failed: ${String(n)}`);
      }
      this.queue.currentTaskIndex++, this.queue.overallProgress.current = this.queue.currentTaskIndex, this.notifyProgress();
    }
    this.queue.isRunning = !1, ve.info("BatchProcessor", "Completed"), this.notifyProgress();
  }
  /**  */
  async executeTask(t) {
    switch (t.type) {
      case "summary":
        await this.executeSummaryTask(t);
        break;
      case "entity":
        await this.executeEntityTask(t);
        break;
      case "trim":
        await this.executeTrimTask(t);
        break;
      case "embed":
        await this.executeEmbedTask(t);
        break;
    }
  }
  async executeSummaryTask(t) {
    if (!t.floorRange) return;
    await kl.setLastSummarizedFloor(t.floorRange.start), await kl.triggerSummary(!0) || (t.status = "skipped");
  }
  async executeEntityTask(t) {
    if (!t.floorRange) return;
    await yu.extractManual() || (t.status = "skipped");
  }
  async executeTrimTask(t) {
    const { canTrim: n } = await gv.canTrim();
    n ? await gv.trim(!0) : t.status = "skipped";
  }
  async executeEmbedTask(t) {
    const n = await Qr.embedUnprocessedEvents((r, i) => {
      t.progress.current = r, t.progress.total = i, this.notifyProgress();
    });
    t.progress.current = n.success;
  }
  pause() {
    this.queue.isPaused = !0, ve.info("BatchProcessor", "Paused"), this.notifyProgress();
  }
  resume() {
    this.queue.isPaused = !1, ve.info("BatchProcessor", "Resumed"), this.notifyProgress();
  }
  stop() {
    this.stopSignal = !0, this.queue.isPaused = !1, ve.info("BatchProcessor", "Stopping...");
  }
  reset() {
    this.stopSignal = !0, this.queue = {
      tasks: [],
      isRunning: !1,
      isPaused: !1,
      currentTaskIndex: 0,
      overallProgress: { current: 0, total: 0 }
    }, this.notifyProgress();
  }
  getQueue() {
    return { ...this.queue };
  }
  notifyProgress() {
    this.onProgress && this.onProgress({ ...this.queue });
  }
  // ====================  txt  ====================
  chunkText(t, n, r) {
    const i = [];
    let s = 0;
    for (; s < t.length; ) {
      const o = Math.min(s + n, t.length);
      if (i.push(t.slice(s, o)), s = o - r, s >= t.length - r) break;
    }
    return i;
  }
  async importText(t, n = nde, r) {
    const i = this.chunkText(t, n.chunkSize, n.overlapSize), s = da.getState();
    await s.initChat();
    let o = 0, u = 0;
    this.queue = {
      tasks: [{
        id: fm(),
        type: "embed",
        status: "running",
        progress: { current: 0, total: i.length }
      }],
      isRunning: !0,
      isPaused: !1,
      currentTaskIndex: 0,
      overallProgress: { current: 0, total: i.length }
    }, this.onProgress = r, this.stopSignal = !1, this.notifyProgress();
    for (let c = 0; c < i.length && !this.stopSignal; c++) {
      const d = i[c];
      try {
        let m = d;
        n.mode === "detailed" && (m = d);
        const p = await s.saveEvent({
          summary: m,
          structured_kv: {
            time_anchor: "",
            role: [],
            location: "",
            event: ` #${c + 1}`,
            logic: [],
            causality: ""
          },
          significance_score: 5,
          level: 0,
          is_embedded: !1,
          is_archived: !1,
          source_range: { start_index: c, end_index: c }
        });
        await Qr.embedEvent(p), o++;
      } catch (m) {
        ve.error("BatchProcessor", `Import chunk ${c} failed: ${String(m)}`), u++;
      }
      this.queue.tasks[0].progress.current = c + 1, this.queue.overallProgress.current = c + 1, this.notifyProgress();
    }
    return this.queue.isRunning = !1, this.queue.tasks[0].status = "done", this.notifyProgress(), ve.info("BatchProcessor", `Import completed: ${o} success, ${u} failed`), { success: o, failed: u };
  }
}
const ud = new rde(), ide = ({ status: e }) => {
  switch (e) {
    case "done":
      return /* @__PURE__ */ g.jsx(Yv, { size: 14, className: "text-green-500" });
    case "error":
      return /* @__PURE__ */ g.jsx(AB, { size: 14, className: "text-red-500" });
    case "running":
      return /* @__PURE__ */ g.jsx(zr, { size: 14, className: "text-primary animate-spin" });
    case "skipped":
      return /* @__PURE__ */ g.jsx(yv, { size: 14, className: "text-muted-foreground" });
    default:
      return /* @__PURE__ */ g.jsx(yv, { size: 14, className: "text-muted-foreground/50" });
  }
}, ade = {
  summary: "",
  entity: "",
  trim: "",
  embed: ""
}, sde = () => {
  const e = F.useRef(null), [t, n] = F.useState(null), [r, i] = F.useState(null), [s, o] = F.useState(!1), [u, c] = F.useState(0), [d, m] = F.useState(kl.getStatus().currentFloor), [p, x] = F.useState("detailed"), [b, S] = F.useState(2e3), [k, A] = F.useState(200), [T, M] = F.useState(""), [j, D] = F.useState(null), z = F.useCallback(async () => {
    o(!0);
    try {
      const Q = await ud.analyzeHistory(u, d);
      n(Q), m(Q.endFloor);
    } catch (Q) {
      console.error("[BatchPanel] Analyze failed:", Q);
    } finally {
      o(!1);
    }
  }, [u, d]), I = F.useCallback(async () => {
    t && await ud.start(t.startFloor, t.endFloor, (Q) => i({ ...Q }));
  }, [t]), L = F.useCallback(() => {
    r != null && r.isPaused ? ud.resume() : ud.pause();
  }, [r]), K = F.useCallback(() => ud.stop(), []), ne = F.useCallback(() => {
    ud.reset(), i(null), n(null);
  }, []), Y = F.useCallback(async () => {
    if (!T.trim()) return;
    const Q = await ud.importText(
      T,
      { mode: p, chunkSize: b, overlapSize: k },
      (se) => {
        se.tasks[0] && D(se.tasks[0].progress);
      }
    );
    D(null), alert(`${Q.success} ${Q.failed} `);
  }, [T, p, b, k]), H = F.useCallback((Q) => {
    var ue;
    const se = (ue = Q.target.files) == null ? void 0 : ue[0];
    if (!se) return;
    const J = new FileReader();
    J.onload = (de) => {
      var ce;
      return M(((ce = de.target) == null ? void 0 : ce.result) || "");
    }, J.readAsText(se);
  }, []), Z = F.useCallback(() => {
    var Q;
    (Q = e.current) == null || Q.click();
  }, []), me = r != null && r.overallProgress ? Math.round(r.overallProgress.current / r.overallProgress.total * 100) : 0;
  return /* @__PURE__ */ g.jsxs("div", { className: "grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-12", children: [
    /* @__PURE__ */ g.jsxs("section", { className: "space-y-6", children: [
      /* @__PURE__ */ g.jsxs("div", { children: [
        /* @__PURE__ */ g.jsx("h2", { className: "text-sm font-medium text-foreground mb-1", children: "" }),
        /* @__PURE__ */ g.jsx("p", { className: "text-xs text-muted-foreground", children: "" })
      ] }),
      /* @__PURE__ */ g.jsxs("div", { className: "grid grid-cols-2 gap-6", children: [
        /* @__PURE__ */ g.jsx(
          bi,
          {
            label: "",
            value: u,
            onChange: c,
            min: 0,
            max: d,
            step: 1,
            showSlider: !1
          }
        ),
        /* @__PURE__ */ g.jsx(
          bi,
          {
            label: "",
            value: d,
            onChange: m,
            min: u,
            step: 1,
            showSlider: !1
          }
        )
      ] }),
      /* @__PURE__ */ g.jsxs(
        "button",
        {
          className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg transition-colors disabled:opacity-50",
          onClick: z,
          disabled: s || (r == null ? void 0 : r.isRunning),
          children: [
            /* @__PURE__ */ g.jsx(zr, { size: 14, className: s ? "animate-spin" : "" }),
            s ? "..." : ""
          ]
        }
      ),
      t && /* @__PURE__ */ g.jsxs(g.Fragment, { children: [
        /* @__PURE__ */ g.jsx(Jr, { length: 100, spacing: "md" }),
        /* @__PURE__ */ g.jsxs("div", { className: "space-y-4", children: [
          /* @__PURE__ */ g.jsx("h3", { className: "text-xs font-medium text-muted-foreground uppercase tracking-wider", children: "" }),
          /* @__PURE__ */ g.jsxs("div", { className: "space-y-2 text-sm", children: [
            /* @__PURE__ */ g.jsxs("div", { className: "flex justify-between", children: [
              /* @__PURE__ */ g.jsx("span", { className: "text-muted-foreground", children: " " }),
              /* @__PURE__ */ g.jsxs("span", { className: "font-mono text-foreground", children: [
                t.summaryTasks,
                " "
              ] })
            ] }),
            /* @__PURE__ */ g.jsxs("div", { className: "flex justify-between", children: [
              /* @__PURE__ */ g.jsx("span", { className: "text-muted-foreground", children: " " }),
              /* @__PURE__ */ g.jsxs("span", { className: "font-mono text-foreground", children: [
                t.entityTasks,
                " "
              ] })
            ] }),
            /* @__PURE__ */ g.jsxs("div", { className: "flex justify-between", children: [
              /* @__PURE__ */ g.jsx("span", { className: "text-muted-foreground", children: " " }),
              /* @__PURE__ */ g.jsxs("span", { className: "font-mono text-foreground", children: [
                "~",
                t.trimTasks,
                " "
              ] })
            ] }),
            /* @__PURE__ */ g.jsxs("div", { className: "flex justify-between", children: [
              /* @__PURE__ */ g.jsx("span", { className: "text-muted-foreground", children: " " }),
              /* @__PURE__ */ g.jsxs("span", { className: "font-mono text-foreground", children: [
                "~",
                t.embedTasks,
                " "
              ] })
            ] }),
            /* @__PURE__ */ g.jsx(Jr, { length: 30, spacing: "sm" }),
            /* @__PURE__ */ g.jsxs("div", { className: "flex justify-between", children: [
              /* @__PURE__ */ g.jsx("span", { className: "text-muted-foreground", children: " Token" }),
              /* @__PURE__ */ g.jsxs("span", { className: "font-mono text-primary", children: [
                "~",
                (t.estimatedTokens / 1e3).toFixed(0),
                "k"
              ] })
            ] })
          ] })
        ] }),
        /* @__PURE__ */ g.jsxs("div", { className: "flex gap-3 flex-wrap", children: [
          r != null && r.isRunning ? /* @__PURE__ */ g.jsxs(g.Fragment, { children: [
            /* @__PURE__ */ g.jsxs(
              "button",
              {
                className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg transition-colors",
                onClick: L,
                children: [
                  r.isPaused ? /* @__PURE__ */ g.jsx(s0, { size: 14 }) : /* @__PURE__ */ g.jsx(nR, { size: 14 }),
                  r.isPaused ? "" : ""
                ]
              }
            ),
            /* @__PURE__ */ g.jsxs(
              "button",
              {
                className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-red-400 hover:text-red-300 border border-red-500/30 rounded-lg transition-colors",
                onClick: K,
                children: [
                  /* @__PURE__ */ g.jsx(sR, { size: 14 }),
                  ""
                ]
              }
            )
          ] }) : /* @__PURE__ */ g.jsxs(
            "button",
            {
              className: "inline-flex items-center gap-2 px-4 py-2 text-sm bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors",
              onClick: I,
              children: [
                /* @__PURE__ */ g.jsx(s0, { size: 14 }),
                ""
              ]
            }
          ),
          r && !r.isRunning && /* @__PURE__ */ g.jsxs(
            "button",
            {
              className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg transition-colors",
              onClick: ne,
              children: [
                /* @__PURE__ */ g.jsx(iR, { size: 14 }),
                ""
              ]
            }
          )
        ] }),
        r && /* @__PURE__ */ g.jsxs("div", { className: "space-y-3", children: [
          /* @__PURE__ */ g.jsx("div", { className: "h-1.5 bg-muted rounded-full overflow-hidden", children: /* @__PURE__ */ g.jsx(
            "div",
            {
              className: "h-full bg-primary transition-all duration-300",
              style: { width: `${me}%` }
            }
          ) }),
          /* @__PURE__ */ g.jsxs("div", { className: "text-xs text-muted-foreground text-center", children: [
            me,
            "% - ",
            r.currentTaskIndex,
            "/",
            r.overallProgress.total,
            " "
          ] }),
          /* @__PURE__ */ g.jsxs("div", { className: "space-y-1 max-h-40 overflow-y-auto", children: [
            r.tasks.slice(0, 10).map((Q) => /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-2 text-xs", children: [
              /* @__PURE__ */ g.jsx(ide, { status: Q.status }),
              /* @__PURE__ */ g.jsx("span", { className: Q.status === "running" ? "text-foreground" : "text-muted-foreground", children: ade[Q.type] || Q.type }),
              Q.floorRange && /* @__PURE__ */ g.jsxs("span", { className: "text-muted-foreground/50 font-mono", children: [
                "#",
                Q.floorRange.start,
                "-",
                Q.floorRange.end
              ] })
            ] }, Q.id)),
            r.tasks.length > 10 && /* @__PURE__ */ g.jsxs("div", { className: "text-xs text-muted-foreground/50", children: [
              "... ",
              r.tasks.length - 10,
              " "
            ] })
          ] })
        ] })
      ] })
    ] }),
    /* @__PURE__ */ g.jsxs("section", { className: "space-y-6 lg:pl-8 relative", children: [
      /* @__PURE__ */ g.jsx(Jr, { responsive: !0, length: 30 }),
      /* @__PURE__ */ g.jsxs("div", { children: [
        /* @__PURE__ */ g.jsx("h2", { className: "text-sm font-medium text-foreground mb-1", children: "" }),
        /* @__PURE__ */ g.jsx("p", { className: "text-xs text-muted-foreground", children: "" })
      ] }),
      /* @__PURE__ */ g.jsxs("div", { className: "flex items-center gap-3", children: [
        /* @__PURE__ */ g.jsx(
          "input",
          {
            ref: e,
            type: "file",
            accept: ".txt,.md",
            onChange: H,
            className: "hidden"
          }
        ),
        /* @__PURE__ */ g.jsxs(
          "button",
          {
            className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg transition-colors",
            onClick: Z,
            children: [
              /* @__PURE__ */ g.jsx(lR, { size: 14 }),
              ""
            ]
          }
        ),
        T && /* @__PURE__ */ g.jsxs("span", { className: "text-xs text-muted-foreground", children: [
          " ",
          (T.length / 1024).toFixed(1),
          " KB"
        ] })
      ] }),
      /* @__PURE__ */ g.jsxs("div", { className: "space-y-3", children: [
        /* @__PURE__ */ g.jsx("span", { className: "text-xs text-muted-foreground", children: "" }),
        /* @__PURE__ */ g.jsxs("div", { className: "space-y-2", children: [
          /* @__PURE__ */ g.jsxs("label", { className: "flex items-start gap-3 cursor-pointer group", onClick: () => x("fast"), children: [
            /* @__PURE__ */ g.jsx("span", { className: `mt-0.5 w-4 h-4 rounded-full border-2 flex items-center justify-center transition-colors ${p === "fast" ? "border-primary bg-primary" : "border-border group-hover:border-muted-foreground"}`, children: p === "fast" && /* @__PURE__ */ g.jsx("span", { className: "w-1.5 h-1.5 rounded-full bg-primary-foreground" }) }),
            /* @__PURE__ */ g.jsxs("div", { children: [
              /* @__PURE__ */ g.jsx("span", { className: `text-sm ${p === "fast" ? "text-foreground" : "text-muted-foreground"}`, children: "" }),
              /* @__PURE__ */ g.jsx("p", { className: "text-[10px] text-muted-foreground", children: "   LLM" })
            ] })
          ] }),
          /* @__PURE__ */ g.jsxs("label", { className: "flex items-start gap-3 cursor-pointer group", onClick: () => x("detailed"), children: [
            /* @__PURE__ */ g.jsx("span", { className: `mt-0.5 w-4 h-4 rounded-full border-2 flex items-center justify-center transition-colors ${p === "detailed" ? "border-primary bg-primary" : "border-border group-hover:border-muted-foreground"}`, children: p === "detailed" && /* @__PURE__ */ g.jsx("span", { className: "w-1.5 h-1.5 rounded-full bg-primary-foreground" }) }),
            /* @__PURE__ */ g.jsxs("div", { children: [
              /* @__PURE__ */ g.jsx("span", { className: `text-sm ${p === "detailed" ? "text-foreground" : "text-muted-foreground"}`, children: "" }),
              /* @__PURE__ */ g.jsx("p", { className: "text-[10px] text-muted-foreground", children: "  LLM   " })
            ] })
          ] })
        ] })
      ] }),
      /* @__PURE__ */ g.jsxs("div", { className: "grid grid-cols-2 gap-6", children: [
        /* @__PURE__ */ g.jsx(
          bi,
          {
            label: "",
            value: b,
            onChange: S,
            min: 100,
            max: 1e4,
            step: 100,
            showSlider: !1
          }
        ),
        /* @__PURE__ */ g.jsx(
          bi,
          {
            label: "",
            value: k,
            onChange: A,
            min: 0,
            max: b / 2,
            step: 50,
            showSlider: !1
          }
        )
      ] }),
      T && /* @__PURE__ */ g.jsxs("div", { children: [
        /* @__PURE__ */ g.jsx("span", { className: "text-xs text-muted-foreground block mb-2", children: "" }),
        /* @__PURE__ */ g.jsxs("div", { className: "bg-muted/20 border border-border rounded-lg p-3 max-h-32 overflow-y-auto text-xs text-muted-foreground font-mono", children: [
          T.slice(0, 500),
          "..."
        ] }),
        /* @__PURE__ */ g.jsxs("div", { className: "text-[10px] text-muted-foreground mt-1", children: [
          " ",
          Math.ceil((T.length - k) / (b - k)),
          " "
        ] })
      ] }),
      /* @__PURE__ */ g.jsxs(
        "button",
        {
          className: "inline-flex items-center gap-2 px-4 py-2 text-sm bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50",
          onClick: Y,
          disabled: !T || j !== null,
          children: [
            /* @__PURE__ */ g.jsx(zm, { size: 14 }),
            j ? ` ${j.current}/${j.total}` : ""
          ]
        }
      ),
      j && /* @__PURE__ */ g.jsx("div", { className: "h-1.5 bg-muted rounded-full overflow-hidden", children: /* @__PURE__ */ g.jsx(
        "div",
        {
          className: "h-full bg-primary transition-all duration-300",
          style: { width: `${j.current / j.total * 100}%` }
        }
      ) })
    ] })
  ] });
}, ode = [
  { id: "summary", label: "", icon: /* @__PURE__ */ g.jsx(zm, { size: 16 }) },
  { id: "entity", label: "", icon: /* @__PURE__ */ g.jsx(tR, { size: 16 }) },
  { id: "vectorization", label: "", icon: /* @__PURE__ */ g.jsx(Wv, { size: 16 }) },
  { id: "recall", label: "", icon: /* @__PURE__ */ g.jsx(Ls, { size: 16 }) },
  { id: "batch", label: "", icon: /* @__PURE__ */ g.jsx(_C, { size: 16 }) }
], lde = [
  { id: "devlog", label: "", icon: Oq, linkTo: "devlog:model" },
  { id: "presets", label: "", icon: cB, linkTo: "presets:prompt" }
], ude = ({ onNavigate: e }) => {
  const [t, n] = F.useState("summary");
  return /* @__PURE__ */ g.jsxs("div", { className: "flex flex-col h-full", children: [
    /* @__PURE__ */ g.jsxs("div", { className: "mb-6", children: [
      /* @__PURE__ */ g.jsx("h1", { className: "text-2xl font-light text-foreground tracking-tight mb-2", children: "" }),
      /* @__PURE__ */ g.jsx("p", { className: "text-sm text-muted-foreground", children: " RAG " })
    ] }),
    /* @__PURE__ */ g.jsx(Jr, { className: "mb-6" }),
    /* @__PURE__ */ g.jsx(
      lx,
      {
        tabs: ode,
        activeTab: t,
        onChange: (r) => n(r),
        actions: /* @__PURE__ */ g.jsx(
          Wfe,
          {
            links: lde,
            onNavigate: (r) => e == null ? void 0 : e(r)
          }
        )
      }
    ),
    /* @__PURE__ */ g.jsxs("div", { className: "flex-1 overflow-y-auto no-scrollbar", children: [
      t === "summary" && /* @__PURE__ */ g.jsx(Qfe, {}),
      t === "vectorization" && /* @__PURE__ */ g.jsx(Zfe, {}),
      t === "recall" && /* @__PURE__ */ g.jsx(ede, {}),
      t === "entity" && /* @__PURE__ */ g.jsx(tde, {}),
      t === "batch" && /* @__PURE__ */ g.jsx(sde, {})
    ] })
  ] });
}, cde = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  ProcessingView: ude
}, Symbol.toStringTag, { value: "Module" }));
//# sourceMappingURL=index.js.map
